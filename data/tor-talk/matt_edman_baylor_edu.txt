
@_date: 2005-08-19 08:20:46
@_author: Edman, Matt 
@_subject: bad security setting for win32 tor service 
You can also have Tor install the service as the NT AUTHORITY\LocalService account. This patch on 0.1.1.5-alpha does so:
--- main.c.orig 2005-08-04 18:45:20.000000000 -0400
+++ main.c      2005-08-19 09:15:47.000000000 -0400
 -77,6 +77,7   GENSRV_SERVICENAME  TEXT("tor")
  GENSRV_DISPLAYNAME  TEXT("Tor Win32 Service")
  GENSRV_DESCRIPTION  TEXT("Provides an anonymous Internet communication system")
+ GENSRV_USERACCT     TEXT("NT AUTHORITY\\LocalService")
 // Cheating: using the pre-defined error codes, tricks Windows into displaying
 //           a semi-related human-readable error message if startup fails as
 -1767,7 +1768,7    if ((hService = CreateService(hSCManager, GENSRV_SERVICENAME, GENSRV_DISPLAYNAME,
                                 SERVICE_ALL_ACCESS, SERVICE_WIN32_OWN_PROCESS,
                                 SERVICE_AUTO_START, SERVICE_ERROR_IGNORE, command,
-                                NULL, NULL, NULL, NULL, "")) == NULL) {
+                                NULL, NULL, NULL, GENSRV_USERACCT, "")) == NULL) {
     errmsg = nt_strerror(GetLastError());
     printf("CreateService() failed : %s\n", errmsg);
     CloseServiceHandle(hSCManager);
-----Original Message-----
Sent: Thu 8/18/2005 9:05 PM
the default install of win32 tor service is bad.
tor -install create the service that it runs with SYSTEM-privileges
(highest possible privilege level on win32 (more than administrator))
Nobody would run tor daemon on *nix with root-privileges.
short document about Service account permissions:
Tor works fine as user LocalService.
tor.exe didn't find:
C:\Documents and Settings\LocalService\Application Data\Tor\torrc
c:\Program Files\Tor\torrc
I defined the log directory in torrc this way:
Log notice file C:\Documents and Settings\LocalService\Application Data\Tor\notices.log
and changed the account for the service:
(0. "tor -install" if tor is not installed)
1. run "regedit /s tor_service.reg" to merge this regfile silent
2. stop tor-service "sc stop tor"
3. start tor-service again "sc start tor" and it runs within the localservice account

@_date: 2005-08-19 23:43:07
@_author: Edman, Matt 
@_subject: bad security setting for win32 tor service 
If the service is set to run as LocalService, other limited
users should not be able to see its data directory.
I know the subject of what location is best for Tor to use as its
default data directory on Windows has been discussed at least once
or twice, but I don't believe a satisfactory solution was determined.
This becomes a problem when someone sets up their server while
running non-service Tor, then installs Tor as a service, and
then things break because Tor is now using LocalService\App Data
instead of UserName\App Data. Similarly, if someone sets up their server while running the Tor service as LocalService, and then wants to run it as non-service Tor, non-service Tor wouldn't know to look in (and wouldn't be able to read) LocalService\App Data.
It seems that Tor would have to use All Users\App Data for Tor
to be able to switch seamlessly between service and non-service
Tor. Of course, this would be bad because then all users would be able to read the server's private keys.
Is it acceptable to say "run Tor either as a service or as a normal
console app. If you want to switch back and forth, you're on your own?" If so, I think it would be safe to say that if you're
running Tor as a service, then Tor will use LocalService\App Data
for everything (including the torrc file). Else, Tor will use
UserName\App Data for everything (including the torrc file).

@_date: 2005-07-31 21:45:10
@_author: Edman, Matt 
@_subject: minimise to system tray 
============================== START ==============================
Thanks trying it out and I will make your suggested changes to the
installer this week.
To leave beta, it really just needs people to use it. It especially needs users of older Windowses (95/98/Me) to try it out. I would also
like to get a bugtracker up somewhere, because I'm sure there are
some bugs lurking.

@_date: 2005-12-20 19:51:22
@_author: Edman, Matt 
@_subject: We have a new Windows Tor installer 
Thanks for pointing that out, Thomas. I've updated the bundles with your fix.
Let us know if anything else is broken.
-----Original Message-----
Sent: Tue 12/20/2005 11:46 AM
Broken config:
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corporation
C:\Documents and Settings\thomas>cd c:\program\tor
Dec 20 18:22:53.531 [notice] Tor v0.1.0.15. This is experimental
software. Do not rely on it for strong anonymity.
Dec 20 18:22:53.546 [warn] config_assign_line(): Unknown option
'SocksListenAddress'.  Failing.
Dec 20 18:22:53.546 [err] tor_init(): Reading config failed--see
warnings above.
 For usage, try -h.
 C:\Program\Tor>
Diff attached.

@_date: 2005-12-29 17:43:50
@_author: Edman, Matt 
@_subject: mobile TorCP? 
Two things would have to be done for this to work. First, TorCP would need to read and save its settings to a text file instead of the registry. Alternatively, a batch file could be used to set the HKCU\TorCP\TorPath value to point to the Tor on the USB drive and then blow away TorCP's settings when you're done.
Second, TorCP would need a way for you to specify which torrc you wish to use, so Tor would load a torrc from the USB drive instead of %appdata%.
Neither of the above items would be too difficult, so maybe this can be done in the not-too-distant future. Certainly the second requirement seems like a rather reasonable feature.

@_date: 2005-12-11 14:18:24
@_author: Edman, Matt 
@_subject: TorCP 0.0.4 is out 
If anyone is using TorCP, version 0.0.4 is out now. It has primarily
aesthetic and usability fixes, as well as improvements to hopefully make
the config menus a little more sane.
New screenshots:
0.0.4 12-10-2005
  o Improved appearance of nearly every dialog.
  o Removed some configuration options that people probably shouldn't     muck with anyway.
  o Added the ability to enable and disable running a Tor server.
  o Corrected the Tor copyright info in the About dialog as per Roger's
    recommendation.
  o Removed the "Service Install/Uninstall" tab. This was confusing too
    many people who didn't even need to be running Tor as a service
anyway     but had the "hey, it's a button, I'll click it" mentality.
  o Automatically try to reconnect to Tor if the controller connection
    for some reason instead of just displaying the little red X and
    the user to deal.
Bug reports and suggestions:

@_date: 2005-07-31 15:49:50
@_author: Edman, Matt 
@_subject: minimise to system tray 
You might also try this little Tor controller for Windows at It runs in the tray and can control Tor running as a service, or start Tor as a console app and
hide the console window. If you have problems with it, e-mail the address listed on the
contact page.

@_date: 2005-07-09 14:04:23
@_author: Edman, Matt 
@_subject: Howto compile Tor on a windows system 
Folks without Visual Studio might also try following the instructions at  using the compiler tools available for free from Microsoft packaged in various distributions (a couple are linked to from the instructions).
-----Original Message-----
Sent: Sat 7/9/2005 10:19 AM
I finally managed to build Tor on windows with VC7 (Visual Studio .net 2003)
Instructions on building Tor can be found at Enjoy :)

@_date: 2005-11-16 17:56:31
@_author: Edman, Matt 
@_subject: Vidalia project? 
Vidalia is making slow progress and, unfortunately, stands no chance of
making the deadline for Phase 1 of the GUI competition (despite the
extended deadline, even). It has never been hosted on SourceForge, but
you can view the spectacular lack of progress at [1]. In the meantime, I welcome any and all comments, suggestions, bug
reports, and hate mail on TorCP. Please see [2] for contact information.
You could be famous in the TorCP changelog for the next release sometime
shortly prior to the November 30 GUI competition deadline.
As mentioned on Tor's Volunteer page [3], documentation for TorCP is
also desperately needed. Since you mentioned you have spare time on your
hands, please see TorCP's Contribute page [4] for things that would be
wonderful to have and probably quite easy to do for those with either
writing, web design, or installer skills. Heck, even a simple e-mail
answering any of the questions posed on the Contribute page would be
great. If you would like to help, I'd like to hear [2] about it. [1] [2]  [3] [4]

@_date: 2005-10-27 14:48:06
@_author: Edman, Matt 
@_subject: TorCP won't start without mfc70.dll 
You might try placing mfc70.dll (and any other dlls it yells at you for) in the same directory as torcp.exe.
-----Original Message-----
Sent: Thursday, October 27, 2005 2:47 PM
I installed Tor 0.1.1.8-alpha together with Privoxy and TorCP on a Windows XP box. All those programs were installed into my homedir which is located on an NFS-server (roaming profiles). When I tried to start TorCP, I got an error messsage, that mfc70.dll is missing and the program couldn't be started. Due to restrictions on that machine I have no write access to C:\windows\system32 and could install it. Is there some other to get TorCP running on that box?
Best regards

@_date: 2005-10-27 17:02:41
@_author: Edman, Matt 
@_subject: TorCP won't start without mfc70.dll 
Hm. I tried removing my mfc70.dll (which caused TorCP to not start) and then placed it in the same directory as the .exe, and it worked fine and I didn't have to register anything. Can you perhaps see if Filemon from SysInternals or something like it yields any useful information about where it's actually looking for this dll?
-----Original Message-----
Sent: Thursday, October 27, 2005 5:20 PM
* Edman, Matt schrieb am 2005-10-27 um 21:48 Uhr:
This was the first thing I tried. But I got the same error message.
The mfc70.dll came from dll-files.com. I placed it into the TorCP-dir (where torcp.exe and some other files are) and tried to open TorCP by doubleclicking on it. Actually I hardly use Windows. Could it be that this dll must be registered somewhere?

@_date: 2005-09-12 15:23:01
@_author: Edman, Matt 
@_subject: Tor 0.1.1.6-alpha is out 
More specifically, Tor is crashing trying to return from
I believe this is caused by a change to connection_edge_end() in
This patch to 0.1.1.6-alpha should fix it:
--- connection_edge.c.orig      2005-09-12 16:17:28.000000000 -0400
+++ connection_edge.c   2005-09-12 16:17:44.000000000 -0400
 -173,7 +173,7  int
 connection_edge_end(connection_t *conn, char reason, crypt_path_t
 {
-  char payload[5];
+  char payload[9];
   size_t payload_len=1;
   circuit_t *circ;
-----Original Message-----
On Behalf Of alien
Sent: Monday, September 12, 2005 12:06 PM
Hi Bob,
The complete error message is:
Microsoft Visual C++ Debug Library
Debug Error!
Program: C:\Program Files\Tor\tor.exe
Module: C:\Program Files\Tor\tor.exe
Run-Time Check Failure  - Stack around the variable 'payload' was
Press retry to debug the application
"Retry" will crash Tor.
I'm getting it too after installing the new tor-0.1.1.6-alpha-win32. I
reverted back to tor-0.1.1.5-alpha-win32 and started getting with it as
well! Now that's odd, I didn't have this before...
It doesn't happen immediately, maybe an hour after starting.
 alien  mailto:alien51 at br.inter.net
.. Success always occurs in private, and failure in full view.

@_date: 2005-09-25 03:00:30
@_author: Edman, Matt 
@_subject: TorCP 0.0.3 is out 
If anyone is using TorCP, there is a new version out. The two big
changes are that you no longer have to manually set ControlPort in your
torrc (unless you run Tor as a service), and also now TorCP actually
works on old Windowses (95/98/Me).
0.0.3 9-25-2005
  o Added ability to copy log messages from history window to the
    (Suggested by Phobos)
  o If TorCP is running Tor as a hidden console app (i.e., not a
    TorCP will pass ControlPort as an argument to Tor so you don't have
    to set this option in your torrc. You still have to set ControlPort
    your torrc if you're running Tor as a service.
  o Fixed the installer to not blow up if it tries to install
    msvcp70.dll or msvcr70.dll and they already exist.
  o Fixed a bug that made TorCP not work in old Windowses (95/98/Me)

@_date: 2005-09-03 10:46:54
@_author: Edman, Matt 
@_subject: AllowedUnverifiedNodes 
AllowUnverifiedNodes setting, but wasn't sure what the correct tried "AllowUnverifiedNodes None" and It accepts "AllowUnverifiedNodes ", but I or does it actually mean none.
This turned out to be a "quirk" in Tor where it didn't really provide a
way to say "none." Roger also noticed that LongLivedPorts has this
problem as well and they hope to have a fix in place pretty soon.
On a side note, I put up an 0.0.2 of torcp so check it out and keep
reporting any bugs you find to the bugtracker!
