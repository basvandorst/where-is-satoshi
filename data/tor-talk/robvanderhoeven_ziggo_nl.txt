
@_date: 2016-04-21 19:27:59
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Sharing my OpenWrt Tor configuration 
Hi folks,
Two months ago I wrote an article named: Thoughts on Tor router
hardware. In the article I described an ideal Tor router configuration and argued
that having Tor on the router benefits both security and usability.
Since the article I have been playing a lot with my OpenWrt router, and
I think I now have a very nice configuration. I documented my
configuration in a new article:
The OpenWrt configuration improves my network security and ..... made me
remove Tor from all my computers. Yep, Tor on the router is the way to
go for me.
Enjoy the article,

@_date: 2016-04-23 10:00:12
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Statistics (metrics) on Tor users? 
I'm looking for statistics on the Tor users. The metrics website only
has data on the network, not on the users. I am interested in the
following data:
The OS distribution - What percentage of users are using
The web-browser distribution - It would be interesting to know what
percentage of users are using the recommended Tor-browser.
Any help is appreciated!

@_date: 2016-04-23 15:15:42
@_author: Rob van der Hoeven 
@_subject: [tor-talk] 12.7 percent of the domains I visit are intercepted by 
Today I got an idea of how to measure "The CloudFlare problem". It turns
out that every time you visit a website that's behind CloudFlare a
cookie is set with the name __cfduid If you use Firefox these cookies end up in a SQLite database which can
be queried with the SQLite Manager add-on. My total number of cookies is
2523 (I disable third-party cookies by default). CloudFlare cookies:
321. So 321/2523 *100 = 12.7% of the domains I have visited are
monitored by CloudFlare. Quite shocking I think.

@_date: 2016-04-23 21:54:24
@_author: Rob van der Hoeven 
@_subject: [tor-talk] 12.7 percent of the domains I visit are intercepted 
I am not using TBB. Sorry I was not clear about this. I use the normal
Firefox, enhanced with NoScript, AddBlockPlus etc. I changed the privacy
settings so that "Accept cookies from sites" is allowed, but "Accept
third-party cookies" is set to "Never"
Now the interesting (nasty) properties of CloudFlare cookies are:
1) They are not coming from the CloudFlare domain, but from the domain
you are visiting. If you surf to abcdef.com and that site uses
CloudFlare then the CloudFlare cookie is set for the abcdef.com domain.
CloudFlare clearly is a third-party, but their cookies can not be
disabled by refusing third-party cookies. 2) Many of *my* CloudFlare cookies have an expiration date of 23 dec
2019. These are clearly ment to be tracking cookies.

@_date: 2016-04-23 22:11:08
@_author: Rob van der Hoeven 
@_subject: [tor-talk] 12.7 percent of the domains I visit are intercepted 
Hmm, you are correct! This will probably mean that the situation is even
more shocking. The 2523 cookies do probably belong to far less domains. Sites with 0 cookies are probably very rare so I do not think taking
this into account will change the outcome significantly.
If I have time I will do a proper calculation.
 (A 100% cookie free website!)

@_date: 2016-02-23 21:46:53
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Thoughts on Tor router hardware 
Hi folks,
The last month I have been playing with cheap Tor router hardware. This
turned out to be quite a nice experience and it got me thinking about
the benefits of running Tor on the router. My conclusions are that running Tor on the router can enhance both
security and usability. It further opens new possibilities for expanding
the Tor-network and can provide a stable source of income for the
Wrote an article about this on my blog:

@_date: 2016-01-18 14:50:22
@_author: Rob van der Hoeven 
@_subject: [tor-talk] transparent tor routers 
The arguments made by Mike and Roger are about users that *need* the
best anonymity. For these users Tor browser and Tails are the safest
The Tor network gives users IP address anonymity but does not
de-anonymise application data that is send over the Tor network. For
some (most?) users this is OK because:
A) The traffic from the exit node they use cannot be monitored by a
party that can harm them because: the adversary has no way to intercept
the traffic from the exit node to the destination, or the connection to
the destination is encrypted (SSL). B) They use Tor to escape censorship. These users use Tor as a simple
I think a large group of (potential) users would benefit from Tor router
hardware. But as always they must be well informed about what anonymity
protection they can expect from a hardware solution. Hardware offering Tor routing is becoming very cheap and I think it's
time to reexamine what we can do with it. If you want to play, here is some hardware I recently bought that can
run Tor firmware:
This $25 router does not have Tor firmware by default. You can download
the Tor firmware from:
Maybe you like my virtual Tor environment. It transparently routes all
TCP and DNS traffic trough the Tor network (guaranteed no leaks).
Currently in alpha and for Linux only (tested on Debian Wheezy)

@_date: 2016-01-18 22:01:43
@_author: Rob van der Hoeven 
@_subject: [tor-talk] transparent tor routers 
Sorry, I do not understand why things are difficult. The Tor daemon has
support for transparent proxying. See:
Besides some extra torrc entries, only a few simple firewall rules are
I can also assure you that Tor works quite well on the router hardware
mentioned above. I'm only playing with the hardware but I have not
encountered any problems yet. Performance is OK too.

@_date: 2016-05-13 13:37:33
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Can the Tor network benefit from client routers? 
Hi folks,
Lately I started running Tor on an OpenWrt router. Moving Tor from your computer(s) to the router can change the
Tor-network landscape. Routers have the most direct Internet connection
and they run 24/7. This opens up the opportunity to donate bandwidth to
the Tor-network, and while a single router can probably donate little
bandwidth there's strength in numbers. I was wondering just how much bandwidth routers running Tor could
potentially donate to the Tor network. Did some research and wrote the
following article about it:

@_date: 2017-12-28 11:19:18
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Tor Transparent Setup 
Your problem might have something to do with the DNS configuration. The
article on the Tor website uses: DNSPort 5353
Unfortunately port 5353 is the standard port for multicast DNS(mDNS)
and thus might already be in use by a program involved with mDNS. You
can check which program is listening on port 5353 with the following
sudo netstat -lup | grep 5353
If this command reports another program than Tor, then change the
DNSport value in both the torrc file and the firewall scripts. I use
9041 as DNSPort. After the changes (and restarts!), run the above
command again to check if DNS is handled by Tor.
Hope this helps,

@_date: 2017-10-25 12:31:04
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor project. 
Hi Folks, 
I'm currently working on a small Linux utility that does single-program transparent proxying. My utility tests if Tor handles all Internet
traffic by requesting an .onion address. If the address gets resolved,
and if a HTTP HEAD request to the resolved address gets a response,
it's assumed that all Internet traffic is routed through Tor. 
I use expyuzz4wqqyqhjn.onion ( as test .onion
address but this address does not seem very stable to me. Getting a
response will frequently take several minutes. Is there an .onion
address available with better (and more stable) response times?
I like to have an .onion address hosted by the Tor project, and not
by a third party.
Kind regards,
Rob van der Hoeven

@_date: 2017-10-25 12:44:00
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
I came across that list, but I really had no idea which of the entries
were stable. My best bet was the Tor project onion, but this onion
turned out to be unstable.

@_date: 2017-10-25 14:36:25
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
Some extra info...
I have also tested with: facebookcorewwwi.onion which gave snappy
response times. Fast (less than 10 seconds) test responses are
important because the connection test is optional. Although the
connection test is performed by default, users are free to skip the

@_date: 2017-10-25 15:07:42
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
My program is supporting Tor clients, not servers. A program started by
my program will have its TCP traffic routed through the Tor network. No
special Tor-configuration needed...
Some examples:
    myprogram firefox     myprogram chromium expyuzz4wqqyqhjn.onion
    myprogram -t w3m expyuzz4wqqyqhjn.onion
    myprogram -t git clone     myprogram bash

@_date: 2017-10-25 15:31:55
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
Correct, but my program uses KERNEL MAGIC! It does not need to inject a
DLL. It's much simpler than torsocks, and I expect it to be compatible
with more (all?) TCP programs.

@_date: 2017-10-25 15:38:01
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
Yep, Facebook is fine for speed, but can block my requests. My program
does not (and cannot) hide itself behind a fake user-agent.

@_date: 2017-10-25 16:16:58
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
That's a good question. I want to know if the Tor network handles all
TCP and DNS traffic. Only the Tor network can resolve an .onion
address, and only the Tor network can reach an .onion address. So, if
both resolve and requesting work, I am quite confident that Tor handles
all TCP traffic.
A DNS requests is cheap, and the test only involves two small ping-pong HTTP messages (both headers). If you compare the bandwidth needed for
the test with the bandwidth used by a targeted program (e.g. Firefox)
you will find it insignificant.
If you really don't like the testing, you can simply change a switch
variable in the program code before compiling.

@_date: 2017-10-25 19:22:18
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
A normal DNS server will not be able to resolve an onion address
My program uses the transparent proxy provided by the Tor daemon which
resolves an onion address to an address in a non routable address
range. 
If the DNS server returns an address outside the VirtualAddrNetworkIPv4
range, I know that something is wrong...

@_date: 2017-10-25 22:42:06
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Does the Tor DNS transparent proxy code use clients 
Hi Folks,
I'm testing a small single-program transproxy program that I wrote (not
released yet). This program forwards DNS requests to the DNSPort of the
Tor daemon. During my tests I noticed something that worries me. 
With my program I can basically redirect network traffic from any
program to the DNSPort/TransPort of the Tor daemon. For fun I tried: 
dig hoevenstein.nl 
To my surprise I got an answer from one of the nameservers in my own
resolv.conf. It looks like the exit node blindly uses the nameserver
from the original request. Can anyone confirm this?
I checked with wireshark, and no DNS queries are leaving my system,
also the query time indicates the request was done using the Tor
Leaking a users nameserver looks dangerous to me.
Can someone shine a light on this?
Here are the result of my experiment:
rob at jessie:~$ aorta -t dig hoevenstein.nl
RUNNING dig hoevenstein.nl
; <<>> DiG 9.10.3-P4-Debian <<>> hoevenstein.nl
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 61683
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;hoevenstein.nl.			IN	A
;; ANSWER SECTION:
hoevenstein.nl.		3600	IN	A	94.211.74
;; Query time: 178 msec
;; SERVER: 89.101.251.228
;; WHEN: Wed Oct 25 21:39:03 CEST 2017
;; MSG SIZE  rcvd: 48
AORTA CLOSED ...
rob at jessie:~$ cat /etc/resolv.conf
# Generated by NetworkManager
search dynamic.ziggo.nl
nameserver 89.101.251.228
nameserver 89.101.251.229
Without using Tor:
rob at jessie:~$ dig hoevenstein.nl
; <<>> DiG 9.10.3-P4-Debian <<>> hoevenstein.nl
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 17152
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;hoevenstein.nl.			IN	A
;; ANSWER SECTION:
hoevenstein.nl.		3600	IN	A	94.211.74
;; Query time: 16 msec
;; SERVER: 89.101.251.228
;; WHEN: Wed Oct 25 21:46:28 CEST 2017
;; MSG SIZE  rcvd: 59

@_date: 2017-10-25 23:01:59
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Does the Tor DNS transparent proxy code use clients 
A good idea, but the Tor daemon expects that all traffic arriving on
torport has been redirected by iptables. It asks IP tables for the
original destination, which is not there when you use dig directly with

@_date: 2017-10-25 23:23:18
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Does the Tor DNS transparent proxy code use clients 
Hmmm, interesting.
If I use dig directly on the DNSPort of the Tor daemon I get the
following results:
rob at jessie:~$ dig  -p 9041 hoevenstein.nl
; <<>> DiG 9.10.3-P4-Debian <<>>  -p 9041 hoevenstein.nl
; (2 servers found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 19551
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;hoevenstein.nl.			IN	A
;; ANSWER SECTION:
hoevenstein.nl.		3600	IN	A	94.211.74
;; Query time: 216 msec
;; SERVER: 127.0.0.1
;; WHEN: Wed Oct 25 23:12:26 CEST 2017
;; MSG SIZE  rcvd: 48
This looks OK. When I check with Wireshark I see no DNS queries leaving
my system. Must think about what this means. Or better, get some sleep.
It's been a long day...

@_date: 2017-10-25 23:47:20
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Does the Tor DNS transparent proxy code use clients 
Well, I think it works differently. What probably happens is that the
nameserver address from resolv.conf never reaches the exit node.
Instead the Tor daemon just remembers the address to use later on in
the reply. So the client never knows that the query was answered by
Tor. Sleepy programmers are fooled by this too ;-)

@_date: 2017-10-26 11:20:40
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
I do not agree. Only a highly privileged *LOCAL* attacker can do the
things you mention unnoticed. In that case no program can protect you,
all hope is lost...
I do not think this will be a problem. Even if an attacker knows that a
user is using my program there's probably little he/she can do. All
that my program does is setting up an environment consisting of a
net_cls cgroup and some iptables rules that forward traffic from
programs within the cgroup to the TransPort and DNSPort of the Tor
daemon. My program does not actively take part in the forwarding,
that's done by *POWERFUL KERNEL MAGIC*. This approach is simple and
much safer than my previous transproxy program AVNE.
Talking about my AVNE program. When I released it I had a discussion
with Yawning. He/she mentioned that its networking code worked much
like Orbot's Android VPN code. Both use a tun interface in combination
with User Space Networking. Maybe the cgroup/iptables method I use in
my program also works on Android. If it does, it can reduce the
complexity and improve the security of Orbot.
I like the controller events idea. It will probably double the code
size of my program but that will be fine *IF* my program becomes
popular. I think it's best to release the program and see if people
like it. Then I can decide. Thank you for your feedback,

@_date: 2017-10-26 12:27:02
@_author: Rob van der Hoeven 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
The last day I have switched back to the torproject onion to
investigate the problem. Unfortunately the problem dit not occur, so I
could not investigate further. Must be a Heisenbug ....

@_date: 2017-10-28 15:39:44
@_author: Rob van der Hoeven 
@_subject: [tor-talk] AORTA - Another Onion Router Transproxy Application 
Hi Folks, I'm proud to announce a new program of mine called AORTA.
AORTA (Another Onion Router Transproxy Application) is a small Linux
utility that transparently routes all TCP and DNS traffic from a
program under its control through the Tor network.
aorta [aorta parameters] [program] [program parameters]
possible (optional) aorta parameters are:
    -t   enable terminal output (for programs like wget, w3m etc.)
    -c   DO NOT CHECK if Tor handles all Internet traffic
    -a   DO NOT CHECK if the targeted program is already active
Note: ONLY use a DO NOT CHECK option if you are *very sure* that the
check is indeed not needed.
    aorta firefox     aorta chromium expyuzz4wqqyqhjn.onion
    aorta -t w3m expyuzz4wqqyqhjn.onion
    aorta -t git clone     aorta bash
Read all about it on my blog:

@_date: 2018-02-02 18:23:04
@_author: Rob van der Hoeven 
@_subject: [tor-talk] AORTA - others tried it? 
Well, the important thing is net_class cgroup support. This support was
*officially* added to Linux kernels >= 3.14
I would like some community response/review too ;-)
TorSocks preloads a DLL that contains all the TCP/DNS functions from
the normal c library. This makes the program use the TorSocks functions
instead of the c library functions. This is the "old" way of
interception and takes place in user space.
AORTA intercepts and redirects TCP/DNS traffic inside kernel space.
What AORTA does is not visible to the program, and also works with
statically linked programs. AORTA is a much more simple program (thanks
to the hard work of the kernel en iptables developers). Except for
programs that clone an already running instance the interception and
redirection of AORTA *should* be guaranteed. NOTE *should* because
AORTA is a new program that has not undergone the same testing that
TorSocks has. Note also that I did test AORTA on different Linux
distributions (Debian, Unbuntu, Mint, Arch Linux) using a wide range of
On my Debian system, programs like Firefox and Chromium do not work
with TorSocks. For AORTA I haven't been able to find a program that
does not work under AORTA. Please let me know if you have a program
that does not work with AORTA.
The test resolves an .onion address and connects to it. This test only
succeeds if DNS and TCP traffic are routed through the Tor network.
Normally this test will always succeed but it can take a long time. For
this I made the test optional (but not by default).
Rob van der Hoeven, 
author of AORTA

@_date: 2018-02-10 10:15:48
@_author: Rob van der Hoeven 
@_subject: [tor-talk] AORTA - others tried it? 
On my Debian system, programs like Firefox and Chromium do not work
This is strange in multiple ways:
First the address. abcd1234abcd1234.onion cannot be a *real* onion
address because onion addresses are supposed to be unreadable :-)
I suspected it to be some kind of test address so i tried to find it in
the Tor source code. No luck. But.... 
I got a telnet reply when i tried to connect to it with AORTA. The
connection was closed immediate after i got the "Escape character is"
With torsocks the address was not resolved and no connection was
About the IPV6 address in your AORTA session. I do not know how you got
this address. AORTA should only resolve to an IPV4 address in the
10.192.0.0/10 range.

@_date: 2018-01-23 11:11:47
@_author: Rob van der Hoeven 
@_subject: [tor-talk] torsocks dont find curl program 
Maybe you can give my AORTA program a try? AORTA does the same job as
TorSocks but makes use of some newer kernel technologies. Because the
network traffic interception is handled in kernel-space, AORTA should
be compatible with more (all?) programs than TorSocks. It is also a
much more simple program.
I wrote the following article about AORTA:
Rob van der Hoeven.
