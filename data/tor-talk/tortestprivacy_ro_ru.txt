
@_date: 2014-01-21 02:53:04
@_author: tortestprivacy tortestprivacy 
@_subject: [tor-talk] Security issue 
I found a security issue in Tor.
With Tor Browser Bundle default settings any web-site can access to local resources by JavaScript and XMLHttpRequest.
For example ANY web-site can scan local ports sending a requests to  and see what port is opened.
For example:   and any other ports.
If some application listen some port it will be able to accept connections and responce to them. If it will be a local web-server any web-site that you visit can view html-pages on it even if all external incoming connections from Internet to this port are disabled by system firewall and only local connections from 127.0.0.1 are allowed.
The decision is turn on ABE (Application Boundaries Enforcer) by default in NoScript Add-On. Now it's disabled by default.
After this any web-site can't get access to  by JavaScript and XMLHttpRequest.
This rule will be added in NoScript by default if you turn on ABE:
# Prevent Internet sites from requesting LAN resources.
Site LOCAL
Accept from LOCAL
If you have default settings of Tor Browser Bundle, ABE is not turned on.
If so you can test what ports are opened on your computer for example here: Regards

@_date: 2014-01-21 08:06:11
@_author: TT Security 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hi Yuri
Maybe you'll be suprised but Firefox by default allow connections to loopback interfaces if there is no disabled rule in firewall settings. NoScript Add-On can solve the problem by ABE.
I have Tor Browser Bundle 3.5 and Firefox 24.2.0 from there. Just open some port on your computer(only for testing) for example local web-server and try with Firefox from Tor Browser Bundle this page:   You will see :) (ABE must be turned off, as by default) TT Security.

@_date: 2014-01-21 08:49:54
@_author: TT Security 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hi Gerardus Hendricks,
I had "digest" option for this mailing list that's why I could see your message in mailing list archive only now. I turned off this "digest" option, so i'll hope to get all in time now.
I don't know :)
Maybe "the same-origin policy" is not for XMLHttpRequest.

@_date: 2014-01-22 01:43:48
@_author: TT Security 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hi ALL,
First of all, i would say i am a practician in the matter of testing.
What we have:
1. OS: Windows (i think all others can be included)
2. App: Tor Browser Bundle 3.5 (Firefox 24.2.0 in it) with default settings
3. Some WWW web-site (not local file:// scheme) it can be ANY other web-site that you visit by Tor
4. This web-site can access to LAN resources by sending query to  and GET THE ANSWER from application that listen to that port! Not matter how it listen on 127.0.0.1 or 0.0.0.0(ALL interfaces). With some conditions:
a.  Application is set to accept connections from loopback interface (127.0.0.1) by system firewall rules. For some firewalls there is no necessity to have allowing rules for that. And any application can LISTEN on 127.0.0.1 without any alerts from system firewall. This is really a potentialy hole!
b. Application decides to answer or not to that query. If it will be a standard web-server it can reject these queries by examination the Origin header. If application don't pay attention to the HTTP headers it will answer to the query. This can reduce the degree of problem but don't exclude it at all. For example it can be a very hidden malware that not detected by antivirus and it will be enable to invisibly communicate with it's "second part" when you visit some web-sites because it doesn't need in allowing rules in system firewall. Unbelievable scenario? :) but it can be! You can test such scenario manually: just create a simple app that listens on 127.0.0.1:7777 or any other port more than 1024, accepts connections and makes a simple answer, you will see this answer on  when you will scan 7777 port.
I think it is better and simple to prohibit access to LAN resources by turning on ABE of NoScript Add-ON by default.
It's worth saying if you set the rules in your system firewall for Tor's Firefox to allow queries only for 9150 and 9151 ports(default settings) this also will close the hole. But if we need for Tor's Firefox connections to loopback interface by default, very often people open ALL ports of loopback interface, not only necessary ports.
TT Security

@_date: 2014-01-22 03:20:34
@_author: TT Security 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hi Yuri,
Mozilla developers don't like such insignificant(from their point of view) :)
Just ask Gijs Kruitbosch there: what would be if some application will send "Access-Control-Allow-Origin: *" in response?
And he will answer to you: this is not the problem of firefox! :)) you'll need control applications on your computer yourself, so if some application will reply with this header Firefox will allow ANY web-site from the global web read the reply and save it on its server :)
This is like Firefox works now! :)
They don't think forward! For example, IE and Opera don't allow acces to LAN resources from global web-sites by default.
TT Security.

@_date: 2014-01-22 03:43:45
@_author: TT Security 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hi Olivier,
Absolutely agree with you!
Just let not treat it as BUG but as some security issue even if only potentially dangerous.
ABE of NoScript can close this issue - simply and quickly. But maybe in the future TBB must prohibit all connections to local LAN resources for global html web-pages. TT Security.

@_date: 2014-01-24 06:27:05
@_author: TT Security 
@_subject: [tor-talk] I don't see any cookies in TBB 3.5 
1. How to see cookies in TBB 3.5?
2. And what are the options:
-Protect new Cookies
-Do not Protect new Cookies
What are they mean?

@_date: 2014-01-24 06:36:58
@_author: TT Security 
@_subject: [tor-talk] Vidalia has been replaced with Tor Launcher 
1. So "Network Map" and "New Identity" are absent now. When these functions will be add to the TBB?
2. Is it still able to set nodes:     in torrc cfg-file?

@_date: 2014-01-24 19:49:07
@_author: TT Security 
@_subject: [tor-talk] I don't see any cookies in TBB 3.5 
Moreover this doesn't work. After change, pressing "Ok" button, and reopening the settings go back to the previous.

@_date: 2014-01-24 20:03:28
@_author: TT Security 
@_subject: [tor-talk] I don't see any cookies in TBB 3.5 
Seems to be BUG...
I don't need cookies next time using Tor's Firefox, after closing they must be deleted with all history but during session they must be shown. In TBB 2.3.25-12 they were shown...
They are not shown but they are saved, otherwise authorization on web-sites wouldn't work.
