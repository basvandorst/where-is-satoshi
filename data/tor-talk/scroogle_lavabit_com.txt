
@_date: 2011-02-13 14:09:56
@_author: scroogle@lavabit.com 
@_subject: Scroogle and Tor 
I've been fighting two different Tor users for a week. Each is
apparently having a good time trying to see how quickly they
can get results from Scroogle searches via Tor exit nodes.
The fastest I've seen is about two per second. Since Tor users
are only two percent of all Scroogle searches, I'm not adverse
to blocking all Tor exits for a while when all else fails.
These two Tor users were rotating their search terms, and one
also switched his user-agent once. You can see why I might be
tempted to throw my "block all Tor" switch on occasion --
sometimes there's no other way to convince the bad guy that
he's not going to succeed.
When a nonprofit such as the Tor Project or Scroogle offers a
public service, the script kiddies should have more respect.
I don't expect everyone to donate to Tor and Scroogle, but I
do expect that no one will steal time and effort from us.
By the way, my "block all Tor" options for my Scroogle servers
use an expanded definition of which IPs are Tor exit nodes.
I pull the blutmagie.de exit node list, or the torproject.org
exit node list (both port 80 and port 443) once per half hour,
alternating between the two sites.
One custom switch I use is a cumulative list from yesterday and
today, all in one list with duplicates purged. The other switch
I created is a moving cumulative list from today plus the
previous six days.
Why do I do this? Well, Tor's DNSEL using "dig" is too much
overhead, compared to searching a sorted list on my servers.
But the available exit node lists from the Tor directory are
strange, to say the least. The list size from blutmagie.de can
be as much as several hundred IPs different than the list from
torproject.org, even within the same one-hour period. Moreover,
they are extremely dynamic. While the current list is usually
around 1100 IPs, the cumulative list from yesterday plus today
is usually about 2600 unique IPs. The list from today plus the
six previous days is anywhere from 4500 to 7500 unique IPs.
I've been watching these numbers for over a year now -- take
my word for it that what I'm describing is a consistent
pattern, not some momentary fluke.
I'm getting to the point where I'm tempted to offer my two
exit node lists (yesterday plus today, and previous six days
plus today) to the public. If I had more confidence in the
lists currently available to the public, I wouldn't be
tempted to do this.

@_date: 2011-02-13 17:06:13
@_author: scroogle@lavabit.com 
@_subject: Scroogle and Tor 
That's the torproject.org bulk list I've been using, alternating with
the blutmagie.de list. When I download the torproject.org list I ask
for exit nodes that can reach one of my servers. I alternate between
asking for port 443 and port 80 on that server.
Difficult, because blutmagie.de and another high-traffic site account for
about 20 percent of my total Tor requests. I have to exempt them from some
of my screening if there's a chance of false positives. I'm already doing
something like what you suggest, after exempting these two sites. It's
normally turned off, but I try this first when I have a problem. I try
other things too before blocking all exit nodes.
Another problem is that search-engine use presents a special challenge.
Often legitimate searchers fire off a few searches in quick succession.
The input box is right there, and they may modify it just slightly and
fire off another search.
An extreme example of this is something I see several times a week
outside of Tor (which is too slow to do this). Someone has a Scroogle
search plugin out there that mimics an instant-search feature for every
keystroke as you key in your search term. This is something Google
introduced last year. But trying to do this on Scroogle is insane.
Even if it works to the user's satisfaction, I consider this extremely
abusive, and I block these IPs for a week as soon as I see it happening.
The reason it's insane is that Scroogle has six servers, while Google
has several hundred thousand servers. I wish these script kiddies would
do the math first!

@_date: 2011-02-14 18:29:45
@_author: scroogle@lavabit.com 
@_subject: Scroogle and Tor 
Some have wondered why anyone would want to abuse Scroogle
using Tor. Apart from some malicious types that may be
doing it for their own amusement, it looks to me like they
are trying to datamine Google -- arguably the largest,
most diverse database on the planet.
If you can manage to run a script 24/7 that datamines
Google, you can monetize your results. Search engine
optimizers would like to be able to do this. So would
various directory builders.
Doing it by scraping google.com directly is not easy.
Scroogle provides 100 links of organic results per
request, with less than one-half the byte-bloat that
Google delivers for the same links and snippets. It is
also much easier to parse Scroogle's simple output page
than it is to parse Google's output page.
I spend a couple hours per day blocking abusers. A huge
amount of this is done through a couple dozen monitoring
programs I've written, but for the most part these
programs provide candidates for blocking only, and
my wetware is needed to make the final determination.
My efforts to counter abuse occasionally cause some
programmers to consider using Tor to get Scroogle's
results. About a year ago I began requiring any and all
Tor searches at Scroogle to use SSL. Using SSL is always
a good idea, but the main reason I did this is that the
SSL requirement discouraged script writers who didn't
know how to add this to their scripts. This policy
helped immensely in cutting back on the abuse I was
seeing from Tor.
Now I'm seeing script writers who have solved the SSL
problem. This leaves me with the user-agent, the search
terms, and as a last resort, blocking Tor exit nodes.
If they vary their search terms and user-agents, it can
take hours to analyze patterns and accurately block them
by returning a blank page. That's the way I prefer to do
it, because I don't like to block Tor exit nodes. Those
who are most sympathetic with what Tor is doing are also
sympathetic with what Scroogle is doing. There's a lot of
collateral damage associated with blocking Tor exit nodes,
and I don't want to alienate the Tor community except as
a last resort.
One reason why Scroogle has lasted for more than six
years is that we are nonprofit, and Google knows by now
that I don't tolerate abuse. My job is to stop the abuser
before Scroogle passes their search terms to Google.
Abusers who use Tor make this more difficult for me.
Blocking an IP address is easy, but blocking Tor abusers
without alienating other Tor users is more complex.
