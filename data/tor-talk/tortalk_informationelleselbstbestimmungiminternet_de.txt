
@_date: 2013-07-06 12:46:17
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
Dear reader,
I?m a Tor user.
My interest in anonymity awoke in response to the European
parliament passing the data retention directive in 2005.  I did (and
still do) not want my ISP to be able to spy on everything I do.
I maintain a German web site explaining how Internet communication
works, warning against data retention, and advertising anonymity via
Tor [1].  I thought that there is not much to lose when using Tor
(except for speed).
Now, I?m about to include a big warning concerning Tor.  Maybe I?m
driven by fear, uncertainty, and doubt.  But I doubt that.  I?d like
to see this e-mail as a consensus check ;)
I?m only talking about Tor users like me, living in a stable
democracy.  In my idealistic (or naive?) view, it?s nobody?s
business to collect data about me as long as I?m not a suspect of
crime.  If they do anyways, they violate my (perceived) rights,
privacy, and dignity.  I?m using Tor as tool to fight that
violation.  (My reasoning does not apply to people under oppressive
regimes who use Tor as protection from their own government when
they coordinate and communicate and whose physical freedom and
well-being are at risk.)
Of course, since Tor?s beginning the threat model has been excluding
global passive adversaries (which are able to observe both ends of
the torified communication) but I didn?t consider that a real issue.
However, now I do.
Today, the GCHQ (GB) is running Tempora to spy on all transatlantic
data, including three days of full storage for deeper analysis.  The
NSA (US) is doing all kinds of spying with PRISM, including rumors
of tapping directly into the German Internet eXchange DE-CIX [2].
The DGSE (French foreign intelligence agency) is spying massively on
the French (so much for *foreign* intelligence).  The BND (German
foreign intelligence) is allowed to monitor up to 20% of
border-crossing Internet traffic; supposedly, they are looking at 5%
right now and investing heavily to increase that number [3].
In 2007 Murdoch and Zieli?ski [4] developed traffic analysis
techniques based on sampled data for parties monitoring Internet
eXchanges (IXes).  Apparently, the parties mentioned above have
capabilities that go far beyond the paper?s sampling technique.
Thus, I?m assuming that global adversaries are spying on me.
As I said, initially I worried about my ISP under data retention and
considered Tor to be an excellent protection.  Of course, that?s
only part of the story as I?d like to restrict who is able to spy on
me as much as possible, whether my ISP, the ordinary criminal, or
our governments?s spies.  Frankly, I only started to think about the
last point after seeing the video ?Enemies of the State? of last
year?s Chaos Communication Congress [5].  There, former NSA
officials complained that the NSA is beating US citizens?
constitutional rights into the dust.  However, the existence of
rights for Non-Americans was not acknowledged, and I wondered how my
expectations should look like given that I?m not protected by the US
Now, Tor re-routes traffic on a world-wide basis.  I believe that
without special precautions (I?m going to write a separate e-mail on
that), my communication with the entry node as well as the exit?s
with the real communication partner will flow through big pipes and
IXes, which are worth the investment of spying facilities; of
course, terrorism needs to be fought ?
Thus, Tor does not anonymize; instead, it turns all my network
traffic over to adversaries.  Hopefully, Tor makes the adversaries?
lives harder, and they need more compute power to spy on me.  Maybe
they find torified traffic more interesting and handle it with
higher priority.  In any case, I assume that torified traffic gets
In contrast, without Tor I?m *not* certain that all my traffic gets
analyzed.  Part of my traffic does not need to flow through big
pipes and IXes but stays in local, untapped regions of the Internet.
Thus, my warning could read as follows:
1. If you are using Tor, you should assume that all your network
traffic gets stored, analyzed, and de-anonymized by intelligence
2. If you do not use Tor, you should be aware that your ISP could
spy on all of your network traffic, while part of it (that part
passing tapped IXes) gets stored and analyzed by intelligence
Of course, there still is more fun in using Tor.
What?s your take on the current situation?  Should the Tor FAQ
include a similar warning?
Best wishes
CBP Crash Islamist Nazi Salmonella Mudslide Illegal immigrants
Blowpipe Narco banners Afghanistan ASPIC FARC illuminati InfoSec
[1]  [2]  [3]  [4]  [5]

@_date: 2013-07-06 14:12:27
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
I don?t worry about the French too much.  I don?t think that the
British need much collaboration, though.
I?ll have a look.  Thanks for the pointers.
Thanks for that reminder.  Some of my browsers don?t do that, but
it?s easy to forget.
However, I wasn?t only thinking about the Web, but also things like
chat and ssh, which I might torify.
I didn?t mean to imply that ?combination? was necessary.
I?m not sure about that.
So do I.
Best wishes

@_date: 2013-07-07 12:04:31
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
Yes, I like those papers.  Yet, I?m confused on at least two levels.
First, the current Tor Path Specification [1] selects nodes based on
DBLP:conf:ccs:EdmanS09 briefly mentions /16 subnets being ?largely
effective, though may not be stringent enough.?  In fact, the more
recent paper on LASTor [2] reports a ?false-negative rate of 57%
with the default Tor client? to detect snooping ASes.
Second, I deliberately considered IXes, not ASes.  From the paper by
Murdoch and Zieli?ski [3]:
?We suggest that existing models, based on Autonomous System (AS)
diversity, do not properly take account of the fact that while, at
the AS level abstraction, a path may have good administrative domain
diversity, physically it could repeatedly pass through the same
Internet eXchange (IX).?
Although the paper by Murdoch and Zieli?ski is cited in
DBLP:conf:ccs:EdmanS09, I fail to see that they address IXes at all.
Best wishes
[1]  [2]  [3]

@_date: 2013-07-07 12:11:26
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
Thanks a lot!
What lightweight defenses are you referring to?

@_date: 2013-07-07 12:14:35
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
I?m not sure about last week, but they announced something for
tomorrow based on an interview that you did with Snowden.
Thanks for the advance notice

@_date: 2013-07-07 18:48:12
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Should I warn against Tor? 
What I?m worrying about is the following:
My encrypted traffic is stored at the tapped IX, say the NSA does
that.  The NSA also observes the traffic from the Tor exit to the US
As pointed out in the FAQ [1], Tor fails now, as they may perform a
correlation analysis to figure out that the connection to the US
server was coming from me.
(As Mike Perry pointed out [2]: The Raccoon showed that such
correlation suffers from the base rate fallacy.  Thus, correlation
might not be as simple as suggested by the FAQ and assumed in
several papers.  He also pointed to other attacks into which I did
not look yet.)
Best wishes
[1]  [2]

@_date: 2013-07-08 22:12:33
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
Thanks a lot for bringing up this topic.  Actually, there is a 2009
paper exploring the IX structure [1].  Their data set is published
at [2].
Being German I restricted EntryNodes to DE and ran traceroutes to
the 3 German guards selected by my Tor client.  Two of those
traceroutes showed IP addresses of DE-CIX (so I don?t want them),
while the third one does not contain any IP address of [2].
I guess I?ll check that out systematically to find ?my? EntryNodes.
When restricting Tor nodes by country, I recommend to update
src/config/geoip first.  E.g., zeller is listed as German node with
Tor v0.2.3.25 (where geoip dates back to May 2012), but lies in
Seattle [3], which can be corrected with a new MaxMind download.
Best wishes
[1]  [2]  [3]

@_date: 2013-07-19 17:35:26
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
[For those who are confused about the context of this: I started the original thread.  A write-up for my motivation is available at [0].]   I found my guard nodes.  Here is a summary of what I did. I started out with a list of 826 Tor nodes located in DE, generated on 2013/07/15 at [1].  Out of these, 232 are named guards, and 78 are named exits.  I analyzed traceroute data both at work and at home.
At work: Only a small number of 25 guards are safe in the sense their paths appear to flow neither through IXPs nor through foreign places.  DE-CIX alone is traversed to reach 179 guards.  However, 4 guards are located in my own Autonomous System (AS).  It seems very attractive to use only those (instead of all 25 candidates).  What do you think?
I?d like to point out that during this week I observed route
changes.  Sometimes, less routes go through DE-CIX, so that up to 39 guards appear to be safe.  Thus, repeated tests are a must.
For Tor exits, traceroute data between me and the exit is less
useful.  Traceroutes between the exits and my communication partners would allow to identify IXPs along that way.  I?m not in the position to obtain that data.  Nevertheless, if I want to anonymize communication that should be local to my country, I?m restricting the exits to those that do not show foreign hops.  I found 58 of those.
At home:
Many guards (126) appear to be safe, only one is located in my own I?d like to share two sample unsafe routes to Tor guards raspitor2 and YanLunYiZou, where IP addresses of intermediate hops and target with their estimated location are shown:
raspitor2 (89.144.24.210): 213.20.59.10;DE ? 195.71.10.242;DE
? 195.71.212.242;DE ? 195.69.145.103;NL (via IXP AMS-IX)
? 193.34.48.162;GB ? 193.34.48.74;GB ? 193.34.48.74;GB
? 185.14.92.22;DE ? 193.24.211.57;DE
? raspitor2 (89.144.24.210);DE (via IXP AMS-IX)
YanLunYiZou (109.69.68.157): 213.20.59.10;DE ? 195.71.10.242;DE
? 195.71.254.93;DE ? 84.16.8.141;ES ? 84.16.14.93;ES
? 212.73.205.225;GB ? 4.69.168.190;US ? 4.69.161.93;US
? 4.69.143.137;US ? 4.69.140.14;US ? 4.69.163.9;US
? 4.69.143.177;US ? 4.69.133.181;US ? 4.69.133.178;US
? 212.162.18.226;GB ? 91.202.40.254;DE
? YanLunYiZou (109.69.68.157);DE
Those are examples of so-called boomerang routes, where source and
target appear to be located in the same country, yet traffic does
impressive sightseeing and receives lots of unwanted attention. Consequently, I?d like to warn against the Tor options to restrict nodes based on country codes.
Finally, at home I found 63 Tor exits that appear to be non-foreign.  The intersection between work and home contains the following 53
routers, which may be useful for German Tor users: 0x3d002, 5268A6ED09875EA2F5, AbelianGrape, Atorisinthesky, BZHack,
Biverse, DaJoker, Datenmuehle, FoeBuD3, HarryTuttle, KOP1,
KiwibirdSuperstar, LookAnotherExit, MagmaSoft, Musashi, NeefEef2,
Piper, Resistance, TommysTorServer, Tor4Freedom, Torboinaz,
TuringComplete, arbitrary, armselig, brotherjacob, chee, devilproxytor, eisler, felixker, filiprem, ftcalip, hamradioboard, hanfisTorRelay, hellinterface, honk, jabla, memyselfandi, neonustor, ppbytor1, randomserver, riqochet, skyplace, smurfix, spdytor1, superblyhidden, supercow12k, tor3aendych, zapit02
Links to my code and a README.txt clarifying necessary prerequisites are available at [0].   Best wishes Jens  [0] [1] [2]

@_date: 2013-07-19 19:03:33
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
I hope that I fixed my ?soft newline? problem.  Sorry about that.
And that is mostly what I?m doing.  How do you find guards across
the ocean?  Among the ?German? guards, YanLunYiZou actually turned
out to be across the ocean and back.  (I didn?t check how many of
those exist.  I picked the first I saw.)
How, actually?  I?m aware that what I?m doing is a departure from
network diversity to obtain anonymity.  I?m excluding what I
consider unsafe based on my current understanding.  It might be that
in the end I?ll be unable to find anything that does not look unsafe
to me.  I don?t know what then.
Best wishes

@_date: 2013-07-19 19:15:15
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] NSA, Tempora, 
satisfactory answer is unknown or kept secret.  I was confused by the answer you gave there and replied:  I may be missing something fundamental and if so I?d appreciate a pointer, but I don?t think that the papers mentioned there help much to figure out what to expect, what to do, or what to recommend in view of Tempora and PRISM. Best wishes Jens

@_date: 2013-07-20 09:02:22
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
Note that in general I go for German entry guards, not for entire Tor paths in Germany.
I hope to find guards ?close? to me with which the communication is not monitored.  Clearly, if the German government is tracking me everywhere in Germany then such guards do not exist, and my approach fails.  In that case, I cannot see technical solutions but only political ones.
(Note that anonymization of communication with German partners fails as both, my communication with the entry and the partner?s with the exit, are monitored within Germany.  Communication with outside partners can also not be anonymized as the Germans? are sharing their data.)
If, as I hope, only major IXPs are monitored in Germany, then the entry guard selection should avoid monitored paths.  That is what I?m trying to do.  If the path to my entry is not monitored, my end of the torified traffic is not observed, thwarting correlation attacks.  Best wishes Jens

@_date: 2013-07-20 09:24:24
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
I don?t buy the entropy argument.  If the NSA compromises Tor nodes, wouldn?t they target as many nodes as possible, regardless of guard selection strategies?
Note that I?m avoiding guards that they can monitor without having compromised them.
What are the implications then?  All metropolitan area customer data of that provider turned over to the NSA?  As I wrote a couple of minutes ago on this list: If that happens everywhere in Germany, I don?t see a technical solution, just political ones.
Exactly.  Citizens there would be driven by other motives than me.
First, they would need to figure out whether they worry more about their own government or about foreign ones.  Then they need to decide whether Tor can help and, if so, what nodes to avoid.
Best wishes Jens

@_date: 2013-07-20 14:31:12
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
Let me expand upon that one.   Actually, I?d like to consider two aspects separately: First, nodes may or may not be compromised. If they are, they should not be used by anyone.  Usually, we don?t know, so we select randomly.  Of course, everybody may have more or less reason to trust individual operators or not?my previous posts are unrelated to such reasoning.   Second, the *path* to a node may or may not be compromised.  Depending on where you live and where you connect to the Internet, different expectations apply.  This is the case I?m talking about.  If I expect a path to be compromised then I don?t want to use entry nodes that must use that path.  I don?t care whether those nodes are compromised or not, they are out of scope.  Note that based on this criterion, I?m probably using different guard nodes when I connect to the from different places.
To sum up: One-size-fits-all is not the best approach for node
So far, I?ve been arguing from a German perspective.  Let?s change
Assume that you live under an oppressive regime that monitors
everything in your own country, and you use Tor to anonymize your
communication.  You must make sure that you always communicate via
foreign servers with your compatriots; otherwise, both ends of the
torified traffic are monitored in your country, and Tor fails.
You cannot avoid that your communication with your entry guard is
stored and analyzed.  Now, if Tor?s standard path selection ever
chooses an exit node in your own country then also the exit?s
communication is stored and analyzed, and Tor fails.  Thus, you must
avoid national exits.  And you must avoid foreign exits with boomerang
routes into your own country.  (It?s less obvious whether you should
avoid national guards.  Although those are monitored in your country
they offer protection against foreign adversaries if you care about
Finally, if you did not do so already ;) please re-read the previous
paragraph and pretend that I wrote ?democratic government? instead of
?oppressive regime.?
One-size-fits-all is not the best approach for node selection.
Best wishes

@_date: 2013-07-22 14:05:09
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] NSA, Tempora, 
"Sun, 21 Jul 2013 13:06:31 +0200")
What 5 points do you think of?
Best wishes

@_date: 2015-06-01 20:46:08
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Browsers with Tor on Android? 
Many thanks for that effort, great news.
I opened new issues and will try to keep track of the progress.  Let
me know if you need specific help.
Best wishes

@_date: 2015-05-19 22:33:08
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Firefox with Tor on Android? 
Hi there,
the usage instructions for Tor on Android at
are unsafe for Firefox users.
Firefox on Android downloads favicons without respecting proxy
preferences.  See here:
Hence, manual proxy configuration of Firefox (via about:config or
add-ons such as Proxy Mobile) fails to tunnel browser traffic
through Tor: The bulk of the traffic goes through Tor but Android
issues GET requests for favicons with the real IP address.
(I tried different configurations of Orbot and Firefox.  Also ?Tor
Everything? fails, both with HTTP proxy at port 8118 and SOCKS proxy
at 9050.)
As a side remark: The favicon code seems to cache the image.  So, if
you aim to reproduce this issue and try to capture unanonymized GET
requests on the wire, be sure to visit web pages from previously
unseen domains.  E.g., different languages of wikipedia.org such as
 might be suitable.
My current attempt for Firefox with Orbot is to configure localhost,
port 8118 as system HTTP proxy (long press Wi-Fi connection ->
Modify network -> Show advances options).  Then, in Firefox verify
via about:config that network.proxy.type is set to 5, which should
be the default and lets Firefox use the system proxy, which is also
used to fetch favicons.
Probably, there are more pitfalls.  Any suggestions?
Best wishes

@_date: 2015-05-20 21:44:30
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Firefox with Tor on Android? 
Hi Nathan,
many thanks for your quick reply!
Some big warning signs might be a good idea.  In particular, on
pages like this:
Great post, many thanks for the reminder!
Android 4.2.2.  I tried Orbot 15.0.0-RC-3 and 14.1.4-PIE.
Initially, I didn?t because the warning said that ?it should NOT be
used for anonymity.?
I just tried that with 15.0.0-RC-3, but failed to get VPN working.
If I klick ?Apps? first, and start Tor afterwards, no circuit gets
built.  In the log I repeatedly see ?The connection to the SOCKS5
proxy server at 127.0.0.1:10720 just failed.?
If I start Tor first, and klick Apps afterwards, I cannot open any
web page.  (Very little data transfer is shown for OrbotVPN, some
packets for each web attempt.  The Orbot logs show some circuits but
?Tried for 120 seconds to get a connection to [scrubbed]...?)
I guess that I need ?Request Root Access.?  Other options?
Firefox without proxy configuration?
I?m surprised that you recommend Orweb.  There is a big red warning
at: I?ll check out Lightning Browser at some later point in time.
Best wishes

@_date: 2015-05-22 19:14:59
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Firefox with Tor on Android? 
I did that, but without success.
The logs show something like the following:
WARN The connection to the SOCKS5 proxy server at 127.0.0.1:10853
just failed. Make sure that the proxy server is up and running.
The mentioned socks port is open, in addition to 9050.
Port 9050 is an IPv4 socket, while 10853 is an IPv6 one.
When I capture the traffic, on the loopback interface I see that SYN
packets to 127.0.0.1:10853 are immediately answered by RST.
Indeed, with telnet I can connect to port 10853 on ::1, but not on
127.0.0.1 (connection refused).
Frankly, this is entirely new to me.  On my GNU/Linux PC such a
different handling of ::1 and 127.0.0.1 is not visible to me.
If I?m not mistaken, either the proxy should bind to 127.0.0.1 or
Socks5Proxy in torrc.custom needs ::1.
Best wishes

@_date: 2015-05-23 15:18:27
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Firefox with Tor on Android? 
I don?t see anything specific to android in that article.
Acts like CALEA probably exist in every country.
Regardless of the OS, it?s best to avoid centralized services.
And to make sure they only get to see encrypted data.
Best wishes

@_date: 2015-05-23 15:33:15
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Firefox with Tor on Android? 
My Android phone does not contain Google Play.  I prefer free
software: In addition to the NSA, Mike Perry?s post mentioned earlier in this
thread points to built-in backdoors:
While I?m using vulnerable software on vulnerable hardware, I still
want Tor to carry all my browser traffic when I choose so.
As I found out, that?s not as easy as it is supposed to be.
I see Tor as a tool against illegal mass surveillance and profiling,
not against targeted attacks and espionage.
Best wishes

@_date: 2015-05-25 15:06:29
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Thou shalt not use mobile phones (was: Firefox with Tor 
"Sat, 23 May 2015 21:54:50 -0600")
As this discussion has drifted away from the original topic, I
changed the subject.
I believe that the above warning against Android should really be
understood as warning against mobile phones in general: Phones are
powerful surveillance devices, easily exploitable by third parties.
I don?t think that Android phones are worse than other smartphones
in this respect.  Please correct me if I?m wrong.
As a matter of fact, people use smartphones anyways.  Some readers
here might say that smartphone users are doomed beyond help.
I don?t agree.
People may try to protect themselves (1) against targeted attacks
and targeted espionage or (2) against mass surveillance.  Both
assume different threat models, yet frequently both are mixed up,
which does not help.  I agree that I?m doomed if I attempt (1) on my
smartphone.  In fact, I don?t think that many people are skilled
enough to protect any kind of device with Internet connection
against targeted attacks.  Thinking of Stuxnet, I don?t believe that
there are many devices which can be protected against targeted
attacks at all (regardless of network connections).
Now, if we mix up cases (1) and (2) it is easy to conclude that
there is nothing one can do anyways.  Resistance appears futile, so
it?s reasonable to resign and submit to the destruction of our
privacy.  It?s the convenient, lazy route, apparently justified by
expert advice.
So, let?s consider both cases separately.  Let?s forget about (1).
We are left with (2), mass surveillance, which as the name suggests
affects the masses and should be everybody?s concern.  Mass
surveillance is based on bulk data collection, where it?s easy to
see who communicates where and when with whom, potentially about
what.  I hope that Tor is a useful tool against mass surveillance.
It?s probably safe to say that with Tor it is not ?easy? any more to
see who communicates where and when with whom.  Tor users do not
offer this information voluntarily, they resist actively.
And it does not matter on what devices people use Tor.  Mass
surveillance becomes harder in any case.
So, please, be careful whom you warn how against the use of mobile
phones.  Too many people are indifferent to mass surveillance
already.  Do not join the chorus to mislead the masses in believing
that resistance is futile.
You may suggest to throw away mobile phones, of course.  I would not
expect more than disbelieve, shock, or laughter in response.
Alternatively, you may want to explain other measures?which also
work on phones: Use decentralized services, use alternative search
engines, encrypt communication, anonymize communication.
Best wishes

@_date: 2015-05-31 18:45:34
@_author: Jens Lechtenboerger 
@_subject: [tor-talk] Browsers with Tor on Android? (was: Firefox with Tor on 
============================== START ==============================
 (Jens Lechtenboerger's message of "Wed, 20 May 2015 21:44:30 +0200")
That is unusable for me.
1. It is based on WebView, which is vulnerable on my phone:
2. On my phone it sends pretty unique x-wap-profile headers:
Best wishes
