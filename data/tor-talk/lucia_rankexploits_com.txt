
@_date: 2013-04-18 16:58:38
@_author: Lucia Liljegren 
@_subject: [tor-talk] CloudFlare 
I use Cloudflare. When I experience hacking, spamming scraping or any other cpu sucking activity, I use Cloudflares API and ban the IP then unban 7 days later.  If the IP falls in a pre-identified 'dirty' range, I never unban it.  Based on my logs I had the distinct impression Cloudflare did not block TOR. So, I wrote Cloudflare. Their response was:
Justin (CloudFlare Support)
Apr 18 02:24 pm (PDT)
Hi, and thanks for contacting us today.
We don't have a particular position on TOR. All IPs are treated the same -- so if suspicious activity was seen from an IP that happens to be a TOR exit node then it'll be challenged by our system before it can access a CloudFlare page. This is no different than any other IP that might be doing something suspicious though. We haven't considered a particular feature to bloc TOR access, but I can pass on the feedback internally.
As you can see: Not only do they not specifically block TOR, they don't have a feature that to facilitate users blocking TOR.
Coffee shops are a bit difficult to block specifically, but why do you think people who block TOR don't block Romania?  I'm a hobby blogger. I don't block all of RO, but  I block rdsnet.ro, fiberlink.ro  and a number of other Romanian ranges.

@_date: 2013-04-18 22:50:21
@_author: Lucia Liljegren 
@_subject: [tor-talk] CloudFlare 
The IP wont' eventually be pulled if it's on rdsnet.ro. ;)  In any case, I'm not asking what you would do. I'm telling you what I do. I keep lists of IP ranges whose individual IPs will be permabanned if they fall in that range. I will continue this practice at my hobby sites where I pay for hosting even if you or someone else 'minds the approach'.  My opinion is you can implement your policy at sites you pay for and run. I implement mine at sites I pay for and run.
In fact there seem to be plenty of IPs that do not get pulled at the source as a result of hacking, cracking, scraping, trolling or other behaviors someone running a blog or forum might consider ban worthy.
Believe it or not, some anonymizing services who do not take bribes from Russian officials also do not monitor their users and appear to take absolutely no steps prevent those who try to hack, spam, scrape or fingerprint from using their service.  Can you imagine that?!
Admittedly, the way some of these services work, a specific person scraping, hacking or spamming might have to cycle through a different IP every 10 minutes, but if they are persistent scrapers,  they may very well come back on one they used before. There is no guarantee that IP will ever be pulled at the source. In fact, if someone were to complain to the ISP, the person running an exit node might defend the connections on the basis that it's just a TOR node exit, it's not him he has no control over what goes out and basically, it's not his problem. If the ISP is TOR friendly, they may accept that and not pull the IP. An IP that has been observed hacking, scraping, spamming and it doesn't get pulled eventually. Can you even imagine such a thing?!?!
TOR aside, I think you are being naive about what happens with particular IPs. Some companies make sell cheap shared hosting; that's their business. It's a perfectly legitimate one.  Once such service might have server used by  numerous accounts all associated with a particular ip, say 123.123.123.123. A person on one of those accounts could load up a script that permits them to spam, scrape, hack, fingerprint, or set up an open proxy that others could use to spam, scrape, hack, finger print or do whatever they prefer. This person would operate a while before complaints rolled in. Then they might get kicked off and move to another company with cheap shared hosting.  Now in principle, 123.123.123.123 is clean. Hurray!
Unfortunately, the company's business still provides cheap shared hosting.  If the hosting company succeeds in keeping other undesirables off, my blog will see zero traffic from that site.   But given their business model, likely as not someone who got kicked off from some other cheap hosting company will sign up and that undesirable person who gets one will load up a script and start hacking, scraping, fingerprinting or setting up an open proxy.   Since the IP is associated with a server whose intended service is to serve pages, not visit other pages, when that IP visits my blog, it's generally going to be traffic I find undesirable.  Also some dedicated servers provide hosting to scrapers of various sorts. These include seo companies, copyright companies, reputation protection companies and all sorts of other businesses that make a living scraping. Many of those hosts will not cancel a customer account for scraping.  There really is no reason to believe that such IPs will be pulled at the source.  If one wishes to avoid incurring high costs to help these scrapers carry out their business model, one has to ban them.
 If the IP is at a colo facility, a dedicated or cheap hosting service, the most practical thing for a one person hobby blogger to do is ban that IP permanently.  As far as I can see, there is very little lost banning these IPs indefinitely. For example, a year or so ago I tested an English language based
Brazil? Blocking IPs from Brazil may seem unfathomable to you. It's not unfathomable to me!  I've blocked the entire country of Brazil from time to time using Cloudflares convenient system that lets me block countries. It took a while to find which of the ranges were the really bad ones, once I did, I blocked those and let the rest of Brazil in.
With respect to your issue with the dating service:  Brazil is hard to deal with, contains many dirty scraper, googlebot spoofing ranges. If TOR floats to Brazil, it's likely to hit a range I regularly ban and I wouldn't be at all surprised if some businesses ban the same range. If you were a customer with a paying account and they cancelled you for reasons that were not stated in the contract, you should request a refund. If you forked over money with no contract: more fool you.  Assuming they did have a contract, when you ask for a refund, they might point to their policy and tell you which policy you violated or refund your money. That seems like a straightforward business issue that could be resolved by discussing the matter with them. If this was a free dating service, it seems to me you have no recourse. On the other hand, you also haven't been injured. Just find another service.  No these sites aren't *required* to respect that. They are businesses involved in helping people find dates. They haven't represented themselves as services who will prevent your landlord or employer from snooping on you or trying to learn how many kids you want.
In the dating business, dating sites put  parties in contact. These businesses have a perfect right and  possibly a fiduciary responsibility to balance the concerns of some customers who might be concerned about their physical safety if their date turns out to be  'The Craigslist Killer',  a con artist after their money  or just married against the desire of another customer who wishes to conceal the fact they are wasting company time visiting dating sites from their employer.    When weighing the needs, desires of rights of paying customers, or deciding what sort of service to provide, the owner and operator of a dating site also has a perfect right to balance any financial lose associated with losing customers who will only join if they can use TOR against those who won't join the service if the dating company permits potential dates to be totally anonymous and untraceable.  (FWIW: I would suggest that if you are concerned your employer's snooping might reveal your visiting a data site using company time or resources that you refrain from visiting dating sites during company time. )
Or maybe what they should do is block TOR entirely so they can improve the odds of tracing a customer if another one turns up sliced and diced after a date arranged on the dating service?  The dating service is a dating service. If the features they offer don't satisfy your requirements seek another one.  If that service isn't TOR friendly, you should certainly share that information with others who want to find a TOR friendly service. But many people won't care, and a dating business isn't required to provide that feature. (Restaurants aren't required to provide tiramisu on their desert menu's either.  If they don't tiramisu loving diners will eat elsewhere, but so be it.)

@_date: 2013-04-19 13:35:49
@_author: Lucia Liljegren 
@_subject: [tor-talk]  CloudFlare   Ciprian Dorin Craciun 
Ciprian Dorin Craciun Ciprian Dorin Craciun Because they have an international appeal Facebook, YouTube and other large international services likely try to find fine grained ways to distinguish between hackers, spammers, defacers and so on. But small hobby English language forums using CMS's like simple machines or some such, or bloggers using self hosted wordpress systems discussing knitting or gardening generally find that IPs from rdsnet.ro, fiberlink.ro, and yes, TOR are disproportionately spammers, hackers and such like. The reason for this is that  99.99999...% of Romanian knitters and gardeners will prefer to visit Romanian language knitting and gardening sites. They mostly aren't interested in English language knitting sites. (Not that they couldn't be, but mostly they go elsewhere.)
The consequence is if you look at the conditional probability given the knowledge that the site hit is an english language site about knitting, the probability that the connection from rdsnet.ro is spammy, cracky or scrapy is very high. In contrast, if the site were a romanian language site, the probability that a connection from rdsnet.ro was spammy, cracky or scrapey would be low.  A similar issue arises with Tor. Some forum admins find the vast majority of requests from Tor IPs are spammy, cracky or scrapey; others will find the majority of Tor user are people who have other not necessarily illegitimate reason to conceal their IP addresses. These connections can be dealt with in a variety of ways, but blocking rdsnet.ro, fiberlink.ro, and yes, TOR can simplify things for a hobbiest who just wants to get on with discussing the relative merits of "k2tog" vs "ssk" decreases when knitting a hat and not be bombarded with traffic attempting to submit links to porn sites or hack into the site and take over the server. Blocking rdsnet.ro isn't sufficient to protecting the site, but it does reduce the server load and provides some relief from difficulties that currently present themselves.
Similar balancing acts are made when a site operator elects to block by IP, user agent, domain, Tor use, referrer or any feature of the request.

@_date: 2013-04-19 14:03:51
@_author: Lucia Liljegren 
@_subject: [tor-talk] CloudFlare  grarpamp 
Reply to:
This was precisely my point. It also shows why you were utterly incorrect to suggest that
(Date: Thu, 18 Apr 2013 19:39:42 -0400 From: grarpamp (grarpamp at gmail.com) To: tor-talk at lists.torproject.org Subject: Re: [tor-talk] CloudFlare) The reality-- as it appears you full well know-- is that some services advertise their willingness to permit people continued access to IPs to make any requests they please even if their requests bother me the owner of the resource they wish to access.
You can fight for the services all you wish. It's even fine with me if they exist. But if ranges which carry a lot of spamming/crackacking/scraping exist, then  those who on the receiving end of those unwelcome attackes and who can easily identify these ranges dominated by that sort of requests are going to block those ranges.  The alternative is to have a server hammered so it crashes under the load. Or for hobbiest, if those ranges remain unblocked the server costs would be so high they cannot run their own blog to discuss things with their own readers. Can anyone imagine a world where small time bloggers and mom and pop stores can run their sites without their servers bogging down under the groaning load of scrape bots, hack bots and spam bots hammering day in and out?
warfare between businesses :)
I thought we were also discussing a) Cloudflare's policy toward blocking Tor.
b) End users blocking Tor  c) Reasons why they  might block TOR and d) Reasons why one might IP block permanently.
Specifically, I thought I was engaging your comment that you would not ban an IP permanently and your theory why one ought not to ban them permanently.
You brought up your sad tale about the unnamed dating service canceling your service for some reason you find unfathomable. I speculated that you had, indeed, used a dirty IP range. But evidently, you didn't enquire the reason for the block and moved on. So we don't know.
With regard to that incident, you claim and no 'for cause' behavior existed
We have to take your word for everything in your claim because (a) we don't know the name of the dating service so we can't look up their TOS and (b) other than connecting from a Tor IP in Brazil, we don't know what you else might have posted or done.  Moreover, we don't even know if they banned you for using TOR. You don't even know why they banned you.  For all we know you wrote something you think is inoffensive but another customer found offensive. You are free to disagree. But I think just as no one owes you free access to their living room, or free pancakes in their restaurant, no one owes you free access to their services.
to the point of being expected and necessary
Restaurants, gas stations, bookstores and libraries area also part of society and provide services. As far as I am concerned, those that do not give you free pancakes, gas, books or permit you to check out library books with no identification are not doing you any injury.  They have a right to do this even if you wish they would behave differently. The place where you are going wrong is not understanding *who* gets to decide on what constitutes individual cause for being blocked.  In any case, if you think the world needs a dating service that permits https access using TOR, you are likely free to start one, market it and carry the costs and liabilities associated with the service. If it's popular, you will profit. Are we reaching such a point? I'm under the impression we are nowhere near there and I sure hope we never will get there.  I would suggest that most privately held services should be free to block all of California for any reason they wish  Amazon.com blocks people living in states with certain types of salestax laws from joining the affiliate program; I got dropped for that reason.  I think Amazon.com should be free to do this if they wish. I thought you said our conversation was not about "warfare between businesses :)" Yet, here you are bringing it up again.  If a business makes a business decision permissible within the law, they will either gain or lose customers and profits as a result of their business model. As far as I am aware, blocking California, closing on Sunday, being open only 8 hours a day, serving breakfast items only between 4 am and 10 am or blocking TOR are allowed.  It's true that some people might write a poor review complaining of this particular business policy. Business owners are likely to bear that in mind when making these policies.
I didn't say you should trust them not to snoop. In fact, I would strongly advise against it. Depending on your employer, they may be legally required to keep some records, and those records could be divulged under a supoena under FOIA or any number of other ways.I said if you don't want your employer to know you are visiting dating sites while at work you could consider not visiting dating sites at work. Whatever you chose to do, your desire to mask your activities from your employer does not create an obligation on the part of the dating site to provide you https services or permit TOR. The dating service can provide the services it sees fit and you can chose to become their customers or not. They can also refuse you access to their service within the constraints permitted by law. Your grousing about a need for privacy doesn't take away their right to make their own business decisions. One of the things "we" as "individuals" know is that if someone you've never met in person and who no one you know has ever met makes themselves untraceable, they might be risky dating material. (Or at least "I" singular as an "individual" singular know this.)
I didn't say the dating company that blocks TOR is *making a claim*. However, it seems the one that banned your account might be operating in a way that leaves some bread crumbs that police might follow in the event of a horrible tragedy.  You may not like this but other users might find it an attractive feature. To be truthful, if I were dating, I would prefer the dating service to block Tor.  I would prefer an American dating service to block proxy connections from Brazil. I would want them to take payment in the form of traceable credit cards. I don't take that behavior as making any claim of full safety nor do I take it as guaranteeing safety. But the fact that a potential date is not untraceable in the event of a tragedy provides an element of security to a single woman in the dating world.  Likely men too. No one is suggesting any such thing. Resorting to overblown hyperbole-by-metaphor does not constitute making a convincing argument for whatever point you are trying to make about the importance of privacy.  Blocking TOR or IP ranges that have previously hacked scraped or spammed is not like having police protectors on every block  nor is it like hiring one's own security force. It's more like not permitting a four big tough looking guys wearing ski masks to enter the isolated quicky-mart at midnight in July. Or maybe like having security cameras. Or maybe something in between. I've never said you should not be allowed to do so. I'm ok with your using TOR. But you've been complaining that people block by IP which as far as I can tell does nothing more than inconvenience you. I'm explaining to you why other people might block by IP and include TOR in those blocks.  I think you should be free to manage your own affairs and use Tor assuming those inconvenience that might arise as a result of your choices. I think bloggers, web site owners and service providers should be equally free to decide to protect themselves from floods of bruteforce attacks on wp-login.php , swarms of scrapers making 10 requests a second  preventing their server logs from filling up with requests for plugin vulnerabilities or RFI attack/SQL injection attacks. IP blocks are a tool that can greatly reduce the bombardment. It can't be used alone, but it is somewhat effective.   If they happen to block you on TOR, that's a risk some are willing to take. As they have no obligation whatsoever toward you, you may be annoyed, but you aren't being injured any more than if you were not served pancakes at the IHOP simply because you requested the restaurant accept payment by check without requiring a valid ID. It's fine to insinuate the reason you aren't being served the internet equivalent of pancakes you feel you deserve is that the restaurant owner is trying to keep mere spam out of the tiramisu. But your misunderstanding or misrepresenting the very real issues that causing people to ban by IP isn't going to persuade anyone to stop doing it. It isn't going to make them feel remotely stupid for blocking by IP or blocking Tor.  You can yap about your need or right for privacy all you want. But those services that are trying to protect against RFI attacks or falling prey to zero day vulnerabilities are going to ban by IP focusing on IPs in ranges that are attractive to those who wish to do these things and which have been used to do these things. Until better ways exist, that's going to include blocking TOR.

@_date: 2013-04-19 21:01:34
@_author: Lucia Liljegren 
@_subject: [tor-talk]  CloudFlare 
grarpamp at gmail.com I reply to the digest which contains the subject "grarpamp at gmail.com "  I clicked "reply" but recongizing that's not a useful title, I cut and paste a relevant subject.  All additional dethreading is caused by the mail server.    I noticed this dethreads so I posted the name in the subject because I noticed the dethreading and I also figure it's likely no one else is interested in this topic and so might wish to skip over it.   It is not meant as antagonistic toward anyone but the opposite: to warn those uninterested that they might not wish to read the exchange. You are not required to reply if you don't wish to do so. However, if you do wish to reply, feel free to provide guidance on how to not dethread when one is responding to digests. I have no idea how to accomplish that.
Sat Apr 20 00:45:51 UTC 2013

@_date: 2013-04-19 21:09:31
@_author: Lucia Liljegren 
@_subject: [tor-talk] CloudFlare (grarpamp) 
First: I apologize for any dethreading that might occur. I cut and pasted the title from the digest.  As I said: If you can explain how to avoid dethreading, I'd welcome the information. In the meantime, I am going to cut and paste the heading from the digest as this retains information relevant to the threading so the person who asked a question can be aware that I answered it. Second: Yes, I  do see those codes passed in $_SERVER["HTTP_CF_IPCOUNTRY"]. from time to time they contain A1, A2, O1 or XX.

@_date: 2013-04-21 12:24:07
@_author: Lucia Liljegren 
@_subject: [tor-talk]  CloudFlare 
I know what XX is used for. That's why I added it to your lists. I thought you would want to know that.
Cloudflare can block for two reasons:
1) Cloudflare itself diagnoses that a particular request should be blocked. This could happen because the IP doesn't pass some virus checks or because the IP is diagnosed dirty due to past history. (For example: Having a high number of spam counts at project honeypot will get an IP blocked.)  The user can request that Cloudflare use a 'strict' or 'lenient' setting on these tests.
2) The user specifically requests a block.
My understanding is that if a sufficient number of users block a particular IP, Cloudflare uses that data as part of their criteria under (1). These means that, potentially, a Tor IP can become blocked at Cloudflare if a sufficient number of users block it after a Tor IP tries to hack into their site. Cloudflare doesn't know it's Tor. It only knows the IP is banned by many individuals. I happen to like that feature and consider this a good reason to block an IP even if no one using that IP has tried to hack *my* site yet. With regard to (1) Cloudflare  permits A1 country codes through Cloudflare.  So that is not the reason Tor is banned.  With regard to (2), I'm not sure that A1 is blockable by the user. Many anonymizers pass country codes anyway (e.g. SE) anyway. A user could block Sweden.  I currently block China at Cloudflare. It's the only country I currently block. The only other countries I recollect ever blocking are... .. Brazil and Israel. I am not making this up merely because you were blocked for using an IP from Brazil.
I no longer block Brazil or Israel because I solved the problem of incessant hammering by identifying the IP ranges that cause me grief and block those specifically.  But I don't think I can block A1, A2, O1 or XX at Cloudflare. If I can, I don't know what to type to block those.  I do read these and have always blocked them from wp-login.php. Those that try to hack into wp-login.php are subsequently banned at Cloudflare. (I block lots of things from wp-login.php)   For what it's worth: When a user blocks a country, cloudflare presents a captcha. If the user passes the captcha, cloudflare lets them pass. I don't know what happens if a connection is blocked because they appear to be a threat but I think Cloudflare may present the Captcha. Cloudflare passes information that permits me to detect a user passed a captcha or more specifically that the user did not pass the virus scan. If I see they did not pass the virus scan, I block them and tell them they are not allowed to visit until they fix their browser. If you want to know more, you could ask Cloudflare. They tend to be very willing to answer anything.

@_date: 2013-04-21 15:06:01
@_author: Lucia Liljegren 
@_subject: [tor-talk] CloudFlare 
With respect to:
grarpamp grarpamp at gmail.com Sun Apr 21 13:05:11 UTC 2013
I'm sure you think you somehow speak the truth about something, But I you are very confused about what people who run servers are permitted to do. They are permitted to block by IP for any reason they see fit even if you grarpamp think their reasons are mere whim. In fact, they are permitted to block IPs even if their reasons are mere whims. This is a simple fact. Not only that: it is the only equitable situation. There are two sides of any request: Those who make requests should not be forced to accept downloads or connections they did not request; those with servers who receive requests are not required to fulfill them.  This unwilling to change in the foreseeable future. If you are unaware of this fact, you might want to read up a bit. I think you are also uninformed about what sorts of requests people on servers see hitting them from Tor or other anonymous services. However, it seems like you are frustrated by their behavior and wish to persuade them to change it.  If you wish services who currently ban by  IPs in ways that often affect your ability to access using TOR  to work with you to change that, you will need to get out of your little bubble and understand things from their point of view. You need to be aware of what sort of connections people see out in the wild. You need to have data that I suspect Tor cannot collect without violating the privacy of the connections. For example: You need to collect requests and determine the fraction that are involved in brute force log in attempts, the fraction involved in spamming and so on. (That large amounts are involved in spamming is easily determined by entering IPs of mature Tor exit nodes at StopForumSpam which logs complaints.)
You need to collect this data and look at it straight on because your being unwilling to look at facts on the ground isn't going to blind other people to these facts.
Telling others what you would do (or even do do) with your server is irrelevant to them.  When I, Craigslist, YouTube, or Pinterest are  deciding whether to block by IP, we are unlikely give a hoot what *you* would do if you ran our server.   I know I don't care.
You are also inferring accusations where there are none.  *You* brought up that example of wishing to visit dating sites while at work as a reason to use Tor.  I have neither said nor implied you are violating any company rules or doing anything unethical by visiting dating sites on your companies server. I have only said that the fact that you do so but wish to keep this information concealed from your employer does not create an obligation on the part of any third party to facilitate your ability to keep the information concealed from your employer. This is a simple fact and does not insinuate any sort of unethical behavior on your or any one else's part. If you don't want people to point out that your reason for using Tor is and should be irrelevant to the operators of sites you visit, don't bring up that particular example.  Otherwise? Go ahead. Get pugnacious. Stand up on your hindlegs. Play whatever rhetorical game you want to play. But it's just silly to suggest  someone is insinuating something nefarious on your part when they merely engage the example you introduced and point out  that your example does not constitute a good reason to permit Tor connections.  I'm mostly not going to bother with the rest.  But if anyone on the Tor project thinks you or they can convince those block by IP that they should not do so you are going to need to better inform yourselves about concerns of others.  It is a simple empirical fact that IPs  become listed at places like Project HoneyPot, StopForumSpam, various block lists and  so on; the IPs  achieve that status by permitting bad behavior over their lines.  Tor IPs frequently get listed on those services.  When they do, those IPs get blocked by those who use them.  With respect to blocking Tor: I feel absolutely no guilt blocking a Tor exit node. Any *person* whose Tor IP is blocked can deactivate and Tor and connect normally. If their new IP is clean they can participate on exactly the same basis as anyone else. Complain all you want, but to the extent that Tor is used by hackers, scammers, scrapers and comment spammers, that behavior will be detected and people will block Tor either directly or after the IP is listed on a block list. VPN or service provider ranges that  do not cancel accounts that permit spamming, scraping, and hacking will be blocked by people running servers; often those blocks will be permanent.  This means that many Tor friendly ranges will be blocked permanently by some web sites. If you don't like that: too darn bad.
Those IPs will get blocked by people who have come to believe that requests from IPs listed on block lists are disproportionately not worthy of their time or resources.   I happen to think the people implementing the bans are justified. You don't? Ok. But if you are banned from Craigslist, a dating site or pretty much anywhere you get zero sympathy from me. None.   Put on your big boy pants and learn that the world doesn't need to give you want you want merely because you want it.

@_date: 2013-08-26 07:23:20
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] Discrimination of Tor Traffic 
I can't speak for Google. But if you really want to know why some services
and websites block Tor, you should ask the people who block Tor instead of
asking the people who not only don't block Tor but are violently opposed
to Tor being blocked.  You can find people who do block tor on the thread
linked below:
Read the thread and then ask people on that forum why they block Tor.
Warning: I suspect you probably can't log in or comment at that site using

@_date: 2013-08-30 07:18:57
@_author: lucia 
@_subject: [tor-talk] Many more Tor users in the past week? 
WRT: "May be a botnet is using Tor?"
Read the thread at
  The title
"Anyone else get hit by TOR-cloaked(?) botnet?"
Bot with Tor addresses hitting sites and attempting SQL injection have
been seen. I don't know how widespread it is.

@_date: 2013-08-30 10:10:47
@_author: lucia 
@_subject: [tor-talk] Many more Tor users in the past week? 
Probably yes. But if you weren't visiting with Tor, there is a good chance
you would not see the 503 message. Loads fine for me. ;)
Spambotsecurity.com is Zaphod's site. He write ZBBlock which blocks any
connection that violates certain 'rules'. (SQL injection patterns and so
on.) It also has two switches that permits tor blocking with TOR IPs being
'rule' violations if that is turned on. (One switch only blocks posting
from TOR. The other bans all connections.)
A first violation by an IP within 1 hour sees a 403 page with an
explanation. 503's are shown after a number of violations by the same IP.
The default is 3 violations but certain rule violations result in
'instabann' which means they are served 503's after the first visit. I
think that's what Zap uses. The 503 page is shown for 1 day, afterwards,
it reverts to 403-- for 3 more violations by that IP or for a violation
that merited an instaban. If visits from that IP recurr ZBBlock swtiches
back to 503. (The 503 page saves the server cpu because it's just a quick
local look up for that IP.)
So if you saw the 503 address, the IP you connected with had visited and
violated a rule at least 3 times in the past 24 hours. I don't know if Zap
has the "Tor" switch on or off.  You would need to as Zap himself. And if
you wanted to know why a specific IP was blocked, you would have to ask
But generally speaking, if you want to read sites that block hostile
connections generally, and/or which block Tor specifically, you will need
to visit and read without using Tor (and often without using certain
proxies that tend to be used by scrapers and hackers.)
So I suspect if you want to see the discussion of the bots using Tor doing
SQL injection you will need to use a non-Tor IP.
FWIW, I'll edit the entry. But the series of ZBblock entries read more or
less like this:
 3934  Thu, 18 Jul 2013 13:49:00 -0400 Running: 0.4.10a3 / 74c
Host: sipb-tor.mit.edu
IP: 18.187.1.68
Score: 5
Violation count: 1 INSTA-BANNED
Why blocked: No access allowed from hosts listed as hostile on Stop Forum
Spam ( (local block). RFI attack/SQL
(QU-001). RFI attack/SQL injection (QU-002). RFI attack/SQL injection
(QU-024). Blind poke detected. INSTA-BAN (IB-023). Heavy hit. INSTA-BAN.
You have been
instantly banned due to extremely hazardous behavior!
User Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.0; MEGAUPLOAD
2.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.5.21022; FDM)
Reconstructed URL: http:// mysite.com
With hosts that include:
 3935  Thu, 18 Jul 2013 13:49:43 -0400 Running: 0.4.10a3 / 74c
Host: axigy2.torservers.net
 3936  Thu, 18 Jul 2013 13:53:35 -0400 Running: 0.4.10a3 / 74c
Host: tor-exit-router39-readme.formlessnetworking.net
Host: tor-exit-router41-readme.formlessnetworking.net
Host: herngaard.torservers.net
And so on.  This continues. All were 'instabanned'. That means all the IPs
that hit were served 503's on their second visit.
So if the IP you used happens to have recently hit that particular forum
with requests similar to those above, you would be served the 503 too. The
IP I use hasn't been banned there, so I am served the forum page.
I guess this one got hit too? ;)

@_date: 2013-01-04 08:24:12
@_author: Lucia Liljegren 
@_subject: [tor-talk]  Wordpress blocking Tor? 
Andrew said he encountered this sort of ban message at a wordpress:
I don't know if Wordpress.com is banning TOR. Plugins exist to assist self hosted bloggers who want to block TOR.  But It's not surprising IP 173.254.216.67 would be blocked for some reason. It is on numerous blacklist for forum and comment spam: The types of malicious access ranges from forum or comment spam to "llegal 3rd party exploits, including proxies, worms and trojan exploits  ".  If you can connect with some TOR addresses but not this one, it may just be this IP blocked.  If you can't connect with any TOR IPs, it's likely TOR specific. Otherwise, you'll have to ask the admin.

@_date: 2013-05-02 13:19:59
@_author: Lucia Liljegren 
@_subject: [tor-talk] torslap! 
I've had this happen at my blogs. Whether or not 'attack" is the correct word and whether or not  the action is targetted at my specific site, when it happens it is relentless.  These "not-attack" behaviors (i.e.  scanning, fingerprinting, attempts at SQl injections, RFI and to some extent just plain old rapid scraping) all consume my resources. Given the ever present possibility of a zero-day vulnerability at a wordpress blog, present a danger that the scanning tools will find something I was unaware of and wreak havoc.  But even if they don't find a vulnerability, they just hammer away generally rapidly and relentlessly.
How? I guess I don't understand because I don't know how someone is imagining this would be implemented.  These vulnerability scanners are generally guessing hundreds to thousands addresses that don't exist.   Because these "not attackers"  are guessing addresses they tend to hit my 404 page which is dynamic and does some checks. When I detect an IP doing this sort of stuff,  I use Cloudflare's API and ban the IP 7 days . I don't check if  the IP is Tor. I don't care if the IP is Tor, an open proxy, a server, a zombie drone or what not.  It's gone.  When the scanner is using proxies or Tor (both get used), they come back on a new IP after a short pause.  I ban that IP. It's true that in this process, many Tor IPs could end up banned.  Note also:  When I do see sustained 'not-attacks' using Tor and they just keep coming back endlessly , I do pre-emptively ban all Tor for 7 days. What's the proposal under Torslap?  I check the IP that's fingerprinting, and if it's TOR, I make it pass a "proof or work", and then let it continue to scan? That can't be what you are suggesting.   So what are you suggesting. How would the Torslap make the "not-attacker" who is hunting for vulnerabilities go away?  I don't see how ReCaptcha addresses the random scan "not-attacks". It may be proof of work.  Systems to submit captchas to a humans in low income countries already exist; that might make the scanning operation more costly. But someone running a server would need to have rocks in their head to permit scanning complete with attempts at RFI, SSH, brute force attacks on wp-login.php and such merely because someone submitted a 'proof of work' for that IP.  You could easily write a wordpress plugin that checks the tor exit nodes on certain wordpress actions giving it the functionality you think is desirable. You could host the webserver/site where users are sent do perform their proof of work.  I don't think this plugin would help the people experiencing the "not-attack" type scanning/fingerprinting/RFI/ etc. behaviors described above. For the most part, that sort of 'not-attack' has been the biggest Tor related nuisance I've experienced.  For me, Tor and comment spam is not a big problem.  I have plenty of ways to deal with comment spam.  But maybe other Wordpress bloggers would use the service. There are many useful Wordpress services; each blogger has their own difficulties and their own preferences. If Tor had a way of keeping abusive users off, this might help.  After all: if you read the above, if I see fingerprinting/ RFI injections and so on from an IP, I'm going to ban that IP at Cloudflare.  I'm not going to make an exception for Tor.  The way Cloudflare works if many people ban that IP, Cloudflare may end up giving it a high threat level and depending on the security level selected by a cloudflare user, that IP could be blocked because its threat level is too high. Similar things happen with various black lists, forum spam filters and so on. These groups aren't going to keep statistics and create ratings for IPs and then carve out an exception for Tor IPs. If Tor wants their IPs to stay off these lists, Tor needs to find a way to inhibit the behaviors that get their IPs listed.  If there is someway to get the fingerprinters/RFI injectors/scrapers etc. off Tor, that might benefit Tor users who don't fingerprint/ RFI inject/ scrape and so on.

@_date: 2013-05-03 12:06:27
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] torslap! 
my >>404 page which is dynamic and does some checks. When I detect an IP
doing >>this sort of stuff,  I use Cloudflare's API and ban the IP 7
days .
Oh you silly billy. :-)  Everyone knows it's trivially easy to block one
link farmer without blocking google. If I detected you doing rapid or
voracious scraping I would block you.   If your range was identifiable, I
might block you permanently.  This would not affect Googlebot.
fingerprinting, >>and if it's TOR, I make it pass a "proof or work", and
then let it >>continue to scan? That can't be what you are suggesting.  So what are you
I'm not groking this.  If your IP was voraciously scraping, attempting RFI
attacks, fingerprinting or doing any of these similarly hostile to my
server,   I would block IP = 123.123.123.123 for that reason.  Even if
someone else shared  123.123.123.123, that  IP is not going to get
sufficiently near my server for me to check the login.  That IP will be
blocked. This has nothing to do with "spam". It has to do with all the
resource sucking behavior the previous person describe and explained were
not attacks.
I don't see how this torslap applied to logins addresses this sort of
misbehavior. It seems to me Tor will still be blocked for these sorts of
things.   As far as I can see, Torslap has been proposed based on the
notion that the only or at least main problem is spam. Spam can be and
likely is a problem. But the main problem I've witnessed with Tor has been
scraping/fingerprinting/ vulnerability scanning and all the things that
have been called "not attacks" in the previous comment.
If  you mean the low number of exit nodes means that when I ban one IP I
may ban a large fraction of potential Tor traffic, that's possible. But
very little of that Tor traffic is people coming to my blog. I read a
paper -- now several years old -- that suggested more than half the
traffic was involved in  Tor tunnels used to exchange bit Torrent traffic.
That's mostly likely involved in copyright violations. Whether or not it
is, my blocking that doesn't affect those who wish to use Tor for bit
Torrent. Of the remaining portion, most was stuff like "search" or "social
networks". Very little was visiting blogs. Given that most Tor traffic
that hits my blog seems to be these "not attacks", I think my blocking Tor
will inconvenience only a very small number of Tor users whose traffic I
would find desirable.  In general, unless an awfully large fraction of Tor
is doing bad things, my 7 day ban will be invisible to most Torians.
Yes. I block for days because blocking for hours is insufficient to solve
the problem.  The script-kiddie programs the script to come back and it
likely will as soon as an IP is blocked. Even if the script-kiddie isn't
specifically interested in my blog, they still seems to write these things
to behave like "The Terminator" from the movie.
I don't know why you think blocking won't "help much". I've implemented
the solution and I find it works rather well at solving my problem.
I don't understand what precisely you are proposing by this "not directly
blocking but instead
reversing source and destination address in packets coming from
such IPs. :-)",  nor what the smilie is intended to convey in that
statement.  Nor do I know why you think this operation would help solve
the problem of scraping/hacking more or better than blocking the IPs at
Cloudflare.  Words might help clarify this in a way that a smile cannot.
As it happens: when I block an IP at Cloudflare, the packets don't arrive
at my server.  I can't reverse packets and send them back.  Blocking the
IP that has been sucking my server resources in these pesky "not attacks"
is quick, simple and it prevents bots from crashing my server as a result
of their "not attack" behaviors.
If you think there is a method that would work better, perhaps you could
describe in words what you think ought to be done in nuts and bolts terms
and then explain why you think it would help prevent entities that are
doing rapid fire scraping, submitting RFI attempts, trying to hunt for
vulnerabilities and so on from wreaking havoc on a server.  Because the
smiley may seem friendly, but it really doesn't clarify the otherwise
rather vague suggestion.

@_date: 2013-05-03 19:48:56
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] (no subject) 
DNS to point there, and have lots of pages point to those domains. Then
the googlebot whould try to fetch all the 404 pages, and get blocked.
No the googlebot wouldn't get blocked by my scripts if you did this.
Others already do it and it does not result in the google bot getting
blocked by my scripts. You are either hallucinating, ignorant or both.
As for the rest, I've concluded you are likely 13 years old or younger. Good luck trying to get those who are blocking Tor in self defense to stop
blocking Tor.  'Cuz your current communication style isn't going to
persuade anyone.

@_date: 2013-05-04 14:13:13
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] :  torslap! 
A while back
Moritz Bartl
under active attack, could also obviously benefit from torslap. I
haven't read the whole thread, but (Re)CAPTCHA could be considered a
cheap and powerful "proof of work", too.
When considering these things, it's worth being aware of cheap services
like that will solve captchas in 15 seconds at a cost of $1.39 for 1000
solved CAPTCHAs.:
"CAPTCHA Bypass done right
With Death by Captcha you can solve any CAPTCHA. All you need to do is
implement our API, pass us your CAPTCHAs and we?ll return the text. It?s
that easy!
Please note that our services should be used only for research projects
and any illegal use of our services is strictly prohibited. Any bypass and
CAPTCHA violations should be reported to emaildbcapiserver.com
Death by Captcha Offers:
    Starting from an incredible low price of $1.39 for 1000 solved CAPTCHAs.
    A hybrid system composed of the most advanced OCR system on the
market, along with a 24/7 team of CAPTCHA solvers.
    An average response time of 15 seconds, with an average accuracy rate
of 90% or more. And you always pay for correctly solved CAPTCHA only!
    Easy-to-use API available for most popular programming languages.
    DeCaptcher and Antigate (Anti-Captcha) API support to make migration
to Death by Captcha as easy as possible.
Some forum managers report this service works.  Captcha passing doesn't
necessarily mean a forum visitor is a human.  They could be a bot who uses
a cheap Captcha breaking service.

@_date: 2013-05-08 13:01:08
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] WebGL forbidden in NoScript but Flash is not? 
Here's a likely example of what Lunar is talking about. If you visit this
link you will be presented a survey form.
The javascript for that page creates a string listing:
1) every plugin for your browser
2) fonts that match his list of fonts.
3) The screen height of your system
4) the screen width of your system.
5) the timezone offset.
6) a timestamp:randomnumber string.
These strings added to hidden input fields and submitted to the browser
when someone agrees to participate.
The person doing the survey is likely collecting browser fingerprints to
identify duplicate entries by people using proxies.  That person
conducting the research is simultaneously the researcher and a blogger who
has been known to express quite a bit of hostility toward category of
human subjects he has invited to participate in his survey.
Obviously, fingerprints when collected are used for whatever purpose the
person collecting them wishes to use them form.

@_date: 2013-05-27 07:43:04
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] CloudFlare 
)To: tor-talk at lists.torproject.org
You brought up the issue of wishing to keep things concealed from ones
employer in
grarpamp grarpamp at gmail.com
"For example, a year or so ago I tested an English language based
predominantly North American, slightly Euro, dating site against Tor.
Though they had no stated policy to be sure of it, from my tests it appeared
that from English speaking exit countries, Tor worked fine. If I let Tor
or come in via say Brazil, the account would be silently deleted. This
lead to belief that they utilized the 'unfathomable' policy. Again, their
actual policy is unknown, I could have just been using unlucky IP's.
Either way, I'd very much hesitate to recommend them to Tor users who
would fear for their legitimate account, and thus any developing relations,
against that unknown. Further, people find dating hard enough without having
their employer or landlord snooping on how many kids they want, and whoever
else generally reading/storing/selling their personal bits. These sites need
to respect that. Part of which is to fully and properly enable HTTPS on
their servers and to permit their users to come from Tor.
Please note the reference to wishing to conceal details from one's employer.
If you don't think instructing me with, "don't take it out on those
expressing ideas counter to yours" is not at least seeming to tell people
they ought not to block IPs they chose to block, I think you are mistaken.
 In anycase, I don't consider blocking IPs associated with scraping,
fingerprinting, attempting XSS attacks and so forth to be taking anything
out on " those expressing ideas counter to [mine]".
I didn't tell you you can't advocate what you wish to advocate. You can
advocate whatever  you like.  I think my response is just as clear and
easy going as yours. I think others can decide whether they wish to take
your advice. With respect to TOR: To the extent that it causes problems
for 3rd parties, they will block it. The reason is: They will often value
protecting their servers more than whatever it is you believe they ought
to value.
I don't consider my telling you this either unclear or not easy going. My
view: You do what you like. Those providing services do what they like.
Everyone gets their freedom on this matter.
In anycase, I don't think my blog is "a service". It is my hobby blog.
Someone on Twitter asked how to block Tor at Cloudflare. I told them how
to do it.  I have no idea why our exercising our right to speak on Twitter
bothers you.
I do block TOR by reading the Tor exist lists and submitting those to
Cloudflare's API. For what it's worth: People can also use Cloudflare's
API to unblock TOR IP's if they wish to do so. If someone asked how to do
that and I read the question, I'd tell them how to do that too.  In fact,
I have a system to unblock Tor IPs after the drop of the list of exit
nodes for more than a month.
I've posted here-- and at Twitter-- totally in public.  I happen to
support the freedom of speech-- even to the extent of discussing how one
may block Tor. I happen to also support the right and freedom for people
who run services to put in place access restriction of their own chosing.
As for the reaction of Cloudflare: Based on some of the text I did not
requote, I imagine you are concerned that Tor could end up blocked at
Cloudflare if many, many individual customers blocked Tor IPs while none
unblocked the: Sure.  That's what I told people in previous threads.
Cloudflare is not treating Tor any differently from other IPs.
My view is that those who run or use Tor or who wish to improve it  would
benefit from learning what causes people to block Tor and where possible
find ways to address these issues.   The Tor community will be unable to
do so if they keep themselves unaware of
(a) the actual reasons why individuals who block Tor block it,
(b) how individuals actually block Tor
(c) what impact individuals blocking Tor have on third parties.
With respect to (a) I block because of XSS, vulnerability scanning,
scraping and so on. Not for comment spam nor for any desire to surpress
their viewpoints. With respect to (b) I block using Cloudflare (and I will
share knowledge with others). With respect to (c) the fact that Cloudflare
uses information from many individuals to create reputation scores for IPs
does mean that if *many* Cloudflare customers block, Tor IPs may find
themselves blocked from many sites that use Cloudflare.  I imagine that
many who block Tor do so for similar reasons.
This is information the Tor community might wish to be aware of.
Or, maybe not. Maybe you'd prefer to think they are blocking IPs to
prevent freedom of speech and so believe that lecturing them on the
importance of freedom of speech or privacy will solve the problem. Or
something. But 'educating' people about the importance of privacy or
freedom of speech will not solve your difficulties if people are blocking
for security reasons, or to contain costs required to deal with scraping.
To deal with those issues you need to consider whether there is someway
you guys could do things like block incoming IPs that attempt to hit
"timthumb.php" or other vulnerabilities.
I haven't forced my opinion of Tor on anyone.  My blocking Tor doesn't
force anything down anyone's throats. My blocking Tor doesn't even affect
any *people*. People are not IPs.  My blocking Tor merely prevents them
from visiting my private blog using *Tor IPs* or any IP that is  blocked. Since people are manifestly NOT their IPs, these people are free to visit
using a non-Tor IP.
Happy memorial day,

@_date: 2013-05-28 16:49:28
@_author: lucia@rankexploits.com 
@_subject: [tor-talk] CloudFlare 
Again, and for the LAST time, nothing there says that I wish do
I didn't say anything about concealment being "illicit". I merely said you
brought up the issue of concealment, which you did when you wrote this
brought up the issue of concealment from employers. You wrote this:
" Further, people find dating hard enough without having
their employer or landlord snooping on how many kids they want, and whoever
else generally reading/storing/selling their personal bits. These sites need
to respect that."
I'm not saying they have no right to *want* anything. People can want what
they want for any reason that seems fit for to them. They can want the
grocery store to give them free beer. What they *want* is not a big deal.
But I disagree that any 3rd party has even the slightest obligation to
*give theses people what they want*.  No 3rd party has any obligation to
respect anything about these employees desire to prevent "their employer
or landlord snooping on how many kids they want, and whoever else
generally reading/storing/selling their personal bits". The dating site
has every right to run their dating site the way *the dating site wants*.
If these people who want https connections don't get what they want-- they
try to find it elsewhere.
If you are going to use this as an example of what 3rd parties like the
dating service *need* to do or what the need to respect I'm going to tell
you you are flat out wrong.
Your saying "Last time" or getting angry or quoting Star Wars or trying to
explain people isn't going to change the fact that these 3rd parties don't
own any Tor users anything and they don't "need to respect" what they

@_date: 2014-02-23 18:50:50
@_author: Lucia Liljegren 
@_subject: [tor-talk] tor-talk Digest, Vol 37, Issue 40 
I thought you guys might want to comment on this post by Bob Lacatena or skeptical science.
The bits that will be relevant to you guys:
======= ======= ======= ======= February 21, 2012 ? 6:52 AM AEDT ? The German
It was February 20, 8:52 PM CET, the local time in Germany, when The German, or so I?ll call him, first hacked his way into the Skeptical Science web site.  If it had happened in America in the nineties, beside his keyboard would have been a can of Coca Cola and a few Twinkies.  I guess today the drink would be a Red Bull.  I?m not sure what a German might choose.
To mask his identity, he fired up a Tor browser.  Tor, despite the titlecase spelling, is actually an acronym for The Onion Router.
Safe in his room, buried under layers of onions, focused on his screen, probably with a caffeinated drink and a snack beside his keyboard on his desk, the hacker comfortably and earnestly began his work.
David Lightman: Hey, I don't believe that any system is totally secure.
? Wargames (1983) ?
March 24, 2012 ? 1:06 AM AEDT ? SkS was hacked
======= ======= ======= ======= I can't say I know whether the hack was accomplished by someone using a Tor IP; Bob doesn't explain why he thinks it was a Tor IP and seems to think "Yes to blocking Tor IP addresses, and many web sites do, but building the map is a huge task." In fact: blocking Tor IPs is easy peasy.
Anyway: you guys might want to be aware of this story.
