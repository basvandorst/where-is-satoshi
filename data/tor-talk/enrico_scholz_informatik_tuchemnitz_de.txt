
@_date: 2006-09-10 23:58:11
@_author: Enrico Scholz 
@_subject: Protecting exit-nodes by GeoIP based policy 
I just had the idea which can help to protect exit-nodes against some
kinds of legal prosecution. Basically, it would be policy to Tor servers
which says "do not connect into country XY". Such a rule does not increase
anonymity but would require that legal actions (e.g. confiscations) must
be performed in another country than this where the crime happened. This
is a much higher hurdle, especially for lower delinquencies.
I see two steps how this policy can be implemented:
A. On client side
 1. add a new option, e.g. 'Jurisdiction' with possible values of
    * 'other'  ... when set, do not use an exit-node when it is the same
                   jurisdiction as the target-ip; this should be the
                   default on new installations
    * 'same'   ... use an exit-node only, when it is in the same
                   jurisdiction (just for completeness...)
    * 'ignore' ... ignore jurisdiction (same behavior as now)
    * a country code  ...  use only exit-nodes within this country; a
                   negated format should exist too
 2. when choosing path, use only exit-nodes which are following the
    constraint above
B. On (exit-)node side
 1. add a new option, e.g. 'JurisdictionPolicy' which accepts country
    codes and perhaps special values like '%same'. Behavior is similar
    to the client side option mentioned above
 2. Tor protocol/meta data must be changed to transmit this option
 3. node forbids connections which are violating the policy
The decision whether a node and a target are in the same jurisdiction can
be done e.g. by a GeoIP like service. A problem might be the license:
GeoIP is GPL, Tor is BSD. Dunno, whether the database can be used freely
and Tor has to implement own parsing routines. Perhaps, similar projects

@_date: 2006-09-11 00:41:53
@_author: Enrico Scholz 
@_subject: Protecting exit-nodes by GeoIP based policy 
This idea is not to increase anonymity but to add protection for the
exit-nodes against legal prosecution.
E.g. when somebody posts offending material in a forum, the exit-node
might be easily confiscated when it is in the same country like the
forum webserver (resp. the offended person). When exit-node is in
another jurisdiction, an confiscation order would not be possible for
such minor crimes.

@_date: 2006-09-11 01:48:50
@_author: Enrico Scholz 
@_subject: Protecting exit-nodes by GeoIP based policy 
GeoIP ( is a candidate but I am not sure
about licensing.
Blocking/allowing a connection would be signaled in a similar way like
for current 'ExitPolicy'.
Yes; basically that's my idea. But I would increase configurability;
e.g. allow to define jurisdiction (e.g. when having my tor server
somewhere in the Caribbean, I would count Caribbean and Germany to my
jurisdiction; ditto for things like single Germany or whole Europe).
You will have to add rules for hosts not covered by the GeoIP database
too (either allow them, or forbid them).
Doing it voluntarily on the client would be step 1 and can be done
immediately after implementing the feature.
Enforcing it on the server would be step 2 and needs some time, because
every client would have to know how to interpret the new exit policy.

@_date: 2006-09-11 16:10:07
@_author: Enrico Scholz 
@_subject: Protecting exit-nodes by GeoIP based policy 
yes; first step still allows malicious clients to bring certain exit-nodes
in trouble.
But I guess/hope, that most clients are interested in an operational/fast
Tor network and want to protect exit-nodes.
Due to the enormous amount of rules, it will require more than a bash
script. The Tor protocol must be changed to express such a policy, and
there must be precautions that clients and servers are using the same
GeoIP database. That's nothing which can be done "today" ;)
Or... just a quick idea... what's about an RBL like DNS mapping? E.g.:
1. There exists somewhere a DNS server which maps '.something'
   to an IP like '10.0.0.' where  identifies a country
   (e.g. 1...Germany, 2...France...)
2. Tor servers resolve additionally '.something' and apply the usual
   ExitPolicy which contains the IP <-> Country mapping from above.
This requires still changes in both clients and servers but no protocol
1. There must be found a better IP range than 10.0.0.0...
2. DNS lookup must be done in a secure/anonymous way

@_date: 2006-09-11 16:56:09
@_author: Enrico Scholz 
@_subject: Protecting exit-nodes by GeoIP based policy 
ok; then, the
option might be not for completeness only ;)
The mentioned danger exists with the current modell of really random
exit-nodes too.

@_date: 2006-09-19 08:52:44
@_author: Enrico Scholz 
@_subject: Using Gmail (with Tor) is a bad idea 
Using unencrypted transfer is always a bad idea; not only with Tor. It just
moves the attack-point for sniffing attacks from e.g. your cable-modem
network, your ISP and the hops till the the webserver to the exit-node and
the hops till the webserver. The way where password data are transferred
unencrypted might be even shorter (e.g. when exit-node is nearer to the
webserver) or more secure (e.g. when you are in a cable-modem network) with
A much bigger problem with Gmail is, that it requires an existing account
to create a new one. Hence, there exist a chain between your anonymous
account and the account of a known person which can reveal your true

@_date: 2006-09-21 09:05:20
@_author: Enrico Scholz 
@_subject: Question about Tor 
Most public mail services offer MSA (with SMTP AUTH) on port 587 too;
and at least two popular german ones with TLS support.
fwiw, Thunderbird (and whole Mozilla suite) works perfectly with Tor
without additional software. It tunnels every connection (IMAP, POP3,
SMTP, HTTP) through the Socks5 proxy.
