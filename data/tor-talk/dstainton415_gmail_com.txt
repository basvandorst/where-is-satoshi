
@_date: 2015-04-22 18:41:07
@_author: David Stainton 
@_subject: [tor-talk] Quantum Insert detection for everyone 
Did you all see this Wired article about Quantum Insert detection?
These TCP injection attacks are used by various entities around the
world (not just NSA!) to target individuals for surveillance or
perhaps to add their computers to a botnet for other purposes.
If you do not use a VPN or Tor you can run "Quantum Insert" detection
on your computer and detect when you receive an attack attempt.
However be advised that proper sandboxing is important here because
intrusion detection and protocol anylsis tools are notoriously
insecure and get pwned all the time.
If you are a Tor exit relay operator you have the options of running
detection software; However you should not publish the results
publicly without mixing in some noise or your published data might
make it possible for some adversaries to deanonymize Tor users. If
your country has strict telecommunications laws then it might only be
legal for you to perform this type of detection if you do not perform
For the past several months... in my free time I've been slowly
developing a very comprehensive TCP injection attack detection tool
called HoneyBadger:
Quantum Insert is a NSA codeword for "TCP injection attack", however
either of these terms are too vague. During my research I was able to
classify 4 different types of TCP injection attack. When I say that
HoneytBadger is comprehensive what I mean is that Honeybadger can
detect ALL of these types of TCP injection attack types... I describe
them briefly here:
Here's the Fox-IT blog post about their Quantum Insert detection software:
I am going to work on writing a much more comprehensive blog post; it
will be filled with gory technical details AND it will include
information on how to use HoneyBadger. HoneyBadger has optional (off
by default) full-take logging which could enable you to capture a
zero-day payload from a TCP attack; you should then responsibly
disclose to the software vendor or contact a malware analyst to help
David Stainton

@_date: 2015-02-17 11:50:52
@_author: David Stainton 
@_subject: [tor-talk] Tor over SSH (torsocks) (?) 
perhaps use "stealth" authenticated tor hidden service for your ssh to
mitigate the ssh 0-day(s); obviously this is not just a tin foil hat
practice anymore.

@_date: 2015-07-13 10:51:57
@_author: David Stainton 
@_subject: [tor-talk] Tor browser for ARM architecture 
I built tbb for arm archlinux:
I ended up not being too clever about it; I performed the build on the
raspberry pi 2 and it took fucking 7 hours. It would be faster to do a
cross-compile or a arm qemu build on am64 machine... but I couldn't
get either of those approaches to work for me.
A slightly more clever but still pretty stupid way to do the build
would be to use a Raspberry pi distcc cluster to perform the build ;-p

@_date: 2015-05-23 02:00:22
@_author: David Stainton 
@_subject: [tor-talk] Quantum Insert detection for everyone 
Hi tor-talk,
Hi Chris,
I've finally fixed all the false positive bugs in honeybadger (as far
as I know!).
I've updated the docs here with a few additional usage considerations
that Tor exit operators might find helpful:
If a TCP attack is detected then honeybadger will write json attack
reports to the logs directory. If the CLI option
-metadata_attack_log=false is set then the attack logs will contain
base64 blobs... and so this is not a human readable format which is
why I created the honeybadgerReportTool which makes it VERY easy to
see the injected data with it's color coated hex dump diff output:
Please feel free to write me on or off list to ask any question you
may have about how honeybadger works or how to use it.

@_date: 2016-01-21 01:30:07
@_author: David Stainton 
@_subject: [tor-talk] Scripted installer of Tor and more being worked on 
hmm it's written in bash. that would not have been my first choice to
express this type of software.
why bash?
i like ansible's agent-less design (no SPOF server with ambient
authority) however it's restrictive yaml really lacks expressiveness
and writing ansible modules in addition to yaml seems like a waste of
time. however there is some excellent ansible tor stuff written for
use by relay operators; meaning that it doesn't have nearly all the
features that your thing has... but should be good enough for most
relay operators:
i think in the future if i had to automate this sort of thing I'd use
bcfg2 in non-SPOF mode (that is, without a centralized server).

@_date: 2016-01-21 20:59:09
@_author: David Stainton 
@_subject: [tor-talk] Scripted installer of Tor and more being worked on 
Firstly, I don't think my questions "deserved" such a long reply and
it is not my preference to have such a broad spattering of
conversation topics... but you started it and so I have tried to reply
to your various points.
The take-away i get from all of that is that you really like bash and
don't have much experience with other programming languages; which is
fine... you have to start somewhere. But I think Python would be a
saner place to start... computer programming. I often recommend it to
people who have zero experience programming... and they pick it up and
learn good habits... such as writing unit tests.
IMHO bash is better for shorter smaller simpler things because it is
not so easily maintainable and has no exception handling (set -e
doesn't count).
You are not correct about bcfg2. It's written in python and therefore
it of course runs on whatever ARM platform. I don't know what bcfg2
encap is... but it sounds like an irrelevant boot strapping mechanism
whose packages are no longer maintained... so just forget you saw
that. ;-0
I don't know what you mean by "reverse ssh terminal to a ~.onion" but
perhaps you meant to comment on the NAT penetration property of onion
"While it may seem dangerous to pack Metasploit with Tor" um what? i
don't know what you mean. And by clearnet I suppose you mean
non-cryptographic protocols like http. This isn't ever really safe in
light of the TCP injection attacks that can be used to insert
malicious data into your TCP stream in order to compromise the client
and/or server.
