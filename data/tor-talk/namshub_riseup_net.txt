
@_date: 2014-08-23 14:27:37
@_author: Nam-Shub 
@_subject: [tor-talk] Hiding the presence of hidden services 
Hash: SHA512
Is there any good way to hide the presence of hidden services? I know
that if I create a hidden service, at least the HSDir nodes are able
to see the .onion address of that site. So someone could scrape a list
of .onion addresses to portscan and automatically exploit if they have
a 0day. Let's say I wanted to expose an SSH service there. As all
incoming connections come from 127.0.0.1 I cannot use a firewall for
access control, and SSH is very verbose in announcing itself.
Is there any good way to hide the presence of services? Something like
port knocking I guess, but most of those solutions seem to listen to
all traffic using libpcap and that sounds like a big attack surface as
I've seen and I think it would be a great solution if/when it gets into the
kernel, but as long as it requires kernel patching it's not really an
option for me.
Alternatively, something that did not hide the listening socket but
was just a very simple wrapper around TCP that checked a MAC on
incoming messages, letting through only those messages that have the
correct MAC but not responding at all to others. Something so simple
that it can be easily audited (unlike OpenSSH). That way scanners
could not tell what was running behind it. Does something like this exist?
