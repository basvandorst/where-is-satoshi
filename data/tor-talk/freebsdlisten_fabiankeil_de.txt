
@_date: 2006-08-18 16:01:32
@_author: Fabian Keil 
@_subject: Tor bug?:  AllowInvalidNodes 
I don't see the problem here. The option is called "AllowInvalidNodes" not "DoNotOnlyUseTrusworthyNodes".
You can't assume that every node not marked as invalid is trustworthy.
I don't see how a registration would disadvantage "high bandwidth snoops".
You would loose most of the running servers without solving
any problems. For example I have no physical access to my
Tor server.
Even if I had and would be willing to let others inspect the
whole server including all my private data, what would stop
be from enabling a sniffer after the inspection is over?
Are you intending to make daily visits without further
notice? After all, reinstalling a clean image is a matter
of minutes. Again, I don't see the point. Good guys aren't the only
ones with "actual name and address". Some of them might
even have fake ones that can't be easily detected. If "mustering" includes access to the Tor server's keys,
that would probably make the system less secure.
You no longer have to run your own spying node,
you just collect all the keys of the other ones.
They are cryptic for a reason. It's documented some where
in the wiki.
I never used any, but I think there are already some
onion gateways available (limited to http I believe).
I don't think the Tor network could currently handle random
packets, but I agree that it would be a nice feature.

@_date: 2006-08-19 13:03:10
@_author: Fabian Keil 
@_subject: A brief response on TRUTHWORTHY 
It was my intention to only snip the parts I didn't comment on.
Yes I know, all I'm saying is that it's a difference if a
node is trustworthy or just not marked as invalid.
As far as I understand it, if a node is not marked as invalid,
it means that the dirserver operators have no reason to believe
that it's untrustworthy or misbehaving. In other words a valid
node isn't guaranteed to be untrustworthy, but it very well might.
After all traffic sniffing nodes can't be detected,
unless they intend to be detected.
You're right, I thought "muster" was another word for "check".
But unless I failed to get it again, your levels would require
the checks you mentioned, so I think most of my concerns still apply?
BTW: instead of "levels" I'd prefer more optional "labels".
What I'd like to have would be a Tor server option
that clarifies if a Tor server provides unmodified
content. Similar like the myfamily feature
it would be only used by the good guys, but I still
think it would be useful.
I really hate it when Tor servers are chained with squid
and provide modified content without letting me know.
Some of them even provide default addresses for failed
DNS requests, instead of delivering a decent error message.
I think most of these Tor server operators have no
wrong intentions and wouldn't mind using such an option
if it existed. I would be glad if I could easily exclude
As far as I remember, the Tor documentation doesn't
say anything about if it's right or wrong to chain
Tor servers with content modifying proxies, but I for
one think it's a bad idea.
As far as I understood, you intended to have some of your proposed
Tor server levels include a check of the Tor server. Is that correct?
I'm just saying that this check would weaken the Tor server's
security, because the person checking the server would get
hold of the server's private key.
I just think your proposed Tor server levels would not only
fail in extreme case, but next to always.
Hopefully something that changes the situation, I just
don't see how your proposed Tor server levels would gain anything. I don't think so. There is no reliable way to detect if a Tor server
is sniffing traffic.
Again I don't think so, the Tor developers do a lot.
I don't. As there's no reliable way to detect a sniffing server,
circulating such a list would only cause a false sense of security,
as you would only exclude the harmless ones that want to be detected.
Entry guards aren't system wide, they are implemented in the client.
Maybe I would do the same, but I don't see what it has to
do with your proposed changes. They weren't rejected because
some evil person infiltrated the Tor development team,
but because they just aren't worth it.

@_date: 2006-08-19 14:24:27
@_author: Fabian Keil 
@_subject: Tor servers chained with proxies (was: A brief response on 
If they are setup correctly I don't see anything wrong with proxies
either. But I expect them not to provides outdated or modified content,
not to mess with error messages and not to cache if the servers
asked them not to.
If I type an invalid address into my browser, I want to see the error
message of my local running Privoxy, not some message send by a
"transparent" proxy.
I assume that most default proxy configurations are as
broken as most default browser configurations, therefore
I'd rather exclude all Tor nodes that are chained with a
proxy, unless I know for sure that they really work
If I was aware that my Tor server had no clean
web connection, I would block port 80.
Not always to the Tor user's disadvantage. For example
Tor allows me to order RC-1 DVDs from web shops that
aren't supposed to ship them to Germany, but don't
mind if the IP check is circumvented.
From time to time I get custom headers that were added by squid
or some other proxy and aren't set by the original web servers.
Some people might not care, I do.
Or I mistype a URL and instead of getting a real error message I'm redirected to another site. In fact "redirect" isn't the
right word, because there is no 302 or 301 status code, but 200.
Sometimes it's a custom error message send with the wrong
status code, sometimes it's just another page with no content
that I'm interested in (this happend only a few times so far).
As I said before I don't think it's the result of bad intentions,
so labels like "HTTPProxy", "ModifiedContent", "ModifiedHTTPBodies"
and "ModifiedHTTPHeaders" could help.

@_date: 2006-08-19 14:26:13
@_author: Fabian Keil 
@_subject: Tor servers chained with proxies (was: A brief response on 
If they are setup correctly I don't see anything wrong with proxies
either. But I expect them not to provides outdated or modified content,
not to mess with error messages and not to cache if the servers
asked them not to.
If I type an invalid address into my browser, I want to see the error
message of my local running Privoxy, not some message send by a
"transparent" proxy.
I assume that most default proxy configurations are as
broken as most default browser configurations, therefore
I'd rather exclude all Tor nodes that are chained with a
proxy, unless I know for sure that they really work
If I was aware that my Tor server had no clean
web connection, I would block port 80.
Not always to the Tor user's disadvantage. For example
Tor allows me to order RC-1 DVDs from web shops that
aren't supposed to ship them to Germany, but don't
mind if the IP check is circumvented.
From time to time I get custom headers that were added by squid
or some other proxy and aren't set by the original web servers.
Some people might not care, I do.
Or I mistype a URL and instead of getting a real error message I'm redirected to another site. In fact "redirect" isn't the
right word, because there is no 302 or 301 status code, but 200.
Sometimes it's a custom error message send with the wrong
status code, sometimes it's just another page with no content
that I'm interested in (this happend only a few times so far).
As I said before I don't think it's the result of bad intentions,
so labels like "HTTPProxy", "ModifiedContent", "ModifiedHTTPBodies"
and "ModifiedHTTPHeaders" could help.

@_date: 2006-08-20 16:28:59
@_author: Fabian Keil 
@_subject: Polipo web proxy 
I'd like to hear your reasons and if you tried Privoxy's cvs version
Please have a look at:
to see the changes, at least some of them are relevant for Tor users.
I haven't tried it yet, but to me it doesn't look like a Privoxy
replacement, but more like a nice addition for the proxy chain.
Browser -> Privoxy -> Polipo -> Tor
Should bring you HTTP pipelining without loosing Privoxy's
filtering capabilities.
As far as I can see, Polipo merely blocks HTTP headers if requested.
Its referrer blocking seems to be smarter than the one of Privoxy 3.0.3,
but Privoxy's cvs version offers the hide-referrer option conditional-block,
which should be equivalent to Polipo's "maybe" setting. At least some of the "funny behaviour" should be fixed in cvs,
and if you disable the more aggressive Privoxy filters,
the site breaking problem should be solved as well. Please let me know if you still see "funny behaviour"
with Privoxy's cvs version that isn't caused by your
filter choice.

@_date: 2006-08-25 12:40:47
@_author: Fabian Keil 
@_subject: More control over bandwidth 
Are you not aware of BandwidthRate and BandwidthBurst,
or is there a reason why they don't work out for you?

@_date: 2006-08-28 12:22:50
@_author: Fabian Keil 
@_subject: Holy shit I caught 1 
Like Firefox, Privoxy doesn't care about the .exit notation,
and just passes it forward without breaking anything:
Aug 28 12:14:45 (08113e00) Request: addons.mozilla.org.1.exit:443/
Aug 28 12:14:45 (08113e00) Error: failed request  to connect to addons.mozilla.org.1.exit:443. Trying again.
Aug 28 12:14:45 (08113e00) Error: failed request  to connect to addons.mozilla.org.1.exit:443. Trying again.
Aug 28 12:14:45 (08113e00) Error: failed request  to connect to addons.mozilla.org.1.exit:443. Trying again.
I haven't checked it, but I assume Tor itself can't deal
with the exit notation if socks4a is used.

@_date: 2006-08-28 12:23:26
@_author: Fabian Keil 
@_subject: Holy shit I caught 1 
How nice of you to back up your claims with enough information
to reproduce the problem. Which error message did you get and
did you verify the problem with another client?
Especially the "keeping the size exactly the same" part sounds
more like a problem in the fetching client. Are you sure that
your application doesn't retry failed fetch attempts without
caring about status codes?
Is it impossible that the download was started but the connection
broke down, your application tried again and got a "404 no such
domain", saved the error message in the binary stream and tried
again with a adjusted byte range?

@_date: 2006-08-29 14:33:23
@_author: Fabian Keil 
@_subject: Holy shit I caught 1 
You claimed:
therefore I assumed you actually verified that it is a Privoxy
problem, so it should be reproducible without running any
scripts. I wouldn't complain if you had just written:
I doubt that it was inserted mid-stream.
Not exactly Privoxy's fault, is it?
So do you still think it's a Privoxy bug?
Well lucky me, I have working copies of curl and fetch lying
around. I will give your script a try, to see how they behave.

@_date: 2006-08-29 21:35:57
@_author: Fabian Keil 
@_subject: Tor 0.1.2.1-alpha is out 
I never compiled Tor on Windows, but there is a fair
chance that you have to run ./configure by hand.

@_date: 2006-08-30 13:55:10
@_author: Fabian Keil 
@_subject: Holy shit I caught 1 
How do you triple check a self-signed certificate?
You can check that it is self-signed, but you
don't know if it is self-singed by the website
you want to visit, or self-signed by the man
in the middle.
What do you gain, if you know that the traffic
between you and the man in the middle is secured? You are better off not trusting them anyway,
especially as a Tor user.
If they can't afford a trustworthy certificate
they should at least make the ssl access optional
or make their stuff accessible through a hidden
service as well.
Generic http to https redirects with self-signed
certificates are a sure way to loose me as a possible
If I don't know what kind of information the website
offers, I don't know if it's worth punching a hole
in my Privoxy configuration or to configure another
stunnel. More often then not I just assume that
it isn't.

@_date: 2006-08-30 18:47:35
@_author: Fabian Keil 
@_subject: Could i use tor to login Paypal? 
A month ago PayPal took my account hostage because
they fantasised to have reason to believe a third
person had access to it.
There were no unauthorised transactions,
therefore I'm sure it's a false alarm.
Of course they didn't tell me their reason,
but I assume it's a stupid one. I wouldn't be
surprised if it was because a change
of exit nodes while I was logged in.

@_date: 2006-08-04 16:17:06
@_author: Fabian Keil 
@_subject: dns-proxy-tor / freecap 
Visit and make sure that Privoxy is using socks4a
to talk to Tor. If it is, Privoxy itself
doesn't leak DNS requests and if the browser
behaves, it doesn't either.
Of course every program that doesn't use
Privoxy or Tor directly with a DNS-safe connection
still leaks DNS requests.
It can help, if you configure it as first and only
DNS server, but it can't itself stop broken applications
from using hard coded defaults. If you can trust your applications to honour your
DNS server settings, you can use dns-proxy-tor to
stop DNS leakage. If you use it together with a decent packet filter,
you can make sure that there is no unencrypted
DNS traffic and connections from broken applications are
redirected into dns-proxy-tor or just fail.
I never used it and I think it's a pain to set it up,
but it could be an alternative solution.
Did you already read "perldoc dns-proxy-tor"?
Even if you don't use perldoc, you could download the
non-windows version, open it in any text editor and
scroll to the bottom to read the documentation.

@_date: 2006-08-05 12:10:49
@_author: Fabian Keil 
@_subject: dns-proxy-tor / freecap 
Anothony Georgeo  wrote [quoting adjusted]:
Correct, if you can trust your applications to use Windows'
DNS resolve functions without modifications. I don't know if an application can use Windows' resolve functions
and provide its own DNS server settings, but it's certainly possible
that an application brings it own DNS client with it and completely
circumvents Windows' DNS client functions.
Of course in that case the DNS leakage is probably
the least of your problems.
If the applications play by the rules and use Windows to do
their DNS requests, the requests will use the preferred DNS server.
Probably that's good enough, but I don't think "force" is the
right word here.

@_date: 2006-12-12 19:22:26
@_author: Fabian Keil 
@_subject: Tor 0.1.2.2-alpha eventdns timeouts 
I patched Tor 0.1.2.4-alpha about half an hour ago,
so I can't be sure yet, but it looks as if the patch
causes less timeout warnings, but more "Bad response 2"
This is a log excerpt from vanilla Tor 0.1.2.4-alpha:
Dec 12 18:55:11.676 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 17:46:01.083 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 17:53:45.157 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 17:53:55.158 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:02:27.201 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:02:37.242 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:12:59.581 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:13:09.582 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:13:19.784 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:13:29.785 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:33:15.708 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:33:16.746 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:43:00.952 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:43:02.706 [warn] eventdns: Nameserver 81.169.148.34 is back up
This is with your patch applied:
Dec 12 18:47:11.260 [notice] Self-testing indicates your DirPort is reachable from the outside. Excellent.
Dec 12 18:48:09.113 [notice] Performing bandwidth self-test.
Dec 12 18:55:11.676 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Dec 12 18:55:21.677 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:55:37.977 [warn] eventdns: Nameserver 81.169.148.34 has failed: Bad response 2 (server failed)
Dec 12 18:55:47.978 [warn] eventdns: Nameserver 81.169.148.34 is back up
Dec 12 18:59:26.843 [warn] eventdns: Nameserver 81.169.148.164 has failed: Bad response 2 (server failed)
Dec 12 18:59:34.863 [warn] eventdns: Nameserver 81.169.148.34 has failed: Bad response 2 (server failed)
Dec 12 18:59:34.864 [warn] eventdns: All nameservers have failed
Dec 12 18:59:36.843 [warn] eventdns: Nameserver 81.169.148.164 is back up
Dec 12 18:59:44.864 [warn] eventdns: Nameserver 81.169.148.34 is back up
I already did get some "Bad response 2" before,
so this could be a coincidence.
As I said, it's not running long enough to be sure,
but it at least looks as if there's still some problem left.

@_date: 2006-07-25 10:55:41
@_author: Fabian Keil 
@_subject: Tor / Privoxy for local URLs 
Check the forward section in Privoxy's configuration file
(open  to get its
location) and add: forward         twiki    .
below Tor's socks4(a) line. If this fails, either specify
the IP address or add an entry in your system's hosts file.
You could also use a proxy exception in Firefox
(see M's answer), but it would be browser dependent
and circumvent your whole proxy chain, not only Tor.

@_date: 2006-07-27 12:23:33
@_author: Fabian Keil 
@_subject: Tor on Debian 
If you get the error after the installation is already finished,
there's a chance that it's not a Debian specific problem. And even if it is a Debian specific problem, I don't think
anyone will get offended if you post about it here.

@_date: 2006-07-10 21:39:05
@_author: Fabian Keil 
@_subject: Reliability of circuit extension if target server is running a Tor 
I read on :
How reliable is this supposed to work? For me it is working most of the time,
but quite often I get:
149.9.0.21 - - [10/Jul/2006:20:55:54 +0200] "GET /pf-stats/ HTTP/1.1" 304 - "-" "Icke"
10.0.0.1 - - [10/Jul/2006:20:56:00 +0200] "GET /pf-stats/pfstat-queues.png HTTP/1.1" 200 8112 " "Icke"
10.0.0.1 - - [10/Jul/2006:20:56:00 +0200] "GET /pf-stats/pfstat-errors.png HTTP/1.1" 200 8118 " "Icke"
10.0.0.1 - - [10/Jul/2006:20:56:00 +0200] "GET /pf-stats/pfstat-states.png HTTP/1.1" 200 8451 " "Icke"
10.0.0.1 - - [10/Jul/2006:20:56:00 +0200] "GET /pf-stats/pfstat-packets.png HTTP/1.1" 200 7426 " "Icke"
10.0.0.1 - - [10/Jul/2006:20:56:00 +0200] "GET /pf-stats/pfstat.png HTTP/1.1" 200 10048 " "Icke"
A foreign exit node is used for the first HTTP request,
the following requests use one of my own nodes.

@_date: 2006-07-11 17:12:04
@_author: Fabian Keil 
@_subject: Reliability of circuit extension if target server is running a 
Not that I know of, but I think the exception for the first
request(s) should be mentioned in the FAQ entry anyway.

@_date: 2006-06-13 12:33:43
@_author: Fabian Keil 
@_subject: Tor,security and web-usability - Sorry, now readable with 
Not to install Flash in the first place would be
an even better idea.
Depends on what kind of security you are talking about.
I read several Privoxy problem reports about
Windows Media Player ignoring the proxy settings
and calling out directly, but you could use a
transparent proxy to force Windows Media Player
to use Tor.
Of course Windows Media Player could still send private
information through Tor, so yes, if you don't
trust Windows Media Player to behave, you probably
should delete or at least disable it.
I disabled JavaScript years ago and don't have
the impression that it's getting harder to surf
without it.
It certainly would improve security, but if you just want
to hide your IP address, a proper firewall configuration
should be good enough (provided your on a private LAN
and Java only sees your private LAN IP). You could use
chroot, jails or systrace (if MacOS offers one them) to
make sure the browser doesn't broadcast your mails.
I also don't understand why you would want to encrypt
the partition of the emulated OS. The goal is to secure
the host system from the browser, not the other way

@_date: 2006-06-13 14:13:45
@_author: Fabian Keil 
@_subject: Tor,security and web-usability - Sorry, now readable with 
"Ringo Kamens" <2600denver at gmail.com> top posted:
I take it, you mean and block all other exits, but Firefox is the
least trusted software on my system and if it decided to leak
every file it can read, Tor couldn't stop it.

@_date: 2006-06-13 14:14:01
@_author: Fabian Keil 
@_subject: Just some super-paranoia 
How do you define "honeypots etc"?
And even more importantly, how do you detect them?

@_date: 2006-06-13 15:01:11
@_author: Fabian Keil 
@_subject: Tor,security and web-usability - Sorry, now readable with 
Try trans-proxy-tor and find out: It provides example configurations for PF and iptables to do that.

@_date: 2006-06-14 16:05:06
@_author: Fabian Keil 
@_subject: Tor Leaking 
Do you have additional links were they actually bring
in some information about what "leaks" and "fingerprints"
they are talking about?
To me they don't look were knowledgeable at all,
the blog doesn't even display correctly in my browser.
Also taken from:
Am I the only one who didn't find their interim solutions?
I didn't see where/if they explain the difference,
but if that's as "down and dirty" they get, the blog
seems to be pretty worthless. I think you're missing that they are probably just
spreading FUD to get attention and have either no real
information to offer, or are very good at hiding it.

@_date: 2006-06-16 17:57:12
@_author: Fabian Keil 
@_subject: Can't download pdfs without socksifying Adobe 
It is certainly possible to misconfigure your
browser to directly open third party applications
that ignore the browser's proxy settings and do
what they want.
Of course this has nothing to do with "the browser
cheating on you" and it shouldn't be a surprise.
Tor is not supposed to detect or prevent all
kinds of DNS leakage. It prints a warning
if it gets requests that contain an suspicious
IP address, as that can be a sign of unencrypted
DNS resolution, but that's all it can do.
If an application doesn't use Tor for its requests,
you obviously shouldn't expect a warning from Tor.
A local DNS server that resolves through Tor and a
properly configured firewall would work as well.
Another solution would be to simply download the
file inside the browser instead of using (broken)
third party plug-ins in the first place.
I don't use PDF or Adobe products so I can't test
this either, but unless you use a transparent proxy
you should expect that every application is leaking DNS
requests until you explicitly configure it otherwise
and checked that it's working.
I don't know what these guys use as "sentinel" and
why they can't show the "sentinel's" output as proof,
but I'm inclined to believe that they just don't
understand how to use it right.
It makes no sense for an application to do a DNS look up,
just to request the file without actually using the
resolved IP.
I wouldn't be surprised if "Adobe" didn't use Tor at all,
but the "sentinel" wasn't watching the right ports.

@_date: 2006-06-22 10:20:58
@_author: Fabian Keil 
@_subject: Privoxy and cache headers 
Vanilla Privoxy doesn't, but you can use the patch at: Afterwards Privoxy can block the If-Modified-Since
header entirely, or randomize it's value in a given range. My generic section contains:
+hide-if-modified-since {-1}
+overwrite-last-modified {randomize} which means the server's Last-Modified header is randomized
in the range between the real value and the actual time
on the Privoxy-running system.
When the Last-Modified header's value is later taken by the
browser as value for the If-Modified-Since header, Privoxy
subtracts a random value between 0 and 1 hour.
This way the If-Modified-Since header is still useful
most of the time, without giving the server the chance
to use it for tracking purposes.
AFAIK there is no way to randomize an If-None-Match header
without causing it to get invalid, therefore it is just
In the worst case scenario the value of the Last-Modified
header is less than an hour old, in the next request
Privoxy's randomization of the If-Modified-Since header
let's it appear to predate the original value on the server,
and the server has to send the document again instead of
just sending 304.
Of course randomizing the If-Modified-Since header has
no effect if you're the only one who ever visited the page.

@_date: 2006-06-06 21:26:43
@_author: Fabian Keil 
@_subject: trans-proxy-tor and FreeBSD 
Does anybody on this list know where I could
find the creator(s) of trans-proxy-tor?
I'm trying to get it to work with FreeBSD 6.1 and PF,
and thought I could use the same settings as OpenBSD
does. Unfortunately I can't:
fk at TP51 ~/downloads/trans-proxy-tor-0.0.7 $sudo \
./trans-proxy-tor -b lo:1112 -s 127.0.0.1:9050 -v debug -f
Test connection succeeded to SOCKS4 server at 127.0.0.1:9050
Proxy listening on 127.0.0.1:1112
Accepting connection from 127.0.0.1:61466
_get_original_destination() failed at ./trans-proxy-tor line 238.
It's prematurely returning from _get_original_destination_pf in
line 167 because "ioctl $Pf, DIOCNATLOOK, $packed_pnl" didn't
satisfy defined(). I'd appreciate any ideas where to dig next.
BTW: Does anybody know whether trans-proxy-tor requires
support for INET6 in kernel and userland? I'm not using
INET6 and had to create
from /usr/src instead of /usr/include and although
I no longer get complaints from trans-proxy-tor, I'm
not sure if that really was enough.

@_date: 2006-06-09 11:17:26
@_author: Fabian Keil 
@_subject: trans-proxy-tor and FreeBSD 
I do now. The author also added contact information
at .
FYI: trans-proxy-tor 0.0.8 has just been released.
FreeBSD is now supported as well.

@_date: 2006-06-13 12:32:32
@_author: Fabian Keil 
@_subject: Firefox extensions and anonymity, TOR etc 
============================== START ==============================
I don't use Vidalia (I thought about it, but ATM the dependency on
QT4 is a big show stopper) and don't know what the PGP problem is
all about, but you could always ditch PGP and use GPG instead.
How is it possible to believe that those country wouldn't
run their "honeypots" from someplace else where they get
less attention.

@_date: 2006-05-19 11:39:32
@_author: Fabian Keil 
@_subject: P2P revisited. 
While it could motivate some people to run Tor on their servers
and thus adding capacity, I believe it's more likely that it
would motivate more people to block as much Tor traffic
as possible and lead to congestion of the network.

@_date: 2006-05-20 13:58:55
@_author: Fabian Keil 
@_subject: Threats to anonymity set at and above the application layer; 
I use a generated Firefox User-Agent string which is rebuild
every few minutes by .
While I don't blend in with the Windows using crowd, the User-Agent
is different for each website visit and therefore can't be used to
track my visits.
The website owner might notice that I don't surf
with a windows box, that I use Tor and probably Privoxy,
block cookies and don't execute his code, but I can live
with that and it's not enough information for a unique
The Host header is required for HTTP/1.1 and probably was already
present anyway. Adding X-Forwarded-For is unusual though.
I'm using several action files and get:
Header: New HTTP Request-Line: GET /links.html HTTP/1.1
Header: scan: GET /links.html HTTP/1.1
Header: scan: Host: 192.168.0.49:8000
Header: scan: User-Agent: Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.3) Gecko/20060506 Firefox/1.5.0.3
Header: scan: Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
Header: scan: Accept-Language: en
Header: scan: Accept-Encoding: gzip,deflate
Header: scan: Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Header: scan: Keep-Alive: 600
Header: scan: Proxy-Connection: keep-alive
Header: scan: Referer: Header: Referer:  (not modified, still on 192.168.0.49:8000)
Header: Modified: User-Agent: Mozilla/5.0 (X11; U; NetBSD i386; sk-SK; rv:1.8.0.3) Gecko/20060505 Firefox/1.5.0.3
Header: Suppressed offer to compress content
Header: crumble crunched: Keep-Alive: 600!
Header: crumble crunched: Proxy-Connection: keep-alive!
Header: Accept-Language header crunched and replaced with: Accept-Language: sk-sk
Header: addh-unique: Host: 192.168.0.49:8000
Header: Adding: Connection: close
I'm using minor Privoxy improvements
but they don't change the behaviour of the
X-Forwarded-For header.
ATM I believe most site owners only check the headers
which later show up in the Servers log file.
For example I think having a Accept-Language header which
matches the locale in the User-Agent is less important than using
a valid User-Agent and a valid Referer. I also think nobody cares
if my request headers have "Connection: close" or "Keep-Alive: 600"
Where do you see the difference if ads and cookies are blocked/modified
by Privoxy or by the browser? If the website owner is interested
if cookies are touched, she can still tell.
If the website owner really wants to know if Tor is used, he just
needs to check the ip address. A common Privoxy configuration wouldn't
change that.
Unfortunately there will never be an agreement what
a good default browser an proxy configuration looks like.
My idea of a good default configuration blocks all cookies,
doesn't execute any code and blocks all SSL connections
(as they circumvent Privoxy's filters), but lets the user
make exceptions for trusted sites.
The Mozilla project however thinks (and most of the other
browser creators agree) it's a better idea to execute every
code that comes along, to accept all cookies without telling
the users and saving them as long as specified.
As most of Firefox's user base read and believed Firefox
was "safe" and "protecting the user's privacy" they don't
touch the default configuration and happily surf without
privacy, assuming the opposite.
Even if the user later installs Privoxy, she probably uses a
weak configuration because otherwise "it breaks sites" and she
is too lazy to check the cause and find a real solution.

@_date: 2006-05-20 14:29:46
@_author: Fabian Keil 
@_subject: P2P revisited. 
Watson Ladd  top posted:
ISPs which offer flatrates but don't want them to be used as such.
Here in Germany many ISPs rate limit known P2P ports and are quite
happy if P2P users decide to leave. Less P2P users means less traffic
and more profit.

@_date: 2006-05-21 15:59:27
@_author: Fabian Keil 
@_subject: Threats to anonymity set at and above the application layer; 
"Ringo Kamens" <2600denver at gmail.com> top posted:
I seriously doubt that any judge will fall for that one.
Blocking all referrers or to rewrite them all to
the root web site is the easiest way _not_ to blend in
with the crowd. The referrer will be invalid most
of the time!
It's also not necessary: if you haven't changed
the host, your referrer doesn't give away any information
the web site owner couldn't gain by checking the server log.
It is sufficient to only block the referrer if the host has
changed. Not only that, it is also harder to detect, a web site
change looks as if the user followed a bookmark or typed/pasted
in the address herself; the following requests are all valid. Conditional blocking can only be detected if the web site is spread
over several hosts, but that's the only case where it isn't superior
to root site faking or generic blocking (which both would be detected
as well).

@_date: 2006-05-21 16:45:08
@_author: Fabian Keil 
@_subject: Threats to anonymity set at and above the application layer; 
"Ringo Kamens" <2600denver at gmail.com> top posted again:
That's not a good example. Faking the colour of your car takes a little
bit more effort and knowledge than to modify the User-Agent.
A better example would be a witness seeing a suspect with a hat
and sunglasses. If the suspect later has to defend himself at court,
his equivalent excuse would be: "Look, at the moment I'm wearing
neither a hat nor sunglasses, therefore it wasn't me".
The judge probably knows that getting a hat and sunglasses
(and dumping them after a crime) is quite easy.
If you are in the position to defend yourself, it means
there is already some evidence against you (or you are living
in a regime and nobody cares for your excuses anyway).
Not wearing a hat and sunglasses right now,
will not let them disappear.

@_date: 2006-05-21 18:44:47
@_author: Fabian Keil 
@_subject: "User.Actions" Template 
How do you convince your browser not to fetch
additional images and style sheet through HTTPS?
Not actively visiting untrusted HTTPS sites doesn't
stop anyone from spicing up his pages with HTTPS
content to get more information about his visitors.
Of course there is legitimate use for HTTPS, but that
doesn't mean one should allow all HTTPS connections
by default.

@_date: 2006-05-22 05:48:11
@_author: Fabian Keil 
@_subject: Threats to anonymity set at and above the application layer; 
They very well can, as long as they never revisit any website
with the same User-Agent.
Additionally regenerating the User-Agent frequently creates
noise in the server log files where other users of less often
used operating systems can hide in, even if they neither use Tor
nor know how to modify their own settings.
Can you be more specific, how one Tor users could be accused of being responsible for another one? Unless the Tor user is running an exit node
that's very unlikely. Am I missing something?

@_date: 2006-05-22 06:03:35
@_author: Fabian Keil 
@_subject: "User.Actions" Template 
Firefox is only concerned about security, not privacy.
You get the "mixed content" warning if you are visiting a
ssl encrypted site and click on a submit button which leads
to an unencrypted page.
Blocking all https sites with a few exceptions is no big deal.
I probably use less than twenty https sites, mostly online shops.
It's not as if I'm spending the whole day adding exceptions.
As these sites already have my full name, address and credit card
or bank account information, additionally telling them that I use
Firefox on FreeBSD is the least of my worries.

@_date: 2006-11-01 13:22:14
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
I think it's just a fact every Tor user should be aware of.
It sure is a disadvantage, but I don't see it as a reason to stop
using Tor.
Of course.
It's besides the point, but given the free alternatives I don't think
anyone should be using Skype anyway. Especially not users who care
about their privacy and system security.
If an ISP thinks it's a good idea to disallow Skype usage
in its terms of service and then tries to enforce this policy,
I don't have a problem with that.
If the user wants to use Skype, she should sign up with an
ISP with less unreasonable terms of service.
For Tor users this shouldn't be a big deal. I also don't see anything
exciting about Narus, I once saw a Squil presentation and if I remember
correctly it can do the basically the same.
Of course a patient person can already do the same thing with
less comfortable tools like tcpdump anyway.
Maybe if you care about privacy and don't use tools like Tor
to protect it.
Personally I think the frequent changes in wiretaping laws
are lot more frightening than the software to comply with them.
It was probably not clear enough, but I wasn't trying to say
that one shouldn't honour the ISP's terms of service. I'm just
saying that they aren't a valid reason not to run a Tor server.
They are only a reason not to run a Tor server in that ISP's
network (if you are interested in running a Tor server and I
know, you personally aren't).

@_date: 2006-11-15 16:47:56
@_author: Fabian Keil 
@_subject: Anonymous Blogging 
Remember that a LiveCD doesn't protect you against hardware key loggers. If you don't enable hide-forwarded-for-headers you are sending your
client's IP address to the web server. If you aren't using NAT,
this will obviously affect your anonymity.
This is probably the biggest issue, but of course most of Privoxy's
features are intended to make user tracking harder; if you disable
them you will be worse off then before, unless you find browser plugins
which do the same.
If you haven't already, you also might want to read Privoxy FAQ
"4.8. Can Privoxy guarantee I am anonymous?":

@_date: 2006-11-15 19:21:37
@_author: Fabian Keil 
@_subject: Anonymous Blogging 
It's usually in default action.
You can use:
to see how Privoxy is changing the request headers.
If you are using the setup jgt described (which is the default),
Privoxy should indeed only send 127.0.0.1. While this isn't enough
to compromise your anonymity by itself, it would still make user
tracking easier.

@_date: 2006-11-03 11:13:46
@_author: Fabian Keil 
@_subject: Connecting to special ports through Tor/Privoxy 
Some Privoxy configurations limit CONNECT to port 443
or block it all together. By default Privoxy answers those
request with an error message inside the HTTP headers because
some user agents get confused otherwise. If you use a browser
that hides HTTP headers, these error messages are obviously
easy to overlook.
You can just make an exception or disable limit-connect for all sites:
If you use Privoxy 3.0.5 beta you could also enable:
to get the standard HTML error message for blocked sites next time
you try to CONNECT to a blocked port. Please read the fine print
about its limitations first.

@_date: 2006-11-18 20:31:32
@_author: Fabian Keil 
@_subject: ff 1.5.0.7 & 2.0 (remote) dns leaks when using tor 
Can you reproduce the problem without any Firefox plugins that
influence the proxy settings?
A few weeks ago I shortly tested FoxyProxy and had similar experiences.
I used the "always use proxy xyz" feature to quickly switch between
different Privoxy versions, Firefox own settings were configured
to use Privoxy as well.
Directly after starting up, Firefox always ignored the proxy
settings and fetched some of the "live bookmarks" directly. The same
happened if there were still tabs open from a previous session.
I also had the feeling that it would randomly ignore the settings
later on, but I didn't use the plugin long enough to verify this.
I never used torbutton, but maybe it has similar problems.

@_date: 2006-11-03 14:42:34
@_author: Fabian Keil 
@_subject: Connecting to special ports through Tor/Privoxy 
As I already wrote above, CONNECT requests are limited to
port 443 (or blocked to every port) by default and as a result
attempts to CONNECT to port 8443 get blocked.
Which means the proxy-using browser will use HTTP CONNECT while
trying to open the SSL connection.
Usually HTTPS connections use port 443 which isn't blocked.
As mentioned above, the error message is send as HTTP header.

@_date: 2006-11-03 18:41:38
@_author: Fabian Keil 
@_subject: Tor and NNTP 
As this still relies on the users to get active and change their
settings it's probably a good idea to combine it with a Tor node that
allows (only) exits to your NTTP port.
This way Tor clients of lazy users should automatically pick
your node as exit and you can detect these requests on their
IP addresses as well. If I remember correctly this only works
from the second connection on, but I assume most of your user
use the first connection to fetch new articles anyway, therefore
this shouldn't be a problem.

@_date: 2006-11-01 14:02:21
@_author: Fabian Keil 
@_subject: Using Privoxy to increase the security level (was: reporter from 
Actually it's not, at least it shouldn't be.
If you visit the Privoxy website you will notice that
Privoxy isn't advertised as a protection against browser
While Privoxy has some mechanisms against a small set of IE exploits,
these exploits are known for several years and should be fixed in
any recent IE release anyway. I'm not aware of a single Firefox
vulnerability that didn't affect Firefox versions behind Privoxy,
and if there are any, these could probably be prevented by using
any other http proxy as well.
Usually browser vulnerabilities are the result of active scripting
bugs or content parsing problems. Privoxy's filtering capabilities
are far too limited to reliable protect the browser against these,
especially not in advance.
And even if Privoxy could do it: by the time someone implemented a
counter measure in Privoxy, the problem would probably be already
long fixed in the latest browser release.
If you want to increase your browser's security level,
use a reasonable default configuration and update regularly
to stay on top of known security problems. If you do that,
Privoxy is unlikely to increase your security level any further.

@_date: 2006-11-06 13:21:31
@_author: Fabian Keil 
@_subject: Using Tor under Parallels 
If I understand you correctly, you are trying to convice Firefox
inside Parallels to connect to Privoxy running on the host system?
If that's the case you will either have to bind Privoxy to a
non-local listen address or skim through the Parallels documentation
to see if there's another way to reach the host's 127.0.0.1 from
the guest system.

@_date: 2006-11-10 11:31:19
@_author: Fabian Keil 
@_subject: Vidalia 0.0.8 
Unfortunately it still ships with Privoxy 3.0.3 while 3.0.5 beta
is out for several weeks and brings some improvements that are
especially useful for Tor users.

@_date: 2006-10-07 15:16:00
@_author: Fabian Keil 
@_subject: To sniff the real data 
Don't put the sniffer between the Tor client and the world outside,
but between your Tor client and the Tor using program on the inside. If you are mainly interested in HTTP, you can use Privoxy
and enable header debugging (3.0.5 beta has some improvements
there), or Firefox' LiveHTTPHeader extension.
Note that if you use a HTTP proxy, a browser can't reliable
tell you which HTTP headers reach or leave your system.
Also note that Firefox tends to invent its own data
for some HTTP failures without displaying an error
message. For example if you open a new tab, and access
an URL where the chunk decoding fails, Firefox shows you
its about:blank page while still displaying the URL you asked
for. If connections time out, LiveHTTPHeaders sometimes show
you status code 200, even though the proxy didn't send it.
Konqueror (and probably some other browser) can also show you
HTTP headers, but I don't know how (un)reliable it works or if
it's possible to log them.
Tor does some kind of Network Address Translation, it's
easy to open a connection to get out, but you can't simply
reach the inside without invitation. Of course a bug inside your Tor client could open an entry,
but the same is true for every other program you run with
Internet access.
It's always a good idea to restrict Tor (and Privoxy and every
other program where it's possible) with Jails, systrace or something
like that, but I think usually the browser is the weakest link.

@_date: 2006-10-13 13:03:52
@_author: Fabian Keil 
@_subject: tor bandwith ratio 
Maybe using queues for prioritising empty ACKs would already
be good enough: It's PF and ALTQ specific, but the same can be done with other
packet filters.
Additionally you could give all Tor traffic a lower priority,
I think it would be a better solution than to set a hard bandwidth
limit in Tor, which most of the time would limit your server more
than necessary.

@_date: 2006-10-18 18:47:38
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
Which is nothing new.
I also think the title of the paper is intentionally misleading.
They aren't attacking Tor, but misconfigured applications
behind the Tor client.
The "surprising" result of their investigation seems to be that Tor
doesn't automatically fix all applications on the system it runs on.
Captain Obvious to the rescue.
Tor's documentation stresses several times that
Tor isn't a replacement for application level security.
It's also a good idea not to trust any exit nodes,
except the ones you run yourself.
This may be true in some environments, but certainly not always.
If you have to assume that someone in your local network is trying
to spy on you or alter your traffic, using Tor makes that a lot
less likely
I assume the old way (having all bots try to infect some other
nodes randomly) is much more effective than to only target IE using
Tor users. You are also less likely to get caught that way.

@_date: 2006-10-20 15:53:40
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
"I also think the title of the paper is intentionally misleading."
                  ^^^^^
I assume you mean the opposite of the last sentence?
Anyway, there will always be some people who don't
understand the documentation, or don't even bother to
read it. That's the case for every product and not a
Tor specific problem.
The risks of JavaScript, Flash and friends are mentioned
several times in the docs.
Why? Just because you can't trust a exit node, doesn't mean
you can't use it. You just have to be aware that unencrypted
traffic might have been altered.
That's a rather lame excuse. Even if your local ISP doesn't allow
you to run a Tor server, you can always get your own rootserver
and run your exit node from there.
That's right, but I'm not saying you should only use your own exit nodes.

@_date: 2006-10-23 12:48:48
@_author: Fabian Keil 
@_subject: Tor 0.1.2.2-alpha eventdns timeouts 
With Tor 0.1.2.2-alpha running as exit node on
FreeBSD 7.0-CURRENT I constantly get warnings
Oct 23 11:56:02.760 [warn] eventdns: Nameserver 10.0.0.4 is back up
Oct 23 11:56:21.183 [warn] eventdns: Nameserver 81.169.148.164 has failed: Bad response 2 (server failed)
Oct 23 11:56:23.770 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 23 11:56:31.185 [warn] eventdns: Nameserver 81.169.148.164 is back up
Oct 23 11:56:33.776 [warn] eventdns: Nameserver 81.169.148.34 is back up
Oct 23 11:58:47.232 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 23 11:58:48.867 [warn] eventdns: Nameserver 81.169.148.34 is back up
Oct 23 11:59:05.767 [warn] eventdns: Nameserver 81.169.148.164 has failed: request timed out.
Oct 23 11:59:15.802 [warn] eventdns: Nameserver 81.169.148.164 is back up
Oct 23 12:02:02.180 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 23 12:02:12.182 [warn] eventdns: Nameserver 81.169.148.34 is back up
Oct 23 12:08:50.727 [warn] eventdns: Nameserver 81.169.148.34 has failed: Bad response 2 (server failed)
Oct 23 12:08:53.062 [warn] eventdns: Nameserver 81.169.148.164 has failed: request timed out.
Oct 23 12:08:56.068 [warn] eventdns: Nameserver 10.0.0.4 has failed: request timed out.
Oct 23 12:08:57.148 [warn] eventdns: Nameserver 81.169.148.34 is back up
Oct 23 12:09:03.064 [warn] eventdns: Nameserver 81.169.148.164 is back up
Oct 23 12:09:06.074 [warn] eventdns: Nameserver 10.0.0.4 is back up
This always seems to happen if there are more than a few (<5)
DNS requests per second. Am I the only one seeing this?

@_date: 2006-10-23 14:22:36
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
My whole point is that you have to read the paper before it becomes
clear that there was no actual onion hacking involved. I'm aware
that the author knows that he didn't attack Tor, but this
doesn't change the fact that the title mislead me.
No, I'm saying that the title is misleading and I assume
this is intentional to get more attention.
If the paper was titled "Stating the obvious: as you already
know from reading the documentation, Tor isn't an intercepting
proxy and using a misconfigured browser has consequences", there
would be a lot less readers. While the author claimed to have found addresses of Tor clients,
he found addresses of the system where the browser is running,
and the addresses of the NAT system the browser is using.
In many (probably most) cases the browser and the Tor client
are running on the same system and share the same IP address,
but that's not guaranteed. Lets say I puplish a paper called
"Practical lock picking: opening closed doors",
whose content basically is: "I didn't find any flaws in the locks,
so obviously they are very well designed. I can't be bothered to
tell you which attacks I tried, but just believe me that I know
what I'm doing. So instead, I concentrated my efforts on the fact
that some people hide the key under a stone near to the door.
It's known to be bad practise, but some do it anyway. And oh my
god, my research shows that these keys can be used to actual open
the doors."
Do you still think the title would not be misleading?
After all everyone who reads the paper can tell that
there was no lock picking involved, and the subtitle is
true as some doors could be opened.
I don't see the "and still some are failing" part in your first
sentence and read "is not likely to have misconfigured or
misused Tor" as the opposite. But then again, English is
not my native language.
Fortunately you don't need much computer expertise to find
solutions like Anonym.OS, which while not being perfect,
are good enough in many cases.
And they constantly get what they deserve.
It was already a well known and documented fact that Tor exit
nodes can alter unencrypted traffic. And even if this wasn't documented,
just thinking about it would make it clear. It was also a well known
fact that (with or without Tor) running scripts or binaries in your
browser has it's risks and that Tor itself doesn't intercept traffic.
Even if I'd assume that most of the Tor nodes are compromised (I don't),
I would still use the network because AFAIK it's currently superior
to the other solutions.
I also doubt that those compromised nodes are especially after me,
or that they are all working together. If the whole path
runs through compromised nodes which are run by different attackers
that don't share their data, my anonymity isn't compromised.
In Germany the monthly fees for cheap root servers starts below 30?. Of course you don't even need a root server to run a Tor node,
many "virtual servers" work as well.
I'm not saying that Tor users without servers are second class citizens,
I'm saying that running your own server is the best way to increase
the number of nodes you can trust.
Anyone interested whether or not your IP address is currently in use
only needs to do a port scan. And if you can't trust your firewall
enough to work in cases where someone knows that your IP address is
in use, you should get a firewall that actually works anyway.
Your are right, but of course this depends highly on your justice system
and there are countries where running a Tor node involves less risks
than in other countries.

@_date: 2006-10-26 18:49:57
@_author: Fabian Keil 
@_subject: Tor 0.1.2.2-alpha eventdns timeouts 
I'll keep that in mind, thanks.
Is "timeout threshold is set too low, and the threshold for declaring
a server down is set too low" still the current analysis?
I increased global_max_retransmits and global_max_nameserver_timeout
from 3 to 5 and changed global_timeout from {3, 0} to {20, 0}.
As eventdns used to complaint from time to time about
"Bad response 2 (server failed)" and I didn't find a threshold
for these cases, I also added {0, 0} at the beginning of
global_nameserver_timeouts[], to make sure the server wouldn't
be ignored for ten seconds.
As a result I see indeed a lot less timeout warnings,
and the servers are declared active right away, but it
also looks as if the number of timeouts isn't reset
Oct 26 18:00:26.467 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 26 18:00:26.469 [warn] eventdns: Nameserver 81.169.148.34 is back up
[ten DNS requests successful]
Oct 26 18:00:35.962 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 26 18:00:36.017 [warn] eventdns: Nameserver 81.169.148.34 is back up
[thirteen DNS requests succesful]
Oct 26 18:00:55.992 [warn] eventdns: Nameserver 81.169.148.34 has failed: request timed out.
Oct 26 18:00:56.008 [warn] eventdns: Nameserver 81.169.148.34 is back up
I assumed that there should be at least global_timeout seconds
between the last successful DNS requests, and a DNS server being
marked as down because of timeouts?

@_date: 2006-10-26 21:05:36
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
I fail to see the similarities between willingly sacrificing
security and privacy for '"rich" experience' and caring about
ones family.
Of course you're right, but I assume the people you mentioned
wouldn't find and read this paper either.
If the target IP address is unused, the scanner gets an error
message send from the router located one hop before the target.
If the scanner doesn't get this error message, it's safe to
assume that the target system is running.
The packet filter can still protect all other ports and
increase the chances that the packets arriving at the Tor
running server are valid. The Tor server's host system can make sure
that a compromised Tor server doesn't cause too much damage.
As a OpenBSD user you will be aware of systrace,
other systems have similar tools.
I don't. But if by "random attacks" you mainly mean DoS attacks
I can see your point.
I didn't claim that.
Depending on your scan it probably wasn't Tor, but the underlying
OS which answered your scan. Of course this doesn't change the
fact that Tor doesn't operate invisible, but this shouldn't
be a major problem.
So they should see that you don't run a system with known vulnerabilities
and the best they can do is to run a DoS attack to clog your Internet
Running a Tor node probably increases the chances to get attacked a bit,
and if the connection to the Internet isn't good enough this might be
quite annoying, but for your security it shouldn't make a difference.
You don't have to use the same Tor process as server and client
and if such an attack was possible, your server wouldn't be the only
one affected and you would probably have connection problems anyway.
As mentioned before, if you think the risks for your local network are
too high, you can always get a dedicated server for Tor.
Even if this was true, this should only affect your decision to
use Tor at all and isn't specific to running Tor as a server.
And looking at larger open source projects I fail to see the
correlation between community size and security. Just have a look
at how long it takes for the average remote exploitable flaw in
PHP or Firefox  to get fixed.

@_date: 2006-10-26 21:22:04
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
AFAIK you don't have to run a Tor server to run a hidden service.

@_date: 2006-10-03 17:11:46
@_author: Fabian Keil 
@_subject: Tor not working 
Spin Doctor  top posted (please don't):
The easiest way to get this error message is not to start Tor,
or have it listening on another address than Privoxy is expecting.
Make sure that Tor is running and that its local address
is the one Privoxy is configured to use:
fk at TP51 ~ $lynx -dump  | grep socks4
   [46]forward-socks4a / 10.0.0.2:9050 .
fk at TP51 ~ $sockstat -4l -p 9050
USER     COMMAND    PID   FD PROTO  LOCAL ADDRESS         FOREIGN ADDRESS      256      tor        862   5  tcp4   10.0.0.2:9050         *:*

@_date: 2006-10-31 15:49:32
@_author: Fabian Keil 
@_subject: "Practical onion hacking: finding the real address of Tor 
Lets replace it with "shouldn't act surprised if they run into
problems" then.
Or you can use Tor and give every Tor exit node operator the chance
to render every "trusted site" that doesn't use encryption into
a source of malware.
It's useful to control software in general.
I thought we were discussing the (dis)advantaged of running
a Tor server in general. I don't intend to convince you personally
to run a Tor server, especially not if you don't even use the Tor
client regularly.
There are several valid reason not to run a Tor server at all,
I just don't think that "local security" or "ISP terms of service"
are among them.

@_date: 2006-10-04 00:22:10
@_author: Fabian Keil 
@_subject: Confused about Tor settings 
Probably a soon as someone provides patches.
In the meantime, just install dns-proxy-tor.
You can use trans-proxy-tor for that, or install 0.1.2.1-alpha.
Quoting I don't think it's in 0.1.1.24 already, but I may be wrong.
And if you don't use FTP anyway, you can just add an bogus
ftp proxy entry.

@_date: 2006-10-04 00:39:17
@_author: Fabian Keil 
@_subject: Tor not working 
Spin Doctor  top posted again:
If Tor was running and Privoxy was configured to use it,
you wouldn't see the error message for every request.
I also doubt that you are using a vanilla Privoxy configuration.
If you didn't change the configuration file, someone else did
it for you or your DNS settings are seriously broken.
I don't know what the "startprivoxy.command file" is supposed
to do, but from the name I would guess that it starts Privoxy
but not Tor.
Privoxy and Tor can operate on their own and it makes little
sense to control both with the same script.
Did you verify that you have a Tor process running?
Did you check Tor's log file as suggested by Roger and others?

@_date: 2006-10-04 01:06:21
@_author: Fabian Keil 
@_subject: Setting up hidden services on Tor server. 
Adding additional HiddenServiceDir and HiddenServicePort entries
should be good enough. Quoting Tor's man page:

@_date: 2006-09-08 10:36:58
@_author: Fabian Keil 
@_subject: confiscating middleman-tor-nodes 
Middleman? Plural?
This is about one single hard disk being confiscated.
It happened before (maybe not in Germany),
and it will happen again.
The original post has been edited twice and at
the moment it states that the poster assumes he
run an exit node.
I have not and I don't see any reason to panic.

@_date: 2006-09-15 16:21:49
@_author: Fabian Keil 
@_subject: Tor Server on Live CD? 
offset  top posted:
I haven't tried it either, but as far as I can see it's just a
bunch of binaries and requires a trusted host operating system.
For knowledgable Windows users it might be safe to use on their
own systems (provided the torpark itself isn't compromised
of course), for the rest of them not even there.
And if you plan to use it with a Windows Live CD,
you might as well put it on the disc itself. Its
promise is not to safe anything.

@_date: 2006-09-01 12:18:02
@_author: Fabian Keil 
@_subject: Tor 0.1.2.1-alpha is out 
Probably your setup is incomplete. I just tested
./configure with cygwin and it run until the check
for libevent (which I haven't installed because I
don't intend to run Tor on Windows).
That's not the right file, the Makefile is generated
by configure and you shouldn't have to specify it at the
command line.
Is there a reason to use MinGW at all?
Like Watson already said, you could try cygwin instead.

@_date: 2006-09-17 15:28:06
@_author: Fabian Keil 
@_subject: information about cenzorship in Slovenia 
What is illegal about asking some providers to block some sites?
By the way, older members of the EU are (or were?) fond of
DNS blocks as well. NRW, Germany for example.
Also my impression is that the European Court didn't rule that
across-border gambling is legal in the whole EU, but that
restrictions are only allowed if they happen in the public interest:
(I'm aware what bwin Interactive Entertainment AG does,
but the description makes sense to me.)
The Chinese government's censorship is done without
breaking Chinese law isn't it? Of course it still sucks,
but I don't see why it should be called illegal.

@_date: 2006-09-17 18:18:50
@_author: Fabian Keil 
@_subject: Privoxy alternatives 
What does "navigation stops anyway" mean exactly?
Which operating system do you use?
Anyway, if you already disabled filtering and if you are
using socks4a, it's unlikely that Privoxy is the cause of your
Using Tor isn't going to make your browsing faster.
Squid isn't an anonymous proxy at all (and neither is Privoxy).
How is Squid's cache going to make your browsing faster?
Doesn't have your browser its own cache already?
You could replace Privoxy with another proxy that supports
socks. Check the archive for a recent discussion about Polipo
, it seems
to be the current recommendation of at least one of the
Tor developers.
Polipo is a caching proxy with limited header filtering
capabilities, if you don't need content filtering, you probably
can remove Squid from your proxy chain as well.

@_date: 2006-09-01 12:18:02
@_author: Fabian Keil 
@_subject: Tor 0.1.2.1-alpha is out 
Probably your setup is incomplete. I just tested
./configure with cygwin and it run until the check
for libevent (which I haven't installed because I
don't intend to run Tor on Windows).
That's not the right file, the Makefile is generated
by configure and you shouldn't have to specify it at the
command line.
Is there a reason to use MinGW at all?
Like Watson already said, you could try cygwin instead.

@_date: 2006-09-19 00:09:11
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
Just in case you wondered whether Tor and Gmail are a good
combination: They are not.
I did some testing with Privoxy's cvs version and this filter:
FILTER: googlemail Hides sponsored links with css and shows why insecure mail transfer is a bad idea.
s at i
s at easy( to switch to Google Mail) $1 and transfer mail unencrypted to make sure everbody is reading it at gi
s at Foo bar at Mail integrity compromised! Yay for GMail.@
s at different
together with these action sections:
{-block \
 -crunch-incoming-cookies \
 -crunch-outgoing-cookies \
 -filter{content-cookies} \
 -filter{img-reorder} \
 -filter{webbugs} \
 -filter{frameset-borders} \
 +filter{googlemail} \
 -filter-client-headers \
 -filter-server-headers \
{+redirect{ \
{+limit-connect{443} \
(My original mail's content is "Foo bar" of course.)
More information (in German):
About 0.3% of my Tor exit nodes' users seem to consider using
Gmail with Tor a good idea. I suggest they reconsider.

@_date: 2006-09-19 01:07:17
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
yancm at sdf.lonestar.org top posted (please don't):
Yes, and some info means everything but your password.
And even if you enter through a man in the middle can send your browser a redirect to
 Google then sends your browser
another redirect to the encrypted login page on another
server and after the secured login you will get redirected
back to Firefox/1.5.0.7 honours an unencrypted redirect
as response for a https connection request.
You don't get a warning, but of course if you look for it,
you can see that the connection is unencrypted.
At that point, however, the man in the middle already has your
authentication cookies and I would be surprised if he
couldn't take over the session. Of course that'll require
greater efforts than some regular expressions.

@_date: 2006-09-19 18:11:44
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
Any site that keeps the whole session encrypted and
doesn't use redirects based on user supplied URL parameters
is not affected.
The problem is specific to a broken "security" concept
and while there are probably a few websites with similar
problems, you shouldn't have a problem finding one that gets
it right, after all that's common sense since the invention
of HTTPS.
You can easily test for yourself if a website is affected.
Use Privoxy to disable HTTPS after you successfully logged
in. If you can still transfer privacy-sensitive data,
you know that the site is broken.
I can't comment on different web based email services
because I don't use them. This short test was an exception
to see which Privoxy filters have to be disabled to get
GMail working.
It wasn't my account and I would never trust
Google to take care of my data anyway.
For me a quick look at their terms and conditions
already is reason enough to stay away from them.

@_date: 2006-09-19 18:31:27
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
I don't intend to post anonymously on this list and
I'm well aware that my website contains information
about where I live and how anyone interested can
reach me. That's intentionally as well.
I use Tor to surf the web anonymously, but if I say
something in public I usually use my real name. For
the topics I'm interested in, that's currently not
a problem in Germany.
I still use encryption for privacy-sensitive information
and if you run a Tor exit node, you will not be able to
alter my mails without getting noticed.
Personally I think using Gmail is never a solution.
You are right though: if you are using a real mail client
with real encryption, you shouldn't have a problem with
man in the middle issues.

@_date: 2006-09-19 18:39:49
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
You're welcome.
I don't consider this a Firefox problem and if you
don't use broken sites the redirect isn't an issue.
Also I don't have the feeling that privacy is a
high priority for the Firefox team anyway, just have
a look a the default configuration.
Feel free to report this as Firefox bug, but as this
doesn't affect me and as I could easily use Privoxy to disable
redirects for untrusted sites, I'm not going to do anything
about it my self.

@_date: 2006-09-19 18:50:32
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
Tim McCormack  top posted (please don't):
Depending on your browser setup, a man in the middle just has to
redirect you to  or directly to Google's
login page and the situation is the same. You can easily overlook
a few redirect, they usally take less than a second and Google uses
lots of redirects anyway.
This isn't a Tor problem at all, in an insecure network environment the
same could be done. An exit node is just an convenient position to
start this attack, it's cheap to run one and if you only sniff traffic,
it's unlikely to get caught.

@_date: 2006-09-19 19:19:53
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
The redirects I'm talking about are basic HTTP features
and don't depend on JavaScript at all.
It's possible to emulate redirects with JavaScript,
but if an attacker is already in the position to run code
on your system, she probably has better things to do than
just to redirect you.
If you want to see how a redirect looks like,
use a Privoxy section like:
{-limit-connect \
 +redirect{ \
Enter  in your browser
and see what happens. If you are still using Privoxy 3.0.3
{+block \
 +handle-as-image \
 -limit-connect \
 +set-image-blocker{ \

@_date: 2006-09-22 12:54:53
@_author: Fabian Keil 
@_subject: Using Gmail (with Tor) is a bad idea 
I missed something here: in my test Firefox was already
configured to use Privoxy as SSL proxy, which means
it has to ask the proxy to connect to the SSL server.
As this happens with an unencrypted request,
the client also accepts an unencrypted response.
Most likely the client does not accept an unencrypted
redirect while trying to open a direct SSL connection
(without any proxy involved).
It might not even work, if the man in the middle isn't
already located between SSL proxy and browser. If this
is true, a Tor exit node wouldn't be the right place
to send these bogus redirects.

@_date: 2007-04-23 18:43:11
@_author: Fabian Keil 
@_subject: Open DNS 
I think there's a fair chance that the OP only wanted to reach OpenDNS
through Tor for himself, and never intended to force OpenDNS upon other
Tor users through an exit node.

@_date: 2007-04-26 20:19:25
@_author: Fabian Keil 
@_subject: Accept-encoding: gzip 
The Accept-Encoding header doesn't affect the encoding
of the headers, so there's no reason why it should make a
difference for header modifications.
I don't think so. It certainly makes fingerprinting
your requests easier, though.
If you don't want to receive compressed content,
you should either set the Accept-Encoding
header to "identity", or send no Accept-Encoding
header at all.
Have a look at section "3.5 Content Codings"
in: if you're interested in the details.
Of course if there is no reason not to accept
compressed content, it makes sense to just leave
the client's encoding settings alone.

@_date: 2007-04-11 21:26:21
@_author: Fabian Keil 
@_subject: Importance of HTTP connection keep-alive (was: Is this for 
Is this an assumption or did you just forget to show
your benchmarks to back this claim up?
Actually you can use connection keep-alive without tossing
Privoxy. Just put Polipo between Privoxy and Tor (be aware
that using another proxy behind Privoxy will render some of
Privoxy's actions useless, though).
My impression is that keep-alive (in the setup described
above, and without Privoxy in the chain) doesn't buy you
enough to be noticeable.
Of course adding Polipo to the proxy chain has other
advantages, I didn't do any scientific benchmarks either,
and I may be biased.
I used Privoxy's CVS version to measure the effects of not
having to use prevent-compression for filtering, though:
fk at TP51 ~ $head -n 15000 /usr/jails/privoxy-jail/var/log/privoxy/privoxy.log | grep Decomp | privoxy-log-parser    16:50:26.413 0815c700 Re-Filter: Decompression successful. Old size: 1147, new size: 2763. (saved: 58.49%)
16:50:27.125 0815c800 Re-Filter: Decompression successful. Old size: 5007, new size: 20885. (saved: 76.03%)
16:50:27.704 0808e900 Re-Filter: Decompression successful. Old size: 623, new size: 2145. (saved: 70.96%)
16:51:48.746 0815c900 Re-Filter: Decompression successful. Old size: 6104, new size: 26928. (saved: 77.33%)
16:57:07.983 0815c900 Re-Filter: Decompression successful. Old size: 29972, new size: 148272. (saved: 79.79%)
16:57:08.745 0815c600 Re-Filter: Decompression successful. Old size: 24125, new size: 113632. (saved: 78.77%)
16:57:16.002 0815ca00 Re-Filter: Decompression successful. Old size: 30392, new size: 150126. (saved: 79.76%)
16:57:17.475 0815c100 Re-Filter: Decompression successful. Old size: 15979, new size: 78088. (saved: 79.54%)
16:57:42.869 08156000 Re-Filter: Decompression successful. Old size: 18927, new size: 86616. (saved: 78.15%)
16:57:50.084 0808e700 Re-Filter: Decompression successful. Old size: 23686, new size: 115163. (saved: 79.43%)
16:58:32.836 0815c400 Re-Filter: Decompression successful. Old size: 30261, new size: 141889. (saved: 78.67%)
17:15:53.644 0808e700 Re-Filter: Decompression successful. Old size: 5318, new size: 22906. (saved: 76.78%)
17:22:20.633 0815c100 Re-Filter: Decompression successful. Old size: 7351, new size: 36324. (saved: 79.76%)
As receiving compressed content seldom saves less than 50%,
I assume that for Privoxy 3.0.6 (chained with Tor) the missing
zlib support is a much bigger slow-down factor than the missing
support for connection keep-alive (if that's a slow-down factor
at all).

@_date: 2007-04-17 15:47:17
@_author: Fabian Keil 
@_subject: My ISP block Tor Servers 
Are you sure the blocks are intentional targeted
against Tor and don't have other reasons (some overly
aggressive heuristic to block worms for example)?
If your ISP is intentionally blocking Tor and the contract
allows it, I assume the most effective bypass will be
to switch ISPs. Unless your ISP has a monopoly I don't
see a reason to pay for its censorship.
If you can't or don't want to switch ISP you could
rent a server with uncensored net access and use
it as proxy.
There are different example configurations in the Tor FAQ.

@_date: 2007-04-18 15:03:49
@_author: Fabian Keil 
@_subject: Importance of HTTP connection keep-alive 
No, you tested wget, which doesn't do parallel requests.
The results are certainly interesting and may or may not
show the difference between serialised requests that are
done with and without keep-alive, but the numbers are worthless
to make any assumptions about web browsing.
Any modern browser I'm aware of uses multiple parallel
connections if keep-alive isn't used, Firefox certainly does.
I have no reason to doubt your results, I just don't
think they are relevant for web browsing.
I just did some tests which I think are more meaningful.
I used Firefox instead of wget, used the Fasterfox plug-in
to time the requests and tried several proxy combinations.
The versions were Tor 0.1.2.9-rc, Firefox 2.0.0.3,
Polipo 0.9.99.1 and Privoxy's CVS version with some
uncommitted modifications which should be irrelevant
for this test.
I didn't change my Privoxy configuration, which means
there were several actions active, some of which effected
the results.  contains
no ads or tracking pixels, so filtering the page causes
a delay without any gain.
The test was done on a laptop with FreeBSD's powered(aemon)
running. As a result the CPU frequency wasn't constant,
but I doubt that it mattered for the end results.
I first did five tests for every proxy combination,
switching the proxy combination after each request.
Requests where started with ctrl+F5 so Firefox didn't
use its cache and additionally set the headers
"Pragma: no-cache" and "Cache-Control: no-cache".
I started Polipo with:
polipo diskCacheRoot='' socksParentProxy=10.0.0.2:9050
and restarted it for every test. I kept Tor and Privoxy
running all the time.
Finally the numbers, the format is:
With Firefox + Privoxy + Polipo + Tor:
40.950s, 6.100s, 6.294s, 24.290s, 56.680s
Firefox + Privoxy + Tor
59.523s, 7.493s, 6.822s, 156.438s, 35.282s
Firefox + Polipo + Tor
14.558s, 38.840s, 12.100s, 5.548s, 26.370s
I also tested with another website (
Firefox + Privoxy + Polipo + Tor:
155.674s, 46.256s, 141.360, 47.120s, 35.967s
Firefox + Privoxy + Tor:
110.619s, 78.505s, 20.397s, 36.926s, 73,442s
Firefox + Polipo + Tor:
93.979s, 33.102s, 34.242s, 123.365s, 99.740s
Privoxy may have had a slight advantage here,
because by removing three tracking pixels it had
to do three requests less. However I think that
it didn't matter much.
The speed of the underlying Tor circuits seems
to be the most important factor here and five
samples probably aren't enough to prove anything.
It certainly looks like keep-alive's effects aren't
big enough to guarantee faster web browsing through
Tor, though.

@_date: 2007-04-18 20:17:02
@_author: Fabian Keil 
@_subject: Importance of HTTP connection keep-alive 
It certainly did for the five samples I took.
What exactly is the problem with the site?
Watching the circuits in Vidalia I had the impression
that Polipo used keep-alive.
To which numbers are you referring here? Repeating my results:
Firefox + Privoxy + Tor:
110.619s, 78.505s, 20.397s, 36.926s, 73,442s
Firefox + Polipo + Tor:
93.979s, 33.102s, 34.242s, 123.365s, 99.740s
So Polipo+Tor were slightly slower, while the reason seems
to be bad luck with the speed of the Tor circuits.
However if I understand you correctly, you're saying
that I intentionally chose a site where Polipo has
Can you name some other sites that you consider valid targets then?
I can test again with Privoxy's actions disabled.

@_date: 2007-04-22 14:59:33
@_author: Fabian Keil 
@_subject: privoxy + ssh socks proxy 
Privoxy supports socks4 and socks4a only, but I believe
that ssh only supports socks5. It may also supports socks4,
but last time I checked it didn't support socks4a.
If you want to reach some websites directly (without Tor),
it would probably be the best solution to move Privoxy to
the system that is already running Tor, and use stunnel
or ssh port forwarding between Squid and Privoxy.
If you want to use Tor for every web connection anyway,
you might as well use stunnel or ssh port forwarding
between Privoxy and Tor.

@_date: 2007-12-01 14:50:14
@_author: Fabian Keil 
@_subject: Maintanance of TOR for FreeBSD 6.2 
I assume it hasn't been updated yet because the ports
tree is frozen in preparation for the next releases.
Also if the port's Makefile is out of date, it's usually
less work to update it yourself instead of messing with
the source tarballs directly.
Check the Makefile:
fk at TP51 ~ $grep MAINTAINER /usr/ports/security/tor/Makefile
MAINTAINER=     nivo+kw+ports.bfa274 at is-root.com

@_date: 2007-02-07 15:47:04
@_author: Fabian Keil 
@_subject: Forcing firefox to keep a connection alive for reuse 
I don't see the contradiction here, but you're not mistaken.
Privoxy doesn't initialise persistent connections by itself,
doesn't pipeline anything and doesn't allow the client to do it either.

@_date: 2007-02-08 21:48:32
@_author: Fabian Keil 
@_subject: About http request  of browser. 
It's not a problem to use a less common User-Agent string,
as long as you regenerate it between visits.
Have a look at:
if you're using Privoxy and/or a browser that understands
Mozilla prefs.js files.
You might also want to have a look at the or-talk
archive, your discovery isn't exactly hot news here.

@_date: 2007-02-12 13:27:26
@_author: Fabian Keil 
@_subject: tor proxy chain 
May I ask why?
What kind of proxy is "proxy_choosen_by_me"?
I'm not aware of a proxy standard that would work
the way you described. It certainly wouldn't work
with HTTP forwarding proxies.
And while I'm not sure, I also believe that
Firefox can't access other HTTP proxies through
socks proxies anyway.
If that's true, you need an additional proxy
before Tor, for example:
Firefox -> Privoxy -> Tor -> another HTTP proxy -> web site
would work.
Most of the time, however, using a proxy after Tor makes
no sense as it usually reduces your anonymity level again
(the IP address the target website sees doesn't change).

@_date: 2007-02-12 16:52:30
@_author: Fabian Keil 
@_subject: tor proxy chain 
You're welcome.
Probably the easiest way to do this is to add Privoxy to the
proxy chain, have the Perl script use Privoxy as HTTP proxy
and let Privoxy do the rest.
I currently use something similar for testing purposes,
the Privoxy config line looks like this:
forward-socks4a         .freebsd.org/        Tor-Jail:9050           tor.fabiankeil.de:8118
Requests that match ".freebsd.org/" are forwarded
through the HTTP proxy "tor.fabiankeil.de:8118"
(another Privoxy) and the connection to that proxy
is made through the socks4a server "Tor-Jail:9050" (Tor).
As mentioned earlier, from a anonymity point
of view this isn't the smartest setup. It increases
the chances that the traffic is sniffed or altered
and the target server always sees the same IP address.
You could also try to find a Perl module that can
reach HTTP proxies through socks4a servers. If you
find one (and aren't already using Privoxy anyway)
this should be even easier to set up, provided you
also find documentation for it.
A third way would be to configure your Perl script
to use a HTTP proxy and then intercept and redirect
these requests through Tor.
I recommend you use dns-proxy-tor, PF and a recent Tor
alpha version to set up the interception proxy, but the
programs John mentioned should work too.

@_date: 2007-01-16 16:02:33
@_author: Fabian Keil 
@_subject: Chunked must be last Transfer-Encoding problem 
[Line lenght adjusted]
I can't reproduce this here, but "WWW::Mechanize" sets
"interesting" header values that could cause problems
like this.
"Connection: close, TE" and "Accept-Encoding: identity"
aren't exactly by the book and if you got the time,
you might want to ask the "WWW::Mechanize" authors
to fix them.
If I remember correctly, "identity" existed in earlier drafts
of the HTTP standard but got (partly) removed in the final one.
It was supposed to mean "no encoding" which is equal to simply
not specifying any encoding.
What's a bit ironic here is that Privoxy versions before
3.0.5 beta had a similar bug and set "Transfer-Encoding: identity"
after dechunking.
It was discovered because it broke "WWW::Mechanize".
Tor itself doesn't alter HTTP headers but some Tor server
operators consider it a good idea to proxy, rewrite or filter
your requests behind your back and/or to provide you with modified
or outdated content.
The error message you got could be the answer of an
intercepting proxy running on the Tor exit node that
didn't like the request headers. It could also be the answer
of the target server, but at least for me ignores the broken headers. It also wouldn't explain why it
worked for you without Tor.
If you activate header logging in Privoxy (debug 8)
you might be able to decide where the answer really
came from.
In any case, using Privoxy's prevent-compression action
should work around the problem, unless your "WWW::Mechanize"
version has different defects than mine.

@_date: 2007-01-19 13:15:07
@_author: Fabian Keil 
@_subject: Privoxy setting blocking Yahoo mail logout 
Please report Privoxy problems to the Privoxy project
directly, unless you are sure the problem only exists in
the Privoxy version that is shipped with the Tor bundle.
Anyway, to really fix the problem (instead of hiding it by
disabling yahoo redirects alltogether) we need to know
how a yahoo logout URL looks like and how a non-intercepted
request for it is answered.
I guess now that the thread is already open it doesn't
hurt if you provide this information here as well,
otherwise you could add it to this tracker:

@_date: 2007-01-19 17:02:31
@_author: Fabian Keil 
@_subject: Privoxy setting blocking Yahoo mail logout 
Can you please check if it still works if the request to
us.ard.yahoo.com is intercepted and redirected to the URL
If I open it, I get a message that I "signed out of the
Yahoo! network", however I don't have an Yahoo account and
was never signed in, therefore I can't verify if skipping
us.ard.yahoo.com would be safe.
Yahoo doesn't bother to validate the URL parameters
and use the "Return to Yahoo! Mail" link) so maybe they
don't verify whether or not you're really signed out either.
Also note, and this is Tor related again, that every time
you run into a Privoxy fast-redirect problem it means that
your request was unencrypted and could be sniffed or altered
by the Tor exit node or systems between the exit node and
the destination.
You may want to investigate whether or not Yahoo allows
you to accidentally send your Email unencrypted (like Google does)
and if the session cookies are transferred encrypted.
While this problem affects all Yahoo-mail-using Tor bundle
users it also affects Yahoo-mail-using Privoxy users that
don't use Tor. If it gets fixed upstream both groups profit.
I agree that the problem should be fixed, I just don't think that
blindly disabling all yahoo redirects is a solution.
With Privoxy 3.0.6 you can add:
{+redirect{ \
{-fast-redirects \
in your user.action file, with Privoxy 3.0.7 (unreleased)
you can even replace the static redirect with:
+redirect{s at i}
to make sure it works for other "done" URLs as well.
If someone can confirm that this is safe, we (the Privoxy team)
will ship it with Privoxy 3.0.7's default configuration.

@_date: 2007-01-21 16:21:02
@_author: Fabian Keil 
@_subject: Privoxy setting blocking Yahoo mail logout 
"A. L."  wrote [quoting adjusted]:
I wasn't worried about missing parameters,
but there was a small chance that every part
of the redirection chain was required a do
a proper log out.
With the fix I posted, us.ard.yahoo.com
is never contacted by the browser and if
this step was necessary, the user would
think she is logged out while in reality
she isn't.
Anyway, if you can confirm that the log
out really happens, the redirect can stay
(it's already in cvs).
Yes, sniffing would be one way to detect whether or not
the mails are passed encrypted. You just have to make
sure that you sniff the data before it's passed into Tor.
Another option would be to increase Privoxy's
debug level and check the log file for traces of
data that shouldn't be visible to Privoxy.

@_date: 2007-01-28 15:33:06
@_author: Fabian Keil 
@_subject: TorK 0.13 Released - Many new features 
I only see kde-devel, xorg-dev, libqt4-dev and KDE 3.5.3
listed as build requirements.
Does this mean the dependency on a GNU/Linux build
environment is gone now?

@_date: 2007-01-28 16:05:58
@_author: Fabian Keil 
@_subject: more letters from the feds 
I think it would be interesting to know if any single person
in Germany got more than one letter, or first a letter for one
investigation and than a personal visit for another one.
If you get the friendly letter to give up information about
your clients it already means you aren't considered a suspect.
If this decision isn't made arbitrary, it should be always the same
and someone who already got one of the service provider letters
could feel more comfortable than one who hasn't heard anything
from the authorities yet.
Of course it's a decision everyone has to make himself,
but I for one wouldn't mind answering the letters now and

@_date: 2007-01-28 16:31:18
@_author: Fabian Keil 
@_subject: more letters from the feds 
I guess the most obvious and perfectly legitimate thing to
use exit nodes for is anonymous communication on the net.
I don't understand how using hidden services would take
off any load though. If a hidden service does the job
of an exit node you might as well consider it as one.
After all it's request IP address will be visible to
the public in which case the risk for the operator
stays the same (unless requests are routed through
the Tor network again, in which case it would only
add latency).

@_date: 2007-01-03 14:32:39
@_author: Fabian Keil 
@_subject: Transparent proxy won't work with mingw under win32 
Tor doesn't intercept the packets itself, but relies on
a packet filter to do it. Of course Tor also has to know
the real destination of the intercepted packets and therefore
has to interact with the intercepting mechanism. In other
words it "only" works for the supported ones and you can't
just use every packet filter out there.
I don't know if Windows itself can intercept and redirect packets,
but even if it can, I would assume that it doesn't use
one of the mechanisms supported by Tor (PF, natd and iptables
if I remember correctly).
I heard that PF was ported to Windows, but I don't know
if the ioctl interface was ported as well, probably it
wasn't. You might look into it anyway, if the ioctl
interface is available it should work.
By finding a redirecting mechanism that works on
Windows and teaching Tor how to interact with it.
Of course the first question isn't "how", but "is it
worth the time". For someone who doesn't use Windows
the answer is probably no and the easiest way to
"fix" it would be to send a working patch to the developers.
Note that I'm not a Tor developer and this isn't
an authoritative response.

@_date: 2007-01-03 16:15:52
@_author: Fabian Keil 
@_subject: Letter from the feds 
I run Zwiebelsuppe and Zwiebelkuchen.
I got a similar letter about two weeks earlier,
but the language was quite polite and no punishment promised.
The BKA was interested in the person who used my exit nodes
at the 26th of October, 6:40 PST, so I guess the thought
crime offender was the same.
I explained what Tor does and why German law forbids me
to log the information they wanted and haven't heard
anything back so far.
Unfortunately you'll still have to pay the lawyer yourself.

@_date: 2007-01-04 18:44:11
@_author: Fabian Keil 
@_subject: Transparent proxy won't work with mingw under win32 
ipfw and PF are different packet filters.
The PF port for Windows seems to be part of
a program named "Core Force":
I didn't find any information about the license
(except that they call it "free"), or if it comes with
header files and ioctl support, but I didn't spend too
much time on the page and may have overlooked it.

@_date: 2007-07-22 15:09:37
@_author: Fabian Keil 
@_subject: is this a bandwidth problem? my IP is a TOR exit, the client 
Remote Tor checks usually only confirm that your request is coming from
a known Tor exit node, they don't confirm whether or not your using
socks4 or socks4a. Are you sure you're using the latter?
I don't think this is related to your hidden service problems.
While it could also be a NAT problem, I wouldn't rule out a firewall issue.
Check your Tor logs. A failed request for a hidden service should
result in something like:
Jul 22 14:28:10.086 [notice] Tried for 120 seconds to get a connection to hy2644uxnz6zwt6c:80. Giving up. (waiting for circuit)
Jul 22 15:07:26.829 [notice] Rend stream is 120 seconds late. Giving up on address 'hy2644uxnz6zwt6c.onion'.
If there are no such messages you may not be using socks4a.
With a socks4 (no "a") connection between Privoxy and Tor
you would still pass remote Tor checks, while your DNS requests
could be done through a standard name server which wouldn't
resolve onion domains and might explain the error messages.
You could also try opening "example.noconnect". If it leads
to the same error message you're not using socks4a.
Additionally you could build Privoxy 3.0.7 from CVS to get a
less useless error message in case of forwarding failures.
It wouldn't solve the problem, but might make diagnosing it

@_date: 2007-07-22 19:29:14
@_author: Fabian Keil 
@_subject: is this a bandwidth problem? my IP is a TOR exit, the client 
There's nothing wrong with the dot. It indicates that
there's no HTTP proxy after the socks proxy.
That's because invalid configuration directives are ignored
(and valid forward-socks4a directives end either with a dot
or with a HTTP proxy address).
Have a look at:
to see which of your configuration directives are ignored.
At least you had it at "Jul 22 23:53:09:137" ...
I think you messed up your Privoxy configuration file
while debugging this issue.
So this hidden service appears to be working.
This hidden service doesn't work for me either,
maybe it's just not running.
That's probably because none of these lines use correct syntax
(and the second one is probably wrong anyway as it would overrule
the first one and it's unlikely that Tor is listening at port 8118).
The configuration file of the official Privoxy release
should contain the same (valid) lines as:

@_date: 2007-06-24 12:20:09
@_author: Fabian Keil 
@_subject: HTTP response is "Connection: close" 
This can happen with Privoxy versions before 3.0.7 and a server or
proxy before Privoxy that simply sends nothing. You should be able
to reliable reproduce it by using Tor's .noconnect special host name
(although it's a slightly different case).
As far as Privoxy is concerned, this has been fixed in:
However, this of course only replaces the confusing "Connection: close"
string with a more reasonable problem description. The real problem
happens earlier in the proxy chain and you still have to retry manually.
Like Andrew, I assume the real problem is a malfunctioning
intercepting proxy on the exit node, so there's little you
can do about it.

@_date: 2007-06-25 19:09:57
@_author: Fabian Keil 
@_subject: HTTP response is "Connection: close" 
It's my impression that the OP can detect that and throws a socks error.
If, however, there's a broken intercepting proxy it would explain
why the OP doesn't notice.
The responses in question are completely empty, there's not a
single HTTP header and of course the nothingness isn't chunked
I get the impression that Polipo forwards them as empty page
and puts some headers on top. At least I'm currently running
Privoxy->Polipo->Tor as default proxy chain and from time to
time I get empty pages that pass Privoxy's trivial no-data check.
Refreshing with CTRL+F5 usually results in the real page.
I neither verified that it's the same problem, nor did I check
how the requests look like before they reach Polipo or after
they are processed by it, but the symptoms would fit.

@_date: 2007-06-03 16:30:49
@_author: Fabian Keil 
@_subject: Compile TOR 0.1.2.14 under FreeBSD 
Note that security/tor will be without maintainer after:
Just in case someone wants to volunteer ...

@_date: 2007-06-13 19:14:45
@_author: Fabian Keil 
@_subject: Problem logging out of yahoo mail over Tor 
Your problem description is pretty vague, but if by "package" you mean
the Tor Vidalia bundle that also contains Privoxy, this might be related to:

@_date: 2007-03-10 16:17:09
@_author: Fabian Keil 
@_subject: Stripping code with Privoxy (was: Warnings on the download 
There are too many different ways to embed or reference
code in HTML. Creating such a Privoxy filter would take a lot
of time and I doubt that it would ever work reliable enough to
be remotely useful, even if you ignore the fact that it would
only work for HTTP anyway.
The filter would only remove the stuff its creators knew about,
and while that may (or may not) be a lot, it would still default
to permit.
Default permit is OK when it comes to blocking ads and other minor
annoyances, but it's a really bad idea when it comes to security: If people wouldn't want this stuff, they shouldn't install the plugins
in the first place and disable remote code execution in the browser.
Don't want to get owned because of Java, PDF, flash or whatever?
Just don't install the plugins.
Can't trust your browser if JavaScript is enabled? Just disable it.
It's that simple.

@_date: 2007-03-25 21:06:39
@_author: Fabian Keil 
@_subject: Free Software and Torpark (was: Ultimate solution) 
The terms "free software" and "open source software" have been
around for a while and so has there meaning. No one said Torpark
wasn't delivered free of charge or that its source wasn't open for
Torpark's license just doesn't give the user enough rights to
call Torpark either free software or open source software
without causing confusion, raised eyebrows or being laughed at.
So it's totally free, except that it isn't. You're also not giving it
away to the public, you're only giving it to those parts of the
public you don't discriminate against.
... and the people who currently don't use Torpark because it isn't
free software and the people who don't care about Torpark itself but
would appreciate it if the term "free software" wouldn't be watered

@_date: 2007-03-27 12:05:12
@_author: Fabian Keil 
@_subject: Free Software and Torpark 
According to Google my search request for "free software" "looks similar
to automated requests from a computer virus or spyware application"
and can't be processed right now, so I couldn't verify your claim.
According to the first MSN Search page the ratio is 9 to 1 in favour
of the FSF interpretation, though.
I never said you had to pay for Torpark.
If by "commercial abuse" you mean "commercial use", they already have
both of these freedoms and I never argued that they shouldn't have them.
It's not about redefining anything. Please have a look at
<20070326162931.GE13237 at itd.nrl.navy.mil> if you haven't already.
I don't know anything about the quality of the code and I never
recommended Torpark or Torpark LLC in the first place (not because
of its code quality or its license, but because I don't know enough
about it).
I would assume though, that license and code quality aren't
completely unrelated and that non-free licenses make it less
likely that the code gets audited by third parties that aren't
paid to do it.

@_date: 2007-03-28 11:52:21
@_author: Fabian Keil 
@_subject: Please RTM!...Re: Please don't recommend Tor Button! 
Could you post a pointer to the part of the Tor
documentation that you're referring to?
The relevant parts of the documentation that
I'm aware of recommend to set the gopher and
ftp proxy settings to Privoxy, to make sure
those requests fail instead of bypassing Tor:
If the Tor button extension would indeed
remove these settings permanently, I'd consider
JT's concerns valid.

@_date: 2007-03-28 20:06:13
@_author: Fabian Keil 
@_subject: Please RTM!...Re: Please don't recommend Tor Button! 
Is that a guess or did you actually verify that?
If you did, which Firefox version were you using?
At least for:
Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.1.2) Gecko/20070306 Firefox/2.0.0.2
proxy port 0 means "ignore the proxy IP and use a direct
connection". I would be very surprised if the behaviour
would be platform-dependent.

@_date: 2007-03-30 17:34:58
@_author: Fabian Keil 
@_subject: Please add to "download" section of homepage 
But it's still fairly easy to detect as the referrer
is invalid most of the time.
I think the best solution is to block the referrer
if the host has changed, but to let it pass otherwise.
It's not undetectable either, but at least it will
never result in invalid referrers.
I don't think Firefox itself can do that, but
both Polipo and Privoxy can (not for HTTPS of course).
[URLs snipped]
A HTML version of uagen's (english) POD is available at:

@_date: 2007-03-31 17:18:55
@_author: Fabian Keil 
@_subject: Example hidden service issue 
The problem is that:
instructs the user to first test the setup with
Google as hidden service, and then switch to the real on,
using the same onion address:
Sounds like a pretty bad idea to me too.

@_date: 2007-03-05 21:23:06
@_author: Fabian Keil 
@_subject: Tor breaks slashdot 
Is there a chance that you could give a more detailed description
or even provide some "before" and "after" screen shots where you
highlight the problem?
I visited the URL above, but I'm not sure what a "display on demand"
feature looks like or how the navigation is supposed to work.
It would also be interesting to know if you freed the browser cache
between the requests and if you can reproduce the problem without
You might additionally want to increase Privoxy's debug level to
see if and how the requests differ.
That's probably correct. Privoxy reloads it's configuration file
with the first request after the change was made, but that request
itself will still use the old settings.

@_date: 2007-03-07 13:55:11
@_author: Fabian Keil 
@_subject: Privoxy and Java 
Like most HTTP proxies, Privoxy doesn't route any DNS requests.
It either relies on the operating system to do the DNS resolution,
or in the case of socks4a connections, just passes the hostname
to the socks proxy.
Privoxy doesn't pass the resolved IP address to the client
(except for some error messages), and in the socks4a case
doesn't even know the address itself.
How many browsers come with their own IP stack?
If the Java application does it's own DNS lookups, it will most
likely bypass the browser. To use Privoxy for the DNS lookups
the Java application would have to tunnel DNS through HTTP,
and I doubt that that's commonly done. I wouldn't know, though,
as I don't use Java.
If the Java application only uses HTTP, there is a chance that
it honours the browser's proxy settings and doesn't cause
any DNS leaks, but that's not guaranteed.

@_date: 2007-05-02 12:00:33
@_author: Fabian Keil 
@_subject: Crazy with Exit nodes 
Please name at least one example of a web server that
expects or relies on the host being part of the request line.
The request you cited above is a proxy request,
the last HTTP proxy in the proxy chain will strip
the " before connecting
to the target server. As a result the target server should
never see the exit node notation in the request line.
Privoxy's hide-tor-exit-notation filter doesn't modify the
request line because Privoxy will be either the last
HTTP proxy in the chain in which case there's nothing to
filter, or there will be another HTTP proxy behind
Privoxy which has to see the Tor exit node notation
to forward it to Tor.
The hide-tor-exit-notation filter should work as
long as Privoxy is the last HTTP proxy in the proxy
chain, or no HTTP proxy behind Privoxy rebuilds the
Host header based on the request line.
Here's an example request:
fk at TP51 ~ $curl -X HEAD -v * About to connect() to proxy 10.0.0.1 port 8118 (
*   Trying 10.0.0.1... connected
* Connected to 10.0.0.1 (10.0.0.1) port 8118 (
< HTTP/1.1 200 OK               < Date: Wed, 02 May 2007 09:51:37 GMT
< Server: Apache                < Content-Location: index.html.en
< Vary: negotiate,accept-language,Accept-Encoding
< TCN: choice                   < Accept-Ranges: bytes
< Content-Length: 6789
< Connection: close
< Content-Type: text/html
< Content-Language: en
* transfer closed with 6789 bytes remaining to read
curl: (18) transfer closed with 6789 bytes remaining to read
* Closing connection And here's what Privoxy did with it:
11:51:25.138 08160600 Header: New HTTP Request-Line: HEAD / HTTP/1.1
11:51:25.139 08160600 Header: HEAD / HTTP/1.1
11:51:25.139 08160600 Header: Tagger 'http-method' added tag 'HEAD'. No action bits update necessary.
11:51:25.139 08160600 Header: Tagger 'variable-test' added tag 'Complete URL is  host is tor.eff.org.zwiebelsuppe.exit and the request came from 10.0.0.1'. No action bits update necessary.
11:51:25.139 08160600 Header: Tagger 'client-ip-address' added tag 'IP-ADDRESS: 10.0.0.1'. No action bits update necessary.
11:51:25.139 08160600 Header: scan: User-Agent: curl/7.16.0 (i386-portbld-freebsd6.2) libcurl/7.16.0 OpenSSL/0.9.7e zlib/1.2.3
11:51:25.139 08160600 Header: Tagger 'user-agent' added tag 'User-Agent: curl/7.16.0 (i386-portbld-freebsd6.2) libcurl/7.16.0 OpenSSL/0.9.7e zlib/1.2.3'. No action bits update necessary.
11:51:25.139 08160600 Header: scan: Host: tor.eff.org.zwiebelsuppe.exit
11:51:25.139 08160600 Header: scan: Pragma: no-cache
11:51:25.140 08160600 Header: scan: Accept: */*
11:51:25.140 08160600 Header: scan: Proxy-Connection: Keep-Alive
11:51:25.140 08160600 Header: Modified: User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X; de-CH; rv:1.8.1.2) Gecko/20070327 Firefox/2.0.0.2
11:51:25.140 08160600 Header: crumble crunched: Proxy-Connection: Keep-Alive!
11:51:25.140 08160600 Header: Transforming "Host: tor.eff.org.zwiebelsuppe.exit" to "Host: tor.eff.org"
11:51:25.140 08160600 Re-Filter: 'hide-tor-exit-notation' hit 1 time, changing size from 35 to 17
11:51:25.140 08160600 Header: Adding: Connection: close
11:51:25.140 08160600 Redirect: Decoding / if necessary.
11:51:25.140 08160600 Redirect: Checking / for redirects.
11:51:25.140 08160600 Request: tor.eff.org.zwiebelsuppe.exit/
11:51:25.140 08160600 Connect: to tor.eff.org.zwiebelsuppe.exit
11:51:48.215 08160600 Header: scan: HTTP/1.1 200 OK
11:51:48.215 08160600 Header: scan: Date: Wed, 02 May 2007 09:51:37 GMT
11:51:48.216 08160600 Header: scan: Server: Apache
11:51:48.216 08160600 Header: scan: Content-Location: index.html.en
11:51:48.216 08160600 Header: scan: Vary: negotiate,accept-language,Accept-Encoding
11:51:48.216 08160600 Header: scan: TCN: choice
11:51:48.216 08160600 Header: scan: Accept-Ranges: bytes
11:51:48.216 08160600 Header: scan: Content-Length: 6789
11:51:48.216 08160600 Header: scan: Connection: close
11:51:48.216 08160600 Header: scan: Content-Type: text/html
11:51:48.217 08160600 Header: Tagger 'content-type' added tag 'text/html'. No action bits update necessary.
11:51:48.217 08160600 Header: scan: Content-Language: en

@_date: 2007-05-02 13:01:28
@_author: Fabian Keil 
@_subject: Crazy with Exit nodes 
Looks like you forgot to enable client-header filtering:

@_date: 2007-05-02 20:45:32
@_author: Fabian Keil 
@_subject: Crazy with Exit nodes 
I don't remember. Probably I either assumed that it would
be too obvious and that calling it a "header filter"
would be enough of a hint, or I just didn't think about it.
Please consider writing a problem report the next time
a Privoxy feature doesn't appear to be working.
So far there wasn't any feedback for hide-tor-exit-notation,
so my assumption was that it worked as expected for everyone
who cared about it.
There's no official Privoxy filter to do that,
but you might try something like:
FILTER: add-tor-exit-notation Adds the Tor exit node notation to absolute link targets
s at gis
I assume it works but I only tested it with a few examples.
It wont work for relative URLs, but if you already used the
Tor exit node notation to reach the page it doesn't matter because
the browser will treat the exit note notation as part of the host.
With Privoxy's CVS version one could solve that problem
with dynamic pcrs commands and the $host variable,
but it would make more sense to leave the page source alone
and just redirect the browser's requests to a rewritten
version of the request URL:
{+redirect{s \
(Requires a Privoxy version above 3.0.6)

@_date: 2007-05-08 17:10:51
@_author: Fabian Keil 
@_subject: stunnel software 
If you use stunnel as HTTP forwarder for
SSL connections, Privoxy will always see HTTP
traffic which it can then filter.
The configuration is pretty straight forward
and by following the documentation you shouldn't
have any problems setting it up.
There are several disadvantages though:
- you have to configure both Privoxy and
  stunnel in advance for every host you
  plan to connect to.
- you have to somehow convince stunnel to
  connect through Tor, either by running Tor as
  intercepting proxy (you'll also need something
  like dns-proxy-tor) or by using a socks4a
  patch that you can find somewhere on the
  stunnel web site (I never used it).
- the encryption ends with stunnel, so your browser
  can no longer tell if the connection is secure or
  not. As a result you probably can't tell either.
There may be more, but I don't remember them right now.
There is at least one Privoxy support request about
this as well, you might want to try digging it up
for additional information.
I only use SSL for sites I trust enough to give them
privacy-sensitive information anyway and after I did
that, user tracking is the least of my worries.
As a result I don't think adding stunnel to the proxy
chain is worth the effort and I also think the lost
transparency (how secure the connection is) comes pretty
close to being a show stopper. Your mileage may vary of course.

@_date: 2007-05-09 13:27:28
@_author: Fabian Keil 
@_subject: chaining an additional proxy between Tor and ALL websites 
Please educate yourself about the meaning of the asterisk
in the domain part of Privoxy's URL patterns. The asterisk
may not do what you think it does, but that doesn't mean
that it has no effect at all.
I think you're looking for:
forward-socks4a / localhost:9050 146.164.34.14:80
In my opinion it's a pretty bad idea,
it works nonetheless though.
The wiki's claim an open proxy behind Tor would still provide
"all the anonymity benefits of Tor" is nonsense as you will
always reach the website through the same IP address which
makes it easier to track your requests between visits.

@_date: 2007-05-02 10:46:28
@_author: Fabian Keil 
@_subject: Crazy with Exit nodes 
Web servers that are responsible for more than one
domain rely on the HTTP "Host" header to decide which
content you're interested in.
If you use Tor's exit node notation in the URL,
the browser will also append it to the Host header.
If the web server ignores the Host header anyway,
it doesn't matter, otherwise you get an error message
because the web server isn't aware of any host with
Tor exit node notation at the end. Some servers also
simply use a default host instead of an error message.
You'll either have to find a way to tell the browser
not to add the exit node notation to the Host header,
or remove the exit node notation later on.
The latter can be done automatically with Privoxy's
hide-tor-exit-notation filter, you can also do it
manually with Firefox extensions like "Tamper data".
I assume there are extensions that can do it automatically
as well, but I haven't looked for them.
Note that many HTTP proxies rebuild the host header
from the URL in which case removing the Tor exit node
notation in the browser is futile.

@_date: 2007-11-17 15:36:17
@_author: Fabian Keil 
@_subject: Swedish Police Swoop on Dan Egerstad 
What's that?
I find it hard to believe that his "hack" didn't
violate any laws in Sweden and I also have my doubts
about the raid taking place in the way described in
this poorly-researched article.
Without more information I get the impression that
he broke Swedish law and is now facing the consequences.
Big deal.

@_date: 2007-11-17 17:00:43
@_author: Fabian Keil 
@_subject: court trial against me - the outcome 
I don't think so.
The first part of the paragraph talks about the guilt of the
offender, the second part about dismissing the case with the
approval of the accused.
The accused doesn't have to be the offender and as being
accused for itself doesn't imply any guilt I don't see why
dismissing the case according of ? 153 StPO would imply any
guilt either.

@_date: 2007-11-01 11:17:48
@_author: Fabian Keil 
@_subject: peculiar 0.2.0.9-alpha behavior this a.m. 
Did you try to build it manually or did you use the port?
For FreeBSD 6 the port is reported to build on all architectures except sparc64:
The stats aren't updated for Vidalia 0.0.15 yet,
but I'm not aware of any regressions.

@_date: 2007-11-08 20:56:45
@_author: Fabian Keil 
@_subject: Using Torbutton to toggle between Privoxy+Tor and vanilla Privoxy 
I don't use Torbutton, but I think it simply changes the browser's
proxy settings. While Privoxy can be used independently of Tor,
Torbutton only lets you either use a HTTP proxy (+ Tor) or no
HTTP proxy at all.
With Privoxy 3.0.6 and earlier you have to edit Privoxy's
main configuration file to change the forwarding settings
and I don't know if Firefox gives its extensions the power
to do that.
Actually I'm not even sure if the Torbutton
developer(s) would want to do that anyway.
Privoxy 3.0.7 beta (which is supposed to be released
this weekend) can be configured to control forwarding
settings with HTTP headers and this makes thinks a lot
easier for Torbutton and friends, but (again) using that
feature may not be desired by the Tor developers.
Of course I can speculate a lot about their motives
to do or not do anything, but I rather CC or-talk@ so they
can give you a definitive answer (Reply-To set as well).

@_date: 2007-10-27 18:47:48
@_author: Fabian Keil 
@_subject: Tor 0.2.0.9-alpha is out 
My client seems to work, but both of my servers abort with:
Oct 27 18:31:57.221 [notice] Tor 0.2.0.9-alpha (r12180) opening log file.
Oct 27 18:31:57.222 [warn] Can't log to stdout with RunAsDaemon set; skipping stdout
 No such file or directory
Oct 27 18:31:57.683 [warn] I have no descriptor for the router named "Zwiebelsuppe" in my declared family; I'll use the nickname as is, but this may confuse clients.
Oct 27 18:31:57.698 [notice] Your Tor server's identity key fingerprint is 'Zwiebelkuchen 8666 742C 9AD2 D3B3 028E 1FB7 C7E6 12F7 4340 BD05'
Oct 27 18:31:57.699 [notice] Configured hibernation.  This interval began at 2007-10-27 17:25:00; the scheduled wake-up time was 2007-10-27 17:25:00; we expect to exhaust our quota for this interval around 2007-10-28 17:25:00; the next interval begins at 2007-10-28 17:25:00 (all times local)
Oct 27 18:32:00.180 [err] Bug: container.c:828: strmap_get: Assertion map failed; aborting.
  0x28416ad7 in kill () from /lib/libc.so.7
  0x28336e66 in raise () from /lib/libthr.so.3
  0x2841576a in abort () from /lib/libc.so.7
  0x080f937a in strmap_get (map=0x0, key=0x28c46a80 "zwiebelkuchen") at container.c:828
  0x080f9ab1 in strmap_get_lc (map=0x0, key=0x28c46b20 "Zwiebelkuchen") at container.c:923
  0x080b465b in networkstatus_nickname_is_unnamed (nickname=0x28c46b20 "Zwiebelkuchen") at networkstatus.c:885
  0x080d34a1 in router_get_by_nickname (nickname=0x28c46b20 "Zwiebelkuchen", warn_if_unnamed=1) at routerlist.c:1703
  0x080cd16c in router_rebuild_descriptor (force=0) at router.c:1235
  0x080cc97c in router_get_my_routerinfo () at router.c:1099
  0x080d4bfb in routerlist_insert (rl=0x2852a9e0, ri=0x285395e0) at routerlist.c:2157
 0x080d6b7b in router_add_to_routerlist (router=0x285395e0, msg=0xbfbfeae8, from_cache=1, from_fetch=0) at routerlist.c:2675
 0x080d7db4 in router_load_routers_from_string (s=0x289af436 "", eos=0x289af436 "", saved_location=SAVED_IN_CACHE,     requested_fingerprints=0x0, descriptor_digests=0, prepend_annotations=0x0) at routerlist.c:3066
 0x080d0452 in router_reload_router_list_impl (store=0x2852a9f8) at routerlist.c:635
 0x080d067c in router_reload_router_list () at routerlist.c:685
 0x080b0dc0 in do_main_loop () at main.c:1356
 0x080b2339 in tor_main (argc=15, argv=0xbfbfecec) at main.c:1932
 0x080ebd12 in main (argc=Cannot access memory at address 0x3
) at tor_main.c:28

@_date: 2007-10-27 20:12:58
@_author: Fabian Keil 
@_subject: Tor 0.2.0.9-alpha is out 
Not using MyFamily works around the problem
(and in my case it's not necessary anyway).
Maybe specifying the MyFamily nodes by fingerprint
would have worked as well, but I didn't figure out
an acceptable fingerprint format yet ...

@_date: 2007-10-31 18:47:35
@_author: Fabian Keil 
@_subject: Insecure Privoxy Configuration in Vidalia Bundles Prior to 
Let me get this straight. A while ago, you found a vulnerability that
allows an attacker to change Privoxy's action files without relying on
the user to execute untrusted code, but decided not to report it to the
Privoxy Team and/or the people behind the Vidalia bundle and instead
only fixed it in your own Tor+Privoxy distribution?
Is there a remote chance that you could come around to
do the right thing and report it now?

@_date: 2007-10-04 07:28:14
@_author: Fabian Keil 
@_subject: Torbutton 1.1.8-alpha (Usability improvements) 
It's not. Privoxy isn't a caching proxy
so there's nothing to be cleared.

@_date: 2007-09-22 10:10:41
@_author: Fabian Keil 
@_subject: Load Balancing 
That's likely, but not guaranteed. Circuits don't last forever.

@_date: 2007-09-22 10:26:29
@_author: Fabian Keil 
@_subject: About HTTP 1.1 Cache 
That's why Privoxy can randomize the time within ranges that
are unlikely to cause revalidation failures:
Note however, that using If-Modified-Since as Cookie replacement
is a lot more work than simply embedding URLs with session info.
Therefore it's questionable if anyone is going to bother.
Especially since the latter can't be easily fooled without
purging the cache.

@_date: 2007-09-23 14:28:56
@_author: Fabian Keil 
@_subject: About HTTP 1.1 Cache 
I'm aware that Gatling does that, but the others I checked

@_date: 2007-09-23 14:35:04
@_author: Fabian Keil 
@_subject: Load Balancing 
Additionally there's Looks like the first person who comes up with a reproducible
benchmark could make three projects happy at the same time.
I second that.

@_date: 2007-09-25 17:06:05
@_author: Fabian Keil 
@_subject: Set up a webproxy to TOR - tor-proxy.net 
I didn't write dns-proxy-tor, I merely created the FreeBSD port.
dns-proxy-tor was written by Tup. And while I don't know who's
behind this pseudonym, I'm quite confident that it isn't me.

@_date: 2008-08-10 17:27:39
@_author: Fabian Keil 
@_subject: Tor TransPort on OpenBSD? 
I have it enabled on FreeBSD, the code for OpenBSD
used to be mostly the same.
That didn't prevent you from using it, though.
Just make sure Tor has the required permissions
to access /dev/pf to lookup destination addresses.

@_date: 2008-08-11 20:51:16
@_author: Fabian Keil 
@_subject: Tor TransPort on OpenBSD? 
I'll skip this part as others already gave a few suggestions.
Is Tor safe if you don't give it access to /dev/pf?
I run Firefox and a handful of other programs with poor
security track records with the privileges required to access
my mail, so I don't worry too much about a (jailed) Tor process
with access to PF.
I don't update my ports through Tor, I use OpenSSH for the
HTTP traffic (mainly because I can) and direct connections
for ftp (I haven't looked into how to tunnel it properly yet).
I believe the main problem with ftp through Tor is
that the number of suitable exit relays is limited.
I don't think it's a TransPort problem and I'm somewhat
sure that I successfully tested ftp through the TransPort
in the past.

@_date: 2008-08-11 20:59:55
@_author: Fabian Keil 
@_subject: Tor TransPort on OpenBSD? 
The alpha releases work pretty well for me.
Unless things changed recently, read permissions
are sufficient for DIOCNATLOOK on OpenBSD.

@_date: 2008-12-03 18:35:19
@_author: Fabian Keil 
@_subject: [Fwd: (Probably) a known problem?] - cant run a relay node 
While we're talking about DNS issues, I recently got:
Nov 30 06:25:02.803 [notice] Tor 0.2.1.6-alpha (r17011) opening new log file.
Nov 30 06:25:02.818 [warn] eventdns: Unable to add nameserver 164.148.169.81: error 2
Nov 30 06:25:02.818 [warn] eventdns: Unable to add nameserver 34.148.169.81: error 2
Nov 30 06:25:02.818 [warn] Unable to parse '/etc/resolv.conf', or no nameservers in '/etc/resolv.conf' (6)
Nov 30 06:25:02.819 [err] set_options(): Bug: Acting on config options left us in a broken state. Dying.
The nameservers were indeed unreachable at that time
(the traffic limit was reached and the system offline),
but earlier Tor versions continued to run and started
working again once the system was back on the net.

@_date: 2008-12-04 08:59:00
@_author: Fabian Keil 
@_subject: [Fwd: (Probably) a known problem?] - cant run a relay node 
It's probably worth mentioning that this is a
relay server running on a GNU/Linux system.

@_date: 2008-02-01 18:08:23
@_author: Fabian Keil 
@_subject: New Privoxy 3.0.8 with Tor 
Without seeing the actual error messages, my guess would
be that your config file references action files without
the extension and your action files use the filter-client-headers
or filter-server-headers actions which have been removed
as Privoxy now supports real header filters.
Check your configuration file for lines like:
   actionsfile default
and change them to:
   actionsfile default.action
In your configuration file remove the obsoleted actions
mentioned above. Note that this will probably take more
time than simply following the steps in:
If you never actually changed Privoxy's action files
you might as well completely deinstall Privoxy 3.0.6,
install 3.0.8 and enable Tor again:

@_date: 2008-01-06 19:21:38
@_author: Fabian Keil 
@_subject: privoxy log analyzer 
What exactly do you want to analyse?
Privoxy and Tor log different things.
I'm not aware of any dedicated log analysers for
Privoxy, but I intend to one day have Privoxy-Log-Parser
report some fancy statistics. Currently it's just a
filter and syntax highlighter:
Also note that Privoxy (more or less) supports the
"Common Log Format" which is supposed to be widely
understood by analysers for web server logs. It's not
very detailed, but may be better than nothing.
I sure would like to have analysers for both
Tor and Privoxy logs. One for Polipo logs would
be useful too ...

@_date: 2008-01-22 21:56:17
@_author: Fabian Keil 
@_subject: TorStatus version 4 has been released 
At least it compresses quite well:
21:28:27.567 283b5400 Re-Filter: Decompression successful. Old size: 230926, new size: 2642640. (saved: 91.26%)
Of course if you'd be using Privoxy 3.0.6 or earlier with
filtering enabled, you'd download the whole two megs ...

@_date: 2008-01-29 18:18:30
@_author: Fabian Keil 
@_subject: New Privoxy 3.0.8 with Tor 
With Privoxy 3.0.8 it should be:
Quoting item two on
Please also have a look at the "Note to Upgraders" on the same page.

@_date: 2008-01-29 20:08:52
@_author: Fabian Keil 
@_subject: New Privoxy 3.0.8 with Tor 
You're welcome.
Note that hide-tor-exit-notation can also clean Referer headers,
but if you only apply it to requests for hosts ending with .exit,
"tainted" referrers to other hosts could slip through.
Of course that's only an issue if you aren't already
blocking referrers across different hosts anyway.

@_date: 2008-01-01 14:59:24
@_author: Fabian Keil 
@_subject: Is there something similar like "Torbutton" FF plugin for the 
I don't think Privoxy's toggle option does what you think it does.
However not all is lost: using Privoxy 3.0.7 beta or later
you can combine the user-agent client-header tagger,
the forward-override action and a browser-plugin that changes
the User-Agent header to build your own Tor toggle.
For details see:
Be sure to read the warning before doing it, though.
Note that nowadays the Torbutton extension is also supposed
to protect you against some JavaScript-based attacks.
Privoxy doesn't do that.

@_date: 2008-06-06 16:15:26
@_author: Fabian Keil 
@_subject: Is tor-resolve required to run an Exit node. 
My "Tor nslookup equivalent" of choice is nslookup:
fk at TP51 ~ $sockstat -4l | grep _tor
_tor     tor        1643  5  tcp4   10.0.0.2:9050         *:*
_tor     tor        1643  6  tcp4   10.0.0.2:9040         *:*
_tor     tor        1643  7  udp4   10.0.0.2:53           *:*
_tor     tor        1643  8  tcp4   10.0.0.2:9051         *:*
fk at TP51 ~ $nslookup  tor-jail
Server:         tor-jail
Address:        10.0.0.2
Non-authoritative answer:
Name:   Address: 86.59.21.36
That may not be possible with stable releases yet, though.

@_date: 2008-06-06 16:39:31
@_author: Fabian Keil 
@_subject: Tor with secure Gmail 
[Second try, now with a subscribed address ...]
If you "untor" by switching from Privoxy+Tor to a direct
connection, you may be hitting the problem described in:

@_date: 2008-11-23 19:51:45
@_author: Fabian Keil 
@_subject: Tor 0.2.1.7-alpha is out 
I'm not sure if it's related to this change,
but bootstrapping no longer works for me on
FreeBSD 8.0-CURRENT:
Nov 23 18:59:08.931 [notice] Tor 0.2.1.7-alpha-dev (r17366) opening log file.
Nov 23 18:59:08.945 [notice] Parsing GEOIP file.
Nov 23 18:59:10.160 [notice] This version of Tor (0.2.1.7-alpha-dev) is newer than any recommended version, according to the directory authorities. Recommended versions are: 0.1.2.17,0.1.2.18,0.1.2.19,0.2.0.26-rc,0.2.0.27-rc,0.2.0.28-rc,0.2.0.29-rc,0.2.0.30,0.2.0.31,0.2.0.32,0.2.1.1-alpha,0.2.1.2-alpha,0.2.1.4-alpha,0.2.1.5-alpha,0.2.1.6-alpha,0.2.1.7-alpha
Nov 23 18:59:11.347 [notice] Bootstrapped 45%: Asking for relay descriptors.
Nov 23 18:59:11.347 [notice] I learned some more directory information, but not enough to build a circuit: We have only 0/1259 usable descriptors.
Nov 23 18:59:12.163 [notice] Bootstrapped 50%: Loading relay descriptors.
Nov 23 18:59:12.741 [notice] I learned some more directory information, but not enough to build a circuit: We have only 0/1259 usable descriptors.
[repeated 31 times]
Nov 23 18:59:28.774 [warn] Problem bootstrapping. Stuck at 50%: Loading relay descriptors. (Tor gave up on the connection; TIMEOUT; count 10; recommendation warn)
Nov 23 18:59:28.805 [warn] Problem bootstrapping. Stuck at 50%: Loading relay descriptors. (Tor gave up on the connection; TIMEOUT; count 11; recommendation warn)
Nov 23 18:59:28.810 [warn] Problem bootstrapping. Stuck at 50%: Loading relay descriptors. (DONE; DONE; count 12; recommendation warn)
Nov 23 18:59:28.810 [warn] Problem bootstrapping. Stuck at 50%: Loading relay descriptors. (DONE; DONE; count 13; recommendation warn)
Nov 23 18:59:28.872 [notice] I learned some more directory information, but not enough to build a circuit: We have only 0/1259 usable descriptors.
[Seems to loop endlessly here]
I have a complete debug log if any Tor developer is interested.
Does the following indicate that Tor is trying to use invalid sockets?
Nov 23 15:05:14.034 [debug] relay_lookup_conn(): found conn for stream 17393.
Nov 23 15:05:14.035 [debug] circuit_receive_relay_cell(): Sending to origin.
Nov 23 15:05:14.035 [debug] connection_edge_process_relay_cell(): Now seen 343 relay cells here.
Nov 23 15:05:14.035 [debug] connection_edge_process_relay_cell(): circ deliver_window now 992.
Nov 23 15:05:14.035 [debug] connection_or_process_cells_from_inbuf(): 28: starting, inbuf_datalen 496 (0 pending in tls object).
Nov 23 15:05:14.035 [debug] conn_write_callback(): socket 19 wants to write.
Nov 23 15:05:14.035 [debug] flush_chunk_tls(): flushed 512 bytes, 0 ready to flush, 0 remain.
Nov 23 15:05:14.035 [debug] connection_handle_write(): After TLS write of 512: 0 read, 586 written
Nov 23 15:05:14.035 [debug] connection_or_flush_from_first_active_circuit(): Made a circuit inactive.
Nov 23 15:05:14.035 [debug] conn_read_callback(): socket 28 wants to read.
Nov 23 15:05:14.036 [debug] connection_read_to_buf(): 28: starting, inbuf_datalen 496 (0 pending in tls object). at_most 16384.
Nov 23 15:05:14.036 [debug] tor_tls_read(): read returned r=-1, err=-2
Nov 23 15:05:14.036 [debug] connection_read_to_buf(): After TLS read of 0: 1440 read, 0 written
Nov 23 15:05:14.036 [debug] connection_or_process_cells_from_inbuf(): 28: starting, inbuf_datalen 496 (0 pending in tls object).
Nov 23 15:05:14.036 [debug] conn_write_callback(): socket 19 wants to write.
Nov 23 15:05:14.036 [debug] flush_chunk_tls(): flushed 512 bytes, 0 ready to flush, 0 remain.
Nov 23 15:05:14.036 [debug] connection_handle_write(): After TLS write of 512: 0 read, 586 written
Nov 23 15:05:14.036 [debug] conn_read_callback(): socket -1 wants to read.
Nov 23 15:05:14.036 [debug] connection_dir_process_inbuf(): Got data, not eof. Leaving on inbuf.
Nov 23 15:05:14.045 [debug] conn_read_callback(): socket 21 wants to read.
Nov 23 15:05:14.045 [debug] connection_read_to_buf(): 21: starting, inbuf_datalen 0 (0 pending in tls object). at_most 16384.
Nov 23 15:05:14.046 [debug] connection_read_to_buf(): After TLS read of 4080: 1258 read, 0 written
Nov 23 15:05:14.046 [debug] connection_or_process_cells_from_inbuf(): 21: starting, inbuf_datalen 4080 (0 pending in tls object).
According to the debug log, tor_tls_read() returns -1 all the time:
fk at TP51 ~ $grep -c "tor_tls_read(): read returned r=-1, err=-2" test/tor/debug.log fk at TP51 ~ $grep "tor_tls_read(): read" test/tor/debug.log | grep -v -c "r=-1"
Tor 0.2.1.6-alpha bootstraps without problems:
Nov 23 19:38:00.572 [notice] Tor 0.2.1.6-alpha (r17011) opening log file.
Nov 23 19:38:00.584 [notice] Parsing GEOIP file.
Nov 23 19:38:01.119 [notice] Bootstrapped 45%: Asking for relay descriptors.
Nov 23 19:38:01.119 [notice] I learned some more directory information, but not enough to build a circuit: We have only 0/1260 usable descriptors.
Nov 23 19:38:02.022 [notice] Bootstrapped 50%: Loading relay descriptors.
Nov 23 19:38:02.926 [notice] Bootstrapped 58%: Loading relay descriptors.
Nov 23 19:38:02.927 [notice] I learned some more directory information, but not enough to build a circuit: We have only 96/1259 usable descriptors.
Nov 23 19:38:03.370 [notice] Bootstrapped 67%: Loading relay descriptors.
Nov 23 19:38:03.370 [notice] I learned some more directory information, but not enough to build a circuit: We have only 188/1259 usable descriptors.
Nov 23 19:38:05.275 [notice] Bootstrapped 70%: Loading relay descriptors.
Nov 23 19:38:05.297 [notice] I learned some more directory information, but not enough to build a circuit: We have only 220/1259 usable descriptors.
Nov 23 19:38:11.469 [notice] Bootstrapped 73%: Loading relay descriptors.
Nov 23 19:38:11.470 [notice] I learned some more directory information, but not enough to build a circuit: We have only 250/1254 usable descriptors.
Nov 23 19:38:12.002 [notice] We now have enough directory information to build circuits.
Nov 23 19:38:12.002 [notice] Bootstrapped 80%: Connecting to the Tor network.
Nov 23 19:38:12.006 [notice] Bootstrapped 85%: Finishing handshake with first hop.
Nov 23 19:38:13.673 [notice] Bootstrapped 90%: Establishing a Tor circuit.
Nov 23 19:38:21.262 [notice] Tor has successfully opened a circuit. Looks like client functionality is working.
Nov 23 19:38:21.263 [notice] Bootstrapped 100%: Done.

@_date: 2008-10-16 10:08:56
@_author: Fabian Keil 
@_subject: "Waiting for circuit"-problem (newbie) 
Did you already follow the steps mentioned in the FAQ?
Using a more recent Privoxy version wouldn't hurt either.
While I think this is a Tor-related problem, newer Privoxy
versions have more descriptive error messages (especially
if you use forward-socks5 instead of forward-socks4a),
which should make debugging this easier:

@_date: 2008-09-30 18:25:40
@_author: Fabian Keil 
@_subject: Force exitnode oddness 
In Privoxy 3.0.8 and later, it's:
Using "/", as Referer headers send to "normal" URLs
while leaving .exit URLs can leak the exit notation
as well (if they aren't blocked anyway).
While it's a bit more work than simply adding the exit notation
in the browser, you can have Privoxy add it behind the browser's back.
Another advantage is that it works for SSL as well (no certificate warnings).
For an example have a look at:
(note that the fingerprint has changed, though)
And in case you aren't using Privoxy, there's always MapAddress.
Quoting tor(1):

@_date: 2009-08-06 17:41:38
@_author: Fabian Keil 
@_subject: frequent empty/closed connections 
If the keep-alive-timeout directive is used, Privoxy versions before
3.0.14 beta don't take the latency into account and may try to reuse
a connection that has already been closed on the server side but still
appears to be open from the point of view of the client.
The result is the error message you mention above.
To really prove anything, you'd have to watch the server
side as well, without that you can still make assumptions,
If you enable connection debugging in Privoxy, you can tell
from the log messages whether or not the problem happened
while reusing a connections.
If it only happens while reusing a connection it likely
is a Privoxy problem. Otherwise it most likely isn't.
If the problem goes away after disabling the keep-alive-timeout
directive, and reappears right after enabling it again, that
would indicate a Privoxy problem as well.
If you report a problem for Privoxy 3.0.12, the first response
will be "Please try to reproduce it with 3.0.14 beta", so you
probably want to upgrade before looking into this.
A FreeBSD port skeleton is available on the SF project page.

@_date: 2009-08-04 21:13:06
@_author: Fabian Keil 
@_subject: Which proxy to use? 
What's your definition of "reverse proxy"?
If you simply want the proxy to process intercepted requests,
you may want to have a look at Privoxy's accept-intercepted-requests

@_date: 2009-01-02 14:00:37
@_author: Fabian Keil 
@_subject: Jailed/sandboxed/chrooted applications 
I'm running Tor and Privoxy in FreeBSD jails,
Xorg applications (which probably pose a bigger thread)
are running on the host system, though.
I wrote about trans-proxy-tor running in a FreeBSD jail at:
The text is in German but the only thing that really matters is
the /etc/devfs.rules example to make /dev/pf visible in the jail.
Nowadays I use Tor's TransPort option instead of trans-proxy-tor,
but the configuration is pretty much the same.

@_date: 2009-07-05 19:00:47
@_author: Fabian Keil 
@_subject: Yahoo Mail and Tor 
I'm sorry to hear that.
Are you by any chance using the Vidalia bundle which unfortunately
contains a Privoxy version that is several years out of date?
That sounds like a lot more work than simply upgrading
your Privoxy version or even back porting the action file
changes manually.
As far as I know, the Yahoo-related problems have been fixed
quite some time ago and if you still notice any problems with
Privoxy 3.0.12 or later, feel free to report them so we can
fix them.

@_date: 2009-06-26 13:57:16
@_author: Fabian Keil 
@_subject: Lynx leaks DNS 
Is there a reason why you aren't using a more recent build?
I can't reproduce the problem with:
fk at TP51 ~ $lynx --version
Lynx Version 2.8.6rel.5 (09 May 2007)
libwww-FM 2.14, SSL-MM 1.4.1, OpenSSL 0.9.8k, ncurses 5.7.20081102(wide)
Built on freebsd8.0 Feb 27 2009 22:36:34

@_date: 2009-05-08 18:20:53
@_author: Fabian Keil 
@_subject: Privoxy change? 
Looks like there are spaces missing before and after the URL pattern.
Also note that:

@_date: 2009-11-15 14:17:07
@_author: Fabian Keil 
@_subject: Tracing internal errors 
Sounds like the following OpenSUSE packaging bug still hasn't been fixed:
You are most likely getting the internal error because Privoxy is
configured to use an improperly populated chroot directory, so it
can't access its template files. If that's the case, you are probably
also looking at the wrong log file.
I'd suggest you file a bug report with OpenSuSE.

@_date: 2010-04-11 13:50:35
@_author: Fabian Keil 
@_subject: "prifoxy" privoxy-on-firefox-extension? 
There was a thread about this on the Privoxy users mailing
list a while ago, started by the "Prifoxy" originator:
My concerns and questions were pretty much ignored and until that
changes I certainly wouldn't recommend the extension myself.

@_date: 2010-12-10 15:32:45
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
I agree that a connection on the local ORPort or DirPort should be
listed as inbound, but I think the same should be done with connections
on the SocksPort. Currently they are listed as outbound with the local
Tor address replaced:
[public gateway IP]:9050 -->  10.0.0.1:58305 (??) UNKNOWN  UNKNOWN 3.4s (OUTBOUND) I think those connections would be listed as outbound on other
systems, too.
The connection doesn't leave the system because its a socks
connection with both the source and the destination address
located on the same system.
I think an option to display the real address would be useful.
It probably would also make sense to not show the local port
when replacing the address.
The outbound connection:
fk at r500 ~ $sudo pfctl -ss | grep 31515 all tcp 10.0.0.2:31515 -> 192.168.0.106:52509 -> [some Tor server address]:9001       ESTABLISHED:ESTABLISHED
Is listed as:
[public gateway IP]:31515 -->  [some Tor server address]:9001 (us) [fingerprint] [relay name] 14.6m (OUTBOUND) but given that the local Tor address is behind two NAT layers
it's highly unlikely that the Tor server will see the connection
as coming from source port 31515.
Maybe it would make even more sense to show the connection
similar to the way pfctl does. I'm thinking of something like:
10.0.0.2:31515 --> [public Tor IP address][:port if known] -->  [Tor server address]:9001 (us) [fingerprint] [relay name] 14.6m (OUTBOUND)
Using features.pathPrefix works for me, thanks for mentioning it.
Maybe it should be mentioning in the log message when the torrc
can't be found?
It is, if you are outside the FreeBSD jail.
The attached patch seems to work for me.
Actually the problem was egrep not understanding "\s" as meta character.
sockstat's -c flag lets it only show the connected sockets, so the last
grep is no longer necessary.
I missed procstat, though.
No real advantage, but as I already had the patch anyway, I was interested
to see the performance differences (which seem to be negligible). I agree
that one sockstat command should do.
When I was running two Tor servers on a FreeBSD system, they were
running on different jails with different IP addresses using the
standard ports. Filtering for the address would have helped there.
You are obviously right that other configurations are possible,
though, they just didn't occur to me when I wrote the comment.

@_date: 2010-12-11 14:06:12
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
If it's the varying number of columns that would cause difficulties,
you could keep the colums constant with lines like:
location1 (location2) --> location3 ...
You get pretty much the same use case, but without jails, when running
Tor in a local network behind a port-forwarding gateway. I would expect
this to be rather common for bridges.
Unless I misunderstood Hans, he was mainly concerned about
having to install a dependency that offers nothing the base
system doesn't already provide anyway.
With ^ added to the pattern it seems to work:
fk at r500 ~/git/arm $lsof -nPi -p 4775 | grep "^tor.*(ESTABLISHED)"
tor       4775    _tor    4u    IPv4 0xfffffe00471633a8        0t0   TCP 10.0.0.2:35771->[scrubbed]:9001 (ESTABLISHED)
tor       4775    _tor   14u    IPv4 0xfffffe0047c71000        0t0   TCP 10.0.0.2:15999->[scrubbed]:443 (ESTABLISHED)
tor       4775    _tor   15u    IPv4 0xfffffe0047221af8        0t0   TCP 10.0.0.2:9051->10.0.0.2:20692 (ESTABLISHED)
Otherwise arm itself shows up multiple times, too:
fk at r500 ~/git/arm $lsof -nPi -p 4775 | grep "tor.*(ESTABLISHED)"
tor       4775    _tor    4u    IPv4 0xfffffe00471633a8        0t0   TCP 10.0.0.2:35771->[scrubbed]:9001 (ESTABLISHED)
tor       4775    _tor   14u    IPv4 0xfffffe0047c71000        0t0   TCP 10.0.0.2:15999->[scrubbed]:443 (ESTABLISHED)
tor       4775    _tor   15u    IPv4 0xfffffe0047221af8        0t0   TCP 10.0.0.2:9051->10.0.0.2:20692 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
python    9179    _tor    3u    IPv4 0xfffffe0047221000        0t0   TCP 10.0.0.2:20692->10.0.0.2:9051 (ESTABLISHED)
Showing the same connection six times in a row makes little
sense to me, but then again, I'm not familiar with lsof.
lsof also seems to be rather slow (on FreeBSD):
fk at r500 ~/git/arm $time lsof -nPi -p 4775 | grep "^tor.*(ESTABLISHED)" > /dev/null
real    0m0.338s
user    0m0.159s
sys     0m0.183s
fk at r500 ~/git/arm $time sockstat -4c | grep 'tor *4775' > /dev/null
real    0m0.010s
user    0m0.015s
sys     0m0.005s
That works too, but without the ^, arm itself shows up again.
procstat and sockstat seem to perform comparable, but sockstat
has the advantage that it will work if arm is run as neither
the tor user nor root.

@_date: 2010-12-12 14:08:14
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
I can't confirm this.
I intend to look into creating a FreeBSD port around Christmas.

@_date: 2010-12-03 20:34:46
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
tor-jail# uname -or
FreeBSD 9.0-CURRENT
tor-jail# su -m _tor -c /bin/csh
tor-jail# id
uid=256(_tor) gid=256(_tor) groups=256(_tor)
tor-jail# procstat -f `pgrep tor` | egrep 'TCP|UDP|PID'
  PID COMM               FD T V FLAGS    REF  OFFSET PRO NAME         3561 tor                 4 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:22370
 3561 tor                 5 s - rw---n--   2       0 TCP 10.0.0.2:9050 0.0.0.0:0
 3561 tor                 6 s - rw---n--   2       0 TCP 10.0.0.2:9040 0.0.0.0:0
 3561 tor                 7 s - rw---n--   2       0 UDP 10.0.0.2:53 0.0.0.0:0
 3561 tor                 8 s - rw---n--   2       0 TCP 10.0.0.2:9051 0.0.0.0:0
 3561 tor                14 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:44381
 3561 tor                15 s - rw---n--   2       0 TCP 10.0.0.2:33734 [scrubbed]:443
 3561 tor                16 s - rw---n--   2       0 TCP 10.0.0.2:47704 [scrubbed]:9001
 3561 tor                17 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:46343
 3561 tor                18 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:64196
 3561 tor                19 s - rw---n--   2       0 TCP 10.0.0.2:18856 [scrubbed]:443
 3561 tor                20 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:20385
 3561 tor                22 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:27541
 3561 tor                23 s - rw---n--   2       0 TCP 10.0.0.2:9050 10.0.0.1:21877
(Public IP addresses scrubbed)
It's at least interesting to a part of the rest of the tor community.
I intent to try Arm in the future. Are you aware of anyone working on a port?

@_date: 2010-12-05 13:02:16
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
Neither of those commands work for me. To let Arm figure out
Tor's pid I still need the pgrep patch I mailed you yesterday.
Attached are the patches I used to get it working on FreeBSD 9.0 CURRENT.
I also rebased the sockstat+awk patch, but sockstat+grep probably works
reliably enough.
One unrelated problem I noticed is that Arm tends to show local
connections as Outbound. A connection from the Privoxy jail to
the Tor jail:
_tor     tor        2750  25 tcp4   10.0.0.2:9050         10.0.0.1:20528
shows up as:
[public gateway IP address scrubbed]:9050  -->    0.0s (OUTBOUND)
Given that the connection doesn't leave the system, replacing
the Tor jail IP address with the public IP address of the gateway
is a bit confusing.
Also, when running Arm outside the Tor jail, the Tor
configuration file isn't found.

@_date: 2010-12-05 16:00:07
@_author: Fabian Keil 
@_subject: Arm Release 1.4.0 
I don't think there is an official git repository.
Good point.
It's -x on CURRENT, too. Patch attached.
I also attached one to get the pid through sockstat. I think changing
it to additionally filter for the control port address would get the
most reliable results.

@_date: 2010-10-09 14:13:00
@_author: Fabian Keil 
@_subject: AdvTor 
If you are using a Privoxy version more recent than 3.0.9
(released in 2008), you can use SOCKS5 which will allow Tor
to provide Privoxy with a more detailed problem description.
Your Privoxy version is from 2006, you might want to consider updating it.
With a more recent version I get:
And Tor says:
Oct 09 14:00:19.571 [notice] Have tried resolving or connecting to address ' at 3 different places. Giving up.

@_date: 2010-10-09 17:00:29
@_author: Fabian Keil 
@_subject: AdvTor 
If the server (or proxy) accepts the connection but closes
it without sending any data, Privoxy versions before 3.0.7
will send the text 'Connection: close' to the client.
This bug was fixed more than three years ago and is yet
another reason why you might want to consider updating
your Privoxy version.
Nowadays you get a proper problem description:
It's still a frequent "problem" when using Tor. Yesterday it happened
for around 1% of my requests (some of them were made without Tor, though):
fk at r500 ~ $privoxy-log-parser --statistics /usr/jails/privoxy-jail/var/log/privoxy/privoxy.log.1
Client requests total: 7881
Crunches: 1100 (13.96%)
Outgoing requests: 6781 (86.04%)
Server keep-alive offers: 2802 (35.55%)
New outgoing connections: 5535 (70.23%)
Reused connections: 1246 (15.81%)
Empty responses: 95 (1.21%)
Empty responses on new connections: 1 (0.01%)
Empty responses on reused connections: 94 (1.19%)
Method distribution:
    7052 : GET          753 : CONNECT       46 : POST    Client HTTP versions:
7830 : HTTP/1.1
21 : HTTP/1.0
URL statistics are disabled. Increase --url-statistics-threshold to enable them.
Note that it isn't necessarily caused by the exit node itself,
it can also happen simply because the server closed the connection
but the Tor client hasn't noticed it yet and thus still accepts
data on an already-dead connection. This would explain the number
of "Empty responses on reused connections".

@_date: 2010-10-10 17:43:54
@_author: Fabian Keil 
@_subject: AdvTor 
It's the unreleased development version available from CVS.

@_date: 2011-08-31 12:28:33
@_author: Fabian Keil 
@_subject: [tor-talk] Tor Exit Node Operator Raided in USA. 
I think getting raided due to running a Tor exit node at
home (or even remotely) is a lot more likely than getting
raided due to running an open wireless access point.
After all an exit node is pretty much guaranteed to be misused
every now and then and not all criminal investigators are
competent enough to recognize that an IP address belongs to
a Tor exit node (and some couldn't care less).

@_date: 2011-02-01 18:00:24
@_author: Fabian Keil 
@_subject: Privoxy icon popping up 
Hard to tell without more information.
If you (temporarily) configure Privoxy to log the client
requests, the log should tell you what's going on.
If you get the Privoxy error favicon (white P in red circle) on
pages that aren't generated by Privoxy itself, but don't see any
requests for the favicon in the log, the client may be reusing
the cached favicon for sites it shouldn't.
Clearing the client cache should work around this.
If you see actual requests for the favicon, the Referer header
or the surrounding requests should give you a hint where the
request originated from.

@_date: 2011-01-12 22:05:27
@_author: Fabian Keil 
@_subject: geeez... 
Some of my equipment got seized a few months ago.
I'm also not sure how the police would try to seize equipment
and fail (assuming the equipment is actually there). Getting a
warrant seems to be pretty easy as long as you don't mention
that the IP address in question belongs to a known Tor server.

@_date: 2011-01-14 00:04:38
@_author: Fabian Keil 
@_subject: geeez... 
The exit node that triggered the raid is hosted by Strato.
I'm running it there since 2006. The friendly local police man
who usually deals with the occasional abuse cases has a generic
description of Tor that includes the IP addresses of my exit nodes
and can forward that information to whomever is interested without
having to contact me every time.
This arrangement worked rather well so far.
For reasons unknown to me the investigation that lead to the
raid was handled by a different police department, though, and
apparently the police men involved prefer to "investigate" a bit
differently. They also didn't seem that fond of Tor in general.

@_date: 2011-07-24 23:02:16
@_author: Fabian Keil 
@_subject: [tor-talk] specify exit for only one website? 
It's possible if you enable the AllowDotExit option, but it's disabled
by default for a (documented) reason. Most of the time using the
already mentioned MapAddress option is a better idea.

@_date: 2011-03-03 12:37:16
@_author: Fabian Keil 
@_subject: [tor-talk] server4you 
Thanks for the tip.
You don't have to go to the police, the letter is
just a misleadingly worded invitation.

@_date: 2011-05-13 13:15:54
@_author: Fabian Keil 
@_subject: [tor-talk] Vidalia 0.3.0-alpha is out 
My Vidalia use case is to manually let it connect to the control
port of an already running Tor process. With 0.2.12 this works and
looks like this:
fk at r500 ~ $/usr/obj/usr/ports/net-mgmt/vidalia/work/vidalia-0.2.12/src/vidalia/vidalia --loglevel notice
May 13 12:48:02.325 [notice] Resetting UI translation to English default.
May 13 12:48:02.427 [notice] Vidalia 0.2.12 using Qt 4.7.2
May 13 12:48:02.520 [notice] QtWarningMsg: Application asked to unregister timer 0x9000004 which is not registered in this thread. Fix application.
May 13 12:48:02.777 [notice] Tor status changed from 'Unset' to 'Stopped'.
May 13 12:48:05.109 [notice] Tor status changed from 'Stopped' to 'Starting'.
May 13 12:48:05.140 [notice] Tor status changed from 'Starting' to 'Started'.
May 13 12:48:05.153 [notice] Tor status changed from 'Started' to 'Authenticating'.
May 13 12:48:05.159 [notice] Authenticating using 'null' authentication.
May 13 12:48:15.663 [notice] Tor status changed from 'Authenticating' to 'Authenticated'.
May 13 12:48:15.664 [notice] Tor status changed from 'Authenticated' to 'Circuit Established'.
May 13 12:49:46.896 [notice] Cleaning up before exiting.
May 13 12:49:46.905 [notice] Vidalia is exiting cleanly (return code 0).
With 0.3.0 this doesn't work. Vidalia starts with the progress bar
already at 18% even though it's not supposed to connect automatically
and the "Start Tor" button doesn't seem to do anything:
fk at r500 ~ $/usr/obj/usr/ports/net-mgmt/vidalia-devel/work/vidalia-0.3.0/src/vidalia/vidalia --loglevel debug
May 13 12:54:21.401 [notice] Resetting UI translation to English default.
May 13 12:54:21.402 [info] Removing all currently installed UI translator objects.
May 13 12:54:21.517 [notice] Vidalia 0.3.0 using Qt 4.7.2
May 13 12:54:21.670 [info] Using Tor's GeoIP database for country-level relay mapping.
May 13 12:54:21.698 [notice] QtWarningMsg: QSystemTrayIcon::setVisible: No Icon set
May 13 12:54:21.704 [notice] QtWarningMsg: Application asked to unregister timer 0x3600000b which is not registered in this thread. Fix application.
^CMay 13 12:55:30.490 [notice] Cleaning up before exiting.
May 13 12:55:30.496 [notice] Vidalia is exiting cleanly (return code 0).
The behaviour seems to be the same when trying to use a Control Socket
instead of a Control Port. I'm using FreeBSD 9.0-CURRENT amd64.
Is manually connecting to an already running Tor process working for anyone else?

@_date: 2011-05-13 15:08:52
@_author: Fabian Keil 
@_subject: [tor-talk] Vidalia 0.3.0-alpha is out 
I meant having the "Connect to Tor automatically" option disabled
so Vidalia doesn't connect to Tor until the "Start Tor" button is
There are no debug messages before the
"[notice] Tor status changed from 'Unset' to 'Stopped'."
message which Vidalia 0.3.0 already lacks.
Sure:

@_date: 2011-09-03 14:28:04
@_author: Fabian Keil 
@_subject: [tor-talk] Tor Exit Node Operator Raided in USA. 
Sure, but I see no reason to believe that the fact that
the offending requests were (supposedly) made through an
open WAP instead of a Tor exit node made a difference.
The country probably did, though.
Given that there are (probably) a lot more open WAPs than
there are Tor exit nodes and that open WAPs can't be easily
abused from other parts of the world, the risks still seem
a lot lower to me.

@_date: 2011-09-24 11:16:19
@_author: Fabian Keil 
@_subject: [tor-talk] question about socks 4, 5 
I never used TBB, but the "Vidalia log" in vanilla Vidalia is basically
a Tor log, so if you configure Tor to additionally log to a file, the log
messages should survive the Vidalia shutdown.
You are probably referring to:
Sep 21 22:43:31.377 [warn] {APP} Your application (using socks5 to port 80) is giving Tor only an IP address. Applications that do DNS resolves themselves may leak information. Consider using Socks4A (e.g. via privoxy or socat) instead. For more information, please see The important part is "giving Tor only an IP address",
you can get the same message for SOCKS4.
The URL should probably be fixed, but I'm not sure if the
original content still exists somewhere.
Simplifying things a bit, SOCKS 4 and 5 both have two "flavours",
one where the client itself resolves the addresses (potentially
"leaking" DNS requests) and one where it doesn't have to (but still
Tor users usually want to use the ones where the client doesn't have
to resolve addresses and naturally they want to use clients that don't
resolve anything anyway.
In case of SOCKS4 that flavour is called SOCKS4A, in case of SOCKS5
it's often called "SOCKS5 with hostnames", but many applications only
support one SOCKS5 flavour and you may have to check the documentation
to figure out which one it is.
For example Privoxy only supports the "SOCKS5 with hostnames"
flavour but simply refers to it as SOCKS5 in the configuration
files. The documentation should make it clear, though:
The same is true for Polipo:
curl supports both, and the switches are --socks5
and --socks5-hostname, so in this case most Tor users
would want the latter.
If an application has properly working SOCKS support
there usually isn't any need to additionally configure
a HTTP proxy unless the proxy itself does something
you consider useful.
If a client supports both SOCKS4A and "SOCK5 with hostnames"
it's usually preferable to use the latter as it supports more
detailed error codes. It's up to the client to do something
useful with them, though.
There seems to be some history available:
I agree. It's also not clear if they are sufficient.
It's my impression that they may not cover everything,
but as I don't use Thunderbird I could be wrong.

@_date: 2012-08-21 13:14:47
@_author: Fabian Keil 
@_subject: [tor-talk] Freedom not Fear 2012: Great opportunity for Tor advocacy 
There's an upcoming bar camp in Brussels (2012-09-14 - 2012-09-17) that
is relevant to our interests, but doesn't seem to be on the calendar yet:
It's likely to be attended by a fair number of non-technical people
who strongly care about privacy and can reach other people that feel
the same, but for various reasons aren't using Tor already, or use it
but have misconceptions about what it protects against.
It would be great if an official member of the Tor project could make it.
People who are willing to provide the EU with a bunch of personal information
additionally may be able to meet with representatives of the EU commission and
the EU parliament and qualify for a travel allowance of up to 120 EUR.
For details see:
I intend to be there and feel confident talking about Tor in general,
arm and Vidalia (which I only use as monitor, though), but I'm not in
a good position to say more than a couple of words about e.g. Orbot,
Tor cloud, TBB or Obfsproxy.

@_date: 2012-01-13 22:01:51
@_author: Fabian Keil 
@_subject: [tor-talk] Tor VPN Server selfmade 
While redsocks looks interesting, it's not clear to
me why you need it in this configuration at all.
What benefit does it offer compared to letting pf redirect
the TCP connection into Tor's TransPort directly and using
Tor as DNS server.

@_date: 2012-06-11 18:41:49
@_author: Fabian Keil 
@_subject: [tor-talk] How to force redirect each application through 
That's incorrect. Privoxy can change the forwarding settings based on tags:
And while polipo currently can't do that, you could simply provide each
client with its own polipo instance and have each instance forward
to a different SocksPort.
BTW, if you don't need wget's webscraping support you could
replace it with curl which has proper socks support.

@_date: 2012-06-27 19:07:33
@_author: Fabian Keil 
@_subject: [tor-talk] How to force redirect each application through 
The documentation above has been available for years and already
contains an example. Are you looking for something specific that
the current documentation doesn't answer?
I've been doing it for years and think it's convenient,
but of course it's a matter of opinion.
The User-Agent can be discovered by letting the proxy (or nc) log it.
It is also usually constant between updates, so checking it once
per update should do.
gpg doesn't seem to set a User-Agent, but that not a problem
as you can either let it use the default forwarding proxy or
change the forwarding based on other criteria like the address
of the keyserver.

@_date: 2012-06-30 18:00:00
@_author: Fabian Keil 
@_subject: [tor-talk] How to force redirect each application through 
That's probably true, but I also think a significant amount
of people doesn't care about this anyway.
I don't see why it should be more complicated and error
prone than using the port number.
Once either method has been configured correctly and tested
it should work reliably until the environment changes.
If you are using TransPort anyway, I don't see the benefit of
additionally using torsocks.
It already does.
I thought about this a while ago, but as you can already get the
use-a-different-forwarder-for-each-listen-address functionality
be using a different IP address for each listen-address it didn't
seem worthwhile at the time.

@_date: 2012-03-03 14:10:31
@_author: Fabian Keil 
@_subject: [tor-talk] Operating system updates / software installation 
Of course this only helps if you are actually building the
packages from source, something the "random person out of a barcamp"
probably doesn't do. The official packages are neither signed nor
transferred securely when using pkg_add -r.
It's my impression that signed packages aren't a priority
for the BSDs in general.
While there's no need to run portaudit at root, I agree
that a signed auditfile.tbz would be preferable.
I don't see why apt absolutely has to run a gpg with root privileges.
If it really does it, it seems more like an implementation detail
than a necessity.

@_date: 2012-11-30 12:25:22
@_author: Fabian Keil 
@_subject: [tor-talk] William was raided for running a Tor exit node. 
There doesn't seem to be any indication that he has been
charged with anything.
Usually raids happen to collect evidence that might lead to the
suspect being charged later on, but it can also lead to the case
being dropped by the public prosecution and that might even happen
without analysing the evidence.
At least in Germany my impression is that Tor-related raids
don't usually lead to Tor-related charges. I'm not aware of
any statistics about this, though.

@_date: 2012-11-30 13:00:43
@_author: Fabian Keil 
@_subject: [tor-talk] William was raided for running a Tor exit node. 
Somehow I doubt that that's actually up to the Austrian police to decide.

@_date: 2012-10-08 14:59:34
@_author: Fabian Keil 
@_subject: [tor-talk] answers of Ms Kroes on EP questions 
I can look into this if nobody else is already working on it.
BTW, some people think blocking Tor without proper cause violates EU law
and apparently a complaint has been filed a couple of months ago:

@_date: 2012-10-31 11:42:52
@_author: Fabian Keil 
@_subject: [tor-talk] Tor web browsing http connection establish procedures 
If the browser is using socks, it establishes a TCP connection to the
Tor client, sends a socks request that contains the destination address,
(optionally) waits for the Tor client to confirm with a socks reply that
the connection to the destination has been established and sends the
HTTP request on the same connection.
The DNS resolution is transparent to the browser.
The details are described in RFC 1928 and the documentation
on the Tor website.

@_date: 2013-02-04 14:33:29
@_author: Fabian Keil 
@_subject: [tor-talk] Legal problems: TOR relay & Torrents in .de 
I wouldn't rule out the possibility that they mixed up IP addresses
or misinterpreted the results of their detection software ...
I generally ignore such donation offers if I get the impression
that it has been created without human interaction.
Otherwise I respond with a short explanation about Tor provided
an email address is provided and I don't have to waste stamps.
I don't see the point of consulting a lawyer if no court is
involved as it makes it more complicated to get back the lawyer
The scam works by threatening enough people to pay up. Actually
following through on the threads is more expensive than just writing
more threats to other people.

@_date: 2013-02-24 11:41:56
@_author: Fabian Keil 
@_subject: [tor-talk] Problem about verify signatures 
Using gpg directly seems to be the recommended way:
Without knowing the error message you got from GPA it's impossible
to tell what's going on and reporting any problem to the GPA project
is probably premature.
I'm not familiar with GPA but as long as gpg itself confirms that
the signature is valid and the gpg binary came from a trustworthy
source, I wouldn't worry about the GPA issue unless the error message
explicitly tells you that the signature is invalid and not just that
it can't be verified (for example due to missing the public key).

@_date: 2013-03-07 16:52:48
@_author: Fabian Keil 
@_subject: [tor-talk] Vista DEP and TBB 
I don't use TBB or Vista, but I've recently started getting
"SOCKS5 TTL expired" errors (Privoxy's translation for SOCKS5
error code 6) that seemed to survive circuit changes and
persisted until tor got a SIGHUP or was restarted.
If you just refreshed the page a bunch of times but didn't actually
restart tor, this could explain the check.torproject.org issue.
Note that I haven't correlated my logs yet to verify that this is
a real issue and not just a bunch of coincidences that looked like
a Tor problem.

@_date: 2013-10-16 11:21:55
@_author: Fabian Keil 
@_subject: [tor-talk] OT - Stop Watching Us NSA rally on 10/26/2013 
And if Germany is closer to you: We (AK Vorrat K?ln-Bonn) will have a booth before and after the rally
in Cologne where we'll also talk to interested visitors about Tor:
BTW, could we get some official Tor advocacy material (stickers,
leaflets ...) for this and similar events we participate in?
The FSFE has: but I'm not aware of a similar page for Tor stuff.

@_date: 2013-10-24 10:56:56
@_author: Fabian Keil 
@_subject: [tor-talk] VOIP and tor 
Unless I missed it, no specific law was mentioned so far.

@_date: 2014-08-16 15:23:23
@_author: Fabian Keil 
@_subject: [tor-talk] Performance 
Privoxy has to buffer the whole page if it's configured to filter it
as the last byte might affect whether or not the first byte has to
be modified.
If filtering is disabled (globally or for the current response),
the page isn't buffered. Encrypted responses aren't buffered either.
Earlier versions of Privoxy behaved the same way and I believe even
Privoxy's predecessor was "smart" enough for this.
Privoxy 3.0.21 and later support Tor's "optimistic data" feature
(with some limitations). While it technically improves performance,
it's seems rather hard for a human to tell whether or not it's enabled,
No arguments there.
Whether or not they are missing out on "performance" and which
part of the chain is to blame is a different question, though.

@_date: 2014-06-19 14:13:11
@_author: Fabian Keil 
@_subject: [tor-talk] multiple local proxy ports 
What's your use case and which Privoxy how-tos are you referring to?

@_date: 2014-06-25 16:58:27
@_author: Fabian Keil 
@_subject: [tor-talk] multiple local proxy ports 
Unless the five users are using the same login, making sure that
their bundles use different ports and paths should be sufficient.
I don't use TBB or Windows, so I don't have any concrete suggestions.
If the users don't need access to Tor's control port (or trust each
other) you could also consider using a single Tor instance listening
on multiple ports that is always running. This would probably require
lots of TBB changes, though.
No. The guide author seem to have different goals.
I'm using Privoxy for this, but my use case is different (one user,
multiple applications) and in your case adding Privoxy to the mix
would complicate things without being necessary (unless you want to
use Privoxy for other reasons anyway).

@_date: 2014-03-12 15:51:34
@_author: Fabian Keil 
@_subject: [tor-talk] Protest against mass surveillance: Cologne, Germany, 
Through the German Working Group on Data Retention (AK Vorrat)
I'm involved with the organisation of a protest weekend against
mass surveillance on 2014-04-12 in Cologne, Germany:
Obviously this would be a good opportunity for Tor advocacy,
but I'll be mainly busy with other stuff.
We are still looking for national and international supporters
(and speakers) so please let me know if you are interested.
You'll note that Zwiebelfreunde e.V. is already supporting
us (there will be Tor stickers), but it would be great if other
Tor-related organisations, groups or projects could support us
as well. Agreeing with our demands is sufficient to get listed,
everything on top of that is optional.
There will be workshops, too. Let me know if you are interested
in doing something related to Tor or surveillance in general and
I'll try to help.
AK Vorrat K?ln-Bonn

@_date: 2014-05-05 13:14:55
@_author: Fabian Keil 
@_subject: [tor-talk] Orbot v14 alpha: obfsclient, Tor 0.2.5.3-alpha 
Are Orbot's proxy requirements documented somewhere?
Could you please post (or provide links to) the Privoxy and Polipo
configurations, system settings and tests that were used to compare
memory usage and performance?
I think Orbot should use whatever works best, but I'd like to reproduce
and analyse those Privoxy issues to figure out if they are design issues
or bugs that should be addressed or were merely the result of configuration

@_date: 2015-08-14 10:18:58
@_author: Fabian Keil 
@_subject: [tor-talk] ConnLimit issues with tor-0.2.7.2-alpha 
This is probably a known regression that has been already fixed in git:

@_date: 2015-05-05 14:53:54
@_author: Fabian Keil 
@_subject: [tor-talk] 100-Foot Overview on Tor 
A couple of comments (about v1.3):
From page 68:
This could be interpreted to mean that the node stops functioning
for the whole network (trivial DoS) while the source suggests that
it merely closes the circuit.
Page 73 could mention that the .exit notation is disabled by default.
Page 124:
s/implemented at/implemented as/
Page 138 specifies bandwidth without unit of time.
Page 141 and 142 seem to suggest that parsing strings is more
likely to be vulnerable than parsing binary data. Is that intended?
Is the source of the PDF available under a free license?
I'm currently preparing a (German) presentation about location
hidden block storage and could reuse the HS-related parts:

@_date: 2015-05-23 19:01:31
@_author: Fabian Keil 
@_subject: [tor-talk] 100-Foot Overview on Tor 
Thanks. As it turned out I did not have the time to delve
into Tor details this time, but I may have in the future.

@_date: 2015-09-18 17:54:20
@_author: Fabian Keil 
@_subject: [tor-talk] Slides from 1C2 talk about location hidden block storage 
A couple of months ago I gave a German talk about accessing block
storage through one or more hidden services using ElectroBSD,
zogftw and (obviously) Tor.
The slides are available online now:
Most of the slides contain pictures, code or command output and
thus hopefully aren't entirely useless if you don't speak German.

@_date: 2017-09-15 17:54:50
@_author: Fabian Keil 
@_subject: [tor-talk] Document Leak: German Agency BND cooperates with NSA 
Could you please quote the part of the article or source documents that
lead you to the conclusion that "[a]ll three agencies run their own
exit nodes"?
The article claims that the BND considers the fact that several exit
relays are located around Washington DC a hint that they are run by
unnamed agencies.
There's also a source document that claims that the BND heard from
other (unnamed) agencies that they installed Tor nodes and used
"protocol data" of those nodes in "investigations".
Unless I missed it, however, there's no claim that the BND itself
is running public Tor relays, did this in the past or intends to
do it in the future.
Relevant German excerpt from the article itself:
Relevant German excerpt from the source document "ME TWD-1623/10"
