
@_date: 2005-07-28 17:25:09
@_author: Pei Hanru 
@_subject: minimise to system tray 
Take a look at this FAQ entry:
I haven't tested it though.

@_date: 2006-04-29 20:20:50
@_author: Pei Hanru 
@_subject: IP changed, then... 
I'm behind a NAT, running a Tor node. My ISP will unreasonably change my IP every 48 hours. Usually Tor runs well, but when my IP changes, I will get an entry in Tor log like this:
[notice] resolve_my_address(): Your IP seems to have changed. Updating.
[warn] second_elapsed_callback(): Your server (xxx.xxx.xxx.xxx:9001) has not managed to confirm that its ORPort is reachable. Please check your firewalls, ports, address, /etc/hosts file, etc.
The "[warn] second_elapsed_callback()..." is added to the log every 20 minutes and will lasts forever. By contrast, if I restart Tor, then it tells me
[notice] Now checking whether ORPort xxx.xxx.xxx.xxx:9001 is reachable... (this may take up to 20 minutes -- look for log messages indicating success)
[notice] router_orport_found_reachable(): Self-testing indicates your ORPort is reachable from the outside. Excellent. Publishing server almost immediately!
So, should I restart Tor manually every time when my IP changes? In FAQ, I get an answer said no, but what's wrong here?

@_date: 2006-04-09 17:08:17
@_author: Pei Hanru 
@_subject: AW: Circuit failure after IP changes 
I'm running a Tor middlenode, I have the same problem.
My server has been down for a day or two, will this cause the binding nickname and fingerprint being deleted from the directory authorities?

@_date: 2006-08-21 20:32:23
@_author: Pei Hanru 
@_subject: Unable to start Tor in Cygwin 
I complied Tor in Cygwin successfully, but when trying to start Tor, I
got the following messages and Tor exits.
Aug 21 20:23:55.890 [notice] Tor v0.1.2.0-alpha-cvs. This is
experimental software. Do not rely on it for strong anonymity.
Aug 21 20:23:55.905 [notice] Initialized libevent version 1.1b using
method poll. Good.
Aug 21 20:23:55.905 [warn] set_max_file_descriptors(): Could not set
maximum number of file descriptors: Too many open files
Aug 21 20:23:55.905 [warn] Failed to parse/validate config: Problem with
ConnLimit value. See logs for details.
Aug 21 20:23:55.905 [err] tor_init(): Reading config failed--see
warnings above.
I also tried to start Tor with the option ConnLimit, such as "tor
ConnLimit 100", but still failed...
Dos anybody here know where the problem is? Any hint? Thanks in advance.

@_date: 2006-08-22 19:19:24
@_author: Pei Hanru 
@_subject: Unable to start Tor in Cygwin 
I think I've traced where the problem is. Cygwin *does* have a
limitation on the number of RLIMIT_NOFILE, if the soft limit is set to
be larger than 3200, setrlimit returns with the error "Too many open
files". But Tor defines MAXCONNECTIONS 15000, which is passed to
setrlimit and is much larger than 3200. See
I've rebuilt Tor definning MAXCONNECTIONS 3200, now everything is OK. :)
Will 3200 enough, for a client or a slow server?

@_date: 2006-12-03 19:29:13
@_author: Pei Hanru 
@_subject: Communications between Tor servers within the Tor network, an idea 
Hash: SHA1
Hi all,
I've conceived a possibly new usage of the Tor network, I need your
The problem:
The Tor network is composed of servers run by volunteers from all over
the world, the role of these servers is solely to relay traffic, the
benefits which can be proposed to convince a user to run a server is not
very obvious (yes, I know, user may get better anonymity by running a
I think this situation might be improved by introducing a new usage to
the Tor network, say, letting Tor servers -- no matter exit or not --
having the ability to communicate with each other within the Tor
network, here, *communicating* is a broader concept besides relaying
For example, both A and B are running *non-exit* Tor servers. Now, A
want to secretly and securely send a file to B, he(A) doesn't need other
mechanisms, he doesn't need to know B's address either, all he needs is
B's nickname, he specifies: "I want Tor to transfer my file to
B(nickname)", then Tor will create a circuit starting from A's server
and ending at B's server, the file is transfered over the circuit, never
goes out of the Tor network, thus meets A's security needs (right?).
So, with this usage, people will have more reasons to run Tor servers,
they will learn their Tor servers can do more than just relaying traffic
for others, more servers will add to the network. And it seems most of
these new servers will be non-exit, this may be helpful to
OK, I've described my idea, hopefully it is clear. :)
Some questions follow.
1) I know my idea is rather primitive, but in general, is it an idea
worth deeper investigation?
2) If the answer to the above question is true, then is it possible to
use available softwares to meet this usage (e.g., by tweaking torrc)?
3) I believe it's always possible to write new code to meet this usage,
but will it be hard or just a snap?
Pei Hanru

@_date: 2006-12-03 20:45:17
@_author: Pei Hanru 
@_subject: Communications between Tor servers within the Tor network, an 
I've never heard of Torward, but it seems A needs to setup a hidden
service here, and it is restricted to file transfer. My idea can be used
in more scenarios, file sharing is only an example, other scenarios
could be chatting, all sorts of peer 2 peer communications.
Sure, A knows who B is, and B knows who A is, we could assume A and B
are acquaintances, they want to secretly share files, using Tor gives
them additional anonymous feature that *any* file transfer tool don't
have, that is, nobody else knows they are sharing files.
So, maybe my idea could be summarized as "a set of people as a whole
gain anonymity from others by running Tor servers".
I'm only only adding, rather than modifying, Tor still works as it is,
but a new usage is introduced.
One thing to clarify, client is still needed, the key here is a Tor
server now has the ability to communicate with another server, they
could build a circuit, and clients reside at two ends could use this
circuit to share information secretly.
Thank you for your comment. :)

@_date: 2006-12-09 16:48:04
@_author: Pei Hanru 
@_subject: how to prevent Tor from auto-buiding circle? 
Since you're writing your Tor controller, Tor control protocol is surely
of great importance. See

@_date: 2006-07-12 16:50:18
@_author: Pei Hanru 
@_subject: Reliability of circuit extension if target server is running 
I have another question about this FAQ, what does 'Tor server' here mean? Must this Tor server be an exit node?
In a more specific scenario, for example, if the Tor server exits only at port 443, but people browse the website on the same IP at port 80 using Tor, will their circuit exit from this Tor server?

@_date: 2006-05-06 18:37:02
@_author: Pei Hanru 
@_subject: Tor limitations 
In case you may forget, at , there's a vivid picture of bandwidth used and bandwidth capacity -- seems Tor network is capable of many more clients. :)
As far as your question is concerned, the picture of total traffic tells something, but doesn't tell everything, e.g., how about exit node capacity vs. client capacity?
IMHO, the answer is self-regulation. If Tor network was overcrowded, then some impatient clients left, then, recovered.

@_date: 2007-04-22 16:44:06
@_author: Pei Hanru 
@_subject: Client config help - TOR will not start - directory information 
I think everything is OK judging from the log you gave. This is the
first time you start Tor, what Tor is doing here is:
1) it connects to one of the directory authority to get its
network-status document;
2) it connects to several directory mirrors to download other
authorities' network-status documents and enough router descriptors.
There's a threshold of how many network-status documents and router
descriptors Tor client should get before it begins to build circuit,
before then, Tor will tell you "...but not enough to build a circuit".
Since the Tor network is becoming larger and some servers are not very
fast, it's normal to take some time to build the first circuit.
So, what you should do is just calm down and wait for a while.
(PS, these two entries are interesting:
Apr 22 00:34:46:390 [Notice] Tor v0.1.2.12-rc. This is experimental...
Apr 22 00:08:41.531 [notice] Tor 0.1.1.26 opening new log file.
Why the version numbers are different?)

@_date: 2007-08-14 15:57:19
@_author: Pei Hanru 
@_subject: Querying TOR server info 
If your Tor server has its control port (normally 9051) open, you may
telnet into it and use getinfo command to get the entry guards list:
  $ telnet localhost 9051
  > authenticate
  > getinfo entry-guards
If the control port is not open, you may view the status file in Tor's
data directory (e.g. /var/lib/tor).

@_date: 2007-01-12 17:41:50
@_author: Pei Hanru 
@_subject: Block directory authorities, is it possible? 
Hash: SHA1
Hi all,
I live in China and was/am having difficulties in using Tor, the problem
is: it takes quite a long time to build a circuit for the first time I
start Tor on my Windows machine.
I think it is because of the earthquake that destroys the fibers at the
seabed near Taiwan at the end of 2006, communications to the US were
almost blocked, to the EU were jammed. So it is very difficult to
download a new network-status from a directory authority.
Excerpt from dir-spec.txt:
network-status documents from a randomly chosen authority.
Well, Tor will finally recover here when the fibers are repaired. But
this reminds me of a possible attack against the Tor network, say, if
the notorious Great Firewall of China blocks *all* the connections to
*all* the directory authorities (currently 5 I believe), then Tor will
will become completely useless in China. Considering the number of
directory authorities, this doesn't seem to be infeasible. (In fact, I
think this is easy to some extent.)
Am I understanding correctly? Are there any actions Tor can take? After
all, we cannot simply assume this will not happen in the future.

@_date: 2007-01-13 17:20:31
@_author: Pei Hanru 
@_subject: Block directory authorities, is it possible? 
Actually, no IP is blocked at this time, it is due to a natural disaster. :(
It's interesting to evaluate whether the option you mentioned will
defend the attack (that is, blocking all directory authorities), in that
setting, there's no living network-status, how to find "other tor
nodes"? Manually importing required files is an idea, but, it's not that
elegant and finding up-to-date files is a problem.
I'm curious on more details. :)

@_date: 2007-01-15 16:18:05
@_author: Pei Hanru 
@_subject: Block directory authorities, is it possible? 
Probably nobody could clarify this issue, the Great Firewall is operated
in the dark, almost all the work is based on reverse engineering, and to
everyone's surprise, they even won't dare to admit the existence of the
Well, also please correct me if I'm wrong. :)
P.S., Kevin, the full paper you mentioned is at:

@_date: 2007-03-08 16:45:02
@_author: Pei Hanru 
@_subject: Building tracking system to nab Tor pedophiles 
Put them all:
1. "Things to know before downloading" on the download page.
2. "Things to know before installing" on the installer wizard.
3. A "Tor checker" web page or whatsoever after installing and
4. "A bubble from Tor GUI (Vidalia, etc.) saying 'Tor cannot completely
protect you from eavesdroppers, for more information, ...'" each time
Vidalia starts.
The more, the better.

@_date: 2007-03-25 18:20:10
@_author: Pei Hanru 
@_subject: Is this a Tor exit node connecting to me? 
A small issue. When I query the DNSBL server for my slow, middleman only
(reject *:*) server, it returns 127.0.0.2. Is it a good idea to include
non-exit Tor servers in this list?

@_date: 2007-11-15 13:32:31
@_author: Pei Hanru 
@_subject: try to translate the docs into Chinese 
Hash: SHA1
Could you tell us a bit more about which docs are you going to translate
(or update)? For website contents, you may send to me directly and I'll
commit them to Tor's svn repository.
Everyone can edit a wiki, but be sure it's easily accessible by
Chinese-saying people, so better it's not dispersed in Tor's official
English wiki.

@_date: 2007-11-27 19:20:03
@_author: Pei Hanru 
@_subject: Another host in China which use persistant cookie to track Tor 
Hash: SHA1
60.16.34.94 seems not to be a Tor node. After some google, it is more
likely that you are using a node from China as your last hop, and the
node's ISP is CNC (China Netcom), and CNC is hijacking HTTP requests (to
insert ad or whatsoever).
It's not the fault of a Tor node in China, it's the f**king ISP! :(

@_date: 2007-10-23 19:08:28
@_author: Pei Hanru 
@_subject: Having trouble setting up TOR server Additional info,, 
Hash: SHA1
Hi, Algenon
At Linksys_Port_Forwarding.htm (Port range forwarding) page, I noticed
you have two similar port forwarding rules, but they have different IP
addresses, one is 192.168.1.2, the other is 192.168.1.3, maybe that's
where you problem lies.
Delete the wrong one, and try again.
Thanks for your contribution to the Tor community!

@_date: 2007-10-28 15:31:55
@_author: Pei Hanru 
@_subject: UpDate: Hello Ringo Kamens,,, Having trouble setting up TOR server 
Hash: SHA1
Unfortunately, you are doing worse...
What you should do is first figuring out the *actual* private IP address
of your Linux box, then forwarding port 9001 and port 9030 (or port
range 9001-9030 if you like) to *that* address, rather than forwarding
the same port range to three distinct addresses.
It's a good idea to reread port forwarding part of Linksys manual carefully.

@_date: 2007-10-30 19:39:56
@_author: Pei Hanru 
@_subject: Email sent through Tor, Problem 
Hash: SHA1
Could you elaborate a bit on how your receiver found the origin of your
mail? Just now, I sent a mail using hotmail web interface through Tor
network, obviously, only the IP of a Tor exit node was recorded (in
"X-Originating-IP:" header).
Though my name appeared in that mail, but it's another story. :)

@_date: 2007-09-21 19:48:26
@_author: Pei Hanru 
@_subject: New Tor routers in specific countries 
What evolution are you referring to here?
For why there're increasing number of routers in China, Roger has a
plausible explanation, see
(the above link also contains a link to another network statistic page,
it shows history, but it's relatively new and I can't see any impressive
Nothing else.

@_date: 2008-01-29 16:20:40
@_author: Pei Hanru 
@_subject: Scripted exclusion of nodes? [Was: How to remove some useless 
Hash: SHA1
ExcludeNodes option will exclude nodes in the list from being used in
the circuit -- not only at exit, but also at entry and middle. In my
opinion, a node from China at entry or middle does no harm, and it has
the potential benefit for a circuit of being in more jurisdictions.
I've long wondered if there is (will be) an option for excluding nodes
solely at exit?
P.S. my practice for "removing useless nodes" is hardcoding a small
number of fastest nodes in China into the ExcludeNodes option, and I've
had almost no problem since.

@_date: 2008-01-31 16:17:57
@_author: Pei Hanru 
@_subject: One hop proxy [Re: Can nickname be duplicate?] 
There're already some one-hop-proxy tools for this specific purpose (I'm
not going to mention them publicly and assuming you're familiar with
them, if not, please drop me a private mail), and generally they're
faster than Tor.
There will be a lot of problems with one-hop circuit. For example, if
"bad" people know that there are one-hop circuits in the Tor network,
they will be more interested in attacking Tor, setting up more malicious
nodes, etc., the consequence is a mess.
I agree with you that Tor is slow, especially in China, we need to
improve this, but alas, it is easier said than done.
I'm also from China, haven't investigated such "browsing unsuitable
material but not spreading" issue you described. How do you draw the
above conclusion? Is it written somewhere?

@_date: 2008-06-21 17:04:21
@_author: Pei Hanru 
@_subject: RPM errors 
Hash: SHA1
I've tried 0.2.0.28-rc and 0.2.1.1-alpha rpms on RHEL4, this error did
show up.
Later, likely. :)

@_date: 2009-06-28 20:09:25
@_author: Pei Hanru 
@_subject: 25 tbreg relays in directory 
I finally got a plausible answer a few days ago.
The short answer is, someone are making use of Tor to do nasty things,
and all "tbreg"s aren't aware they are running Tor relays.
The long answer.
"tbreg" stands for "TaoBao REGistrar". TaoBao is an eBay-like website in
China. Some sellers want to quickly increase their reputations
(so-called refresh) in order to attract more buyers. The first thing for
them is to register multiple accounts. However, TaoBao is rigorous on
this, a single IP is only allowed to register one or two accounts. So,
someone realize this need and begin to sell softwares which
automatically register large number of TaoBao accounts. Tor, together
with Privoxy are used as a HTTP proxy to bypass the IP restriction. For
some reasons I don't understand, this software will run Tor as a relay.
I've downloaded the software and tested, the version of Tor in it is
indeed 0.2.1.2-alpha, torrc in it is
  SocksPort 9050 # what port to open for local application connections
  SocksListenAddress 127.0.0.1 # accept connections only from localhost
  ControlPort 9051
  Nickname tbreg
  ORPort 9001
You may test yourself, the download link is
 (from
Finally some random thoughts.
1. We shall be reassured for a moment, these relays won't do much harm
to the Tor network. I'm more concerned about the people running these
relays, their computers aren't protected at all. But considering the
things these guys are doing... well, let it go!
2. Why Tor runs in a relay mode?
3. Should these "tbreg"s be banned from the Tor network? If so, what's
the best way to do?

@_date: 2009-06-29 18:07:24
@_author: Pei Hanru 
@_subject: 25 tbreg relays in directory 
Someone hinted in a local forum that those "tbreg"s are related with
Taobao. So I googled and found out what I've described. That's it.
