
@_date: 2008-08-10 09:13:54
@_author: Christopher Davis 
@_subject: Tor TransPort on OpenBSD? 
I made the diff for trunk, but the patch seems to apply cleanly to 0.2.0.30, as well. ie:
Macintosh:tor-0.2.0.30 chrisd$ patch -p0 < pf_open_startup.patch
patching file src/or/config.c
Hunk  succeeded at 1022 (offset -38 lines).
patching file src/or/connection_edge.c
Hunk  succeeded at 1633 (offset -8 lines).
patching file src/or/or.h
Hunk  succeeded at 2855 (offset -84 lines).

@_date: 2008-08-10 13:06:24
@_author: Christopher Davis 
@_subject: Tor TransPort on OpenBSD? 
trunk is where the current Tor development goes in the subversion
repository. Tor 0.2.0.30 is the latest stable version.
I've been running 0.2.0.30 on FreeBSD for a few weeks, and the transparent proxy functions well for my needs. I haven't used the alpha version, so I can't tell you how it compares to stable. Perhaps another user can respond.
Instead of installing Tor from an OpenBSD port or package, an easier way would be to download the source package from Tor's download page, then unpack, apply the patch, and compile and install. Applying the
patch should be straightforward. See my last email for the commands.
Remember to run the patch command from the root directory of the source package. The same might be accomplished with the KDE tool, but
I am not familiar with it. I've attached the patch to this email.
If patching and rebuilding is too much trouble, then simply adjust the permissions on /dev/pf, ie:
# chgrp torgroup /dev/pf
# chmod 660 /dev/pf
Where 'torgroup' is the group Tor runs as. This should quiet the

@_date: 2008-08-10 18:12:15
@_author: Christopher Davis 
@_subject: Tor TransPort on OpenBSD? 
It needs to access /dev/pf in order to determine the original destination address before redirection (using DIOCNATLOOK ioctl). For Linux, Tor uses getsockopt() for the same purpose, so there is no device node to access there.
See connection_ap_get_original_destination() in src/or/connection_edge.c for details.

@_date: 2008-08-10 19:30:52
@_author: Christopher Davis 
@_subject: Tor TransPort on OpenBSD? 
On FreeBSD, you can also put Tor in a jail with a high securelevel
to disable operations on /dev/pf that would alter the rules, while
permitting read operations, like DIOCNATLOOK. FreeBSD does allow
per-jail securelevel settings, independent of the host's level.

@_date: 2008-12-14 10:36:13
@_author: Christopher Davis 
@_subject: SSH and Telnet ports 
How practical is SSH password cracking over Tor? Wouldn't the latency
deter attackers?

@_date: 2008-12-15 08:18:56
@_author: Christopher Davis 
@_subject: SSH and Telnet ports 
Putting ssh on a wierd port does work well in my experience, and it can be an alternative to solutions that introduce firewall rules
automatically in response to (perceived) abuse. Auotmated tools
may be risky if the administrator doesn't have direct access to the console, etc.

@_date: 2008-07-03 15:29:43
@_author: Christopher Davis 
@_subject: Tor and HTTPS 
I'd also suggest seeing if your browser has an option to disable sending of the user agent header in HTTP requests. This is something
that privoxy can do, but may be difficult to tweak in some browsers.

@_date: 2008-06-05 17:37:53
@_author: Christopher Davis 
@_subject: How do we defeat exit node sniffing? 
Prefer TLS-enabled services, and mind the authenticity of server certs.
Or use Tor hidden services.

@_date: 2008-11-09 10:43:29
@_author: Christopher Davis 
@_subject: is tor an email mixmaster? 
Unfortunately, this doesn't seem to be running. The idea is
interesting, though. It would be prudent to enable spam filtering
and/or hashcash for a service like this, of course.
Alternatively, it should be possible to use google's relay after creating an account anonymously.

@_date: 2009-02-10 11:26:20
@_author: Christopher Davis 
@_subject: Grrr...SafeLogging doesn't work in 0.2.1.12-alpha :-{ 
This looks like the offending message:
--- src/or/connection_edge.c.orig	2009-02-10 11:20:48.000000000 -0800
+++ src/or/connection_edge.c	2009-02-10 11:21:05.000000000 -0800
 -328,9 +328,9    conn = TO_CONN(edge_conn);
   tor_assert(conn->state == EXIT_CONN_STATE_CONNECTING);
-  log_info(LD_EXIT,"Exit connection to %s:%u (%s) established.",
-           escaped_safe_str(conn->address),conn->port,
-           fmt_addr(&conn->addr));
+  log_info(LD_EXIT,"Exit connection to %s:%u established.",
+           escaped_safe_str(conn->address),conn->port);
+              conn->state = EXIT_CONN_STATE_OPEN;
   connection_watch_events(conn, EV_READ); /* stop writing, continue reading */

@_date: 2009-01-13 12:26:15
@_author: Christopher Davis 
@_subject: SOCKS4/5 support for OR and direcotry connections 
I'm working on a patch to enable SOCKS 4 and 5 support for Tor's OR and directory connections. I got SOCKS working for OR connections already, but the directory behavior is a bit more
challenging to SOCKSify, because it queues the request immediately on the connection's outbuf with the directory_send_command() call
right after connecting in directory_initiate_command_rend(). To get SOCKS to work, the parameters (resource, payload, etc) would need to be saved to the connection structure so directory_send_command() can be called after the proxy handshake finishes. Would that be acceptable?

@_date: 2009-01-13 16:33:07
@_author: Christopher Davis 
@_subject: SOCKS4/5 support for OR and direcotry connections 
I'll leave directory.c alone, then.
Is there any reason why Tor needs to support direct directory fetches at this point? Perhaps the code could be simplified a bit.
