
@_date: 2014-01-21 10:01:24
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 05:06, TT Security a ?crit :
Fwiw, I can confirm this unfortunate behavior. :(
TBB connecting to loopback netcat socket from tortestprivacy.url.ph
$ nc -l -p 1234
GET / HTTP/1.1
Host: 127.0.0.1:1234
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:26.0)
Gecko/20100101 Firefox/26.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Referer: Origin: Connection: keep-alive
Olivier Cornu

@_date: 2014-01-21 10:20:34
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le mar. 21 janv. 2014 10:01:24 CET, Olivier Cornu a ?crit :
Sorry, previous log showed an attempt with a regular Firefox.
Here is the TBB log:
$ nc -l -p 1234
GET / HTTP/1.1
Host: 127.0.0.1:1234
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:24.0) Gecko/20100101 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: Origin: Connection: keep-alive
Olivier Cornu

@_date: 2014-01-21 11:56:42
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 10:58, Mike Cardwell a ?crit :
Indeed. But being able to send requests to arbitrary *LAN* host:port and
get back discriminating answers allows easy scanning. A JS script might
scan the entire LAN, test firewall policies, and xhr the result back to
the originating website.
Indeed, and detect timeouts/errors via javascript?
The XHR method seems to provide more information and a more reliable
interface for scanning/network fingerprinting though (you can even test
LAN web servers CORS policy) -- I haven't looked into it deep enough to
be sure.
I'm not sure how this is all a good default for regular browsing, yet it
is clearly unacceptable in a TBB context: it makes (FOXACID) LAN
fingerprinting a breeze.
Olivier Cornu

@_date: 2014-01-21 12:14:04
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 11:44, Yuri a ?crit :
I guess that incorrect CORS policy on local apache interrupts the XHR,
as Mike explained, whereas netcat (or port 443) XHRs time out.

@_date: 2014-01-21 12:38:45
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 11:30, Yuri a ?crit :
Loopback (and LAN I bet) is accessible with TBB, FF and Chromium on
Linux (Ubuntu). Platform specific behaviors?
Anyway, the more I think about it, the more I see this as a TBB bug: TBB
is leaking non-Tor connections on client LAN.
As I understand it, current behavior is too clever and too liberal:
instead of allowing non-Tor connections to LAN hosts, supposedly because
they are safe, it should block them as a default.

@_date: 2014-01-21 15:45:19
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 13:18, Max Jakob Maass a ?crit :
You're right: TBB only leaks on "127.0.0.1" when tested from a local
HTML file. "localhost" as well as other non-loopback IP addresses are
rejected by the SOCKS proxy:
    [warn] Rejecting SOCKS request for anonymous connection to private
    address [scrubbed]
On Linux, stock FF and Chromium (w/o proxy) do connect to all the above.
So, TBB's supposed bug becomes: TBB is leaking non-Tor traffic to 127.0.0.1.
I believe this breaks TBB's required proxy obedience
The testing site is enough to show the vulnerability, but it does not
try to perform advanced fingerprinting:
* XHR to a local web server will get stopped by CORS policies and appear
as a "closed port".
* Timeouts are interpreted as a "closed ports" too (although it may show
return statuses): in some cases (like the netcat test) it times out
because server is waiting for more input than the HTTP GET request it's
given before closing the TCP connection; In other cases it may timeout
because the port is open but filtered.
Also, it'd be nice if  would allow tweaking
the full URL (rather than just port number) for public testing purposes.
Could you perhaps help with that, TT Security? :)
Olivier Cornu

@_date: 2014-01-22 00:31:59
@_author: Olivier Cornu 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Le 21/01/2014 16:02, Max Jakob Maass a ?crit :
I forgot to thank you earlier. :)
Olivier Cornu

@_date: 2014-01-31 15:00:54
@_author: Olivier Cornu 
@_subject: [tor-talk] NoScript for TOR disabled by default 
Le 31/01/2014 01:18, Joe Btfsplk a ?crit :
It does not have to be Mozilla, it could also be any website visited:
Where Mozilla might be held responsible is because the corresponding bug
has had an open ticket for almost 8 years:
But perhaps I misunderstood what Sukhoi meant?
