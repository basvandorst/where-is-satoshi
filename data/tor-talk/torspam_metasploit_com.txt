
@_date: 2007-03-08 16:12:10
@_author: H D Moore 
@_subject: Warnings on the download page 
I just subscribed to the or-talk list and would be happy to answer any questions related to the recent "catching pedophiles" article and the decloak test tool. I am in the process of updating the decloak demonstration to explain each of the tests and provide source code for the components. What may not be obvious (especially from the ZDNet article), is that I believe in the Tor project's goals and am not developing these types of tests to damage the project. I will not respond to any questions regarding the legallity of Tor traffic capture and manipulation. I believe this is still a gray area, since it depends on whether a Tor node qualifies as a service provider or meets the safe harbor requirements. I will not respond to questions about what, if any, Tor nodes I operate.
I am able to answer any technical questions related to the research I have done (which includes generic content-detection and filtering, as well decloaking/deanonymization tests). Some quick URLs for anyone who needs them:
 -  (this starts Java)
Torment (outdated tor source + ruby patch):
 -

@_date: 2007-03-08 16:33:49
@_author: H D Moore 
@_subject: Warnings on the download page 
Hi Roger,
Looks good so far. From my perspective, the biggest risks are:
1) Third-party client applications leaking the real IP address of the user. This includes Java, Flash, media players, PDF viewers, Word documents...anything that opens up an external application that doesn't go through the proxy.
2) Persistent cookies. If a rogue Tor node injects a HTML response back to the user containing an IFRAME for every major web site, and that user has a stored cookie for one of those sites, it could lead to the identity of the user being disclosed. 3) Web application hijacking. If a rogue Tor node watches for a specific pattern, such as the "welcome!" message from a web application or web mail portal, the Tor node could kick the user out and hijack their session. This is especially dangerous for sites that SSL-protect the authentication process, but leave the rest of the application unencrypted (Yahoo, GMail, others?). Once a valid session has been obtained, the node operator could send spam (web mail), impersonate the user, or just data mine their messages and account settings for identifiable information.

@_date: 2007-03-08 17:40:43
@_author: H D Moore 
@_subject: Warnings on the download page 
Thanks for the feedback! Keep in mind this is the first applet I have ever written :-) Any information about the new API would be appreciated. Do you happen to know what versions it is compatible with? Bizzare that they would explicitly allow non-proxied connections. I used the Datagram Socket was so that I could send requests directly to the DNS server and not have to do any extra processing on the server side. The next version of decloak should be able to avoid Java/Javascript completely by loading up streaming media, PDFs, and so on within IFRAME tags inside the HTML. These media files would reference the magic DNS domain or custom services running on my server. An easy hack would be to stick a fake SMB service on the server and then embed UNC paths into the HTML. The tricky part is implementing enough of CIFS that I could extract a unique identifier from client's request.

@_date: 2007-03-08 19:56:34
@_author: H D Moore 
@_subject: Warnings on the download page 
This wasn't meant to be evasive and does not bypass the enable java setting on my browser (latest firefox + sun-jre-1.6.0). The reason for generating the applet tag on the fly is to enable injection by embedding a

@_date: 2007-03-08 20:33:29
@_author: H D Moore 
@_subject: Warnings on the download page 
Looks like the "Practical Onion Hacking" paper covered many features I was working on, as well as touching on the warez/movie/music leeches and the child pornography traffic. I should have released this back in August when I presented on it the first time :-)
The big differences are:
1) They use iptables to modify and reinject traffic, I use an embedded Ruby interpreter in the Tor software.
2) They perform DNS tracking, but don't actually record or cross-reference the data.
3) They use Flash instead of Java to obtain the real external address of the user.
Similarities include:
1) Web-bug injection via HTML response
2) DNS tracking via wildcard domain
3) Use of JS/Java bridge to get the internal address
Seems like two big items I need to add to decloak are Flash and the shiny no-proxy Java connection mode (which seems to apply to TCP sockets only).

@_date: 2007-03-09 12:45:22
@_author: H D Moore 
@_subject: Warnings on the download page 
This would have to support all sorts of variations for media files:
document.location = something.ext
meta refresh URL=something.ext
iframe src=something.ext
frame src=something.ext
img src=something.ext (some cases)
Seems easier to lock down the browser and prevent any and all media/plugins from executing.

@_date: 2007-03-11 20:17:01
@_author: H D Moore 
@_subject: Talks of hidden services and DNS 
The tricky part will be deciding who is authoritative for the DNS records. If any user can submit a name, what if its already taken? Does it overwrite, or is it first-come, first-serve? If its distributed, then a rogue operator could serve false responses for a target name. If this is something that the tor "core" would operate, it still needs some form of authentication to manage/update/remove/etc.... and authentication seems to be the exact opposite of what tor is supposed to provide.

@_date: 2007-03-12 14:36:05
@_author: H D Moore 
@_subject: Tor + Hushmail? 
Firewall all outbound traffic from your workstation except for that reaching the Tor server. Enable Java and Javascript in your browser. There is a still a possibility of internal address leakage (from the Java applet calling the socket APIs), but your external address should not be visible to hushmail.com. Keep in mind that even after you create an account, you still need to have Java and Javascript enabled to access your email. You might want to pick a different mail provider and just manually PGP and paste your messages into the web form.

@_date: 2007-03-25 11:42:32
@_author: H D Moore 
@_subject: Ultimate solution 
This non-commercial clause prevents it from being "Free" and "Open" as the OSI and FSF define it. Metasploit 3 has a similar license. TorPark is still "free" as in beer, its just not "Free" as in speech. You can grumble all you like about it, but at the end of the day, its still their time and effort going into the project.
Sometimes, a "less free" license is required to keep your developers happy. I wrote up some slides about this (as it relates to security

@_date: 2007-03-25 15:48:15
@_author: H D Moore 
@_subject: Free Software and Torpark (was: Ultimate solution) 
Watered down? C'mon. Do a google search for "free software". At least half of the results refer to software that is "free as in beer" vs "free as in speech". If you want to show the difference between "free" and "Free", capitalize it like everyone else. Just because something isn't "Free" doesn't mean you have to pay for it.
Speaking of freedom, what about a giving a software developer the freedom to prevent commercial abuse? Would you prefer to give them the "Freedom" to stop working on their software because they don't want it ripped off by scumbags?
I argue that anyone trying to redefine the english word "free" to only mean software licensed according to the FSF guidelines deserves to be laughed at.
This is a stupid argument to start with -- ignoring the license, TorPark should be recommended based on the quality of the code and the features of the software. If TorPark LLC does something evil at a later date, stop recommending them.

@_date: 2007-03-26 14:34:37
@_author: H D Moore 
@_subject: Free Software and Torpark (was: Ultimate solution) 
My employer's product has RFC1314 support for sending exploit traffic ;-)

@_date: 2007-03-28 09:10:59
@_author: H D Moore 
@_subject: Please don't recommend Tor Button! 
If they use the decloak portal instead, I can add tests for Gopher and FTP as well:

@_date: 2008-12-14 19:26:43
@_author: H D Moore 
@_subject: Metasploit Decloak Project v2 
I am looking for feedback as well -- right now, the reporting side is pretty weak, but that should improve this evening. Roger pointed me at the torbutton design notes, so I will continue adding coverage/techniques there. This test should work on all browsers regardless of security settings or scripting. No test requires javascript, which should give an accurate view for folks who run noscript/torbutton. My own testing with torbutton shows it to be really solid (only tor exit and tor exit's DNS servers show up).

@_date: 2008-12-14 21:27:33
@_author: H D Moore 
@_subject: Metasploit Decloak Project v2 
Added iTunes (itms://) and made the Office test much more useful. tor-
button asks the user to confirm itms:// URLs before launching at least.

@_date: 2008-12-18 16:50:31
@_author: H D Moore 
@_subject: Decloaking Engine moved... 
The new web site is:  I added the ability for third-party web sites to embed the engine and query the backend for data. This is an easy way to setup your own decloaking page without having to install all over the backend services. The source code for all of the components is still available, but this seemed like an easy way for folks to put the engine to their own uses. Still not sure what the data deletion interval will be, I am leaning towards purging all records over 48 hours old, but need to see what the traffic/usage is like. The Quicktime, iTunes, and Word methods are all improvements over the original version. The iTunes method is a bit intrusive, but has proven to be a reliable and often exposed application.

@_date: 2008-07-24 11:27:36
@_author: H D Moore 
@_subject: Researchers could face legal risks for Tor network snooping 
I would love to see this case go to court and set a precedent, although I hope its the University that is targeted and not the actual researchers.
The CNET article is just FUD though -- yes, the law is fuzzy in this area, but I highly doubt that any federal prosecutor is going to pick this up unless a specific indivual or company claims damages.

@_date: 2008-07-24 11:27:36
@_author: H D Moore 
@_subject: Researchers could face legal risks for Tor network snooping 
I would love to see this case go to court and set a precedent, although I hope its the University that is targeted and not the actual researchers.
The CNET article is just FUD though -- yes, the law is fuzzy in this area, but I highly doubt that any federal prosecutor is going to pick this up unless a specific indivual or company claims damages.

@_date: 2008-05-06 14:04:21
@_author: H D Moore 
@_subject: exit nodes earn money? 
Just inject google ads into all response pages! Folks who run an exit node behind a "bad" ISP are already doing this (whether they know it or not). See the following article:
