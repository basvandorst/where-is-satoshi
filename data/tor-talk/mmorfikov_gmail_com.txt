
@_date: 2016-02-17 13:29:05
@_author: Mikhail Morfikov 
@_subject: [tor-talk] How to configure TorBrowser so it could use a local web 
Hash: SHA512
I have two system services: Tor and Polipo (web proxy). I was able to
configure them, and they work well. I can redirect traffic from my normal
Firefox profile to the proxy, and then to the Tor network. The same with
other kind of traffic, like for example refreshing GPG keys. But I
encountered a problem with configuring the TorBrowser. I know it can work
on its own, and everything can be done automatically, but I just wanted to
remove some unneeded processes, and also make use of the web proxy.
I followed the instructions included in the Browser/start-tor-browser file,
which was to set the TorBrowser in the following way:
# SETTING NAME                            VALUE
# extensions.torbutton.banned_ports       [...],9050,9051
# extensions.torbutton.block_disk         false
# extensions.torbutton.custom.socks_host  127.0.0.1
# extensions.torbutton.custom.socks_port  9050
# extensions.torbutton.inserted_button    true
# extensions.torbutton.launch_warning     false
# extensions.torbutton.loglevel           2
# extensions.torbutton.logmethod          0
# extensions.torbutton.settings_method    custom
# extensions.torbutton.socks_port         9050
# extensions.torbutton.use_privoxy        false
# extensions.torlauncher.control_port      9051
# extensions.torlauncher.loglevel          2
# extensions.torlauncher.logmethod         0
# extensions.torlauncher.prompt_at_startup false
# extensions.torlauncher.start_tor         false
I also exported the the Tor socket password via the file using:
setControlPortPasswd ${TOR_CONTROL_PASSWD:='"some-pass"'}
The settings above stopped the built in Tor service from running. When I
try to browse the internet using TorBrowser, everything seems to work
just fine. I can see on my system monitor (vidalia) that the traffic goes
to the tor network, and the Tor testing page says that I'm using Tor (the
green onion).
When I try to configure the TorBrowser in Preferences > Advanced > Network
HTTP Proxy: 127.0.0.1 8118
SSL Proxy: 127.0.0.1 8118
FTP Proxy: 127.0.0.1 8118
SOCKS HOST: 127.0.0.1 9050
It doesn't work, and the TorBrowser simply returns an error which contains
the "Unable to find the proxy server" message. When I set the same
settings in my normal Firefox profile, I don't have that issue.
The following are the config files for both services:
# egrep -v ^# /etc/tor/torrc | egrep -v ^$
SocksPort 127.0.0.1:9050
Log notice syslog
ControlPort 9051
HashedControlPassword 16:HASHED-PASS
# egrep -v ^# /etc/polipo/config | egrep -v ^$
proxyAddress = "127.0.0.1"
proxyPort = 8118
allowedClients = 127.0.0.1
allowedPorts = 1-65535
proxyName = "localhost"
cacheIsShared = false
socksParentProxy = "localhost:9050"
socksProxyType = socks5
logSyslog = true
logFile = /var/log/polipo/polipo.log
diskCacheRoot = "/var/cache/polipo/"
localDocumentRoot = ""
disableLocalInterface = true
disableConfiguration = true
dnsQueryIPv6 = no
censoredHeaders = from, acc
So the questions is why the TorBrowser can't find the local proxy server?
