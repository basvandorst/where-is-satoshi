
@_date: 2018-08-08 10:59:23
@_author: Need Secure Mail 
@_subject: [tor-talk] HSTS forbids "Add an exception" (also, 
The following is to help searchers who rammed their heads into this
problem, as I did when accessing clearnet version of a rather popular
.onion (LE cert).
Firefox/Tor Browser disallows adding an exception. The "add an exception"
button does not even appear! It gives the error message:
"This site uses HTTP Strict Transport Security (HSTS) to specify that
Tor Browser may only connect to it securely. As a result, it is not
possible to add an exception for this certificate."
Workaround FOR ADVANCED SECURITY GURUS ONLY -- WARNING, DANGER, YOU
CAN BREAK YOUR SECURITY IF YOU DO NOT KNOW WHAT YOU ARE DOING -- create
prefs integer before visiting the broken website:
Instructions given here are intentionally opaque; if you don't know what
that means, don't try it.
Doing this is NOT RECOMMENDED.
I myself would NEVER do this unless either I verified the certificate
fingerprint by out-of-band means, or observed the same fingerprint
through many different random exits.
If you don't understand what this means, please do not try to override
HSTS. You will get ruined by a BadExit. Evil h4x0rs with sslstrip will
steal your identity, dox you on the scary darknets, and put sugar in
your gas tank. Instead of overriding security features, tell the server
admin of the broken website to fix his problem by adding intermediate
certificate to chain in webserver config.
Topic drift observation:
This error made me realize that Tor Browser/Firefox must load at least the
response HTTP headers before displaying the certificate error message. I
did not realize this! I reasonably assumed that it had simply refused to
complete the TLS handshake. No TLS connection, no way to know about HSTS.
Scary. How much does Tor Browser actually load over an *unauthenticated*
connection? Most importantly, I am curious, does it leak the request
URI path (including query string parameters) this way? Or does it do
something like a `HEAD /` to specifically check for HSTS? No request
headers, no response headers, no way to know about HSTS. Spies running
sslstrip may be interested in that.
Sent with ProtonMail Secure Email.

@_date: 2018-08-08 16:22:25
@_author: Need Secure Mail 
@_subject: [tor-talk] Tor-friendly, Bitcoin-friendly paid e-mail 
Grizzled long-time Tor user here. I seek basic, reliable POP/IMAP/SMTP
service with an option to use my own domain (to avoid lock-in with a
provider), from a well-established provider who will not likely disappear
*and* will never block my account for Tor logins, demand selfies with
gov-id, etc. I am willing to pay a reasonable amount, because TANSTAAFL. I
will NOT use credit cards, Paypal, or any such horrible monstrosity.
Here is what I found so far. The following list is not in any way
intended to be comprehensive. I've spent many hours searching the web,
winnowing things down. I invite discussion.
Observed TLSA (DANE) implementation status is listed, due to this being
(unfortunately) the only standardized means to prevent STARTTLS downgrade
When multiple currency-of-account options are offered, I list prices
in the currency most favorable to the user at current exchange rates.
Much as I can, I try to list the effective *actual* cost to the user,
per month, if paid on an annual basis. This may differ from the
advertised price.
I am not affiliated with any of the below-listed companies; I receive
no compensation if you sign up for any of them.
Without further ado, here is my current shortlist:
# - Effective price: €1.01/month (€1 + 1% Bitpay fee; prepay annually)
- By: Heinlein Support GmbH
- Jurisdiction: Germany (EU; Fourteen Eyes)
- .onion site (POP3/IMAP/SMTP/XMPP; no web): kqiafglit242fygz.onion
- Working DNSSEC/TLSA: I found this through the Tor trac,[0] which is probably the very best
advertising for them. Everything looks pretty good from a technical
perspective. Price is reasonable.
I like how the signup form asks for a name, but explicitly says it does
not need to be your "real name".
Though I have not yet tested this, it looks like you can attach one domain
to the account for each alias; and the €1/month account provides three
aliases. This could make a cost-effective home/work identity solution
for an individual with a limited budget.
A 30-day trial account limits features, but allows POP/IMAP/SMTP access.
I will give this a spin, and pay them money if it works out.
I do wish that they were not in a Fourteen Eyes country.
[0] # - Effective price: About $3.25/month (prepay annually)
- By: ContactOffice Group sa
- Jurisdiction: Belgium (EU; Fourteen Eyes)
- .onion site: Promised, but not actually existing.[1]
- No DNSSEC, thus no TLSA: Before I found mailbox.org, I signed up for this and almost paid for an
account. For the most inexpensive account, I was offered payment options
of €2.50/month or $2.77/month, both paid annually. That exchange rate
is moderately favorable to USD; so I selected $2.77/month.
*Then*, I saw the amount of Bitcoin they demanded: 0.005142968 BTC,
allegedly for $33.30. That works out to a Bitcoin exchange rate of
$6474.86/BTC. At that exact moment, my desktop ticker was showing an
average exchange rate of $7591.24/BTC. Thus, they offered me a HORRIBLE
exchange rate, almost 15% under market! This makes the effective account
price $39.04/year, or $3.25/month.
How many people use a desktop calculator to check the exchange rate? Well,
you need to wake up pretty early to fool me.
Mailfence's free accounts do not offer POP/IMAP/SMTP access; so I am
unable to fully test their services without paying. I prefer Mailbox's
arrangement with a time-limited trial account. I am totally uninterested
in webmail; how am I supposed to test a service without POP/IMAP/SMTP
[1] Text: "Note: we also plan to release an onion domain for Mailfence
in the future."  Comments: "Yes, we do plan to provide a Tor
hidden service. However, this currently is not in our priority
list." (2017-02-27)
# - Effective price: $4.00/month (prepaid annually)
- By: Proton Technologies, SA
- Jurisdiction: Switzerland
- Standard PGP, standard algorithms: No homebrew crypto!
- Can communicate with GPG users.
- POP/IMAP/SMTP access requires "Bridge" proxy software.
- .onion site (mail login only): - DNSSEC, but no DANE/TLSA: Ok, everybody knows Protonmail. As a longtime PGP/GPG user, I love
Protonmail 3.14 because I can direct n00bs to it as a user-friendly
PGP mail solution[2] which Just Works. However, it does not meet *my*
needs. I need my local GPG. I need a dropbox which can be accessed
through POP/IMAP and polled from my crontab, with sending via SMTP. No
web browsers, no "Bridge".
Also: The price is reasonable for the full-featured service they offer;
however, it is way too high for the services I myself need.
If Protonmail offered a no-frills POP box on their Swiss servers for
$2/month, or even $3/month for a Swiss price premium, I would jump for
that in a heartbeat.
**PSA: Non-technical people, PLEASE sign up for Protonmail and STOP
SENDING UNENCRYPTED PERSONAL COMMUNICATIONS.** Seriously. Die-hard Gmail
fans I unsuccessfully badgered about this for years have fallen in love
with Protonmail. It is that easy.
[2] "Introducing Address Verification and Full PGP Support" (2018-07-25)
# Hushmail (beneath linking)
If you compromise your allegedly encrypted mail service even once, *ever*,
even for the account of an alleged heinous criminal, then I will not even
look at you. That just shows all your fancy software is so much security
theater -- a waste of CPU cycles. AVOID.
Mentioned only because a disturbing number of sites are still linking to
this as "private e-mail". No, thanks. I would rather use Gmail and have my
privacy raped openly, without illusions.
[3] Many sites/articles, example: "Encrypted E-Mail Company Hushmail
Spills to Feds" (2007-11-07)
# - Effective price: About $3/month (prepaid annually), including a stamp
- By: Runbox Solutions AS - Jurisdiction: Norway (EU; Nine Eyes)
- No Bitcoin payments (they do accept cash in the mail)
- No .onion site
- No DNSSEC, thus no TLSA: Mentioned because I have experience with them. Some good, some bad.
According to their support "Using Tor is no problem at all"
(2017-03-01). User report: I never had any problems with Torified logins.
They do have very good support.
# - Price: High
- Jurisdiction: Iceland
- Apparently custom crypto protocol (?)
- Apparently no POP/IMAP/SMTP
- No DNSSEC, thus no TLSA: Mentioned because Iceland. Does anybody know a reliable, well-established
Icelandic company offering no-frills POP boxes for €1/month? I have
# (lots of results for search query "swiss e-mail")
- Price: High
- Jurisdiction: Switzerland (allegedly)
- Other characteristics: ???
I stopped looking when I saw the price. I am willing to pay for e-mail;
but my needs are very basic, and I do not want to be ripped off for a
simple POP box. I listed this just to demonstrate a point: I searched
for Swiss e-mail (to get outside E.U./Fourteen Eyes territories), and
found a bunch of sites offering basic e-mail for $10-20/month. WTF? I
know Switzerland is expensive; but it is not 10x as expensive as Germany!
Any good ones I missed? Please tell me, before I commit to something!
Sent with ProtonMail Secure Email.

@_date: 2018-08-08 16:27:33
@_author: Need Secure Mail 
@_subject: [tor-talk] HSTS forbids "Add an exception" (also, 
Thanks, I was already quite familiar with the RFC. I know its rationale.
But it is an absolute rule that *I* get the final word on what my machine
does. That is why I run open-source software, after all. I understand that
most users essentially must be protected from their own bad decisions when
faced with clickthrough warnings. I have read the pertinent research. It's
fine that the easy-clickthrough GUI button is removed by HSTS. However,
if *I* desire to "completely defeat the purpose of HSTS", then I shall
do so, and my user-agent shall obey me. I understand exactly how HSTS
works, and I know the implications of overriding it.
Although I did not check the browser's preload list, I have observed
this on a relatively obscure domain very unlikely to be on it...
...as to which I had never yet successfully made a TLS connection in
that temporary VM, with a fresh Tor Browser instance which had never
before visited *any* sites...
...and thus of course, could not save anything from previous loads of the
site. My whole browsing setup is amnesiac. I literally use a new VM with
"new" Tor Browser installation for each and every browsing session. No
cached STS value!
Key phrase: "for some definitions of prevent".
Inductive reasoning: For a site not in the STS preload list and never
before visited, the only means for the user-agent to know about STS is
to receive an HTTP response header. The only means to receive an HTTP
response header, is to send HTTP request headers. Assume that the browser
does not make an HTTP request. How does it know that the site uses STS?
The HTTP request headers themselves may be useful to spies. Without the
request headers, a network evesdropper only knows the hostname of the
request (via SNI, RFC 6066). With the request headers:
0. The request path informs the evesdropper about which news articles
I am reading on  which people I communicate with on
 etc.
1. Query string parameters, if any, are exposed. On many sites, this can
be a severe privacy problem. On some (badly-designed) sites, it can also
be a security issue.
2. Some browser fingerprint information is exposed. This is a lesser issue
with Tor Browser requests from a Tor exit; any tcp/443 traffic from a Tor
exit can be presumed Tor Browser unless demonstrated otherwise. However,
the principle with TLS should be: Do not expose anything on the network
which is not exposed by TLS itself (or lower network layers).
The most sensitive information is the request path. If the user-agent
wishes to ascertain HSTS status upon a certificate validation error, it
could perform a fake `HEAD /` request as I suggested upthread; indeed,
it is only means of receiving an HSTS response header without potentially
leaking the request path to an sslstripper. I do not know if Tor Browser
already does this, and have not checked too carefully. I did glance
back through RFC 6797's advice to implementors, and saw nothing about
this issue.
No, I am referring only to HSTS. I have read both RFCs. I would not
confuse them.
I would *not* override a HPKP pin, unless I saw it very well-documented
that a site had committed "pin-suicide". My interest in this thread
is overriding HSTS, due to the issue raised by nusenu on the parent
thread. There exist sites with valid certificates, which are inaccessible
in Tor Browser due to omission of a needed intermediary cert in the cert
chain set in the webserver configuration. If the site uses HSTS, there is
no supported means to override this -- only the semi-undocumented trick
I disclosed upthread.
P.S., my apologies to the list that Protonmail stripped all In-Reply-To
and References headers when I changed the subject line. Aargh. I need
to get back to my normal mail client... See also:
Sent with ProtonMail Secure Email.
