
@_date: 2015-11-29 18:35:12
@_author: Amin s 
@_subject: [tor-talk] TOR and Obfsproxy packet size 
I have some questions about TOR and Obfsproxy packet size.
   1. TOR cell size is 512 bytes but most TOR packets have size of 586
   bytes [1].
My question is that why there is such difference in size (74 bytes
   1. In my own testing, instead of TOR packets with size of 586 bytes,
   there are packets with size of 543 bytes in TOR traffic and packets with
   size of 565 bytes in Obfsproxy traffic.
My question here is that why doesn't TOR or Obfsproxy generate 586 bytes?
the size that reported in lots of papers like link [1] ?
   1. In my own testing on TOR traffic, from 9939 packets that were sent
   from client to server, there were 2648 packets with different sizes than
   543, like 126,1086,1629,4101,612 and so on.
If TOR cell size is fixed, then why are there packets with different sizes
than 543? (why don't all of the packets have the same 543 bytes in size?)
Relating to above question, there are lots of packets with size of 1460
bytes in backward direction (from server to client). So what happens to the
fixed cell size?
[1]

@_date: 2015-11-30 15:00:35
@_author: Amin s 
@_subject: [tor-talk] TOR and Obfsproxy packet size 
Hi Philipp,
Tor cells;
How many bytes does TLS take?
if we say TOR cell is 512 bytes, then 512 + 20 (TCP) + 20 (IP) = 552 and
586 - 552 = 34 bytes for TLS. is it correct?
I used Obfs3.
I am using wireshark . i get the same packet size when using tcpdump. In
wireshark there are 5 layers. Application,Transport,IP,Ethernet and
physical layer. (in regular TOR) for the application layer it shows 543
bytes (probably TLS is included).
Overall packet size (including all layers) is 597 bytes [543 + 20 (TCP) +
20 (IP) + 14 (Ethernet) = 597 bytes].
According to what you said at first, if 586 bytes is for (cell + TLS + TCP
+ IP), then in my case
(cell + TLS + TCP + IP) equals to 543 + 20 + 20 = 583 bytes. There is 3
bytes difference here. Why is it so?
How about Obfs3 traffic that wireshark (tcpdump) shows 565 bytes for the
application layer? [565 + 20 (TCP) + 20 (IP) = 605 bytes]
Do you know when TOR uses static-length cell and when variable-length cell?
