
@_date: 2004-08-11 19:30:51
@_author: Roger Dingledine 
@_subject: (FWD) private IP network ranges 
[I'm forwarding this because Ben isn't subscribed to the list.
Ben: asking the Tor server at the other side of the circuit to be able
to get to your internal IP space doesn't make sense -- it couldn't
work. It also happens to be the case that no exit nodes allow exiting
to 192.168/16 currently, so you're probably getting a warning in your
logs explaining that no suitable exit server could be found.
In any case, I think the right answer for you is that many applications
(such as mozilla) have an "except" section in their proxies, and you
can put in the dns names that shouldn't go to your proxy. Does that help?

@_date: 2004-08-18 20:02:49
@_author: Roger Dingledine 
@_subject: (FWD) Compiling Tor on Windows? 
[Hi Christian -- please let us know if the new 0.0.8rc1 is any better
for this. -RD]

@_date: 2004-08-18 20:37:16
@_author: Roger Dingledine 
@_subject: (FWD) Re: (FWD) Compiling Tor on Windows?  Reply-To: 
[Christian -- Please post from the address that is subscribed to the
[Nick -- can you look into this?]

@_date: 2004-12-08 06:58:14
@_author: Roger Dingledine 
@_subject: (FWD) Re: BitTorrent - can it be blocked? 
[Forwarding to the list since Anna sent it from an address that isn't
subscribed. -RD]
As to the legal questions, our lawyers are drafting a response to this
issue. In the meantime, I suggest you do whatever is necessary to stay
on good terms with your ISP (switching to middleman node, taking the node
down temporarily, etc if they want you to), since that's always useful.

@_date: 2004-12-08 07:57:12
@_author: Roger Dingledine 
@_subject: (FWD) Re: BitTorrent - can it be blocked? 
[Forwarding because Mr. Remailer is not subscribed to the list. -RD]
Paul, can you think about changing your Tor howto so it emphasizes
that we don't want this much bittorrent traffic going over Tor right
now? Anonymous trackers seem fine in terms of load, but arbitrary numbers
of people free-loading off our bandwidth isn't something we're a big
enough network to handle yet.

@_date: 2004-12-11 11:26:49
@_author: Roger Dingledine 
@_subject: Firewall? 
Also, you should permit outgoing to 80, 443, and 9001-9033, even if you
set your exit policy to reject them, since your server will want to use
those to connect to directory servers and other ORs.
You can modify it -- check out the 'ExitPolicy' section of
But I should ask: why do you not want to open "too many"? I can understand
blocking incoming connections, if you have users who don't understand
security and keep running programs in vulnerable configurations. But
what are you protecting against by blocking outgoing connections?

@_date: 2004-12-11 13:24:55
@_author: Roger Dingledine 
@_subject: Tor 0.0.9 is imminent 
Hi folks,
If you've been stunned by the frequency of new release candidates and
you've been waiting for The Actual Release Candidate, 0.0.9rc7 is it.
If you have a free moment this weekend, please pull it down and try to
break it. If no major problems come up, we'll be releasing 0.0.9 in a
few days.

@_date: 2004-12-12 03:45:25
@_author: Roger Dingledine 
@_subject: Running in middleman mode 
Yes, more middleman nodes is really useful too, because it spreads out
the load of the network more, and because it provides more *entry*
points into the network. (One of the best ways to beat Tor is to be
watching both the entry node and the exit node that a user picks. More
nodes means more places people have to watch.)
Yes, if you have a firewall, you need to set it to enable incoming
connections on those ports. You also need to allow outgoing connections
to the directory servers and to the other ORs (typically these run on
ports 80, 443, and 9001-9033).
I've just updated so it has more useful details.
Let me know if you still have any questions.

@_date: 2004-12-17 03:29:27
@_author: Roger Dingledine 
@_subject: A map of the current Tor network 
(A screenshot from the Tor GUI controller that Aphex is working on.)
This shows that we have a ways to go before we are truly decentralized. :)

@_date: 2004-12-02 18:42:01
@_author: Roger Dingledine 
@_subject: Error in the Java Standard Library while using Tor sock proxy 
According to the url you posted, this message means you're using socks5
in this case. But in any case, it "ought" to be working. We send a 1 in
byte 3 of the reply, which means IPv4. In
it defines IPv4 to be 1.
Which version of Tor are you using? Do you have this problem with both
0.0.8.1 and 0.0.9rc5?
Are you certain that the java you're using is the source you pointed to?

@_date: 2004-12-17 23:56:46
@_author: Roger Dingledine 
@_subject: ExitPolicy: ports 1024-65535 needed? 
Exit policies work at the TCP level. They let your server decide which
addresses and ports for outgoing connections will be allowed.
So if you accept *:80 and reject the rest, then outgoing connections
to anywhere on port 80 will be permitted, and outgoing connections on
other ports will be denied.
Exit policies don't think on a per-packet level. They think on a per
TCP stream level. Indeed, Tor also works on a per TCP stream level. We
don't transport packets, we transport streams.
Does that make more sense? You could switch to the exit policy you
indicated if you want, and it would work fine; but of course, we prefer
to have more nodes that allow more flexible exiting.

@_date: 2004-12-18 00:56:27
@_author: Roger Dingledine 
@_subject: (FWD) Re: BitTorrent - can it be blocked? 
Since this has the potential for turning into a bike shed problem
( let me put out a
few facts to start us out.
Tor already has a few congestion control and rate
limiting features built-in -- see sections 4.5 and 4.6 of
 . But
they're mainly designed for fairness and for letting the server operator
protect himself, rather than overall abuse control.
You can configure Tor to rate-limit overall incoming bytes/second. But
setting this too low provides crummy service to all users, not just the
ones abusing the network.
We could limit the number of TLS connections from a given client (that
is, IP), but a) some IPs NAT for a whole lot of clients -- AOL is the
canonical example of this; and b) it wouldn't help much because a single
TLS connection is enough to multiplex many circuits and many streams. We
could limit the number of circuits a given TLS connection can have open
at once; but I don't think this is being a problem currently.
Because "extend" relay cells look just like "data" relay cells when
they're encrypted, there's no way for entry nodes to limit the number
of streams that are opened over a given circuit. (We could fix this if
we needed to, but it's not clear to me that it would help.)
We could rate limit the bytes going over each connection or each
circuit. But this wouldn't foil smart programs like Bittorrent that open
many connections over time. Even if each entry node limited each client
to say 10kB/s, clients could use N entry nodes in parallel (for example
by cranking up min_peers) to get fine overall speeds.
We could try to build a coordinated black-list by communicating among
entry nodes about users that have many connections open or are using
many bytes. But it seems like an incredibly hard research problem to do
that without letting an adversary start to enumerate IPs of clients.
We could let the allowed bandwidth for a circuit decay over time or
after many bytes, to provide improved service to people who don't talk so
much. But again, Bittorrent is smarter than that -- it will prefer working
circuits to non-working circuits and simply migrate to the new ones.
We could provide better quality of service to cells on circuits that don't
talk much, by putting such cells to the front of the line. But this is
hard to do with our current system because once you've crypted a cell
and put it on the out buffer, you can't easily uncrypt it and change
the order of things. Also, if you're pushing a lot of bytes already,
and the link is pretty much full, then even moving cells to the front
of the buffer won't solve the fact that we have to wait for the previous
flushes to finish first.
We can't block the default bittorrent port in exit policies, because
there's no such port. (Blocking 6969 isn't what we want, because
connections to the trackers are not the ones causing pain.)
We can't integrate an IDS on exit nodes and snipe outgoing connections
with certain signatures, because a) we don't want the added complexity
of an IDS and maintaining signatures and so on inside Tor, a') such
things have historically been bloated and don't work so well, and b)
we don't actually want to be building that tool, we want to be building
a content-neutral anonymous transport system.
Ok, so that's a big list of what we can't do to help. What _can_ we do?
Stayed tuned for a follow-up post. :)

@_date: 2004-12-18 01:13:52
@_author: Roger Dingledine 
@_subject: It is time to expand the Tor network 
Hi All,
I've been pondering how to deal with the recent Bittorrent load. Here's
one answer.
First, let's consider what Tor is for. Tor is designed to improve
privacy for certain activities. These activities include pulling down
or publishing news web pages; instant messaging; talking on irc. They
don't include entire protocols (like http), or activities like pulling
down huge files. (We wouldn't mind providing that ability, but forced
to choose, we prefer protecting the former activities.)
Because Tor clients now pick nodes for their path proportional to the
advertised capacity of each node, we already do basic load balancing. This
means we can accept nodes with a capacity of only 15kB or 20kB, and
they'll be used sometimes but rarely, which is exactly what we want. So
far we've been preferring not to take these nodes, because we wanted to
give clients lots of throughput, and because these nodes tend to come
with higher latency, less reliable uptimes, and crummier networks --
degrading overall user experience for every activity.
If we expand the network to include them, though, then we'll end up
with a lot more nodes to choose from (which also happens to be good for
anonymity). The chances increase that a given connection that BT tries
will not have much throughput available -- which means that if the BT
folks stick around, as we add more thin pipes, the chances increase
that a given connection will be overloaded and thus provide crummy
service. Oh well.
A rephrase of my plan could be "we will make Tor so slow that the file
sharers will go away." But remember that if this keeps up, all our fat
connections will appear like thin ones anyway, so this may not be as
radical a change as it sounds.
Alas, as we go in this direction, we will hear fewer shocked statements
from former JAP and Anonymizer users wondering how Tor can be so fast.
But we've been adding the infrastructure to handle this, and now is
the time. I've changed the documentation for setting up servers --
 -- to reflect this
change. If you're on cable or dsl and have been waiting to run a node,
now's the time. :)

@_date: 2004-12-20 18:15:20
@_author: Roger Dingledine 
@_subject: Debian Install Broken 
I'm not a Debian person, but I'll take a stab at this.
First, it may already be running. Try "ps auxw|grep tor" to find out.
In any case, that's not how you're supposed to be running it. The Debian
Tor package creates a separate user for Tor called debian-tor. The deb has
a script for starting Tor like every other daemon. You should be using it.
Try something like "/etc/rc.d/tor start"

@_date: 2004-12-21 02:23:26
@_author: Roger Dingledine 
@_subject: Tor has a public IRC channel now 
Because we've had an increasing number of people trying to find us to
talk to us, I've set up a public IRC channel at  on irc.oftc.net.
It's designed for users and server operators, and the developers will
also aim to be there sometimes.
You all should feel free to come hang out, answer questions, ask
questions, work together on supporting applications or documentation, etc.

@_date: 2004-12-23 16:15:47
@_author: Roger Dingledine 
@_subject: Tor running on mipsel 
How much available ram do these things have while running? I worry that
Tor's approach to buffers will cause it to constantly be hitting the
ceiling. I would guess this is especially problematic for Tor servers.
If you have any suggestions to make our build process more pleasant
for cross-compiling, we're very happy to take patches.

@_date: 2004-12-23 23:00:06
@_author: Roger Dingledine 
@_subject: 503's on directories (was Re: Tor running on mipsel) 
Just to be clear, we currently believe that only the authoritative
dirservers needed to be patched, and they have been. So there's no
need for users or servers to upgrade because of this. (There are other
bugs that we're working on that you may want to upgrade for, but that's
another story for another time. :)

@_date: 2004-12-24 04:48:25
@_author: Roger Dingledine 
@_subject: Bug/warning message.. 
Thanks. I tracked down one such instance and just fixed it in cvs, so
this will be at least partly fixed in 0.0.9.2 (which will come out in
a week or so, unless anything critical shows up). You'll have to let us
know then if the warns continue. :)
(If you want to update your server to cvs to find out right away, you're
also welcome to do that.)

@_date: 2004-11-21 07:29:54
@_author: Roger Dingledine 
@_subject: 0.0.9.pre6 --list-fingerprint(key generation) for server fails 
Yes, CVS had a bug like this that we introduced a few days ago, and
(I think) fixed last night. You should expect the CVS version of Tor to
catch fire.
It sounds like --list-fingerprint will do what you want.

@_date: 2004-11-26 14:30:59
@_author: Roger Dingledine 
@_subject: tor 0.0.9rc2-win32 
Ok. I've reverted the website to point to the pre6 installer.
Nick will return sometime this weekend and he can take a look at
things then.

@_date: 2004-11-20 03:10:15
@_author: Roger Dingledine 
@_subject: 0.0.9.pre6 --list-fingerprint(key generation) for server fails 
The --list-fingerprint option is only there to output a hash of your
identity key and then exit. Since clients don't have fixed identity
keys, they no longer output one.
But if you want actually run tor, you shouldn't use --list-fingerprint
as an option. And all the keys and so on will be written to your
DataDirectory just like normal whether or not you use --list-fingerprint.
Ah, yes, it takes a second or so to generate keys the first time it
starts, on some processors.
So it is working now? Please consider registering your key fingerprint,
per the instructions on

@_date: 2004-10-11 18:54:34
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
Great, thanks for the bug report. I've fixed this one too (I think).
We'll aim to get a pre3-cvs exe out in the next few days, so we can
make sure these bugs aren't still around.
Keep the bug reports coming, folks!

@_date: 2004-10-11 19:58:52
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
Great. I think it would be worthwhile to write up a how-to for how to
set up your tracker behind a hidden service. I bet we could handle some
(as many as several thousand) of those with our current network. Teaching
Azureus about hidden services, and to do socks4a to talk to Tor, is
also needed there. A button in Azureus to do this would probably also
be useful; and we should figure out how to tell users "you need to
install Tor to use this".
But adding a 'make your download private' button would probably be a bad
move at this point, because it wouldn't work -- after too many people
clicked it, it would work for none of them. So let's hold off on that
for now.
We have some plans for how to speed up initial connection by a factor
of 2 or 3. But it's always going to involve a public key operation and
at least some circuit extension, so it's always going to be fairly slow.
The key to scalability will be getting other people to carry bandwidth,
and learning to handle unpredictable and heterogeneous relays.

@_date: 2004-10-12 04:56:28
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
That one's part of the previous bug. Already fixed in cvs. :)

@_date: 2004-10-03 15:59:29
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
I fixed a bug that sounds like that one, in 0.0.9pre1. I recommend
fetching 0.0.9pre2 and seeing if it still has the problem.
Except, nobody has made any exe's for win32 out of pre2 yet. Nick?
More generally, is there any gdb equivalent for a win32 binary? Does it
make sense for me to ask for a stack trace in these cases? Or are win32
people just sol?

@_date: 2004-10-13 14:31:40
@_author: Roger Dingledine 
@_subject: We need more SILC-enabled relay servers! 
If there are no objections, I could add an "accept *:706" line to the
default exit policy, so most servers would allow this.
Why didn't you guys pick a high-numbered port like normal projects? :)

@_date: 2004-10-14 15:27:25
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
[Forwarding since Hee So isn't subscribed to the list from this address.]
[Yes, 009pre1 and later cache the directory locally, and use that to
start up more reliably. Note that the directory includes more information
than just "the list of ORs" -- e.g. it also includes which ones are up
right now, their exit policies, etc. So having a fresh copy is always
handy. -RD]

@_date: 2004-10-14 16:48:19
@_author: Roger Dingledine 
@_subject: Compiling my own version? 
It's ok license-wise to do this, though you should consider including the
LICENSE file, or otherwise making it known to your users that it's free
software and they too can fetch the source and do what they want with it,
under its license.
It doesn't cause servers to refuse your connections. But it does cause
the *clients* to detect that they're not running a recommended version.
(They download a directory every 10 minutes, and the directory lists
the recommended versions.)
So I'd recommend that you leave the version intact from the code you
derived your binary from. Please try to refrain from making really
dramatic changes, since then it's not "really" that version any more.
And if you find yourself making the same patch for several versions
in a row, please consider sending us the patch so we can put it in the
main tree.

@_date: 2004-10-14 23:45:25
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
Also, note that dirservers will give out just a summary of who's up
right now. See, e.g., So in theory you could fetch a new directory a few times a day, and
fetch an updated running-routers more frequently. We just haven't yet
gotten around to teaching clients that they should automatically do this.

@_date: 2004-10-03 16:32:00
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
Right. Bram and I talked early on about whether we should arrange it so
Tor and BT would work well together like this, and the conclusion was
that we shouldn't. BT is all about efficiency (getting data blocks from
various points directly to you, without a middleman), and Tor in that
respect is all about inefficiency (making sure the data doesn't travel
directly to you). So if you're willing to take the inefficiency hit from
Tor, then BT doesn't buy you much anymore.
The JAP team has implemented the Tor protocol inside their JAP client. It
lets you pick which network (Web mixes or Tor) you use. Their code is
in Java, and is free. I think it's working in the beta releases now,
but I haven't been keeping up with when they're planning to release it.
Yes, but it's going to take a lot of work. The key task is to let more
clients act like servers. But ideally, while we add more servers, we
still want some way of limiting the adversary from signing up lots of
servers and attracting lots of traffic (which would defeat anonymity).
So we're working on ways to scale without giving up much anonymity.

@_date: 2004-10-10 02:09:25
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
Ok, Nick has put a 0.0.9pre2 exe in
Please let me know whether it works. :)

@_date: 2004-10-10 21:18:29
@_author: Roger Dingledine 
@_subject: assert() crasher in circuitlist.c:414 
Thanks for sending the assert line. Below is a patch so you can change
your code and let me know if that fixes it. (Or if you want us to build
a new exe with the patch in it, let me know and we will.)
One question for you, though -- were the [warn] lines above printed with
about the same timestamp, or were there many minutes between them?
Thanks again! All of you should please keep sending me your assert bugs.
diff -u -r1.10 circuitlist.c
--- circuitlist.c       29 Sep 2004 06:52:35 -0000      1.10
+++ circuitlist.c       10 Oct 2004 23:21:38 -0000
 -411,6 +411,7        tor_assert(cp->handshake_state);
       break;
     default:
+      log_fn(LOG_WARN,"Unexpected state %d",cp->state);
       tor_assert(0);
     }
   tor_assert(cp->package_window >= 0);
diff -u -r1.14 circuituse.c
--- circuituse.c        3 Oct 2004 19:39:29 -0000       1.14
+++ circuituse.c        11 Oct 2004 01:07:35 -0000
 -333,6 +333,8    tor_assert(circ && conn);
+  conn->cpath_layer = NULL; /* make sure we don't keep a stale pointer */
   if(conn == circ->p_streams) {
     circ->p_streams = conn->next_stream;
     return;

@_date: 2004-09-25 02:01:12
@_author: Roger Dingledine 
@_subject: browsing hidden servers 
You need to install an http proxy that speaks socks4a. One example is
privoxy. You configure your mozilla to http and https proxy to localhost
8118, then you configure your privoxy to socks4a proxy to localhost 9050.
Let me know if it works. If it still fails, look in your Tor logs to see
if there are any hints.

@_date: 2004-09-25 23:11:29
@_author: Roger Dingledine 
@_subject: browsing hidden servers 
The socat approach is a hack that can allow you to redirect requests to
a single IP. It's useful for things like irc that don't have an easy
socks4a proxy. To web browse with it, you'd need to change socat's
arguments and rerun it every time you wanted to go to a new site.
So, use privoxy. :)

@_date: 2004-09-29 16:26:40
@_author: Roger Dingledine 
@_subject: (FWD) Tor, Socks bind, and BitTorrent 
(Forwarding here to get the discussion archived and public)
It isn't going to be trivial to support Tor in BitTorrent. Bram designed
BT with the intent of making it tricky to anonymize in this way.
Tor doesn't support the SOCKS BIND extensions. You
can read about what Tor's version of SOCKS at
The question you need to answer before proceeding is: which parties are
you trying to protect? I see at least two scenarios:
a) The tracker runs behind a Tor hidden service. That is, people can
access it without being able to learn its location.
This wouldn't be so hard to do, and it wouldn't put that much load on the
Tor network; all users accessing it would need to pass their connections
through Tor (via socks4a).
How do clients interact with the Tracker in BT -- do they connect once
and keep talking periodically, or do they connect every so often, talk
a bit, and disconnect?
In this scenario, the users themselves would still be exposed (to
each other).
b) Each user runs behind a hidden service. That is, all the actual
block-passing traffic goes over Tor. First off, I suspect this will
slow down transfers quite a bit, since the current Tor infrastructure
won't scale to handle that very well. Second, you may need to change
the BT protocol to handle addresses (hostnames) rather than IPs when
describing another user. Plus each user would have to configure her own
hidden service, so you'd probably have to do up an interface for that
if you wanted it to be easy.
I think Tor needs more design and development work before scenario b)
is reasonable. But scenario a) could work right now.

@_date: 2004-09-30 11:42:35
@_author: Roger Dingledine 
@_subject: Funning log entry... 
I've fixed it in cvs, and it'll be in 0.0.9pre1 whenever that comes out.
Thanks for letting us know the log message, Eugene.

@_date: 2005-04-01 12:24:46
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.2-rc is out 
This is the second release candidate for the 0.1.0.x series. It makes
reachability detection work better. (A lot of people upgraded their
servers, but the servers thought they were unreachable so didn't publish
their descriptors -- oops.)
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes on 0.1.0.1-rc:
    - Fixes on reachability detection:
      - Don't check for reachability while hibernating.
      - If ORPort is reachable but DirPort isn't, still publish the
        descriptor, but zero out DirPort until it's found reachable.
      - When building testing circs for ORPort testing, use only
        high-bandwidth nodes, so fewer circuits fail.
      - Complain about unreachable ORPort separately from unreachable
        DirPort, so the user knows what's going on.
      - Make sure we only conclude ORPort reachability if we didn't
        initiate the conn. Otherwise we could falsely conclude that
        we're reachable just because we connected to the guy earlier
        and he used that same pipe to extend to us.
      - Authdirservers shouldn't do ORPort reachability detection,
        since they're in clique mode, so it will be rare to find a
        server not already connected to them.
      - When building testing circuits, always pick middle hops running
        Tor 0.0.9.7, so we avoid the "can't extend to unknown routers"
        bug. (This is a kludge; it will go away when 0.0.9.x becomes
        obsolete.)
      - When we decide we're reachable, actually publish our descriptor
        right then.
    - Fix bug in redirectstream in the controller.
    - Fix the state descriptor strings so logs don't claim edge streams
      are in a different state than they actually are.
    - Use recent libevent features when possible (this only really affects
      win32 and osx right now, because the new libevent with these
      features hasn't been released yet). Add code to suppress spurious
      libevent log msgs.
    - Prevent possible segfault in connection_close_unattached_ap().
    - Fix newlines on torrc in win32.
    - Improve error msgs when tor-resolve fails.
  o Improvements on 0.0.9.x:
    - New experimental script tor/contrib/ExerciseServer.py (needs more
      work) that uses the controller interface to build circuits and
      fetch pages over them. This will help us bootstrap servers that
      have lots of capacity but haven't noticed it yet.
    - New experimental script tor/contrib/PathDemo.py (needs more work)
      that uses the controller interface to let you choose whole paths
      via addresses like
      "...path"
    - When we've connected to an OR and handshaked but didn't like
      the result, we were closing the conn without sending destroy
      cells back for pending circuits. Now send those destroys.

@_date: 2005-04-04 19:42:59
@_author: Roger Dingledine 
@_subject: timeout with tor-resolve 
Hi Martin,
I'm not quite sure what your bug report here is. What behavior did you
expect, and how did the behavior you got differ from that? Is there
something we should fix in the Tor code?

@_date: 2005-04-14 03:20:41
@_author: Roger Dingledine 
@_subject: begginer at Tor 
On Unix, you can send a HUP signal. On Windows nothing like this is
currently supported, but we are getting very close -- the controller
interface lets you ask Tor to act like it just received a signal. So
once somebody writes a Tor controller on Win32, it should have a "reload"
button that sends the HUP signal to Tor.
If you send an INT signal on Unix, this will do what you want (it will
do a controlled shutdown over a period of 30 seconds -- as of 0.1.0.1-rc,
this time is configurable via the ShutdownWaitLength config option).
But as above, you'll need to wait until somebody adds a way for the Win32
controller to send this "please do a controlled shutdown" signal request.
Anybody want to write a sample win32 signal sender? :) You could
start (or not) with the various tor controller python examples in
See

@_date: 2005-04-15 02:32:44
@_author: Roger Dingledine 
@_subject: (FWD) Server on OS/X 
[Forwarding because Eddie still hasn't figured out what address he's
subscribed under. :) Possible answers include "your emac (what's an
emac?) has only 32 megs of ram"; "your emac overheats if you use the cpu
for more than a few minutes at a time"; "hardware problems"; others? -RD]

@_date: 2005-04-04 19:58:12
@_author: Roger Dingledine 
@_subject: Can't start Tor under Debian 
Hm. You're the second person to have this problem. In both cases I'm
suspecting it's user error -- you, or some program you ran, messed with
the directories in a way that made them unsuitable for Tor.
My guess is that typically this is because people install a package
(which wants to start Tor via /etc/.../init.d/tor), and then they run
tor directly from the commandline. So the Tor package has different
plans about which uid was intended to start Tor.
Putting aside for the moment the fact that the user is supposed to do
what we expect them to do, is there a way to make us more tolerant of
what users do? Maybe the first step is to have clearer log messages --
e.g. "if you really want Tor to run as user %s, then please run 'chown
%s.%s %s', as root if necessary."
What other steps could we take?
Is there a way for Tor to notice if it's installed as a package, and
prefer not to be started directly?

@_date: 2005-04-19 09:15:55
@_author: Roger Dingledine 
@_subject: (FWD) New Hidden Service 
[Forwarding because our good friend Nomen is not subscribed to the
list. Remember that the 0.1.0.x Tor releases will work better for
accessing/providing hidden services. -RD]

@_date: 2005-04-21 05:52:06
@_author: Roger Dingledine 
@_subject: performance tuning... 
Actually, I was serious about setting up a spoon2, if you want to try to
get closer to the cpu limit. You would then be passing twice the traffic,
since the load balancing scheme would treat your new server as different
even if it's on the same machine.
In any case, the more the merrier. Your choice. :)

@_date: 2005-04-21 05:54:15
@_author: Roger Dingledine 
@_subject: A warning to proxy writers 
Hi Adam,
This is a nice list. Can you confirm that common browsers will
automatically load a ftp:// image link? If so, we should really
consider how to deal with that. :}

@_date: 2005-04-21 10:36:26
@_author: Roger Dingledine 
@_subject: philosophical issues 
It is already the case that accusers need more proof than "it came
from your computer." As more and more computers on the net are running
vulnerable operating systems, it is becoming almost the norm to tell
somebody "hey, your computer is compromised" rather than to accuse them
of actually doing the activity.
So people already need more evidence, such as finding the bad files on
your computer, before they can believe that you're doing bad things. Tor
doesn't change the situation as much as you might think.
You're right that this depends on laws which may differ from country to
country. If it is the case that operating a Tor server isn't breaking
any laws, then it would seem that no, we are not required to do anything.
We have four broad approaches to combatting the abuse complaints issue:
1) Educate people generally. Explain about the good uses of Tor, and get
people to understand that anonymity has many positive social values. Also
get them to understand that the abuses they're seeing can happen many
other ways, and Tor isn't really introducing new classes of abuse.
2) Educate people specifically. When we find a site like wikipedia
that has decided allowing its users to retain privacy is not worth the
hassle, we need to work with them to help them understand the issues,
design better authentication mechanisms, etc. We've had nice success
with this with Freenode, for example.
3) In cases where we can, we should take technological measures to limit
the abuse potential in Tor. For example, our default exit policy rejects
port 25, which could be used to draw bad attention to Tor servers.
4) We must become a larger network, and become more mainstream. Google
produces plenty of abuse by running Google Groups, but nobody is clamoring
to have them shut it down.
Hope this helps,

@_date: 2005-04-05 03:29:28
@_author: Roger Dingledine 
@_subject: tor v0.1.0.2 rc - Problem connecting to news servers 
Another possibility is that thunderbird doesn't use the http proxy,
or doesn't use it the way we expect, when speaking the nntp protocol.
Privoxy only handles http/https, after all.
Can somebody confirm/dispute this?

@_date: 2005-04-23 10:25:27
@_author: Roger Dingledine 
@_subject: both my servers crashed 
Right, this is a known bug. We're working on it.
If you'd been running 0.1.0.3-rc, you would have seen a slightly
more useful warn message:
Apr 23 01:42:23.735 [warn] tor_tls_get_peer_cert_nickname(): Peer
certificate nickname 'JAP-Client' has illegal characters.
I don't think this is malicious. We just don't handle it as well as we
should. Expect an update out todayish, and hopefully the whole network
won't die in the meantime. ;)
Hm, this is disturbing. My first thought is that this is related to the
insecurity of your Windows and nothing to do with Tor. Do you have any
reason to believe otherwise?

@_date: 2005-04-23 18:15:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.4-rc is out 
This is the fourth release candidate for the 0.1.0.x series. We've fixed
some more stability problems, including a bug that's been taking down
a lot of servers today.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes:
    - If unofficial Tor clients connect and send weird TLS certs, our
      Tor server triggers an assert. Stop asserting, and start handling
      TLS errors better in other situations too.
    - When the controller asks us to tell it about all the debug-level
      logs, it turns out we were generating debug-level logs while
      telling it about them, which turns into a bad loop. Now keep
      track of whether you're sending a debug log to the controller,
      and don't log when you are.
    - Fix the "postdescriptor" feature of the controller interface: on
      non-complete success, only say "done" once.
  o Features:
    - Clients are now willing to load balance over up to 2mB, not 1mB,
      of advertised bandwidth capacity.
    - Add a NoPublish config option, so you can be a server (e.g. for
      testing running Tor servers in other Tor networks) without
      publishing your descriptor to the primary dirservers.

@_date: 2005-04-26 16:10:34
@_author: Roger Dingledine 
@_subject: Bug: Expiring a dns resolve that's still pending. Forgot to cull      it? 
Hi Gene,
Thanks for keeping at this. We don't know what your bug is yet. :)
Has anybody else been experiencing the problems Gene describes?
The 0.1.0.5-rc release (coming out later today) will have more debugging
info. If this bug appears pretty quickly for you, Gene, could you run Tor
at loglevel debug and send us (just us, not the whole list) the output?
That will give us more to go on. But there is still something really
weird going on.

@_date: 2005-04-27 13:15:26
@_author: Roger Dingledine 
@_subject: Bug: Expiring a dns resolve that's still pending. Forgot to cull      it? 
Hi Gene,
It looks like you're collecting a debug-debug log. That is, it contains
no higher-severity log messages. This is not very useful to me. :)
Can you try with a line like
"log debug file debug-log"?
It probably can't hurt to do another cvs update first too.
Also, please try to avoid posting debug logs to the list (or even urls
to them), since they may contain sensitive information, and we don't
want to get in the habit of throwing that around.

@_date: 2005-04-27 19:17:13
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.5-rc is out 
This is the fifth release candidate for the 0.1.0.x series. We've got a
few stability fixes (in particular, libevent 1.0d has a serious crash bug,
so now we incorporate libevent 1.0e), add https authenticator support,
and some performance improvements.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes:
    - Stop trying to print a null pointer if an OR conn fails because
      we didn't like its cert.
  o Features:
    - Switch our internal buffers implementation to use a ring buffer,
      to hopefully improve performance for fast servers a lot.
    - Add HttpsProxyAuthenticator support (basic auth only), based
      on patch from Adam Langley.
    - Bump the default BandwidthRate from 1 MB to 2 MB, to accommodate
      the fast servers that have been joining lately.
    - Give hidden service accesses extra time on the first attempt,
      since 60 seconds is often only barely enough. This might improve
      robustness more.
    - Improve performance for dirservers: stop re-parsing the whole
      directory every time you regenerate it.
    - Add more debugging info to help us find the weird dns freebsd
      pthreads bug; cleaner debug messages to help track future issues.

@_date: 2005-04-28 12:01:09
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.5-rc is out 
Tor doesn't need the reboot; it's the privoxy installer that asks for it.
(The privoxy installer is bundled with the Tor installer.)
I don't run os x, but I imagine if you're getting it to work without the
reboot, then there's no need to reboot. :)
Great. Sorry for the trouble.

@_date: 2005-04-28 16:04:02
@_author: Roger Dingledine 
@_subject: (FWD) NewCircuitPeriod ? 
[Forwarding because this address isn't subscribed to the list.  Answer:
if you're using 0.1.0.x which I assume you are, we've added a new config
option called MaxCircuitDirtiness, which is probably the line you want
rather than the one you quote below. See the man page for details. Can
you point me to places in the docs that are obsolete and need to be
fixed? Thanks. -RD]

@_date: 2005-04-05 15:55:39
@_author: Roger Dingledine 
@_subject: EntryNode / ExitNode Howto 
I should point out that the advice of this poster is potentially very
dangerous. I'm not going to comment on which are "echelon countries",
but notice that the ones he lists have significant control over the
world's major telcos and Internet backbones.
Notice that his traceroute indicates he's in the United States.
summary at Depending on his destinations, and his adversaries, he may be sunk
regardless of which Tor nodes he chooses.
It's a tricky world out there,

@_date: 2005-04-04 15:39:28
@_author: Roger Dingledine 
@_subject: 4/4 CVS Build - Huge Jump in Responsiveness - Just ME? 
I hate to ask this, but are you sure you're using Tor? :) That's the
first thing that comes to mind when people say "wow, cool, Tor is just
as fast as my normal connection."
We have been making some improvements to speed and reliability, but not
that you describe above, I think.
It's also hard to get a consistent feel for performance changes in the
code, since the network itself varies so much in how hosed it is.

@_date: 2005-04-06 13:47:09
@_author: Roger Dingledine 
@_subject: hidden wiki et al. 
"If it works for you and you're happy with it, then great, else wait
several more months and try again" is the current state, and will probably
be the state for the forseeable future. :)
Put this in your /etc/apt/sources.list:
deb      experimental main
and you can get a deb for the latest Tor cvs (0.1.0.2-rc-cvs).
(It's for sid, and happens to work for sarge at the moment, but not
for woody.)
The 0.1.0.x code has significant robustness improvements for hidden
services. So I suggest you try it instead of 0.0.9.x.
You might also try a different hidden service, e.g.
It varies a lot, depending on how hosed that particular service is, and
how hosed the network is.
Hope that helps,

@_date: 2005-04-06 14:09:16
@_author: Roger Dingledine 
@_subject: script to magically restart tor [was: Re: disappearing nodes] 
This sort of thing is trickier than it seems. The Tor directories include
a list of "recommended" versions, and your Tor client/server examines
the directory, compares the list to its own version, and auto shuts down
if it's running a version that we no longer recommend.
This is so we can break compatibility and make obsolete clients go away,
and it's also so we can quickly unrecommend certain versions when we
find a serious security hole (which has happened several times).
But if you run your Tor inside a loop as you describe above, then it
will start, decide to die, start again, ad infinitum.
We still have a few people out there on the Internet running Tor 0.0.6
inside a loop like this; it's why I implemented the DirPolicy config
option for dirservers, so we can reuse to serve directories to certain
people -- they were asking for a new directory every time they restarted,
many times a second.
We currently exit(0) when we're obsolete. I don't believe we exit with
that status code anywhere else, except if you sigint or sigterm tor.
So perhaps scripts like this should check the status code and only
restart if there was a problem? Can somebody volunteer to sort this out
and provide a recommended script we can put in tor/contrib/?

@_date: 2005-04-06 15:37:17
@_author: Roger Dingledine 
@_subject: reconsidering default exit policy 
I used to take the "later, when we're farther along, we'll do foo"
approach, but I find the best way to get farther along is to act like
we already are there. There's no time like the present to live in the
world we want to live in.
I've heard from several Tor operators who are happy to run the default
exit policy -- whatever it is. When I suggest that they configure their
server to be more permissive than the default (e.g. accepting port 119),
they say they'd be happy to, as soon as I make that the default.
So I think if our goal is to have lots of nodes allowing port 80, we can
choose between having it off by default (and only having the people who
explicitly choose to enable it), or having it on by default (and having
everybody who can keep it that way).
On the theory that allowing exits from Tor is not breaking any laws
(see EFF's Tor legal faq), I'm going to go with the exit policy that
Geoff proposed for 0.1.0.x. If we always think defensively, we will
continue to always think defensively.
But, I agree that having a comment in the torrc will be very useful.
So I've added a comment to the ExitPolicy section of the torrc:
 A comma-separated list of exit policies. They're considered first
 to last, and the first match wins. If you want to *replace*
 the default exit policy, end this with either a reject *:* or an
 accept *:*. Otherwise, you're *augmenting* (prepending to) the
 default exit policy. Leave commented to just use the default, which is
 available in the man page or at  Look at  for issues you might encounter if you use the default exit policy.
 accept *:6660-6667,reject *:* # allow irc ports but no more
 accept *:119 # accept nntp as well as default exit policy
 reject *:* # middleman only -- no exits allowed
Does that sound like a good compromise?

@_date: 2005-04-08 03:23:47
@_author: Roger Dingledine 
@_subject: tor server shutdown 
Hi Giorgos,
Give the 0.1.0.x series a try.
See  for how to download the
latest experimental deb.

@_date: 2005-04-08 04:17:59
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.3-rc is out 
This is the third release candidate for the 0.1.0.x series. We've made
some performance improvements, made it tolerate more clock skew, and
fixed a bunch more bugs.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Improvements on 0.1.0.2-rc:
    - Client now retries when streams end early for 'hibernating' or
      'resource limit' reasons, rather than failing them.
    - More automated handling for dirserver operators:
      - Automatically approve nodes running 0.1.0.2-rc or later,
        now that the the reachability detection stuff is working.
      - Now we allow two unverified servers with the same nickname
        but different keys. But if a nickname is verified, only that
        nickname+key are allowed.
      - If you're an authdirserver connecting to an address:port,
        and it's not the OR you were expecting, forget about that
        descriptor. If he *was* the one you were expecting, then forget
        about all other descriptors for that address:port.
      - Allow servers to publish descriptors from 12 hours in the future.
        Corollary: only whine about clock skew from the dirserver if
        he's a trusted dirserver (since now even verified servers could
        have quite wrong clocks).
    - Adjust maximum skew and age for rendezvous descriptors: let skew
      be 48 hours rather than 90 minutes.
    - Efficiency improvements:
      - Keep a big splay tree of (circid,orconn)->circuit mappings to make
        it much faster to look up a circuit for each relay cell.
      - Remove most calls to assert_all_pending_dns_resolves_ok(),
        since they're eating our cpu on exit nodes.
      - Stop wasting time doing a case insensitive comparison for every
        dns name every time we do any lookup. Canonicalize the names to
        lowercase and be done with it.
    - Start sending 'truncated' cells back rather than destroy cells,
      if the circuit closes in front of you. This means we won't have
      to abandon partially built circuits.
    - Only warn once per nickname from add_nickname_list_to_smartlist
      per failure, so an entrynode or exitnode choice that's down won't
      yell so much.
    - Put a note in the torrc about abuse potential with the default
      exit policy.
    - Revise control spec and implementation to allow all log messages to
      be sent to controller with their severities intact (suggested by
      Matt Edman). Update TorControl to handle new log event types.
    - Provide better explanation messages when controller's POSTDESCRIPTOR
      fails.
    - Stop putting nodename in the Platform string in server descriptors.
      It doesn't actually help, and it is confusing/upsetting some people.
  o Bugfixes on 0.1.0.2-rc:
    - We were printing the host mask wrong in exit policies in server
      descriptors. This isn't a critical bug though, since we were still
      obeying the exit policy internally.
    - Fix Tor when compiled with libevent but without pthreads: move
      connection_unregister() from _connection_free() to
      connection_free().
    - Fix an assert trigger (already fixed in 0.0.9.x): when we have
      the rare mysterious case of accepting a conn on 0.0.0.0:0, then
      when we look through the connection array, we'll find any of the
      cpu/dnsworkers. This is no good.
  o Bugfixes on 0.0.9.x:
    - Fix possible bug on threading platforms (e.g. win32) which was
      leaking a file descriptor whenever a cpuworker or dnsworker died.
    - When using preferred entry or exit nodes, ignore whether the
      circuit wants uptime or capacity. They asked for the nodes, they
      get the nodes.
    - chdir() to your datadirectory at the *end* of the daemonize process,
      not the beginning. This was a problem because the first time you
      run tor, if your datadir isn't there, and you have runasdaemon set
      to 1, it will try to chdir to it before it tries to create it. Oops.
    - Handle changed router status correctly when dirserver reloads
      fingerprint file. We used to be dropping all unverified descriptors
      right then. The bug was hidden because we would immediately
      fetch a directory from another dirserver, which would include the
      descriptors we just dropped.
    - When we're connecting to an OR and he's got a different nickname/key
      than we were expecting, only complain loudly if we're an OP or a
      dirserver. Complaining loudly to the OR admins just confuses them.
    - Tie MAX_DIR_SIZE to MAX_BUF_SIZE, so now directory sizes won't get
      artificially capped at 500kB.

@_date: 2005-04-04 16:42:00
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.1-rc is out 
Well, there are a number of problems. One of the biggest is that if the
adversary owns a few Tor servers, then over time as the hidden service
makes rendezvous circuits, the adversary's server is likely to end up
as the first hop on the path. What makes it especially bad is that the
adversary can *induce* rendezvous circuits by accessing the hidden service
as normal. If the hidden service is not a Tor server, then it's quickly
clear from timing that the guy who just launched the circuit is probably
the operator of the hidden service. And if he is a Tor server, then basic
predecessor attacks (
 probably work well.
I'm wary of doing this, because I fear oscillation. By the time clients
get ahold of server descriptors, many dozens of minutes have typically
passed. So anything that relies on being quicker than other people about
taking advantage of inefficiencies is not going to work so well.
No, we don't try to do any sanity checking yet. The first step is to get
things robust enough in the presence of friendly nodes. Lying nodes is
much harder.
It's not tunable. Should it be?
I picked 30 seconds because that's the default timeout for clients. So
trying longer than that probably won't help because the client will have
given up on this particular rendezvous.
The timeout probably does have some effect on security, but probably not
a big one, compared e.g. to the attack I describe above.

@_date: 2005-04-12 17:56:07
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.3-rc is out 
Hi Michael,
Thanks. I think I fixed it. Let me know if not. :)

@_date: 2005-04-12 18:23:29
@_author: Roger Dingledine 
@_subject: performance tuning... 
From the tor-spec.txt (documenting the descriptor line):
   "bandwidth" bandwidth-avg bandwidth-burst bandwidth-observed
      Estimated bandwidth for this router, in bytes per second.  The
      "average" bandwidth is the volume per second that the OR is willing
      to sustain over long periods; the "burst" bandwidth is the volume
      that the OR is willing to sustain in very short intervals.  The
      "observed" value is an estimate of the capacity this server can
      handle.  The server remembers the max bandwidth sustained output
      over any ten second period in the past day, and another sustained
      input.  The "observed" value is the lesser of these two numbers.
Check out
for a bit more info.
Let us know what you find. The 0.1.0.3-rc release has some more
cpu improvements, but the main pain comes from crypto, and that is
proportional to the number of clients who are asking you to handle a
circuit for them. In any case, you won't be filling up all 100Mb yet --
see the lower graph of Also check out

@_date: 2005-04-04 17:29:10
@_author: Roger Dingledine 
@_subject: 4/4 CVS Build - Huge Jump in Responsiveness - Just ME? 
Hi Gene,
This is an interesting bug. Has anybody else been seeing it?
I'm not sure what it is, yet. It looks like it's happening pretty
often, though? Did you get this warn message previously, or is today
the first day?
One possibility is that it could be pthread bugs on netbsd. Could you
comment out the " HAVE_PTHREAD_CREATE 1" line in orconfig.h,
recompile, and see whether it continues to happen?

@_date: 2005-04-14 02:55:49
@_author: Roger Dingledine 
@_subject: performance tuning... 
No, I think the limit you're running into is that there isn't much more
traffic that needs to be carried.
Part of this is because clients load-balance their circuits over the
various servers based on advertised bandwidth, but if a server claims
to have more than 800 kB (as of 0.0.9.3, or 1000 kB as of 0.0.9.4),
then it caps it at that level. I've just changed cvs so 0.1.0.4-rc and
later will believe you if you claim as much as 2000 kB, so this means
high bandwidth servers will be able to attract more use. (The tradeoff
is that I don't want somebody to advertise an incredibly huge bandwidth
and attract most of the circuits -- so I'm slowly raising the cap as
the overall network capacity grows.)
Well, you could always run spoon2 on the same machine. :)
(If you do, please set the MyFamily torrc directive.)

@_date: 2005-08-16 13:25:50
@_author: Roger Dingledine 
@_subject: Gentoo's response on them blocking access to their forums via Tor 
Hi Gustavo,
That's great news. Let us know if you need any help. I look forward to
the gentoo-newsletter that explains that things have been fixed. :)

@_date: 2005-08-04 20:05:52
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.4-alpha is out: critical security update! 
This is the fourth development snapshot for the 0.1.1.x series. It fixes
a CRITICAL bug in the security of our crypto handshakes. All clients
should upgrade IMMEDIATELY.
(We mean it. Really. Also, note that with this release we are abandoning
support for the old Tor 0.0.9.x tree. You should stop using it.)
  o Bugfixes included in 0.1.0.13.
  o Features:
    - Improve tor_gettimeofday() granularity on windows.
    - Make clients regenerate their keys when their IP address changes.
    - Implement some more GETINFO goodness: expose helper nodes, config
      options, getinfo keys.

@_date: 2005-08-19 03:12:55
@_author: Roger Dingledine 
@_subject: So TOR is NOT  really anonoymous!? 
In short, yes.
Anonymity is hard. If anybody else does the java thing right, feel free
to let us know. As far as I understand it, it's a tradeoff, and the
other option is having you write mail with a subject "So Tor doesn't
really work?!"
See  and
the rest of that thread.
See also

@_date: 2005-08-19 20:28:27
@_author: Roger Dingledine 
@_subject: Tor GUI Competition announcement 
Here's the EFF press release. Please forward wherever appropriate,
and please consider helping out! :) (You know you want the T-shirt...)
EFF Wants You to Make Online Anonymity Easy
Announcing the Tor Graphical User Interface Competition
Now information designers can make it easier for people to protect
themselves online. The developers of Tor, a software tool for
communicating anonymously online, today announced the Tor graphical
user interface (GUI) competition. Entrants will create a usable and
aesthetically pleasing GUI for the Tor program, which will allow people
to install and configure Tor easily and monitor the software's performance
while it's running.
"Security depends on knowing what's working correctly and what isn't,"
said Roger Dingledine, Tor project leader. "A good interface tells users
what's going on so they can make smart decisions."
Tor, which is currently being developed with support from the Electronic
Frontier Foundation, helps anonymize web browsing and publishing,
instant messaging, IRC, SSH, and other applications that use the TCP
protocol. Tor also provides a platform on which software developers can
build new applications with built-in anonymity, safety, and privacy
The competition has two phases. First, there will be a design
competition where entrants can submit mock-up sketches of good
interfaces. Second, there will be a competition to create working
implementations of good interfaces. People are encouraged to submit to
either phase or both phases. Winning entries will be open source,
exhibit strong graphic design, and include an intuitive and simple
interface. Students, freelancers, and professionals at all levels are
encouraged to enter. Everyone who enters will get a free Tor t-shirt,
and the best sketches and working implementations will be published on
the Tor website.
The competition winners will be announced at the 2006 SOUPS conference.

@_date: 2005-08-19 22:48:11
@_author: Roger Dingledine 
@_subject: (FWD) News item re: anonymous tips 
Interesting find. Of course, Tor wouldn't entirely solve the problem here,
since presumably only so many people live in the neighborhood, and random
retaliation might work just fine. Still, something to keep in mind.
Thanks Jason,

@_date: 2005-08-23 16:23:13
@_author: Roger Dingledine 
@_subject: [take 2] tor-0.1.1.5-alpha 'make check' failure on OSX 10.4.2 
Try pulling the latest from cvs and see if it still fails for you.
 has directions.

@_date: 2005-08-24 18:18:57
@_author: Roger Dingledine 
@_subject: torserver verified without request 
In early April 2005, we released 0.1.0.3-rc which included this ChangeLog
    - More automated handling for dirserver operators:
      - Automatically approve nodes running 0.1.0.2-rc or later,
        now that the reachability detection stuff is working.
      - Now we allow two unverified servers with the same nickname
        but different keys. But if a nickname is verified, only that
        nickname+key are allowed.
      - If you're an authdirserver connecting to an address:port,
        and it's not the OR you were expecting, forget about that
        descriptor. If he *was* the one you were expecting, then forget
        about all other descriptors for that address:port.
Basically once we got reachability detection working on the server side,
it fixed most instances of servers running but being unreachable, so
the manual step of making sure that a server worked was mostly solved.
So "registering" your server is now done to bind your nickname to
your key, so nobody else can take your nickname (which would be a
security issue for users who refer to your node by nickname).
See also
Hope this helps,

@_date: 2005-08-26 14:30:08
@_author: Roger Dingledine 
@_subject: PIDFile not written/missing in  tor-0.1.1.5-alpha-cvs 
Nick and I were just looking over this thread, and he noticed your quotes
above. You're attempting to use the file ""/var/Process/tor.pid"". This
will not work. :)
We're going to fix the code to put quotes around file names when it's
logging problems, so hopefully the next guy will see two double-quotes
next to each other and start wondering.

@_date: 2005-08-29 02:04:09
@_author: Roger Dingledine 
@_subject: privoxy/firefox 
Last I read the code, the way Firefox does socks5 is *not* secure from
Tor's perspective. It does the DNS resolve itself, then passes the IP
address to Tor via socks5.
Firefox 1.1 (not yet released, as far as I know) has an option to "do
dns remotely", which makes it safe. Adam Langley has a howto on this:

@_date: 2005-08-30 01:58:38
@_author: Roger Dingledine 
@_subject: Injecting client data through your own server 
If you're using Tor, your traffic is always encrypted before it leaves
your computer.
There have been some theories about setting your Tor client to point to
your Tor server as its first hop. The theory is that this way you know
that your first hop is safe. But whether this is actually safer is a
matter of debate among the researchers still. (I am slowly coming to
believe that it is less safe.)
So setting entrynodes on your Tor server to go to itself for the first
hop makes no sense, since it's already at itself (think of it as the
zeroth hop).
Can you point me to the docs that made you think this way? A lot of
people are being confused and I really want to fix whatever is confusing
in the docs.

@_date: 2005-08-30 02:12:24
@_author: Roger Dingledine 
@_subject: Injecting client data through your own server 
This is key to Tor's security.
(See picture 3)
Now, it is true that when your application (e.g. Firefox) sends stuff to
Tor, it is in plaintext. This is why you should run your Tor near you,
for example on the same computer as your application.

@_date: 2005-08-08 17:15:17
@_author: Roger Dingledine 
@_subject: Tor client and OR knowledge 
Enable your ControlPort in your torrc (e.g. to port 9100)
telnet localhost 9100
SETEVENTS CIRC
(You'll need to be using Tor 0.1.1.x-alpha for this.)
You can SETEVENTS CIRC STREAM if you want to hear status on your
socks streams too.
(If you're using an OS without a command line, then I suppose you'll
have to wait until somebody builds a tool to automate this for you.)
Hope that helps,

@_date: 2005-08-08 17:29:39
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.5-alpha is out: security update 
This is the fifth development snapshot for the 0.1.1.x series. It
fixes the second half of an important bug in the security of our crypto
handshakes. This time for sure. :) All clients should upgrade.
  o Bugfixes included in 0.1.0.14.
  o Bugfixes on 0.1.0.x:
    - If you write "HiddenServicePort 6667 127.0.0.1 6668" in your
      torrc rather than "HiddenServicePort 6667 127.0.0.1:6668",
      it would silently using ignore the 6668.

@_date: 2005-08-09 13:36:04
@_author: Roger Dingledine 
@_subject: (FWD) Re: OS X Client and Privoxy 503 error 
[Forwarding because Jay isn't subscribed as this address. Jay,
please either subscribe with the address you post from or post from
the address you're subscribed from. Brian, what version of Tor is
this? The latest alpha release (0.1.1.5-alpha) has a crash bug if you
set FascistFirewall in your torrc. Lastly, you can see your Tor logs
via  -RD]

@_date: 2005-08-10 16:56:41
@_author: Roger Dingledine 
@_subject: Tor servers on port 443 and 80 
Martin wasn't asking people to open up more ports 80 and 443 in exit
policies. He was asking people to change their ORPort to 443, and change
their DirPort to 80. This is for when people use you as their entry node.
This matters because some Tor users are behind restrictive firewalls
that only allow certain ports to get to the Internet.
Windows Tor servers who aren't doing something else with these ports
can just change the entry in their torrc. The only catch that I'm aware
of is that some ISPs filter incoming connections to these ports. So
if you change it and your Tor server is suddenly convinced that you're
unreachable, change it back. :)
No, we never write any streams to files.

@_date: 2005-08-10 17:21:30
@_author: Roger Dingledine 
@_subject: Gentoo's response on them blocking access to their forums via Tor 
Hi Brian,
Could you drop by there tomorrow and try to explain to them that it's not
very hard to make web servers distinguish between GET and POST requests,
and that they could easily fix things to block POST requests while still
allowing GET requests?
If it's just a matter of them not knowing how to configure their web
server, I bet we can find a volunteer or twenty to help out with this.
If they have a deeper reason, I'd be curious to learn what it is.
(All the rest of you going to LWE tomorrow should do go chat with them
about this too. :)

@_date: 2005-08-11 03:33:49
@_author: Roger Dingledine 
@_subject: Gentoo's response on them blocking access to their forums via Tor 
Alas, no scheme like this is going to work. People run the Tor client
on their own computers, and trying to hide how it works is going to be
a losing proposition.
Hope that helps,

@_date: 2005-08-12 13:34:20
@_author: Roger Dingledine 
@_subject: Using tor in http proxied enviroment 
Read the top of your torrc, where it says
 See the man page, or  for more
 options you can use in this file.

@_date: 2005-08-12 14:24:11
@_author: Roger Dingledine 
@_subject: Tor exiting: too many open files 
Is there something wrong with your DNS resolver? For example, does
it use a DNS server on Jupiter or otherwise a very slow one? :)
Please let me know if you've also seen something like Nils's problem.

@_date: 2005-08-12 14:36:58
@_author: Roger Dingledine 
@_subject: Tor exiting: too many open files 
Another option is to try building with the "--disable-threads" option
to ./configure. Let me know if that helps. (If it does help, this means
threading support on your platform is broken.)

@_date: 2005-08-12 15:15:02
@_author: Roger Dingledine 
@_subject: Using tor in http proxied enviroment 
Well, if it's NTLM, check out
If it's 'integrated' (whatever that is) I suppose the same answer applies,
but we don't have anything to point you to. :)

@_date: 2005-08-14 05:56:42
@_author: Roger Dingledine 
@_subject: Policy on filtered ExitNodes?? 
Right. There's a tension between verifying and tracking trusted operators,
and letting any shmo run a server. For now we're tending towards the
It is possible to un-recommend specific bad servers. The way it works
is that the directory servers recommend to clients which servers are
usable for exit. Up until Tor 0.0.9.x, we needed to explicitly approve
your node before you could be used. Now, if you pass a few rudimentary
checks then you're automatically able to be used. We'll keep tweaking
things (or totally changing our mind) until we're happy.
So as you find servers that are filtering exits, please come to the
IRC channel and tell us. We'll track them down and get them to correct
it (like in the case of powerpenguin61), else we'll un-recommend them.
One of the important tasks as we move forward is to make these automated
checks better. But we're never going to be able to entirely find all
the subtle ways in which people might change content. It goes back to
our original statement about exit node risk: if you need some sort of
end-to-end data integrity checking, like SSL, then you should use that
whether or not you use Tor.
Hope that helps,

@_date: 2005-12-15 02:35:06
@_author: Roger Dingledine 
@_subject: [declan@well.com: [Politech] E.U. Parliament votes to force "data retention" on telecom, Net firms [priv]] 
Alas, I think Jeffrey has it right. Tor aims to provide protection in
a scenario where the adversary cannot observe the whole network (or
a substantial piece of it). The EU data retention directives directly
threaten the security that the current Tor design can provide.
There are some anonymity designs that aim to provide protection against
this strong level of adversary -- see e.g.  --
but they carry unacceptably high latency for Tor-style connections.
As I understand it we're still a ways off from understanding exactly
what laws will be passed in each country, and only a while after that
will we start to understand what each law will mean. It may turn out
to be impractical (or illegal) to put out a blanket query to every ISP
in Europe saying "please tell me all users who connected to any of the
following 1000 IP addresses in this 10 second period".
But even so, once we have a sense of what sorts of attacks are likely,
we can also start looking at some specialized padding techniques for
Tor users to blend together better without paying too high a price in
overhead. The goal is not to beat arbitrary statistical attacks, but
to increase false positives (and maybe false negatives) with respect to
specific attacks.
We may also be able to take advantage of the fact that these adversaries
are only partial attackers: even in the best attacks they can only
observe perhaps half the network. We may be able to arrange things to
increase the doubt in their findings -- though as Jeffrey points out,
a patient attacker will use statistics to become increasingly convinced
that he has found his target.
It really is a shame that Europe has chosen to cripple the security of
its citizens and companies in this way. The bad people will continue to
break laws and not get caught by this (breaking into computers around the
world and using them as stepping stones, using open wireless networks,
using botnets, you name it), and honest people and organizations in Europe
will always be wondering who has broken into their ISP and grabbed their
traffic data -- for espionage, for advertising purposes, for stalking,
for who knows.
This is reminiscent of the U.S.'s earlier crypto export fiasco, when they
chose to undermine their position as the world leader in cryptography,
as well as ensure that the good guys were vulnerable while the bad guys
were safe. I wonder how this one will turn out.

@_date: 2005-12-16 05:46:56
@_author: Roger Dingledine 
@_subject: (FWD) Resurrecting the or-dev list 
FYI. Feel free to subscribe to or-dev and watch what we're up to, or
you can check up on it periodically from

@_date: 2005-12-16 05:59:22
@_author: Roger Dingledine 
@_subject: Getting more servers 
I believe the answer to this is no. Directory fetches are already
a small percentage of the overall Tor traffic, and the directory
changes we're making in 0.1.1.x make things even more lightweight
(clients download individual server descriptors when new ones are
available, rather than downloading them all en masse periodically --
see  for more details, though
alas it looks like it needs updating).
To handle more load, the real answer it to attract and keep more fast
and reliable servers.

@_date: 2005-12-16 06:23:59
@_author: Roger Dingledine 
@_subject: (FWD) commercial nodes (Was: Re: data retention) [u] 
[Forwarding because Mixter isn't subscribed at this address. Mixter,
please fix this one way or the other. -RD]

@_date: 2005-12-16 06:28:17
@_author: Roger Dingledine 
@_subject: (FWD) Re: Whitedust article 
[Forwarding because our good friend Mixminion isn't on the
list either. Tor is already tackling the below problems, though
we're not currently aiming to defeat a China-level adversary:
Message-type: plaintext
Network admins DO have legit concerns about people abusing both Tor and their
systems, however as I understand it from the Tor website, Tor's primary goal is functional anonymity that can protect people in harsh circumstances.  One
good example is that people are using things like Tor and Freenet to get
information through the Bamboo Firewall of China.  In order to remain effective,
Tor must remain able to function in spite of people attempting to shut it down
or block it.
I think my ideas are reletively simple concepts:
1  Encourage more node operators to become directory servers.
   (this one's a no-brainer)
2  Add (unless it's already there) an ability to have Tor use an    'accessible' port like 80 or 443 to contact directory servers instead of
   the default port that people trying to stop Tor will likely be watching.
3  Implement decentralized directory functions.  Take a page from Freenet
   and let the client attempt to get directory info from any node it is able
   to contact.  Even if each node can only tell about the ones that it has
   contacted, it shouldn't take long for Tor to build enough directory info
   to allow it to route to a full directory server through the network.
   combined with the use of a separatly downloadable file similar to the freenet
   seednode.ref, a current copy of which would be included in the installer
   along with directons for getting a fresh one from a Tor website if it's
   needed.
-----END TYPE III ANONYMOUS MESSAGE-----

@_date: 2005-12-18 01:11:40
@_author: Roger Dingledine 
@_subject: circuit recovery 
I've just fleshed out the FAQ entry on this:
Thanks for the nudge.

@_date: 2005-12-19 17:05:16
@_author: Roger Dingledine 
@_subject: Resolving IP address 
You're right, that's a bad log message. In 0.1.0.15, it happened only
when you failed to resolve an address. In 0.1.1.x, it also can happen
when you resolved it but keep getting "misc errors" back from the exit
nodes that try to connect.
So I've changed it in CVS to say "resolving or connecting to".
Definitely not or-dev.
As Peter said, the best place for bugs is since that way we'll be sure not to lose track of them.

@_date: 2005-12-20 02:13:09
@_author: Roger Dingledine 
@_subject: We have a new Windows Tor installer 
Hi folks,
Matt Edman has created a "package bundle" that includes Tor, TorCP,
and Privoxy. We've rewritten the Tor win32 instructions to tell people
to use that rather than doing all the steps manually:
If you're a Windows user, please take a look and let us know if there
are any installation problems, and if there are any documentation things
we should fix.

@_date: 2005-12-23 05:22:46
@_author: Roger Dingledine 
@_subject: EFF no longer funding Tor (was Re: ATTN: for-profit Tor operators) 
I've put up a donations page for Tor here:
Nick and I are continuing to work on Tor in our spare time, but as you
can see, the user base is growing faster than our development can keep
up. Please help us to put our attention back on Tor development rather
than getting day jobs.

@_date: 2005-12-23 18:39:05
@_author: Roger Dingledine 
@_subject: EFF no longer funding Tor (was Re: ATTN: for-profit Tor operators) 
Good idea. I've added a few more paragraphs to
with details on this, plus other options.
Let me know if I've left out anything else that's important. :)

@_date: 2005-12-23 22:37:33
@_author: Roger Dingledine 
@_subject: P2P wanted? 
It would be desirable, but it's a bit tricky. We need to a) design a tit
for tat mechanism that encourages good behavior, b) assess its impact
on anonymity and fix it until we're happy, and c) do some (possibly
significant) architecture changes on Tor so we can provide better service
to some servers or on some circuits.
Please read section 5.1 of
I'm collaborating with Dan Wallach at Rice University on a small NSF
project to look into this. I hope to have some answers in a month or two.

@_date: 2005-12-31 03:37:09
@_author: Roger Dingledine 
@_subject: public archive? 
You can see your post here:
I don't think this should be causing more spam for you.
The archive is public because we try to do our Tor work and discussions
in the open so people can know what's going on. Also, one of these days
we'll set up a way to search the archives (anybody want to help with
that? ;), so people can hunt for previous threads rather than starting
the same ones over again.

@_date: 2005-12-07 19:04:35
@_author: Roger Dingledine 
@_subject: (FWD) Name alice in graphic should be changed 
The crypto namespace meets the outside world.
Anybody else here know about Alice, and think we should consider
changing our actors in the diagrams?

@_date: 2005-12-08 16:36:19
@_author: Roger Dingledine 
@_subject: Setting Up Server Help Please. 
% host ephman.no-ip.info
ephman.no-ip.info has address 67.100.54.160
% telnet 67.100.54.160 9001
Trying 67.100.54.160...
I've changed the "this may take several minutes" part of the log message
to "this may take up to 20 minutes -- look for log messages indicating
success". I've also updated the first paragraph of

@_date: 2005-12-09 00:06:10
@_author: Roger Dingledine 
@_subject: ProxyCap analogues 
Freecap is about the best we can point you to.
See the bottom half of  for more options.
Speaking of which, we're still looking for some volunteers to help
sort this list, document what works where, and so on. :)

@_date: 2005-12-01 20:04:41
@_author: Roger Dingledine 
@_subject: Voting for nym 
Hi Jason,
Can you walk us through the trade-offs between the following two schemes?
a) Adding the patch to MediaWiki and having Wikipedia track which certs
are good and which are bad.
b) Running an http proxy of your own somewhere that demands
authentication via certs, and then allows proxying to Wikipedia?
Option b seems to need some way for Wikipedia to tell you "who" caused
abuse so you can remember that yourself, but on the other hand maybe
it's easier for Wikipedia to handle?

@_date: 2005-12-11 02:29:03
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.10-alpha is out 
This is the tenth development snapshot for the 0.1.1.x series. We fix
more crash bugs, fix some anonymity-related problems, and provide major
performance speedups and use less memory than the previous alphas.
Changes in version 0.1.1.10-alpha - 2005-12-11
  o Correctness bugfixes on 0.1.0.x:
    - On Windows, build with a libevent patch from "I-M Weasel" to avoid
      corrupting the heap, losing FDs, or crashing when we need to resize
      the fd_sets. (This affects the Win32 binaries, not Tor's sources.)
    - Stop doing the complex voodoo overkill checking for insecure
      Diffie-Hellman keys. Just check if it's in [2,p-2] and be happy.
    - When we were closing connections, there was a rare case that
      stomped on memory, triggering seg faults and asserts.
    - We were neglecting to unlink marked circuits from soon-to-close OR
      connections, which caused some rare scribbling on freed memory.
    - When we're deciding whether a stream has enough circuits around
      that can handle it, count the freshly dirty ones and not the ones
      that are so dirty they won't be able to handle it.
    - Recover better from TCP connections to Tor servers that are
      broken but don't tell you (it happens!); and rotate TLS
      connections once a week.
    - When we're expiring old circuits, we had a logic error that caused
      us to close new rendezvous circuits rather than old ones.
    - Fix a scary-looking but apparently harmless bug where circuits
      would sometimes start out in state CIRCUIT_STATE_OR_WAIT at
      servers, and never switch to state CIRCUIT_STATE_OPEN.
    - When building with -static or on Solaris, we sometimes needed to
      build with -ldl.
    - Give a useful message when people run Tor as the wrong user,
      rather than telling them to start chowning random directories.
    - We were failing to inform the controller about new .onion streams.
  o Security bugfixes on 0.1.0.x:
    - Refuse server descriptors if the fingerprint line doesn't match
      the included identity key. Tor doesn't care, but other apps (and
      humans) might actually be trusting the fingerprint line.
    - We used to kill the circuit when we receive a relay command we
      don't recognize. Now we just drop it.
    - Start obeying our firewall options more rigorously:
      . If we can't get to a dirserver directly, try going via Tor.
      . Don't ever try to connect (as a client) to a place our
        firewall options forbid.
      . If we specify a proxy and also firewall options, obey the
        firewall options even when we're using the proxy: some proxies
        can only proxy to certain destinations.
    - Fix a bug found by Lasse Overlier: when we were making internal
      circuits (intended to be cannibalized later for rendezvous and
      introduction circuits), we were picking them so that they had
      useful exit nodes. There was no need for this, and it actually
      aids some statistical attacks.
    - Start treating internal circuits and exit circuits separately.
      It's important to keep them separate because internal circuits
      have their last hops picked like middle hops, rather than like
      exit hops. So exiting on them will break the user's expectations.
  o Bugfixes on 0.1.1.x:
    - Take out the mis-feature where we tried to detect IP address
      flapping for people with DynDNS, and chose not to upload a new
      server descriptor sometimes.
    - Try to be compatible with OpenSSL 0.9.6 again.
    - Log fix: when the controller is logging about .onion addresses,
      sometimes it didn't include the ".onion" part of the address.
    - Don't try to modify options->DirServers internally -- if the
      user didn't specify any, just add the default ones directly to
      the trusted dirserver list. This fixes a bug where people running
      controllers would use SETCONF on some totally unrelated config
      option, and Tor would start yelling at them about changing their
      DirServer lines.
    - Let the controller's redirectstream command specify a port, in
      case the controller wants to change that too.
    - When we requested a pile of server descriptors, we sometimes
      accidentally launched a duplicate request for the first one.
    - Bugfix for trackhostexits: write down the fingerprint of the
      chosen exit, not its nickname, because the chosen exit might not
      be verified.
    - When parsing foo.exit, if foo is unknown, and we are leaving
      circuits unattached, set the chosen_exit field and leave the
      address empty. This matters because controllers got confused
      otherwise.
    - Directory authorities no longer try to download server
      descriptors that they know they will reject.
  o Features and updates:
    - Replace balanced trees with hash tables: this should make stuff
      significantly faster.
    - Resume using the AES counter-mode implementation that we ship,
      rather than OpenSSL's. Ours is significantly faster.
    - Many other CPU and memory improvements.
    - Add a new config option FastFirstHopPK (on by default) so clients
      do a trivial crypto handshake for their first hop, since TLS has
      already taken care of confidentiality and authentication.
    - Add a new config option TestSocks so people can see if their
      applications are using socks4, socks4a, socks5-with-ip, or
      socks5-with-hostname. This way they don't have to keep mucking
      with tcpdump and wondering if something got cached somewhere.
    - Warn when listening on a public address for socks. I suspect a
      lot of people are setting themselves up as open socks proxies,
      and they have no idea that jerks on the Internet are using them,
      since they simply proxy the traffic into the Tor network.
    - Add "private:*" as an alias in configuration for policies. Now
      you can simplify your exit policy rather than needing to list
      every single internal or nonroutable network space.
    - Add a new controller event type that allows controllers to get
      all server descriptors that were uploaded to a router in its role
      as authoritative dirserver.
    - Start shipping socks-extensions.txt, tor-doc-unix.html,
      tor-doc-server.html, and stylesheet.css in the tarball.
    - Stop shipping tor-doc.html in the tarball.

@_date: 2005-12-13 23:20:13
@_author: Roger Dingledine 
@_subject: We're sorry... 
It does. But it looks like a lot of them are affected for the past few
days. It will pass.

@_date: 2005-02-12 19:38:19
@_author: Roger Dingledine 
@_subject: Reusing Exit Nodes? 
Hi Mike,
Thanks for sending this. I'm in the process of putting the patch in. Once
I finish jumping from conference to conference I'll land the changes. I
realized that our client dns cache *is* an addressmap, so I'm trying to
merge them so we can keep complexity down.
This was very useful to jumpstart us into doing this feature. Don't get
discouraged just because we're busy. :)

@_date: 2005-02-20 18:07:57
@_author: Roger Dingledine 
@_subject: blockers 
Hi Matthias,
That looks like a fine addition to the FAQ wiki. Please add it.
Also, can you provide more details about the actual errors and other
'minor error messages'? As SK said, Google typically does this filtering
by query. They don't (as far as I know) keep a big database of IPs they
think are 'bad'. So I'd be curious to hear more details. :)

@_date: 2005-02-21 17:36:55
@_author: Roger Dingledine 
@_subject: (FWD) tor [windows tutorials] 
Can somebody take a look at this and see if it's something we
should like, something we want tweaked and then will like, etc?

@_date: 2005-02-21 18:13:14
@_author: Roger Dingledine 
@_subject: (FWD) Re: (FWD) tor [windows tutorials] 
[Forwarded because Nato isn't subscribed from this address. -RD]
Nato, can you contact the guy and help him turn these into something
that we'll find useful? We can put them up on the official website
once they're in good shape, or we can leave them where they are.

@_date: 2005-02-21 20:07:53
@_author: Roger Dingledine 
@_subject: Reusing Exit Nodes? 
Ok, this feature is now in CVS:
Try this example in your torrc:
AddressMap  then try adding
AddressMap  It lets you remap remaps, but cuts you off after 16 remaps.
(I could raise this limit if people think it's too low.)
See the man page for more details about AddressMap and TrackHostExits.
Thanks to Mike Perry for the motivation and starting point for this.

@_date: 2005-02-25 16:18:23
@_author: Roger Dingledine 
@_subject: freshmeat tor entry 
Hi Martin,
Great idea. Would you like to be our Freshmeat liaison? That is, list
the project and keep the listing up to date?

@_date: 2005-02-02 17:40:22
@_author: Roger Dingledine 
@_subject: Tor Network response slowing to zero 
One of the immediate reasons for this, I think, is that the big
exit nodes are limited at 1024 open file descriptors, and as
Giorgos points out, they're hitting that limit. See my post
 for details.
Another big reason is that we're getting increasingly hammered by
file-sharers. This has caused some of the bigger nodes to decide they
don't want to carry this much traffic. We need to teach clients to back
off better when things are going wrong; I'm not sure of the best way to
do that yet.
We also have some stability issues, as Giorgos points out. These are
getting resolved. (If you folks want to try running the CVS code again,
go for it. It might just work for you this time. :)
Plus, we're trying to adapt to having other Tor clients in the system.
JAP has implemented a Tor client and they're getting ready to release it
(or they have already, I'm not sure). I'm not sure how I feel about this,
because they only wrote a client, not a server, so in some sense they're
just as bad as the filesharing folks. (In another sense, yay privacy,
more privacy good.)
On top of all this is the blacklisting issue, where we're in a standoff
with various projects that would rather see the Tor network as a whole
go away. (And the funny thing is, every single person who wants to see
Tor die starts out his statement with "I think Tor is a really important
idea, but". It's like they're afraid to be seen as not hip, yet they
still want it to die.)
Clearly, the number one answer is that if Tor isn't working for you,
please run (or find somebody to run) a high-bandwidth node. Or failing
that, please run any sort of node (cable or dsl is fine). If everybody
only uses Tor as a client, and expects it to work for them, then this
whole experiment will fail.
On the one hand, we theorize that the network will stabilize: people who
are getting crappy performance and don't like it will get frustrated and
leave, freeing up bandwidth for the rest of the people. So Tor will grow
and shrink in cycles, as it adapts to how much it's getting hammered.
This theory falls apart though if the file sharers are more tolerant
of crappy performance than the rest of the users. It could be that the
file sharers will stick around until the whole network is pushed into
the ground.
There's a new default exit policy in CVS, which blocks more default
file-sharing ports:
ExitPolicy reject 0.0.0.0/8,reject 169.254.0.0/16,reject 127.0.0.0/8, reject 192.168.0.0/16,reject 10.0.0.0/8,reject 172.16.0.0/12
ExitPolicy accept *:20-22,accept *:53,accept *:79-81,accept *:110,accept *:143,accept *:389,accept *:443,accept *:636,accept *:706,accept *:873,accept *:993,accept *:995
ExitPolicy reject *:1214,reject *:4661-4666,reject *:6346-6347,reject *:6419,reject *:6881-6889
ExitPolicy accept *:1024-65535,reject *:*"
Feel free to apply it to your exit server if you like. Or if you run CVS,
you get it automatically. This approach isn't meant to definitively stop
all instances of file-sharing. Rather, it's meant to make casual users
think Tor doesn't work for them, so they go away. (A few exit servers
will likely still allow many ports; but in this case the protocols that
exit at them are bottlenecked by those servers.)
Or we could take more drastic measures. For example, we could recommend
an exit policy which accepts 20-22,53,79-81,110,143,389,443,636,706,873,
993,995,1863,5050,5190,5222,5223,6667,8080,8300,8888, and rejects the
Heck, we could accept just 80 and 443 and tell people using the other
protocols to go bugger off.
(A related plan would be to put priorities on certain ports, such as
80 and 443, and when using those we ignore servers with capacity less
than 100kB. I'm not sure how this would play out in the tragedy of
the commons.)
In some sense, these could be temporary measures. Tor is still in
development, and it needs more work on pretty much all fronts. We need
to focus on all this development rather than (or at least 'as well as')
just being reactionary about the immediate issues. As long as we have
some sort of deployed network finding bugs for us, we can move forward
on that.  All the publicity we've gotten from having a working system
has distracted us from making a system that will actually work. :)
What do you folks think?
Right now we choose nodes for our circuits proportional to their declared
capacity (the most bytes they've seen themselves able to handle, both
incoming and outgoing, in the past 24 hours, or their BandwidthRate if
it's lower).
So if everybody knows that everybody is choosing paths that way, that
seems pretty close to optimal under our constraints.
I suppose we could weight it further by the proportion of its capacity
it has been using lately, but this leads to your next question:
Right now servers upload new descriptors every 20 minutes, servers fetch
full directories every hour, and clients fetch full directories (once
an hour) from any server that has it mirrored. So we're talking an hour
or more before the information propagates. And we'd like to crank those
numbers *up*, not down, since they still represent significant overhead,
and since we're still hoping to decentralize the network discovery process
even more. I guess we could back down on that hope if you convinced us
things would work better this way. But I think the problem is not that
the Tor network is mis-allocating its bandwidth, I think it's that we
simply don't have any left.
In short: run a server. :)

@_date: 2005-02-02 17:54:35
@_author: Roger Dingledine 
@_subject: Tor Network response slowing to zero 
Interesting. Note that Tor's rate limiting is very primitive: we simply
stop reading from the TCP sockets when we don't want to receive any more,
and then start reading again when we do. This presumably causes TCP to
push back until the window goes to zero.
Is this going to produce different behavior (that is, less packet loss)
than simply trying to get packets and having not all of them arrive?
I really don't know. It's probably worth experimenting.
Our default BandwidthBurst is high because I figured hey, letting bytes
through is good.
Perhaps we should try a different approach where if the user doesn't
define BandwidthRate, we start it out at 20 KB with a BandwidthBurst
of twice that, and periodically we check if our measured capacity (the
highest throughput we've seen in the past 24 hours sustained over 10
seconds) exceeds BandwidthRate, and if so, we raise it. This would let
us ramp up by auto-detecting available bandwidth, without the user having
to make any decisions.
Ramping down is another issue, though. For coloc'ed machines, their
capacity typically is at least what we measured. But cablemodem machines
are weird because their available bandwidth varies so much. Currently
our capacity estimates tend to _over_estimate the capacity they have,
since we measure the most we've seen in the past day. One easy ramping
down approach would be, periodically (like once a day or once an hour),
to reset our BandwidthRate to our measured capacity. So if it goes down
dramatically we will react.
Can somebody else speculate on whether this would help?

@_date: 2005-02-02 23:42:31
@_author: Roger Dingledine 
@_subject: a NAT problem 
Right. If you have an address that isn't behind nat (that people can get
to from the outside), then you're all set. It's only if you're behind
nat (by which I guess I mean 'only behind nat'), then we can't deal with
that yet.
We don't care where the actual processing happens. We just care that it
(the server) is reachable.
Hope that helps,

@_date: 2005-02-03 00:37:00
@_author: Roger Dingledine 
@_subject: questions of morality 
Hi Aaron. You've heard a number of perspectives so far. The perspective
of the Tor developers can be summarized by the list at the top of
and then by the discussion in the 'abuse' section on the wiki faq:
  7.1. Doesn't Tor enable criminals to do bad things?
  Criminals can already do bad things. Since they're willing to break
  laws, they already have lots of options available that provide _better_
  privacy than Tor provides. They can steal cell phones, use them, and
  throw them in a ditch; they can crack into computers in Korea or Brazil
  and use them to launch abusive activities; they can spread viruses that
  take control of literally millions of Windows machines around the world.
  Tor aims to provide protection for ordinary people who want to follow
  the law. Only criminals have privacy right now; we need to fix that.
Let me know if you need more convincing, or need help setting up a
server. :)

@_date: 2005-02-03 19:55:12
@_author: Roger Dingledine 
@_subject: tor won't run for more than a few minutes 
Yep, that's pretty much what happened in the past few hours. :)
0.0.9.4 coming out shortly.

@_date: 2005-02-03 22:25:33
@_author: Roger Dingledine 
@_subject: tor won't run for more than a few minutes 
is in place, for those of
you eager to run a version that doesn't crash from this.
I'll do up an actual or-announce mail once we have packages ready for
various platforms.
It's been an exciting day. :) Sorry for the disturbance.

@_date: 2005-02-04 02:21:33
@_author: Roger Dingledine 
@_subject: Which signature to use? 
Let me know if I can make that answer more useful.

@_date: 2005-02-01 05:13:46
@_author: Roger Dingledine 
@_subject: hostile node anonymity attack scenario 
Right. When your Tor client (call it Alice) asks the first hop to extend
to the second hop, part of this extend process requires the second hop
to prove to Alice that it knows the appropriate private key:
plus the diagram above that.
So the only way the first hop could "fake" the extend is by knowing the
appropriate private key, e.g. by colluding with the second hop. Since
Alice chooses which nodes to use for each hop, then the chance that
they'll be colluding is low as long as many nodes in the network don't
all collude with each other.
But you're right to point out the weakness of trusting us to keep the
master list. But if we just let anybody sign up, we could have real
This is a tricky problem already, and it's going to get even trickier
as we try to scale up the network and take the humans out of the loop.
One approach we're considering is just to do it anyway and hope that
no large attacker cares to try attacking the network (and as we grow,
the bar for successfully attacking the network becomes higher and higher).
Actually, this attack is overkill. The attacker only needs to have Alice
happen to pick bad nodes for both her first and last hops. Even if nodes
in the middle are good, we suspect end-to-end traffic confirmation attacks
(based on packet timing and volume) can be used with great success:
This is why Tor's security is mainly based on the diversity of the
We hope to grow large enough that most real-world adversaries are unlikely
to be in the right places to attack users.
As for the specific attack of waiting until Alice happens to pick bad
first and last hops, this is why we need to investigate using helper
nodes, that is, fixed first hops:
People running hidden services are particularly vulnerable to this issue,
since other users (such as the adversary) control the rate at which they
build connections.
Hope that helps,

@_date: 2005-02-09 05:45:36
@_author: Roger Dingledine 
@_subject: blocking google groups [was Re: ExitPolicy abuse] 
First, to SK: yes, middleman nodes are still very useful. Remember that
two of the three hops in the circuit are on nodes other than the exit
node. Also, since Tor's security comes from the diversity of its network,
letting people *enter* at your node is very helpful to security.
(I assume you mean Usenet.)
Hm, this is a tricky one. For example, if Google starts filtering posts,
liability issues may come up. Also, Google tends to get bad publicity
when they do things that can be seen as "censorship."
Ok, but groups.google.com is an alias for groups.google.akadns.net,
which doesn't bode well for easily enumerating its addresses. :)
I'll have a talk with some Google security folks about this, and see how
they feel about this particular example of abuse. Thanks for bringing
it up.

@_date: 2005-02-09 05:59:36
@_author: Roger Dingledine 
@_subject: Opt-Out Lists: Useful Feature? 
Another down side is that we'd need some way to keep people from
opting out *other* sites -- effectively DoSing them. Plus, as you say,
a centralized point of control (never good from a legal perspective)
endangers anonymity since we can with short notice influence the set of
sites a given user might be exiting from.
Also, it's not clear how services would realize that Tor is doing the
connections. How does this work for bugmenot? Anonymous remailers can
put notices in the mail headers ("this is an anonymous remailer, mail
this address for abuse problems"), but since Tor abstains from knowing
about the application-level protocols, this seems hard in the general
One other thing that's been bothering me is that the directory grows
as exit policies get increasingly complex. That is, we try to describe
each exit's planned actions in the directory, so the client can predict
which nodes will allow his requests. We might try to describe the exit
policy in broad strokes in the directory, and then clients will keep
trying likely exits until one works; but this increases latency, and
nobody seems to like that.
You're right, nodes with liberal exit policies ("liberal" meaning allowing
port 80, which carries pretty much every protocol these days) are going
to keep having problems until we figure out a more fine-grained solution
for this. Hm.

@_date: 2005-02-09 06:43:17
@_author: Roger Dingledine 
@_subject: First draft, Challenges in deploying low-latency anonymity 
Hi folks,
In the spirit of documenting our experiences with deploying Tor, we've
been feverishly working on a paper lately, and we have a first draft
available for comment.
  There are many unexpected or unexpectedly difficult obstacles to
  deploying anonymous communications.  Drawing on our experiences
  deploying Tor (the second-generation onion routing network), we
  describe social challenges and technical issues that must be faced
  in building, deploying, and sustaining a scalable, distributed,
  low-latency anonymity network.
Please don't publish this past this list yet, as it's simply the first
draft of a paper we have not yet submitted, so we expect it to change
quite a bit before the final version.

@_date: 2005-01-31 21:52:53
@_author: Roger Dingledine 
@_subject: http status 403 (unapproved server) response from dirserver 
Whoops, this one was my fault. I accidentally started moria2 an hour
or so ago with an old approved list. I imagine several other recently
joined servers got this message as well. Oops.

@_date: 2005-01-03 20:39:13
@_author: Roger Dingledine 
@_subject: hidden services... 
In theory it is never changed, assuming the directory you point to is
unchanged. For example, if you put it in /tmp/ then it may get erased
by a system utility, and then Tor would find that it's not there (and
recreate it) next time you run Tor.
You're not the first person to report this phenomenon though. Perhaps
we have a bug somewhere. Can anybody recreate this in a repeatable way?

@_date: 2005-01-22 17:17:07
@_author: Roger Dingledine 
@_subject: wikipedia vandalism 
Hi Frank,
I noticed
 from
my referer log earlier today, so I've been looking a bit at Wikipedia
banning policies.
I took a brief look around the block policy at
 and the pointer
to the February 2004 thread about anonymizers, but I didn't see any
definitive answers to the thread on the list. (In fact, it seems you point
to which isn't even in the thread.) Could you summarize for us to reasons why
Wikipedia doesn't want to require users _from Tor IPs_ to create accounts
in order to edit pages?
We have the beginnings of some Abuse faq entries on
but there's still plenty more to discuss there.
This is tricky to do from a technical standpoint, a) because we need to
teach Tor about protocols and how to reach into the application-layer
stream, and b) because Tor clients would need to predict what the
application was going to do before it does it, in order to pick an exit
node that will allow the operation. We'd like to consider implementing
something like this down the road but it seems hard to get right without
adding a lot of complexity (which is bad for security systems).

@_date: 2005-01-24 03:18:37
@_author: Roger Dingledine 
@_subject: Crash Logs for tor CVS Current built 1-21-2005 
No, these don't give us any hints at all of what was going on or what
caused the crash. These lines just say that the dns worker noticed the
main process died, so it exited too.
A core dump, or the last couple hundred lines of debug-level logs,
would be more useful.
Alas, we have a couple of known bugs in cvs that we haven't fixed yet. I
might suggest waiting a few weeks until we have time to track all these
things down. 0.0.9.3 will hopefully work well enough until then. (Nick
and I are spending the next little while working on a paper to summarize
the current and future issues Tor needs to deal with.)

@_date: 2005-01-24 04:25:49
@_author: Roger Dingledine 
@_subject: (FWD) Problems with Tor in user-mode-linux 
Using 56 megs of memory for Tor is not un-heard of, for a very active
Tor server. I typically find leaks by using valgrind periodically,
but it's crazy slow so it doesn't work well for long-running servers.
Do you know any run-time leak-checkers that work and aren't too slow?
As for the other processes beside the first one, I believe all of those
are using roughly zero memory. When linux does a fork, all of the memory
pages are inherited in a copy-on-write fashion, and Tor doesn't change
most of them. So I think the other processes are sharing the same memory.
(Do you have reason to believe otherwise? We might have a bug there.)
Tor forks a cpuworker when it starts (well, one cpuworker per cpu you
have configured in 'NumCpus', defaulting to 1), and the other workers
are dnsworkers. They just do a very simple loop in dnsworker_main() in
src/or/dns.c, which just reads stuff off their socket, calls gethostbyname
on it, and writes back the answer. We fork 3 dnsworkers to start, and we
make a new one when the others are busy, and if there are too many idle
(more than 10) we kill off the excess ones.
Yeah. Hm. Maybe we should put out a bounty on this one. :) Let me know
if you encounter any more hints.

@_date: 2005-01-24 06:04:52
@_author: Roger Dingledine 
@_subject: wikipedia vandalism 
Hi Frank,
I agree, Wikipedia's current "make an account" system does
not do what you need -- make it hard for vandals to do their
thing. Yahoo and other sites address this problem by using captchas
( to add cost to creating an account.
You're in a pretty tricky situation, given that you want to keep allowing
account-less edits, yet there are literally millions of open proxies
and compromised machines out there that vandals can use. By blocking Tor
exit nodes, the people who want privacy via Tor can't edit wikipedia now,
but the vandals still have plenty of open proxies they can use.
Notice that there are actual legitimate people doing real edits over
Tor. You've heard from some of them in private mail lately, and others
posted on your "Talk" wiki. Even in the original thread about this on
the wikipedia list, there were people who didnt want an overall ban, e.g.,
One approach that's in the middle ground would be to require logins,
including captchas, and track edits by accounts like you do now. If
you notice abuse then roll back everything the account has done and
cancel it. If there's repeated unmanageable abuse from Tor, block
it for an hour or something until the guy gets bored. Alternatively,
you could preemptively put edits from certain accounts into a "has
to be manually approved" queue. Optionally, if the first N edits are
approved then further edits can be automatic as now. If you worry about
the barrier-to-entry for normal wikipedia users, all of this can be
selectively applied only to IPs that you flag as suspicious.
So, there are some solutions that could provide much better protection
without too much more work, if you decide that being able to get edits
from Tor users is worthwhile.
(You mention in your Talk wiki that you used to run a Tor node? I think
you might be confused about how Tor works, since you have never run a
Tor node to my knowledge. Most Tor users are just clients; I'm guessing
that's what you ran. We have probably upwards of 10k-20k people using Tor
currently, and I imagine some of them do, or would like to do, Wikipedia
edits. As a trivial example, I noticed a grammar problem while browsing
the entry on Svalbard today, and I can't fix it. Oh well.)
It seems the culmination of the thread from the February 2004 wikipedia
list is the statement
"In general, I like living in a world with anonymous proxies.  I wish
them well.  There are many valid uses for them.  But, writing on
Wikipedia is not one of the valid uses."
If this is truly the concensus of the wikipedia community -- that
wikipedia values equal access for all, except when it comes to people
who value their privacy -- then I guess the discussion is over. I think
in that case it ends in Wikipedia's loss, since you block a few IPs,
yet there are still many IPs left for vandals to use that you do not
block. As the Tor network grows, you will be blocking more and more
potentially useful users, yet not really impacting the number of IPs
available to the vandals.
Now, I think you are right, it's reasonable to block the whole Tor network
for the moment, while you take stock of your security assumptions and
see if you want to adapt into a system that can take into account that
humans do not map uniquely to IP addresses. Blocking Tor is not going
to solve your problem long-term -- your problem is deeper than that.
But it shouldn't be up to Tor to understand and manage application-level
authentication and authorization for every service on the Internet. While
this particular issue is being resolved, Tor servers operators
should do what they need to do; but I recommend that you don't
put any Wikipedia-specific entries in your exit policy, in order
to allow as many people as possible to safely read wikipedia. And
if you want to write to wikipedia from your Tor server's IP (which
you might want to do typically for plausible deniability, a form of
privacy), I recommend you use some other anonymizing service, such
as JAP ( or Anonymizer
( If wikipedia decides to block those, there are
plenty more where they came from. Hopefully at some point they'll realize
their energies can be better spent working on content for Wikipedia
rather than working on building and maintaining blacklists of many
thousands of IP addresses around the Internet.
I'm sorry to not have more useful answers. Wikipedia's security
assumptions don't leave us much wiggle room. :(

@_date: 2005-01-03 21:24:32
@_author: Roger Dingledine 
@_subject: Tor running on mipsel 
Hi Niels,
Could you write up a little tutorial on tor + transproxy for us,
and post it maybe at  ?
We already have which describes setting up an exit node + squid for caching. But the
squid howto was written before we added the RedirectExit config option
(man tor for details).
It looks like you're thinking of using iptables+transproxy at the client
side instead, to automatically capture and redirect port 80 requests?

@_date: 2005-01-25 01:18:03
@_author: Roger Dingledine 
@_subject: (FWD) Problems with Tor in user-mode-linux 
Yow. You're totally right.
We'll do something about it in the 0.1.0 series.

@_date: 2005-01-25 03:19:03
@_author: Roger Dingledine 
@_subject: TOR DNSBL - blacklist for Tor servers 
We've been working with Rob (aka lilo) to come up with good answers for
Freenode. He seems intent on not blocking ("klining") Tor nodes from
the Freenode network, so we're off to a good start.
The current approach he's working on is to label all users coming from
Tor nodes as "Tor users", and then each irc channel can decide whether
to block this class of users or not. I think that's reasonable.
The "sectoor" blacklist you mention is particularly troublesome, because
a) it doesn't look at exit policies at all, b) it suggests you block
the entire class C network (x.y.z.*) around each Tor server, and c)
it recommends itself for SMTP blocking even though no Tor node allows
outgoing port 25.
A number of people have been pushing us to make an "official" Tor
blacklist that parses exit policies and is smarter about stuff. For
now I have decided that the Tor project should not do this:
The real answer is to improve the services on the Internet so they stop
assuming that IP addresses equate to humans. Just as the FSF doesn't help
people with proprietary software, I think we should not help people with
blacklisting Tor nodes based on IP. It's not the right approach. Our
role should be to provide the transport, be happy that some services
are interested in allowing privacy-minded folks to use the service,
and preach from the rooftops regarding the ones that are scared of it.
So, people are free to cobble together solutions based on blacklists
if they prefer that route to fixing their security assumptions. But the
Tor project isn't going to do it for them.

@_date: 2005-01-03 22:19:02
@_author: Roger Dingledine 
@_subject: Tor network speed 
Actually, it's quite possible that at various times various Tor servers
are saturated -- especially the ones in the lower bandwidth ranges, since
they're presumably used for other stuff as well and they don't have much
capacity to go around.
Weasel's bandwidth graph (
indicates that we're pushing over 100 mbits/s average sustained throughput
over the Tor network, with bursts in the 200-300 mbit/s range.
The Tor software itself has been observed to push 10mbit/s on a given
node, and probably could do more if pressed. So the increased latency
(and decreased throughput) you're seeing is due to the servers your
circuit happened to pick.
Alas, as we try to scale the network to make it more robust and more
secure against various adversaries, we're going to start accepting
more and more slow nodes. This is inevitable, especially if we want
to avoid being such a juicy target for the Bittorrent folks -- see
Some of this slowness is not inevitable. For example, we might later on
allow people to optimize paths through the network so they can choose
for themselves what tradeoff of performance vs privacy they want. Also,
I suspect our process of porting to Win32 is not yet complete, and the
Windows users are still getting a skewed view of what Tor can do. (The
core Tor developers don't use Windows, so we are relying on bug reports
from you folks to know what isn't working correctly yet.)
And finally, I've not given up hope on revamping the Tor innards to give
better quality-of-service to short streams (e.g. ssh) rather than big
streams (e.g. ftp). But that will wait until we've unearthed ourselves
from the latest flood of mails and feature requests. :) And in any case
it probably won't help you get your big web page faster, since it will
look (albeit only briefly) like an ftp stream.
Hope that helps,

@_date: 2005-01-25 18:37:59
@_author: Roger Dingledine 
@_subject: (FWD) Re: Wikipedia Manifesto 
[Forwarding because Adam isn't subscribed to the list from this
address. -RD]
[Btw, Frank unsubscribed from or-talk after Geoff's post, so he is
presumably no longer listening.]

@_date: 2005-01-26 05:49:03
@_author: Roger Dingledine 
@_subject: What happened? 
Sounds good. Sit tight and wait a few weeks, and we'll see what we
can do. :)
Thanks for your patience,

@_date: 2005-01-03 22:26:42
@_author: Roger Dingledine 
@_subject: Tor 0.0.9.1 crashed 
This could be triggered from any number of situations, and it will be
really hard to track down without more information.
Do you have a core file for us, or a back-trace from gdb or something?
If not, can you ulimit -c unlimited so you have one for next time?
What platform are you running on? Are you sure the version was 0.0.9.1?
Can you trigger this behavior? If not, how often does it occur by chance?
Do you have any debug-level logs, by any chance? Can you make some for
us and try to trigger the behavior again?
What are you doing to your Tor socksport to cause this warning
repeatedly? You (or somebody) is connecting to it with some application
that is speaking a protocol other than socks.
This is weird. Dns workers are extra processes we spawn to call
gethostbyname() (that is, do dns resolves), since that function waits to
return until it has its answer, so we can't run it in the main process.
But typically they don't just die for no reason. Are you killing processes
randomly on your machine? :) Are you nearly out of memory? Hm.
I could fix your immediate problem for now by making
dns_cancel_pending_resolve() just return immediately if
!resolve->pending_connections -- but this will mean we'll never find
the bug. :)

@_date: 2005-01-27 01:25:23
@_author: Roger Dingledine 
@_subject: privoxy problem on OpenBSD 
Does just using Privoxy (without Tor) work?
Do the privoxy logs indicate anything different or unusual when you add
Tor into the loop?
It depends how the browser resolves the address. I can imagine some
browsers that don't bother to see if it looks like an IP address first,
and just hand the string "18.244.0.188" to their dns server. If this
dns server lives on a remote machine, then you could have troubles.
Can anybody here speak to how common this is in practice?
Not easily.
When your application speaks socks4 or socks5 (the variant that hands
only an IP to Tor) rather than socks4a, there's no way for Tor to
determine whether the application got that IP safely or not. I'd like
to come up with a better way to do that warning, but I'm not sure how
that should work.

@_date: 2005-01-27 02:34:26
@_author: Roger Dingledine 
@_subject: wikipedia vandalism 
All in all, I think Wikipedia's two-tiered service is a plausible and
fine response to the situation, at least while they're not planning to do
any serious changes in their assumptions. Tor users can _read_ just fine,
which is what most visitors to the site do.
Brandon Wiley describes another option to this whole mess in his blog
at In situations where the service wants to operate with *only* IP
authentication, we can allow banning abusive IPs proportional to the
amount of abuse they produce. If it turns out that the trolls are not
particularly persistent with respect to trolling specifically through Tor,
then we can end up in a better situation than having the whole network
just preemptively banned. Here are a few snippets:
A better solution is temporary random exponential time bans. The key idea
here is that whenever a troll is found, the IP of the troll is banned
temporarily. Each time a ban occurs, the length of the next bans is
increased a random but approximately exponentially larger amount. After
an IP has gone without being banned for a while, the length of the next
future ban is decreased following the same curve until it reaches the
minimum amount.
This approach has a number of advantages over blacklisting all tor
nodes. First of all, it is not specific to tor. This method can be used
on all IPs. It is also automatic. No one needs to manually decide on
the interval that a ban should be. They only need to add IPs to the
ban list. They should also expire automatically. It only punishes
IPs which have actually been used for trolling, instead of punishing
innocent IPs which have committed no offense. Additionally, no IP is
ever beyond redemption. It will always be removed from the blacklist
eventually. In the best case, where no trolls use tor, everything is
eventually unblocked. In the worst case, where trolls use every tor node
to troll as much as they can, every tor node is blocked, which is no worse
than the existing policy of preemptively blocking all tor nodes and better
than that case because if all tor nodes are blocked and the trolls really
want to troll and not attack tor, they will move on to something else.

@_date: 2005-01-27 03:52:09
@_author: Roger Dingledine 
@_subject: 0.0.9.3 and hidden services 
Heh. :)
I only backported a few of the hidden service fixes I made in the 0.1.0
cvs. The cvs code works much better with respect to hidden services
(for me at least), but cvs currently also has only half-implemented
libevent support, so it's unstable for now.
As for the performance problems lately, it looks like there are a lot
of variables going at once. One of them is that we've been having some
churn in the server lists (getting some new servers, losing some old
ones). Another is that it's the end of the month, so some of the nodes
mis-estimated how much bandwidth they'd need for the month and they're
hibernating now. A third is that I think we're seeing a lot more bytes
passed over the network now than, say, a week ago. And finally, as we
added more cable modem and dsl nodes, my bandwidth capacity detection
algorithm is working less well, meaning clients are sent to cable modem
nodes more often than they should for proper load balancing.
So, don't worry, we're still here, but for now Nick and I are working
on design and writing down some of our ideas, in preparation for the
upcoming PET submission deadline ( In the meantime
we are piling up the bug reports at  so they
don't slip through the cracks. We're betting that the Tor network won't
entirely collapse by the time we get back to coding and can start to
address these issues.

@_date: 2005-01-27 04:33:39
@_author: Roger Dingledine 
@_subject: Reusing Exit Nodes? 
Hi Mike,
Sorry about the delay on this. I've been trying to figure out how I
want this to work.
First, check out sec 3.11 of The "mapaddress" functionality is aimed to solve a number of situations:
a) Alice wants to use a .onion or .exit address from a client that doesn't
speak socks4a. For example, we can intercept her gethostbyname() call,
return a fake address like 0.x.y.z, and then inform Tor via the Control
interface that 0.x.y.z should map to the string she asked to resolve.
b) Poor man's VPN. Let's say Alice runs a service somewhere that doesn't
have encryption or authentication -- like telnet. She can set up a
hidden service via Tor to let people connect and get encryption and
authentication, but connections to it will require the extra hassle of
hidden service foo. So instead she runs a Tor server on the same host
(or inside the trusted perimeter of the host), and she configures an
Address Mapping to internally rewrite any request for service.com to
service.com.aliceserver.exit. This gives two benefits: First, her local
applications can connect to it like normal and get end-to-end encryption
and auth for free. Second, we don't break applications that include the
destination address in the application-level. The HTTP "Host" header
is a good example of this -- if you type  in
your Mozilla, then you break Google's virthosting because it only does
its geodns magic if you say Host:  The alternative is to
write an application-level-aware proxy that rewrites the Host: line; yuck.
c) Inside Tor, mapaddress could do exactly what you're looking for here.
If Alice's destination matches certain configured names, or certain ports,
then once she picks an exit node it can establish an addressmap so she'll
pick it again later.
Of course, the controller interface probably needs more data than we
describe in the spec, such as an expiry time and maybe more. It would
probably make sense to implement the Tor side of things, plus being
able to specify it in the Tor config, and then somebody will deal with
configuring it via the controller later.
I think what you've got here is a good start, but I think if we
generalized it to do mapaddress we'd be in even better shape. What do
you think?

@_date: 2005-01-28 04:47:40
@_author: Roger Dingledine 
@_subject: Reusing Exit Nodes? 
When I ask you to resolve 6sxoyfb3h2nvok2d.onion, what IP does this
resolve to?
These special addresses are not in the 'normal' namespace, so we have to
deal with them some other way.
(I assume you mean 'ExitNodes' -- RedirectExit is something else.)
The functionality between AddressMap and ExitNodes would be nearly the
same -- the difference is that ExitNodes affects *all* streams you make,
whereas AddressMap affects exactly the one you want and not the rest.
(Actually, that's not quite true -- new streams will use whatever open
circuit works, and since you recently built one to the specified exit,
that might be the one that's picked. So it *does* affect others. But
not as strongly.)
(Actually, you wouldn't have to restart Tor to change ExitNodes -- you
could do a SETCONF from the controller to change it, and that would be
all it takes.)
Right. Well, the address mapping data structures should live inside
Tor, since that's where they're used.
Speaking of, you might find our string-keyed binary tree handy in keeping
track of addressmaps and hunting through them, so you don't have to do
it linearly. Check out strmap_* in src/common/container.c
It doesn't have to block on the controller. You could implement it
locally with normal config options, so people can individually define some
addressmaps when tor starts, and also so people can define some addresses
or ports (as your patch already does) that will get auto-addressmapped
once they pick an exit. Then the controller stuff could come later.
What do you think? :)

@_date: 2005-01-28 05:52:18
@_author: Roger Dingledine 
@_subject: What happened? 
I think I've tracked one major source of these down: some of the larger
servers have been hitting the 1024 file descriptor limit, and things do
not fail gracefully when that happens.
This is good news, in that the Tor network really is handling tens of
thousands of streams simultaneously. Go us.
But it points to a bigger problem, too. As people continue to use Tor
for long-term connections like IRC and AIM, our big fast servers are
going to get clogged with streams that take up a file descriptor and a
few bytes of memory but not really much else. This is great, except for
some reason file descriptors seem to be considered rare commodities.
The short-term solution is to fix the bugs so when the connection is
refused, a "resource limit" reason is sent back, rather than the "misc
error, close the conn now" which is sent currently. That way the client
can try somewhere else. But if most servers are full most of the time,
performance will still be bad.
We're already in the process of integrating libevent, so we can make use
of epoll, kqueue, and whatever the other snazzy interfaces are that can
poll many file descriptors efficiently.
Can we just ask server operators to pump up their ulimit -n to a couple
hundred thousand? Or will this make people upset.
We could also implement per-port quotas, stop advertising ourselves in
the directory when a certain threshold percent of our file descriptors
are occupied, etc, if this stays a problem.
How do ulimits work on win32, anyway?
Any other suggestions?

@_date: 2005-01-28 07:15:54
@_author: Roger Dingledine 
@_subject: tor eating CPU time 
As near as I can tell it, Tor spends most of its time doing SSL handshakes
with other Tors (either clients or servers).
I don't think anybody has given me profiling output lately (gprof,
oprofile, etc) on a really busy server though. If you wanted to give
that a go and let me know where it spends its time _once it gets to 100%
cpu use_, that would be really handy.
For example, I can imagine a couple situations where it would start
doing linear lookups on a list of circuits that has grown really large --
and it would do such a lookup for each cell that it handles. But until
I know what's going on, trying to optimize everything is just going to
increase complexity.

@_date: 2005-01-04 06:39:45
@_author: Roger Dingledine 
@_subject: Tor 0.0.9.1 crashed 
Perfect. I've found at least one bug here, and fixed it. Hopefully it's
the one you've been seeing. :)
The 0.0.9.2 release simply tolerates the bug and prints out a warning
saying "Bug" (which is still better than triggering an assert and crashing
:). Future releases will actually have it fixed.
The random killing of processes still worries me though, especially as
you say it's happening to other processes too. Perhaps you're having
hardware problems?

@_date: 2005-01-05 03:19:56
@_author: Roger Dingledine 
@_subject: Tor Beginner's Questions 
Local means "from 127.0.0.1 to 127.0.0.1" -- some firewalls seem to block
even these sorts of connections, and people who run them don't tend to
realize they're running them, so it's sort of hard to document for. Any
suggestions on how to fix the wording?
I've just added this answer as
Currently the 'FirewallPorts' config option doesn't support ranges, just
numbers. Is this something we should fix?

@_date: 2005-01-05 04:23:51
@_author: Roger Dingledine 
@_subject: Heavy CPU usage.. normal? 
Check out Several people have reported being quite happy with the cpu load fixes
that are in cvs (but not in the 0.0.9.x series yet). They seem stable
enough that I'll probably try to get them into 0.0.9.3 (whenever it
If that doesn't solve it for you, get our your profiler and tell me
which parts of our code are crummy. :)

@_date: 2005-01-02 01:22:46
@_author: Roger Dingledine 
@_subject: Tor 0.0.9.1 crashes 
This one is fixed in CVS now too, btw.
Thanks for reporting this! I've fixed it in CVS, and it will be in the
0.0.9.2 bugfix release that comes out, uhm, sometime soon (once we've
worked through a few more of the bugs). Let us know if you encounter
any other problems.

@_date: 2005-01-05 10:30:31
@_author: Roger Dingledine 
@_subject: Please verify our OS X installer instructions 
Hi folks,
Thanks to Thomas Hardly, we have some new step-by-step os x installer
instructions: Please take a look at them, and let us know if any of the sentences
or ideas don't make sense, if that's not what you see when you try it,
if other actions ought to have screenshots, etc.

@_date: 2005-01-02 03:07:27
@_author: Roger Dingledine 
@_subject: Proper settings for 'Bandwidth' parameters 
Tor uses a token bucket scheme to do rate limiting:
  Each connection has a token bucket with a specified capacity
  BandwidthBurst. BandwidthRate tokens are added to the bucket each
  second (when the bucket is full, new tokens are discarded.) Each
  token represents permission to receive one byte from the network
  --- to receive a byte, the connection must remove a token from the
  bucket. Thus if the bucket is empty, that connection must wait until
  more tokens arrive. The number of tokens we add enforces a longterm
  average rate of incoming bytes, yet we still permit short-term bursts
  above the allowed bandwidth.
We currently don't rate-limit bytes going *onto* the network, on
the theory that each byte out roughly corresponds to a byte in. This
assumption no longer holds for nodes that open their DirPort though --
this is a known bug, and we hope to get around to fixing it soon by
adding rate-limiting for writes as well. For now, the workaround if you
need one is to leave your DirPort closed.
I've just added this answer to the FAQ as:
In the case of a cable-modem, you typically have much more than 256
kpbs up-rate sometimes, and much less other times, so alas it's not
so clear-cut as we'd like it to be. Let me know if you still have
more questions.

@_date: 2005-01-10 20:30:11
@_author: Roger Dingledine 
@_subject: Hidden service behind NAT? 
If you can get to but not to your hidden service, then I'd suggest leaving it
running and checking it tomorrow. If you can't get to the service
above, then perhaps your configuration is screwed up somehow.
I plan to make hidden services not suck as much in the next release,
but first we need to get all these other bugs sorted out. :)
You don't need to be routable or have any sort of public IP to run
a hidden service. If you can get out to the Internet somehow, you can
offer a hidden service.

@_date: 2005-01-12 17:51:48
@_author: Roger Dingledine 
@_subject: Tor exit nodes by country 
Geoff Goodell has written up a script that lists Tor servers by country;
annotates them based on bandwidth, whether they're verified/unverified,
and whether they're reachable now; and parses out the exit policies so
you know which server will connect to what services.
If you want to ask about specific ports, you can do something like:
(Your Tor client already parses all of this internally and picks
appropriate exit nodes for your destination IP and port -- so at this
point this is just a more visual representation of the network.)

@_date: 2005-01-13 15:35:01
@_author: Roger Dingledine 
@_subject: (FWD) Using Tor with IRC/Chat clients 
[Fwding to the list because Andrew isn't subscribed. Andrew, please post
next time from an address that is subscribed. -RD]
Andrew: Right, Privoxy only deals with HTTP. Your other applications are
presumably speaking some other protocol.
Can somebody here answer the question about sockscap?

@_date: 2005-01-13 15:50:12
@_author: Roger Dingledine 
@_subject: Tor exit nodes by country 
The HiddenServiceNodes config option is not intended to be needed
by everyday people. It's more a novelty/testing option. Tor should
automatically pick appropriate intro points and make everything work.
It will do this, uhm, soon. :)

@_date: 2005-01-13 15:52:22
@_author: Roger Dingledine 
@_subject: Tor exit nodes by country 
So far we've figured ExcludeNodes is good enough for this situation. If you
really need more fine-grained control, please submit a patch. :)

@_date: 2005-01-15 17:32:35
@_author: Roger Dingledine 
@_subject: Hardware requirements for a tor server 
Hi Jens,
This should be plenty of hardware for a Tor server.
Note that most of the cpu use comes from handling lots of clients,
so by scaling back your bandwidth use (e.g. by setting BandwidthRate),
you'll also be scaling back your advertised bandwidth capacity and thus
your cpu requirements.
Giorgos is sort of a special case -- his server has a particularly open
exit policy, so it gets picked more often than others. (This is good --
we need more people willing to exit to most ports.)
Does that help to answer your question? Usually as long as you've got
200-300mhz you should be all set.

@_date: 2005-01-15 17:36:08
@_author: Roger Dingledine 
@_subject: tor_resolve 
Weird. This was a bug in 0.0.9.1 but (I thought) we fixed it in
0.0.9.2. Are you sure you're running the new version?

@_date: 2005-01-15 18:55:37
@_author: Roger Dingledine 
@_subject: ports 
In your torrc, you can set your ExitPolicy
lines. See the man page ('man tor', or our html version at
 ) for more
You are refusing all exit connections from your node. This is a fine
approach, but of course, if you're ok with letting some connections
exit, that would be more useful for the network. :)
tor-ops has no gpg key; it's just an alias. I've answered the rest of
this in private mail.

@_date: 2005-01-03 19:09:49
@_author: Roger Dingledine 
@_subject: Potential attack by associating onymous & anonymous traffic 
Yes, this is a potential problem. Tor tries to find a balance between
opening a new circuit for every TCP stream (slow and cpu-intensive)
and using the same circuit for all your streams. More generally, Tor
does not yet support "pseudonyms" as the old Freedom network (from
Zero-Knowledge Systems) did.
I'm not sure of the right interface for doing this. Perhaps Tor should
have some config options for various ports or IPs that should never be
used on the same circuit? Maybe the GUI interface should have a set
of profiles that you can click on, and Tor will make sure never to use
a stream from one profile on the same circuit as a stream from another
To some extent you're screwed, because your various profiles will only
be active when Nick Nolan is online, and never otherwise. But Tor can
certainly improve a great deal from where it is currently.
Nick, would you like to help specify and/or build this stuff? We've got
our hands full for now just building the basic anonymous transport layer,
without dealing with pseudonymity yet. I'll add support for it in the
back-end if you figure out how to display it to the user and how to
phrase it in the config.

@_date: 2005-01-17 16:18:09
@_author: Roger Dingledine 
@_subject: tor and xp debugging 
You gave us no information about what the crash was, what you were
doing at the time, any log messages it spit out, etc.
Please check out

@_date: 2005-01-18 22:58:12
@_author: Roger Dingledine 
@_subject: tor and xp debugging 
Alas, I don't think this part applies to Win32. I've asked here earlier
if Win32 has any sort of stack-level debuggers, and nobody seemed to
have an answer. Is that still true?
Note the "-l" vs "-1". Perhaps they look the same on your screen. :)

@_date: 2005-01-19 02:34:15
@_author: Roger Dingledine 
@_subject: (FWD) Problems with Tor in user-mode-linux 
[Forwarding since Bernhard isn't on the list, and should have sent
it to or-talk in any case. -RD]
As for why the Tor in CVS may not work, there are known bugs with 2.5/2.6
kernels, epoll, and the new libevent stuff. We're working on those.
As for why Tor 0.0.9.2 memory explodes in user-mode-linux, gosh, I
don't know. Does user-mode-linux not give back memory that's freed?
Is this running as a client or a server? I assume server, since you
have multiple tor processes.

@_date: 2005-07-02 22:02:00
@_author: Roger Dingledine 
@_subject: spawn_enough_dnsworkers 
Great. I just added a FAQ entry to try to start answering these:
By "after this", do you have a sense of how long after that log entry
the Tor process died? I still claim it's a coincidence. :)
The next step is probably to try to get a core file. Also, you should
check the output of "dmesg" to make sure your out-of-memory-killer isn't
in action.

@_date: 2005-07-25 04:42:10
@_author: Roger Dingledine 
@_subject: Confirm new Tor server working? [SOLVED] 
Great. Except,
% telnet 64.36.3.34 9001
Trying 64.36.3.34...
telnet: connect to address 64.36.3.34: Connection refused
Looks like it's still refusing connections?
See the man page, or Something like "200 KB" goes in the 'what goes here', to mean 200
kilobytes per second.
No, you can't move that down. 200 is a small number really; many servers
use 1024 or more. Are connections a limited resource for you somehow?

@_date: 2005-07-25 16:15:38
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.3-alpha is out 
This is the third development snapshot for the 0.1.1.x series. It fixes
a crash bug with hidden services, an assert trigger in the controller,
and a few other controller bugs.
  o Bugfixes on 0.1.1.2-alpha:
    - Fix a bug in handling the controller's "post descriptor"
      function.
    - Fix several bugs in handling the controller's "extend circuit"
      function.
    - Fix a bug in handling the controller's "stream status" event.
    - Fix an assert failure if we have a controller listening for
      circuit events and we go offline.
    - Re-allow hidden service descriptors to publish 0 intro points.
    - Fix a crash when generating your hidden service descriptor if
      you don't have enough intro points already.
  o New features on 0.1.1.2-alpha:
    - New controller function "getinfo accounting", to ask how
      many bytes we've used in this time period.
    - Experimental support for helper nodes: a lot of the risk from
      a small static adversary comes because users pick new random
      nodes every time they rebuild a circuit. Now users will try to
      stick to the same small set of entry nodes if they can. Not
      enabled by default yet.
  o Bugfixes on 0.1.0.12:
    - If you're an auth dir server, always publish your dirport,
      even if you haven't yet found yourself to be reachable.
    - Fix a size_t underflow in smartlist_join_strings2() that made
      it do bad things when you hand it an empty smartlist.

@_date: 2005-07-03 07:17:54
@_author: Roger Dingledine 
@_subject: No intro circ found for INTRODUCE1 
Section 0.2 of  shows the
steps for a hidden-service rendezvous. Basically what has happened
here is that somebody established an introduction point at your server,
advertised this fact, and then disappeared. People who want to get to
his hidden service will try your intro point, and since the circuit he
established to you is gone, all you can do is tell people (in step 8)
that you didn't introduce them to anybody.
If the guy comes back, he will establish new introduction points and
upload a new descriptor telling people about them. If not, the hidden
service descriptor will expire after REND_CACHE_MAX_AGE seconds (currently
48 hours).
But you raise a good point -- there's no need to be squealing to the
server operator whenever this happens. Now that I'm pretty sure this whole
rendezvous thing works, I should make the server just quietly do its job.
I'll try to tone down the rendezvous-related warns and notices in 0.1.1.x.

@_date: 2005-07-03 07:23:16
@_author: Roger Dingledine 
@_subject: Is exit policy broken? 
No, definitely not. Good catch -- this is a serious bug. We've put out
a 0.1.0.11 release that fixes this. All servers should now be running
either 0.0.9.10, 0.1.0.11, or latest CVS.

@_date: 2005-07-03 07:32:40
@_author: Roger Dingledine 
@_subject: Sniffing OR-OR connections by rerouting them 
Hey, this is a nice bug. Thanks for finding it, dvorak.
I think this is probably the way to go. Once the connection is
established, Alice should send a cell indicating what IP:port she thought
she was connecting to. If Bob thinks this is scary, he can hang up.
Having Bob make these decisions is better, since we can make Bob smarter
down the road about what locations are acceptable, and Alice never has
to care.
I'm going to try to resist adding the 'currently acceptable alternative'
business, since most of the time everybody should have it right in the
first place, so this will be a rarely used feature that just adds bulk
(and risk) to the design. But if it turns out we need it, we can add it.

@_date: 2005-07-04 01:01:50
@_author: Roger Dingledine 
@_subject: spawn_enough_dnsworkers 
Ok. I've added a sixth section to
More verbose logging will hopefully track things down a bit closer.
How long does it typically take before it dies?
You should also switch to running Tor in the foreground, so when it
dies you will see what happens.

@_date: 2005-07-06 11:08:30
@_author: Roger Dingledine 
@_subject: I'm seeing someone else's localhost.localdomain 
Right. What's actually happening in this case is that you ask the remote
side to resolve "pgsql.localhost.localdomain" for you, and the first few
people probably tell you "gosh, I have no idea", and then you hit upon a
Tor server with a busted resolver. That is, it resolves every hostname
it doesn't recognize to 127.0.0.1. Then it probably sends back a "but
my exit policy doesn't let me get to that" message. Your Tor client,
now equipped with the correct IP address for this hostname, then looks
through its directory for a Tor server that allows exit to 127.0.0.1:80,
and makes its next circuit exit from that server.
Hey, these folks opened *:80 on their servers. They get warns when they
start Tor, if they didn't explicitly ask to accept 127.0.0.1:80.
In all cases I've seen so far, you can get exactly the same page by
going to port 80 of their public IP address. So I'm not too worried.
There's a todo item on tor.eff.org/volunteer.html which asks if anybody
wants to track down what is causing the "I think I'll resolve everything
to localhost" bug. I presume it's default behavior on some broken OS
out there, likely Win32 or OS X. Anybody?

@_date: 2005-07-12 19:26:19
@_author: Roger Dingledine 
@_subject: Soekris VPN-1401, OpenSSL,OpenBSD and TOR 
Great. Our most recent alpha release has some support for hardware
crypto accelerators:
but it's untested because we don't own any. Please test. :)
This is mainly the public key stuff currently, if I understand
Our AES implementation is software-only and ships with Tor currently
though. This is because when we started, most openssl's didn't have
AES. In fact, many of them still don't. It's on our todo list to start
using the openssl AES implementation if available, so we can take
advantage of hardware accelerators if present. Feel free to step up
and send us a patch for this, if you want it to happen quicker. :)

@_date: 2005-07-12 19:32:39
@_author: Roger Dingledine 
@_subject: Slashdot Article on Tor 
I've finally put the finishing touches on our Tor Abuse FAQ
and posted it on the site:
Hopefully this will help combat FUD.

@_date: 2005-07-12 19:48:46
@_author: Roger Dingledine 
@_subject: Tor server crashing all the time 
See the fourth bullet point of the "Fifth," paragraph.
Was there ever any actual crashing involved? Or does it just not work,
because your ulimit -n is incredibly low?

@_date: 2005-07-15 03:37:55
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.2-alpha is out 
This is the second development snapshot for the 0.1.1.x series. It fixes
a seg fault in the controller handling, plus a few other bugs.
  o New directory servers:
    - tor26 has changed IP address.
  o Bugfixes on 0.1.0.x, crashes/leaks:
    - Port the servers-not-obeying-their-exit-policies fix from
      0.1.0.11.
    - Fix an fd leak in start_daemon().
    - On Windows, you can't always reopen a port right after you've
      closed it. So change retry_listeners() to only close and re-open
      ports that have changed.
    - Fix a possible double-free in tor_gzip_uncompress().
  o Bugfixes on 0.1.0.x, usability:
    - When tor_socketpair() fails in Windows, give a reasonable
      Windows-style errno back.
    - Let people type "tor --install" as well as "tor -install" when
      they
      want to make it an NT service.
    - NT service patch from Matt Edman to improve error messages.
    - When the controller asks for a config option with an abbreviated
      name, give the full name in our response.
    - Correct the man page entry on TrackHostExitsExpire.
    - Looks like we were never delivering deflated (i.e. compressed)
      running-routers lists, even when asked. Oops.
    - When --disable-threads is set, do not search for or link against
      pthreads libraries.
  o Bugfixes on 0.1.1.x:
    - Fix a seg fault with autodetecting which controller version is
      being used.
  o Features:
    - New hidden service descriptor format: put a version in it, and
      let people specify introduction/rendezvous points that aren't
      in "the directory" (which is subjective anyway).
    - Allow the DEBUG controller event to work again. Mark certain log
      entries as "don't tell this to controllers", so we avoid cycles.

@_date: 2005-07-15 15:03:25
@_author: Roger Dingledine 
@_subject: tor 0.1.0.11 crash on Debian testing 
Nice one. I've fixed this in cvs, and the fix will be included in
0.1.0.12, when it comes out. (I'm going to wait a bit longer, since I
don't think this is a critical bug, and crying wolf too many times with
updates to the stable tree can be bad. :)

@_date: 2005-07-19 20:45:08
@_author: Roger Dingledine 
@_subject: question 
So just so I understand correctly, you run a program (virus checker)
that intercepts all network traffic and looks for bad stuff? When it
finds the bad stuff, it saves it to a file somewhere?
Is there any indication that you were actually infected? Or are you just
wondering about why an infected file passed through your network?
Please note that this may be bad for the security of Tor and
its users. Plus, there may be legal liability questions here; see
I'm working with the EFF lawyers to see if they can provide a more
detailed answer to this question, even though the laws in the US are
currently very ambiguous.
Sure. Is this a problem? We expect all users to have ways on their own
of dealing with viruses, for example by not running software that is
vulnerable to them.
Yes; see
Hope this helps,

@_date: 2005-07-20 15:00:26
@_author: Roger Dingledine 
@_subject: question 
Does it only change packets going to port 80?
It might be that you only need to remove a few ports from your exit

@_date: 2005-07-20 15:51:08
@_author: Roger Dingledine 
@_subject: Tor SwitchProxy howto 
Hi folks,
I've written up a howto for using the SwitchProxy Firefox plugin
with Tor. If you're using Firefox, I very much recommend this.
It's got screenshots and everything, thanks to Robyn Wagner.
Please give it a whirl and let me know:
a) if you can't get it working;
b) if any parts are confusing;
c) if you think I should change or add anything.

@_date: 2005-07-02 20:47:34
@_author: Roger Dingledine 
@_subject: tor and Daemantools-0.76 
Do you get cores? Do you get assert failures? Please spend a few moments
to provide a bug report if you have any hints.
Also, please please please put a sleep(100) in your script somewhere.
We had a bug a while ago where people would start their Tor, it would
suck down a directory, kill itself, restart, suck down another directory,
repeat. This was not good for our volunteer's bandwidth. :)
Is your instability based on the fact that a 3.5MB data segment is
incredibly too small to run a Tor server? You want another one or two
orders of magnitude more than this.

@_date: 2005-07-22 05:43:25
@_author: Roger Dingledine 
@_subject: (FWD) Re: chaining JAP and Tor 
[Forwarding because Sascha isn't subscribed at this address. Sascha,
please post from an address that's subscribed, or subscribe with the
address you're posting from. -RD]

@_date: 2005-06-11 04:17:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.9-rc is out 
Hey, nice bug.
Try this one:
Does it work better for you?

@_date: 2005-06-12 23:02:56
@_author: Roger Dingledine 
@_subject: Problems with TOR & FreeBSD 
Hi Warren,
We found this bug (in libevent), and the new libevent 1.1a that
Niels put up today should hopefully address it:

@_date: 2005-06-12 23:35:03
@_author: Roger Dingledine 
@_subject: port scanning increase 
I've just added a FAQ entry with two answers:
Let us know if you know of more. :)

@_date: 2005-06-14 17:20:45
@_author: Roger Dingledine 
@_subject: (FWD) 0.1.0.9 SRPM Build Error 
[Forwarded since Robin isn't subscribed at this address. Patches to our
rpm spec file are happily accepted, to make it work on whatever the below
OS is but also still on Red Hat. Bonus points if it ends up working on
Mandrake too. Grand prize if you want to take over maintaining the spec
file. ;) -RD]

@_date: 2005-06-17 17:27:16
@_author: Roger Dingledine 
@_subject: upgraded server not responsive? 
Well, the problem was that you upgraded your server and changed its key.
Check out
for instructions on how to upgrade and continue using the old key.
What you're seeing now -- the fact that your server isn't listed --
is because of 0.1.0.10's automatic self-reachability detection. Your
server is trying to build a circuit in the Tor network back to itself
to see if it can, and because it's suddenly using a new key, and all
the other servers out there know about the old key, nobody is willing
to believe this new key, so they refuse to connect.
This means your server won't be able to find itself to be reachable
until the old descriptor disappears from the directory, which will be
about 24 hours after it was last published.
At that point your server will discover it is reachable (if I don't have a
bug ;), and it will begin publishing a server descriptor with the new key.
Hope this helps,

@_date: 2005-06-17 17:29:42
@_author: Roger Dingledine 
@_subject: ISP Cutoff 
Are you sure it isn't just a stability problem with your router? People
are quick to assume that everybody is out to censor them, when often
nobody is paying attention at all. :)
(The rate limiting option will help with instability problems too.)

@_date: 2005-06-17 21:54:05
@_author: Roger Dingledine 
@_subject: (FWD) Re: ISP Cutoff 
[Forwarding because mozbugbox is not subscribed to the list. -RD]

@_date: 2005-06-20 14:39:19
@_author: Roger Dingledine 
@_subject: (FWD) Re: Please review new control-spec.txt 
[Forwarding since Sebastian isn't subscribed at this address. -RD]

@_date: 2005-06-21 04:21:04
@_author: Roger Dingledine 
@_subject: False warning(?) and logging 
According to the code, it wants it to be 172.16.0.0/12.
If this is the correct subnet (is it?), then we should probably make
the log entries clearer about this. Thanks for pointing it out.
The problem is that those log entries happen before the log file is
configured. This is on our list of stuff to deal with in 0.1.1.x, but
some of them are hard to get the order right for, since that warning
happens before you act on your config options, meaning before you've
opened the logs. Hm.
No, this is fine. With 0.1.0.x, when that notice happens, it immediately
goes to try to fetch another one; so unless it happens constantly for an
extended period of time, it's fine.

@_date: 2005-06-21 15:54:09
@_author: Roger Dingledine 
@_subject: Access for the uncomputed 
[I'm forwarding this thread to the or-talk list, since this is probably
the better place for it. -RD]
Right, Tor servers (and heck, Tor clients) can do this by opening their
socks port to the world. Then people can use their node as a socks
proxy without needing any special software. But note that they'll be
communicating unencrypted, and they'll also be at the mercy of the proxy
they choose. But such is life when you don't run our software yourself.
Well, if you open a socks proxy, then some proxy scanners will conclude
that you are an open socks proxy ("since they can handshake with you,
clearly your IP address allows arbitrary outgoing connections"), and
put your IP address on blacklists. This will make it harder for you to
connect to some IRC servers, and who knows what else those blacklists
might be used for now or down the road.
Right. There are lots of ways we could do this. We should keep in mind
that all the reasonable ways will involve letting the blacklisters easily
enumerate them too.
Ah, so this would mean not just letting people connect via socks, but
also running a web proxy that points to a Tor. This is easy enough --
just run Privoxy and open up *its* port to the outside world. But that
won't get you encryption either.
So you want some sort of interface like anonymizer's, where there's a
web site you can SSL to and it will let you type in a URL that it will
load for you?
Anybody want to work on one of these? :)
Or better, tell us how to make a smoother and more transparent interface
for this? Perhaps  ?
Bonus if it supports .onion and .exit addresses.

@_date: 2005-06-21 18:49:10
@_author: Roger Dingledine 
@_subject: Access for the uncomputed 
Oh hey, and Patrick Coleman runs a Tor server too:
Patrick, how is this going? It looks like Tor can replace the more
ambitious part of your project, but step one is still a hard task to
get right too. :)
It looks like it's GPL, which is good. But it looks like it breaks
stylesheets of the pages it downloads (e.g. tor.eff.org), which is
bad. What about SSL to the proxy page? Does it have a back-end that can
http-proxy to privoxy, and/or socks4a-proxy to Tor?
Is this still in development, or should I take the "Copyright 2003"
to be a bad sign? :)

@_date: 2005-06-22 17:11:20
@_author: Roger Dingledine 
@_subject: tor-resolve 
We need a better reason than this. ;)
Currently we have no plans to do any of this in the near future.
I'm not convinced the increased complexity would be worth it.
In the meantime, try forcing your resolver to use TCP, and then
connect to a DNS server via Tor and make your requests that way.

@_date: 2005-06-23 04:01:51
@_author: Roger Dingledine 
@_subject: spawn_enough_dnsworkers 
Unreachable? From the log you pasted, it seems like it's doing fine.
Typically "notice" level logs are not errors, but just things for you
to keep in mind or things for you say "hmmm" if they start showing up
many times a second. Check out the code, in src/or/dns.c: (hope this
helps -- you can just look at the comments, no need to worry about the
syntax details)
 * \file dns.c
 * \brief Implements a farm of 'DNS worker' threads or processes to
 * perform DNS lookups for onion routers and cache the results.
 * [This needs to be done in the background because of the lack of a
 * good, ubiquitous asynchronous DNS implementation.]
 **/
 MAX_IDLE_DNSWORKERS 10
 */
static void
  int num_dnsworkers_needed; /* aim to have 1 more than needed,
                              * but no less than min and no more than max
                              */
  while (num_dnsworkers > num_dnsworkers_busy+MAX_IDLE_DNSWORKERS) {
    /* too many idle? */
    /* cull excess workers */
    log_fn(LOG_NOTICE,"%d of %d dnsworkers are idle. Killing one.",
           num_dnsworkers-num_dnsworkers_needed, num_dnsworkers);

@_date: 2005-06-23 14:46:50
@_author: Roger Dingledine 
@_subject: (FWD) RE: Tor as windows service 
[Forwarding because this particular Bob isn't subscribed to or-talk. -RD]
Behalf Of Pat Frank
Sent: Thursday, June 23, 2005 8:08 AM
When I did this all I had to do was copy the torrc file into c:\program
files\tor and run the command.
But I was logged in as administrator.  I see Martin earlier today asking
about running the service as NON-administrator.  My guess would be that the
command would fail in some way, perhaps as described by Bradley (or is that
Martin on another computer?).
Behalf Of Bradley
Sent: Thursday, June 23, 2005 12:11 AM
I cant seem to get my service working correctly. I followed the instructions
in the wiki, but it always seems to crash and get an error when the service
tries to start ("Could not start the service tor win32 on Local Computer -
Error 0xffffffff: 0xffffffff").. seems to work fine from the command line
though. Im running WinXP Corp...

@_date: 2005-06-23 17:51:19
@_author: Roger Dingledine 
@_subject: NTLM proxy support needed 
It looks like the best answer is for you to run this ntlmaps thing
locally as an http and https proxy to convert the basic auth that Tor
expects to your local proprietary format.
With luck, Tor doesn't need to do anything different at all.

@_date: 2005-06-25 16:27:14
@_author: Roger Dingledine 
@_subject: (FWD) ORPort Unreachable Warning & NMAP Invisibility 
[Forwarding because Robin isn't subscribed from this address. okapi Tor
server has not published its descriptor yet, because it doesn't think
that it's reachable. This isn't a spurious warning -- your second point
below indicates some sort of firewalling still in place? -RD]

@_date: 2005-06-26 16:19:44
@_author: Roger Dingledine 
@_subject: Installation problem (fingerprint, could not bind to port 9050) 
This won't make you doubly sure on OS X -- if you installed from
the package, Tor starts at boot.

@_date: 2005-06-29 15:27:33
@_author: Roger Dingledine 
@_subject: spawn_enough_dnsworkers 
Ok, I think the spawn_enough_dnsworkers log entry is just a coincidence.
The real problem is that your Tor process is crashing unexpectedly and
without any log entries to indicate what's going on.
Perhaps you are running a buggy version of libevent? You need at least
libevent 1.1 on Linux, and 1.1a on *BSD.
(Are these problems still happening for you, or did they go away?)

@_date: 2005-06-29 15:45:39
@_author: Roger Dingledine 
@_subject: Question about the real traffic pattern to Tor nodes 
I would guess the traffic pattern is very different. They use email or
other block messages, and we use TCP streams. Note that Tor doesn't mix,
batch, etc, other than the coincidental mixing that happens from our
round-robin approach for reading from the network.
An actual study here is complicated by the fact that, at least in the
US, the laws about looking at other peoples' traffic are very fuzzy.
See  for a few more details.

@_date: 2005-06-29 17:28:13
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.1-alpha is out 
This is the first development snapshot for the 0.1.1.x series. The main
change is a revised controller protocol (version 1) that uses ascii
rather than binary. Also, if you have a hardware crypto accelerator,
please tell us whether it works with Tor now.
  o Bugfixes:
    - Make OS X init script check for missing argument, so we don't
      confuse users who invoke it incorrectly.
    - Fix a seg fault in "tor --hash-password foo".
    - Fix a possible way to DoS dirservers.
    - When we complain that your exit policy implicitly allows local or
      private address spaces, name them explicitly so operators can
      fix it.
    - Make the log message less scary when all the dirservers are
      temporarily unreachable.
    - We were printing the number of idle dns workers incorrectly when
      culling them.
  o Features:
    - Revised controller protocol (version 1) that uses ascii rather
      than binary. Add supporting libraries in python and java so you
      can use the controller from your applications without caring how
      our protocol works.
    - Spiffy new support for crypto hardware accelerators. Can somebody
      test this?

@_date: 2005-06-30 18:27:47
@_author: Roger Dingledine 
@_subject: Is exit policy broken? 
Which Tor server is this?
Which version of Tor?
Are you sure it is running with the exit policy you described? That
is, you restarted (or hupped) it after changing the torrc.
Is your DNS server always returning an IP for slashdot.org that's
within the range in your line above, or is it (sometimes) returning some
other IP?
Does this behavior show up for you with earlier versions of Tor too?

@_date: 2005-06-30 19:03:22
@_author: Roger Dingledine 
@_subject: (FWD) Re: Howto compile Tor on a windows system 
[Forwarding because this particular Ben Blount isn't subscribed to the
list. (Ben, you should post from a subscribed address.) I've just added
an answer to Ben's question here:
Hope that helps -RD]

@_date: 2005-06-01 10:18:57
@_author: Roger Dingledine 
@_subject: Banned from Slashdot 
Hi Jamie,
I'm out of the country now so not so good connectivity, but I have a
couple of questions for you before we try to figure out how to resolve
1) Can you give us a better indication of the abuse you're talking about?
Is it people posting garbage comments and it's hard to filter them all
out? Is it people accessing your site a lot and you don't want to serve
that many web pages? Etc.
1') Note that we have something like 50,000 concurrent users now. Are you
sure that what you're seeing is not just a whole lot of users? Recall
that you just had a slashdot article about Tor, so we've presumably
added the sort of users recently who read slashdot rss fanatically.
2) What do you do about the fact that people can read, and post, via the
more than a million open proxies out there? Do you just not see this in
practice so far so it's not so big a problem for you? Or have you given
up on that but you're still hopeful to deal with Tor?
3) Do you see any obnoxious posts (or massive rss fetching) from,
e.g. AOL? Tor is not unique in the property of aggregating a lot of users
behind a few IP addresses. Have you had to deal with that yet? How do
you respond?
This is tricky to do from a technical standpoint, a) because we need to
teach Tor about protocols and how to reach into the application-layer
stream, and b) because Tor clients would need to predict what the
application was going to do before it does it, in order to pick an exit
node that will allow the operation. We'd like to consider implementing
something like this down the road but it seems hard to get right without
adding a lot of complexity (which is bad for security systems).
The above paragraph is a quote from
also check out
We're working with wikipedia now to ultimately have them tag
posts as being from Tor users, which I suppose will help them filter.
(Wikipedia also already has problems with AOL users, so we're also
going to try to help them improve their authentication model enough
that they don't need to permanently block AOL periodically.)
The Freenode IRC network already does this tagging:
and this measure has made them happy with the number of contributing
Tor users compared to the abuse potential.
Actually, we refuse port 25 by default just for image. When people ask
"what about spam?", the real answer is that spammers are doing *great*
already, they absolutely don't need Tor and it would be a hassle for
them to set things up and use it, compared to what they already have.
But you're right, it's a far easier answer to just say "Tor can't
do that."
Right, you're correct that more and more protocols are being
transported over port 80 these days. Indeed, people who block certain
ports *encourage* this behavior -- check out how Kazaa hunts around for
ports it can use, or how people behind corporate firewalls tend to tunnel
everything out. Heck, Tor itself is showing that making decisions based
on IPs and ports is not so useful as it once appeared.
But Tor ought to remain protocol-neutral for the technical reasons I
describe above; and it's also handy for legal/liability questions.
Programmers *already* need to build in protections from people who use
open proxies, who use DHCP accounts, who come in over AOL. Tor is not
introducing any new problems here. The software packages that let you
sort and filter posts, do collaborative filtering, tag certain incoming
posts as suspicious and needing human approval, etc, are going to be
more effective in the face of these various attacks.
I think we're likely to produce a complex (and thus insecure) system if
we go down this path -- remember that what you're describing is just a
first step in the arms race, and that plenty of other systems out there
work fine for abuse and wouldn't have these measures. So having us add
this is not going to solve your problem.
Right; it's a user-editable wiki-faq. Please change it to be more
polite. :)
( You will need to login to edit the faq, due to wiki-spam
issues; you might find a suitable user/pass at the top of
 )

@_date: 2005-06-08 02:13:15
@_author: Roger Dingledine 
@_subject: Anonymous/Nonymous Communication Coexisting? 
You could do this with privoxy, at least for web browsing.
Check out the forward-socks4a section of the privoxy config, and
hopefully it isn't so hard to craft a line where *.onion traffic goes
via the socks4a proxy and other traffic goes directly out from privoxy.

@_date: 2005-06-08 14:48:04
@_author: Roger Dingledine 
@_subject: Stable Tor Debian package poor performance. 
Yeah, it's not Debian's fault. Right now Tor 0.1.0.x is much faster but
not quite as stable as Tor 0.0.9.x. We're trying to resolve the last
few issues so we can throw away the 0.0.9.x series entirely. Give us a
few more days. :)
New debs will presumably follow.

@_date: 2005-06-09 04:42:34
@_author: Roger Dingledine 
@_subject: Exit policies by site? 
Sure, you can accept or reject by IP address or net block, as well as
by port. See the ExitPolicy entry in the man page for details (a copy
is at (You can't do it by fqdn, because most Tor clients will ask for
destinations by IP address, and it's impossible to know whether
*.badsite.com matches a given IP address or not.)

@_date: 2005-06-09 06:39:09
@_author: Roger Dingledine 
@_subject: IRCNet abuse 
If certain IPs and ports are blocked externally, e.g. by your firewall,
you should update your exit policy to reflect this. (Good point, I'm
going to add this note into the torrc.sample.)
There is no way (I think?) for Tor to discover it, since it can't tell the
difference between failure to connect and a problem with the site itself.

@_date: 2005-06-09 20:15:20
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.9-rc is out 
This is the ninth release candidate for the 0.1.0.x series. This release
fixes some memory bloating, disables threads on Solaris, and includes
some important security fixes for Win32.
This is the one, I can feel it!
(We have one bug left, which is some weird behavior with FreeBSD and
libevent 1.1. Let us know if you're experiencing these crashes too.)
  o Bugfixes:
    - Reset buf->highwater every time buf_shrink() is called, not just on
      a successful shrink. This was causing significant memory bloat.
    - Fix buffer overflow when checking hashed passwords.
    - Security fix: if seeding the RNG on Win32 fails, quit.
    - Allow seeding the RNG on Win32 even when you're not running as
      Administrator.
    - Disable threading on Solaris too. Something is wonky with it,
      cpuworkers, and reentrant libs.
    - Reenable the part of the code that tries to flush as soon as an
      OR outbuf has a full TLS record available. Perhaps this will make
      OR outbufs not grow as huge except in rare cases, thus saving lots
      of CPU time plus memory.
    - Reject malformed .onion addresses rather then passing them on as
      normal web requests.
    - Adapt patch from Adam Langley: fix possible memory leak in
      tor_lookup_hostname().
    - Initialize libevent later in the startup process, so the logs are
      already established by the time we start logging libevent warns.
    - Use correct errno on win32 if libevent fails.
    - Check and warn about known-bad/slow libevent versions.
    - Pay more attention to the ClientOnly config option.
    - Have torctl.in/tor.sh.in check for location of su binary (needed
      on FreeBSD)
    - Correct/add man page entries for LongLivedPorts, ExitPolicy,
      KeepalivePeriod, ClientOnly, NoPublish, HttpProxy, HttpsProxy,
      HttpProxyAuthenticator
    - Stop warning about sigpipes in the logs. We're going to
      pretend that getting these occassionally is normal and fine.
    - Resolve OS X installer bugs: stop claiming to be 0.0.9.2 in
      certain
      installer screens; and don't put stuff into StartupItems unless
      the user asks you to.
    - Require servers that use the default dirservers to have public IP
      addresses. We have too many servers that are configured with private
      IPs and their admins never notice the log entries complaining that
      their descriptors are being rejected.
    - Add OSX uninstall instructions. An actual uninstall script will
      come later.

@_date: 2005-03-21 05:33:48
@_author: Roger Dingledine 
@_subject: (FWD) Dynamic DNS Voodoo Documentation - Draft 
[Forwarding because Eddie isn't subscribed to the list under this address;
Eddie, would it make sense to put this document onto the Wiki so others
can touch it up? -RD]

@_date: 2005-03-26 08:36:36
@_author: Roger Dingledine 
@_subject: Question about torrc in Windows 
In theory, the win32 installer puts a link to the torrc in your startup
button. So you never need to care about where the torrc is; you can just
edit it anyway.
Does this not work? How can we make it clearer that it's there, or easier
to use, or whatever we're not doing?

@_date: 2005-03-26 09:13:08
@_author: Roger Dingledine 
@_subject: h07onion shut down by isp 
Hi Stephan,
Thanks for letting us know. I'm sorry to hear about the gross
incompetence. :( Let me know if there's anything I can do to help.
I took a moment to set up a wiki page, so we can start to record issues
like this:
If you run/ran a Tor server and have something to say about your ISP,
please consider adding it to the page. In my ideal world we'll start
building up a set of good ISPs as well as bad ones. :)
Due to automated wiki spam issues, you will need to log
in to edit the page; look for instructions at the top of

@_date: 2005-03-26 09:39:47
@_author: Roger Dingledine 
@_subject: silky and tor 
I'm not sure about the particulars of silky and
Tor, but you should be aware that the SILC protocol
encodes your IP in its packets. See e.g. section 3.1 of
 and section 2.4
of Perhaps a SILC scrubber is in order? I haven't looked at the protocol
in detail; there might be more to it than that.

@_date: 2005-03-26 09:43:01
@_author: Roger Dingledine 
@_subject: (FWD) OS/X Installer 
[I'm forwarding because Eddie isn't subscribed to the list under this
address. Eddie: please either subscribe with this address, or post from
the subscribed address. -RD]

@_date: 2005-03-27 20:03:26
@_author: Roger Dingledine 
@_subject: Limit number of TCP connections? (2) 
Hi Ron,
Thanks for letting us know. This max-sockets problem has been
bugging us on Windows for a while now.
Here are some more hints:
When you set the registry entry for MaxConnections, did you set it as
a string or a dword? Apparently it has to be a string on 98/ME but a
DWORD on 95.
I'm also told you need to reboot after changing your registry entry.
It's possible that 256 is still too small for what you're trying to do;
have you tried, say 1024 or 2048? Note that this max is apparently shared
by every application running.
Looks like NT/XP/2000 is doing fine in terms of max connections, it's
just 95/98/98SE/ME that are based on DOS and intended for a single human
running only client apps. That probably helps explain why some win32
people have been doing fine: they're running NT.
Check out  for
more discussion of this bug and some other approaches for dealing with it.

@_date: 2005-03-28 21:52:13
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.1-rc is out 
This is the first release candidate for the 0.1.0 series. (See
 for an
explanation of our new version scheme.) Please report any bugs, either
in the installers or in Tor operation, so we can get it perfect for an
actual release: This release incorporates automatic reachability testing for servers (the
first step to getting rid of the 'verified servers' notion), uses pthreads
if available to reduce server memory footprint, uses libevent so we can
use better polling interfaces when available, handles slow/busy hidden
services better, supports https proxies for clients, and fleshes out our
controller interface. It also fixes a bunch of minor but annoying bugs.
  o New features:
    - Add reachability testing. Your Tor server will automatically try
      to see if its ORPort and DirPort are reachable from the outside,
      and it won't upload its descriptor until it decides they are.
    - Handle unavailable hidden services better. Handle slow or busy
      hidden services better.
    - Add support for CONNECTing through https proxies, with "HttpsProxy"
      config option.
    - New exit policy: accept most low-numbered ports, rather than
      rejecting most low-numbered ports.
    - More Tor controller support (still experimental). See
       for all the new features,
      including signals to emulate unix signals from any platform;
      redirectstream; extendcircuit; mapaddress; getinfo; postdescriptor;
      closestream; closecircuit; etc.
    - Make nt services work and start on startup on win32 (based on
      patch by Matt Edman).
    - Add a new AddressMap config directive to rewrite incoming socks
      addresses. This lets you, for example, declare an implicit
      required exit node for certain sites.
    - Add a new TrackHostExits config directive to trigger addressmaps
      for certain incoming socks addresses -- for sites that break when
      your exit keeps changing (based on patch by Mike Perry).
    - Redo the client-side dns cache so it's just an addressmap too.
    - Notice when our IP changes, and reset stats/uptime/reachability.
    - When an application is using socks5, give him the whole variety of
      potential socks5 responses (connect refused, host unreachable, etc),
      rather than just "success" or "failure".
    - A more sane version numbering system. See
       for details.
    - New contributed script "exitlist": a simple python script to
      parse directories and find Tor nodes that exit to listed
      addresses/ports.
    - New contributed script "privoxy-tor-toggle" to toggle whether
      Privoxy uses Tor. Seems to be configured for Debian by default.
    - Report HTTP reasons to client when getting a response from directory
      servers -- so you can actually know what went wrong.
    - New config option MaxAdvertisedBandwidth which lets you advertise
      a low bandwidthrate (to not attract as many circuits) while still
      allowing a higher bandwidthrate in reality.
  o Robustness/stability fixes:
    - Make Tor use Niels Provos's libevent instead of its current
      poll-but-sometimes-select mess.  This will let us use faster async
      cores (like epoll, kpoll, and /dev/poll), and hopefully work better
      on Windows too.
    - pthread support now too. This was forced because when we forked,
      we ended up wasting a lot of duplicate ram over time. Also switch
      to foo_r versions of some library calls to allow reentry and
      threadsafeness.
    - Better handling for heterogeneous / unreliable nodes:
      - Annotate circuits w/ whether they aim to contain high uptime nodes
        and/or high capacity nodes. When building circuits, choose
        appropriate nodes.
      - This means that every single node in an intro rend circuit,
        not just the last one, will have a minimum uptime.
      - New config option LongLivedPorts to indicate application streams
        that will want high uptime circuits.
      - Servers reset uptime when a dir fetch entirely fails. This
        hopefully reflects stability of the server's network connectivity.
      - If somebody starts his tor server in Jan 2004 and then fixes his
        clock, don't make his published uptime be a year.
      - Reset published uptime when you wake up from hibernation.
    - Introduce a notion of 'internal' circs, which are chosen without
      regard to the exit policy of the last hop. Intro and rendezvous
      circs must be internal circs, to avoid leaking information. Resolve
      and connect streams can use internal circs if they want.
    - New circuit pooling algorithm: make sure to have enough circs around
      to satisfy any predicted ports, and also make sure to have 2 internal
      circs around if we've required internal circs lately (and with high
      uptime if we've seen that lately too).
    - Split NewCircuitPeriod option into NewCircuitPeriod (30 secs),
      which describes how often we retry making new circuits if current
      ones are dirty, and MaxCircuitDirtiness (10 mins), which describes
      how long we're willing to make use of an already-dirty circuit.
    - Cannibalize GENERAL circs to be C_REND, C_INTRO, S_INTRO, and S_REND
      circ as necessary, if there are any completed ones lying around
      when we try to launch one.
    - Make hidden services try to establish a rendezvous for 30 seconds,
      rather than for n (where n=3) attempts to build a circuit.
    - Change SHUTDOWN_WAIT_LENGTH from a fixed 30 secs to a config option
      "ShutdownWaitLength".
    - Try to be more zealous about calling connection_edge_end when
      things go bad with edge conns in connection.c.
    - Revise tor-spec to add more/better stream end reasons.
    - Revise all calls to connection_edge_end to avoid sending "misc",
      and to take errno into account where possible.
  o Bug fixes:
    - Fix a race condition that can trigger an assert, when we have a
      pending create cell and an OR connection fails right then.
    - Fix several double-mark-for-close bugs, e.g. where we were finding
      a conn for a cell even if that conn is already marked for close.
    - Make sequence of log messages when starting on win32 with no config
      file more reasonable.
    - When choosing an exit node for a new non-internal circ, don't take
      into account whether it'll be useful for any pending x.onion
      addresses -- it won't.
    - Turn addr_policy_compare from a tristate to a quadstate; this should
      help address our "Ah, you allow 1.2.3.4:80. You are a good choice
      for google.com" problem.
    - Make "platform" string in descriptor more accurate for Win32 servers,
      so it's not just "unknown platform".
    - Fix an edge case in parsing config options (thanks weasel).
      If they say "--" on the commandline, it's not an option.
    - Reject odd-looking addresses at the client (e.g. addresses that
      contain a colon), rather than having the server drop them because
      they're malformed.
    - tor-resolve requests were ignoring .exit if there was a working circuit
      they could use instead.
    - REUSEADDR on normal platforms means you can rebind to the port
      right after somebody else has let it go. But REUSEADDR on win32
      means to let you bind to the port _even when somebody else
      already has it bound_! So, don't do that on Win32.
    - Change version parsing logic: a version is "obsolete" if it is not
      recommended and (1) there is a newer recommended version in the
      same series, or (2) there are no recommended versions in the same
      series, but there are some recommended versions in a newer series.
      A version is "new" if it is newer than any recommended version in
      the same series.
    - Stop most cases of hanging up on a socks connection without sending
      the socks reject.
  o Helpful fixes:
    - Require BandwidthRate to be at least 20kB/s for servers.
    - When a dirserver causes you to give a warn, mention which dirserver
      it was.
    - New config option DirAllowPrivateAddresses for authdirservers.
      Now by default they refuse router descriptors that have non-IP or
      private-IP addresses.
    - Stop publishing socksport in the directory, since it's not
      actually meant to be public. For compatibility, publish a 0 there
      for now.
    - Change DirFetchPeriod/StatusFetchPeriod to have a special "Be
      smart" value, that is low for servers and high for clients.
    - If our clock jumps forward by 100 seconds or more, assume something
      has gone wrong with our network and abandon all not-yet-used circs.
    - Warn when exit policy implicitly allows local addresses.
    - If we get an incredibly skewed timestamp from a dirserver mirror
      that isn't a verified OR, don't warn -- it's probably him that's
      wrong.
    - Since we ship our own Privoxy on OS X, tweak it so it doesn't write
      cookies to disk and doesn't log each web request to disk. (Thanks
      to Brett Carrington for pointing this out.)
    - When a client asks us for a dir mirror and we don't have one,
      launch an attempt to get a fresh one.
    - If we're hibernating and we get a SIGINT, exit immediately.
    - Add --with-dmalloc ./configure option, to track memory leaks.
    - And try to free all memory on closing, so we can detect what
      we're leaking.
    - Cache local dns resolves correctly even when they're .exit
      addresses.
    - Give a better warning when some other server advertises an
      ORPort that is actually an apache running ssl.
    - Add "opt hibernating 1" to server descriptor to make it clearer
      whether the server is hibernating.

@_date: 2005-03-29 03:41:10
@_author: Roger Dingledine 
@_subject: Can't start Tor under Debian 
Because the script "/etc/init.d/tor" is run as root, and it runs the
start-stop-daemon script, which launches tor as the debian-tor user. So
tor is never run as root.
"grep 113 /etc/passwd"
Is uid 113 debian-tor, or is this an old debian-tor, or what? It looks
from the above like you used to have tor installed, and it probably left
its /var/lib/tor/ directory, and then you installed a new one and it's
not compatible with what used to be there?

@_date: 2005-03-29 05:34:39
@_author: Roger Dingledine 
@_subject: QoS Solution? 
Hi Mike,
Sorry for the delay in answering this. I've been trying to let the
various approaches filter around in my head first.
I don't think we should do explicit QoS. We're always going to
be wondering if we've got the categories right, and we'll always be
worrying that we're pushing everybody to start doing all their traffic
over port 80.
I think we should dynamically decide fairness on a per-circuit basis
based on how many cells it's already tried to push through recently.
This means if you do a quick page fetch on port 80 it works fine,
but if you pull down a dvd on port 80 you start getting less priority;
yet a long-term IM conversation over port 80 is still pretty zippy.
It also means we can decide priorities at entry/middle hops without
needing to know what port is involved, and we don't need to mess with
changing Tor's network protocol or compatibility (which means we're
forward-compatible with a better implementation somebody might do down
the road).
It still means there would be voodoo constants we need to pick and tweak
until we're happy. So be it.
And we need to pick where we're going to queue things. Two options come
to mind: A) each circuit has an outqueue and OR conns would thumb through
the outqueues, lifting off cells to send when needed. B) each OR conn
has a priority queue with say 4 bins, and circuits decide the priority
of each cell, based on a busyness stat on the circuit, and stick it in
the appropriate bin. Then conns have some algorithm to give precedence
to some bins without totally starving others.
Option B) seems conceptually easier, but our requirement for in-order
delivery of cells on each circuit will screw it up. Imagine you have
a greedy circuit, and its cells are going onto the low-priority bin;
then the circuit gets more polite, and its newer cells go onto the
high-priority bin, and get sent first. Bad news. So maybe option A)
is better. Is there an option C) out there somewhere?
If we go with A), we'd probably want to implement linked lists of circs
associated with each conn, so it's easy to hunt through them without
going through the global circuit list. One more list to keep track of
(yuck) but probably worth it.
We'd want to pick cells such that conn's outbuf has >=16kB on it when
we flush, since that's the TLS record size. Easy enough. Whenever it
has less than that, we can go through circuits until we've got nothing
to send or it's full enough.
Another worry is that there's no way to 'push back' TCP-style on a given
circuit, since circuits are multiplexed over a single OR connection
from the previous OR, and you don't know the next cell's circuit
without reading it off the network, at which point you've already
accepted it. Right now we handle this by having explicit end-to-end
acknowledgements per circuit (and per stream inside a circuit, but let's
ignore that for now), so if you don't get your ack you're not allowed to
send any more cells until you do. So the circuit queues would have a max
length of CIRCWINDOW_START (1000) cells hanging out. But this is already
an issue now, since you can open a lot of circuits and force ORs to use
up more and more buffer space (until they decide the OR conn's buffer
is too big and kill the whole thing). In fact, by dividing queues up
into per-circuit queues, we would get more control, and we could have
a smarter algorithm for picking which circuits need to die when we're
out of buffer space.
(Side note: our circuit windows are fixed at 1000 right now, which
probably impacts our performance for quick transfers of sizes over
512kB. We should be able to get much better performance by implementing
dynamic-sized windows. But on the theory that we're not trying to optimize
for bulk transfers, I'm going to continue to ignore this.)
Another worry is reconciling our fairness scheme with bandwidthrate
constraints (per per-connection and global; and read and write)). But
hopefully we can modularize the issue and have a separate algorithm that
decides how much we get to read/write on each OR conn, and that should
be entirely separate from what cells we end up putting on them. It's a
good thing we're not trying to let circuits use multiple OR conns.
Of course, by pushing low priority stuff aside only when there is high
priority stuff, we're making Steven and George's Oakland attack even
more effective. But I believe that we need to learn to live with it, as
directly combatting it will reduce usability and performance for Tor,
which is a bad plan. Our real defense against their attack is to grow
the network until it becomes hard for them to measure all of it quickly
and reliably.
What did I leave out?

@_date: 2005-03-29 06:55:10
@_author: Roger Dingledine 
@_subject: QoS Solution? 
Hi Michal,
Both good points. But I think you're taking the wrong approach. We
shouldn't conclude that possible approaches "won't work" or "can't
be used" just because there exists a situation where they won't be
as effective.
I don't know of any magic answers here. No solution will work perfectly
for all situations. So we need to consider how much benefit we get from
each approach compared to how much complexity we add to the Tor code. I
think it might be worth trying this one out (especially as Mike keeps
volunteering to write code for us :)

@_date: 2005-03-10 13:30:56
@_author: Roger Dingledine 
@_subject: (FWD) privoxy.tor: Script control privoxy's tor. 
[Posted via gmane; I'm forwarding to the list. Let me know if you find
this useful or think we should put it somewhere more permanent. -RD]

@_date: 2005-03-14 18:18:31
@_author: Roger Dingledine 
@_subject: reconsidering default exit policy 
You may find
to be useful for this as well.
Yeah, that was me. I spoke to some people at Google, but it's as I
thought: they are happy with their current situation, and they're big
enough that nobody's going to blacklist them or make their ISP turn
them off.
So, the only long-term answer on our side is to become large enough,
common enough, and useful enough that nobody wants to mess with us either.

@_date: 2005-03-20 05:27:49
@_author: Roger Dingledine 
@_subject: disappearing nodes 
Hi Giorgos. Have you tried cvs tor? Now that we've switched to pthreads
(when they're available), we ought to be much more friendly memory-wise.
If you're still having problems even with cvs, that would be good to
know. :)
(We will hopefully have a tarball out for the first attempt in the
0.1.0 series in a few days, so if you don't want to mess with cvs,
you can wait for it.)

@_date: 2005-05-24 03:11:36
@_author: Roger Dingledine 
@_subject: Question about exit policy. 
On the other side of the coin, many Tor servers *want* people to exit
from them for nearby services, so users can have end-to-end encryption
and end-to-end authentication even for applications that don't have
these security features built-in. Consider blogging sites, Indymedia, etc.
We haven't implemented this part fully yet -- to have Alice automatically
detect whether there's a Tor node nearby her intended destination --
because there are still some design questions we're wrestling with,
but I plan for the 0.1.1.x release to have a partial solution for this.
So given that we can't predict what the Tor server operator has in mind,
we figured the best way to do it is to let him choose his exit policy.

@_date: 2005-05-24 22:59:32
@_author: Roger Dingledine 
@_subject: EFF Tor T-shirts for people who run exit nodes 
Hi folks,
EFF made Tor T-shirts. They're spiffy. And they're giving them out free,
to people running Tor servers that exit to (at least) port 80. In fact,
they will even ship yours to you.
Mail Eric Hanson (ehanson at eff.org) with your name, server's nickname,
t-shirt size, and snailmail address. If you live outside the U.S., he
will want you to make a $5 (or more) donation to EFF to cover your postage
(at  If you don't run an exit node but
you want a shirt anyway (they're way spiffy), he can probably also be
convinced to part with one for a not-quite-as-trivial donation. (If you
run an exit node that hibernates for 30 days out of the month, I'll let
your level of guilt/employment dictate the required amount. :)
Spread the word,

@_date: 2005-05-25 04:45:30
@_author: Roger Dingledine 
@_subject: ssh & connecting to 192.168.x.x addresses 
Based on the example in 1.7.4, it looks like ssh lets you specify for
which Hosts you should ProxyCommand and for which you should connect
Once you've figured it out, please edit the TorifyHOWTO to say how
you do it. :)

@_date: 2005-05-25 11:41:23
@_author: Roger Dingledine 
@_subject: raise ulimit? 
Alas, he's on Windows:
Can somebody tell us how to raise the file descriptor limit on Windows
XP? Or should we just give up and be happy it runs at all? :}

@_date: 2005-05-03 14:25:05
@_author: Roger Dingledine 
@_subject: 5/3 CVS Compile Error 
Perhaps you did your checkout at exactly the wrong time?
Let us know if it's still broken.

@_date: 2005-05-25 23:39:44
@_author: Roger Dingledine 
@_subject: FW: I still do not understand... 
It is an inherent property of the design that clients need to know where
servers are in order to use them.
There doesn't have to be a central directory, and it doesn't have to
always contain all of the servers, but in order for clients to use the
network they need to be able to learn about many of the servers.
And the adversary can be a client too, and learn about many of the
servers. We can't stop that.
So, we might as well make the engineering easier and centralize some
parts of it. This also improves our anonymity properties again certain
attacks like the Sybil attack.
Our stock answer for this is here:
Peekabooty and other systems had designs that aimed to give only a few
IPs at a time to clients, so they couldn't map the network. I never saw
the specification, so who knows, but I think this is a hard problem.
Feel free to solve it for us and let us know how to do it. :)
You're free to run an unlisted node. Add
NoPublish 1
to your torrc, and it won't upload your descriptor to the central
dirservers. Then clients can get your descriptor out-of-band, import
it via the controller interface, and use it however they like. Heck,
you can even go a step farther and specify your own dirservers. Or use
the three that we provide plus a fourth sekrit one. Tor aims to be a
unifying protocol, and people can build whatever topologies they want on
top of it. We also happen to provide one such example topology currently.

@_date: 2005-05-26 00:16:49
@_author: Roger Dingledine 
@_subject: volunteer to do php patch for wikipedia? 
Hi folks,
I've been talking to Jimmy Wales, the guy who runs Wikipedia, and we've
agreed on a proposed patch to Mediawiki (the software that runs Wikipedia)
that I think we'll all be happy with. (The Frank guy who visited or-talk
long ago is just some guy who claimed to run Wikipedia -- nothing more.)
Wikipedia blocks some Tor exit nodes from writing to their website. This
issue is not new for them: they have exactly the same problems when AOL
users abuse their website, since AOL also has only a few IP addresses
for its many users. Their current answer is to have a message on the
block page begging their admins not to block certain IP spaces. They
recover from accidental blocks by hearing from angry AOL users on their
IRC channel and manually fixing things.
Here's how I envision it working: there should be a db of IP sets (some
contiguous blocks, some not) that Wikipedia keeps track of. Periodically
(like every 15 minutes), all of these IPs should be unblocked. To make
things saner for the admins, certain IP sets should have a flag that says
if you block any IP in the set then you should block every IP in the set.
In this way, the Tor network (or each individual AOL IP) would be blocked
while there is abuse, but when it subsides they would become unblocked.
The reason I mention this here is that the Tor core developers have
their hands full making Tor work better, and it's time to delegate. Can I
get one (or more) of you to step up and make this happen? We don't need
to produce a beautiful pristine patch on the first go, but we need to
move this forward or its status will never change. :) Don't worry about
producing the list of actual IPs, we've got that covered.
(Please, do not debate here whether these measures are adequate to
prevent abuse -- we will find this out by trying it, not by speculating.)
Thanks. Let me know if you need more details.

@_date: 2005-05-03 14:41:53
@_author: Roger Dingledine 
@_subject: tor and bittorrent 
That's right, they added socks4a support to their application.
I wouldn't really call it a clash. Tor does want to be able to handle
heavy traffic loads, for example because I periodically talk to large
corporations who are considering putting their entire corporate web
traffic over Tor.
Right, this is true. Actually, they didn't integrate a client, they
just added socks4a support and told you you'd need a Tor client if
you want it to work over Tor. What Tor needs to do is make it easy and
worthwhile to run your Tor client in relay mode.
We're working on easy now (the 0.1.0.x release includes automated
reachability detection, which is a major building block we need),
but there are a lot of other issues we need to resolve too, like
decentralizing the directory more (that's our main task for 0.1.1.x),
and eventually (if necessary) adding some sort of incentive scheme to
encourage people to relay traffic if they want their own performance to
not suck.

@_date: 2005-05-28 11:45:30
@_author: Roger Dingledine 
@_subject: Memory use 
I believe we have some sort of memory bloat in 0.1.0.8-rc currently.
moria2 (one of the dirservers) is running on my shiny new 64 bit opteron,
and it's running at about 10% cpu pushing 900 kB/s.
But its memory footprint has been steadily growing.
I tried running it inside valgrind (which is actually possible on this
opteron -- wow), but valgrind indicated that there were no leaks.
Yet the footprint keeps growing.
I'm currently speculating that our malloc/realloc/free patterns in
buffers.c are convincing glibc not to give the memory back to the
operating system -- that is, we *are* freeing it, but glibc keeps it
around since it expects us to ask for it back soon.
Am I going mad?
Ten points to whoever finds the problem. :)

@_date: 2005-05-05 00:47:33
@_author: Roger Dingledine 
@_subject: (FWD) clock 
[Forwarding because Joel isn't subscribed with this address. Joel,
what seems not-right about it? Is your clock not in fact jumping around
wildly? What do you use to keep it accurate? Do you see these messages
every time you run Tor or just this one time? Can you reproduce this? I
typically get these messages when my laptop has been suspended and I
un-suspend it. -RD]

@_date: 2005-05-05 23:19:44
@_author: Roger Dingledine 
@_subject: Recent Abuse compalints... 
Right, law enforcement is surprisingly educated about this sort of
thing. I think it comes because nearly all of their leads are dead-ends
already, because bad people break into computers and relay through them.
So "I don't have any answers for you, I'd really like to help but I can't"
is something they're used to hearing.
Right, he contacted me as well. I gave him the standard answer:
I pointed him to  for a sample
script to help him enumerate all the Tor servers that allow exiting to
his IP addresses and ports; hopefully he will be pleased that we can
help him in that regard. I'm talking to him now to try to explain that
Tor can't actually identify-and-keep-out-all-bad-guys, and so if he
wants captchas, accounts, etc, he is going to need to add them on his
end rather than having them be part of the Internet transport mechanisms.
We'll see how it goes. :)

@_date: 2005-05-05 23:46:31
@_author: Roger Dingledine 
@_subject: (FWD) clock 
Maybe a good way to investigate this would be to log to a file at
loglevel debug:
and see how the timestamps look in the entries before and after these
Does it typically happen when you're not using Tor, or when you are?
Sounds good.

@_date: 2005-05-06 03:30:45
@_author: Roger Dingledine 
@_subject: (FWD) MacUpdate Dev: Tor updated 
Anybody want to be Roger and keep these folks up-to-date? I don't have
time to deal with all of these myself.

@_date: 2005-05-07 03:44:16
@_author: Roger Dingledine 
@_subject: (FWD) MacUpdate Dev: Tor updated 
Great, thanks for volunteering, Joel.
I guess step one might be to teach them about the "0." at the front of
the current version? ;) Or should we leave that as-is?

@_date: 2005-05-11 18:18:55
@_author: Roger Dingledine 
@_subject: Hibernation and client use 
Woo. Thanks for the new Tor node. :)
Right. This is because we do accountingmax based on the number of bytes
coming into the Tor, from any connection type (OR, exit node, socks
connection, ...)
When the limit is reached, we figure you don't want to spend any more
You're right, I bet we could do this. We would close the OR port, and
refuse incoming create requests, but otherwise continue to perform.
Would people prefer this behavior, or do they like it the way it is now?
As Warren says, the workaround is simple: run a Tor client also, and use
that for your own stuff.
This approach may even be a smarter move anonymity-wise, since we're
currently researching "interference attacks" --- it's possible to measure
traffic *remotely*, without needing to tap or subpoena or compromise or
whatever the server. This happens because servers have finite resources,
and the adversary can send his *own* traffic through the server to
measure where other traffic is going through the node too.
So this adversary can determine all the nodes in your path, but he still
can't learn about *you*. But if you always use your node as the first
hop in your path, this may not be so good.
There are other arguments in favor of using a fixed entry node (it
improves against other attacks), so this is not a simple topic. Also,
we especially want to investigate this more if we're going to try to get
clients to relay traffic (helps the community, but may impact anonymity
both helpfully and unhelpfully). In any case, just choosing your path
randomly should do for now, until we understand more.
Hope that helps,

@_date: 2005-05-12 23:25:58
@_author: Roger Dingledine 
@_subject: Tor 0.4 and 0.5 throughput 
Hi Alex,
Is this still happening? Can you try again more thoroughly? You're
the only person we've heard this issue from. Other people seem to be
getting throughput fine from these versions, even on Win32.

@_date: 2005-05-14 23:17:27
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.6-rc is out 
This is the sixth release candidate for the 0.1.0.x series. This is an
actual release candidate--it's going to be the final release if there
are no bugs--we promise. :) We fixed the last known major problems:
we don't use threading on netbsd now, and the new libevent 1.1 detects
and disables the broken kqueue that ships with OS X 10.4.0.
Libevent 1.1 also has __significant__ performance improvements if you're
using poll or select. Try it, you'll like it.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes:
    - Implement --disable-threads configure option. Disable threads on
      netbsd by default, because it appears to have no reentrant resolver
      functions.
    - Apple's OS X 10.4.0 ships with a broken kqueue. The new libevent
      release (1.1) detects and disables kqueue if it's broken.
    - Append default exit policy before checking for implicit internal
      addresses. Now we don't log a bunch of complaints on startup
      when using the default exit policy.
    - Some people were putting "Address  " in their torrc, and they had
      a buggy resolver that resolved " " to 0.0.0.0. Oops.
    - If DataDir is ~/.tor, and that expands to /.tor, then default to
      LOCALSTATEDIR/tor instead.
    - Fix fragmented-message bug in TorControl.py.
    - Resolve a minor bug which would prevent unreachable dirports
      from getting suppressed in the published descriptor.
    - When the controller gave us a new descriptor, we weren't resolving
      it immediately, so Tor would think its address was 0.0.0.0 until
      we fetched a new directory.
    - Fix an uppercase/lowercase case error in suppressing a bogus
      libevent warning on some Linuxes.
  o Features:
    - Begin scrubbing sensitive strings from logs by default. Turn off
      the config option SafeLogging if you need to do debugging.
    - Switch to a new buffer management algorithm, which tries to avoid
      reallocing and copying quite as much. In first tests it looks like
      it uses *more* memory on average, but less cpu.
    - First cut at support for "create-fast" cells. Clients can use
      these when extending to their first hop, since the TLS already
      provides forward secrecy and authentication. Not enabled on
      clients yet.
    - When dirservers refuse a router descriptor, we now log its
      contactinfo, platform, and the poster's IP address.
    - Call tor_free_all instead of connections_free_all after forking, to
      save memory on systems that need to fork.
    - Whine at you if you're a server and you don't set your contactinfo.
    - Implement --verify-config command-line option to check if your torrc
      is valid without actually launching Tor.
    - Rewrite address "serifos.exit" to "localhost.serifos.exit"
      rather than just rejecting it.

@_date: 2005-05-15 00:21:12
@_author: Roger Dingledine 
@_subject: (FWD) Re: Tor 0.1.0.6-rc is out 
[Forwarding because Matt isn't subscribed at this address. Matt, can
you give us some hints about what form you'd like this to take? Extra
points if you can you give us some autoconf code to do it. :) -RD]

@_date: 2005-05-15 20:48:52
@_author: Roger Dingledine 
@_subject: Tor-1.0.4  core dump on FreeBSD 5.3 
You might also consider upgrading your libevent to 1.1. There were a
couple libevent bugs over the past few libevent releases that might
produce errors like that.

@_date: 2005-05-16 15:20:54
@_author: Roger Dingledine 
@_subject: Filtering out attacks? 
I've been thinking about this periodically. My current thought is that
we should implement some basic resource limits for technical reasons --
the previous instance of this was when somebody was hitting google a lot
via Tor, and google's DoS detectors were triggering. The Tor server could
detect this and preemptively avoid it. There are a couple advantages here:
1) The exit node *can* tell if two flows are from the same circuit. So
we could have a per-circuit limit, and also maybe an overall limit,
on the number of connections to a given IP per second.
2) When the exit node decides it can't handle a given request, it can send
back a "resource limit exceeded" reason for failing, and the client can
automatically give it a go from a different exit node. This is already
done in the case of running out of file descriptors, etc. (Actually,
I'm not sure if this is the right thing to do here. If in fact the user
is sending out way too many requests, shouldn't we cut him off rather
than spreading the pain through the rest of Tor? Perhaps the per-circuit
limit will send back an "it failed" reason, but the overall limit would
send back "resource limit exceeded".)
I am wary of going too far down this path, of course, because at some
point we're making judgments about whether to allow certain content,
and things just turn bad from there.

@_date: 2005-05-16 17:45:06
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.6-rc is out 
Right, this is because your libevent installs itself in /usr/local/,
yet your system isn't configured to look for anything there.
I consider this a bug with the bsd's. :(
Maybe you should build libevent with --prefix=/usr ?
We've been pondering making Tor's autoconf automatically append
-I/usr/local/include and -L/usr/local/lib if they seem needed, but this
is a dangerous path to go down.
Our current thoughts are, if it looks like you don't have libevent,
your autoconf should go see if it looks like it's in /usr/local but not
in your ld.so.conf or includepath, and if so, spit out an error message
that tells you to run the command you quote above if you really mean that.
Is there a better way to do this? Should we just automate it anyway and
accept the fact that sometimes the bsd folks will get weird behavior if
they're relying on the current (broken) paths?

@_date: 2005-05-16 18:10:50
@_author: Roger Dingledine 
@_subject: (FWD) Re: Tor 0.1.0.6-rc is out 
[Forwarding because Matt isn't subscribed at this address. Matt,
could you consider subscribing from this address, or sending from
the address tha is subscribed?
Good point, that we already do this for openssl, so what's one more
step down this finely paved road, anyway. -RD]

@_date: 2005-05-17 01:34:17
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.7-rc is out 
This is the seventh release candidate for the 0.1.0.x series. We're
getting real close now! :) This release fixes the OS X package for Tiger
(again, differently), and also finds and links and runs libevent much
better on weird platforms.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes:
    - Fix a bug in the OS X package installer that prevented it from
      installing on Tiger.
    - Fix a script bug in the OS X package installer that made it
      complain during installation.
    - Find libevent even if it's hiding in /usr/local/ and your
      CFLAGS and LDFLAGS don't tell you to look there.
    - Be able to link with libevent as a shared library (the default
      after 1.0d), even if it's hiding in /usr/local/lib and even
      if you haven't added /usr/local/lib to your /etc/ld.so.conf,
      assuming you're running gcc. Otherwise fail and give a useful
      error message.
    - Fix a bug in the RPM packager: set home directory for _tor to
      something more reasonable when first installing.
    - Free a minor amount of memory that is still reachable on exit.

@_date: 2005-05-19 01:33:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.7-rc is out 
Great, thanks for letting us know, and thanks to tyranix and Christopher
Schanzle for sending us patches, too.
I've placed a new spec rev and rpm at:
Hopefully this one will behave better. :)

@_date: 2005-05-19 02:26:05
@_author: Roger Dingledine 
@_subject: tor ops/users dinner in boston, next week 
Hi folks,
I realized there are plenty of you also in Boston that I haven't met
yet, and that's silly. Send me mail if you want to get together for an
informal dinner somewhere next week to talk about Tor, current and future
directions, etc, and let me know which of Mon-Thurs you can't make. Also,
if you're around here but can't make next week, drop me a line anyway
so I can keep you informed of future attempts, and not spam the list
each time. :)

@_date: 2005-05-20 00:33:42
@_author: Roger Dingledine 
@_subject: New Tor server 
Sounds good.
My rough recommendation is a BandwidthRate of 20*x KB, where x is the
number of gigs per day you want to handle (in each direction).

@_date: 2005-05-20 00:49:56
@_author: Roger Dingledine 
@_subject: os x kernel panics 
Hi Phobos,
What version of Tor was this? Tor 0.0.9.x doesn't use kqueue; to my
knowledge OS X 10.3.x does not implement kqueue; and Tor 0.1.0.7-rc links
libevent 1.1 which detects and disables kqueue on 10.4.x because 10.4.x
implements an api that is different from every other kqueue on earth.
So, are you doing this on a Tor 0.1.0.x where x != 7-rc? If so, you should
upgrade. :) If you're using 7-rc, can you tell us the log messages when
Tor starts up, that say what polling method libevent has decided to use?
Also, you say you could trigger these panics on Tor 0.0.9.9. It might
be nice to compare the symbols you find for these panics, since if
they reference kqueue also, perhaps you are not lining up your symbols

@_date: 2005-05-20 02:44:44
@_author: Roger Dingledine 
@_subject: os x kernel panics 
Yes, it really does look like it. Gosh.
Ok, Adam's workaround can best be explained by:
"edit /Library/StartupItems/Tor/Tor and place "export EVENT_NOKQUEUE=1"
just before the setting of TORLOC."
Please give this a go and let us know if you can (or can't) trigger any
more kernel panics. If this one works, then I suppose we'll just find a
way to disable kqueue on OS X because they've gotten it wrong on every
single version. :}

@_date: 2005-05-22 02:18:13
@_author: Roger Dingledine 
@_subject: Problems with TOR & FreeBSD 
Thanks, I've fixed this bug in what will soon be called 0.1.0.8-rc.
When you start Tor logging to stdout, and libevent prints a little blurb
when you startup, like
what does yours say?

@_date: 2005-05-22 22:11:23
@_author: Roger Dingledine 
@_subject: Problems with cvs? 
We moved the old moria onto new hardware with a new OS, and had a couple
of glitches as we did it.
I believe tor anon cvs is working now. Let me know if it isn't. :)

@_date: 2005-05-23 03:42:55
@_author: Roger Dingledine 
@_subject: Tor 0.1.0.8-rc is out 
============================== START ==============================
This is the eighth release candidate for the 0.1.0.x series. This
release makes Tor no longer induce kernel panics on OS X 10.3.9, disables
threading on OpenBSD, and fixes other odds and ends.
Please report any bugs, either in the installers or in Tor operation, so
we can get it perfect for an actual release:   o Bugfixes:
    - It turns out that kqueue on OS X 10.3.9 was causing kernel
      panics. Disable kqueue on all OS X Tors.
    - Fix RPM: remove duplicate line accidentally added to the rpm
      spec file.
    - Disable threads on openbsd too, since its gethostaddr is not
      reentrant either.
    - Tolerate libevent 0.8 since it still works, even though it's
      ancient.
    - Enable building on Red Hat 9.0 again.
    - Allow the middle hop of the testing circuit to be running any
      version, now that most of them have the bugfix to let them connect
      to unknown servers. This will allow reachability testing to work
      even when 0.0.9.7-0.0.9.9 become obsolete.
    - Handle relay cells with rh.length too large. This prevents
      a potential attack that could read arbitrary memory (maybe even
      keys) from the exit server's process.
    - We screwed up the dirport reachability testing when we don't yet
      have a cached version of the directory. Hopefully now fixed.
    - Clean up router_load_single_router() (used by the controller),
      so it doesn't seg fault on error.
    - Fix a minor memory leak when somebody establishes an introduction
      point at your Tor server.
    - If a socks connection ends because read fails, don't warn that
      you're not sending a socks reply back.
  o Features:
    - Add HttpProxyAuthenticator config option too, that works like
      the HttpsProxyAuthenticator config option.
    - Encode hashed controller passwords in hex instead of base64,
      to make it easier to write controllers.

@_date: 2005-11-15 04:17:56
@_author: Roger Dingledine 
@_subject: Error message? 
I assume you're getting this from the 0.1.1.9-alpha that
we've put on the website but haven't announced yet?
It's a logic error in the log message. Remove the "un" and it
will hopefully make more sense. :) Thanks for pointing it out.
(Did you expect this server to be recognized by the dirservers?
If so, we have a larger bug to deal with.)

@_date: 2005-11-15 15:35:18
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.9-alpha is out 
This is the ninth development snapshot for the 0.1.1.x series. We
fix some memory leaks from the last snapshot, remove a lot of extra
confusing log warnings, and fix other bugs.
Changes in version 0.1.1.9-alpha - 2005-11-15
  o Usability improvements:
    - Start calling it FooListenAddress rather than FooBindAddress,
      since few of our users know what it means to bind an address
      or port.
    - Reduce clutter in server logs. We're going to try to make
      them actually usable now. New config option ProtocolWarnings that
      lets you hear about how _other Tors_ are breaking the protocol. Off
      by default.
    - Divide log messages into logging domains. Once we put some sort
      of interface on this, it will let people looking at more verbose
      log levels specify the topics they want to hear more about.
    - Make directory servers return better http 404 error messages
      instead of a generic "Servers unavailable".
    - Check for even more Windows version flags when writing the platform
      string in server descriptors, and note any we don't recognize.
    - Clean up more of the OpenSSL memory when exiting, so we can detect
      memory leaks better.
    - Make directory authorities be non-versioning, non-naming by
      default. Now we can add new directory servers without requiring
      their operators to pay close attention.
    - When logging via syslog, include the pid whenever we provide
      a log entry. Suggested by Todd Fries.
  o Performance improvements:
    - Directory servers now silently throw away new descriptors that
      haven't changed much if the timestamps are similar. We do this to
      tolerate older Tor servers that upload a new descriptor every 15
      minutes. (It seemed like a good idea at the time.)
    - Inline bottleneck smartlist functions; use fast versions by default.
    - Add a "Map from digest to void*" abstraction digestmap_t so we
      can do less hex encoding/decoding. Use it in router_get_by_digest()
      to resolve a performance bottleneck.
    - Allow tor_gzip_uncompress to extract as much as possible from
      truncated compressed data. Try to extract as many
      descriptors as possible from truncated http responses (when
      DIR_PURPOSE_FETCH_ROUTERDESC).
    - Make circ->onionskin a pointer, not a static array. moria2 was using
      125000 circuit_t's after it had been up for a few weeks, which
      translates to 20+ megs of wasted space.
    - The private half of our EDH handshake keys are now chosen out
      of 320 bits, not 1024 bits. (Suggested by Ian Goldberg.)
  o Security improvements:
    - Start making directory caches retain old routerinfos, so soon
      clients can start asking by digest of descriptor rather than by
      fingerprint of server.
    - Add half our entropy from RAND_poll in OpenSSL.  This knows how
      to use egd (if present), openbsd weirdness (if present), vms/os2
      weirdness (if we ever port there), and more in the future.
  o Bugfixes on 0.1.0.x:
    - Do round-robin writes of at most 16 kB per write. This might be
      more fair on loaded Tor servers, and it might resolve our Windows
      crash bug. It might also slow things down.
    - Our TLS handshakes were generating a single public/private
      keypair for the TLS context, rather than making a new one for
      each new connections. Oops. (But we were still rotating them
      periodically, so it's not so bad.)
    - When we were cannibalizing a circuit with a particular exit
      node in mind, we weren't checking to see if that exit node was
      already present earlier in the circuit. Oops.
    - When a Tor server's IP changes (e.g. from a dyndns address),
      upload a new descriptor so clients will learn too.
    - Really busy servers were keeping enough circuits open on stable
      connections that they were wrapping around the circuit_id
      space. (It's only two bytes.) This exposed a bug where we would
      feel free to reuse a circuit_id even if it still exists but has
      been marked for close. Try to fix this bug. Some bug remains.
    - If we would close a stream early (e.g. it asks for a .exit that
      we know would refuse it) but the LeaveStreamsUnattached config
      option is set by the controller, then don't close it.
  o Bugfixes on 0.1.1.8-alpha:
    - Fix a big pile of memory leaks, some of them serious.
    - Do not try to download a routerdesc if we would immediately reject
      it as obsolete.
    - Resume inserting a newline between all router descriptors when
      generating (old style) signed directories, since our spec says
      we do.
    - When providing content-type application/octet-stream for
      server descriptors using .z, we were leaving out the
      content-encoding header. Oops. (Everything tolerated this just
      fine, but that doesn't mean we need to be part of the problem.)
    - Fix a potential seg fault in getconf and getinfo using version 1
      of the controller protocol.
    - Avoid crash: do not check whether DirPort is reachable when we
      are suppressing it because of hibernation.
    - Make --hash-password not crash on exit.

@_date: 2005-11-16 17:35:41
@_author: Roger Dingledine 
@_subject: (FWD) Re: tor block insanity 
Here's the reply from the Gentoo forum folks. Please do pay close
attention to his remark about rudeness. You really are hurting our cause
by calling people stupid.

@_date: 2005-11-17 19:25:48
@_author: Roger Dingledine 
@_subject: .9-alpha problem 
Did you (do you) get a better message from your browser with
What Tor server are you?
We did change the dynamic IP address stuff in this release, so it's
likely we've got a bug somewhere.

@_date: 2005-11-17 21:49:39
@_author: Roger Dingledine 
@_subject: Error message? 
I managed to recreate this for myself, and fixed it (I think ;).
Thanks for letting us know.

@_date: 2005-11-23 17:46:08
@_author: Roger Dingledine 
@_subject: ATTN: for-profit Tor operators 
Hi Eugen,
Looks like a fun experiment. Let us know how it goes.
Remember that your users will get less security than with the main Tor
network, since Tor's security is all about the diversity and dispersal
of the network and operators.
We've been thinking a lot lately about how to fund Tor development,
since EFF ran out of money for us last month.
So, we wish you luck. And if you find that you have a financial interest
in continuing Tor development, keep in mind that the Tor developers can
do that better than anybody. :)

@_date: 2005-11-25 20:35:41
@_author: Roger Dingledine 
@_subject: EFF no longer funding Tor (was Re: ATTN: for-profit Tor operators) 
We don't need complex theories to explain it. They simply ran out of
money. They had to let go some of their actual employees too. This time
of year is never good for non-profits.
Nothing has changed except they don't have money for funding Tor
development. They're still excited to work with us, and so far we (the
Tor project) are excited to continue working with them, since they have
a high profile and some smart lawyers, and part of the goal of Tor is
to be a catalyst to help change bad laws and bad policies.
Btw, amongst all the development and contracting stuff I'm trying to do, I
have finally come around to the side of reason, and I agree that we should
begin soliciting donations to pay for further Tor development. After
all, there is a huge amount of development, research, and usability work
that still needs to happen. This will let us not have to get distracting
other jobs, and in our wild dreams it will let us start paying a third
developer. Please contact me off-list if you have some experience making
this work right, with answers to such questions as "Is Paypal the right
way to go?" and "Are there ways to have people auto-pay each month?"

@_date: 2005-11-26 17:20:31
@_author: Roger Dingledine 
@_subject: Win XP Tor servers and the WSAENOBUFS error 
Hi folks,
I know a lot of you have been plagued by the WSAENOBUFS error while
trying to run Tor as a server on your XP computers.
It's possible I fixed this bug in 0.1.1.9-alpha.
If you have experienced this problem, can you try running that release
as a Tor server, and let me know if it's still a problem?

@_date: 2005-11-29 09:14:51
@_author: Roger Dingledine 
@_subject: strange warning 
Hey, good catch. That's a bug, and I know how to fix it. I'll put it
on the todo list; let us know if it is still around when we release

@_date: 2005-10-16 14:14:57
@_author: Roger Dingledine 
@_subject: Increasingly large number of "404"s 
Hi Mike,
Included in the Changelog for 0.1.1.6-alpha is:
    - Retry streams if the exit node sends back a 'misc' failure. This
      should result in fewer random failures. Also, after failing
      from resolve failed or misc, reset the num failures, so we give
      it a fair shake next time we try.
I have fewer issues now that I'm using the latest alpha release.
But this is still a problem overall, yes. The problem is that these Tor
servers really do believe that the host is unreachable, either because
their firewall lies to them or their network is otherwise screwed up.
And typically this behavior only shows up when the Tor server is really
heavily loaded -- meaning it works for the operator typically, so it's
hard to track down what's going wrong.
Anyway, let me know if the new version helps at all, and we'll go from

@_date: 2005-10-18 01:48:39
@_author: Roger Dingledine 
@_subject: Broadband Reports: Tor Network Bogged Down by P2P 
I like this approach -- let Tor self-regulate itself because when it
gets too overloaded, people will leave until it works again.
There's a potential problem with it, though, when different users place
different value on their time and on their security.
So one failure mode would be if the filesharers care more about being
anonymous than the web users. Then they'd just leave it running in the
background, and not mind that it takes 6 days to download a file rather
than 6 hours, because eventually it arrives.
The current Tor network clearly can't sustain very many of these people,
but if all the web users give up first, then "let it suck" means most
of our users go away.
It remains to be seen whether this will happen, of course, but we're
trying to come up with some useful technical approaches too. :)

@_date: 2005-10-18 21:42:54
@_author: Roger Dingledine 
@_subject: invalid certificate warning 
Somebody is running a Tor client (or server?) at that address that doesn't
follow the Tor spec. I'm not sure who it is or what they're working on.
The new versions of Tor (in CVS) don't warn about this particular issue
anymore, since it isn't anything that the Tor operator who sees it can
do anything about.

@_date: 2005-10-19 09:11:35
@_author: Roger Dingledine 
@_subject: DMCA letters in general 
As I understood it, there's no need for the ISP to respond to people
spamming them with takedown demands. The tor-dmca-response.html is
designed for the user and her ISP to have a discussion, and sending
anything at all back to the industry lawyers is just asking for more
Of course, the industry lawyers may get upset if they are ignored --
they might demand that your ISP terminate your account, or they might
sue somebody. I'd recommend talking to a lawyer about your particular
situation. In fact, we happen to know a few who might be interested in
your case:

@_date: 2005-10-02 01:41:39
@_author: Roger Dingledine 
@_subject: nym-0.2.1 released (live demo available) 
Hi Jason,
I just went through the client side of the demo. Nice.
In your README you mention a deb I need -- libcrypt-ssleay-perl.
Turned out I also needed libdigest-sha1-perl for Digest/SHA1.pm. (This
is on Sarge.)
In Firefox, adding a cert is "Edit | Preferences | Advanced |
Certificates" and then click on "ask every time" and then click on
"manage certificates" and click "import".
In the live demo list you say:
  "Real" installations will probably block tor exit nodes and open http
  proxies to enforce the one-token-per-IP rule.
My first response is that Tor servers will hand out at most one token each
anyway, so since they're self-limiting there's no point in special-casing
them.  But then I realized that since a lot of people will judge the
effectiveness of this design from its first five minutes of performance,
we probably do want to close all those holes right at the beginning.
I also wanted to make makecert.sh automatically hit enter at each
point. Having uniform responses is a security issue, after all. I just
hacked that together as
yes ""|./makecert.sh
but you could also work that into the script itself when it calls
openssl. In my ideal world, I guess the openssl command would have a
"hit enter to everything" command-line option.
Let me know if/when you want nym to become an official part of the
freehaven/tor sites. :) We can help with documentation and screenshots
and publicity, and maybe more if there's something you need.

@_date: 2005-10-20 13:03:57
@_author: Roger Dingledine 
@_subject: SSL fro hidden services 
Good point.
Also a good point.
Another thing to remember is that if the hidden service is not run on
the same computer as its Tor client (for example, if you use the line
"HiddenServicePort 80  then that last hop is in the
clear unless it uses some sort of encryption/authentication like SSL.

@_date: 2005-10-23 23:41:20
@_author: Roger Dingledine 
@_subject: Publicizing Hidden Services 
And the more canonical one is
which is linked from
but could also be helpfully linked from overview.html and
documentation.html (which was why this thread started).
I've just linked them more loudly from both of these places. Let
me know if you think that helps.
I couldn't actually access the one phobos provided. Which leads to the
more important point -- we need to work on speed and reliability of
hidden services before we try to make them more popular. That's on the
todo list, but it's pretty far down the list at this point, at least
until somebody with funding decides that this is important to them.

@_date: 2005-10-26 16:55:36
@_author: Roger Dingledine 
@_subject: EFF is looking for Tor DMCA test case volunteers 
Fred asked me to forward this to the list. If you have legal questions
(and probably most questions about this count as legal questions), you
should contact Fred and Kevin directly (fred at eff.org and bankston at
eff.org). Fred also reminds us that any correspondence you have with me
or others here would be discoverable, so that's an added incentive to
go to them directly.
Please look through this checklist, and decide if you match the profile
they're looking for. I'd like to encourage you to contact them even
if there are a few points you don't match so well -- I'd rather have a
big pile of pretty-good volunteers than have everybody hold off because
they are not perfectly suited -- then Fred and Kevin can make their own
decisions from there.
If record label and movie studio representatives continue sending
infringement notices to Tor node operators and their upstream ISPs,
it will become increasingly important to set a clear legal precedent
establishing that merely running a node does not create copyright
liability for either node operators or their bandwidth providers. In
order to establish such a precedent, it will be necessary to bring or
defend a test case. EFF is actively seeking clients willing to be the
test case.
Picking the right client is half the battle in any test case.
Accordingly, we cannot promise that we will be able to defend any and
all Tor node operators. There are several factors that are relevant
in finding the right test case client. Here are some of them:
1. You must have received a complaint from a copyright owner about
operating a Tor node. Complaints from your ISP about running a proxy
do not count, even if they mention copyright infringement as the
reason for their objection -- that's a contractual fight between you
and your bandwidth provider. We are looking for node operators who
have either received copyright complaints directly, or forwarded to
them from their ISPs.
2. You should not be an infringer yourself, or be engaged in any
other kind of unlawful activity. In litigation, the copyright owners
will want to examine every hard drive and email message in your
possession or control, looking for evidence that you are running Tor
because you want to encourage people to infringe copyright. So if you
are a big file-sharer, warez trader, or are involved in any other
unlawful activities (even if unrelated to Tor), you are probably not
the right person.
3. You should have a legitimate reason to run Tor. If you are the
client for the test case, you will be deposed under oath and asked
why you run Tor. You should be able to truthfully respond in a way
that does not suggest that you are doing it to encourage any illegal
activity, including copyright infringement. For example, running it
because you value free speech is a legitimate reason. Same if you are
running it for research purposes. Any documentary evidence from your
past (e.g., emails, papers presented, etc) should not contradict your
story. Most Tor node operators will qualify under this criteria, but
if you wrote a bunch of emails and bulletin board posts describing
how great Tor will be for the coming copyright revolution, you are
probably not the ideal client.
4. You should be willing to see the case through. Litigation takes
time -- often several years. The process will occasionally involve
some inconvenience, including depositions and allowing the other side
to go through most documents in your possession or control (including
email, hard drives, etc). EFF will provide the legal services for
free. But there is some risk of personal liability for damages,
perhaps amounting to several thousand dollars, if we lose. We will do
everything to minimize the risk, but cannot eliminate it altogether.
5. You should be located in the United States. Your Tor server should
also be located in the United States.
6. You should have an upstream bandwidth provider who will stand by
you. It would be less than ideal if your upstream ISP terminates your
account before we ever get to court.

@_date: 2005-10-27 15:55:23
@_author: Roger Dingledine 
@_subject: Wrongly configured Squid @ kaneda.ced.homedns.org & 404's 
Great, I've sent the operator of ced a mail. We'll hopefully clear this
up shortly. If anybody notices other cases like this, please let us know.
I use the the 0.1.1.x branch, and I get no 404's. (I made some
improvements in when it retries from a different exit.) So you might
try that.
Geoff Goodell just convinced me yesterday that I should be even more
thorough about retrying, to tolerate crummy Tor exit servers, so hopefully
the next release of the Tor alpha branch will be even better.

@_date: 2005-10-30 13:36:00
@_author: Roger Dingledine 
@_subject: Determining bandwidth 
It is a slight underestimate of the actual bandwidth used on the wire. The
reason for the discrepancy is overhead in the TLS protocol. When we send
x bytes, it gets broken up into records of at most 16 kB, with a small
header on each record that doesn't get counted in the above calculation.
(Of course, if our data transmission pattern doesn't provide easy chunks
of 16kB, then the header will be a larger proportion of the bandwidth as
the record size decreases.) Also, we don't count bytes used in the TLS
handshake phase. And lastly, TLS can request rekeying whenever it likes,
and that happens in the background and isn't counted above either.
We've been meaning to go dig into the OpenSSL internals to keep track of
all the extra bytes used also, but right now we figure we're a pretty
good approximation in most cases.

@_date: 2005-10-31 01:29:11
@_author: Roger Dingledine 
@_subject: Fwd: [sorbs.net #51340] Need help with 81.169.156.174 (support form) 
Right. SORBS is pretty much a one-man project, and this "Mat" fellow
adds all services to his list that in his opinion shouldn't exist.
Tor is such a service -- we had a long discussion with him when he first
started listing Tor servers, and the conclusion was that he wanted Tor
to go away, so he's doing what he can to kill it.
I used to think that I could reason with Mat and get him to update his
software so he didn't mark you as a spammer (port 25) just because your
Tor server could make connections on other ports (e.g. port 6667). I've
given up on that, though.
So what's the right strategy? Certainly the first step is to not use
SORBS, and to tell everybody we know not to. Maybe we should publicize
things farther, and use some of our google-juice to start waging war on
his project?
But I'm tempted not to do anything at all, and just let him die quietly
away. I'm constantly amazed to find mail sites that pay attention to his
blacklist. Didn't they learn their lesson from previous blacklists that
went evil and suddenly started listing large chunks of the Internet?
I guess history is destined to repeat itself. Don't be caught letting
some guy in Australia decide what mail you can receive and what mail
you can't receive.

@_date: 2005-10-01 04:09:55
@_author: Roger Dingledine 
@_subject: Finding Volunteers - Hardly likely!!!! 
Is this the SORBS blacklist, or which?
There are many email blacklists out there. Some of them are reasonable,
and some as you say are in it for the power trip and/or the extortion
I spoke at length with Mat (the SORBS guy) to try to get him to see
reason, and he ultimately declared that his service was not about stopping
spam, it was about blacklisting everything that Mat doesn't like on the
Internet. And he doesn't like anonymity. At that point I figured the
conversation was over. He actively blacklists Tor IPs whether they have
done anything wrong or not.
I guess the answer is that you can't keep everybody happy at once. If
people choose to use SORBS, then they're putting themselves at the mercy
of Mat and his tactics. They lose.
(I feel sad that many people don't have the choice of whether their
ISP believes these blacklists -- but I suppose in a sense they do,
since they can vote with their feet.)
Tor does work with dynamic IP addresses. If you happen to have some
extras, it's probably a better set-up, but that's just up to personal
choice and circumstances.
As for what somebody told you on APAS -- last I checked APAS was mostly
just people yelling at each other and making fun of each other. If
you want to join the mixmaster community, that seems to be par for the
course. I'm doing my best to let the Tor community grow freely without
turning into another APAS. Hopefully there is slightly less yelling on
or-talk. :)
You don't need static IPs, but some people will say bad things to you
if you don't. Come to think of it, people will probably say bad things
to you if you do, also.
Is Alex refusing mail from a bunch of mixmaster nodes because they're
on some blacklist he pays attention to? I think that's funny. It also
helps to explain some of the unreliability of Mixmaster message delivery.
I'm glad we chose to use a non-SMTP transport for Mixminion.
That's true. We all need to decide about our priorities and which projects
are worth paying attention to and helping out. Tor is still very young,
and we've got a long way to go before all the wrinkles are ironed out.
I'm sorry you feel that way.

@_date: 2005-10-07 18:26:23
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.8-alpha is out 
This is the eighth development snapshot for the 0.1.1.x series. The
main changes are that clients now use the new directory protocol, that
servers that are tight on resources stop advertising their DirPort,
and that we use OpenSSL's AES if it's available.
Changes in version 0.1.1.8-alpha - 2005-10-07
  o New features (major):
    - Clients don't download or use the directory anymore. Now they
      download and use network-statuses from the trusted dirservers,
      and fetch individual server descriptors as needed from mirrors.
      See dir-spec.txt for all the gory details.
    - Be more conservative about whether to advertise our DirPort.
      The main change is to not advertise if we're running at capacity
      and either a) we could hibernate or b) our capacity is low and
      we're using a default DirPort.
    - Use OpenSSL's AES when OpenSSL has version 0.9.7 or later.
  o New features (minor):
    - Try to be smart about when to retry network-status and
      server-descriptor fetches. Still needs some tuning.
    - Stop parsing, storing, or using running-routers output (but
      mirrors still cache and serve it).
    - Consider a threshold of versioning dirservers (dirservers who have
      an opinion about which Tor versions are still recommended) before
      deciding whether to warn the user that he's obsolete.
    - Dirservers can now reject/invalidate by key and IP, with the
      config options "AuthDirInvalid" and "AuthDirReject". This is
      useful since currently we automatically list servers as running
      and usable even if we know they're jerks.
    - Provide dire warnings to any users who set DirServer; move it out
      of torrc.sample and into torrc.complete.
    - Add MyFamily to torrc.sample in the server section.
    - Add nicknames to the DirServer line, so we can refer to them
      without requiring all our users to memorize their IP addresses.
    - When we get an EOF or a timeout on a directory connection, note
      how many bytes of serverdesc we are dropping. This will help
      us determine whether it is smart to parse incomplete serverdesc
      responses.
    - Add a new function to "change pseudonyms" -- that is, to stop
      using any currently-dirty circuits for new streams, so we don't
      link new actions to old actions. Currently it's only called on
      HUP (or SIGNAL RELOAD).
    - On sighup, if UseHelperNodes changed to 1, use new circuits.
    - Start using RAND_bytes rather than RAND_pseudo_bytes from
      OpenSSL. Also, reseed our entropy every hour, not just at
      startup. And entropy in 512-bit chunks, not 160-bit chunks.
  o Fixes on 0.1.1.7-alpha:
    - Nobody ever implemented EVENT_ADDRMAP for control protocol
      version 0, so don't let version 0 controllers ask for it.
    - If you requested something with too many newlines via the
      v1 controller protocol, you could crash tor.
    - Fix a number of memory leaks, including some pretty serious ones.
    - Re-enable DirPort testing again, so Tor servers will be willing
      to advertise their DirPort if it's reachable.
    - On TLS handshake, only check the other router's nickname against
      its expected nickname if is_named is set.
  o Fixes forward-ported from 0.1.0.15:
    - Don't crash when we don't have any spare file descriptors and we
      try to spawn a dns or cpu worker.
    - Make the numbers in read-history and write-history into uint64s,
      so they don't overflow and publish negatives in the descriptor.
  o Fixes on 0.1.0.x:
    - For the OS X package's modified privoxy config file, comment
      out the "logfile" line so we don't log everything passed
      through privoxy.
    - We were whining about using socks4 or socks5-with-local-lookup
      even when it's an IP in the "virtual" range we designed exactly
      for this case.
    - We were leaking some memory every time the client changes IPs.
    - Never call free() on tor_malloc()d memory. This will help us
      use dmalloc to detect memory leaks.
    - Check for named servers when looking them up by nickname;
      warn when we'recalling a non-named server by its nickname;
      don't warn twice about the same name.
    - Try to list MyFamily elements by key, not by nickname, and warn
      if we've not heard of the server.
    - Make windows platform detection (uname equivalent) smarter.
    - It turns out sparc64 doesn't like unaligned access either.

@_date: 2005-09-09 23:34:34
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.6-alpha is out 
This is the sixth development snapshot for the 0.1.1.x series. It
fixes some bugs in 0.1.1.5-alpha, and adds new features including exit
enclaves, improved hidden service speed, remote reachability detection
by the dirservers, fixes to let the Tor network bootstrap again, and a
start on the new directory design.
Changes in version 0.1.1.6-alpha - 2005-09-09
  o Fixes on 0.1.1.5-alpha:
    - We broke fascistfirewall in 0.1.1.5-alpha. Oops.
    - Fix segfault in unit tests in 0.1.1.5-alpha. Oops.
    - Fix bug with tor_memmem finding a match at the end of the string.
    - Make unit tests run without segfaulting.
    - Resolve some solaris x86 compile warnings.
    - Handle duplicate lines in approved-routers files without warning.
    - Fix bug where as soon as a server refused any requests due to his
      exit policy (e.g. when we ask for localhost and he tells us that's
      127.0.0.1 and he won't do it), we decided he wasn't obeying his
      exit policy using him for any exits.
    - Only do openssl hardware accelerator stuff if openssl version is
      at least 0.9.7.
  o New controller features/fixes:
    - Add a "RESETCONF" command so you can set config options like
      AllowUnverifiedNodes and LongLivedPorts to "". Also, if you give
      a config option in the torrc with no value, then it clears it
      entirely (rather than setting it to its default).
    - Add a "GETINFO config-file" to tell us where torrc is.
    - Avoid sending blank lines when GETINFO replies should be empty.
    - Add a QUIT command for the controller (for using it manually).
    - Fix a bug in SAVECONF that was adding default dirservers and
      other redundant entries to the torrc file.
  o Start on the new directory design:
    - Generate, publish, cache, serve new network-status format.
    - Publish individual descriptors (by fingerprint, by "all", and by
      "tell me yours").
    - Publish client and server recommended versions separately.
    - Allow tor_gzip_uncompress() to handle multiple concatenated
      compressed strings. Serve compressed groups of router
      descriptors. The compression logic here could be more
      memory-efficient.
    - Distinguish v1 authorities (all currently trusted directories)
      from v2 authorities (all trusted directories).
    - Change DirServers config line to note which dirs are v1 authorities.
    - Add configuration option "V1AuthoritativeDirectory 1" which
      moria1, moria2, and tor26 should set.
    - Remove option when getting directory cache to see whether they
      support running-routers; they all do now. Replace it with one
      to see whether caches support v2 stuff.
  o New features:
    - Dirservers now do their own external reachability testing of each
      Tor server, and only list them as running if they've been found to
      be reachable. We also send back warnings to the server's logs if
      it uploads a descriptor that we already believe is unreachable.
    - Implement exit enclaves: if we know an IP address for the
      destination, and there's a running Tor server at that address
      which allows exit to the destination, then extend the circuit to
      that exit first. This provides end-to-end encryption and end-to-end
      authentication. Also, if the user wants a .exit address or enclave,
      use 4 hops rather than 3, and cannibalize a general circ for it
      if you can.
    - Permit transitioning from ORPort=0 to ORPort!=0, and back, from the
      controller. Also, rotate dns and cpu workers if the controller
      changes options that will affect them; and initialize the dns
      worker cache tree whether or not we start out as a server.
    - Only upload a new server descriptor when options change, 18
      hours have passed, uptime is reset, or bandwidth changes a lot.
    - Check [X-]Forwarded-For headers in HTTP requests when generating
      log messages. This lets people run dirservers (and caches) behind
      Apache but still know which IP addresses are causing warnings.
  o Config option changes:
    - Replace (Fascist)Firewall* config options with a new
      ReachableAddresses option that understands address policies.
      For example, "ReachableAddresses *:80,*:443"
    - Get rid of IgnoreVersion undocumented config option, and make us
      only warn, never exit, when we're running an obsolete version.
    - Make MonthlyAccountingStart config option truly obsolete now.
  o Fixes on 0.1.0.x:
    - Reject ports 465 and 587 in the default exit policy, since
      people have started using them for spam too.
    - It turns out we couldn't bootstrap a network since we added
      reachability detection in 0.1.0.1-rc. Good thing the Tor network
      has never gone down. Add an AssumeReachable config option to let
      servers and dirservers bootstrap. When we're trying to build a
      high-uptime or high-bandwidth circuit but there aren't enough
      suitable servers, try being less picky rather than simply failing.
    - Our logic to decide if the OR we connected to was the right guy
      was brittle and maybe open to a mitm for unverified routers.
    - We weren't cannibalizing circuits correctly for
      CIRCUIT_PURPOSE_C_ESTABLISH_REND and
      CIRCUIT_PURPOSE_S_ESTABLISH_INTRO, so we were being forced to
      build those from scratch. This should make hidden services faster.
    - Predict required circuits better, with an eye toward making hidden
      services faster on the service end.
    - Retry streams if the exit node sends back a 'misc' failure. This
      should result in fewer random failures. Also, after failing
      from resolve failed or misc, reset the num failures, so we give
      it a fair shake next time we try.
    - Clean up the rendezvous warn log msgs, and downgrade some to info.
    - Reduce severity on logs about dns worker spawning and culling.
    - When we're shutting down and we do something like try to post a
      server descriptor or rendezvous descriptor, don't complain that
      we seem to be unreachable. Of course we are, we're shutting down.
    - Add TTLs to RESOLVED, CONNECTED, and END_REASON_EXITPOLICY cells.
      We don't use them yet, but maybe one day our DNS resolver will be
      able to discover them.
    - Make ContactInfo mandatory for authoritative directory servers.
    - Require server descriptors to list IPv4 addresses -- hostnames
      are no longer allowed. This also fixes some potential security
      problems with people providing hostnames as their address and then
      preferentially resolving them to partition users.
    - Change log line for unreachability to explicitly suggest /etc/hosts
      as the culprit. Also make it clearer what IP address and ports we're
      testing for reachability.
    - Put quotes around user-supplied strings when logging so users are
      more likely to realize if they add bad characters (like quotes)
      to the torrc.
    - Let auth dir servers start without specifying an Address config
      option.
    - Make unit tests (and other invocations that aren't the real Tor)
      run without launching listeners, creating subdirectories, and so on.

@_date: 2005-09-10 16:29:41
@_author: Roger Dingledine 
@_subject: Tor errors 
It looks like your https proxy told you "Proxy Error ( SSL port specified
is not allowed. )"
Presumably this means that your https proxy only allows you to ask for
certain SSL ports.
See the third paragraph of
Is there some way we can make this clearer for the next person? Since
every https proxy probably has its own error strings (and heck, probably
some use 502 and some use other error numbers), it's probably hard for
us to automatically detect the error string and explain to the user what
it means.
I guess my only idea is to force you to read every line in that FAQ
entry. :)
Hope that helps,

@_date: 2005-09-13 00:04:43
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.6-alpha is out 
Thanks, Matt. Good catch. We've put this fix into cvs, along with a few
more. We'll put out a 0.1.1.7-alpha, uhm, sometime. :)

@_date: 2005-09-13 00:41:14
@_author: Roger Dingledine 
@_subject: (FWD) Re: Dirserver believes your ORPort is unreachable 
[Forwarding because Marcel isn't subscribed to the list from
this address. Marcel, can you fix this one way or another please?
As for your question...hm. Can you describe what exactly is going wrong
for you, and what exactly fixes it? I get the feeling your actions might
be a coincidence...for example, does it all fix itself if you wait a
little while? -RD]

@_date: 2005-09-14 10:50:37
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.7-alpha is out 
This is the seventh development snapshot for the 0.1.1.x series. It
is mainly a bugfix release.
Changes in version 0.1.1.7-alpha - 2005-09-14
  o Fixes on 0.1.1.6-alpha:
    - Exit servers were crashing when people asked them to make a
      connection to an address not in their exit policy.
    - Looking up a non-existent stream for a v1 control connection would
      cause a segfault.
    - Fix a seg fault if we ask a dirserver for a descriptor by
      fingerprint but he doesn't know about him.
    - SETCONF was appending items to linelists, not clearing them.
    - SETCONF SocksBindAddress killed Tor if it fails to bind. Now back
      out and refuse the setconf if it would fail.
    - Downgrade the dirserver log messages when whining about
      unreachability.
  o New features:
    - Add Peter Palfrader's check-tor script to tor/contrib/
      It lets you easily check whether a given server (referenced by
      nickname) is reachable by you.
    - Numerous changes to move towards client-side v2 directories. Not
      enabled yet.
  o Fixes on 0.1.0.x:
    - If the user gave tor an odd number of command-line arguments,
      we were silently ignoring the last one. Now we complain and fail.
      [This wins the oldest-bug prize -- this bug has been present since
       November 2002, as released in Tor 0.0.0.]
    - Do not use unaligned memory access on alpha, mips, or mipsel.
      It *works*, but is very slow, so we treat them as if it doesn't.
    - Retry directory requests if we fail to get an answer we like
      from a given dirserver (we were retrying before, but only if
      we fail to connect).
    - When writing the RecommendedVersions line, sort them first.
    - When the client asked for a rendezvous port that the hidden
      service didn't want to provide, we were sending an IP address
      back along with the end cell. Fortunately, it was zero. But stop
      that anyway.
    - Correct "your server is reachable" log entries to indicate that
      it was self-testing that told us so.

@_date: 2005-09-19 20:35:18
@_author: Roger Dingledine 
@_subject: privoxy test request 
Hi Giorgos,
You might find that some of your slow-down is due to trying to route
your traffic through your Tor server. Tor servers that are running near
their capacity try to be fair to all their users, and won't give you
any special treatment. This might mean that you're seeing more slow-down
than people who have their Tor client to themselves.
Try just running a Tor client + privoxy separately from your Tor server,
and let us know if you get better (or worse) performance.

@_date: 2005-09-20 23:11:03
@_author: Roger Dingledine 
@_subject: portable Tor 
You can specify your own torrc location by using "-f torrc" on
the command line.
(If your operating system doesn't handle command-lines easily, maybe a
batch file or something is an ok workaround.)

@_date: 2005-09-23 01:26:59
@_author: Roger Dingledine 
@_subject: portable Tor 
Yes, that's what DataDirectory is for.
Please read through the man page. There are many options you can
put in your torrc. If you're on OS X, Linux, BSD, Solaris, etc,
you can read man pages natively ("man tor"). If you're on another OS
(such as Windows), you will have to make do with our html version at

@_date: 2005-09-24 19:34:56
@_author: Roger Dingledine 
@_subject: (FWD) port 587 
Anybody know the answer here?
(The first answer is "probably not everybody will block it, so
I doubt it will go away entirely in any case.")

@_date: 2005-09-25 05:35:44
@_author: Roger Dingledine 
@_subject: TorCP 0.0.3 is out 
Hi Matt,
Great to see you're making progress with this. I would recommend that you
phase out talking about running Tor as a service on the TorCP web page,
since that seems to be something we should discourage now that we've
got torcp. It sounds like we should even change the FAQ entry to just
point to torcp and not mention this whole "move stuff into different
directories and then run this obscure command-line thing" idea.
I'll also encourage you to spend time at each release on updating the
text and screenshots on the webpage, since they are what most people will
think torcp is. I've slowly been learning my lesson about this from the
Tor releases. :)
Also, I noticed on that you list the copyright as 2004-2005 Roger Dingledine, Nick
Mathewson, but the Tor LICENSE file says
Copyright (c) 2001-2005 Roger Dingledine
Copyright (c) 2004-2005 Nick Mathewson
It's probably worth mentioning the earlier years in the copyright too.
Looking great so far.

@_date: 2005-09-27 15:54:38
@_author: Roger Dingledine 
@_subject: Wikipedia & Tor 
To be fair, this answer is yes. People have used Tor to deface Wikipedia
pages, along with Slashdot pages, certain IRC networks, and so on. I
think that counts as spam at least in a broad sense.
As I understand it, Jimmy is hoping that we will develop and maintain
this notion. We would run both "halves" of the Tor network, and when they
complain about a user, we would cut that user out of the authenticated
Jimmy and I talked about Tor-and-Wikipedia many months ago, and the
conclusion was that they (mediawiki) would be willing to try a variety of
technological solutions to see if they work (i.e. cut down on vandalism
and aren't too much of a burden to run). My favorite is to simply have
certain address classes where the block expires after 15 minutes or
so. Brandon Wiley proposed a similar idea but where the block timeout is
exponentially longer for repeated abuse, so services that are frequently
blocked will stay blocked longer. This is great. But somebody needs to
actually code it.
Wikipedia already needs this sort of thing because of AOL IPs -- they
have similar characteristics to Tor, in that a single IP produces lots
of behavior, some good some bad. The two differences as I understand
them are that AOL will cancel user accounts if you complain loudly enough
(but there's constant tension here because in plenty of cases AOL decides
not to cancel the account, so Wikipedia has to deal some other way like
temporarily blocking the IP), and that it's not clear enough to the
Wikipedia operators that there *are* good Tor users.
(One might argue that it's hard for Wikipedia to change their perception
and learn about any good Tor uses, firstly because good users will
blend in and nobody will notice, and secondly because they've prevented
them all from editing so there are no data points either way.)
So I've been content to wait and watch things progress. Perhaps we will
find a volunteer who wants to help hack the mediawiki codebase to be more
authentication-friendly (or have more powerful blocking config options).
Perhaps we'll find a volunteer to help build the blind-signature
pseudonymous authenticated identity management infrastructure that Nick
refers to. Perhaps the Wikimedia operators will increasingly get a sense
that Tor has something to offer besides vandalism. (I presume this thread
re-surfaced because Tor users and operators are periodically telling
Wikipedia that they don't like being blocked.) Maybe we will come to
the point eventually that it makes sense to do something different than
blocking the Tor IP addresses from editing Wikipedia. (Which, we should
all remember compared the Gentoo forum situation, is a great step above
blocking them from both reading and writing.)
It could be that we never reach that point. Certain services on the
Internet (like some IRC networks) that are really prone to abuse are
probably doing the right thing by blocking all Tor users (and all AOL
users, and all open proxies, and ...). And we want to keep Tor easy
to block, or we're really going to start getting the other communities
angry at us.
In summary, I'm not too unhappy with the status quo for now. Tor needs
way more basic development / usability work still. In the absence of
actual volunteers-who-code on the side of Tor _or_ Wikipedia to resolve
the problem, I'm going to focus on continuing to make Tor better, so
down the road maybe we'll be able to see better answers.

@_date: 2005-09-02 22:00:53
@_author: Roger Dingledine 
@_subject: Greetings/Question - Was: RE: Have some consideration for users... 
Tor servers publish an "uptime" in their server descriptor, which is
the time they've been available/working at their current IP.
If servers die suddenly, Tor circuits that use them are broken. If
somebody is using one of those circuits (e.g. for his irc connection),
then it gets cut.
Tor clients have a config option "LongLivedPorts" which defaults to
"21,22,706,1863,5050,5190,5222,5223,6667,8300,8888". If a socks request
asks for one of these ports, then it uses a circuit constructed entirely
of nodes with uptimes of at least a day. The theory is that if they've
been up that long, they'll probably be up a while longer.
So for things like port 80 where the request is typically quite quick,
a flaky node is fine, since it's either up during the request or it's not
(in which case we'll keep building circuits until we get one that works).
The answer to your question is "If your node is always like this, then
it's probably not worth while to run a Tor node. But if it's fine for
most days and it has this behavior one afternoon a week, then it's useful
to have it."
Hope that helps,

@_date: 2005-09-03 04:08:14
@_author: Roger Dingledine 
@_subject: (FWD) OpenBSD port broke server 
[Forwarding because David isn't subscribed to the list from this
address. David, please either subscribe as this address, or post from
the address that is subscribed.
To answer your question, I recommend you avoid the OpenBSD Tor port,
or ask them to actually maintain it. Try installing Tor from source. -RD]

@_date: 2005-09-29 15:41:09
@_author: Roger Dingledine 
@_subject: TOR Park Exit Node Question 
This is probably because the two fastest Tor exit nodes right now
are in .nl.
The Tor network is made up of volunteers. If you want more diversity,
go find us some more nodes. :)

@_date: 2005-09-03 09:36:06
@_author: Roger Dingledine 
@_subject: (FWD) Re: (FWD) OpenBSD port broke server 
[Forwarding again because this is sent from an address that isn't
subscribed to the list.
I'm surprised you're running OpenBSD if you want to run up-to-date
versions of things. :)
The problem is likely that you have two libevents installed: an obsolete
one in /usr/lib/ and a new one in /usr/local/lib/. If this is the case,
install the new one into /usr/lib/, or use the CPPFLAGS and LDFLAGS
trick at the bottom of If this doesn't fix it, blow away your old libevent more thoroughly.
The keys-changing thing is likely caused by changing your default
DataDirectory. Figure out where the ports tor puts it by default,
and then copy over the relevant files:
Hope that helps. Feel free to send mail to the ports maintainer (and I
use that term loosely) asking why the package isn't up to date.  -RD]

@_date: 2005-09-30 18:46:01
@_author: Roger Dingledine 
@_subject: Why some Tor servers are slow (was Re: TOR Park Exit Node Question) 
Tonga is using dual AMD64's. Moria also uses those CPUs. They seem to
be extremely fast at crypto (and everything else).
Tonga also advertises port 80 and 443, so it's useful for people
stuck behind fascist firewalls.
Tonga also opened up its exit policy to attract more traffic. Servers
that have lots of unused capacity, and are fast and have high uptime, and
offer unusual ports like the default file-sharing ports, will bootstrap
themselves by advertising a little bit, attracting more clients, and
so on.
(I'm not sure I actually like the fact that Tonga opened up its file
sharing ports, since it puts more load on the rest of the network too,
but I guess since we're still in development, a little bit of stress
like this can be good for us.)
Actually, the default MaxAdvertisedBandwidth is 128 TB. I believe
you're thinking of BandwidthRate.
There is something wrong with the masquerade Tor server. You can see it
yourself (you may have to try from someplace other than masquerade's LAN,
though) -- run "telnet 155.207.113.227 9001" and hit enter about 10 times.
Notice how it's really sluggish and takes a long time before it hangs up.
Now run "telnet 82.94.251.206 443" and do the same thing. Notice how it
realizes the ssl handshake has failed after about 5 lines. This is how
it's supposed to be.
So masquerade is somehow not putting much attention into its ssl
handshakes. This could be because its network connection is actually
through a proxy or a firewall that is dropping some of the packets or
slowing things down tremendously. It could also be that it's running on
a 100 mhz 486, or its ulimits are set to something crazy-low, or it's
busy ray-tracing a movie, or something else.
I'd be curious to learn what's up with it. I've seen this behavior before
on Windows machines behind cable modems and crappy NAT boxes.

@_date: 2005-09-07 18:25:04
@_author: Roger Dingledine 
@_subject: Tor-0.1.1.5-alpha-cvs: Segmentation Fault. 
Please check out
Hrm, this isn't very useful. Perhaps there is something wrong with your
gdb install. It might work better to get a core file and then run gdb
on that.

@_date: 2005-09-08 17:29:53
@_author: Roger Dingledine 
@_subject: AllowedUnverifiedNodes 
Thanks for spotting this bug.
In the upcoming 0.1.1.6-alpha release, there will be a new controller
command "RESETCONF AllowUnverifiedNodes" which will return it to its
default ("middle,rendezvous").
The command "SETCONF AllowUnverifiedNodes" will set it to "".
You will also be able to set it to "" in your torrc by putting the
line "AllowUnverifiedNodes" by itself in your torrc.

@_date: 2005-09-09 03:34:21
@_author: Roger Dingledine 
@_subject: Does tor still leak memory? 
Can you provide a bit more detail -- for example, does this only happen
for hostnames that shouldn't resolve to anything? Does it happen for
hostnames that you know should resolve to something?
Turn on info-err logging to a file:
and see if there's a pattern to which exit node you're using when you
get redirected. This is noisy, but look for log lines like:
Sep 09 03:25:57.516 [info] circuit_log_path(): exit circ (length 3): tor26(open) bolanda(open) sorot(open)
Sep 09 03:25:57.516 [info] connection_ap_handshake_send_begin(): Address/port sent, ap socket 13, n_circ_id 13032
In this case sorot was my exit node.
My guess is that some Tor server out there has a broken DNS resolver,
and it's tricking you into getting a different page than you intended.
(If only the Internet had ubiquitous dnssec and https...)
If you can narrow down which server it is, we can take some steps to
fix it.

@_date: 2005-09-09 15:12:05
@_author: Roger Dingledine 
@_subject: Does tor still leak memory? 
Ah ha.
I believe the misbehaving DNS resolver is yours. :)
I've observed that some Windows machines have weird behavior where
sometimes they return 127.0.0.1 when they don't have a better answer.
This is a problem when those nodes run as exit nodes, since then you get
their local web site, whatever it is. In your case you aren't using Tor
at all for your browsing, but you're seeing the same effect.
Does this sound plausible? Can you track down whether your computer
really did get told to go try the website at 127.0.0.1?
I'd love to know more details here, since this has been a question
for a while.
"Maybe." If the website keeps track of who you are with certificates,
as it should, then no. If it keeps track with cookies, then also no.
But if it keeps track of who you are by your IP address, then this may
be possible.
But note that very few websites do this, because there are many situations
besides Tor where a single IP "is" many people. Corporate firewalls,
DHCP users, and AOL users come to mind. So if you find a website that
does, you should already be suspicious of its security.
Hope this helps,

@_date: 2006-04-24 12:42:59
@_author: Roger Dingledine 
@_subject: Wiki about usage of vservers still up to date? / What are descriptors? 
Some companies selling "vservers" give you enough file descriptors,
but they limit the buffer space to some very small amount.
This trend is not a coincidence -- the goal of the vserver scam is to
sell you something that you think will work and then it turns out to
have lots of weird artificial limits. You could try asking "Can I run a
popular website from this account?", but it likely won't be that easy,
because many support people either don't understand that vservers are
a scam, or they are in on it themselves.
Now, vserver accounts are fine if you just want to log in and read your
mail or something. So they do have a use. The problem is that the people
who market them make a point of not being clear about what they can and
can't do.

@_date: 2006-04-04 00:05:26
@_author: Roger Dingledine 
@_subject: OS X support document suggestions 
Actually, the page does talk about both Firefox and plugins. Can you
provide a patch that makes it clearer for you that it does? :)
Right. We need to make this clearer. (Ideally we would do something
more than simply document the brokenness, but I'm not sure what.)
I'm hoping that we can stop doing screenshots of proxy config windows
at all, and just switch to Torbutton. Is this naive?

@_date: 2006-04-06 20:49:34
@_author: Roger Dingledine 
@_subject: Tor t-shirt 
Just to be clear, this mail was sent almost a year ago, and I'm told
EFF has roughly zero of these shirts left. Nobody has made a new batch.
I'm working with EFF so we can let people send checks to EFF rather than
to me for Tor donations, which would mean the checks for Tor would be
tax-exempt. There has been talk of doing another batch of Tor shirts and
treating them like they treat the EFF shirts -- for people who donate
past a certain threshold they can get a "free" shirt back if they want.
I'm ok funding a batch if they end up approximately paying for themselves
eventually. Is this something we should do? It's always good seeing more
Tor shirts at Tor talks. :)

@_date: 2006-04-09 05:31:11
@_author: Roger Dingledine 
@_subject: AW: Circuit failure after IP changes 
This bug is fixed in 0.1.1.18-rc (to be released soon) I hope.
No, that's a manual process, both to add it and to remove it.

@_date: 2006-04-10 18:07:21
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.18-rc is out 
This is the fourth release candidate for the 0.1.1.x series.
Please let us know if you find bugs, because I expect only one
more release candidate before the real thing.
It adds a fifth authoritative directory server, and fixes a lot
of bugs in threshold decisions around directories.
Changes in version 0.1.1.18-rc - 2006-04-10
  o Major fixes:
    - Work harder to download live network-statuses from all the
      directory authorities we know about. Improve the threshold
      decision logic so we're more robust to edge cases.
    - When fetching rendezvous descriptors, we were willing to ask
      v2 authorities too, which would always return 404.
  o Minor fixes:
    - Stop listing down or invalid nodes in the v1 directory. This will
      reduce its bulk by about 1/3, and reduce load on directory
      mirrors.
    - When deciding whether a router is Fast or Guard-worthy, consider
      his advertised BandwidthRate and not just the BandwidthCapacity.
    - No longer ship INSTALL and README files -- they are useless now.
    - Force rpmbuild to behave and honor target_cpu.
    - Avoid warnings about machine/limits.h on Debian GNU/kFreeBSD.
    - Start to include translated versions of the tor-doc-*.html
      files, along with the screenshots. Still needs more work.
    - Start sending back 512 and 451 errors if mapaddress fails,
      rather than not sending anything back at all.
    - When we fail to bind or listen on an incoming or outgoing
      socket, we should close it before failing. otherwise we just
      leak it. (thanks to weasel for finding.)
    - Allow "getinfo dir/status/foo" to work, as long as your DirPort
      is enabled. (This is a hack, and will be fixed in 0.1.2.x.)
    - Make NoPublish (even though deprecated) work again.
    - Fix a minor security flaw where a versioning auth dirserver
      could list a recommended version many times in a row to make
      clients more convinced that it's recommended.
    - Fix crash bug if there are two unregistered servers running
      with the same nickname, one of them is down, and you ask for
      them by nickname in your EntryNodes or ExitNodes. Also, try
      to pick the one that's running rather than an arbitrary one.
    - Fix an infinite loop we could hit if we go offline for too long.
    - Complain when we hit WSAENOBUFS on recv() or write() too.
      Perhaps this will help us hunt the bug.
    - If you're not a versioning dirserver, don't put the string
      "client-versions \nserver-versions \n" in your network-status.
    - Lower the minimum required number of file descriptors to 1000,
      so we can have some overhead for Valgrind on Linux, where the
      default ulimit -n is 1024.
  o New features:
    - Add tor.dizum.com as the fifth authoritative directory server.
    - Add a new config option FetchUselessDescriptors, off by default,
      for when you plan to run "exitlist" on your client and you want
      to know about even the non-running descriptors.

@_date: 2006-04-12 18:15:03
@_author: Roger Dingledine 
@_subject: Fwd: [Dailydave] Who do I have to pay to get The Big Manual of Thread Safety distributed to the EFF? 
Hi Dave, others,
"tsocks" is not written by us. It is the best program out there that we
could find to do a small piece of what needs to be done, on a few OSes.
See  for
a few others.
Rewriting all the applications on the Internet to be more robust and more
privacy-safe is on our todo list, but it may take a while, and we have
important things to get to first:
While am I'm at it, "the EFF" never was and still isn't the people who
develop Tor. But I admit that does make your rant better. :)
Check out
for some initial patches we've been collecting. If you want to put a
bounty out to fix certain properties of tsocks, you should be specific
about what you want done, and maybe somebody will take you up on it.
Hope that helps,

@_date: 2006-04-12 18:27:39
@_author: Roger Dingledine 
@_subject: getting tor to start at boot on mac osx 
I vaguely recall that we fixed our os x package a while ago, because it
wasn't starting somethingerother at boot. Did you try the latest package
(0.1.1.18-rc)? If that works and 0.1.0.17 doesn't, please let us know.

@_date: 2006-04-02 06:22:52
@_author: Roger Dingledine 
@_subject: Update: Torbutton 1.0.1 
I've just changed the Tor installation docs to recommend Torbutton rather
than SwitchProxy: If you all could please give it a try and let us know if you can find
any compatibility problems, bugs, etc, that would be great. I'd like to
get all the issues worked out so we can have a stable plugin to recommend.

@_date: 2006-04-15 22:45:40
@_author: Roger Dingledine 
@_subject: possible security hole(unsure)(really minor) 
points to the ones that exist.
It is becoming increasingly clear that we should write a spec for "how
Tor chooses paths". This is not necessary to build a compatible Tor,
but it is necessary to understanding what security we're getting, and
to understanding what should change.
I plan to get to this sometime in late 2006 at this point. I would
welcome some help (in fact, it's often better when somebody who didn't
write the code specifies what it appears to be doing -- this uncovers
a lot of problems). Thumbing through circuitbuild.c is a good first step.

@_date: 2006-04-21 22:39:26
@_author: Roger Dingledine 
@_subject: (FWD) Re: IP resolving 
[Forwarding since Dennis isn't subscribed to the list as this
address -RD]

@_date: 2006-04-23 17:13:05
@_author: Roger Dingledine 
@_subject: Number of processes and memory allocation 
Another explanation is that the small one is hibernating, meaning it
killed all its worker processes. When it wakes up it will respawn them.
The number of processes is 1 + the number of dns workers + the number
of cpuworkers.
The number of cpuworkers is typically 1, but you can control it with
the NumCpus torrc option. The number of dnsworkers is three to start,
and then Tor tries to be smart depending on how many DNS resolve requests
it's getting at once.

@_date: 2006-08-15 22:49:07
@_author: Roger Dingledine 
@_subject: Tor bug?: AllowInvalidNodes 
True. I've been eyeing those servers for a while now. I believe the
correct fix (rather than trying to hunt down the operator(s)) is to put
in the patch that's been on the TODO for a while, to treat nodes in the
same /16 as in the same family, even if they don't explicitly volunteer
that information.
Hopefully that will be in rsn, depending on when we get time to actually
do dev work. :}

@_date: 2006-08-16 00:03:16
@_author: Roger Dingledine 
@_subject: Tor bug?: AllowInvalidNodes 
Ok, I bit the bullet and just added that patch to the current svn
trunk. Feel free to upgrade if you want what might be more security for
this case. :)

@_date: 2006-08-16 13:42:17
@_author: Roger Dingledine 
@_subject: Tor bug?: AllowInvalidNodes 
The fundamental confusion here is that the word 'invalid' means many
things to many people, but it means pretty much nothing to Tor. The
exit.pl script that Geoff wrote and runs on Serifos uses the phrase "not
a valid Tor server" to mean "not a Tor server as far as I know". The
word "valid" with respect to the AllowInvalidNodes config option is
simply defined as "not manually designed by the directory authorities
as invalid".
The reason why serifos's exit.pl script is confused as to whether these
particular IP addresses are Tor servers is because they publishes one
IP but their traffic comes out another one. This is common practice for
multi-homed servers, and there are other networking features that make
it plausible too.
We have no master way of deciding whether a server is safe or not. Once
upon a time, we demanded that I had met each server operator personally.
That turned out to scale even less well than I had expected it to. So
the answer now is to aim to grow the Tor network large enough that few
adversaries are big enough to be able to attack it "well". There are also
some research avenues that seem promising but have a lot of hurdles yet
to overcome (e.g. That said, I suggest you forget all about the AllowInvalidNodes config
option. It's not in the sample torrc that we ship. It barely exists
Hope that helps,

@_date: 2006-08-16 15:28:53
@_author: Roger Dingledine 
@_subject: LOTS of messages: "package_window 0. Skipping" 
You're meant to view your logs at level "notice" or higher. Anything
more verbose than that is quite verbose indeed. :)
(This particular case is normal behavior for a Tor with lots of
socks or exit connections that uses BandwidthRate.)

@_date: 2006-08-18 15:10:59
@_author: Roger Dingledine 
@_subject: Tor bug?:  AllowInvalidNodes 
Thank you for your bug report. I've updated the man page entry for
The meaning of "unverified" changed in the 0.1.0.3-rc release on
April 8, 2005: It was then included in the 0.1.0.10 stable release in June 2005:
This is why we write, and announce, ChangeLogs. I'm sorry that you were
confused. However, we really do need to spend our limited time working
on Tor, not explaining to people about Tor. We are happy that in some
cases volunteers have stepped up to help out with the latter.
Please remember that almost 600 people (would like to) read every
message that goes to or-talk. Please keep messages on-topic, civil,
and *concise*.
You are showing many characteristics of being a troll, and trying to
incite flamewars. I know you may be upset, but you don't have a right
to insult or yell at people here. You do have a couple of useful points
(like the bug report above), but the manner in which you present them
is very offensive.
You started the name-calling and accusations; please stop or I'm afraid
I will remove you from the list to preserve what little signal-to-noise
ratio we still have.

@_date: 2006-08-18 17:47:03
@_author: Roger Dingledine 
@_subject: following on from today's discussion 
[Dropping the or-dev CC since this isn't related to Tor development]
Actually, look at
It is an open legal question -- that is, there's no clear precedent with
respect to Tor servers -- but it's probably not wise to just assume that
it's legal. Also, remember that there are many jurisdictions out there,
and they all have their own complex laws.
I agree. Somebody should write a clear introduction to Tor, what it does,
and what it doesn't do. One day that somebody will be me, but I would
welcome some early versions to help me along.
The reason I haven't emphasized the issue so far is that I think you're
overstating the protection ordinary users get from the Internet as it
is. For example, if you're on a local network with other users (often
including everybody in your neighborhood for cablemodem systems), you're
not in very good shape. Tor solves this issue, and for many users it's
a huge issue.
Then there's the question of the Internet infrastructure itself --
your Internet packets travel over a wide variety of places on the way
to their destination. Sometimes packets get mis-routed to, well, pretty
much anywhere. The chance that any hop along the way is able to observe
them -- for example because of a crooked employee, but also because some
Russian cracker 0wns a computer nearby in the path -- is hard to estimate
in general, but from studying botnets and dealing with net security for
the past decade or so, I don't feel it's as low as you imply.
All that said, I agree with you that most of the danger is probably at
the endpoints of the communication -- on the path from you to your entry
Tor node, and on the path from your exit node to your destination. Tor
solves the first issue and changes the second issue -- possibly for the
worse, depending on your situation.
So barring any actual data about the security of the Internet as a whole,
which seems hard to get, I still stick with my answer from
If you're not using end-to-end encryption, then you're in bad shape,
whether you use Tor (and are exposed to one set of risks) or don't use
Tor (and are exposed to a different set of risks).

@_date: 2006-08-18 18:47:18
@_author: Roger Dingledine 
@_subject: following on from today's discussion 
Doesn't Firefox already include this warning when you try to use plaintext
auth protocols on the Internet in general? Or heck, when you try to POST
data to a non-ssl webpage at all?
Also consider that in many countries, the ISPs are the government or are
in cahoots with the government (more countries than we might think, alas),
and many users are not too thrilled about being tracked and observed by
their government.
Even if you trust your government completely, then you're still not safe:
with the advent of data retention, there are an increasing number of
juicy databases sitting around waiting to be stolen, backed up to the
wrong location, lost, freely give out information to people without a
suitable warrant, etc.
On the one hand, in many cases ISPs have a strong financial incentive to
not be too obvious about their snooping, so you are right to expect that
they won't be so public and broad-sweeping with their attacks. On the
other hand, if torxunixguxru is the toughest adversary that Tor users
are up against, I'd be delighted.
It's certainly hard to pin down the exact risks here -- there are
clearly huge risks on both sides. Somebody should write up a clear
concise explanation, perhaps based on some statements from this thread. :)

@_date: 2006-08-18 20:28:42
@_author: Roger Dingledine 
@_subject: Polipo web proxy (was Re: Tor and Google Image search) 
Exciting. Thanks for tracking this down.
What I'd like to do actually is move to some other http proxy one day.
(I once dreamed of taking the http proxy out of the loop entirely now that
Firefox supports safe socks, but it turns out that the entire networking
component of Firefox blocks during socks handshakes, so that is not an
option until somebody does a major overhaul of Firefox.)
I am thinking Polipo is a nice next option:
I've been using it the past month or two with good success. Can other
people here give it a try and see if we can clean it up? (You will need
the latest development version.)
Known issues when using Polipo with Tor:
1) In the config.sample, it suggests
socksParentProxy = "localhost:9050"
You should either change this to 127.0.0.1:9050, or enable the
dnsUseGethostbyname config option -- otherwise polipo asks your name
servers where "localhost" is, with possibly disastrous implications.
2) Polipo doesn't do as much application-level scrubbing as Privoxy tries
to do. But Privoxy isn't very good at it anymore anyway, and Firefox
is getting better. See previous threads about all the Firefox plugins
you need so you can discard Privoxy -- I recommend Noscript, Adblock,
and Adblock Filterset.G.
3) I've seen some funny behavior from its caching. But Privoxy also
gives funny behavior. And Polipo breaks fewer sites than Privoxy does. :)
4) It crashes (albeit rarely). The developer knows and is looking for
more clues.
5) I've never tried it on Windows. I don't think its developer has either.
6) Polipo writes your hostname in every request. Either define proxyName
to something else, or set DisableVia = true in your config file.
See also

@_date: 2006-08-18 21:01:20
@_author: Roger Dingledine 
@_subject: Polipo web proxy (was Re: Tor and Google Image search) 
Polipo can do this too. Just set both your parentProxy and your

@_date: 2006-08-19 02:47:47
@_author: Roger Dingledine 
@_subject: following on from today's discussion 
Correct. Woe is the day when a malicious Tor exit node also has a stolen
or purchased copy of a trusted CA's key.
But you're right, chaos can be had without even that extreme. This is
why Tor's packages (and other security packages) come with gpg signatures.
The Internet can be a scary place. And Tor users need to be even more
aware of this fact than ordinary Internet users. Part of what we need
to do is educate the world about all the security issues with being
an ordinary user on the Internet. (I don't think Tor introduces any
new attacks -- after all, here I am using my open wireless to get to my
shared cablemodem in my apartment in Cambridge, and I'd better be aware
of all sorts of possible attacks -- but it does change which attacks
you can expect to encounter.)
The next thing we need to do is continue to work on interfaces and
usability for end-user applications like Firefox. What does that lock
mean really? If I do (or don't) see the lock, what should I trust? How
can we make use of the plethora of anti-phishing schemes currently
under research?
And lastly, there's the issue of advocacy for authentication, integrity,
and confidentiality on the Internet in general. Translation: we need to
get everybody using SSL for everything.
Might be that Blossom is useful for you here (with a few tweaks). Or see
 for more general
options. It's tricky to automate this idea and make it usable because
you'd also have to remember which application connection was involved,
since several different exit nodes can be active at the same time, for
example if they have different exit policies. And that's not something
that is simple to do and still be as safe.

@_date: 2006-08-01 22:37:59
@_author: Roger Dingledine 
@_subject: Tor Question 
It could be a really long time. The reason for this is that you probably
spend the first n minutes downloading pieces of the directory, and Tor
isn't really set up to prioritize circuit-building during this process.
(In fact, for security reasons you shouldn't try to build circuits
until you have the whole directory, because if you take any actions
before that, the adversary will know what servers you know about and
what servers you don't know about.)
Making Tor suitable for dial-up is on our list, but there are a lot of
things on our list and this is a hard one to do right.
You will probably want to include the new Tor 0.1.1.23 stable release;
the official announcement is pending on getting win32 packages though,
so it isn't quite ready for you yet.

@_date: 2006-08-21 22:47:32
@_author: Roger Dingledine 
@_subject: tor trying to pop mail from random IPs on win32 
What version of Tor? What version of Windows? Have you changed your
Tor configuration at all, e.g. are you a Tor server?
If you are just a Tor client, perhaps there was a Tor server running
on 218.46.74.116:110? There's no rule that traffic on port 110 will
necessarily be pop traffic. But I don't think there was a Tor server at
that address.
If you were a Tor server, perhaps somebody tried to connect to port 110
via you?
It's unlikely that this is a rogue or zombie Tor. More likely, it is a
hyperactive anti-virus program. But, hard to say without more details.

@_date: 2006-08-22 22:49:29
@_author: Roger Dingledine 
@_subject: Polipo web proxy 
If you're talking about section 14.45 of RFC 2616
then it doesn't seem to require any uniqueness. (This is good, since
Polipo adds a "Via: 1.1 localhost.localdomain" header for my browsing,
and I'd guess I'm not the only one of those out there. :)
So if you want to follow the RFC, would it be adequate to use the
pseudonym "polipo" in each case?
This approach is dangerous because it lets websites track Tor users by
this unique ID. This is exactly what we'd like to avoid: each Tor user
is recognizable later on, based on having the same name, even if he has
changed to a new exit node. A more subtle example of this attack would
happen if you decided to list the version of Polipo in the Via header --
then websites could narrow down which hits aren't from the same user.
So the two solutions that come to mind are to use a brand new random
string for every page, or to pick a string that everybody uses. The
latter approach seems less prone to error.
Hope this helps,

@_date: 2006-08-27 21:37:04
@_author: Roger Dingledine 
@_subject: Holy shit I caught 1 
It's a node in China. It looks like it's not actually aiming for Tor --
rather, this fellow's Internet connection is attacking him, and Tor gets
attacked too.
I recall hearing stories about gatherings in east Asian countries suddenly
finding all their https connections man-in-the-middled.
Fortunately, Firefox catches it, and complains -- but unfortunately,
nobody takes the complaints seriously anymore.
Thanks for setting this up.
I've been meaning to integrate an 'exit traffic comparison scheme'
inside the directory authorities, so they not only check reachability,
but they check whether certain sites are retrieved accurately from you
if you're an exit node. Then you are listed as 'not running' (or not
listed at all) if you're found to be funny-looking.
But I obviously haven't gotten around to this yet. Feel free to beat me
to it.
In the mean time, it looks like we need to start a policy of what Tor
servers don't get included in the directory. We can exclude servers by
key, by nickname, and by IP address/netmask. Another option is to label
them as invalid, which will cause (correctly behaving) Tors to use them
only for untrusted locations in the path. Sounds like that's the best plan
for now. Let us know if you find others and we'll treat them similarly.
I don't. Good question.

@_date: 2006-08-27 21:42:46
@_author: Roger Dingledine 
@_subject: .onion 
gives you a link
to the hidden wiki, which is the canonical hidden service site:
My first example hidden service is still up too:

@_date: 2006-08-27 23:23:03
@_author: Roger Dingledine 
@_subject: Holy shit I caught 1 
Actually, it would be smarter to add a controller interface to let
the controller inform Tor of new opinions it should have. For example,
"this server is not running". Then we could do all the smarts in the
controller, where they should be.
The actual interface will be a bit delicate though, since we want Tor
to do some of the thinking and the controller to do other of the thinking.
As a first step though, we could make the controller changes sticky,
meaning that Tor doesn't do any thinking for servers that the controller
has given it an opinion on.
Any better ideas out there?
Check out
Also check out Geoff's python Tor controller (which uses the above
scripts) at

@_date: 2006-08-28 04:14:09
@_author: Roger Dingledine 
@_subject: Holy shit I caught 1 
I noticed from your earlier statement that you're using the v1 directory
format. This is obsolete, and any v1 directories you may run across
will likely not contain complete information anymore (this includes the
output of the scripts at serifos, which haven't been upgraded yet). See
 for the v2 format
(introduced in Tor 0.1.1.x), which involves fetching network-statuses
and server descriptors independently.
If you want your Tor controller to have up to date descriptors and
network statuses, you can
1) Read them out of the $datadir yourself, from "cached-routers*" and
2) Listen for "newdesc" events, and ask us why there is no "newstatus"
event. (Good point, I've just put that on the todo list.)
3) Send "getinfo desc/all-recent" and "getinfo network-status". This
won't give you the full set of network-status strings though.
4) Turn on your dirport and send "getinfo dir/status/all" and
"getinfo dir/server/all".
Personally, I would go for  Note that for any of these, you may want
to set your FetchUselessDescriptors torrc variable (see man page).
(I'm using Tor 0.1.2.1-alpha. I don't recall if all of these are
implemented in the 0.1.1.x series, but it's possible they're not.)
Yep. Especially if you help us figure out what interface you want. :)

@_date: 2006-08-28 15:42:13
@_author: Roger Dingledine 
@_subject: Patch: tor-0.1.1.23 spuriously killed slow directory connections 
Hi Adam,
Good catch. I've adapted your patch here:
It's in svn trunk now, and will be in 0.1.1.24 whenever
that comes out.

@_date: 2006-08-29 04:41:35
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.1-alpha is out 
This is the first development snapshot for the 0.1.2.x series. It features
an asynchronous DNS library from Adam Langley, better performance and
memory overhead for clients and servers, and more.
(Windows bundles aren't ready yet, since none of the developers have
Windows these days; they'll be up...sometime.)
Changes in version 0.1.2.1-alpha - 2006-08-27
  o Major features:
    - Add "eventdns" async dns library from Adam Langley, tweaked to
      build on OSX and Windows. Only enabled if you pass the
      --enable-eventdns argument to configure.
    - Allow servers with no hostname or IP address to learn their
      IP address by asking the directory authorities. This code only
      kicks in when you would normally have exited with a "no address"
      error. Nothing's authenticated, so use with care.
    - Rather than waiting a fixed amount of time between retrying
      application connections, we wait only 5 seconds for the first,
      10 seconds for the second, and 15 seconds for each retry after
      that. Hopefully this will improve the expected user experience.
    - Patch from Tup to add support for transparent AP connections:
      this basically bundles the functionality of trans-proxy-tor
      into the Tor mainline. Now hosts with compliant pf/netfilter
      implementations can redirect TCP connections straight to Tor
      without diverting through SOCKS. Needs docs.
    - Busy directory servers save lots of memory by spooling server
      descriptors, v1 directories, and v2 networkstatus docs to buffers
      as needed rather than en masse. Also mmap the cached-routers
      files, so we don't need to keep the whole thing in memory too.
    - Automatically avoid picking more than one node from the same
      /16 network when constructing a circuit.
    - Revise and clean up the torrc.sample that we ship with; add
      a section for BandwidthRate and BandwidthBurst.
  o Minor features:
    - Split circuit_t into origin_circuit_t and or_circuit_t, and
      split connection_t into edge, or, dir, control, and base structs.
      These will save quite a bit of memory on busy servers, and they'll
      also help us track down bugs in the code and bugs in the spec.
    - Experimentally re-enable kqueue on OSX when using libevent 1.1b
      or later. Log when we are doing this, so we can diagnose it when
      it fails. (Also, recommend libevent 1.1b for kqueue and
      win32 methods; deprecate libevent 1.0b harder; make libevent
      recommendation system saner.)
    - Start being able to build universal binaries on OS X (thanks
      to Phobos).
    - Export the default exit policy via the control port, so controllers
      don't need to guess what it is / will be later.
    - Add a man page entry for ProtocolWarnings.
    - Add TestVia config option to the man page.
    - Remove even more protocol-related warnings from Tor server logs,
      such as bad TLS handshakes and malformed begin cells.
    - Stop fetching descriptors if you're not a dir mirror and you
      haven't tried to establish any circuits lately. [This currently
      causes some dangerous behavior, because when you start up again
      you'll use your ancient server descriptors.]
    - New DirPort behavior: if you have your dirport set, you download
      descriptors aggressively like a directory mirror, whether or not
      your ORPort is set.
    - Get rid of the router_retry_connections notion. Now routers
      no longer try to rebuild long-term connections to directory
      authorities, and directory authorities no longer try to rebuild
      long-term connections to all servers. We still don't hang up
      connections in these two cases though -- we need to look at it
      more carefully to avoid flapping, and we likely need to wait til
      0.1.1.x is obsolete.
    - Drop compatibility with obsolete Tors that permit create cells
      to have the wrong circ_id_type.
    - Re-enable per-connection rate limiting. Get rid of the "OP
      bandwidth" concept. Lay groundwork for "bandwidth classes" --
      separate global buckets that apply depending on what sort of conn
      it is.
    - Start publishing one minute or so after we find our ORPort
      to be reachable. This will help reduce the number of descriptors
      we have for ourselves floating around, since it's quite likely
      other things (e.g. DirPort) will change during that minute too.
    - Fork the v1 directory protocol into its own spec document,
      and mark dir-spec.txt as the currently correct (v2) spec.
  o Major bugfixes:
    - When we find our DirPort to be reachable, publish a new descriptor
      so we'll tell the world (reported by pnx).
    - Publish a new descriptor after we hup/reload. This is important
      if our config has changed such that we'll want to start advertising
      our DirPort now, etc.
    - Allow Tor to start when RunAsDaemon is set but no logs are set.
    - When we have a state file we cannot parse, tell the user and
      move it aside. Now we avoid situations where the user starts
      Tor in 1904, Tor writes a state file with that timestamp in it,
      the user fixes her clock, and Tor refuses to start.
    - Fix configure.in to not produce broken configure files with
      more recent versions of autoconf. Thanks to Clint for his auto*
      voodoo.
    - "tor --verify-config" now exits with -1(255) or 0 depending on
      whether the config options are bad or good.
    - Resolve bug 321 when using dnsworkers: append a period to every
      address we resolve at the exit node, so that we do not accidentally
      pick up local addresses, and so that failing searches are retried
      in the resolver search domains. (This is already solved for
      eventdns.) (This breaks Blossom servers for now.)
    - If we are using an exit enclave and we can't connect, e.g. because
      its webserver is misconfigured to not listen on localhost, then
      back off and try connecting from somewhere else before we fail.
  o Minor bugfixes:
    - Start compiling on MinGW on Windows (patches from Mike Chiussi).
    - Start compiling on MSVC6 on Windows (patches from Frediano Ziglio).
    - Fix bug 314: Tor clients issued "unsafe socks" warnings even
      when the IP address is mapped through MapAddress to a hostname.
    - Start passing "ipv4" hints to getaddrinfo(), so servers don't do
      useless IPv6 DNS resolves.
    - Patch suggested by Karsten Loesing: respond to SIGNAL command
      before we execute the signal, in case the signal shuts us down.
    - Clean up AllowInvalidNodes man page entry.
    - Claim a commonname of Tor, rather than TOR, in TLS handshakes.
    - Add more asserts to track down an assert error on a windows Tor
      server with connection_add being called with socket == -1.
    - Handle reporting OR_CONN_EVENT_NEW events to the controller.
    - Fix misleading log messages: an entry guard that is "unlisted",
      as well as not known to be "down" (because we've never heard
      of it), is not therefore "up".
    - Remove code to special-case "-cvs" ending, since it has not
      actually mattered since 0.0.9.
    - Make our socks5 handling more robust to broken socks clients:
      throw out everything waiting on the buffer in between socks
      handshake phases, since they can't possibly (so the theory
      goes) have predicted what we plan to respond to them.

@_date: 2006-08-30 03:59:46
@_author: Roger Dingledine 
@_subject: Holy shit I caught 1 
Yes, but only if you click "accept" when your Firefox tells you that
somebody is spoofing the site.
I often click accept when a site gives me a bogus certificate, because
I want to see the page anyway -- but if I do I know that I shouldn't
expect any security from the site anymore.
(And if you're using a browser that doesn't give you warnings for
bogus certificates... you should switch. :)

@_date: 2006-08-01 23:11:59
@_author: Roger Dingledine 
@_subject: Tor Question 
Correct. Windows doesn't have signals, so there is no concept of sending
a sighup to a Windows process.
We fake this by letting you connect on the controlport and send the string
"signal hup", aka "signal reload". Then Tor behaves as though you just
sent it a unix-style signal.
Any circuit that's currently using that node breaks. So if a user has a
long-term IRC or IM connection on that circuit, she gets disconnected.
Tor will automatically recover and build new circuits, but the application
will have to reconnect over the new circuit.
We try to tolerate nodes that appear and disappear frequently, by avoiding
them when building circuits for destination ports that we expect will
want high uptime: see LongLivedPorts in your manual page. After all,
servers will have to disappear and reappear periodically.
But if they aren't online very long, new clients won't have time to hear
about them from the directories, so we won't be able to make good use
of them. This is another item on our list of hard things that ought to
be fixed. :)
Why do you ask?

@_date: 2006-08-05 10:20:58
@_author: Roger Dingledine 
@_subject: Configured hibernation does not work after restart in an interval? 
Yes, that's what it means.
Is your DataDirectory writable by your Tor process? Is your Tor
process creating and upating a file called "bw_accounting" in the
DataDirectory? What OS, and did you install from package or source,
and did you change anything? Any other warnings in your Tor log?

@_date: 2006-08-05 10:45:19
@_author: Roger Dingledine 
@_subject: different IP address for each request? 
The short answer is that we don't want you to do that. The reason is that
you'd be building a new circuit for every request, and building a circuit
puts a non-trivial load on the Tor servers. If everybody tried to build
new circuits often, most circuits would fail to be built (because the
Tor servers can't keep up), all the Tor servers would run at 100% cpu,
which would ultimately cause the operators to stop running the servers.
We know this, because a few years back we experienced it. At that point
the default amount of time for rotating circuits was 30 seconds, rather
than 10 minutes.
While I'm at it, there's another point to make. Tor only rebuilds a
circuit if the previous one has been used. So we don't put any load
on the network except when we're actually browsing the web or whatever
we're doing. This lets the available Tor servers (700 or so) time-share
over the number of users (several hundred thousand, but not all active
at the same time). So the critical lesson is that we need to make sure
that the tools we write that help us use Tor don't make frequent requests
to Tor while we're not actively using it.
Hope that helps,

@_date: 2006-08-05 10:51:35
@_author: Roger Dingledine 
@_subject: 1 Mb d/l on startup.. can this be avoided? 
You're right -- Tor doesn't work well currently for people on modems and
people with extreme bandwidth constraints. That's on our todo list too,
and we hope to get to it within the next year -- feel free to help. :)

@_date: 2006-08-05 10:58:18
@_author: Roger Dingledine 
@_subject: exit node DNS crashes [was Re: low bandwidth utilization] 
If anybody experiences this with the 0.1.1.23 release, please let me
know. We fixed one big bug here, but I'm not sure if we fixed all of
them. :)

@_date: 2006-12-15 00:10:58
@_author: Roger Dingledine 
@_subject: tor log file function 
Tor wants each option to be of the form
  key value
That is, it needs to receive the value part, "notice file tor.log",
all as one element on the argv array.
On most modern OSes, this is easy -- you just put it in quotes, and
your shell takes care of doing the right thing. That might work for
Windows too, I'm not sure.
PidFile has no effect on Windows. We'd be happy to accept a patch that
makes it do something smart. I'm not sure what that should be.

@_date: 2006-12-16 15:39:03
@_author: Roger Dingledine 
@_subject: Annoying "wikileaks" message 
I'm going to unsubscribe them now. This should be the last message
they get, until they solve it somehow. :)
Thanks, and sorry for the troubles,

@_date: 2006-12-17 14:58:40
@_author: Roger Dingledine 
@_subject: Facing legal issues 
Hi Florian,
You should contact  and ask this same question.
Maybe you can then suggest to them that they put up a page or two
summarizing what they would answer to people?
I'll be in Berlin in a week or so and will encourage them to do this
then too. But the more encouragement the better. :)

@_date: 2006-12-04 15:25:39
@_author: Roger Dingledine 
@_subject: I2P (was Re: Psiphon (Was: Bootstraping Tor manually to get past the Great Firewall)) 
My opinions on I2P are here:
Alas, that opinion is a couple of years old, but looking over their site,
it looks like it still holds. Perhaps they have been secretly doing
convincing research on anonymity questions since then, but...yeah. :)
It is likely that a few of their design decisions are actually better
than Tor's, but many of them probably aren't, and I have no idea which
are which. The I2P design subscribes to same design approach as Freenet:
"add complexity until it's secure." This is a different mentality than
Tor's "simplify until you know what you have" approach.

@_date: 2006-12-05 12:15:16
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.4-alpha is out 
This is the fourth development snapshot for the 0.1.2.x series. It fixes
some bugs. The Windows and OS X bundles include the new Privoxy 3.0.6.
Changes in version 0.1.2.4-alpha - 2006-12-03
  o Major features:
    - Add support for using natd; this allows FreeBSDs earlier than
      5.1.2 to have ipfw send connections through Tor without using
      SOCKS. (Patch from Zajcev Evgeny with tweaks from tup.)
  o Minor features:
    - Make all connections to addresses of the form ".noconnect"
      immediately get closed. This lets application/controller combos
      successfully test whether they're talking to the same Tor by
      watching for STREAM events.
    - Make cross.sh cross-compilation script work even when autogen.sh
      hasn't been run. (Patch from Michael Mohr.)
    - Statistics dumped by -USR2 now include a breakdown of public key
      operations, for profiling.
  o Major bugfixes:
    - Fix a major leak when directory authorities parse their
      approved-routers list, a minor memory leak when we fail to pick
      an exit node, and a few rare leaks on errors.
    - Handle TransPort connections even when the server sends data before
      the client sends data. Previously, the connection would just hang
      until the client sent data. (Patch from tup based on patch from
      Zajcev Evgeny.)
    - Avoid assert failure when our cached-routers file is empty on
      startup.
  o Minor bugfixes:
    - Don't log spurious warnings when we see a circuit close reason we
      don't recognize; it's probably just from a newer version of Tor.
    - Have directory authorities allow larger amounts of drift in uptime
      without replacing the server descriptor: previously, a server that
      restarted every 30 minutes could have 48 "interesting" descriptors
      per day.
    - Start linking to the Tor specification and Tor reference manual
      correctly in the Windows installer.
    - Add Vidalia to the OS X uninstaller script, so when we uninstall
      Tor/Privoxy we also uninstall Vidalia.
    - Resume building on Irix64, and fix a lot of warnings from its
      MIPSpro C compiler.
    - Don't corrupt last_guessed_ip in router_new_address_suggestion()
      when we're running as a client.

@_date: 2006-12-10 16:49:11
@_author: Roger Dingledine 
@_subject: Tor directory status 
Yep. These are fine. They're just following the advice at
for people who want to advertise ports 80 and 443 without actually
needing local privileges to bind them directly.
In the case of lefkada, it actually offers Tor data if you ask it
correctly (e.g. but it's an ordinary apache too. Setting this up is also described in
the FAQ entry above.
Hope that helps,

@_date: 2006-02-11 20:17:53
@_author: Roger Dingledine 
@_subject: New user question about Directory mirroring & bittorent 
Thanks for the prod. I've just changed the lines in the torrc.sample to:
 Uncomment this to mirror the directory for others. Please do
 if you have enough bandwidth: see the bottom of
 It's fine to leave it commented out. I've just been working on some
ways to let you serve copies of the directory *sometimes* as long as you
don't do it so often that it hurts your connections. Stay tuned for the
0.1.1.14 release.
The only answer I can give is to play around with it until you're happy.
Tor will play pretty well with other network applications. You might have
a problem if you have a really crappy cable modem or router though --
sometimes they can only handle a few connections at a time before they
start to get cranky.

@_date: 2006-02-12 04:44:35
@_author: Roger Dingledine 
@_subject: Circuits still shared? 
No, because a new circuit for every TCP connection is too expensive. For
example, you would open a new circuit for every little 1x1 pixel on the
cnn frontpage. This means it would dramatically slow down Tor for users,
and worse, the public key ops required for making these circuits would
overpower the CPUs of our volunteer servers.
But we've got a new tool for resolving this, if you want to start
experimenting. You can write a Tor controller that intercepts each stream
request and decides, for each destination, which circuit to use.
And see Geoff's Blossom project for an example:
It may be best to first think hard about the tradeoffs of various
approaches to dividing streams over circuits, since optimizing for your
anonymity vs somebody else's donated CPU sounds like a pretty tough
graph to nail down. Let us know when you have some designs and we'll
start thinking about how to analyze and compare them.

@_date: 2006-02-12 04:56:06
@_author: Roger Dingledine 
@_subject: Circuits still shared? 
One option is that we've already got a function in the code:
  /** Go through the circuitlist; for each circuit that starts at us
   * and is dirty, frob its timestamp_dirty so we won't use it for any
   * new streams.
   *
   * This is useful for letting the user change pseudonyms, so new
   * streams will not be linkable to old streams.
   */
  void
  circuit_expire_all_dirty_circs(void)
We could expose this function via the controller interface (maybe
as another signal), and then the controller could have a button to
"change to a new pseudonym." I think this was in the plans at some
point, but it fell off my plate.
This could achieve the goal of not overloading the network. Is it smart
to rely on the human to know when a pseudonym switch is required?

@_date: 2006-02-14 17:13:05
@_author: Roger Dingledine 
@_subject: Error creating network socket: No buffer space available 
You appear to be running Linux:
What Linux in particular?
Are you running on a "virtual server" by any chance?

@_date: 2006-02-18 17:10:26
@_author: Roger Dingledine 
@_subject: Torpark and security 
Yes, you need to talk to your local ISP to do DHCP, etc.
That doesn't sound bad to me.
Right. To communicate on your local network, you specify your origin. It
probably gets stripped by the intermediate networks before it gets to
the Tor entry node, but even if it doesn't, that doesn't matter. The
Tor entry node is allowed to know who you are -- it just doesn't know
where you're going.
Yes, this is possible. If you visit a web page that does a buffer overflow
on your Firefox, then that would be bad. But this sort of attack can
still work despite your firewall. In the normal case, even without Tor,
you connect to the website and the page you get back could overflow
your Firefox and the "firewall" would be none the wiser, since from its
perspective you asked for a page and you got it.
Now, you have a point that the web page won't be arriving at your computer
in the clear so a program that is designed to sniff all your incoming
traffic won't be able to see it. I have no idea how your particular
program works. A common approach among security professionals is to run
secure software and not use an "internet packet firewall" at all -- we
don't believe that they work against real attacks, and we're not
vulnerable to trivial attacks.
Tor fetches directory updates periodically, and caches them to your disk
so it will still have a copy in case you restart.
A hostile ISP cannot spoof a Tor server -- the Tor network uses strong
authentication to make sure you're talking to the Tor servers you wanted
to be talking to. But yes, he could spoof a web page:
We are pretty sure we made that impossible. The design certainly seems
bullet-proof in that regard. But Tor is still young software, so there
might be a bug somewhere.
My thinking is that if people knew how to break the encryption algorithms
that Tor uses, they would first exploit banks and governments, and we'd
hear about it long before they got around to attacking Tor.
It is true that Tor uses moderately small (1024 bit) keys for some of
its public key operations -- we're trying to be fast, and public key
operations with huge keys are too slow currently. You can google for
a wide variety of allegedly expert opinions about the strength of 1024
bit RSA and EDH against well-funded attackers.

@_date: 2006-02-19 02:28:21
@_author: Roger Dingledine 
@_subject: BandwidthRate does this actually work ? 
Were you setting BandwidthBurst as well? The 0.1.0.17 version of Tor
will refuse to send out a directory if your write token bucket is empty,
and it will only be empty if your BandwidthBurst has been exhausted.
So if you set a BandwidthRate of 20 KB, and leave the BandwidthBurst at
the default of 5 MB, it will be a long while until it becomes empty.
Please let me know if that helps,

@_date: 2006-02-02 03:43:23
@_author: Roger Dingledine 
@_subject: an idea about how to improve routing for interactive services 
You're right. We've put this on the roadmap for the 0.1.2 release.
The other piece is that we want to track average amount of time per day
that the server is live, so we know whether it's a suitable choice as
a guard entry node.
Ah. We are not likely to implement this. It seems hard to predict, before
a connection happens, what traffic pattern it will have. Judging by port
may be an ok approximation for now, but it will encourage the trend toward
moving the whole Internet over port 80. Most importantly, middle nodes
don't know the port/address/etc for the streams they're transporting,
and we don't want to get into that fine-grained level of censorship.
Yes, but the increased chance of having a broken connection is bad. It
seems that extending the path length will really hurt your reliability.
As for getting more security from more hops, see
But you're right that long-lived circuits may be more vulnerable. As
far as I know, nobody has done any research on the implications of this
in practice.
We would love to make progress on everything at once. Please help out
(development or funding) and we will focus on this too.

@_date: 2006-02-19 16:44:41
@_author: Roger Dingledine 
@_subject: Exit node blocking site? 
Right now you're degrading service for other Tor users that try to go to
groups.google.com, because you trick them into thinking that it resolves
to something else. Also (and you'll perhaps be more motivated by this), if
the user resolves the address into an IP first, you're not blocking that.
The better answer is to change your exit policy to reflect the addresses
and ports that aren't reachable from your server. Then clients will
learn it from your descriptor and not even try to exit from you.

@_date: 2006-02-21 11:17:03
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.14-alpha is out 
This is the fourteenth development snapshot for the 0.1.1.x series.
It fixes a few more bugs with clients and servers (including a memory
bloating bug for servers) and ties up other loose ends.
Changes in version 0.1.1.14-alpha - 2006-02-20
  o Bugfixes on 0.1.1.x:
    - Don't die if we ask for a stdout or stderr log (even implicitly)
      and we're set to RunAsDaemon -- just warn.
    - We still had a few bugs in the OR connection rotation code that
      caused directory servers to slowly aggregate connections to other
      fast Tor servers. This time for sure!
    - Make log entries on Win32 include the name of the function again.
    - We were treating a pair of exit policies if they were equal even
      if one said accept and the other said reject -- causing us to
      not always publish a new descriptor since we thought nothing
      had changed.
    - Retry pending server downloads as well as pending networkstatus
      downloads when we unexpectedly get a socks request.
    - We were ignoring the IS_FAST flag in the directory status,
      meaning we were willing to pick trivial-bandwidth nodes for "fast"
      connections.
    - If the controller's SAVECONF command fails (e.g. due to file
      permissions), let the controller know that it failed.
  o Features:
    - If we're trying to be a Tor server and running Windows 95/98/ME
      as a server, explain that we'll likely crash.
    - When we're a server, a client asks for an old-style directory,
      and our write bucket is empty, don't give it to him. This way
      small servers can continue to serve the directory *sometimes*,
      without getting overloaded.
    - Compress exit policies even more -- look for duplicate lines
      and remove them.
    - Clients now honor the "guard" flag in the router status when
      picking entry guards, rather than looking at is_fast or is_stable.
    - Retain unrecognized lines in $DATADIR/state file, so that we can
      be forward-compatible.
    - Generate 18.0.0.0/8 address policy format in descs when we can;
      warn when the mask is not reducible to a bit-prefix.
    - Let the user set ControlListenAddress in the torrc.  This can be
      dangerous, but there are some cases (like a secured LAN) where it
      makes sense.
    - Split ReachableAddresses into ReachableDirAddresses and
      ReachableORAddresses, so we can restrict Dir conns to port 80
      and OR conns to port 443.
    - Now we can target arch and OS in rpm builds (contributed by
      Phobos). Also make the resulting dist-rpm filename match the
      target arch.
    - New config options to help controllers: FetchServerDescriptors
      and FetchHidServDescriptors for whether to fetch server
      info and hidserv info or let the controller do it, and
      PublishServerDescriptor and PublishHidServDescriptors.
    - Also let the controller set the __AllDirActionsPrivate config
      option if you want all directory fetches/publishes to happen via
      Tor (it assumes your controller bootstraps your circuits).

@_date: 2006-02-02 19:38:17
@_author: Roger Dingledine 
@_subject: Bandwidth 
Most likely you are counting in fractions of a byte -- for example, bits.
Everything in Tor is counted in whole numbers.
For more details, see

@_date: 2006-02-06 08:01:39
@_author: Roger Dingledine 
@_subject: Prioritizing from source ip? 
Right now the best suggestion is to run two Tor instances -- one
as a server, and one as a client:
One of my plans for the Tor 0.1.2.x roadmap (still a ways off) is to
make it easier to use your Tor server as a client.

@_date: 2006-02-06 08:07:49
@_author: Roger Dingledine 
@_subject: e-gold donations for Tor 
I just got an e-gold account for Tor. See the bottom of

@_date: 2006-02-06 09:53:34
@_author: Roger Dingledine 
@_subject: TLS errors 
Are you sure you're getting them at log-level notice? Usually those
lines are at log-level info, and if so they're harmless.  But if you're
seeing them at 'notice', then there may be other problems -- can you
post a few lines of context? Hopefully the log lines around it will
be self-explanatory.
I'm sorry to hear that. Now might be a fine time to take one of their
admins out for a beer, make a friend, and teach him about Tor. :)

@_date: 2006-02-10 20:05:13
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.13-alpha is out 
This is the thirteenth development snapshot for the 0.1.1.x series.
It fixes several important crash bugs for servers and clients, as well
as a number of big memory bloating problems. This is the best Tor yet!
Changes in version 0.1.1.13-alpha - 2006-02-09
  o Crashes in 0.1.1.x:
    - When you tried to setconf ORPort via the controller, Tor would
      crash. So people using TorCP to become a server were sad.
    - Solve (I hope) the stack-smashing bug that we were seeing on fast
      servers. The problem appears to be something do with OpenSSL's
      random number generation, or how we call it, or something. Let me
      know if the crashes continue.
    - Turn crypto hardware acceleration off by default, until we find
      somebody smart who can test it for us. (It appears to produce
      seg faults in at least some cases.)
    - Fix a rare assert error when we've tried all intro points for
      a hidden service and we try fetching the service descriptor again:
      "Assertion conn->state != AP_CONN_STATE_RENDDESC_WAIT failed"
  o Major fixes:
    - Fix a major load balance bug: we were round-robining in 16 KB
      chunks, and servers with bandwidthrate of 20 KB, while downloading
      a 600 KB directory, would starve their other connections. Now we
      try to be a bit more fair.
    - Dir authorities and mirrors were never expiring the newest
      descriptor for each server, causing memory and directory bloat.
    - Fix memory-bloating and connection-bloating bug on servers: We
      were never closing any connection that had ever had a circuit on
      it, because we were checking conn->n_circuits == 0, yet we had a
      bug that let it go negative.
    - Make Tor work using squid as your http proxy again -- squid
      returns an error if you ask for a URL that's too long, and it uses
      a really generic error message. Plus, many people are behind a
      transparent squid so they don't even realize it.
    - On platforms that don't have getrlimit (like Windows), we were
      artificially constraining ourselves to a max of 1024
      connections. Now just assume that we can handle as many as 15000
      connections. Hopefully this won't cause other problems.
    - Add a new config option ExitPolicyRejectPrivate which defaults to
      1. This means all exit policies will begin with rejecting private
      addresses, unless the server operator explicitly turns it off.
  o Major features:
    - Clients not longer download descriptors for non-running
      descriptors.
    - Before we add new directory authorities, we should make it
      clear that only v1 authorities should receive/publish hidden
      service descriptors.
  o Minor features:
    - As soon as we've fetched some more directory info, immediately
      try to download more server descriptors. This way we don't have
      a 10 second pause during initial bootstrapping.
    - Remove even more loud log messages that the server operator can't
      do anything about.
    - When we're running an obsolete or un-recommended version, make
      the log message more clear about what the problem is and what
      versions *are* still recommended.
    - Provide a more useful warn message when our onion queue gets full:
      the CPU is too slow or the exit policy is too liberal.
    - Don't warn when we receive a 503 from a dirserver/cache -- this
      will pave the way for them being able to refuse if they're busy.
    - When we fail to bind a listener, try to provide a more useful
      log message: e.g., "Is Tor already running?"
    - Adjust tor-spec to parameterize cell and key lengths. Now Ian
      Goldberg can prove things about our handshake protocol more
      easily.
    - MaxConn has been obsolete for a while now. Document the ConnLimit
      config option, which is a *minimum* number of file descriptors
      that must be available else Tor refuses to start.
    - Apply Matt Ghali's --with-syslog-facility patch to ./configure
      if you log to syslog and want something other than LOG_DAEMON.
    - Make dirservers generate a separate "guard" flag to mean,
      "would make a good entry guard". Make clients parse it and vote
      on it. Not used by clients yet.
    - Implement --with-libevent-dir option to ./configure. Also, improve
      search techniques to find libevent, and use those for openssl too.
    - Bump the default bandwidthrate to 3 MB, and burst to 6 MB
    - Only start testing reachability once we've established a
      circuit. This will make startup on dirservers less noisy.
    - Don't try to upload hidden service descriptors until we have
      established a circuit.
    - Fix the controller's "attachstream 0" command to treat conn like
      it just connected, doing address remapping, handling .exit and
      .onion idioms, and so on. Now we're more uniform in making sure
      that the controller hears about new and closing connections.

@_date: 2006-02-10 23:12:41
@_author: Roger Dingledine 
@_subject: 0.1.1.13-alpha problem with libevent-1.1a 
Thanks for letting us know. I've put new versions of the dmg and rpm up.
Let us know if this one is better.
We've got almost entirely new packaging volunteers in the past few
versions (since I don't have Red Hat on my build computers anymore,
and Nick is out of town for a few months and can't build OS X and Win32
packages), and we're still working out some details. This is an alpha
after all. :)

@_date: 2006-01-31 19:48:34
@_author: Roger Dingledine 
@_subject: facility for specifying that a Tor node should not be preferred? 
There is an opposite to ExitNodes -- it's called ExcludeNodes. See
But it doesn't do what you seem to want -- you cannot control how other
Tor users choose their paths, because the exit node does not (should not)
know this information.
Good question. I think our current directory distribution protocol would
hurt if all of the servers have megabyte-long exit policies.
So I guess the answer for that is that rejecting *:80 is the better
plan if those are the choices.
The real answer for universities is to route their subscriptions to things
like Webster and Springer through a proxy server that uses their already
established local auth mechanism (MIT's cert system, Harvard's PIN system,
UCLA's Bruin OnLine system, etc etc). In many cases they *already* have
the proxy system in place for off-campus users, so it's just a matter of
using them in other cases too.
This would free them up from all the fears that their IP space has to be
locked down thoroughly or they'll be breaking some contract somewhere.
Then they could get back to being centers of research and innovation.
But, while some universities are becoming enlightened and heading in
this direction, there are still a lot of scared people out there.

@_date: 2006-01-31 20:28:01
@_author: Roger Dingledine 
@_subject: IDS bells ringing 
I am not surprised by this, but not for the reason you indicate.
Intrusion detection systems suck. All the ones that I know about produce a
huge pile of false positives. Basically, once you start sending packets
around on a variety of protocols, your IDS is going to nutso. This
doesn't mean people are hacking through Tor. (However, with several
hundred thousand active Tor users, I'm sure a bit of bad stuff *is*
happening -- just like elsewhere on the Internet.)
for another way of phrasing this.
Hope that helps,

@_date: 2006-01-03 04:40:27
@_author: Roger Dingledine 
@_subject: benchmarking a node 
The new 0.1.0.16, just released, handles this.
(We'll announce it more widely in a day or so -- on the or-announce
list, which all of you should be on -- once more packages are built.)

@_date: 2006-01-27 19:09:25
@_author: Roger Dingledine 
@_subject: (FWD) quick question on exit policy... 
[Forwarding because Joe is not subscribed as this address.
The answer is yes, this will work fine, but the way you say
it is 128.32.0.0/255.255.0.0:* or 128.32.0.0/16:*

@_date: 2006-01-03 06:30:14
@_author: Roger Dingledine 
@_subject: benchmarking a node 
To get an idea of what your node is doing right now, you could look at
which shows redgene with a max self-measured burst of 847kB/s, and an
average of 337 kB/s in and 339 kB/s out.
You can get the data itself from your descriptor:
 and look
at the write-history and read-history (which are in 15 minute summaries,
oldest to most recent).
To push up these numbers, you need to start sending traffic through it.
One way is to listen on ports like 80 and 443 to attract more users
behind firewalls, and to open up your exit policy more to attract more
users in general. Another way is to run a Tor client on a link that's
faster than your server's, and start transferring a lot of data through
it, e.g. by specifying it as your entrynode. Do several in parallel if
you need to. If you want to get more precise, use a Tor controller like
Blossom to craft a path that uses only your node; and/or run your own
whole Tor network on the server (see FAQ entry).
If anybody can give us a useful backtrace from the crashes in Tor cvs,
that would be wonderful. There's a crash bug that happens for fast
servers and so far we have been unable to track it down.

@_date: 2006-01-30 14:56:29
@_author: Roger Dingledine 
@_subject: whats up with tor?! 
Try upgrading to 0.1.0.16 or later. Or try going to websites
that exist. :)
Really? They seem up to me.

@_date: 2006-01-31 02:55:50
@_author: Roger Dingledine 
@_subject: Socks/TOR setup question 
The port that your error message references (49370) doesn't look like
it's for web browsing.
Do you actually get this with every connection? If so, then you should
be seeing complaints about port 80 also.
Perhaps it is some other application that you are pointing through Tor? It
sounds like you're using Privoxy correctly for your web connections and
you are using other applications which you have failed to mention here
that leak DNS resolves.

@_date: 2006-01-31 02:58:39
@_author: Roger Dingledine 
@_subject: TOR log question 
Interesting. This sounds like a bug somewhere. Did you install
from the latest bundle from the Tor webpage? Are you running Windows XP
SP2, or something else?
1) do these errors happen often?
2) are they repeatable?
3) is the directory there?
4) are the files there?
5) if they're there, what size are they?

@_date: 2006-01-31 03:04:39
@_author: Roger Dingledine 
@_subject: Question about HiddenServices and... 
To run a hidden service, your Tor connects *out*, and then the people
accessing your hidden service use those outbound connections to get
to your service.
This means you can run a hidden service from anywhere that can reach
the Tor network. It doesn't have to have a routable network address.
It's hidden, after all.
Perhaps ask a more concrete question?

@_date: 2006-01-31 03:21:33
@_author: Roger Dingledine 
@_subject: Lots of errors in logs (>300mb) 
These are very serious. They mean that your Tor server is overloaded
and can't keep up with the clients trying to use it. I've just changed
the log message to be more helpful:
"Your computer is too slow to handle this many circuit creation
 requests! Please consider using the MaxAdvertisedBandwidth config
 option or choosing a more restricted exit policy."
Does that help? My best guess is either that you're running on a 20mhz
processor, or you set your exit policy to accept *:*, or both.

@_date: 2006-01-31 03:30:26
@_author: Roger Dingledine 
@_subject: dynamically changable options in torrc? 
See options_transition_allowed() in
Currently everything is allowed to change except PidFile, RunAsDaemon,
DataDirectory, User, Group, and HardwareAccel.
Note that there's a bug in 0.1.1.12-alpha that makes your Tor crash
when you enable ORPort -- this is fixed in CVS.
Sure. For lots more details, see section 3.1 and the end of 3.3 in
and also

@_date: 2006-01-31 03:35:31
@_author: Roger Dingledine 
@_subject: Bandwidth shaping by time of day / week / month? Adding that info to Tor protocol? 
Using one of the 0.1.1.x Tor releases, set "ControlPort 9051" in your
torrc before you start Tor, and then
telnet localhost 9051
setconf bandwidthrate="50 KB"
I'm sure you can automate this process via netcat or the like.
Once you've got your script working, can you publish it here
so others can use it and improve it?

@_date: 2006-01-31 03:42:23
@_author: Roger Dingledine 
@_subject: choosing a syslog facility other than 'daemon' 
Hi Matt,
You're the only person who wants this, as far as I've heard. Did
you have another facility in mind, or did you want to handle all
of them?
I would be pleased to apply a patch. :)

@_date: 2006-01-04 18:34:53
@_author: Roger Dingledine 
@_subject: Running a server on the 80 and 443 ports 
Step 9 of points you to this FAQ entry:
which walks you through setting up port forwarding with iptables, etc.
Hope that helps,

@_date: 2006-01-11 00:12:55
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.11-alpha is out 
This is the eleventh development snapshot for the 0.1.1.x series.
This release implements entry guard nodes: it automatically chooses a
handful of entry nodes and sticks with them for all circuits. The logs
about entry guards are still pretty chatty, but hopefully that will help
us track down any problems. Please let us know whether it works for you.
The release also reduces directory bandwidth overhead substantially,
makes Tor servers with dynamic IP addresses useful again, and makes IRC
and IM connections over Tor more reliable.
Everybody who runs a hidden service should upgrade.
Changes in version 0.1.1.11-alpha - 2006-01-10
  o Crashes in 0.1.1.x:
    - Include all the assert/crash fixes from 0.1.0.16.
    - If you start Tor and then quit very quickly, there were some
      races that tried to free things that weren't allocated yet.
    - Fix a rare memory stomp if you're running hidden services.
    - Fix segfault when specifying DirServer in config without nickname.
    - Fix a seg fault when you finish connecting to a server but at
      that moment you dump his server descriptor.
    - Extendcircuit and Attachstream controller commands would
      assert/crash if you don't give them enough arguments.
    - Fix an assert error when we're out of space in the connection_list
      and we try to post a hidden service descriptor (reported by weasel).
    - If you specify a relative torrc path and you set RunAsDaemon in
      your torrc, then it chdir()'s to the new directory. If you HUP,
      it tries to load the new torrc location, fails, and exits.
      The fix: no longer allow a relative path to torrc using -f.
  o Major features:
    - Implement "entry guards": automatically choose a handful of entry
      nodes and stick with them for all circuits. Only pick new guards
      when the ones you have are unsuitable, and if the old guards
      become suitable again, switch back. This will increase security
      dramatically against certain end-point attacks. The EntryNodes
      config option now provides some hints about which entry guards you
      want to use most; and StrictEntryNodes means to only use those.
    - New directory logic: download by descriptor digest, not by
      fingerprint. Caches try to download all listed digests from
      authorities; clients try to download "best" digests from caches.
      This avoids partitioning and isolating attacks better.
    - Make the "stable" router flag in network-status be the median of
      the uptimes of running valid servers, and make clients pay
      attention to the network-status flags. Thus the cutoff adapts
      to the stability of the network as a whole, making IRC, IM, etc
      connections more reliable.
  o Major fixes:
    - Tor servers with dynamic IP addresses were needing to wait 18
      hours before they could start doing reachability testing using
      the new IP address and ports. This is because they were using
      the internal descriptor to learn what to test, yet they were only
      rebuilding the descriptor once they decided they were reachable.
    - Tor 0.1.1.9 and 0.1.1.10 had a serious bug that caused clients
      to download certain server descriptors, throw them away, and then
      fetch them again after 30 minutes. Now mirrors throw away these
      server descriptors so clients can't get them.
    - We were leaving duplicate connections to other ORs open for a week,
      rather than closing them once we detect a duplicate. This only
      really affected authdirservers, but it affected them a lot.
    - Spread the authdirservers' reachability testing over the entire
      testing interval, so we don't try to do 500 TLS's at once every
      20 minutes.
  o Minor fixes:
    - If the network is down, and we try to connect to a conn because
      we have a circuit in mind, and we timeout (30 seconds) because the
      network never answers, we were expiring the circuit, but we weren't
      obsoleting the connection or telling the entry_guards functions.
    - Some Tor servers process billions of cells per day. These statistics
      need to be uint64_t's.
    - Check for integer overflows in more places, when adding elements
      to smartlists. This could possibly prevent a buffer overflow
      on malicious huge inputs. I don't see any, but I haven't looked
      carefully.
    - ReachableAddresses kept growing new "reject *:*" lines on every
      setconf/reload.
    - When you "setconf log" via the controller, it should remove all
      logs. We were automatically adding back in a "log notice stdout".
    - Newly bootstrapped Tor networks couldn't establish hidden service
      circuits until they had nodes with high uptime. Be more tolerant.
    - We were marking servers down when they could not answer every piece
      of the directory request we sent them. This was far too harsh.
    - Fix the torify (tsocks) config file to not use Tor for localhost
      connections.
    - Directory authorities now go to the proper authority when asking for
      a networkstatus, even when they want a compressed one.
    - Fix a harmless bug that was causing Tor servers to log
      "Got an end because of misc error, but we're not an AP. Closing."
    - Authorities were treating their own descriptor changes as cosmetic,
      meaning the descriptor available in the network-status and the
      descriptor that clients downloaded were different.
    - The OS X installer was adding a symlink for tor_resolve but
      the binary was called tor-resolve (reported by Thomas Hardly).
    - Workaround a problem with some http proxies where they refuse GET
      requests that specify "Content-Length: 0" (reported by Adrian).
    - Fix wrong log message when you add a "HiddenServiceNodes" config
      line without any HiddenServiceDir line (reported by Chris Thomas).
  o Minor features:
    - Write the TorVersion into the state file so we have a prayer of
      keeping forward and backward compatibility.
    - Revive the FascistFirewall config option rather than eliminating it:
      now it's a synonym for ReachableAddresses *:80,*:443.
    - Clients choose directory servers from the network status lists,
      not from their internal list of router descriptors. Now they can
      go to caches directly rather than needing to go to authorities
      to bootstrap.
    - Directory authorities ignore router descriptors that have only
      cosmetic differences: do this for 0.1.0.x servers now too.
    - Add a new flag to network-status indicating whether the server
      can answer v2 directory requests too.
    - Authdirs now stop whining so loudly about bad descriptors that
      they fetch from other dirservers. So when there's a log complaint,
      it's for sure from a freshly uploaded descriptor.
    - Reduce memory requirements in our structs by changing the order
      of fields.
    - There used to be two ways to specify your listening ports in a
      server descriptor: on the "router" line and with a separate "ports"
      line. Remove support for the "ports" line.
    - New config option "AuthDirRejectUnlisted" for auth dirservers as
      a panic button: if we get flooded with unusable servers we can
      revert to only listing servers in the approved-routers file.
    - Auth dir servers can now mark a fingerprint as "!reject" or
      "!invalid" in the approved-routers file (as its nickname), to
      refuse descriptors outright or include them but marked as invalid.
    - Servers store bandwidth history across restarts/crashes.
    - Add reasons to DESTROY and RELAY_TRUNCATED cells, so clients can
      get a better idea of why their circuits failed. Not used yet.
    - Directory mirrors now cache up to 16 unrecognized network-status
      docs. Now we can add new authdirservers and they'll be cached too.
    - When picking a random directory, prefer non-authorities if any
      are known.
    - New controller option "getinfo desc/all-recent" to fetch the
      latest server descriptor for every router that Tor knows about.

@_date: 2006-01-12 00:32:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.12-alpha is out 
This is the twelfth development snapshot for the 0.1.1.x series.
It fixes a bug that prevented Tor servers from accepting connections
from non-servers. If you run a server, you should use this release rather
than 0.1.1.11-alpha.
Changes in version 0.1.1.12-alpha - 2006-01-11
  o Bugfixes on 0.1.1.x:
    - The fix to close duplicate server connections was closing all
      Tor client connections if they didn't establish a circuit
      quickly enough. Oops.
    - Fix minor memory issue (double-free) that happened on exit.
  o Bugfixes on 0.1.0.x:
    - Tor didn't warn when it failed to open a log file.

@_date: 2006-01-02 09:28:30
@_author: Roger Dingledine 
@_subject: Dealing with bad Tor nodes 
Upgrade to the latest 0.1.1.x-alpha and you should see some marked
The upcoming 0.1.0.16 release has several backports from the 0.1.1.x
tree that should make it behave better too.

@_date: 2006-01-22 23:14:32
@_author: Roger Dingledine 
@_subject: an idea about how to improve routing for interactive services 
Actually, we already do something like this. Nodes report their uptime,
and we assume that a long uptime implies that it will stay up.
I'm not sure I understand this part. You are using an external tool to
traffic shape the stuff you send into Tor? Or you are using an external
tool to traffic shape the stuff that exits from your Tor server?
Right, we do this too.
Check out the man page entry:
LongLivedPorts PORTS
  A list of ports for services that tend to have long-running connec-
  tions (e.g. chat and interactive shells). Circuits for streams that
  use  these ports will contain only high-uptime nodes, to reduce the
  chance that a node will go down  before  the  stream  is finished.
  (Default:  21,  22,  706, 1863, 5050, 5190, 5222, 5223, 6667, 8300,
  8888)
In 0.1.0.x, "high-uptime" is defined as "claiming an uptime of at least 24
hours." In 0.1.1.11-alpha, high-uptime is defined as meeting or exceeding
the median uptime of running valid servers. On the current Tor network
this tends to vary between 2 to 3 days.
But this clearly does not totally solve the problem: long-term connections
over Tor do still break. Part of this is because the Tor network is very
young and still quite dynamic, so people are upgrading, restarting their
servers, and so on. There is also clearly a tension between scaling the
network (and thus being more flexible about the volunteers we can make
use of) and providing stable links.
Another nice approach would be to be able to move streams to a new
circuit if the current one dies. But this has its own problems:
What other approaches are there that might work?

@_date: 2006-07-21 17:31:22
@_author: Roger Dingledine 
@_subject: (FWD) french article about tor 
[Forwarding because arno isn't subscribed as this address -RD]

@_date: 2006-07-26 20:00:11
@_author: Roger Dingledine 
@_subject: How to contact the "April3rd team" ? 
Nope -- I believe they submitted only to phase one. If you'd like
to build (or build on) their design, by all means do so. :)

@_date: 2006-07-28 02:04:57
@_author: Roger Dingledine 
@_subject: excludenodes 
Yes, it's a bug. If you choose a node as one of your entry guards,
and later you add it to ExcludeNodes, then it won't be thrown out.
It's on the todo list.
(We didn't pay it much mind, because we don't use ExcludeNodes, and
we're thinking of de-emphasizing it even more. Letting users play with
their routes on a wide scale is probably bad for their anonymity, and
definitely bad for load balancing across servers.)

@_date: 2006-07-07 18:32:06
@_author: Roger Dingledine 
@_subject: Tor & dynamic dns 
I made some substantial reachability fixes in the upcoming 0.1.1.22
stable release. Many packages and such are available for it already on
the Tor download page (I'll be officially announcing it in a day or two
once they're all there). So give that a try and let me know how it does.
No, restarting Tor each time should not be needed. Please put your energy
into helping me fix bugs rather than just working around them. :)

@_date: 2006-07-07 18:38:43
@_author: Roger Dingledine 
@_subject: low bandwidth utilization 
I agree with Nick that it looks like something is being stomped.
See also Have other server operators experienced this?

@_date: 2006-07-11 02:45:33
@_author: Roger Dingledine 
@_subject: Reliability of circuit extension if target server is running a Tor exit node 
Correct, that's how it's implemented right now. The reason is that when
the user types " into their browser, Tor has no idea what its
IP address is, so it doesn't know that your Tor server is the same place.
We could always resolve every site first, just in case it's at the
same place as an exit node, but in most cases this would be a wasted
So we assume that the first request is just the front-page, and probably
not really sensitive. And then once we've cached the IP address for the
destination, future requests become smarter.
It seemed like a good trade-off at the time. If it's a destination that
is really sensitive, you can add a MapAddress line to your torrc.
Are there important example scenarios where this behavior is really

@_date: 2006-07-11 02:57:11
@_author: Roger Dingledine 
@_subject: Finding my exit node 
Option one: get your Vidalia working. Perhaps your ControlPort isn't
enabled, or you're not letting Vidalia launch your Tor, or something.
Option two: install Blossom instead and use that to display what circuits
you're using: Option three: run at log-level info, and look through the logs for the
description of your circuit's path whenever you launch a stream or close
a stream.
Option four: enable your controlport, and telnet localhost 9051,
"authenticate", "setevents circ stream", and match things up manually.
Personally, I'd probably choose option three at this point. But I spend
a lot of time looking through Tor's logs to make sure everything is
working right, so I'm used to them. :)

@_date: 2006-07-13 00:54:27
@_author: Roger Dingledine 
@_subject: Reliability of circuit extension if target server is running  a Tor exit node 
But remember that Tor servers have exit policies, so there's more to it
than saying "you're an exit node" or "you're not an exit node". For
example, some Tor servers might have an exit policy that rejects
everything but connections to their own IP address. Then they can be
used in the way you describe (as a private enclave server, essentially),
but they won't connect to arbitrary destinations.

@_date: 2006-07-15 22:57:27
@_author: Roger Dingledine 
@_subject: Configure TorDNS 
Hi Steven,
Just to make it clear, "TorDNS" isn't written by any of the Tor
developers. In fact, I don't believe any of us have even tested or tried
to run it.
To make it more fun, last I checked, there are multiple programs out there
called TorDNS (none of which are written/tried/etc by the Tor developers).
So, you're on your own here. If you get it working, you might want to
document it better than the author has. :) And look through the source
code to see if it's something you're happy running.
While you're at it, you might want to look at dns-proxy-tor instead:

@_date: 2006-07-16 17:50:16
@_author: Roger Dingledine 
@_subject: Problems running TOR for an extended period 
On your operating system, yes.
If there exists a new version of NetBSD with a reentrant
gethostbyname_r(), let us know and we'll special-case it.

@_date: 2006-07-17 13:33:10
@_author: Roger Dingledine 
@_subject: Sending mail through TOR/Socks 
No, Tor is smarter than that: your Tor client knows the exit policies
of the Tor servers, and it picks an appropriate exit node.
If I had to pick a reason for your problem, it would be that only 2 of
the 700 currently running Tor nodes allow port 25 to exit, and these
are likely on all sorts of SMTP blacklists.

@_date: 2006-06-14 07:38:31
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.20 servers no longer handle dynamic IPs? 
I believe I've fixed the bug. At least, I fixed a big bug. :)
The bug affects servers who publish a valid descriptor with one IP:port,
and then soon after try to test whether they're reachable at a different
IP:port. So it mainly affects servers on dynamic IP addresses.
There's a catch, though -- the bug is in the Tor servers that we're
testing via, not in our own tests. So pretty much the whole deployed
Tor network has this problem. Only Tor servers that have upgraded to
0.1.1.21-cvs or 0.1.2.1-alpha (not yet released) will do the reachability
tests correctly.
I just put a patch into current cvs to prefer nodes running these new
versions when doing reachability tests. So if you update to the latest
cvs, I believe the reachability problems will go away:
I've included a snapshot here, for people who prefer tarballs:
Please let me know if it works / doesn't work for you.

@_date: 2006-06-01 15:17:02
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.20 servers no longer handle dynamic IPs? 
Hi folks,
It seems that Tor 0.1.0.17 correctly handled people running servers
with dynamic IP addresses:
I've gotten a report that Tor 0.1.1.20 does not -- when the IP address
changes, Tor notices, but then it never finds itself reachable. Only
restarting the process fixes it.
Has anybody else experienced this? Or run servers on 0.1.1.20 successfully
using dynamic IP adresses?
Please help me track this down,

@_date: 2006-06-01 04:58:25
@_author: Roger Dingledine 
@_subject: Vidalia 
The short answer is that TorCP was (is) rotting beneath us. The
TorCP developers stopped working on it months ago and started Vidalia
instead. Further, TorCP relies on the old deprecated version 0 controller
protocol (  ) which
Tor has not been maintaining well either.
The bundle is not labelled as stable -- Tor 0.1.1.20 is. You can bundle
it with whatever you like. I left a link to the old TorCP bundle on the
download page too, for people who prefer it.
I should note that none of the Tor developers use Windows, so we rely
on our Windows users to make Tor more usable and stable there.
Ah. That would be Tor that did that. Look for a "torrc.orig.%d"
file nearby, for the backup copy that Tor kept.
When you click 'save' in Vidalia, Vidalia asks Tor to write the new
config to the torrc file.
How's this for a fix: when Tor writes the new torrc file, if it's
replacing an old non-autogenerated torrc, it should include a comment
at the top of the new torrc to go look for the ".orig" file if you want
the old one. Would that have helped to resolve your issue?
More generally, we definitely need to work on usability for servers. It
is still not easy to run a single Tor as both client and server, for
example because the rate limiting kicks in equally for both. That's on
my plate for the 0.1.2 release.
We don't consider either TorCP or Vidalia to be stable. We take
what we can get, though.
Hope that helps,

@_date: 2006-06-01 18:39:04
@_author: Roger Dingledine 
@_subject: tor+torbutton without privoxy doesn't work 
Well, yeah. Your Firefox was still configured to point to Privoxy.
(Answering this question out of order)
It is possible, but I've found it harder to explain to people how to do
it, so we simply recommend using Privoxy. If you want to take Privoxy
out of the loop, check out:
and recognize that you'll probably screw up your configuration,
since there are a lot of "how to do this correctly" questions that
even the Tor developers haven't looked at much yet.
Ah ha, there is a new Torbutton out this week, with new features and
new bugs. Great. Here's a partial list from first playing with it:
* I agree with you that un-clicking "use Privoxy" in the new Torbutton
doesn't seem to work for me either. I'm using Firefox 1.0 in Debian Sarge.
When I un-click "Use Privoxy", it fills in "localhost" "9050" for every
proxy entry. It should just fill it in for the "socks" entry. As it
is now, my Firefox tries to use Tor directly as an http proxy, which
doesn't work.
* When I click "Use custom proxy settings" and remove the "localhost"
and "9050" from the http proxy, and click ok, it doesn't actually
take effect. I need to close firefox and restart and then it does.
* In the "About Torbutton" dialog, it doesn't tell me what version
I'm using. This makes it hard to report bugs well.
* I had to play around with it for a while, but it seems that it turns
Tor off every time I change anything in the "Preferences..." menu. What
I think that really means is that it's displaying the string "Tor
Disabled" when the proxy configuration does not exactly match the one
that we consider safe for Tor. This is great, but now that Torbutton
has multiple configurations that it wants to consider safe, we need to
update the logic for when to display "Tor Disabled".

@_date: 2006-06-02 22:22:51
@_author: Roger Dingledine 
@_subject: what happened to Tor's network? 
The graph is wrong. Tor is still as it was -- slowly growing.
This data comes from reports published by Tor servers about
how much bandwidth they've used lately. The site grabs all the
numbers it can find and adds them up.  But since Tor servers only
publish every 18 hours or so if nothing much has changed, it's
under-reporting for the latest 24 hours -- it only has some of the
data points. That's why there's a linear fall-off at the end of, say,
Peter just changed the code that generates the graph, to not graph the
latest 24 hours. Hopefully this will fix it.

@_date: 2006-06-03 02:58:47
@_author: Roger Dingledine 
@_subject: Vidalia 
Tor never ever looks at the torrc.orig.%d file. It simply renames
torrc to it if the torrc doesn't have the magic string at the top:
 GENERATED_FILE_PREFIX "# This file was generated by Tor; " \
  "if you edit it, comments will not be preserved"
No, Tor totally ignores the torrc.orig.%d file.
What comments imply this? Can you help us fix the wording?

@_date: 2006-06-07 18:10:48
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.20 servers no longer handle dynamic IPs? 
For all those that are experiencing this, it would be great to get debug
logs starting from when you start your Tor server, running Tor 0.1.1.20,
until a ways after you find yourself reachable or several hours pass
The phenomenon as I understand it is that you start your Tor server,
and nearly all testing circuits fail, and eventually one maybe succeeds
after a half hour or an hour, for reasons I haven't figured out yet;
then when your IP address changes, you're back to square one, at best.
I need more data. You can send them to be via personal mail
(compressed). Posting them publically is probably not a good plan.

@_date: 2006-06-08 19:17:11
@_author: Roger Dingledine 
@_subject: "SHTTPD": Windows web-server, light-weight, stand-alone and multi-platform (Unix, etc) 
Hi folks. I hereby kill this thread, before it spirals even more
out of control.
It's dead now. Please don't post any more about it.

@_date: 2006-03-12 14:09:47
@_author: Roger Dingledine 
@_subject: Is there anything in particular I should check for in the log? 
No, they all look fine. One of the features in the upcoming
0.1.1.x release is that the logs are much quieter again. You
might try upgrading to the recent unstable version if you want
quieter logs.

@_date: 2006-03-12 14:30:45
@_author: Roger Dingledine 
@_subject: memory usage slowly rising 
Not necessarily. Using several hundred MB of memory for a fast Tor
server is not out of the question:
That said, I believe there are some memory leaks on the server in the
experimental tree. Valgrind doesn't work on 64 bit, and I don't have any
32 bit servers anymore, so somebody should please valgrind the latest
cvs on a Tor server. Here's how you do it:
Rather than running "src/or/tor", you run
"valgrind --leak-check=yes --error-limit=no src/or/tor"
then it scrolls a whole lot of openssl errors which you ignore, and a
half hour or so later you ^c it, and it gives you a set of "definitely
leaked" and "possibly leaked" backtraces which you should mail to me.
Then I fix a few and we iterate the process.
This only works for 32-bit Linux and only if you know what you're doing.
But hopefully some people out there do. :)
As far as I know, there are two Tor client implementations in Java,
and zero Tor server implementations.

@_date: 2006-03-13 00:22:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.15-rc is out 
This is the first release candidate for the 0.1.1.x series.
It fixes a major bootstrapping bug for clients and adds some more
security improvements. We're fixing a few known bugs, and if you
find others please let us know.
Changes in version 0.1.1.15-rc - 2006-03-11
  o Bugfixes and cleanups:
    - When we're printing strings from the network, don't try to print
      non-printable characters. This protects us against shell escape
      sequence exploits, and also against attacks to fool humans into
      misreading their logs.
    - Fix a bug where Tor would fail to establish any connections if you
      left it off for 24 hours and then started it: we were happy with
      the obsolete network statuses, but they all referred to router
      descriptors that were too old to fetch, so we ended up with no
      valid router descriptors.
    - Fix a seg fault in the controller's "getinfo orconn-status"
      command while listing status on incoming handshaking connections.
      Introduce a status name "NEW" for these connections.
    - If we get a linelist or linelist_s config option from the torrc
      (e.g. ExitPolicy) and it has no value, warn and skip rather than
      silently resetting it to its default.
    - Don't abandon entry guards until they've been down or gone for
      a whole month.
    - Cleaner and quieter log messages.
  o New features:
    - New controller signal NEWNYM that makes new application requests
      use clean circuits.
    - Add a new circuit purpose 'controller' to let the controller ask
      for a circuit that Tor won't try to use. Extend the EXTENDCIRCUIT
      controller command to let you specify the purpose if you're
      starting a new circuit.  Add a new SETCIRCUITPURPOSE controller
      command to let you change a circuit's purpose after it's been
      created.
    - Accept "private:*" in routerdesc exit policies; not generated yet
      because older Tors do not understand it.
    - Add BSD-style contributed startup script "rc.subr" from Peter
      Thoenen.

@_date: 2006-03-18 01:24:39
@_author: Roger Dingledine 
@_subject: write event on a connection 
I'm not sure what you're looking for here. A write event occurs when a
socket is writable, and we start checking whether it's writable when we
have something to write to it. What do you want to know really?

@_date: 2006-03-18 16:05:38
@_author: Roger Dingledine 
@_subject: Update: Torbutton 1.0.1 
This is great. I just installed it on Firefox 1.0.x and it seems
to work fine. Even though the interface is really simple, though,
it probably wants a page of documentation somewhere. Maybe a FAQ:
Q Is there anything to the interface more than this "Tor Disabled" /
  "Tor Enabled" text that I can click? For example, a window with
  settings?
A No, that's the beauty of it. We tried to keep TorButton simple so
  it would just work.
Q I want to change my "No proxy for" line. Do you have a window for
  this, or do I edit my proxy preferences like normal, or what?
Q My Privoxy and/or Tor run on non-standard ports. Do you support this?
Q What is this about "socks_remote_dns"?
Q I want to use Firefox 1.5 and socks_remote_dns and cut privoxy
  out of the loop. Do you support this?

@_date: 2006-03-18 16:07:07
@_author: Roger Dingledine 
@_subject: (FWD) Re: Update: Torbutton 1.0.1 
[And here's another couple of good FAQ questions. -RD]

@_date: 2006-03-18 17:58:38
@_author: Roger Dingledine 
@_subject: How to contact tor-ops? 
Paul Syverson is one of the Tor folks: I believe his mail is down for a day or so.
It shouldn't. We need as many different groups as possible caring
about Tor and wanting anonymity. Anonymous communications on the
Internet is best defended by bringing all parties who want it into
the same camp so they carry more weight. See the first section of
 for some more details.
Hope that helps,

@_date: 2006-03-18 20:02:28
@_author: Roger Dingledine 
@_subject: How to contact tor-ops? 
We've done better than that. Registering your node is only to register
the binding between the nickname that you chose and your key. Tor still
works fine if the binding isn't registered.
See  for details.

@_date: 2006-03-20 01:16:10
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.16-rc is out 
This is the second release candidate for the 0.1.1.x series.
It fixes a variety of odds and ends, including getting started
on making it easier to add new authoritative dirservers.
Changes in version 0.1.1.16-rc - 2006-03-18
  o Bugfixes on 0.1.1.15-rc:
    - Fix assert when the controller asks to attachstream a connect-wait
      or resolve-wait stream.
    - Now do address rewriting when the controller asks us to attach
      to a particular circuit too. This will let Blossom specify
      "moria2.exit" without having to learn what moria2's IP address is.
    - Make the "tor --verify-config" command-line work again, so people
      can automatically check if their torrc will parse.
    - Authoritative dirservers no longer require an open connection from
      a server to consider him "reachable". We need this change because
      when we add new auth dirservers, old servers won't know not to
      hang up on them.
    - Let Tor build on Sun CC again.
    - Fix an off-by-one buffer size in dirserv.c that magically never
      hit our three authorities but broke sjmurdoch's own tor network.
    - If we as a directory mirror don't know of any v1 directory
      authorities, then don't try to cache any v1 directories.
    - Stop warning about unknown servers in our family when they are
      given as hex digests.
    - Stop complaining as quickly to the server operator that he
      hasn't registered his nickname/key binding.
    - Various cleanups so we can add new V2 Auth Dirservers.
    - Change "AllowUnverifiedNodes" to "AllowInvalidNodes", to
      reflect the updated flags in our v2 dir protocol.
    - Resume allowing non-printable characters for exit streams (both
      for connecting and for resolving). Now we tolerate applications
      that don't follow the RFCs. But continue to block malformed names
      at the socks side.
  o Bugfixes on 0.1.0.x:
    - Fix assert bug in close_logs(): when we close and delete logs,
      remove them all from the global "logfiles" list.
    - Fix minor integer overflow in calculating when we expect to use up
      our bandwidth allocation before hibernating.
    - Fix a couple of bugs in OpenSSL detection. Also, deal better when
      there are multiple SSLs installed with different versions.
    - When we try to be a server and Address is not explicitly set and
      our hostname resolves to a private IP address, try to use an
      interface address if it has a public address. Now Windows machines
      that think of themselves as localhost can work by default.
  o New features:
    - Let the controller ask for GETINFO dir/server/foo so it can ask
      directly rather than connecting to the dir port.
    - Let the controller tell us about certain router descriptors
      that it doesn't want Tor to use in circuits. Implement
      SETROUTERPURPOSE and modify +POSTDESCRIPTOR to do this.
    - New config option SafeSocks to reject all application connections
      using unsafe socks protocols. Defaults to off.

@_date: 2006-03-20 03:38:44
@_author: Roger Dingledine 
@_subject: DNS 
See section 2 of
An example that uses it is
Possibly a better plan is to use the controller protocol's MAPADDRESS
command since this can save a round-trip. This is described in the second
task under  and in more detail in
section 1.7 of

@_date: 2006-03-21 13:11:49
@_author: Roger Dingledine 
@_subject: fingerprint wrong 
Sounds like you didn't actually restore the server's identity key,
or you didn't restore it to the right DataDirectory.

@_date: 2006-03-24 14:25:16
@_author: Roger Dingledine 
@_subject: client problem on slow connection 
If you want this to work, try upgrading to 0.1.1.16-rc. The 0.1.1
series still cuts off downloads after a long timeout, but it looks at
the partial download and learns what it can, so it should all work out
eventually. Let me know if it works for you.

@_date: 2006-03-28 20:11:36
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.17-rc is out 
This is the third release candidate for the 0.1.1.x series.
It fixes several major bugs for clients and servers. It also adds
a fourth authoritative directory server (finally).
Changes in version 0.1.1.17-rc - 2006-03-28
  o Major fixes:
    - Clients and servers since 0.1.1.10-alpha have been expiring
      connections whenever they are idle for 5 minutes and they *do*
      have circuits on them. Oops. With this new version, clients will
      discard their previous entry guard choices and avoid choosing
      entry guards running these flawed versions.
    - Fix memory leak when uncompressing concatenated zlib streams. This
      was causing substantial leaks over time on Tor servers.
    - The v1 directory was including servers as much as 48 hours old,
      because that's how the new routerlist->routers works. Now only
      include them if they're 20 hours old or less.
  o Minor fixes:
    - Resume building on irix64, netbsd 2.0, etc.
    - On non-gcc compilers (e.g. solaris), use "-g -O" instead of
      "-Wall -g -O2".
    - Stop writing the "router.desc" file, ever. Nothing uses it anymore,
      and it is confusing some users.
    - Mirrors stop caching the v1 directory so often.
    - Make the max number of old descriptors that a cache will hold
      rise with the number of directory authorities, so we can scale.
    - Change our win32 uname() hack to be more forgiving about what
      win32 versions it thinks it's found.
  o New features:
    - Add lefkada.eecs.harvard.edu as a fourth authoritative directory
      server.
    - When the controller's *setconf commands fail, collect an error
      message in a string and hand it back to the controller.
    - Make the v2 dir's "Fast" flag based on relative capacity, just
      like "Stable" is based on median uptime. Name everything in the
      top 7/8 Fast, and only the top 1/2 gets to be a Guard.
    - Log server fingerprint on startup, so new server operators don't
      have to go hunting around their filesystem for it.
    - Return a robots.txt on our dirport to discourage google indexing.
    - Let the controller ask for GETINFO dir/status/foo so it can ask
      directly rather than connecting to the dir port. Only works when
      dirport is set for now.
  o New config options rather than constants in the code:
    - SocksTimeout: How long do we let a socks connection wait
      unattached before we fail it?
    - CircuitBuildTimeout: Cull non-open circuits that were born
      at least this many seconds ago.
    - CircuitIdleTimeout: Cull open clean circuits that were born
      at least this many seconds ago.

@_date: 2006-03-08 19:00:39
@_author: Roger Dingledine 
@_subject: Firefox extension: TorButton 
I poked at torbutton a bit with my Firefox 1.0.x on Debian Sarge, and
I couldn't get it to install. Perhaps I did something wrong or perhaps
it is not easily compatible that far back.
Trying to be smarter than the users will make them sad. I think the
best plan is to leave this setting alone.
Correct. You should point all the protocols to privoxy (localhost 8118)
including clicking the button, and you should *also* point socks 5 to
tor (localhost 9050). This is for protocols that don't obey the standard
proxy settings but do obey the socks proxy setting.
Bonus points if you set the socks_remote_dns value to true:
but this will only work on some firefoxes so it will make portability
even more exciting. :)

@_date: 2006-05-04 18:41:34
@_author: Roger Dingledine 
@_subject: Tor & DNS Requests 
Socks4a and socks5-with-remote-lookup actually hands the fqdn (aka
hostname) to the socks proxy. Tor in turn hands it to the exit node.
The exit node does a DNS resolve however it sees fit. Then in the response
cell inside the Tor network (either "connected" or "end"), the exit node
includes the IP address that it found for that hostname. This way the Tor
client can cache it for next time, saving future exit nodes from needing
to resolve it, and also allowing the client to compare it to exit policies
(which are written in terms of IP addresses, not in terms of hostnames,
see faq for why).
Standard DNS lookup, however the local system is configured to do it.
No. All Tor nodes, including nodes with an exit policy of reject
*:*, are willing to do DNS resolves for people. Of course, clients
will try to pick nodes that would allow their connection to exit,
so they will tend to avoid using the reject *:* ones -- but when
using our extension to socks to do dns resolves directly (see
 the Tor client is
fine picking a reject-all node, since no traffic will actually be exiting.
Can you suggest some place in the documentation that you would expect
to find these answers? It feels like we already have too many docs,
but obviously there's lots more to say too.
Hope that helps,

@_date: 2006-05-07 04:46:07
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.19-rc is out 
This is the fifth and final release candidate for the 0.1.1.x series.
Please let us know if you find bugs -- if there are no huge problems,
this will turn into the real release.
(As of this mail, the new win32 bundle isn't linked to yet -- I'm hoping
to start linking to the bundle that includes Vidalia rather than TorCP,
since TorCP will soon be obsolete.)
Changes in version 0.1.1.19-rc - 2006-05-03
  o Minor bugs:
    - Regenerate our local descriptor if it's dirty and we try to use
      it locally (e.g. if it changes during reachability detection).
    - If we setconf our ORPort to 0, we continued to listen on the
      old ORPort and receive connections.
    - Avoid a second warning about machine/limits.h on Debian
      GNU/kFreeBSD.
    - Be willing to add our own routerinfo into the routerlist.
      Now authorities will include themselves in their directories
      and network-statuses.
    - Stop trying to upload rendezvous descriptors to every
      directory authority: only try the v1 authorities.
    - Servers no longer complain when they think they're not
      registered with the directory authorities. There were too many
      false positives.
    - Backport dist-rpm changes so rpms can be built without errors.
  o Features:
    - Implement an option, VirtualAddrMask, to set which addresses
      get handed out in response to mapaddress requests. This works
      around a bug in tsocks where 127.0.0.0/8 is never socksified.

@_date: 2006-05-09 05:03:28
@_author: Roger Dingledine 
@_subject: Running a Tor exit node on an academic network? 
Joe has asked me to speculate a bit more about whether it's smart
to have exit policies with thousands of lines in them.
I think the answer is that it is quite bad indeed. Right now compressed
server descriptors are 1K or less; if we increase that by an order of
magnitude, we're going to load the directory system a lot more, making
it stop scaling a lot quicker. (We could tolerate a small number of
nodes doing this, but tragedy of the commons will kick in.) There are
also some other problems having to do with current client behavior --
we evaluate exit policies in a linear way and we don't cache results,
which means if exit policies get a lot longer, clients are going to
start wasting a lot of time looking through them.
So if you're in the position where you have hundreds or thousands of
particular locations that you don't want to allow connections to, the
two options that come to mind are:
* Block them in large chunks rather than in a fine-grained manner. E.g.,
block 128.0.0.0/8:80. Probably not worth your time to maintain the list
since you'll end up blocking much of the Internet anyway.
* Block *:80, since the services you're needing to block probably believe
that port 80 is the whole Internet already. This will decrease your
usefulness to the Tor network, but that's ok, that's why we have other
nodes. If needed, you can block a few other ports (e.g. 443) if those
are used by your libraries too.
Unfortunately, Joe added another restriction, which is that he wants to
do research on "typical" exit behavior, while at the same time being
restricted by his university about what IP addresses are not known to
blindly trust his school's IP space. I stick with my earlier response
to this case:
Hope that helps,

@_date: 2006-05-09 23:41:35
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.19-rc is out 
Hi folks,
I just linked to the 0.0.4 release of the Vidalia/Privoxy/Tor bundle,
for the new recommended Windows package. The bundle includes the latest
Tor release (0.1.1.19-rc). Please grab it and let me know if it's broken.
I hear Vidalia is way nicer than TorCP.
I imagine the Vidalia authors would also be happy to hear feedback on
what parts need the most work. And they would be even happier if somebody
wants to help out with improving it, documenting it, and so on. :)

@_date: 2006-05-10 02:53:50
@_author: Roger Dingledine 
@_subject: TorPark mentioned on BoingBoing 
Hi Steve,
Can you enlighten us about the current status with respect to following
the licenses of Firefox, Portable Firefox, and Tor?
I see that there's a link to a source tarball at the bottom of
 but a) I don't see a license for Tor there,
and b) just copying the licenses for software that is released under the
GPL is not sufficient to follow those licenses. You need to follow section
3 of the GPL: the simplest approach in my opinion is to make the complete
source code available for download from the same site as the binary.
(You may also find it smart to include other documentation/etc files in
the "source" package, since people will look there to obtain everything
they need to recreate your exe, and I'm guessing it doesn't include all
the required files currently.)
It is very important that we resolve this, though. People in the free
software world make their software available with a very specific
set of requirements, and disregarding them makes the whole community
mistrust you.
At least they don't call it TORpark or TORPARK :)

@_date: 2006-05-24 07:42:07
@_author: Roger Dingledine 
@_subject: Aren't exit node names supposed to be unique? 
They have the same nickname, but different keys/owners/etc. As of
Tor 0.1.0.x, nicknames are no longer unique.
This is the whole point of "binding" your nickname to your key via
the directory authorities:
If you use an unnamed nickname (one not already bound by the directory
authorities to a particular key) in ExcludeNodes, etc, Tor will warn
you that you're ambiguous. You should specify it by key, e.g.
"$FF8845046DB449DA989B025AEA1D10E19E709166" for the one in Norway.

@_date: 2006-05-24 09:07:29
@_author: Roger Dingledine 
@_subject: Tor 0.1.1.20 is released 
Yes. See the two sections of the Changelog entitled:
  o Config option fixes:
  o Config option features:
There are a few other new config options scattered throughout the
rest of the changelog too.

@_date: 2006-05-26 14:03:22
@_author: Roger Dingledine 
@_subject: (FWD) How to run tor with Polipo 
[I'm forwarding to the list since Juliusz is not subscribed. -RD]

@_date: 2006-05-11 22:24:15
@_author: Roger Dingledine 
@_subject: (FWD) Re: Recommendation for ISP in Germany? 
[Forwarding because Manuel is not subscribed at this address. -RD]

@_date: 2006-05-12 20:50:49
@_author: Roger Dingledine 
@_subject: (Newbie:) Why use privoxy? 
Note that this case only applies to Firefox 1.5 and after. Those
with earlier versions are still out of luck.
Also, Privoxy provides some other nice privacy-related features, such
as ad blocking, dealing with cookies, and so on. It's not perfect,
but it is much better than nothing. So if you take Privoxy out of the
loop, you should replace all its features with various Firefox plugins
(noscript, something for cookies, adblock and friends, etc).
It is an open question whether there exists a set of compatible Firefox
plugins that can entirely replace Privoxy's functionality. Somebody
should sit down and work out all the details.
Any takers? :)

@_date: 2006-11-19 04:15:18
@_author: Roger Dingledine 
@_subject: ff 1.5.0.7 & 2.0 (remote) dns leaks when using tor 
(Just got back in town, am starting to plow through my mail)
Actually, as far as I know, you should list at least http, https,
and socks. The reason is that some plugins look at one proxy setting,
and some look at others. And alas, some plugins don't look at any,
which might be what you're experiencing.
It "shouldn't" be Torbutton's fault. That's not to say it isn't, but if I
were looking for a problem, Torbutton would be pretty far down on my list.
It just changes Firefox's configuration, after all.
Might well be. We need to test-and-document all configuration
combinations, with all the weird extra software that people use. I
would bet there are a wide variety of seemingly ok combinations that
are actually bad. Plus, there are many seemingly bad combinations that
people don't realize might be bad. :)
Looks good. These are coming from privoxy, which uses socks4a.
Yep. Your thunderbird is talking pop3s, which is not http, so it can't use
the http proxy setting. This is an example of one of the applications I
mentioned above. So if you leave your socks proxy line blank, Thunderbird
will go out directly, even if your http/https proxies are set.
No, I believe your Thunderbird never does any http/https content,
at least not in the examples you've pasted.
My first guess is that you have some other firefox plugin installed that
does a dns lookup for everything you type. What other plugins/extensions
do you have?

@_date: 2006-11-19 04:39:31
@_author: Roger Dingledine 
@_subject: still slow browsing 
Are you trying to use your Tor as both a client and a server? The
bandwidth limits that Tor uses affect all incoming traffic -- so by
setting a bandwidthrate of 20KB/s, you're limiting your incoming traffic
to way less than you could get otherwise.
The temporary fix is to do a bandwidth shaping script like
the one Mike Perry uses (Mike, is this posted somewhere?),
or to run two Tors (one a server, one a client -- see
 for
details, which are alas quite sparse for the case of Windows), or to
turn off the server side for now, or to wait patiently for us to add a
feature (hopefully in 0.1.2.x) that will only rate-limit certain classes
of traffic.
Hope that helps,

@_date: 2006-11-19 19:40:20
@_author: Roger Dingledine 
@_subject: Torbutton 1.0.5 release candidate 
Hi Scott,
Looks pretty good to me. Here's another bug report while we're at it
though: I'm using custom proxy settings currently, because I'm using
Polipo on port 8123. When I click "use the recommended proxy settings"
it moves everything to 8118, which is reasonable, but when I then click
"use custom proxy settings" again, my old custom proxy settings are lost,
and I need to retype them. Maybe Torbutton could remember them somewhere?
This is great. Can you document somewhere how these work? I guess there
are two pieces to this: first of all, how does it detect what language to
use? I suppose it inherits its language from one or more of the Firefox
config settings? Second, is there a page somewhere that describes how
to add a new locale? "Download these two pages and translate them" --
in UTF-8 or something else? How do you pick the name of your locale? If
you add a new string in a later Torbutton version, and nobody updates
the locale files, will Torbutton just use English for that string? What
about if you change the value of an existing string in a later Torbutton?
Do you credit your translators anywhere, or at least have a secret
list somewhere so you can track them down when you need an update? Once
there's a short instruction page up somewhere, I can try to get a lot
more translations for you, if you like.
And last, why is there a chrome.manifest and an identical
chrome.manifst? :)

@_date: 2006-11-20 06:05:44
@_author: Roger Dingledine 
@_subject: Torbutton 1.0.5 release candidate 
Gah. I upgraded, and the fix didn't work for me. When I clicked on
'use custom proxy settings', they're all blank and zero. Minor bug
but ok. Then I set them, and they worked, but if I clicked on 'use the
recommended proxy settings' and then back on 'use custom proxy settings',
they'd be blank again.
But after restarting Firefox again, it all works nicely. Then I
uninstalled Torbutton and reinstalled 1.0.4.907, and it still works
fine. So, I cannot reproduce my bug report, so I guess there is no bug. :)
I'll try a different one: on Firefox 1.0, I can't unclick 'use privoxy'.
On looking closer, it looks like it's greyed out. Is this because I'm
not supposed to unclick it? If I'm not allowed to mess with it, can we
remove it from my menu entirely? I guess I'm a minority user so it's not
critical if it's hard to do.
Nice. Thanks!

@_date: 2006-11-23 19:04:58
@_author: Roger Dingledine 
@_subject: build of rpm fails 
Have you tried building the old one again? I don't think anything
changed in the RPM spec file between 0.1.1.24 and 0.1.1.25. So my
first thought is that something has changed on your side. :)

@_date: 2006-11-26 04:31:57
@_author: Roger Dingledine 
@_subject: Blocked by Websense 
Oh boy. Looks like they have started that particular arms race.
Do you know what version of Websense they were using?
We know what the next few steps of the arms race will be on our side,
and we have some guesses about what they'll be on the opposing sides,
but I'm not sure how quickly we want the arms race to proceed. I suppose
we should give that some thought now.
Get a cached-routers file and the cached-status/* files from
somewhere. Bring them from home on a USB stick if you like. I'm not
sure how recent they need to be -- if you're using 0.1.1.x it needs
to be from within 24 hours. I believe 0.1.2.3-alpha is more forgiving,
but not by much. Let me know if you get it working and what it takes.
Future versions of Tor will bootstrap better with whatever files it
starts with; and will avoid the particular fingerprinting vulnerability
you describe above.
Set "__AllDirActionsPrivate 1" in your torrc.
(This config option is intended for controllers that bootstrap your
initial circuits themselves, but it should work fine as a manual
workaround for now.)
Hope that helps,

@_date: 2006-11-28 20:26:05
@_author: Roger Dingledine 
@_subject: False certificates 
Yuck. Actually, Peter Palfrader just pointed out that it's probably just
an iptables screw-up. "bach" is that Tor server's nickname. It looks
like he's redirecting all outgoing port 443 requests back into his ORPort.
So, yet another instance of a non-malicious attacker. :)
Yes, we can mark the node as invalid, and then people won't use it for
entry or exit. Down the road when more people have upgraded to 0.1.2.x,
we will instead make use of the BadExit flag we recently introduced.
Bach registered itself a while ago; I'll contact the operator and ask
him to fix his iptables.

@_date: 2006-11-29 10:18:34
@_author: Roger Dingledine 
@_subject: False certificates 
Looks like bach is all fixed now.
Thanks. Let me know if you find other misconfigured exits. One day
we'll get the automated scanning going. :)

@_date: 2006-11-06 01:17:54
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.3-alpha is out 
This is the third development snapshot for the 0.1.2.x series. It
starts preparing the Tor directory authorities to integrate with Mike
Perry's new Tor controller, so we can autodetect broken exit relays. The
bundles include the new Vidalia 0.0.9 release, which features an improved
interface for setting up and configuring a Tor server. The Windows bundle
also includes Torbutton for simpler installs.
Changes in version 0.1.2.3-alpha - 2006-10-29
  o Minor features:
    - Prepare for servers to publish descriptors less often: never
      discard a descriptor simply for being too old until either it is
      recommended by no authorities, or until we get a better one for
      the same router. Make caches consider retaining old recommended
      routers for even longer.
    - If most authorities set a BadExit flag for a server, clients
      don't think of it as a general-purpose exit. Clients only consider
      authorities that advertise themselves as listing bad exits.
    - Directory servers now provide 'Pragma: no-cache' and 'Expires'
      headers for content, so that we can work better in the presence of
      caching HTTP proxies.
    - Allow authorities to list nodes as bad exits by fingerprint or by
      address.
  o Minor features, controller:
    - Add a REASON field to CIRC events; for backward compatibility, this
      field is sent only to controllers that have enabled the extended
      event format.  Also, add additional reason codes to explain why
      a given circuit has been destroyed or truncated. (Patches from
      Mike Perry)
    - Add a REMOTE_REASON field to extended CIRC events to tell the
      controller about why a remote OR told us to close a circuit.
    - Stream events also now have REASON and REMOTE_REASON fields,
      working much like those for circuit events.
    - There's now a GETINFO ns/... field so that controllers can ask Tor
      about the current status of a router.
    - A new event type "NS" to inform a controller when our opinion of
      a router's status has changed.
    - Add a GETINFO events/names and GETINFO features/names so controllers
      can tell which events and features are supported.
    - A new CLEARDNSCACHE signal to allow controllers to clear the
      client-side DNS cache without expiring circuits.
  o Security bugfixes:
    - When the user sends a NEWNYM signal, clear the client-side DNS
      cache too. Otherwise we continue to act on previous information.
  o Minor bugfixes:
    - Avoid sending junk to controllers or segfaulting when a controller
      uses EVENT_NEW_DESC with verbose nicknames.
    - Stop triggering asserts if the controller tries to extend hidden
      service circuits (reported by mwenge).
    - Avoid infinite loop on unexpected controller input.
    - When the controller does a "GETINFO network-status", tell it
      about even those routers whose descriptors are very old, and use
      long nicknames where appropriate.
    - Change NT service functions to be loaded on demand.  This lets us
      build with MinGW without breaking Tor for Windows 98 users.
    - Do DirPort reachability tests less often, since a single test
      chews through many circuits before giving up.
    - In the hidden service example in torrc.sample, stop recommending
      esoteric and discouraged hidden service options.
    - When stopping an NT service, wait up to 10 sec for it to actually
      stop.  (Patch from Matt Edman; resolves bug 295.)
    - Fix handling of verbose nicknames with ORCONN controller events:
      make them show up exactly when requested, rather than exactly when
      not requested.
    - When reporting verbose nicknames in entry_guards_getinfo(), avoid
      printing a duplicate "$" in the keys we send (reported by mwenge).
    - Correctly set maximum connection limit on Cygwin. (This time
      for sure!)
    - Try to detect Windows correctly when cross-compiling.
    - Detect the size of the routers file correctly even if it is
      corrupted (on systems without mmap) or not page-aligned (on systems
      with mmap). This bug was harmless.
    - Sometimes we didn't bother sending a RELAY_END cell when an attempt
      to open a stream fails; now we do in more cases. This should
      make clients able to find a good exit faster in some cases, since
      unhandleable requests will now get an error rather than timing out.
    - Resolve two memory leaks when rebuilding the on-disk router cache
      (reported by fookoowa).
    - Clean up minor code warnings suggested by the MIPSpro C compiler,
      and reported by some Centos users.
    - Controller signals now work on non-Unix platforms that don't define
      SIGUSR1 and SIGUSR2 the way we expect.
    - Patch from Michael Mohr to contrib/cross.sh, so it checks more
      values before failing, and always enables eventdns.
    - Libevent-1.2 exports, but does not define in its headers, strlcpy.
      Try to fix this in configure.in by checking for most functions
      before we check for libevent.

@_date: 2006-11-09 13:42:53
@_author: Roger Dingledine 
@_subject: Vidalia 0.0.8 
Actually, Vidalia 0.0.9 is the latest.
The reason we shipped Vidalia 0.0.7 with the Tor 0.1.1.25 bundle is
that it's meant to be a "stable" bundle. We know 0.0.7 has some flaws,
but at least we know about them.
The Tor 0.1.2.3-alpha bundle comes with Vidalia 0.0.9, if you want to
be more cutting edge. :)

@_date: 2006-11-12 00:35:36
@_author: Roger Dingledine 
@_subject: DNS prob? 
Good question. For some reason your DNS resolver is not very fast.
It's possible this is because you are attracting a whole lot of traffic,
and it simply can't keep up. More likely is that your DNS server is slow
or otherwise doesn't like you very much. Also possible is that your OS
has threading problems -- which OS are you using?
Which version of Tor is this? The development releases (e.g. Tor
0.1.2.3-alpha) have a brand-new different DNS subsystem, so they will
at least have new and different bugs. :)

@_date: 2006-11-13 14:20:00
@_author: Roger Dingledine 
@_subject: TorPark (was Re: Win32.Trojan.Agent appear when close Torpark) 
Hi Steve,
I'm about to run off to catch a flight, so I'll keep this brief.
In short, I still don't know what's in Torpark, and why. Here's what
would make me happier about it:
1) Tell us what's inside it. There are two steps to this:
First, document how to recreate the Torpark binary. If I took your NSI
file and the plugin you ship and put them together with an out-of-the-box
Firefox, would I end up with the same thing? I'm under the impression
that the answer is no. For example: you've hinted periodically that you
do things like turn off Javascript. At what stage in the build do you
make these changes? Is there a Firefox config file that you merge in,
and if so can you make that available too?
Second, document exactly what you change, and why. For example: if you
turn off Javascript, write that down, and write two sentences next to it
that say "This is because of fears that Javascript can reveal the user's
IP address. Alas, turning it off also breaks some websites." Exactly
which other config options are changed?
2) Tell us more about what resources Torpark accesses on the host
system. For example: does it use swap on the host hard drive? Does it
encrypt that swap? Does it add any lines to the registry, and if so which
ones? Does this vary by version of Windows? If there are resources that
it *doesn't* touch but people might think it does, mention those too
and provide some intuition for why it doesn't.
2') What Tor configuration do you use? Is your DataDirectory on the USB
key, or on the host system? What are the security, speed, convenience
(and durability of USB media) issues for each choice?
3) Tell us more about the plugin(s) you ship. What exactly do they do?
How are they configured?
For example: I seem to recall a line on the website saying that the "live
IP" plugin is configured to make a new connection through Tor once every
minute, forever? But I can't find that documented anywhere now. If it's
true, then Torpark is adding a huge amount of extra load to the network,
since every Torpark user will be building a new circuit every 10 minutes
whether they're at their computer or not.
Another example: is NoScript included? I don't see that anywhere in the
source, or the documentation, so I guess that it isn't, but in personal
mail you told me it is?
4) Explain the design choices for which plugins you included, what
configuration choices you made, etc. Explain the design choices for cases
where you decided *not* to use a given plugin, configuration change, etc.
For example, "we avoid the Frobnitzer plugin because it sends packets out
onto the local network." As another example, do you include or exclude
the Adobe PDF plugin, since it's rumored to ignore proxy settings?
Then I would like some security analysis and intuition. The great thing
here is that if you do the above steps, you're no longer the only one
in the position to do these next steps. Hopefully other people will step
up and help out:
5) Explain what security issues there are with a USB configuration of Tor,
and with the particular configuration and design choices that Torpark
has made. A lot of these are inherited from Tor (a distinctive network
signature, for example). Some might be new to Torpark (for example, if you
shipped a plugin that did a local DNS resolve of every destination people
type into Firefox, so it can display the IP address of the destination --
I'm not saying you ship this, but I honestly am not sure.)
In all of these steps, I don't expect everything to be perfectly secure.
Document what it is right now, and make notes about parts you're worried
about or parts that you'd like to fix more thoroughly. Once other people
know what is there currently, then we can help to make suggestions and
point out other worries and possible flaws.
Please don't send a long answer to or-talk with responses to each of
these paragraphs. Instead, write up a text file with the answers, and
link to it from the Torpark website, and include it in the source and
the Torpark package itself, and tell us about it. Then you can continue
to maintain and improve it as things change.
As another example, we haven't added an auto-update feature to Tor
yet because there are a huge pile of security issues that need closer
analysis: automatically installing software via Tor while retaining
security and anonymity, and not introducing new attacks (Auto-update
from where? With what key? How do you rotate it? Who controls it?),
is a heck of a problem.
I fear that if you simply announce the one-liner "now we have
auto-update" ... I'm going to be writing another of these mails. :)
Hope this helps,

@_date: 2006-10-07 16:18:57
@_author: Roger Dingledine 
@_subject: ORPort is unreachable from the Internet 
When the Linksys box passes the connection on, what IP address does your
Tor server think it's getting a connection from?
We've got a check in there to make sure we don't consider ourselves
reachable too eagerly -- if it's a connection from a local IP address,
we don't buy it. But perhaps this is biting us in the case of people who
Can you look at info-level or debug-level logs and hunt through until it
tells you what IP address it's getting a connection from? (If it's all
gobbledygook to you, you can also mail me a debug-level log of the first
15 minutes of operation, and I'll look through it.)

@_date: 2006-10-08 01:03:16
@_author: Roger Dingledine 
@_subject: Perplexing Tor Messages. 
I am already confused. Are you an exit node on port 80, or are you a
hidden service, or are you both? Your exit policy has nothing to do with
being a hidden service, and whether you're a Tor server also has nothing
to do with whether you're a hidden service.
If you're a Tor server, please don't restrict outbound ports at all.
Also, the earlier log messages may give you better hints about what's
going wrong.

@_date: 2006-10-09 18:49:09
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.2-alpha is out 
This is the second development snapshot for the 0.1.2.x series. It
features better load balancing when picking paths, an automated workaround
on the server-side for ISPs that "hijack" your DNS answers, and a whole
lot of bugfixes.
We also got it building on Windows with MinGW, so hopefully Windows
releases will be more reliable from now on.
Changes in version 0.1.2.2-alpha - 2006-10-07
  o Major features:
    - Make our async eventdns library on-by-default for Tor servers,
      and plan to deprecate the separate dnsworker threads.
    - Add server-side support for "reverse" DNS lookups (using PTR
      records so clients can determine the canonical hostname for a given
      IPv4 address). Only supported by servers using eventdns; servers
      now announce in their descriptors whether they support eventdns.
    - Specify and implement client-side SOCKS5 interface for reverse DNS
      lookups (see doc/socks-extensions.txt).
    - Add a BEGIN_DIR relay cell type for an easier in-protocol way to
      connect to directory servers through Tor. Previously, clients needed
      to find Tor exits to make private connections to directory servers.
    - Avoid choosing Exit nodes for entry or middle hops when the
      total bandwidth available from non-Exit nodes is much higher than
      the total bandwidth available from Exit nodes.
    - Workaround for name servers (like Earthlink's) that hijack failing
      DNS requests and replace the no-such-server answer with a "helpful"
      redirect to an advertising-driven search portal. Also work around
      DNS hijackers who "helpfully" decline to hijack known-invalid
      RFC2606 addresses. Config option "ServerDNSDetectHijacking 0"
      lets you turn it off.
    - Send out a burst of long-range padding cells once we've established
      that we're reachable. Spread them over 4 circuits, so hopefully
      a few will be fast. This exercises our bandwidth and bootstraps
      us into the directory more quickly.
  o New/improved config options:
    - Add new config option "ResolvConf" to let the server operator
      choose an alternate resolve.conf file when using eventdns.
    - Add an "EnforceDistinctSubnets" option to control our "exclude
      servers on the same /16" behavior. It's still on by default; this
      is mostly for people who want to operate private test networks with
      all the machines on the same subnet.
    - If one of our entry guards is on the ExcludeNodes list, or the
      directory authorities don't think it's a good guard, treat it as
      if it were unlisted: stop using it as a guard, and throw it off
      the guards list if it stays that way for a long time.
    - Allow directory authorities to be marked separately as authorities
      for the v1 directory protocol, the v2 directory protocol, and
      as hidden service directories, to make it easier to retire old
      authorities. V1 authorities should set "HSAuthoritativeDir 1"
      to continue being hidden service authorities too.
    - Remove 8888 as a LongLivedPort, and add 6697 (IRCS).
  o Minor features, controller:
    - Fix CIRC controller events so that controllers can learn the
      identity digests of non-Named servers used in circuit paths.
    - Let controllers ask for more useful identifiers for servers. Instead
      of learning identity digests for un-Named servers and nicknames
      for Named servers, the new identifiers include digest, nickname,
      and indication of Named status. Off by default; see control-spec.txt
      for more information.
    - Add a "getinfo address" controller command so it can display Tor's
      best guess to the user.
    - New controller event to alert the controller when our server
      descriptor has changed.
    - Give more meaningful errors on controller authentication failure.
  o Minor features, other:
    - When asked to resolve a hostname, don't use non-exit servers unless
      requested to do so. This allows servers with broken DNS to be
      useful to the network.
    - Divide eventdns log messages into warn and info messages.
    - Reserve the nickname "Unnamed" for routers that can't pick
      a hostname: any router can call itself Unnamed; directory
      authorities will never allocate Unnamed to any particular router;
      clients won't believe that any router is the canonical Unnamed.
    - Only include function names in log messages for info/debug messages.
      For notice/warn/err, the content of the message should be clear on
      its own, and printing the function name only confuses users.
    - Avoid some false positives during reachability testing: don't try
      to test via a server that's on the same /24 as us.
    - If we fail to build a circuit to an intended enclave, and it's
      not mandatory that we use that enclave, stop wanting it.
    - When eventdns is enabled, allow multithreaded builds on NetBSD and
      OpenBSD. (We had previously disabled threads on these platforms
      because they didn't have working thread-safe resolver functions)
  o Major bugfixes, anonymity/security:
    - If a client asked for a server by name, and there's a named server
      in our network-status but we don't have its descriptor yet, we
      could return an unnamed server instead.
    - Fix NetBSD bug that could allow someone to force uninitialized RAM
      to be sent to a server's DNS resolver. This only affects NetBSD
      and other platforms that do not bounds-check tolower().
    - Reject (most) attempts to use Tor circuits with length one. (If
      many people start using Tor as a one-hop proxy, exit nodes become
      a more attractive target for compromise.)
    - Just because your DirPort is open doesn't mean people should be
      able to remotely teach you about hidden service descriptors. Now
      only accept rendezvous posts if you've got HSAuthoritativeDir set.
  o Major bugfixes, other:
    - Don't crash on race condition in dns.c: tor_assert(!resolve->expire)
    - When a client asks the server to resolve (not connect to)
      an address, and it has a cached answer, give them the cached answer.
      Previously, the server would give them no answer at all.
    - Allow really slow clients to not hang up five minutes into their
      directory downloads (suggested by Adam J. Richter).
    - We were building exactly the wrong circuits when we anticipated
      hidden service requirements, meaning Tor would have to build all
      its circuits on demand.
    - Avoid crashing when we mmap a router cache file of size 0.
    - When testing reachability of our DirPort, don't launch new
      tests when there's already one in progress -- unreachable
      servers were stacking up dozens of testing streams.
  o Minor bugfixes, correctness:
    - If we're a directory mirror and we ask for "all" network status
      documents, we would discard status documents from authorities
      we don't recognize.
    - Avoid a memory corruption bug when creating a hash table for
      the first time.
    - Avoid controller-triggered crash when misusing certain commands
      from a v0 controller on platforms that do not handle
      printf("%s",NULL) gracefully.
    - Don't crash when a controller sends a third argument to an
      "extendcircuit" request.
    - Controller protocol fixes: fix encoding in "getinfo addr-mappings"
      response; fix error code when "getinfo dir/status/" fails.
    - Avoid crash when telling controller stream-status and a stream
      is detached.
    - Patch from Adam Langley to fix assert() in eventdns.c.
    - Fix a debug log message in eventdns to say "X resolved to Y"
      instead of "X resolved to X".
    - Make eventdns give strings for DNS errors, not just error numbers.
    - Track unreachable entry guards correctly: don't conflate
      'unreachable by us right now' with 'listed as down by the directory
      authorities'. With the old code, if a guard was unreachable by
      us but listed as running, it would clog our guard list forever.
    - Behave correctly in case we ever have a network with more than
      2GB/s total advertised capacity.
    - Make TrackExitHosts case-insensitive, and fix the behavior of
      ".suffix" TrackExitHosts items to avoid matching in the middle of
      an address.
    - Finally fix the openssl warnings from newer gccs that believe that
      ignoring a return value is okay, but casting a return value and
      then ignoring it is a sign of madness.
    - Prevent the contrib/exitlist script from printing the same
      result more than once.
    - Patch from Steve Hildrey: Generate network status correctly on
      non-versioning dirservers.
    - Don't listen to the X-Your-Address-Is hint if you did the lookup
      via Tor; otherwise you'll think you're the exit node's IP address.
  o Minor bugfixes, performance:
    - Two small performance improvements on parsing descriptors.
    - Major performance improvement on inserting descriptors: change
      algorithm from O(n^2) to O(n).
    - Make the common memory allocation path faster on machines where
      malloc(0) returns a pointer.
    - Start remembering X-Your-Address-Is directory hints even if you're
      a client, so you can become a server more smoothly.
    - Avoid duplicate entries on MyFamily line in server descriptor.
  o Packaging, features:
    - Remove architecture from OS X builds. The official builds are
      now universal binaries.
    - The Debian package now uses --verify-config when (re)starting,
      to distinguish configuration errors from other errors.
    - Update RPMs to require libevent 1.1b.
  o Packaging, bugfixes:
    - Patches so Tor builds with MinGW on Windows.
    - Patches so Tor might run on Cygwin again.
    - Resume building on non-gcc compilers and ancient gcc. Resume
      building with the -O0 compile flag. Resume building cleanly on
      Debian woody.
    - Run correctly on OS X platforms with case-sensitive filesystems.
    - Correct includes for net/if.h and net/pfvar.h on OpenBSD (from Tup).
    - Add autoconf checks so Tor can build on Solaris x86 again.
  o Documentation
    - Documented (and renamed) ServerDNSSearchDomains and
      ServerDNSResolvConfFile options.
    - Be clearer that the *ListenAddress directives can be repeated
      multiple times.

@_date: 2006-10-10 05:08:39
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.2-alpha is out 
Yes. Of course, they each will need to upgrade before it will matter
for them, but it's a start.
Glad you like it. Nick was actually the one who wrote most of the code
for the 0.1.2.2-alpha release. I was pretty much just the one who wrote
the changelog and looked over all the commits. :)

@_date: 2006-10-03 01:53:05
@_author: Roger Dingledine 
@_subject: Tor not working 
My guess would be that your Tor isn't running.
See also

@_date: 2006-10-10 23:27:09
@_author: Roger Dingledine 
@_subject: List of NODES in IP form 
Unfortunately, both of those answers use the old version 1 directory
protocol (from Tor 0.1.0.x), which is deprecated at this point. So both
of those techniques will be somewhat inaccurate.
Further, since each Tor server has its own exit policy, and assuming
your goal is to get a list of IP addresses which might connect to your
service, you don't so much want a list of all the Tor IP addresses as
you want a list of all the Tor IP addresses whose exit policies allow
connections to your service.
This is why we provide a script to make this list for you: see the end of

@_date: 2006-10-14 18:17:42
@_author: Roger Dingledine 
@_subject: Snakes On A Tor Scanner - 0.0.3 
Hi Mike,
This looks great. Here are a few responses from reading your README:
You could have your Metatroller connect to Tor and set
__LeaveStreamsUnattached=1 itself. Then the user doesn't have to mess
with his torrc at all (assuming he already has the controlport set). In
fact, when the metatroller exits you could unset it, so Tor becomes a
normal client again.
If you could help us get moving on that, that would be great. Some sort
of spec patch and preliminary code patch would be fabulous.
When you extendcircuit, you can specify purpose=controller, and
then Tor won't ever touch those circuits on its own.
That's an interesting question -- do the slow ones drop circuits more
often? I'd be curious to hear some data on that.
More generally, while using a fraction of the nodes (7/8 or 65%) lets
us adapt better to whatever network we have available, it may still not
be the right approach if our goal is to have high chances of getting a
non-sucky circuit. On the other hand, people who sign up to be relays
but never get used may be sad. On the third hand, so what? Hm.
Right, I think this is definitely worth investigating further. We could
add a getinfo statusflags/id/foo and maybe a setinfo to go along with
it, and any directory authority that wanted to could run your script to
learn whether to set the BadExit flag on a given router. (Note that we've
already put in a new flag called BadExit that clients will recognize in
future versions.)
While we're at it, would it be interesting to look into adding a country
code to the network-status list, saying our best guess based on whois
or whatever of where the node is? As more and more tools hardcode "fetch
it from serifos, unauthenticated and with a single point of failure",
it might be nice to offer a better option.

@_date: 2006-10-20 18:49:45
@_author: Roger Dingledine 
@_subject: "Practical onion hacking: finding the real address of Tor clients" 
Right, this would be great. There are a few checkers out there that
hand a java program to the user that fetches his IP address. We (Tor)
get mail every so often from people who say "hey, I went to this site
and it knows who I am! Tor's broken!"
One of these days I'll get around to writing the single clear paragraph
that will explain everything to everybody. That's still in the works
though; feel free to beat me to it. It would go between
as a new section.
Right. Yay JanusVM. I think the eventual solution for packaging Tor
correctly will be to run a VM or something similar that handles all
network traffic correctly, so people don't have to worry so much about
configuring things. It still won't be perfect though, because your
Firefox's Java program can still run whatever it likes, and because
cookies and other application-level issues need to be solved too.
See also
See also
for Linux, BSD, and probably OS X.

@_date: 2006-10-23 22:33:27
@_author: Roger Dingledine 
@_subject: Culled Wedged CPUworkers Bug 
I believe this was fixed in 0.1.1.22, which was released on 2006-07-05.
What Tor version are you running? If it's a later version than that,
can you provide more details, like how often it occurs, whether you can
induce it to occur, whether there's high load at the time, whether your
CPU sucks, whether you're running an obscure operating system, and other
hints that might be helpful?

@_date: 2006-10-24 20:15:49
@_author: Roger Dingledine 
@_subject: Culled Wedged CPUworkers Bug 
Well, perhaps it didn't actually disappear, since you're seeing the
above problem. :)
Does building with --disable-threads make the log lines go away?

@_date: 2006-10-28 02:30:38
@_author: Roger Dingledine 
@_subject: tor-0.1.1.24 
If by "crash" you mean "seg faults", there are lots more details
you can provide. I've made an attempt at a walk-through here:

@_date: 2006-09-04 23:40:50
@_author: Roger Dingledine 
@_subject: tor scans? 
Keep your computer secure, and you should be just fine. Looks like
somebody trying to build a list of open proxies on the net.

@_date: 2006-09-05 01:36:46
@_author: Roger Dingledine 
@_subject: Puzzling behavior of Tor server. 
These log messages have to do with running Tor as a server. They look
But these messages are about running Tor as a client. Are you using your
Tor as a socks proxy too, that is, for application connections? If so,
it doesn't much matter that you're also a server -- that's a separate
issue. If you aren't, then it looks like somebody else is, and you should
look into closing your socksport more.
(The only way in which running a Tor server might matter here is if your
Tor server is using a lot of your bandwidth, so there isn't much left
for your own connections -- it's on the todo list to give priority to
local connections, but it's hard to do in an easy and simple way. Most
people who run Tor servers and also want to use Tor as a client run two
separate processes.)
In any case, these types of messages are ordinary. Tor automatically
tries to retry to another circuit if the current circuit seems crummy
I'm not sure what you mean by 'this' here. Using Tor makes logging out of
Yahoo mail difficult? Perhaps this is a flaw with Yahoo's authentication
model (that it assumes you'll always be coming from the same IP address),
or perhaps it's just coincidence, or perhaps one of us is confused?

@_date: 2006-09-06 09:15:03
@_author: Roger Dingledine 
@_subject: Assertation -> tor crashes 
What version of libevent do you have installed?
When Tor starts, does libevent print out a log message indicating which
libevent method it's using? If so, which method is it using? For example,
Sep 06 09:14:11.797 [notice] Initialized libevent version 1.1a using method epoll. Good.

@_date: 2006-09-09 16:27:48
@_author: Roger Dingledine 
@_subject: confiscating middleman-tor-nodes 
Hi folks,
Looks like it was a pretty wide-scale event a few days ago. Since German
policy is at stake, I figure the best move is to let our German privacy
advocates deal with it. I think most German exit node operators are
coordinated already, but if you're involved or want to become involved,
you can contact Julius et al at anonymizer at ccc.de.
(To my knowledge, no non-exit nodes were involved. Just exit nodes.)

@_date: 2006-09-10 12:16:57
@_author: Roger Dingledine 
@_subject: CCC dirserver gone 
Hi Marco,
We've had five directory authorities the whole time. I've been meaning
one day to add a CCC node as the sixth, and your node as the seventh,
but haven't gotten around to it yet. So don't be too worried yet.
In other news, I think this shows us that we probably want another
requirement on being a directory authority: "must not be an exit node".
That is, we should avoid having more than one reason why somebody might
want to attack a directory authority.

@_date: 2006-09-10 13:09:09
@_author: Roger Dingledine 
@_subject: (FWD) Re: An observation 
[Forwarded because Kristian isn't subscribed to or-talk at this address.
What's next? Requiring government-issued IDs at Internet cafes like in
Italy, or in libraries? Outlawing open message boards, or Wikipedia,
or prepaid sim cards, or payphones, or the postal service? Making people
liable for activity that occurs because they run an insecure operating
system, like in France?
There are a lot of ways to screw up here.

@_date: 2006-09-11 17:56:08
@_author: Roger Dingledine 
@_subject: confiscating middleman-tor-nodes 
I'm doing my best to leave actual strategy to the Tor operators and
advocates in Germany, since it's German law and policy that could be
at issue. But yes, Tor, EFF, CCC, and others are coordinating.
And for those who have only been reading the slashdot stories, we've
put a bit of actual information up on the Tor site:
Hope that helps,

@_date: 2006-09-23 13:06:32
@_author: Roger Dingledine 
@_subject: Error generating TOR web site 
You need to check out tor-stable (tor-0_1_1-patches) and tor-head (trunk)
and edit your website/Makefile to reflect their locations.

@_date: 2006-09-27 15:15:34
@_author: Roger Dingledine 
@_subject: Missing threads...been removed? 
The archive server ran out of disk space yesterday and ate
some of the files. I've rebuild the Sep-2006 index. Let me
know if you notice others that are broken.

@_date: 2006-09-29 22:37:31
@_author: Roger Dingledine 
@_subject: Problem during IP change of connection momentarily down 
Hi Marco,
Nice bug. I believe I've already fixed this in SVN (available in the
upcoming 0.1.2.2-alpha release). Nick just fixed it in 0.1.1.x, and that
will be included in the upcoming 0.1.1.24 release.

@_date: 2006-09-29 23:31:58
@_author: Roger Dingledine 
@_subject: write access 
Tor doesn't log much by default. The "by default" means "if you don't
change your torrc". You changed your torrc. That's why it's logging more.
Debug is really very noisy indeed. Maybe you should change it back. :)

@_date: 2006-09-04 09:48:00
@_author: Roger Dingledine 
@_subject: (FWD) Re: Something Strange Happens to google when Tor is enabled 
[Forwarding because Alexis isn't subscribed to or-talk at this
address. Also, you should check out the FAQ entry on this topic:

@_date: 2006-09-04 17:46:52
@_author: Roger Dingledine 
@_subject: being a middleman 
I've removed all trace of the word 'middleman' from the code, the docs,
and the sample torrc file. So the only place you'll be encountering
it is somebody else's docs or an old torrc file if you're using an old
0.1.0.x one. Are there places that I missed?
The new phrase I use is something akin to "not an exit node", which is
hopefully an easier distinction.

@_date: 2006-09-04 17:52:49
@_author: Roger Dingledine 
@_subject: v2 directory? 
The v2 directory isn't just in the latest alpha versions, it's
been used since 0.1.1.x.

@_date: 2007-04-23 17:02:06
@_author: Roger Dingledine 
@_subject: Example hidden service issue 
Hi Mike,
Thanks for the kick. This has been moving up my todo list, but I just
jumped it to the top and finished it:
Folks, please let me know if this new page is intelligible and
also if it fixes all the issues we've raised.

@_date: 2007-04-24 21:24:21
@_author: Roger Dingledine 
@_subject: 2-node circuits Vs 3-node circuits 
There are some differences. One of them is in the amount of coordination
required to do the attack in the 2-hop case vs the 3-hop case. From
the design paper: "If Alice always uses two hops, then both ORs can be
certain that by colluding they will learn about Alice and Bob." Another
has to do with the fact that the first hop is constrained based on our
"entry guard" design, which may leak a lot of info in the 2-hop case.
See also
See  and follow-up
messages for a current discussion.

@_date: 2007-04-25 21:24:48
@_author: Roger Dingledine 
@_subject: Selecting and using a particular Tor IP address 
Check out "TrackHostExits" in the man page. This may be what
you're looking for.

@_date: 2007-04-26 14:06:57
@_author: Roger Dingledine 
@_subject: Accept-encoding: gzip 
Agreed. That's why we do it already. :)
Search dir-spec.txt for ".z".
(We use zlib, not gzip, for portability reasons. But it's close enough.)
Also, almost nobody fetches the v1 directory anymore (the big one you
describe above). Most people (I hope) are using the v2 directory design
at this point, which was introduced in Tor 0.1.1.x.

@_date: 2007-04-26 17:01:10
@_author: Roger Dingledine 
@_subject: bandwidth limit strangeness 
I am guessing you are one of those people who count bandwidth by
the sum of incoming bits and outgoing bits?
I am one of the people who count bandwidth by how many bytes are going
in a given direction.
Alas, there are many more types of people even than the two of us. The
man page tries to lay it out clearly.
Does that help resolve it?
(Btw, setting MaxAdvertisedBandwidth only has an effect if the value
you choose is less than your BandwidthRate. So in the above it doesn't
do anything.)

@_date: 2007-04-28 02:52:35
@_author: Roger Dingledine 
@_subject: (FWD) Re: ip-port.torhosts.nighteffect.us and exim 
[Forwarding since Mike isn't subscribed as this address. -RD]

@_date: 2007-04-30 17:34:01
@_author: Roger Dingledine 
@_subject: Exiting only port 80 
I think those are reasonable assumptions. A few people have done informal
studies, and they found that the majority of _requests_ are for web
browsing, and the majority of _bytes_ are for higher-bandwidth protocols.
Could be. I don't think it will be as effective a solution as you hope,
though -- more and more of the Internet is travelling over port 80 these
days, due to firewall restrictions, filters, and people taking steps
like the one you propose. :) It's not an arms race we can easily win,
so I'm not that enthusiastic about starting it.

@_date: 2007-04-09 15:57:36
@_author: Roger Dingledine 
@_subject: Another Method to Block Java Hijinks 
This certainly does seem like a nice approach -- run a virtual computer in
between you and the Internet, a) so your computer never knows its external
IP address, and b) so you can intercept all outgoing communications and
either scrub them or drop them, depending.
James Muir, HD Moore, others: can you give some thought to what attacks
and vulnerabilities remain even in this model? I guess we can still
overflow the browser and start looking around for private data on the
computer, like an Outlook address book. What other issues remain? And
does this approach introduce any new issues?
Kyle: this would be more useful if it didn't depend on a non-free vm
player. Do any of the free software variants of VMWare actually work
well enough for this approach? Also, is there any way to adapt this idea
for resource-constrained systems, e.g. a Tor client running on an old
computer in an oppressed country, or is the LiveCD idea definitely the
more feasible approach there?

@_date: 2007-04-09 16:13:17
@_author: Roger Dingledine 
@_subject: Another Method to Block Java Hijinks 
Whoops, I should probably clarify my terms before this thread blows
up. By non-free, I mean software not available under a Debian Free
Software Guidelines style license.
So by free software variants of VMWare, I meant some virtual machine
approach that is available as free software. To my knowledge none of
the VMWare stuff is free software.
(I don't mean to say that the nonexistence of a free vm player is a deal
killer here; but boy does it hinder testing, analysis, and overall trust.)

@_date: 2007-04-01 04:43:05
@_author: Roger Dingledine 
@_subject: Example hidden service issue 
Yes, you're absolutely right. Oops. Thanks for pointing it out.
I originally split the setup instructions into two steps because
people had a lot of trouble distinguishing whether they had screwed up
editing their torrc or had screwed up setting up their webserver. It's
doubly tricky because we're trying to be platform independent in the
One option is to remove step one. This will cause more people to get
confused and send us angry mail that our instructions are too hard.
Another option is to change  to some other address. But even
if it's a site we really trust (like tor.eff.org), there's still the worry
about somebody watching the site. We could suggest instead, because then an observer wouldn't be able to learn the Host:
header (I believe), but that doesn't really resolve the point of failure,
and explaining how to prepend " to the .onion address will turn
the instructions back into a mess.
Any other good options out there? :)
I'm leaning towards option one at this point, simply because instructing
people to point their .onion addresses at an external site is just asking
for trouble -- and suggesting a company that's well-known for keeping
extensive logs is a particularly egregious choice.

@_date: 2007-04-13 12:50:00
@_author: Roger Dingledine 
@_subject: [Fwd: High-traffic Colluding Tor Routers in Washington, D.C.  Confirmed] 
Yeah. This happened in mid 2006. I don't know why some random person
just picked it up now.
We (mainly Steven Murdoch and Richard Clayton) tracked down the fellow
running them. It turned out to be an innocent mistake. He's still running
quite a few, on the same network, but now he sets the MyFamily torrc
option on them.
This issue also prompted us to speed up the fix/feature in 0.1.2.1-alpha:
"Automatically avoid picking more than one node from the same
For a more interesting (and more conclusive imo) method of deciding
they're the same, check out slide 28 in Steven's slides from his CCS
paper and 23C3 talk, where he investigated these servers:

@_date: 2007-04-17 23:05:35
@_author: Roger Dingledine 
@_subject: Importance of HTTP connection keep-alive 
Speaking of which, it occurred to me a little while ago that
persistent connections between the http proxy and the website,
through Tor, can have an impact on anonymity.
If the user is figuring they're rotating their connections over different
Tor circuits over time (after all, they're clicking at different times,
right?), but polipo is holding open the same persistent connection,
then this changes things.
Is it documented anywhere how Polipo does its keepalives and timeouts
for persistent connections?
Fun fun,

@_date: 2007-04-18 01:01:55
@_author: Roger Dingledine 
@_subject: [Fwd: High-traffic Colluding Tor Routers in Washington, D.C.  Confirmed] 
"Nostra2004 at Safe-mail.net" sent me some follow-up questions, which
I'll answer here so we can keep the thread in one place. Maybe this
will finally put the topic to rest. :)
I believe they made some phone calls to their friends who work in the
network operations center at psinet.
They know the person who was running them. It was somebody in the security
field who was helping out but was embarrassed to realize that he was
actually putting the network at risk by helping out quite so much. :)
The fellow felt that private embarrassment was adequate, and asked not
to be publically named. I trust them, and they trust him, so from my
perspective it is now fine.
Yep. I agree. The Tor network may seem large, but it still needs to grow
a lot larger to resist even medium sized attackers.
If you launch a bunch of Tor servers that together push upwards of
200MBit/s each way sustained, ...that's a lot of bytes.
Tor weights path selection by bandwidth -- otherwise Tor performance
would be extremely miserable rather than just miserable.
There are even several research projects currently looking at how to
trade off a bit more privacy for better performance, including one of
our GSoC interns. See also item  on
Yes. See the previous post:
  This issue also prompted us to speed up the fix/feature in
  0.1.2.1-alpha:
  "Automatically avoid picking more than one node from the same
  /16 network when constructing a circuit."
  But the issue still exists with respect to people who control different
they can).
Well, the Tor directory authorities list servers, and can mark each
server as invalid, badexit, etc. So in effect the authority operators
can collude to blacklist nodes that we agree are behaving badly. A
majority of authority operators need to claim something before clients
will believe it. See for a few more details.
Yes, there is actually a video, courtesy the 23C3 folks:
look for talk 1513. For example,
Hope that helps,

@_date: 2007-04-23 01:51:56
@_author: Roger Dingledine 
@_subject: Using a Proxy with Tor 
Hi Mike,
Can you clarify this bug report? I was under the impression that Tor's
proxy behavior was perfect, at least in 0.1.1.10-alpha and later.

@_date: 2007-04-23 02:11:16
@_author: Roger Dingledine 
@_subject: HttpProxy 
Depends what you're using it for.
__AllDirActionsPrivate was put in so controllers could set it if they are
solving bootstrapping on their own, e.g. by importing server descriptors
from some alternate directory service. It's not in the man page, and
not supported for normal users, because it's easy to get into a state
where your Tor stops working -- if you can't build a circuit, then you
can't get any more directory info and you're stuck.
Feel free to use it though if you want.
Whether you should be using HttpProxy or something else, I have no idea.
Depends what you're trying to do. :)

@_date: 2007-08-10 07:58:35
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.3-alpha and 0.2.0.4-alpha are out 
These are the next two development snapshots for the 0.2.0.x series. We've
had them ready for a week or so, but I delayed the official announce
since we didn't have all the packages ready.
Tor 0.2.0.4-alpha fixes a critical security vulnerability for most users,
specifically those running Vidalia, TorK, etc. Everybody should upgrade
to either 0.1.2.16 or 0.2.0.4-alpha.
Tor 0.2.0.3-alpha introduces new experimental blocking-resistance
features and a preliminary version of the v3 directory voting design,
and includes many other smaller features and bugfixes.
Changes in version 0.2.0.4-alpha - 2007-08-01
  o Major security fixes:
    - Close immediately after missing authentication on control port;
      do not allow multiple authentication attempts.
  o Major bugfixes (compilation):
    - Fix win32 compilation: apparently IN_ADDR and IN6_ADDR are already
      defined there.
  o Minor features (performance):
    - Be even more aggressive about releasing RAM from small
      empty buffers. Thanks to our free-list code, this shouldn't be too
      performance-intensive.
    - Disable sentinel-based debugging for buffer code: we squashed all
      the bugs that this was supposed to detect a long time ago, and
      now its only effect is to change our buffer sizes from nice
      powers of two (which platform mallocs tend to like) to values
      siightly over powers of two (which make some platform mallocs sad).
    - Log malloc statistics from mallinfo() on platforms where it
      exists.
Changes in version 0.2.0.3-alpha - 2007-07-29
  o Major features:
    - The first pieces of our "bridge" design for blocking-resistance
      are implemented. People can run bridge directory authorities;
      people can run bridges; and people can configure their Tor clients
      with a set of bridges to use as the first hop into the Tor network.
      See  for
      details.
    - Create listener connections before we setuid to the configured
      User and Group. Now non-Windows users can choose port values
      under 1024, start Tor as root, and have Tor bind those ports
      before it changes to another UID. (Windows users could already
      pick these ports.)
    - Added a new ConstrainedSockets config option to set SO_SNDBUF and
      SO_RCVBUF on TCP sockets. Hopefully useful for Tor servers running
      on "vserver" accounts. (Patch from coderman.)
    - Be even more aggressive about separating local traffic from relayed
      traffic when RelayBandwidthRate is set. (Refines proposal 111.)
  o Major features (experimental):
    - First cut of code for "v3 dir voting": directory authorities will
      vote on a common network status document rather than each publishing
      their own opinion. This code needs more testing and more corner-case
      handling before it's ready for use.
  o Security fixes:
    - Directory authorities now call routers Fast if their bandwidth is
      at least 100KB/s, and consider their bandwidth adequate to be a
      Guard if it is at least 250KB/s, no matter the medians. This fix
      complements proposal 107. [Bugfix on 0.1.2.x]
    - Directory authorities now never mark more than 3 servers per IP as
      Valid and Running. (Implements proposal 109, by Kevin Bauer and
      Damon McCoy.)
    - Minor change to organizationName and commonName generation
      procedures in TLS certificates during Tor handshakes, to invalidate
      some earlier censorware approaches. This is not a long-term
      solution, but applying it will give us a bit of time to look into
      the epidemiology of countermeasures as they spread.
  o Major bugfixes (directory):
    - Rewrite directory tokenization code to never run off the end of
      a string. Fixes bug 455. Patch from croup. [Bugfix on 0.1.2.x]
  o Minor features (controller):
    - Add a SOURCE_ADDR field to STREAM NEW events so that controllers can
      match requests to applications. (Patch from Robert Hogan.)
    - Report address and port correctly on connections to DNSPort. (Patch
      from Robert Hogan.)
    - Add a RESOLVE command to launch hostname lookups. (Original patch
      from Robert Hogan.)
    - Add GETINFO status/enough-dir-info to let controllers tell whether
      Tor has downloaded sufficient directory information. (Patch
      from Tup.)
    - You can now use the ControlSocket option to tell Tor to listen for
      controller connections on Unix domain sockets on systems that
      support them. (Patch from Peter Palfrader.)
    - STREAM NEW events are generated for DNSPort requests and for
      tunneled directory connections. (Patch from Robert Hogan.)
    - New "GETINFO address-mappings/*" command to get address mappings
      with expiry information. "addr-mappings/*" is now deprecated.
      (Patch from Tup.)
  o Minor features (misc):
    - Merge in some (as-yet-unused) IPv6 address manipulation code. (Patch
      from croup.)
    - The tor-gencert tool for v3 directory authorities now creates all
      files as readable to the file creator only, and write-protects
      the authority identity key.
    - When dumping memory usage, list bytes used in buffer memory
      free-lists.
    - When running with dmalloc, dump more stats on hup and on exit.
    - Directory authorities now fail quickly and (relatively) harmlessly
      if they generate a network status document that is somehow
      malformed.
  o Traffic load balancing improvements:
    - If exit bandwidth ever exceeds one third of total bandwidth, then
      use the correct formula to weight exit nodes when choosing paths.
      (Based on patch from Mike Perry.)
    - Choose perfectly fairly among routers when choosing by bandwidth and
      weighting by fraction of bandwidth provided by exits. Previously, we
      would choose with only approximate fairness, and correct ourselves
      if we ran off the end of the list. [Bugfix on 0.1.2.x]
  o Performance improvements:
    - Be more aggressive with freeing buffer RAM or putting it on the
      memory free lists.
    - Use Critical Sections rather than Mutexes for synchronizing threads
      on win32; Mutexes are heavier-weight, and designed for synchronizing
      between processes.
  o Deprecated and removed features:
    - RedirectExits is now deprecated.
    - Stop allowing address masks that do not correspond to bit prefixes.
      We have warned about these for a really long time; now it's time
      to reject them. (Patch from croup.)
  o Minor bugfixes (directory):
    - Fix another crash bug related to extra-info caching. (Bug found by
      Peter Palfrader.) [Bugfix on 0.2.0.2-alpha]
    - Directories no longer return a "304 not modified" when they don't
      have the networkstatus the client asked for. Also fix a memory
      leak when returning 304 not modified. [Bugfixes on 0.2.0.2-alpha]
    - We had accidentally labelled 0.1.2.x directory servers as not
      suitable for begin_dir requests, and had labelled no directory
      servers as suitable for uploading extra-info documents. [Bugfix
      on 0.2.0.1-alpha]
  o Minor bugfixes (dns):
    - Fix a crash when DNSPort is set more than once. (Patch from Robert
      Hogan.) [Bugfix on 0.2.0.2-alpha]
    - Add DNSPort connections to the global connection list, so that we
      can time them out correctly. (Bug found by Robert Hogan.) [Bugfix
      on 0.2.0.2-alpha]
    - Fix a dangling reference that could lead to a crash when DNSPort is
      changed or closed (Patch from Robert Hogan.) [Bugfix on
      0.2.0.2-alpha]
  o Minor bugfixes (controller):
    - Provide DNS expiry times in GMT, not in local time. For backward
      compatibility, ADDRMAP events only provide GMT expiry in an extended
      field. "GETINFO address-mappings" always does the right thing.
    - Use CRLF line endings properly in NS events.
    - Terminate multi-line control events properly. (Original patch
      from tup.) [Bugfix on 0.1.2.x-alpha]
    - Do not include spaces in SOURCE_ADDR fields in STREAM
      events. Resolves bug 472. [Bugfix on 0.2.0.x-alpha]

@_date: 2007-08-11 14:33:22
@_author: Roger Dingledine 
@_subject: Question about the vulnerability 
Read  for the
answer. We do promise to explain it better once more people have had a
chance to upgrade. :)
Hope that helps,

@_date: 2007-08-14 10:29:57
@_author: Roger Dingledine 
@_subject: contradicting log entries regarding ExcludeNodes 
This is because you specified it both as a nickname and as a key. You
should specify it just as a key, and this warning will go away:
ExcludeNodes $3B1CD4DC4863DD1013E7C35A6F475C28946AB909
You should add 'SafeLogging 0' to your torrc to see what the value
of [scrubbed] is, but I suspect this is DirPort reachability testing.
Are you *sure* you're looking at your Tor client's logs? It looks more
like your Tor server's logs.

@_date: 2007-08-16 22:17:40
@_author: Roger Dingledine 
@_subject: Academic usability meets Tor 
Hi folks,
For those who are interested, a group of security/usability academics we
know did a nice analysis of the state of Tor installation/configuration
approaches as of about a year ago:
The link is from:
If anybody wants to grab ahold of the suggestions in the paper and turn
them into more concrete patches, please do. :)

@_date: 2007-08-18 22:58:21
@_author: Roger Dingledine 
@_subject: MinGW compile error with rev 10888 
Try tor trunk now. I believe it should work.
I also think it's a libevent error though, since the problem is that
libevent's event.h has no idea what a timeval is. Tor has a workaround
for systems that don't define a timeval, but libevent should include
this workaround too. Nick, can you look further into this?

@_date: 2007-08-19 15:07:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.5-alpha is out 
This development snapshot fixes compilation on Windows again; fixes an
obnoxious client-side bug that slowed things down and put extra load
on the network; gets us closer to using the v3 directory voting scheme;
makes it easier for Tor controllers to use cookie-based authentication;
and fixes a variety of other bugs.
Changes in version 0.2.0.5-alpha - 2007-08-19
  o Removed features:
    - Version 1 directories are no longer generated in full. Instead,
      authorities generate and serve "stub" v1 directories that list
      no servers. This will stop Tor versions 0.1.0.x and earlier from
      working, but (for security reasons) nobody should be running those
      versions anyway.
  o Major bugfixes (compilation, 0.2.0.x):
    - Try to fix Win32 compilation again: improve checking for IPv6 types.
    - Try to fix MSVC compilation: build correctly on platforms that do
      not define s6_addr16 or s6_addr32.
    - Fix compile on platforms without getaddrinfo: bug found by Li-Hui
      Zhou.
  o Major bugfixes (stream expiration):
    - Expire not-yet-successful application streams in all cases if
      they've been around longer than SocksTimeout. Right now there are
      some cases where the stream will live forever, demanding a new
      circuit every 15 seconds. Bugfix on 0.1.2.7-alpha; fixes bug 454;
      reported by lodger.
  o Minor features (directory servers):
    - When somebody requests a list of statuses or servers, and we have
      none of those, return a 404 rather than an empty 200.
  o Minor features (directory voting):
    - Store v3 consensus status consensuses on disk, and reload them
      on startup.
  o Minor features (security):
    - Warn about unsafe ControlPort configurations.
    - Refuse to start with certain directory authority keys, and
      encourage people using them to stop.
  o Minor features (controller):
    - Add a PROTOCOLINFO controller command. Like AUTHENTICATE, it
      is valid before any authentication has been received. It tells
      a controller what kind of authentication is expected, and what
      protocol is spoken. Implements proposal 119.
    - New config option CookieAuthFile to choose a new location for the
      cookie authentication file, and config option
      CookieAuthFileGroupReadable to make it group-readable.
  o Minor features (unit testing):
    - Add command-line arguments to unit-test executable so that we can
      invoke any chosen test from the command line rather than having
      to run the whole test suite at once; and so that we can turn on
      logging for the unit tests.
  o Minor bugfixes (on 0.1.2.x):
    - If we require CookieAuthentication but we fail to write the
      cookie file, we would warn but not exit, and end up in a state
      where no controller could authenticate. Now we exit.
    - If we require CookieAuthentication, stop generating a new cookie
      every time we change any piece of our config.
    - When loading bandwidth history, do not believe any information in
      the future.  Fixes bug 434.
    - When loading entry guard information, do not believe any information
      in the future.
    - When we have our clock set far in the future and generate an
      onion key, then re-set our clock to be correct, we should not stop
      the onion key from getting rotated.
    - Clean up torrc sample config file.
    - Do not automatically run configure from autogen.sh. This
      non-standard behavior tended to annoy people who have built other
      programs.
  o Minor bugfixes (on 0.2.0.x):
    - Fix a bug with AutomapHostsOnResolve that would always cause
      the second request to fail. Bug reported by Kate. Bugfix on
      0.2.0.3-alpha.
    - Fix a bug in ADDRMAP controller replies that would sometimes
      try to print a NULL. Patch from tup.
    - Read v3 directory authority keys from the right location.
    - Numerous bugfixes to directory voting code.

@_date: 2007-08-20 00:31:08
@_author: Roger Dingledine 
@_subject: 0.1.2.17 is getting close to ready; please test it 
Hi folks,
We're getting close to having 0.1.2.17 ready. I've put a snapshot at
Please grab it, try it out, and let us know whether we broke anything. (We
may be adding a few more backports before the final release, but this
should be most of them.)
Partial list of changes in version 0.1.2.17 - 2007-08-??
  o Removed features (security):
    - We removed support for the old (v0) control protocol. It has been
      deprecated since Tor 0.1.1.1-alpha, and keeping it safe and secure
      has been more of a headache than it's worth.
  o Major bugfixes (stream expiration):
    - Expire not-yet-successful application streams in all cases if
      they've been around longer than SocksTimeout. Right now there are
      some cases where the stream will live forever, demanding a new
      circuit every 15 seconds. Bugfix on 0.1.2.7-alpha; fixes bug 454;
      reported by lodger.
  o Minor features (controller):
    - Add a PROTOCOLINFO controller command. Like AUTHENTICATE, it
      is valid before any authentication has been received. It tells
      a controller what kind of authentication is expected, and what
      protocol is spoken. Implements proposal 119.
  o Minor bugfixes (performance):
    - Save on most routerlist_assert_ok() calls in routerlist.c, thus
      greatly speeding up loading cached-routers from disk on startup.
    - Disable sentinel-based debugging for buffer code: we squashed all
      the bugs that this was supposed to detect a long time ago, and now
      its only effect is to change our buffer sizes from nice powers of
      two (which platform mallocs tend to like) to values slightly over
      powers of two (which make some platform mallocs sad).
  o Minor bugfixes (misc):
    - If exit bandwidth ever exceeds one third of total bandwidth, then
      use the correct formula to weight exit nodes when choosing paths.
      Based on patch from Mike Perry.
    - Choose perfectly fairly among routers when choosing by bandwidth and
      weighting by fraction of bandwidth provided by exits. Previously, we
      would choose with only approximate fairness, and correct ourselves
      if we ran off the end of the list.
    - If we require CookieAuthentication but we fail to write the
      cookie file, we would warn but not exit, and end up in a state
      where no controller could authenticate. Now we exit.
    - If we require CookieAuthentication, stop generating a new cookie
      every time we change any piece of our config.
    - Refuse to start with certain directory authority keys, and
      encourage people using them to stop.
    - Terminate multi-line control events properly. Original patch
      from tup.

@_date: 2007-08-21 17:43:41
@_author: Roger Dingledine 
@_subject: 0.2.0.5-alpha breaks cookiefile (was Re: error noted in) 
Hi Robert,
I figured I should mention that Tor 0.2.0.5-alpha has a bug where the
controller authentication cookie is not written to the expected file.
This is fixed in trunk, and will be fixed in 0.2.0.6-alpha too. I
imagine this will inconvenience any TorK users that use cookie auth.

@_date: 2007-08-23 00:31:19
@_author: Roger Dingledine 
@_subject: How can a node become an entry guard? 
See Section 3.3 of
Note that the properties required for the 'Stable' flag are in
flux right now:

@_date: 2007-08-23 00:51:12
@_author: Roger Dingledine 
@_subject: No descriptor send beeing only directory mirror 
Right. You're not a Tor server, so there's no need to make a descriptor
or advertise yourself to the world. You're just a directory mirror, which
we assume is to be used for private purposes, like the one you describe.
It's intentional.

@_date: 2007-08-27 02:26:25
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.6-alpha is out 
This sixth development snapshot features a new Vidalia version in the
Windows and OS X bundles. Vidalia 0.0.14 makes authentication required for
the ControlPort in the default configuration, which addresses important
security risks.
In addition, this snapshot fixes major load balancing problems
with path selection, which should speed things up a lot once many
people have upgraded. The directory authorities also use a new
mean-time-between-failure approach to tracking which servers are stable,
rather than just looking at the most recent uptime.
Changes in version 0.2.0.6-alpha - 2007-08-26
  o New directory authorities:
    - Set up Tonga as the default bridge directory authority.
  o Major features:
    - Directory authorities now track servers by weighted
      mean-times-between-failures. When we have 4 or more days of data,
      use measured MTBF rather than declared uptime to decide whether
      to call a router Stable. Implements proposal 108.
  o Major bugfixes (load balancing):
    - When choosing nodes for non-guard positions, weight guards
      proportionally less, since they already have enough load. Patch
      from Mike Perry.
    - Raise the "max believable bandwidth" from 1.5MB/s to 10MB/s. This
      will allow fast Tor servers to get more attention.
    - When we're upgrading from an old Tor version, forget our current
      guards and pick new ones according to the new weightings. These
      three load balancing patches could raise effective network capacity
      by a factor of four. Thanks to Mike Perry for measurements.
  o Major bugfixes (descriptor parsing):
    - Handle unexpected whitespace better in malformed descriptors. Bug
      found using Benedikt Boss's new Tor fuzzer! Bugfix on 0.2.0.x.
  o Minor features:
    - There is now an ugly, temporary "desc/all-recent-extrainfo-hack"
      GETINFO for Torstat to use until it can switch to using extrainfos.
    - Optionally (if built with -DEXPORTMALLINFO) export the output
      of mallinfo via http, as tor/mallinfo.txt. Only accessible
      from localhost.
  o Minor bugfixes:
    - Do not intermix bridge routers with controller-added
      routers. (Bugfix on 0.2.0.x)
    - Do not fail with an assert when accept() returns an unexpected
      address family. Addresses but does not wholly fix bug 483. (Bugfix
      on 0.2.0.x)
    - Let directory authorities startup even when they can't generate
      a descriptor immediately, e.g. because they don't know their
      address.
    - Stop putting the authentication cookie in a file called "0"
      in your working directory if you don't specify anything for the
      new CookieAuthFile option. Reported by Matt Edman.
    - Make it possible to read the PROTOCOLINFO response in a way that
      conforms to our control-spec. Reported by Matt Edman.
    - Fix a minor memory leak when we fail to find enough suitable
      servers to choose a circuit. Bugfix on 0.1.2.x.
    - Stop leaking part of the descriptor when we run into a particularly
      unparseable piece of it. Bugfix on 0.1.2.x.
    - Unmap the extrainfo cache file on exit.

@_date: 2007-08-28 17:14:17
@_author: Roger Dingledine 
@_subject: Some problems setting up a server 
If your cablemodem/dsl router died, this is the hint:
and if your PC's networking and stuff died, it's probably this:

@_date: 2007-08-29 04:36:33
@_author: Roger Dingledine 
@_subject: TorCheck - New Features 
Great, I'm happy to see this last one. It's been on my todo list to
track you down and let you know about the newly returned exitlist. :)
But why do you ask about exiting to google.com:80? Why not ask exitlist
whether there's a Tor node that will exit to torcheck.xenobite.eu:80?
(Or I guess in the case of  a Tor node
that will exit to torcheck.xenobite.eu:443?)

@_date: 2007-08-29 04:38:08
@_author: Roger Dingledine 
@_subject: Some problems setting up a server 
Hm. Linux doesn't just die like that. Perhaps you have a hardware
problem? Perhaps you are running some obsolete version of something?
You might try finding a friendly local sysadmin who can help you track
down the problem.

@_date: 2007-08-04 14:23:12
@_author: Roger Dingledine 
@_subject: critical security vulnaribility fixed in Tor 0.1.2.16 
(Typing on defcon network so will be quite brief)
The short answer is yes, this is an attack, and no, we're not going
to tell you exactly how it works yet. That's because several hundred
thousand people are vulnerable, and we're going to give them several
weeks to upgrade before we arm random people on the Internet with the
ability to launch this attack against them.
You should be one of the people who upgrades. :)

@_date: 2007-08-04 15:32:51
@_author: Roger Dingledine 
@_subject: Tor and NTLM (was Re: Can we beat the "Firewall of china" attack?) 
See the middle paragraph of
for how to do NTLM along with your http proxy for Tor.

@_date: 2007-08-07 20:15:54
@_author: Roger Dingledine 
@_subject: orconfig.h for windows 
Once upon a time, the answer was "manually" -- you can still see one in
 which I presume is useful for
MSVC++ builds or the like.
If you're using mingw, look at
 for
instructions that appear to run ./configure, and therefore probably auto
generate an orconfig.h file.
Hope that helps,

@_date: 2007-12-01 23:12:51
@_author: Roger Dingledine 
@_subject: Help me understand tor with SSL? 
Privoxy doesn't do that much to protect you. Doing something in the
browser, for example the development version of Torbutton (as shipped
in the 0.2.0.x bundles), is a safer bet.
In the future I'm hoping to swap Privoxy out and put Polipo in its
place. One day I'll get around to organizing my list of reasons for that.
The reason for continuing to use an http proxy at all, rather than just
going directly from Firefox to Tor as a socks proxy? Firefox doesn't deal
well if the socks handshake takes more than a trivial amount of time. In
particular, all other network operations block until the handshake
finishes. See e.g. particularly comment Hope that helps,

@_date: 2007-12-10 13:23:42
@_author: Roger Dingledine 
@_subject: Suspicious Circuits 
Exciting. Looks like a bug of some sort.
We make an exception for client-side introduction circuits: the first
three hops ensure your anonymity, and after that we try one random
node at a time out of the set of introduction points listed in the
hidden service descriptor. If one of the intro points doesn't cooperate
(for example because the hidden service is no longer connected to that
introduction point, so they *can't* help), then we move on to the next.
We keep reusing the same circuit (just extending it another hop each time)
so we don't waste a lot of time making new circuits.
But we're *supposed* to be marking each intro point down when it
isn't helpful, so the fact that we're extending back to it (repeatedly
sometimes, based on your jpgs!) is definitely a bug of some sort. Can
you get me a debug-level log from when this happens?
Also, you mentioned that the bug doesn't happen on 0.1.2.8-alpha. What
about 0.1.2.18?

@_date: 2007-12-10 13:39:30
@_author: Roger Dingledine 
@_subject: torbutton webpage comments 
(Eric: sorry for the fuss. I'll let Mike Perry answer your thread,
since he's in the best position to do so.)
Please take your retroshare advocacy elsewhere. We don't want it on
or-talk, or for Tor in general.

@_date: 2007-12-12 20:46:40
@_author: Roger Dingledine 
@_subject: tor26 missing certificate messages today 
This is a bug (either with logging or some deeper confusion) that was
triggered by adding a fourth v3 directory authority. I still don't know
what the bug is, which means it's a good bet it'll show up when we add
the fifth. :)
But it seems to have resolved itself after one voting period, so I am
not too worried.

@_date: 2007-12-19 10:32:37
@_author: Roger Dingledine 
@_subject: Suspicious Circuits 
Hi Karsten,
A) This explains why it is trying the old introduction points, and it
explains why it's building a long circuit trying each one in turn. But
why is it trying the same introduction point more than once?
B) Do you think it's possible to reduce the "30 second delay" to make
this sort of behavior happen less often? It would be nice to have hidden
services launch more 'immediately'. But on more thought, I think 30
seconds may already be a bare minimum, if we consider users on crappy
connections setting up hidden services. Hm.

@_date: 2007-12-19 10:46:56
@_author: Roger Dingledine 
@_subject: another seeming attack on my server's DirPort 
Hi Scott,
Can you check what's being repeatedly fetched?
One way to do this is to run at loglevel debug briefly, and look for
  log_debug(LD_DIRSERV,"rewritten url as '%s'.", url);
My first guess is that it's a runaway Tor client, or a runaway cache
between the Tor client and you, rather than any intentionally abusive
behavior. (It's amazing what can go wrong on the Internet when you have
enough participants.)

@_date: 2007-12-19 10:54:46
@_author: Roger Dingledine 
@_subject: Tor gives "resolve failed" errors even when IP address is supplied 
Hopefully you mean using privoxy as an http proxy.
If you turn SafeLogging to 0 in your torrc, it will tell you what address
Tor thought you were asking for. That might help to identify the problem,
e.g. if you're asking to connect to  rather than 24.4.4.4.

@_date: 2007-12-20 13:16:10
@_author: Roger Dingledine 
@_subject: Kyle's controlport bug 
Hi Kyle,
I'd love to hear more details on this. It would be a bad bug indeed.
But I've never encountered or heard about anything like it, so far. :)

@_date: 2007-12-22 04:19:09
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.13-alpha is out 
Tor 0.2.0.13-alpha adds a fourth v3 directory authority run by Geoff
Goodell, fixes many more bugs, and adds a lot of infrastructure for
upcoming features.
Changes in version 0.2.0.13-alpha - 2007-12-21
  o New directory authorities:
    - Set up lefkada (run by Geoff Goodell) as the fourth v3 directory
      authority.
  o Major bugfixes:
    - Only update guard status (usable / not usable) once we have
      enough directory information. This was causing us to always pick
      two new guards on startup (bugfix on 0.2.0.9-alpha), and it was
      causing us to discard all our guards on startup if we hadn't been
      running for a few weeks (bugfix on 0.1.2.x). Fixes bug 448.
    - Purge old entries from the "rephist" database and the hidden
      service descriptor databases even when DirPort is zero. Bugfix
      on 0.1.2.x.
    - We were ignoring our RelayBandwidthRate for the first 30 seconds
      after opening a circuit -- even a relayed circuit. Bugfix on
      0.2.0.3-alpha.
    - Stop thinking that 0.1.2.x directory servers can handle "begin_dir"
      requests. Should ease bugs 406 and 419 where 0.1.2.x relays are
      crashing or mis-answering these types of requests.
    - Relays were publishing their server descriptor to v1 and v2
      directory authorities, but they didn't try publishing to v3-only
      authorities. Fix this; and also stop publishing to v1 authorities.
      Bugfix on 0.2.0.x.
    - When we were reading router descriptors from cache, we were ignoring
      the annotations -- so for example we were reading in bridge-purpose
      descriptors as general-purpose descriptors. Bugfix on 0.2.0.8-alpha.
    - When we decided to send a 503 response to a request for servers, we
      were then also sending the server descriptors: this defeats the
      whole purpose. Fixes bug 539; bugfix on 0.1.2.x.
  o Major features:
    - Bridge relays now behave like clients with respect to time
      intervals for downloading new consensus documents -- otherwise they
      stand out. Bridge users now wait until the end of the interval,
      so their bridge relay will be sure to have a new consensus document.
    - Three new config options (AlternateDirAuthority,
      AlternateBridgeAuthority, and AlternateHSAuthority) that let the
      user selectively replace the default directory authorities by type,
      rather than the all-or-nothing replacement that DirServer offers.
    - Tor can now be configured to read a GeoIP file from disk in one
      of two formats. This can be used by controllers to map IP addresses
      to countries. Eventually, it may support exit-by-country.
    - When possible, bridge relays remember which countries users
      are coming from, and report aggregate information in their
      extra-info documents, so that the bridge authorities can learn
      where Tor is blocked.
    - Bridge directory authorities now do reachability testing on the
      bridges they know. They provide router status summaries to the
      controller via "getinfo ns/purpose/bridge", and also dump summaries
      to a file periodically.
    - Stop fetching directory info so aggressively if your DirPort is
      on but your ORPort is off; stop fetching v2 dir info entirely.
      You can override these choices with the new FetchDirInfoEarly
      config option.
  o Minor bugfixes:
    - The fix in 0.2.0.12-alpha cleared the "hsdir" flag in v3 network
      consensus documents when there are too many relays at a single
      IP address. Now clear it in v2 network status documents too, and
      also clear it in routerinfo_t when the relay is no longer listed
      in the relevant networkstatus document.
    - Don't crash if we get an unexpected value for the
      PublishServerDescriptor config option. Reported by Matt Edman;
      bugfix on 0.2.0.9-alpha.
    - Our new v2 hidden service descriptor format allows descriptors
      that have no introduction points. But Tor crashed when we tried
      to build a descriptor with no intro points (and it would have
      crashed if we had tried to parse one). Bugfix on 0.2.0.x; patch
      by Karsten Loesing.
    - Fix building with dmalloc 5.5.2 with glibc.
    - Reject uploaded descriptors and extrainfo documents if they're
      huge. Otherwise we'll cache them all over the network and it'll
      clog everything up. Reported by Aljosha Judmayer.
    - Check for presence of s6_addr16 and s6_addr32 fields in in6_addr
      via autoconf. Should fix compile on solaris. Bugfix on 0.2.0.x.
    - When the DANGEROUS_VERSION controller status event told us we're
      running an obsolete version, it used the string "OLD" to describe
      it. Yet the "getinfo" interface used the string "OBSOLETE". Now use
      "OBSOLETE" in both cases. Bugfix on 0.1.2.x.
    - If we can't expand our list of entry guards (e.g. because we're
      using bridges or we have StrictEntryNodes set), don't mark relays
      down when they fail a directory request. Otherwise we're too quick
      to mark all our entry points down. Bugfix on 0.1.2.x.
    - Fix handling of hex nicknames when answering controller requests for
      networkstatus by name, or when deciding whether to warn about unknown
      routers in a config option. Bugfix on 0.1.2.x. (Patch from mwenge.)
    - Fix a couple of hard-to-trigger autoconf problems that could result
      in really weird results on platforms whose sys/types.h files define
      nonstandard integer types. Bugfix on 0.1.2.x.
    - Fix compilation with --disable-threads set. Bugfix on 0.2.0.x.
    - Don't crash on name lookup when we have no current consensus.  Fixes
      bug 538; bugfix on 0.2.0.x.
    - Only Tors that want to mirror the v2 directory info should
      create the "cached-status" directory in their datadir. (All Tors
      used to create it.) Bugfix on 0.2.0.9-alpha.
    - Directory authorities should only automatically download Extra Info
      documents if they're v1, v2, or v3 authorities. Bugfix on 0.1.2.x.
  o Minor features:
    - On the USR1 signal, when dmalloc is in use, log the top 10 memory
      consumers. (We already do this on HUP.)
    - Authorities and caches fetch the v2 networkstatus documents
      less often, now that v3 is encouraged.
    - Add a new config option BridgeRelay that specifies you want to
      be a bridge relay. Right now the only difference is that it makes
      you answer begin_dir requests, and it makes you cache dir info,
      even if your DirPort isn't on.
    - Add "GETINFO/desc-annotations/id/" so controllers can
      ask about source, timestamp of arrival, purpose, etc. We need
      something like this to help Vidalia not do GeoIP lookups on bridge
      addresses.
    - Allow multiple HashedControlPassword config lines, to support
      multiple controller passwords.
    - Authorities now decide whether they're authoritative for a given
      router based on the router's purpose.
    - New config options AuthDirBadDir and AuthDirListBadDirs for
      authorities to mark certain relays as "bad directories" in the
      networkstatus documents. Also supports the "!baddir" directive in
      the approved-routers file.

@_date: 2007-12-22 05:00:28
@_author: Roger Dingledine 
@_subject: Please run a bridge relay! (was Re: Tor 0.2.0.13-alpha is out) 
Hi folks,
One of the new features we've been working on is called "bridges". We
need some volunteers to run more of them.
Bridge relays (or "bridges" for short) are Tor relays that aren't listed
in the main directory. Since there is no complete public list of them,
even if an ISP is filtering connections to all the known Tor relays,
they probably won't be able to block all the bridges. From the operator's
perspective, unlike running an exit relay, running a bridge relay just
passes data to and from the Tor network, so it shouldn't expose the
operator to any abuse complaints.
First, install the latest development bundle from
There are two ways to set up a bridge. The easy way is to go into
Vidalia's Settings -> Relay window, and click "Help censored users
reach the Tor network". You might want to click on 'Bandwidth Limits'
too and set that to something smaller. Then click save.
The harder way is to edit your torrc file manually
and add the following lines:
  ORPort 443
  BridgeRelay 1
  PublishServerDescriptor bridge
  ExitPolicy reject *:*
  RelayBandwidthRate 50 KBytes
In either case, your next step is to mess with your Linksys router or
whatever you're using, and set up port forwarding so connections will
make it to port 443 of the computer running the bridge relay. Then check
your 'Message Log' window to see whether "Self-testing indicates your
ORPort is reachable from the outside", or "Your server has not managed
to confirm that its ORPort is reachable."
If you're interested, you can see a few bridges listed here:
You only learn a small number of bridges from any single location, to
make it a bit harder for attackers to learn them all. We've still got a
big pile of items on the bridge todo list, but having more bridges for
testing is really useful for the next steps.
Plus there are people in the world who need them. :)

@_date: 2007-12-22 05:23:19
@_author: Roger Dingledine 
@_subject: Please run a bridge relay! (was Re: Tor 0.2.0.13-alpha is out) 
Minor fix: if you use this last line, you'll also want this line
    RelayBandwidthBurst 50 KBytes

@_date: 2007-12-23 14:52:44
@_author: Roger Dingledine 
@_subject: Vidalia shows reachability-testing circuits (was Re: About bridges) 
What you are seeing are the "reachability test" circuits. They go from
you through the Tor network back to you, so we can make sure that your
relay is reachable from other relays. See also Section 2.1.3 of
Options I can imagine:
a) get Vidalia to mark each circuit with its purpose, so it's easier to
know why those circuits are being displayed. This would involve some
hard thinking -- mostly to figure out a good interface that doesn't
clutter things even more.
b) get Vidalia to not display non-general-purpose circuits. That way
these circuits wouldn't show up on that map, so fewer people would ask
about them. Somewhat easier to do, but feels like we're hiding
potentially useful info from the users.
c) continue to answer this question a few times a year.
d) other ideas?

@_date: 2007-12-23 21:14:24
@_author: Roger Dingledine 
@_subject: Kyle's controlport bug 
Interesting. Is it plausible to respond "well, don't do that then?"
There are a few other cases where Tor will freeze doing a dns resolve,
e.g. if you specify a fqdn rather than IP address for your hidden
service's location. But in your case above, it's not even Tor that's
doing the resolve -- so I have no idea how we'd go about "fixing" that.
I guess we could disallow filenames that look funny. Is there a valid
use case for netbios calls here, or do they always signal funny business?
Sounds great. Yeah, if somebody can trigger it remotely, that's
definitely something to fix. I don't see how they could though.

@_date: 2007-12-24 04:23:10
@_author: Roger Dingledine 
@_subject: Please run a bridge relay! (was Re: Tor 0.2.0.13-alpha is out) 
You'd want to say
ORPort 443
ORListenAddress 0.0.0.0:1443
See also

@_date: 2007-12-27 09:00:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.15-alpha is out 
Tor 0.2.0.14-alpha and 0.2.0.15-alpha fix a bunch of bugs with the
features added in 0.2.0.13-alpha.
Changes in version 0.2.0.15-alpha - 2007-12-25
  o Major bugfixes:
    - Fix several remotely triggerable asserts based on DirPort requests
      for a v2 or v3 networkstatus object before we were prepared. This
      was particularly bad for 0.2.0.13 and later bridge relays, who
      would never have a v2 networkstatus and would thus always crash
      when used. Bugfixes on 0.2.0.x.
    - Estimate the v3 networkstatus size more accurately, rather than
      estimating it at zero bytes and giving it artificially high priority
      compared to other directory requests. Bugfix on 0.2.0.x.
  o Minor bugfixes:
    - Fix configure.in logic for cross-compilation.
    - When we load a bridge descriptor from the cache, and it was
      previously unreachable, mark it as retriable so we won't just
      ignore it. Also, try fetching a new copy immediately. Bugfixes
      on 0.2.0.13-alpha.
    - The bridge GeoIP stats were counting other relays, for example
      self-reachability and authority-reachability tests.
  o Minor features:
    - Support compilation to target iPhone; patch from cjacker huang.
      To build for iPhone, pass the --enable-iphone option to configure.
Changes in version 0.2.0.14-alpha - 2007-12-23
  o Major bugfixes:
    - Fix a crash on startup if you install Tor 0.2.0.13-alpha fresh
      without a datadirectory from a previous Tor install. Reported
      by Zax.
    - Fix a crash when we fetch a descriptor that turns out to be
      unexpected (it used to be in our networkstatus when we started
      fetching it, but it isn't in our current networkstatus), and we
      aren't using bridges. Bugfix on 0.2.0.x.
    - Fix a crash when accessing hidden services: it would work the first
      time you use a given introduction point for your service, but
      on subsequent requests we'd be using garbage memory. Fixed by
      Karsten Loesing. Bugfix on 0.2.0.13-alpha.
    - Fix a crash when we load a bridge descriptor from disk but we don't
      currently have a Bridge line for it in our torrc. Bugfix on
      0.2.0.13-alpha.
  o Major features:
    - If bridge authorities set BridgePassword, they will serve a
      snapshot of known bridge routerstatuses from their DirPort to
      anybody who knows that password. Unset by default.
  o Minor bugfixes:
    - Make the unit tests build again.
    - Make "GETINFO/desc-annotations/id/" actually work.
    - Make PublishServerDescriptor default to 1, so the default doesn't
      have to change as we invent new directory protocol versions.
    - Fix test for rlim_t on OSX 10.3: sys/resource.h doesn't want to
      be included unless sys/time.h is already included.  Fixes
      bug 553.  Bugfix on 0.2.0.x.
    - If we receive a general-purpose descriptor and then receive an
      identical bridge-purpose descriptor soon after, don't discard
      the next one as a duplicate.
  o Minor features:
    - If BridgeRelay is set to 1, then the default for
      PublishServerDescriptor is now "bridge" rather than "v2,v3".
    - If the user sets RelayBandwidthRate but doesn't set
      RelayBandwidthBurst, then make them equal rather than erroring out.

@_date: 2007-12-04 09:19:48
@_author: Roger Dingledine 
@_subject: How to detect DNS leaks (was Re: Had someone of made Gajim working with Tor?) 
I just added a faq entry to help out a bit here:
Hope that helps,

@_date: 2007-12-04 09:35:13
@_author: Roger Dingledine 
@_subject: Tor takes too much RAM 
Hi folks (especially Olaf),
If you're using Linux, and you're unhappy with the amount of ram and
cpu your Tor server is using, try out Nick's suggestion here:
and let us know what you learn. :)

@_date: 2007-12-04 09:53:40
@_author: Roger Dingledine 
@_subject: BSD/etc Tor servers? (was Re: Tor takes too much RAM) 
The apparently obsolete ones are valid for some v2 networkstatus that
is still live. That is, there might be a client out there with an old
but still valid v2 networkstatus that lists one of those old descriptors.
So since you're a cache, you need to keep copies of those around too,
in case some client asks for them.
You discard them once the networkstatus that listed them becomes obsolete.
See Once the v2 directory design disappears in favor of v3 (which is used
in the Tor 0.2.0.x branch), the number of descriptors the caches will
need to cache should go down.
No, Tor mmaps that file, so it isn't all in memory.

@_date: 2007-12-05 13:58:40
@_author: Roger Dingledine 
@_subject: Help with directory mirror 
I think you might misunderstand what DirServer is for. That config line
changes the directory authorities that Tor believes in. So if you put
DirServer lines pointing to DirectoryMirror{1,2,3}, then Tor will demand
networkstatus documents (or in 0.2.0, a consensus document) signed by
a majority of the DirServers.
Since you didn't talk above about setting AuthoritativeDirectory, which
you would do if you were actually trying to create your own separate Tor
network, I have to assume that the mirrors aren't making any networkstatus
documents, which means anybody who sets DirServer lines pointing to them
are going to have real problems finding enough dir info to make circuits.
It probably has TorX in its cached-status from back before you changed
the DirServer lines on TorX?
Something is deeply wrong with your assumptions here. You might try
reading the man page entries again.
Hope that helps,

@_date: 2007-12-06 06:08:34
@_author: Roger Dingledine 
@_subject: Help with directory mirror 
Ah. Right now Tor only supports having one "main" networkstatus when
it's building circuits for itself. If a router isn't listed (and listed
as Running) in the main networkstatus, then it won't want to use it for
a circuit.
Probably the best way to merge Tor networks for now is to POSTDESCRIPTOR
the "private" descriptors via the control port interface, and then use
EXTENDCIRCUIT to tell Tor what path you want it to build. You would have
to get the descriptors to the controller somehow, for example by rigging
a simple directory system of your own.
This approach may have bugs now though, since it hasn't been used in
a few years (since Blossom was active) and we've been mucking with all
sorts of things since then. Patches appreciated. :)
Hope that helps,

@_date: 2007-02-27 01:23:34
@_author: Roger Dingledine 
@_subject: purging old router information, revocation 
It looks like authorities do reachability testing on anything that's
in rl->routers: see dirserv_test_reachability().
It looks like elements are only removed from that list in
routerlist_remove_old_routers(), and it removes them if they're more
than 48 hours old *and* they're not recommended by networkstatuses.
This is probably a bug: we don't mention them in the directories if
they're older than 20 hours, yet we keep testing them for at least 48
hours. Here's a fix for that:
--- dirserv.c   (revision 9664)
+++ dirserv.c   (working copy)
 -1968,6 +1968,7  dirserv_test_reachability(int try_all)
 {
   time_t now = time(NULL);
+  time_t cutoff = now - ROUTER_MAX_AGE_TO_PUBLISH;
   routerlist_t *rl = router_get_routerlist();
   static char ctr = 0;
 -1975,6 +1976,8      const char *id_digest = router->cache_info.identity_digest;
     if (router_is_me(router))
       continue;
+    if (router->cache_info.published_on > cutoff)
+      continue;
     if (try_all || (((uint8_t)id_digest[0]) % 128) == ctr) {
       log_debug(LD_OR,"Testing reachability of %s at %s:%u.",
                 router->nickname, router->address, router->or_port);
But it's not that clearcut, since 'getinfo network-status' via the
controller lists all routerinfos in rl->routers, regardless of age,
in list_server_status(). Perhaps *that* is a bug too, since you'll be
getting different output from the controller than you would from the
directory port? :)
Needs a bit more thinking. Does anybody here use getinfo network-status,
and if so, what behavior do you expect?

@_date: 2007-02-27 01:29:58
@_author: Roger Dingledine 
@_subject: map of tor routers 
I would say no -- running as a directory authority, but not having any
clients or servers who think you're a directory authority, isn't going
to buy you anything.
If you want to get slightly faster updates for your Tor cache, you should
enable your DirPort. This will signal to Tor that you want to keep a bit
more up to date than if you're just a plain user.
I'll leave the peerguardian idea up to you, but just imagine where we'd
be if we believed every Internet-scale blacklist out there...

@_date: 2007-02-27 01:37:23
@_author: Roger Dingledine 
@_subject: Question about 2 warn messages 
These are fine, as long as Tor is working for you. They happen because
somebody is advertising an open DirPort somewhere, but actually they're
running some other software at that address and port. In this case it's
probably some sort of web cache or web server. Eventually I'd like to
stop mentioning these to users (there's not much they can do, after all),
but at the same time if *all* your directory requests are showing these
errors, then it's a good hint that maybe your local http connections
are being intercepted and blocked. For example, this happens on hotel
or airport wireless networks.
I'll add a todo item to try to be smarter about when we can be quiet
and when we should tell the user -- for example, if Tor has already
bootstrapped and we hit just one bad dirport, it's not worth mentioning.

@_date: 2007-02-27 01:45:28
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.8-beta is out 
This is the eighth development snapshot for the 0.1.2.x series. You'll
notice that it's a beta -- more mature than an alpha but not yet a
release candidate. It fixes a few crash bugs, and generally continues
to clean things up. We're getting close!
The bundles also come with Vidalia 0.0.11.
Changes in version 0.1.2.8-beta - 2007-02-26
  o Major bugfixes (crashes):
    - Stop crashing when the controller asks us to resetconf more than
      one config option at once. (Vidalia 0.0.11 does this.)
    - Fix a crash that happened on Win98 when we're given command-line
      arguments: don't try to load NT service functions from advapi32.dll
      except when we need them. (Bug introduced in 0.1.2.7-alpha;
      resolves bug 389.)
    - Fix a longstanding obscure crash bug that could occur when
      we run out of DNS worker processes. (Resolves bug 390.)
  o Major bugfixes (hidden services):
    - Correctly detect whether hidden service descriptor downloads are
      in-progress. (Suggested by Karsten Loesing; fixes bug 399.)
  o Major bugfixes (accounting):
    - When we start during an accounting interval before it's time to wake
      up, remember to wake up at the correct time. (May fix bug 342.)
  o Minor bugfixes (controller):
    - Give the controller END_STREAM_REASON_DESTROY events _before_ we
      clear the corresponding on_circuit variable, and remember later
      that we don't need to send a redundant CLOSED event.  (Resolves part
      3 of bug 367.)
    - Report events where a resolve succeeded or where we got a socks
      protocol error correctly, rather than calling both of them
      "INTERNAL".
    - Change reported stream target addresses to IP consistently when
      we finally get the IP from an exit node.
    - Send log messages to the controller even if they happen to be very
      long.
  o Minor bugfixes (other):
    - Display correct results when reporting which versions are
      recommended, and how recommended they are. (Resolves bug 383.)
    - Improve our estimates for directory bandwidth to be less random:
      guess that an unrecognized directory will have the average bandwidth
      from all known directories, not that it will have the average
      bandwidth from those directories earlier than it on the list.
    - If we start a server with ClientOnly 1, then set ClientOnly to 0
      and hup, stop triggering an assert based on an empty onion_key.
    - On platforms with no working mmap() equivalent, don't warn the
      user when cached-routers doesn't exist.
    - Warn the user when mmap() [or its equivalent] fails for some reason
      other than file-not-found.
    - Don't warn the user when cached-routers.new doesn't exist: that's
      perfectly fine when starting up for the first time.
    - When EntryNodes are configured, rebuild the guard list to contain,
      in order: the EntryNodes that were guards before; the rest of the
      EntryNodes; the nodes that were guards before.
    - Mask out all signals in sub-threads; only the libevent signal
      handler should be processing them. This should prevent some crashes
      on some machines using pthreads. (Patch from coderman.)
    - Fix switched arguments on memset in the implementation of
      tor_munmap() for systems with no mmap() call.
    - When Tor receives a router descriptor that it asked for, but
      no longer wants (because it has received fresh networkstatuses
      in the meantime), do not warn the user.  Cache the descriptor if
      we're a cache; drop it if we aren't.
    - Make earlier entry guards _really_ get retried when the network
      comes back online.
    - On a malformed DNS reply, always give an error to the corresponding
      DNS request.
    - Build with recent libevents on platforms that do not define the
      nonstandard types "u_int8_t" and friends.
  o Minor features (controller):
    - Warn the user when an application uses the obsolete binary v0
      control protocol.  We're planning to remove support for it during
      the next development series, so it's good to give people some
      advance warning.
    - Add STREAM_BW events to report per-entry-stream bandwidth
      use. (Patch from Robert Hogan.)
    - Rate-limit SIGNEWNYM signals in response to controllers that
      impolitely generate them for every single stream. (Patch from
      mwenge; closes bug 394.)
    - Make REMAP stream events have a SOURCE (cache or exit), and
      make them generated in every case where we get a successful
      connected or resolved cell.
  o Minor bugfixes (performance):
    - Call router_have_min_dir_info half as often. (This is showing up in
      some profiles, but not others.)
    - When using GCC, make log_debug never get called at all, and its
      arguments never get evaluated, when no debug logs are configured.
      (This is showing up in some profiles, but not others.)
  o Minor features:
    - Remove some never-implemented options.  Mark PathlenCoinWeight as
      obsolete.
    - Implement proposal 106: Stop requiring clients to have well-formed
      certificates; stop checking nicknames in certificates. (Clients
      have certificates so that they can look like Tor servers, but in
      the future we might want to allow them to look like regular TLS
      clients instead. Nicknames in certificates serve no purpose other
      than making our protocol easier to recognize on the wire.)
    - Revise messages on handshake failure again to be even more clear about
      which are incoming connections and which are outgoing.
    - Discard any v1 directory info that's over 1 month old (for
      directories) or over 1 week old (for running-routers lists).
    - Do not warn when individual nodes in the configuration's EntryNodes,
      ExitNodes, etc are down: warn only when all possible nodes
      are down. (Fixes bug 348.)
    - Always remove expired routers and networkstatus docs before checking
      whether we have enough information to build circuits. (Fixes
      bug 373.)
    - Put a lower-bound on MaxAdvertisedBandwidth.

@_date: 2007-02-28 17:24:55
@_author: Roger Dingledine 
@_subject: problems setting up a relay node on win XP 
The bandwidth self-test is actually instantaneous: it just sends
out some bytes right then, and sees how they fare.
I've changed the log message from
  Performing bandwidth self-test.
  Performing bandwidth self-test...done.
Hopefully that will help. :)

@_date: 2007-02-05 15:50:21
@_author: Roger Dingledine 
@_subject: Forcing firefox to keep a connection alive for reuse 
Privoxy disables pipelining.
You might try using Polipo instead, which supports pipelining, and see
if you like it better.
(See item  of
 )

@_date: 2007-02-06 21:11:00
@_author: Roger Dingledine 
@_subject: tls and connection hacking 
If you're just trying to fuzz Tor, your easiest path might be to disable
the parts of Tor that get upset when you don't have the right certificate
See connection_or_check_valid_handshake() in connection_or.c

@_date: 2007-02-08 00:32:38
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.7-alpha is out 
This is the seventh development snapshot for the 0.1.2.x series. It makes
rate limiting much more comfortable for servers, along with a huge pile
of other bugfixes.
Changes in version 0.1.2.7-alpha - 2007-02-06
  o Major bugfixes (rate limiting):
    - Servers decline directory requests much more aggressively when
      they're low on bandwidth. Otherwise they end up queueing more and
      more directory responses, which can't be good for latency.
    - But never refuse directory requests from local addresses.
    - Fix a memory leak when sending a 503 response for a networkstatus
      request.
    - Be willing to read or write on local connections (e.g. controller
      connections) even when the global rate limiting buckets are empty.
    - If our system clock jumps back in time, don't publish a negative
      uptime in the descriptor. Also, don't let the global rate limiting
      buckets go absurdly negative.
    - Flush local controller connection buffers periodically as we're
      writing to them, so we avoid queueing 4+ megabytes of data before
      trying to flush.
  o Major bugfixes (NT services):
    - Install as NT_AUTHORITY\LocalService rather than as SYSTEM; add a
      command-line flag so that admins can override the default by saying
      "tor --service install --user "SomeUser"".  This will not affect
      existing installed services.  Also, warn the user that the service
      will look for its configuration file in the service user's
      %appdata% directory.  (We can't do the 'hardwire the user's appdata
      directory' trick any more, since we may not have read access to that
      directory.)
  o Major bugfixes (other):
    - Previously, we would cache up to 16 old networkstatus documents
      indefinitely, if they came from nontrusted authorities. Now we
      discard them if they are more than 10 days old.
    - Fix a crash bug in the presence of DNS hijacking (reported by Andrew
      Del Vecchio).
    - Detect and reject malformed DNS responses containing circular
      pointer loops.
    - If exits are rare enough that we're not marking exits as guards,
      ignore exit bandwidth when we're deciding the required bandwidth
      to become a guard.
    - When we're handling a directory connection tunneled over Tor,
      don't fill up internal memory buffers with all the data we want
      to tunnel; instead, only add it if the OR connection that will
      eventually receive it has some room for it. (This can lead to
      slowdowns in tunneled dir connections; a better solution will have
      to wait for 0.2.0.)
  o Minor bugfixes (dns):
    - Add some defensive programming to eventdns.c in an attempt to catch
      possible memory-stomping bugs.
    - Detect and reject DNS replies containing IPv4 or IPv6 records with
      an incorrect number of bytes. (Previously, we would ignore the
      extra bytes.)
    - Fix as-yet-unused reverse IPv6 lookup code so it sends nybbles
      in the correct order, and doesn't crash.
    - Free memory held in recently-completed DNS lookup attempts on exit.
      This was not a memory leak, but may have been hiding memory leaks.
    - Handle TTL values correctly on reverse DNS lookups.
    - Treat failure to parse resolv.conf as an error.
  o Minor bugfixes (other):
    - Fix crash with "tor --list-fingerprint" (reported by seeess).
    - When computing clock skew from directory HTTP headers, consider what
      time it was when we finished asking for the directory, not what
      time it is now.
    - Expire socks connections if they spend too long waiting for the
      handshake to finish. Previously we would let them sit around for
      days, if the connecting application didn't close them either.
    - And if the socks handshake hasn't started, don't send a
      "DNS resolve socks failed" handshake reply; just close it.
    - Stop using C functions that OpenBSD's linker doesn't like.
    - Don't launch requests for descriptors unless we have networkstatuses
      from at least half of the authorities.  This delays the first
      download slightly under pathological circumstances, but can prevent
      us from downloading a bunch of descriptors we don't need.
    - Do not log IPs with TLS failures for incoming TLS
      connections. (Fixes bug 382.)
    - If the user asks to use invalid exit nodes, be willing to use
      unstable ones.
    - Stop using the reserved ac_cv namespace in our configure script.
    - Call stat() slightly less often; use fstat() when possible.
    - Refactor the way we handle pending circuits when an OR connection
      completes or fails, in an attempt to fix a rare crash bug.
    - Only rewrite a conn's address based on X-Forwarded-For: headers
      if it's a parseable public IP address; and stop adding extra quotes
      to the resulting address.
  o Major features:
    - Weight directory requests by advertised bandwidth. Now we can
      let servers enable write limiting but still allow most clients to
      succeed at their directory requests. (We still ignore weights when
      choosing a directory authority; I hope this is a feature.)
  o Minor features:
    - Create a new file ReleaseNotes which was the old ChangeLog. The
      new ChangeLog file now includes the summaries for all development
      versions too.
    - Check for addresses with invalid characters at the exit as well
      as at the client, and warn less verbosely when they fail. You can
      override this by setting ServerDNSAllowNonRFC953Addresses to 1.
    - Adapt a patch from goodell to let the contrib/exitlist script
      take arguments rather than require direct editing.
    - Inform the server operator when we decide not to advertise a
      DirPort due to AccountingMax enabled or a low BandwidthRate. It
      was confusing Zax, so now we're hopefully more helpful.
    - Bring us one step closer to being able to establish an encrypted
      directory tunnel without knowing a descriptor first. Still not
      ready yet. As part of the change, now assume we can use a
      create_fast cell if we don't know anything about a router.
    - Allow exit nodes to use nameservers running on ports other than 53.
    - Servers now cache reverse DNS replies.
    - Add an --ignore-missing-torrc command-line option so that we can
      get the "use sensible defaults if the configuration file doesn't
      exist" behavior even when specifying a torrc location on the command
      line.
  o Minor features (controller):
    - Track reasons for OR connection failure; make these reasons
      available via the controller interface. (Patch from Mike Perry.)
    - Add a SOCKS_BAD_HOSTNAME client status event so controllers
      can learn when clients are sending malformed hostnames to Tor.
    - Clean up documentation for controller status events.
    - Add a REMAP status to stream events to note that a stream's
      address has changed because of a cached address or a MapAddress
      directive.

@_date: 2007-01-13 20:34:47
@_author: Roger Dingledine 
@_subject: Block directory authorities, is it possible? 
You shouldn't need to contact a directory authority directly -- any
directory cache should do.
(Note that there was a bug in 0.1.2.x before 0.1.2.5-alpha that prevented
Windows Tor clients from caching certain things on disk correctly. That
might have slowed you down too.)
In a future directory scheme, we'll still make use of network-status
documents older than 24 hours. It's tricky because if you're willing to
use really old ones, the adversary can hand you just the combination of
old network-status documents that will make you behave differently from
everybody else. This is related to the current "if your clock is wrong
by more than a day, Tor will not work for you" bug.
Right. In fact, it's not just a problem at the directory authorities --
they could also just fetch the directory and block all 800 IP addresses
in it.
Check out
and then also
for our latest (draft) thoughts on what components we might add to Tor
to be more resistant to an attacker that wants to block access to the
whole Tor network.
We'll be slowly adding pieces of this over the course of 2007, along with
the other projects that need attention, and then we'll see where we are.

@_date: 2007-01-13 20:53:12
@_author: Roger Dingledine 
@_subject: Block directory authorities, is it possible? 
My guesses, in order of ease-of-explanation:
A) There are perhaps 30000 people in China running Tor clients right now,
according to my rough estimates. That's roughly zero people, in China.
B) The general perception of Tor is that it's a tool for experts. So
they don't think they need to block it (yet).
C) We haven't publically threatened their control. By emphasizing
government/military/law enforcement use, and individuals in free countries
who need their civil liberties, we don't force them to take action.
D) Other?
As I understand it, social networking attacks are much simpler
and more successful. Having an informer at the factory is much more
straightforward, and just the *possibility* of it is usually enough to
make a lot of people self-censor.
In fact, as countries restrict more information at their national
firewall, they end up with *more* Tor users -- not because they're all
dissidents, but because they want to read the web comics or stock market
sites they were able to read last week. The mere fact that you use Tor
in these cases is not "much" evidence on you, as long as there's a
sufficient population around you using Tor.
So yes, they could do what you describe, but there are many things they
*could* do, and from talking to people in China, this probably isn't
first in line in terms of worries. But let me know if you disagree. :)

@_date: 2007-01-13 21:13:16
@_author: Roger Dingledine 
@_subject: Bandwidth limits 
Interesting. This looks like a bug. You're not supposed to see warnings
like that. Can you give us details -- what Tor version, what Vidalia
version (I assume that's what you mean by "the English version"),
what torrc options you picked, any other warnings you get, etc?
Are there situations that make the warnings always show up?
Can you narrow down what causes the warnings to show up and what doesn't?
Those look plausible.

@_date: 2007-01-15 21:16:25
@_author: Roger Dingledine 
@_subject: Question for DEVs -- Write/Read Limiting 
Before, we did rate limiting on incoming bytes. We let outgoing
bytes go out at whatever rate the network could support.
This was useful, because if we did rate limiting in both directions and
servers sent out more than they read (e.g. because they were answering
directory requests too), then they'd end up queueing a big pile of
outgoing bytes, and Tor data would experience higher and higher latency
because data could come in easily but it would sit on buffers for a long
time on the way out.
On the other hand, it was bad because people would configure rate limiting
and be surprised that the rate limiting "didn't work".
Nick convinced me that being predictable for server operators was more
important than some more latency. So now we rate limit in both directions.
I'm now working on trying to make Tor servers intelligent about when to
turn down directory requests (send a "503 busy" instead of answering), so
Tor clients will get answers to their directory questions in a reasonable
time period, but we won't end up in the above bad situation very often.
Now we do the BandwidthRate/BandwidthBurst thing twice -- once for
incoming and once for outgoing.
The AccountingStart/AccountingMax behavior is unchanged.
Nope. I had a plan to let people configure their BandwidthRateRead
and BandwidthRateWrite separately, but Nick convinced me it would be a
headache to handle even more combinations and permutations.
If you wanted to think hard about that and send us a patch, I bet we'd
accept it.
Hope that helps,

@_date: 2007-01-17 15:24:33
@_author: Roger Dingledine 
@_subject: irssi+tsocks: can't connect to ssl-secured irc-server 
So far so good.
Alas, you've combined two buggy situations. First, tsocks is
packed with bugs:
Second, IRC SSL has never been a stable concept or well supported
by common IRC clients.
I wish you luck. :)

@_date: 2007-01-23 14:23:30
@_author: Roger Dingledine 
@_subject: Another Write/Read Limiting Question 
This was a bug in 0.1.2.5-alpha and 0.1.2.6-alpha. The goal was to
not enforce rate limiting on "internal" connections (127.0.0.1, 10/8,
192.168/16, etc), but it didn't quite happen. I fixed this in SVN r9369,
and it will be part of 0.1.2.7-alpha.
I made big requests work a lot better (I think) in r9382.
Try upgrading to the latest SVN, and let us know if it works better
for you.

@_date: 2007-01-24 15:49:59
@_author: Roger Dingledine 
@_subject: tor and p2p 
There's lots of work left before Tor is in a position for most users
to be servers.
Hope that helps,

@_date: 2007-01-07 04:11:39
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.5-alpha is out 
This is the fifth development snapshot for the 0.1.2.x series. It enables
write limiting by default, makes NT services more convenient and more
correct, includes better detection for misbehaving DNS on servers,
and a bunch of other features and bugfixes. It also ships with the new
Vidalia 0.0.10 release.
Changes in version 0.1.2.5-alpha - 2007-01-06
  o Major features:
    - Enable write limiting as well as read limiting. Now we sacrifice
      capacity if we're pushing out lots of directory traffic, rather
      than overrunning the user's intended bandwidth limits.
    - Include TLS overhead when counting bandwidth usage; previously, we
      would count only the bytes sent over TLS, but not the bytes used
      to send them.
    - Support running the Tor service with a torrc not in the same
      directory as tor.exe and default to using the torrc located in
      the %appdata%\Tor\ of the user who installed the service. Patch
      from Matt Edman.
    - Servers now check for the case when common DNS requests are going to
      wildcarded addresses (i.e. all getting the same answer), and change
      their exit policy to reject *:* if it's happening.
    - Implement BEGIN_DIR cells, so we can connect to the directory
      server via TLS to do encrypted directory requests rather than
      plaintext. Enable via the TunnelDirConns and PreferTunneledDirConns
      config options if you like. This still needs more debugging before
      people other than developers should try it.
  o Minor features (config and docs):
    - Start using the state file to store bandwidth accounting data:
      the bw_accounting file is now obsolete. We'll keep generating it
      for a while for people who are still using 0.1.2.4-alpha.
    - Try to batch changes to the state file so that we do as few
      disk writes as possible while still storing important things in
      a timely fashion.
    - The state file and the bw_accounting file get saved less often when
      the AvoidDiskWrites config option is set.
    - Make PIDFile work on Windows (untested).
    - Add internal descriptions for a bunch of configuration options:
      accessible via controller interface and in comments in saved
      options files.
    - Reject *:563 (NNTPS) in the default exit policy. We already reject
      NNTP by default, so this seems like a sensible addition.
    - Clients now reject hostnames with invalid characters. This should
      avoid some inadvertent info leaks. Add an option
      AllowNonRFC953Hostnames to disable this behavior, in case somebody
      is running a private network with hosts called  !, and     - Add a maintainer script to tell us which options are missing
      documentation: "make check-docs".
    - Add a new address-spec.txt document to describe our special-case
      addresses: .exit, .onion, and .noconnnect.
  o Minor features (DNS):
    - Ongoing work on eventdns infrastructure: now it has dns server
      and ipv6 support. One day Tor will make use of it.
    - Add client-side caching for reverse DNS lookups.
    - Add support to tor-resolve tool for reverse lookups and SOCKS5.
    - When we change nameservers or IP addresses, reset and re-launch
      our tests for DNS hijacking.
  o Minor features (directory):
    - Authorities now specify server versions in networkstatus. This adds
      about 2% to the side of compressed networkstatus docs, and allows
      clients to tell which servers support BEGIN_DIR and which don't.
      The implementation is forward-compatible with a proposed future
      protocol version scheme not tied to Tor versions.
    - DirServer configuration lines now have an orport= option so
      clients can open encrypted tunnels to the authorities without
      having downloaded their descriptors yet. Enabled for moria1,
      moria2, tor26, and lefkada now in the default configuration.
    - Directory servers are more willing to send a 503 "busy" if they
      are near their write limit, especially for v1 directory requests.
      Now they can use their limited bandwidth for actual Tor traffic.
    - Clients track responses with status 503 from dirservers. After a
      dirserver has given us a 503, we try not to use it until an hour has
      gone by, or until we have no dirservers that haven't given us a 503.
    - When we get a 503 from a directory, and we're not a server, we don't
      count the failure against the total number of failures allowed
      for the thing we're trying to download.
    - Report X-Your-Address-Is correctly from tunneled directory
      connections; don't report X-Your-Address-Is when it's an internal
      address; and never believe reported remote addresses when they're
      internal.
    - Protect against an unlikely DoS attack on directory servers.
    - Add a BadDirectory flag to network status docs so that authorities
      can (eventually) tell clients about caches they believe to be
      broken.
  o Minor features (controller):
    - Have GETINFO dir/status/* work on hosts with DirPort disabled.
    - Reimplement GETINFO so that info/names stays in sync with the
      actual keys.
    - Implement "GETINFO fingerprint".
    - Implement "SETEVENTS GUARD" so controllers can get updates on
      entry guard status as it changes.
  o Minor features (clean up obsolete pieces):
    - Remove some options that have been deprecated since at least
      0.1.0.x: AccountingMaxKB, LogFile, DebugLogFile, LogLevel, and
      SysLog. Use AccountingMax instead of AccountingMaxKB, and use Log
      to set log options.
    - We no longer look for identity and onion keys in "identity.key" and
      "onion.key" -- these were replaced by secret_id_key and
      secret_onion_key in 0.0.8pre1.
    - We no longer require unrecognized directory entries to be
      preceded by "opt".
  o Major bugfixes (security):
    - Stop sending the HttpProxyAuthenticator string to directory
      servers when directory connections are tunnelled through Tor.
    - Clients no longer store bandwidth history in the state file.
    - Do not log introduction points for hidden services if SafeLogging
      is set.
    - When generating bandwidth history, round down to the nearest
      1k. When storing accounting data, round up to the nearest 1k.
    - When we're running as a server, remember when we last rotated onion
      keys, so that we will rotate keys once they're a week old even if
      we never stay up for a week ourselves.
  o Major bugfixes (other):
    - Fix a longstanding bug in eventdns that prevented the count of
      timed-out resolves from ever being reset. This bug caused us to
      give up on a nameserver the third time it timed out, and try it
      10 seconds later... and to give up on it every time it timed out
      after that.
    - Take out the '5 second' timeout from the connection retry
      schedule. Now the first connect attempt will wait a full 10
      seconds before switching to a new circuit. Perhaps this will help
      a lot. Based on observations from Mike Perry.
    - Fix a bug on the Windows implementation of tor_mmap_file() that
      would prevent the cached-routers file from ever loading. Reported
      by John Kimble.
  o Minor bugfixes:
    - Fix an assert failure when a directory authority sets
      AuthDirRejectUnlisted and then receives a descriptor from an
      unlisted router. Reported by seeess.
    - Avoid a double-free when parsing malformed DirServer lines.
    - Fix a bug when a BSD-style PF socket is first used. Patch from
      Fabian Keil.
    - Fix a bug in 0.1.2.2-alpha that prevented clients from asking
      to resolve an address at a given exit node even when they ask for
      it by name.
    - Servers no longer ever list themselves in their "family" line,
      even if configured to do so. This makes it easier to configure
      family lists conveniently.
    - When running as a server, don't fall back to 127.0.0.1 when no
      nameservers are configured in /etc/resolv.conf; instead, make the
      user fix resolv.conf or specify nameservers explicitly. (Resolves
      bug 363.)
    - Stop accepting certain malformed ports in configured exit policies.
    - Don't re-write the fingerprint file every restart, unless it has
      changed.
    - Stop warning when a single nameserver fails: only warn when _all_ of
      our nameservers have failed. Also, when we only have one nameserver,
      raise the threshold for deciding that the nameserver is dead.
    - Directory authorities now only decide that routers are reachable
      if their identity keys are as expected.
    - When the user uses bad syntax in the Log config line, stop
      suggesting other bad syntax as a replacement.
    - Correctly detect ipv6 DNS capability on OpenBSD.
  o Minor bugfixes (controller):
    - Report the circuit number correctly in STREAM CLOSED events. Bug
      reported by Mike Perry.
    - Do not report bizarre values for results of accounting GETINFOs
      when the last second's write or read exceeds the allotted bandwidth.
    - Report "unrecognized key" rather than an empty string when the
      controller tries to fetch a networkstatus that doesn't exist.

@_date: 2007-01-08 09:22:56
@_author: Roger Dingledine 
@_subject: more letters from the feds 
At 23C3, I spoke to several people who told me about chats with law
enforcement where a German fed was intentionally bothering Tor operators
with the goal of making Tor disappear.
Now, this doesn't mean they all think this way -- and as Alexander points
out, even if they liked Tor they might still have the same behavior due
to German law.
If you know a German fed who understands and likes Tor, please be very
friendly and offer to teach him/her more. Also, you should coordinate
with the CCC folks (anonymizer at ccc.de) so we can keep track of useful
smart people. They come in handy, since answering with "why don't you
give this fellow at your agency a call and he'll explain it to you"
works a lot better than "I know you think I'm a criminal, but let me
tell you why I'm not".
And if you know a fed or other decision-maker in this process whom you
think would like to learn more about Tor, you should also coordinate
with the CCC folks (and me if you like) to teach them more. I've found
that injecting facts into the conversations (along with being open and
helpful) helps tremendously -- take them out to coffee/beer when they're
not investigating you and see where it goes. :)

@_date: 2007-01-09 09:40:45
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.6-alpha is out 
This is the sixth development snapshot for the 0.1.2.x series. It fixes
two server crash bugs in 0.1.2.5-alpha.
(Not all packages are up on the website yet, but they should be there
in the next day or two.)
Changes in version 0.1.2.6-alpha - 2007-01-09
  o Major bugfixes:
    - Fix an assert error introduced in 0.1.2.5-alpha: if a single TLS
      connection handles more than 4 gigs in either direction, we crash.
    - Fix an assert error introduced in 0.1.2.5-alpha: if we're an
      advertised exit node, somebody might try to exit from us when
      we're bootstrapping and before we've built your descriptor yet.
      Refuse the connection rather than crashing.
  o Minor bugfixes:
    - Warn if we (as a server) find that we've resolved an address that we
      weren't planning to resolve.
    - Warn that using select() on any libevent version before 1.1 will be
      unnecessarily slow (even for select()).
    - Flush ERR-level controller status events just like we currently
      flush ERR-level log events, so that a Tor shutdown doesn't prevent
      the controller from learning about current events.
  o Minor features (more controller status events):
    - Implement EXTERNAL_ADDRESS server status event so controllers can
      learn when our address changes.
    - Implement BAD_SERVER_DESCRIPTOR server status event so controllers
      can learn when directories reject our descriptor.
    - Implement SOCKS_UNKNOWN_PROTOCOL client status event so controllers
      can learn when a client application is speaking a non-socks protocol
      to our SocksPort.
    - Implement DANGEROUS_SOCKS client status event so controllers
      can learn when a client application is leaking DNS addresses.
    - Implement BUG general status event so controllers can learn when
      Tor is unhappy about its internal invariants.
    - Implement CLOCK_SKEW general status event so controllers can learn
      when Tor thinks the system clock is set incorrectly.
    - Implement GOOD_SERVER_DESCRIPTOR and ACCEPTED_SERVER_DESCRIPTOR
      server status events so controllers can learn when their descriptors
      are accepted by a directory.
    - Implement CHECKING_REACHABILITY and REACHABILITY_{SUCCEEDED|FAILED}
      server status events so controllers can learn about Tor's progress in
      deciding whether it's reachable from the outside.
    - Implement BAD_LIBEVENT general status event so controllers can learn
      when we have a version/method combination in libevent that needs to
      be changed.
    - Implement NAMESERVER_STATUS, NAMESERVER_ALL_DOWN, DNS_HIJACKED,
      and DNS_USELESS server status events so controllers can learn
      about changes to DNS server status.
  o Minor features (directory):
    - Authorities no longer recommend exits as guards if this would shift
      too much load to the exit nodes.

@_date: 2007-07-15 19:52:21
@_author: Roger Dingledine 
@_subject: active connections when hibernating 
If you disable your ORPort and sighup, Tor will stop listening for
new connections on the ORPort, and it will send back destroy cells in
response to any new create cells it receives, and it will refuse any
new begin cells it receives, but otherwise it will continue to act like
a server with respect to circuits and streams that are already open.
Correct, that is intended behavior.
See e.g. sec 2.1.1 of

@_date: 2007-07-18 23:35:54
@_author: Roger Dingledine 
@_subject: On the performance scalability of Tor 
They can be issued concurrently. Tor doesn't care.
Also, with HTTP/1.1 pipelining to the actual website, we just need to
open a single TCP stream (one RELAY_BEGIN) and we can then fetch many
pages in a row.
I'm not sure if this is better or worse than fetching them in parallel. I
suspect Juliusz (the polipo developer) has opinions :), and I'll defer
to him.

@_date: 2007-07-22 03:11:24
@_author: Roger Dingledine 
@_subject: is this a bandwidth problem? my IP is a TOR exit, the client works and the server doesn't 
Don't pay too much attention to privoxy's error message. It only has
one error message, no matter what went wrong. :(
No, the problem is that your ports aren't reachable.
You should rethink this. :)
Does  load for you? You may have to try
it several times.
If not, does it fail immediately (meaning you might not have configured
your Firefox correctly -- you are using Firefox and Torbutton, right?) or
does it take a few minutes to fail (meaning everything's configured
correctly on your side, but your network is still too slow or flaky for
it to work)?

@_date: 2007-07-22 03:46:08
@_author: Roger Dingledine 
@_subject: Tor takes too much RAM 
Yes, my directory authorities are using way too much ram too. It appears
that we introduced something bad in 0.1.2.x that wasn't present in
I'm tracking it down; do feel free to help :). Current progress is that
I'm pretty sure it's not a memory leak -- something is actually using
this memory.

@_date: 2007-07-22 05:24:22
@_author: Roger Dingledine 
@_subject: Tor takes too much RAM 
No, this is not true. At least, it wasn't true for 0.1.1.x. Some kind
soul appears to have modified the FAQ to report the current situation,
rather than bugging anybody about the problems. :)
A few months ago we had plenty of people running at 30Mbps+ using 200M
or 300M of memory, back when 0.1.1.x was the recommended stable.
You might try downgrading to 0.1.1.26 briefly, and see how it compares
to the current situation.
Fun fun,

@_date: 2007-07-23 18:17:08
@_author: Roger Dingledine 
@_subject: [Secunia] Regarding Tor 0.1.2.15 Release Notes 
Great. I'm also cc'ing this to the main user mailing list, so other
people can be up to date too.
We just looked at it closer, and it appears to read off the end of
the buffer, but not write anything, so it shouldn't (heh) be that big
a problem.
In any case, this is only a problem if you added the Natdport
configuration option to your torrc file, which you would only have done
if you're on a really old BSD and also you were experimenting with the
new natd support.
So most users will not be affected by this.
Sending out the reason for tearing down your circuit relates to reduction
in anonymity, rather than system security. It might be usable by an
adversary who's trying to narrow down who you are out of a small set of
suspects; we don't have a specific attack in mind, and we don't think
that an attack like this would be the best way to attack Tor, but it's
best to fix it.
The "Keep streamids from different exits on a circuit separate" bug is
probably the biggest one. Tor servers in the middle of your circuit can
blindly inject data into your TCP stream -- they can't read anything, and
they have only a 1 in 2**16 chance of guessing which tag to use to make it
work, but those are still not good odds. As usual, if users use end-to-end
authentication (a la ssl or ssh), this attack won't work against them.
Lastly, the "don't expand your guard list without needing to" helps to
limit the number of new entry nodes you'll pick, which protects from
 and other anonymity-related
Hope that helps,

@_date: 2007-07-27 00:04:19
@_author: Roger Dingledine 
@_subject: Windows XP SP2 + Tor = instant crashes 
Exciting. Can you make a backup copy of all the files in C:\Documents and
Settings\Jevon\Application Data\tor\, and then delete the cached-routers*
and cached-status/* files and try starting Tor again?
If it works after that, then we really want to see the cached-routers
file that breaks it.
(If you're feeling adventurous, you could put the old versions back into
place and see if it is broken again.)

@_date: 2007-07-27 00:40:52
@_author: Roger Dingledine 
@_subject: Windows XP SP2 + Tor = instant crashes 
My guess is that it was some property of the entire file that made it die,
not just of the last few entries.
We fixed a bug exactly like yours in 0.1.2.15, or at least, we thought
we did. :) Are you sure you tried using it with 0.1.2.15?
In any case, can you post your entire cached-routers file somewhere?

@_date: 2007-07-27 00:56:49
@_author: Roger Dingledine 
@_subject: Windows XP SP2 + Tor = instant crashes 
Yes, please do try it, because we fixed a bug very much like this.
(The latest alpha release is from 2007-06-02, whereas the latest stable
is from 2007-07-17.)

@_date: 2007-07-27 01:54:26
@_author: Roger Dingledine 
@_subject: flash in a stand-alone player 
Unless you have to switch to worrying about how xB Machine works and
whether it addresses all the problems correctly and doesn't add new
ones. :)
I look forward to my conversation with you on Aug 3 where I try to
convince you to document and publish what you intend it to be doing,
so we have something to compare against. :)

@_date: 2007-07-27 06:00:16
@_author: Roger Dingledine 
@_subject: Excessive bandwidth use 
You have rate limited it to 800KB/s, and from the graphs I can see,
it appears to be using roughly that.
Perhaps you are one of those people who count bandwidth in fractions of
bytes rather than in bytes?

@_date: 2007-07-27 07:11:43
@_author: Roger Dingledine 
@_subject: Excessive bandwidth use 
K is 1<<10, and M is 1<<20.
Right. Alas, I assure you there's a big community of people who'd be
confused and upset if we went the other way too. Most network things
measure in bits, and most application things measure in bytes.
Or said another way, most (unix) sysadmins measure application bandwidth
in bits, and most (Windows) users measure application bandwidth in bytes.
You mean back when it was using about 10mbit? My guess is this would
be some limitation on your system or your network. Most likely network,
but all I have to go on are the graphs. :) An unconstrained Tor server
will use about 40mbit sustained these days if you let it.

@_date: 2007-07-28 10:01:59
@_author: Roger Dingledine 
@_subject: The value of specifications (was Re: flash in a stand-alone player) 
Hi folks,
Unfortunately, there is more that needs to be said before any of these
approaches for bundling Tor can be convincingly secure.
I tend to focus my attention on Steve when trying to explain the need
for documentation, because he seems most likely to get lots of users,
but I shouldn't pick on just him -- right now roughly none of the various
Tor bundling projects tell me exactly what's going on in detail.
So what do I mean by "in detail"? Let me take an aside to describe the
Tor specifications and why they're useful.
Our aim when writing the Tor spec documents is to provide sufficient
detail that somebody can build a compatible Tor implementation. That is,
to let people build something that a) does the same thing (has the same
features and behavior) and b) has the same level of security that Tor
aims to provide.
Beyond just letting people build compatible versions, the specs also
serve a critical role in security analysis. There are many security
people who are good at reading design docs and ok at reading specs,
and they can now look at both and tell us if we screwed up the spec
somewhere. We get many researchers coming to us saying "hey, I think if
you do it the way your spec says, you'll have a problem". On the other
side, there are also many security people who are good at looking at an
implementation and ok at reading specs, and they can look at both and
say "your spec says you do this, but the code doesn't do that."
The key is that these classes of security people are often different --
very few people are skilled at both. If we just had a design doc and an
implementation, then people who look at the code would have to divine
what we *meant* to do, as well as what we actually do, if they want to
find/fix a bug. Similarly, people who look at the design document would
have to guess what we meant for the code to do, because the design doc
isn't clear on exactly how to do each thing.
So that's the background, and the reasoning for why Tor has spec
documents. I believe our specs are one of the main reasons that Tor
is the standard anonymity system in the research community now. They
do take a lot of energy to write and maintain, but they also help us
make decisions carefully about what security properties we have now,
and what a given change would imply. And it helps the rest of the world
have confidence that we've gotten things right, because we also tell
them what we *mean* to do.
What I ultimately want from each of these bundling projects is all three
pieces: a design doc ("here are the intuitions for what we're trying to
do, and the assumptions we're working under"), a spec ("here is enough
detail to build your own, and if you followed this document we would
be confident that you built an ok one"), and the implementation itself
("here is the code, here are the scripts, here are the config files"). The
design doc needs to explain what behaviors and security properties you
have in mind, and the spec should include details of how you provide them.
A few examples may include: if you're trying to be subtle, what traces do
you leave behind that your program was there? What application behavior
do you modify?
I understand that not all of these projects are at the stages where
writing a spec makes sense. While you're still playing around with what
you want to include, or how you want it to be configured, it may be
premature to create a spec. But at some point it will make sense. And
doing it will help *you*, in that outside people can then evaluate your
security. As a side benefit, whoever produces a useful design doc and
spec first will become the de facto standard that everybody else has to
compare against, because you'll be the one with written recommendations.
What I would love to do is head toward a handful of unified documents
that say "If you want to bundle Tor in context X, here are the
recommendations. Follow these and you'll be well on your way to doing
it right." Because it is very likely that if xerobank wrote a spec and
janusvm wrote a spec, you would have different recommendations. Wouldn't
it be neat if we could recognize those and then discuss them and decide
which recommendation is better for each issue?
Hopefully this short discussion helps to explain why the Tor website
doesn't yet recommend any of the bundled Tors -- JanusVM, Xerobank,
Incognito, Torpark, Anonym.OS, etc. And why when people ask me what
I think of a given project, my answer tends to be "They seem like nice
people, and the project has a lot of potential. But heck if I know. What's
it do really?"

@_date: 2007-07-30 08:13:06
@_author: Roger Dingledine 
@_subject: Please try out the new bridge features 
Hi folks,
The upcoming 0.2.0.3-alpha release has a couple new features from the
blocking-resistance design we're working on. I'm going to write down more
details about how it works soon, but I wanted to give people a chance
to play with it (and report problems) now that it'll be out in a release.
For background on the design, see
In short, the new Tor release lets you run a relay that isn't in the
main directories (known as a bridge), and you can configure your client
by giving it a set of bridge addresses to use as your first hop into
the Tor network and as your source of directory information. There's no
support in Vidalia for it yet, and the design is still in flux, but here
are some tips to get you started.
(Warning: these instructions are geared for people who are comfortable
editing their torrc and messing around with Tor. If it breaks and
you think it's a bug, please let me know; if you just fail to get it
working, wait for a few more releases and it'll be easier. Also, note
that these features alone do not provide very good blocking-resistance;
more features are on the way still.)
********* Part one: using a bridge when you're a client *****
Add these lines to your torrc file:
  UseBridges 1
  TunnelDirConns 1
  Bridge 128.31.0.34:9009 4C17 FB53 2E20 B2A8 AC19 9441 ECD2 B017 7B39 E4B1
You can specify as many Bridge lines as you like, one for each bridge
you'd like to use. You can leave out the key if you don't know it or
don't care:
  Bridge 128.31.0.34:9009
******** Part two: setting up your own bridge ***********
Configure yourself as if you were a normal Tor server. Make sure to
define a DirPort. Then add this line to your torrc file:
  PublishServerDescriptor 0
This makes you into a Tor server that doesn't advertise on the main
directory authorities. You should tell people your IP address and ORPort
(and optionally your identity fingerprint) and they can write their own
Bridge lines as in "Part one" above.
Optionally, you may want to set
  RelayBandwidthRate 50 KB
  RelayBandwidthBurst 50 KB
instead of the more traditional BandwidthRate and BandwidthBurst options,
so you can use your bridge as a Tor client too and not get hit by your
own rate limiting.
********Part three: a bridge directory authority *********
For the adventurous, I'm also running a temporary bridge directory
authority. If you want your bridge to publish to this bridge authority,
use these lines in your torrc:
  PublishServerDescriptor bridge
  dirserver moria1 v1 orport=9001 128.31.0.34:9031 FFCB 46DB 1339 DA84 674C 70D7 CB58 6434 C437 0441
  dirserver moria2 v1 orport=9002 128.31.0.34:9032 719B E45D E224 B607 C537 07D0 E214 3E2D 423E 74CF
  dirserver tor26 v1 orport=443 86.59.21.38:80 847B 1F85 0344 D787 6491 A548 92F9 0493 4E4E B85D
  dirserver lefkada orport=443 140.247.60.64:80 38D4 F5FC F7B1 0232 28B8 95EA 56ED E7D5 CCDC AF32
  dirserver dizum 194.109.206.212:80 7EA6 EAD6 FD83 083C 538F 4403 8BBF A077 587D D755
  dirserver moria5 orport=9005 bridge no-v2 128.31.0.34:9035 F812 FCC1 E3EB E2E8 1C09 E516 E51A F9BF AFE3 3974
The first line specifies to publish to all authorities of type 'bridge',
and the last line specifies a new dirserver of type bridge. The others
are just repeating the current dirservers so we don't lose them when we
define a new one. I promise I'll have a better interface for this soon. :)
Then clients that use your bridge can add
  UpdateBridgesFromAuthority 1
to their torrc, and now even if your IP:port change (for example you're
on a dynamic IP address), they'll still be able to find you again.

@_date: 2007-07-08 20:17:37
@_author: Roger Dingledine 
@_subject: running tor on a vserver 
I'm afraid ConnLimit won't do what you expect. Here's the man page
entry for it:
      The minimum number of file descriptors that must be available to
      the Tor process before it will start. Tor will ask the OS for as
      many file descriptors as the OS will allow (you can find this by
      "ulimit -H -n"). If this number is less than ConnLimit, then Tor
      will refuse to start.
      You probably don't need to adjust this. It has no effect on Win-
      dows since that platform lacks getrlimit(). (Default: 1000)
We should probably rename it MinConn or something like that -- or get
rid of it entirely. To repeat: Saying "ConnLimit 90" will have no effect
on your situation.
(Some people want us to implement some sort of maximum connections open at
a time feature -- but that would cause you to refuse 'extend' operations,
and potentially turn you into a useless Tor server. Until we have a plan
for a non-clique topology (also known as a restricted-route topology)
that doesn't screw up the anonymity we can offer, the best we can answer
is that you need to be able to handle many sockets if you want to be
a server.)

@_date: 2007-07-09 00:00:27
@_author: Roger Dingledine 
@_subject: running tor on a vserver 
The suggestion of cranking down the bandwidthrate (and make sure to crank
down the bandwidthburst alongside it) is a good one. You may find that
setting your MaxAdvertiseBandwidth to something even lower (like 20 KB)
lets you attract less traffic but still provide good performance for
the circuits you do get.
You could also invert your exit policy to accept *:80, *:443, *:6667,
and reject the rest (rather than rejecting a few and accepting the rest),
so you attract fewer exit connections that might use lots of buffer space.
You could also talk to the group providing your vserver and ask them to
raise some of the constraints. There's usually no good technical reason
why they can't, so I assume it's generally because they want to make you
suffer enough that you'll pay for a "real" computer with them. But hey,
maybe it's because they genuinely didn't realize that it might be useful
to have resources available.
Anybody have other suggestions?
Good luck,

@_date: 2007-07-09 23:52:28
@_author: Roger Dingledine 
@_subject: running tor on a vserver 
Hi coderman,
Interesting idea. If you would whip up a patch, I'll add a new config
option "CheapServer 1" (suggestions for a better name? ;) and put it in
as an experimental feature.

@_date: 2007-07-10 00:05:03
@_author: Roger Dingledine 
@_subject: New Torbutton (1.1.4-alpha) 
Hi Mike,
Looks like great progress. One question though -- one of the warnings on
that page that bothers me is "Consider removing extensions that look up
more information about the websites you type in (like Google toolbar),
as they may bypass Tor and/or broadcast sensitive information." Is
this one of the warnings that we're going to have to keep (along with
"you need to send your traffic through Tor for Tor to have any prayer of
helping you" and "don't send plaintext passwords over the Internet"), or
is there something we can do about other extensions doing local resolves?
I really like your "Description of Options" section of this page. I
recognize they can't be tooltips yet -- are those Firefox bugs going
to be fixed soon, or should we think about adding a "Help" window to
Torbutton to explain what all these things are for people who can't get
to the website?
(I'm not so enthusiastic about your use of javascript on the webpage
though. ;)
Now the obligatory usability bug report: if I choose "I will manually
manage my cookies" in the Cookies window, what does that mean for the
choices in the Shutdown window?

@_date: 2007-07-03 09:54:01
@_author: Roger Dingledine 
@_subject: two unseemly tor behaviors 
The notion of shutting down the server after all the circuits are closed
has been on the low-priority todo list for a few years. Feel free to
submit a patch. I bet other people would use this feature too.
No, silently ignoring it isn't acceptable either, alas. If you hup tor and
don't look at the logs, then you'll assume that it magically worked. At
least this way you learn (eventually) that it hasn't.
Now, there is a command-line option to tor called --verify-config. You
could run it from the script that hups tor, and if --verify-config
complains, then don't hup tor. The debian initscript does all of this,
so you could copy the behavior from there if you like.
Hum. Could be. I think that page only looks at a single network status,
so it may have gotten one that had just rebooted. Or maybe it's a bug.
No, you misunderstood. See e.g.
Hope the above helps.

@_date: 2007-07-13 03:08:45
@_author: Roger Dingledine 
@_subject: constrained socket buffers patch 
Good question. The first answer is "it won't change it at all",
but you're right, it may be more complex than that.
I'm interested to see your [1] where you do the numbers. :)
Tor servers advertise aggregate throughput. In fact, it's often the
case that some link or another can't push many bytes, either because
it's slow or because that node is rate limiting a lot already.
So looking at it another way, there's enough variety in servers already
that it's not clear this would add many new problems to the network --
it already has lots of problems.

@_date: 2007-07-13 09:16:44
@_author: Roger Dingledine 
@_subject: 0.1.2.15 is getting close to ready; please test it 
Hi folks,
We're getting close to having 0.1.2.15 ready. I've put a snapshot at
that we hope compiles in more places than 0.1.2.14 (apologies to the BSD
folks :), and has fewer bugs and no new bugs. Please grab it, try it out,
and let us know whether we broke anything. (We'll be adding a few more
backports before the final release, but this should be most of them.)
Partial list of changes in version 0.1.2.15 - 2007-07-??
  o Major bugfixes (compilation):
    - Fix compile on FreeBSD/NetBSD/OpenBSD. Oops.
  o Major bugfixes (crashes):
    - Try even harder not to dereference the first character after
      an mmap(). Reported by lodger.
    - Fix a crash bug in directory authorities when we re-number the
      routerlist while inserting a new router.
    - Fix eventdns.c behavior on Solaris: It is critical to include
      orconfig.h _before_ sys/types.h, so that we can get the expected
      definition of _FILE_OFFSET_BITS.
  o Major bugfixes (security):
    - Fix a possible buffer overrun when using BSD natd support.
      Bug found by "Mr. Croup."
    - When sending destroy cells from a circuit's origin, don't include
      the reason for tearing down the circuit. The spec says we didn't,
      and now we actually don't. Reported by lodger.
    - Keep streamids from different exits on a circuit separate. This
      bug may have allowed other routers on a given circuit to inject
      cells into streams. Reported by lodger; fixes bug 446.
  o Minor bugfixes (guard nodes):
    - Weight guard selection by bandwidth, so that high-bandwidth nodes
      don't get underused as guards.
    - If there's a never-before-connected-to guard node in our list,
      never choose any guards past it. This way we don't expand our
      guard list unless we need to.
  o Minor bugfixes (directory):
    - Count the number of authorities that recommend each version
      correctly.  Previously, we were under-counting by 1.
  o Minor bugfixes (hidden services):
    - Stop tearing down the whole circuit when the user asks for a
      connection to a port that the hidden service didn't configure.
      Resolves bug 444.
  o Minor bugfixes (misc):
    - On Windows, we were preventing other processes from reading
      cached-routers while Tor was running. Reported by janbar.
    - Fix a possible (but very unlikely) bug in picking routers by
      bandwidth. Add a log message to confirm that it is in fact
      unlikely. Patch from lodger.
    - Backport a couple of memory leak fixes.
    - Backport miscellaneous cosmetic bugfixes.

@_date: 2007-07-14 23:10:54
@_author: Roger Dingledine 
@_subject: active connections when hibernating 
Hibernation is actually a two-step process. The first step is that it
hits the "soft hibernation limit", .95*AccountingMax, at which point
it stops allowing new connections and new circuits. Then when it hits
AccountingMax it kills all the remaining connections.
Perhaps your Tor was still in the 'soft limit' stage?
If somebody wants to track down some memory leaks, that would be good.
I think there may be some in 0.1.2.x that need finding.

@_date: 2007-07-14 23:28:07
@_author: Roger Dingledine 
@_subject: Tor bandwidth testing 
Tor builds four circuits from itself to itself, and then sends out 500K
worth of cells spread across the four testing circuits.
So it bootstraps its "sent" bandwidth when sending out these padding
cells, and bootstraps its "received" bandwidth when receiving them.
See section 2.1.3 of
 for details.
As for how the advertised bandwidth is computed in general, see the
"bandwidth" line in section 2.1 of
Hope that helps,

@_date: 2007-07-14 23:34:47
@_author: Roger Dingledine 
@_subject: What happens when I shut down my Tor-server? 
You'll have to define "traffic" for us.
Do you mean incoming TCP connections that are trying to get to your
server? If so, then yes, there are still a few hundred thousand Tor
users out there who might try to build a circuit that includes you;
it will be several hours until that begins to taper off.
Do you mean actual bytes carried back and forth by your Tor server? If
so, perhaps you have a different definition of "shut down" than I do? :)

@_date: 2007-06-15 18:06:48
@_author: Roger Dingledine 
@_subject: Cisco firewall filtering Tor? 
Try sending "GET /tor/status/all". (Some filters look for the "/tor/"
And if that works, try sending the same thing to 128.31.0.34 port 9031.

@_date: 2007-06-15 18:20:35
@_author: Roger Dingledine 
@_subject: Cisco firewall filtering Tor? 
Ok. Go look at add_default_trusted_dirservers() in src/or/config.c and
try each of those, then. :)
(I think dizum is down right now, but the rest should work.)

@_date: 2007-06-16 01:54:01
@_author: Roger Dingledine 
@_subject: Cisco firewall filtering Tor? 
Something is definitely interfering with your ability to complete a
TLS handshake.
Whether that's your local firewall demanding that it MitM your SSL
connections, or your local firewall recognizing Tor's TLS signature and
killing that connection, or something else, I couldn't say.
See also Nick's post from November about this topic:
If in fact they're running one of the rulesets from Nick's post, and
it's working, then the best plan for you is either to sit tight and
wait until we've deployed the next iteration of our protocol (it could
be many months at this rate), ...or you could help. :) See
for details.
Btw, you seem to have set a config option of "ReachableAddresses *:443",
which means you can't contact (m)any directory servers. You may find
this to be bad after a couple of days. :) You might prefer *:80,*:443.

@_date: 2007-06-16 18:34:07
@_author: Roger Dingledine 
@_subject: nighteffect.us gone 
Some people have been modifying the "Random stuff" section of
(hard to say who, it's a wiki ;)
The other answer is that I should link some of them from the
Tor documentation page.
Is one of these more stable than the other, or should I list both? Or
should I list others too?
Also, one day I'd like to declare one of them as official, and give it
a foo.torproject.org address. But perhaps we are not there yet. :)

@_date: 2007-06-17 00:15:15
@_author: Roger Dingledine 
@_subject: nighteffect.us gone 
Actually, you can have Apache listen for Tor requests on port 80 and
pass them to the actual DirPort.
See the middle of
for how to configure ProxyPass for your Apache.

@_date: 2007-06-17 03:19:05
@_author: Roger Dingledine 
@_subject: nighteffect.us gone 
Great. I have just changed to point to both of these.
Ok. We were originally planning to check the code into Tor SVN as one of
the many modules we're accumulating (
but you beat us to it. Perhaps it would be a good move to put it into
official Tor SVN at this point? I guess it depends on whether there is
anybody around who actually plans to maintain it. :)

@_date: 2007-06-19 12:30:40
@_author: Roger Dingledine 
@_subject: Strange behaviour of Tor 0.2.0.2 Alpha & vidalia 0.0.12 
As of 0.1.2.x, Tor guesses its own IP address automatically, and nobody
has described to me any cases where it's wrong, so I assume it is working
perfectly. ;)
In a future version of Vidalia, the "address" box, along with the button
to click, will disappear. Yay simpler interfaces.
(We may eventually add an 'Advanced' window to the server configuration
window in Vidalia, but I'm not sure right now what would go on it. All
advanced things right now are solved by requiring the user to know how
to edit a text file (easy) and to somehow know which file to edit (not
so easy).)
Vidalia 0.0.12 has no idea that the RelayBandwidth* config options
exist. In a future version of Vidalia, it will _only_ set RelayBandwidth*,
and never Bandwidth*, since this is what users actually mean when they
ask for rate limiting. (Especially if we can figure out what the bug is
that Fredzupy is reporting. :)
Hope that helps,

@_date: 2007-06-21 00:32:46
@_author: Roger Dingledine 
@_subject: Problem with bandwidth 
Uhm, no, it defaults to bytes unless you specify otherwise.
Which means we have the opposite problem sometimes (people try to
rate limit to 20 bytes per second), but hopefully the checks in config.c
notice that.

@_date: 2007-06-21 00:53:14
@_author: Roger Dingledine 
@_subject: Received http status code 503 ("Directory unavailable") from server 
Look through src/or/connection.c for "Directory unavailable". This
happens when you try to ask for a v1-style directory object (either
a full directory or a running-routers list), and the directory mirror
doesn't have a suitable copy yet.
Most commonly this is because the server just started and hasn't found
a copy it likes yet.
With more and more Tor servers upgrading to 0.1.2.x and later, it will
become increasingly rare to find copies of the v1 directory objects (since
they will decline to serve them more often, sending a "503 Directory busy,
try again later").
I just checked the server you queried, and got a 503 as you say.
Then I queried it for /tor/server/authority and it told me it had an
uptime of 3 seconds (as of earlier today) and was named 'zealand'. The
IP and nickname aren't mentioned in any network-status documents I can
Perhaps this is in your own private Tor network? Anything else you
aren't mentioning? :)

@_date: 2007-06-01 01:09:16
@_author: Roger Dingledine 
@_subject: [ANNOUNCE] Incognito "tiny" Live CD update, now <50MB 
Hi Pat,
Thanks for sticking with this. I'll give you a quick suggestion that
you may not find useful quite yet but it'll sure come in handy soon:
how about putting a version number (or a few numbers) on it? :)

@_date: 2007-06-04 00:00:06
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.2-alpha is out 
These are the first two development snapshots for the 0.2.0.x series.
These releases provide new features for people running Tor as both a
client and a server (check out the new RelayBandwidth config options); let
Tor run as a DNS proxy; and generally move us forward on a lot of fronts.
Changes in version 0.2.0.2-alpha - 2007-06-02
  o Major bugfixes on 0.2.0.1-alpha:
    - Fix an assertion failure related to servers without extra-info digests.
      Resolves bugs 441 and 442.
  o Minor features (directory):
    - Support "If-Modified-Since" when answering HTTP requests for
      directories, running-routers documents, and network-status documents.
      (There's no need to support it for router descriptors, since those
      are downloaded by descriptor digest.)
  o Minor build issues:
    - Clear up some MIPSPro compiler warnings.
    - When building from a tarball on a machine that happens to have SVK
      installed, report the micro-revision as whatever version existed
      in the tarball, not as "x".
Changes in version 0.2.0.1-alpha - 2007-06-01
  o Major features, server usability:
    - New config options RelayBandwidthRate and RelayBandwidthBurst:
      a separate set of token buckets for relayed traffic. Right now
      relayed traffic is defined as answers to directory requests, and
      OR connections that don't have any local circuits on them.
  o Major features, client usability:
    - A client-side DNS proxy feature to replace the need for
      dns-proxy-tor: Just set "DNSPort 9999", and Tor will now listen
      for DNS requests on port 9999, use the Tor network to resolve them
      anonymously, and send the reply back like a regular DNS server.
      The code still only implements a subset of DNS.
    - Make PreferTunneledDirConns and TunnelDirConns work even when
      we have no cached directory info. This means Tor clients can now
      do all of their connections protected by TLS.
  o Major features, performance and efficiency:
    - Directory authorities accept and serve "extra info" documents for
      routers. These documents contain fields from router descriptors
      that aren't usually needed, and that use a lot of excess
      bandwidth. Once these fields are removed from router descriptors,
      the bandwidth savings should be about 60%. [Partially implements
      proposal 104.]
    - Servers upload extra-info documents to any authority that accepts
      them. Authorities (and caches that have been configured to download
      extra-info documents) download them as needed. [Partially implements
      proposal 104.]
    - Change the way that Tor buffers data that it is waiting to write.
      Instead of queueing data cells in an enormous ring buffer for each
      client->OR or OR->OR connection, we now queue cells on a separate
      queue for each circuit.  This lets us use less slack memory, and
      will eventually let us be smarter about prioritizing different kinds
      of traffic.
    - Use memory pools to allocate cells with better speed and memory
      efficiency, especially on platforms where malloc() is inefficient.
    - Stop reading on edge connections when their corresponding circuit
      buffers are full; start again as the circuits empty out.
  o Major features, other:
    - Add an HSAuthorityRecordStats option that hidden service authorities
      can use to track statistics of overall hidden service usage without
      logging information that would be very useful to an attacker.
    - Start work implementing multi-level keys for directory authorities:
      Add a standalone tool to generate key certificates. (Proposal 103.)
  o Security fixes:
    - Directory authorities now call routers stable if they have an
      uptime of at least 30 days, even if that's not the median uptime
      in the network. Implements proposal 107, suggested by Kevin Bauer
      and Damon McCoy.
  o Minor fixes (resource management):
    - Count the number of open sockets separately from the number
      of active connection_t objects. This will let us avoid underusing
      our allocated connection limit.
    - We no longer use socket pairs to link an edge connection to an
      anonymous directory connection or a DirPort test connection.
      Instead, we track the link internally and transfer the data
      in-process. This saves two sockets per "linked" connection (at the
      client and at the server), and avoids the nasty Windows socketpair()
      workaround.
    - Keep unused 4k and 16k buffers on free lists, rather than wasting 8k
      for every single inactive connection_t. Free items from the
      4k/16k-buffer free lists when they haven't been used for a while.
  o Minor features (build):
    - Make autoconf search for libevent, openssl, and zlib consistently.
    - Update deprecated macros in configure.in.
    - When warning about missing headers, tell the user to let us
      know if the compile succeeds anyway, so we can downgrade the
      warning.
    - Include the current subversion revision as part of the version
      string: either fetch it directly if we're in an SVN checkout, do
      some magic to guess it if we're in an SVK checkout, or use
      the last-detected version if we're building from a .tar.gz.
      Use this version consistently in log messages.
  o Minor features (logging):
    - Always prepend "Bug: " to any log message about a bug.
    - Put a platform string (e.g. "Linux i686") in the startup log
      message, so when people paste just their logs, we know if it's
      OpenBSD or Windows or what.
    - When logging memory usage, break down memory used in buffers by
      buffer type.
  o Minor features (directory system):
    - New config option V2AuthoritativeDirectory that all directory
      authorities should set. This will let future authorities choose
      not to serve V2 directory information.
    - Directory authorities allow multiple router descriptors and/or extra
      info documents to be uploaded in a single go.  This will make
      implementing proposal 104 simpler.
  o Minor features (controller):
    - Add a new config option __DisablePredictedCircuits designed for
      use by the controller, when we don't want Tor to build any circuits
      preemptively.
    - Let the controller specify HOP=%d as an argument to ATTACHSTREAM,
      so we can exit from the middle of the circuit.
    - Implement "getinfo status/circuit-established".
    - Implement "getinfo status/version/..." so a controller can tell
      whether the current version is recommended, and whether any versions
      are good, and how many authorities agree. (Patch from shibz.)
  o Minor features (hidden services):
    - Allow multiple HiddenServeicePort directives with the same virtual
      port; when they occur, the user is sent round-robin to one
      of the target ports chosen at random.  Partially fixes bug 393 by
      adding limited ad-hoc round-robining.
  o Minor features (other):
    - More unit tests.
    - Add a new AutomapHostsOnResolve option: when it is enabled, any
      resolve request for hosts matching a given pattern causes Tor to
      generate an internal virtual address mapping for that host.  This
      allows DNSPort to work sensibly with hidden service users.  By
      default, .exit and .onion addresses are remapped; the list of
      patterns can be reconfigured with AutomapHostsSuffixes.
    - Add an "-F" option to tor-resolve to force a resolve for a .onion
      address. Thanks to the AutomapHostsOnResolve option, this is no
      longer a completely silly thing to do.
    - If Tor is invoked from something that isn't a shell (e.g. Vidalia),
      now we expand "-f ~/.tor/torrc" correctly. Suggested by Matt Edman.
    - Treat "2gb" when given in torrc for a bandwidth as meaning 2gb,
      minus 1 byte: the actual maximum declared bandwidth.
  o Removed features:
    - Removed support for the old binary "version 0" controller protocol.
      This has been deprecated since 0.1.1, and warnings have been issued
      since 0.1.2.  When we encounter a v0 control message, we now send
      back an error and close the connection.
    - Remove the old "dns worker" server DNS code: it hasn't been default
      since 0.1.2.2-alpha, and all the servers seem to be using the new
      eventdns code.
  o Minor bugfixes (portability):
    - Even though Windows is equally happy with / and \ as path separators,
      try to use \ consistently on Windows and / consistently on Unix: it
      makes the log messages nicer.
    - Correctly report platform name on Windows 95 OSR2 and Windows 98 SE.
  o Minor bugfixes (directory):
    - Correctly enforce that elements of directory objects do not appear
      more often than they are allowed to appear.
    - When we are reporting the DirServer line we just parsed, we were
      logging the second stanza of the key fingerprint, not the first.
  o Minor bugfixes (logging):
    - When we hit an EOF on a log (probably because we're shutting down),
      don't try to remove the log from the list: just mark it as
      unusable.  (Bulletproofs against bug 222.)
  o Minor bugfixes (other):
    - In the exitlist script, only consider the most recently published
      server descriptor for each server. Also, when the user requests
      a list of servers that _reject_ connections to a given address,
      explicitly exclude the IPs that also have servers that accept
      connections to that address. (Resolves bug 405.)
    - Stop allowing hibernating servers to be "stable" or "fast".
    - On Windows, we were preventing other processes from reading
      cached-routers while Tor was running.  (Reported by janbar)
    - Make the NodeFamilies config option work. (Reported by
      lodger -- it has never actually worked, even though we added it
      in Oct 2004.)
    - Check return values from pthread_mutex functions.
    - Don't save non-general-purpose router descriptors to the disk cache,
      because we have no way of remembering what their purpose was when
      we restart.
    - Add even more asserts to hunt down bug 417.
    - Build without verbose warnings even on (not-yet-released) gcc 4.2.
  o Minor bugfixes (controller):
    - Make 'getinfo fingerprint' return a 551 error if we're not a
      server, so we match what the control spec claims we do. Reported
      by daejees.
    - Fix a typo in an error message when extendcircuit fails that
      caused us to not follow the \r\n-based delimiter protocol. Reported
      by daejees.
  o Code simplifications and refactoring:
    - Stop passing around circuit_t and crypt_path_t pointers that are
      implicit in other procedure arguments.
    - Drop the old code to choke directory connections when the
      corresponding OR connections got full: thanks to the cell queue
      feature, OR conns don't get full any more.
    - Make dns_resolve() handle attaching connections to circuits
      properly, so the caller doesn't have to.
    - Rename wants_to_read and wants_to_write to read/write_blocked_on_bw.
    - Keep the connection array as a dynamic smartlist_t, rather than as
      a fixed-sized array. This is important, as the number of connections
      is becoming increasingly decoupled from the number of sockets.

@_date: 2007-06-04 10:56:21
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.2-alpha is out 
Great, thanks for helping out!
Ah, I should have been more clear. Quoting from sec 3.3 of
   "A router is 'Stable' if it is active, and either its
   uptime is at least the median uptime for known active routers, or
   its uptime is at least 30 days."
   ("a router is considered "active" if it is
   running, valid, and not hibernating")
Most of the servers in the network get their Stable flag from being in
the top half of the servers by uptime, and only a few are affected by
the or-30-days exception we added in 0.2.0.1-alpha. The current cutoff
for being stable in the Tor network right now is 185878 seconds, or a
bit over 51 hours.
Hope that helps,

@_date: 2007-06-04 11:03:19
@_author: Roger Dingledine 
@_subject: Directory mirror and BandwidthRate/BandwidthBurst 
Note that you're talking about the v1 directory:
which is only used by Tor versions 0.1.0.x and earlier.
As you say, it is huge. I believe most of the people who fetch it these
days are a) directory mirrors who fetch a fresh copy in case somebody
asks for it, or b) humans like you fetching it manually. So I have no
problems with phasing it out. See also Nick's recent mail declaring
its imminent obsolescence:
I'd rather save your bandwidth for more useful directory stuff. More
generally, this was one of the tradeoffs I wrestled with when I was
putting the 'write limiting' feature in -- I wanted to make sure we
never went over our write limit, but I also wanted to minimize directory
overhead in general, since every byte we spend for directory stuff is
a byte we can't spend passing Tor traffic.
We already do. Ask for it with ".z" appended to the end of the url.

@_date: 2007-06-12 19:06:19
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.2-alpha is out 
Hi folks,
Can people try these out and give me feedback?
If you run a Tor server and also use it as a client, these options are
for you. Just replace your current BandwidthRate and BandwidthBurst
settings in torrc with RelayBandwidthRate and RelayBandwidthBurst, and
Tor should magically start working better for you -- it will rate limit
traffic from other people but not limit your own traffic.

@_date: 2007-03-07 14:04:10
@_author: Roger Dingledine 
@_subject: one less onion skin 
I believe that k_1 is redundant with respect to TLS's security, yes.
(d_1 isn't redundant -- each MAC is with respect to cells that start or
finish at that hop, so d_1 isn't used except for control cells to/from
N_1 and if the user decides to exit from N_1.)
In any case, the AES overhead doesn't seem so bad. Our profiling goals
have been to get us back to the state where the crypto is the limiting
factor, and I've seen 1Ghz pentiums push 10MB/s of Tor traffic assuming
there aren't bottlenecks elsewhere. Getting rid of the public key pieces
of the handshake was a smart move though.
Let me take your proposal a step further though: why not get rid of
k_2 and d_2 too? After all, since people only exit from the end of the
circuit in practice, and if the real attack we fall to is the end-to-end
correlation attack, isn't it adequate for our encryption and our integrity
checking to be just at the end-points too? And the answer is yes, except
we're hoping for breakthroughs on the research side that can give us some
amount of protection against the end-to-end attack, and I'm guessing that
having a more uniform protocol may be handy at that point.
On the third hand, you make some good points, and as long as we use
TLS correctly, it seems that first layer of AES can be discarded with
little ill effects, even if we end up doing mixing or delaying later,
and even if the user decides to exit from the first hop. If you wrote up a
"spec proposal" for the idea, I bet it would make it pretty far.
(One ill effect might arise because the rotation schedule for the TLS
keys is way less frequent than for a quick circuit. But if the user is
using CREATE_FAST, then he doesn't actually have perfect forward secrecy
from that hop anyway.)
(I wrote this draft last night but didn't send it, and now others have
responded -- I agree with them too.)

@_date: 2007-03-08 05:30:57
@_author: Roger Dingledine 
@_subject: Warnings on the download page (was: yet another tor attack) 
Mike and I just whipped up an early version of this here:
(Thanks Mike!)
Let us know if you have any fixes or more issues to list. Eventually
this should get its own page, with more details, etc, and then we can
put just a concise summary (ha ha) on the download page. There are so
many permutations of applications out there...it's depressing sometimes
how hard it is to secure the whole Internet.
Also, somebody should write up a page with recommendations for
configurations/etc of common applications that work well with Tor, for
tasks other than web browsing -- Gaim comes to mind first for AIM + IRC,
and we can recommend OTR at the same time. What else is a very common
task by Tor users who need basic documentation? We probably shouldn't
try to document Torifying mail delivery at this point (other than "use
web mail") or Skype ("don't bother, stick with web browsing").
This document could be based on
 but needs to
be simpler and more right. I'm guessing the somebody will end up being
me, but if you send me drafts/notes/etc it'll happen faster. :)

@_date: 2007-03-08 17:22:34
@_author: Roger Dingledine 
@_subject: Warnings on the download page 
Hi HD,
Thanks for joining the discussion, and welcome. We (the Tor developers)
have been working mostly on making Tor itself work, and hoping that
other people would step up to help us figure out how to safely configure
the supporting applications (web browsers, etc). We could sure use some
help. :)
The current simplest advice I can give people is to remove all plugins:
Do you have any suggestions on safe ways to back off from that?

@_date: 2007-03-08 23:30:55
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.10-rc is out 
This is the second release candidate for the 0.1.2.x series. We made it
work better on Windows again -- this time for sure. :)
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.1.2.10-rc - 2007-03-07
  o Major bugfixes (Windows):
    - Do not load the NT services library functions (which may not exist)
      just to detect if we're a service trying to shut down. Now we run
      on Win98 and friends again.
  o Minor bugfixes (other):
    - Clarify a couple of log messages.
    - Fix a misleading socks5 error number.

@_date: 2007-03-09 03:14:31
@_author: Roger Dingledine 
@_subject: Warnings on the download page 
I hear from people on OS X who use Firefox for safe stuff and Safari
or something else for non-safe stuff. They seem happy enough.
I'm not comfortable recommending portable firefox yet, due to a problem
that Steven Murdoch found a while ago: when firefox starts up, it hunts
around on your hard drive to see if there are any plugins, and then it
enables those. I think there are some ways to disable this behavior,
but it's not disabled by default... so it's not so easy as just adding
a link. :(
Also, isn't Portable Firefox Windows-only? Or am I confused?
How often are you doing this scanning at this point?
Speaking of which, a frequently asked question that isn't answered on
the FAQ is: "I'm pretty sure my exit node is screwing with me. How do
I figure out which exit node it is?" My answers so far have been
  - Run at loglevel info and go look through all the stuff that
    makes no sense to you. Not so easy.
  - Use Vidalia's Network Map window and watch which circuit your
    stream is connecting to. Easy -- if you use Vidalia.
  - Connect to the control port manually and ask for stream and
    circuit events and then let it scroll. When something goes
    wrong, look at the output and piece it back together.
Any ideas on a more foolproof approach? :)

@_date: 2007-03-10 17:23:55
@_author: Roger Dingledine 
@_subject: How to run Tor from USB with Linux (Kubuntu 6.10) 
Should be pretty straightforward. Just grab src/or/tor and you're on
your way, assuming your OS has the library dependencies. You could also
try compiling a static Tor if you want it to be actually portable.
You might also want tor-resolve, but only if you actually want it.
For libraries, or things like Vidalia, I would say that "copy it over,
see if it works, add what's missing, repeat" is a fine strategy.
Whatever you want. :) If you want Tor to store its cache files and state
to your USB key, then point it there. If you want it on your hard drive,
point it there. But you should put it somewhere where you'll use it
again next time; that is, you don't want to be deleting the DataDirectory
between invocations.
Hope that helps,

@_date: 2007-03-12 18:18:19
@_author: Roger Dingledine 
@_subject: server status 'offline' 
I believe you're talking about the node MrBenn:
If so,
% telnet 86.129.181.33 9001
Trying 86.129.181.33...
It just times out. You (or your ISP, but probably you) are firewalling
incoming connections on this port.
Perhaps you're running a Windows firewall that lets things work for a
little while and then locks them down again?
(Another option is that your Tor process isn't running anymore, and the
default Windows behavior is to just time out for a port where no process
is listening.)

@_date: 2007-03-13 02:27:35
@_author: Roger Dingledine 
@_subject: Firefox extensions that hurt privacy (was Re: Warnings on the download page) 
I've just added another sentence to the pile of warnings:
"Consider removing extensions that look up more information about the
websites you type in (like Google toolbar), as they may bypass Tor and/or
broadcast sensitive information."
I added this because periodically people show up on the IRC channel
saying they followed our instructions exactly, but their sniffer still
says they're doing DNS resolves. And in many cases we track it down to
some esoteric extension that does geolocation for the websites they type
in, or lists the IP address that they're hitting, or something like that.
I guess that some Tor users have a whole mess of other extensions
installed. I have no idea if these users are smart enough to realize
potential problems, but probably not all of them are.
The last person who had this problem wrote this wiki page for us:
Have you experienced other extensions that have this behavior? (Perhaps
you're running one right now and you didn't realize? ;) Would somebody
here like to take charge to organize a list and keep it maintained?

@_date: 2007-03-14 03:20:15
@_author: Roger Dingledine 
@_subject: Tor server crashes on a Linksys WRT54GL 
Try the 0.1.2.10-rc release -- it will start only 2 processes and then
hog all your cpu. ;)
How much ram does your linksys have? I hear they have been selling them
with less and less ram to discourage people from using them for anything,
so the newer it is the less likely it will run Tor (or heck, Linux) well.
nmap won't scan all the ports. It is the wrong tool for that purpose.
Try netstat instead.
You may find
Good luck,

@_date: 2007-03-16 03:17:00
@_author: Roger Dingledine 
@_subject: Work on Tor this summer, get paid by Google 
Hi folks,
We (EFF and Tor working together) have been accepted into Google's
Summer of Code 2007. This means they'll fund several students to work
with us this summer on projects related to Tor. International students
are welcome too.
The deadline for students submitting applications is _MARCH 24_.
I've put up a page with more details here:
and there's a big list of potential projects here:
Please let us know if you're interested, and spread the word. The
more applications we get, the more likely Google is to give us good
students. So if you haven't filled up your summer plans yet, consider
spending some time working with us to make Tor better!

@_date: 2007-03-18 23:16:05
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.12-rc is out 
This is the fourth release candidate for the 0.1.2.x series. We fixed
an important bug that could send your Tor server into an infinite loop.
(The 0.1.2.11-rc release also appeared, but was quickly replaced by
0.1.2.12-rc. :)
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.1.2.12-rc - 2007-03-16
  o Major bugfixes:
    - Fix an infinite loop introduced in 0.1.2.7-alpha when we serve
      directory information requested inside Tor connections (i.e. via
      begin_dir cells). It only triggered when the same connection was
      serving other data at the same time. Reported by seeess.
  o Minor bugfixes:
    - When creating a circuit via the controller, send a 'launched'
      event when we're done, so we follow the spec better.
Changes in version 0.1.2.11-rc - 2007-03-15
  o Minor bugfixes (controller), reported by daejees:
    - Correct the control spec to match how the code actually responds
      to 'getinfo addr-mappings/*'.
    - The control spec described a GUARDS event, but the code
      implemented a GUARD event. Standardize on GUARD, but let people
      ask for GUARDS too.

@_date: 2007-03-20 16:04:55
@_author: Roger Dingledine 
@_subject: posting hidden service descriptors 
No, one-hop circuits are for begin_dir cells. See 6.2.1 in
tor-spec.txt. They let you connect to a directory port in an encrypted
authenticated manner, which can also be handy when your local network
is filtering certain http requests or ports. The one-hop circuits
are intended for cases where currently you'd just be making a direct
connection: now you connect to the Tor server and ask to connect to
its dirport.
Yep. That would be bad.

@_date: 2007-03-20 16:31:36
@_author: Roger Dingledine 
@_subject: how much traffic does an unthrottled middleman draw on 100 MBit/s? 
Well, assuming it's got all the CPU/etc it needs, and is actually
on a *good* 100Mbps link... the highest throughput Tor server right
now is desync:
which is pushing about 2870 kB/s sustained on average (read+write / 2).
This adds up to a lot of bytes per month. :) And it looks like it's rate
limited by the default 3MB/6MB rate limiting, so it could be even higher
if the operator chose to raise its bandwidthrate.
If you don't give it enough cpu, or your network isn't actually 100mbit,
or it's 100mbit to the ISP but it's less to the rest of the Internet,
then it will be less. I know of several 100mbit connections that are
using 1500 kB/s, which is quite a bit different, and FoeBud ran one for
a while that could barely get past 1MB/s (they're at a different ISP and
happier now).
I'm not sure what features are most influential in causing some to be
really fast and others only sort of fast.
By comparison, the fastest middleman server right now is Tonga, which
is pushing 1848 kB/s sustained.

@_date: 2007-03-21 12:43:29
@_author: Roger Dingledine 
@_subject: how much traffic does an unthrottled middleman draw on 100 MBit/s? 
It's unlikely to go past about 25Mbps sustained, even if there is no rate
limiting  -- the load balancing over the Tor network isn't good enough
to allocate more than that to you, because there are lots of slower Tor
servers that cause bottlenecks.
The default BandwidthRate is 3 MB, and the default BandwidthBurst is 6 MB.
shrek2 appears to be using these defaults currently.
So it won't go past 24Mbps sustained (or 48Mbps if you're one of those
people who adds incoming traffic and outgoing traffic and calls that
the bandwidth use.)
(If you're using Tor 0.1.1.x, which you are, the BandwidthRate doesn't
do any rate limit on outgoing bytes -- so your directory writes could
exceed 24Mbps out. You should move to 0.1.2.12-rc or later if you don't
like this.)
Hope this helps,

@_date: 2007-03-23 18:17:50
@_author: Roger Dingledine 
@_subject: Tor Server Affecting Net Access 
Suggestions, to try in order. Let me know which one of these solves it,
so we have another data point. :)
1) Add "BandwidthBurst 75 KB" to your torrc too. Right now your
BandwidthBurst is at the default, which is 6 MB, which is certainly
enough to saturate your upstream during bursts.
2) Upgrade to 0.1.2.12-rc, or if you can't, turn off your DirPort. The
0.1.1.x release only rate limits incoming traffic, whereas 0.1.2.x rate
limits both, including handling directory traffic well. Outgoing traffic
is probably causing your problem, whatever it is.
3) Try reducing the number 75 to a lower number. Maybe you don't
have the upstream bandwidth you think you have.
4) Drake had a good question, which was "does having Tor running degrade
your connectivity even when it's known to be hibernating?"
5) Your DSL router may have problems handling hundreds of TCP
connections at once. Are you running the most recent bios?
I don't think getting a separate IP will do much. But hey, if you
get to this point in the list, who knows. :) But once you've figured
out the issue, yay exit nodes, we could use more.
Hope that helps,

@_date: 2007-03-23 23:33:39
@_author: Roger Dingledine 
@_subject: Exit Node vs. Middleman Requirements 
Right. We have something like 900 Tor servers right now, and they're
trying to handle traffic from a few hundred thousand active users pushing
perhaps a gigabit of traffic each way on average. That's not a good
ratio. :)
Around a third of the available bandwidth is from exit nodes. So we
could sure use more exit nodes too.

@_date: 2007-03-26 15:46:14
@_author: Roger Dingledine 
@_subject: Anonymity through decentralization (was Re: Ultimate solution) 
I'm leaving the licensing discussion alone for now, but I wanted to
respond to this technical point. Tor's security [1] comes from two
components. The first is its large and diverse user base -- as the user
base expands, the mere use of Tor doesn't narrow you down to a specific
user community or specific few people who are known to have fetched the
program [2]. The second is the diversity of the relays -- as the Tor
network expands, fewer adversaries are able to be in enough places on
the network to succeed at linking senders to recipients.
Now, it's still an open research question what metrics we should use
for these components (that is, how exactly we measure the security we
get from them), but my intuition is that after a certain point the first
component doesn't contribute much more to security -- meaning in Tor's
current state, its security grows primarily as the network grows.
And remember that by "being in enough places", I mean being in a position
to watch (or otherwise measure [3]) the traffic; the best attacks we know
right now only look at characteristics of the traffic flow [4], because
any sort of coordinated compromise of many relays is probably harder.
I'm not saying Tor's design is perfect. We are still grappling with
Sybil attack questions, and as you say we need to encourage our users to
employ end-to-end encryption and authentication when appropriate. And
we're still not happy that a widely dispersed attacker can probably do
very well against Tor.
But a central organization that administers all the relays, even if it
puts them in different places geographically, and even if it promises to
do perfect audits and employ only perfect people, aims for a fundamentally
different sort of security than Tor aims to provide. The traffic analysis
attacks above are still just as much of a concern, but insider attacks and
other attacks on/by the organization are now a significant question too.
You can launch a new single-hop proxy service, commercial or not,
proprietary or not. You can also launch a multi-hop service where you
control every hop. And the license of the Tor software lets you use it
if you find it useful for your purposes. But please don't deceive your
users by changing the security context and then encouraging them to think
that just because the Tor software is present somewhere in the picture,
they are benefitting from the type of security that Tor aims to provide.
[1] By "security", I'm talking primarily about unlinkability here;
but that's a different thread.
[2] [3] [4]

@_date: 2007-03-04 21:10:11
@_author: Roger Dingledine 
@_subject: "router get by nickname" on request to dir server appears to be failing 
One of the big privacy concerns is that your DNS queries get sent out
in the clear to anybody who's watching your network connection. Tor can
protect against an attacker watching your network connection, but not if
you tell him each of your destinations before you (anonymously) go there.
If you find specific Tor nodes that are consistently bad with their DNS
answers, please let us know and we'll contact the operators to get them
to fix it (or assign the BadExit flag to them if that doesn't work).

@_date: 2007-03-26 17:06:39
@_author: Roger Dingledine 
@_subject: Is this a Tor exit node connecting to me? 
Hi Joe,
Great stuff. Thanks for setting it up!
I am beginning to wonder if the first query type should be there at
all though. After all, part of the motivation for running a "better"
dnsbl is that we had problems with sites setting up lists of Tor servers,
glossing over the details of what is an exit server and what that means,
and then encouraging everybody to use their list for whatever purpose they
like. Services have been trained to look for "a list of IP addresses", not
"a list of IP addresses relative to my service". I predict a lot of people
will use your list in the same way as they've used every other dnsbl --
and even more so once we point at it and say "that's the official dnsbl
you should use."
If a user wants to see whether a given IP address happens to be running
a Tor server, and doesn't care about exit policy, then I am fine sending
him to a web page to look it up manually. Making it easy to automate is
just encouraging the wrong assumptions.
Matt, can you let us know if setting up sendmail with the
relative-to-your-IP-address approach is just as easy? Are there common
situations where it would make things harder?
And while I'm asking, we could imagine setting up a dnsbl that looks
at what IP address is asking the question, and answers relative to that
address. Thus people in Matt's situation could just plug it in, and it
would internally do what we all mean. I can see some downsides though --
if the client querying the dnsbl is on a very different address than
the service, or if proxying dns queries (or passing recursive queries)
is commonplace. I suspect a few 'no, that wouldn't work' responses should
be sufficient to discard this paragraph. :)

@_date: 2007-03-28 20:20:27
@_author: Roger Dingledine 
@_subject: Please don't recommend Tor Button! 
Torbutton does different things depending on your version of Firefox.
On versions less than 1.5.x -- the ones that don't support
socks_remote_dns -- it sets every proxy it can find, because if you
leave any of them out, the browser will default to your socks proxy and
broadcast the DNS resolve as it does so.
On versions that have socks_remote_dns, we're in better shape. Torbutton
automatically sets that, so now when things default to your socks proxy,
it's still safe.
I just updated the FTP FAQ entry:

@_date: 2007-03-29 20:16:18
@_author: Roger Dingledine 
@_subject: Please don't recommend Tor Button! 
[Forwarding since HD isn't subscribed at this address. -RD]

@_date: 2007-03-05 16:31:32
@_author: Roger Dingledine 
@_subject: pop3 and smtp over ssl [was: ssh] 
They might be slow, and they might also be overloaded by folks who
want to use non-standard ports, so they get even more overloaded.
I know that there have been cases where nodes open up port 25 and then
become nearly useless because they attract all the people who've been
trying to send anonymous mail through Tor but couldn't.
Well, once you've made a connection to a port, Tor remembers this for
the next hour and tries to prebuild circuits that will allow exits to
that port. But you're suggesting something to give a hint to Tor before
you even do the first connection?
Seems straightforward enough. Another config option, of the same form as
LongLivedPorts, that defaults to "80", maybe called InitialPredictedPorts?
And then see predicted_ports_init() in rephist.c -- replace the third
line with something that parses the smartlist into numbers and adds each
of them.

@_date: 2007-03-03 00:06:29
@_author: Roger Dingledine 
@_subject: Tor 0.1.2.9-rc is out 
This is the first release candidate for the 0.1.2.x series. We made it
work better on Windows again, and fixed a few other bugs.
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.1.2.9-rc - 2007-03-02
  o Major bugfixes (Windows):
    - On MinGW, use "%I64u" to printf/scanf 64-bit integers, instead
      of the usual GCC "%llu". This prevents a bug when saving 64-bit
      int configuration values: the high-order 32 bits would get
      truncated. In particular, we were being bitten by the default
      MaxAdvertisedBandwidth of 128 TB turning into 0. (Fixes bug 400
      and maybe also bug 397.)
  o Minor bugfixes (performance):
    - Use OpenSSL's AES implementation on platforms where it's faster.
      This could save us as much as 10% CPU usage.
  o Minor bugfixes (server):
    - Do not rotate onion key immediately after setting it for the first
      time.
  o Minor bugfixes (directory authorities):
    - Stop calling servers that have been hibernating for a long time
      "stable". Also, stop letting hibernating or obsolete servers affect
      uptime and bandwidth cutoffs.
    - Stop listing hibernating servers in the v1 directory.
  o Minor bugfixes (hidden services):
    - Upload hidden service descriptors slightly less often, to reduce
      load on authorities.
  o Minor bugfixes (other):
    - Fix an assert that could trigger if a controller quickly set then
      cleared EntryNodes.  (Bug found by Udo van den Heuvel.)
    - On architectures where sizeof(int)>4, still clamp declarable bandwidth
      to INT32_MAX.
    - Fix a potential race condition in the rpm installer.  Found by
      Stefan Nordhausen.
    - Try to fix eventdns warnings once and for all: do not treat a dns rcode
      of 2 as indicating that the server is completely bad; it sometimes
      means that the server is just bad for the request in question. (may fix
      the last of bug 326.)
    - Disable encrypted directory connections when we don't have a server
      descriptor for the destination. We'll get this working again in
      the 0.2.0 branch.

@_date: 2007-03-06 14:16:00
@_author: Roger Dingledine 
@_subject: blog about tor and skype 
To clarify for the or-talk readers, it looks like the suggestion for
using Skype with Tor can be summarized as "use Freecap".
The problem is that Skype uses either UDP or TCP, depending on the
situation. If it chooses TCP, Freecap will intercept it and send it
through Tor, and for that traffic you'll get anonymity as well as
encryption up to the point where it reaches the first Skype hop --
after that you have to rely on whatever encryption Skype gives you (and
as Enigma pointed out, there are some cases where Skype gives you none).
Yes, if it goes through Tor, then it is encrypted by Tor, up to the point
where it reaches the first Skype hop. After that, it's up to Skype to
protect it.
But if it doesn't go through Tor (for example, Skype choses to use UDP),
then Tor isn't anywhere in the picture.
Same answer as above.
Step one would be to force Skype to use TCP only. I'm not sure how to do
this; one option would be to firewall yourself so only the Tor process
can send outbound traffic (don't ask me how to do that in Windows, it's
probably really hard), and I hear Skype is smart enough to keep trying
until it finds something that works.
I should also note that Tor is going to make you a very sad Skype voice
user, since it'll add both latency and jitter. But maybe Skype text is ok.
(I personally don't use Skype, because I don't know what the heck it
does. But for Windows users, I guess that's par for the course. YMMV.)
Good luck,

@_date: 2007-03-06 14:21:10
@_author: Roger Dingledine 
@_subject: blog about tor and skype 
One option to investigate for Windows would be JanusVM:
I haven't looked at whatever it *does* block all non-Tor traffic,
but if not it wouldn't be too hard to make it do that, if you were the
JanusVM developer.
(It still wouldn't solve the facts that Skype voice performance will suck,
and that Skype is a distributed botnet waiting to be exploited.)

@_date: 2007-03-06 14:42:20
@_author: Roger Dingledine 
@_subject: Error Message when stop Tor with Vidalia 
Good point. The 0.1.2.10-rc release will call that a 'notice',
not an 'error', since it is not an error.

@_date: 2007-03-06 14:55:28
@_author: Roger Dingledine 
@_subject: blog about tor and skype 
One day I'd like to support this, yes. It's hard though:

@_date: 2007-03-06 16:39:28
@_author: Roger Dingledine 
@_subject: TTL expired? 
You're right: I've changed line 471 of rendclient.c so it'll use
END_STREAM_REASON_RESOLVEFAILED rather than END_STREAM_REASON_TIMEOUT,
which will result in a socks5 error 4 (host unreachable).
But there's a deeper issue, which is that we return socks5 error 6 (ttl
expired) for cases of END_STREAM_REASON_TIMEOUT, and this is probably
wrong. What's happening on Tor's side is that it's trying to build or
find a suitable circuit for the stream, but it gives up after a few
minutes and tells you you're out of luck.
Is this a host unreachable case or a network unreachable case? As far as
I can tell, the socks5 error messages are totally undocumented beyond
the short phrase for each one. I did find Some Guy On The Internet who
speculated a few more details:
None of these fit the "we timed out without even trying to make the
connection" case in Tor, but host unreachable and network unreachable
seem closest. Anybody have a good rationale for one over the other?

@_date: 2007-03-03 03:01:59
@_author: Roger Dingledine 
@_subject: Problem starting Tor. 
Did 0.1.2.8-beta work for you?
Can you clarify "refuses to start"? Be as specific as you can.
See also  :)

@_date: 2007-03-07 01:42:27
@_author: Roger Dingledine 
@_subject: Building tracking system to nab Tor pedophiles 
You still have to be careful though -- if you enable them for some
domains that you trust (say, foo.com), then you can still get nailed
when you visit foo.com from an evil exit node, it inserts some malicious
applets, and your noscript says "well yeah, but the user typed in foo.com,
therefore this applet is from foo.com, so I trust it".
So the moral of the story appears to be turn the plugins off, period.
The broader moral is: don't run code from strangers on your computer. The
even broader moral would be to lament that we're still not using SSL on
most Internet interactions. And maybe the fourth is that we (somebody
here) should work on easy instructions for locking down common OS network
interfaces so only Tor communications can get through. Or Tor LiveCDs
that have that already done. Or VM images that can be run as routers
between your computer and the Internet.

@_date: 2007-05-16 02:04:17
@_author: Roger Dingledine 
@_subject: bw_accounting and mirroring dir 
If you want to monitor a server's bandwidth, probably the best way is to
open up its controlport, and have your tool connect to the controlport
and ask for 'bw' events. You'll get an update every second, and you can
add them up, store them, etc as you like.
If your script becomes useful please share it with the rest of us. :)

@_date: 2007-05-16 14:23:21
@_author: Roger Dingledine 
@_subject: LiveCD / USB for testing 
Hi Pat,
This looks neat. I'm travelling currently so can't actually try booting
it, but here are some early thoughts:
- The configuration descriptions are great. They let me actually decide
  what it does and whether it's doing it right. The next step would be to
  post the config files et al for each section, so you can not only read
  the English description of what you did but also fetch it yourself and
  confirm that it's been done right, use it in your own configuration,
  etc. This will be especially useful for the more complex programs that
  have several config files, so we can know what exactly you've modified
  and what you've left alone. I could imagine a few links at the top of
  each description section pointing to the appropriate config files.
- You should probably pick a better name than 'torcd', long-term.
  Everybody seems to want to pick that name for their Tor livecd, and
  things are already confusing enough. :) As an example, blindcoder
  changed his torcd project to "Rockate", a pun on Rock linux and (I
  assume) the translation of Tor as a German word.
- Setting up Tor with its DirPort enabled should be fine if you're
  using Tor 0.1.2.13 or later. This version of Tor is pretty good about
  not advertising its DirPort until it thinks it has enough bandwidth
  to offer.
- Speaking of which, your descriptions of applications don't say which
  versions you're including. Is it Firefox 0.9 or 2.0 or what? :)
- As for the UDP question, my instinct is towards dropping unexpected
  UDP packets. Is your goal to provide an easy anonymizing experience for
  people who otherwise don't much know what they're doing? Or to provide
  a "power livecd" for people who want their applications even when they
  show up at a foreign computer? I guess these are quite different goals,
  and you'll go mad if you try to achieve both at once.

@_date: 2007-05-25 14:06:39
@_author: Roger Dingledine 
@_subject: Regulating bandwidth 
Currently we recommend that you manually set your BandwidthRate so
your accounting quota is expected to be exhausted halfway through your
accounting period.
See the last paragraph of
for details.
I wouldn't object to a config option AccountingBandwidthAuto or the
like that does what you describe. This would save people from needing to
do that calculation. In fact, the naive implementation could be really
easy -- it could just take the AccountingMax and accounting period and
do the math. But it could also try to get smarter, as you say.
So, feel free to submit a patch. :)

@_date: 2007-05-25 15:41:03
@_author: Roger Dingledine 
@_subject: Probed Server 
Those are Tor directory requests.
Most likely he thought you were running a Tor directory mirror on that
Perhaps you used to advertise port 80 for your Tor server's directory
mirror? (Or you still do?)
Another possibility is that you're on a dynamic IP address and somebody
else was running one on there before you inherited that IP address.

@_date: 2007-05-25 23:23:34
@_author: Roger Dingledine 
@_subject: Regulating bandwidth 
Yeah, Olaf already knows about the numcpu option:
He is right that we need to think about how to offload more of the
computation onto other threads. But concluding that is the easy part. :)
The hard part is: what computations can we offload?

@_date: 2007-05-28 19:21:16
@_author: Roger Dingledine 
@_subject: ISP TOS restrictions on servers 
It depends a lot on the ISP. In many cases they add this clause to their
terms of service so people can't complain if their IP address starts
changing nightly or the ISP starts filtering certain incoming ports, etc

@_date: 2007-05-29 12:55:21
@_author: Roger Dingledine 
@_subject: ISP TOS restrictions on servers 
The wiki is editable, but you need to log in first (due to wiki spam).
The "Meta" section of may help you to log in more easily.

@_date: 2007-05-30 11:32:50
@_author: Roger Dingledine 
@_subject: Bandwith donation for some days ? 
Yes. We had a lot of Tor servers running at 23C3.
Yes. They should start seeing use a few hours after they are set up.
No need.
Yep. Thanks!
One last note -- are they all going to be using IP addresses from the
same /16 network, or will the IP addresses be more diverse than that?

@_date: 2007-05-31 18:35:14
@_author: Roger Dingledine 
@_subject: All authorities have failed. Not trying any. 
We told you that setting __AllDirActionsPrivate would do that if you
don't provide some external mechanism for inserting descriptors yourself.
You're welcome to try setting it anyway, but if it breaks, you get to
keep both pieces. :)
If you figure out what the issue is and have a patch, great. Otherwise,
I'll just continue saying that it's not recommended.
Good luck,

@_date: 2007-05-05 04:22:04
@_author: Roger Dingledine 
@_subject: new TOR seems excessively chatty 
You should make a debug level log for us, that lasts for 10 minutes or
so, and post that on some url somewhere.
It sounds like a bug, but it sure could be a lot of them based on
the above hints. :)
In the mean time, can other people check to see if they're getting
this behavior? I would expect that 0.1.1.26 clients might also be
seeing it.

@_date: 2007-05-05 17:23:00
@_author: Roger Dingledine 
@_subject: new TOR seems excessively chatty 
Thanks. This looks like two different bugs, triggered because dizum
has been down for the past 4 days. I've opened a flyspray entry on it:
In the mean time, can you downgrade to 0.1.1.26 and confirm that you
have the same problems there? You should probably back up your datadir
first to make sure it isn't lost when you downgrade.

@_date: 2007-05-05 20:45:10
@_author: Roger Dingledine 
@_subject: Tor server monitoring and notification service? 
Hi folks,
I just added a new item to   Sometimes Tor servers crash, or the computers they're on fall off the
  network, or other accidents happen. Some Tor operators have expressed
  an interest in signing up to a "notifying" service that periodically
  checks whether their Tor server is healthy and sends them a reminder
  mail when it's not. Anybody want to write a few cgi scripts, a few web
  pages, and set up some sort of wget hack and/or something more complex
  like Nagios to do the monitoring? The
  first version could check just the directory port, e.g. looking through
  the cached network-status page for the right IP address and port and
  then asking for the "/tor/server/authority" page.
Perhaps somebody here (or a group of somebodies) wants to tackle this?

@_date: 2007-05-07 01:26:13
@_author: Roger Dingledine 
@_subject: Nodes naming 
Section 2.2 of  says:
 nickname ::= between 1 and 19 alphanumeric characters, case-insensitive.
No. But in some cases there can be only one node with a given nickname,
if that nickname is bound to a particular identity key by a naming
directory authority, and if the "named" one is running right now. You
can read a bit more about the Named flag in section 3.1, but its behavior
will likely change yet again in the future; see e.g. proposal 113:
If you want something unique, use the identity fingerprint (aka digest).

@_date: 2007-05-07 01:28:50
@_author: Roger Dingledine 
@_subject: crypto error 
No ideas. Perhaps you can give us a few hints about your situation?
What OS, what Tor version, did you install from a package or source,
what openssl version, did you change anything, what did you change,
do you have hardware acceleration enabled, etc.
Alternatively, is Tor working for you generally and this appeared in
your log for no reason you can tell?
My bet is that you're either trying to install Tor to some really odd
hardware/software combination, or you're running a really old Tor. Or
both. :)

@_date: 2007-05-07 01:30:11
@_author: Roger Dingledine 
@_subject: FW: Tor server monitoring and notification service? 
Sure, that sounds great.
The rest of you should continue to feel free to do this too -- the first
person who produces something useful wins. :)
Let me know if you have questions about how it ought to work/behave/not

@_date: 2007-05-07 01:31:31
@_author: Roger Dingledine 
@_subject: nighteffect.us gone 
It does appear to be missing, yes.
I think we have a copy of the code around here somewhere, so worst comes
to worst we can try to find a volunteer to put up a second copy.
But I am still optimistic that Joe will return sometime and fix it. :)

@_date: 2007-05-08 18:55:08
@_author: Roger Dingledine 
@_subject: www.torrify.com 
Tor is a non-profit effort, which isn't quite the same thing -- we have
been funded to research and develop Tor over the past five years by
groups ranging from the US Naval Research Lab to the Electronic Frontier
Foundation. But yes, we have intentionally avoided a lot of the ways we
might commercialize Tor, because we feel they would be bad for the Tor
community long-term. The Tor software, protocols, and network must remain
open and free: so people can evaluate it, decide whether they trust it,
etc, and also so we have the best shot at providing good anonymity.
The two organizations are aware of each other and working to clear
any issues.
Stay tuned. :) And feel free to contact us if you have any questions
or concerns.

@_date: 2007-05-09 03:55:03
@_author: Roger Dingledine 
@_subject: advantage using multiple cpus 
Right. Tor has one main thread, which does TLS, signature verifications,
etc. It then has separate "cpuworker" threads that do onion decryption. As
you say, this doesn't divide everything evenly. But it is a start. :)
Once upon a time (before Tor 0.1.0.1-rc), the cpuworker threads were
separate processes. They still are separate processes on OpenBSD, NetBSD,
Solaris, and a few others due to pthreads problems on those platforms.
But now that most Tors use threads, it could be that we could share more
cpu work with the cpuworker threads. It would be great if somebody wants
to look into this. Our dependency on opaque OpenSSL functions for a lot
of the cpu-using activities makes this tougher.

@_date: 2007-11-14 00:47:39
@_author: Roger Dingledine 
@_subject: Tor takes too much RAM 
Thanks to Mike Perry, we finally tracked down a little bug that was
leaking a huge amount of memory for exit relays.
The attempted fix will be part of the upcoming development release
(whatever version number it eventually gets), and will eventually
work its way into a new stable release.
If you're running the 0.1.2.x branch and you can't wait to help us test
it, check out
This addresses a big issue with exit relays, but there is still some
other issue remaining. We're not back to the 0.0.9.x days quite yet I'm
afraid. :)
Thanks for your patience,

@_date: 2007-11-14 15:56:03
@_author: Roger Dingledine 
@_subject: Teaching about Tor in Germany 
Hi folks,
I'm going to be in Berlin (and probably Stuttgart) the first week of
January, after 24C3. I'd really like to meet with some German law
enforcement, judges, lawyers, or other people who are likely to be
involved in future Tor cases and could benefit from understanding more
about Tor. If you know a person or group who fits this description,
please take a moment to introduce them to me.
I've had several productive talks with FBI officers around the US and with
Norwegian law enforcement, but apart from some helpful people at BSI,
I haven't ever talked to the more traditional German law enforcement
groups. My goal wouldn't be to advocate for any particular laws or
policies (that's up to them, after all), but rather to help give them
background so they can make more informed decisions: explain who uses
Tor and how it works, and try to answer any questions that come up.
Please feel free to forward this to anybody who can help -- I'd rather
learn about too many people than too few, since I travel to Germany
periodically and I can aim to fit them all in over time..

@_date: 2007-11-15 01:29:11
@_author: Roger Dingledine 
@_subject: News orgs should be interested in running tor nodes 
Rather than trying to get them to operate their own hardware, we might
make more progress just trying to help them understand the good uses
and good users for Tor.
We've made some progress with American journalists because by this point
quite a few of them know somebody down the hall who's used Tor and found
it useful. For example, we heard from a major American news organization
that got a knock on the door of their foreign office after they submitted
a story about an east Asian country from inside said country. Now that
they know about Tor, they don't attract as much attention from the locals
when researching their stories or submitting them.
The more journalists who recognize the value of safety online, the
more they'll be willing to see (and explain) both sides of a story when
something comes up.
So if you know a journalist, whatever country you're in, take them out
for coffee and teach them how anonymity on the Internet can work and how
diverse its users are. Offer to be a contact if they ever find themselves
needing to know more about anonymity online.
Speaking of which, we need to work more on docs that explain the good
uses of Tor. There's a start here:
If anybody wants to clean this up and make it look sharper, please do. :)

@_date: 2007-11-15 22:29:41
@_author: Roger Dingledine 
@_subject: Tor on the OLPC? 
Yes, I've heard it runs Tor just fine. Many of the OLPC developers use Tor
on their laptop. They live down the street from Nick and me, in fact. :)
The real question they've been pondering is not "does it run Tor", but
"should it come with Tor pre-installed". After all, they don't want all
these kids getting profiled and getting into local databases and so on.
But alas, I don't think Tor is ready for a few million more users yet, a)
because they would just add load to the network and not help relay, b)
because our development pace is still too fast to point to a given Tor
installation and say "that's Tor and it'll work next year too", and c)
because Tor is only part of the security/privacy puzzle and rest of the
puzzle still needs a whole lot of work.
These are on our todo list though. :)

@_date: 2007-11-15 23:57:07
@_author: Roger Dingledine 
@_subject: Why Are We Waiting for the Cavalry to Ride In? (was Re: court trial against me - the outcome) 
Agreed. Part of the challenge here is that different analogies work for
different people. Explaining why anonymity is useful for individuals
in the US may not quite be the same as for individuals in Europe, and
is probably quite different than for individuals in Guatemala. And
explaining it for law enforcement is different from explaining it for
road warrior executives is diferent from soldiers ...
Some of the technically oriented folks don't like "dumbed down" analogies,
because while they may do a great job at explaining some aspects of Tor,
they mislead the reader about other aspects of Tor. On the flip side, we
haven't found an analogy that is technically accurate and not misleading,
yet can be given in a single sentence.
We get half a million hits each day on the website; I bet we could do
a lot better job at teaching our audience about privacy issues on the
Internet than we do now.
I've been pondering for a little while that maybe we should run a 'Tor
analogy competition', akin to the GUI competition we ran a few years back.
I have no idea who would judge it though.
I think you should divide the above suggestion into two pieces.
I am all for creating an information center to teach people how to explain
Tor, to hook them up with lawyers in their area, to give contact info
for law enforcement in their area who have already seen a Tor talk, to
explain some of what will hopefully one day be regarded as common sense
(such as "if the police think you might be a criminal and ask you to
explain to them how the Internet works, and you ignore them, they're
probably to keep thinking you're a criminal"), and to actively build a
local community of educatied lawyers, law enforcement, etc.
There are quite a few lawyers in the US who would be happy to give
advice (see Tor's legal FAQ), and we know some in Germany and other
countries. For example, I send anybody with a legal question in Germany
to Julius Mittenzwei, and hopefully he introduces them to useful people
after that. It would be good to have more volunteers than just Julius
that we can send people to.
And it would be great to have more coordinators than just in the US and
Germany -- there are other countries than these two, after all. But as
I've found over the past few years, you really really need a coordinator
inside each country who knows the right people and keeps track of local
policies and laws. Somebody who knows all the coordinators, and who
travels a lot and can keep up to speed on a lot of the issues, would be
useful to help coordinate the coordinators. I'll continue to do what I
can do to help, but I fear I'm wearing rather too many hats these days
as it is.
So yes, organizing better would be fabulous, along with then educating
people more about the fact that people *are* organized.
But collecting money and promising to fund the defense of anybody who gets
in trouble? That brings in a host of complexities. No group of lawyers
I've ever met promises to defend people before they've heard about the
specifics of the case and the defendant. It simply wouldn't make sense
for them to make a blanket promise only to find out later on that the
defendant has some side hobby or past history that undermines the case.
So I would argue that you already would have a huge challenge, and
would do what most needs to be done, even if there aren't any funds
being distributed.
Hope that helps,

@_date: 2007-11-17 05:42:32
@_author: Roger Dingledine 
@_subject: How to ban bad tor node which would redirect http request to a certain ip tracker? 
Yes, you can exclude the node by nickname (or better, by key fingerprint)
by adding an "ExcludeNodes" line to your torrc file. See the man page
for details.
But even better, if you tell us which node it is, we'll a) try to contact
the operator to get him to fix it, as it's quite likely to be an innocent
misconfiguration, and b) blacklist it from the directory consensus in
the meantime, so other users won't stumble into it.
(I've been meaning for a while to come up with some mechanism for users to
report problems they see, while we wait for Mike Perry to get his TorFlow
application more automated. But there are enough false positives that I
don't think we should just say "mail tor-volunteers". I'm not sure what
the best plan should be.)

@_date: 2007-11-17 07:35:10
@_author: Roger Dingledine 
@_subject: encrypting your communications?! 
Gah. You're right.
I've changed the offending sentence to:
"Tor protects you by bouncing your communications around a distributed
network of relays run by volunteers all around the world: it prevents
somebody watching your Internet connection from learning what sites you
visit, and it prevents the sites you visit from learning where you're
coming from."
I don't want to only say that it hides the origin of your communication,
because a lot of people out there use Tor to gain protection from a
local attacker, and "hides the origin" is only half the story.
(Actually, it's only a third of the story -- the last third that I've
left out is that Tor is resistant to any single relay learning both your
location and your destination. But there's only so much you can fit into
an introductory paragraph.)
If anybody wants to propose alternate frontpage text, do feel free. :)

@_date: 2007-11-21 20:00:48
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.12-alpha is out 
Tor 0.2.0.10-alpha adds a third v3 directory authority run by Mike Perry,
adds most of Karsten Loesing's new hidden service descriptor format, fixes
a bad crash bug and new bridge bugs introduced in 0.2.0.9-alpha, fixes
many bugs with the v3 directory implementation, fixes some minor memory
leaks in previous 0.2.0.x snapshots, and addresses many more minor issues.
Tor 0.2.0.11-alpha fixes some build problems with the previous
snapshot. It also includes a more secure-by-default exit policy for
relays, fixes an enormous memory leak for exit relays, and fixes another
bug where servers were falling out of the directory list.
Tor 0.2.0.12-alpha fixes some more build problems as well as a few
minor bugs.
Changes in version 0.2.0.12-alpha - 2007-11-16
  This twelfth development snapshot fixes some more build problems as
  well as a few minor bugs.
  o Compile fixes:
    - Make it build on OpenBSD again. Patch from tup.
    - Substitute BINDIR and LOCALSTATEDIR in scripts. Fixes
      package-building for Red Hat, OS X, etc.
  o Minor bugfixes (on 0.1.2.x):
    - Changing the ExitPolicyRejectPrivate setting should cause us to
      rebuild our server descriptor.
  o Minor bugfixes (on 0.2.0.x):
    - When we're lacking a consensus, don't try to perform rendezvous
      operations. Reported by Karsten Loesing.
    - Fix a small memory leak whenever we decide against using a
      newly picked entry guard. Reported by Mike Perry.
    - When authorities detected more than two relays running on the same
      IP address, they were clearing all the status flags but forgetting
      to clear the "hsdir" flag. So clients were being told that a
      given relay was the right choice for a v2 hsdir lookup, yet they
      never had its descriptor because it was marked as 'not running'
      in the consensus.
    - If we're trying to fetch a bridge descriptor and there's no way
      the bridge authority could help us (for example, we don't know
      a digest, or there is no bridge authority), don't be so eager to
      fall back to asking the bridge authority.
    - If we're using bridges or have strictentrynodes set, and our
      chosen exit is in the same family as all our bridges/entry guards,
      then be flexible about families.
  o Minor features:
    - When we negotiate a v2 link-layer connection (not yet implemented),
      accept RELAY_EARLY cells and turn them into RELAY cells if we've
      negotiated a v1 connection for their next step. Initial code for
      proposal 110.
Changes in version 0.2.0.11-alpha - 2007-11-12
  This eleventh development snapshot fixes some build problems with
  the previous snapshot. It also includes a more secure-by-default exit
  policy for relays, fixes an enormous memory leak for exit relays, and
  fixes another bug where servers were falling out of the directory list.
  o Security fixes:
    - Exit policies now reject connections that are addressed to a
      relay's public (external) IP address too, unless
      ExitPolicyRejectPrivate is turned off. We do this because too
      many relays are running nearby to services that trust them based
      on network address. Bugfix on 0.1.2.x.
  o Major bugfixes:
    - Fix a memory leak on exit relays; we were leaking a cached_resolve_t
      on every successful resolve. Reported by Mike Perry; bugfix
      on 0.1.2.x.
    - On authorities, never downgrade to old router descriptors simply
      because they're listed in the consensus. This created a catch-22
      where we wouldn't list a new descriptor because there was an
      old one in the consensus, and we couldn't get the new one in the
      consensus because we wouldn't list it. Possible fix for bug 548.
      Also, this might cause bug 543 to appear on authorities; if so,
      we'll need a band-aid for that. Bugfix on 0.2.0.9-alpha.
  o Packaging fixes on 0.2.0.10-alpha:
    - We were including instructions about what to do with the
      src/config/fallback-consensus file, but we weren't actually
      including it in the tarball. Disable all of that for now.
  o Minor features:
    - Allow people to say PreferTunnelledDirConns rather than
      PreferTunneledDirConns, for those alternate-spellers out there.
  o Minor bugfixes:
    - Don't reevaluate all the information from our consensus document
      just because we've downloaded a v2 networkstatus that we intend
      to cache. Fixes bug 545; bugfix on 0.2.0.x.
Changes in version 0.2.0.10-alpha - 2007-11-10
  This tenth development snapshot adds a third v3 directory authority
  run by Mike Perry, adds most of Karsten Loesing's new hidden service
  descriptor format, fixes a bad crash bug and new bridge bugs introduced
  in 0.2.0.9-alpha, fixes many bugs with the v3 directory implementation,
  fixes some minor memory leaks in previous 0.2.0.x snapshots, and
  addresses many more minor issues.
  o New directory authorities:
    - Set up ides (run by Mike Perry) as the third v3 directory authority.
  o Major features:
    - Allow tunnelled directory connections to ask for an encrypted
      "begin_dir" connection or an anonymized "uses a full Tor circuit"
      connection independently. Now we can make anonymized begin_dir
      connections for (e.g.) more secure hidden service posting and
      fetching.
    - More progress on proposal 114: code from Karsten Loesing to
      implement new hidden service descriptor format.
    - Raise the default BandwidthRate/BandwidthBurst to 5MB/10MB, to
      accommodate the growing number of servers that use the default
      and are reaching it.
    - Directory authorities use a new formula for selecting which nodes
      to advertise as Guards: they must be in the top 7/8 in terms of
      how long we have known about them, and above the median of those
      nodes in terms of weighted fractional uptime.
    - Make "not enough dir info yet" warnings describe *why* Tor feels
      it doesn't have enough directory info yet.
  o Major bugfixes:
    - Stop servers from crashing if they set a Family option (or
      maybe in other situations too). Bugfix on 0.2.0.9-alpha; reported
      by Fabian Keil.
    - Make bridge users work again -- the move to v3 directories in
      0.2.0.9-alpha had introduced a number of bugs that made bridges
      no longer work for clients.
    - When the clock jumps forward a lot, do not allow the bandwidth
      buckets to become negative. Bugfix on 0.1.2.x; fixes bug 544.
  o Major bugfixes (v3 dir, bugfixes on 0.2.0.9-alpha):
    - When the consensus lists a router descriptor that we previously were
      mirroring, but that we considered non-canonical, reload the
      descriptor as canonical. This fixes bug 543 where Tor servers
      would start complaining after a few days that they don't have
      enough directory information to build a circuit.
    - Consider replacing the current consensus when certificates arrive
      that make the pending consensus valid. Previously, we were only
      considering replacement when the new certs _didn't_ help.
    - Fix an assert error on startup if we didn't already have the
      consensus and certs cached in our datadirectory: we were caching
      the consensus in consensus_waiting_for_certs but then free'ing it
      right after.
    - Avoid sending a request for "keys/fp" (for which we'll get a 400 Bad
      Request) if we need more v3 certs but we've already got pending
      requests for all of them.
    - Correctly back off from failing certificate downloads. Fixes
      bug 546.
    - Authorities don't vote on the Running flag if they have been running
      for less than 30 minutes themselves. Fixes bug 547, where a newly
      started authority would vote that everyone was down.
  o New requirements:
    - Drop support for OpenSSL version 0.9.6. Just about nobody was using
      it, it had no AES, and it hasn't seen any security patches since
      2004.
  o Minor features:
    - Clients now hold circuitless TLS connections open for 1.5 times
      MaxCircuitDirtiness (15 minutes), since it is likely that they'll
      rebuild a new circuit over them within that timeframe. Previously,
      they held them open only for KeepalivePeriod (5 minutes).
    - Use "If-Modified-Since" to avoid retrieving consensus
      networkstatuses that we already have.
    - When we have no consensus, check FallbackNetworkstatusFile (defaults
      to $PREFIX/share/tor/fallback-consensus) for a consensus.  This way
      we start knowing some directory caches.
    - When we receive a consensus from the future, warn about skew.
    - Improve skew reporting: try to give the user a better log message
      about how skewed they are, and how much this matters.
    - When we have a certificate for an authority, believe that
      certificate's claims about the authority's IP address.
    - New --quiet command-line option to suppress the default console log.
      Good in combination with --hash-password.
    - Authorities send back an X-Descriptor-Not-New header in response to
      an accepted-but-discarded descriptor upload.  Partially implements
      fix for bug 535.
    - Make the log message for "tls error. breaking." more useful.
    - Better log messages about certificate downloads, to attempt to
      track down the second incarnation of bug 546.
  o Minor features (bridges):
    - If bridge users set UpdateBridgesFromAuthority, but the digest
      they ask for is a 404 from the bridge authority, they now fall
      back to trying the bridge directly.
    - Bridges now use begin_dir to publish their server descriptor to
      the bridge authority, even when they haven't set TunnelDirConns.
  o Minor features (controller):
    - When reporting clock skew, and we know that the clock is _at least
      as skewed_ as some value, but we don't know the actual value,
      report the value as a "minimum skew."
  o Utilities:
    - Update linux-tor-prio.sh script to allow QoS based on the uid of
      the Tor process. Patch from Marco Bonetti with tweaks from Mike
      Perry.
  o Minor bugfixes:
    - Refuse to start if both ORPort and UseBridges are set. Bugfix
      on 0.2.0.x, suggested by Matt Edman.
    - Don't stop fetching descriptors when FetchUselessDescriptors is
      set, even if we stop asking for circuits. Bugfix on 0.1.2.x;
      reported by tup and ioerror.
    - Better log message on vote from unknown authority.
    - Don't log "Launching 0 request for 0 router" message.
  o Minor bugfixes (memory leaks):
    - Stop leaking memory every time we parse a v3 certificate. Bugfix
      on 0.2.0.1-alpha.
    - Stop leaking memory every time we load a v3 certificate. Bugfix
      on 0.2.0.1-alpha. Fixes Bug 536.
    - Stop leaking a cached networkstatus on exit.  Bugfix on
      0.2.0.3-alpha.
    - Stop leaking voter information every time we free a consensus.
      Bugfix on 0.2.0.3-alpha.
    - Stop leaking signed data every time we check a voter signature.
      Bugfix on 0.2.0.3-alpha.
    - Stop leaking a signature every time we fail to parse a consensus or
      a vote.  Bugfix on 0.2.0.3-alpha.
    - Stop leaking v2_download_status_map on shutdown.  Bugfix on
      0.2.0.9-alpha.
    - Stop leaking conn->nickname every time we make a connection to a
      Tor relay without knowing its expected identity digest (e.g. when
      using bridges). Bugfix on 0.2.0.3-alpha.
  - Minor bugfixes (portability):
    - Run correctly on platforms where rlim_t is larger than unsigned
      long, and/or where the real limit for number of open files is
      OPEN_FILES, not rlim_max from getrlimit(RLIMIT_NOFILES). In
      particular, these may be needed for OS X 10.5.

@_date: 2007-11-21 20:52:14
@_author: Roger Dingledine 
@_subject: tor server thinks IP address changed twice when it did not change 
Interesting. Looks like it changed, then changed back. I just made
the "seems to have changed" log entry more informative:
And these two are from the dirport reachability test launched at
Right. That's because Tor clients were using the IP address advertised
in the descriptor you published before this hiccup.
Right, there's no reason to think it has to do with your cached files.
Tor doesn't look at your old cached descriptors to decide your current
IP address -- that would just be too fragile.
My first thought is that in fact your "thruhere.net" address resolved
to the old IP address briefly. This might happen because thruhere.net
has a big pile of dns servers, if one of them had an old answer cached
for a little while.
How repeatable is this? If you could get an info-level log, that would
give some more hints. (A debug-level log would provide even more hints,
but it would be really loud, so let's first see if info is enough.)

@_date: 2007-11-05 07:32:11
@_author: Roger Dingledine 
@_subject: "Our directory information is no longer up-to-date enough to build circuits." problem logged 
Hi Scott,
I encountered this issue once with 0.2.0.9-alpha, and it wasn't
immediately apparent what the problem was. Since then we've fixed a
variety of things, including providing more details in the logs about
*why* we don't feel we've got enough dir info.
So if you could upgrade to svn trunk and see if it recurs there, that
would be great. (And if it does recur, hopefully it will provide a better
hint. :) (If upgrading to svn is too much of a hassle, I'm hoping to
get the 0.2.0.10-alpha snapshot out sometime this week.)

@_date: 2007-11-24 20:41:02
@_author: Roger Dingledine 
@_subject: Tor relays in China (was Re: Tor blocking german nodes) 
I still think this is normal behavior. See e.g.
for the last time this discussion came up.
Seriously, the Vidalia interface is making it really easy these days
to become a Tor relay, and by default Vidalia relays are exit relays
(then see  From
very informal studies of what's hitting my directory cache, Germany,
US, and China make up about 20% of the Tor user base each.
So it is not surprising to me that in BlueStar's stats
( they represent the top
three countries by relays too.
I don't think they're Chinese dissidents. I think they're Chinese Tor
users. Most German Tor users aren't German dissidents either. Once you
start talking about hundreds of thousands of users, most of them are
just ordinary people hoping to get a bit more privacy.
Press coverage about the increasing use of Tor in China would actually
harm our goals -- right now Tor works well in China because we're not
threatening them, making them look bad in the media, etc. Let's keep it
that way as long as we can.

@_date: 2007-11-25 08:26:52
@_author: Roger Dingledine 
@_subject: Tor blocking german nodes 
Alas, I fear it's more complex than that. There are two anonymity-related
issues that people here aren't considering enough:
a) Tor's security doesn't come from having any single honest (unobserved)
relay on the path. It comes from the adversary not being able to see
(measure) traffic on both ends of the circuit. See e.g.
So for example if the destination website is in Germany, and it logs all
the packets it sees, then a logging entry relay would be sufficient to
give away the game.
b) If the Tor relay's ISP is logging enough, then it doesn't matter what
the Tor relay itself logs. I'm still hoping to hear an answer to Mike
Perry's question at
Then see If sufficient logging becomes pervasive at the ISP or IX level, then it
would seem that either we'll need to excise those jurisdictions from the
Tor network (and worse, give up on providing anonymity to users there),
or work on anonymity designs that tolerate this level of attack while
still remaining usable.
And that's where the actual definition of "traffic headers" or "traffic
data" becomes critical -- and as I understand it, nobody yet knows
what definitions will be used in practice. So it is premature to start
deploying any alternate designs.
But yes, if it gets to that point, we will be working hard on ways to
avoiding leaving as many tracks in these large central databases. Even
if I entirely trusted the authorities to only use the data in critical
situations, what scares me most is the poor track record of large
organizations at securing huge piles of sensitive data. We don't have
to look very far for stunning examples of data leaks. These extra
requirements like realtime access just make the task even more impossible.
Right. If you would like to start logging early, please instead turn
off your Tor relay.
And if the authorities try to force you to start logging early, please
also turn off your Tor relay, and then find some lawyers to help you
figure out how to notify the world safely.
Good luck!

@_date: 2007-11-30 15:23:28
@_author: Roger Dingledine 
@_subject: Insecurities in Privoxy Configurations  - Details 
Thanks Greg.
Two further comments:
1) Those of us who use polipo should pay attention too, and make sure
to put
in our polipo config file. Otherwise a remote attacker can reconfigure
our polipo out from underneath us, examine our cache to see where we've
been browsing, etc.
For more suggested polipo config options, check out
2) For a truly stunning array of browser-based attacks that can allow
this sort of attack (lest you think that you're safe because you're
running an up-to-date browser), check out "Protecting Browsers from DNS
Rebinding Attacks" by some good folks at Stanford:

@_date: 2007-11-30 17:13:33
@_author: Roger Dingledine 
@_subject: BSD/etc Tor servers? (was Re: Tor takes too much RAM) 
It occurs to me that all of the ram bloating reports have come from
Linux users.
Now, that may be because most fast Tor relays are on Linux.
If you run a fast Tor relay on something other than Linux, and you've
been around since the Tor 0.1.1.x days or before, please let us know if
it's using much more memory than it used to.

@_date: 2007-11-07 11:52:45
@_author: Roger Dingledine 
@_subject: Security concerns/help me understand tor 
Yep. That's why Tor has a notion of exit policies:
If you really want to restrict connections to sensitive local resources,
you should reject connections to them in your exit policy.
The default exit policy rejects internal addresses like 10.*, 192.168.*,
etc, but as you say there may be other sensitive resources depending on
your situation.
The other half of the answer is that you shouldn't be relying on network
location for authorization. You should, for example, use a password.
The third half of the answer is that running a web browser and interacting
with strange websites creates an excellent opportunity already for dns
rebinding attacks, cross-site foo attacks, etc. See for example the
"drive-by pharming" report from some folks I've been working with at IU,
summarized by Bruce Schneier here:
It's pretty darn scary what bad guys can do to access local resources
by tricking your browser.
In short, you'd better think harder if you want to both a) run complex
programs that can act as proxies, such as a web browser and such as Tor,
and b) do any sort of trust-by-network-location.
Yes. If you're visiting Bob's website, Tor can provide end-to-end
authentication and end-to-end encryption without the need for SSL.
This is a great potential feature. But you're right, Bob had better not
allow additional access to sensitive resources for people connecting
from his Tor relay.
Yes, except in cases where a) he doesn't know the extent to which local
services trust his IP address, and b) he is on a dynamic IP address.
Unfortunately, I suspect these are exactly the contexts where it's most
important for users to understand what's going on, *and* exactly the
contexts where the users will be most ignorant about the issues.
Where do you suggest we put the warnings, and can you suggest some
sample phrasings?
We could e.g. add a note to step 9 on
but I fear that most users can't (won't) count to 9.
Another option is to assume that most home users will be configuring
relaying via Vidalia, so we should concentrate on explaining all the
various issues there. (In fact, Vidalia doesn't currently have a good
interface for letting people tweak their exit policy by *addresses*
as well as ports.)
Another thought is that Tor relays already know their public IP address,
since after all they have to advertise it. Perhaps the default exit
policy should reject connections to that IP address, unless the operator
explicitly allows them? See also the "ExitPolicyRejectPrivate" entry
in the man page. This would be a shame to set up by default, but maybe
secure-by-default-for-end-users is a trend we should embrace.
And lastly, just to cover all bases: is there any point to this additional
complexity given that the attacks can already be done just fine via a
web browser? I guess it depends what assumptions we want to make about
the users. My instinct would be 'yes'.
The same thing that prevents bad people from doing it in airports,
local coffeeshop wifi, and so on: users should use SSL if they want to
be sure they're talking to the right destination.
See e.g. point  at Welcome. Hope that helps to explain a bit.

@_date: 2007-11-07 12:13:16
@_author: Roger Dingledine 
@_subject: "Our directory information is no longer up-to-date enough to build circuits." problem logged 
I think Nick has a handle on fixing the bug:
Hopefully it will be resolved in 0.2.0.10-alpha -- whenever that
comes out. ;)

@_date: 2007-11-07 18:18:59
@_author: Roger Dingledine 
@_subject: "Our directory information is no longer up-to-date enough to build circuits." problem logged 
No, this is very likely all the same bug.
We added a lot of extra debugging logs in to help find the problem.
That was what I talked about earlier when I said "you should upgrade to
svn trunk because that has more useful logs". :)

@_date: 2007-11-10 16:27:51
@_author: Roger Dingledine 
@_subject: Security concerns/help me understand tor 
Actually Jake, Tor already does automatically reject the RFC
1918 addresses in your exit policy, unless you change your
ExitPolicyRejectPrivate config option from 1 to 0.
I just changed it so it also adds your relay's public (external) IP
address too:
This change will be in the 0.2.0.11-alpha release (it's too late to put
it in the 0.2.0.10-alpha release), and will probably make its way into
0.1.2.19 (whenever that comes out) too.

@_date: 2007-10-10 15:45:54
@_author: Roger Dingledine 
@_subject: Bug: main.c:344: connection_stop_writing 
Yes, but it isn't fixed:
If you can help fix it, that would be grand. :)
It never seems to happen to me. :(

@_date: 2007-10-10 22:06:21
@_author: Roger Dingledine 
@_subject: Were are DIRs now?!? 
What do you mean "now"?
belegost.mit.edu and moria.mit.edu haven't been Tor directory
authorities since May.
Plus, the URL you're fetching from tor.noreply.org is the version 1
directory protocol, which has been obsolete since August.

@_date: 2007-10-13 16:25:28
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.8-alpha is out 
This eighth development snapshot fixes a crash bug that's been bothering
us since February 2007, lets bridge authorities store a list of bridge
descriptors they've seen, gets v3 directory voting closer to working,
starts caching v3 directory consensus documents on directory mirrors,
and fixes a variety of smaller issues including some minor memory leaks.
The Windows bundle also includes the new development Torbutton
version 1.1.8, which improves usability and compatibility over 1.1.7:
 Windows users are encouraged to
back up their Firefox settings before upgrading.
Changes in version 0.2.0.8-alpha - 2007-10-12
  o Major features (router descriptor cache):
    - Store routers in a file called cached-descriptors instead of in
      cached-routers. Initialize cached-descriptors from cached-routers
      if the old format is around. The new format allows us to store
      annotations along with descriptors.
    - Use annotations to record the time we received each descriptor, its
      source, and its purpose.
    - Disable the SETROUTERPURPOSE controller command: it is now
      obsolete.
    - Controllers should now specify cache=no or cache=yes when using
      the +POSTDESCRIPTOR command.
    - Bridge authorities now write bridge descriptors to disk, meaning
      we can export them to other programs and begin distributing them
      to blocked users.
  o Major features (directory authorities):
    - When a v3 authority is missing votes or signatures, it now tries
      to fetch them.
    - Directory authorities track weighted fractional uptime as well as
      weighted mean-time-between failures.  WFU is suitable for deciding
      whether a node is "usually up", while MTBF is suitable for deciding
      whether a node is "likely to stay up."  We need both, because
      "usually up" is a good requirement for guards, while "likely to
      stay up" is a good requirement for long-lived connections.
  o Major features (v3 directory system):
    - Caches now download v3 network status documents as needed,
      and download the descriptors listed in them.
    - All hosts now attempt to download and keep fresh v3 authority
      certificates, and re-attempt after failures.
    - More internal-consistency checks for vote parsing.
  o Major bugfixes (crashes):
    - If a connection is shut down abruptly because of something that
      happened inside connection_flushed_some(), do not call
      connection_finished_flushing(). Should fix bug 451. Bugfix on
      0.1.2.7-alpha.
  o Major bugfixes (performance):
    - Fix really bad O(n^2) performance when parsing a long list of
      routers: Instead of searching the entire list for an "extra-info "
      string which usually wasn't there, once for every routerinfo
      we read, just scan lines forward until we find one we like.
      Bugfix on 0.2.0.1.
    - When we add data to a write buffer in response to the data on that
      write buffer getting low because of a flush, do not consider the
      newly added data as a candidate for immediate flushing, but rather
      make it wait until the next round of writing. Otherwise, we flush
      and refill recursively, and a single greedy TLS connection can
      eat all of our bandwidth. Bugfix on 0.1.2.7-alpha.
  o Minor features (v3 authority system):
    - Add more ways for tools to download the votes that lead to the
      current consensus.
    - Send a 503 when low on bandwidth and a vote, consensus, or
      certificate is requested.
    - If-modified-since is now implemented properly for all kinds of
      certificate requests.
  o Minor bugfixes (network statuses):
    - Tweak the implementation of proposal 109 slightly: allow at most
      two Tor servers on the same IP address, except if it's the location
      of a directory authority, in which case allow five. Bugfix on
      0.2.0.3-alpha.
  o Minor bugfixes (controller):
    - When sending a status event to the controller telling it that an
      OR address is readable, set the port correctly. (Previously we
      were reporting the dir port.) Bugfix on 0.1.2.x.
  o Minor bugfixes (v3 directory system):
    - Fix logic to look up a cert by its signing key digest. Bugfix on
      0.2.0.7-alpha.
    - Only change the reply to a vote to "OK" if it's not already
      set. This gets rid of annoying "400 OK" log messages, which may
      have been masking some deeper issue. Bugfix on 0.2.0.7-alpha.
    - When we get a valid consensus, recompute the voting schedule.
    - Base the valid-after time of a vote on the consensus voting
      schedule, not on our preferred schedule.
    - Make the return values and messages from signature uploads and
      downloads more sensible.
    - Fix a memory leak when serving votes and consensus documents, and
      another when serving certificates.
  o Minor bugfixes (performance):
    - Use a slightly simpler string hashing algorithm (copying Python's
      instead of Java's) and optimize our digest hashing algorithm to take
      advantage of 64-bit platforms and to remove some possibly-costly
      voodoo.
    - Fix a minor memory leak whenever we parse guards from our state
      file. Bugfix on 0.2.0.7-alpha.
    - Fix a minor memory leak whenever we write out a file. Bugfix on
      0.2.0.7-alpha.
    - Fix a minor memory leak whenever a controller sends the PROTOCOLINFO
      command. Bugfix on 0.2.0.5-alpha.
  o Minor bugfixes (portability):
    - On some platforms, accept() can return a broken address. Detect
      this more quietly, and deal accordingly. Fixes bug 483.
    - Stop calling tor_strlower() on uninitialized memory in some cases.
      Bugfix in 0.2.0.7-alpha.
  o Minor bugfixes (usability):
    - Treat some 403 responses from directory servers as INFO rather than
      WARN-severity events.
    - It's not actually an error to find a non-pending entry in the DNS
      cache when canceling a pending resolve. Don't log unless stuff is
      fishy. Resolves bug 463.
  o Minor bugfixes (anonymity):
    - Never report that we've used more bandwidth than we're willing to
      relay: it leaks how much non-relay traffic we're using. Resolves
      bug 516.
    - When looking for a circuit to cannibalize, consider family as well
      as identity. Fixes bug 438. Bugfix on 0.1.0.x (which introduced
      circuit cannibalization).
  o Code simplifications and refactoring:
    - Make a bunch of functions static. Remove some dead code.
    - Pull out about a third of the really big routerlist.c; put it in a
      new module, networkstatus.c.
    - Merge the extra fields in local_routerstatus_t back into
      routerstatus_t: we used to need one routerstatus_t for each
      authority's opinion, plus a local_routerstatus_t for the locally
      computed consensus opinion. To save space, we put the locally
      modified fields into local_routerstatus_t, and only the common
      stuff into routerstatus_t. But once v3 directories are in use,
      clients and caches will no longer need to hold authority opinions;
      thus, the rationale for keeping the types separate is now gone.
    - Make the code used to reschedule and reattempt downloads more
      uniform.
    - Turn all 'Are we a directory server/mirror?' logic into a call to
      dirserver_mode().
    - Remove the code to generate the oldest (v1) directory format.
      The code has been disabled since 0.2.0.5-alpha.

@_date: 2007-10-13 18:56:57
@_author: Roger Dingledine 
@_subject: magic Wednesday 
Is blutmagie running weasel's Tor deb, by any chance?
I believe I have fixed this in
Here's the answer:
Your Tor server publishes a new server descriptor whenever something
important changes, or whenever 18 hours have passed since you last
published one.
Authorities stop listing servers if the last descriptor they have is more
than 20 hours old. To protect against crazy broken servers that publish
a new descriptor every minute, the authorities compare new descriptors
to old ones, and if nothing important has changed and it's been less
than 12 hours, they drop the new one -- no point forcing clients to
fetch extra descriptors if they wouldn't learn anything new.
So what's happening is that on the first morning at 6am, your Tor server
is getting a hup signal, which causes it to publish a new descriptor
and reset its "18 hour" counter -- meaning it won't publish again until
6+18=midnight. So now it's in a cycle where it tries to publish twice
a day: once at midnight, and once at 6am.
But the authorities discard the next 6am descriptor, because nothing
important has changed. And the midnight descriptor expires around 8pm,
meaning there's a 4-hour gap before you publish again.
The fix will be in 0.2.0.9-alpha, and might get backported to 0.1.2.18
if we decide we should. The next steps will be to fix it even more
thoroughly: the current thought is that authorities should distinguish
between "I accepted that" and "I accepted that but then discarded it"
in their response code when servers try to publish, and servers should
consider 18 hours from the last successful publish, not 18 hours from
the last attempt.
(Oh, and the magic Wednesday? Your Tor server generates a new onion
key every 7 days -- the new onion key produced a descriptor that the
authorities accepted, so there was no gap on that day.)

@_date: 2007-10-14 04:30:28
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.8-alpha is out 
Hm, you're right.
I've removed the 0.2.0.8-alpha Vidalia Windows bundle from the download
page for now, until we get it sorted out.

@_date: 2007-10-14 17:51:59
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.8-alpha is out 
And, it should be back up and in place now. Thanks!

@_date: 2007-10-14 18:02:54
@_author: Roger Dingledine 
@_subject: New Tor middleman server woes 
weasel and I just removed the old key fingerprint for Uovobw from the
approved-routers lists, so it should work fine now.
(There's no need to re-register with the new key fingerprint -- we're
trying to work on a better way of registering servers that doesn't
involve humans as bottlenecks, and in the mean time the best available
answer is to not do it at all. :)

@_date: 2007-10-15 01:20:21
@_author: Roger Dingledine 
@_subject: [privoxy-users] Reverse DNS Lookups? 
See  (item Right. The dev version of Torbutton does this by default:
Right. See for example JanusVM or Xerobank VM. (Actually, rather than
running the browser inside the VM, some people think the better approach
is to run the Tor client in the VM and handle the network there too.)
Alternatively, you can redirect your network traffic through Tor directly
with iptables/pf on Linux/BSD, using the TransPort feature that tup
helped add:
Quite so. One day one of them will write a clear set of documentation for
how to configure the VM and associated apps, what security properties
they aim to get, etc, and then people will have a chance to judge how
well the implementations match up with the design goals. I am optimistic
that this approach will turn out to be the right way to run a Tor client
for people who a) need to stay on Windows and b) have the horsepower
for the extra VM layer. But there are still some missing steps.

@_date: 2007-10-15 15:47:51
@_author: Roger Dingledine 
@_subject: Attn TorStatus folks! We are about to break your bandwidth measures! 
Hi Kasimir,
It looks like something still isn't right, at least with
The 0.1.2.x Tor servers have fine bandwidth graphs, e.g.
But the 0.2.0.x Tor servers have flatlined graphs, e.g.
Is torstatus.kgprog.com still running an old version, or is it
not asking for extra-info docs correctly, or are the authorities
not serving them correctly, or what? :)

@_date: 2007-10-16 00:23:51
@_author: Roger Dingledine 
@_subject: Attn TorStatus folks! We are about to break your bandwidth measures! 
Yeah. Here's the better approach, which I think matches what you say
Step 0: set "DownloadExtraInfo 1" in your torrc.
Step 1: GETINFO desc/all-recent
Step 2: Look for descriptors that have the extra-info-digest line, and
then GETINFO extra-info/ to get the bandwidth information for
that descriptor.
Hope that helps. I just tested the GETINFO desc/all-recent-extrainfo-hack
thing, and it seems to work. Perhaps you skipped step 0?

@_date: 2007-10-16 00:32:51
@_author: Roger Dingledine 
@_subject: 0.1.2.18 is getting close to ready; please test it 
Hi folks,
We're getting close to having 0.1.2.18 ready. I've put snapshots at
Please grab it, try it out, and let us know whether we broke anything.
Partial list of changes in version 0.1.2.18 - 2007-10-??
  o Major bugfixes (crashes):
    - If a connection is shut down abruptly because of something that
      happened inside connection_flushed_some(), do not call
      connection_finished_flushing(). Should fix bug 451:
 Assertion conn->write_event failed"
      Bugfix on 0.1.2.7-alpha.
    - Fix possible segfaults in functions called from
      rend_process_relay_cell().
  o Major bugfixes (other):
    - Stop publishing a new server descriptor just because we get a
      HUP signal. This led (in a roundabout way) to some servers getting
      dropped from the networkstatus lists for a few hours each day.
    - Hidden services were choosing introduction points uniquely by
      hexdigest, but when constructing the hidden service descriptor
      they merely wrote the (potentially ambiguous) nickname.
    - Clients now use the v2 intro format for hidden service
      connections: they specify their chosen rendezvous point by identity
      digest rather than by (potentially ambiguous) nickname. These
      changes could speed up hidden service connections dramatically.
    - When looking for a circuit to cannibalize, consider family as well
      as identity. Fixes bug 438. Bugfix on 0.1.0.x (which introduced
      circuit cannibalization).
  o Minor bugfixes:
    - Don't try to access (or alter) the state file when running
      --list-fingerprint or --verify-config or --hash-password. (Resolves
      bug 499.)
    - When generating information telling us how to extend to a given
      router, do not try to include the nickname if it is
      absent. (Resolves bug 467.)
    - Fix a user-triggerable segfault in expand_filename(). (There isn't
      a way to trigger this remotely.)
    - When sending a status event to the controller telling it that an
      OR address is readable, set the port correctly. (Previously we
      were reporting the dir port.)
    - Fix a minor memory leak whenever a controller sends the PROTOCOLINFO
      command. Bugfix on 0.1.2.17.
    - When loading bandwidth history, do not believe any information in
      the future. Fixes bug 434.
    - When loading entry guard information, do not believe any information
      in the future.
    - When we have our clock set far in the future and generate an
      onion key, then re-set our clock to be correct, we should not stop
      the onion key from getting rotated.
    - On some platforms, accept() can return a broken address. Detect
      this more quietly, and deal accordingly. Fixes bug 483.
    - It's not actually an error to find a non-pending entry in the DNS
      cache when canceling a pending resolve. Don't log unless stuff
      is fishy. Resolves bug 463.

@_date: 2007-10-23 05:01:22
@_author: Roger Dingledine 
@_subject: recent rev. take a very long time to get client working 
It's because recent svn revisions use the new v3 directory protocol,
and there are currently only two v3 directory authorities. Both of
these authorities upgraded to a new version a few hours ago that had a
crash bug, and one of them is still down. It takes a majority to build a
networkstatus consensus, and a majority of 2 is 2. Without a consensus,
your Tor client refuses to build any circuits.
Later, there will be more than two v3 authorities, so this will happen
We're pondering letting Tor clients start with an obsolete networkstatus
consensus (say, if you have one from 12 hours ago). This is good from
a "now it works" perspective, but bad because a malicious directory
cache can hand you one from 12 hours ago and claim there aren't any
newer ones, and now you behave differently from all the other users who
weren't tricked.

@_date: 2007-10-01 03:09:22
@_author: Roger Dingledine 
@_subject: Servers and the "Named" flag (was Re: time needed to register a serve) 
I've removed step four, and also cleaned up some of the other items
so they don't contain scary-sounding words like "stdout". Thanks for
the nudge.
Me too. Keep your eyes out on the or-dev list for discussion about
how to do this in a more manageable way.
Maybe we should instead assign them math problems to evaluate their
dedication. :)

@_date: 2007-10-25 12:18:07
@_author: Roger Dingledine 
@_subject: Dropping support for openssl 0.9.6? 
Hi folks,
We're thinking about dropping support in Tor for openssl 0.9.6.
(It appears that 0.9.6 was last patched in 2004, meaning it's probably
quite insecure now.)
Does anybody here still rely on it? Or do you know any common platforms
that do? Speak up now if this matters to you. :)
We'll probably do a two-stage deprecation, where in the first stage
new Tors refuse to build with it but still accept connections to/from
Tors that use it, and in the second stage we assume that it no longer
exists anywhere.

@_date: 2007-10-26 17:19:40
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.9-alpha is out 
This ninth development snapshot switches clients to the new v3 directory
system; allows servers to be listed in the network status even when they
have the same nickname as a registered server; and fixes many other bugs
including a big one that was causing some servers to disappear from the
network status lists for a few hours each day.
We've added Torbutton to the OS X bundles, so now the Windows and OS X
bundles include the new development Torbutton version 1.1.9.1. Bundle
users are encouraged to back up their Firefox settings before upgrading.
We also modified the default Privoxy config files in the bundles to
avoid some security problems, so make sure to leave "install Privoxy"
checked when you upgrade.
And last, we have a new URL:
Changes in version 0.2.0.9-alpha - 2007-10-24
  o Major features (directory system):
    - Clients now download v3 consensus networkstatus documents instead
      of v2 networkstatus documents. Clients and caches now base their
      opinions about routers on these consensus documents. Clients only
      download router descriptors listed in the consensus.
    - Authorities now list servers who have the same nickname as
      a different named server, but list them with a new flag,
      "Unnamed". Now we can list servers that happen to pick the same
      nickname as a server that registered two years ago and then
      disappeared. Partially implements proposal 122.
    - If the consensus list a router as "Unnamed", the name is assigned
      to a different router: do not identify the router by that name.
      Partially implements proposal 122.
    - Authorities can now come to a consensus on which method to use to
      compute the consensus. This gives us forward compatibility.
  o Major bugfixes:
    - Stop publishing a new server descriptor just because we HUP or
      when we find our DirPort to be reachable but won't actually publish
      it. New descriptors without any real changes are dropped by the
      authorities, and can screw up our "publish every 18 hours" schedule.
      Bugfix on 0.1.2.x.
    - When a router wasn't listed in a new networkstatus, we were leaving
      the flags for that router alone -- meaning it remained Named,
      Running, etc -- even though absence from the networkstatus means
      that it shouldn't be considered to exist at all anymore. Now we
      clear all the flags for routers that fall out of the networkstatus
      consensus. Fixes bug 529; bugfix on 0.1.2.x.
    - Fix awful behavior in DownloadExtraInfo option where we'd fetch
      extrainfo documents and then discard them immediately for not
      matching the latest router. Bugfix on 0.2.0.1-alpha.
  o Minor features (v3 directory protocol):
    - Allow tor-gencert to generate a new certificate without replacing
      the signing key.
    - Allow certificates to include an address.
    - When we change our directory-cache settings, reschedule all voting
      and download operations.
    - Reattempt certificate downloads immediately on failure, as long as
      we haven't failed a threshold number of times yet.
    - Delay retrying consensus downloads while we're downloading
      certificates to verify the one we just got.  Also, count getting a
      consensus that we already have (or one that isn't valid) as a failure,
      and count failing to get the certificates after 20 minutes as a
      failure.
    - Build circuits and download descriptors even if our consensus is a
      little expired. (This feature will go away once authorities are
      more reliable.)
  o Minor features (router descriptor cache):
    - If we find a cached-routers file that's been sitting around for more
      than 28 days unmodified, then most likely it's a leftover from
      when we upgraded to 0.2.0.8-alpha. Remove it. It has no good
      routers anyway.
    - When we (as a cache) download a descriptor because it was listed
      in a consensus, remember when the consensus was supposed to expire,
      and don't expire the descriptor until then.
  o Minor features (performance):
    - Call routerlist_remove_old_routers() much less often. This should
      speed startup, especially on directory caches.
    - Don't try to launch new descriptor downloads quite so often when we
      already have enough directory information to build circuits.
    - Base64 decoding was actually showing up on our profile when parsing
      the initial descriptor file; switch to an in-process all-at-once
      implementation that's about 3.5x times faster than calling out to
      OpenSSL.
  o Minor features (compilation):
    - Detect non-ASCII platforms (if any still exist) and refuse to
      build there: some of our code assumes that 'A' is 65 and so on.
  o Minor bugfixes (v3 directory authorities, bugfixes on 0.2.0.x):
    - Make the "next period" votes into "current period" votes immediately
      after publishing the consensus; avoid a heisenbug that made them
      stick around indefinitely.
    - When we discard a vote as a duplicate, do not report this as
      an error.
    - Treat missing v3 keys or certificates as an error when running as a
      v3 directory authority.
    - When we're configured to be a v3 authority, but we're only listed
      as a non-v3 authority in our DirServer line for ourself, correct
      the listing.
    - If an authority doesn't have a qualified hostname, just put
      its address in the vote. This fixes the problem where we referred to
      "moria on moria:9031."
    - Distinguish between detached signatures for the wrong period, and
      detached signatures for a divergent vote.
    - Fix a small memory leak when computing a consensus.
    - When there's no concensus, we were forming a vote every 30
      minutes, but writing the "valid-after" line in our vote based
      on our configured V3AuthVotingInterval: so unless the intervals
      matched up, we immediately rejected our own vote because it didn't
      start at the voting interval that caused us to construct a vote.
  o Minor bugfixes (v3 directory protocol, bugfixes on 0.2.0.x):
    - Delete unverified-consensus when the real consensus is set.
    - Consider retrying a consensus networkstatus fetch immediately
      after one fails: don't wait 60 seconds to notice.
    - When fetching a consensus as a cache, wait until a newer consensus
      should exist before trying to replace the current one.
    - Use a more forgiving schedule for retrying failed consensus
      downloads than for other types.
  o Minor bugfixes (other directory issues):
    - Correct the implementation of "download votes by digest." Bugfix on
      0.2.0.8-alpha.
    - Authorities no longer send back "400 you're unreachable please fix
      it" errors to Tor servers that aren't online all the time. We're
      supposed to tolerate these servers now. Bugfix on 0.1.2.x.
  o Minor bugfixes (controller):
    - Don't reset trusted dir server list when we set a configuration
      option. Patch from Robert Hogan; bugfix on 0.1.2.x.
    - Respond to INT and TERM SIGNAL commands before we execute the
      signal, in case the signal shuts us down. We had a patch in
      0.1.2.1-alpha that tried to do this by queueing the response on
      the connection's buffer before shutting down, but that really
      isn't the same thing at all. Bug located by Matt Edman.
  o Minor bugfixes (misc):
    - Correctly check for bad options to the "PublishServerDescriptor"
      config option. Bugfix on 0.2.0.1-alpha; reported by Matt Edman.
    - Stop leaking memory on failing case of base32_decode, and make
      it accept upper-case letters. Bugfixes on 0.2.0.7-alpha.
    - Don't try to download extrainfo documents when we're trying to
      fetch enough directory info to build a circuit: having enough
      info should get priority. Bugfix on 0.2.0.x.
    - Don't complain that "your server has not managed to confirm that its
      ports are reachable" if we haven't been able to build any circuits
      yet. Bug found by spending four hours without a v3 consensus. Bugfix
      on 0.1.2.x.
    - Detect the reason for failing to mmap a descriptor file we just
      wrote, and give a more useful log message.  Fixes bug 533. Bugfix
      on 0.1.2.x.
  o Code simplifications and refactoring:
    - Remove support for the old bw_accounting file: we've been storing
      bandwidth accounting information in the state file since
      0.1.2.5-alpha.  This may result in bandwidth accounting errors
      if you try to upgrade from 0.1.1.x or earlier, or if you try to
      downgrade to 0.1.1.x or earlier.
    - New convenience code to locate a file within the DataDirectory.
    - Move non-authority functionality out of dirvote.c.
    - Refactor the arguments for router_pick_{directory_|trusteddir}server
      so that they all take the same named flags.
  o Utilities
    - Include the "tor-ctrl.sh" bash script by Stefan Behte to provide
      Unix users an easy way to script their Tor process (e.g. by
      adjusting bandwidth based on the time of the day).

@_date: 2007-10-27 08:47:06
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.9-alpha is out 
Give us a few days to put out 0.1.2.18, and then I'll go into more
details beyond what phobos sent. :) They aren't earth-shattering issues,
unless you're trusting your privoxy to keep your anonymity for you --
which probably isn't a good idea in the first place. Use a modern Firefox
plus the dev version of Torbutton and you should be fine.
More news soon I hope,

@_date: 2007-10-27 17:46:33
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.9-alpha is out 
Hi Fabian,
Thanks for the bug report. I may have fixed it here:
If you could tweak your local copy of the code and see if that fixes
the crash for you, that would be great.
(This might also be totally the wrong fix. I'll let Nick take a look at
it too before 0.2.0.10-alpha comes out. :)

@_date: 2007-10-28 11:07:19
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.9-alpha is out 
Hi John,
While this does in fact sound like a Vidalia bug worth looking into
(and I'll let Matt tackle it), here's an answer to your other question
that you didn't realize you should ask. :)
Go into the Vidalia -> Settings -> Network and click on the box next to
"My ISP blocks connections to the Tor network", then save. Even if you
don't add any bridges, Tor will do some smart things internally.
You can get the same effect by setting
TunnelDirConns 1
in your torrc.
(But again, we haven't set this to be the default yet, because we don't
want to force steps in the arms race until we're ready for more steps.)
Hope that helps,

@_date: 2007-10-10 02:58:10
@_author: Roger Dingledine 
@_subject: Attacking the Tor Control Port with Java 
Fun stuff. I suspected something like this would be possible.
This is why all the Tor users out there should run Tor 0.1.2.17 (released
Aug 30 2007) or 0.2.0.6-alpha or later (released Aug 26 2007).
Let us know if you find an attack that works on these versions. :)
If you're running vulnerable versions of Java, you may well be screwed
for other reasons. Another good reason for us to get the dev version of
Torbutton into good shape.

@_date: 2007-09-16 19:19:23
@_author: Roger Dingledine 
@_subject: CN's nodes lookin' uncool, do they? 
Here's an alternative to the conspiracy theory:
Notice that many of the China nodes have the nickname 'Unnamed'. This
is what you'll get if you don't set a Nickname -- for example, if you
click the "turn me into a server" button in Vidalia. Also, you use the
default exit policy when you click that button in Vidalia.
It's already been established informally through other measurements
that we have tens of thousands of Tor users in China. So the alternative
theory is that a slightly larger (but still quite small) percentage of
Chinese users have chosen to click the button in Vidalia.
Nice stats pages!

@_date: 2007-09-17 19:23:43
@_author: Roger Dingledine 
@_subject: default exit policy (was Re: CN's nodes lookin' uncool, do they?) 
There are two reasons that Tor's default exit policy allows some
common ports rather than denying everything:
1) The activation energy to change one thing (becoming a server) is
already very high. We don't want to make it so people need to change
two separate things to be useful to the network.
2) I've talked to a lot of people over the years who say they're happy
to run the default exit policy -- whatever it is -- but they are not
willing to run anything more permissive than the default. This is
because their ISPs are fine with the default configuration ("well,
if that's what other people run") but are not fine with changes.
See also the earlier threads on this topic:
Now, part of our solution back in 2005 was to write a nice clear comment
in the torrc file so people knew what they were getting into. I agree
that we should work on making the "make me into a server" interface in
Vidalia provide some education too. (There is a similar issue if the
user doesn't realize he might want to click on the 'Bandwidth Limits'
tab to see what that's about.) Constructive suggestions?

@_date: 2007-09-18 02:26:54
@_author: Roger Dingledine 
@_subject: [ANNOUNCE] Incognito CD/USB 20070824.1 released 
Hi folks,
I've been absent the past few weeks, and it looks like the list has
gotten very, er, exciting in that short time. I'll try to bring a bit
more signal/noise ratio back to it now that I'm back.
Incognito, in this context, is the subject of this thread that you
are participating in:
People who are rude have to be extra-careful to be both correct and
useful; otherwise they just contribute to the problem. :(
As to whether user support for Incognito is on-topic for or-talk, let's
find out whether Pat wants to deal with it here, and whether it's one
user per month or hundreds.

@_date: 2007-09-19 01:07:18
@_author: Roger Dingledine 
@_subject: end-to-end encryption question 
Actually, this isn't true. "The local host" in this text is the same as
localhost. It is 127.0.0.1.
If your webserver rejects requests from 127.0.0.1, that's bad, and it
will break people trying to reach your website from your Tor server.
The reason for this is that many modern OSes look at the destination
(1.2.3.4), realize they've got a better route for that, and decide to
route it via 127.0.0.1.
(This might not be true for your favorite OS -- I'm not sure which OSes
have this behavior -- but in practice it's true for enough of them that
many people run into it.)
No, because Tor looks at the address (1.2.3.4) and your exit policy is
fine with it. It's only later, in the OS, that it gets switched over.
Yes, because then your exit policy rejects 1.2.3.4, and Tor clients
won't try to use you to exit to it.
Right, but note that you're going to have to bootstrap your first set of
directory information somehow. There is no simple procedure currently,
since we haven't seen the need for it yet.
Hope that helps,

@_date: 2007-09-19 22:43:41
@_author: Roger Dingledine 
@_subject: No-mail mode for this list 
The answer is that you should mail me and I'll whitelist your
address -- then you can post while not receiving mails.
Actually, I did answer. Here are some hints:
  Date: Wed, 19 Sep 2007 13:51:31 -0400
  From: arma at mit.edu (Roger Dingledine)
  To: "misc at mail333.com"   Cc: owner-or-talk at seul.org
  Subject: Re: No-mail mode
  Message-ID: <20070919175131.GU20777 at moria.seul.org>
Does anybody know how I can contact misc at mail333.com? :)
Hope that helps,

@_date: 2007-09-20 00:49:47
@_author: Roger Dingledine 
@_subject: No-mail mode for this list 
We're running mailman here too. One of the things I've been meaning to
do in my copious free time is move the Tor lists over.
Majordomo doesn't bother me much though, and you're roughly the second
person to ask for this feature, so I'm in no hurry compared to, say,
getting more Tor done. :)

@_date: 2007-09-22 15:06:37
@_author: Roger Dingledine 
@_subject: Load Balancing 
Actually, here's one reason why using circuits one by one rather than
all at once is good for performance and ultimately good for security.
Imagine you make five circuits preemptively. Scenario one is that you
use them one by one, discarding them and switching to a new one when the
current one becomes dirty (defined as "first used more than 10 minutes
ago"). Scenario two is that you use all five of them for fetching your
big web site, discarding them when they become dirty.
Now compare the two scenarios in terms of total number of circuits the
user needs to make over the course of a day.
Once upon a time, the value of "10 minutes" was actually more like 1
minute. You see, the shorter it is, the fewer actions from the user are
linkable with each other based on being in the same circuit. But Tor
server operaters complained they were using 100% cpu because they were
constantly handling new circuit creation requests. So we moved it back to
10 minutes -- bad for user security, but necessary to keep things working.
If the user started churning through circuits at five times the current
rate, we may end up forced to move the "10 minute" value back even farther
to compensate, resulting in even more user connections becoming linkable.
Now, this isn't the whole story. Maybe there are really
good security improvements that can be had by not fetching
the whole site over a single connection -- see e.g. item  on
 or (a more tenuous connection)
But on the third hand, see
Until somebody works through both the security issues and the performance
issues in a convincing way, we will likely just stick with the current

@_date: 2007-09-22 15:58:17
@_author: Roger Dingledine 
@_subject: Load Balancing 
It's because of the crypto. Each server on the path needs to do two
public key operations for each new circuit -- one to ensure perfect
forward secrecy, and the other for authentication.
See e.g.
or Section 5.1 of
If you still want to read after those, also see

@_date: 2007-09-22 19:46:10
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.7-alpha is out 
This seventh development snapshot makes bridges work again, makes bridge
authorities work for the first time, fixes two huge performance flaws
in hidden services, and fixes a variety of minor issues.
The Windows bundle also includes the new development Torbutton version
1.1.7, which clears cookies and disables a lot of other dangerous
web behavior:  Windows users are
encouraged to back up their Firefox settings before upgrading.
Changes in version 0.2.0.7-alpha - 2007-09-21
  o New directory authorities:
    - Set up moria1 and tor26 as the first v3 directory authorities. See
      doc/spec/dir-spec.txt for details on the new directory design.
  o Major bugfixes (crashes):
    - Fix possible segfaults in functions called from
      rend_process_relay_cell(). Bugfix on 0.1.2.x.
  o Major bugfixes (bridges):
    - Fix a bug that made servers send a "404 Not found" in response to
      attempts to fetch their server descriptor. This caused Tor servers
      to take many minutes to establish reachability for their DirPort,
      and it totally crippled bridges. Bugfix on 0.2.0.5-alpha.
    - Make "UpdateBridgesFromAuthority" torrc option work: when bridge
      users configure that and specify a bridge with an identity
      fingerprint, now they will lookup the bridge descriptor at the
      default bridge authority via a one-hop tunnel, but once circuits
      are established they will switch to a three-hop tunnel for later
      connections to the bridge authority. Bugfix in 0.2.0.3-alpha.
  o Major bugfixes (hidden services):
    - Hidden services were choosing introduction points uniquely by
      hexdigest, but when constructing the hidden service descriptor
      they merely wrote the (potentially ambiguous) nickname.
    - Clients now use the v2 intro format for hidden service
      connections: they specify their chosen rendezvous point by identity
      digest rather than by (potentially ambiguous) nickname. Both
      are bugfixes on 0.1.2.x, and they could speed up hidden service
      connections dramatically. Thanks to Karsten Loesing.
  o Minor features (security):
    - As a client, do not believe any server that tells us that an
      address maps to an internal address space.
    - Make it possible to enable HashedControlPassword and
      CookieAuthentication at the same time.
  o Minor features (guard nodes):
    - Tag every guard node in our state file with the version that
      we believe added it, or with our own version if we add it. This way,
      if a user temporarily runs an old version of Tor and then switches
      back to a new one, she doesn't automatically lose her guards.
  o Minor features (speed):
    - When implementing AES counter mode, update only the portions of the
      counter buffer that need to change, and don't keep separate
      network-order and host-order counters when they are the same (i.e.,
      on big-endian hosts.)
  o Minor features (controller):
    - Accept LF instead of CRLF on controller, since some software has a
      hard time generating real Internet newlines.
    - Add GETINFO values for the server status events
      "REACHABILITY_SUCCEEDED" and "GOOD_SERVER_DESCRIPTOR". Patch from
      Robert Hogan.
  o Removed features:
     - Routers no longer include bandwidth-history lines in their
       descriptors; this information is already available in extra-info
       documents, and including it in router descriptors took up 60%
       (!) of compressed router descriptor downloads. Completes
       implementation of proposal 104.
     - Remove the contrib scripts ExerciseServer.py, PathDemo.py,
       and TorControl.py, as they use the old v0 controller protocol,
       and are obsoleted by TorFlow anyway.
     - Drop support for v1 rendezvous descriptors, since we never used
       them anyway, and the code has probably rotted by now. Based on
       patch from Karsten Loesing.
     - On OSX, stop warning the user that kqueue support in libevent is
      "experimental", since it seems to have worked fine for ages.
  o Minor bugfixes:
    - When generating information telling us how to extend to a given
      router, do not try to include the nickname if it is absent. Fixes
      bug 467. Bugfix on 0.2.0.3-alpha.
    - Fix a user-triggerable (but not remotely-triggerable) segfault
      in expand_filename(). Bugfix on 0.1.2.x.
    - Fix a memory leak when freeing incomplete requests from DNSPort.
      Found by Niels Provos with valgrind. Bugfix on 0.2.0.1-alpha.
    - Don't try to access (or alter) the state file when running
      --list-fingerprint or --verify-config or --hash-password. (Resolves
      bug 499.) Bugfix on 0.1.2.x.
    - Servers used to decline to publish their DirPort if their
      BandwidthRate, RelayBandwidthRate, or MaxAdvertisedBandwidth
      were below a threshold. Now they only look at BandwidthRate and
      RelayBandwidthRate. Bugfix on 0.1.2.x.
    - Remove an optimization in the AES counter-mode code that assumed
      that the counter never exceeded 2^68. When the counter can be set
      arbitrarily as an IV (as it is by Karsten's new hidden services
      code), this assumption no longer holds. Bugfix on 0.1.2.x.
    - Resume listing "AUTHORITY" flag for authorities in network status.
      Bugfix on 0.2.0.3-alpha; reported by Alex de Joode.
  o Code simplifications and refactoring:
    - Revamp file-writing logic so we don't need to have the entire
      contents of a file in memory at once before we write to disk. Tor,
      meet stdio.
    - Turn "descriptor store" into a full-fledged type.
    - Move all NT services code into a separate source file.
    - Unify all code that computes medians, percentile elements, etc.
    - Get rid of a needless malloc when parsing address policies.

@_date: 2007-09-23 16:37:27
@_author: Roger Dingledine 
@_subject: Servers and the "Named" flag (was Re: time needed to register a serve) 
Alas, we've pretty much stopped assigning the Named flag to servers.
This is because it's a time-sink to manually go through and make sure
the server is actually acting correctly, go put the keys in the right
place, etc. There have been some proposals to make it easier, e.g.
and at some point we should do one of them. See also the discussion
under I'm a fan of solution  in the above url: there's no reason why a human
needs to be in the loop, and if we don't know the operator on the other
end, the "Named" flag doesn't mean what it meant in 2003 when we created
it anyway.
Once upon a time (2003 era), you needed to be manually approved or you
wouldn't be able to join the network. The primary reason was that we
needed to verify that your server was reachable, working, etc. Then
we got more than a dozen servers, including servers run by people we
didn't know, and we automated the process of testing reachability at the
directory authorities. Then we started to allow unnamed servers to join
the network and play pretty much the same role.
The only main difference at this point is from the client perspective:
if you manually specify a non-named server in your torrc or using the
foo.exit syntax, your Tor will complain to you (well, to your logs)
and suggest a hex digest that you should use instead.
Now, there is an argument for letting people remember nicknames rather
than hex digests. But I would eventually like to see some sort of
graphical "server picking" interface that most users would use, and it
would be smart enough to know the hex digest of the picked server. If,
that is, we need any sort of server picking to be happening at all --
most users I hear from who need to specify a specific server rather than
just let Tor pick for them seem to be doing it to get around crude access
controls on websites or other services, and I'm not sure that's an arms
race I want to get into.
There are other problems that need to be solved from a usability angle.
For example, if the nickname Alice picks is already registered, then when
she tries to sign up her server, it will print a mysterious message in her
logs ("there are logs? what's a log?") and her server won't be useful. We
need to make that simpler somehow, and the simplest approach for now
(by default) is to not have many Named servers. My preferred solution
would be to add an "Unnamed" flag that servers get when they're using a
nickname that is already registered -- the server will continue to be a
fine server, but it will be invisible from the perspective of referring
to servers by nickname.
And lastly, one of the crucial reasons for maintaining contact with server
operators is so they feel appreciated, and so we have an opportunity
to answer their questions, address their concerns and problems, etc.
Maintaining communication with the server community helps it to grow
and be stable. We are doing a poor job at that currently. A few years
ago I realized that I could choose between answering a whole lot
more mail (and having the number of good Tor servers keep going up)
and getting more development work done on Tor. Since Tor is nowhere
close to done, the latter was the clear choice -- as long as there
is *some* sort of Tor network, that's good enough for testing the new
scalability/anonymity/performance features and bugfixes.
Peter Palfrader then stepped up to answer mail for a while, but he
soon found it to be a flood too. My fix at the time was to modify
 to make it clearer that we
may not ever answer the mails. Maybe I should make the statement even
stronger, or just erase 'step four' entirely, until somebody sorts out
proposal 113 and implements and deploys a good solution.
I don't think getting a pile of volunteers to answer the mails is the
right answer -- we should instead a) work to take out the artificial
bottleneck (help appreciated! :), and b) figure out better ways to build
server operator community that don't involve as much manual attention
from me (help appreciated! :).

@_date: 2007-09-25 14:45:05
@_author: Roger Dingledine 
@_subject: "Rejecting truncated ESTABLISH_INTRO cell" warns 
Hi folks,
A number of server operators have been reporting seeing these lines
in their logs lately:
Sep 25 04:59:13.165 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Sep 25 05:31:56.838 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Sep 25 05:57:53.254 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Sep 25 06:28:13.560 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Sep 25 08:06:53.230 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Sep 25 08:28:56.614 [warn] Rejecting truncated ESTABLISH_INTRO cell.
Two notes:
A) This is not a problem with your server, it's a problem with a Tor
client somewhere behaving in a way we didn't expect. So there's no need
to shut down your server, worry about security issues from this, etc. :)
If the warnings continue, we'll make them quieter in the next release.
Which leads me to:
B) Somewhere in the world somebody is working on a new implementation
of Tor hidden services, but it's currently making malformed requests
when trying to set up introduction circuits. Perhaps even somebody on
this list. Let us know if you need help making it work. ;)

@_date: 2007-09-25 15:38:01
@_author: Roger Dingledine 
@_subject: Wikileaks and Tor (was Re: ESTABLISH_INTRO warns) 
We haven't heard from the Wikileaks people, nor have we reviewed their
supposed changes, if any. I would be happy to take a look at them if
they would like us to. From past experience with other random folks
on the Internet who either a) think they can make Tor better without
involving any of the Tor developers or designers, or b) think they can
make Tor better without telling anybody how they do it, they are very
likely to have made some critical mistakes.
See also

@_date: 2007-09-26 01:36:57
@_author: Roger Dingledine 
@_subject: Exit enclaves and FQDNs 
Right. But you don't really want to use your local DNS servers for
queries, because that's really bad for your anonymity.
But notice the new DNSPort feature -- if somebody figures out how to
bundle/configure it conveniently, it might grow in popularity a lot,
and it may do what you want:
Exactly so.
For those following along at home, you can read more about the "enclave"
design at
Alas, that's about right. It was the best compromise I could come up with:
we didn't want to always do a round-trip first just in case it matched
an enclave -- and in any case, even if we did, the vulnerability you
mention where the first guy you pick lies to you would remain.
Do you know of any decentralized secure cheat-proof way of turning
FQDN's into IP addresses? Sounds like we want DNSSec or whatever the
latest craze is called.

@_date: 2007-09-26 01:50:08
@_author: Roger Dingledine 
@_subject: Clone nodes 
The main different that comes to mind is that when users ask your router
to extend to another router, you could end up with redundant (duplicate)
connections to those other routers. So it would strain the number of
file descriptors each router needs to use, and many are already running
at their limits.
I don't think it would be catastrophic if you want to do it for testing.
In fact, once upon a time, we had a feature called "router twins"
that is exactly what you describe.  We were hoping it would provide
better robustness for a given server -- this was back in the day when we
were using actual onions to lay circuits, and envisioning actual reply
onions rather than the current rendezvous design, so there was a need
for servers to be around for hours or even days after you built an onion.
But it is mildly harmful, so please don't do it long-term in a widespread
It seems like a smarter move would be to teach Tor to load balance between
multiple Tor servers if they all share the IP address of the destination.
But see

@_date: 2007-09-28 15:59:42
@_author: Roger Dingledine 
@_subject: (FWD) Does your Tor controller use "setrouterpurpose"? 
FYI, for any Tor controller developers who aren't on or-dev.

@_date: 2008-04-12 23:34:33
@_author: Roger Dingledine 
@_subject: zero-knowledge protocols 
Ah! Finally a paragraph I understand.
For which I wrote a related FAQ entry earlier:
One day we'll write up a more clear and complete answer, but for now
the very short answer is "you can't do that." Math only goes so far when
confronted with real-world identity and humans.

@_date: 2008-04-16 16:07:57
@_author: Roger Dingledine 
@_subject: torsec exit behaves badly? 
Interesting. My first thought is that it's some Windows software that
intercepts port 80 traffic for the user and tries to sanitize his
browsing experience.
My second thought is that the user's ISP is trying to launch some sort
of attack on the user's browsing habits, e.g. like Phorm.
One of our google-summer-of-code projects is going to be looking at
automating exit relay scanning and giving real-time updates to the
directory authorities so they can notice and punt nodes like this. (Doing
it manually doesn't work very well, it turns out.)

@_date: 2008-04-20 17:39:20
@_author: Roger Dingledine 
@_subject: getting more exit nodes 
Well, in theory the "client-exit" nodes don't need to send their
descriptors to any users. They just need to have an association with
a Tor relay so the relay learns quickly when they're available. Then
the relay can advertise itself with the exit policy of the client-exit
node, and so long as it has some client-exits available whenever an exit
request shows up, it can pass it on.
Here are a few other things that would be useful to consider before we
can evaluate the idea:
- Bug 98. If you run too many connections through a Tor process on
  Windows, the OS will crash. We (meaning Nick) are slowly working on
  that, but it is not yet solved.
- Robert Hogan's questions in this thread are good to look at. In
  particular, does the relay actually advertise the client-exit's exit
  policy as its own?
- Need to consider load balancing. Right now users will choose the
  relay proportional to the bandwidth it advertises. But if it's a fast
  relay and the client-exit node is slow, the client-exit node will get
  overloaded and things will be even slower than they are now.
- Related to load balancing: how much additional latency are we talking
  about, from adding a fourth hop to the circuit? Because it would seem
  that you need four hops, since the "relay to client-exit" hop isn't
  adding much additional anonymity. (Or is it?)
- How is the crypto going to work between the relay node and the
  client-exit node? Are you planning to put a Tor process on the
  client-exit node, or were you just hoping to put a tiny proxy on it?
Probably there are more issues to explore after these.
Hope that helps,

@_date: 2008-04-22 22:55:36
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.24-rc 
Yeah. We're going to see a lot more threads like this over the next
several hours.
We added a new v3 authority, and dropped a dead one. That means the
current set of authorities doesn't agree enough about itself to produce
a new consensus networkstatus. That will continue to be the case until
enough of the current v3 authorities have upgraded. Which will happen,
uhm, sometime soon I hope. :)

@_date: 2008-04-23 20:34:08
@_author: Roger Dingledine 
@_subject: tor path length 
It's hard-coded. Part of the intuition for that is described here:
You can change it in the code -- look at the desired_path_len element.
We periodically hear from users who think Tor is great but it's too slow,
and they don't want that stupid anonymity stuff anyway, and if they
could just use it as a set of single-hop proxies they'd be happy.
Note that most Tor relays won't let you do one-hop paths, and that's a
security feature for the relay: to quote from the above FAQ entry,
"Currently there is no reason to suspect that investigating a single
relay will yield user-destination pairs, but if many people are using
only a single hop, we make it more likely that attackers will seize or
break into relays in hopes of tracing users."
Hope that helps,

@_date: 2008-04-25 02:59:03
@_author: Roger Dingledine 
@_subject: clock jump error persists into 0.2.0.25-rc 
We've changed a whole lot of code in the past 6 development releases. :)
Great. Can you try it on 0.2.0.20-rc? Then once you've established
whether that has the problem, can you binary search the svn releases
between those two development releases and narrow down further?
If you can get to the point of saying "I think it was one of these few
commits", then we'll be a lot closer.
Sorry for the continued troubles. :(

@_date: 2008-04-28 20:13:23
@_author: Roger Dingledine 
@_subject: [Fwd: ESA Foreign Notice (fwd)] 
This is one option -- force them to officially commit to something. The
problem there is that it involves getting a lot of people involved in
the decision, and many of those people are paid to say no to anything
confusing or at all risky. (I think the consensus here is that there
isn't much risk from some American corporation trying to hassle you
across national boundaries; but large organizations get very good at
saying no to every possible question.)
Another option is to not demand that they make any official statement, and
just try to educate the fellow you're talking to and slowly win advocates
and supporters before any official decision needs to be made. See e.g.

@_date: 2008-04-29 03:36:33
@_author: Roger Dingledine 
@_subject: [Fwd: ESA Foreign Notice (fwd)] 
Also a fine option in some cases. The goal is to figure out what's going
on their heads -- they probably don't actually care much, and they just
want some way to make this stuff not take much of their time. For example,
several Tor exit nodes at universities I've talked to know the people
who answer the abuse complaints, and they have an informal deal where
they just pass the abuse complaints on the Tor operators, who process
them as needed (in most cases this means ignoring them).
Technically speaking, this isn't quite true. Bittorrent can run on
whatever port the tracker and/or clients pick.
(Most of the Internet is slowly moving to port 80, as corporate and
government firewalls start to push people to put all their traffic there.)

@_date: 2008-04-03 17:11:19
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.22-rc is out 
Yeah. We assume you have some way around your firewall (e.g. open proxies,
friends, etc) but it's inconvenient and you don't want to use it all
the time. But hopefully it's enough to get Tor itself.
(We're looking into setting up a gmail autoresponder -- apparently gmail
messages can be 20 megabytes. Handy.)
Is that also true for Tor 0.2.0.23-rc?
If so, can you describe your firewall in more detail for us?

@_date: 2008-04-08 16:18:33
@_author: Roger Dingledine 
@_subject: problems with bridge-relay 
Well, the first problem is that you set yourself up as both a bridge
relay and a bridge directory authority. :)
You should take out the last two lines, if you want to be a bridge

@_date: 2008-03-31 22:20:53
@_author: Roger Dingledine 
@_subject: BOGUS AUTHORITY ALERT:  interesting cached-status/1A0999C05AE2B9A3CF474077F06060E91B3A847 file 
Calm down. Your Tor client doesn't care if other people claim to be
authorities. The authorities that you trust are hard-coded in config.c,
or they're in your torrc if you specify new DirServer lines (which
you shouldn't).
Your directory mirror will collect other v2 directory networkstatus
documents just in case other clients trust them as authorities and want
a copy. (For example, if we added a new authority to the list, but you
hadn't upgraded yet, it would be handy for your cache to cache the new
stuff too.)
Your client or cache probably got the bogus v2 networkstatus by going
to one of the caches and asking for "all" v2 networkstatuses. The bogus
ones will expire after a while.

@_date: 2008-08-17 02:02:52
@_author: Roger Dingledine 
@_subject: The "de-Tor-iorate Anonymity" talk by Nathan Evans at DEFCON 16 
Yep. I talked to Nate about it earlier that day, and also talked to
Christian (his advisor) beforehand.
Actually, Tor still allows this attack. In 0.2.1.3-alpha, we fixed most
of the problem:
    - Implement most of proposal 110: The first K cells to be sent
      along a circuit are marked as special "early" cells; only K "early"
      cells will be allowed. Once this code is universal, we can block
      certain kinds of DOS attack by requiring that EXTEND commands must
      be sent using an "early" cell.
but the current plan is to wait until 0.1.2.x and 0.2.0.x are obsolete
before doing the last step. That means the attack will still work for
the next 6-9 months.
The reasoning for why this delay is acceptable is that there are (alas)
plenty of other attacks we're still working on that might be just as
effective as this one.
Right. Note that in this particular version of the attack, they assumed
that the attacker runs the website and the exit relay, so they learn
the middle relay for free, and they're only aiming to uncover the entry
relay. The original attack (from 2005) just assumed that the attacker
runs the website. I bet this version could be adapted to find multiple
relays, but this particular paper didn't do that.
Also note that the attack turns Tor into a *network* of single-hop
proxies. If there's only one single-hop proxy, then it can be more readily
attacked than if there are 500 single-hop proxies and you don't know
which one your target will pick. It's a subtle distinction but still
one worth clarifying.
I think using 4 nodes in a circuit would foil this particular variation
of the attack, but adapting the attack to handle it wouldn't be so
hard. Using a variable number of nodes in the circuit could help though,
because the attacker wouldn't know how many matches they're hunting for.
As far as I know, the only analysis that has happened for this class of
attacks is building your own circuit (so you already know which relay is
the one you're supposed to find), then measuring the relays and showing
that the relay you were looking at scores high in terms of a match.
Nobody to my knowledge has done the analysis to measure them all and
look at false positives, false negatives, etc. That would be good to do.
(Actually, not til 0.2.1.x or 0.2.2.x probably)
Disabling javascript wouldn't do it, since the "generate a recognizable
signal" step could be done using refreshes, just a single large file
sent in a certain traffic pattern, or probably other ways.
Similarly, I don't think these would do it.
Good summary.

@_date: 2008-08-17 17:12:51
@_author: Roger Dingledine 
@_subject: DEFCON Presentations 
I hope to have the video up at some point too, but I don't think they've
finished it yet.

@_date: 2008-08-17 17:51:01
@_author: Roger Dingledine 
@_subject: MaxOnionsPending questions 
Usually relays are well under the 100 mark. The only cases I've seen in
practice where it happens are:
a) If the Tor relay doesn't have much cpu to spare, and it's advertising
   a really high bandwidth value.
b) If some client goes berserk and starts sending hundreds of create
   cells.
We don't have a good solution for "b" yet. Perhaps if our queue gets
large, we should ignore create cells from relays that have recently
sent too many?

@_date: 2008-08-18 18:04:24
@_author: Roger Dingledine 
@_subject: Confusion about TorButton, Noscript, etc. 
Right. This is important to remember -- using Tor without the new
Torbutton can expose you to anonymity-breaking (or, depending on your
behavior, at least anonymity-hurting) attacks.
Indeed. I use both Noscript and the new Torbutton. They work fine
together, in terms of usability. But I use Noscript to try to get some
handle on how I view the web -- not to protect me from evil people
running evil javascript on my browser.
The main thing to keep in mind while using both of them is that
unauthenticated connections can lie to you about who they are. So while
you can use Noscript to turn off *some* scripts from domains that aren't
whitelisted, you shouldn't deceive yourself into thinking that you are
using it to turn off *all* such scripts. A man-in-the-middle attack
(e.g. from an ISP or a Tor exit node) could trick your browser into
making a request for a domain that you've whitelisted in noscript,
and then you'd end up running scripts -- and if you are tricked well,
you won't even notice it happened.
I believe the reason Mike put a "don't use noscript" clause in is because
this is a pretty subtle distinction for most users, so they could easily
get a false sense of security. In particular, they might be thinking
"noscript is preventing any scripts from running unless I type in one
of the following domains", and this false (with or without Tor).

@_date: 2008-08-19 04:01:48
@_author: Roger Dingledine 
@_subject: Are different countries/areas entry+exit choseable? 
This isn't currently built in to Tor, though some controllers people
are working on can offer this approach.
The real problem though is that it's not just the location of the
relays. It's what ISPs your traffic goes through when travelling from
you to the Tor network, or between Tor relays, or from the Tor network
to your destination.
See for example
This is a worrisome and ongoing concern, but as far as I can tell,
just choosing your entry and exit relays by country doesn't solve it much.
"More research remains", as they say.

@_date: 2008-08-22 22:34:39
@_author: Roger Dingledine 
@_subject: [OT] Off-topic posts 
Right. Sorry for the troubles. I will now remove Roy from the list.

@_date: 2008-08-25 17:13:44
@_author: Roger Dingledine 
@_subject: [Fwd: [Fwd: Not getting copied my posts to or-talk]] 
You can also watch It gets updated in almost-real-time.

@_date: 2008-08-27 01:05:02
@_author: Roger Dingledine 
@_subject: Tor im wont play youtube vids. 
Check out item  on
Your options for now are either "stop wanting that", or change Torbutton's
config to allow plugins (but also open yourself up to potential privacy
We're working on some more usable approaches.

@_date: 2008-08-29 02:26:11
@_author: Roger Dingledine 
@_subject: Archive & email addresses 
I doubt anybody here runs mail4liste.de. It certainly isn't the
official Tor list archives. (And we did prune email addresses from the
archives.seul.org lists.)
Perhaps you should contact somebody at mail4liste.de to get them to do
so? If they refuse, I suppose I can unsubscribe the address.

@_date: 2008-08-08 05:11:22
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.4-alpha is out 
Tor 0.2.1.3-alpha implements most of the pieces to prevent infinite-length
circuit attacks (see proposal 110); fixes a bug that might cause exit
relays to corrupt streams they send back; allows address patterns
(e.g. 255.128.0.0/16) to appear in ExcludeNodes and ExcludeExitNodes
config options; and fixes a big pile of bugs. Tor 0.2.1.4-alpha fixes
a pair of crash bugs in 0.2.1.3-alpha.
Changes in version 0.2.1.4-alpha - 2008-08-04
  o Major bugfixes:
    - The address part of exit policies was not correctly written
      to router descriptors. This generated router descriptors that failed
      their self-checks. Noticed by phobos, fixed by Karsten. Bugfix
      on 0.2.1.3-alpha.
    - Tor triggered a false assert when extending a circuit to a relay
      but we already have a connection open to that relay. Noticed by
      phobos, fixed by Karsten. Bugfix on 0.2.1.3-alpha.
  o Minor bugfixes:
    - Fix a hidden service logging bug: in some edge cases, the router
      descriptor of a previously picked introduction point becomes
      obsolete and we need to give up on it rather than continually
      complaining that it has become obsolete. Observed by xiando. Bugfix
      on 0.2.1.3-alpha.
  o Removed features:
    - Take out the TestVia config option, since it was a workaround for
      a bug that was fixed in Tor 0.1.1.21.
Changes in version 0.2.1.3-alpha - 2008-08-03
  o Bootstrapping bugfixes (on 0.2.1.x-alpha):
    - Send a bootstrap problem "warn" event on the first problem if the
      reason is NO_ROUTE (that is, our network is down).
  o Major features:
    - Implement most of proposal 110: The first K cells to be sent
      along a circuit are marked as special "early" cells; only K "early"
      cells will be allowed. Once this code is universal, we can block
      certain kinds of DOS attack by requiring that EXTEND commands must
      be sent using an "early" cell.
  o Major bugfixes:
    - Try to attach connections immediately upon receiving a RENDEZVOUS2
      or RENDEZVOUS_ESTABLISHED cell. This can save a second or two
      on the client side when connecting to a hidden service. Bugfix
      on 0.0.6pre1. Found and fixed by Christian Wilms; resolves bug 743.
    - Ensure that two circuits can never exist on the same connection
      with the same circuit ID, even if one is marked for close. This
      is conceivably a bugfix for bug 779; fixes a bug on 0.1.0.4-rc.
  o Minor features:
    - When relays do their initial bandwidth measurement, don't limit
      to just our entry guards for the test circuits. Otherwise we tend
      to have multiple test circuits going through a single entry guard,
      which makes our bandwidth test less accurate. Fixes part of bug 654;
      patch contributed by Josh Albrecht.
    - Add an ExcludeExitNodes option so users can list a set of nodes
      that should be be excluded from the exit node position, but
      allowed elsewhere. Implements proposal 151.
    - Allow address patterns (e.g., 255.128.0.0/16) to appear in
      ExcludeNodes and ExcludeExitNodes lists.
    - Change the implementation of ExcludeNodes and ExcludeExitNodes to
      be more efficient. Formerly it was quadratic in the number of
      servers; now it should be linear. Fixes bug 509.
    - Save 16-22 bytes per open circuit by moving the n_addr, n_port,
      and n_conn_id_digest fields into a separate structure that's
      only needed when the circuit has not yet attached to an n_conn.
  o Minor bugfixes:
    - Change the contrib/tor.logrotate script so it makes the new
      logs as "_tor:_tor" rather than the default, which is generally
      "root:wheel". Fixes bug 676, reported by Serge Koksharov.
    - Stop using __attribute__((nonnull)) with GCC: it can give us useful
      warnings (occasionally), but it can also cause the compiler to
      eliminate error-checking code. Suggested by Peter Gutmann.
    - When a hidden service is giving up on an introduction point candidate
      that was not included in the last published rendezvous descriptor,
      don't reschedule publication of the next descriptor. Fixes bug 763.
      Bugfix on 0.0.9.3.
    - Mark RendNodes, RendExcludeNodes, HiddenServiceNodes, and
      HiddenServiceExcludeNodes as obsolete: they never worked properly,
      and nobody claims to be using them. Fixes bug 754. Bugfix on
      0.1.0.1-rc. Patch from Christian Wilms.
    - Fix a small alignment and memory-wasting bug on buffer chunks. Spotted
      by rovv.
  o Minor bugfixes (controller):
    - When closing an application-side connection because its circuit
      is getting torn down, generate the stream event correctly.
      Bugfix on 0.1.2.x. Anonymous patch.
  o Removed features:
    - Remove all backward-compatibility code to support relays running
      versions of Tor so old that they no longer work at all on the
      Tor network.

@_date: 2008-08-11 07:08:13
@_author: Roger Dingledine 
@_subject: tortila as a bad exit 
(I've been at defcon and black hat the past week, so have only been
peripherally watching the or-talk list.)
My impression from reading the posts is that tortila's craziness is
another instance of bug 779:
We're working on fixing it. This looks like a real bug, and a really
bad one at that. Marking all the exit nodes as badexit (which it looks
like we'd have to do by this metric) is going to make it harder to track
it down.
One of the next steps is to try to learn how to induce the bug. We're
working on that from several different angles.
Any help ya'll can provide would be useful. :)

@_date: 2008-12-10 02:10:49
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.8-alpha is out 
Tor 0.2.1.8-alpha fixes some crash bugs in earlier alpha releases,
builds better on unusual platforms like Solaris and old OS X, and fixes
a variety of other issues.
Changes in version 0.2.1.8-alpha - 2008-12-08
  o Major features:
    - New DirPortFrontPage option that takes an html file and publishes
      it as "/" on the DirPort. Now relay operators can provide a
      disclaimer without needing to set up a separate webserver. There's
      a sample disclaimer in contrib/tor-exit-notice.html.
  o Security fixes:
    - When the client is choosing entry guards, now it selects at most
      one guard from a given relay family. Otherwise we could end up with
      all of our entry points into the network run by the same operator.
      Suggested by Camilo Viecco. Fix on 0.1.1.11-alpha.
  o Major bugfixes:
    - Fix a DOS opportunity during the voting signature collection process
      at directory authorities. Spotted by rovv. Bugfix on 0.2.0.x.
    - Fix a possible segfault when establishing an exit connection. Bugfix
      on 0.2.1.5-alpha.
  o Minor bugfixes:
    - Get file locking working on win32. Bugfix on 0.2.1.6-alpha. Fixes
      bug 859.
    - Made Tor a little less aggressive about deleting expired
      certificates. Partial fix for bug 854.
    - Stop doing unaligned memory access that generated bus errors on
      sparc64. Bugfix on 0.2.0.10-alpha. Fix for bug 862.
    - Fix a crash bug when changing EntryNodes from the controller. Bugfix
      on 0.2.1.6-alpha. Fix for bug 867. Patched by Sebastian.
    - Make USR2 log-level switch take effect immediately. Bugfix on
      0.1.2.8-beta.
    - If one win32 nameserver fails to get added, continue adding the
      rest, and don't automatically fail.
    - Use fcntl() for locking when flock() is not available. Should fix
      compilation on Solaris. Should fix Bug 873. Bugfix on 0.2.1.6-alpha.
    - Do not mark smartlist_bsearch_idx() function as ATTR_PURE. This bug
      could make gcc generate non-functional binary search code. Bugfix
      on 0.2.0.10-alpha.
    - Build correctly on platforms without socklen_t.
    - Avoid potential crash on internal error during signature collection.
      Fixes bug 864. Patch from rovv.
    - Do not use C's stdio library for writing to log files. This will
      improve logging performance by a minute amount, and will stop
      leaking fds when our disk is full. Fixes bug 861.
    - Stop erroneous use of O_APPEND in cases where we did not in fact
      want to re-seek to the end of a file before every last write().
    - Correct handling of possible malformed authority signing key
      certificates with internal signature types. Fixes bug 880. Bugfix
      on 0.2.0.3-alpha.
    - Fix a hard-to-trigger resource leak when logging credential status.
      CID 349.
  o Minor features:
    - Directory mirrors no longer fetch the v1 directory or
      running-routers files. They are obsolete, and nobody asks for them
      anymore. This is the first step to making v1 authorities obsolete.
  o Minor features (controller):
    - Return circuit purposes in response to GETINFO circuit-status. Fixes
      bug 858.

@_date: 2008-12-11 12:30:28
@_author: Roger Dingledine 
@_subject: (FWD) [FoeBuD-News] Der NEUE PrivacyDongle: Unbeobachtet surfen mit Mac, Linux-Systemen und Windows 
Interesting. I wonder what exactly they ship on Mac and Linux, since our
current Tor Browser Bundle is mostly geared toward Windows.
----- Forwarded message from "FoeBuD e.V."  -----
Delivery-Date: Thu, 11 Dec 2008 12:25:26 -0500
Der NEUE PrivacyDongle:
Unbeobachtet surfen mit Mac, Linux-Systemen und Windows
Den ber?hmten Anonymisierungs-Stick namens PrivacyDongle des FoeBuD
gibt es endlich auch f?r Mac und Linux.
Wer nicht m?chte, dass ihm Wolfgang Sch?uble oder die Telekom beim
Surfen im Internet ?ber die Schulter guckt, kann das verhindern:
Computerfreaks benutzen dazu das kostenlose internationale
Anonymiserungsnetzwerk TOR. Mit dem PrivacyDongle, des FoeBuD e.V.,
ist das anonyme Surfen mit TOR f?r alle ganz einfach geworden:
PrivacyDongle in den USB-Port stecken, Software-Icon anklicken und
Was so einfach bisher nur auf Windowsrechnern klappte, l?uft nun auch
auf Macs und vielen Linux-Systemen. Und noch mehr: Wer zu Hause am Mac
arbeitet, kann unterwegs am Internetrechner des Hotels oder
Internetcaf? denselben PrivacyDongle ? und damit alle seine eigenen
Einstellungen und Lesezeichen nutzen.
Es gibt ihn als Last-Minute-Weihnachtsgeschenk online im
FoeBuD-Unterst?tzungsshop ( Wie immer werden alle
Gewinne f?r die inhaltliche Arbeit des FoeBuD e.V. (
genutzt. Der FoeBuD betreibt selbst einen TOR-Anonymisierungsserver.
Der neue PrivacyDongle des FoeBuD ist vollst?ndig ?berarbeitet worden
und kommt in einem neuen (Hardware-)Gewand daher. Der PrivacyDongle
ist ein vom FoeBuD modifizierter FireFox-Browser. Er l?uft auf allen
g?ngigen Betriebssystemen: und zwar nicht in getrennten Versionen,
sondern er kann nacheinander auf allen benutzt werden - die ?nderungen
bei den Einstellungen wandern mit. Au?erdem ist er auf den Firefox 3
aktualisiert worden und beinhaltet mehrere praktische Erweiterungen,
die die Nutzung des TOR-Anonymisierungsnetzwerks erleichtern, sich um
weitere Aspekte von Sicherheit und Anonymit?t k?mmern, Werbung
blockieren und der Datensammelwut von Google Grenzen setzen. Nicht
zuletzt haben wir dem Browser die M?glichkeit gegeben, in vielen
Sprachen zu arbeiten und bieten unsere Erweiterungen und Hilfetexte in
deutsch, englisch und franz?sisch an.
Seit Anfang 2008 sind die Telekommunikationsabieter in Deutschland
dazu verpflichtet, die Verkehrsdaten ihrer Kunden f?r 6 Monate zu
speichern. Auf diese Weise kann nachvollzogen werden, wer mit wem per
Telefon oder Internet Kontakt aufgenommen hat. Diese Ma?nahme betrifft
eben nicht Terroristen, sondern 80 Millionen unbescholtene B?rgerinnen
und B?rger in Deutschland. Der FoeBuD e.V. engagiert sich seit langem
gegen die Vorratsdatenspeicherung, denn diese ist eine Bedrohung f?r
unsere Demokratie. Deswegen hat der FoeBuD mit dem "PrivacyDongle" ein
Werkzeug geschaffen, das das anonyme Surfen auch f?r technisch nicht
so bewanderte Menschen einfach m?glich macht.
Den "PrivacyDongle" gibt es ab 20 Euro (je nach Speicherkapazit?t des
USB-Sticks, 1GB, 4GB, 8GB) im FoeBuD-Shop zu kaufen:
?brigens: Der FoeBuD-Shop wird ehrenamtlich betrieben, alle Einnahmen
kommen der Arbeit des FoeBuD zugute. Der FoeBuD betreibt einen eigenen
Freundliche Gr??e
FoeBuD e.V.

@_date: 2008-12-11 14:14:08
@_author: Roger Dingledine 
@_subject: Do Tor options FascistFirewall and ReachableAddresses have anything to do with each other? 
"FascistFirewall 1" is a shorthand for "ReachableORAddresses *:443,
ReachableDirAddresses *:80".
If you want to be more fine-grained, use Reachable*Addresses. If you
want to be quick and it does what you want, use FascistFirewall.

@_date: 2008-12-11 17:40:24
@_author: Roger Dingledine 
@_subject: How many hidden service circuits built? 
It should try to reuse the same circuit.
(You will see a bunch of circuits going to make the rendezvous happen, but
only one of them will be the one that all your streams get connected to.)

@_date: 2008-12-03 16:00:11
@_author: Roger Dingledine 
@_subject: Exceeding connection limit 
See  at Basically your Tor relay has over 1000 connections open. Given that
there are 1500 other relays, and 100000+ Tor clients running right now,
that's not hard to reach.
If you were using the Tor deb, it would solve this step for you. :)

@_date: 2008-12-03 16:04:18
@_author: Roger Dingledine 
@_subject: Exceeding connection limit 
[Forwarding because John isn't subscribed at this address. Here's a more
detailed version of what I said in my other post. -RD]

@_date: 2008-12-14 13:26:25
@_author: Roger Dingledine 
@_subject: SSH and Telnet ports 
There are a variety of different attackers that a Tor user might be
concerned about. "Anonymity with respect to the destination" is what
you're thinking about above. But you might also want "anonymity with
respect to eavesdroppers" -- so you can prevent somebody watching your
local network connection from discovering where you're connecting to, or
somebody watching the ssh server from discovering your current location.
So it makes perfect sense to have both anonymity from eavesdroppers and
strong authentication to the destination.
That said, feel free to take out ports 21 and 22 from your exit policy
if they make you uncomfortable.

@_date: 2008-12-16 18:44:58
@_author: Roger Dingledine 
@_subject: Failed to hand off onionskin 
This warning happens when you have more than 100 create cells queued
for processing, so presumably your CPU isn't able to keep up with them.
Well, step one is to set
NumCPUs 2
but I think you already did that.
Assuming you're referring to the relay "Arlequin", this is a very fast
relay, so you will be running up against various constraints that not
many people hit.
We have a todo item to make Tor better on using multiple CPUs. See
"Handle multi-core cpus better" at
But the case of decrypting onion requests (aka create cells) is actually
the part where we do best already at using multiple CPUs.
An amd64 cpu is a good start, since Tor's crypto is much faster on 64-bit.
How much ram is Tor using? If it's a lot, you might consider the -alpha
versions, as on some platforms they use much less ram.

@_date: 2008-12-24 18:58:17
@_author: Roger Dingledine 
@_subject: Tor's three-year development roadmap 
Hi folks,
I've finally finished writing up our three-year development roadmap. This
document describes Tor research and development items that should happen
on a three-year timeframe to move Tor forward at being both a useful
circumvention tool and a useful privacy tool:
We've got enough funding to get good starts on many of the items in
the roadmap (more detail on that coming soon), but of course we could
use some more to get even further. So if you know anybody interested in
these topics, please let them know -- and let us know. :)
While The Tor Project makes sure to do a great job at being transparent
in our research and design discussions and outcomes ("how Tor works and
why" from the researcher perspective), we haven't done as good a job
lately at being transparent to our *users* about what we're working on,
what we hope to work on next, who's working on what, etc. Hopefully this
pdf will help change that.
Andrew also produced an actual press release for us, so we can become more
press friendly and provide a way for the media to start a conversation
with us:
You may also be interested to follow the more detailed TODO list I've
been maintaining to help keep all the developers coordinated:

@_date: 2008-12-24 19:26:21
@_author: Roger Dingledine 
@_subject: No Tor server exists that allows exit to ... 
I assume you're setting "ExitPolicyRejectPrivate 0" in your relay's torrc?
Are we talking about port 80, or some other port?
Ought to work (assuming the relay's exit policy allows the connection,
and assuming the relay stays up the directory authorities consider
it reachable).
The next step would be to take a debug-level log from the client's
perspective, and put it up on a website somewhere and we can look through
it to see what's going on. If you do this, be sure to be using the recent
development code (either 0.2.1.8-alpha or svn trunk).

@_date: 2008-12-04 00:10:11
@_author: Roger Dingledine 
@_subject: Exceeding connection limit 
Note that this is the *minimum* number. Basically the config option is
not useful in this case. (Or most other cases.)
Alas, right now the Tor design assumes that all relays can reach all other
relays. Since clients choose paths randomly, and there are roughly 100
times more clients than there are relays, then pretty much every link
is going to be in use.
There are some research directions for "restricted route topologies",
but they still have some hard challenges. One of the little ones is how
to grow the topology such that it maintains small-worlds properties
as new relays join and old relays disappear. One of the big ones is
communicating the topology to the clients in an efficient way, so they
can know which links they're allowed to use. Another big one is analyzing
how much anonymity we lose by making route selection more predictable --
done right we shouldn't lose much, but I'd need to work out a lot more
details before really believing it.
The more long-term solution for this is to switch to UDP transport between
relays. Done right, that basically means a few sockets would handle all
the TLS connections (well, DTLS then), and Tor would get a lot smarter
about handling the multiplexing between conversations internally. The
proposals you've seen on here from Joel Reardon and from Camilo Viecco
would move us in that direction.

@_date: 2008-12-28 22:49:11
@_author: Roger Dingledine 
@_subject: Tor-Bridge: DirPort unreachable 
It's a bug. It's been on my todo list for many months now. It's a
harmless bug, so I haven't gotten around to it.
For now, you can solve it by turning your DirPort off (bridges don't
use dirports). Else continue being patient. :)

@_date: 2008-12-04 12:08:58
@_author: Roger Dingledine 
@_subject: Tor bridges email discovery... 
Earlier today there was a commit from Jake:
with the phrase "some fixes / improvements and is lightly broken :)".
That might be our hint. I'll let Jake follow-up with more details.

@_date: 2008-12-02 17:52:32
@_author: Roger Dingledine 
@_subject: tor-0.2.0.32 doesn't compile on Solaris? 
Fixed in svn. It should be resolved for 0.2.1.8-alpha and 0.2.0.33
(whenever they came out).

@_date: 2008-12-06 02:07:54
@_author: Roger Dingledine 
@_subject: [python] __LeaveStreamsUnattached 
Sounds like you either want to 1) use multiple threads (one to do the
connect, and one to listen to Tor controller events and assign the stream
to the circuit) or to 2) make your connect non-blocking and then listen
to controller events and assign the stream to the circuit and then go
back to see if the connect() has finished.
I think the more usual approach is (There is no way to learn the streamid before starting the connect(),
since there is no stream, so Tor hasn't picked a number for it yet.)

@_date: 2008-02-09 10:39:46
@_author: Roger Dingledine 
@_subject: another unusual connection 
Ok. Now that I've had a moment with a real Internet, I've confirmed
  $ telnet 212.112.242.159 80
  Trying 212.112.242.159...
  Connected to 212.112.242.159.
  Escape character is '^]'.
  GET /tor/ HTTP/1.0
  HTTP/1.0 200 OK
  Date: Sat, 09 Feb 2008 10:28:32 GMT
  Content-Type: text/plain
  X-Your-Address-Is: 212.112.242.159
  Content-Encoding: identity
  Content-Length: 820
  Expires: Sat, 09 Feb 2008 11:28:32 GMT
Thanks to a patch submitted by "Andrew S. Lists", this particular issue
will be fixed in the upcoming 0.2.0.19-alpha release.

@_date: 2008-02-01 19:28:34
@_author: Roger Dingledine 
@_subject: Odd behavior: same entry/exit node + more 
Tor makes sure that no circuit has the same entry and exit node. But one
circuit could have a given node as its entry node, and another circuit
could have that same node as its exit node. This shouldn't present much
danger -- and in fact *not* allowing it would reduce your anonymity
by further reducing the set of possible nodes you might be picking at
each point.
As for the speed increase, I am betting that was coincidence, at least
until you give more hints. :)
To load balance efficiently, Tor picks its exit nodes proportional to the
bandwidth they claim to have (with a cap to prevent any single node from
lying too much). There really aren't that many really fast exit nodes
right now. I haven't counted them recently; ten seems on the low end,
but not outrageously low.
See also Depends. Do you have any more info?
My guess is that you're running some Windows program that leaves out all
the details and tries to make you alarmed at every packet. For example,
perhaps it's sending ICMP unreachable packets at you, which are being
interpreted as pings. "Attempts to access my system" sounds like you're
quoting out of one of these dumb programs.
Are you running a local firewall (hardware or software) that limits what
outgoing addresses or ports you can reach? Or is your net connection
flaky or slow?

@_date: 2008-02-01 19:47:34
@_author: Roger Dingledine 
@_subject: Not using slow circuits (was Re: Tor slow no matter what I do.) 
Right. I think it was the Foxtor folks at CMU who first suggested the
idea of measuring latency of a circuit once it's built (or measuring
time to build a circuit) and dropping circuits that are "too slow".
There are two problems with just doing it via CircuitBuildTimeout
a) If many people do this, and if a high fraction of circuits are judged
inadequate, then we're really pumping up the amount of cpu work that
each node needs to do -- and it's all wasted work too. Servers aren't
quite on the edge of being overloaded anymore these days, since we raised
the circuit rotation period to 10 minutes a few years ago. But I already
feel that 10 minutes is too high, and if we have to raise it any higher
because people are DoSing the servers with public key operations, that
would be bad. Consider the extreme where all the servers get overloaded
by this denial of service attack, and all the clients keep giving up
and starting again after just a few seconds, causing even more load,
causing even more clients to give up and start again, ...
b) People on slow networks will never establish a circuit with a low
default. If you're on a modem, your local network connection is otherwise
full or slow, or your net connection is lossy, then you sometimes need
the whole minute just to get enough cells back and forth.
What about a design where the client keeps a rolling record of recent
circuit build times it's seen, and discards circuits that take more
than the 75th percentile? Or 90%, or first standard dev, or whatever
is good. Perhaps Mike or Kevin/Damon have stats on the distribution of
circuit build times? :)
(It's unclear what anonymity impact this might have, but it might be
substantial: if a lot of our potential paths through the network involve
a slow link, and we discard all those potential paths, that would make
a big difference. On the other hand, that's exactly the point.)

@_date: 2008-02-11 00:42:06
@_author: Roger Dingledine 
@_subject: another unusual connection 
Is it actually being a bad exit with respect to any content?
My guess is that it's doing a proxypass from its apache on port 80 to
whatever port Tor is running on locally, and Tor is getting confused
about what IP address to report, because all the addresses *it* sees
are coming from the apache server.
I just checked in another patch that will reduce instances of this in
the future, even for relays that haven't upgraded yet:
(There probably *are* a few malicious Tor operators out there somewhere,
but in general many of the issues people tend to raise on this list can be
more easily explained by bugs, misconfigurations, or other confusion. I've
met the fellow who runs maximator, and he's been running Tor servers
since 2005. He seems like a nice enough guy.)

@_date: 2008-02-11 00:47:14
@_author: Roger Dingledine 
@_subject: another unusual connection 
I think you're confusing the IP address guessing with the reachability
The IP address guessing is known to be not perfect. I mean, heck, it's
based on plaintext unauthenticated claims from some dude running a Tor
relay somewhere in the world. But in general it's quite a bit better
than nothing, which was the previous option.
(Once we have our netinfo cells up and running, we may be able to make
it encrypted and authenticated. Which will help a little bit.)
The reachability detection is also known to not be perfect. It just has
to weed out most of the problems and the directory authorities can then
test the rest.
"Submit a patch."

@_date: 2008-02-11 22:36:51
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.19-alpha is out 
Tor 0.2.0.19-alpha makes more progress towards normalizing Tor's TLS
handshake, makes path selection for relays more secure and IP address
guessing more robust, and generally fixes a lot of bugs in preparation
for calling the 0.2.0 branch stable.
Changes in version 0.2.0.19-alpha - 2008-02-09
  o Major features:
    - Do not include recognizeable strings in the commonname part of
      Tor's x509 certificates.
  o Major bugfixes:
    - If we're a relay, avoid picking ourselves as an introduction point,
      a rendezvous point, or as the final hop for internal circuits. Bug
      reported by taranis and lodger. Bugfix on 0.1.2.x.
    - Patch from "Andrew S. Lists" to catch when we contact a directory
      mirror at IP address X and he says we look like we're coming from
      IP address X. Bugfix on 0.1.2.x.
  o Minor features (security):
    - Be more paranoid about overwriting sensitive memory on free(),
      as a defensive programming tactic to ensure forward secrecy.
  o Minor features (directory authority):
    - Actually validate the options passed to AuthDirReject,
      AuthDirInvalid, AuthDirBadDir, and AuthDirBadExit.
    - Reject router descriptors with out-of-range bandwidthcapacity or
      bandwidthburst values.
  o Minor features (controller):
    - Reject controller commands over 1MB in length.  This keeps rogue
      processes from running us out of memory.
  o Minor features (misc):
    - Give more descriptive well-formedness errors for out-of-range
      hidden service descriptor/protocol versions.
    - Make memory debugging information describe more about history
      of cell allocation, so we can help reduce our memory use.
  o Deprecated features (controller):
    - The status/version/num-versioning and status/version/num-concurring
      GETINFO options are no longer useful in the v3 directory protocol:
      treat them as deprecated, and warn when they're used.
  o Minor bugfixes:
    - When our consensus networkstatus has been expired for a while, stop
      being willing to build circuits using it. Fixes bug 401. Bugfix
      on 0.1.2.x.
    - Directory caches now fetch certificates from all authorities
      listed in a networkstatus consensus, even when they do not
      recognize them. Fixes bug 571. Bugfix on 0.2.0.x.
    - When connecting to a bridge without specifying its key, insert
      the connection into the identity-to-connection map as soon as
      a key is learned. Fixes bug 574. Bugfix on 0.2.0.x.
    - Detect versions of OS X where malloc_good_size() is present in the
      library but never actually declared. Resolves bug 587. Bugfix
      on 0.2.0.x.
    - Stop incorrectly truncating zlib responses to directory authority
      signature download requests. Fixes bug 593. Bugfix on 0.2.0.x.
    - Stop recommending that every server operator send mail to tor-ops.
      Resolves bug 597. Bugfix on 0.1.2.x.
    - Don't trigger an assert if we start a directory authority with a
      private IP address (like 127.0.0.1).
    - Avoid possible failures when generating a directory with routers
      with over-long versions strings, or too many flags set. Bugfix
      on 0.1.2.x.
    - If an attempt to launch a DNS resolve request over the control
      port fails because we have overrun the limit on the number of
      connections, tell the controller that the request has failed.
    - Avoid using too little bandwidth when our clock skips a few
      seconds. Bugfix on 0.1.2.x.
    - Fix shell error when warning about missing packages in configure
      script, on Fedora or Red Hat machines. Bugfix on 0.2.0.x.
    - Do not become confused when receiving a spurious VERSIONS-like
      cell from a confused v1 client.  Bugfix on 0.2.0.x.
    - Re-fetch v2 (as well as v0) rendezvous descriptors when all
      introduction points for a hidden service have failed. Patch from
      Karsten Loesing. Bugfix on 0.2.0.x.
  o Code simplifications and refactoring:
    - Remove some needless generality from cpuworker code, for improved
      type-safety.
    - Stop overloading the circuit_t.onionskin field for both "onionskin
      from a CREATE cell that we are waiting for a cpuworker to be
      assigned" and "onionskin from an EXTEND cell that we are going to
      send to an OR as soon as we are connected". Might help with bug 600.
    - Add an in-place version of aes_crypt() so that we can avoid doing a
      needless memcpy() call on each cell payload.

@_date: 2008-02-13 22:38:43
@_author: Roger Dingledine 
@_subject: directory server 
We could use some more, it's true. But we need to make sure that the
people who run them are well-known as being useful contributors to the
Tor community and also as being honest people with good common sense.
I wrote a little bit more here:
So I'd suggest that the first step would be to get involved in the Tor
community (IRC, mailing lists, etc), and then to get involved in the
security community (including physically meeting people at conferences
like CCC, Black Hat, Shmoocon, etc).

@_date: 2008-02-14 06:47:27
@_author: Roger Dingledine 
@_subject: OSI 1-3 attack on Tor? in it.wikipedia 
They are signed. Also, people ought to use https, not http, for the Tor
website -- which we hope takes more than a little effort to fake.

@_date: 2008-02-16 01:43:02
@_author: Roger Dingledine 
@_subject: Compromised entry guards rejecting safe circuits (was Re: OSI 1-3 attack on Tor? in it.wikipedia) 
(I changed the thread's Subject, since "Anon Mus"'s attack is not the
same as the attack described on it.wikipedia.)
I agree with others here that this particular item from Anon Mus is
bogus. The math simply doesn't work this way: 1024 bits is really big,
and enumerating and storing products of 512ish-bit primes is going to
fill up your disk way before you have a non-trivial fraction of them.
Probably the reason they all misinterpreted your attack is the thread
you posted it in (which describes a similar-sounding attack that *is*
bogus), plus the above "A.3" which sounds like it's straight out of some
conspiracy theory.
Now that we've cleared that up (if we have), let me rephrase your attack
and we can see if it makes sense to more people here.
Imagine an adversary who can observe any connection attempt from Alice
and fail any of them that he wants. Imagine this adversary also runs, say,
10% of the Tor network, including some guard nodes and some exit nodes.
Alice starts up, learns about the Tor network, picks her entry guards, and
tries to connect to some. Our adversary keeps tricking her into thinking
she picked bad nodes, until she picks an adversary-controlled entry guard.
Then he lets all connections to that entry guard succeed, but when Alice
picks a second hop that isn't adversary-controlled, he claims that next
hop is down. Until eventually he picks an adversary-controlled second
hop. Repeat for the exit node.
Ignoring bandwidth weightings, exit policies, etc, Alice would need to
try (.1*.1)^-1 = an estimated 100 circuits before she makes three bad
hops (assuming she's already happened across the bad entry guard). For
a more reasonable 1% of the network being bad, that changes to 10000
circuit rebuilds.
See  for a related paper here.
Mike Perry also brought up an attack like this when he was working on
SoaT. Alas (or perhaps fortunately), he's been working on Torbutton-dev
lately instead. The number of competent anonymity programmers and
designers in the world is still woefully small.
Note that to make this attack work, you really do need to be able to
reject any connection from Alice that you want. Otherwise, if she picks
some bad guards and some good guards, she'll switch to using her good
guards as soon as the bad guards demonstrate themselves to be flaky. And
if you're in that powerful a position for Alice, I'm not too worried
about this attack; or to say it differently, I worry a lot about other
attacks too, and I'm not sure I can help Alice much.

@_date: 2008-02-20 17:34:31
@_author: Roger Dingledine 
@_subject: many scrubbed connections on tor relay running v0.2.0.19-alpha (r13450) 
If you want to get a bit more info, set
  SafeLogging 0
in your torrc. Then you'll learn what it's connecting to. My guess is
that it's doing a reachability test on its own DirPort. But I really
don't know.
Once SafeLogging is off, be more careful with your logs (e.g., if it
looks like an actual user connection, don't post it). And be sure to
turn it back on again when you're done debugging.

@_date: 2008-02-22 16:31:12
@_author: Roger Dingledine 
@_subject: Tor relay shutted down by ISP 
That part at least has an easy explanation: like all other large
organizations, xs4all is made up of many different people, and most of
them are just there to do their job. There are probably a few people at
xs4all who really like Tor, a few who really hate it, and the rest are
in between depending on all sorts of factors (like whether they've had
their coffee yet that day).
So rather than saying "it puzzles me that xs4all acted like that", it
might be better phrased as "it puzzles me that one person at xs4all
acted like that", and then it becomes less puzzling.

@_date: 2008-02-24 01:48:49
@_author: Roger Dingledine 
@_subject: Binding Tor to Pseudo-Interface 
One approach would be to add a line
  reject 64.233.189.0/24:80
to your exit policy.
Then you allow port 80 for most destinations but not for some of the
Google services. It's not quite the ideal solution, but it's not a
bad one.

@_date: 2008-02-25 22:11:14
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.20-rc is out 
Tor 0.2.0.20-rc is the first release candidate for the 0.2.0 series. It
makes more progress towards normalizing Tor's TLS handshake, makes
hidden services work better again, helps relays bootstrap if they don't
know their IP address, adds optional support for linking in openbsd's
allocator or tcmalloc, allows really fast relays to scale past 15000
sockets, and fixes a bunch of minor bugs reported by Veracode.
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.0.20-rc - 2008-02-24
  o Major features:
    - Enable the revised TLS handshake based on the one designed by
      Steven Murdoch in proposal 124, as revised in proposal 130. It
      includes version negotiation for OR connections as described in
      proposal 105. The new handshake is meant to be harder for censors
      to fingerprint, and it adds the ability to detect certain kinds of
      man-in-the-middle traffic analysis attacks. The version negotiation
      feature will allow us to improve Tor's link protocol more safely
      in the future.
    - Choose which bridge to use proportional to its advertised bandwidth,
      rather than uniformly at random. This should speed up Tor for
      bridge users. Also do this for people who set StrictEntryNodes.
    - When a TrackHostExits-chosen exit fails too many times in a row,
      stop using it. Bugfix on 0.1.2.x; fixes bug 437.
  o Major bugfixes:
    - Resolved problems with (re-)fetching hidden service descriptors.
      Patch from Karsten Loesing; fixes problems with 0.2.0.18-alpha
      and 0.2.0.19-alpha.
    - If we only ever used Tor for hidden service lookups or posts, we
      would stop building circuits and start refusing connections after
      24 hours, since we falsely believed that Tor was dormant. Reported
      by nwf; bugfix on 0.1.2.x.
    - Servers that don't know their own IP address should go to the
      authorities for their first directory fetch, even if their DirPort
      is off or if they don't know they're reachable yet. This will help
      them bootstrap better. Bugfix on 0.2.0.18-alpha; fixes bug 609.
    - When counting the number of open sockets, count not only the number
      of sockets we have received from the socket() call, but also
      the number we've gotten from accept() and socketpair(). This bug
      made us fail to count all sockets that we were using for incoming
      connections. Bugfix on 0.2.0.x.
    - Fix code used to find strings within buffers, when those strings
      are not in the first chunk of the buffer. Bugfix on 0.2.0.x.
    - Fix potential segfault when parsing HTTP headers. Bugfix on 0.2.0.x.
    - Add a new __HashedControlSessionPassword option for controllers
      to use for one-off session password hashes that shouldn't get
      saved to disk by SAVECONF --- Vidalia users were accumulating a
      pile of HashedControlPassword lines in their torrc files, one for
      each time they had restarted Tor and then clicked Save. Make Tor
      automatically convert "HashedControlPassword" to this new option but
      only when it's given on the command line. Partial fix for bug 586.
  o Minor features (performance):
    - Tune parameters for cell pool allocation to minimize amount of
      RAM overhead used.
    - Add OpenBSD malloc code from phk as an optional malloc
      replacement on Linux: some glibc libraries do very poorly
      with Tor's memory allocation patterns. Pass
      --enable-openbsd-malloc to get the replacement malloc code.
    - Add a --with-tcmalloc option to the configure script to link
      against tcmalloc (if present). Does not yet search for
      non-system include paths.
    - Stop imposing an arbitrary maximum on the number of file descriptors
      used for busy servers. Bug reported by Olaf Selke; patch from
      Sebastian Hahn.
  o Minor features (other):
    - When SafeLogging is disabled, log addresses along with all TLS
      errors.
    - When building with --enable-gcc-warnings, check for whether Apple's
      warning "-Wshorten-64-to-32" is available.
    - Add a --passphrase-fd argument to the tor-gencert command for
      scriptability.
  o Minor bugfixes (memory leaks and code problems):
    - We were leaking a file descriptor if Tor started with a zero-length
      cached-descriptors file. Patch by freddy77; bugfix on 0.1.2.
    - Detect size overflow in zlib code. Reported by Dan Kaminsky.
    - We were comparing the raw BridgePassword entry with a base64'ed
      version of it, when handling a "/tor/networkstatus-bridges"
      directory request. Now compare correctly. Noticed by Veracode.
    - Recover from bad tracked-since value in MTBF-history file.
      Should fix bug 537.
    - Alter the code that tries to recover from unhandled write
      errors, to not try to flush onto a socket that's given us
      unhandled errors. Bugfix on 0.1.2.x.
    - Make Unix controlsockets work correctly on OpenBSD. Patch from
      tup. Bugfix on 0.2.0.3-alpha.
  o Minor bugfixes (other):
    - If we have an extra-info document for our server, always make
      it available on the control port, even if we haven't gotten
      a copy of it from an authority yet. Patch from mwenge.
    - Log the correct memory chunk sizes for empty RAM chunks in mempool.c.
    - Directory mirrors no longer include a guess at the client's IP
      address if the connection appears to be coming from the same /24
      network; it was producing too many wrong guesses.
    - Make the new hidden service code respect the SafeLogging setting.
      Bugfix on 0.2.0.x. Patch from Karsten.
    - When starting as an authority, do not overwrite all certificates
      cached from other authorities. Bugfix on 0.2.0.x. Fixes bug 606.
    - If we're trying to flush the last bytes on a connection (for
      example, when answering a directory request), reset the
      time-to-give-up timeout every time we manage to write something
      on the socket. Bugfix on 0.1.2.x.
    - Change the behavior of "getinfo status/good-server-descriptor"
      so it doesn't return failure when any authority disappears.
    - Even though the man page said that "TrackHostExits ." should
      work, nobody had ever implemented it. Bugfix on 0.1.0.x.
    - Report TLS "zero return" case as a "clean close" and "IO error"
      as a "close". Stop calling closes "unexpected closes": existing
      Tors don't use SSL_close(), so having a connection close without
      the TLS shutdown handshake is hardly unexpected.
    - Send NAMESERVER_STATUS messages for a single failed nameserver
      correctly.
  o Code simplifications and refactoring:
    - Remove the tor_strpartition function: its logic was confused,
      and it was only used for one thing that could be implemented far
      more easily.

@_date: 2008-02-29 03:33:26
@_author: Roger Dingledine 
@_subject: "Your system clock just jumped" on Debian+VMware ESX 
The other hint here is that FreeBSD users used to see this problem,
until a recent fix to FreeBSD made it go away. But last I checked,
nobody has tracked down what the fix was.
What's happening inside Tor is that it goes to sleep until a new
event happens or until one second elapses. When it wakes up, it asks
gettimeofday() how much time passed, and in this case it finds that it
has travelled back in time 4397 seconds since the last time it asked.
I'm guessing this is a kernel thing, so running "date" a lot will probably
not help to notice it. Is gettimeofday() the wrong way to ask what time
it is under vmware? :)

@_date: 2008-02-29 05:06:54
@_author: Roger Dingledine 
@_subject: lefkada down 
Right, Lefkada's been down for nearly a week. Its owner is working
on that. Good thing we have other directory authorities. :)
You are a little bit confused. Tor 0.2.0.x uses the new v3 directory
system, which means it looks at ~/.tor/cached-consensus. The
~/.tor/cached-status/ directory is just for mirroring v2 networkstatus
documents to the Tor users that are running 0.1.2.x.
Hope that helps,

@_date: 2008-01-08 16:35:40
@_author: Roger Dingledine 
@_subject: What to do at IP number change? 
There is still a problem. It's the same one that Peter said in
 :
"Don't do that.  It takes several hours before all the clients have your
current descriptor, if you keep changing it every two or so hours you
are only placing a burden on the directory infrastructure and nobody
will use you anyway.
Changing it every now and then, say daily because your ISP disconnects
you and gives you a new IP address, is ok, but the longer you run at the
same address the more useful you are."
Even if you hup your Tor rather than restarting it, you're still killing
all the circuits going through you -- and more importantly, all the
clients will continue for those two hours to look for you at the old IP
address. And once they get a new one, you will have moved again.
Please don't do this.

@_date: 2008-01-09 08:14:32
@_author: Roger Dingledine 
@_subject: 24C3: Current events in Tor development 
Hi folks,
My talk at 24C3 in Berlin is now up on the web in various formats.
Basically I gave an overview of some of the big technical things we did
in 2007, some of the policy/legal issues that we're tackling, and some of
the technical things that need to come next. The focus was on Germany,
so it included some discussion of the upcoming data retention problems,
and of the general issue with police in Germany seizing servers.
You can download the high-quality version here:
or watch the low-quality version here:
and the slides are here:

@_date: 2008-01-09 14:03:53
@_author: Roger Dingledine 
@_subject: 0.1.2.19 is getting close to ready; please test it 
Hi folks,
We're getting close to having 0.1.2.19 ready. Phobos has put snapshots up;
the packaging changes are a) the Vidalia bundles now ship with Vidalia
0.0.16 (which includes many bugfixes, and hopefully not too many new
bugs), and b) the OS X bundles now include the stable Torbutton xpi too.
Please grab it, try it out, and let us know whether we broke anything.
Partial list of changes in version 0.1.2.19 - 2008-01-??
  o Security fixes:
    - Exit policies now reject connections that are addressed to a
      relay's public (external) IP address too, unless
      ExitPolicyRejectPrivate is turned off. We do this because too
      many relays are running nearby to services that trust them based
      on network address.
  o Major bugfixes:
    - When the clock jumps forward a lot, do not allow the bandwidth
      buckets to become negative. Fixes bug 544.
    - Fix a memory leak on exit relays; we were leaking a cached_resolve_t
      on every successful resolve. Reported by Mike Perry.
    - Purge old entries from the "rephist" database and the hidden
      service descriptor database even when DirPort is zero.
    - Stop thinking that 0.1.2.x directory servers can handle "begin_dir"
      requests. Should ease bugs 406 and 419 where 0.1.2.x relays are
      crashing or mis-answering these requests.
    - When we decide to send a 503 response to a request for servers, do
      not then also send the server descriptors: this defeats the whole
      purpose. Fixes bug 539.
  o Minor bugfixes:
    - Changing the ExitPolicyRejectPrivate setting should cause us to
      rebuild our server descriptor.
    - Fix handling of hex nicknames when answering controller requests for
      networkstatus by name, or when deciding whether to warn about
      unknown routers in a config option. (Patch from mwenge.)
    - Fix a couple of hard-to-trigger autoconf problems that could result
      in really weird results on platforms whose sys/types.h files define
      nonstandard integer types.
    - Don't try to create the datadir when running --verify-config or
      --hash-password. Resolves bug 540.
    - If we were having problems getting a particular descriptor from the
      directory caches, and then we learned about a new descriptor for
      that router, we weren't resetting our failure count. Reported
      by lodger.
    - Although we fixed bug 539 (where servers would send HTTP status 503
      responses _and_ send a body too), there are still servers out there
      that haven't upgraded. Therefore, make clients parse such bodies
      when they receive them.

@_date: 2008-01-09 23:44:43
@_author: Roger Dingledine 
@_subject: What to do at IP number change? 
Sorry for the ambiguity. The circuits die because the IP address has
changed in the above scenario. The hupping is incidental.
Just hupping Tor by itself doesn't cut circuits.

@_date: 2008-01-10 20:52:33
@_author: Roger Dingledine 
@_subject: via ControlPort, can we build a circuit to a bridge? 
Yes, that should work fine.
As far as Tor is concerned, assuming it's got descriptors for them,
these are all just relays.
Let us know if it works / doesn't work. :)

@_date: 2008-01-15 10:19:00
@_author: Roger Dingledine 
@_subject: Question about TOR and IIS - Also hello! 
Thanks. :)
are probably two good places to start.
The first thing I would worry about with one webserver that handles
hidden services and "normal" websites is if somebody can connect to the
hidden service website, ask for the real website, and get it. This lets
an attacker guess-and-check about where your hidden service lives. In
apache-land this is usually solved by listening on two different ports,
and making sure to keep the two classes of sites separate in apache's
mind. I imagine there's a way for IIS to do it too.
has a bit more discussion.
If you get it working well and want to document what you did and why,
that would be great. Hidden services haven't received much attention
over the past few years in terms of writing tutorials.

@_date: 2008-01-17 00:49:00
@_author: Roger Dingledine 
@_subject: via ControlPort, postdescriptor w/ purpose=general fails 
Thanks; I think I've fixed this assert in r13153:
It'll be part of the 0.2.0.16-alpha release whenever that comes out.
(In the future, if you say what Tor version you're using (I think you
were using 0.2.0.15-alpha), and exactly what the assert error is, that
will help me to track these down faster.)
I just added a brief description into path-spec.txt:

@_date: 2008-01-17 01:34:48
@_author: Roger Dingledine 
@_subject: how many connections are legitimate to a DirPort? 
Here are three cases where it occurs legitimately:
a) Sometimes there are multiple Tor clients natted behind a single
IP address.
b) Since Squid doesn't like URLs >= 4096 bytes, and you never know where a
transparent squid proxy will pop up, Tor limits each directory request to
96 descriptors. So it's possible that a Tor client that's just starting
up will want more than 96 descriptors from you, in which case it will
use multiple (parallel) connections.
c) If a Tor client has a connection, but it's going slowly, and not long
after it learns that it wants to fetch some more descriptors (say it gets
a new networkstatus concensus, or some other directory request fails),
and it picks you for the next fetch.
I'll let you know if I think of others. But these are some already. :)
You could make the case that we should queue requests for a given relay
so we only ask them one at a time. Maybe one day we'll fix the code so
it does that more reliably; but that's not on the list for 0.2.0.x.
I'm not sure what is causing the DirPort DoSes that some people have been
seeing. More details (e.g. what they're asking for) would be helpful in
tracking those down.
Hope that helps,

@_date: 2008-01-19 13:12:03
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.17-alpha is out 
Tor 0.2.0.16-alpha and 0.2.0.17-alpha add a fifth v3 directory authority
run by Karsten Loesing, and generally clean up a lot of features and
minor bugs.
Changes in version 0.2.0.17-alpha - 2008-01-17
  o Compile fixes:
    - Make the tor-gencert man page get included correctly in the tarball.
Changes in version 0.2.0.16-alpha - 2008-01-17
  o New directory authorities:
    - Set up gabelmoo (run by Karsten Loesing) as the fifth v3 directory
      authority.
  o Major performance improvements:
    - Switch our old ring buffer implementation for one more like that
      used by free Unix kernels. The wasted space in a buffer with 1mb
      of data will now be more like 8k than 1mb. The new implementation
      also avoids realloc();realloc(); patterns that can contribute to
      memory fragmentation.
  o Minor features:
    - Configuration files now accept C-style strings as values. This
      helps encode characters not allowed in the current configuration
      file format, such as newline or  Addresses bug 557.
    - Although we fixed bug 539 (where servers would send HTTP status 503
      responses _and_ send a body too), there are still servers out
      there that haven't upgraded. Therefore, make clients parse such
      bodies when they receive them.
    - When we're not serving v2 directory information, there is no reason
      to actually keep any around. Remove the obsolete files and directory
      on startup if they are very old and we aren't going to serve them.
  o Minor performance improvements:
    - Reference-count and share copies of address policy entries; only 5%
      of them were actually distinct.
    - Never walk through the list of logs if we know that no log is
      interested in a given message.
  o Minor bugfixes:
    - When an authority has not signed a consensus, do not try to
      download a nonexistent "certificate with key 00000000". Bugfix
      on 0.2.0.x. Fixes bug 569.
    - Fix a rare assert error when we're closing one of our threads:
      use a mutex to protect the list of logs, so we never write to the
      list as it's being freed. Bugfix on 0.1.2.x. Fixes the very rare
      bug 575, which is kind of the revenge of bug 222.
    - Patch from Karsten Loesing to complain less at both the client
      and the relay when a relay used to have the HSDir flag but doesn't
      anymore, and we try to upload a hidden service descriptor.
    - Stop leaking one cert per TLS context. Fixes bug 582. Bugfix on
      0.2.0.15-alpha.
    - Do not try to download missing certificates until we have tried
      to check our fallback consensus. Fixes bug 583.
    - Make bridges round reported GeoIP stats info up to the nearest
      estimate, not down. Now we can distinguish between "0 people from
      this country" and "1 person from this country".
    - Avoid a spurious free on base64 failure. Bugfix on 0.1.2.
    - Avoid possible segfault if key generation fails in
      crypto_pk_hybrid_encrypt. Bugfix on 0.2.0.
    - Avoid segfault in the case where a badly behaved v2 versioning
      directory sends a signed networkstatus with missing client-versions.
      Bugfix on 0.1.2.
    - Avoid segfaults on certain complex invocations of
      router_get_by_hexdigest(). Bugfix on 0.1.2.
    - Correct bad index on array access in parse_http_time(). Bugfix
      on 0.2.0.
    - Fix possible bug in vote generation when server versions are present
      but client versions are not.
    - Fix rare bug on REDIRECTSTREAM control command when called with no
      port set: it could erroneously report an error when none had
      happened.
    - Avoid bogus crash-prone, leak-prone tor_realloc when we're
      compressing large objects and find ourselves with more than 4k
      left over. Bugfix on 0.2.0.
    - Fix a small memory leak when setting up a hidden service.
    - Fix a few memory leaks that could in theory happen under bizarre
      error conditions.
    - Fix an assert if we post a general-purpose descriptor via the
      control port but that descriptor isn't mentioned in our current
      network consensus. Bug reported by Jon McLachlan; bugfix on
      0.2.0.9-alpha.
  o Minor features (controller):
    - Get NS events working again. Patch from tup.
    - The GETCONF command now escapes and quotes configuration values
      that don't otherwise fit into the torrc file.
    - The SETCONF command now handles quoted values correctly.
  o Minor features (directory authorities):
    - New configuration options to override default maximum number of
      servers allowed on a single IP address. This is important for
      running a test network on a single host.
    - Actually implement the -s option to tor-gencert.
    - Add a manual page for tor-gencert.
  o Minor features (bridges):
    - Bridge authorities no longer serve bridge descriptors over
      unencrypted connections.
  o Minor features (other):
    - Add hidden services and DNSPorts to the list of things that make
      Tor accept that it has running ports. Change starting Tor with no
      ports from a fatal error to a warning; we might change it back if
      this turns out to confuse anybody. Fixes bug 579.

@_date: 2008-01-19 15:36:18
@_author: Roger Dingledine 
@_subject: Hidden Services 
Yeah. Just take the private_key file with you from your HiddenServiceDir

@_date: 2008-01-19 18:31:27
@_author: Roger Dingledine 
@_subject: libevent & tor 
It depends just how outdated your libevent is.
And what platform you're running it on, which dictates what
system call it prefers to use: select, poll, kqueue, etc.
Tor tries to warn you if it sees a combination of a platform and
libevent version that it knows is especially bad:
see check_libevent_version() in src/or/config.c
But if you're encountering problems and you're using an old libevent,
upgrading your libevent is often a good place to start.

@_date: 2008-01-19 18:36:35
@_author: Roger Dingledine 
@_subject: Konqueror & SOCKS with Tor+Privoxy 
You might find
to be useful.
You should configure the socks part too. The reason is that browsers
have a habit of supporting all sorts of weird protocols besides http and
https, and if some webpage gives you (over Tor) a link that points to
one of those other protocols, then your browser will fetch it without
going through any proxies. If you specify a socks proxy, your browser
should [*] use the socks proxy for all other protocols.
(I say "should" because I have no idea what bugs konqueror has where
it decides it's smarter than you and shouldn't use a proxy for some

@_date: 2008-01-23 04:22:14
@_author: Roger Dingledine 
@_subject: TorStatus version 4 has been released 
Hi Kasimir,
Here's a wishlist that's been slowly accumulating in my head. :)
1) It looks like it's still using the v2 networkstatus format. (I'm
guessing this because there I sometimes see the "partially listed"
icon by a few relays.) The v3 networkstatus format also works now:
if you run a recent 0.2.0.x version, you may find the cached-consensus
file to be easier to look at than looking through each cached-status
file and computing locally. See also
2) I love the "bandwidth bar" in the relay list. But it would be more
meaningful to me if it listed average sustained load, not just peak
load. You can compute this daily average by adding up all the numbers
in the write-history and read-history lines (either in the descriptor
or in the extrainfo document, depending on the relay's Tor version)
and dividing by 2*86400. (This penalizes relays that don't list a whole
day's worth of bandwidth histories, but I claim that's a feature.) You
could leave the peak bandwidth number in place, for people who want that,
and then make the bandwidth bar and the number two separate columns.
3) It looks like it's still using the DNSEL server that Joe added in?
Compare to the "tor checker" on xenobite (
or the one that tup wrote that Jake is running on
 that does active measurements to notice
Tor relays that exit on a different IP address than they advertise.
4) The network_detail.php page includes non-Running servers in its
graphs. I think this is skewing the data, and in any case it's hard
to adjust for that in my brain. We've been thinking about removing
non-Running servers from the networkstatus consensus. But even if we
don't get around to doing that for a while, would it make sense to
discard them from the graphs?

@_date: 2008-01-23 14:07:29
@_author: Roger Dingledine 
@_subject: We're missing a certificate from authority lefkada with	signing key 0000000000000000000000000000 
Fetch the latest version from SVN:
or wait until 0.2.0.18-alpha comes out.

@_date: 2008-01-23 14:59:55
@_author: Roger Dingledine 
@_subject: unusual connection activity? 
Sounds like you've uncovered a bug in 0.1.2.19. I'm guessing you didn't
set your Address line, so Tor is doing its best to guess. And it sounds
like your Tor made a tunnelled connection through 212.112.242.159 to a
directory cache, and then it got suckered into thinking its IP address
had changed.
Can you give me a few more hints? Anything else in the logs? Is this
repeatable? Were you doing anything interesting at the time? Do you run
a hidden service too? Had your relay been running for a long time or
short time before this happened?
Has anybody else here experienced this?

@_date: 2008-01-27 22:33:43
@_author: Roger Dingledine 
@_subject: another unusual connection 
Neat. So it was 212.112.242.159 in both cases?
New theory: in rare cases, Tor servers (like maximator) lie to directory
clients about what IP address they appear to have, due to iptables
confusion or something similar. More specifically, it claims that
everybody looks like itself. Then Tor servers that don't know their own
address get suckered into thinking they switched.
If this is actually the bug, I'll have to ponder how to fix it well. We
could require several places to agree before we think we should switch;
but that would slow down reaction times considerably. We could only
believe answers from authorities; but I don't want to preclude better
load balancing. We could ignore it when we ask a directory mirror at IP
address X and he says we look like we're coming from IP address X;
that's probably a good idea, and I should add a check for this. Then we
can see if that check ever triggers.
Please let me know if it happens more (or if other people experience it
and can provide more details!), and maybe we'll narrow in further.

@_date: 2008-01-27 22:50:50
@_author: Roger Dingledine 
@_subject: directory authority/authorities need(s) updating? 
Right. I dropped 0.2.0.16-alpha and 0.2.0.17-alpha from recommended server
versions for the reasons you cite. Any server running 0.2.0.17-alpha
is going to bloat to the point that it endangers other processes on
the machine.
There are actually only three v2 authorities that recommend versions:
moria1, moria2, and tor26. And I believe just two of these (moria1 and
tor26) are the sole v3 authorities that recommend versions.
So Scott, don't worry too much about the "careless" directory operators,
especially since we haven't ramped up to having more versioning
authorities yet. Our goal isn't to always keep them perfectly in sync
anyway -- the goal is to have the majority opinion be a reasonable one.
My Internet is not very good for this week, so I figured I'd push out
0.2.0.18-alpha (and change recommended versions) before I disappeared. You
can read its ChangeLog entry if you want a sneak preview; eventually
I'll send an official announce about it.
Hope that helps,

@_date: 2008-01-28 15:53:51
@_author: Roger Dingledine 
@_subject: quick circuit tear down question 
Check out Section 5.4 of tor-spec.txt, which includes:
   To tear down part of a circuit, the OP may send a RELAY_TRUNCATE cell
   signaling a given OR (Stream ID zero).  That OR sends a DESTROY
   cell to the next node in the circuit, and replies to the OP with a
   RELAY_TRUNCATED cell.
I don't think we've added any interface for this into the control
protocol, because we don't really have a safe use in mind yet. You
can read about the feature in tor-design.pdf under the phrase "leaky
pipe". But somebody needs to do more anonymity and performance analysis
first, to tell us what the tradeoffs are between tearing down part of
a certain and just starting a new one.
Hope that helps,

@_date: 2008-01-28 17:02:48
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.18-alpha is out 
Tor 0.2.0.18-alpha adds a sixth v3 directory authority run by CCC,
fixes a big memory leak in 0.2.0.17-alpha, and adds new config options
that can warn or reject connections to ports generally associated with
vulnerable-plaintext protocols.
Changes in version 0.2.0.18-alpha - 2008-01-25
  o New directory authorities:
    - Set up dannenberg (run by CCC) as the sixth v3 directory
      authority.
  o Major bugfixes:
    - Fix a major memory leak when attempting to use the v2 TLS
      handshake code. Bugfix on 0.2.0.x; fixes bug 589.
    - We accidentally enabled the under-development v2 TLS handshake
      code, which was causing log entries like "TLS error while
      renegotiating handshake". Disable it again. Resolves bug 590.
    - We were computing the wrong Content-Length: header for directory
      responses that need to be compressed on the fly, causing clients
      asking for those items to always fail. Bugfix on 0.2.0.x; fixes
      bug 593.
  o Major features:
    - Avoid going directly to the directory authorities even if you're a
      relay, if you haven't found yourself reachable yet or if you've
      decided not to advertise your dirport yet. Addresses bug 556.
    - If we've gone 12 hours since our last bandwidth check, and we
      estimate we have less than 50KB bandwidth capacity but we could
      handle more, do another bandwidth test.
    - New config options WarnPlaintextPorts and RejectPlaintextPorts so
      Tor can warn and/or refuse connections to ports commonly used with
      vulnerable-plaintext protocols. Currently we warn on ports 23,
      109, 110, and 143, but we don't reject any.
  o Minor bugfixes:
    - When we setconf ClientOnly to 1, close any current OR and Dir
      listeners. Reported by mwenge.
    - When we get a consensus that's been signed by more people than
      we expect, don't log about it; it's not a big deal. Reported
      by Kyle Williams.
  o Minor features:
    - Don't answer "/tor/networkstatus-bridges" directory requests if
      the request isn't encrypted.
    - Make "ClientOnly 1" config option disable directory ports too.
    - Patches from Karsten Loesing to make v2 hidden services more
      robust: work even when there aren't enough HSDir relays available;
      retry when a v2 rend desc fetch fails; but don't retry if we
      already have a usable v0 rend desc.

@_date: 2008-01-30 16:20:10
@_author: Roger Dingledine 
@_subject: bridges.torproject.org certificate 
Fixed, for now.
The real answer is that we should get a "real" cert for that site. But
we haven't done that yet because I still have hopes to move it off of
moria onto someplace that's more secure (and more important, managed by
somebody who isn't me :)

@_date: 2008-07-30 14:21:30
@_author: Roger Dingledine 
@_subject: *Theoretical* question to the Tor project leader 
Well, first of all, The Tor Project is a separate organization organized
as a US non-profit. Tor is not "at" MIT.
Tor's funding comes from a wide variety of sources:
and it's exactly this diversity of funding that makes us able to make our
own decisions and do the right thing. So far nobody has tried to strongarm
us into change this approach. But we do have to make sure that when we
accept funding, we only agree to do things that we already want to do.
I wouldn't say it's easy, but things are going pretty well overall,
especially considering the variety of governments and corporations
that are trying harder to censor their Internet and/or track all their
Or perhaps you are looking for
No, but most of the Tor development team was in Leuven last week. So we
do get out of the US.
Hope that helps.

@_date: 2008-07-09 06:35:37
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.29-rc is out 
Tor 0.2.0.29-rc fixes two big bugs with using bridges, fixes more
hidden-service performance bugs, and fixes a bunch of smaller bugs.
The bundles also come with Torbutton 0.1.2rc5 and the Vidalia 0.1.6:
Changes in version 0.2.0.29-rc - 2008-07-08
  o Major bugfixes:
    - If you have more than one bridge but don't know their keys,
      you would only launch a request for the descriptor of the first one
      on your list. (Tor considered launching requests for the others, but
      found that it already had a connection on the way for $0000...0000
      so it didn't open another.) Bugfix on 0.2.0.x.
    - If you have more than one bridge but don't know their keys, and the
      connection to one of the bridges failed, you would cancel all
      pending bridge connections. (After all, they all have the same
      digest.) Bugfix on 0.2.0.x.
    - When a hidden service was trying to establish an introduction point,
      and Tor had built circuits preemptively for such purposes, we
      were ignoring all the preemptive circuits and launching a new one
      instead. Bugfix on 0.2.0.14-alpha.
    - When a hidden service was trying to establish an introduction point,
      and Tor *did* manage to reuse one of the preemptively built
      circuits, it didn't correctly remember which one it used,
      so it asked for another one soon after, until there were no
      more preemptive circuits, at which point it launched one from
      scratch. Bugfix on 0.0.9.x.
    - Make directory servers include the X-Your-Address-Is: http header in
      their responses even for begin_dir conns. Now clients who only
      ever use begin_dir connections still have a way to learn their IP
      address. Fixes bug 737; bugfix on 0.2.0.22-rc. Reported by goldy.
  o Minor bugfixes:
    - Fix a macro/CPP interactions that was confusing some compilers:
      some GCCs don't like  pairs inside macro arguments.
      Fix for bug 707.
    - Fix macro collision between OpenSSL 0.9.8h and Windows headers.
      Fixes bug 704; fix from Steven Murdoch.
    - When opening /dev/null in finish_daemonize(), do not pass the
      O_CREAT flag. Fortify was complaining, and correctly so. Fixes
      bug 742; fix from Michael Scherer. Bugfix on 0.0.2pre19.
    - Correctly detect transparent proxy support on Linux hosts that
      require in.h to be included before netfilter_ipv4.h.  Patch
      from coderman.

@_date: 2008-07-03 03:48:04
@_author: Roger Dingledine 
@_subject: odd warning at shutdown 
Sounds like
which we fixed in 0.2.0.25-rc, several months ago.
Are you sure this was the real 0.2.1.1-alpha release? If so, is it
repeatable? (It should be repeatable, since I don't think we fixed
anything to do with that between 0.2.1.1-alpha and 0.2.1.2-alpha.)

@_date: 2008-07-17 00:23:16
@_author: Roger Dingledine 
@_subject: Mixed pages - serious bug of tor 
It looks like you have DoSed some of the faster Tor relays out there,
and then Tor stopped working as well for you. Perhaps these were your
entry guards, so you were particularly strongly affected?
But more broadly, yes, the capacity of the Tor network, while huge, is
still small compared to all the people out there who might want to use it.
And you can do a CPU denial of service too, not just a bandwidth denial
of service, as you say.
Part of the challenge here is that we've built an anonymity system,
and that means it's hard for a relay to distinguish between 500 users
each building a circuit, and one guy named Marek building 500 circuits.
I guess we can put some checks for this particular attack in, for example
by rate limiting the number of create attempts from a Tor not listed
in the directory. But I fear that stopping all DoS avenues is a losing
proposition. It's hard enough to build a system that handles many users
well even when they are all playing nice.
This sounds like a separate bug. Are you using Privoxy or Polipo? Which
version of Torbutton? More details about what "corrupted" means?

@_date: 2008-07-17 02:38:13
@_author: Roger Dingledine 
@_subject: Mixed pages - serious bug of tor 
What errors? Please be specific.
What pages? Please be specific.

@_date: 2008-07-03 04:02:12
@_author: Roger Dingledine 
@_subject: odd warning at shutdown 
Great. Basically, it's a (hopefully small) memory leak.
Let us know if you set any weird config options, like
"AuthDirListBadExits". :) Otherwise, I'll look forward to hearing more
when you (or others here!) have seen it again.

@_date: 2008-07-17 10:48:25
@_author: Roger Dingledine 
@_subject: Delivery Status Notification (Delay) 
Gah. Sorry about that. The spammer has been removed from the list.

@_date: 2008-07-17 11:57:17
@_author: Roger Dingledine 
@_subject: Mixed pages - serious bug of tor 
Some things to narrow down to help us understand it:
- Are you using Opera to Privoxy to Tor, or Opera directly to Tor?
- Are bytes getting clobbered inside a given stream, or is Opera loading
  several streams and some of them are entirely the wrong bytes? For
  example, if you could fetch the page with wget and see if there's
  corruption inside the page you get, that would help narrow down.
- Can you make this happen with many different exit points, or did you
  list those three because they're the ones that worked? If it works
  with others, which ones?
- Can you get us a debug-level log (with SafeLogging 0) of the bug in
  action? I suspect it will be a large log.

@_date: 2008-07-17 19:47:32
@_author: Roger Dingledine 
@_subject: Stable in noreply debian repo jumped to 0.2.0.30 
I tagged Tor 0.2.0.30, the stable release of the 0.2.0.x series,
on Tuesday.
You can read all about it here:
We haven't made an official announcement yet, because we're waiting for
Torbutton 1.2.0 to go stable so we can build packages for the Windows
and OS X folks. It'll probably be a few weeks yet. But that's no reason
for the folks on real operating systems to be kept waiting. :)

@_date: 2008-06-11 01:17:38
@_author: Roger Dingledine 
@_subject: How are hackers breaking Tor and trojan users? 
Well. What an exciting thread. I think I'll put a few more cents in.
I really do appreciate the push that you and Kyle have been making
towards shipping a Tor configuration that uses a transparent proxying
approach. Right now there are straightforward and simple solutions for
Linux and BSD, and all it takes is some iptables rules:
but unfortunately there aren't yet any solutions that simple for Windows.
(And in fact if we wanted to make a simple bundle for Linux and BSD
end-users, it becomes complex again since you need some sort of interface
for adding those iptables rules, taking them out again, etc.)
All of the Windows transparent proxying approaches I've seen so far come
with a huge VM blob (plus the requirement of a huge opaque VM player),
so while it would be great to offer it as one download option, it can't
be our only option: there will always be folks with few resources for
whom it isn't suitable. Down the road I would like to see Windows Tor
bundles that do transparent proxying with lower overhead and using only
free software, maybe even without the VM approach at all. I bet we're
heading there, and I look forward to it.
But the real problem here comes down to the lack of design documentation
or security analysis on the current Windows transparent proxying
options. Nobody knows what's in them really, nobody knows how to
reproduce them so they can confirm what's in them, nobody knows how
they're *supposed* to work so they can't verify that, there's no place
to go to read a good analysis of the tradeoffs, etc. In that respect,
we're still in the same place we were a year ago, when I wrote my previous
mail on this topic:
I look forward to the day when we have clear and thorough design docs
and security analyses for the VM-based approach to a Tor bundle. At
this point I'm assuming we will have to do it ourselves, though. It's on
our todo list, and we're getting there (we'd love to have some help!),
but we're still tackling a lot of more fundamental issues like how to
make Tor not screw up your anonymity even when you do use it right.
In the mean time we have been making progress at some related
approaches. In particular, several people have brought up Mike Perry's
fine new version of Torbutton:
that *does* have some good analysis:
I agree with you that it's not perfect in all cases, but I'll take
a pretty good tool whose security properties I understand over an
undocumented miracle tool any day.
We really do need to get the Tor 0.2.0.x branch stabilized so we can get
rid of the current "stable" Tor bundles -- they still ship with the old
vanilla Torbutton, which requires users to read and understand all the
warnings on the download page:
and even then I suspect you're right that various Firefox bugs can be
turned against them.
Just so we're all clear here, I believe Steve is referring to browser
vulnerabilities that can force your browser to bypass its proxy
configuration and skip over Tor entirely. Attacks like this do pop
up periodically; I am stunned at how many bugs there are in Firefox,
and IE is even worse.
He may also be referring to attacks where a local application (like the
browser, but it doesn't have to be) can be tricked into connecting to
your local Tor control port, like Kyle's attack from last year:
This was a great attack, but I think the latest versions of Torbutton
and Vidalia make it a non-issue going forward. I would love to hear if
you think otherwise.
But we have to also remember that the broader class of 0-day software
vulnerabilities also includes ways to exploit your browser to compromise
your computer, run programs on it, steal all your data, etc. And I think
we all agree that end-to-end application vulnerabilities aren't going
to get resolved just by sticking your Tor in a VM.
Actually, no, I think that's false. I've been chatting with Christian
Grothoff, one of the speakers for that talk, and the attack he's working
on should work just as well against any of the various ways to package
Tor. He has promised to keep us in the loop and help us fix the problem
before his talk. I have to say I prefer that approach to threatening to
"drop zero-days" on us.

@_date: 2008-06-13 16:41:16
@_author: Roger Dingledine 
@_subject: SPD talk: "Simulating a Global Passive Adversary for Attacking Tor-like Anonymity Systems"? 
Right. We've gotten a copy of the paper from the authors, and we're
evaluating it. My current thoughts are that this is a brilliant new
theoretical attack, but how effective it can be on the current Tor
network is still an open question.
In other words, the next steps are to a) try to make the attack more
practical and see how flexible it can become, and/or b) learn from the
authors whether they know more than they wrote in their very brief and
unfortunately kind of vague analysis section. Alas, I'm busy the next
few days with our upcoming Tor releases, and will get back to talking
to them after that.
Interestingly, it appears that folks who transfer huge amounts of data
over Tor may be more vulnerable than the folks who have more moderate
loads -- maybe we've just found another argument against putting
file-sharing traffic over Tor. ;)
Since a lot of the countermeasures we're pondering are just a matter
of degree ("well, if the attack doesn't work when the foo level is
over .8, then try to make the foo level always .81"), we need a better
understanding of the limits of the attack before we can go about trying
to counter it.
My intuition is that it will turn out to be a fine attack, and we will
need to do something smart about it.
Speaking of which, there is another attack that's currently in this same
situation -- a brilliant theoretical attack, probably can be made to work
in practice, more work is required before we understand how effective
it can be:
One of the interesting features of these new network-property-based
anonymity attacks is that it appears they work even better against
single-hop proxy systems than against Tor. These attacks so far are of
the form "first do an attack to identify the Tor relays in the circuit,
and then hope you have enough time left to trace all the way to the
client location before the client moves". If the first half is trivial,
you have a lot more time for the second half.
So when you read our warning at startup:
"This is experimental software. Do not rely on it for strong anonymity."
be sure not to interpret it as a suggestion that there are any other
low-latency anonymity approaches that are considered better. As far
as I can tell, it's either use Tor or do nothing; and each user has a
different level of risk they can handle, so part of our ongoing work is
to figure out how much risk there really is.
Exciting times,

@_date: 2008-06-14 02:18:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.28-rc is out 
Tor 0.2.0.28-rc fixes an anonymity-related bug, fixes a hidden-service
performance bug, and fixes a bunch of smaller bugs.
The bundles also come with Torbutton 0.1.2rc2 and the Vidalia 0.1.4:
Changes in version 0.2.0.28-rc - 2008-06-13
  o Anonymity fixes:
    - Fix a bug where, when we were choosing the 'end stream reason' to
      put in our relay end cell that we send to the exit relay, Tor
      clients on Windows were sometimes sending the wrong 'reason'. The
      anonymity problem is that exit relays may be able to guess whether
      the client is running Windows, thus helping partition the anonymity
      set. Down the road we should stop sending reasons to exit relays,
      or otherwise prevent future versions of this bug.
  o Major bugfixes:
    - While setting up a hidden service, some valid introduction circuits
      were overlooked and abandoned. This might be the reason for
      the long delay in making a hidden service available. Bugfix on
      0.2.0.13-alpha.
  o Minor features:
    - Update to the "June 9 2008" ip-to-country file.
    - Run 'make test' as part of 'make dist', so we stop releasing so
      many development snapshots that fail their unit tests.
  o Minor bugfixes:
    - When we're checking if we have enough dir info for each relay
      to begin establishing circuits, make sure that we actually have
      the descriptor listed in the consensus, not just any descriptor.
    - Bridge relays no longer print "xx=0" in their extrainfo document
      for every single country code in the geoip db.
    - Only warn when we fail to load the geoip file if we were planning to
      include geoip stats in our extrainfo document.
    - If we change our MaxAdvertisedBandwidth and then reload torrc,
      Tor won't realize it should publish a new relay descriptor. Fixes
      bug 688, reported by mfr.
    - When we haven't had any application requests lately, don't bother
      logging that we have expired a bunch of descriptors.
    - Make relay cells written on a connection count as non-padding when
      tracking how long a connection has been in use. Bugfix on
      0.2.0.1-alpha. Spotted by lodger.
    - Fix unit tests in 0.2.0.27-rc.
    - Fix compile on Windows.

@_date: 2008-06-14 22:26:56
@_author: Roger Dingledine 
@_subject: questions about bug in 0.2.0.20-rc 
The 0.2.0.21-rc ChangeLog includes:
    - Downgrade assert in connection_buckets_decrement() to a log message.
      This may help us solve bug 614, and in any case will make its
      symptoms less severe. Bugfix on 0.2.0.20-rc. Reported by fredzupy.
Then 0.2.0.22-rc says:
    - When counting the number of bytes written on a TLS connection,
      look at the BIO actually used for writing to the network, not
      at the BIO used (sometimes) to buffer data for the network.
      Looking at different BIOs could result in write counts on the
      order of ULONG_MAX. Fixes bug 614.

@_date: 2008-06-16 00:24:19
@_author: Roger Dingledine 
@_subject: Blocked by my ISP? 
You should be aware that you're using a Tor that was released almost 10
months ago. Perhaps you're not using the right debian repository to keep
up to date?
Could be that your ISP is filtering certain requests it doesn't like.
I would suggest upgrading to Tor 0.2.0.28-rc. It fetches directory
information in a different way, so it probably doesn't do the action
that your ISP is trying to filter.
This is weird to see here. It looks like you succeeded at getting enough
directory information and establishing a circuit. So your Tor ought to
work. Perhaps this is because you had directory information from using
Tor recently when it wasn't filtered?
That sounds like a reasonable guess.
That makes it sound like you've screwed up your proxy settings. If your
ISP blocks Tor, then your Tor requests ought to time out or otherwise
fail. Not work and show up as being your own local IP address.
So in summary, "maybe, but it sounds like you're confused about enough
that I can't really guess."

@_date: 2008-06-18 00:25:37
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.1-alpha is out 
Tor 0.2.1.1-alpha fixes a lot of memory fragmentation problems that
were making the Tor process bloat especially on Linux; makes our TLS
handshake blend in better; sends "bootstrap phase" status events to the
controller, so it can keep the user informed of progress (and problems)
fetching directory information and establishing circuits; and adds a
variety of smaller features.
The big Tor relays on Linux who are having memory problems should try
this one out and let us know how it goes for you.
(Yes, the 0.2.0.x tree hasn't quite gone stable yet. But we wanted to
keep making progress while it finishes stabilizing.)
Changes in version 0.2.1.1-alpha - 2008-06-13
  o Major features:
    - More work on making our TLS handshake blend in: modify the list
      of ciphers advertised by OpenSSL in client mode to even more
      closely resemble a common web browser. We cheat a little so that
      we can advertise ciphers that the locally installed OpenSSL doesn't
      know about.
    - Start sending "bootstrap phase" status events to the controller,
      so it can keep the user informed of progress fetching directory
      information and establishing circuits. Also inform the controller
      if we think we're stuck at a particular bootstrap phase. Implements
      proposal 137.
    - Resume using OpenSSL's RAND_poll() for better (and more portable)
      cross-platform entropy collection again. We used to use it, then
      stopped using it because of a bug that could crash systems that
      called RAND_poll when they had a lot of fds open. It looks like the
      bug got fixed in late 2006. Our new behavior is to call RAND_poll()
      at startup, and to call RAND_poll() when we reseed later only if
      we have a non-buggy OpenSSL version.
  o Major bugfixes:
    - When we choose to abandon a new entry guard because we think our
      older ones might be better, close any circuits pending on that
      new entry guard connection. This fix should make us recover much
      faster when our network is down and then comes back. Bugfix on
      0.1.2.8-beta; found by lodger.
  o Memory fixes and improvements:
    - Add a malloc_good_size implementation to OpenBSD_malloc_linux.c,
      to avoid unused RAM in buffer chunks and memory pools.
    - Speed up parsing and cut down on memory fragmentation by using
      stack-style allocations for parsing directory objects. Previously,
      this accounted for over 40% of allocations from within Tor's code
      on a typical directory cache.
    - Use a Bloom filter rather than a digest-based set to track which
      descriptors we need to keep around when we're cleaning out old
      router descriptors. This speeds up the computation significantly,
      and may reduce fragmentation.
    - Reduce the default smartlist size from 32 to 16; it turns out that
      most smartlists hold around 8-12 elements tops.
    - Make dumpstats() log the fullness and size of openssl-internal
      buffers.
    - If the user has applied the experimental SSL_MODE_RELEASE_BUFFERS
      patch to their OpenSSL, turn it on to save memory on servers. This
      patch will (with any luck) get included in a mainline distribution
      before too long.
    - Never use OpenSSL compression: it wastes RAM and CPU trying to
      compress cells, which are basically all encrypted, compressed,
      or both.
  o Minor bugfixes:
    - Stop reloading the router list from disk for no reason when we
      run out of reachable directory mirrors. Once upon a time reloading
      it would set the 'is_running' flag back to 1 for them. It hasn't
      done that for a long time.
    - In very rare situations new hidden service descriptors were
      published earlier than 30 seconds after the last change to the
      service. (We currently think that a hidden service descriptor
      that's been stable for 30 seconds is worth publishing.)
  o Minor features:
    - Allow separate log levels to be configured for different logging
      domains. For example, this allows one to log all notices, warnings,
      or errors, plus all memory management messages of level debug or
      higher, with: Log [MM] debug-err [*] notice-err file /var/log/tor.
    - Add a couple of extra warnings to --enable-gcc-warnings for GCC 4.3,
      and stop using a warning that had become unfixably verbose under
      GCC 4.3.
    - New --hush command-line option similar to --quiet. While --quiet
      disables all logging to the console on startup, --hush limits the
      output to messages of warning and error severity.
    - Servers support a new URL scheme for consensus downloads that
      allows the client to specify which authorities are trusted.
      The server then only sends the consensus if the client will trust
      it. Otherwise a 404 error is sent back. Clients use this
      new scheme when the server supports it (meaning it's running
      0.2.1.1-alpha or later). Implements proposal 134.
    - New configure/torrc options (--enable-geoip-stats,
      DirRecordUsageByCountry) to record how many IPs we've served
      directory info to in each country code, how many status documents
      total we've sent to each country code, and what share of the total
      directory requests we should expect to see.
    - Use the TLS1 hostname extension to more closely resemble browser
      behavior.
    - Lots of new unit tests.
    - Add a macro to implement the common pattern of iterating through
      two parallel lists in lockstep.

@_date: 2008-06-18 01:12:45
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.1-alpha is out 
I'm running a fast Tor server that isn't using the openbsd malloc, and
it's using only 270MB of ram.
So in theory that may not be needed anymore (finally).
But only if you all have the same experience. :)
I'll leave this question for Nick.

@_date: 2008-06-28 00:24:24
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.2-alpha is out 
Tor 0.2.1.2-alpha includes a new "TestingTorNetwork" config option to
make it easier to set up your own private Tor network; fixes several
big bugs with using more than one bridge relay; fixes a big bug with
offering hidden services quickly after Tor starts; and uses a better
API for reporting potential bootstrapping problems to the controller.
(Yes, the 0.2.0.x tree hasn't quite gone stable yet. But we wanted to
keep making progress while it finishes stabilizing.)
Changes in version 0.2.1.2-alpha - 2008-06-20
  o Major features:
    - New TestingTorNetwork config option to allow adjustment of
      previously constant values that, while reasonable, could slow
      bootstrapping. Implements proposal 135. Patch from Karsten.
  o Major bugfixes:
    - If you have more than one bridge but don't know their digests,
      you would only launch a request for the descriptor of the first one
      on your list. (Tor considered launching requests for the others, but
      found that it already had a connection on the way for $0000...0000
      so it didn't open another.) Bugfix on 0.2.0.x.
    - If you have more than one bridge but don't know their digests,
      and the connection to one of the bridges failed, you would cancel
      all pending bridge connections. (After all, they all have the
      same digest.) Bugfix on 0.2.0.x.
    - When establishing a hidden service, introduction points that
      originate from cannibalized circuits are completely ignored and not
      included in rendezvous service descriptors. This might be another
      reason for delay in making a hidden service available. Bugfix
      from long ago (0.0.9.x?)
  o Minor features:
    - Allow OpenSSL to use dynamic locks if it wants.
    - When building a consensus, do not include routers that are down.
      This will cut down 30% to 40% on consensus size. Implements
      proposal 138.
    - In directory authorities' approved-routers files, allow
      fingerprints with or without space.
    - Add a "GETINFO /status/bootstrap-phase" controller option, so the
      controller can query our current bootstrap state in case it attaches
      partway through and wants to catch up.
    - Send an initial "Starting" bootstrap status event, so we have a
      state to start out in.
  o Minor bugfixes:
    - Asking for a conditional consensus at .../consensus/
      would crash a dirserver if it did not already have a
      consensus. Bugfix on 0.2.1.1-alpha.
    - Clean up some macro/CPP interactions: some GCC versions don't like
       pairs inside macro arguments. Fixes bug 707. Bugfix on
      0.2.0.x.
  o Bootstrapping bugfixes (on 0.2.1.1-alpha):
    - Directory authorities shouldn't complain about bootstrapping
      problems just because they do a lot of reachability testing and
      some of the connection attempts fail.
    - Start sending "count" and "recommendation" key/value pairs in
      bootstrap problem status events, so the controller can hear about
      problems even before Tor decides they're worth reporting for sure.
    - If you're using bridges, generate "bootstrap problem" warnings
      as soon as you run out of working bridges, rather than waiting
      for ten failures -- which will never happen if you have less than
      ten bridges.
    - If we close our OR connection because there's been a circuit
      pending on it for too long, we were telling our bootstrap status
      events "REASON=NONE". Now tell them "REASON=TIMEOUT".

@_date: 2008-06-28 13:01:03
@_author: Roger Dingledine 
@_subject: icann opening up of tld's 
Well, the first thing to keep in mind is that the Tor client intercepts
addresses, notices whether they're a .onion address, and handles them
itself. So if suddenly a top-level .onion domain springs into existence,
the only real change will be that Tor users won't be able to reach the
new "real" .onion sites.
There remains a security concern for folks who think they're using Tor and
accidentally aren't -- they will attempt to resolve the .onion address
locally. Currently they'll get a resolve failure, but if there's a new
tld they could get a page back. I don't think this is much of a new
vulnerability though, because a local attacker can already spoof DNS
responses and send you to their page. But again this is only a worry
if you have your Tor misconfigured. (Insert request for well-documented
secure transparent proxying solution here. :)

@_date: 2008-06-30 18:21:36
@_author: Roger Dingledine 
@_subject: Tor security advisory: Debian flaw causes weak identity keys 
When we rotated three of the six v3 authority keys in mid May, we decided
to sign new consensuses with both the new keys and the old keys for a
short time, so people who hadn't upgraded yet wouldn't have their Tors
totally break on them.
Today ends that interim period. We've disabled the "legacy" keys
on moria1, tor26, and gabelmoo. This means that anybody running Tor
0.2.0.9-alpha through Tor 0.2.0.25-rc inclusive will find that their
Tor can't find network information, and will stop working. Upgrade.

@_date: 2008-06-03 15:51:06
@_author: Roger Dingledine 
@_subject: SSL Keys + Identity of a Tor server 
You don't need to keep it. It gets rotated every week or so. Its function
is to be the encryption key that clients use when establishing a circuit
through you and making a session key. It is separate from the identity
key because it is good security practice to have different keys for
different roles. (That turns out to have been a smart move in light of
this particular security problem, even. :)
nickname and secret_id_key are all it takes. IP address can change.
Sounds fine. Some relays get a new IP address every night automatically.
Yep. It will stay that way for several months until the old name<->key
binding expires.

@_date: 2008-06-05 00:31:04
@_author: Roger Dingledine 
@_subject: Switching to 2.x 
Tor 0.1.2.x is still the official Tor stable branch.
The Tor 0.2.0.x tree is still in development, meaning we keep putting
out new releases and then finding neat bugs in them the next day, then
waiting another week before putting out another development release that
fixes those bugs but uncovers new ones, etc.
So if you want to run a Tor and have it be very solid, the 0.1.2.x branch
is still your best choice.
If you want lots of new features, and a few surprising bugs, then use
the newer one.
See also

@_date: 2008-06-05 02:27:05
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.27-rc is out 
Tor 0.2.0.27-rc adds a few features we left out of the earlier release
candidates. In particular, we now include an IP-to-country GeoIP database,
so controllers can easily look up what country a given relay is in,
and so bridge relays can give us some sanitized summaries about which
countries are making use of bridges. (See proposal 126-geoip-fetching.txt
for details.)
The bundles also come with Torbutton 0.1.2rc1 (which includes preliminary
support for Firefox 3) and the new Vidalia 0.1.3 release.
Changes in version 0.2.0.27-rc - 2008-06-03
  o Major features:
    - Include an IP-to-country GeoIP file in the tarball, so bridge
      relays can report sanitized summaries of the usage they're seeing.
  o Minor features:
    - Add a "PURPOSE=" argument to "STREAM NEW" events, as suggested by
      Robert Hogan. Fixes the first part of bug 681.
    - Make bridge authorities never serve extrainfo docs.
    - Add support to detect Libevent versions in the 1.4.x series
      on mingw.
    - Fix build on gcc 4.3 with --enable-gcc-warnings set.
    - Include a new contrib/tor-exit-notice.html file that exit relay
      operators can put on their website to help reduce abuse queries.
  o Minor bugfixes:
    - When tunneling an encrypted directory connection, and its first
      circuit fails, do not leave it unattached and ask the controller
      to deal. Fixes the second part of bug 681.
    - Make bridge authorities correctly expire old extrainfo documents
      from time to time.

@_date: 2008-03-14 01:24:37
@_author: Roger Dingledine 
@_subject: Tor and Firefox 3 
Hi Steve,
Is the current plan for xb browser that it will continue shipping with its
own Firefox mods, or are you planning to migrate towards using Torbutton
1.1.x since that handles more application-level privacy issues?
For reference, the original thread was asking about Torbutton-dev and
Firefox 3. More info on torbutton-dev here:

@_date: 2008-03-17 00:12:06
@_author: Roger Dingledine 
@_subject: odd clock jump messages from 0.2.0.21-rc 
See also the previous thread on this topic:
In this case, Lucky found the problem was that he was running with
multiple CPUs, and vmware kept track of time differently on each CPU
(different meaning they were several hours apart from each other). So
when Tor moved from one CPU to the other, its time changed wildly.
It sounds like that's not what's happening here. But are you on more than
one cpu (or more than one 'core', now that we're in the 21st century)?
I've also heard from some FreeBSD users who had problems with the clock
jump warnings, and once they upgraded their kernel sufficiently the
complaints went away. I don't think you mentioned what OS you're using,
but it looks like you're using FreeBSD too?
The other option is that you're massively swapping and Tor really is
getting starved for hundreds of seconds at a time. But I'm guessing
that's not it.

@_date: 2008-03-18 18:31:01
@_author: Roger Dingledine 
@_subject: Recommended versions of Tor 
Yep. Give us a bit more time for it to be there. :)

@_date: 2008-03-19 17:25:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.22-rc is out 
Tor 0.2.0.22-rc is the third release candidate for the 0.2.0 series. It
enables encrypted directory connections by default for non-relays, fixes
some broken TLS behavior we added in 0.2.0.20-rc, and resolves many
other bugs. The bundles also include Vidalia 0.1.1 and Torbutton 1.1.17:
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.0.22-rc - 2008-03-18
  o Major features:
    - Enable encrypted directory connections by default for non-relays,
      so censor tools that block Tor directory connections based on their
      plaintext patterns will no longer work. This means Tor works in
      certain censored countries by default again.
  o Major bugfixes:
    - Make sure servers always request certificates from clients during
      TLS renegotiation. Reported by lodger; bugfix on 0.2.0.20-rc.
    - Do not enter a CPU-eating loop when a connection is closed in
      the middle of client-side TLS renegotiation. Fixes bug 622. Bug
      diagnosed by lodger; bugfix on 0.2.0.20-rc.
    - Fix assertion failure that could occur when a blocked circuit
      became unblocked, and it had pending client DNS requests. Bugfix
      on 0.2.0.1-alpha. Fixes bug 632.
  o Minor bugfixes (on 0.1.2.x):
    - Generate "STATUS_SERVER" events rather than misspelled
      "STATUS_SEVER" events. Caught by mwenge.
    - When counting the number of bytes written on a TLS connection,
      look at the BIO actually used for writing to the network, not
      at the BIO used (sometimes) to buffer data for the network.
      Looking at different BIOs could result in write counts on the
      order of ULONG_MAX. Fixes bug 614.
    - On Windows, correctly detect errors when listing the contents of
      a directory. Fix from lodger.
  o Minor bugfixes (on 0.2.0.x):
    - Downgrade "sslv3 alert handshake failure" message to INFO.
    - If we set RelayBandwidthRate and RelayBandwidthBurst very high but
      left BandwidthRate and BandwidthBurst at the default, we would be
      silently limited by those defaults. Now raise them to match the
      RelayBandwidth* values.
    - Fix the SVK version detection logic to work correctly on a branch.
    - Make --enable-openbsd-malloc work correctly on Linux with alpha
      CPUs. Fixes bug 625.
    - Logging functions now check that the passed severity is sane.
    - Use proper log levels in the testsuite call of
      get_interface_address6().
    - When using a nonstandard malloc, do not use the platform values for
      HAVE_MALLOC_GOOD_SIZE or HAVE_MALLOC_USABLE_SIZE.
    - Make the openbsd malloc code use 8k pages on alpha CPUs and
      16k pages on ia64.
    - Detect mismatched page sizes when using --enable-openbsd-malloc.
    - Avoid double-marked-for-close warning when certain kinds of invalid
      .in-addr.arpa addresses are passed to the DNSPort. Part of a fix
      for bug 617. Bugfix on 0.2.0.1-alpha.
    - Make sure that the "NULL-means-reject *:*" convention is followed by
      all the policy manipulation functions, avoiding some possible crash
      bugs. Bug found by lodger. Bugfix on 0.2.0.16-alpha.
    - Fix the implementation of ClientDNSRejectInternalAddresses so that it
      actually works, and doesn't warn about every single reverse lookup.
      Fixes the other part of bug 617.  Bugfix on 0.2.0.1-alpha.
  o Minor features:
    - Only log guard node status when guard node status has changed.
    - Downgrade the 3 most common "INFO" messages to "DEBUG". This will
      make "INFO" 75% less verbose.

@_date: 2008-03-25 16:53:12
@_author: Roger Dingledine 
@_subject: Weird-looking circuits in Vidalia 
They're caused by a new Tor feature. Starting with Tor 0.2.0.22-rc,
Tor does encrypted directory requests rather than plaintext (http)
directory requests. These show up in the Vidalia circuit list as a bunch
of one-hop circuits, since in reality that's what they are.
I wonder if Vidalia should hide these one-hop circuits from the user? Or
maybe users in the future will get used to seeing them in the list?

@_date: 2008-03-25 16:57:46
@_author: Roger Dingledine 
@_subject: Need help for a friend who lives in the Iran 
I hear that Iran uses Smartfilter to oppress their citizens. If that's
true, then your friend should try the Tor 0.2.0.22-rc or later release.
It should automatically get around Smartfilter's (current) filtering

@_date: 2008-03-25 17:13:27
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.22-rc is out 
Hi Andrew,
This would seem to be a bug, yes? If people leave "Torbutton" checked
in their installer, they expect the installer to clobber any current
Torbutton install. Right?
(That said, I'm not sure how easy it is technically to make the installer
overwrite a current Torbutton. Anybody here want to take a go at that? :)
My guess is this is an issue for both the OSX and the Windows installer.)

@_date: 2008-03-26 03:13:35
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.23-rc is out 
Tor 0.2.0.23-rc is the fourth release candidate for the 0.2.0 series. It
makes bootstrapping faster if the first directory mirror you contact is
down. The bundles also include the new Vidalia 0.1.2 release:
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.0.23-rc - 2008-03-24
  o Major bugfixes:
    - When a tunneled directory request is made to a directory server
      that's down, notice after 30 seconds rather than 120 seconds. Also,
      fail any begindir streams that are pending on it, so they can
      retry elsewhere. This was causing multi-minute delays on bootstrap.

@_date: 2008-03-30 16:31:10
@_author: Roger Dingledine 
@_subject: Exit node to add to ExcludeNodes 
Nice. That one's got a lot of bandwidth for a Chinese relay getting
mitm'ed by its ISP.
I've listed it as !badexit on moria1 and moria2. Once another authority
lists it too, it'll be marked that way.
(We really need to get more automated exit scanning going. There are
some promising GSoC projects that aim to do that.)

@_date: 2008-03-04 15:29:42
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.21-rc is out 
Tor 0.2.0.21-rc is the second release candidate for the 0.2.0 series. It
makes Tor work well with Vidalia again, fixes a rare assert bug, and
fixes a pair of more minor bugs. The bundles also include Vidalia 0.1.0
and Torbutton 1.1.16:
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.0.21-rc - 2008-03-02
  o Major bugfixes:
    - The control port should declare that it requires password auth
      when HashedControlSessionPassword is set too. Patch from Matt Edman;
      bugfix on 0.2.0.20-rc. Fixes bug 615.
    - Downgrade assert in connection_buckets_decrement() to a log message.
      This may help us solve bug 614, and in any case will make its
      symptoms less severe. Bugfix on 0.2.0.20-rc. Reported by fredzupy.
    - We were sometimes miscounting the number of bytes read from the
      network, causing our rate limiting to not be followed exactly.
      Bugfix on 0.2.0.16-alpha. Reported by lodger.
  o Minor bugfixes:
    - Fix compilation with OpenSSL 0.9.8 and 0.9.8a.  All other supported
      OpenSSL versions should have been working fine.  Diagnosis and patch
      from lodger, Karsten Loesing and Sebastian Hahn.  Fixes bug 616.
      Bugfix on 0.2.0.20-rc.

@_date: 2008-03-04 15:32:26
@_author: Roger Dingledine 
@_subject: Tor Browser web page 
Done: Let us know if you have any other suggestions!

@_date: 2008-03-07 15:27:50
@_author: Roger Dingledine 
@_subject: "TLS error while renegotiating handshake" on Win XP 
I believe [scrubbed] is the actual string that he is seeing. Tor doesn't
like printing IP addresses when it can help it. :)
In this case, I believe those warnings come from people running Tor
clients or relays on 0.2.0.17-alpha, which had a bug in TLS handshaking.
We left the warning in, in case there was a later bug too. But I think
there isn't. So we will downgrade it to an 'info' level log in the next
release candidate.

@_date: 2008-03-11 17:40:42
@_author: Roger Dingledine 
@_subject: same exit node on all circuits? 
Most likely you're looking at the list of circuits in Vidalia's network
map. That list includes both "exit" circuits and "internal" circuits.
The internal circuits are kept around for hidden service requests and
other requests that don't actually exit the Tor network.
And since internal circuits don't "exit", they ignore your whitelist of
allowed exit nodes.
As to why it's the same one several times in a row for you, a) probably
coincidence, and b) there are a few dozen really fast Tor servers that
are involved in a lot of the action.

@_date: 2008-05-19 15:23:55
@_author: Roger Dingledine 
@_subject: most nodes now "not running" ? 
~/.tor$ grep Running cached-consensus |wc -l
Give me a few more hints?

@_date: 2008-05-04 16:15:33
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.25-rc is out 
Tor 0.2.0.24-rc and 0.2.0.25-rc are the next release candidates for the
0.2.0 series. They add dizum (run by Alex de Joode) as the new sixth
v3 directory authority, make relays with dynamic IP addresses and no
DirPort notice more quickly when their IP address changes, fix a few
rare crashes and memory leaks, and fix a few other miscellaneous bugs.
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.0.25-rc - 2008-04-23
  o Major bugfixes:
    - Remember to initialize threading before initializing logging.
      Otherwise, many BSD-family implementations will crash hard on
      startup. Fixes bug 671. Bugfix on 0.2.0.24-rc.
  o Minor bugfixes:
    - Authorities correctly free policies on bad servers on
      exit. Fixes bug 672. Bugfix on 0.2.0.x.
Changes in version 0.2.0.24-rc - 2008-04-22
  o New directory authorities:
    - Take lefkada out of the list of v3 directory authorities, since
      it has been down for months.
    - Set up dizum (run by Alex de Joode) as the new sixth v3 directory
      authority.
  o Major bugfixes:
    - Detect address changes more quickly on non-directory mirror
      relays. Bugfix on 0.2.0.18-alpha; fixes bug 652.
  o Minor features (security):
    - Reject requests for reverse-dns lookup of names that are in
      a private address space. Patch from lodger.
    - Non-exit relays no longer allow DNS requests. Fixes bug 619. Patch
      from lodger.
  o Minor bugfixes (crashes):
    - Avoid a rare assert that can trigger when Tor doesn't have much
      directory information yet and it tries to fetch a v2 hidden
      service descriptor. Fixes bug 651, reported by nwf.
    - Initialize log mutex before initializing dmalloc. Otherwise,
      running with dmalloc would crash. Bugfix on 0.2.0.x-alpha.
    - Use recursive pthread mutexes in order to avoid deadlock when
      logging debug-level messages to a controller. Bug spotted by nwf,
      bugfix on 0.2.0.16-alpha.
  o Minor bugfixes (resource management):
    - Keep address policies from leaking memory: start their refcount
      at 1, not 2. Bugfix on 0.2.0.16-alpha.
    - Free authority certificates on exit, so they don't look like memory
      leaks. Bugfix on 0.2.0.19-alpha.
    - Free static hashtables for policy maps and for TLS connections on
      shutdown, so they don't look like memory leaks. Bugfix on 0.2.0.x.
    - Avoid allocating extra space when computing consensuses on 64-bit
      platforms. Bug spotted by aakova.
  o Minor bugfixes (misc):
    - Do not read the configuration file when we've only been told to
      generate a password hash. Fixes bug 643. Bugfix on 0.0.9pre5. Fix
      based on patch from Sebastian Hahn.
    - Exit relays that are used as a client can now reach themselves
      using the .exit notation, rather than just launching an infinite
      pile of circuits. Fixes bug 641. Reported by Sebastian Hahn.
    - When attempting to open a logfile fails, tell us why.
    - Fix a dumb bug that was preventing us from knowing that we should
      preemptively build circuits to handle expected directory requests.
      Fixes bug 660. Bugfix on 0.1.2.x.
    - Warn less verbosely about clock skew from netinfo cells from
      untrusted sources. Fixes bug 663.
    - Make controller stream events for DNS requests more consistent,
      by adding "new stream" events for DNS requests, and removing
      spurious "stream closed" events" for cached reverse resolves.
      Patch from mwenge. Fixes bug 646.
    - Correctly notify one-hop connections when a circuit build has
      failed. Possible fix for bug 669. Found by lodger.

@_date: 2008-05-23 08:11:46
@_author: Roger Dingledine 
@_subject: Your Tor relay might be affected by Debain OpenSSL flaw 
That warning has to do with fetching directory information so you can
mirror it to Tor clients. It isn't same as the original warning you were
seeing, which was more explicit: "Fingerprint is marked rejected".
So you should be ok now.
(We do try to make our error messages clear when they're important. :)

@_date: 2008-05-23 19:07:22
@_author: Roger Dingledine 
@_subject: lots of DMCA request's... (1/day) 
My first thought is to have a conversation with the linode person
handling the takedowns, and encourage him/her to learn more about the
legal requirements. As I understand from
your ISP can discard all of the DMCA complaints directed toward your Tor
relay -- they don't need to answer them. Whether they *want* to answer
them, or hassle you, is another story, and practically speaking I agree
it's a relevant one, but step one is distinguishing legal requirements
from actions they are opting to take on their own.
My second thought is that if you want to reduce the frequent of DMCA
notices in particular, you might switch from the default exit policy,
which permits most ports and denies a few, to an exit policy that permits
a few popular ports and denies the rest. For example, a node that permits
only *:80 and *:443 would still be useful for many Tor users, but might
attract less file-sharing traffic.
My third thought is to take a look through
Hope that helps,

@_date: 2008-05-24 00:06:19
@_author: Roger Dingledine 
@_subject: Backward decryption of Tor traffic after Debian OpenSSL bug disclosure 
It's real.
I've just added two more paragraphs to
to try to make it clearer:
  Worse, this attack works against past traffic too: what if an attacker
  logged traffic over the past two years? As long as there's a single
  non-weak non-colluding Tor relay in your circuit, you're fine --
  that relay will provide encryption that the attacker can't break,
  then or now. But if you ever picked a path that consisted entirely of
  relays with broken RNGs, and an attacker logged this traffic, then he
  can unwrap the traffic from his logs using the same approach as above.
  Similarly, if anybody has logs of traffic coming out of a Debian
  or Ubuntu Tor client, they can strip it of its encryption, and thus
  retroactively break the anonymity.
Now, it would take some work to write the program to sort it all out,
walk all the computations backwards, etc. But we would like to have better
security than "let's hope nobody writes the program that breaks it".
Bad stuff,

@_date: 2008-05-27 16:18:20
@_author: Roger Dingledine 
@_subject: Fwd: Logistics of International Policy Restrictions (project liberation) 
[conspiracy theories]
Ok, I have removed Wilfred from the list. He is welcome to continue
spinning conspiracy theories, but the Tor lists are not the right place
for that.

@_date: 2008-05-27 17:34:28
@_author: Roger Dingledine 
@_subject: FW: controller GETINFO ns/id/fingerprint "s" record 
It gets answered by your local Tor process based on the directory
information that it has locally. It doesn't trigger any new fetches.
Do you mean that the getinfo command hangs for 20 seconds and then
answers? Or that getinfo tells you it doesn't have an answer, and up to
20 seconds passes, with you continually doing new getinfos, before you
get the answer you want?
If the former, that sounds like a bug, and you should give us debug-level
logs with details. If the latter, it sounds like you're asking for data
that your Tor doesn't have yet.

@_date: 2008-05-29 15:37:22
@_author: Roger Dingledine 
@_subject: bridge relays and bridge directories 
Any relay will work there, but relays that are configured to be bridges
will work best. See above url. ("It's complicated").
Fortunately for you, there's only one default bridge authority
currently. Let's hope you trust it.
(We need to come up with a design where we can handle more than one --
but we can't just spread all the bridge info onto every bridge authority,
because that just makes n single points of failure for an attacker trying
to learn bridges.)
No, you're confusing ExitPolicy with ExtendPolicy. (And ExtendPolicy
doesn't exist.)
Only if they add DirServer lines to their torrc to point to you.
You might also like
which has only sort of been implemented at this point. In fact, it looks
like I haven't even gotten very far at writing the proposal. :)
What do you expect it to do?

@_date: 2008-05-29 16:04:49
@_author: Roger Dingledine 
@_subject: de-Tor-iorate Anonymity 
Unknown currently. I'll mail Christian and ask him for details.
Sounds like snake oil, doesn't it? Also unknown at this time.

@_date: 2008-05-31 12:20:03
@_author: Roger Dingledine 
@_subject: bridge relay: "DirPort unreachable" 
Are you running something else on port 80? Like, say, a webserver?
It means your Tor client tried to do a self-test on its advertised DirPort
(port 80 of whatever Address you're advertising), and it didn't get an
answer it expected. Perhaps something else is listening there instead?

@_date: 2008-05-01 05:02:37
@_author: Roger Dingledine 
@_subject: Tor-only email 
Hi Andy,
A word of warning: pop3 and imap tend to communicate authentication
information in plaintext. Sending protocols like those over the open
Internet (whether using Tor or not) is generally a very risky thing to do.
Sending them over Tor may be even riskier.
(There are safe ways to do it, e.g. by making sure that your Tor clients
use a hidden service to transport their plaintext protocols, or making
sure they always exit from a relay that's on the same local network as
the destination. But you need to think carefully about these issues in
any case.)

@_date: 2008-05-13 09:27:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.0.26-rc is out 
Tor 0.2.0.26-rc fixes a major security vulnerability caused by a bug in
Debian's OpenSSL packages. All users running any 0.2.0.x version should
upgrade, whether they're running Debian or not. We will follow up with
a security advisory shortly.
Changes in version 0.2.0.26-rc - 2008-05-13
  o Major security fixes:
    - Use new V3 directory authority keys on the tor26, gabelmoo, and
      moria1 V3 directory authorities. The old keys were generated with
      a vulnerable version of Debian's OpenSSL package, and must be
      considered compromised. Other authorities' keys were not generated
      with an affected version of OpenSSL.
  o Major bugfixes:
    - List authority signatures as "unrecognized" based on DirServer
      lines, not on cert cache. Bugfix on 0.2.0.x.
  o Minor features:
    - Add a new V3AuthUseLegacyKey option to make it easier for
      authorities to change their identity keys if they have to.

@_date: 2008-05-13 11:55:35
@_author: Roger Dingledine 
@_subject: Tor security advisory: Debian flaw causes weak identity keys 
This is a critical security announcement.
  A bug in the Debian GNU/Linux distribution's OpenSSL package was
  announced today. This bug would allow an attacker to figure out private
  keys generated by these buggy versions of the OpenSSL library. Thus,
  all private keys generated by affected versions of OpenSSL must be
  considered to be compromised.
  Tor uses OpenSSL, so Tor users and admins need to take action in order
  to remain secure in response to this problem.
  If you are running Debian, Ubuntu, or any Debian-based GNU/Linux
  distribution, first follow the instructions at
      to upgrade your OpenSSL package to a safe version. If you're running a
  Tor server or a Tor hidden service, then also follow the instructions
  below to replace your Tor identity keys.
  Also, if you are running Tor 0.2.0.x, you must upgrade to Tor
  0.2.0.26-rc.
WHO IS AFFECTED:
  This advisory applies to Tor 0.2.0.x and/or any Debian/Ubuntu/related
  system running _any_ Tor version. Tor clients and servers that are
  running 0.1.2.x and that are not using Debian/Ubuntu/etc don't need
  to do anything.
  Specific versions affected: All Tor 0.2.0.x development versions up
  through 0.2.0.25-rc, and most Debian/Ubuntu/related users regardless of
  Tor version.
  A local attacker or malicious directory cache may be able to trick
  a client running 0.2.0.x into believing a false directory consensus, thus
  (e.g.) causing the client to create a path wholly owned by the attacker.
  Further, relay identity keys or hidden service secret keys that were
  generated on most versions of Debian, Ubuntu, or other Debian-derived OS
  are also weak (regardless of your Tor version):
    WHAT TO DO:
  First, all affected Debian/Ubuntu/similar users (regardless
  of Tor version) should apt-get upgrade to the latest (i.e. today's)
  OpenSSL package.
  Second, all Tor clients and servers running 0.2.0.x should upgrade to
  0.2.0.26-rc. (Again: Tor clients and servers that are running 0.1.2.x
  and aren't using Debian/Ubuntu/related don't need to do anything.)
  Third, Tor servers and hidden services running on Debian/Ubuntu/related
  (regardless of Tor version) should discard their identity keys and
  generate fresh ones. To discard your Tor server's keys, delete
  the "keys/secret_*" files in your datadirectory (often it is
  /var/lib/tor/). To discard your hidden service secret key, delete
  the "private_key" file from the hidden service directory that you
  configured in your torrc. [This will change the .onion address of your
  hidden service.]
  Due to a bug in Debian's modified version of OpenSSL 0.9.8, all
  generated keys (and other cryptographic material!) have a stunningly
  small amount of entropy. This flaw means that brute force attacks which
  are very hard against the unmodified OpenSSL library (e.g. breaking RSA
  keys) are very practical against these keys. See the URL above for
  more information about the flaw in Debian's OpenSSL packages.
  While we believe the v2 authority keys (used in Tor 0.1.2.x) were
  generated correctly, at least three of the six v3 authority keys (used
  in Tor 0.2.0.x) are known to be weak. This fraction is uncomfortably
  close to the majority vote needed to create a networkstatus consensus,
  so the Tor 0.2.0.26-rc release changes these three affected keys.
  Relay identity keys and hidden service secret keys generated in this
  flawed way are also breakable. That is, any encryption operations with
  respect to a weak-key relay (including link encryption and onion
  encryption) can be easily broken, and their descriptors can be easily
  forged. Soon we will begin identifying weak-key relays and cutting them
  out of the network. (We will likely put out another release in a few
  days with a new identity key for our bridge authority; we apologize for
  the inconvenience to our bridge users.)
  Finally, while we don't know of any attacks that will reveal the
  location of a weak-key hidden service, an attacker could derive its
  secret key and then pretend to be the hidden service.

@_date: 2008-05-14 02:57:38
@_author: Roger Dingledine 
@_subject: Tor security advisory: Debian flaw causes weak identity keys 
Hi folks,
I wrote a few more details about the potential impact here:
(It glosses over a few tricky and more esoteric attacks that might
become possible, but I think it captures the main ones. I'll update
it tonight (in ~8 hours) if any more come to mind.)

@_date: 2008-05-14 02:59:49
@_author: Roger Dingledine 
@_subject: Undeciperable message... 
If you ever wrote that node down specifically, e.g. in your torrc file,
then it means what Karsten N just described. You can't specify a node
just by its nickname and expect it to be unique.
If you haven't ever touched your config file and you're wondering why
this message came out of the blue, it may be the recurrence of an old
bug we had with Vidalia doing lookups on Tor servers in the background.
Please let us know which it is. :)

@_date: 2008-05-14 12:14:40
@_author: Roger Dingledine 
@_subject: Your Tor relay might be affected by Debain OpenSSL flaw 
We blacklisted nodes by their weak keys. So if you come back with the same
(weak) key, you'll still be blacklisted -- but that's as it should be.
Perhaps you could provide more details?

@_date: 2008-11-09 18:23:20
@_author: Roger Dingledine 
@_subject: Kudos on memory usage in 0.2.X 
Tor 0.2.0.x is somewhat more stable than 0.2.1.x-alpha in general. For
example, we just made a change in 0.2.1.7-alpha that will make Tor
mysteriously fail to start on some obscure operating systems.
On the other hand, if your 0.2.0.x keeps running out of memory and
crashing, then you might find 0.2.1.x to be more stable. ;)

@_date: 2008-11-09 22:06:34
@_author: Roger Dingledine 
@_subject: SANS Paper: Detecting Tor 
I suspect it refers to the old 0.1.2.x versions of Tor, back when we
wrote deterministic strings in our TLS certificates.
Tor 0.2.0.x and later don't do that.

@_date: 2008-11-10 16:13:38
@_author: Roger Dingledine 
@_subject: Dir servers on private networks 
Check out the TestingTorNetwork config option in 0.2.1.x-alpha. It's
not quite instantly, but it turns on a lot of config options that make
it smoother to run your own network:
static config_var_t testing_tor_network_defaults[] = {
  V(ServerDNSAllowBrokenResolvConf, BOOL,  "1"),
  V(DirAllowPrivateAddresses,    BOOL,     "1"),
  V(EnforceDistinctSubnets,      BOOL,     "0"),
  V(AssumeReachable,             BOOL,     "1"),
  V(AuthDirMaxServersPerAddr,    UINT,     "0"),
  V(AuthDirMaxServersPerAuthAddr,UINT,     "0"),
  V(ClientDNSRejectInternalAddresses, BOOL,"0"),
  V(ExitPolicyRejectPrivate,     BOOL,     "0"),
  V(V3AuthVotingInterval,        INTERVAL, "5 minutes"),
  V(V3AuthVoteDelay,             INTERVAL, "20 seconds"),
  V(V3AuthDistDelay,             INTERVAL, "20 seconds"),
  V(TestingV3AuthInitialVotingInterval, INTERVAL, "5 minutes"),
  V(TestingV3AuthInitialVoteDelay, INTERVAL, "20 seconds"),
  V(TestingV3AuthInitialDistDelay, INTERVAL, "20 seconds"),
  V(TestingAuthDirTimeToLearnReachability, INTERVAL, "0 minutes"),
  V(TestingEstimatedDescriptorPropagationTime, INTERVAL, "0 minutes"),
You'll still need to set your own DirServer lines.
If you continue to have problems, you should put your torrc files up
somewhere. Giving us ambiguous warning messages without hints about what
config options are set doesn't give us enough info. :)

@_date: 2008-11-10 23:43:42
@_author: Roger Dingledine 
@_subject: Version deprecated? 
Looks like gabelmoo isn't recommending quite the set of versions it should
be recommending. That is, it's missing 0.2.0.29-rc, 0.2.0.30, 0.2.0.31.
Since moria1 and tor26 do recommend those, the majority rules, so you
will get the correct recommendations most of the time.
But I suppose if a consensus gets built that's missing moria1 or tor26,
then the majority of versioning authorities would no longer recommend
Hopefully Karsten will fix his authority soon.

@_date: 2008-11-11 17:32:37
@_author: Roger Dingledine 
@_subject: determining which are the ORs a Tor circuit is using 
Btw, please pick only one mailing list to send your mail to. Your
follow-up mail actually sent it to three lists, not just two. This is
not cool. :)
The traditional way to do this is to open your Tor's control port,
and then attach a controller program (lika Vidalia, but you can write
your own too with the torctl libraries) to ask questions like this. See
doc/spec/control-spec.txt for many more details.
For example, if you send
  setevents extended circ stream
Then for streams you get lines like this
650 STREAM 17 NEW 0  SOURCE_ADDR=127.0.0.1:51279 PURPOSE=USER
650 STREAM 17 SENTCONNECT 5  650 STREAM 17 REMAP 5 72.14.235.104:80 SOURCE=EXIT
650 STREAM 17 SUCCEEDED 5 72.14.235.104:80 650 STREAM 18 NEW 0  SOURCE_ADDR=127.0.0.1:51280 PURPOSE=USER
650 STREAM 18 SENTCONNECT 5  650 STREAM 18 REMAP 5 72.14.235.99:80 SOURCE=EXIT
650 STREAM 18 SUCCEEDED 5 72.14.235.99:80 650 STREAM 17 CLOSED 5 72.14.235.104:80 REASON=END REMOTE_REASON=unknown
and interspersed with that you get circ info like
650 CIRC 10 LAUNCHED PURPOSE=GENERAL
650 CIRC 10 EXTENDED $43AF24071B400911629D5BC9FC20DE335F9DFC00 PURPOSE=GENERAL
650 CIRC 10 EXTENDED $43AF24071B400911629D5BC9FC20DE335F9DFC00,ratator PURPOSE=GENERAL
650 CIRC 10 EXTENDED $43AF24071B400911629D5BC9FC20DE335F9DFC00,ratator,$D3EAC880BECBE5F80DB4609F225D351CC4F72395 PURPOSE=GENERAL
650 CIRC 10 BUILT $43AF24071B400911629D5BC9FC20DE335F9DFC00,ratator,$D3EAC880BEC
You can also do a command like
  getinfo circuit-status
which will spit out a summary:
getinfo circuit-status
9 EXTENDED gremlin,pickaproxy
8 BUILT BostonUCompSci,$D0FF59689F9148D47B03DC03025853C80315A930,$D1C0C9FF2F88EB291DD436A1485DD471EB80D40F
6 BUILT gremlin,myrnaloy,godzilla,tor26
4 BUILT gremlin,SEC,vallenator
3 BUILT $43AF24071B400911629D5BC9FC20DE335F9DFC00,$8318A0A99B26785C6AB59FB3A290F6A04ADDD42C,vallenator
2 BUILT BostonUCompSci,$2682892CB12EDA0B69049C42A8483A680F70F56F,$83044401FD17BB48723049ED5BF7F1E9A9AB1A00,EviDancerDirServer
1 BUILT gremlin,SEC,$F701FBB7B5B70B765751D71DA8FE40E517223331

@_date: 2008-11-11 18:51:55
@_author: Roger Dingledine 
@_subject: determining which are the ORs a Tor circuit is using 
That's one of the places. grep for calls to control_event_circuit_status()
for what the various circ events correspond to.
(One of them is called from circuit_has_opened(), which is very near
the piece of code you pasted. And that's the only place right now that
signals a circuit has finished building.)

@_date: 2008-11-02 02:20:36
@_author: Roger Dingledine 
@_subject: Tor From SVN on Weelky Basis 
Should be fine. We try to fix known problems in svn as we encounter them,
so trunk is usually pretty stable. There are occasionally crash bugs that
take us a couple days to fix; in those cases you might want to hang out
in irc to hear how they're going. Please do report any problems you find.
So yes, at least in theory, running trunk should be fine. I keep my Tor
client as up to date as possible, to see if I can make bugs happen. I
also periodically upgrade my directory authorities to trunk to try to
get them to crash before new releases.

@_date: 2008-11-02 16:12:35
@_author: Roger Dingledine 
@_subject: exit nodes always also being middle nodes 
Actually, clients weight their path selection based on whether you're
an exit. So they look at how scarce exit bandwidth is, and choose your
exit proportionally less for non-exit positions.
which points to
and section 2.2 explains more.
We also do a similar weighting for the entry position (see section 5).

@_date: 2008-11-20 18:50:12
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.7-alpha is out 
Tor 0.2.1.7-alpha fixes a major security problem in Debian and Ubuntu
packages (and maybe other packages) noticed by Theo de Raadt, fixes
a smaller security flaw that might allow an attacker to access local
services, adds better defense against DNS poisoning attacks on exit
relays, further improves hidden service performance, and fixes a variety
of other issues.
Changes in version 0.2.1.7-alpha - 2008-11-08
  o Security fixes:
    - The "ClientDNSRejectInternalAddresses" config option wasn't being
      consistently obeyed: if an exit relay refuses a stream because its
      exit policy doesn't allow it, we would remember what IP address
      the relay said the destination address resolves to, even if it's
      an internal IP address. Bugfix on 0.2.0.7-alpha; patch by rovv.
    - The "User" and "Group" config options did not clear the
      supplementary group entries for the Tor process. The "User" option
      is now more robust, and we now set the groups to the specified
      user's primary group. The "Group" option is now ignored. For more
      detailed logging on credential switching, set CREDENTIAL_LOG_LEVEL
      in common/compat.c to LOG_NOTICE or higher. Patch by Jacob Appelbaum
      and Steven Murdoch. Bugfix on 0.0.2pre14. Fixes bug 848.
    - Do not use or believe expired v3 authority certificates. Patch
      from Karsten. Bugfix in 0.2.0.x. Fixes bug 851.
  o Minor features:
    - Now NodeFamily and MyFamily config options allow spaces in
      identity fingerprints, so it's easier to paste them in.
      Suggested by Lucky Green.
    - Implement the 0x20 hack to better resist DNS poisoning: set the
      case on outgoing DNS requests randomly, and reject responses that do
      not match the case correctly. This logic can be disabled with the
      ServerDNSRamdomizeCase setting, if you are using one of the 0.3%
      of servers that do not reliably preserve case in replies. See
      "Increased DNS Forgery Resistance through 0x20-Bit Encoding"
      for more info.
    - Preserve case in replies to DNSPort requests in order to support
      the 0x20 hack for resisting DNS poisoning attacks.
  o Hidden service performance improvements:
    - When the client launches an introduction circuit, retry with a
      new circuit after 30 seconds rather than 60 seconds.
    - Launch a second client-side introduction circuit in parallel
      after a delay of 15 seconds (based on work by Christian Wilms).
    - Hidden services start out building five intro circuits rather
      than three, and when the first three finish they publish a service
      descriptor using those. Now we publish our service descriptor much
      faster after restart.
  o Minor bugfixes:
    - Minor fix in the warning messages when you're having problems
      bootstrapping; also, be more forgiving of bootstrap problems when
      we're still making incremental progress on a given bootstrap phase.
    - When we're choosing an exit node for a circuit, and we have
      no pending streams, choose a good general exit rather than one that
      supports "all the pending streams". Bugfix on 0.1.1.x. Fix by rovv.
    - Send a valid END cell back when a client tries to connect to a
      nonexistent hidden service port. Bugfix on 0.1.2.15. Fixes bug
      840. Patch from rovv.
    - If a broken client asks a non-exit router to connect somewhere,
      do not even do the DNS lookup before rejecting the connection.
      Fixes another case of bug 619. Patch from rovv.
    - Fix another case of assuming, when a specific exit is requested,
      that we know more than the user about what hosts it allows.
      Fixes another case of bug 752. Patch from rovv.
    - Check which hops rendezvous stream cells are associated with to
      prevent possible guess-the-streamid injection attacks from
      intermediate hops. Fixes another case of bug 446. Based on patch
      from rovv.
    - Avoid using a negative right-shift when comparing 32-bit
      addresses. Possible fix for bug 845 and bug 811.
    - Make the assert_circuit_ok() function work correctly on circuits that
      have already been marked for close.
    - Fix read-off-the-end-of-string error in unit tests when decoding
      introduction points.
    - Fix uninitialized size field for memory area allocation: may improve
      memory performance during directory parsing.
    - Treat duplicate certificate fetches as failures, so that we do
      not try to re-fetch an expired certificate over and over and over.
    - Do not say we're fetching a certificate when we'll in fact skip it
      because of a pending download.

@_date: 2008-11-20 23:40:04
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.7-alpha is out 
Same exact version. We make a point of never changing stuff after we
tag a release -- if we want to fix something, we put out a new version.
I just took me a while to announce it here. :/

@_date: 2008-11-02 17:29:38
@_author: Roger Dingledine 
@_subject: Found a bug in documentation on the site? 
It's quite possible. The torify wiki pages are written by random people
who show up and add stuff.
You should feel free to fix the wiki. :)

@_date: 2008-11-22 18:43:03
@_author: Roger Dingledine 
@_subject: DoS attack 
Hi Karsten,
How did this resolve? Hopefully it ended after a while?

@_date: 2008-11-23 02:51:35
@_author: Roger Dingledine 
@_subject: Tor Exit node on Intel Atom 230 anyone? 
Just to clarify here, Tor's design resists the strategy you describe
here of logging traffic and then later breaking into the Tor relay
to get its key. The long-term identity key for a relay is only used
to sign descriptors.
The actual key exchange for circuit encryption is done with ephemeral
keys, which are discarded when the circuit is done.
I've just cleaned up the faq entry on this topic and moved it to the
new faq I've been growing:

@_date: 2008-11-23 20:47:08
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.6-alpha is out 
Is this compile error still present for 0.2.1.7-alpha? If so, can you
open a flyspray entry ( so we don't lose
track of it?
While I'm at it, why do you have "-D__DARWIN_UNIX03 -DIPHONE" as part of
your commandline? Did you run ./configure with --enable-iphone?

@_date: 2008-11-24 03:42:41
@_author: Roger Dingledine 
@_subject: bad exit blacklisting 
True, it isn't implemented anywhere yet. But it isn't hard: there are
config options for directory authorities, either by adding a torrc
line like
  authdirbadexit 87.118.97.0/24
or by adding a line like
  !badexit FFFF 4D66 0846 8650 46B1 A1F3 6AED 8C10 B841 81E8
to the approved-routers file.
My rough idea is that the script hunting for bad exits should connect to
the directory authority's control port, and change its config options as
Then the script can keep its own timestamps of when it found an address
(or netblock) to be bad, and try them again periodically, and then
forgive an address if a) it starts behaving well again, or b) it has
been offline long enough.
Of course, it needs to get a lot more testing before we'll just hook
it up to a directory authority and let it dictate which relays should
be avoided. :) Some script that an authority operator can run to say
"I just heard this relay is misbehaving. Please run some tests and
confirm or deny" would be great. The step after that would be for it
to run in the background and send mail to a list when it looks like it
found a misbehaving relay. Then the operators can investigate further.
Once we've had a human in the loop for a while and things look like
they're working smoothly, then we should take the last step of just
automating it.
Yes, having a working script to do this would be great. I've been hoping
that Mike Perry would get Torflow up and working, but so far he hasn't
found time to do it.

@_date: 2008-11-24 04:04:20
@_author: Roger Dingledine 
@_subject: Introducing Torsocks - Transparent socks for Tor 
Hi Robert,
Looks great. Can you (or somebody) confirm that it does everything it
should do on BSD and OS X? I ask because there's another tool called
dsocks, from Dug Song, that is designed for OS X and friends:
I wrote an item on the volunteer page long ago to make the torify script
smarter, so it calls tsocks or dsocks depending on which is available
and recommended for the system. See item  at
Or perhaps torsocks makes dsocks obsolete? :)

@_date: 2008-11-24 04:22:28
@_author: Roger Dingledine 
@_subject: Geo Tracing/Locate Tor Network 
[Answered earlier in the thread]
Basically it uses a city-resolution DB queried via Tor.
But see also
which describes how Tor now ships with a country-resolution geoip DB,
and some options going forward.

@_date: 2008-11-24 07:19:18
@_author: Roger Dingledine 
@_subject: Perl modules 
There aren't any in our official list, at least. All the people who
might have been perl users have moved on to python. :)
If anybody has some perl torctl libs, please let us know so we can stick
them in tor svn.

@_date: 2008-11-25 23:12:11
@_author: Roger Dingledine 
@_subject: Tor website translation. 
Actually, there's one more:
I know that because there's a list here:
and here:
That would be great! We do need more translations.
You can read all about translating the web pages here
I'm afraid it's not as easy as it could be, in that it involves
downloading text files and editing them. But if you figured out how to
use a mailing list, you should be all set. :)
More generally, we also need translations for the Vidalia GUI,
Torbutton, our installers, etc:

@_date: 2008-11-05 19:54:43
@_author: Roger Dingledine 
@_subject: DDoS attacks via TOR? 
It doesn't make any sense to DDoS people over Tor. It wouldn't work.
See also

@_date: 2008-11-09 16:44:04
@_author: Roger Dingledine 
@_subject: Kudos on memory usage in 0.2.X 
It sure did. Mainly on Linux.
Great. Glad you like it.
And if you like 0.2.0.x's memory usage, you'll like 0.2.1.x's even more! :)

@_date: 2008-10-16 19:20:34
@_author: Roger Dingledine 
@_subject: Tor Socks4a handshake error? 
Check the Tor logs for why your stream was refused. In this case it
sounds like the Tor relay you build the stream through doesn't want to
allow clients to build one-hop circuits: see also
The simplest way to fix it is to upgrade your relay to 0.2.1.6-alpha
and set
AllowSingleHopCircuits 1
AllowSingleHopExits 1
in its torrc.
More complex ways involve hacking your relay's code to permit it. Or
using two hops like you're supposed to. :)
Ok. You may be interested to know that there are known security and
performance flaws with that version -- especially when trying to connect
to the public Tor network.

@_date: 2008-10-17 15:44:41
@_author: Roger Dingledine 
@_subject: Streams are always detached.. 
You should be looking at your Tor logs (at info or debug level). They
will say why a given stream didn't fit onto a given circuit.
Note that tor26 doesn't allow exits to google. That's probably your
reason in this particular case.
See also

@_date: 2008-10-18 16:13:53
@_author: Roger Dingledine 
@_subject: German data rentention law 
The JonDos folks are nice people, but they seem to be taking the approach
"let's work with law enforcement to comply with what they wanted the law
to include." I would rather take the approach "let's figure out how we
can keep Tor users and relay operators as safe as possible even if ISPs
in Germany start logging things."
Talking with law enforcement is generally a good idea, but asking them
for clarification and then believing that's the law may not be such a
good idea.
In my opinion we really have to look at the endpoints of the Tor circuit,
which is where Tor is most vulnerable (via end-to-end correlation
attacks): we are worried about A) an attacker who can watch the Tor user,
or its network connection, or its entry relay; and B) an attacker who
can watch the destination site, or its network connection, or the exit
relay. From that perspective, an attacker who can watch the website
doesn't really care where the exit relay is -- he's already got that
half of the conversation, and if he can combine it with knowing something
about the beginning of the circuit, he wins.
Consider instead my proposal from last week on or-dev:
The basic proposal there is:
1) Never assign the Guard flag to Tor relays in Germany.
2) Maybe, consider starting circuits unpredictably before we want to
attach a stream to them (we already mostly do that, since we build
circuits preemptively), and closing circuits unpredictably after we are
done using them. The idea there is to make the TCP connection logs at
ISPs not correlate with when a given Tor stream started or stopped. I say
"maybe" because it's far from clear that all ISPs will be forced to log
TCP connection start and stop timestamps.
Note that this strategy is designed to make it safe to have Tor relays
running at *ISPs* that log. Even if no German Tor relays log, data
retention poses a serious risk to Tor users if enough ISPs are logging
There will be no such thing as a Tor relay that logs. (If you wish to
run a Tor relay that logs all its connections in a way that's useful
to attackers, please do us the favor of shutting it off instead. If you
find a way to keep logs that are absolutely useless but that you think
will keep the police from hassling you, please talk to us first.)
Idea  above solves this issue: we can take the Guard flag away at the
authorities, so only the directory authorities need to upgrade.
Even if all German Tor relays became non-exit relays, we would still have
the worry that a user visited a German website using a German *entry*
point. According to our research if an attacker manages to get data from
both sides, this appears sufficient for linking the user to the website.
So no, I think that is not a sufficient fix. :)
In any case, I don't want to reach conclusions like "therefore all
German nodes have to stop providing exit service." The law is vague --
so let's fight the law, through lawsuits and other mechanisms, not try
to guess what it might mean and obey that guess.
There *will* be people in Germany who continue to run their Tor relay
(exit or not) and do not log anything. So we need to figure out how to
make successful test cases from the organizations that have the resources
and inclination to defend themselves. (This does mean, though, that
if you're running an exit relay in Germany and you're not comfortable
fighting this law, then you should consider becoming a non-exit in
January until things get more clear.)
There will be much more discussion at 25C3 I hope!

@_date: 2008-10-18 19:03:34
@_author: Roger Dingledine 
@_subject: German data rentention law 
To be clear, I didn't write the above line.
A fine question. Hopefully as we learn more about what ISPs will log,
we will come to decide that having Tor exit relays in Germany doesn't
pose much risk -- as long as we take appropriate other steps to make
sure the other end of the circuit isn't logged by German ISPs too.
It isn't just a matter of what port they listen on. So long as there's
a public list of Tor relays, then people can just compare IP addresses
they see to the public relay list. And that public relay list isn't
going away anytime soon, since Tor clients need it when picking a path.
But that said, hiding your first hop by using an entry guard that isn't
in the public relay list may be a fine strategy. We call these non-public
relays "bridges":

@_date: 2008-10-19 14:03:59
@_author: Roger Dingledine 
@_subject: Default ORPort 443 [was: Re: German data rentention law] 
Actually, Vidalia on Windows defaults to port 443 for your relay. Windows
doesn't have this sissy concept of "privileged ports", you see. ;)
(Vidalia on non-Windows defaults to 9001 still.)
As another data point, Tor 0.2.0.3-alpha learned how to bind ports
before it drops privileges:
    - Create listener connections before we setuid to the configured
      User and Group. Now non-Windows users can choose port values
      under 1024, start Tor as root, and have Tor bind those ports
      before it changes to another UID. (Windows users could already
      pick these ports.)
So if your initscript starts Tor as root, you can just set
  ORPort 443
without messing with any port forwarding.
Debian (and thus probably Ubuntu) Tor users who use the deb can do
this now by default. Perhaps other packages will allow it soon too,
or do already?

@_date: 2008-10-19 18:06:58
@_author: Roger Dingledine 
@_subject: German data rentention law 
Great. That would make it even better.
"Some guy at 24C3 told me", I believe is what I'm working with. Lots of
rumors. It would be great to see this one turn out to be false.
That idea matches what the officers in Stuttgart told me they asked for:
But they also seemed to be under the impression they'd gotten a much
more far-reaching law than they asked for.
Quite so. Good thing all the German laws are so clear. :)
(To be fair, the amount of contradictory legal goo in other countries
is no better.)
So: if it turns out that German ISPs don't log anything related to traffic
headers, then the only remaining concern is the Germany-specific clause
about anonymizing services.
And we do not want to see any Tor relays that log traffic information. So
should Tor's role for now be to simply say "the only risk from the German
data retention law is if its vague wording convinces Tor operators
to install backdoors in their relays. If you think your new law is
enforceable, and would like to backdoor your relay, please shut it down
instead.", and then wait to see how the people fighting the law fare?
Is there anything more active that we could usefully do?
Are there actually any design changes in Tor that are needed for now?
Assuming ISPs don't suddenly start becoming logging stations, and assuming
not very many Tor relays become compromised, there really aren't any
new threats for Tor users.

@_date: 2008-10-21 15:18:57
@_author: Roger Dingledine 
@_subject: Copying Tor Directory Info 
No. That wouldn't work because 0.1.2.x uses the v2 directory scheme,
and 0.2.0.x and 0.2.1.x use the v3 directory scheme. So if you run the
newer Tor versions, they won't fetch everything that 0.1.2.x would need
to connect to the network.
You could in theory run matching versions and copy over the directory
data. I bet it would work if you try hard enough.
But might I suggest you try the Tor Browser Bundle, which uses the Tor
0.2.1.x tree and should be generally harder to block than your 0.1.2.x

@_date: 2008-10-22 12:34:49
@_author: Roger Dingledine 
@_subject: Copying Tor Directory Info 
I think you're confused. What makes you think that binaries for the
0.2.0.x and 0.2.1.x branch of Tor are not yet up? They're easy to find
on the Tor download page. Perhaps you're looking somewhere else?
Or, is it the "1.1.4" on the Tor download page (listed for the Tor
Browser Bundle) that's throwing you off?

@_date: 2008-10-22 18:23:12
@_author: Roger Dingledine 
@_subject: torproject svn changes 
is our website. We used to mirror (not very well)
some parts of the svn repository on the website. We stopped doing that
because it wasn't working very well and didn't scale to the number of
modules in the repository. You can find the correct pointers to the svn
repository here:
You might also find  to be useful (it's
another mirror of the real repository, but ought to be good enough for
most read-only uses).

@_date: 2008-10-29 17:26:06
@_author: Roger Dingledine 
@_subject: How to ban many IPs? 
Right. An exit policy with more than 50 or so lines is probably too long.
Right. We don't want to tell clients that it should work, and then have
them find that it doesn't.
The only solution we have right now is to overblock by using broad exit
policy lines. As the extreme, you might consider rejecting port 80, if
that's what you'd be mostly filtering. There are still plenty of other
useful ports.

@_date: 2008-10-31 01:03:51
@_author: Roger Dingledine 
@_subject: German data rentention law 
There are at least four reasons why this would be a bad move.
First, Tor isn't actually that bulletproof against a distributed
attacker (see all the recent papers we've been adding to
 as well as the upcoming attack papers
we keep hearing rumors about), and we don't want to make the job even
easier by making each of these relays into a juicy data target.
Second, the rest of the Tor community would not easily believe that
trading off network security for network capacity in this way is a
tradeoff they want.
Third, if Tor tolerates this law because its network architecture resists
it, and we let the law survive, then the next iteration of the law will
be better adapted to Tor's threat model.
Fourth, we don't want to undermine the effort to make this data retention
law go away, by showing "oh, the law isn't so bad".
There are still people in Germany who run high profile Tor relays and
who say they will not log. I have no interest in adding logs to Tor.
I'm still surprised at all the people who think the choice is between
keeping their Tor relay without logs or adding logging. The choice is
to keep the relay running with no logs, or to shut down the relay.
Let's beat it here and now, rather than letting them gnaw us to death.

@_date: 2008-10-08 04:37:32
@_author: Roger Dingledine 
@_subject: we seem to have another huge traffic reduction 
Interesting questions. So long as Tor seems to keep working ok for
most people as a client, I don't think there's something wrong with the
network. Some of it could be reduced directory overhead -- but directory
overhead on the server side should be easy to spot in graphs, since it
should show up as asymmetric bandwidth use.
As I mentioned earlier, we're working on plans to start gathering more
comprehensive stats on the Tor network, how Tor relays are behaving,
how client-side performance is looking, etc. This should help us be
able to answer questions like this in the future. We're keeping some
data already, so hopefully we can look into the past once we have better
tools and look for trends. Expect to hear more here in early 2009.
There shouldn't be any change between those versions, as far as I know.
It is true that 0.1.2.x fetched a networkstatus document every 30 minutes,
and 0.2.0.x and later fetch one every 2-3 hours.

@_date: 2008-10-08 05:50:31
@_author: Roger Dingledine 
@_subject: we seem to have another huge traffic reduction 
That sounds like it might be related to bug 696:
The Stable and Guard flags are not really being assigned according to
the spec, in the v3 networkstatus docs. The current theory is that this
is due to corruption in the measurements file for some of the authorities.
We could delete those garbage measurements files and it would probably
recover. But then we'd have less of a chance to figure out what the bug
was, so it would happen again sometime.
Alas, we're busy working on other features right now, so that bug is
getting left alone. Soon I hope! :)

@_date: 2008-10-08 23:34:00
@_author: Roger Dingledine 
@_subject: another DirPort DoS attacker 
Hi Scott,
I think I finally tracked down why these are happening.
They are being generated by obsolete Tors, running 0.2.0.8-alpha or
0.2.0.9-alpha. Those Tor versions are hoping to find v3 identity key
certificates from the old v3 authorities, from back before we changed
their keys due to the Debian RNG bug:
Tor periodically asks itself if it has all the v3 identity certs it
wants, and if it's missing any then it launches requests for them. The
bug introduced in 0.2.0.8-alpha (2007-10-12)
and fixed in 0.2.0.10-alpha (2007-11-10)
was that if there were currently fetches in progress for every cert
that's missing, it would make a request for "/keys/fp" rather than making
no request.
That bug isn't a big deal when the certs you want are all available. You
get them eventually, and then you don't need them anymore so you stop
the connection flood. But if no caches have the certs either, you just
keep asking for them, and whenever a request is outstanding, you go into
a tight loop of connection flooding while you wait.
The fix? Well, we can't go make those people upgrade. We don't even know
who they are. The fix I'm working on now is to generate new certs for
the two obsolete keys (only moria1 and tor26 were v3 authorities back in
version 0.2.0.9-alpha), so these old clients will finally get what they
want and shut up. (They still won't work, because the networkstatus
consensus they get won't be signed by any of the keys they demand
signatures from, but at least they'll cry quietly to themselves rather
than harming the rest of the network.)
I'll let you know how it goes,

@_date: 2008-10-01 09:18:47
@_author: Roger Dingledine 
@_subject: DoS attack 
I'm sorry to hear that. :(
Was it an exit relay?
(I don't see it in my list of relays, so I guess it has been offline
for quite a while now?)
 provides a bit of
background that may help in this case.
I doubt that the Scroogle thread is related to this. It's probably just
some jerk who also happens to own a small botnet.

@_date: 2008-10-10 15:36:38
@_author: Roger Dingledine 
@_subject: Single nodes (was same first hops) 
Tor makes its directory fetches using one-hop circuits. It started doing
this in 0.2.0.22-rc:
  - Enable encrypted directory connections by default for non-relays,
    so censor tools that block Tor directory connections based on their
    plaintext patterns will no longer work. This means Tor works in
    certain censored countries by default again.
Vidalia shows all the circuits, because it can't really distinguish what
you (or your Tor) are planning to use the circuit for.
Down the road, we may switch it so it makes these one-hop circuits to your
entry guards. No point revealing your existence to any more relays than
you have to. The phrase for this new design would be "directory guards";
you can see it scattered about the TODO file and roadmaps.

@_date: 2008-10-10 19:01:45
@_author: Roger Dingledine 
@_subject: Single nodes (was same first hops) 
You can find two of them in
Alas, they're not exactly well fleshed out. I've been working on a newer
version that captures more of what we've been up to lately and what we
hope to be up to in the next several years. Stay tuned.
As for the TODO list, take a look at

@_date: 2008-10-11 09:00:05
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.6-alpha is out 
Tor 0.2.1.6-alpha further improves performance and robustness of hidden
services, starts work on supporting per-country relay selection, and
fixes a variety of smaller issues.
Changes in version 0.2.1.6-alpha - 2008-09-30
  o Major features:
    - Implement proposal 121: make it possible to build hidden services
      that only certain clients are allowed to connect to. This is
      enforced at several points, so that unauthorized clients are unable
      to send INTRODUCE cells to the service, or even (depending on the
      type of authentication) to learn introduction points. This feature
      raises the bar for certain kinds of active attacks against hidden
      services. Code by Karsten Loesing.
    - Relays now store and serve v2 hidden service descriptors by default,
      i.e., the new default value for HidServDirectoryV2 is 1. This is
      the last step in proposal 114, which aims to make hidden service
      lookups more reliable.
    - Start work to allow node restrictions to include country codes. The
      syntax to exclude nodes in a country with country code XX is
      "ExcludeNodes {XX}". Patch from Robert Hogan. It still needs some
      refinement to decide what config options should take priority if
      you ask to both use a particular node and exclude it.
    - Allow ExitNodes list to include IP ranges and country codes, just
      like the Exclude*Nodes lists. Patch from Robert Hogan.
  o Major bugfixes:
    - Fix a bug when parsing ports in tor_addr_port_parse() that caused
      Tor to fail to start if you had it configured to use a bridge
      relay. Fixes bug 809. Bugfix on 0.2.1.5-alpha.
    - When extending a circuit to a hidden service directory to upload a
      rendezvous descriptor using a BEGIN_DIR cell, almost 1/6 of all
      requests failed, because the router descriptor had not been
      downloaded yet. In these cases, we now wait until the router
      descriptor is downloaded, and then retry. Likewise, clients
      now skip over a hidden service directory if they don't yet have
      its router descriptor, rather than futilely requesting it and
      putting mysterious complaints in the logs. Fixes bug 767. Bugfix
      on 0.2.0.10-alpha.
    - When fetching v0 and v2 rendezvous service descriptors in parallel,
      we were failing the whole hidden service request when the v0
      descriptor fetch fails, even if the v2 fetch is still pending and
      might succeed. Similarly, if the last v2 fetch fails, we were
      failing the whole hidden service request even if a v0 fetch is
      still pending. Fixes bug 814. Bugfix on 0.2.0.10-alpha.
    - DNS replies need to have names matching their requests, but
      these names should be in the questions section, not necessarily
      in the answers section. Fixes bug 823. Bugfix on 0.2.1.5-alpha.
  o Minor features:
    - Update to the "September 1 2008" ip-to-country file.
    - Allow ports 465 and 587 in the default exit policy again. We had
      rejected them in 0.1.0.15, because back in 2005 they were commonly
      misconfigured and ended up as spam targets. We hear they are better
      locked down these days.
    - Use a lockfile to make sure that two Tor processes are not
      simultaneously running with the same datadir.
    - Serve the latest v3 networkstatus consensus via the control
      port. Use "getinfo dir/status-vote/current/consensus" to fetch it.
    - Better logging about stability/reliability calculations on directory
      servers.
    - Drop the requirement to have an open dir port for storing and
      serving v2 hidden service descriptors.
    - Directory authorities now serve a /tor/dbg-stability.txt URL to
      help debug WFU and MTBF calculations.
    - Implement most of Proposal 152: allow specialized servers to permit
      single-hop circuits, and clients to use those servers to build
      single-hop circuits when using a specialized controller. Patch
      from Josh Albrecht. Resolves feature request 768.
    - Add a -p option to tor-resolve for specifying the SOCKS port: some
      people find host:port too confusing.
    - Make TrackHostExit mappings expire a while after their last use, not
      after their creation.  Patch from Robert Hogan.
    - Provide circuit purposes along with circuit events to the controller.
  o Minor bugfixes:
    - Fix compile on OpenBSD 4.4-current. Bugfix on 0.2.1.5-alpha.
      Reported by Tas.
    - Fixed some memory leaks -- some quite frequent, some almost
      impossible to trigger -- based on results from Coverity.
    - When testing for libevent functions, set the LDFLAGS variable
      correctly. Found by Riastradh.
    - Fix an assertion bug in parsing policy-related options; possible fix
      for bug 811.
    - Catch and report a few more bootstrapping failure cases when Tor
      fails to establish a TCP connection. Cleanup on 0.2.1.x.
    - Avoid a bug where the FastFirstHopPK 0 option would keep Tor from
      bootstrapping with tunneled directory connections. Bugfix on
      0.1.2.5-alpha. Fixes bug 797. Found by Erwin Lam.
    - When asked to connect to A.B.exit:80, if we don't know the IP for A
      and we know that server B rejects most-but-not all connections to
      port 80, we would previously reject the connection. Now, we assume
      the user knows what they were asking for. Fixes bug 752. Bugfix
      on 0.0.9rc5. Diagnosed by BarkerJr.
    - If we are not using BEGIN_DIR cells, don't attempt to contact hidden
      service directories if they have no advertised dir port. Bugfix
      on 0.2.0.10-alpha.
    - If we overrun our per-second write limits a little, count this as
      having used up our write allocation for the second, and choke
      outgoing directory writes. Previously, we had only counted this when
      we had met our limits precisely. Fixes bug 824. Patch from by rovv.
      Bugfix on 0.2.0.x (??).
    - Avoid a "0 divided by 0" calculation when calculating router uptime
      at directory authorities. Bugfix on 0.2.0.8-alpha.
    - Make DNS resolved controller events into "CLOSED", not
      "FAILED". Bugfix on 0.1.2.5-alpha. Fix by Robert Hogan. Resolves
      bug 807.
    - Fix a bug where an unreachable relay would establish enough
      reachability testing circuits to do a bandwidth test -- if
      we already have a connection to the middle hop of the testing
      circuit, then it could establish the last hop by using the existing
      connection. Bugfix on 0.1.2.2-alpha, exposed when we made testing
      circuits no longer use entry guards in 0.2.1.3-alpha.
    - If we have correct permissions on $datadir, we complain to stdout
      and fail to start. But dangerous permissions on
      $datadir/cached-status/ would cause us to open a log and complain
      there. Now complain to stdout and fail to start in both cases. Fixes
      bug 820, reported by seeess.
    - Remove the old v2 directory authority 'lefkada' from the default
      list. It has been gone for many months.
  o Code simplifications and refactoring:
    - Revise the connection_new functions so that a more typesafe variant
      exists. This will work better with Coverity, and let us find any
      actual mistakes we're making here.
    - Refactor unit testing logic so that dmalloc can be used sensibly
      with unit tests to check for memory leaks.
    - Move all hidden-service related fields from connection and circuit
      structure to substructures: this way they won't eat so much memory.

@_date: 2008-10-11 09:03:23
@_author: Roger Dingledine 
@_subject: Work on tor 
Step one is to go through the "getting up to speed" items at
There's also plenty to look at on Step two is probably to hang out on IRC (both  and  and get a
sense of what's being worked on and what people are having troubles with.
As for suggestions, you should pick the bugs or missing features that
are bothering you most. :)

@_date: 2008-10-11 21:46:43
@_author: Roger Dingledine 
@_subject: Thesis: Improving Tor using a TCP-over-DTLS Tunnel 
Hi folks,
Joel Reardon has finished his thesis at U Waterloo under the guidance
of Ian Goldberg. He looked at switching Tor's transport from TCP to
UDP. There are still many unsolved problems before we can do the switch,
but the thesis walks through a lot of the issues as well as future
work. It's definitely worth a look.

@_date: 2008-09-13 01:22:36
@_author: Roger Dingledine 
@_subject: invitation to directory server operators 
I think you're confused about the role of defaults, Scott. Anything that
we want to have enabled throughout most of the network should be on
by default. We should assume that the vast majority of people who run
relays don't follow or-talk.
The reason "hsdir" hadn't been on by defauly yet was because we were still
(slowly) working on stability and edge cases like the one Andrew produced.
Now that it's on by default, I expect to see the numbers slowly climbing,
especially first among the folks who update from svn nightly.
I should also clarify that the hsdir flag is only for Karsten's v2 hidden
service design (see e.g. proposal 114). All hidden services still publish
the old v0 way too, and all clients still fetch the old v0 way too.
On a much more theoretical note, this "choose a good default" discussion
reminds me of Section 4 of

@_date: 2008-09-15 14:25:21
@_author: Roger Dingledine 
@_subject: Proposed student project 
Two thoughts come to mind immediately. First, you will want to use
Tor's transparent proxy interface with iptables / pf:
You might like Incognito's firewall rules:
For the software side, you should look at coderman's draft thoughts on
a self-contained Tor in a VM:
Second, if you want this Tor to be able to act as a relay too (aka a Tor
server), it will need some non-trivial hardware. Exactly what hardware is
needed is an open question, and worth exploring more. The Tor software
development process seems to have cycles where we 1) accidentally cause
Tor to use too many resources, then 2) fix that, then go back to 1.
So some versions of Tor are much more friendly, cpu and memory wise,
than others. The current 0.2.1.5-alpha version is quite good I believe.
You may find that some config details, like how much rate limiting the
user wants to put in place, are hard to guess automatically.

@_date: 2008-09-22 16:21:40
@_author: Roger Dingledine 
@_subject: Attempting to connect to nodes in bogon space 
These are probably reachability testing for Tor relays that configured
themselves with weird IP addresses.
For the most part they will realize that they're not reachable, and not
even try to publish their descriptors to the directory.
For those that do publish, the directory authorities will find them
unreachable, and not give them the Running flag. So clients will ignore

@_date: 2008-09-04 00:36:47
@_author: Roger Dingledine 
@_subject: Ports 465/587 in exit policy (was Re: Update to default exit policy) 
Hi Dawn,
Thanks for sticking with this. I'm probably the closest person there is
for changing the default exit policy. I confess I still haven't worked
my way through all the off-topic garbage on or-talk from a few weeks ago.
Unfortunately, I'm not up on all the different ways that people screw up
configuring their mail services these days. Back in 2005 when we first
added 465 and 587 to the exit policies:
we did it because people showed up and explained that many sites were
running services on those ports that were basically equivalent to what
they run on port 25.
It sounds like nobody has any objections to opening these ports back up.
And it sounds like it could help those folks using gmail, etc.
So I am inclined to do it.
We can do it in the 0.2.1.x development series, and that way it'll be
pretty easy to change our minds if anything comes up.
(Ultimately, I don't think it should even be necessary to reject port
25 by default. The spammers are doing great on the Internet already,
and Tor is tremendously inefficient compared to the spamming engines
they use now. But these economic arguments are too subtle when used on a
really really angry person, so we've preferred the simpler "Tor doesn't
allow that" approach so far.)

@_date: 2008-09-09 06:42:02
@_author: Roger Dingledine 
@_subject: peculiar server "bandwidth" posted by server "mnl" and possible new type of attack 
Wow. Nice! :)
And, as you say, unlikely to be true.
Yep. Probably an integer underflow somewhere.
There has been quite a bit of work on this one, at least.
First, clients use the min of the bandwidthrate and the measured
bandwidth, so in the above "5242880 10485760 52239166" example clients
will load-balance based on 5242880. So this bug doesn't have any real
effect, at least in this case.
Also, clients cap the number they'll believe at 10MB, so an evil relay
can only sucker people so much.
There are research designs for doing community-measured bandwidth
numbers, which would make it much harder for an evil relay to sucker
people. See for example Unfortunately, all of these designs have downsides currently, so they're
not ready for deployment yet.
We're working on plans to start gathering more methodical data about
how the network has run and is running, with the goal of being able to
answer questions like this more usefully.
Another example I'd love to investigate is the apparent feedback effect --
once a relay happens to have a high-volume flow through it, it tends to
continue to advertise high bandwidth numbers for weeks after, whereas if
it doesn't start with any high-volume flows, it never seems to attract
them later.
My guess is that the current slowdown is due to a combination of fewer
file-sharing users (which, if true, will alas probably pass) and Tor's
not-as-optimal-as-it-should-be load balancing algorithm. In particular,
our load balancing algorithm produces high variance. Or said more
normally, the speed you get is wildly unpredictable, sometimes really
good and sometimes really awful -- and we need to cut down on the
frequency of 'really awful'.
So, stay tuned, but be patient. I'm hoping that we'll have that "metrics
and measurements" plan ramped up sometime in early 2009 -- with people
paid to focus on it, even. :)
In the meantime, perhaps we can get some more intuition about this
particular slowdown. For example, does it happen for 0.2.0.x relays and
not 0.1.2.x relays?

@_date: 2008-09-10 14:05:53
@_author: Roger Dingledine 
@_subject: peculiar server "bandwidth" posted by server "mnl" and possible new type of attack 
This explains it. grep the logs for "consensus":
Sep 08 06:41:43.220 [warn] Our clock is 5 hours, 19 minutes behind the time published in the consensus network status document (2008-09-08 10:00:00 GMT).  Tor needs an accurate clock to work correctly. Please check your time and date settings!
Sep 08 07:28:28.888 [warn] Our clock is 5 hours, 31 minutes behind the time published in the consensus network status document (2008-09-08 11:00:00 GMT).  Tor needs an accurate clock to work correctly. Please check your time and date settings!
The clock jumps around wildly, e.g.:
Sep 08 13:25:40.205 [warn] Our clock is 5 hours, 36 minutes behind the time published in the consensus network status document (2008-09-08 17:00:00 GMT).  Tor needs an accurate clock to work correctly. Please check your time and date settings!
Sep 08 13:54:04.349 [warn] Our clock is 11 hours, 5 minutes behind the time published in the consensus network status document (2008-09-08 23:00:00 GMT).  Tor needs an accurate clock to work correctly. Please check your time and date settings!
It looks like if you go back in time at just the right moment, you screw
up the bandwidth counting mechanism.

@_date: 2008-09-10 14:52:28
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.5-alpha is out 
Tor 0.2.1.5-alpha moves us closer to handling IPv6 destinations,
puts in a lot of the infrastructure for adding authorization to hidden
services, lays the groundwork for having clients read their load balancing
information out of the networkstatus consensus rather than the individual
router descriptors, addresses two potential anonymity issues, and fixes
a variety of smaller issues.
This development release has a known bug when you configure it to use
bridge relays; we recommend that bridge users wait for the next release.
Changes in version 0.2.1.5-alpha - 2008-08-31
  o Major features:
    - Convert many internal address representations to optionally hold
      IPv6 addresses.
    - Generate and accept IPv6 addresses in many protocol elements.
    - Make resolver code handle nameservers located at ipv6 addresses.
    - Begin implementation of proposal 121 ("Client authorization for
      hidden services"): configure hidden services with client
      authorization, publish descriptors for them, and configure
      authorization data for hidden services at clients. The next
      step is to actually access hidden services that perform client
      authorization.
    - More progress toward proposal 141: Network status consensus
      documents and votes now contain bandwidth information for each
      router and a summary of that router's exit policy. Eventually this
      will be used by clients so that they do not have to download every
      known descriptor before building circuits.
  o Major bugfixes (on 0.2.0.x and before):
    - When sending CREATED cells back for a given circuit, use a 64-bit
      connection ID to find the right connection, rather than an addr:port
      combination. Now that we can have multiple OR connections between
      the same ORs, it is no longer possible to use addr:port to uniquely
      identify a connection.
    - Relays now reject risky extend cells: if the extend cell includes
      a digest of all zeroes, or asks to extend back to the relay that
      sent the extend cell, tear down the circuit. Ideas suggested
      by rovv.
    - If not enough of our entry guards are available so we add a new
      one, we might use the new one even if it overlapped with the
      current circuit's exit relay (or its family). Anonymity bugfix
      pointed out by rovv.
  o Minor bugfixes:
    - Recover 3-7 bytes that were wasted per memory chunk. Fixes bug
      794; bug spotted by rovv. Bugfix on 0.2.0.1-alpha.
    - When using the TransPort option on OpenBSD, and using the User
      option to change UID and drop privileges, make sure to open /dev/pf
      before dropping privileges. Fixes bug 782. Patch from Christopher
      Davis. Bugfix on 0.1.2.1-alpha.
    - Correctly detect the presence of the linux/netfilter_ipv4.h header
      when building against recent kernels. Bugfix on 0.1.2.1-alpha.
    - Add a missing safe_str() call for a debug log message.
    - Use 64 bits instead of 32 bits for connection identifiers used with
      the controller protocol, to greatly reduce risk of identifier reuse.
    - Make the autoconf script accept the obsolete --with-ssl-dir
      option as an alias for the actually-working --with-openssl-dir
      option. Fix the help documentation to recommend --with-openssl-dir.
      Based on a patch by "Dave". Bugfix on 0.2.0.1-alpha.
  o Minor features:
    - Rate-limit too-many-sockets messages: when they happen, they happen
      a lot. Resolves bug 748.
    - Resist DNS poisoning a little better by making sure that names in
      answer sections match.
    - Print the SOCKS5 error message string as well as the error code
      when a tor-resolve request fails. Patch from Jacob.

@_date: 2008-09-10 23:10:19
@_author: Roger Dingledine 
@_subject: Error help: Tunnel to dirserver failed 
The fix will be included in an upcoming release.
It should still work (most of the time ;), despite the complaints.

@_date: 2008-09-12 05:42:53
@_author: Roger Dingledine 
@_subject: Tor's startup anonymity warning (was Re: quick question) 
When Tor 1.0 is released, and we understand good clean metrics for
anonymity, and we're satisfied with the amount that all of our users
achieve. :)
Given the rate of discovery of great new attacks on anonymity designs
in general, I am not optimistic that this will be anytime soon. :(
But we can continue to do better, and we're doing pretty well -- Tor is
already the best option out there. We mostly leave the warning there
as a disclaimer to make sure that nobody gets suckered into believing
that just because they installed Tor they are now totally immune from
all possible worries.
It makes me a bit sad that we might be pushing users onto the commercial
snakeoil anonymity systems who studiously avoid admitting that there
could be possible attacks. But I would feel a lot more sad if we joined
the ranks of the folks trying to brush everything under the rug.
The fact is that the state of the art in anonymity isn't yet to the point
where we can use an anonymity tool without understanding the details of
where and how you might be vulnerable. One day.
But all of that said, the current phrase "This is experimental
software. Do not rely on it for strong anonymity" probably doesn't
capture the above very well. How can we improve it?

@_date: 2009-04-27 17:32:16
@_author: Roger Dingledine 
@_subject: 25 tbreg relays in directory 
Interesting question.
moria1 currently has 368 descriptors from relays with the nickname
"tbreg", with 272 unique IP addresses. moria1 is voting about 67 distinct
tbreg relays, and it believes 15 of them are Running.
The other interesting feature is that they all say
platform Tor 0.2.1.2-alpha (r15383) on Windows XP Service Pack 2 [workstation] { terminal services, single user}
But the identity keys are generally different.
So it looks to me like somebody created a "ready-made" Tor relay image,
and has a lot of people running it. The only reason we're noticing at
all is because their relay image sets the nickname to tbreg.
Now, is this because of a massive Chinese conspiracy to flood the Tor
network with a block of centrally controlled Windows relays, or is it a
whole lot of excited Tor users in China who really want to help out but
don't realize that they're using an insecure and old version of Tor? You
decide. :)

@_date: 2009-04-30 10:46:29
@_author: Roger Dingledine 
@_subject: Tor questions 
See section 1.1 of
but then see also section 3.7 of the above pdf.

@_date: 2009-04-01 08:29:48
@_author: Roger Dingledine 
@_subject: descriptor lost by authorities? 
Hm. moria1 isn't voting for it either, currently.
The last descriptor I have for it is from
published 2009-03-31 11:24:33
(GMT) which matches your first log lines.
I'd like to know why also. :) There's no hint in moria1's logs about
rejecting it for whatever reason. Can you post more of your info-level
logs around the "Apr 01 00:25:03.710" timeframe? (If it's large, no need
to spam all 1000+ people on this list.)
The best theory I've heard so far for this phenomenon is that a brief
network hiccup around the time of publishing will make you fail to upload,
and you won't try for another 18 hours (meaning 12 hours of being missing
from the consensus).
We have some partial plans for having relays recognize when their upload
failed: see directories_have_accepted_server_descriptor() and look for
"rejected = 1" in connection_dir_client_reached_eof(), both in
but for various reasons we haven't finished that feature yet.
It would be good to confirm if this is what's going wrong, or if it's
something else. I'm going to put yet more debugging log messages in,
both on the relay side and the authority side, to help track this down.

@_date: 2009-04-14 10:27:46
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.14-rc is out 
Tor 0.2.1.14-rc marks the first release candidate for the 0.2.1.x
series. It begins fixing some major performance problems, and also finally
addresses the bug that was causing relays on dynamic IP addresses to
fall out of the directory.
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.1.14-rc - 2009-04-12
  o Major features:
    - Clients replace entry guards that were chosen more than a few months
      ago. This change should significantly improve client performance,
      especially once more people upgrade, since relays that have been
      a guard for a long time are currently overloaded.
  o Major bugfixes (on 0.2.0):
    - Finally fix the bug where dynamic-IP relays disappear when their
      IP address changes: directory mirrors were mistakenly telling
      them their old address if they asked via begin_dir, so they
      never got an accurate answer about their new address, so they
      just vanished after a day. For belt-and-suspenders, relays that
      don't set Address in their config now avoid using begin_dir for
      all direct connections. Should fix bugs 827, 883, and 900.
    - Relays were falling out of the networkstatus consensus for
      part of a day if they changed their local config but the
      authorities discarded their new descriptor as "not sufficiently
      different". Now directory authorities accept a descriptor as changed
      if bandwidthrate or bandwidthburst changed. Partial fix for bug 962;
      patch by Sebastian.
    - Avoid crashing in the presence of certain malformed descriptors.
      Found by lark, and by automated fuzzing.
  o Minor features:
    - When generating circuit events with verbose nicknames for
      controllers, try harder to look up nicknames for routers on a
      circuit. (Previously, we would look in the router descriptors we had
      for nicknames, but not in the consensus.) Partial fix for bug 941.
    - If the bridge config line doesn't specify a port, assume 443.
      This makes bridge lines a bit smaller and easier for users to
      understand.
    - Raise the minimum bandwidth to be a relay from 20000 bytes to 20480
      bytes (aka 20KB/s), to match our documentation. Also update
      directory authorities so they always assign the Fast flag to relays
      with 20KB/s of capacity. Now people running relays won't suddenly
      find themselves not seeing any use, if the network gets faster
      on average.
    - Update to the "April 3 2009" ip-to-country file.
  o Minor bugfixes:
    - Avoid trying to print raw memory to the logs when we decide to
      give up on downloading a given relay descriptor. Bugfix on
      0.2.1.9-alpha.
    - In tor-resolve, when the Tor client to use is specified by
      :, actually use the specified port rather than
      defaulting to 9050. Bugfix on 0.2.1.6-alpha.
    - Make directory usage recording work again. Bugfix on 0.2.1.6-alpha.
    - When starting with a cache over a few days old, do not leak
      memory for the obsolete router descriptors in it. Bugfix on
      0.2.0.33.
    - Avoid double-free on list of successfully uploaded hidden
      service discriptors. Fix for bug 948. Bugfix on 0.2.1.6-alpha.
    - Change memarea_strndup() implementation to work even when
      duplicating a string at the end of a page. This bug was
      harmless for now, but could have meant crashes later. Fix by
      lark. Bugfix on 0.2.1.1-alpha.
    - Limit uploaded directory documents to be 16M rather than 500K.
      The directory authorities were refusing v3 consensus votes from
      other authorities, since the votes are now 504K. Fixes bug 959;
      bugfix on 0.0.2pre17 (where we raised it from 50K to 500K ;).
    - Directory authorities should never send a 503 "busy" response to
      requests for votes or keys. Bugfix on 0.2.0.8-alpha; exposed by
      bug 959.

@_date: 2009-04-19 17:28:42
@_author: Roger Dingledine 
@_subject: tor removed from ubuntu jaunty 
Yep. You can read a lot more about it here:
and back from 2007 here:
 at lists.ubuntu.com/msg24404.html
Ubuntu hardy and intrepid are still shipping known-remote-vulnerable
versions of Tor. The version they have in Intrepid is even
known-remote-root-vulnerable. And they still haven't gotten around to
fixing it.
If you're going to include Tor in your distribution, you really have
to maintain it. Since Ubuntu doesn't maintain packages in its Universe,
it seemed like the smartest move to make sure we don't keep having this
problem with every new Ubuntu version.
You can find well-maintained Ubuntu packages here:
I presume we'll put up jaunty packages when jaunty goes stable. In the
mean time, I hear the intrepid packages work fine on jaunty. (Let me
know if that's wrong, and I'll ask Peter to consider setting up a jaunty
build environment sooner.)

@_date: 2009-08-15 08:52:03
@_author: Roger Dingledine 
@_subject: Are keywords and values in "torrc" (and other) config files case-sensitive? 
The keywords are case-insensitive. So ExitNodes and exitnodes are
Whether the values are case-insensitive depends on which keyword we're
talking about. For {us} vs {US}, they should both work fine.

@_date: 2009-08-19 17:24:57
@_author: Roger Dingledine 
@_subject: Roger's HAR2009 talk on Tor performance 
Right. For those who like to see the links too, see

@_date: 2009-08-20 11:43:04
@_author: Roger Dingledine 
@_subject: Solaris10/Sparc, tor and threads 
Well, Tor still can use your other CPUs -- it falls back from threading
to forking. Be sure to set "numcpus 4" if you want to use all of them.
(Alas, Tor only uses cpuworkers for decrypting create cells -- it doesn't
use them for AES or for TLS. So it doesn't balance load over multiple
CPUs nearly as well as it could. That's on the low-priority todo list.
Patches appreciated. ;)
Long ago, we got reports of Tors crashing when trying to use threads.
That was many years ago now though, so it could be that it works better
now. Does Solaris support pthreads correctly, or does it prefer its own
native version that we'd need to teach Tor about?
You could try it and find out. :)
I think you'd need to edit configure.in and modify this part:
if test x$enable_threads = x; then
   case $host in
    *-*-solaris* )

@_date: 2009-08-21 20:16:39
@_author: Roger Dingledine 
@_subject: Annoying loop situation 
That's because Torbutton watches your proxy settings and tries to make
sure that whatever status it's displaying matches your current proxy
That is, if anything ever changes your proxy settings so your Firefox
is now configured to use the settings that Torbutton would use when you
click 'enable', then Torbutton will change status to show you that your
proxy settings are pointing to Tor.
It looks like you're using Torbutton to point to Privoxy, but you're
using Privoxy directly rather than pointing it into Tor. That's fine
(as long as you know what you're doing), but Torbutton can't tell the
Hm. Back in the day when Torbutton was just a proxy toggler, it made a lot
of sense to have Torbutton update its status to reflect what your proxy
settings 'really' are. But now that Torbutton does all sorts of other
application-level things, it is plausible that you might want to have
your proxy settings set up in a way that looks identical to Tor, yet you
don't want the other application-level protections that Torbutton adds.
But then, isn't this a really special case? For example, if you run your
Privoxy on a different port, then you won't confuse Torbutton.

@_date: 2009-08-10 14:59:00
@_author: Roger Dingledine 
@_subject: Tor and system time 
Yes. How you do this depends on what platform you're on, but generally
your goal is to get an NTP (network time protocol) client going.
"In general, the complete connection between client and hidden service
consists of 6 relays: 3 of them were picked by the client with the
third being the rendezvous point and the other 3 were picked by the
hidden service."

@_date: 2009-12-29 22:07:57
@_author: Roger Dingledine 
@_subject: Fix the middle router in Tor path ? 
Nope. Not in the Tor config file at least.
You could control your whole path selection by using the Tor control
But that's probably overkill for 'just for fun'.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-12-05 15:34:27
@_author: Roger Dingledine 
@_subject: I exclude all bloxortsipt nodes in my tor use 
I've been keeping an eye on the bloxortsipt nodes off and on.
Looking at my cached-consensus file, there are 7 of them running currently
(2 of which are offering 0 bandwidth so clients will mostly ignore
them). Of those 5, they're offering a total bandwidth of 102 KB.
The total bandwidth mentioned in cached-consensus is 1354016 KB.
So "that large of a percent of my total Tor traffic" is in this
case 102/1354016 = .0075% of the Tor network.
You might instead ask about blutmagie, which at an advertised 41200 KB
is 3% of the Tor network.
The other thing to note is that none of the bloxortsipt nodes have either
the Exit or the Guard flag. So for normal circuits, they're never going
to see you or your destinations.
So I'm going to go with "Helping us all, because he loves us all so
What's wrong with the Family line? It's long, but it looks well-formed
to me.
I think this is a bad idea. Whenever your behavior is different from
the hundreds of thousands of other Tor users, you stand out and open
up ways that an attacker can recognize you. In this case the difference
in behavior is trivial, so not a big deal. But still it's something to
think harder about.
Rather than just excluding them and hoping that doesn't burn you, why
not contact him and ask what's up? Perhaps he's bundled a Tor relay with
some other software or hardware he maintains.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-12-18 17:24:42
@_author: Roger Dingledine 
@_subject: doesn't take long for the dmca's notices to start rolling in.. 
Good luck!
As another direction to consider, I've found that a more personal
interaction often has better results. It's easy for them to say "I don't
want to deal with this email from some guy I've never met", and harder
for them to think that once you've had coffee with them and explained
what Tor is.
Other reading options include:
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-12-01 18:38:42
@_author: Roger Dingledine 
@_subject: (FWD) Re: Good and bad ISP in Germany and around ? 
[Forwarding because Alex isn't subscribed to the list at this address.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-12-22 03:20:43
@_author: Roger Dingledine 
@_subject: Problems with setting up a private Tor network and setting up your own Tor relay(s) 
Should work. I just set one up with two directory authorities and 5
relays, to test. Worked fine.
By "onion proxy" I think you mean "Tor client"? My, that terminology
takes me back. :)
Where is your privoxy forwarding to?
I notice in the torrc that you pasted you don't say "SocksPort 0" on
your relays. Are they all on separate IP addresses, so each of them can
bind to the default socksport (9050)?
What do the logs for your Tor client say?
What does the torrc for your Tor client look like? Perhaps you have
'SocksPolicy' or some similar option set?
Ah ha. Yes, Tor won't let you use the same node as both the beginning
and the end of a circuit. More generally, Tor will fight back pretty hard
about putting the same node in more than one position in a circuit. You'll
have to use the control protocol to manually 'EXTENDCIRCUIT' and specify
them both. Even in that case, you'll want to have two nodes in between,
since 0.2.0.31 introduced
  - Relays now reject risky extend cells: if the extend cell includes
    a digest of all zeroes, or asks to extend back to the relay that
    sent the extend cell, tear down the circuit. Ideas suggested
    by rovv.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-12-24 03:44:00
@_author: Roger Dingledine 
@_subject: Many Vietnamese exit-nodes: what does it mean? 
Looking at
I see two relays in Vietnam. Only one -- hanhphuc -- is of much
consequence. Neither of them are exit relays. So I would expect that
you would never see a Vietnamese IP address as your exit relay.
Perhaps you are confused about what country the IP addresses are
associated with?
...Or perhaps I am? :) (Check out how many nodes on that site are
allegedly affiliated with Namibia, to get a sense of how effective geoip
db's are these days.)
I think that's a pretty big leap. Why not first suspect that the
several-dozen relays in Russia are operated by Russian intelligence?
More generally, I think the odds are better that relays (both in Russia
and in Vietnam if we were to get some) are run by good people, and
telephone companies / country-wide networks are monitored by intelligence
services. And then comes the question of where your destination website
is and who's watching *it*. Things get complex quickly.
I'd be surprised. Why run a Tor relay of your own when you can just
watch somebody else's?
I guess it's hard to answer any theory that includes the phrase
"unintelligible purposes". :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-02-17 15:04:13
@_author: Roger Dingledine 
@_subject: another reason to keep ExcludeNodes 
Hey, that brings up another possible attack. What if a website keeps
giving out partial pages in response to exit nodes that it doesn't like
(for example because it can't monitor them), to encourage users to
manually mark them as excludeexit, thus making sure that user won't use
those exits for other sites either?
It wouldn't break anonymity outright, but it would certainly make the
probabilities more complex to reason about.
Rabbit holes within rabbit holes,

@_date: 2009-02-09 16:44:14
@_author: Roger Dingledine 
@_subject: another BADEXIT found $8424E8653469B1EFF87E79E8599933A3BAF8FDB2 
Peter and I added it as a BadExit, so it should be taken care of.
(It's not Running anymore either, so it's no longer in the consensus
It is progressing. You can follow mikeperry's commits on the or-cvs list
if you like, too.

@_date: 2009-02-09 18:04:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.12-alpha is out 
Tor 0.2.1.12-alpha features several more security-related fixes. You
should upgrade, especially if you run an exit relay (remote crash) or
a directory authority (remote infinite loop), or you're on an older
(pre-XP) or not-recently-patched Windows (remote exploit). It also
includes a big pile of minor bugfixes and cleanups.
Changes in version 0.2.1.12-alpha - 2009-02-08
  o Security fixes:
    - Fix an infinite-loop bug on handling corrupt votes under certain
      circumstances. Bugfix on 0.2.0.8-alpha.
    - Fix a temporary DoS vulnerability that could be performed by
      a directory mirror. Bugfix on 0.2.0.9-alpha; reported by lark.
    - Avoid a potential crash on exit nodes when processing malformed
      input. Remote DoS opportunity. Bugfix on 0.2.1.7-alpha.
  o Minor bugfixes:
    - Let controllers actually ask for the "clients_seen" event for
      getting usage summaries on bridge relays. Bugfix on 0.2.1.10-alpha;
      reported by Matt Edman.
    - Fix a compile warning on OSX Panther. Fixes bug 913; bugfix against
      0.2.1.11-alpha.
    - Fix a bug in address parsing that was preventing bridges or hidden
      service targets from being at IPv6 addresses.
    - Solve a bug that kept hardware crypto acceleration from getting
      enabled when accounting was turned on. Fixes bug 907. Bugfix on
      0.0.9pre6.
    - Remove a bash-ism from configure.in to build properly on non-Linux
      platforms. Bugfix on 0.2.1.1-alpha.
    - Fix code so authorities _actually_ send back X-Descriptor-Not-New
      headers. Bugfix on 0.2.0.10-alpha.
    - Don't consider expiring already-closed client connections. Fixes
      bug 893. Bugfix on 0.0.2pre20.
    - Fix another interesting corner-case of bug 891 spotted by rovv:
      Previously, if two hosts had different amounts of clock drift, and
      one of them created a new connection with just the wrong timing,
      the other might decide to deprecate the new connection erroneously.
      Bugfix on 0.1.1.13-alpha.
    - Resolve a very rare crash bug that could occur when the user forced
      a nameserver reconfiguration during the middle of a nameserver
      probe. Fixes bug 526. Bugfix on 0.1.2.1-alpha.
    - Support changing value of ServerDNSRandomizeCase during SIGHUP.
      Bugfix on 0.2.1.7-alpha.
    - If we're using bridges and our network goes away, be more willing
      to forgive our bridges and try again when we get an application
      request. Bugfix on 0.2.0.x.
  o Minor features:
    - Support platforms where time_t is 64 bits long. (Congratulations,
      NetBSD!) Patch from Matthias Drochner.
    - Add a 'getinfo status/clients-seen' controller command, in case
      controllers want to hear clients_seen events but connect late.
  o Build changes:
    - Disable GCC's strict alias optimization by default, to avoid the
      likelihood of its introducing subtle bugs whenever our code violates
      the letter of C99's alias rules.

@_date: 2009-02-10 04:54:29
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.12-alpha is out 
You should set your MaxAdvertisedBandwidth line in your torrc, at a
low enough number that it's advertising a rate that doesn't cause those
log entries.
(If you ignore them, you are denying service to clients who are trying
to use your relay and failing.)
Eventually, you're right, we should design a Tor network and protocol
where each relay doesn't have to reach each other relay. That's harder
than it sounds, though, if you want to keep anonymity and have low
directory overhead too.
Why is raising ulimit -n not an option for you?

@_date: 2009-02-10 14:59:44
@_author: Roger Dingledine 
@_subject: Grrr...SafeLogging doesn't work in 0.2.1.12-alpha :-{ 
Whoops. Thanks for the bug report. Karsten just fixed it in svn, and
the fix will be included in the next development release.
In general, production Tor relays should log at notice. Logging at info
will slow them down. Also, I think there might be other info-level logs
that aren't scrubbed properly -- we only made sure to do notice and warn
and err.
If somebody wants to walk through all the info-level logs and report
others that are likely to be problems, that'd be great.
Any log message that we think you should find alarming will be notice or
higher (usually warn or higher). Any log message that is info or lower
we do not think you should find alarming. How's that? :)
(I will grant that sometimes we screw up, so asking here isn't a crazy
Directory mirrors need to cache and serve v3 key certificates for v3
directory authorities they don't recognize. That's because we might add
a new v3 directory authority, and then clients would want to be able to
learn its key certs from mirrors (even mirrors who haven't upgraded yet)
in order to check signatures on the consensus.
So yes, I think that's working as intended.
All of that said, at some point we should teach clients to discard v3
certs from authorities they don't recognize. Otherwise they'll just sit
around in the cached-certs file taking up space. I'll put that on the
todo list.

@_date: 2009-02-10 15:50:27
@_author: Roger Dingledine 
@_subject: Some Bones to Pick with Tor Admins 
At this point there are very few win98 users of Tor. That plus the fact
that win98 is known to be obsolete and insecure means we don't pay much
attention to it.
Like the other esoteric operating systems out there, we don't object to
staying compatible if it's not too much trouble, but we rely on the
users to help track down the compatibility problems and work with us to
fix things again.
I should also note that the ability to stay compatible with win98 is
fading. I believe Firefox 3 has dropped win98 compatibility. Now that
Firefox 2 is unsupported, it will soon be the case that you have no safe
browser to use with Tor. (You need Torbutton 1.2 on Firefox to have any
chance of safe browsing.)
You should be on the or-announce list if you're not already.

@_date: 2009-01-13 17:09:16
@_author: Roger Dingledine 
@_subject: redirect to meagpass.net while using Tor 
Yes, both directory authorities that vote for BadExit have now flagged
it. Thanks for hunting it down!

@_date: 2009-01-13 17:16:06
@_author: Roger Dingledine 
@_subject: SOCKS4/5 support for OR and direcotry connections 
Since Tor has moved towards doing the directory fetches over an OR
connection (it even does it by default in Tor 0.2.0.x and later),
I would suggest that you don't actually need to support socks proxies
for directory fetches.

@_date: 2009-01-15 14:01:10
@_author: Roger Dingledine 
@_subject: "Circumventing censorship: issues of trust" 
Hi folks,
For those who missed the recent fuss in the "China and circumvention
tools" blogosphere, check out
Here's the teaser:
"On Friday Hal Roberts at the Berkman Center for Internet and Society
wrote a blog post that has a lot of people rightly worried: Popular
Chinese Filtering Circumvention Tools DynaWeb FreeGate, GPass, and
FirePhoenix Sell User Data."

@_date: 2009-01-16 18:21:44
@_author: Roger Dingledine 
@_subject: Am I really helping tor 
You're running a bridge. Great. Bridges are designed to not be in any
public directory, though:
So it should not be surprising to you that it's not in the directory. :)
Btw, you're using the "v2" directory protocol there. It will be phased
out at some point. (Neither the stable 0.2.0.x series nor the development
0.2.1.x series use it.)
DirPorts aren't really used much anymore. Most clients make an encrypted
connection to the ORPort, and do their directory queries from there.
But that said, you probably won't see much traffic on your ORPort
either, yet, since you're a bridge. At this point, bridges are a future
step on the "blocking resistance" arms race:
and no country has gotten that far on the arms race yet. So they're more
a strategy that we have in reserve for the time when we need it.
Hope that helps,

@_date: 2009-01-17 14:39:14
@_author: Roger Dingledine 
@_subject: Use a specific curcuit when establishing a SOCKS connection 
setconf __LeaveStreamsUnattached to 1 (you can read about it in section
5.4 of control-spec.txt), and then use "attachstream" (section 3.13) to
assign each stream.
If you don't want to handle attaching a given stream, just send an
attachstream with "0" as the circid and Tor will handle that one.
You might also like the TorCtl library, e.g

@_date: 2009-01-17 18:54:25
@_author: Roger Dingledine 
@_subject: Problem running tor-0.2.0.32 on Ubuntu 8.04 
(Btw, please only post to or-talk or or-dev, never both)
Other details of your setup or configuration? What torrc lines are you
using? Did the ./configure output look funny at all?
Does it happen immediately on startup? If so, you could run it in
valgrind and then valgrind will give you a more useful hint about what's
going wrong. glibc isn't really very useful for this sort of thing.

@_date: 2009-01-21 17:58:19
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.11-alpha is out 
Tor 0.2.1.11-alpha finishes fixing the "if your Tor is off for a week it
will take a long time to bootstrap again" bug. It also fixes an important
security-related bug reported by Ilja van Sprundel. You should upgrade.
(We'll send out more details about the bug once people have had some
time to upgrade.)
Changes in version 0.2.1.11-alpha - 2009-01-20
  o Security fixes:
    - Fix a heap-corruption bug that may be remotely triggerable on
      some platforms. Reported by Ilja van Sprundel.
  o Major bugfixes:
    - Discard router descriptors as we load them if they are more than
      five days old. Otherwise if Tor is off for a long time and then
      starts with cached descriptors, it will try to use the onion
      keys in those obsolete descriptors when building circuits. Bugfix
      on 0.2.0.x. Fixes bug 887.
  o Minor features:
    - Try to make sure that the version of Libevent we're running with
      is binary-compatible with the one we built with. May address bug
      897 and others.
    - Make setting ServerDNSRandomizeCase to 0 actually work. Bugfix
      for bug 905. Bugfix on 0.2.1.7-alpha.
    - Add a new --enable-local-appdata configuration switch to change
      the default location of the datadir on win32 from APPDATA to
      LOCAL_APPDATA. In the future, we should migrate to LOCAL_APPDATA
      entirely. Patch from coderman.
  o Minor bugfixes:
    - Make outbound DNS packets respect the OutboundBindAddress setting.
      Fixes the bug part of bug 798. Bugfix on 0.1.2.2-alpha.
    - When our circuit fails at the first hop (e.g. we get a destroy
      cell back), avoid using that OR connection anymore, and also
      tell all the one-hop directory requests waiting for it that they
      should fail. Bugfix on 0.2.1.3-alpha.
    - In the torify(1) manpage, mention that tsocks will leak your
      DNS requests.

@_date: 2009-01-28 01:45:17
@_author: Roger Dingledine 
@_subject: Memory leak? 
I assume you're doing this on Linux?
You might try it on, say, FreeBSD to compare. Its malloc is a lot
different than the one in glibc. In many cases, the memory fragments
such that even though we free it, the OS never sees it again. See also
If you're good with valgrind, you could also check to see if it's
an actual memory leak. We don't know of any serious memory leaks in
0.2.1.11-alpha (or trunk).
Tor dies on out-of-memory. If it's lucky, it notices the problem and
kills itself. Else, the out-of-memory-killer eats it, or some other thing
makes it disappear. We don't try to survive out-of-memory, because in
many cases that's not a decision that the process gets to make.

@_date: 2009-01-28 17:20:33
@_author: Roger Dingledine 
@_subject: Tor bridges email discovery... 
Hi Jon,
You're right, it was broken. It broke in late October when we shuffled
around some infrastructure and didn't update some firewall rules. Oops.
Thanks for pointing it out (even though it took a while for me to get
it sorted out). It should work now -- though we're still tweaking it a
bit to improve our odds of noticing if it stops working again. :}

@_date: 2009-01-29 01:17:28
@_author: Roger Dingledine 
@_subject: "RequestPolicy": can people take a look at it? 
Hi folks,
A smart security person pointed me to the "RequestPolicy" firefox
extension. I've had it on my todo list for a month but haven't found
time to look at it. Anybody here want to take a look, give it a spin,
decide if it solves an important problem, figure out how well it coexists
with Noscript and Torbutton, etc?

@_date: 2009-01-03 05:14:14
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.9-alpha is out 
Tor 0.2.1.9-alpha fixes many more bugs, some of them security-related.
Changes in version 0.2.1.9-alpha - 2008-12-25
  o New directory authorities:
    - gabelmoo (the authority run by Karsten Loesing) now has a new
      IP address.
  o Security fixes:
    - Never use a connection with a mismatched address to extend a
      circuit, unless that connection is canonical. A canonical
      connection is one whose address is authenticated by the router's
      identity key, either in a NETINFO cell or in a router descriptor.
    - Avoid a possible memory corruption bug when receiving hidden service
      descriptors. Bugfix on 0.2.1.6-alpha.
  o Major bugfixes:
    - Fix a logic error that would automatically reject all but the first
      configured DNS server. Bugfix on 0.2.1.5-alpha. Possible fix for
      part of bug 813/868. Bug spotted by coderman.
    - When a stream at an exit relay is in state "resolving" or
      "connecting" and it receives an "end" relay cell, the exit relay
      would silently ignore the end cell and not close the stream. If
      the client never closes the circuit, then the exit relay never
      closes the TCP connection. Bug introduced in 0.1.2.1-alpha;
      reported by "wood".
    - When we can't initialize DNS because the network is down, do not
      automatically stop Tor from starting. Instead, retry failed
      dns_inits() every 10 minutes, and change the exit policy to reject
      *:* until one succeeds. Fixes bug 691.
  o Minor features:
    - Give a better error message when an overzealous init script says
      "sudo -u username tor --user username". Makes Bug 882 easier for
      users to diagnose.
    - When a directory authority gives us a new guess for our IP address,
      log which authority we used. Hopefully this will help us debug
      the recent complaints about bad IP address guesses.
    - Detect svn revision properly when we're using git-svn.
    - Try not to open more than one descriptor-downloading connection
      to an authority at once. This should reduce load on directory
      authorities. Fixes bug 366.
    - Add cross-certification to newly generated certificates, so that
      a signing key is enough information to look up a certificate.
      Partial implementation of proposal 157.
    - Start serving certificates by       pairs. Partial implementation of proposal 157.
    - Clients now never report any stream end reason except 'MISC'.
      Implements proposal 148.
    - On platforms with a maximum syslog string length, truncate syslog
      messages to that length ourselves, rather than relying on the
      system to do it for us.
    - Optimize out calls to time(NULL) that occur for every IO operation,
      or for every cell. On systems where time() is a slow syscall,
      this fix will be slightly helpful.
    - Exit servers can now answer resolve requests for ip6.arpa addresses.
    - When we download a descriptor that we then immediately (as
      a directory authority) reject, do not retry downloading it right
      away. Should save some bandwidth on authorities. Fix for bug
      888. Patch by Sebastian Hahn.
    - When a download gets us zero good descriptors, do not notify
      Tor that new directory information has arrived.
    - Avoid some nasty corner cases in the logic for marking connections
      as too old or obsolete or noncanonical for circuits.
  o Minor features (controller):
    - New CONSENSUS_ARRIVED event to note when a new consensus has
      been fetched and validated.
    - When we realize that another process has modified our cached
      descriptors file, print out a more useful error message rather
      than triggering an assertion. Fixes bug 885. Patch from Karsten.
    - Add an internal-use-only __ReloadTorrcOnSIGHUP option for
      controllers to prevent SIGHUP from reloading the
      configuration. Fixes bug 856.
  o Minor bugfixes:
    - Resume using the correct "REASON=" stream when telling the
      controller why we closed a stream. Bugfix in 0.2.1.1-alpha.
    - When a canonical connection appears later in our internal list
      than a noncanonical one for a given OR ID, always use the
      canonical one. Bugfix on 0.2.0.12-alpha. Fixes bug 805.
      Spotted by rovv.
    - Clip the MaxCircuitDirtiness config option to a minimum of 10
      seconds. Warn the user if lower values are given in the
      configuration. Bugfix on 0.1.0.1-rc. Patch by Sebastian.
    - Clip the CircuitBuildTimeout to a minimum of 30 seconds. Warn the
      user if lower values are given in the configuration. Bugfix on
      0.1.1.17-rc. Patch by Sebastian.
    - Fix a race condition when freeing keys shared between main thread
      and CPU workers that could result in a memory leak. Bugfix on
      0.1.0.1-rc. Fixes bug 889.
  o Minor bugfixes (hidden services):
    - Do not throw away existing introduction points on SIGHUP (bugfix on
      0.0.6pre1); also, do not stall hidden services because we're
      throwing away introduction points; bugfix on 0.2.1.7-alpha. Spotted
      by John Brooks. Patch by Karsten. Fixes bug 874.
    - Fix a memory leak when we decline to add a v2 rendezvous
      descriptor to the cache because we already had a v0 descriptor
      with the same ID. Bugfix on 0.2.0.18-alpha.
  o Deprecated and removed features:
    - RedirectExits has been removed. It was deprecated since
      0.2.0.3-alpha.
    - Finally remove deprecated "EXTENDED_FORMAT" controller feature. It
      has been called EXTENDED_EVENTS since 0.1.2.4-alpha.
    - Cell pools are now always enabled; --disable-cell-pools is ignored.
  o Code simplifications and refactoring:
    - Rename the confusing or_is_obsolete field to the more appropriate
      is_bad_for_new_circs, and move it to or_connection_t where it
      belongs.
    - Move edge-only flags from connection_t to edge_connection_t: not
      only is this better coding, but on machines of plausible alignment,
      it should save 4-8 bytes per connection_t. "Every little bit helps."
    - Rename ServerDNSAllowBrokenResolvConf to ServerDNSAllowBrokenConfig
      for consistency; keep old option working for backward compatibility.
    - Simplify the code for finding connections to use for a circuit.

@_date: 2009-01-05 13:31:06
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.9-alpha STILL BROKEN 
You might find
to be useful for tracking down the issue.
Next step, see if it's producing a core. Look at dmesg to see if it's
killing it for out-of-memory reasons.
Then run it in gdb and see how it dies.

@_date: 2009-01-06 02:25:36
@_author: Roger Dingledine 
@_subject: proxychains DNS leaks stopped 
Socks doesn't have a notion of resolving. It only has a notion of
connecting (well, and binding, but we don't use that).
We hacked on our own notion of a 'resolve' socks request:
and I'd be surprised if any other projects use our extension.

@_date: 2009-01-09 23:42:54
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.10-alpha is out 
Tor 0.2.1.10-alpha fixes two major bugs in bridge relays (one that would
make the bridge relay not so useful if it had DirPort set to 0, and one
that could let an attacker learn a little bit of information about the
bridge's users), and a bug that would cause your Tor relay to ignore a
circuit create request it can't decrypt (rather than reply with an error).
It also fixes a wide variety of other bugs.
Changes in version 0.2.1.10-alpha - 2009-01-06
  o Major bugfixes:
    - If the cached networkstatus consensus is more than five days old,
      discard it rather than trying to use it. In theory it could
      be useful because it lists alternate directory mirrors, but in
      practice it just means we spend many minutes trying directory
      mirrors that are long gone from the network. Helps bug 887 a bit;
      bugfix on 0.2.0.x.
    - Bridge relays that had DirPort set to 0 would stop fetching
      descriptors shortly after startup, and then briefly resume
      after a new bandwidth test and/or after publishing a new bridge
      descriptor. Bridge users that try to bootstrap from them would
      get a recent networkstatus but would get descriptors from up to
      18 hours earlier, meaning most of the descriptors were obsolete
      already. Reported by Tas; bugfix on 0.2.0.13-alpha.
    - Prevent bridge relays from serving their 'extrainfo' document
      to anybody who asks, now that extrainfo docs include potentially
      sensitive aggregated client geoip summaries. Bugfix on
      0.2.0.13-alpha.
  o Minor features:
    - New controller event "clients_seen" to report a geoip-based summary
      of which countries we've seen clients from recently. Now controllers
      like Vidalia can show bridge operators that they're actually making
      a difference.
    - Build correctly against versions of OpenSSL 0.9.8 or later built
      without support for deprecated functions.
    - Update to the "December 19 2008" ip-to-country file.
  o Minor bugfixes (on 0.2.0.x):
    - Authorities now vote for the Stable flag for any router whose
      weighted MTBF is at least 5 days, regardless of the mean MTBF.
    - Do not remove routers as too old if we do not have any consensus
      document. Bugfix on 0.2.0.7-alpha.
    - Do not accept incomplete ipv4 addresses (like 192.168.0) as valid.
      Spec conformance issue. Bugfix on Tor 0.0.2pre27.
    - When an exit relay resolves a stream address to a local IP address,
      do not just keep retrying that same exit relay over and
      over. Instead, just close the stream. Addresses bug 872. Bugfix
      on 0.2.0.32. Patch from rovv.
    - If a hidden service sends us an END cell, do not consider
      retrying the connection; just close it. Patch from rovv.
    - When we made bridge authorities stop serving bridge descriptors over
      unencrypted links, we also broke DirPort reachability testing for
      bridges. So bridges with a non-zero DirPort were printing spurious
      warns to their logs. Bugfix on 0.2.0.16-alpha. Fixes bug 709.
    - When a relay gets a create cell it can't decrypt (e.g. because it's
      using the wrong onion key), we were dropping it and letting the
      client time out. Now actually answer with a destroy cell. Fixes
      bug 904. Bugfix on 0.0.2pre8.
    - Squeeze 2-5% out of client performance (according to oprofile) by
      improving the implementation of some policy-manipulation functions.
  o Minor bugfixes (on 0.2.1.x):
    - Make get_interface_address() function work properly again; stop
      guessing the wrong parts of our address as our address.
    - Do not cannibalize a circuit if we're out of RELAY_EARLY cells to
      send on that circuit. Otherwise we might violate the proposal-110
      limit. Bugfix on 0.2.1.3-alpha. Partial fix for Bug 878. Diagnosis
      thanks to Karsten.
    - When we're sending non-EXTEND cells to the first hop in a circuit,
      for example to use an encrypted directory connection, we don't need
      to use RELAY_EARLY cells: the first hop knows what kind of cell
      it is, and nobody else can even see the cell type. Conserving
      RELAY_EARLY cells makes it easier to cannibalize circuits like
      this later.
    - Stop logging nameserver addresses in reverse order.
    - If we are retrying a directory download slowly over and over, do
      not automatically give up after the 254th failure. Bugfix on
      0.2.1.9-alpha.
    - Resume reporting accurate "stream end" reasons to the local control
      port. They were lost in the changes for Proposal 148. Bugfix on
      0.2.1.9-alpha.
  o Deprecated and removed features:
    - The old "tor --version --version" command, which would print out
      the subversion "Id" of most of the source files, is now removed. It
      turned out to be less useful than we'd expected, and harder to
      maintain.
  o Code simplifications and refactoring:
    - Change our header file guard macros to be less likely to conflict
      with system headers. Adam Langley noticed that we were conflicting
      with log.h on Android.
    - Tool-assisted documentation cleanup. Nearly every function or
      static variable in Tor should have its own documentation now.

@_date: 2009-01-13 12:11:31
@_author: Roger Dingledine 
@_subject: redirect to meagpass.net while using Tor 
Another option is to use Vidalia's network map. It will show you (look in
the bottom middle) which circuits you have open. So for example if it says
"gremlin, corfu, tasia" then tasia is the third relay in your circuit.
Then when you open a stream (e.g. by clicking on something in your
browser), the stream shows up attached under a specific circuit.

@_date: 2009-07-12 22:31:54
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.17-rc is out -- final release candidate? 
Tor 0.2.1.17-rc marks the fourth -- and hopefully last -- release
candidate for the 0.2.1.x series. It lays the groundwork for further
client performance improvements, and also fixes a big bug with directory
authorities that were causing them to assign Guard and Stable flags
The Windows bundles also finally include the geoip database that we
thought we'd been shipping since 0.2.0.x (oops), and the OS X bundles
should actually install Torbutton rather than giving you a cryptic
failure message (oops).
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and 0.2.1.18 will be the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.1.17-rc - 2009-07-02
  o Major features:
    - Clients now use the bandwidth values in the consensus, rather than
      the bandwidth values in each relay descriptor. This approach opens
      the door to more accurate bandwidth estimates once the directory
      authorities start doing active measurements. Implements more of
      proposal 141.
  o Major bugfixes:
    - When Tor clients restart after 1-5 days, they discard all their
      cached descriptors as too old, but they still use the cached
      consensus document. This approach is good for robustness, but
      bad for performance: since they don't know any bandwidths, they
      end up choosing at random rather than weighting their choice by
      speed. Fixed by the above feature of putting bandwidths in the
      consensus. Bugfix on 0.2.0.x.
    - Directory authorities were neglecting to mark relays down in their
      internal histories if the relays fall off the routerlist without
      ever being found unreachable. So there were relays in the histories
      that haven't been seen for eight months, and are listed as being
      up for eight months. This wreaked havoc on the "median wfu"
      and "median mtbf" calculations, in turn making Guard and Stable
      flags very wrong, hurting network performance. Fixes bugs 696 and
      969. Bugfix on 0.2.0.6-alpha.
  o Minor bugfixes:
    - Serve the DirPortFrontPage page even when we have been approaching
      our quotas recently. Fixes bug 1013; bugfix on 0.2.1.8-alpha.
    - The control port would close the connection before flushing long
      replies, such as the network consensus, if a QUIT command was issued
      before the reply had completed. Now, the control port flushes all
      pending replies before closing the connection. Also fixed a spurious
      warning when a QUIT command is issued after a malformed or rejected
      AUTHENTICATE command, but before the connection was closed. Patch
      by Marcus Griep. Bugfix on 0.2.0.x; fixes bugs 1015 and 1016.
    - When we can't find an intro key for a v2 hidden service descriptor,
      fall back to the v0 hidden service descriptor and log a bug message.
      Workaround for bug 1024.
  o Minor features:
    - If we're a relay and we change our IP address, be more verbose
      about the reason that made us change. Should help track down
      further bugs for relays on dynamic IP addresses.

@_date: 2009-07-14 01:06:26
@_author: Roger Dingledine 
@_subject: problem with connecting to a hidden service 
Actually, I don't think the Tor network is as oversatured as we think.
I think it's just massively unbalanced.
See sections 2 and 4 of
I think there's a real bug here. I've been playing with it on and off. I
think that when Tor has a rendezvous circuit that it thinks it should
like, and suddenly changes its mind, then it discards that circuit and
starts working on a new one (which is good), but at the same time it
closes the socks stream (which is bad).
Fixing that bug, if it turns out to actually be a bug, would mean that
hidden services are dirt slow when making the initial connection (until
we make Tor itself faster at least), but they're not as flaky as they
currently appear.

@_date: 2009-07-14 01:42:35
@_author: Roger Dingledine 
@_subject: List Archives 
I've got one. But I don't make it public because it has email addresses,
etc in it.
I'm not sure how to resolve the spammer question, except maybe to assume
that everybody has given up on the problem.
Why do you ask?

@_date: 2009-07-14 01:56:18
@_author: Roger Dingledine 
@_subject: secret_id_key 
About three weeks ago we got an influx of new relays, and many of them
were exit relays. In particular, we got enough that Tor Exits were
allowed to be marked Guards again too.
To understand what I just said, see Sec 3.3 of
  If the total bandwidth of active non-BadExit Exit servers is less
  than one third of the total bandwidth of all active servers, no Exit is
  listed as a Guard.
So before mid June, relays had either Guard flags or Exit flags but
never both.
My guess is that having both of those flags makes clients less willing
to use you as the middle hop, so your traffic drops.
When you threw away your key, you lost your Guard flag, so the middle-hop
traffic returned.
This is a special case of another bug I've been working on:
which is that the longer you've been a guard, the more clients you
attract, and new guards have almost no clients. That's fixed in Tor
0.2.1.14-rc, but we need most people to upgrade before it matters much.

@_date: 2009-07-14 02:04:26
@_author: Roger Dingledine 
@_subject: Relay: not reachable 
You didn't get your port forwarding right, is the simplest explanation.
There are some less likely explanations, like "your ISP filters port 443
inbound" and "whatever Zenwalk is has complex firewall rules that are
hard to turn off". But my guess is it's the port forwarding.
Also, you should not port-forward 9050 and especially not 9051. That
could potentially be a really bad security move. Only your ORPort,
and optionally your DirPort, should be reachable from the outside.

@_date: 2009-07-14 02:24:30
@_author: Roger Dingledine 
@_subject: exit notation stripping 
Yep. The smarter place to put this logic would be inside Torbutton
(or inside something else in Firefox-land).
But alas, the real answer is that the whole .exit notation needs to go
away. There are too many subtle security and anonymity problems with it.
If somebody wants to make a patch for 0.2.2.x that adds a new config
option for allowing .exit, disabled by default, this change would happen
faster. That seems to be the best compromise I can see -- keep users
safe by default, and let people screw themselves if they really want
the feature. Any takers? :)

@_date: 2009-07-14 03:24:48
@_author: Roger Dingledine 
@_subject: ShutdownWaitLength vs. 'restart' in init scripts 
Mostly the latter.
There was a little issue at the beginning where there were two people
offering to be maintainer, and I had been working with one and he had
a fine rpm spec file, and for some reason they picked the other and
ignored us both. I haven't interacted with them at all since; they seem
happy in their world ignoring upstream. :(
Right. We've been thinking of setting up an rpm.torproject.org
repository, and putting our rpms into it. That would be similar to the
mirror.noreply.org deb repository that our Debian maintainer maintains.
Then we would have better control over what people think of as our rpms.
But the even better answer would be to somehow get the fedora folks
to improve their spec file. It needs to set ulimit -n like the debian
init script does; understand how to shut down relays cleanly; create
a separate user and run Tor as that user; and I really haven't looked
deep enough lately to know what else it's missing.
The main reason against would be 'complexity'.
For example, if you run a controller that 'setconf's a new
ShutdownWaitLength value via the control port, but the Tor process can't
saveconf because it can't write to its torrc (arguably a feature not a
bug), then Tor would be using a different value of ShutdownWaitLength
than you'd find in its torrc file. That's an unlikely edge case, but it
illustrates how it might not be that simple.
I would say that just taking Debian's "up to 60 seconds while it exits"
strategy would get us most of the way there.
Ah. I'm not sure whether that's the exact order of events (I don't think
TorA can kill TorB just by exiting), but in any case it's certainly a
big mess. The thing to do is to make sure that TorA has exited before
you launch TorB, and that has to be done by the init script.
Tor just exits cleanly when it's counted through its ShutdownWaitLength
time. It doesn't go hunting for other instances of Tor to kill them too.
Perhaps TorB dies early on (but after writing its pid file) when it
realizes that TorA is still around?
In any case, launching Tor while Tor is still running is not a supported
operation. We should make it not do that. :)
Can you take the lead in making a patch, and in either getting Fedora to
believe in it, or helping us maintain our own rpms better?

@_date: 2009-07-14 12:54:32
@_author: Roger Dingledine 
@_subject: "permission denied" on wake-up 
Right. The problem is that you can't configure hibernation plus pick a
low-numbered port currently.
See for details -- in Tor 0.2.1.x, we've added a warning during boot that
you've chosen two incompatible config choices. For later versions of
Tor, we hope to have a smarter answer.
For now, the workaround is to either not configure hibernation, or to
pick a port above 1023.

@_date: 2009-07-15 16:19:26
@_author: Roger Dingledine 
@_subject: Odd connection attempt to tor 
One of the Tor relays rigged its reverse resolve to be the address ".".
See e.g.
Of course, it could have been some other address that was connecting and
also set its reverse resolve to ".". Trusting reverse resolves isn't so
smart, it turns out.

@_date: 2009-07-26 03:52:38
@_author: Roger Dingledine 
@_subject: warning message question 
80.190.246.100:80 is the DirPort on gabelmoo, one of the v3 authorities.
So your relay was trying to get an updated version of the v3 consensus
from gabelmoo.
It looks like the way gabelmoo is listening on port 80 is by proxypassing
it through apache. You can read more about that approach in this poorly
organized faq entry:
and at that particular moment, for some reason apache decided that
sending back a 502 proxy error was better than passing your request on.
For example, I bet this could happen if the gabelmoo relay was down at
the time.

@_date: 2009-07-28 09:38:14
@_author: Roger Dingledine 
@_subject: Torbutton for Mozilla Thunderbird 
Once upon a time, Torbutton just toggled your proxy settings on and off.
So it made sense to make it compatible with a lot of environments --
e.g. both Firefox and Thunderbird.
A year or so ago, Torbutton became something much better. Now it actually
tries to tackle all of the application-level gotchas that come up with
web browsing over Tor: Nobody has looked at the application-level gotchas in Thunderbird. I
wouldn't be surprised if Thunderbird wrote your IP address in an smtp
header or helo command or error message or something else.
It seems silly (no, worse than silly, harmful) to declare support for
Thunderbird when we haven't done any of the security work on it.
So, feel free to use Tor with Thunderbird, but it's probably not safe.

@_date: 2009-07-29 19:42:49
@_author: Roger Dingledine 
@_subject: Two different hidden service on the same tor client 
No, it ought to work fine. The 80 is the "virtual" port, and it only
has to be unique per hidden service.
So running both hidden services redirecting from 80 to someplace else
should work fine.
Hidden services aren't exactly robust these days though, so the fact
that you couldn't reach the second service is not a huge surprise.
"Upgrade to 0.2.1.19 and try again" is the best advice I can offer.
Good luck,

@_date: 2009-07-30 03:02:00
@_author: Roger Dingledine 
@_subject: (FWD) Re: seven bloxortsipt* relays ought *not* to be Valid 
[Forwarding since truxton appears not to be subscribed to or-talk. As
for the questions: a) yes, you should upgrade, that version is way old,
and b) check out

@_date: 2009-07-06 03:06:23
@_author: Roger Dingledine 
@_subject: Yahoo Mail and Tor 
You should try the Tor Browser Bundle for Windows, and compare how
that goes. It uses Polipo rather than Privoxy, so should have different
application-level behavior.

@_date: 2009-06-12 18:22:27
@_author: Roger Dingledine 
@_subject: JanusVM tests 
The easy way to check is to have a cron job that happens once an hour
or so:
wget " --no-check-certificate -q -O bulk-exitlist
and then you can just see if the client's IP address is in the
bulk-exitlist file.

@_date: 2009-06-12 19:32:24
@_author: Roger Dingledine 
@_subject: eliminating bogus port 43 exits 
I would also be curious to learn the mean/median number of bytes that
a given connection to port 43 takes. If it's a tiny amount, then it
probably isn't responsible for 70% of Tor's traffic. If it's huge,
then perhaps that means people are file-sharing over port 43.
This question is an ongoing debate in the legal world. Here's a bit
of background (from a non-lawyer).
There are two categories to consider here: wiretapping and pen
registers. Wiretapping considers content, and is really bad to do. Pen
registers consider addressing information -- who is involved in the call
but not what they're saying. (Yes, "call" -- think of all communications
like phone calls, and you'll be getting into the spirit of the law.)
While wiretapping is "right out", pen registers are a much more gray
area. In practice, so far, and especially if you're doing it to improve
the quality of service, and you don't upset the wrong people, and a few
other disclaimers and caveats, nobody's going to bother you *legally*
for pen registering your Tor.
That means we can get down to the real question, which imo is: if you're
going to collect info like that from your Tor, how should you do it in a
way that keeps everybody actually safe? Not publishing specific addresses
is a must -- not even letting them touch disk seems like a good move too.
We've been wrestling with this question in the context of collecting
aggregate performance and usage data from Tor so we can start resolving
our speed problems. See for example the last few paragraphs of

@_date: 2009-06-12 20:44:50
@_author: Roger Dingledine 
@_subject: eliminating bogus port 43 exits 
I should note that in the previous post I did that thing that EFF lawyers
always do that confuses people: I pretended there's only one country in
the world.
This is interesting first of all because there are relays (and relay
operators) in other countries -- and places like the EU have quite
detailed privacy laws. But second because people from other countries
*use* the Tor network, and that brings the myriad of other legal regimes
into scope even for US-based researchers.
I've been wanting for a while to publish a set of guidelines or heuristics
for how to collect Tor stats safely. Otherwise we stay in the current
situation, where random people decide they want to learn something,
do it, and then get jumped on later for not following the unwritten,
undiscussed, and not-really-actually-agreed-upon-anyway best practices.
The only tiny problem remaining is that we need to write them, discuss
them, and agree upon them. :)

@_date: 2009-06-02 11:44:03
@_author: Roger Dingledine 
@_subject: Banners injected in web pages at exit nodes TRHCourtney* 
Exciting. Peter and I just added these nodes to the badexit list. That
means clients should start learning that in the next several hours.
Thanks for pointing it out.
Oh. I was going to suggest mailing him/her to ask if the injection was a
mistake. (We've had plenty of people sign up as Tor relays and not realize
that their local traffic "protection" tools will affect their Tor traffic
too.) But this page makes it pretty clear that they meant to do it. Bleah.

@_date: 2009-06-15 04:40:42
@_author: Roger Dingledine 
@_subject: eliminating bogus port 43 exits 
No, Vidalia uses the default exit policy too when you opt to become a
relay. This probably surprises some Vidalia users, but it's still better
than having zero exit relays.
We won't be fixing it. We don't want relay descriptors to be huge, because
every client has to fetch them. I would say that your heuristic of "if
you have too many exit policy lines about a given port, then simplify
by rejecting it" is not a bad one.
In the future, when clients aren't fetching relay descriptors at all,
and exit policies are instead summarized in the consensus or the
microdescriptors, clients won't even be learning the IP-address parts
of exit policies. See Section 3.4 of proposal 141 for details.

@_date: 2009-06-17 15:23:46
@_author: Roger Dingledine 
@_subject: Iran + tor 
See e.g. The text you're quoting must be years old. TunnelDirConns and
PreferTunneledDirConns have defaulted to 1 starting in Tor 0.2.0.x.
We made that change in part because Smartfilter and Websense (used in
countries like Iran) learned how to detect the old unencrypted directory
requests from Tor 0.1.2.x and earlier.

@_date: 2009-06-17 22:11:11
@_author: Roger Dingledine 
@_subject: Help Iranian dissidents by collecting and posting Bridge addresses?  (here?) 
Yeah, see, I'm not sure whether this is true. If ordinary bridges are
working, then probably ordinary Tor relays are working too. Or said
another way, if ordinary Tor relays aren't working, probably ordinary
bridges won't work either.
We've heard rumors they're blocking all encrypted traffic. Does this
mean everything that does an SSL handshake no matter the port? Or does
it mean the blocked port 443?
If the former, an automated system like Tor is going to have a tough time
keeping up -- at least without the tweaks we've been pondering over the
past few days. ;)
If the latter, then setting up a bunch of bridges on port 80 (even
though everything's still encrypted) might be the ticket.
Lots of misinformation going around, and not so much information.

@_date: 2009-06-18 20:34:44
@_author: Roger Dingledine 
@_subject: Help Iranian dissidents by collecting and posting Bridge addresses? (here?) 
Tor has been mentioned in a variety of articles. We actually try to avoid
getting big mentions in the press -- every time I talk to journalists they
have visions of headlines like "Tor Project declares war on China!" or
"Lone American hacker conquers communist nation", but the reality is
that those sort of articles will hurt much more than they help.
Getting the news to the right people is very important, and I'm happy
that Tor instructions are spreading by word-of-mouth, blogs, etc. But
huge high-profile stories in Western media will end up forcing the
authorities in these countries to act when otherwise they might not
need to. You can bet that plenty of policy people in other countries are
watching right now to learn what technologies they should instruct their
firewall operators to prepare better for. It's a delicate balancing act.

@_date: 2009-06-19 02:37:36
@_author: Roger Dingledine 
@_subject: mail from iran 
Glad you found it useful. Let us know if we can answer any Tor questions
for you. Also let us know if it stops working, so we can help to debug. :)
Speaking of which: we've recently heard rumors that port 443 is blocked
throughout Iran. Have you found that to be true? Tor should be able to
work even if 443 is blocked, but it will work better if 443 works.
And last: once you have a bit more free time, we'd love to have some
help translating our tools and website into Farsi.

@_date: 2009-06-21 07:38:42
@_author: Roger Dingledine 
@_subject: Help Iranian dissidents 
There are only a few hundred running bridges right now. I think it's fine
to "use" them all this week, if people want to. We'll have more later,
and it'll be good to learn some lessons here.
You can discover some bridge addresses either with a gmail account,
or with a web browser:
It seems that other people are collecting bridge addresses manually and
giving them out when they find people who could use one. This might
be a bad idea, in that it increases the risk that the attacker will
get ahold of the bridge address, since now there are two ways to learn
it. But it also might be a good idea, since now it's more likely to get
used by somebody who needs it (not everybody knows about the above two
URLs after all).
I'm not sure what the right balance is.
In any case, the Tor network itself hasn't been blocked in Iran, as far
as I can tell. So in a sense this bridge stuff (the next step in the
arms race) is all just practice.

@_date: 2009-06-22 01:22:30
@_author: Roger Dingledine 
@_subject: jurisdictional concentration of authorities 
Actually, only five v3 authorities are up right now. The sixth
(dannenberg) appears down.
The others you're seeing are moria2 (v1 and v2 authority, but not v3),
and Tonga (bridge authority).
Yep. Of the current 6 v3 authorities, there are:
moria1 (US)
ides (US)
tor26 (Austria)
gabelmoo (Germany)
dizum (Netherlands)
dannenberg (Germany)
We're planning to add a seventh soon (lostinthenoise, US). But it's
currently a real pain to add an authority; see proposal 165 for details.
See also
for more discussion.
A coordinated DoS of 4 of them might be conceivable. If it happens,
we'll learn from that and adapt.
Installing backdoors on 4 of them and then keeping them up seems much
We're happy to add more authorities, once we get proposal 165 in. We
totally should.
The limiting factor in these countries you name is trustworthy dedicated
competent humans who also have good Internet providers. Without actual
people we know and trust, it doesn't really seem like a good move.

@_date: 2009-06-23 17:52:51
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.16-rc is out 
Tor 0.2.1.16-rc speeds up performance for fast exit relays, and fixes
a bunch of minor bugs.
Changes in version 0.2.1.16-rc - 2009-06-20
  o Security fixes:
    - Fix an edge case where a malicious exit relay could convince a
      controller that the client's DNS question resolves to an internal IP
      address. Bug found and fixed by "optimist"; bugfix on 0.1.2.8-beta.
  o Major performance improvements (on 0.2.0.x):
    - Disable and refactor some debugging checks that forced a linear scan
      over the whole server-side DNS cache. These accounted for over 50%
      of CPU time on a relatively busy exit node's gprof profile. Found
      by Jacob.
    - Disable some debugging checks that appeared in exit node profile
      data.
  o Minor features:
    - Update to the "June 3 2009" ip-to-country file.
    - Do not have tor-resolve automatically refuse all .onion addresses;
      if AutomapHostsOnResolve is set in your torrc, this will work fine.
  o Minor bugfixes (on 0.2.0.x):
    - Log correct error messages for DNS-related network errors on
      Windows.
    - Fix a race condition that could cause crashes or memory corruption
      when running as a server with a controller listening for log
      messages.
    - Avoid crashing when we have a policy specified in a DirPolicy or
      SocksPolicy or ReachableAddresses option with ports set on it,
      and we re-load the policy. May fix bug 996.
    - Hidden service clients didn't use a cached service descriptor that
      was older than 15 minutes, but wouldn't fetch a new one either,
      because there was already one in the cache. Now, fetch a v2
      descriptor unless the same descriptor was added to the cache within
      the last 15 minutes. Fixes bug 997; reported by Marcus Griep.
  o Minor bugfixes (on 0.2.1.x):
    - Don't warn users about low port and hibernation mix when they
      provide a *ListenAddress directive to fix that. Bugfix on
      0.2.1.15-rc.
    - When switching back and forth between bridge mode, do not start
      gathering GeoIP data until two hours have passed.
    - Do not complain that the user has requested an excluded node as
      an exit when the node is not really an exit. This could happen
      because the circuit was for testing, or an introduction point.
      Fix for bug 984.

@_date: 2009-06-23 18:08:02
@_author: Roger Dingledine 
@_subject: Strange tor status... 
moria2 is only a v2 directory authority. You are looking at obsolete
directory authorities and an obsolete directory protocol.
There does exist a torstatus that looks at v3 information. See e.g.
In any case, you appear to be another of those edge cases where some of
the directory authorities can reach you, and some of them can't.
moria1 can reach you:
r ReactorRelay ekp80iSmHIIG8kfyC2wkdX9oMIs 7T+TKBsijyincvCHza7JH+TQ3V0 2009-06-23 21:48:26 86.111.64.45 9001 9030
s Exit Fast Guard Named Running Stable V2Dir Valid
tor26 cannot:
r ReactorRelay ekp80iSmHIIG8kfyC2wkdX9oMIs 7T+TKBsijyincvCHza7JH+TQ3V0 2009-06-23 21:48:26 86.111.64.45 9001 9030
s Named V2Dir Valid
ides can:
r ReactorRelay ekp80iSmHIIG8kfyC2wkdX9oMIs 7T+TKBsijyincvCHza7JH+TQ3V0 2009-06-23 21:48:26 86.111.64.45 9001 9030
s Exit Fast Guard Running Stable V2Dir Valid
dizum cannot:
r ReactorRelay ekp80iSmHIIG8kfyC2wkdX9oMIs 7T+TKBsijyincvCHza7JH+TQ3V0 2009-06-23 21:48:26 86.111.64.45 9001 9030
s V2Dir Valid
gabelmoo cannot:
r ReactorRelay ekp80iSmHIIG8kfyC2wkdX9oMIs 7T+TKBsijyincvCHza7JH+TQ3V0 2009-06-23 21:48:26 86.111.64.45 9001 9030
s V2Dir Valid
So the pattern is "America finds you reachable, and Europe finds you
Is your firewall set up in a funny way? Does your hosting provider have
its routing table broken?
See also
and my followup there:
Same pattern of authority opinions too!

@_date: 2009-06-25 04:39:49
@_author: Roger Dingledine 
@_subject: ShutdownWaitLength vs. 'restart' in init scripts 
Is this with the tor rpm shipped by Fedora? We don't support (or use,
or like, or recommend) the fedora tor rpm.
Check out how the torctl that we ship in the rpms handles that:
It basically kills it, and then tries to kill it even harder if it
doesn't die. That's probably not the right answer.
The right answer imo is how the deb package does it:
Check out the wait_for_deaddaemon function: it basically checks each
second whether the process is still around, and returns when it's gone
(or 60 seconds have passed).
So I guess if you raise your ShutdownWaitLength, you'll want to tweak
the script. But that still seems better than the
"kill -INT, sleep 1, kill -9" strategy the rpm uses.
Patches to the torctl script greatly appreciated. :)
Can you clarify what happens here? 'tor stop' finishes but Tor is still
running, so then 'tor start' fails to launch a new Tor, and then the
old Tor exits, and then you have no Tor running but you think you do?

@_date: 2009-06-26 10:45:44
@_author: Roger Dingledine 
@_subject: A Few Random Thoughts... 
Sounds great. Let us know if you have any questions or run into any
Depending on how you're installing, you might like the development
version (currently 0.2.1.16-rc). The 0.2.1.x series is going to become
the new "stable" soon (it's already probably more stable in practice
than 0.2.0.35), and it's way better in a number of other ways.
But either 0.2.0.x or 0.2.1.x is fine, really.
That's a really good point.
Especially since a lot of the people who really hate/fear Tor are IT
folks who don't understand it.
Yep. The next step is to come up with some really good clean simple
example sentences for our new category. Those examples will dictate the
title we give it -- "Security experts use Tor", "Sysadmins use Tor",
"Computer experts use Tor", or something else.
If anybody knows good places, please let us know. :) There's a small
list being built here:
Another concern is that if we centralize all the exit relays in a few
places, we reduce the anonymity that the Tor network can provide. But I
don't think we're anywhere near doing that yet, so it's just something
to keep in the back of our minds.
Me too. Don't worry, we won't do it. But see also

@_date: 2009-06-27 11:58:11
@_author: Roger Dingledine 
@_subject: Ping times with Tor running 
1000KB is 8 megabit. 2000KB is 16 megabit.
Tor counts in units of '1' rather than units of '1/8' :)
Whereas your cable provider counts in units that produce large
impressive-sounding numbers.
See also

@_date: 2009-06-03 21:48:31
@_author: Roger Dingledine 
@_subject: single hop tor circuits (tor-0.2.1.15-rc) 
Yes. These are directory lookups.
In Tor 0.1.2.x the directory lookups were done separately as plaintext
HTTP requests. That turned out to be easy for filtering tools to
recognize. Now they're done inside the TLS connection.

@_date: 2009-06-03 22:05:28
@_author: Roger Dingledine 
@_subject: Issue about selection of Tor relays when using the default torrc configuration 
One stream ever is probably a bad assumption. Tor generates streams to
do its directory lookups, for example.
A better place to instrument might be
But overall, as long as you're smart and check that it's really the
circuit and stream you think it is, you should be fine either way.
I dunno. Depends how you are doing things differently than we expected
you to. :) Perhaps some more details, of exactly what you're doing and
exactly what you expect and exactly what you get instead, would help us
Perhaps you introduced a bug when you made changes to Tor?
Or perhaps there is a crash bug in Tor when using it the way you're
trying to. If the latter, we'd love to hear more. There's a FAQ entry
that explains some of the ways you can help report:
Running it in gdb should help you get a backtrace, to pinpoint the

@_date: 2009-06-03 22:13:58
@_author: Roger Dingledine 
@_subject: GETINFO argument to dertermine OR IP addresses 
Quoting from the control-spec.txt:
    "desc/id/" or "desc/name/" -- the latest
      server descriptor for a given OR, NUL-terminated.
Assuming you know the relay's identity fingerprint, fetching the
descriptor and parsing it is a simple way. Don't use nicknames or you'll
end up getting confused when multiple relays have the same nickname.
There are a couple of edge cases. For example, the descriptor that your
local Tor client has may not be the same as the descriptor advertised
in the networkstatus consensus, since your Tor client may not yet have
fetched the newer descriptor. But assuming the relays in question don't
change IP addresses much, or assuming you only want to know about relays
that your Tor client already knows descriptors for, this approach should
be close enough.

@_date: 2009-06-03 22:35:20
@_author: Roger Dingledine 
@_subject: tor controller hangs / doesn't reply 
Is this related to the Tor modifications you made? :)
You could gdb attach to the Tor process and see where it is. Or watch
the debug logs carefully. It's also possible that Tor is just slow --
but that shouldn't cause your control port to stop responding.
I should also note that TorExample.py is several years out of date. So
it's possible that it does not play well with the current Tor anymore.
Mikeperry: is TorExample.py still (thought to be) compatible with TorCtl
and friends?

@_date: 2009-06-08 09:46:00
@_author: Roger Dingledine 
@_subject: Using POSTDESCRIPTOR command 
Not currently. Tor looks at the networkstatus consensus to decide which
relays are Running or otherwise suitable for circuits. Your descriptor
isn't listed there, so Tor doesn't consider using it.
If somebody were to write a patch to implement a +POSTNS
instruction (using a format like a networkstatus stanza in your
~/.tor/cached-consensus file), I think that would be good.
Doing it right would be tricky though -- for example, it wouldn't get
cached anywhere, and Tor would discard it every time it gets a new
networkstatus consensus (and finds that it's missing any mention of
your descriptor).

@_date: 2009-03-04 16:42:04
@_author: Roger Dingledine 
@_subject: 64 bit Linux 
64-bit works great on Linux. Several of the directory authorities run on
athlon64. Plus, 64-bit does crypto (mostly public key crypto) faster. I
heartily recommend it.

@_date: 2009-03-27 18:41:46
@_author: Roger Dingledine 
@_subject: News from my Tor Server raid 
This is (alas) still not a good assumption. Like all huge bureaucracies,
there are plenty of pieces of German law enforcement who don't understand
how the Internet works, much less what Tor is and how it works.
I think I made a lot of progress in talking to the Stuttgart police last
insofar as the number of raids we've heard about has gone way down in
the past year. Notice that this thread is about a raid from 20 months
ago. (This new raid was because they didn't understand how Wikileaks
works -- a related but perhaps independent battle. ;)
In any case, we still have a ways to go before all the law enforcement
in the world understands Tor and Internet security in general. Let me
know if you have good contacts I should help teach!

@_date: 2009-03-13 00:45:50
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.13-alpha is out 
Tor 0.2.1.13-alpha includes another big pile of minor bugfixes and
cleanups. We're finally getting close to a release candidate.
Changes in version 0.2.1.13-alpha - 2009-03-09
  o Major bugfixes:
    - Correctly update the list of which countries we exclude as
      exits, when the GeoIP file is loaded or reloaded. Diagnosed by
      lark. Bugfix on 0.2.1.6-alpha.
  o Minor bugfixes (on 0.2.0.x and earlier):
    - Automatically detect MacOSX versions earlier than 10.4.0, and
      disable kqueue from inside Tor when running with these versions.
      We previously did this from the startup script, but that was no
      help to people who didn't use the startup script. Resolves bug 863.
    - When we had picked an exit node for a connection, but marked it as
      "optional", and it turned out we had no onion key for the exit,
      stop wanting that exit and try again. This situation may not
      be possible now, but will probably become feasible with proposal
      158. Spotted by rovv. Fixes another case of bug 752.
    - Clients no longer cache certificates for authorities they do not
      recognize. Bugfix on 0.2.0.9-alpha.
    - When we can't transmit a DNS request due to a network error, retry
      it after a while, and eventually transmit a failing response to
      the RESOLVED cell. Bugfix on 0.1.2.5-alpha.
    - If the controller claimed responsibility for a stream, but that
      stream never finished making its connection, it would live
      forever in circuit_wait state. Now we close it after SocksTimeout
      seconds. Bugfix on 0.1.2.7-alpha; reported by Mike Perry.
    - Drop begin cells to a hidden service if they come from the middle
      of a circuit. Patch from lark.
    - When we erroneously receive two EXTEND cells for the same circuit
      ID on the same connection, drop the second. Patch from lark.
    - Fix a crash that occurs on exit nodes when a nameserver request
      timed out. Bugfix on 0.1.2.1-alpha; our CLEAR debugging code had
      been suppressing the bug since 0.1.2.10-alpha. Partial fix for
      bug 929.
    - Do not assume that a stack-allocated character array will be
      64-bit aligned on platforms that demand that uint64_t access is
      aligned. Possible fix for bug 604.
    - Parse dates and IPv4 addresses in a locale- and libc-independent
      manner, to avoid platform-dependent behavior on malformed input.
    - Build correctly when configured to build outside the main source
      path. Patch from Michael Gold.
    - We were already rejecting relay begin cells with destination port
      of 0. Now also reject extend cells with destination port or address
      of 0. Suggested by lark.
  o Minor bugfixes (on 0.2.1.x):
    - Don't re-extend introduction circuits if we ran out of RELAY_EARLY
      cells. Bugfix on 0.2.1.3-alpha. Fixes more of bug 878.
    - If we're an exit node, scrub the IP address to which we are exiting
      in the logs. Bugfix on 0.2.1.8-alpha.
  o Minor features:
    - On Linux, use the prctl call to re-enable core dumps when the user
      is option is set.
    - New controller event NEWCONSENSUS that lists the networkstatus
      lines for every recommended relay. Now controllers like Torflow
      can keep up-to-date on which relays they should be using.
    - Update to the "February 26 2009" ip-to-country file.

@_date: 2009-03-13 07:06:59
@_author: Roger Dingledine 
@_subject: Why Tor is slow and what we're going to do about it 
Hi folks,
I just wrote up a blog post about the document we finished yesterday,
which describes our understanding of why the Tor network is slow, and
what measures we can take to resolve the issues:
And for those who had no idea we've got a blog, now you know. :)

@_date: 2009-03-17 03:03:43
@_author: Roger Dingledine 
@_subject: Abuse ticket 
See also
The basic idea there is to start talking to people before incidents
happen, since they're more likely to listen then. This suggestion doesn't
help you so much in your current situation, though.
The other suggestions in the thread might be useful too -- especially
Phobos's suggestion of trying to take your ISP out of the loop in the
abuse responses.

@_date: 2009-03-22 14:21:49
@_author: Roger Dingledine 
@_subject: Bridge scanning resistance 
============================== START ==============================
Yes indeed. It's also a messy project -- rather than knowing what to
build, you need to grapple with a lot of vague security requirements,
along with a lot of potentially contradictory engineering requirements,
and then choose the right balance of "protects well enough against
the important attacks" vs "can be build and deployed without too many
subtleties which induce bugs, and can be maintained afterwards". So
that requires a lot of intuition; it's not a project for a beginner at
this stuff.
Yep. I haven't looked at TLS lately, and our variant where we do rekeying
inside TLS:
but it seems contradictory to both a) authenticate that you're talking
to the right relay, and b) not act funny until you've authenticated, if
we need to demand rekeying (which is pretty odd) before we can see all
the right certs. So there's definitely some design work involved here too.
Check out DirPortFrontPage in the man page.
Yep. My current thought is that you'll never achieve bug-compatibility
with Apache (consider for a moment how good nmap is at distinguishing
OSes based on how they chose to implement TCP), so the only foolproof
plan here is to intercept Tor connections and handle them as Tor, else
pass the connection through to Apache.
Of course, if you're "close enough to Apache", that may be good enough.
Nobody has looked carefully enough to know how much work that would be.
Yep. That wouldn't be so bad though -- the web application doesn't much
care what its bridge lines look like. It's really the bridge descriptor
that needs to get updated, so it includes the password that the bridge
Overall, this looks like one of those high-risk summer projects, where
you might spend your whole time being dismayed at the number of confusing

@_date: 2009-05-25 11:41:08
@_author: Roger Dingledine 
@_subject: weird path selection 
Interesting. Yeah, I've been seeing these lately as well. I added some
more logging, and it looks like the "Client" is actually a wide variety
of previous Tor relays. So somebody out there is trying to build paths
"..., X, moria2, moria2" where X varies widely.
Is it an attack? I dunno what they'd be attacking.
My guesses are either a) an alternative Tor client that didn't think very
hard about its path selection, or b) a scientist experimenting with Tor
paths who again didn't think very hard about path selection.
Alas, it appears that tracking down who it is will be hard. They seem to
be using an anonymity system. ;)

@_date: 2009-05-25 14:21:59
@_author: Roger Dingledine 
@_subject: SoC Project: Improving Hidden Service Security and Usability 
Based on your location, there are two nearby events that might interest
 (Moses Lake, WA; July 2-5)
 (Seattle, WA; August 5-7)
Quite a few Tor developers will be present at each (especially PETS).
Interesting. I've always been conflicted about whether it's possible to
distill enough how-to advice that novices can actually safely set up a
complex (i.e. more than just static html) website.
That's why my walk-through at
suggests thttpd -- it doesn't have all the edge cases that apache /
php / etc would have.
Note that Vidalia has an interface for configuring a hidden service in
It would be neat to eventually have a Thandy component which is
a website. Then in the Thandy interface when you're choosing which
components to track, you could click "hidden service" and it would fetch
and install a thttpd for you. Or heck, a more complex webserver if we
think we can secure it effectively.

@_date: 2009-05-25 16:59:33
@_author: Roger Dingledine 
@_subject: Out-of-date Tors (was Re: 25 tbreg relays in directory) 
Right. Actually, we've recently taught Vidalia how to pop up a box
telling you you're out of date. For those using Thandy, the eventual
goal is for Vidalia and Thandy to automatically fetch the new versions
and check their sigs, which should make it a lot easier to upgrade.
But you're right, this is a real problem. Some of our users use Linux
packaging systems that keep them mostly up to date. But some are on Ubuntu
(...insert expletives here). And some are on BSD, which either provides
no easy upgrades, or the users don't use them.
That's a better idea than our long-ago strategy of "if Tor sees that its
version is not listed as recommended, it emits a warning log entry and
then exits". That old idea had two problems: a) some people ran their
Tors in a while(1) loop to restart after crashes, which caused them to
pull down a new consensus, exit, repeat, which beat up the directories. b)
people fretted that we had implemented a "remote kill switch" for clients.
So your idea above would solve (a), but it would still leave (b), which
was ultimately the reason why we took that "feature" out in 0.1.1.6-alpha:
Two thoughts here.
First, this decision is probably better made at the directory
authorities. They can decide which relays to list in their votes. Check
out dirserv_get_status_impl() in dirserv.c:
  /* 0.1.1.17-rc was the first version that claimed to be stable, * doesn't
   * crash and drop circuits all the time, and is even vaguely
   * compatible with
   * the current network */
  if (platform && !tor_version_as_new_as(platform,"0.1.1.17-rc")) {
    if (msg)
      *msg = "Tor version is far too old to work.";
    return FP_REJECT;
  }
So we could easily bump up that "minimum version" number.
The second thought: these Tor versions aren't *so* bad, compared to the
wide variety of other applications out there. Why are we singling out
Tor versions? Should we check if you're running a new enough patch-level
of Windows, and lock you out otherwise? Should we port-scan the relays
and look for sketchy daemons?
On the one hand, "yes, do everything reasonable to make sure clients
will avoid dangerous relays." But on the other hand, Tor gains security
from diversity and dispersal of relays, and an active attack is more work
(and more risk) than various large-scale passive threats. So I'm
hesitant to cut out too many relays.
And at the same time, when the Tor network is way overloaded and all
the users are crying for more performance, should we really be removing
relays from the list? :)
Again, this is better done by setting FP_BADEXIT at the directory
Actually, you don't want to do this with Valid. Well, you might not. Tor
clients will still use non-Valid relays for middle hops and rendezvous
hops. Check out AllowInvalidNodes in the man page.
Actually, the authorities have an enormous list of bad keys, so they can
recognize most relays that show up using a weak key. That's important,
since you could conceivably run a modern Tor with a weak key, so it's
not a matter of Tor version.
But yes, there is definitely a tradeoff here. I'm not sure where the
right point in the tradeoff is. But my intuition is that cutting 0.1.2.x
relays out of the network would hurt more than help at this point. But
for the few remaining 0.1.1.x relays? Hm.

@_date: 2009-05-31 06:09:50
@_author: Roger Dingledine 
@_subject: Issue about selection of Tor relays when using the default torrc configuration 
Yes, that's a feature. Otherwise you'll open yourself up to a variety
of attacks:
If you want to turn off that defense, set "UseEntryGuards 0" in your
Or you can delete them from your $datadir/state file while Tor is off,
but that's probably more likely to cause problems.
You can get it from SVN:
Playing around and testing with telnet or nc is a fine start. You only
need the torctl library if you find that playing around by hand is
insufficient for your needs.

@_date: 2009-05-31 16:37:34
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.15-rc is out 
Tor 0.2.1.15-rc marks the second release candidate for the 0.2.1.x
series. It fixes a major bug on fast exit relays, as well as a variety
of more minor bugs.
This is a release candidate! That means that we don't know of any
remaining show-stopping bugs, and this will become the new stable if
there are no problems. Please test it, and tell us about any problems
that you find.
Changes in version 0.2.1.15-rc - 2009-05-25
  o Major bugfixes (on 0.2.0.x):
    - Fix a timing-dependent, allocator-dependent, DNS-related crash bug
      that would occur on some exit nodes when DNS failures and timeouts
      occurred in certain patterns. Fix for bug 957.
  o Minor bugfixes (on 0.2.0.x):
    - Actually return -1 in the error case for read_bandwidth_usage().
      Harmless bug, since we currently don't care about the return value
      anywhere. Bugfix on 0.2.0.9-alpha.
    - Provide a more useful log message if bug 977 (related to buffer
      freelists) ever reappears, and do not crash right away.
    - Fix an assertion failure on 64-bit platforms when we allocated
      memory right up to the end of a memarea, then realigned the memory
      one step beyond the end. Fixes a possible cause of bug 930.
    - Protect the count of open sockets with a mutex, so we can't
      corrupt it when two threads are closing or opening sockets at once.
      Fix for bug 939. Bugfix on 0.2.0.1-alpha.
    - Don't allow a bridge to publish its router descriptor to a
      non-bridge directory authority. Fixes part of bug 932.
    - When we change to or from being a bridge, reset our counts of
      client usage by country. Fixes bug 932.
    - Fix a bug that made stream bandwidth get misreported to the
      controller.
    - Stop using malloc_usable_size() to use more area than we had
      actually allocated: it was safe, but made valgrind really unhappy.
    - Fix a memory leak when v3 directory authorities load their keys
      and cert from disk. Bugfix on 0.2.0.1-alpha.
  o Minor bugfixes (on 0.2.1.x):
    - Fix use of freed memory when deciding to mark a non-addable
      descriptor as never-downloadable. Bugfix on 0.2.1.9-alpha.

@_date: 2009-05-05 21:15:58
@_author: Roger Dingledine 
@_subject: Increasing Polipo Portability for GSoC 2009 
In software development lingo, portability has to do with whether a
program compiles and runs on a variety of architectures and operating
It's a different term than the collection of "portable foo" programs
that aim to be run without needing system libraries/etc.

@_date: 2009-05-09 17:52:39
@_author: Roger Dingledine 
@_subject: My tor exit node is gone from the node list? 
How odd. It is still publishing descriptors, and the directory
authorities are still testing its reachability. In particular, here
are the six votes from the six directory authorities:
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s Exit Fast HSDir Running Unnamed V2Dir Valid
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s V2Dir Valid
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s Unnamed V2Dir Valid
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s Exit Fast HSDir Running V2Dir Valid
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s Exit Fast HSDir Running V2Dir Valid
r kyirong hJ1FoyM1XrNPcy7120MLkGoh2q4 a8to9mHCh8NrHRXv2kYvWc80StA 2009-05-09 15:14:55 89.248.169.108 8010 80
s V2Dir Valid
Only three of the six are voting for the Running flag. Therefore it's
not considered running, and it's left out of the consensus (since nobody
would use it anyway).
So that's why it's missing. But, why is it not considered reachable from
three of them? I'm not sure.

@_date: 2009-11-21 22:48:26
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.6-alpha is out 
Tor 0.2.2.6-alpha lays the groundwork for many upcoming features:
support for the new lower-footprint "microdescriptor" directory design,
future-proofing our consensus format against new hash functions or
other changes, and an Android port. It also makes Tor compatible with
the upcoming OpenSSL 0.9.8l release, and fixes a variety of bugs.
Changes in version 0.2.2.6-alpha - 2009-11-19
  o Major features:
    - Directory authorities can now create, vote on, and serve multiple
      parallel formats of directory data as part of their voting process.
      Partially implements Proposal 162: "Publish the consensus in
      multiple flavors".
    - Directory authorities can now agree on and publish small summaries
      of router information that clients can use in place of regular
      server descriptors. This transition will eventually allow clients
      to use far less bandwidth for downloading information about the
      network. Begins the implementation of Proposal 158: "Clients
      download consensus + microdescriptors".
    - The directory voting system is now extensible to use multiple hash
      algorithms for signatures and resource selection. Newer formats
      are signed with SHA256, with a possibility for moving to a better
      hash algorithm in the future.
    - New DisableAllSwap option. If set to 1, Tor will attempt to lock all
      current and future memory pages via mlockall(). On supported
      platforms (modern Linux and probably BSD but not Windows or OS X),
      this should effectively disable any and all attempts to page out
      memory. This option requires that you start your Tor as root --
      if you use DisableAllSwap, please consider using the User option
      to properly reduce the privileges of your Tor.
    - Numerous changes, bugfixes, and workarounds from Nathan Freitas
      to help Tor build correctly for Android phones.
  o Major bugfixes:
    - Work around a security feature in OpenSSL 0.9.8l that prevents our
      handshake from working unless we explicitly tell OpenSSL that we
      are using SSL renegotiation safely. We are, but OpenSSL 0.9.8l
      won't work unless we say we are.
  o Minor bugfixes:
    - Fix a crash bug when trying to initialize the evdns module in
      Libevent 2. Bugfix on 0.2.1.16-rc.
    - Stop logging at severity 'warn' when some other Tor client tries
      to establish a circuit with us using weak DH keys. It's a protocol
      violation, but that doesn't mean ordinary users need to hear about
      it. Fixes the bug part of bug 1114. Bugfix on 0.1.0.13.
    - Do not refuse to learn about authority certs and v2 networkstatus
      documents that are older than the latest consensus. This bug might
      have degraded client bootstrapping. Bugfix on 0.2.0.10-alpha.
      Spotted and fixed by xmux.
    - Fix numerous small code-flaws found by Coverity Scan Rung 3.
    - If all authorities restart at once right before a consensus vote,
      nobody will vote about "Running", and clients will get a consensus
      with no usable relays. Instead, authorities refuse to build a
      consensus if this happens. Bugfix on 0.2.0.10-alpha; fixes bug 1066.
    - If your relay can't keep up with the number of incoming create
      cells, it would log one warning per failure into your logs. Limit
      warnings to 1 per minute. Bugfix on 0.0.2pre10; fixes bug 1042.
    - Bridges now use "reject *:*" as their default exit policy. Bugfix
      on 0.2.0.3-alpha; fixes bug 1113.
    - Fix a memory leak on directory authorities during voting that was
      introduced in 0.2.2.1-alpha. Found via valgrind.

@_date: 2009-11-21 23:42:58
@_author: Roger Dingledine 
@_subject: weak cipher in TLS? 
No, it means that a different algorithm (e.g. DES) could be *offered*.
Generally in cipher negotiations, one side offers a wide variety of
ciphers, and then the other either picks one it's comfortable with,
or refuses to pick any of them.
Correctly-behaving Tor clients (for example, the one we wrote) will only
accept ciphers with sufficient security properties.
   Responders MUST NOT select any TLS ciphersuite that lacks ephemeral keys,
   or whose symmetric keys are less then KEY_LEN bits, or whose digests are
   less than HASH_LEN bits.  Responders SHOULD NOT select any SSLv3
   ciphersuite other than those listed above.
("Those listed above" are basically DHE, RSA/DSS, AES/3DES, and SHA1.)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-11-23 10:20:52
@_author: Roger Dingledine 
@_subject: Connections through Tor 
Thanks for helping out with the network!
You basically want to use your Tor as a client too. So, use it just like
if you had a Tor client running locally -- you do. Open your socksport
in your torrc file (it might be open already), install an http proxy
(either privoxy or polipo) and configure it to point to Tor, and then
make your requests via http to the http proxy. I suspect the various
perl libraries can handle using http proxies just fine.
See e.g.  for more details.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-11-23 14:52:27
@_author: Roger Dingledine 
@_subject: TLS Man-In-The-Middle Vulnerability 
Right. The 0.2.2.6-alpha release should work with the new openssl.
The 0.2.1.21 release will too, but it isn't out yet; I'm still hoping
to combine a second fix (for bug 1150) along with the openssl changes,
and that one is currently being tested.
I figure people who are always running the latest-and-greatest of whatever
libs won't have much trouble either running our development version,
or using the maint-0.2.1 git branch, until the new stable is ready.
Which distros have backported the new openssl that breaks the world?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-11-24 19:15:30
@_author: Roger Dingledine 
@_subject: (FWD) Vidalia bundle upgrade fails on OS X 
[Forwarding since this address isn't subscribed to the list. I also
took the liberty of changing the subject line -- I suspect the problem
is that you had an old install of the Vidalia bundle on your OS X, and
you tried to upgrade to the new drag-and-drop one. You should instead
uninstall the old one, and install the new one fresh. The specific
problem here is that if you upgrade wrong, Vidalia doesn't learn the
correct command-line arguments to use when it launches Polipo. -RD]
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-11-24 19:49:07
@_author: Roger Dingledine 
@_subject: AN idea of non-public exit-nodes 
You might find this faq entry useful:
See especially point  "even if we didn't tell clients about the list of
relays directly, somebody could still make a lot of connections through
Tor to a test site and build a list of the addresses they see."
I guess we could perhaps add support for configuring your own secret
exit node that your buddy runs for you. But at that point the anonymity
that Tor can provide in that situation gets pretty fuzzy.
Indeed. The case of livejournal and Russia is particularly sad here --
lj is where a lot of Russian activists hang out, yet it's also owned and
monitored by (simplifying a little) the Russian authorities. And nobody
in the activist community can get enough momentum to convince people to
move somewhere that is less monitored. Very well done.
For the rest of you following this whole 'livejournal and Russia'
topic, I find Evgeny Morozov's writings to be useful here. See e.g.
Not a new story, alas.
I think one useful approach here is to help livejournal understand that
they need to stop blocking all users who want privacy. Here are some
talking points there:
- Blocking Tor users entirely is over-broad. Even if they have no
  internal mechanism for handling accountability and authentication,
  they can still target only the behaviors that they can't get under
  control. I presume they're blocking it because some small number of
  people are crawling certain resources on livejournal. So they should
  narrow their blocking to just those resources. As a parallel example
  here, Slashdot prevents posts from Tor exit IP addresses, but they
  don't just cut all connections.
- They probably don't have any idea how many 'normal' Tor users they
  have. If the only time you notice Tor is when somebody's being a
  jerk, it's easy to fall into the trap of thinking that Tor only has a
  few users, most of whom are jerks. But the fact is that hundreds of
  thousands of people use Tor daily. Blocking all of them is going to
  impact many more people than you think. (How many of these users use
  LJ daily? I don't know, but if they've set things up to filter based
  on IP address, they could also set things up to count instead.)
- I talked to the chief security officer of Facebook a few months back.
  They used to regard Tor as something that could hurt their business
  model. Then the June election thing happened in Iran, and facebook.com
  was blocked in Iran, and suddenly around 10000 facebook users in
  Iran were connecting via Tor daily. Now Facebook has a very different
  perspective on privacy tools like Tor. Their story is similar in China.
Alas, livejournal's hand here might be forced by their new owners. In
that case, the only answer I can think of is for everybody in the affected
countries to jump ship.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-11-28 14:57:10
@_author: Roger Dingledine 
@_subject: padlock patch for tor 
The 0.2.2.1-alpha ChangeLog includes the entry:
    - New AccelName and AccelDir options add support for dynamic OpenSSL
      hardware crypto acceleration engines.
Can you test AccelName and see if it does what you wanted?
       AccelName NAME
              When using OpenSSL hardware crypto acceleration attempt to  load
              the  dynamic  engine  of  this  name.  This must be used for any
              dynamic hardware engine. Names can be verified with the  openssl
              engine command.
       AccelDir DIR
              Specify  this  option if using dynamic hardware acceleration and
              the engine implementation library resides somewhere  other  than
              the OpenSSL default.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-28 15:05:14
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.4-alpha and 0.2.2.5-alpha are out 
Tor 0.2.2.4-alpha fixes more assert bugs in 0.2.2.2-alpha. It also
introduces a new unit test framework, shifts directry authority addresses
around to reduce the impact from recent blocking events, and fixes a
few smaller bugs.
Tor 0.2.2.5-alpha fixes a few compile problems in 0.2.2.4-alpha.
Alas, the Windows bundles aren't updated yet, since we need to fix some
packaging problems around Vidalia and polipo playing well together. Be
patient -- or help. :) (or fetch the newer Tor from the 'expert packages'
table and cobble it together yourself)
Changes in version 0.2.2.5-alpha - 2009-10-11
  o Major bugfixes:
    - Make the tarball compile again. Oops. Bugfix on 0.2.2.4-alpha.
  o New directory authorities:
    - Move dizum to an alternate IP address.
Changes in version 0.2.2.4-alpha - 2009-10-10
  o Major bugfixes:
    - Fix several more asserts in the circuit_build_times code, for
      example one that causes Tor to fail to start once we have
      accumulated 5000 build times in the state file. Bugfixes on
      0.2.2.2-alpha; fixes bug 1108.
  o New directory authorities:
    - Move moria1 and Tonga to alternate IP addresses.
  o Minor features:
    - Log SSL state transitions at debug level during handshake, and
      include SSL states in error messages. This may help debug future
      SSL handshake issues.
    - Add a new "Handshake" log domain for activities that happen
      during the TLS handshake.
    - Revert to the "June 3 2009" ip-to-country file. The September one
      seems to have removed most US IP addresses.
    - Directory authorities now reject Tor relays with versions less than
      0.1.2.14. This step cuts out four relays from the current network,
      none of which are very big.
  o Minor bugfixes:
    - Fix a couple of smaller issues with gathering statistics. Bugfixes
      on 0.2.2.1-alpha.
    - Fix two memory leaks in the error case of
      circuit_build_times_parse_state(). Bugfix on 0.2.2.2-alpha.
    - Don't count one-hop circuits when we're estimating how long it
      takes circuits to build on average. Otherwise we'll set our circuit
      build timeout lower than we should. Bugfix on 0.2.2.2-alpha.
    - Directory authorities no longer change their opinion of, or vote on,
      whether a router is Running, unless they have themselves been
      online long enough to have some idea. Bugfix on 0.2.0.6-alpha.
      Fixes bug 1023.
  o Code simplifications and refactoring:
    - Revise our unit tests to use the "tinytest" framework, so we
      can run tests in their own processes, have smarter setup/teardown
      code, and so on. The unit test code has moved to its own
      subdirectory, and has been split into multiple modules.

@_date: 2009-10-31 01:17:13
@_author: Roger Dingledine 
@_subject: (FWD) Load external content? message seems inappropriate 
[Forwarding to the list since this address isn't subscribed.
My first question is: what is the content-type header provided by the
webserver? Perhaps it was something that your browser recognized and
thought it couldn't display by itself?
My second thought is: this might be a Torbutton bug, and might want
to go into bugs.torproject.org.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-04 08:32:31
@_author: Roger Dingledine 
@_subject: Node received the reload signal (hup)...what does that mean? 
You probably have a deb installed (e.g. Debian or Ubuntu). It does a hup
every morning, so it can rotate its logs away.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-10 13:32:25
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.2-alpha and 0.2.2.3-alpha are out 
Tor 0.2.2.2-alpha introduces our latest performance improvement for
clients: Tor tracks the average time it takes to build a circuit, and
avoids using circuits that take too long to build. For fast connections,
this feature can cut your expected latency in half. For slow or flaky
connections, it could ruin your Tor experience. Let us know if it does!
Tor 0.2.2.3-alpha fixes a few crash bugs in 0.2.2.2-alpha. The next
version will even fix a few more. :)
Changes in version 0.2.2.3-alpha - 2009-09-23
  o Major bugfixes:
    - Fix an overzealous assert in our new circuit build timeout code.
      Bugfix on 0.2.2.2-alpha; fixes bug 1103.
  o Minor bugfixes:
    - If the networkstatus consensus tells us that we should use a
      negative circuit package window, ignore it. Otherwise we'll
      believe it and then trigger an assert. Bugfix on 0.2.2.2-alpha.
Changes in version 0.2.2.2-alpha - 2009-09-21
  o Major features:
    - Tor now tracks how long it takes to build client-side circuits
      over time, and adapts its timeout to local network performance.
      Since a circuit that takes a long time to build will also provide
      bad performance, we get significant latency improvements by
      discarding the slowest 20% of circuits. Specifically, Tor creates
      circuits more aggressively than usual until it has enough data
      points for a good timeout estimate. Implements proposal 151.
      We are especially looking for reports (good and bad) from users with
      both EDGE and broadband connections that can move from broadband
      to EDGE and find out if the build-time data in the .tor/state gets
      reset without loss of Tor usability. You should also see a notice
      log message telling you that Tor has reset its timeout.
    - Directory authorities can now vote on arbitary integer values as
      part of the consensus process. This is designed to help set
      network-wide parameters. Implements proposal 167.
    - Tor now reads the "circwindow" parameter out of the consensus,
      and uses that value for its circuit package window rather than the
      default of 1000 cells. Begins the implementation of proposal 168.
  o Major bugfixes:
    - Fix a remotely triggerable memory leak when a consensus document
      contains more than one signature from the same voter. Bugfix on
      0.2.0.3-alpha.
  o Minor bugfixes:
    - Fix an extremely rare infinite recursion bug that could occur if
      we tried to log a message after shutting down the log subsystem.
      Found by Matt Edman. Bugfix on 0.2.0.16-alpha.
    - Fix parsing for memory or time units given without a space between
      the number and the unit. Bugfix on 0.2.2.1-alpha; fixes bug 1076.
    - A networkstatus vote must contain exactly one signature. Spec
      conformance issue. Bugfix on 0.2.0.3-alpha.
    - Fix an obscure bug where hidden services on 64-bit big-endian
      systems might mis-read the timestamp in v3 introduce cells, and
      refuse to connect back to the client. Discovered by "rotor".
      Bugfix on 0.2.1.6-alpha.
    - We were triggering a CLOCK_SKEW controller status event whenever
      we connect via the v2 connection protocol to any relay that has
      a wrong clock. Instead, we should only inform the controller when
      it's a trusted authority that claims our clock is wrong. Bugfix
      on 0.2.0.20-rc; starts to fix bug 1074. Reported by SwissTorExit.
    - We were telling the controller about CHECKING_REACHABILITY and
      REACHABILITY_FAILED status events whenever we launch a testing
      circuit or notice that one has failed. Instead, only tell the
      controller when we want to inform the user of overall success or
      overall failure. Bugfix on 0.1.2.6-alpha. Fixes bug 1075. Reported
      by SwissTorExit.
    - Don't warn when we're using a circuit that ends with a node
      excluded in ExcludeExitNodes, but the circuit is not used to access
      the outside world. This should help fix bug 1090, but more problems
      remain. Bugfix on 0.2.1.6-alpha.
    - Work around a small memory leak in some versions of OpenSSL that
      stopped the memory used by the hostname TLS extension from being
      freed.
    - Make our 'torify' script more portable; if we have only one of
      'torsocks' or 'tsocks' installed, don't complain to the user;
      and explain our warning about tsocks better.
  o Minor features:
    - Add a "getinfo status/accepted-server-descriptor" controller
      command, which is the recommended way for controllers to learn
      whether our server descriptor has been successfully received by at
      least on directory authority. Un-recommend good-server-descriptor
      getinfo and status events until we have a better design for them.
    - Update to the "September 4 2009" ip-to-country file.

@_date: 2009-10-10 15:23:26
@_author: Roger Dingledine 
@_subject: Is it me or a bug? 
You're right, that was a mistake. I just corrected the spec to explain:
     "650" SP "STREAM_BW" SP StreamID SP BytesWritten SP BytesRead CRLF
     BytesWritten = 1*DIGIT
     BytesRead = 1*DIGIT
  BytesWritten and BytesRead are the number of bytes written and read
  by the application since the last STREAM_BW event on this stream.
  Note that from Tor's perspective, *reading* a byte on a stream means
  that the application *wrote* the byte. That's why the order of "written"
  vs "read" is opposite for stream_bw events compared to bw events.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-10 20:10:03
@_author: Roger Dingledine 
@_subject: Bug? 
When you open the network map in Vidalia, that tells Vidalia to go find
out what country and city each relay is in. You'll probably notice an
attempt to some-IP-address port 443 appear in the "connection" part of
the network map window.
Once Vidalia finishes doing those fetches (anonymously, via Tor), it
will replace the question marks with flags.
So if your Tor isn't working, that could be one reason why Vidalia hasn't
figured out the country and city yet. Another reason could be that you
haven't let it try enough yet.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-12 13:53:48
@_author: Roger Dingledine 
@_subject: Use that anonym relay 
Set these two lines in your torrc:
UseBridges 1
Bridge 128.31.0.34:9009 4C17FB532E20B2A8AC199441ECD2B0177B39E4B1
You can even leave off the fingerprint. See also
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-12 17:45:57
@_author: Roger Dingledine 
@_subject: Tame circuits 
Section 5.4 of control-spec.txt:
  __LeaveStreamsUnattached
    If true, Tor will not automatically attach new streams to circuits;
    instead, the controller must attach them with ATTACHSTREAM.  If the
    controller does not attach the streams, their data will never be routed.
Setting that to 1 will prevent Tor from building a circuit in response
to a socks request. (Setting __DisablePredictedCircuits will prevent
Tor from building circuits beforehand in anticipation of socks requests.)
As for overhead, if you want to control circuits, this is how you do it.
Unless you can suggest a better way.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-14 14:18:17
@_author: Roger Dingledine 
@_subject: Less OT: Here's a Solaris crypto acceleration branch to try. 
That callgraph looks like it didn't handle much traffic.
10% of the cpu time was spend loading the geoip file?
Looks like he captured the call graph soon after he turned on his Tor.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-10-16 22:34:45
@_author: Roger Dingledine 
@_subject: Directory History 
November 16 2009 has not yet occurred?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-24 01:34:19
@_author: Roger Dingledine 
@_subject: [OT]RE: Unsubscribe 
Yep. Gone are the days where people on this list reliably know what
email headers are. :)
I just hacked^Wconfigured majordomo to put a footer on every mail to
the list. We'll see if it works.
To unsubscribe, send an e-mail to majordomo at seul.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-24 04:08:52
@_author: Roger Dingledine 
@_subject: Repeatedly changing unique exit nodes 
You want to do non-standard things with your Tor. You should start by
looking at the control protocol specification, which lets you tell Tor
how to choose its paths:
and Torctl, a Python lib to help use the control protocol:
However, it won't be trivial. Mostly I hear requests like these from
people who only know a little bit of php, and they want to vote a thousand
times on some online survey, or spam a thousand website comment fields,
or other things like that. I have to say I'm not very sympathetic to
those goals.
Perhaps you have a use case in mind that would make people more excited
to see this happen? :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-01 23:58:50
@_author: Roger Dingledine 
@_subject: More important: Bridges or ORs 
Fortunately, I wrote this up as a faq entry during the June Iran
events. :)

@_date: 2009-09-27 05:13:03
@_author: Roger Dingledine 
@_subject: Are that repositoy alive? 
Yes, for a while. You should switch.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-27 05:30:28
@_author: Roger Dingledine 
@_subject: onion_skin_client_handshake failed. 
How odd. What's happening is your Tor is trying to extend a circuit
(this is a client-side circuit, that is, a circuit that your Tor could
use for its own connections), and you send your half of the handshake,
and get back the other half of the handshake. Then you compute what you
think the session key should be (based on both halves of the handshake),
and compare that to what the fellow on the other end thought the session
key should be. They don't match.
Has anybody else been seeing these?
If not, my guess is there's something weird with your hardware or
your openssl libs. You don't happen to be using some sort of crypto
accelerator, do you? :) If so, try turning it off and see if the problems
go away.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-30 04:39:31
@_author: Roger Dingledine 
@_subject: (FWD) Tor partially blocked in China; change your relay's IP address? 
(For those of you who want to be on tor-relays, you can learn more about
it at  )
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-30 05:20:28
@_author: Roger Dingledine 
@_subject: (FWD) Tor partially blocked in China; change your relay's IP address? 
Well, yeah. That's why we designed bridge relays, if you're a user in
this situation.
Turn it around and think of it as a strength -- you can use bridges by
default, but for those who don't yet need them, we provide a much easier
way of using Tor too. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2009-09-02 15:23:53
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.1-alpha is out 
Tor 0.2.2.1-alpha disables ".exit" address notation by default, allows
Tor clients to bootstrap on networks where only port 80 is reachable,
makes it more straightforward to support hardware crypto accelerators,
and starts the groundwork for gathering stats safely at relays.
We've been improving our packages and bundles:
  o Packaging changes:
    - Upgrade Vidalia from 0.1.15 to 0.2.3 in the Windows and OS X
      installer bundles. See
            for details of what's new in Vidalia 0.2.3.
    - Windows Vidalia Bundle: update Privoxy from 3.0.6 to 3.0.14-beta.
    - OS X Vidalia Bundle: move to Polipo 1.0.4 with Tor specific
      configuration file, rather than the old Privoxy.
    - OS X Vidalia Bundle: Vidalia, Tor, and Polipo are compiled as
      x86-only for better compatibility with OS X 10.6, aka Snow Leopard.
    - OS X Tor Expert Bundle: Tor is compiled as x86-only for
      better compatibility with OS X 10.6, aka Snow Leopard.
    - OS X Vidalia Bundle: The multi-package installer is now replaced
      by a simple drag and drop to the /Applications folder. This change
      occurred with the upgrade to Vidalia 0.2.3.
Changes in version 0.2.2.1-alpha - 2009-08-26
  o Security fixes:
    - Start the process of disabling ".exit" address notation, since it
      can be used for a variety of esoteric application-level attacks
      on users. To reenable it, set "AllowDotExit 1" in your torrc. Fix
      on 0.0.9rc5.
  o New directory authorities:
    - Set up urras (run by Jacob Appelbaum) as the seventh v3 directory
      authority.
  o Major features:
    - New AccelName and AccelDir options add support for dynamic OpenSSL
      hardware crypto acceleration engines.
    - Tor now supports tunneling all of its outgoing connections over
      a SOCKS proxy, using the SOCKS4Proxy and/or SOCKS5Proxy
      configuration options. Code by Christopher Davis.
  o Major bugfixes:
    - Send circuit or stream sendme cells when our window has decreased
      by 100 cells, not when it has decreased by 101 cells. Bug uncovered
      by Karsten when testing the "reduce circuit window" performance
      patch. Bugfix on the 54th commit on Tor -- from July 2002,
      before the release of Tor 0.0.0. This is the new winner of the
      oldest-bug prize.
  o New options for gathering stats safely:
    - Directories that set "DirReqStatistics 1" write statistics on
      directory request to disk every 24 hours. As compared to the
      --enable-geoip-stats flag in 0.2.1.x, there are a few improvements:
      1) stats are written to disk exactly every 24 hours; 2) estimated
      shares of v2 and v3 requests are determined as mean values, not at
      the end of a measurement period; 3) unresolved requests are listed
      with country code '??'; 4) directories also measure download times.
    - Exit nodes that set "ExitPortStatistics 1" write statistics on the
      number of exit streams and transferred bytes per port to disk every
      24 hours.
    - Relays that set "CellStatistics 1" write statistics on how long
      cells spend in their circuit queues to disk every 24 hours.
    - Entry nodes that set "EntryStatistics 1" write statistics on the
      rough number and origins of connecting clients to disk every 24
      hours.
    - Relays that write any of the above statistics to disk and set
      "ExtraInfoStatistics 1" include the past 24 hours of statistics in
      their extra-info documents.
  o Minor features:
    - New --digests command-line switch to output the digests of the
      source files Tor was built with.
    - The "torify" script now uses torsocks where available.
    - The memarea code now uses a sentinel value at the end of each area
      to make sure nothing writes beyond the end of an area. This might
      help debug some conceivable causes of bug 930.
    - Time and memory units in the configuration file can now be set to
      fractional units. For example, "2.5 GB" is now a valid value for
      AccountingMax.
    - Certain Tor clients (such as those behind check.torproject.org) may
      want to fetch the consensus in an extra early manner. To enable this
      a user may now set FetchDirInfoExtraEarly to 1. This also depends on
      setting FetchDirInfoEarly to 1. Previous behavior will stay the same
      as only certain clients who must have this information sooner should
      set this option.
    - Instead of adding the svn revision to the Tor version string, report
      the git commit (when we're building from a git checkout).
  o Minor bugfixes:
    - If any the v3 certs we download are unparseable, we should actually
      notice the failure so we don't retry indefinitely. Bugfix on
      0.2.0.x; reported by "rotator".
    - If the cached cert file is unparseable, warn but don't exit.
    - Fix possible segmentation fault on directory authorities. Bugfix on
      0.2.1.14-rc.
    - When Tor fails to parse a descriptor of any kind, dump it to disk.
      Might help diagnosing bug 1051.
  o Deprecated and removed features:
    - The controller no longer accepts the old obsolete "addr-mappings/"
      or "unregistered-servers-" GETINFO values.
    - Hidden services no longer publish version 0 descriptors, and clients
      do not request or use version 0 descriptors. However, the old hidden
      service authorities still accept and serve version 0 descriptors
      when contacted by older hidden services/clients.
    - The EXTENDED_EVENTS and VERBOSE_NAMES controller features are now
      always on; using them is necessary for correct forward-compatible
      controllers.
    - Remove support for .noconnect style addresses. Nobody was using
      them, and they provided another avenue for detecting Tor users
      via application-level web tricks.

@_date: 2009-09-16 00:11:44
@_author: Roger Dingledine 
@_subject: New tor debs repo live 
Actually, it won't be quite that bad. Peter (our Debian guy) plans to
continue updating the debs at noreply.org for "a while". The current plan
is to do it until the current signing subkey for the noreply repository
expires (another year or so).
At that point users will think it's broken anyway, so the easiest fix
will be to update their repository address.
This part is definitely true.

@_date: 2010-04-02 16:57:57
@_author: Roger Dingledine 
@_subject: Polipo question 
I believe the answer is that you can't turn off caching. It's core to
what polipo does. But perhaps Chris or Juliusz will contradict me.
My guess is that's actually Torbutton preventing you from reaching port
8118 or port 8123, not Firefox preventing you from reaching localhost.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-18 13:21:33
@_author: Roger Dingledine 
@_subject: BadExit flag still needed for PrivacyNow... 
Sebastian just confirmed for me that it was really happening, so I've
set the BadExit flag for moria1. I agree that dns filtering is a good
reason for earning the BadExit flag.
Once tor26 or ides set it also, it should take effect.
Sorry for the delay in response. As usual, we're all overbusy over
here. I was supposed to be on an airplane over the Atlantic now --
but it looks instead like I can catch up on my email. :)
On the bright side though, it's looking good that we'll be able to get a
google summer of code student to revive Mike Perry's "Snakes on a Tor"
project, and hopefully that means we will a) have some automated scans
looking for really obviously broken relays, and b) build a clearer policy
about what counts as badexit and what doesn't, so we can react faster
next time.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-02 17:22:42
@_author: Roger Dingledine 
@_subject: Resend: fastestfox and too many connections 
See also
If somebody would verify the bug and figure out how to reproduce it
reliably, that would be grand.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-22 02:15:23
@_author: Roger Dingledine 
@_subject: Very strange exit-node? Bad or evil exit-node? 
The way you overcome that is you get more people to run fast exit relays
for the Tor network.
Right now not enough people do, so you end up using blutmagie a lot.
The Tor network is a community, and it sure does need to grow if it wants
to handle all the people who want safety around the world.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-22 19:39:07
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.11-alpha and 0.2.2.12-alpha are out 
Tor 0.2.2.12-alpha fixes a critical bug in how directory authorities
handle and vote on descriptors. It was causing relays to drop out of
the consensus.
Tor 0.2.2.11-alpha fixes yet another instance of broken OpenSSL libraries
that was causing some relays to drop out of the consensus.
(Windows bundles will be available whenever Andrew gets around to making
them; we're trying to stick to a policy of announcing alphas on time
rather than waiting for every package.)
Changes in version 0.2.2.12-alpha - 2010-04-20
  o Major bugfixes:
    - Many relays have been falling out of the consensus lately because
      not enough authorities know about their descriptor for them to get
      a majority of votes. When we deprecated the v2 directory protocol,
      we got rid of the only way that v3 authorities can hear from each
      other about other descriptors. Now authorities examine every v3
      vote for new descriptors, and fetch them from that authority. Bugfix
      on 0.2.1.23.
    - Fix two typos in tor_vasprintf() that broke the compile on Windows,
      and a warning in or.h related to bandwidth_weight_rule_t that
      prevented clean compile on OS X. Fixes bug 1363; bugfix on
      0.2.2.11-alpha.
    - Fix a segfault on relays when DirReqStatistics is enabled
      and 24 hours pass. Bug found by keb. Fixes bug 1365; bugfix on
      0.2.2.11-alpha.
  o Minor bugfixes:
    - Demote a confusing TLS warning that relay operators might get when
      someone tries to talk to their OrPort. It is neither the operator's
      fault nor can they do anything about it. Fixes bug 1364; bugfix
      on 0.2.0.14-alpha.
Changes in version 0.2.2.11-alpha - 2010-04-15
  o Major bugfixes:
    - Directory mirrors were fetching relay descriptors only from v2
      directory authorities, rather than v3 authorities like they should.
      Only 2 v2 authorities remain (compared to 7 v3 authorities), leading
      to a serious bottleneck. Bugfix on 0.2.0.9-alpha. Fixes bug 1324.
    - Fix a parsing error that made every possible value of
      CircPriorityHalflifeMsec get treated as "1 msec". Bugfix
      on 0.2.2.7-alpha. Rename CircPriorityHalflifeMsec to
      CircuitPriorityHalflifeMsec, so authorities can tell newer relays
      about the option without breaking older ones.
    - Fix SSL renegotiation behavior on OpenSSL versions like on Centos
      that claim to be earlier than 0.9.8m, but which have in reality
      backported huge swaths of 0.9.8m or 0.9.8n renegotiation
      behavior. Possible fix for some cases of bug 1346.
  o Minor features:
    - Experiment with a more aggressive approach to preventing clients
      from making one-hop exit streams. Exit relays who want to try it
      out can set "RefuseUnknownExits 1" in their torrc, and then look
      for "Attempt by %s to open a stream" log messages. Let us know
      how it goes!
    - Add support for statically linking zlib by specifying
      --enable-static-zlib, to go with our support for statically linking
      openssl and libevent. Resolves bug 1358.
  o Minor bugfixes:
    - Fix a segfault that happens whenever a Tor client that is using
      libevent2's bufferevents gets a hup signal. Bugfix on 0.2.2.5-alpha;
      fixes bug 1341.
    - When we cleaned up the contrib/tor-exit-notice.html file, we left
      out the first line. Fixes bug 1295.
    - When building the manpage from a tarball, we required asciidoc, but
      the asciidoc -> roff/html conversion was already done for the
      tarball. Make 'make' complain only when we need asciidoc (either
      because we're compiling directly from git, or because we altered
      the asciidoc manpage in the tarball). Bugfix on 0.2.2.9-alpha.
    - When none of the directory authorities vote on any params, Tor
      segfaulted when trying to make the consensus from the votes. We
      didn't trigger the bug in practice, because authorities do include
      params in their votes. Bugfix on 0.2.2.10-alpha; fixes bug 1322.
  o Testsuite fixes:
    - In the util/threads test, no longer free the test_mutex before all
      worker threads have finished. Bugfix on 0.2.1.6-alpha.
    - The master thread could starve the worker threads quite badly on
      certain systems, causing them to run only partially in the allowed
      window. This resulted in test failures. Now the master thread sleeps
      occasionally for a few microseconds while the two worker-threads
      compete for the mutex. Bugfix on 0.2.0.1-alpha.

@_date: 2010-04-23 14:16:57
@_author: Roger Dingledine 
@_subject: Declining traffic 
My first thought is that you updated your openssl rpm in centos, which
disabled tls renegotiation in yet another new way, and that broke your
Tor relay. Meaning your relay still worked, but it would only do tls
renegotiation with other people with centos's particular openssl twist.
Tor 0.2.2.11-alpha fixes the issue we hope:
    - Fix SSL renegotiation behavior on OpenSSL versions like on Centos
      that claim to be earlier than 0.9.8m, but which have in reality
      backported huge swaths of 0.9.8m or 0.9.8n renegotiation
      behavior. Possible fix for some cases of bug 1346.
But we haven't yet put out a stable release that includes that patch.
So if you upgraded to the latest 0.2.2.x-alpha to get the fixes for other
bugs, you would get the fix for this bug too. Let us know if it works.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-03 16:52:50
@_author: Roger Dingledine 
@_subject: Cannot Download Bridges 
Turns out this was something we could fix in Vidalia. The current version
of Vidalia had a hard-coded ssl cert in mind for bridges.torproject.org,
but we changed that cert on the site itself.
Expect the "find bridges now" button to resume working in a later
Vidalia release.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-23 16:57:42
@_author: Roger Dingledine 
@_subject: (FWD) Re: Declining traffic 
For those who haven't noticed yet, relays on Centos running 0.2.1.25 will
fail to work as expected. You should either upgrade to 0.2.2.12-alpha,
or wait patiently for 0.2.1.26.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-24 06:45:38
@_author: Roger Dingledine 
@_subject: Declining traffic 
It does work, as far as I am told. Or are you talking about yet another
operating system vendor that crippled its openssl in some new way?
I believe some of the BSDs took tls renegotiation out of their openssl
entirely. It's quite possible they would be bold enough to declare that
their openssl is the real openssl 1.0.0. The only answer there is to
not use their crippled openssl.
Has anybody else here tried Tor with openssl 1.0.0 and found that it
worked / didn't work?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-24 06:51:14
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.11-alpha and 0.2.2.12-alpha are out 
Yes, because I tagged it well before we had a handle on the connection
flooding bug. One critical bugfix at a time, please. :)
Tor 0.2.2.13-alpha packages should be coming out shortly. I just
tagged it, so you're welcome to fetch the tarball.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-28 15:13:19
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.13-alpha is out 
Tor 0.2.2.13-alpha addresses the recent connection and memory overload
problems we've been seeing on relays, especially relays with their DirPort
open. If your relay has been crashing, or you turned it off because it
used too many resources, give this release a try.
Changes in version 0.2.2.13-alpha - 2010-04-24
  o Major bugfixes:
    - Teach relays to defend themselves from connection overload. Relays
      now close idle circuits early if it looks like they were intended
      for directory fetches. Relays are also more aggressive about closing
      TLS connections that have no circuits on them. Such circuits are
      unlikely to be re-used, and tens of thousands of them were piling
      up at the fast relays, causing the relays to run out of sockets
      and memory. Bugfix on 0.2.0.22-rc (where clients started tunneling
      their directory fetches over TLS).
  o Minor features:
    - Finally get rid of the deprecated and now harmful notion of "clique
      mode", where directory authorities maintain TLS connections to
      every other relay.
    - Directory authorities now do an immediate reachability check as soon
      as they hear about a new relay. This change should slightly reduce
      the time between setting up a relay and getting listed as running
      in the consensus. It should also improve the time between setting
      up a bridge and seeing use by bridge users.
    - Directory authorities no longer launch a TLS connection to every
      relay as they startup. Now that we have 2k+ descriptors cached,
      the resulting network hiccup is becoming a burden. Besides,
      authorities already avoid voting about Running for the first half
      hour of their uptime.

@_date: 2010-04-04 15:46:00
@_author: Roger Dingledine 
@_subject: vps 
But also see
If you get one that's too cheap, it might be so cheap because they're
lying to you about actually providing a server environment big enough
to run programs like Tor. Many VPS providers get away with this "bait
and switch" approach because most of their customers don't actually use
the VPS for much, so they never notice that it's artificially crippled.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-05 20:33:22
@_author: Roger Dingledine 
@_subject: (FWD) Re: Good news: tor 0.2.1.25 works on Sparc-Solaris10 
[Forwarding since Wyllys isn't subscribed at this address -RD]
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-10 00:08:12
@_author: Roger Dingledine 
@_subject: [or-talk] where are the exit nodes gone? 
No, that 1755 was total Running relays. For comparison, there are
1541 running relays in the consensus right now.
You might like
Also, we moved from tor.eff.org to torproject.org several years ago. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-01 16:33:50
@_author: Roger Dingledine 
@_subject: Cannot Download Bridges 
What happens when you try to visit with your (non-torified) browser?
It's possible. It's just a website, and the people running your country's
firewall are already good at blocking websites when they choose to.
Also, you should notice that the bridges given out via https tend to
get blocked earlier than the bridges given out via gmail. So if they do
block that website, it may be that the next step is to block the bridges
it gives out.
A fine question. Last I heard, that website is only blocked in China.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-11 00:15:23
@_author: Roger Dingledine 
@_subject: "prifoxy" privoxy-on-firefox-extension? 
Hi folks,
Several people on irc have pointed out "prifoxy":
Can somebody take a look at it, and decide whether it's for real,
whether it looks competently done, trustworthy, safe to recommend, etc?
My brief look showed me a binary blob and not much else, so my guess
is that it's bad news; but more eyes would be great.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-11 12:04:26
@_author: Roger Dingledine 
@_subject: Tor-network-status wishlist (was Re: [or-talk] where are the exit 
Here's my chance to remind people about
I think  and  have been done, but  and  remain.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-11 22:06:28
@_author: Roger Dingledine 
@_subject: Polipo and dnsUseGethostbyname - what is the best option and 
As I understand it, the question is whether polipo should use the
system call named gethostbyname(), or if it should use its own internal
non-blocking dns resolve code. The question isn't "should polipo disable
dns resolves or not".
Back when I picked the "yes" answer, there were two reasons:
A) polipo's internal dns resolve code didn't look at /etc/hosts,
so when I set my proxy to localhost:9050, polipo would try to resolve
"localhost", and it ended up asking my ISP where "localhost" was. My ISP
helpfully answered 127.0.0.1, but what if my ISP had answered something
else? Really bad news.
B) There were some remote buffer overflows in polipo's internal dns
resolve code.
Given those, and since polipo shouldn't be doing any dns resolves anyway
when it's using a socks5 proxy, I figured I'd go for the choice that
exposed less surface area.
I'm not sure whether either of these bugs are fixed at present (ugh). So
I'd recommend sticking with yes (or true, I guess it's called now).
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-08-20 21:26:38
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.15-alpha is out 
Tor 0.2.2.15-alpha fixes a big bug in hidden service availability, fixes a
variety of other bugs that were preventing performance experiments from
moving forward, fixes several bothersome memory leaks, and generally
closes a lot of smaller bugs that have been filling up trac lately.
Packages will be appearing over the next few days or weeks.
Changes in version 0.2.2.15-alpha - 2010-08-18
  o Major bugfixes:
    - Stop assigning the HSDir flag to relays that disable their
      DirPort (and thus will refuse to answer directory requests). This
      fix should dramatically improve the reachability of hidden services:
      hidden services and hidden service clients pick six HSDir relays
      to store and retrieve the hidden service descriptor, and currently
      about half of the HSDir relays will refuse to work. Bugfix on
      0.2.0.10-alpha; fixes part of bug 1693.
    - The PerConnBWRate and Burst config options, along with the
      bwconnrate and bwconnburst consensus params, initialized each conn's
      token bucket values only when the connection is established. Now we
      update them if the config options change, and update them every time
      we get a new consensus. Otherwise we can encounter an ugly edge
      case where we initialize an OR conn to client-level bandwidth,
      but then later the relay joins the consensus and we leave it
      throttled. Bugfix on 0.2.2.7-alpha; fixes bug 1830.
    - Fix a regression that caused Tor to rebind its ports if it receives
      SIGHUP while hibernating. Bugfix in 0.1.1.6-alpha; closes bug 919.
  o Major features:
    - Lower the maximum weighted-fractional-uptime cutoff to 98%. This
      should give us approximately 40-50% more Guard-flagged nodes,
      improving the anonymity the Tor network can provide and also
      decreasing the dropoff in throughput that relays experience when
      they first get the Guard flag.
    - Allow enabling or disabling the *Statistics config options while
      Tor is running.
  o Minor features:
    - Update to the August 1 2010 Maxmind GeoLite Country database.
    - Have the controller interface give a more useful message than
      "Internal Error" in response to failed GETINFO requests.
    - Warn when the same option is provided more than once in a torrc
      file, on the command line, or in a single SETCONF statement, and
      the option is one that only accepts a single line. Closes bug 1384.
    - Build correctly on mingw with more recent versions of OpenSSL 0.9.8.
      Patch from mingw-san.
    - Add support for the country code "{??}" in torrc options like
      ExcludeNodes, to indicate all routers of unknown country. Closes
      bug 1094.
    - Relays report the number of bytes spent on answering directory
      requests in extra-info descriptors similar to {read,write}-history.
      Implements enhancement 1790.
  o Minor bugfixes (on 0.2.1.x and earlier):
    - Complain if PublishServerDescriptor is given multiple arguments that
      include 0 or 1. This configuration will be rejected in the future.
      Bugfix on 0.2.0.1-alpha; closes bug 1107.
    - Disallow BridgeRelay 1 and ORPort 0 at once in the configuration.
      Bugfix on 0.2.0.13-alpha; closes bug 928.
    - Change "Application request when we're believed to be offline."
      notice to "Application request when we haven't used client
      functionality lately.", to clarify that it's not an error. Bugfix
      on 0.0.9.3; fixes bug 1222.
    - Fix a bug in the controller interface where "GETINFO ns/asdaskljkl"
      would return "551 Internal error" rather than "552 Unrecognized key
      ns/asdaskljkl". Bugfix on 0.1.2.3-alpha.
    - Users can't configure a regular relay to be their bridge. It didn't
      work because when Tor fetched the bridge descriptor, it found
      that it already had it, and didn't realize that the purpose of the
      descriptor had changed. Now we replace routers with a purpose other
      than bridge with bridge descriptors when fetching them. Bugfix on
      0.1.1.9-alpha. Bug 1776 not yet fixed because now we immediately
      refetch the descriptor with router purpose 'general', disabling
      it as a bridge.
    - Fix a rare bug in rend_fn unit tests: we would fail a test when
      a randomly generated port is 0. Diagnosed by Matt Edman. Bugfix
      on 0.2.0.10-alpha; fixes bug 1808.
    - Exit nodes didn't recognize EHOSTUNREACH as a plausible error code,
      and so sent back END_STREAM_REASON_MISC. Clients now recognize a new
      stream ending reason for this case: END_STREAM_REASON_NOROUTE.
      Servers can start sending this code when enough clients recognize
      it. Also update the spec to reflect this new reason. Bugfix on
      0.1.0.1-rc; fixes part of bug 1793.
    - Delay geoip stats collection by bridges for 6 hours, not 2 hours,
      when we switch from being a public relay to a bridge. Otherwise
      there will still be clients that see the relay in their consensus,
      and the stats will end up wrong. Bugfix on 0.2.1.15-rc; fixes bug
      932 even more.
    - Instead of giving an assertion failure on an internal mismatch
      on estimated freelist size, just log a BUG warning and try later.
      Mitigates but does not fix bug 1125.
    - Fix an assertion failure that could occur in caches or bridge users
      when using a very short voting interval on a testing network.
      Diagnosed by Robert Hogan. Fixes bug 1141; bugfix on 0.2.0.8-alpha.
  o Minor bugfixes (on 0.2.2.x):
    - Alter directory authorities to always consider Exit-flagged nodes
      as potential Guard nodes in their votes. The actual decision to
      use Exits as Guards is done in the consensus bandwidth weights.
      Fixes bug 1294; bugfix on 0.2.2.10-alpha.
    - When the controller is reporting the purpose of circuits that
      didn't finish building before the circuit build timeout, it was
      printing UNKNOWN_13. Now print EXPIRED. Bugfix on 0.2.2.14-alpha.
    - Our libevent version parsing code couldn't handle versions like
      1.4.14b-stable and incorrectly warned the user about using an
      old and broken version of libevent. Treat 1.4.14b-stable like
      1.4.14-stable when parsing the version. Fixes bug 1731; bugfix
      on 0.2.2.1-alpha.
    - Don't use substitution references like $(VAR:MOD) when
      $(asciidoc_files) is empty -- make(1) on NetBSD transforms
      '$(:x)' to 'x' rather than the empty string. This bites us in
      doc/ when configured with --disable-asciidoc. Bugfix on
      0.2.2.9-alpha; fixes bug 1773.
    - Remove a spurious hidden service server-side log notice about
      "Ancient non-dirty circuits". Bugfix on 0.2.2.14-alpha; fixes
      bug 1741.
    - Fix compilation with --with-dmalloc set. Bugfix on 0.2.2.6-alpha;
      fixes bug 1832.
    - Correctly report written bytes on linked connections. Found while
      implementing 1790. Bugfix on 0.2.2.4-alpha.
    - Fix three memory leaks: one in circuit_build_times_parse_state(),
      one in dirvote_add_signatures_to_pending_consensus(), and one every
      time we parse a v3 network consensus. Bugfixes on 0.2.2.14-alpha,
      0.2.2.6-alpha, and 0.2.2.10-alpha respectively; fixes bug 1831.
  o Code simplifications and refactoring:
    - Take a first step towards making or.h smaller by splitting out
      function definitions for all source files in src/or/. Leave
      structures and defines in or.h for now.
    - Remove a bunch of unused function declarations as well as a block of
       0'd code from the unit tests. Closes bug 1824.
    - New unit tests for exit-port history statistics; refactored exit
      statistics code to be more easily tested.
    - Remove the old debian/ directory from the main Tor distribution.
      The official Tor-for-debian git repository lives at the URL

@_date: 2010-08-22 01:14:45
@_author: Roger Dingledine 
@_subject: Bigger Thinking [was: Tor Project 2008 Tax Return] 
Here's some reading:
We haven't gotten the "microdescriptor" out in practice yet, but
it's on its way:
Most ways to do this are bad news:
But it probably is how the distant future will look:
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-08-22 11:43:48
@_author: Roger Dingledine 
@_subject: ?fter upgrading a stable Tor-version to alfa  Tor-version 
No, it's not normal.
What package, which OS, how did you upgrade, etc?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-08-28 14:51:35
@_author: Roger Dingledine 
@_subject: Tor seems to have a huge security risk--please prove me wrong! 
Maybe. Or maybe not. This is an open research area that continues to
worry me.
I keep talking to professors and grad students who have started a paper
showing that website fingerprinting works on Tor, and after a while they
stop working on the paper because they can't get good results either way
(they can't show that it works well, and they also can't show that it
doesn't work well).
The real question I want to see answered is not "does it work" -- I bet
it can work in some narrow situations even if it doesn't work well in
the general case. Rather, I want to know how to make it work less well.
But we need to have a better handle on how well it works before we can
answer that harder question.
For those who want more background, you can read more at item  on
(I hoped to transition
 over to that new
page, but haven't gotten around to finishing)
or see my 25c3 talk from 2008:
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-08-30 03:59:00
@_author: Roger Dingledine 
@_subject: What are these entries in my connections tab (using Vidalia 
These are internal circuits, built without any plans to exit to external
services, but instead ready to handle hidden service requests.
Tor starts out thinking maybe you'll interact with hidden services,
so it builds some circuits for them preemptively.
If an hour passes and you don't use them, it closes them and doesn't
build any new ones.
You may find the in-progress path-spec document useful:
See sec 2.1.1 in particular.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-08-14 16:32:14
@_author: Roger Dingledine 
@_subject: Tor Project 2008 Tax Return Now Online 
If you know any funders outside the US who care about privacy, anonymity,
or circumvention, we're all ears. :)
Conspiracy theories aside, this is an important open research question
that still needs more research attention: if you can watch a given amount
of Internet backbone traffic, how much of the Tor network can you surveil?
Here are three papers to get you started if you want to learn more about
this issue:
Designs like Tor have always accepted that they will be vulnerable to
a global passive adversary:
The key point to realize here is that you shouldn't so much think about
the locations of the Tor relays, but instead think about which networks
the communication between Tor users and the Tor network traverses,
and which networks the communication between the Tor network and the
destination services (e.g. websites) traverses. The Internet itself has
bottlenecks that make our task hard even if we could engineer a good
diversity of relay locations.
We can certainly imagine that some pieces of the US government have the
capability to tap large pieces of the Internet:
But what saves us here is that the US government, like all governments,
is not one person. It's a lot of different groups, all with different
goals and different capabilities. So a) that means some parts of the
government actually want to support freedom of speech and/or need for
themselves the security properties that Tor provides, and b) there's a
huge amount of bureaucracy to slow down coordination between different
pieces of the government -- so even if somebody at NSA can beat Tor,
that doesn't mean somebody at FBI can call him up and ask for answers.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-17 03:04:22
@_author: Roger Dingledine 
@_subject: Vidalia and interactively changing Tor circuits. 
Vidalia lets you view what relays are in a circuit, and lets you ask
Tor to close a circuit, but Vidalia has no notion of "which circuit is
the next one Tor would use if it got a new stream request."
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-20 09:15:26
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.20-alpha is out (security patches) 
Tor 0.2.2.20-alpha does some code cleanup to reduce the risk of remotely
exploitable bugs. Thanks to Willem Pinckaers for notifying us of the
issue. The Common Vulnerabilities and Exposures project has assigned
CVE-2010-1676 to this issue.
We also fix a variety of other significant bugs, change the IP address
for one of our directory authorities, and update the minimum version
that Tor relays must run to join the network.
All Tor users should upgrade.
Changes in version 0.2.2.20-alpha - 2010-12-17
  o Major bugfixes:
    - Fix a remotely exploitable bug that could be used to crash instances
      of Tor remotely by overflowing on the heap. Remote-code execution
      hasn't been confirmed, but can't be ruled out. Everyone should
      upgrade. Bugfix on the 0.1.1 series and later.
    - Fix a bug that could break accounting on 64-bit systems with large
      time_t values, making them hibernate for impossibly long intervals.
      Fixes bug 2146. Bugfix on 0.0.9pre6; fix by boboper.
    - Fix a logic error in directory_fetches_from_authorities() that
      would cause all _non_-exits refusing single-hop-like circuits
      to fetch from authorities, when we wanted to have _exits_ fetch
      from authorities. Fixes more of 2097. Bugfix on 0.2.2.16-alpha;
      fix by boboper.
    - Fix a stream fairness bug that would cause newer streams on a given
      circuit to get preference when reading bytes from the origin or
      destination. Fixes bug 2210. Fix by Mashael AlSabah. This bug was
      introduced before the first Tor release, in svn revision r152.
  o Directory authority changes:
    - Change IP address and ports for gabelmoo (v3 directory authority).
  o Minor bugfixes:
    - Avoid crashes when AccountingMax is set on clients. Fixes bug 2235.
      Bugfix on 0.2.2.18-alpha. Diagnosed by boboper.
    - Fix an off-by-one error in calculating some controller command
      argument lengths. Fortunately, this mistake is harmless since
      the controller code does redundant NUL termination too. Found by
      boboper. Bugfix on 0.1.1.1-alpha.
    - Do not dereference NULL if a bridge fails to build its
      extra-info descriptor. Found by an anonymous commenter on
      Trac. Bugfix on 0.2.2.19-alpha.
  o Minor features:
    - Update to the December 1 2010 Maxmind GeoLite Country database.
    - Directory authorities now reject relays running any versions of
      Tor between 0.2.1.3-alpha and 0.2.1.18 inclusive; they have
      known bugs that keep RELAY_EARLY cells from working on rendezvous
      circuits. Followup to fix for bug 2081.
    - Directory authorities now reject relays running any version of Tor
      older than 0.2.0.26-rc. That version is the earliest that fetches
      current directory information correctly. Fixes bug 2156.
    - Report only the top 10 ports in exit-port stats in order not to
      exceed the maximum extra-info descriptor length of 50 KB. Implements
      task 2196.

@_date: 2010-12-27 22:28:33
@_author: Roger Dingledine 
@_subject: Why NOT send UDP over tor? 
Another short answer, from 2005, is
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-27 22:33:56
@_author: Roger Dingledine 
@_subject: Why NOT send UDP over tor? 
Assuming 1) you give better performance to relays, and 2) the list of
relays remains public (or at least substantially knowable), and 3) it's
possible to tell whether a given user is getting better performance for
her circuit, then you severely reduce the user's anonymity, especially
if her actions are linkable to each other over time.
The latest paper in this research direction is Braids:
which still has plenty more open questions to work on before we can
understand the anonymity implications of its design.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-28 23:29:09
@_author: Roger Dingledine 
@_subject: 27C3 on Tor 
See also point 3 at
It's been sitting on our "this is important to learn more about"
research list for years.
It's also listed in the talk I did at 25c3:
 (slide 30)
So I'm glad to see more attention to the attack, but a bit frustrated that
we (the research community) are not farther along at understanding it.
Two other things to note:
The website fingerprinting attack works against other anonymity systems
too, in most cases even more straightforwardly than against Tor. We've
got 8+ years in the literature of applying it to other systems (most
thoroughly just attacking SSL streams to learn what web page is being
fetched despite the encryption), and in the past few years people have
improved the attack to get it to work against Tor also. As I understand
it, even now it only works consistently when they assume laboratory
conditions. That isn't to say that it won't work in real-world conditions

@_date: 2010-12-28 23:45:00
@_author: Roger Dingledine 
@_subject: 27C3 on Tor 
Based on
I'm guessing they're basing the talk on their CCSW 2009 paper:
I was a reviewer on that paper. But alas I was in Hong Kong doing a Tor
training so I couldn't attend their presentation last November. It's the
best paper there is on the topic currently, but I feel that the attack
could become much much stronger against Tor than it was in the paper --
that paper's focus on size and frequency of IP packets was what made me
write on the Tor research page:
"The problem with all the previous attack papers is that they look at
timing and counting of IP packets on the wire. But OpenSSL's TLS records,
plus Tor's use of TCP pushback to do rate limiting, means that tracing by
IP packets produces very poor results. The right approach is to realize
that Tor uses OpenSSL, look inside the TLS record at the TLS headers,
and figure out how many 512-byte cells are being sent or received."
As a final note, on my reading list (which alas is growing rather than
shrinking) is
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-29 00:38:09
@_author: Roger Dingledine 
@_subject: Tor & Email? 
The only recommended way to use email with Tor is to use web mail,
e.g. https connections to gmail.
Periodically people ask about using Thunderbird or the like. The problem
is that client-side applications that compose and deliver email could
leave identifying features in the mail headers they generate, or in the
application-level data while interacting with remote mail servers. Nobody
has investigated what would be needed to write a Torbutton equivalent
for Thunderbird.
To answer what might be your more immediate question, you may be
confused about Tor when you say "when someone is connected to the Tor
network". Only applications that have been specifically configured
to use Tor will send their traffic over Tor. See point 'a' at
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-29 05:42:52
@_author: Roger Dingledine 
@_subject: Tor & Email? 
It's still in the plans, but we don't have anybody to work on it
currently, so don't hold your breath.
Perhaps some nice person here will volunteer? The challenge is that it
takes a special kind of person to be thorough enough to look at all the
ways that Thunderbird can screw up.
See  for a good start on the
web end of things. But Mike Perry is constantly several Firefox versions
behind, even then. So I am not particularly optimistic about providing
good support for another Mozilla product too. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-04 13:41:53
@_author: Roger Dingledine 
@_subject: Stuck at 85% 
You have configured your Tor client to use one bridge, and you can't
reach that bridge.
(I can't reach it either -- it seems to be down.)
So either find a bridge that works (is up and reachable for you), or
stop using bridges and then you'll have more options for where to connect
(should work everywhere but in China).
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-04 13:48:25
@_author: Roger Dingledine 
@_subject: [notice] Circuit build measurement period of 218915ms is more 
Tor clients build circuits when they first start up, to estimate the
average amount of time it takes to build a circuit. Once they have a good
estimate, they abandon the slowest 20% of the circuits they make, since
a circuit that takes a long time to build will probably be no fun to use.
Your circuit build times appear to be really crummy. Your Tor has
estimated that the 80% mark for you is 219 seconds. But in fact, the
slowest circuit you've actually created took only 152 seconds. I believe
this situation can occur when many of the circuits your Tor tries to
make fail to get created at all.
Are you rate limiting your exit node? Perhaps you should start. It seems
like your network is really overloaded.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-04 16:23:27
@_author: Roger Dingledine 
@_subject: Stuck at 85% 
What sort of firewall are you behind?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-05 11:59:09
@_author: Roger Dingledine 
@_subject: [notice] Circuit build measurement period of 218915ms is more 
RelayBandwidthRate 200 KBytes
RelayBandwidthBurst 400 KBytes
instead, and see if that makes things better on your side.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-07 18:06:21
@_author: Roger Dingledine 
@_subject: Chrome and Safari IP leak 
Let me be even broader: if you want to be safe, you must never use Tor
with any browser except Firefox, and you must also use Torbutton. If
you don't do both, you can lose from a wide variety of application-level
See also
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-07 18:24:08
@_author: Roger Dingledine 
@_subject: Chrome and Safari IP leak 
Sorry, I've been talking to too many ordinary users lately. :)
I don't know of any problems with lynx. I think you'll still want to
think about topics like cookies and whether your http headers make you
recognizable. Take a look through
for more topics to think about. Web browsers like 'wget' should also be
pretty safe in general. But somebody needs to analyze them in more detail.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-11 18:58:20
@_author: Roger Dingledine 
@_subject: TOR Blocked at Universities 
Or more generally, just block *:80?
It's not the best answer I could hope for, but it's sure better than
not being an exit relay at all.
A more general approach would be to get a DMZ address, meaning somewhere
in your university address space that hasn't been whitelisted by the
libraries. That concept might not exist at your university though --
yet :).
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-15 13:54:53
@_author: Roger Dingledine 
@_subject: Fixed Size Cell 
Mauricio's answer is "fixed size cells helps against traffic analysis
because your data is indistinguishable from anyone's else data."
More generally, we use fixed-size cells because we haven't given up on
the hope that somebody will hand us a cool trick that makes end-to-end
correlation attacks meaningfully slower. Right now we assume they're
instantaneous in all circumstances, but maybe that won't be true forever.
(For more background on end-to-end correlation, see this blog post:
 )
We could probably switch to variable-sized cells (we even have them in
the spec and use them in a few cases). It's looking less likely that
somebody will figure out how to secure low-latency anonymity systems
against end-to-end correlation. But I haven't totally given up hope. :)
Also, it looks like Tor's cell chunking assists us to some extent against
website fingerprinting attacks:
So it may be useful to keep it even if we don't expect defense against
end-to-end correlation. Or maybe the latest website fingerprinting
attacks could become much better if they take into account more of Tor's
architecture during the attack. Hard to say.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-15 15:41:55
@_author: Roger Dingledine 
@_subject: getinfo circuit-status 
Not currently. I've thought periodically of adding a getinfo line to tell
you that. It would be of the form "if a connection were to show up to
address x and port y, which circuit would it use?" The primary use is for
controllers that want to tell you which country you'll be exiting from,
without actually making a test request (once they make the test request,
they alter what will actually happen with the real request).
This task would be a good one for somebody who wants to jump into Tor's
source code and get some more experience, e.g. for to stand out as a
good candidate for Tor's upcoming summer of code projects.
To get started, check out circuit_get_best() in src/or/circuituse.c. You'd
want to make a dummy stream and send that in to the function.
It still wouldn't be perfect, though, because there are other checks
in connection_ap_handshake_rewrite_and_attach() that call, e.g.,
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-15 15:43:27
@_author: Roger Dingledine 
@_subject: getinfo circuit-status 
As Nick points out, there's an easy way to do it after the fact. My
longer mail is talking about predicting which circuit will be used by
a hypothetical stream without actually making any connections through Tor.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-02 15:24:56
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.8-alpha is out 
Tor 0.2.2.8-alpha fixes a crash bug in 0.2.2.7-alpha that has been causing
bridge relays to disappear. If you're running a bridge, please upgrade.
(There aren't any Windows packages yet though. No idea when they'll
be ready. We've decided to start announcing development releases not
long after they're tagged, rather than waiting for all the packages to
be ready.)
Changes in version 0.2.2.8-alpha - 2010-01-26
  o Major bugfixes:
    - Fix a memory corruption bug on bridges that occurred during the
      inclusion of stats data in extra-info descriptors. Also fix the
      interface for geoip_get_bridge_stats* to prevent similar bugs in
      the future. Diagnosis by Tas, patch by Karsten and Sebastian.
      Fixes bug 1208; bugfix on 0.2.2.7-alpha.
  o Minor bugfixes:
    - Ignore OutboundBindAddress when connecting to localhost.
      Connections to localhost need to come _from_ localhost, or else
      local servers (like DNS and outgoing HTTP/SOCKS proxies) will often
      refuse to listen.

@_date: 2010-02-16 16:56:32
@_author: Roger Dingledine 
@_subject: bridge relay: GeoIPFile config option 
Tor actually understands several variants of geoip db format -- but all
ascii, none binary.
It's derived from
which is slowly rotting, and we need to find a better geoip db. The free
maxmind one is intentionally crippled, which makes me not so optimistic
about its future.
More generally, we have three or four geoip db's, and no ground truth, so
it's hard to know which ones are "better". Worse, they're all oriented for
commercial use, which means they all suck when it comes to tiny countries
where the citizens are unlikely to buy your televisions. For our bridge
user counts, those tend to be the countries we're most interested in.
So if anybody wants to pick up the torch and figure out how to maintain
a good free geoip db that specializes in getting the answers right for
places like Syria, please do.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-16 17:25:44
@_author: Roger Dingledine 
@_subject: bridge relay: GeoIPFile config option 
Really? I am under the impression that they have four databases: 1)
crippled (gpl) country db, 2) non-crippled (commercial) country db, 3)
crippled city db, 4) non-crippled city db.
We would use  and I'm not sure how that compares in accuracy to I believe both  and  are bad at telling you whether an IP address is
located in, say, Tunisia -- after all, Maxmind's customers generally get
no revenue from Tunisia so they don't care whether it's accurate there.
And it's an open question whether  is any better than  at answering
questions about Tunisia.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-17 00:40:32
@_author: Roger Dingledine 
@_subject: Problem with Tor 0.2.1.23....not managed to confirm that its 
I just heard from somebody on irc with this problem too, so I opened
a flyspray entry for it:
Hopefully our debian maintainer will get it sorted out in the next
few days.
In other news, the upcoming 0.2.1.23 release doesn't actually work on
OS X either, since Apple's recent security update crippled their openssl
in a particularly intricate way. We've got a fix we're testing.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-17 17:30:01
@_author: Roger Dingledine 
@_subject: Problem with Tor 0.2.1.23....not managed to confirm that its 
Yes, the new deb should take care of it for now.
The bug was that Tor detects openssl's version by asking openssl what
version it is, and turns on various openssl features (such as re-enabling
tls renegotiation) based on the version. But when Debian backports
features (or backports the removal of features) to its openssl lib, it
never changes the openssl version. In summary, we were foolish enough
to believe that Debian's openssl would not lie to us. Lesson learned. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-02-18 01:15:43
@_author: Roger Dingledine 
@_subject: freenode irc, tor, and sasl 
It looks like the freenode irc channel is trying a new approach for
handling its Tor users. (This is great, since for a long time it looked
like they were planning to just let Tor users slowly starve to death.)
Has anybody played with it? What did you think?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-14 17:08:12
@_author: Roger Dingledine 
@_subject: something wrong? 
Hardware upgrade that took longer than expected. We've taken a lot of
services off this machine and are setting them up elsewhere (git, svn,
etc), but majordomo and the lists remain.
Things should be settling back down now. Sorry for the disturbance.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-15 16:14:41
@_author: Roger Dingledine 
@_subject: BridgeRelay 1, tor does nothing 
You need to set an ORPort too, or your bridge won't listen for connections.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-15 17:06:51
@_author: Roger Dingledine 
@_subject: QoS and Tor on Ubuntu 9.10 
You're in luck!
See item  at
for a pointer to Mike's "Linux-based QoS script".
Alas, our new https interface for git is still under construction,
so in the mean time, an easy place to find the script is
contrib/linux-tor-prio.sh in your Tor tarball.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-17 21:36:23
@_author: Roger Dingledine 
@_subject: Memory usage on relays 
Nick wrote an OpenSSL patch to not waste so much memory in its internal
buffers. See item  on
I ran a super-fast Tor relay recently that held 15000 TLS connections
open. That's 550MB of ram wasted inside openssl.
That said, I don't know what the current state of the patch is, or where
you can get a copy. Nick?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-20 15:06:43
@_author: Roger Dingledine 
@_subject: Latest OS X update breaks Tor 
Hi folks,
It looks like the latest OS X update removes a feature from the system
OpenSSL library, and Tor needs this feature to operate.
So if you're on OS X, you should expect that your Tor will stop working
when you do the system update. :(
We're aiming to have a fixed bundle (that statically links openssl) out
in the next week or so.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-20 15:14:16
@_author: Roger Dingledine 
@_subject: tor experimental??? 
Your url is quite old. Since then, we've A) moved to deb.torproject.org,
and B) renamed the experimental branch to "experimental", so you don't
need to name a branch.
What happened in your case is that 0.2.1.x is the new stable.
You might like  or
Hope that helps,
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-20 16:43:44
@_author: Roger Dingledine 
@_subject: Tor Project infrastructure updates in response to security breach 
You should upgrade to Tor 0.2.1.22 or 0.2.2.7-alpha:
In early January we discovered that two of the seven directory
authorities were compromised (moria1 and gabelmoo), along with
metrics.torproject.org, a new server we'd recently set up to serve
metrics data and graphs. The three servers have since been reinstalled
with service migrated to other servers.
We made fresh identity keys for the two directory authorities, which is
why you need to upgrade.
Moria also hosted our git repository and svn repository. We took the
services offline as soon as we learned of the breach. It appears the
attackers didn't realize what they broke into -- just that they had
found some servers with lots of bandwidth. The attackers set up some ssh
keys and proceeded to use the three servers for launching other attacks.
We've done some preliminary comparisons, and it looks like git and svn
were not touched in any way.
We've been very lucky the past few years regarding security. It still
seems this breach is unrelated to Tor itself. To be clear, it doesn't
seem that anyone specifically attacked our servers to get at Tor. It
seems we were attacked for the cpu capacity and bandwidth of the servers,
and the servers just happened to also carry out functions for Tor.
We've tried to address the most common questions below.
* Does this mean someone could have matched users up to their
No. By design, Tor requires a majority of directory authorities (four
in this case) to generate a consensus; and like other relays in the
Tor network, directory authorities don't know enough to match a user
and traffic or destination.
* Does this mean somebody could have changed the Tor source?
No, we've checked the source. It does mean you should upgrade so your
client knows about all the currently valid directory authorities.
* Does this mean someone could have learned more about Tor than an
ordinary user?
Since our software and specifications are open, everyone already has
access to almost everything on these machines... except some old bridge
descriptors, which we give out only in small batches as entry points for
blocked clients.
* Can I trust Tor's security?
We've taken steps to fix the weaknesses identified and to harden our
systems further. Tor has a track record of openness and transparency,
with its source code and specifications and also with its operations.
Moreover, we're disclosing breaches such as this so you can monitor our
status. You shouldn't assume those who don't disclose security breaches
never have any!

@_date: 2010-01-20 17:03:29
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.7-alpha is out 
Tor 0.2.2.7-alpha fixes a huge client-side performance bug, as well
as laying the groundwork for further relay-side performance fixes. It
also starts cleaning up client behavior with respect to the EntryNodes,
ExitNodes, and StrictNodes config options.
This release also rotates two directory authority keys, due to a security
breach of some of the Torproject servers:
Everybody should upgrade:
Changes in version 0.2.2.7-alpha - 2010-01-19
  o Directory authority changes:
    - Rotate keys (both v3 identity and relay identity) for moria1
      and gabelmoo.
  o Major features (performance):
    - We were selecting our guards uniformly at random, and then weighting
      which of our guards we'd use uniformly at random. This imbalance
      meant that Tor clients were severely limited on throughput (and
      probably latency too) by the first hop in their circuit. Now we
      select guards weighted by currently advertised bandwidth. We also
      automatically discard guards picked using the old algorithm. Fixes
      bug 1217; bugfix on 0.2.1.3-alpha. Found by Mike Perry.
    - When choosing which cells to relay first, relays can now favor
      circuits that have been quiet recently, to provide lower latency
      for low-volume circuits. By default, relays enable or disable this
      feature based on a setting in the consensus. You can override
      this default by using the new "CircuitPriorityHalflife" config
      option. Design and code by Ian Goldberg, Can Tang, and Chris
      Alexander.
    - Add separate per-conn write limiting to go with the per-conn read
      limiting. We added a global write limit in Tor 0.1.2.5-alpha,
      but never per-conn write limits.
    - New consensus params "bwconnrate" and "bwconnburst" to let us
      rate-limit client connections as they enter the network. It's
      controlled in the consensus so we can turn it on and off for
      experiments. It's starting out off. Based on proposal 163.
  o Major features (relay selection options):
    - Switch to a StrictNodes config option, rather than the previous
      "StrictEntryNodes" / "StrictExitNodes" separation that was missing a
      "StrictExcludeNodes" option.
    - If EntryNodes, ExitNodes, ExcludeNodes, or ExcludeExitNodes
      change during a config reload, mark and discard all our origin
      circuits. This fix should address edge cases where we change the
      config options and but then choose a circuit that we created before
      the change.
    - If EntryNodes or ExitNodes are set, be more willing to use an
      unsuitable (e.g. slow or unstable) circuit. The user asked for it,
      they get it.
    - Make EntryNodes config option much more aggressive even when
      StrictNodes is not set. Before it would prepend your requested
      entrynodes to your list of guard nodes, but feel free to use others
      after that. Now it chooses only from your EntryNodes if any of
      those are available, and only falls back to others if a) they're
      all down and b) StrictNodes is not set.
    - Now we refresh your entry guards from EntryNodes at each consensus
      fetch -- rather than just at startup and then they slowly rot as
      the network changes.
  o Major bugfixes:
    - Stop bridge directory authorities from answering dbg-stability.txt
      directory queries, which would let people fetch a list of all
      bridge identities they track. Bugfix on 0.2.1.6-alpha.
  o Minor features:
    - Log a notice when we get a new control connection. Now it's easier
      for security-conscious users to recognize when a local application
      is knocking on their controller door. Suggested by bug 1196.
    - New config option "CircuitStreamTimeout" to override our internal
      timeout schedule for how many seconds until we detach a stream from
      a circuit and try a new circuit. If your network is particularly
      slow, you might want to set this to a number like 60.
    - New controller command "getinfo config-text". It returns the
      contents that Tor would write if you send it a SAVECONF command,
      so the controller can write the file to disk itself.
    - New options for SafeLogging to allow scrubbing only log messages
      generated while acting as a relay.
    - Ship the bridges spec file in the tarball too.
    - Avoid a mad rush at the beginning of each month when each client
      rotates half of its guards. Instead we spread the rotation out
      throughout the month, but we still avoid leaving a precise timestamp
      in the state file about when we first picked the guard. Improves
      over the behavior introduced in 0.1.2.17.
  o Minor bugfixes (compiling):
    - Fix compilation on OS X 10.3, which has a stub mlockall() but
      hides it. Bugfix on 0.2.2.6-alpha.
    - Fix compilation on Solaris by removing support for the
      DisableAllSwap config option. Solaris doesn't have an rlimit for
      mlockall, so we cannot use it safely. Fixes bug 1198; bugfix on
      0.2.2.6-alpha.
  o Minor bugfixes (crashes):
    - Do not segfault when writing buffer stats when we haven't observed
      a single circuit to report about. Found by Fabian Lanze. Bugfix on
      0.2.2.1-alpha.
    - If we're in the pathological case where there's no exit bandwidth
      but there is non-exit bandwidth, or no guard bandwidth but there
      is non-guard bandwidth, don't crash during path selection. Bugfix
      on 0.2.0.3-alpha.
    - Fix an impossible-to-actually-trigger buffer overflow in relay
      descriptor generation. Bugfix on 0.1.0.15.
  o Minor bugfixes (privacy):
    - Fix an instance where a Tor directory mirror might accidentally
      log the IP address of a misbehaving Tor client. Bugfix on
      0.1.0.1-rc.
    - Don't list Windows capabilities in relay descriptors. We never made
      use of them, and maybe it's a bad idea to publish them. Bugfix
      on 0.1.1.8-alpha.
  o Minor bugfixes (other):
    - Resolve an edge case in path weighting that could make us misweight
      our relay selection. Fixes bug 1203; bugfix on 0.0.8rc1.
    - Fix statistics on client numbers by country as seen by bridges that
      were broken in 0.2.2.1-alpha. Also switch to reporting full 24-hour
      intervals instead of variable 12-to-48-hour intervals.
    - After we free an internal connection structure, overwrite it
      with a different memory value than we use for overwriting a freed
      internal circuit structure. Should help with debugging. Suggested
      by bug 1055.
    - Update our OpenSSL 0.9.8l fix so that it works with OpenSSL 0.9.8m
      too.
  o Removed features:
    - Remove the HSAuthorityRecordStats option that version 0 hidden
      service authorities could have used to track statistics of overall
      hidden service usage.

@_date: 2010-01-20 22:54:03
@_author: Roger Dingledine 
@_subject: Tor Project infrastructure updates in response to security 
Here are some more technical details about the potential impacts, for
those who want to know more about Tor's innards:
-----  Directory authority keys
Owning two out of seven directory authorities isn't enough to make a new
networkstatus consensus (you need four for that), but it means you've
only got two more to go. We've generated new v3 long-term identity keys
for these two authorities.
The old v3 long-term identity keys probably aren't compromised, since
they weren't stored on the affected machines, but they signed v3 signing
keys that are valid until 2010-04-12 in the case of moria1 and until
2010-05-04 in the case of gabelmoo. That's still a pretty big window,
so it's best to upgrade clients away from trusting those keys.
You should upgrade to 0.2.1.22 or 0.2.2.7-alpha, which uses the new v3
long-term identity keys (with a new set of signing keys).
-----  Relay identity keys
We already have a way to cleanly migrate to a new v3 long-term identity
key, because we needed one for the Debian weak RNG bug:
But we don't have a way to cleanly migrate relay identity keys. An
attacker who knows moria1's relay identity key can craft a new descriptor
for it with a new onion key (or even a new IP address), and then
man-in-the-middle traffic coming to the relay. They wouldn't be able to
spoof directory statements, or break the encryption for further relays
in the path, but it still removes one layer of the defense-in-depth.
Normally there's nothing special about the relay identity key (if you
lose yours, just generate another one), but relay identity keys for
directory authorities are hard-coded in the Tor bundle so the client
can detect man-in-the-middle attacks on bootstrapping.
So we abandoned the old relay identity keys too. That means abandoning
the old IP:port the authorities were listening on, or older clients will
produce warn messages whenever they connect to the new authority. Older
Tor clients can now take longer to bootstrap if they try the abandoned
addresses first. (You should upgrade.)
-----  Infrastructure services
Moria also hosted our git repository and svn repository. I took the
services offline as soon as we learned of the breach -- in theory a clever
attacker could give out altered files to people who check out the source,
or even tailor his answers based on who's doing the git update. We're
in pretty good shape for git though: the git tree is a set of hashes
all the way back to the root, so when you update your git tree, it will
automatically notice any tampering.
As explained in the last mail, it appears the attackers didn't realize
what they broke into. We had already been slowly migrating Tor services
off of moria (it runs too many services for too many different projects),
so we took this opportunity to speed up that plan. A friendly anonymous
sponsor has provided a pile of new servers, and git and svn are now up
in their new locations. The only remaining Tor infrastructure services on
moria are the directory authority, the mailing lists, and a DNS secondary.
-----  Bridge descriptors
The metrics server had an archive of bridge descriptors from 2009.
We used the descriptors to create summary graphs of bridge count and
bridge usage by country, like the ones you can see at
So it's conceivable that some bad guy now has a set of historical bridge
data -- meaning he knows addresses and public keys of the bridges, and
presumably some of the bridges are still running at those addresses and/or
with those public keys. He could use this information to help governments
or other censors prevent Tor clients from reaching the Tor network.
I'm not actually so worried about this one though, because a) we didn't
have that many bridges to begin with in 2009 (you should run a bridge!),
b) there seems to be considerable churn in our bridges, so last year's
list doesn't map so well to this year's list), and c) we haven't been
doing a great job lately at keeping China from learning bridges as it is.
Hope that helps to explain,
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-21 00:14:32
@_author: Roger Dingledine 
@_subject: Tor Project infrastructure updates in response to security 
Yes, depending on how paranoid you want to get.
I don't think they could have done anything particularly devious with
the directory authority. We've got that pretty well sorted out with the
distributed trust thing -- nothing moria1 does can rig the consensus
by itself.
So it's really a question of the services running.
Moria was running a nameserver for torproject.org (still is), so they
could send web requests elsewhere. If people check SSL certs, no problem
(modulo the usual points about SSL not being perfect); if they don't
check SSL certs, we hope they check package signatures. This risk isn't
specific to our machines though -- your local ISP can lie to you about
your DNS resolves, or some jerk could redirect our bgp record like how
Pakistan stole Youtube for a few hours last year.
It was also the mail host for  though most of the mails
went off to other mail servers after that. So they could have read my
mail. Most of my mail is public (and/or boring) anyway though.
I could imagine that they might try to sneak in a commit to the git
repository. We have a hook that mails all commits to the mailing list,
and we watch that pretty well. But they could disable the hook during
their commit. As I mentioned in the earlier mail, the git tree is made up
of hashes, so they can't just modify it outright. I've looked over the
'git log' output, and didn't find anything odd. It might be neat to do
an automated comparison of "mails that made it to the mailing list" vs
"commits to the git repository", if we wanted another layer of checking.
Svn is less secure. It's just a database, and people can muck with it how
they like. We've compared several of the svn repositories to backups, and
nothing looked out of the ordinary. Good thing we moved Tor, Torbutton,
BridgeDB, etc to git last year. The website wml files are still in svn
and not git though, to make it easier for our volunteer translators;
give us a holler if you find "Tor sucks" scribbled in some corner. :)
If you want to scale up on the paranoid meter, you could imagine ssh
client buffer overflows for the developers when we connected to it. That
rabbit-hole goes as far as you like.
Speaking of rabbit-holes, my gpg key is nearly a decade old and only
1024 bits. Sometime in the next little while I'm going to switch to a
bigger one.
As I understand it, we have a 450G disk image from one of the machines
sitting somewhere in Canada, but not anywhere near any of the Tor people.
The attacker(s) were sloppy, so we know some things like the name of the
local-to-root exploit they used (which by its name works on a surprisingly
wide spread of kernel versions... security is hard). I still don't know
how they got in to moria originally, though. Too much was going on on
that machine.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-21 00:32:42
@_author: Roger Dingledine 
@_subject: Tor Project infrastructure updates in response to security 
We do sign the git repository for each release (stable and development).
Do a git clone of Tor, and then 'git tag -l'.
Saying the git hash of the release in the release notes is not a crazy
notion though.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-21 14:10:48
@_author: Roger Dingledine 
@_subject: exit and guard flag 
Hi Olaf,
Mike Perry recently found two further reasons why this is the case.
The first (known) reason is that once you get the Guard flag, clients
assume you're not useful for the middle hop anymore, since now you
presumably have a lot of clients using you for the first hop. Once you've
had the Guard flag for a while, that's a reasonable assumption -- but
on day one, pretty much nobody has chosen you as their guard yet.
New reason  is that clients were picking guards without weighting
by bandwidth:
So fast guards would get just the same amount of attention as slow
guards. Tor 0.2.2.7-alpha resolves this, and 0.2.1.23 (whenever we put
it out) will too. So the load balancing here should slowly correct itself
over time.
New reason  is that in the special case where you have both the Guard
flag *and* the Exit flag, we aren't giving you as much attention as we
should have. See Mike Perry's recent or-dev post with details:
There's a third reason lurking, which is that the directory authorities
seem to be making really bad decisions about which relays ought to get
the Guard flag. That one is still unsolved though. It looks like the
uptime and stability tracking is broken somehow.
This time for sure! :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-21 14:38:16
@_author: Roger Dingledine 
@_subject: Dir server's rendezvous-service-descriptor's 
A) No, the hidden service descriptors aren't archived anywhere, or
published anywhere, or even written to disk anywhere.
B) Which six servers are you talking about? v2 hidden service descriptors
are stored DHT-style on any relays with the HSDir flag:
Right now I count 581 of those relays in the consensus.
(v0 hidden service descriptors are stored just on the original three v1
directory authorities, two of which are gone so it's mostly moot.)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-04 22:45:12
@_author: Roger Dingledine 
@_subject: git.torproject.org? 
Yep, it's down for now. We're setting up a new host that will serve just
git. The machine it's on right now provides too many services, and it
looks like it may have had some potential security issues recently. While
we investigate them, it seems smartest to leave some services down until
we've moved them to a more robust location.
It will hopefully be back up in a few days.
Or for those that can't wait, you might like To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-05 01:02:33
@_author: Roger Dingledine 
@_subject: how much to use big relays (was Re: bloxortsipt) 
I think it's best to offer as much bandwidth as you want to offer, and
then let the directory authorities decide how much weight you should get.
For example, the bwauthority scripts currently compute how much weight
the directory authority suggests that we give to each relay:
and they cap the vote they produce for any relay to 5% of the total
weights they're voting on. So while blutmagie varies between 1% and 5%
of the total network, it won't (I think) go higher than that.
The big challenge here is to find the right balance between security (not
too much centralization) and performance (making use of the bandwidth
that relays offer). One theory is "make sure to provide really good
decentralization, and one day when we have more relays it'll actually be
usable", whereas the other theory is "use what you've got as best you
can, and one day when we have more relays it'll be even safer". The 5%
heuristic tries to pick the right balance between the two. I'm more
willing to tend toward the second one now that we have active bw
measurement rather than passive "believe what the relay tells you"
For what it's worth, the numbers you see here aren't the numbers that
client use when weighting their path selection. You can see the weights
they use in your ~/.tor/cached-consensus file. It would be great if
somebody wants to patch the torstatus so it can reflect that.
More generally, here's a torstatus wishlist I wrote up a while ago:
  - Torstatus's relay listings should look in extrainfo descriptors and
    figure out the average actual bandwidth used by the relay. (Add up
    all the read and write histories, and divide by the number of seconds
    in the intervals.) That's the main bandwidth number it should show
    when ranking and sorting the relays. Maybe for completeness, we could
    add another column which just shows a number for the bandwidth the              relay is advertising.
  - Be sure to grab the advertised bandwidth from the consensus (the "w"
    line), not from the descriptor. Clients use the one in the consensus
    as of Tor 0.2.1.18.
  - I think torstatus still uses its own "tor check" variant. We should
    make it use the tordnsel instead (e.g. via fetching the list of
    current IP addresses from the bulk exitlist at
        and comparing locally).
Volunteers happily encouraged. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-05 20:02:43
@_author: Roger Dingledine 
@_subject: Quick question on Torbutton and NoScript 
Right. As I understand it, Noscript is toggling the "allow javascript
or not" option inside Firefox, whereas Torbutton is actually rewriting
parts of the javascript parser inside Firefox. So the two are compatible
at that level: *if* javascript happens to be enabled, either via Firefox
config or via Noscript config, then the javascript you get will be the
javascript that Torbutton has modified.
The original reason why Noscript was discouraged was because if you're
using Tor but not using SSL (for example, you're using http:// addresses),
then the address you see in your toolbar may or may not be the server
you're talking to. Specifically, your exit relay can send you whatever
it likes; so if the exit relay can guess any domain that you've
whitelisted in Noscript, then it can embed an iframe or other link to
that domain, and trick you into running javascript anyway.
So if you really do need Noscript to get it right (i.e. allow some
domains, disallow others), then it can't.
Of course, this problem is present in internet cafes, hotels, conferences,
and plenty of other contexts. And as long as you're using Noscript's
feature as defense-in-depth, rather than relying on it for always-correct
behavior, then it's fine to use both Noscript and Torbutton. I do.
But to be clear, I use Noscript as a tool to change how my browser
renders the page, and to avoid telling Google analytics about every
page I go to. Lately I've been using RequestPolicy as well for the same
results. If I were worried that Javascript will do bad things to me, then
I would disable it, because Noscript won't protect me. Marco talked about
"the ability of noscript to restrict the active contents from https only"

@_date: 2010-01-06 03:44:32
@_author: Roger Dingledine 
@_subject: Speaking of cryptography 
I assume you're talking about
You should also read
No idea. Somebody clueful in crypto would have to figure that one out,
and then convince somebody that's both clueful in crypto and well-known
in the Tor community to believe it.
Writing it up as a research paper and getting it published would be the
best approach. Writing it up as a Tor proposal and including a thorough
security/performance/transition analysis might work too. Identifying
further problems in the current approach would encourage us to switch
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-06 06:36:35
@_author: Roger Dingledine 
@_subject: A question 
The second one. The bridge caches all the directory info, and provides
it when you ask.
Your Tor can check to make sure the bridge is not giving
you the wrong info, because the networkstatus consensus
you get is signed by the directory authorities. See also
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-06 06:59:15
@_author: Roger Dingledine 
@_subject: signal newnym and rate limiting 
Actually, Tor is deliberately slow if you make newnym requests too close
together. No use spamming the network with new circuits all the time.
If you want to know whether your newnym has taken effect, you could watch
for circuit events and parse them, or watch for log events and parse them.
Hm. SIGHUP should respond quite quickly (well under a second). SIGINT
should log quite quickly, but on relays won't actually take down your
Tor relay for ShutdownWaitLength (typically 30) seconds.
If your log responses are taking minutes to show up, there's something
wrong. In fact, this problem sounds like the same problem you get around
"clock jumped" events. Is your libevent not waking up correctly each
second? What version of libevent are you using?
You could learn more by instrumenting the beginning of
second_elapsed_callback() in src/or/main.c to log when it starts:
  log_fn(LOG_NOTICE, "Tick.");
and instrumenting the bottom of that function with:
  log_fn(LOG_NOTICE, "End tick.");
"Tick" should show up slightly more than once per second -- not exactly
once per second due to bug 943:
and "End tick" should show up quite soon (generally much less than a
second) after "Tick".
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-08 15:52:55
@_author: Roger Dingledine 
@_subject: TLS renegotiating error persists on FreeBSD 8.0 updated. 
Yep. See also
I don't want to cripple Tor's handshake on the relay side, since that
would prevent people in censoring countries from doing the version of
the TLS handshake that blends in better.
Eventually we're going to do a smoother version of the handshake
that doesn't require TLS renegotiation -- basically we'll do it by
reimplementing what we need from the TLS protocol inside Tor at the cell
level. But that could be half a year from now at least, and it's going
to be a mess to get right.
In the meantime, I guess we're at a standoff.
"What the fuck, freebsd? Why did you break a system library?"
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-07-27 10:56:42
@_author: Roger Dingledine 
@_subject: Tor and DNS. 
Yep, you should be all set.
I did a Tor demo in Bolivia several years ago, showing "now we get Google
Deutsch, now it's Google in Japan", and people came up to me afterward
asking "how did you get the Internet to work?" Turns out the local DNS
at the conference was broken, and I hadn't even noticed. Tor as a client
pretty much completely ignores your local DNS.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-07-12 15:28:25
@_author: Roger Dingledine 
@_subject: Official torproject .onions 
lists some hidden services,
some of which are quite official, like the hidden service that points
to archive.torproject.org.
The Tor Project itself mainly writes software and does advocacy, rather
than running Tor directory authorities, hidden services, or even relays.
That said, there are individuals who maintain hidden services and who
are also Tor developers. The line is pretty fuzzy in some cases.
Why do you ask?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-07-13 15:51:29
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.14-alpha is out 
Tor 0.2.2.14-alpha greatly improves client-side handling of circuit build
timeouts, which are used to estimate speed and improve performance. We
also move to a much better GeoIP database, port Tor to Windows CE,
introduce new compile flags that improve code security, add an eighth
v3 directory authority, and address a lot of more minor issues.
Packages will be appearing over the next few days or weeks. (We've decided
to start announcing alpha versions when they're released, rather than
waiting for all the packages first.)
Changes in version 0.2.2.14-alpha - 2010-07-12
  o Major bugfixes:
    - Tor directory authorities no longer crash when started with a
      cached-microdesc-consensus file in their data directory. Bugfix
      on 0.2.2.6-alpha; fixes bug 1532.
    - Treat an unset $HOME like an empty $HOME rather than triggering an
      assert. Bugfix on 0.0.8pre1; fixes bug 1522.
    - Ignore negative and large circuit build timeout values that can
      happen during a suspend or hibernate. These values caused various
      asserts to fire. Bugfix on 0.2.2.2-alpha; fixes bug 1245.
    - Alter calculation of Pareto distribution parameter 'Xm' for
      Circuit Build Timeout learning to use the weighted average of the
      top N=3 modes (because we have three entry guards). Considering
      multiple modes should improve the timeout calculation in some cases,
      and prevent extremely high timeout values. Bugfix on 0.2.2.2-alpha;
      fixes bug 1335.
    - Alter calculation of Pareto distribution parameter 'Alpha' to use a
      right censored distribution model. This approach improves over the
      synthetic timeout generation approach that was producing insanely
      high timeout values. Now we calculate build timeouts using truncated
      times. Bugfix on 0.2.2.2-alpha; fixes bugs 1245 and 1335.
    - Do not close circuits that are under construction when they reach
      the circuit build timeout. Instead, leave them building (but do not
      use them) for up until the time corresponding to the 95th percentile
      on the Pareto CDF or 60 seconds, whichever is greater. This is done
      to provide better data for the new Pareto model. This percentile
      can be controlled by the consensus.
  o Major features:
    - Move to the June 2010 Maxmind GeoLite country db (rather than the
      June 2009 ip-to-country GeoIP db) for our statistics that count
      how many users relays are seeing from each country. Now we have
      more accurate data for many African countries.
    - Port Tor to build and run correctly on Windows CE systems, using
      the wcecompat library. Contributed by Valerio Lupi.
    - New "--enable-gcc-hardening" ./configure flag (off by default)
      to turn on gcc compile time hardening options. It ensures
      that signed ints have defined behavior (-fwrapv), enables
      -D_FORTIFY_SOURCE=2 (requiring -O2), adds stack smashing protection
      with canaries (-fstack-protector-all), turns on ASLR protection if
      supported by the kernel (-fPIE, -pie), and adds additional security
      related warnings. Verified to work on Mac OS X and Debian Lenny.
    - New "--enable-linker-hardening" ./configure flag (off by default)
      to turn on ELF specific hardening features (relro, now). This does
      not work with Mac OS X or any other non-ELF binary format.
  o New directory authorities:
    - Set up maatuska (run by Linus Nordberg) as the eighth v3 directory
      authority.
  o Minor features:
    - New config option "WarnUnsafeSocks 0" disables the warning that
      occurs whenever Tor receives only an IP address instead of a
      hostname. Setups that do DNS locally over Tor are fine, and we
      shouldn't spam the logs in that case.
    - Convert the HACKING file to asciidoc, and add a few new sections
      to it, explaining how we use Git, how we make changelogs, and
      what should go in a patch.
    - Add a TIMEOUT_RATE keyword to the BUILDTIMEOUT_SET control port
      event, to give information on the current rate of circuit timeouts
      over our stored history.
    - Add ability to disable circuit build time learning via consensus
      parameter and via a LearnCircuitBuildTimeout config option. Also
      automatically disable circuit build time calculation if we are
      either a AuthoritativeDirectory, or if we fail to write our state
      file. Fixes bug 1296.
    - More gracefully handle corrupt state files, removing asserts
      in favor of saving a backup and resetting state.
    - Rename the "log.h" header to "torlog.h" so as to conflict with fewer
      system headers.
  o Minor bugfixes:
    - Build correctly on OSX with zlib 1.2.4 and higher with all warnings
      enabled.
    - When a2x fails, mention that the user could disable manpages instead
      of trying to fix their asciidoc installation.
    - Where available, use Libevent 2.0's periodic timers so that our
      once-per-second cleanup code gets called even more closely to
      once per second than it would otherwise. Fixes bug 943.
    - If you run a bridge that listens on multiple IP addresses, and
      some user configures a bridge address that uses a different IP
      address than your bridge writes in its router descriptor, and the
      user doesn't specify an identity key, their Tor would discard the
      descriptor because "it isn't one of our configured bridges", and
      fail to bootstrap. Now believe the descriptor and bootstrap anyway.
      Bugfix on 0.2.0.3-alpha.
    - If OpenSSL fails to make a duplicate of a private or public key, log
      an error message and try to exit cleanly. May help with debugging
      if bug 1209 ever remanifests.
    - Save a couple bytes in memory allocation every time we escape
      certain characters in a string. Patch from Florian Zumbiehl.
    - Make it explicit that we don't cannibalize one-hop circuits. This
      happens in the wild, but doesn't turn out to be a problem because
      we fortunately don't use those circuits. Many thanks to outofwords
      for the initial analysis and to swissknife who confirmed that
      two-hop circuits are actually created.
    - Make directory mirrors report non-zero dirreq-v[23]-shares again.
      Fixes bug 1564; bugfix on 0.2.2.9-alpha.
    - Eliminate a case where a circuit build time warning was displayed
      after network connectivity resumed. Bugfix on 0.2.2.2-alpha.

@_date: 2010-07-02 18:31:32
@_author: Roger Dingledine 
@_subject: traffic gone? 
A) What's the nickname / IP address? That will help us know how to help
look for it.
B) Have you checked that the ports are actually reachable from the
C) What's making a controller connection every 5 minutes? That seems
unusual. Probably not anything bad, but I don't know what configuration
would do that.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-07-21 09:36:08
@_author: Roger Dingledine 
@_subject: app for each app's tor control? 
Looks like you're trying to use tsocks on os x? It doesn't (easily)
work on os x, even for non-gui apps.
There's a program from Dug Song named dsocks that does, I hear.
I also hear from Robert Hogan that an upcoming not-yet-released version
of torsocks will work on os x.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-28 21:02:57
@_author: Roger Dingledine 
@_subject: New Tor Relay: Help!!!!! 
If your exit policy is 'reject *:*', Tor clients will avoid asking your
Tor relay to resolve things for them.
So it's fine if your dns is broken, in this particular case.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-08 04:48:46
@_author: Roger Dingledine 
@_subject: Server Setup 
There are three torrc options you want to look at:
"Address" is the IP address that your relay publishes to the outside
world. That will be the address that other clients use to reach you,
and it will also be the address that your Tor relay uses to check its
own reachability.
"OutboundBindAddress" tells your Tor which IP address to bind for
connections that it launches. It's useful for your case where (I think)
you have more than one outgoing route and a different IP address for
each outgoing route.
Optionally, "ORListenAddress" will tell your Tor to only bind to specific
IP addresses for incoming connections. You can do this if you *don't*
want to listen on some of your addresses; but its default of 0.0.0.0
should work fine.
Btw, you don't need to port-forward incoming UDP.
Hope that helps,
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-11 02:12:30
@_author: Roger Dingledine 
@_subject: Network Map showing a major difference in public relays 
Tor relays that haven't seen any client requests lately (and by client
requests I mean requests using that Tor as a client) and don't have
an advertised DirPort will stop fetching descriptors after a while,
to save bandwidth.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-11 02:15:57
@_author: Roger Dingledine 
@_subject: issues with running a Tor relay 
Which Tor status page? There are a bunch and they present status
Depends on the page. My guess is that you're using one of the torstatus
pages running trunk, and they are presenting to you the average number
of bytes your relay has actually pushed. This is a nicer way to rank
relays by bandwidth than just picking some number that they claim.
My second guess is that 122KB is the number published in the consensus for
your relay, meaning that's the median vote by the bandwidth measurement
authorities about how fast your relay actually is in practice. See
proposal 161.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-02 07:14:52
@_author: Roger Dingledine 
@_subject: Node not listed 
Are you running Centos?
You appear to be running Tor 0.2.1.20, which is 6 revisions out of
date. Upgrade, and then see if it's still a problem.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-06-14 18:08:20
@_author: Roger Dingledine 
@_subject: shadowserver.org 
Well, it depends how much of it is actual abuse. If the only people
complaining are the honeypot, that's a good argument that the honeypot
is overbroad in its notion of abuse.
For example, a while ago we got to deal with SORBS's approach to Tor. They
ran some honeypots on port 6667, and any addresses that connected to
those honeypots got onto their spam (port 25) blacklist. They didn't
know or care that Tor relays have exit policies, meaning they can allow
connections to port 6667 while not allowing connections to port 25.
(The result was a stand-off where SORBS declared that it hated anonymity
and wanted to kill the whole idea of Tor... but that's a separate
discussion. :)
More generally, your point is a good one that the Tor network would
do a lot better if it generated less abuse. But from talking to the
exit relay operators, they see very few abuse complaints per kilobyte
handled. Part of the challenge is that people who think anonymity can't
be very popular look at the Tor network, figure it has roughly no users,
see that it generates abuse complaints, and leap to the conclusion that
most Tor users are abusing it. After all, if Tor is succeeding, nobody
notices. And in fact Tor handles hundreds of thousands of users daily.
People reading this thread might also like reading
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-10 23:11:59
@_author: Roger Dingledine 
@_subject: (FWD) [or-cvs] [tor/master] let people test the RefuseUnknownExits 
For those who a) run an exit relay, and b) like running the latest git
master, here's a new feature for you to test out. Let me know if it
breaks, works brilliantly, stays suspiciously silent, etc.
Eventually I plan to turn this feature 'always on', so best to find the
bugs early.
See also
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-12 23:06:10
@_author: Roger Dingledine 
@_subject: All routers are down or won't exit -- choosing a doomed exit 
Sounds like you have some application configured to use localhost:8118 as
an http proxy, and that application is trying to launch lots of requests,
many of which are to ports that Tor's default exit policy doesn't allow.
In the past, people with this problem have found that they have a
bittorrent client configured to use Tor that they forgot about.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-03 00:22:41
@_author: Roger Dingledine 
@_subject: Tor documentation 
You might like to peruse the ChangeLog file:
It seems this "onion forum" thing is full of misinformation, conspiracy
theories, and uninformed people. What a deal. :)
Of course, just because I give you a changelog file doesn't mean it's
suddenly trustworthy.  should
let you walk through all the commits.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-04 00:26:11
@_author: Roger Dingledine 
@_subject: hidden service with jabber and ssl 
The general notion that people are pushing is that since Privoxy keeps
you safe, and Privoxy can't look inside SSL, then it can't keep you safe
when you're using SSL.
The problem with that logic is that Privoxy isn't what should keep you
safe. Your Firefox (plus extensions) is what should do it. Torbutton
does most of the steps that you might want. Adblock will remove some ads.
Etc. Doing the keeping-you-safe at the proxy is just the wrong place to
do it.
Which makes the faq entry:
not very accurate or useful.
Anybody want to rewrite it to be more crisp and more accurate? :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-04 00:37:36
@_author: Roger Dingledine 
@_subject: Memory usage on relays 
I've updated the FAQ entry to reflect this tip along with others:
Let me know if anybody runs across more good suggestions. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-07 02:53:46
@_author: Roger Dingledine 
@_subject: What causes this error? 
There are some known false positives for this warning message if your
Tor is both a relay and also offers a hidden service.
If your Tor is seeing use from clients, and it's listed in the
networkstatus consensus, I wouldn't worry about that message.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-03-08 23:58:00
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.9-alpha and 0.2.2.10-alpha are out 
Tor 0.2.2.9-alpha makes Tor work again on the latest OS X, updates the
location of a directory authority, and cleans up a bunch of small bugs.
Tor 0.2.2.10-alpha fixes a regression introduced in 0.2.2.9-alpha that
could prevent relays from guessing their IP address correctly. It also
starts the groundwork for another client-side performance boost, since
currently we're not making efficient use of relays that have both the
Guard flag and the Exit flag.
For those of you that build from the tarball, you'll notice that the
0.2.2.10-alpha tarball has a build dependency on asciidoc. We'll be
fixing that in the next alpha.
Changes in version 0.2.2.10-alpha - 2010-03-07
  o Major bugfixes:
    - Fix a regression from our patch for bug 1244 that caused relays
      to guess their IP address incorrectly if they didn't set Address
      in their torrc and/or their address fails to resolve. Bugfix on
      0.2.2.9-alpha; fixes bug 1269.
  o Major features (performance):
    - Directory authorities now compute consensus weightings that instruct
      clients how to weight relays flagged as Guard, Exit, Guard+Exit,
      and no flag. Clients that use these weightings will distribute
      network load more evenly across these different relay types. The
      weightings are in the consensus so we can change them globally in
      the future. Extra thanks to "outofwords" for finding some nasty
      security bugs in the first implementation of this feature.
  o Minor features (performance):
    - Always perform router selections using weighted relay bandwidth,
      even if we don't need a high capacity circuit at the time. Non-fast
      circuits now only differ from fast ones in that they can use relays
      not marked with the Fast flag. This "feature" could turn out to
      be a horrible bug; we should investigate more before it goes into
      a stable release.
  o Minor features:
    - Allow disabling building of the manpages. Skipping the manpage
      speeds up the build considerably.
  o Minor bugfixes (on 0.2.2.x):
    - Fix a memleak in the EXTENDCIRCUIT logic. Spotted by coverity.
      Bugfix on 0.2.2.9-alpha.
    - Disallow values larger than INT32_MAX for PerConnBWRate|Burst
      config option. Bugfix on 0.2.2.7-alpha.
    - Ship the asciidoc-helper file in the tarball, so that people can
      build from source if they want to, and touching the .1.txt files
      doesn't break the build. Bugfix on 0.2.2.9-alpha.
  o Minor bugfixes (on 0.2.1.x or earlier):
    - Fix a dereference-then-NULL-check sequence when publishing
      descriptors. Bugfix on 0.2.1.5-alpha. Discovered by ekir; fixes
      bug 1255.
    - Fix another dereference-then-NULL-check sequence. Bugfix on
      0.2.1.14-rc. Discovered by ekir; fixes bug 1256.
    - Make sure we treat potentially not NUL-terminated strings correctly.
      Bugfix on 0.1.1.13-alpha. Discovered by rieo; fixes bug 1257.
  o Code simplifications and refactoring:
    - Fix some urls in the exit notice file and make it XHTML1.1 strict
      compliant. Based on a patch from Christian Kujau.
    - Don't use sed in asciidoc-helper anymore.
    - Make the build process fail if asciidoc cannot be found and
      building with asciidoc isn't disabled.
Changes in version 0.2.2.9-alpha - 2010-02-22
  o Directory authority changes:
    - Change IP address for dannenberg (v3 directory authority), and
      remove moria2 (obsolete v1, v2 directory authority and v0 hidden
      service directory authority) from the list.
  o Major bugfixes:
    - Make Tor work again on the latest OS X: when deciding whether to
      use strange flags to turn TLS renegotiation on, detect the OpenSSL
      version at run-time, not compile time. We need to do this because
      Apple doesn't update its dev-tools headers when it updates its
      libraries in a security patch.
    - Fix a potential buffer overflow in lookup_last_hid_serv_request()
      that could happen on 32-bit platforms with 64-bit time_t. Also fix
      a memory leak when requesting a hidden service descriptor we've
      requested before. Fixes bug 1242, bugfix on 0.2.0.18-alpha. Found
      by aakova.
    - Authorities could be tricked into giving out the Exit flag to relays
      that didn't allow exiting to any ports. This bug could screw
      with load balancing and stats. Bugfix on 0.1.1.6-alpha; fixes bug
      1238. Bug discovered by Martin Kowalczyk.
    - When freeing a session key, zero it out completely. We only zeroed
      the first ptrsize bytes. Bugfix on 0.0.2pre8. Discovered and
      patched by ekir. Fixes bug 1254.
  o Minor bugfixes:
    - Fix static compilation by listing the openssl libraries in the right
      order. Bugfix on Tor 0.2.2.8-alpha; fixes bug 1237.
    - Resume handling .exit hostnames in a special way: originally we
      stripped the .exit part and used the requested exit relay. In
      0.2.2.1-alpha we stopped treating them in any special way, meaning
      if you use a .exit address then Tor will pass it on to the exit
      relay. Now we reject the .exit stream outright, since that behavior
      might be more expected by the user. Found and diagnosed by Scott
      Bennett and Downie on or-talk.
    - Don't spam the controller with events when we have no file
      descriptors available. Bugfix on 0.2.1.5-alpha. (Rate-limiting
      for log messages was already solved from bug 748.)
    - Avoid a bogus overlapped memcpy in tor_addr_copy(). Reported by
      "memcpyfail".
    - Make the DNSPort option work with libevent 2.x. Don't alter the
      behaviour for libevent 1.x. Fixes bug 1143. Found by SwissTorExit.
    - Emit a GUARD DROPPED controller event for a case we missed.
    - Make more fields in the controller protocol case-insensitive, since
      control-spec.txt said they were.
    - Refactor resolve_my_address() to not use gethostbyname() anymore.
      Fixes bug 1244; bugfix on 0.0.2pre25. Reported by Mike Mestnik.
    - Fix a spec conformance issue: the network-status-version token
      must be the first token in a v3 consensus or vote. Discovered by
      parakeep. Bugfix on 0.2.0.3-alpha.
  o Code simplifications and refactoring:
    - Generate our manpage and HTML documentation using Asciidoc. This
      change should make it easier to maintain the documentation, and
      produce nicer HTML.
    - Remove the --enable-iphone option. According to reports from Marco
      Bonetti, Tor builds fine without any special tweaking on recent
      iPhone SDK versions.
    - Removed some unnecessary files from the source distribution. The
      AUTHORS file has now been merged into the people page on the
      website. The roadmaps and design doc can now be found in the
      projects directory in svn.
    - Enabled various circuit build timeout constants to be controlled
      by consensus parameters. Also set better defaults for these
      parameters based on experimentation on broadband and simulated
      high latency links.
  o Minor features:
    - The 'EXTENDCIRCUIT' control port command can now be used with
      a circ id of 0 and no path. This feature will cause Tor to build
      a new 'fast' general purpose circuit using its own path selection
      algorithms.
    - Added a BUILDTIMEOUT_SET controller event to describe changes
      to the circuit build timeout.
    - Future-proof the controller protocol a bit by ignoring keyword
      arguments we do not recognize.
    - Expand homedirs passed to tor-checkkey. This should silence a
      coverity complaint about passing a user-supplied string into
      open() without checking it.

@_date: 2010-03-09 14:45:07
@_author: Roger Dingledine 
@_subject: tor 0.2.1.24 crashes on Sparc-Solaris10 
Try these:
It includes:
  o Major bugfixes:
    - Fix a regression from our patch for bug 1244 that caused relays
      to guess their IP address incorrectly if they didn't set Address
      in their torrc and/or their address fails to resolve. Bugfix on
      0.2.1.23; fixes bug 1269.
I guess that bug could conceivably cause a crash on an overzealous
I'm waiting for the fix to get some testing in 0.2.2.10-alpha before
putting out the new stable.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-13 23:50:06
@_author: Roger Dingledine 
@_subject: How to "wrap" applications in Mac OS X? 
Check out "dsocks", by Dug Song.
Not currently, I believe. It would be great if somebody wanted to combine
torsocks and dsocks so there's less work for the poor BSD users to do.
Maybe? Give it a try, and let us know.
Good luck!
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-14 18:15:27
@_author: Roger Dingledine 
@_subject: [GSoC] Improving Snakes on a Tor 
The balance here is between making use of imperfect exit resources that
people volunteer, and keeping the content you can reach through Tor
"clean". If we had infinite exit relays, it would be clear that we should
hunt for any differences and ban all relays that don't behave perfectly.
I think John's starting point, of doing very simple tests and trying to
reduce false positives, is a good way to go. The goal would be identifying
exit relays that are *accidentally* broken, for example because their
ISP or upstream or software AV system messes with the traffic. Detecting
these can be as simple as fetching an html page with known content, and
seeing if you get the right content. Then we can focus on doing tests as
soon as possible when a new exit relay shows up (rather than waiting for
the relay to get into the consensus, go to clients, see some use, etc),
and on automating the process of getting the directory authorities to
change its status.
The next missing steps there are a) how to contact exit relays that are
accidentally broken so they have a hope of fixing the problem, and b)
how to let broken exits still be somewhat useful. These aren't problems
that John needs to tackle (at least not this summer ;), but solving them
will will make his work more useful.
For "a", it's easy if they set their ContactInfo. Problem is, many exits
don't set it, or don't set it accurately. We could set a message at the
directory authorities that their relay gets every time it publishes a
descriptor, and then have their relay log the message (and/or tell Vidalia
to pop up a message). We're on our way to supporting that approach,
but we never finished all the steps. If anybody wants to pick that up,
please do.
For "b", it could be smart to just remove certain ports from the exit
policy. We can't change the exit policy in the descriptor clients get
(because it's self-signed by the relay), but for example in the consensus
we can say that exiting on port 80 of that relay is bad but the rest of
the ports are ok. I guess how much energy we put into part b depends on
how many broken relays we find, and how successful we are at part a.
There is a separate arms race of detecting intentionally broken exits.
But imo that isn't really an arms race we can win with SoaT. The way
to do better at that one is to teach users and service providers about
end-to-end authentication and encryption. Oh, and solve the fact that
the whole Certificate Authority infrastructure idea is a mess.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-14 18:16:25
@_author: Roger Dingledine 
@_subject: Connection refused 
Could be a variety of things. It sounds like either Tor or Polipo is
caching a wrong address for your destination site.
Next time it happens, try killing and restarting only one of Tor or
Polipo, and see what you learn.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-15 21:31:05
@_author: Roger Dingledine 
@_subject: Preventing 502s? 
Depending on what you mean by "the wait time", you might try setting
CircuitStreamTimeout to something like 30 seconds.
(Only available in 0.2.2.7-alpha and later)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-15 23:58:44
@_author: Roger Dingledine 
@_subject: [GSoC] Improving Snakes on a Tor 
Good point. I didn't mean to discourage him from working on more than
one direction at once. I suspect that working on good clean tests
that don't produce false positives, and setting up the infrastructure
to automatically launch them and gather results, is something that can
actually be clearly accomplished and finished; whereas trying to sort out
the right balance between "subtly not working right" and "still worth
letting ordinary users exit from" is a rat-hole that may well lead to
madness plus no useful results. In short, it sounds like both are worth
pursuing in parallel. :)
Yep. Is there a list somewhere of what active attacks SoaT would like
to defend against, and how to do each of the corresponding tests? I
remember Mike originally designed SoaT to have a "secret" config file,
so bad guys couldn't learn what the tests are.
While I can see some reasons for doing it that way, that shouldn't stop
us from documenting whatever we can publically.
should give us a few hints about what Mike was thinking.
Once we have that list would be a good time to solicit opinions for
what's missing from it or whether it's doing tests is a suboptimal way.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-20 00:19:26
@_author: Roger Dingledine 
@_subject: perfect-privacy.com, Family specifications, etc. 
Independent. Meaning your Tor client believes family information in the
descriptor, and independently looks at whether you've set the NodeFamily
to indicate not to use two relays in the same circuit.
It would be great to see somebody clean up the man page entry.
Maybe that is you? :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-20 00:25:33
@_author: Roger Dingledine 
@_subject: Answer by perfect-privacy.com Re: perfect-privacy.com, Family 
The trouble here is that if we make family declarations one-sided, then
I can tell everybody that I'm in blutmagie's family (and X's family and
Y's family and Z's family and ...), and suddenly I'm influencing the
path selection of other clients in a way I shouldn't be able to.
We need to have each set of relays in a family declare the others,
or it's open to attacks like this.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-23 22:37:32
@_author: Roger Dingledine 
@_subject: Got warning: "ControlPort is open, but no authentication 
It depends what you did.
My guess is you either 1) edited your /etc/tor/torrc and added
a ControlPort line without also adding a HashedControlPassword or
CookieAuthentication line, or 2) went to the Advanced settings window
in Vidalia and changed the 'Authentication' choice to 'None'.
The problem here is that you've opened up your Tor to be configured by any
local application that can connect to it. You might think that's fine,
but in fact your browser is a local application that can be influenced
by a remote attacker:
The way to fix it is to either configure your Vidalia to use
authentication with Tor (rather than no authentication), or to leave
Vidalia off and just run Tor by itself.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-05-25 16:33:33
@_author: Roger Dingledine 
@_subject: [OT] another proxy, but not open source :-( 
Tor certainly takes a different approach to publicity compared to
people like Haystack. We prefer to let our technology and deployment
do the speaking, and then explain it to people once it's clear there's
something worth explaining.
As has been made clear in all areas of technology over the past years,
though, the publicity side of things doesn't care whether you have the
technology sorted out or not.
Still, no thanks. I'd rather spend my time figuring out how to make the
technology actually work, than telling people about how great it'll be.
That said, massive publicity engines like this one can still do the
field some good. First, it reminds a much broader segment of society
about the issues. Second, it draws the attention of the censors. :)
Big red warning letters are actually something that these other projects
attack us about. After all, if you scare your users, they'll just go
elsewhere, or "worse", they'll stop trying to circumvent their firewall
as much.
It does worry me that so many of these projects see circumvention and
user privacy as totally unrelated goals. Iran sure has been learning its
lesson in that regard, with all the shiny new deep packet inspection
hardware their government is deploying. Check out these quotes from
Iran's chief of police:
For more reading, check out  at
It sure would be cool if somebody worked on pluggable ways to transport
Tor traffic in a more unobservable way. I suspect that starting over is
an unlikely route to get there though.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-18 23:03:41
@_author: Roger Dingledine 
@_subject: Anonymity easily thwarted by flooding network with relays? 
I just took a brief look through it. I wish they'd included analysis of
guard nodes in their equations -- because relays take several days or
more to get the Guard flag, and clients only rotate their guards monthly,
the equations in this paper are misleading and their conclusions like
"99% if the user connects three times" and "the network forensics section
may last for a few hours [and still be effective]" are also misleading.
That isn't to say that the general point is wrong -- I think with the
current size of the Tor network, a well-funded adversary could run enough
relays that he will have a high probability of deanonymizing users. We
sure do need to get a larger network if we want to raise the cost of
these attacks. But at some point somebody should run the numbers to
find out how much it would cost in practice. (These numbers might also
convince us to change the parameters like "3 guards" and "30 days".)
We should also take the next step in our bandwidth measurement authorities
at some point -- right now the directory authorities put in a better
estimate for your bandwidth _once we have a better estimate_, and use the
self-advertised bandwidth until that point. I think that's a security
flaw. We could cap the believed self-advertised bandwidth at something
like 100KB. It would mean that newly volunteering relays would take even
longer before they're usefully contributing. The step after that would
be to accelerate the initial measurements on new relays, to narrow the
window where we don't have an opinion on bandwidth weight.
There's also an open research question on how to combine Mike Perry's
measurements (which are more accurate at high bandwidths) with Robin
Snyder's measurements (which are more accurate at low bandwidths). I
know Mike would love to have some help there.
No, that won't work. The key vulnerability is the first-last correlation
attack, which doesn't care how many hops your path has (as long
as it's at least two). You can read more about it from the various
freehaven.net/anonbib/ links in this blog post about a related topic:
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-24 14:02:16
@_author: Roger Dingledine 
@_subject: Do I need an updated .torrc file? 
That's actually the newest version of the default torrc. I update the
date and version at the top when I change the file, but I try not to
change the file often because every time it changes some of the packages
(e.g. Debian) need to interact with the user, to ask if they want to
keep their old torrc version or move to the new version.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-25 13:35:50
@_author: Roger Dingledine 
@_subject: StrictNodes or StrictExitNodes? 
When Vidalia tells you Tor exited, you should go to Vidalia's message
window and learn what Tor said as it exited. In this case I'd guess
it's because Tor 0.2.1.26 does not know the 'StrictNodes' config option.
It was introduced in Tor 0.2.2.7-alpha.
WarnUnsafeSocks was introduced in Tor 0.2.2.14-alpha.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-25 18:41:22
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.19-alpha is out 
Yet another OpenSSL security patch broke its compatibility with Tor:
Tor 0.2.2.19-alpha makes relays work with OpenSSL 0.9.8p and 1.0.0.b.
Changes in version 0.2.2.19-alpha - 2010-11-21
  o Major bugfixes:
    - Resolve an incompatibility with openssl 0.9.8p and openssl 1.0.0b:
      No longer set the tlsext_host_name extension on server SSL objects;
      but continue to set it on client SSL objects. Our goal in setting
      it was to imitate a browser, not a vhosting server. Fixes bug 2204;
      bugfix on 0.2.1.1-alpha.
  o Minor bugfixes:
    - Try harder not to exceed the maximum length of 50 KB when writing
      statistics to extra-info descriptors. This bug was triggered by very
      fast relays reporting exit-port, entry, and dirreq statistics.
      Reported by Olaf Selke. Bugfix on 0.2.2.1-alpha. Fixes bug 2183.
    - Publish a router descriptor even if generating an extra-info
      descriptor fails. Previously we would not publish a router
      descriptor without an extra-info descriptor; this can cause fast
      exit relays collecting exit-port statistics to drop from the
      consensus. Bugfix on 0.1.2.9-rc; fixes bug 2195.

@_date: 2010-11-26 14:33:47
@_author: Roger Dingledine 
@_subject: Security risks of using vds for setting up tor-nodes? 
It's much more likely that they broke in through some other service
you're running. Sounds like you didn't keep your system up-to-date?
Reinstall, for sure. They got root, and replaced a lot of files. You're
always going to be wondering what else they replaced that you didn't
It's better to generate new keys. Who knows how many people have seen
your current keys. That's what compromise means. :)
Generating new keys for your relay really doesn't hurt Tor much, so you
shouldn't feel bad about doing it in cases like this.
Maybe, but it's much more likely that you're just a random victim,
and they were planning to use your machine to launch other attacks,
run an IRC bouncer, or do whatever else script kiddies do these days.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-16 14:23:01
@_author: Roger Dingledine 
@_subject: 3 Hops 
Tor client -> entry guard -> middle hop -> exit relay -> website
So your traffic goes through three Tor relays.
The circuit you use to the hidden service is six hops:
Tor client -> entry guard -> middle hop -> rendezvous point ->
middle hop* -> middle hop* -> entry guard* -> Tor client*
And the ones with stars are chosen by the hidden service's Tor, so it
can get its anonymity from you. Basically, the hidden service design
glues two Tor circuits together.
Everything is encrypted between your Tor client and the Tor client
that offers the hidden service. No external parties get to read it.
I wouldn't go so far as to call that "completely anonymous", given that
the hidden service gets to read it and you don't know who that is.
I don't understand this part of the question.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-17 12:04:30
@_author: Roger Dingledine 
@_subject: Tor 0.2.1.26-1~~lenny+1: segfault with libcryto.so.0.9.8 
On Debian, you want to apt-get install tor-dbg, so you get the symbols
for the Tor binary.
You might even have a core file already sitting in your datadirectory,
which I think is /var/lib/tor/
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-17 15:17:41
@_author: Roger Dingledine 
@_subject: Debian/Ubuntu tor users, please check for core files 
Hi folks,
If you use our debs on Debian or Ubuntu, can you please do
ls -la /var/lib/tor/core*
as root, and let us know if you have any?
I want to get a sense of how many core files (from crashes) are piling up
for you.
If you do have core files, don't share them with anybody -- they could
include sensitive information like your past session keys or what
destinations you visited then.
Alas, due to a bug in Debian's current gdb:
these core files are not so useful with the Tor debs from 0.2.2.7-alpha
onward, since we ship them with compiler hardening flags (-pie) that
confuse gdb.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-17 17:05:27
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.18-alpha is out 
Tor 0.2.2.18-alpha fixes several crash bugs that have been nagging
us lately, makes unpublished bridge relays able to detect their IP
address, and fixes a wide variety of other bugs to get us much closer
to a stable release.
Packages will be appearing over the next few days.
Changes in version 0.2.2.18-alpha - 2010-11-16
  o Major bugfixes:
    - Do even more to reject (and not just ignore) annotations on
      router descriptors received anywhere but from the cache. Previously
      we would ignore such annotations at first, but cache them to disk
      anyway. Bugfix on 0.2.0.8-alpha. Found by piebeer.
    - Do not log messages to the controller while shrinking buffer
      freelists. Doing so would sometimes make the controller connection
      try to allocate a buffer chunk, which would mess up the internals
      of the freelist and cause an assertion failure. Fixes bug 1125;
      fixed by Robert Ransom. Bugfix on 0.2.0.16-alpha.
    - Learn our external IP address when we're a relay or bridge, even if
      we set PublishServerDescriptor to 0. Bugfix on 0.2.0.3-alpha,
      where we introduced bridge relays that don't need to publish to
      be useful. Fixes bug 2050.
    - Maintain separate TLS contexts and certificates for incoming and
      outgoing connections in bridge relays. Previously we would use the
      same TLS contexts and certs for incoming and outgoing connections.
      Bugfix on 0.2.0.3-alpha; addresses bug 988.
    - Maintain separate identity keys for incoming and outgoing TLS
      contexts in bridge relays. Previously we would use the same
      identity keys for incoming and outgoing TLS contexts. Bugfix on
      0.2.0.3-alpha; addresses the other half of bug 988.
    - Avoid an assertion failure when we as an authority receive a
      duplicate upload of a router descriptor that we already have,
      but which we previously considered an obsolete descriptor.
      Fixes another case of bug 1776. Bugfix on 0.2.2.16-alpha.
    - Avoid a crash bug triggered by looking at a dangling pointer while
      setting the network status consensus. Found by Robert Ransom.
      Bugfix on 0.2.2.17-alpha. Fixes bug 2097.
    - Fix a logic error where servers that _didn't_ act as exits would
      try to keep their server lists more aggressively up to date than
      exits, when it was supposed to be the other way around. Bugfix
      on 0.2.2.17-alpha.
  o Minor bugfixes (on Tor 0.2.1.x and earlier):
    - When we're trying to guess whether we know our IP address as
      a relay, we would log various ways that we failed to guess
      our address, but never log that we ended up guessing it
      successfully. Now add a log line to help confused and anxious
      relay operators. Bugfix on 0.1.2.1-alpha; fixes bug 1534.
    - Bring the logic that gathers routerinfos and assesses the
      acceptability of circuits into line. This prevents a Tor OP from
      getting locked in a cycle of choosing its local OR as an exit for a
      path (due to a .exit request) and then rejecting the circuit because
      its OR is not listed yet. It also prevents Tor clients from using an
      OR running in the same instance as an exit (due to a .exit request)
      if the OR does not meet the same requirements expected of an OR
      running elsewhere. Fixes bug 1859; bugfix on 0.1.0.1-rc.
    - Correctly describe errors that occur when generating a TLS object.
      Previously we would attribute them to a failure while generating a
      TLS context. Patch by Robert Ransom. Bugfix on 0.1.0.4-rc; fixes
      bug 1994.
    - Enforce multiplicity rules when parsing annotations. Bugfix on
      0.2.0.8-alpha. Found by piebeer.
    - Fix warnings that newer versions of autoconf produced during
      ./autogen.sh. These warnings appear to be harmless in our case,
      but they were extremely verbose. Fixes bug 2020.
  o Minor bugfixes (on Tor 0.2.2.x):
    - Enable protection of small arrays whenever we build with gcc
      hardening features, not only when also building with warnings
      enabled. Fixes bug 2031; bugfix on 0.2.2.14-alpha. Reported by keb.
  o Minor features:
    - Make hidden services work better in private Tor networks by not
      requiring any uptime to join the hidden service descriptor
      DHT. Implements ticket 2088.
    - Rate-limit the "your application is giving Tor only an IP address"
      warning. Addresses bug 2000; bugfix on 0.0.8pre2.
    - When AllowSingleHopExits is set, print a warning to explain to the
      relay operator why most clients are avoiding her relay.
    - Update to the November 1 2010 Maxmind GeoLite Country database.
  o Code simplifications and refactoring:
    - When we fixed bug 1038 we had to put in a restriction not to send
      RELAY_EARLY cells on rend circuits. This was necessary as long
      as relays using Tor 0.2.1.3-alpha through 0.2.1.18-alpha were
      active. Now remove this obsolete check. Resolves bug 2081.
    - Some options used different conventions for uppercasing of acronyms
      when comparing manpage and source. Fix those in favor of the
      manpage, as it makes sense to capitalize acronyms.
    - Remove the torrc.complete file. It hasn't been kept up to date
      and users will have better luck checking out the manpage.
    - Remove the obsolete "NoPublish" option; it has been flagged
      as obsolete and has produced a warning since 0.1.1.18-rc.
    - Remove everything related to building the expert bundle for OS X.
      It has confused many users, doesn't work right on OS X 10.6,
      and is hard to get rid of once installed. Resolves bug 1274.

@_date: 2010-11-17 19:50:05
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.18-alpha is out 
If by "Tor-only" packages you mean the old "expert" packages, we decided
to drop support for them:
  o Code simplifications and refactoring:
    - Remove everything related to building the expert bundle for OS X.
      It has confused many users, doesn't work right on OS X 10.6,
      and is hard to get rid of once installed. Resolves bug 1274.
Sounds like we should come up with some recommended upgrade path. What
are some good ways for OS X users to install and maintain Tor as a
relay, other than by using the Vidalia install or the (experimental)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-11-17 19:55:27
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.18-alpha is out 
For background, see
Sounds like we should do a better job of declaring a policy on what
platforms we're trying to make work, and a better job of getting feedback
from users when we ponder changes in this policy. Last I heard, Nick
was working on a proposed policy draft so we can at least get a handle
on where things stand currently. The challenge is that we have neither
enough developers nor enough (trustworthy) build machines to support
everything out there.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-16 14:33:46
@_author: Roger Dingledine 
@_subject: Where does Tor get its relay lists from? 
Another place to read would be
and then
The short answer is "it gets it from a few static IP addresses that
never change, except if you're using bridges in which case it uses
your bridges".
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-19 23:30:53
@_author: Roger Dingledine 
@_subject: hidden service 
[In the future, please send your mail to only one list, not two. I just
subscribed you to or-talk, since you'd sent the mail there but aren't
on the list.]
What Tor version are you using?
One of the changes in Tor 0.2.2.1-alpha is:
    - Hidden services no longer publish version 0 descriptors, and clients
      do not request or use version 0 descriptors. However, the old hidden
      service authorities still accept and serve version 0 descriptors
      when contacted by older hidden services/clients.
So if you're using Tor 0.2.1.26, the fix is to add the "hs" flag to
your dirserver lines.
The man page says:
       DirServer [nickname] [flags] address:port fingerprint
For some example lines, see add_default_trusted_dir_authorities()
in src/or/config.c, e.g.
If you're using Tor 0.2.2.x or later, though, the hidden service directory
servers are no longer centralized. We use a distributed hash table design
to spread the hidden service descriptors around all relays that have
the HSDir flag. The HSDir flag is only given to relays that have been up
for at least MinUptimeHidServDirectoryV2 seconds, which by default is 24
hours. My guess is that setting that config value to 0 on the directory
authorities should help in your case.
Were you using the TestingTorNetwork config option? If so, I think Tor
ought to set MinUptimeHidServDirectoryV2 to 0 for you automatically. But
it doesn't do that yet. I just opened a bug report to resolve it:
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-27 06:02:55
@_author: Roger Dingledine 
@_subject: TBB in a sandbox (osx) 
Hi Andreas!
Thanks for working on this. Sorry for the delay in response.
As we talked about today in person, I think the sandboxed TBB on OS
X should start with a quite relaxed policy. So long as we block the
super-dangerous stuff like executing other programs, we're doing a lot
better than we would be doing without a sandbox.
We could ship with a very locked-down policy, but then most people would
try the bundle and abandon it without ever filing a bug report. On the
other hand, if we ship the main bundle with a relaxed policy and then try
out new experimental versions that are slightly more locked down, people
are more likely to complain to us when we break their expected workflow.
The eventual goal is to get a better handle on what workflows actual OS
X users expect to use with a sandboxed TBB. We could certainly anticipate
all possible workflows and try to design sandbox rules that will work for
every person, but we will go mad. We could try to guess the top 6 choices
that users will want to make (allow flash or not, allow downloads or not,
etc), but I think we should wait to hear from actual users what they
most want to do. Then we could imagine that the first time you launch
TBB, Vidalia walks you through choosing how locked down you want your
Firefox to be.
The flash question in particular is tricky -- TBB for Windows ships
without Flash, yet when people complain that we broke Youtube we point
them at which tells them how to turn off Torbutton's protections. But their
Firefox doesn't have flash in the first place, so turning off Torbutton's
protections doesn't actually solve their problem. Mike and Erinn were
recently trying to decide whether to reenable Firefox's plugin search
path, which would let it find Flash if you have another Firefox+Flash
installed on the system. That would be good for the people who want to
find and use their Flash from TBB, but it would be bad for the people
who really want Tor to disable their Flash (less defense-in-depth). Both
options are messy.
Hope that helps as a general strategy suggestion. Let us know if there
are still specific choices to be made -- or just pick something smart and
run with it, so we can get to the 'actual users testing it' phase. :)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-01 04:56:25
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.17-alpha is out 
Tor 0.2.2.17-alpha introduces a feature to make it harder for clients
to use one-hop circuits (which can put the exit relays at higher risk,
plus unbalance the network); fixes a big bug in bandwidth accounting
for relays that want to limit their monthly bandwidth use; fixes a
big pile of bugs in how clients tolerate temporary network failure;
and makes our adaptive circuit build timeout feature (which improves
client performance if your network is fast while not breaking things
if your network is slow) better handle bad networks.
Packages will be appearing over the next few days.
Changes in version 0.2.2.17-alpha - 2010-09-30
  o Major features:
    - Exit relays now try harder to block exit attempts from unknown
      relays, to make it harder for people to use them as one-hop proxies
      a la tortunnel. Controlled by the refuseunknownexits consensus
      parameter (currently enabled), or you can override it on your
      relay with the RefuseUnknownExits torrc option. Resolves bug 1751.
  o Major bugfixes (0.2.1.x and earlier):
    - Fix a bug in bandwidth accounting that could make us use twice
      the intended bandwidth when our interval start changes due to
      daylight saving time. Now we tolerate skew in stored vs computed
      interval starts: if the start of the period changes by no more than
      50% of the period's duration, we remember bytes that we transferred
      in the old period. Fixes bug 1511; bugfix on 0.0.9pre5.
    - Always search the Windows system directory for system DLLs, and
      nowhere else. Bugfix on 0.1.1.23; fixes bug 1954.
    - When you're using bridges and your network goes away and your
      bridges get marked as down, recover when you attempt a new socks
      connection (if the network is back), rather than waiting up to an
      hour to try fetching new descriptors for your bridges. Bugfix on
      0.2.0.3-alpha; fixes bug 1981.
  o Major bugfixes (on 0.2.2.x):
    - Fix compilation on Windows. Bugfix on 0.2.2.16-alpha; related to
      bug 1797.
    - Fix a segfault that could happen when operating a bridge relay with
      no GeoIP database set. Fixes bug 1964; bugfix on 0.2.2.15-alpha.
    - The consensus bandwidth-weights (used by clients to choose fast
      relays) entered an unexpected edge case in September where
      Exits were much scarcer than Guards, resulting in bad weight
      recommendations. Now we compute them using new constraints that
      should succeed in all cases. Also alter directory authorities to
      not include the bandwidth-weights line if they fail to produce
      valid values. Fixes bug 1952; bugfix on 0.2.2.10-alpha.
    - When weighting bridges during path selection, we used to trust
      the bandwidths they provided in their descriptor, only capping them
      at 10MB/s. This turned out to be problematic for two reasons:
      Bridges could claim to handle a lot more traffic then they
      actually would, thus making more clients pick them and have a
      pretty effective DoS attack. The other issue is that new bridges
      that might not have a good estimate for their bw capacity yet
      would not get used at all unless no other bridges are available
      to a client. Fixes bug 1912; bugfix on 0.2.2.7-alpha.
  o Major bugfixes (on the circuit build timeout feature, 0.2.2.x):
    - Ignore cannibalized circuits when recording circuit build times.
      This should provide for a minor performance improvement for hidden
      service users using 0.2.2.14-alpha, and should remove two spurious
      notice log messages. Bugfix on 0.2.2.14-alpha; fixes bug 1740.
    - Simplify the logic that causes us to decide if the network is
      unavailable for purposes of recording circuit build times. If we
      receive no cells whatsoever for the entire duration of a circuit's
      full measured lifetime, the network is probably down. Also ignore
      one-hop directory fetching circuit timeouts when calculating our
      circuit build times. These changes should hopefully reduce the
      cases where we see ridiculous circuit build timeouts for people
      with spotty wireless connections. Fixes part of bug 1772; bugfix
      on 0.2.2.2-alpha.
    - Prevent the circuit build timeout from becoming larger than
      the maximum build time we have ever seen. Also, prevent the time
      period for measurement circuits from becoming larger than twice that
      value. Fixes the other part of bug 1772; bugfix on 0.2.2.2-alpha.
  o Minor features:
    - When we run out of directory information such that we can't build
      circuits, but then get enough that we can build circuits, log when
      we actually construct a circuit, so the user has a better chance of
      knowing what's going on. Fixes bug 1362.
    - Be more generous with how much bandwidth we'd use up (with
      accounting enabled) before entering "soft hibernation". Previously,
      we'd refuse new connections and circuits once we'd used up 95% of
      our allotment. Now, we use up 95% of our allotment, AND make sure
      that we have no more than 500MB (or 3 hours of expected traffic,
      whichever is lower) remaining before we enter soft hibernation.
    - If we've configured EntryNodes and our network goes away and/or all
      our entrynodes get marked down, optimistically retry them all when
      a new socks application request appears. Fixes bug 1882.
    - Add some more defensive programming for architectures that can't
      handle unaligned integer accesses. We don't know of any actual bugs
      right now, but that's the best time to fix them. Fixes bug 1943.
    - Support line continuations in the torrc config file. If a line
      ends with a single backslash character, the newline is ignored, and
      the configuration value is treated as continuing on the next line.
      Resolves bug 1929.
  o Minor bugfixes (on 0.2.1.x and earlier):
    - For bandwidth accounting, calculate our expected bandwidth rate
      based on the time during which we were active and not in
      soft-hibernation during the last interval. Previously, we were
      also considering the time spent in soft-hibernation. If this
      was a long time, we would wind up underestimating our bandwidth
      by a lot, and skewing our wakeup time towards the start of the
      accounting interval. Fixes bug 1789. Bugfix on 0.0.9pre5.
  o Minor bugfixes (on 0.2.2.x):
    - Resume generating CIRC FAILED REASON=TIMEOUT control port messages,
      which were disabled by the circuit build timeout changes in
      0.2.2.14-alpha. Bugfix on 0.2.2.14-alpha; fixes bug 1739.
    - Make sure we don't warn about missing bandwidth weights when
      choosing bridges or other relays not in the consensus. Bugfix on
      0.2.2.10-alpha; fixes bug 1805.
    - In our logs, do not double-report signatures from unrecognized
      authorities both as "from unknown authority" and "not
      present". Fixes bug 1956, bugfix on 0.2.2.16-alpha.

@_date: 2010-10-27 17:05:45
@_author: Roger Dingledine 
@_subject: Hints and Tips for Whistleblowers - their comments on Tor and 
Once upon a time, Tor shipped with an http proxy named Privoxy, which
tried to remove identifying features from the web pages you get and
from your web requests you make. These were the days before Torbutton,
and back in that day Tor was entirely focused on location anonymity
(i.e. protecting the origin and destination of your traffic). Our approach
to application-level anonymity (making sure the website you're talking
to can't recognize you by cookies or history, can't give you malicious
flash applets, etc) was to wish you luck and remind you that it's a
hard problem.
Back in that day there were some people who noted that https traffic
couldn't be parsed by Privoxy, so Privoxy couldn't do its job. Fair
point. They then mistakenly recommended that letting Privoxy see the
traffic would overall be better for your privacy than the end-to-end
encryption that https offers. Bad advice, it turns out.
So I think the conclusion is a) that advice was bad at the time, and b)
it's really bad advice now that Torbutton exists.
Yeah, this sounds like garbage advice.
Perhaps they are thinking that if you don't use Privoxy, then your
actual user agent will show up in the apache logs of the webserver,
and this is risky? In any case, the application-level scrubbing needs
to happen inside the browser, not in a proxy, and one main reason is
so you can do https just as safely.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-28 06:01:20
@_author: Roger Dingledine 
@_subject: TorFaq on https for hidden services ( was: Hints and Tips for 
Yes, it's wrong. It's a wiki -- please fix it. :)
In fact, none of the Tor developers added this particular question in
the first place. That's part of why I've been pushing to migrate the faq
entries that are actually useful onto so we can abandon the wiki faq.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-20 16:13:50
@_author: Roger Dingledine 
@_subject: A few questions and potential answers: 
Tor uses a distributed trust model, where any single relay doesn't get
to learn both the user and her destination. So yes, a bad guy can run a
relay, but the sample of network traffic he sees from that relay is not
useful to him. He needs to own multiple relays, and get lucky enough to
own the user's first hop and also her last hop. The math is a lot better
in that case, though still not perfect -- for c out of n proxies run by
the bad guy, the chance he wins is (c/n)^2 rather than c/n.
Correct, it isn't hard.
If you're talking about a one-hop network (that is, a network where
users route through one proxy and then to their destination), then yes,
I think centralized control is a slightly better idea. But I think one-hop
proxies are a horrible idea for anonymity, whether centralized or not.
Aside from the "does the proxy want to learn about my browsing habits"
question, you need to wonder about whether the network itself (e.g. the
proxy's upstream) wants to track things.
See also Section 5 of
It sounds like you're thinking of Tor as a network of one-hop proxies.
Tor is more modular than that -- in a nutshell, the core Tor protocol
is a protocol to build secure routes through a set of relays, and it
doesn't care where it learns the relays.
You might like
That's one approach. I think there other viable approaches too.
This actually does happen, e.g. to some people we know in a certain
north African country.
As Justin mentioned, Tor relays (including bridges) can listen on whatever
ports they want.
See item  on
which leads to
which needs more work. :)
The best known answer is to try to look enough like some other common
protocol that you mostly blend in. Trying to look like SSL is the clear
best choice at this point.
Sounds like a fine open problem. You should investigate it and show us
that it can actually be done, and actually will make it harder to notice
this traffic. Historically, people working on this topic either (at best)
find that it's harder than they thought, or (at worst) overlook why it's
hard and end up with an approach that's less safe than they think.
A good place to start might be to look at papers in the Information
Hiding workshop over the past decade.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-21 17:56:58
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.16-alpha is out 
Tor 0.2.2.16-alpha fixes a variety of old stream fairness bugs (most
evident at exit relays), and also continues to resolve all the little
bugs that have been filling up trac lately.
Packages will be appearing over the next few days or weeks (except
on Windows, which apparently doesn't build -- stay tuned for an
0.2.2.17-alpha in that case).
Changes in version 0.2.2.16-alpha - 2010-09-17
  o Major bugfixes (stream-level fairness):
    - When receiving a circuit-level SENDME for a blocked circuit, try
      to package cells fairly from all the streams that had previously
      been blocked on that circuit. Previously, we had started with the
      oldest stream, and allowed each stream to potentially exhaust
      the circuit's package window. This gave older streams on any
      given circuit priority over newer ones. Fixes bug 1937. Detected
      originally by Camilo Viecco. This bug was introduced before the
      first Tor release, in svn commit r152: it is the new winner of
      the longest-lived bug prize.
    - When the exit relay got a circuit-level sendme cell, it started
      reading on the exit streams, even if had 500 cells queued in the
      circuit queue already, so the circuit queue just grew and grew in
      some cases. We fix this by not re-enabling reading on receipt of a
      sendme cell when the cell queue is blocked. Fixes bug 1653. Bugfix
      on 0.2.0.1-alpha. Detected by Mashael AlSabah. Original patch by
      "yetonetime".
    - Newly created streams were allowed to read cells onto circuits,
      even if the circuit's cell queue was blocked and waiting to drain.
      This created potential unfairness, as older streams would be
      blocked, but newer streams would gladly fill the queue completely.
      We add code to detect this situation and prevent any stream from
      getting more than one free cell. Bugfix on 0.2.0.1-alpha. Partially
      fixes bug 1298.
  o Minor features:
    - Update to the September 1 2010 Maxmind GeoLite Country database.
    - Warn when CookieAuthFileGroupReadable is set but CookieAuthFile is
      not. This would lead to a cookie that is still not group readable.
      Closes bug 1843. Suggested by katmagic.
    - When logging a rate-limited warning, we now mention how many messages
      got suppressed since the last warning.
    - Add new "perconnbwrate" and "perconnbwburst" consensus params to
      do individual connection-level rate limiting of clients. The torrc
      config options with the same names trump the consensus params, if
      both are present. Replaces the old "bwconnrate" and "bwconnburst"
      consensus params which were broken from 0.2.2.7-alpha through
      0.2.2.14-alpha. Closes bug 1947.
    - When a router changes IP address or port, authorities now launch
      a new reachability test for it. Implements ticket 1899.
    - Make the formerly ugly "2 unknown, 7 missing key, 0 good, 0 bad,
      2 no signature, 4 required" messages about consensus signatures
      easier to read, and make sure they get logged at the same severity
      as the messages explaining which keys are which. Fixes bug 1290.
    - Don't warn when we have a consensus that we can't verify because
      of missing certificates, unless those certificates are ones
      that we have been trying and failing to download. Fixes bug 1145.
    - If you configure your bridge with a known identity fingerprint,
      and the bridge authority is unreachable (as it is in at least
      one country now), fall back to directly requesting the descriptor
      from the bridge. Finishes the feature started in 0.2.0.10-alpha;
      closes bug 1138.
    - When building with --enable-gcc-warnings on OpenBSD, disable
      warnings in system headers. This makes --enable-gcc-warnings
      pass on OpenBSD 4.8.
  o Minor bugfixes (on 0.2.1.x and earlier):
    - Authorities will now attempt to download consensuses if their
      own efforts to make a live consensus have failed. This change
      means authorities that restart will fetch a valid consensus, and
      it means authorities that didn't agree with the current consensus
      will still fetch and serve it if it has enough signatures. Bugfix
      on 0.2.0.9-alpha; fixes bug 1300.
    - Ensure DNS requests launched by "RESOLVE" commands from the
      controller respect the __LeaveStreamsUnattached setconf options. The
      same goes for requests launched via DNSPort or transparent
      proxying. Bugfix on 0.2.0.1-alpha; fixes bug 1525.
    - Allow handshaking OR connections to take a full KeepalivePeriod
      seconds to handshake. Previously, we would close them after
      IDLE_OR_CONN_TIMEOUT (180) seconds, the same timeout as if they
      were open. Bugfix on 0.2.1.26; fixes bug 1840. Thanks to mingw-san
      for analysis help.
    - Rate-limit "Failed to hand off onionskin" warnings.
    - Never relay a cell for a circuit we have already destroyed.
      Between marking a circuit as closeable and finally closing it,
      it may have been possible for a few queued cells to get relayed,
      even though they would have been immediately dropped by the next
      OR in the circuit. Fixes bug 1184; bugfix on 0.2.0.1-alpha.
    - Never queue a cell for a circuit that's already been marked
      for close.
    - Never vote for a server as "Running" if we have a descriptor for
      it claiming to be hibernating, and that descriptor was published
      more recently than our last contact with the server. Bugfix on
      0.2.0.3-alpha; fixes bug 911.
    - Squash a compile warning on OpenBSD. Reported by Tas; fixes
      bug 1848.
  o Minor bugfixes (on 0.2.2.x):
    - Fix a regression introduced in 0.2.2.7-alpha that marked relays
      down if a directory fetch fails and you've configured either
      bridges or EntryNodes. The intent was to mark the relay as down
      _unless_ you're using bridges or EntryNodes, since if you are
      then you could quickly run out of entry points.
    - Fix the Windows directory-listing code. A bug introduced in
      0.2.2.14-alpha could make Windows directory servers forget to load
      some of their cached v2 networkstatus files.
    - Really allow clients to use relays as bridges. Fixes bug 1776;
      bugfix on 0.2.2.15-alpha.
    - Demote a warn to info that happens when the CellStatistics option
      was just enabled. Bugfix on 0.2.2.15-alpha; fixes bug 1921.
      Reported by Moritz Bartl.
    - On Windows, build correctly either with or without Unicode support.
      This is necessary so that Tor can support fringe platforms like
      Windows 98 (which has no Unicode), or Windows CE (which has no
      non-Unicode). Bugfix on 0.2.2.14-alpha; fixes bug 1797.
  o Testing
    - Add a unit test for cross-platform directory-listing code.

@_date: 2010-09-10 03:39:44
@_author: Roger Dingledine 
@_subject: gratuitous change blocks upgrade to 0.2.2.15-alpha :-( 
The ChangeLog entry in question is:
    - Warn when the same option is provided more than once in a torrc
      file, on the command line, or in a single SETCONF statement, and
      the option is one that only accepts a single line. Closes bug 1384.
As I understand it, we changed no behavior except printing out a warn
for people who had multiple lines, to tell them that they're expecting
behavior that they're not getting.
Can you confirm?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-10 04:40:02
@_author: Roger Dingledine 
@_subject: gratuitous change blocks upgrade to 0.2.2.15-alpha :-( 
This excludenodes thing has been no end of trouble. The root problem is
that it's a feature that absolutely none of the developers use.
I wonder if that means there are similar problems with other features
that no developers use.
In any case, Sebastian started a trac entry for this one:
wherein he starts out by listing a reason that we shouldn't fix it.
Please add more pros and cons to the trac entry.
(I guess the angry rants can stay here. ;)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-10 04:44:37
@_author: Roger Dingledine 
@_subject: gratuitous change blocks upgrade to 0.2.2.15-alpha :-( 
That bug still does exist (also):
but that bug is mainly in edge cases, e.g. where Tor wants to contact
a hidden service directory node because that's the place that knows how
to rendezvous with the hidden service, but that directory node has been
listed in excludenodes. Some users expect one behavior, others expect
a different behavior. It's on my todo list to put in some sort of patch
for it by 0.2.2.x stable.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-13 06:38:32
@_author: Roger Dingledine 
@_subject: connect Vidalia to a running tor instance [solved] 
Correct. "Start Tor" is perhaps not the best name for what it actually
does, which is "try to connect to a running Tor, and if so try to
authenticate to it. If there is no running Tor (or more precisely, if
nothing is listening on the control port that Vidalia is configured to
look on), start one."
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-09-02 13:51:13
@_author: Roger Dingledine 
@_subject: tor and resolv.conf / ipv6 
This really should only affect exit relays, right? And up until now
we assumed they would have at least ipv4 nameserver, since for other
reasons we assume they have an ipv4 address that's reachable, and that
they can reach ipv4 addresses.
Though, due to bug 965:
I believe non-exit relays, and even bridges, will try to parse
I wonder how common Udo's situation is.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-04-02 09:44:50
@_author: Roger Dingledine 
@_subject: [tor-talk] GSOC Ideas. 
That said, I think changing the Torstatus PHP script so it uses the
metrics database as its back-end, and cleaning up the PHP part of it,
would still be a very valuable task.
Right now Torstatus has two components: the PHP interface front-end,
and the database back-end that remembers stuff about the network so it
can (for example) make historical bandwidth graphs.
The database kept by the metrics project is probably better than the
database kept by Torstatus. So dropping the db side of torstatus, and
teaching it to use the db from metrics, would be valuable in that it
would make things more maintainable.
The front-end from Torstatus is currently more usable, and thus more
useful, than the front-end on the metrics project. Karsten would like
somebody to fix the metrics side so it's better, and then we can dump
Torstatus. That would be great, if it happens, but until it happens,
making Torstatus better would still be useful.
The problem is that there are basically no Torstatus developers in
the world, so working on that as a GSoC project would be hard since we
wouldn't have anybody to mentor you.
But if somebody wants to pick it up as a side hobby, that'd be great. :)

@_date: 2011-04-07 23:52:55
@_author: Roger Dingledine 
@_subject: [tor-talk] location question 
You may find this FAQ entry useful:
You can find that link in item 'b' of

@_date: 2011-04-17 00:18:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.24-alpha is out 
Tor 0.2.2.24-alpha fixes a variety of bugs, including a big bug that
prevented Tor clients from effectively using "multihomed" bridges,
that is, bridges that listen on multiple ports or IP addresses so users
can continue to use some of their addresses even if others get blocked.
Changes in version 0.2.2.24-alpha - 2011-04-08
  o Major bugfixes:
    - Fix a bug where bridge users who configure the non-canonical
      address of a bridge automatically switch to its canonical
      address. If a bridge listens at more than one address, it should be
      able to advertise those addresses independently and any non-blocked
      addresses should continue to work. Bugfix on Tor 0.2.0.x. Fixes
      bug 2510.
    - If you configured Tor to use bridge A, and then quit and
      configured Tor to use bridge B instead, it would happily continue
      to use bridge A if it's still reachable. While this behavior is
      a feature if your goal is connectivity, in some scenarios it's a
      dangerous bug. Bugfix on Tor 0.2.0.1-alpha; fixes bug 2511.
    - Directory authorities now use data collected from their own
      uptime observations when choosing whether to assign the HSDir flag
      to relays, instead of trusting the uptime value the relay reports in
      its descriptor. This change helps prevent an attack where a small
      set of nodes with frequently-changing identity keys can blackhole
      a hidden service. (Only authorities need upgrade; others will be
      fine once they do.) Bugfix on 0.2.0.10-alpha; fixes bug 2709.
  o Minor bugfixes:
    - When we restart our relay, we might get a successful connection
      from the outside before we've started our reachability tests,
      triggering a warning: "ORPort found reachable, but I have no
      routerinfo yet. Failing to inform controller of success." This
      bug was harmless unless Tor is running under a controller
      like Vidalia, in which case the controller would never get a
      REACHABILITY_SUCCEEDED status event. Bugfix on 0.1.2.6-alpha;
      fixes bug 1172.
    - Make directory authorities more accurate at recording when
      relays that have failed several reachability tests became
      unreachable, so we can provide more accuracy at assigning Stable,
      Guard, HSDir, etc flags. Bugfix on 0.2.0.6-alpha. Resolves bug 2716.
    - Fix an issue that prevented static linking of libevent on
      some platforms (notably Linux). Fixes bug 2698; bugfix on
      versions 0.2.1.23/0.2.2.8-alpha (the versions introducing
      the --with-static-libevent configure option).
    - We now ask the other side of a stream (the client or the exit)
      for more data on that stream when the amount of queued data on
      that stream dips low enough. Previously, we wouldn't ask the
      other side for more data until either it sent us more data (which
      it wasn't supposed to do if it had exhausted its window!) or we
      had completely flushed all our queued data. This flow control fix
      should improve throughput. Fixes bug 2756; bugfix on the earliest
      released versions of Tor (svn commit r152).
    - Avoid a double-mark-for-free warning when failing to attach a
      transparent proxy connection. (We thought we had fixed this in
      0.2.2.23-alpha, but it turns out our fix was checking the wrong
      connection.) Fixes bug 2757; bugfix on 0.1.2.1-alpha (the original
      bug) and 0.2.2.23-alpha (the incorrect fix).
    - When warning about missing zlib development packages during compile,
      give the correct package names. Bugfix on 0.2.0.1-alpha.
  o Minor features:
    - Directory authorities now log the source of a rejected POSTed v3
      networkstatus vote.
    - Make compilation with clang possible when using
      --enable-gcc-warnings by removing two warning optionss that clang
      hasn't implemented yet and by fixing a few warnings. Implements
      ticket 2696.
    - When expiring circuits, use microsecond timers rather than
      one-second timers. This can avoid an unpleasant situation where a
      circuit is launched near the end of one second and expired right
      near the beginning of the next, and prevent fluctuations in circuit
      timeout values.
    - Use computed circuit-build timeouts to decide when to launch
      parallel introduction circuits for hidden services. (Previously,
      we would retry after 15 seconds.)
    - Update to the April 1 2011 Maxmind GeoLite Country database.
  o Packaging fixes:
    - Create the /var/run/tor directory on startup on OpenSUSE if it is
      not already created. Patch from Andreas Stieger. Fixes bug 2573.
  o Documentation changes:
    - Modernize the doxygen configuration file slightly. Fixes bug 2707.
    - Resolve all doxygen warnings except those for missing documentation.
      Fixes bug 2705.
    - Add doxygen documentation for more functions, fields, and types.

@_date: 2011-04-17 00:23:27
@_author: Roger Dingledine 
@_subject: [tor-talk] announcing releases 
The trouble is the definition of 'available for download'.
I can announce the release when the tarball is made, but then most
users (including I think you?) will find that it is not yet available
for download by their definition.
Or we can announce when some bundle or another is ready, but there's often
some user on some platform for whom it is not yet available. There's no
clear line.
The real trouble here is that I tag a tarball, then later Erinn finishes
some packages, then later I send the tor-talk mail. These "then later"s
take a couple of days each. I have become higher latency on some things
lately, since I'm doing too many Tor jobs at once. Maybe we should stop
the tor-talk mails entirely?

@_date: 2011-04-26 13:05:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Exit Enclaves 
% host duckduckgo.com
duckduckgo.com has address 50.17.207.245
% grep 50.17.207.245 cached-*
I think there is no Tor relay running at that IP address currently,
so this exit enclave you're hoping for cannot happen. An exit enclave
is a Tor exit relay that runs on the same IP address as a destination
(e.g. a website).
Perhaps you mean a Tor hidden service, not an exit enclave?
In which case, yes, if you visit a .onion address, that won't involve
Tor exit relays. You instead do a rendezvous inside the Tor network:
What does 'external validity' mean?

@_date: 2011-04-29 14:44:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.23-alpha is out 
Reminder: Nick is going to be doing the upcoming 0.2.2.25-alpha release.

@_date: 2011-08-14 01:30:17
@_author: Roger Dingledine 
@_subject: [tor-talk] Any problem installing TBB & Vidalia bundle on 
Installing both at once is no problem -- TBB doesn't require any
"install", so there's nothing to conflict.
But running both at once won't work currently: the Tor in each of them
tries to bind to the same ports, so the first one to run will win and
the second one to run will lose.
We're actually trying to fix that so they can be run together though.
Keep an eye on upcoming TBB announcements.
I agree. I wonder if we should come up with some option in the TBB
Vidalia 'advanced' window, along the lines of "don't close TBB when
Firefox closes".
Vidalia is working on a plugin approach, so for example that checkbox
might become an option in the "TBB panel" in Vidalia.

@_date: 2011-08-27 01:13:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.31-rc is out 
Tor 0.2.2.31-rc is the second and final release candidate for the Tor
0.2.2.x series.
(The upcoming release is going to be a stable 0.2.2.32 release. Finally!
For those looking for a sneak peak, check out
 )
Changes in version 0.2.2.31-rc - 2011-08-17
  o Major bugfixes:
    - Remove an extra pair of quotation marks around the error
      message in control-port STATUS_GENERAL BUG events. Bugfix on
      0.1.2.6-alpha; fixes bug 3732.
    - If we're configured to write our ControlPorts to disk, only write
      them after switching UID and creating the data directory. This way,
      we don't fail when starting up with a nonexistent DataDirectory
      and a ControlPortWriteToFile setting based on that directory. Fixes
      bug 3747; bugfix on Tor 0.2.2.26-beta.
  o Minor features:
    - Update to the August 2 2011 Maxmind GeoLite Country database.
  o Minor bugfixes:
    - Allow GETINFO fingerprint to return a fingerprint even when
      we have not yet built a router descriptor. Fixes bug 3577;
      bugfix on 0.2.0.1-alpha.
    - Write several files in text mode, on OSes that distinguish text
      mode from binary mode (namely, Windows). These files are:
      'buffer-stats', 'dirreq-stats', and 'entry-stats' on relays
      that collect those statistics; 'client_keys' and 'hostname' for
      hidden services that use authentication; and (in the tor-gencert
      utility) newly generated identity and signing keys. Previously,
      we wouldn't specify text mode or binary mode, leading to an
      assertion failure. Fixes bug 3607. Bugfix on 0.2.1.1-alpha (when
      the DirRecordUsageByCountry option which would have triggered
      the assertion failure was added), although this assertion failure
      would have occurred in tor-gencert on Windows in 0.2.0.1-alpha.
    - Selectively disable deprecation warnings on OS X because Lion
      started deprecating the shipped copy of openssl. Fixes bug 3643.
    - When unable to format an address as a string, report its value
      as "???" rather than reusing the last formatted address. Bugfix
      on 0.2.1.5-alpha.

@_date: 2011-08-27 17:22:25
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor service can't start with "CPU worker" error 
It is an "info" level log. It doesn't mean there's a problem with your
cpuworker. That is a normal log line, either as part of Tor shutting down,
or as part of Tor rotating some of its keys. If it's the last line in
your log, my guess is it's part of Tor shutting down.
Are there no "notice" or "warn" level logs?
If no, see also

@_date: 2011-12-05 08:03:19
@_author: Roger Dingledine 
@_subject: [tor-talk] How important is it that the MyFamily option be 
Can you post the script / results somewhere?
If the relays are in the same /16 network as each other then setting
myfamily is redundant (but still pleasant).
If they're not, then it actually will make a difference.
How important it is is still a matter of debate -- on the one hand,
we want to let clients avoid building circuits that use more than one
relay operated by the same individual, and the closer we can get to that
ideal the better. On the other hand, real bad guys aren't going to make
it obvious when they run more than one relay.
I just filed

@_date: 2011-12-05 15:56:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor HS load balancing 
Yes, it will (should) work. See also
The answer if two different Tors have the same hidden service private
key is that they will each publish a hidden service descriptor. Whichever
one published more recently is the one that a user accessing the hidden
service will probably find and use.
This approach can provide a very crude load balancing. More interesting,
it can also provide a very crude failover, where if one of them
disappears, an hour or so later the other will publish and the hidden
service will become reachable again.

@_date: 2011-12-05 16:11:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Increase tor HS reachability 
I think it will end up hurting more than it helps. One of the main reasons
it's hard to reach hidden services these days is that the introduction
points for popular hidden services are overwhelmed by circuit creation
requests from users who are trying to introduce themselves (that's step 4
on If we changed it so every client that's trying to access the hidden
service mobs the introduction points even more, we will make the problem
We also have some bugs that make a single client put too much load on
the introduction point by trying over and over.
I think the fix is that we need to put *less* load on the introduction
points, and that will make them work better. Robert Ransom has been
working on this area lately.

@_date: 2011-12-08 17:17:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.9-alpha is out 
Tor 0.2.3.9-alpha introduces initial IPv6 support for bridges, adds
a "DisableNetwork" security feature that bundles can use to avoid
touching the network until bridges are configured, moves forward on
the pluggable transport design, fixes a flaw in the hidden service
design that unnecessarily prevented clients with wrong clocks from
reaching hidden services, and fixes a wide variety of other issues.
(Packages coming eventually.)
Changes in version 0.2.3.9-alpha - 2011-12-08
  o Major features:
    - Clients can now connect to private bridges over IPv6. Bridges
      still need at least one IPv4 address in order to connect to
      other relays. Note that we don't yet handle the case where the
      user has two bridge lines for the same bridge (one IPv4, one
      IPv6). Implements parts of proposal 186.
    - New "DisableNetwork" config option to prevent Tor from launching any
      connections or accepting any connections except on a control port.
      Bundles and controllers can set this option before letting Tor talk
      to the rest of the network, for example to prevent any connections
      to a non-bridge address. Packages like Orbot can also use this
      option to instruct Tor to save power when the network is off.
    - Clients and bridges can now be configured to use a separate
      "transport" proxy. This approach makes the censorship arms race
      easier by allowing bridges to use protocol obfuscation plugins. It
      implements the "managed proxy" part of proposal 180 (ticket 3472).
    - When using OpenSSL 1.0.0 or later, use OpenSSL's counter mode
      implementation. It makes AES_CTR about 7% faster than our old one
      (which was about 10% faster than the one OpenSSL used to provide).
      Resolves ticket 4526.
    - Add a "tor2web mode" for clients that want to connect to hidden
      services non-anonymously (and possibly more quickly). As a safety
      measure to try to keep users from turning this on without knowing
      what they are doing, tor2web mode must be explicitly enabled at
      compile time, and a copy of Tor compiled to run in tor2web mode
      cannot be used as a normal Tor client. Implements feature 2553.
    - Add experimental support for running on Windows with IOCP and no
      kernel-space socket buffers. This feature is controlled by a new
      "UserspaceIOCPBuffers" config option (off by default), which has
      no effect unless Tor has been built with support for bufferevents,
      is running on Windows, and has enabled IOCP. This may, in the long
      run, help solve or mitigate bug 98.
    - Use a more secure consensus parameter voting algorithm. Now at
      least three directory authorities or a majority of them must
      vote on a given parameter before it will be included in the
      consensus. Implements proposal 178.
  o Major bugfixes:
    - Hidden services now ignore the timestamps on INTRODUCE2 cells.
      They used to check that the timestamp was within 30 minutes
      of their system clock, so they could cap the size of their
      replay-detection cache, but that approach unnecessarily refused
      service to clients with wrong clocks. Bugfix on 0.2.1.6-alpha, when
      the v3 intro-point protocol (the first one which sent a timestamp
      field in the INTRODUCE2 cell) was introduced; fixes bug 3460.
    - Only use the EVP interface when AES acceleration is enabled,
      to avoid a 5-7% performance regression. Resolves issue 4525;
      bugfix on 0.2.3.8-alpha.
  o Privacy/anonymity features (bridge detection):
    - Make bridge SSL certificates a bit more stealthy by using random
      serial numbers, in the same fashion as OpenSSL when generating
      self-signed certificates. Implements ticket 4584.
    - Introduce a new config option "DynamicDHGroups", enabled by
      default, which provides each bridge with a unique prime DH modulus
      to be used during SSL handshakes. This option attempts to help
      against censors who might use the Apache DH modulus as a static
      identifier for bridges. Addresses ticket 4548.
  o Minor features (new/different config options):
    - New configuration option "DisableDebuggerAttachment" (on by default)
      to prevent basic debugging attachment attempts by other processes.
      Supports Mac OS X and Gnu/Linux. Resolves ticket 3313.
    - Allow MapAddress directives to specify matches against super-domains,
      as in "MapAddress *.torproject.org *.torproject.org.torserver.exit".
      Implements issue 933.
    - Slightly change behavior of "list" options (that is, config
      options that can appear more than once) when they appear both in
      torrc and on the command line. Previously, the command-line options
      would be appended to the ones from torrc. Now, the command-line
      options override the torrc options entirely. This new behavior
      allows the user to override list options (like exit policies and
      ports to listen on) from the command line, rather than simply
      appending to the list.
    - You can get the old (appending) command-line behavior for "list"
      options by prefixing the option name with a "+".
    - You can remove all the values for a "list" option from the command
      line without adding any new ones by prefixing the option name
      with a "/".
    - Add experimental support for a "defaults" torrc file to be parsed
      before the regular torrc. Torrc options override the defaults file's
      options in the same way that the command line overrides the torrc.
      The SAVECONF controller command saves only those options which
      differ between the current configuration and the defaults file. HUP
      reloads both files. (Note: This is an experimental feature; its
      behavior will probably be refined in future 0.2.3.x-alpha versions
      to better meet packagers' needs.)
  o Minor features:
    - Try to make the introductory warning message that Tor prints on
      startup more useful for actually finding help and information.
      Resolves ticket 2474.
    - Running "make version" now displays the version of Tor that
      we're about to build. Idea from katmagic; resolves issue 4400.
    - Expire old or over-used hidden service introduction points.
      Required by fix for bug 3460.
    - Move the replay-detection cache for the RSA-encrypted parts of
      INTRODUCE2 cells to the introduction point data structures.
      Previously, we would use one replay-detection cache per hidden
      service. Required by fix for bug 3460.
    - Reduce the lifetime of elements of hidden services' Diffie-Hellman
      public key replay-detection cache from 60 minutes to 5 minutes. This
      replay-detection cache is now used only to detect multiple
      INTRODUCE2 cells specifying the same rendezvous point, so we can
      avoid launching multiple simultaneous attempts to connect to it.
  o Minor bugfixes (on Tor 0.2.2.x and earlier):
    - Resolve an integer overflow bug in smartlist_ensure_capacity().
      Fixes bug 4230; bugfix on Tor 0.1.0.1-rc. Based on a patch by
      Mansour Moufid.
    - Fix a minor formatting issue in one of tor-gencert's error messages.
      Fixes bug 4574.
    - Prevent a false positive from the check-spaces script, by disabling
      the "whitespace between function name and (" check for functions
      named 'op()'.
    - Fix a log message suggesting that people contact a non-existent
      email address. Fixes bug 3448.
    - Fix null-pointer access that could occur if TLS allocation failed.
      Fixes bug 4531; bugfix on 0.2.0.20-rc. Found by "troll_un".
    - Report a real bootstrap problem to the controller on router
      identity mismatch. Previously we just said "foo", which probably
      made a lot of sense at the time. Fixes bug 4169; bugfix on
      0.2.1.1-alpha.
    - If we had ever tried to call tor_addr_to_str() on an address of
      unknown type, we would have done a strdup() on an uninitialized
      buffer. Now we won't. Fixes bug 4529; bugfix on 0.2.1.3-alpha.
      Reported by "troll_un".
    - Correctly detect and handle transient lookup failures from
      tor_addr_lookup(). Fixes bug 4530; bugfix on 0.2.1.5-alpha.
      Reported by "troll_un".
    - Use tor_socket_t type for listener argument to accept(). Fixes bug
      4535; bugfix on 0.2.2.28-beta. Found by "troll_un".
    - Initialize conn->addr to a valid state in spawn_cpuworker(). Fixes
      bug 4532; found by "troll_un".
  o Minor bugfixes (on Tor 0.2.3.x):
    - Fix a compile warning in tor_inet_pton(). Bugfix on 0.2.3.8-alpha;
      fixes bug 4554.
    - Don't send two ESTABLISH_RENDEZVOUS cells when opening a new
      circuit for use as a hidden service client's rendezvous point.
      Fixes bugs 4641 and 4171; bugfix on 0.2.3.3-alpha. Diagnosed
      with help from wanoskarnet.
    - Restore behavior of overriding SocksPort, ORPort, and similar
      options from the command line. Bugfix on 0.2.3.3-alpha.
  o Build fixes:
    - Properly handle the case where the build-tree is not the same
      as the source tree when generating src/common/common_sha1.i,
      src/or/micro-revision.i, and src/or/or_sha1.i. Fixes bug 3953;
      bugfix on 0.2.0.1-alpha.
  o Code simplifications, cleanups, and refactorings:
    - Remove the pure attribute from all functions that used it
      previously. In many cases we assigned it incorrectly, because the
      functions might assert or call impure functions, and we don't have
      evidence that keeping the pure attribute is worthwhile. Implements
      changes suggested in ticket 4421.
    - Remove some dead code spotted by coverity. Fixes cid 432.
      Bugfix on 0.2.3.1-alpha, closes bug 4637.

@_date: 2011-12-12 00:32:18
@_author: Roger Dingledine 
@_subject: [tor-talk] New to List 
You should be using Torbutton, not mucking with Firefox's about:config
settings yourself. In fact, you should be using Tor Browser Bundle Linux,
not using your own Firefox.
Gah. That FAQ entry really does say "TestgSocks". That's not a valid torrc
option. That means if you think you're setting it for Tor, you're not.
The more general lesson is that the FAQ on the wiki has decayed and
should not be considered authoritative. The only FAQ entries I will
vouch for are on The timeout is probably because you are using your own Firefox rather
than TBB.
tor-qa was intended as a "Tor quality assurance" list, not a questions
and answers list. It's for volunteers who want to test packages. It also
appears to have a particularly confusing name.

@_date: 2011-12-16 13:06:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.10-alpha is out (security fix) 
Tor 0.2.3.10-alpha fixes a critical heap-overflow security issue in
Tor's buffers code. Absolutely everybody should upgrade.
The bug relied on an incorrect calculation when making data continuous
in one of our IO buffers, if the first chunk of the buffer was
misaligned by just the wrong amount. The miscalculation would allow an
attacker to overflow a piece of heap-allocated memory. To mount this
attack, the attacker would need to either open a SOCKS connection to
Tor's SocksPort (usually restricted to localhost), or target a Tor
instance configured to make its connections through a SOCKS proxy
(which Tor does not do by default).
Good security practice requires that all heap-overflow bugs should be
presumed to be exploitable until proven otherwise, so we are treating
this as a potential code execution attack. Please upgrade immediately!
This bug does not affect bufferevents-based builds of Tor. Special
thanks to "Vektor" for reporting this issue to us!
This release also contains a few minor bugfixes for issues discovered
in 0.2.3.9-alpha.
Note that the tarball and git tags are signed by Nick Mathewson (gpg
key 165733EA) this time around.
Changes in version 0.2.3.10-alpha - 2011-12-16
  o Major bugfixes:
    - Fix a heap overflow bug that could occur when trying to pull
      data into the first chunk of a buffer, when that chunk had
      already had some data drained from it. Fixes CVE-2011-2778;
      bugfix on 0.2.0.16-alpha. Reported by "Vektor".
  o Minor bugfixes:
    - If we can't attach streams to a rendezvous circuit when we
      finish connecting to a hidden service, clear the rendezvous
      circuit's stream-isolation state and try to attach streams
      again. Previously, we cleared rendezvous circuits' isolation
      state either too early (if they were freshly built) or not at all
      (if they had been built earlier and were cannibalized). Bugfix on
      0.2.3.3-alpha; fixes bug 4655.
    - Fix compilation of the libnatpmp helper on non-Windows. Bugfix on
      0.2.3.9-alpha; fixes bug 4691. Reported by Anthony G. Basile.
    - Fix an assertion failure when a relay with accounting enabled
      starts up while dormant. Fixes bug 4702; bugfix on 0.2.3.9-alpha.
  o Minor features:
    - Update to the December 6 2011 Maxmind GeoLite Country database.

@_date: 2011-12-20 22:03:28
@_author: Roger Dingledine 
@_subject: [tor-talk] Announcing the Tor Farsi blog 
Neat. I'm happy to see this moving forward!
It looks like it pulls an image from a third-party site though:
meaning amazonaws gets to learn about everybody who views the fa-blog,
solely because we decided to host an image there rather than on the
fa-blog site. From the outside this sure looks like a web bug.

@_date: 2011-12-21 06:17:17
@_author: Roger Dingledine 
@_subject: [tor-talk] janusvm still safe? 
No, not safe.
Probably has been unsafe to use for years.

@_date: 2011-12-21 06:59:29
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Browser standalone without videla/tor bundle 
That should work.
Another way to do it, for those who don't like editing text files,
is to go to Vidalia's 'advanced' settings panel and click "Configure
ControlPort automatically" (and then close and restart TBB until it
works). That will make Tor pick random unused ports, have Vidalia learn
about them, and have Vidalia tell Torbutton when it launches Firefox.
That's actually the default behavior on TBB OSX and TBB Linux. We tried
it on Windows, but too many people had antivirus systems that freaked
out when Tor asked the system to give it an unused port.

@_date: 2011-12-21 07:41:07
@_author: Roger Dingledine 
@_subject: [tor-talk] Exit enclaves 
Correct. The problem comes when the user types in "
and there's a Tor relay running on the same IP address, but the user
doesn't know the IP address yet so she doesn't realize that there's an
exit enclave available.
The way it works then is that she makes a stream from some exit relay
to  and as part of its "I connected successfully" answer
it includes the IP address it found for  At that point the
Tor client will do the exit enclave thing for *future* streams -- which
could be good or bad, depending on the situation.
Exactly so. The Tor client only knows after the initial stream attempt.
You could do a 'mapaddress' line in your torrc, to tell the client
preemptively what IP address it should be. But that only works for the
clients that set it.
You could encourage all your users to connect to the server via IP
address. But that only works for the users who can handle the idea.
for a start at an alternate design that should be more foolproof.
We assume it's pretty easy, through timing analysis, to learn where
you are on the path. So if an exit relay is the third hop on the path,
and it is asked to extent to some other relay, the odds are good that
it's seeing an exit enclave attempt. (But that's ok, since the third
hop doesn't know about the user.)
It may also be possible to do a probabilistic attack at the entry
guard, or watching the client's local network. You look at the number of
round-trips of cells: three round-trips to establish a three-hop circuit,
then another round-trip for the begin cell and connected cell, then a
cell for the http get request, and a flood of cells in reply. It's unclear
how consistent the success of this attack would be, e.g. due to building
other preemptive circuits at the same time, doing directory fetches at the
same time, building 4-hop circuits for other reasons like hidden service
interaction, etc; but that's not at all the same as a security argument.

@_date: 2011-02-24 00:11:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Weather reports Node Out of Date! 
Seems like Weather should alert the user if their version is not in the
recommended versions list. It shouldn't alert the user if there exists
a version newer than their current one, yet both are in the recommended
versions list.
(I guess we could have a "mail me whenever a new version comes out"
option, but I think that's called a mailing list.)

@_date: 2011-02-10 17:51:18
@_author: Roger Dingledine 
@_subject: Feedback and Suspicions about Tor... 
You may like:
(available via (available via (available via as for "and do it", it's proving to be a bit more complex than that.
Yeah, that hasn't been true for years.
but Karsten sure has been procrastinating about merging in proposal
114 to the rend-spec.txt file.
Hope that helps,
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-02-10 18:34:43
@_author: Roger Dingledine 
@_subject: advice on using accounting... 
Sounds reasonable.
Your node *is* down. That's what hibernation does. As soon as it goes into
'soft' hibernation, it closes its external ports. Next time the directory
authorities test it for reachability, they will find that it is gone.
That said, the authorities should be accepting your new descriptor,
because it _is_ much different from the previous one. The "hibernating
1" line makes it different. It also means that they won't wait until
they've tried several reachability tests to mark you as not running,
since you published an explicit "I'm hibernating" descriptor.
Tor weather's behavior here may need some improvement. I haven't had time
to look at how they determine whether you're hibernating vs down. It's
quite possible they made some wrong assumptions when building that part.
As for whether they're "not stable" by definition, the definition is that
you have to be in the top half of nodes by mean-time-between-failure. So
if many nodes have this behavior, some of them will end up with the stable
flag. If few nodes do, probably none of them will get the stable flag.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-02-12 00:51:16
@_author: Roger Dingledine 
@_subject: Problem with downloading attachments in torbrowser for osx 
Have you tried using Save-As instead?
I believe the trouble is that Firefox doesn't make it easy for extensions
to tell if the website is trying to get you to run an external application
vs just trying to give you a file to download.
But I'll turn the question around on you: which trac entry on
did you report your issue on? If it's not on the bugtracker it's nowhere.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-02-02 00:51:36
@_author: Roger Dingledine 
@_subject: Exit nodes in torrc question 
We have no clear plan about what we should do in these cases. Every user
seems to want some specific behavior and be shocked that we don't do it
the way they would want it. The result is that different Tor versions
over the years do it different ways, just confusing people more. :/
ExitNodes is a global directive, but with the .exit notation I would say
you specified that you wanted to overrule that global directive for that
stream. Seems like plausible behavior to me. In any case, it has nothing
to do with the order of the lines in your torrc.
See also which thankfully (assuming you're running Tor 0.2.2.7-alpha or later)
is now mainly a problem with assumptions about what Tor should do when
you specify ExcludeNodes or ExcludeExitNodes.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-02-05 20:51:38
@_author: Roger Dingledine 
@_subject: What to gain by adding a custom port on a hidden service 
Not much at all, as far as I can tell.
Maybe they're doing it to prevent people who try to index .onion addresses
from finding their service. But that's not a very compelling example,
because if you learn about the port when you learn about the .onion
address, the gig is up.
My guess would be that they're running the service locally on port 8080,
and they didn't realize that they could get their Tor to map the "virtual"
port 80 onto the "bound" port 8080.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-12 21:01:34
@_author: Roger Dingledine 
@_subject: geeez... 
I assume he meant the latter -- there are many ways that people can
reach your website and have their IP address not really linked to the
human making the connection.
This is related to the "if you remove Tor from the world, you're not
really reducing the ability of bad guys to be anonymous on the Internet"
idea. See also my first entry at By making your decisions based on the application-level content rather
than the routing of the packets. If you have a forum, and it has jerks,
then you need to learn about accounts and authentication. If it stays
bad, you need to learn about reputation, or moderation, or various other
techniques people have developed over the years to deal with abuse.
It depends where your jerks are coming from. If your jerks are all obeying
every law and showing up from their static non-natted IP address, then
yes, routing address is definitely related to identity. But if your
jerks have ever noticed this doesn't work so well for them, they may
start using other approaches and suddenly you're back needing to learn
about application-level mechanisms (or you're back being angry at the
Internet for not giving you identification by IP address; if blocking
by IP address is the only abuse prevention mechanism you've got, you're
going to spend a lot of your life angry).
For more on this topic, I'd point you to a short article a few years
ago by Goodell and Syverson called "The Right Place at the Right Time:
Examining the Use of Network Location in Authentication and Abuse
Prevention" -- but in going to hunt for it I can't find it available
online anymore. Proprietary publishers suck I guess. :(
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-12 21:25:51
@_author: Roger Dingledine 
@_subject: geeez... 
Here it is: go to
and then click on the link to a site in Egypt. :/
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-12 22:28:45
@_author: Roger Dingledine 
@_subject: System time in anonymity oriented LiveCDs 
Whether this is a good idea depends on where you got the consensus. If you
connect to a Tor directory mirror and it hands you a consensus from last
month, and you set your clock based on it, then you've opened yourself
up to exactly the attack that Tor is trying to defend against.
If your Tor fetches its consensus from a directory authority, you're
in better shape, insofar as the directory authorities are probably not
your adversaries.
Relays do these directory fetches in the clear, though, due to an
earlier bug: so we're back to the authentication and integrity question there. Clients
set up a TLS connection first and tunnel their directory fetches over it,
so they're in slightly better shape. Do your LiveCD users always have
both ORPort set to 0?
The better answer is for Tor clients to read the time out of the NETINFO
cells that are part of the v2 connection handshake we added in Tor
0.2.0.x. See section 4.2 of tor-spec.txt:
Using the data in NETINFO cells has been sitting on the todo list for
a while:
but nobody's moved it forward. Perhaps somebody wants to pick this up
and do it? :)
Also, ideally you want to get an opinion from more than one directory
authority. One design that I could imagine would be to, if we find a
directory mirror or entry guard whose time disagrees with us, connect
to a directory authority to get a stronger opinion. If the directory
authority also disagrees, connect to a threshold of directory authorities
and then memorize our relative clock skew based on the majority vote.
Potential complications include "what threshold should you require" and
"what if you can't reach the directory authorities directly because you're
in a censored area". Maybe in the latter case you should just believe
your bridge's clock, because it's the one giving you the directory
information anyway -- depends if the user wants her Tor to fail open
(reachability) or fail closed (safety).
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-18 22:11:57
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.21-alpha is out (security patches) 
Tor 0.2.2.21-alpha includes all the patches from Tor 0.2.1.29, which
continues our recent code security audit work. The main fix resolves
a remote heap overflow vulnerability that can allow remote code
execution (CVE-2011-0427). Other fixes address a variety of assert
and crash bugs, most of which we think are hard to exploit remotely.
All Tor users should upgrade.
Changes in version 0.2.2.21-alpha - 2011-01-15
  o Major bugfixes (security), also included in 0.2.1.29:
    - Fix a heap overflow bug where an adversary could cause heap
      corruption. This bug probably allows remote code execution
      attacks. Reported by "debuger". Fixes CVE-2011-0427. Bugfix on
      0.1.2.10-rc.
    - Prevent a denial-of-service attack by disallowing any
      zlib-compressed data whose compression factor is implausibly
      high. Fixes part of bug 2324; reported by "doorss".
    - Zero out a few more keys in memory before freeing them. Fixes
      bug 2384 and part of bug 2385. These key instances found by
      "cypherpunks", based on Andrew Case's report about being able
      to find sensitive data in Tor's memory space if you have enough
      permissions. Bugfix on 0.0.2pre9.
  o Major bugfixes (crashes), also included in 0.2.1.29:
    - Prevent calls to Libevent from inside Libevent log handlers.
      This had potential to cause a nasty set of crashes, especially
      if running Libevent with debug logging enabled, and running
      Tor with a controller watching for low-severity log messages.
      Bugfix on 0.1.0.2-rc. Fixes bug 2190.
    - Add a check for SIZE_T_MAX to tor_realloc() to try to avoid
      underflow errors there too. Fixes the other part of bug 2324.
    - Fix a bug where we would assert if we ever had a
      cached-descriptors.new file (or another file read directly into
      memory) of exactly SIZE_T_CEILING bytes. Fixes bug 2326; bugfix
      on 0.2.1.25. Found by doorss.
    - Fix some potential asserts and parsing issues with grossly
      malformed router caches. Fixes bug 2352; bugfix on Tor 0.2.1.27.
      Found by doorss.
  o Minor bugfixes (other), also included in 0.2.1.29:
    - Fix a bug with handling misformed replies to reverse DNS lookup
      requests in DNSPort. Bugfix on Tor 0.2.0.1-alpha. Related to a
      bug reported by doorss.
    - Fix compilation on mingw when a pthreads compatibility library
      has been installed. (We don't want to use it, so we shouldn't
      be including pthread.h.) Fixes bug 2313; bugfix on 0.1.0.1-rc.
    - Fix a bug where we would declare that we had run out of virtual
      addresses when the address space was only half-exhausted. Bugfix
      on 0.1.2.1-alpha.
    - Correctly handle the case where AutomapHostsOnResolve is set but
      no virtual addresses are available. Fixes bug 2328; bugfix on
      0.1.2.1-alpha. Bug found by doorss.
    - Correctly handle wrapping around when we run out of virtual
      address space. Found by cypherpunks; bugfix on 0.2.0.5-alpha.
  o Minor features, also included in 0.2.1.29:
    - Update to the January 1 2011 Maxmind GeoLite Country database.
    - Introduce output size checks on all of our decryption functions.
  o Build changes, also included in 0.2.1.29:
    - Tor does not build packages correctly with Automake 1.6 and earlier;
      added a check to Makefile.am to make sure that we're building with
      Automake 1.7 or later.
    - The 0.2.1.28 tarball was missing src/common/OpenBSD_malloc_Linux.c
      because we built it with a too-old version of automake. Thus that
      release broke ./configure --enable-openbsd-malloc, which is popular
      among really fast exit relays on Linux.
  o Major bugfixes, new in 0.2.2.21-alpha:
    - Prevent crash/heap corruption when the cbtnummodes consensus
      parameter is set to 0 or large values. Fixes bug 2317; bugfix
      on 0.2.2.14-alpha.
  o Major features, new in 0.2.2.21-alpha:
    - Introduce minimum/maximum values that clients will believe
      from the consensus. Now we'll have a better chance to avoid crashes
      or worse when a consensus param has a weird value.
  o Minor features, new in 0.2.2.21-alpha:
    - Make sure to disable DirPort if running as a bridge. DirPorts aren't
      used on bridges, and it makes bridge scanning somewhat easier.
    - If writing the state file to disk fails, wait up to an hour before
      retrying again, rather than trying again each second. Fixes bug
      2346; bugfix on Tor 0.1.1.3-alpha.
    - Make Libevent log messages get delivered to controllers later,
      and not from inside the Libevent log handler. This prevents unsafe
      reentrant Libevent calls while still letting the log messages
      get through.
    - Detect platforms that brokenly use a signed size_t, and refuse to
      build there. Found and analyzed by doorss and rransom.
    - Fix a bunch of compile warnings revealed by mingw with gcc 4.5.
      Resolves bug 2314.
  o Minor bugfixes, new in 0.2.2.21-alpha:
    - Handle SOCKS messages longer than 128 bytes long correctly, rather
      than waiting forever for them to finish. Fixes bug 2330; bugfix
      on 0.2.0.16-alpha. Found by doorss.
    - Add assertions to check for overflow in arguments to
      base32_encode() and base32_decode(); fix a signed-unsigned
      comparison there too. These bugs are not actually reachable in Tor,
      but it's good to prevent future errors too. Found by doorss.
    - Correctly detect failures to create DNS requests when using Libevent
      versions before v2. (Before Libevent 2, we used our own evdns
      implementation. Its return values for Libevent's evdns_resolve_*()
      functions are not consistent with those from Libevent.) Fixes bug
      2363; bugfix on 0.2.2.6-alpha. Found by "lodger".
  o Documentation, new in 0.2.2.21-alpha:
    - Document the default socks host and port (127.0.0.1:9050) for
      tor-resolve.

@_date: 2011-01-22 17:28:27
@_author: Roger Dingledine 
@_subject: understanding problem, hidden services 
Whenever Alice chooses the node that Alice and Bob will use to interact,
Alice uses that node as her third hop in a three hop circuit. Whenever
*Bob* chooses it, Alice builds a three hop path of her own and then uses
Bob's choice as the fourth hop.
So in the above case, it will be the former situation:
Alice -> OR1 -> OR2 -> Rendezvous point.
In this case, Alice didn't pick the Intro point. Alice wants three hops
that she chose, so it will be Alice -> OR1 -> OR2 -> OR3 -> Intro.
Whereas Bob wants three hops that he chose, so his side will be
Bob -> ORa -> ORb -> Intro.
Bob didn't pick the rendezvous point, so he wants three hops of his own
plus the rendezvous point.
Can somebody write a patch for rend-spec.txt to clarify?
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-04 08:14:36
@_author: Roger Dingledine 
@_subject: The Skype begin refusing payments making on their site through 
You're missing the diversity of adversaries that various Tor users might
care about.
For example, imagine you're using Tor to prevent a local observer (e.g.
your government-owned ISP) from discovering that you're going to Skype's
payment page.
More generally, there are people who use Tor to ssh to a server somewhere

@_date: 2011-01-04 08:16:38
@_author: Roger Dingledine 
@_subject: Tor uses swap? 
Could be. The Tor Browser Bundle for Linux is just an ordinary
application. It doesn't control your swap either way. You don't start
it as root, so it can't.
I'd suggest that you should be using encrypted swap by default. Everybody
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-30 02:00:26
@_author: Roger Dingledine 
@_subject: Tor 0.2.2.22-alpha is out 
Tor 0.2.2.22-alpha fixes a few more less-critical security issues. The
main other change is a slight tweak to Tor's TLS handshake that makes
relays and bridges that run this new version reachable from Iran again.
We don't expect this tweak will win the arms race long-term, but it will
buy us a bit more time until we roll out a better solution.
Anybody running a relay or bridge who wants it to work for Iran should
Changes in version 0.2.2.22-alpha - 2011-01-25
  o Major bugfixes:
    - Fix a bounds-checking error that could allow an attacker to
      remotely crash a directory authority. Bugfix on 0.2.1.5-alpha.
      Found by "piebeer".
    - Don't assert when changing from bridge to relay or vice versa
      via the controller. The assert happened because we didn't properly
      initialize our keys in this case. Bugfix on 0.2.2.18-alpha; fixes
      bug 2433. Reported by bastik.
  o Minor features:
    - Adjust our TLS Diffie-Hellman parameters to match those used by
      Apache's mod_ssl.
    - Provide a log message stating which geoip file we're parsing
      instead of just stating that we're parsing the geoip file.
      Implements ticket 2432.
  o Minor bugfixes:
    - Check for and reject overly long directory certificates and
      directory tokens before they have a chance to hit any assertions.
      Bugfix on 0.2.1.28 / 0.2.2.20-alpha. Found by "doorss".

@_date: 2011-07-10 13:15:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.30-rc is out 
Tor 0.2.2.30-rc is the first release candidate for the Tor 0.2.2.x
series. It fixes a few smaller bugs, but generally appears stable.
Please test it and let us know whether it is!
Packages will appear on the download page in the coming days.
Changes in version 0.2.2.30-rc - 2011-07-07
  o Minor bugfixes:
    - Send a SUCCEEDED stream event to the controller when a reverse
      resolve succeeded. Fixes bug 3536; bugfix on 0.0.8pre1. Issue
      discovered by katmagic.
    - Always NUL-terminate the sun_path field of a sockaddr_un before
      passing it to the kernel. (Not a security issue: kernels are
      smart enough to reject bad sockaddr_uns.) Found by Coverity;
      CID  Bugfix on Tor 0.2.0.3-alpha.
    - Don't stack-allocate the list of supplementary GIDs when we're
      about to log them. Stack-allocating NGROUPS_MAX gid_t elements
      could take up to 256K, which is way too much stack. Found by
      Coverity; CID  Bugfix on 0.2.1.7-alpha.
    - Add BUILDTIMEOUT_SET to the list returned by the 'GETINFO
      events/names' control-port command. Bugfix on 0.2.2.9-alpha;
      fixes part of bug 3465.
    - Fix a memory leak when receiving a descriptor for a hidden
      service we didn't ask for. Found by Coverity; CID  Bugfix
      on 0.2.2.26-beta.
  o Minor features:
    - Update to the July 1 2011 Maxmind GeoLite Country database.

@_date: 2011-07-10 13:20:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia documentation 
You might also like
What documentation did you have in mind?

@_date: 2011-07-12 19:53:50
@_author: Roger Dingledine 
@_subject: [tor-talk] tor-0.2.2.30rc, torrc, ExitNodes, 
No, they should work fine.
StrictExitNodes is no longer needed in the Tor 0.2.2.x series (you can
think of it as being automatically on).

@_date: 2011-07-19 03:22:07
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.2-alpha is out 
Tor 0.2.3.2-alpha introduces two new experimental features:
microdescriptors and pluggable transports. It also continues cleaning
up a variety of recently introduced features.
I'm not sure yet what our plan is for packages -- until the 0.2.2 tree
becomes the new stable, it doesn't seem wise to try to squeeze three
different versions onto the download page.
Changes in version 0.2.3.2-alpha - 2011-07-18
  o Major features:
    - Clients can now use microdescriptors instead of regular descriptors
      to build circuits. Microdescriptors are authority-generated
      summaries of regular descriptors' contents, designed to change
      very rarely (see proposal 158 for details). This feature is
      designed to save bandwidth, especially for clients on slow internet
      connections. It's off by default for now, since nearly no caches
      support it, but it will be on-by-default for clients in a future
      version. You can use the UseMicrodescriptors option to turn it on.
    - Tor clients using bridges can now be configured to use a separate
      'transport' proxy for each bridge. This approach helps to resist
      censorship by allowing bridges to use protocol obfuscation
      plugins. It implements part of proposal 180. Implements ticket 2841.
    - While we're trying to bootstrap, record how many TLS connections
      fail in each state, and report which states saw the most failures
      in response to any bootstrap failures. This feature may speed up
      diagnosis of censorship events. Implements ticket 3116.
  o Major bugfixes (on 0.2.3.1-alpha):
    - When configuring a large set of nodes in EntryNodes (as with
      'EntryNodes {cc}' or 'EntryNodes 1.1.1.1/16'), choose only a
      random subset to be guards, and choose them in random
      order. Fixes bug 2798.
    - Tor could crash when remembering a consensus in a non-used consensus
      flavor without having a current consensus set. Fixes bug 3361.
    - Comparing an unknown address to a microdescriptor's shortened exit
      policy would always give a "rejected" result. Fixes bug 3599.
    - Using microdescriptors as a client no longer prevents Tor from
      uploading and downloading hidden service descriptors. Fixes
      bug 3601.
  o Minor features:
    - Allow nameservers with IPv6 address. Resolves bug 2574.
    - Accept attempts to include a password authenticator in the
      handshake, as supported by SOCKS5. This handles SOCKS clients that
      don't know how to omit a password when authenticating. Resolves
      bug 1666.
    - When configuring a large set of nodes in EntryNodes, and there are
      enough of them listed as Guard so that we don't need to consider
      the non-guard entries, prefer the ones listed with the Guard flag.
    - Check for and recover from inconsistency in the microdescriptor
      cache. This will make it harder for us to accidentally free a
      microdescriptor without removing it from the appropriate data
      structures. Fixes issue 3135; issue noted by "wanoskarnet".
    - Log SSL state transitions at log level DEBUG, log domain
      HANDSHAKE. This can be useful for debugging censorship events.
      Implements ticket 3264.
    - Add port 6523 (Gobby) to LongLivedPorts. Patch by intrigeri;
      implements ticket 3439.
  o Minor bugfixes (on 0.2.3.1-alpha):
    - Do not free all general-purpose regular descriptors just
      because microdescriptor use is enabled. Fixes bug 3113.
    - Correctly link libevent_openssl when --enable-static-libevent
      is passed to configure. Fixes bug 3118.
    - Bridges should not complain during their heartbeat log messages that
      they are unlisted in the consensus: that's more or less the point
      of being a bridge. Fixes bug 3183.
    - Report a SIGNAL event to controllers when acting on a delayed
      SIGNAL NEWNYM command. Previously, we would report a SIGNAL
      event to the controller if we acted on a SIGNAL NEWNYM command
      immediately, and otherwise not report a SIGNAL event for the
      command at all. Fixes bug 3349.
    - Fix a crash when handling the SIGNAL controller command or
      reporting ERR-level status events with bufferevents enabled. Found
      by Robert Ransom. Fixes bug 3367.
    - Always ship the tor-fw-helper manpage in our release tarballs.
      Fixes bug 3389. Reported by Stephen Walker.
    - Fix a class of double-mark-for-close bugs when bufferevents
      are enabled. Fixes bug 3403.
    - Update tor-fw-helper to support libnatpmp-20110618. Fixes bug 3434.
    - Add SIGNAL to the list returned by the 'GETINFO events/names'
      control-port command. Fixes part of bug 3465.
    - Prevent using negative indices during unit test runs when read_all()
      fails. Spotted by coverity.
    - Fix a rare memory leak when checking the nodelist without it being
      present. Found by coverity.
    - Only try to download a microdescriptor-flavored consensus from
      a directory cache that provides them.
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Assert that hidden-service-related operations are not performed
      using single-hop circuits. Previously, Tor would assert that
      client-side streams are not attached to single-hop circuits,
      but not that other sensitive operations on the client and service
      side are not performed using single-hop circuits. Fixes bug 3332;
      bugfix on 0.0.6.
    - Don't publish a new relay descriptor when we reload our onion key,
      unless the onion key has actually changed. Fixes bug 3263 and
      resolves another cause of bug 1810. Bugfix on 0.1.1.11-alpha.
    - Allow GETINFO fingerprint to return a fingerprint even when
      we have not yet built a router descriptor. Fixes bug 3577;
      bugfix on 0.2.0.1-alpha.
    - Make 'tor --digests' list hashes of all Tor source files. Bugfix
      on 0.2.2.4-alpha; fixes bug 3427.
  o Code simplification and refactoring:
    - Use tor_sscanf() in place of scanf() in more places through the
      code. This makes us a little more locale-independent, and
      should help shut up code-analysis tools that can't tell
      a safe sscanf string from a dangerous one.
    - Use tt_assert(), not tor_assert(), for checking for test failures.
      This makes the unit tests more able to go on in the event that
      one of them fails.
    - Split connection_about_to_close() into separate functions for each
      connection type.
  o Build changes:
    - On Windows, we now define the _WIN32_WINNT macros only if they
      are not already defined. This lets the person building Tor decide,
      if they want, to require a later version of Windows.

@_date: 2011-07-22 00:16:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.2-alpha is out 
What you describe is plausible. If you want to get more confidence, you
could rm -rf ~/.tor/cached-* so your Tor client has to fetch everything
from scratch.
The "we now have enough" line shows up once Tor has at least 1/4 of
the descriptors (or in this case microdescriptors) that it knows it
wants. So it makes sense that it takes a while after that point to a)
fetch the rest of them, and b) build a circuit.
Note that the main benefit you'll see from microdescriptors is in reduced
directory overhead *after* initial bootstrap -- because microdescriptors
don't change as often as normal descriptors so you can keep them cached
for a week. They don't help so much with the initial bootstrapping cost.

@_date: 2011-07-30 23:15:23
@_author: Roger Dingledine 
@_subject: [tor-talk] Proxy Use 101 
It uses the http proxy if it's set and you've attempted an http
connection. If it's not set and you've attempted an http connection,
it falls back to the socks proxy.
If you're doing a non-http connection, it ignores your http proxy.
In the old model where you should use polipo, you would set your http
proxy to point to polipo and your socks proxy to point to tor. In the
new model where polipo isn't needed anymore, you should simply set your
socks proxy to point to tor.
In any case, even if you use polipo, you should set your socks proxy so
you will capture protocols that aren't even configurable on the proxy
config page.
Hope that helps,

@_date: 2011-06-02 22:59:13
@_author: Roger Dingledine 
@_subject: [tor-talk] ReachableAddresses *:* harmful? 
If you've configured your Tor client to use bridges, then you probably
want to allow it to reach all the bridges you've configured.
In that case "reachableaddresses *:*" is the right choice. In fact,
that's even the default. It shouldn't hurt anything in any case.
You should only change reachableaddresses if your local Internet
connection is firewalled by your ISP in terms of what destinations you
can reach.

@_date: 2011-06-05 01:43:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.28-beta is out 
Tor 0.2.2.28-beta makes great progress towards a new stable release: we
fixed a big bug in whether relays stay in the consensus consistently,
we moved closer to handling bridges and hidden services correctly,
and we started the process of better handling the dreaded "my Vidalia
died, and now my Tor demands a password when I try to reconnect to it"
usability issue.
Packages will appear on the download page in the coming days.
Changes in version 0.2.2.28-beta - 2011-06-04
  o Major bugfixes:
    - Don't decide to make a new descriptor when receiving a HUP signal.
      This bug has caused a lot of 0.2.2.x relays to disappear from the
      consensus periodically. Fixes the most common case of triggering
      bug 1810; bugfix on 0.2.2.7-alpha.
    - Actually allow nameservers with IPv6 addresses. Fixes bug 2574.
    - Don't try to build descriptors if "ORPort auto" is set and we
      don't know our actual ORPort yet. Fix for bug 3216; bugfix on
      0.2.2.26-beta.
    - Resolve a crash that occurred when setting BridgeRelay to 1 with
      accounting enabled. Fixes bug 3228; bugfix on 0.2.2.18-alpha.
    - Apply circuit timeouts to opened hidden-service-related circuits
      based on the correct start time. Previously, we would apply the
      circuit build timeout based on time since the circuit's creation;
      it was supposed to be applied based on time since the circuit
      entered its current state. Bugfix on 0.0.6; fixes part of bug 1297.
    - Use the same circuit timeout for client-side introduction
      circuits as for other four-hop circuits, rather than the timeout
      for single-hop directory-fetch circuits; the shorter timeout may
      have been appropriate with the static circuit build timeout in
      0.2.1.x and earlier, but caused many hidden service access attempts
      to fail with the adaptive CBT introduced in 0.2.2.2-alpha. Bugfix
      on 0.2.2.2-alpha; fixes another part of bug 1297.
    - In ticket 2511 we fixed a case where you could use an unconfigured
      bridge if you had configured it as a bridge the last time you ran
      Tor. Now fix another edge case: if you had configured it as a bridge
      but then switched to a different bridge via the controller, you
      would still be willing to use the old one. Bugfix on 0.2.0.1-alpha;
      fixes bug 3321.
  o Major features:
    - Add an __OwningControllerProcess configuration option and a
      TAKEOWNERSHIP control-port command. Now a Tor controller can ensure
      that when it exits, Tor will shut down. Implements feature 3049.
    - If "UseBridges 1" is set and no bridges are configured, Tor will
      now refuse to build any circuits until some bridges are set.
      If "UseBridges auto" is set, Tor will use bridges if they are
      configured and we are not running as a server, but otherwise will
      make circuits as usual. The new default is "auto". Patch by anonym,
      so the Tails LiveCD can stop automatically revealing you as a Tor
      user on startup.
  o Minor bugfixes:
    - Fix warnings from GCC 4.6's "-Wunused-but-set-variable" option.
    - Remove a trailing asterisk from "exit-policy/default" in the
      output of the control port command "GETINFO info/names". Bugfix
      on 0.1.2.5-alpha.
    - Use a wide type to hold sockets when built for 64-bit Windows builds.
      Fixes bug 3270.
    - Warn when the user configures two HiddenServiceDir lines that point
      to the same directory. Bugfix on 0.0.6 (the version introducing
      HiddenServiceDir); fixes bug 3289.
    - Remove dead code from rend_cache_lookup_v2_desc_as_dir. Fixes
      part of bug 2748; bugfix on 0.2.0.10-alpha.
    - Log malformed requests for rendezvous descriptors as protocol
      warnings, not warnings. Also, use a more informative log message
      in case someone sees it at log level warning without prior
      info-level messages. Fixes the other part of bug 2748; bugfix
      on 0.2.0.10-alpha.
    - Clear the table recording the time of the last request for each
      hidden service descriptor from each HS directory on SIGNAL NEWNYM.
      Previously, we would clear our HS descriptor cache on SIGNAL
      NEWNYM, but if we had previously retrieved a descriptor (or tried
      to) from every directory responsible for it, we would refuse to
      fetch it again for up to 15 minutes. Bugfix on 0.2.2.25-alpha;
      fixes bug 3309.
    - Fix a log message that said "bits" while displaying a value in
      bytes. Found by wanoskarnet. Fixes bug 3318; bugfix on
      0.2.0.1-alpha.
    - When checking for 1024-bit keys, check for 1024 bits, not 128
      bytes. This allows Tor to correctly discard keys of length 1017
      through 1023. Bugfix on 0.0.9pre5.
  o Minor features:
    - Relays now log the reason for publishing a new relay descriptor,
      so we have a better chance of hunting down instances of bug 1810.
      Resolves ticket 3252.
    - Revise most log messages that refer to nodes by nickname to
      instead use the "$key=nickname at address" format. This should be
      more useful, especially since nicknames are less and less likely
      to be unique. Resolves ticket 3045.
    - Log (at info level) when purging pieces of hidden-service-client
      state because of SIGNAL NEWNYM.
  o Removed options:
    - Remove undocumented option "-F" from tor-resolve: it hasn't done
      anything since 0.2.1.16-rc.

@_date: 2011-06-09 12:36:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Identifying use of relay as an Entry node 
You can look at the identity key that the connection presents -- if it's
a relay, it will present its identity key, even if it's coming from a
different IP address than is in its descriptor.
But I didn't understand the original question. Are you asking if relays
can enumerate the clients that use them for their first hop? If so, yes.
See also point f on

@_date: 2011-06-14 22:41:36
@_author: Roger Dingledine 
@_subject: [tor-talk] When to use and not to use tor. 
Which ones are 'your' users (so I can figure out how to help better)?
What frustrates me is that Firefox *has* that warning enabled at first,
and everybody knows to just click it away. You'll have to make your
browser popup windows dire indeed before users will even notice you're
trying to get their attention.
The challenge is that good advice differs from user to user. It depends
on your situation, what you're worried about ("what your threat model
is"), what's at risk, what online activities you need to do, etc. When
Tor does trainings for activists in dangerous countries, the conversation
always starts out the same but it never ends up in the same place.
All that said, I agree that it would be nice to have things spelled out
in more detail for the users who need that. There are a lot of handbooks
out there named things like "security in a box" that aim to explain
it all -- not just Tor but disk encryption, anti-virus, etc etc -- and
they're always forced to make tradeoffs and leave out important topics.
And they even have a specific type of user in mind when they start.
That said, here are some specific answers:
Agreed in general, but not for the reason you might think: a lot of
banks these days freak out when you log in from a foreign country, and
end up locking your account until you go through a little dance. So it
is because of poorly tuned anti-fraud algorithms that you may not want
to use Tor to connect to your bank.
That said, I used Tor when logging into my bank account on the Defcon
wireless network. So it depends on your context and what you're worried
Don't use the Internet for non encrypted email. It's a bad idea no matter
where you are -- Starbucks, your cablemodem at home which your neighbors
can sniff, the Tor network, anywhere.

@_date: 2011-06-15 15:24:50
@_author: Roger Dingledine 
@_subject: [tor-talk] announcing releases 
That's where we announce new stable releases. We haven't made a new
stable release since 0.2.1.30 in February of 2011.
We also use it for security advisories. Last I checked the list had >10k
people on it, so I don't want to spam them too much. The current goal
is that every mail to the list is something every list member should read.

@_date: 2011-06-16 12:13:24
@_author: Roger Dingledine 
@_subject: [tor-talk] check.torproject.org isn't working properly? 
That means you're probably an exit relay. The problem here is that
check.torproject.org looks at the IP address you're coming from to guess
whether you're using Tor. You're coming from the IP address of a Tor
exit relay, so it figures the odds are good that you're using Tor.
In this case it's a false positive, because "you" aren't using Tor even
though "you" are running Tor.
Sounds like you didn't configure it right. See
 for some hints.
Right. This is the false positive I explained above.
If it could look at your browser settings, yes. All it can do is look
at the IP address you're coming from though.
Right -- that's your main hint. We currently assume that people running
an exit relay will figure it out. That's not a great assumption as we
get a more diverse set of relay operators though.
Sounds good. That's why we made the TBB. :)
Hope that helps,

@_date: 2011-06-18 18:15:12
@_author: Roger Dingledine 
@_subject: [tor-talk] ControlPort "read-only" access? 
Not currently. I would be happy to have a feature like this, if somebody
wanted to design and write it.
I fear there may be some parts of the control protocol where it's not
immediately clear what permissions a "read-only" user should have. So it
may be more work than we think. Or it may not.

@_date: 2011-06-20 20:23:46
@_author: Roger Dingledine 
@_subject: [tor-talk] How to choose to get connected to a specific relay? 
When your browser connects to the webserver, it sends an http "Host:"
header to specify which virtual host (domain) it wanted the webserver
to give it. It chooses this virthost based on the address you typed into
your browser. So in this case your browser sends
Host: torproject.org.6297b13a687b521a59c6bd79188a2501ec03a065.exit
and the poor webserver is left to guess which virthost you had in mind,
because it hasn't been configured to handle that virthost.
Looks like the apache config for  defaults to giving
you the virthost you expected, and the apache config for torproject.org
defaults to giving you a virthost you didn't expect.
Privoxy has a config option;
  +client-header-filter{hide-tor-exit-notation}
that looks through all your Host: headers and strips "foo.exit" from them.
We could imagine teaching Torbutton to do that too.
But the real answer is that you are seeing just how much of a hack the
dot-exit notation was. :) I say was because it's deprecated in 0.2.2
and later.
Hope that helps,

@_date: 2011-06-21 02:38:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.29-beta is out 
Tor 0.2.2.29-beta reverts an accidental behavior change for users who
have bridge lines in their torrc but don't want to use them; gets
us closer to having the control socket feature working on Debian;
and fixes a variety of smaller bugs.
Packages will appear on the download page in the coming days.
(We didn't make packages for the previous beta release, because we didn't
want to harm users who would be bitten by bug 3354.)
Changes in version 0.2.2.29-beta - 2011-06-20
  o Major bugfixes:
    - Revert the UseBridges option to its behavior before 0.2.2.28-beta.
      When we changed the default behavior to "use bridges if any
      are listed in the torrc", we surprised users who had bridges
      in their torrc files but who didn't actually want to use them.
      Partial resolution for bug 3354.
  o Privacy fixes:
    - Don't attach new streams to old rendezvous circuits after SIGNAL
      NEWNYM. Previously, we would keep using an existing rendezvous
      circuit if it remained open (i.e. if it were kept open by a
      long-lived stream, or if a new stream were attached to it before
      Tor could notice that it was old and no longer in use). Bugfix on
      0.1.1.15-rc; fixes bug 3375.
  o Minor bugfixes:
    - Fix a bug when using ControlSocketsGroupWritable with User. The
      directory's group would be checked against the current group, not
      the configured group. Patch by J?r?my Bobbio. Fixes bug 3393;
      bugfix on 0.2.2.26-beta.
    - Make connection_printf_to_buf()'s behaviour sane. Its callers
      expect it to emit a CRLF iff the format string ends with CRLF;
      it actually emitted a CRLF iff (a) the format string ended with
      CRLF or (b) the resulting string was over 1023 characters long or
      (c) the format string did not end with CRLF *and* the resulting
      string was 1021 characters long or longer. Bugfix on 0.1.1.9-alpha;
      fixes part of bug 3407.
    - Make send_control_event_impl()'s behaviour sane. Its callers
      expect it to always emit a CRLF at the end of the string; it
      might have emitted extra control characters as well. Bugfix on
      0.1.1.9-alpha; fixes another part of bug 3407.
    - Make crypto_rand_int() check the value of its input correctly.
      Previously, it accepted values up to UINT_MAX, but could return a
      negative number if given a value above INT_MAX+1. Found by George
      Kadianakis. Fixes bug 3306; bugfix on 0.2.2pre14.
    - Avoid a segfault when reading a malformed circuit build state
      with more than INT_MAX entries. Found by wanoskarnet. Bugfix on
      0.2.2.4-alpha.
    - When asked about a DNS record type we don't support via a
      client DNSPort, reply with NOTIMPL rather than an empty
      reply. Patch by intrigeri. Fixes bug 3369; bugfix on 2.0.1-alpha.
    - Fix a rare memory leak during stats writing. Found by coverity.
  o Minor features:
    - Update to the June 1 2011 Maxmind GeoLite Country database.
  o Code simplifications and refactoring:
    - Remove some dead code as indicated by coverity.
    - Remove a few dead assignments during router parsing. Found by
      coverity.
    - Add some forgotten return value checks during unit tests. Found
      by coverity.
    - Don't use 1-bit wide signed bit fields. Found by coverity.

@_date: 2011-06-21 17:45:28
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.29-beta is out 
0.2.1.x is currently the stable branch, and 0.2.2.x is currently the
development branch. You can distinguish because 0.2.2.29-beta has a tag
("-beta") at the end.
Quoting from  :
"There are two versions of each package, a stable and alpha
release. Stable packages are released when we believe the features and
code will not change for many months. Alpha or unstable packages are
released so you can help us test new features and bugfixes. Even though
they have a higher version number than the stable versions listed above,
there is a much higher chance of serious reliability and security bugs
in these downloads. Please be prepared to report bugs."
You can switch to the development branch for your debs:

@_date: 2011-03-08 14:26:35
@_author: Roger Dingledine 
@_subject: [tor-talk] can't get tor to work :( 
There was indeed a directory authority outage, but it's unclear whether
the original bug report here is related to the outage.
When all directory authorities are down, new Tor clients can't bootstrap
if they don't have cached directory information from earlier that day. But
Tor clients that are already up and have directory information are all
set for about 24 hours. At that point, if the directory authorities
still haven't produced any new consensus about the network, things go bad.
Fortunately, in this case things didn't come to that.
We don't believe directory information that's too old, to protect clients
from attackers who choose their favorite consensus from the past year and
give that to their target client, either to skew their path selection
onto relays that the attacker controls, or to make the client build
paths in a distinguishable way from all the other clients. See
for a variation on this issue.
The reason I say it's unclear whether the original bug report is related
is that a Tor bridge should have been able to bootstrap the user the
whole time. Most Tor clients probably didn't notice any disruption.
For those wondering about the role of the directory authorities, see e.g.
The bug in this case was that we had implemented partial IPv6 support
for Tor but hadn't implemented it in a consistent way. So when somebody
tried adding the experimental IPv6 support to his exit policy, the
directory authorities triggered an assert. We figured out the problem,
created a patch, and got a threshold of directory authorities to upgrade,
in about 8 hours. Plenty of time to spare. ;)
Mike opened this trac ticket afterwards so we can adapt our process for
handling these situations:

@_date: 2011-03-09 14:30:28
@_author: Roger Dingledine 
@_subject: [tor-talk] torrc consistency 
See the discussion at
The "right" way to read or write the torrc file is to ask Tor to do it
for you, via the controller interface. Then you never have to care about
the format questions.
But that said, Tor blows away user-written comments when it does a
'saveconf'. So that answer doesn't address your questions either.
Which users did you have in mind as your target audience?

@_date: 2011-03-10 20:08:48
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.23-alpha is out 
Tor 0.2.2.23-alpha lets relays record their bandwidth history so when
they restart they don't lose their bandwidth capacity estimate. This
release also fixes a diverse set of user-facing bugs, ranging from
relays overrunning their rate limiting to clients falsely warning about
clock skew to bridge descriptor leaks by our bridge directory authority.
Nick Mathewson will be taking over development releases soon. Expect
future announcements and signatures from him -- his GPG key fingerprint is
pub   3072R/165733EA 2004-07-03
      Key fingerprint = B35B F85B F194 89D0 4E28  C33C 2119 4EBB 1657 33EA
Changes in version 0.2.2.23-alpha - 2011-03-08
  o Major bugfixes:
    - Stop sending a CLOCK_SKEW controller status event whenever
      we fetch directory information from a relay that has a wrong clock.
      Instead, only inform the controller when it's a trusted authority
      that claims our clock is wrong. Bugfix on 0.1.2.6-alpha; fixes
      the rest of bug 1074.
    - Fix an assert in parsing router descriptors containing IPv6
      addresses. This one took down the directory authorities when
      somebody tried some experimental code. Bugfix on 0.2.1.3-alpha.
    - Make the bridge directory authority refuse to answer directory
      requests for "all" descriptors. It used to include bridge
      descriptors in its answer, which was a major information leak.
      Found by "piebeer". Bugfix on 0.2.0.3-alpha.
    - If relays set RelayBandwidthBurst but not RelayBandwidthRate,
      Tor would ignore their RelayBandwidthBurst setting,
      potentially using more bandwidth than expected. Bugfix on
      0.2.0.1-alpha. Reported by Paul Wouters. Fixes bug 2470.
    - Ignore and warn if the user mistakenly sets "PublishServerDescriptor
      hidserv" in her torrc. The 'hidserv' argument never controlled
      publication of hidden service descriptors. Bugfix on 0.2.0.1-alpha.
  o Major features:
    - Relays now save observed peak bandwidth throughput rates to their
      state file (along with total usage, which was already saved)
      so that they can determine their correct estimated bandwidth on
      restart. Resolves bug 1863, where Tor relays would reset their
      estimated bandwidth to 0 after restarting.
    - Directory authorities now take changes in router IP address and
      ORPort into account when determining router stability. Previously,
      if a router changed its IP or ORPort, the authorities would not
      treat it as having any downtime for the purposes of stability
      calculation, whereas clients would experience downtime since the
      change could take a while to propagate to them. Resolves issue 1035.
    - Enable Address Space Layout Randomization (ASLR) and Data Execution
      Prevention (DEP) by default on Windows to make it harder for
      attackers to exploit vulnerabilities. Patch from John Brooks.
  o Minor bugfixes (on 0.2.1.x and earlier):
    - Fix a rare crash bug that could occur when a client was configured
      with a large number of bridges. Fixes bug 2629; bugfix on
      0.2.1.2-alpha. Bugfix by trac user "shitlei".
    - Avoid a double mark-for-free warning when failing to attach a
      transparent proxy connection. Bugfix on 0.1.2.1-alpha. Fixes
      bug 2279.
    - Correctly detect failure to allocate an OpenSSL BIO. Fixes bug 2378;
      found by "cypherpunks". This bug was introduced before the first
      Tor release, in svn commit r110.
    - Country codes aren't supported in EntryNodes until 0.2.3.x, so
      don't mention them in the manpage. Fixes bug 2450; issue
      spotted by keb and G-Lo.
    - Fix a bug in bandwidth history state parsing that could have been
      triggered if a future version of Tor ever changed the timing
      granularity at which bandwidth history is measured. Bugfix on
      Tor 0.1.1.11-alpha.
    - When a relay decides that its DNS is too broken for it to serve
      as an exit server, it advertised itself as a non-exit, but
      continued to act as an exit. This could create accidental
      partitioning opportunities for users. Instead, if a relay is
      going to advertise reject *:* as its exit policy, it should
      really act with exit policy "reject *:*". Fixes bug 2366.
      Bugfix on Tor 0.1.2.5-alpha. Bugfix by user "postman" on trac.
    - In the special case where you configure a public exit relay as your
      bridge, Tor would be willing to use that exit relay as the last
      hop in your circuit as well. Now we fail that circuit instead.
      Bugfix on 0.2.0.12-alpha. Fixes bug 2403. Reported by "piebeer".
    - Fix a bug with our locking implementation on Windows that couldn't
      correctly detect when a file was already locked. Fixes bug 2504,
      bugfix on 0.2.1.6-alpha.
    - Fix IPv6-related connect() failures on some platforms (BSD, OS X).
      Bugfix on 0.2.0.3-alpha; fixes first part of bug 2660. Patch by
      "piebeer".
    - Set target port in get_interface_address6() correctly. Bugfix
      on 0.1.1.4-alpha and 0.2.0.3-alpha; fixes second part of bug 2660.
    - Directory authorities are now more robust to hops back in time
      when calculating router stability. Previously, if a run of uptime
      or downtime appeared to be negative, the calculation could give
      incorrect results. Bugfix on 0.2.0.6-alpha; noticed when fixing
      bug 1035.
    - Fix an assert that got triggered when using the TestingTorNetwork
      configuration option and then issuing a GETINFO config-text control
      command. Fixes bug 2250; bugfix on 0.2.1.2-alpha.
  o Minor bugfixes (on 0.2.2.x):
    - Clients should not weight BadExit nodes as Exits in their node
      selection. Similarly, directory authorities should not count BadExit
      bandwidth as Exit bandwidth when computing bandwidth-weights.
      Bugfix on 0.2.2.10-alpha; fixes bug 2203.
    - Correctly clear our dir_read/dir_write history when there is an
      error parsing any bw history value from the state file. Bugfix on
      Tor 0.2.2.15-alpha.
    - Resolve a bug in verifying signatures of directory objects
      with digests longer than SHA1. Bugfix on 0.2.2.20-alpha.
      Fixes bug 2409. Found by "piebeer".
    - Bridge authorities no longer crash on SIGHUP when they try to
      publish their relay descriptor to themselves. Fixes bug 2572. Bugfix
      on 0.2.2.22-alpha.
  o Minor features:
    - Log less aggressively about circuit timeout changes, and improve
      some other circuit timeout messages. Resolves bug 2004.
    - Log a little more clearly about the times at which we're no longer
      accepting new connections. Resolves bug 2181.
    - Reject attempts at the client side to open connections to private
      IP addresses (like 127.0.0.1, 10.0.0.1, and so on) with
      a randomly chosen exit node. Attempts to do so are always
      ill-defined, generally prevented by exit policies, and usually
      in error. This will also help to detect loops in transparent
      proxy configurations. You can disable this feature by setting
      "ClientRejectInternalAddresses 0" in your torrc.
    - Always treat failure to allocate an RSA key as an unrecoverable
      allocation error.
    - Update to the March 1 2011 Maxmind GeoLite Country database.
  o Minor features (log subsystem):
    - Add documentation for configuring logging at different severities in
      different log domains. We've had this feature since 0.2.1.1-alpha,
      but for some reason it never made it into the manpage. Fixes
      bug 2215.
    - Make it simpler to specify "All log domains except for A and B".
      Previously you needed to say "[*,~A,~B]". Now you can just say
      "[~A,~B]".
    - Add a "LogMessageDomains 1" option to include the domains of log
      messages along with the messages. Without this, there's no way
      to use log domains without reading the source or doing a lot
      of guessing.
  o Packaging changes:
    - Stop shipping the Tor specs files and development proposal documents
      in the tarball. They are now in a separate git repository at
      git://git.torproject.org/torspec.git

@_date: 2011-03-11 14:24:19
@_author: Roger Dingledine 
@_subject: [tor-talk] New Tor paper: One Bad Apple Spoils the Bunch 
This looks like another iteration of the paper that I blogged about
from these authors last year:
There was quite a bit of press about it then. The very short version
of the blog post is "that's one of the reasons you shouldn't be running
Bittorrent over Tor."
The series of papers coming from this research group has also caused me to
bump up the priority of "draft some guidelines for ethical Tor research"
in my todo list, based in part on conversations with Chris Soghoian et
al at WECSR last week:

@_date: 2011-03-12 19:27:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Error message when running a hidden service 
It's in plain text in your logs because there isn't much point hiding
it from you -- the .onion address (and corresponding key) are already
written in a text file on your system.
Probably not these nodes, since your Tor failed to establish an
introduction circuit to them. By 'introduction circuit', I mean picture
one in You are probably telling your introduction points about your hidden
service, but that's how the design works (and you do it using a Tor
circuit). You're also telling the hidden service directory points about
your hidden service, but again that's how the design works (and again
it's over a Tor circuit).
My guess is that what's happening is Tor is trying to pick introduction
points, and establish circuits to them, before your Tor is quite
bootstrapped. Should be harmless.

@_date: 2011-03-12 22:36:48
@_author: Roger Dingledine 
@_subject: [tor-talk] Error message when running a hidden service 
Good point. Added as bug 2743:
It's likely to sit there unresolved for a good while, so this would be
a great opportunity for somebody else to step in and get some practice
writing patches for Tor. :)

@_date: 2011-05-13 17:05:26
@_author: Roger Dingledine 
@_subject: [tor-talk] automatic updates? 
Oh good, you already quoted the URLs I was going to go find.
I'd like to put Thandy in all the Windows and OS X bundles.
The missing steps are still more or less the ones listed on the wiki page.
We'd love to have some help. We're definitely short on developers who
like to mess with packages.

@_date: 2011-05-15 18:39:21
@_author: Roger Dingledine 
@_subject: [tor-talk] "drop all vulnerable relays from the consensus" 
See tor_version_as_new_as() in routerparse.c.
Then see dirserv.c:
  /* Tor 0.2.0.26-rc is the oldest version that currently caches the right
   * directory information.  Once more of them die off, we should raise this
   * minimum. */
  if (platform && !tor_version_as_new_as(platform,"0.2.0.26-rc")) {
    if (msg)
      *msg = "Tor version is far too old to work.";
    return FP_REJECT;
  } else if (platform && tor_version_as_new_as(platform,"0.2.1.3-alpha")
                      && !tor_version_as_new_as(platform, "0.2.1.19")) {
    /* These versions mishandled RELAY_EARLY cells on rend circuits. */
    if (msg)
      *msg = "Tor version is too buggy to work.";
    return FP_REJECT;
  }
So yes, there's a pretty easy way to do it, just by changing the versions
in those lines (but we haven't made a config option out of it).
Yes, along with knowing something about which versions are deployed that
might have modified code. For example, some of the 0.2.1.26 relays out
there are probably running lenny-backports:
so they're getting patches from our debian maintainer even if the version
isn't changing.
Similarly, most of the 0.2.0.34 and 0.2.0.35 relays on Linux are probably
running from a deb, which received some security backports before Debian
finally dropped support for that version.
And as Sebastian pointed out, some of the relays running 0.2.1.25 are
running from the maint-0.2.1 git branch (and similarly, 0.2.2.19-alpha
might be running maint-0.2.2 git), which are actually more up-to-date
than the versions imply. In the 0.2.2.x case we can check the git revision
in the version if we need to distinguish.
It's really a balancing act here to make use of whatever resources
are volunteered to the Tor network while making relays running old
Tor versions do more good than harm. Cutting out relays reduces the
capacity of the network, making it slower and more frustrating to users
(which could cause them to switch to some other even less safe system),
and reduces the diversity of the network:
We've made similar tradeoffs in the past between anonymity and
performance. The big example that comes to mind is how we are advertising
higher bandwidth weights for the really fast relays, which improves
performance but reduces diversity.
In my mind the right place to draw the line is to drop relays that are
violating the Tor protocol (e.g. mishandling traffic) in a way that
bites actual users. If we wanted to preemptively drop vulnerable relays,
we should start by identifying crappy operating systems and dropping all
those relays, and then move on to identifying evil countries or telcos
and dropping those relays too -- that way lies madness (or at least a
smaller and weaker Tor network).

@_date: 2011-05-15 18:57:18
@_author: Roger Dingledine 
@_subject: [tor-talk] detecting harmful relays 
Well, it's harmful in two ways. First is that clients will mistakenly
ask for service from relays that don't know how to provide it, or that
provide it in a buggy fashion. You can look through Tor's code for calls
to tor_version_as_new_as() to see examples. Second is that the developers,
when trying to debug something, will get misled.
You could in theory scan for wrong versions, e.g. by doing requests to a
relay and seeing how it answers. If there's no interaction that allows
us to distinguish between a relay that has a working feature and one
that doesn't, then is it really a bug? :)
As for relays that don't report *any* version... I think there are
basically none of those.
We haven't needed to explore this issue much because most relays seem
to be running the code we wrote. I think it falls into the "don't think
about it too much until it happens, since whatever you prepared for
isn't going to be the thing that actually goes wrong" category.

@_date: 2011-05-19 02:54:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.2.26-beta and 0.2.2.27-beta are out 
Tor 0.2.2.26-beta fixes a variety of potential privacy problems. It
also introduces a new "socksport auto" approach that should make it
easier to run multiple Tors on the same system, and does a lot of
cleanup to get us closer to a release candidate.
Tor 0.2.2.27-beta fixes a bridge-related stability bug in the previous
release, and also adds a few more general bugfixes.
Packages will appear on the download page in the coming days.
Changes in version 0.2.2.26-beta - 2011-05-17
  o Security/privacy fixes:
    - Replace all potentially sensitive memory comparison operations
      with versions whose runtime does not depend on the data being
      compared. This will help resist a class of attacks where an
      adversary can use variations in timing information to learn
      sensitive data. Fix for one case of bug 3122. (Safe memcmp
      implementation by Robert Ransom based partially on code by DJB.)
    - When receiving a hidden service descriptor, check that it is for
      the hidden service we wanted. Previously, Tor would store any
      hidden service descriptors that a directory gave it, whether it
      wanted them or not. This wouldn't have let an attacker impersonate
      a hidden service, but it did let directories pre-seed a client
      with descriptors that it didn't want. Bugfix on 0.0.6.
    - On SIGHUP, do not clear out all TrackHostExits mappings, client
      DNS cache entries, and virtual address mappings: that's what
      NEWNYM is for. Fixes bug 1345; bugfix on 0.1.0.1-rc.
  o Major features:
    - The options SocksPort, ControlPort, and so on now all accept a
      value "auto" that opens a socket on an OS-selected port. A
      new ControlPortWriteToFile option tells Tor to write its
      actual control port or ports to a chosen file. If the option
      ControlPortFileGroupReadable is set, the file is created as
      group-readable. Now users can run two Tor clients on the same
      system without needing to manually mess with parameters. Resolves
      part of ticket 3076.
    - Set SO_REUSEADDR on all sockets, not just listeners. This should
      help busy exit nodes avoid running out of useable ports just
      because all the ports have been used in the near past. Resolves
      issue 2850.
  o Minor features:
    - New "GETINFO net/listeners/(type)" controller command to return
      a list of addresses and ports that are bound for listeners for a
      given connection type. This is useful when the user has configured
      "SocksPort auto" and the controller needs to know which port got
      chosen. Resolves another part of ticket 3076.
    - Add a new ControlSocketsGroupWritable configuration option: when
      it is turned on, ControlSockets are group-writeable by the default
      group of the current user. Patch by J??r??my Bobbio; implements
      ticket 2972.
    - Tor now refuses to create a ControlSocket in a directory that is
      world-readable (or group-readable if ControlSocketsGroupWritable
      is 0). This is necessary because some operating systems do not
      enforce permissions on an AF_UNIX sockets. Permissions on the
      directory holding the socket, however, seems to work everywhere.
    - Rate-limit a warning about failures to download v2 networkstatus
      documents. Resolves part of bug 1352.
    - Backport code from 0.2.3.x that allows directory authorities to
      clean their microdescriptor caches. Needed to resolve bug 2230.
    - When an HTTPS proxy reports "403 Forbidden", we now explain
      what it means rather than calling it an unexpected status code.
      Closes bug 2503. Patch from Michael Yakubovich.
    - Update to the May 1 2011 Maxmind GeoLite Country database.
  o Minor bugfixes:
    - Authorities now clean their microdesc cache periodically and when
      reading from disk initially, not only when adding new descriptors.
      This prevents a bug where we could lose microdescriptors. Bugfix
      on 0.2.2.6-alpha. 2230
    - Do not crash when our configuration file becomes unreadable, for
      example due to a permissions change, between when we start up
      and when a controller calls SAVECONF. Fixes bug 3135; bugfix
      on 0.0.9pre6.
    - Avoid a bug that would keep us from replacing a microdescriptor
      cache on Windows. (We would try to replace the file while still
      holding it open. That's fine on Unix, but Windows doesn't let us
      do that.) Bugfix on 0.2.2.6-alpha; bug found by wanoskarnet.
    - Add missing explanations for the authority-related torrc options
      RephistTrackTime, BridgePassword, and V3AuthUseLegacyKey in the
      man page. Resolves issue 2379.
    - As an authority, do not upload our own vote or signature set to
      ourself. It would tell us nothing new, and as of 0.2.2.24-alpha,
      it would get flagged as a duplicate. Resolves bug 3026.
    - Accept hidden service descriptors if we think we might be a hidden
      service directory, regardless of what our consensus says. This
      helps robustness, since clients and hidden services can sometimes
      have a more up-to-date view of the network consensus than we do,
      and if they think that the directory authorities list us a HSDir,
      we might actually be one. Related to bug 2732; bugfix on
      0.2.0.10-alpha.
    - When a controller changes TrackHostExits, remove mappings for
      hosts that should no longer have their exits tracked. Bugfix on
      0.1.0.1-rc.
    - When a controller changes VirtualAddrNetwork, remove any mappings
      for hosts that were automapped to the old network. Bugfix on
      0.1.1.19-rc.
    - When a controller changes one of the AutomapHosts* options, remove
      any mappings for hosts that should no longer be automapped. Bugfix
      on 0.2.0.1-alpha.
    - Do not reset the bridge descriptor download status every time we
      re-parse our configuration or get a configuration change. Fixes
      bug 3019; bugfix on 0.2.0.3-alpha.
  o Minor bugfixes (code cleanup):
    - When loading the microdesc journal, remember its current size.
      In 0.2.2, this helps prevent the microdesc journal from growing
      without limit on authorities (who are the only ones to use it in
      0.2.2). Fixes a part of bug 2230; bugfix on 0.2.2.6-alpha.
      Fix posted by "cypherpunks."
    - The microdesc journal is supposed to get rebuilt only if it is
      at least _half_ the length of the store, not _twice_ the length
      of the store. Bugfix on 0.2.2.6-alpha; fixes part of bug 2230.
    - Fix a potential null-pointer dereference while computing a
      consensus. Bugfix on tor-0.2.0.3-alpha, found with the help of
      clang's analyzer.
    - Avoid a possible null-pointer dereference when rebuilding the mdesc
      cache without actually having any descriptors to cache. Bugfix on
      0.2.2.6-alpha. Issue discovered using clang's static analyzer.
    - If we fail to compute the identity digest of a v3 legacy keypair,
      warn, and don't use a buffer-full of junk instead. Bugfix on
      0.2.1.1-alpha; fixes bug 3106.
    - Resolve an untriggerable issue in smartlist_string_num_isin(),
      where if the function had ever in the future been used to check
      for the presence of a too-large number, it would have given an
      incorrect result. (Fortunately, we only used it for 16-bit
      values.) Fixes bug 3175; bugfix on 0.1.0.1-rc.
    - Require that introduction point keys and onion handshake keys
      have a public exponent of 65537. Starts to fix bug 3207; bugfix
      on 0.2.0.10-alpha.
  o Removed features:
    - Caches no longer download and serve v2 networkstatus documents
      unless FetchV2Networkstatus flag is set: these documents haven't
      haven't been used by clients or relays since 0.2.0.x. Resolves
      bug 3022.
Changes in version 0.2.2.27-beta - 2011-05-18
  o Major bugfixes:
    - Fix a crash bug when changing bridges in a running Tor process.
      Fixes bug 3213; bugfix on 0.2.2.26-beta.
    - When the controller configures a new bridge, don't wait 10 to 60
      seconds before trying to fetch its descriptor. Bugfix on
      0.2.0.3-alpha; fixes bug 3198 (suggested by 2355).
  o Minor bugfixes:
    - Require that onion keys have exponent 65537 in microdescriptors too.
      Fixes more of bug 3207; bugfix on 0.2.2.26-beta.
    - Tor used to limit HttpProxyAuthenticator values to 48 characters.
      Changed the limit to 512 characters by removing base64 newlines.
      Fixes bug 2752. Fix by Michael Yakubovich.
    - When a client starts or stops using bridges, never use a circuit
      that was built before the configuration change. This behavior could
      put at risk a user who uses bridges to ensure that her traffic
      only goes to the chosen addresses. Bugfix on 0.2.0.3-alpha; fixes
      bug 3200.

@_date: 2011-05-29 15:26:29
@_author: Roger Dingledine 
@_subject: [tor-talk] drops from the consensus 
Yes, actually.
See recent comments on
An upcoming 0.2.2.x and 0.2.3.x release will include this changelog entry:
  o Major bugfixes:
    - Don't decide to make a new descriptor when receiving a HUP signal.
      This bug has caused a lot of relays to disappear from the consensus
      periodically. Fixes the most common case of triggering bug 1810;
      bugfix on 0.2.2.7-alpha.
At least, I hope that's the issue. :)

@_date: 2011-05-30 15:29:43
@_author: Roger Dingledine 
@_subject: [tor-talk] password... 
Actually, the original "514 Authentication required" came because the
user configured his browser to proxy to Tor's *control* port, on 9051.
Tor's socks port is 9050.
But the real problem here was that the user was trying to mess with
his proxy settings at all. You should either use the Tor Browser Bundle
(which should just work), or install Torbutton and let it configure your
proxy settings.

@_date: 2011-11-02 23:42:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Freedom Hosting admin revealed by Anonymous - 
According to
the Mozilla Foundation was not involved in any of these steps.
In any case, you don't need Mozilla's permission to write a Firefox
extension and put it on a website and sucker somebody into installing it.
The claims from the opdarknet people seem to be full of misunderstandings
and/or wrong facts. I guess that doesn't stop it from being a great story.

@_date: 2011-11-03 02:21:05
@_author: Roger Dingledine 
@_subject: [tor-talk] What is tor used for? 
You might like
Really, getting good stories of Tor successes is tricky, because if Tor
is doing its job, nobody notices. I know a lot of people who have really
interesting Tor success stories and have no interest in telling the world
who they are and how they managed (until that moment when everybody is
reading about them, that is) to stay safe.
Still, there are a bunch of other stories out there that haven't been
documented as well. For example, I really like Nasser's story about his
experiences in Mauritania:
I think I understand one of your confusions though, when you say "the
common entry points to the network". You're thinking about hidden
services, which are not Tor's main use case (Tor's main use case is
accessing the rest of the Internet safely).
Hidden services have gotten less broad attention from the Tor user base,
since most people who install Tor have a website in mind like twitter
or indymedia that they want to visit safely. Some good use cases that
we've seen for hidden services in particular include:
- I know people (for example, in countries that have been undergoing
revolutions lately) who run popular blogs but their blogs kept getting
knocked offline by, well, criminals. The common blogging software
they used (like Wordpress) couldn't stand up to the ddos attacks and
breakins. The solution was to split the blog into a public side, which is
static html and has no logins, and a private side for posting, which is
only reachable over a Tor hidden service. Now their blog works again and
they're reaching their audiences. And as a bonus, the nice fellow hosting
the private side for him doesn't need to let people know where it is,
and even if they figure it out, the nice fellow hosting it doesn't have
any IP addresses to hand over or lose.
- Whistleblowing websites want to provide documents from a platform that
is hard for upset corporations or governments to censor. See e.g.
- Google for 'indymedia fbi seize'. When Indymedia offers a hidden service
version of their website, censoring organizations don't know which data
centers to bully into handing over the hardware.
- Data retention laws in Europe (and soon in the US too at this rate)
threaten to make centralized chat networks vulnerable to social network
analysis (step one, collect all the data; step two, get broken into by
corporations, criminals, external governments, you name it; step three
comes identity theft, stalking, targeted scam jobs, etc etc). What if
you had a chat network where all the users were on hidden services by
default? Now there's no easy central point to learn who's talking to
who and when. Building one and making it usable turns out to be hard.
But good thing we have this versatile tool here as a building block.
How's that for a start? It is certainly the case that we (Tor) spend
most of our time making the technology better, and not so much of our
time figuring out how to market it and change the world's perception on
whether being safe online is worthwhile. Please help. :)

@_date: 2011-11-03 19:28:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor-fi: risks of mobile hotspot feature in 
Sounds like you really want your setup to make use of the proposal 171
"separate streams" feature that went into Tor 0.2.3.3-alpha:
    - You can now configure Tor so that streams from different
      applications are isolated on different circuits, to prevent an
      attacker who sees your streams as they leave an exit node from
      linking your sessions to one another. To do this, choose some way
      to distinguish the applications: have them connect to different
      SocksPorts, or have one of them use SOCKS4 while the other uses
      SOCKS5, or have them pass different authentication strings to the
      SOCKS proxy. Then, use the new SocksPort syntax to configure the
      degree of isolation you need. This implements Proposal 171.
In what way are you proxying all of the traffic from the other users into
your Tor client? See the "Isolate*" entries in the man page in Tor master.
The Torouter people should probably be asking themselves the same
questions I asked above.

@_date: 2011-11-15 12:33:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Run Tor as a bridge in the Amazon Cloud 
No, this is dangerous: if you list your bridge as part of your family in
the relay descriptor, then everybody can learn your bridge fingerprint,
and they can look up your bridge's descriptor (and thus location) at
the bridge directory authority.
We currently don't have a good answer for putting bridges and relays
in the same family. Suggestions welcome. (Note that if the bridge and
the relay are in the same /16 network, Tor clients will automatically
know they're in the same family. So the unsolved case is where they're
in different networks but operated by the same human. My inclination is
to not worry about it that much.)

@_date: 2011-11-15 13:22:00
@_author: Roger Dingledine 
@_subject: [tor-talk] tor net questions 
Vidalia has one location for each country. So that's one dot for every
relay in the US.
(Vidalia used to do geolocation at the city level rather than the country
level, but we got rid of the feature because it was too much overhead.)
And lastly, the phrase "p2p network" means so many things these days
that at this point it means nothing at all.

@_date: 2011-11-15 18:06:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Aurora tab loading status 
I use Vidalia's bandwidth graph, and leave my Firefox alone.
It's not perfect either, but I've found that Firefox is not very good
at guessing how close it is to being ready, and as you say, I don't want
to load up my browser with all kinds of addons.

@_date: 2011-11-15 18:08:53
@_author: Roger Dingledine 
@_subject: [tor-talk] tor net questions 
China is known to be doing  and recently suspected to be doing
something similar to You might like

@_date: 2011-11-17 15:08:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia for Iphone 3g 
Hm. I wonder if the better answer to this question is "an easy tutorial
for ordinary users? there isn't one."
Marco's Tor-for-iphone packages are great for testing, but without an
analysis of the application-level vulnerabilities, like the one for
Tor Browser (
you're going to have to really know what you're doing to use it correctly.
And I suspect a better way of phrasing that is that you're going to need
to really understand what protections you're missing, understand your
threats, and change your behavior to match the threats to the missing
The case of 'covert browser' is even worse: does anybody know if that's
even using Tor under the hood? In the case of Marco's packages, we know
what application-level protections to expect (basically none). In the case
of 'covert browser'... what should we expect? How do we evaluate whether
it achieves them? Does it screw up something else and not realize it,
so e.g. it's broadcasting something about you and you don't know?
I don't know that the answer is 'yes', but I also don't know that it's
'no'. We hear they've changed the Tor source, and we know they haven't
shown us the changes. That's not a good sign.
So it seems unwise to call either of these, especially the second one,
"an easy tutorial".

@_date: 2011-11-24 05:27:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.8-alpha is out 
Tor 0.2.3.8-alpha fixes some crash and assert bugs, including a
socketpair-related bug that has been bothering Windows users. It adds
support to serve microdescriptors to controllers, so Vidalia's network
map can resume listing relays (once Vidalia implements its side),
and adds better support for hardware AES acceleration. Finally, it
starts the process of adjusting the bandwidth cutoff for getting the
"Fast" flag from 20KB to (currently) 32KB -- preliminary results show
that tiny relays harm performance more than they help network capacity.
(Packages coming eventually.)
Changes in version 0.2.3.8-alpha - 2011-11-22
  o Major bugfixes:
    - Initialize Libevent with the EVENT_BASE_FLAG_NOLOCK flag enabled, so
      that it doesn't attempt to allocate a socketpair. This could cause
      some problems on Windows systems with overzealous firewalls. Fix for
      bug 4457; workaround for Libevent versions 2.0.1-alpha through
      2.0.15-stable.
    - Correctly sanity-check that we don't underflow on a memory
      allocation (and then assert) for hidden service introduction
      point decryption. Bug discovered by Dan Rosenberg. Fixes bug 4410;
      bugfix on 0.2.1.5-alpha.
    - Remove the artificially low cutoff of 20KB to guarantee the Fast
      flag. In the past few years the average relay speed has picked
      up, and while the "top 7/8 of the network get the Fast flag" and
      "all relays with 20KB or more of capacity get the Fast flag" rules
      used to have the same result, now the top 7/8 of the network has
      a capacity more like 32KB. Bugfix on 0.2.1.14-rc. Fixes bug 4489.
    - Fix a rare assertion failure when checking whether a v0 hidden
      service descriptor has any usable introduction points left, and
      we don't have enough information to build a circuit to the first
      intro point named in the descriptor. The HS client code in
      0.2.3.x no longer uses v0 HS descriptors, but this assertion can
      trigger on (and crash) v0 HS authorities. Fixes bug 4411.
      Bugfix on 0.2.3.1-alpha; diagnosed by frosty_un.
    - Make bridge authorities not crash when they are asked for their own
      descriptor. Bugfix on 0.2.3.7-alpha, reported by Lucky Green.
    - When running as a client, do not print a misleading (and plain
      wrong) log message that we're collecting "directory request"
      statistics: clients don't collect statistics. Also don't create a
      useless (because empty) stats file in the stats/ directory. Fixes
      bug 4353; bugfix on 0.2.2.34 and 0.2.3.7-alpha.
  o Major features:
    - Allow Tor controllers like Vidalia to obtain the microdescriptor
      for a relay by identity digest or nickname. Previously,
      microdescriptors were only available by their own digests, so a
      controller would have to ask for and parse the whole microdescriptor
      consensus in order to look up a single relay's microdesc. Fixes
      bug 3832; bugfix on 0.2.3.1-alpha.
    - Use OpenSSL's EVP interface for AES encryption, so that all AES
      operations can use hardware acceleration (if present). Resolves
      ticket 4442.
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Detect failure to initialize Libevent. This fix provides better
      detection for future instances of bug 4457.
    - Avoid frequent calls to the fairly expensive cull_wedged_cpuworkers
      function. This was eating up hideously large amounts of time on some
      busy servers. Fixes bug 4518; bugfix on 0.0.9.8.
    - Don't warn about unused log_mutex in log.c when building with
      --disable-threads using a recent GCC. Fixes bug 4437; bugfix on
      0.1.0.6-rc which introduced --disable-threads.
    - Allow manual 'authenticate' commands to the controller interface
      from netcat (nc) as well as telnet. We were rejecting them because
      they didn't come with the expected whitespace at the end of the
      command. Bugfix on 0.1.1.1-alpha; fixes bug 2893.
    - Fix some (not actually triggerable) buffer size checks in usage of
      tor_inet_ntop. Fixes bug 4434; bugfix on Tor 0.2.0.1-alpha. Patch
      by Anders Sundman.
    - Fix parsing of some corner-cases with tor_inet_pton(). Fixes
      bug 4515; bugfix on 0.2.0.1-alpha; fix by Anders Sundman.
    - When configuring, starting, or stopping an NT service, stop
      immediately after the service configuration attempt has succeeded
      or failed. Fixes bug 3963; bugfix on 0.2.0.7-alpha.
    - When sending a NETINFO cell, include the original address
      received for the other side, not its canonical address. Found
      by "troll_un"; fixes bug 4349; bugfix on 0.2.0.10-alpha.
    - Rename the bench_{aes,dmap} functions to test_*, so that tinytest
      can pick them up when the tests aren't disabled. Bugfix on
      0.2.2.4-alpha which introduced tinytest.
    - Fix a memory leak when we check whether a hidden service
      descriptor has any usable introduction points left. Fixes bug
      4424. Bugfix on 0.2.2.25-alpha.
    - Fix a memory leak in launch_direct_bridge_descriptor_fetch() that
      occurred when a client tried to fetch a descriptor for a bridge
      in ExcludeNodes. Fixes bug 4383; bugfix on 0.2.2.25-alpha.
  o Minor bugfixes (on 0.2.3.x):
    - Make util unit tests build correctly with MSVC. Bugfix on
      0.2.3.3-alpha. Patch by Gisle Vanem.
    - Successfully detect AUTH_CHALLENGE cells with no recognized
      authentication type listed. Fixes bug 4367; bugfix on 0.2.3.6-alpha.
      Found by frosty_un.
    - If a relay receives an AUTH_CHALLENGE cell it can't answer,
      it should still send a NETINFO cell to allow the connection to
      become open. Fixes bug 4368; fix on 0.2.3.6-alpha; bug found by
      "frosty".
    - Log less loudly when we get an invalid authentication certificate
      from a source other than a directory authority: it's not unusual
      to see invalid certs because of clock skew. Fixes bug 4370; bugfix
      on 0.2.3.6-alpha.
    - Tolerate servers with more clock skew in their authentication
      certificates than previously. Fixes bug 4371; bugfix on
      0.2.3.6-alpha.
    - Fix a couple of compile warnings on Windows. Fixes bug 4469; bugfix
      on 0.2.3.4-alpha and 0.2.3.6-alpha.
  o Minor features:
    - Add two new config options for directory authorities:
      AuthDirFastGuarantee sets a bandwidth threshold for guaranteeing the
      Fast flag, and AuthDirGuardBWGuarantee sets a bandwidth threshold
      that is always sufficient to satisfy the bandwidth requirement for
      the Guard flag. Now it will be easier for researchers to simulate
      Tor networks with different values. Resolves ticket 4484.
    - When Tor ignores a hidden service specified in its configuration,
      include the hidden service's directory in the warning message.
      Previously, we would only tell the user that some hidden service
      was ignored. Bugfix on 0.0.6; fixes bug 4426.
    - When we fail to initialize Libevent, retry with IOCP disabled so we
      don't need to turn on multi-threading support in Libevent, which in
      turn requires a working socketpair(). This is a workaround for bug
      4457, which affects Libevent versions from 2.0.1-alpha through
      2.0.15-stable.
    - Detect when we try to build on a platform that doesn't define
      AF_UNSPEC to 0. We don't work there, so refuse to compile.
    - Update to the November 1 2011 Maxmind GeoLite Country database.
  o Packaging changes:
    - Make it easier to automate expert package builds on Windows,
      by removing an absolute path from makensis.exe command.
  o Code simplifications and refactoring:
    - Remove some redundant  directives throughout the code.
      Patch from Andrea Gelmini.
    - Unconditionally use OpenSSL's AES implementation instead of our
      old built-in one. OpenSSL's AES has been better for a while, and
      relatively few servers should still be on any version of OpenSSL
      that doesn't have good optimized assembly AES.
    - Use the name "CERTS" consistently to refer to the new cell type;
      we were calling it CERT in some places and CERTS in others.
  o Testing:
    - Numerous new unit tests for functions in util.c and address.c by
      Anders Sundman.
    - The long-disabled benchmark tests are now split into their own
      ./src/test/bench binary.
    - The benchmark tests can now use more accurate timers than
      gettimeofday() when such timers are available.

@_date: 2011-10-02 16:29:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Reject Exit Policy to Syria, Iran, Belarus, 
Here are some suggestions to get better accuracy:
A) You're overcounting relays by looking at every descriptor in your
cached-descriptors file. One simple fix, assuming your Tor is just a
client, is to look at the fingerprint line in the router descriptor,
and discard all but the newest descriptor for a given fingerprint.
B) Most relays reject their own IP address in their exit policy (since
it's common that there's some service that trusts connections from that
IP address, e.g. a linksys router that lets you log in). So you should
read the IP address out of the router line, and ignore reject lines
for that IP address.
I expect once you correct for A and B your numbers will look very
different. All it takes is one guy in SA running a relay and having his
IP get changed 15 times and you suddenly have 15 reject lines to SA in
your list.
The next step is that you'll want to think about bandwidth and uptime
of relays -- SA has a heck of a lot of Tor users, and every once in a
while one of them clicks the "make me a relay" button, but it doesn't
stay up very long or push much bandwidth.
I guess how much you should read out of tiny transient relays
depends on what you're trying to learn by these stats.
Another thing you should know is that some of these addresses
you've got aren't IP address, but rather netblocks. So
reject 7.0.0.0/8:*
is quite different from
reject 7.0.0.0:*
You might like

@_date: 2011-10-08 02:32:40
@_author: Roger Dingledine 
@_subject: [tor-talk] using bridge directly 
No. You need a local Tor client to use Tor, so it can learn about the
rest of the network, build your circuit, do the crypto, etc.
(If you relied on the bridge to do all these things for you, it would
get to learn your destinations, and the design would be no better than
a single-hop proxy.)

@_date: 2011-10-13 11:40:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor compromised? 
Also, keep an eye out for claims like "25% of the Tor relays runs
Windows, so if I can break into all relays on Windows, I'll own 25%
of the Tor network."
Tor clients load-balance over relays based on the relay capacity,
so the statement should really be about how much of the *capacity*
of the Tor network is on Windows. That's a bit messier to calculate,
but I bet it's nowhere near 25%.
I don't mean to say that being able to break into, say, 3% of the Tor
network is irrelevant -- but if claims like this do eventually emerge,
it would show that either he doesn't understand the Tor design, or he
has no interest in letting facts get in the way of his claims.
More broadly, this just looks like another case of a guy who wants to
get publicity and have everybody think he's amazing, and the best way
he knows how to do that is to wait until the last possible moment before
anybody can learn what his claims are.

@_date: 2011-10-17 10:28:08
@_author: Roger Dingledine 
@_subject: [tor-talk] whats the very first connection initialized by 
No, that attack wouldn't work:
There are eight of them, run by various Tor developers and other people
we know personally. You need to compromise or otherwise coopt a majority
of them before you can start tricking people about what the network
looks like.

@_date: 2011-10-23 22:56:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Legal or not on monitoring traffic at a Tor exit? 
The issue as I understand it is that when you are not an endpoint of
the Tor flows (meaning they go from some Tor user to some destination
like a website), looking at the content of the flows is wiretapping.
If you are the endpoint of one of the flows, then you can look at the
content of that flow (but still not at the content of other flows).
As Greg said, I'd suggest you read the legal faq. I'd be happy to
introduce you to some lawyers who can help explain further details. Paul
Ohm (Colorado) and Marcia Hofmann (EFF) come to mind.
There was also a panel at PETS this year on the ethics of research on
the Tor network. Eventually some notes from it will find their way onto
the wiki, but consensus results for researchers like "don't wiretap"
shouldn't surprise you.

@_date: 2011-10-24 19:38:26
@_author: Roger Dingledine 
@_subject: [tor-talk] TOR exits unexpectedly 
You are the latest victim of the longest-open Windows Tor bug.
Congratulations. :/
You can resolve it by having more physical ram, and/or running fewer
network-intensive applications in parallel with Tor, and/or configuring
yourself as a Tor client rather than a bridge or relay.
If that doesn't work, I would suggest an upgrade to Ubuntu.
We'll have another round of experimental fixes out for the Tor 0.2.3.x
branch in a while, when we fold in (and resolve whatever bugs we find in)
the new libevent 2.x release and the new "bufferevents" option in Tor.

@_date: 2011-10-27 00:59:58
@_author: Roger Dingledine 
@_subject: [tor-talk] tor http proxy 
Your http proxy needs to accept CONNECT requests. That means it should
be what many people would call an 'https proxy'.
Also, when you configure Tor to use it, you need to use the httpsproxy
directive in your torrc, not the httpproxy directive.
If you're configuring via Vidalia, that means you need to set your proxy
as "HTTP / HTTPS", not "HTTP".
(Using only a plain http proxy means you only proxy your unencrypted
directory fetches, which isn't very useful, especially now that Tor
tunnels its directory fetches over the TLS (https) connection by default.)
Hope that helps,

@_date: 2011-10-27 20:43:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.6-alpha is out (security patches) 
Tor 0.2.3.6-alpha includes the fix from 0.2.2.34 for a critical
anonymity vulnerability where an attacker can deanonymize Tor
Everybody should upgrade.
This release also features support for a new v3 connection handshake
protocol, and fixes to make hidden service connections more robust.
Changes in version 0.2.3.6-alpha - 2011-10-26
  o Major features:
    - Implement a new handshake protocol (v3) for authenticating Tors to
      each other over TLS. It should be more resistant to fingerprinting
      than previous protocols, and should require less TLS hacking for
      future Tor implementations. Implements proposal 185.
    - Allow variable-length padding cells to disguise the length of
      Tor's TLS records. Implements part of proposal 184.
  o Privacy/anonymity fixes (clients):
    - Clients and bridges no longer send TLS certificate chains on
      outgoing OR connections. Previously, each client or bridge would
      use the same cert chain for all outgoing OR connections until
      its IP address changes, which allowed any relay that the client
      or bridge contacted to determine which entry guards it is using.
      Fixes CVE-2011-2768. Bugfix on 0.0.9pre5; found by "frosty_un".
    - If a relay receives a CREATE_FAST cell on a TLS connection, it
      no longer considers that connection as suitable for satisfying a
      circuit EXTEND request. Now relays can protect clients from the
      CVE-2011-2768 issue even if the clients haven't upgraded yet.
    - Directory authorities no longer assign the Guard flag to relays
      that haven't upgraded to the above "refuse EXTEND requests
      to client connections" fix. Now directory authorities can
      protect clients from the CVE-2011-2768 issue even if neither
      the clients nor the relays have upgraded yet. There's a new
      "GiveGuardFlagTo_CVE_2011_2768_VulnerableRelays" config option
      to let us transition smoothly, else tomorrow there would be no
      guard relays.
  o Major bugfixes (hidden services):
    - Improve hidden service robustness: when an attempt to connect to
      a hidden service ends, be willing to refetch its hidden service
      descriptors from each of the HSDir relays responsible for them
      immediately. Previously, we would not consider refetching the
      service's descriptors from each HSDir for 15 minutes after the last
      fetch, which was inconvenient if the hidden service was not running
      during the first attempt. Bugfix on 0.2.0.18-alpha; fixes bug 3335.
    - When one of a hidden service's introduction points appears to be
      unreachable, stop trying it. Previously, we would keep trying
      to build circuits to the introduction point until we lost the
      descriptor, usually because the user gave up and restarted Tor.
      Partly fixes bug 3825.
    - Don't launch a useless circuit after failing to use one of a
      hidden service's introduction points. Previously, we would
      launch a new introduction circuit, but not set the hidden service
      which that circuit was intended to connect to, so it would never
      actually be used. A different piece of code would then create a
      new introduction circuit correctly. Bug reported by katmagic and
      found by Sebastian Hahn. Bugfix on 0.2.1.13-alpha; fixes bug 4212.
  o Major bugfixes (other):
    - Bridges now refuse CREATE or CREATE_FAST cells on OR connections
      that they initiated. Relays could distinguish incoming bridge
      connections from client connections, creating another avenue for
      enumerating bridges. Fixes CVE-2011-2769. Bugfix on 0.2.0.3-alpha.
      Found by "frosty_un".
    - Don't update the AccountingSoftLimitHitAt state file entry whenever
      tor gets started. This prevents a wrong average bandwidth
      estimate, which would cause relays to always start a new accounting
      interval at the earliest possible moment. Fixes bug 2003; bugfix
      on 0.2.2.7-alpha. Reported by BryonEldridge, who also helped
      immensely in tracking this bug down.
    - Fix a crash bug when changing node restrictions while a DNS lookup
      is in-progress. Fixes bug 4259; bugfix on 0.2.2.25-alpha. Bugfix
      by "Tey'".
  o Minor bugfixes (on 0.2.2.x and earlier):
    - When a hidden service turns an extra service-side introduction
      circuit into a general-purpose circuit, free the rend_data and
      intro_key fields first, so we won't leak memory if the circuit
      is cannibalized for use as another service-side introduction
      circuit. Bugfix on 0.2.1.7-alpha; fixes bug 4251.
    - Rephrase the log message emitted if the TestSocks check is
      successful. Patch from Fabian Keil; fixes bug 4094.
    - Bridges now skip DNS self-tests, to act a little more stealthily.
      Fixes bug 4201; bugfix on 0.2.0.3-alpha, which first introduced
      bridges. Patch by "warms0x".
    - Remove a confusing dollar sign from the example fingerprint in the
      man page, and also make the example fingerprint a valid one. Fixes
      bug 4309; bugfix on 0.2.1.3-alpha.
    - Fix internal bug-checking logic that was supposed to catch
      failures in digest generation so that it will fail more robustly
      if we ask for a nonexistent algorithm. Found by Coverity Scan.
      Bugfix on 0.2.2.1-alpha; fixes Coverity CID 479.
    - Report any failure in init_keys() calls launched because our
      IP address has changed. Spotted by Coverity Scan. Bugfix on
      0.1.1.4-alpha; fixes CID 484.
  o Minor bugfixes (on 0.2.3.x):
    - Fix a bug in configure.in that kept it from building a configure
      script with autoconf versions earlier than 2.61. Fixes bug 2430;
      bugfix on 0.2.3.1-alpha.
    - Don't warn users that they are exposing a client port to the
      Internet if they have specified an RFC1918 address. Previously,
      we would warn if the user had specified any non-loopback
      address. Bugfix on 0.2.3.3-alpha. Fixes bug 4018; reported by Tas.
    - Fix memory leaks in the failing cases of the new SocksPort and
      ControlPort code. Found by Coverity Scan. Bugfix on 0.2.3.3-alpha;
      fixes coverity CIDs 485, 486, and 487.
  o Minor features:
    - When a hidden service's introduction point times out, consider
      trying it again during the next attempt to connect to the
      HS. Previously, we would not try it again unless a newly fetched
      descriptor contained it. Required by fixes for bugs 1297 and 3825.
    - The next version of Windows will be called Windows 8, and it has
      a major version of 6, minor version of 2. Correctly identify that
      version instead of calling it "Very recent version". Resolves
      ticket 4153; reported by funkstar.
    - The Bridge Authority now writes statistics on how many bridge
      descriptors it gave out in total, and how many unique descriptors
      it gave out. It also lists how often the most and least commonly
      fetched descriptors were given out, as well as the median and
      25th/75th percentile. Implements tickets 4200 and 4294.
    - Update to the October 4 2011 Maxmind GeoLite Country database.
  o Code simplifications and refactoring:
    - Remove some old code to remember statistics about which descriptors
      we've served as a directory mirror. The feature wasn't used and
      is outdated now that microdescriptors are around.
    - Rename Tor functions that turn strings into addresses, so that
      "parse" indicates that no hostname resolution occurs, and
      "lookup" indicates that hostname resolution may occur. This
      should help prevent mistakes in the future. Fixes bug 3512.

@_date: 2011-10-28 16:23:22
@_author: Roger Dingledine 
@_subject: [tor-talk] bug found on the Tor 
That bug is The more exciting one is
which looks related except Tor crashes.
Stay tuned,

@_date: 2011-10-30 20:37:54
@_author: Roger Dingledine 
@_subject: [tor-talk] which apps require an http proxy? 
This is the crux of the question: which ones? And are they applications
that we think are safe enough to use in general with Tor, or are they
applications where if we learned you were using them we'd tell you to
give up on trying to be safe? If there are enough apps in the former
category, we should think about either a) getting an http proxy into
the bundles we ship, or b) writing clear instructions for how people
can bolt on an http proxy if they want one.

@_date: 2011-10-30 22:04:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.7-alpha is out 
Tor 0.2.3.7-alpha fixes a crash bug in 0.2.3.6-alpha introduced by
the new v3 handshake. It also resolves yet another bridge address
enumeration issue.
Changes in version 0.2.3.7-alpha - 2011-10-30
  o Major bugfixes:
    - If we mark an OR connection for close based on a cell we process,
      don't process any further cells on it. We already avoid further
      reads on marked-for-close connections, but now we also discard the
      cells we'd already read. Fixes bug 4299; bugfix on 0.2.0.10-alpha,
      which was the first version where we might mark a connection for
      close based on processing a cell on it.
    - Fix a double-free bug that would occur when we received an invalid
      certificate in a CERT cell in the new v3 handshake. Fixes bug 4343;
      bugfix on 0.2.3.6-alpha.
    - Bridges no longer include their address in NETINFO cells on outgoing
      OR connections, to allow them to blend in better with clients.
      Removes another avenue for enumerating bridges. Reported by
      "troll_un". Fixes bug 4348; bugfix on 0.2.0.10-alpha, when NETINFO
      cells were introduced.
  o Trivial fixes:
    - Fixed a typo in a hibernation-related log message. Fixes bug 4331;
      bugfix on 0.2.2.23-alpha; found by "tmpname0901".

@_date: 2011-10-31 04:45:19
@_author: Roger Dingledine 
@_subject: [tor-talk] Two tor clients 
Depends what you changed in the source.
You shouldn't need to change the source at all. Just pick different
datadirs and different socksports and poof, you have two separate Tor

@_date: 2011-10-31 06:17:20
@_author: Roger Dingledine 
@_subject: [tor-talk] Exit enclave without middle node 
See also
which could use some more work but might do what you have in mind.

@_date: 2011-09-01 04:47:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Dutch CA issues fake *.torproject.org cert (among many 
For those who haven't been following, check out
You should pay special attention if you're in an environment where your
ISP (or your government!) might try a man-in-the-middle attack on your
interactions with We stepped up our schedule for switching the Tor Browser Bundle to Firefox
6 (which we can build from source on all platforms, and thus remove the
offending CA ourselves). New bundles are out now:
Perhaps now is a great time for you to learn how to verify the signatures
on Tor packages you download:

@_date: 2011-09-01 05:12:47
@_author: Roger Dingledine 
@_subject: [tor-talk] (FWD) Tor 0.2.2.32 is released 
If you're not on tor-announce, consider joining: that's where the stable
Tor releases get announced.

@_date: 2011-09-01 09:24:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Dutch police break into webservers over hidden services 
Several people have asked us on irc about recent news articles like
Apparently the Dutch police exploited vulnerabilities in the webservers
reachable over the hidden services. Some people are confusing this issue
with an attack on Tor. Tor just transports bytes back and forth. If you
have an instant messaging conversation with a Tor user and convince her
to tell you her address, did you break Tor? Having an http conversation
with a webserver running over a Tor hidden service, and convincing it
to tell you its address, is not much different.
So what lessons can we learn here, other than the usual "criminals
are not as smart as your average bear"? (If only we could count on bad
people to run insecure software, and good people to secure their software
correctly, the world would be a much simpler place.) One lesson is that
there are a lot of non-Tor components that can go wrong in keeping a
hidden service hidden -- just as we have a laundry list of security
and privacy issues to consider when using Tor as a normal client (at
the bottom of  )
there's a whole other set of issues, mostly unexplored, for hidden
service operators to keep in mind:

@_date: 2011-09-03 04:39:53
@_author: Roger Dingledine 
@_subject: [tor-talk] massive automated bridge requests: why? 
Hi folks,
Over the past few months the number of bridge users has spiked, most
prominently in Italy, but also plenty in Spain, Brazil, Israel, and
I believe it started out with a Tor bundle that somebody made that had
three bridges pre-configured -- we found a torrc file along with an
unofficial Windows Tor bundle. At the beginning, those few bridges had
tens of thousands of users each, and that was it.
Since then, we've seen an enormous spike in automated connections to
 -- more than a million requests an hour.
Now just about every bridge that's given out via the https pool (as
opposed to the gmail pool or the reserve pool) is seeing many many
thousands of users from Italy and these other countries.
It seems clear that somebody's unofficial Tor bundle automatically grabs
some bridges for its users, and that this somebody didn't understand
the notion of being polite to a remote service -- I think each user is
hitting the bridges page roughly every 30 seconds.
We've taken steps to defend the bridgedb service from this overload. And
I can imagine further steps, like finally rolling out a captcha on that
page, to block people from using it like a remote API (which I always
thought was kind of a neat option). Or heck, just moving to a different
URL and abandoning that one.
But the question first is: what's going on? Can those of you near or in
these countries please ask around and try to get some answers?
I don't think it's a censoring adversary trying to collect the list of
bridges. For one, it's way overkill; for another, why use the bridges
I don't think it's malware or some automated botnet that happens to
use bridges -- if it were, we should be seeing spikes in well-connected
countries like Japan.

@_date: 2011-09-04 01:47:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.3-alpha is out 
Tor 0.2.3.3-alpha adds a new "stream isolation" feature to improve Tor's
security, and provides client-side support for the microdescriptor
and optimistic data features introduced earlier in the 0.2.3.x
series. It also includes numerous critical bugfixes in the (optional)
bufferevent-based networking backend.
Packages for 0.2.3.x aren't up yet, but hopefully they'll be up in a
few days.
Changes in version 0.2.3.3-alpha - 2011-09-01
  o Major features (stream isolation):
    - You can now configure Tor so that streams from different
      applications are isolated on different circuits, to prevent an
      attacker who sees your streams as they leave an exit node from
      linking your sessions to one another. To do this, choose some way
      to distinguish the applications: have them connect to different
      SocksPorts, or have one of them use SOCKS4 while the other uses
      SOCKS5, or have them pass different authentication strings to the
      SOCKS proxy. Then, use the new SocksPort syntax to configure the
      degree of isolation you need. This implements Proposal 171.
    - There's a new syntax for specifying multiple client ports (such as
      SOCKSPort, TransPort, DNSPort, NATDPort): you can now just declare
      multiple *Port entries with full addr:port syntax on each.
      The old *ListenAddress format is still supported, but you can't
      mix it with the new *Port syntax.
  o Major features (other):
    - Enable microdescriptor fetching by default for clients. This allows
      clients to download a much smaller amount of directory information.
      To disable it (and go back to the old-style consensus and
      descriptors), set "UseMicrodescriptors 0" in your torrc file.
    - Tor's firewall-helper feature, introduced in 0.2.3.1-alpha (see the
      "PortForwarding" config option), now supports Windows.
    - When using an exit relay running 0.2.3.x, clients can now
      "optimistically" send data before the exit relay reports that
      the stream has opened. This saves a round trip when starting
      connections where the client speaks first (such as web browsing).
      This behavior is controlled by a consensus parameter (currently
      disabled). To turn it on or off manually, use the "OptimisticData"
      torrc option. Implements proposal 181; code by Ian Goldberg.
  o Major bugfixes (bufferevents, fixes on 0.2.3.1-alpha):
    - When using IOCP on Windows, we need to enable Libevent windows
      threading support.
    - The IOCP backend now works even when the user has not specified
      the (internal, debugging-only) _UseFilteringSSLBufferevents option.
      Fixes part of bug 3752.
    - Correctly record the bytes we've read and written when using
      bufferevents, so that we can include them in our bandwidth history
      and advertised bandwidth. Fixes bug 3803.
    - Apply rate-limiting only at the bottom of a chain of filtering
      bufferevents. This prevents us from filling up internal read
      buffers and violating rate-limits when filtering bufferevents
      are enabled. Fixes part of bug 3804.
    - Add high-watermarks to the output buffers for filtered
      bufferevents. This prevents us from filling up internal write
      buffers and wasting CPU cycles when filtering bufferevents are
      enabled. Fixes part of bug 3804.
    - Correctly notice when data has been written from a bufferevent
      without flushing it completely. Fixes bug 3805.
    - Fix a bug where server-side tunneled bufferevent-based directory
      streams would get closed prematurely. Fixes bug 3814.
    - Fix a use-after-free error with per-connection rate-limiting
      buckets. Fixes bug 3888.
  o Major bugfixes (also part of 0.2.2.31-rc):
    - If we're configured to write our ControlPorts to disk, only write
      them after switching UID and creating the data directory. This way,
      we don't fail when starting up with a nonexistent DataDirectory
      and a ControlPortWriteToFile setting based on that directory. Fixes
      bug 3747; bugfix on Tor 0.2.2.26-beta.
  o Minor features:
    - Added a new CONF_CHANGED event so that controllers can be notified
      of any configuration changes made by other controllers, or by the
      user. Implements ticket 1692.
    - Use evbuffer_copyout() in inspect_evbuffer(). This fixes a memory
      leak when using bufferevents, and lets Libevent worry about how to
      best copy data out of a buffer.
    - Replace files in stats/ rather than appending to them. Now that we
      include statistics in extra-info descriptors, it makes no sense to
      keep old statistics forever. Implements ticket 2930.
  o Minor features (build compatibility):
    - Limited, experimental support for building with nmake and MSVC.
    - Provide a substitute implementation of lround() for MSVC, which
      apparently lacks it. Patch from Gisle Vanem.
  o Minor features (also part of 0.2.2.31-rc):
    - Update to the August 2 2011 Maxmind GeoLite Country database.
  o Minor bugfixes (on 0.2.3.x-alpha):
    - Fix a spurious warning when parsing SOCKS requests with
      bufferevents enabled. Fixes bug 3615; bugfix on 0.2.3.2-alpha.
    - Get rid of a harmless warning that could happen on relays running
      with bufferevents. The warning was caused by someone doing an http
      request to a relay's orport. Also don't warn for a few related
      non-errors. Fixes bug 3700; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (on 2.2.x and earlier):
    - Correct the man page to explain that HashedControlPassword and
      CookieAuthentication can both be set, in which case either method
      is sufficient to authenticate to Tor. Bugfix on 0.2.0.7-alpha,
      when we decided to allow these config options to both be set. Issue
      raised by bug 3898.
    - The "--quiet" and "--hush" options now apply not only to Tor's
      behavior before logs are configured, but also to Tor's behavior in
      the absense of configured logs. Fixes bug 3550; bugfix on
      0.2.0.10-alpha.
  o Minor bugfixes (also part of 0.2.2.31-rc):
    - Write several files in text mode, on OSes that distinguish text
      mode from binary mode (namely, Windows). These files are:
      'buffer-stats', 'dirreq-stats', and 'entry-stats' on relays
      that collect those statistics; 'client_keys' and 'hostname' for
      hidden services that use authentication; and (in the tor-gencert
      utility) newly generated identity and signing keys. Previously,
      we wouldn't specify text mode or binary mode, leading to an
      assertion failure. Fixes bug 3607. Bugfix on 0.2.1.1-alpha (when
      the DirRecordUsageByCountry option which would have triggered
      the assertion failure was added), although this assertion failure
      would have occurred in tor-gencert on Windows in 0.2.0.1-alpha.
    - Selectively disable deprecation warnings on OS X because Lion
      started deprecating the shipped copy of openssl. Fixes bug 3643.
    - Remove an extra pair of quotation marks around the error
      message in control-port STATUS_GENERAL BUG events. Bugfix on
      0.1.2.6-alpha; fixes bug 3732.
    - When unable to format an address as a string, report its value
      as "???" rather than reusing the last formatted address. Bugfix
      on 0.2.1.5-alpha.
  o Code simplifications and refactoring:
    - Rewrite the listener-selection logic so that parsing which ports
      we want to listen on is now separate from binding to the ports
      we want.
  o Build changes:
    - Building Tor with bufferevent support now requires Libevent
      2.0.13-stable or later. Previous versions of Libevent had bugs in
      SSL-related bufferevents and related issues that would make Tor
      work badly with bufferevents. Requiring 2.0.13-stable also allows
      Tor with bufferevents to take advantage of Libevent APIs
      introduced after 2.0.8-rc.

@_date: 2011-09-08 07:32:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor spying 
I'd like to argue with some of these clauses, actually. I agree that the
first several thousand Tor users were smart security-aware people. But
I believe the *next* several million users were not all smart security
people. Rather, they were folks who heard about how dangerous the
Internet is ("NSA wiretaps America", "large credit agency loses 30
million names/addresses/credit card numbers", etc), and tried to do
something about it.
So I don't expect your average Tor user to be any better at understanding
https than your average person using the Internet at Starbucks.
Depending on when these attacks were done, it's quite reasonable to
estimate that 1/3 or more of the Tor users at the time were in repressive
regimes where their main focus was to get to censored websites rather
than to protect themselves from some wiretapping adversary.
We've got an uphill battle in front of us, in terms of how to teach
everybody on the Internet what encryption is, what it's for, how to
know when your browser is or isn't doing it right, etc. Our cause is
made harder by the pervasive snakeoil VPN providers who undermine user
education by promising "100% encryption" when what they really mean is
"we will encrypt the traffic from you to us, and then we will datamine
the hell out of it once it gets to us".
As Andrew said, it's easy to make the news by putting "and we attacked
Tor!!" in your talk blurb. Tor is hot, so people notice. But let's not
let that distract us too much from the question of "how do we protect all
Internet users, including Tor users?" Pretending that all Tor users are
"possessed with some advanced level of expertise" isn't going to make
that task any easier.

@_date: 2011-09-09 06:36:42
@_author: Roger Dingledine 
@_subject: [tor-talk] TB-1.4.2 
You should realize that using Torbutton on your own browser is a dying
There aren't that many known bugs now in using Torbutton this way,
but in a few months there may well be known serious bugs that we have
chosen not to fix.
"However, the New Identity button and the Hotmail fix are only
available to Tor Browser Bundle users."
The changelog of Torbutton 1.4.1 includes
  * bug 3809: Disable referer spoofing (fixes navigation issues)

@_date: 2011-09-10 08:00:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Dutch Police Investigation & Tor Spike: 
I think it's extremely unlikely to be related. There's no way "get a
million people in Italy, Spain, and Latin America to use Tor" is somehow
one of the steps in a Dutch police investigation.

@_date: 2011-09-12 05:59:13
@_author: Roger Dingledine 
@_subject: [tor-talk] Download of Tor Browser Bundle (2.2.32-4) 
Ah ha. This happens because there is no download/de/download.wml file,
since not enough of it is translated now. But our website build process
left the download/download.html.de file alone.
Should be fixed now.

@_date: 2011-09-13 20:42:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.4-alpha is out 
Tor 0.2.3.4-alpha includes the fixes from 0.2.2.33, including a slight
tweak to Tor's TLS handshake that makes relays and bridges that run
this new version reachable from Iran again. It also fixes a few new
bugs in 0.2.3.x, and teaches relays to recognize when they're not
listed in the network consensus and republish.
Packages for 0.2.3.x aren't up yet, but hopefully they'll be up in a
few days.
Changes in version 0.2.3.4-alpha - 2011-09-13
  o Major bugfixes (also part of 0.2.2.33):
    - Avoid an assertion failure when reloading a configuration with
      TrackExitHosts changes. Found and fixed by 'laruldan'. Fixes bug
      3923; bugfix on 0.2.2.25-alpha.
  o Minor features (security, also part of 0.2.2.33):
    - Check for replays of the public-key encrypted portion of an
      INTRODUCE1 cell, in addition to the current check for replays of
      the g^x value. This prevents a possible class of active attacks
      by an attacker who controls both an introduction point and a
      rendezvous point, and who uses the malleability of AES-CTR to
      alter the encrypted g^x portion of the INTRODUCE1 cell. We think
      that these attacks is infeasible (requiring the attacker to send
      on the order of zettabytes of altered cells in a short interval),
      but we'd rather block them off in case there are any classes of
      this attack that we missed. Reported by Willem Pinckaers.
  o Minor features (also part of 0.2.2.33):
    - Adjust the expiration time on our SSL session certificates to
      better match SSL certs seen in the wild. Resolves ticket 4014.
    - Change the default required uptime for a relay to be accepted as
      a HSDir (hidden service directory) from 24 hours to 25 hours.
      Improves on 0.2.0.10-alpha; resolves ticket 2649.
    - Add a VoteOnHidServDirectoriesV2 config option to allow directory
      authorities to abstain from voting on assignment of the HSDir
      consensus flag. Related to bug 2649.
    - Update to the September 6 2011 Maxmind GeoLite Country database.
  o Minor bugfixes (also part of 0.2.2.33):
    - Demote the 'replay detected' log message emitted when a hidden
      service receives the same Diffie-Hellman public key in two different
      INTRODUCE2 cells to info level. A normal Tor client can cause that
      log message during its normal operation. Bugfix on 0.2.1.6-alpha;
      fixes part of bug 2442.
    - Demote the 'INTRODUCE2 cell is too {old,new}' log message to info
      level. There is nothing that a hidden service's operator can do
      to fix its clients' clocks. Bugfix on 0.2.1.6-alpha; fixes part
      of bug 2442.
    - Clarify a log message specifying the characters permitted in
      HiddenServiceAuthorizeClient client names. Previously, the log
      message said that "[A-Za-z0-9+-_]" were permitted; that could have
      given the impression that every ASCII character between "+" and "_"
      was permitted. Now we say "[A-Za-z0-9+_-]". Bugfix on 0.2.1.5-alpha.
  o Build fixes (also part of 0.2.2.33):
    - Clean up some code issues that prevented Tor from building on older
      BSDs. Fixes bug 3894; reported by "grarpamp".
    - Search for a platform-specific version of "ar" when cross-compiling.
      Should fix builds on iOS. Resolves bug 3909, found by Marco Bonetti.
  o Major bugfixes:
    - Fix a bug where the SocksPort option (for example) would get
      ignored and replaced by the default if a SocksListenAddress
      option was set. Bugfix on 0.2.3.3-alpha; fixes bug 3936. Fix by
      Fabian Keil.
  o Major features:
    - Relays now try regenerating and uploading their descriptor more
      frequently if they are not listed in the consensus, or if the
      version of their descriptor listed in the consensus is too
      old. This fix should prevent situations where a server declines
      to re-publish itself because it has done so too recently, even
      though the authorities decided not to list its recent-enough
      descriptor. Fix for bug 3327.
  o Minor features:
    - Relays now include a reason for regenerating their descriptors
      in an HTTP header when uploading to the authorities. This will
      make it easier to debug descriptor-upload issues in the future.
    - When starting as root and then changing our UID via the User
      control option, and we have a ControlSocket configured, make sure
      that the ControlSocket is owned by the same account that Tor will
      run under. Implements ticket 3421; fix by J??r??my Bobbio.
  o Minor bugfixes:
    - Abort if tor_vasprintf fails in connection_printf_to_buf (a
      utility function used in the control-port code). This shouldn't
      ever happen unless Tor is completely out of memory, but if it did
      happen and Tor somehow recovered from it, Tor could have sent a log
      message to a control port in the middle of a reply to a controller
      command. Fixes part of bug 3428; bugfix on 0.1.2.3-alpha.
    - Make 'FetchUselessDescriptors' cause all descriptor types and
      all consensus types (including microdescriptors) to get fetched.
      Fixes bug 3851; bugfix on 0.2.3.1-alpha.
  o Code refactoring:
    - Make a new "entry connection" struct as an internal subtype of "edge
      connection", to simplify the code and make exit connections smaller.

@_date: 2011-09-13 20:57:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.4-alpha is out 
Iran blocked Tor by protocol fingerprint earlier today. Fortunately, the
fix is on the relay side -- so once enough relays and bridges upgrade,
the many tens of thousands of users in Iran will resume being able to
reach the Tor network:
For all those people who enjoy building their Tor relay or bridge from
tarballs or from git, please upgrade. We'll have 0.2.2.33 tarballs out
later tonight I hope, and packages (including debs) following that.

@_date: 2011-09-14 14:30:57
@_author: Roger Dingledine 
@_subject: [tor-talk] New Signatures after using gpg? 
It means you had a copy of the key already, and now you downloaded a few
more signatures on the key, which can be used to improve your trust in it
if you recognize and trust any of the keys that signed it.
Do a "gpg --list-sigs 886DDD89" and you'll see (assuming you import
the other keys too) something like:
$ gpg --list-sigs 886DDD89
pub   2048R/886DDD89 2009-09-04 [expires: 2014-09-03]
uid                  deb.torproject.org archive signing key
sig 3        886DDD89 2009-09-04  deb.torproject.org archive signing key
sig 3        94C09C7F 2009-09-04  Peter Palfrader
sig          28988BF5 2009-09-11  Roger Dingledine sig          31B0974B 2009-09-13  Andrew Lewman (phobos) sig          639F6A66 2010-02-03  Adam Nichols sig          5B172AB2 2010-02-18  Sven Lucke (Verschl?sselung) sig          A1A1BC05 2010-02-19  Sven Lucke (Neuer Schl?ssel) sig          27A1C89A 2010-10-17  z00z00z00 sig          6F10FC42 2010-11-05  [User ID not found]
sig          7B5D666B 2010-09-16  robbiemacg sig 3        29606E77 2010-11-15  lilo sig          339A7FA8 2010-09-23  Chris Jordan sig          5B54D68C 2010-10-22  James O. Christie sig          FDA28A1A 2011-06-30  [User ID not found]
sub   2048R/219EC810 2009-09-04 [expires: 2012-09-03]
sig          886DDD89 2009-09-04  deb.torproject.org archive signing key
In the PGP web of trust idea, anybody who wants to can sign a key for
whatever reason they choose. Some more people chose to sign the key since
you last fetched a copy. Nothing to worry about.

@_date: 2011-09-18 11:55:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia bundles broken 
Whoops. I just fixed them. Thanks for pointing it out!
Good question. Probably. I guess it depends if you keep the current
config file, or switch to the new one, during the install.
 is a start.
Debugging on Windows is a huge pain though, so odds are good that it
is not a known problem (or rather, that its cause is not known). Help
would be great.

@_date: 2011-09-20 21:04:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Question About "1000 circuit times" 
Yes, it's using data from previous Tor runs. Tor started collecting and
recording this data sometime early in the 0.2.2.x branch.

@_date: 2011-09-26 17:59:16
@_author: Roger Dingledine 
@_subject: [tor-talk] blutmagie exits shut down 
Thanks for your contributions to making the world a better place, Olaf!
It will be interesting to see how
change over the next few days.

@_date: 2011-09-26 18:11:35
@_author: Roger Dingledine 
@_subject: [tor-talk] Is there Tor Browser Bundle with FireFox 3.x? 
You might like
But really, the answer is that Firefox 3.x is increasingly going to have
privacy and security problems that nobody fixes. Bundling it would be
irresponsible (and a waste of our limited packaging resources).

@_date: 2011-09-27 15:53:54
@_author: Roger Dingledine 
@_subject: [tor-talk] blutmagie exits shut down 
This is a good point. If you (or anybody) knows anybody still working
there, it's clear what must be done. ;) I imagine offering to deal with
operations, handling complaints, etc would make it more palatable. But
really, it's going to require some ongoing effort by said employee.
While I'm here -- based on various people emailing me yesterday, I put
up a new FAQ entry on turning donations into relays:

@_date: 2011-09-28 20:06:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.5-alpha is out 
Tor 0.2.3.5-alpha fixes two bugs that make it possible to enumerate
bridge relays; fixes an assertion error that many users started hitting
today; and adds the ability to refill token buckets more often than
once per second, allowing significant performance improvements.
Packages will be out in a few days.
Changes in version 0.2.3.5-alpha - 2011-09-28
  o Security fixes:
    - Bridge relays now do their directory fetches inside Tor TLS
      connections, like all the other clients do, rather than connecting
      directly to the DirPort like public relays do. Removes another
      avenue for enumerating bridges. Fixes bug 4115; bugfix on 0.2.0.35.
    - Bridges relays now build circuits for themselves in a more similar
      way to how clients build them. Removes another avenue for
      enumerating bridges. Fixes bug 4124; bugfix on 0.2.0.3-alpha,
      when bridges were introduced.
  o Major bugfixes:
    - Fix an "Assertion md->held_by_node == 1 failed" error that could
      occur when the same microdescriptor was referenced by two node_t
      objects at once. Fix for bug 4118; bugfix on Tor 0.2.3.1-alpha.
  o Major features (networking):
    - Add a new TokenBucketRefillInterval option to refill token buckets
      more frequently than once per second. This should improve network
      performance, alleviate queueing problems, and make traffic less
      bursty. Implements proposal 183; closes ticket 3630. Design by
      Florian Tschorsch and Bj??rn Scheuermann; implementation by
      Florian Tschorsch.
  o Minor bugfixes:
    - Change an integer overflow check in the OpenBSD_Malloc code so
      that GCC is less likely to eliminate it as impossible. Patch
      from Mansour Moufid. Fixes bug 4059.
  o Minor bugfixes (usability):
    - Downgrade log messages about circuit timeout calibration from
      "notice" to "info": they don't require or suggest any human
      intervention. Patch from Tom Lowenthal. Fixes bug 4063;
      bugfix on 0.2.2.14-alpha.
  o Minor features (diagnostics):
    - When the system call to create a listener socket fails, log the
      error message explaining why. This may help diagnose bug 4027.

@_date: 2011-09-28 20:12:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.5-alpha is out 
A side effect of this patch is that fast relays may start using more CPU.
If somebody could profile their relay (ideally before-and-after) to
learn whether this is a theoretical concern or a practical concern,
that would be great!

@_date: 2012-04-04 17:16:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor traffic disguised as Skype video calls to fool 
The short answer is that SkypeMorph is not ready for actual usage yet.
It is still at the "research project" stage.
It's great that researchers are working on alternate transports for
Tor -- and that's exactly what we had in mind when we came up with the
'modular transports' notion.
For the more technical side, you can see the discussion starting at
Holy camoley. You are very likely screwing up your anonymity with that
complex and unusual configuration.

@_date: 2012-04-04 18:31:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor traffic disguised as Skype video calls to fool 
My best recommendation is that you run one of the packages listed on
or Running anything else only makes sense if a) you are smarter than the
Tor developers, or b) you don't care about anonymity and want to test
out alternative approaches.

@_date: 2012-04-04 18:45:15
@_author: Roger Dingledine 
@_subject: [tor-talk] access sites 
There has been some research on what Tor *traffic* is, but the methodology
soundness is always a question. The question here though is what the
breakdown of Tor *users* is. Nobody's done a scientifically valid study,
mostly because of the difficulty of getting a good sample when you're
talking about anonymous people.

@_date: 2012-04-04 21:14:53
@_author: Roger Dingledine 
@_subject: [tor-talk] access sites 
Notice that this paper is quite old. Since then Iran, has hit the "
country using Tor" mark:
So I expect the ratios will be different.
One of the important security properties of Tor is that is blends users
together. So if there are 10000 people in Saudi Arabia using Tor today,
and 5000 of them are using it to look at pictures of unclothed ankles,
that actually helps the other 5000 who may be using it for more diverse
(and potentially more risky) activities.
For what it's worth, it's the phrasing of assertions like this that make
people call your posts here trolling.
I am periodically invited to do talks for law enforcement about Tor,
and at basically every talk somebody there tells me they use Tor every
day for their work. See for example
 for an
early report on such a talk.
I've heard from dozens of soldiers and intelligence analysts who use
Tor for their work. Is it such a stretch to imagine that they would want
privacy online too, even if the adversaries they worry about aren't the
same ones you worry about?
This diversity of concerns is part of what makes Tor strong.

@_date: 2012-04-06 16:31:54
@_author: Roger Dingledine 
@_subject: [tor-talk] two tors? 
Actually, you can do it with a single Tor and multiple SocksPort lines,
if you're using Tor 0.2.3.x. See this piece of 0.2.3.3-alpha's changelog:
  o Major features (stream isolation):
    - You can now configure Tor so that streams from different
      applications are isolated on different circuits, to prevent an
      attacker who sees your streams as they leave an exit node from
      linking your sessions to one another. To do this, choose some way
      to distinguish the applications: have them connect to different
      SocksPorts, or have one of them use SOCKS4 while the other uses
      SOCKS5, or have them pass different authentication strings to the
      SOCKS proxy. Then, use the new SocksPort syntax to configure the
      degree of isolation you need. This implements Proposal 171.
    - There's a new syntax for specifying multiple client ports (such as
      SOCKSPort, TransPort, DNSPort, NATDPort): you can now just declare
      multiple *Port entries with full addr:port syntax on each.
      The old *ListenAddress format is still supported, but you can't
      mix it with the new *Port syntax.
You can read more details in the SOCKSPort entry of the 0.2.3 Tor manual.
The advantage to using one Tor with multiple SocksPort lines is that
you don't load down the Tor network with duplicate directory fetches.

@_date: 2012-04-19 23:45:51
@_author: Roger Dingledine 
@_subject: [tor-talk] We're looking for another dedicated core Tor developer 
Your job would be to work on all aspects of the main Tor network daemon
and other open-source software. This would be a contractor position for
2012 (starting as soon as you're ready and with plenty of work to keep
you busy), with the possibility of 2013 and beyond.
Being a core Tor developer includes triaging, diagnosing, and fixing bugs;
looking for and resolving security issues; and working collaboratively
with coworkers and volunteers on implementing new features and protocol
changes at every stage from design to maintenance. We'd also need help
making our code more scalable, testable, and maintainable. Sometimes,
we need to drop everything and scramble to implement last-minute
anticensorship schemes, or to deploy urgent security updates. You'd also
be reviewing other people's code and designs, and looking for ways to
improve it. For an idea of the breadth and depth of the work you'd be
doing, have a look at the ChangeLog file from the Tor source distribution:
See our new jobs page for details:

@_date: 2012-04-23 03:38:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.14-alpha is out 
Tor 0.2.3.14-alpha fixes yet more bugs to get us closer to a release
candidate. It also dramatically speeds up AES: fast relays should
consider switching to the newer OpenSSL library.
(Packages coming eventually.)
Changes in version 0.2.3.14-alpha - 2012-04-23
  o Directory authority changes:
    - Change IP address for ides (v3 directory authority), and rename
      it to turtles.
  o Major bugfixes:
    - Avoid logging uninitialized data when unable to decode a hidden
      service descriptor cookie. Fixes bug 5647; bugfix on 0.2.1.5-alpha.
    - Avoid a client-side assertion failure when receiving an INTRODUCE2
      cell on a general purpose circuit. Fixes bug 5644; bugfix on
      0.2.1.6-alpha.
    - If authorities are unable to get a v2 consensus document from other
      directory authorities, they no longer fall back to fetching
      them from regular directory caches. Fixes bug 5635; bugfix on
      0.2.2.26-beta, where routers stopped downloading v2 consensus
      documents entirely.
    - When we start a Tor client with a normal consensus already cached,
      be willing to download a microdescriptor consensus. Fixes bug 4011;
      fix on 0.2.3.1-alpha.
  o Major features (performance):
    - When built to use OpenSSL 1.0.1, and built for an x86 or x86_64
      instruction set, take advantage of OpenSSL's AESNI, bitsliced, or
      vectorized AES implementations as appropriate. These can be much,
      much faster than other AES implementations.
  o Minor bugfixes (0.2.2.x and earlier):
    - Don't launch more than 10 service-side introduction-point circuits
      for a hidden service in five minutes. Previously, we would consider
      launching more introduction-point circuits if at least one second
      had passed without any introduction-point circuits failing. Fixes
      bug 4607; bugfix on 0.0.7pre1.
    - Change the BridgePassword feature (part of the "bridge community"
      design, which is not yet implemented) to use a time-independent
      comparison. The old behavior might have allowed an adversary
      to use timing to guess the BridgePassword value. Fixes bug 5543;
      bugfix on 0.2.0.14-alpha.
    - Enforce correct return behavior of tor_vsscanf() when the '%%'
      pattern is used. Fixes bug 5558. Bugfix on 0.2.1.13.
    - When sending an HTTP/1.1 proxy request, include a Host header.
      Fixes bug 5593; bugfix on 0.2.2.1-alpha.
    - Don't log that we have "decided to publish new relay descriptor"
      unless we are actually publishing a descriptor. Fixes bug 3942;
      bugfix on 0.2.2.28-beta.
  o Minor bugfixes (0.2.3.x):
    - Fix a bug where a bridge authority crashes (on a failed assert)
      if it has seen no directory requests when it's time to write
      statistics to disk. Fixes bug 5508. Bugfix on 0.2.3.6-alpha.
    - Fix bug stomping on ORPort option NoListen and ignoring option
      NoAdvertise. Fixes bug 5151; bugfix on 0.2.3.9-alpha.
    - In the testsuite, provide a large enough buffer in the tor_sscanf
      unit test. Otherwise we'd overrun that buffer and crash during
      the unit tests. Found by weasel. Fixes bug 5449; bugfix on
      0.2.3.12-alpha.
    - Make sure we create the keys directory if it doesn't exist and we're
      about to store the dynamic Diffie-Hellman parameters. Fixes bug
      5572; bugfix on 0.2.3.13-alpha.
    - Fix a small memory leak when trying to decode incorrect base16
      authenticator during SAFECOOKIE authentication. Found by
      Coverity Scan. Fixes CID 507. Bugfix on 0.2.3.13-alpha.
  o Minor features:
    - Add more information to a log statement that might help track down
      bug 4091. If you're seeing "Bug: tor_addr_is_internal() called with a
      non-IP address" messages (or any Bug messages, for that matter!),
      please let us know about it.
    - Relays now understand an IPv6 address when they get one from a
      directory server. Resolves ticket 4875.
    - Resolve IPv6 addresses in bridge and entry statistics to country
      code "??" which means we at least count them. Resolves ticket 5053;
      improves on 0.2.3.9-alpha.
    - Update to the April 3 2012 Maxmind GeoLite Country database.
    - Begin a doc/state-contents.txt file to explain the contents of
      the Tor state file. Fixes bug 2987.
  o Default torrc changes:
    - Stop listing "socksport 9050" in torrc.sample. We open a socks
      port on 9050 by default anyway, so this should not change anything
      in practice.
    - Stop mentioning the deprecated *ListenAddress options in
      torrc.sample. Fixes bug 5438.
    - Document unit of bandwidth related options in sample torrc.
      Fixes bug 5621.
  o Removed features:
    - The "torify" script no longer supports the "tsocks" socksifier
      tool, since tsocks doesn't support DNS and UDP right for Tor.
      Everyone should be using torsocks instead. Fixes bugs 3530 and
      5180. Based on a patch by "ugh".
  o Code refactoring:
    - Change the symmetric cipher interface so that creating and
      initializing a stream cipher are no longer separate functions.
    - Remove all internal support for unpadded RSA. We never used it, and
      it would be a bad idea to start.

@_date: 2012-04-30 17:05:51
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.15-alpha is out 
Tor 0.2.3.15-alpha fixes a variety of smaller bugs, including making
the development branch build on Windows again.
(Packages coming eventually.)
Changes in version 0.2.3.15-alpha - 2012-04-30
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Make sure that there are no unhandled pending TLS errors before
      reading from a TLS stream. We had checks in 0.1.0.3-rc, but
      lost them in 0.1.0.5-rc when we refactored read_to_buf_tls().
      Bugfix on 0.1.0.5-rc; fixes bug 4528.
    - Fix an assert that directory authorities could trigger on sighup
      during some configuration state transitions. We now don't treat
      it as a fatal error when the new descriptor we just generated in
      init_keys() isn't accepted. Fixes bug 4438; bugfix on 0.2.1.9-alpha.
    - After we pick a directory mirror, we would refuse to use it if
      it's in our ExcludeExitNodes list, resulting in mysterious failures
      to bootstrap for people who just wanted to avoid exiting from
      certain locations. Fixes bug 5623; bugfix on 0.2.2.25-alpha.
    - When building with --enable-static-tor on OpenBSD, do not
      erroneously attempt to link -lrt. Fixes bug 5103.
  o Minor bugfixes (on 0.2.3.x):
    - When Tor is built with kernel headers from a recent (last few
      years) Linux kernel, do not fail to run on older (pre-2.6.28
      Linux kernels). Fixes bug 5112; bugfix on 0.2.3.1-alpha.
    - Fix cross-compilation isssues with mingw. Bugfixes on 0.2.3.6-alpha
      and 0.2.3.12-alpha.
    - Fix compilation with miniupnpc version 1.6; patch from
      Anthony G. Basile. Fixes bug 5434; bugfix on 0.2.3.12-alpha.
    - Fix compilation with MSVC, which had defined MS_WINDOWS. Bugfix
      on 0.2.3.13-alpha; found and fixed by Gisle Vanem.
    - Fix compilation on platforms without unistd.h, or where environ
      is defined in stdlib.h. Fixes bug 5704; bugfix on 0.2.3.13-alpha.
  o Minor features:
    - Directory authorities are now a little more lenient at accepting
      older router descriptors, or newer router descriptors that don't
      make big changes. This should help ameliorate past and future
      issues where routers think they have uploaded valid descriptors,
      but the authorities don't think so. Fix for ticket 2479.
    - Make the code that clients use to detect an address change be
      IPv6-aware, so that it won't fill clients' logs with error
      messages when trying to get the IPv4 address of an IPv6
      connection. Implements ticket 5537.
  o Removed features:
    - Remove the GiveGuardFlagTo_CVE_2011_2768_VulnerableRelays option;
      authorities needed to use it for a while to keep the network working
      as people upgraded to 0.2.1.31, 0.2.2.34, or 0.2.3.6-alpha, but
      that was six months ago. As of now, it should no longer be needed
      or used.

@_date: 2012-08-07 17:51:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.20-rc is out 
Tor 0.2.3.20-rc is the third release candidate for the Tor 0.2.3.x
series. It fixes a pair of code security bugs and a potential anonymity
issue, updates our RPM spec files, and cleans up other smaller issues.
(Packages coming eventually.)
Changes in version 0.2.3.20-rc - 2012-08-05
  o Security fixes:
    - Avoid read-from-freed-memory and double-free bugs that could occur
      when a DNS request fails while launching it. Fixes bug 6480;
      bugfix on 0.2.0.1-alpha.
    - Avoid an uninitialized memory read when reading a vote or consensus
      document that has an unrecognized flavor name. This read could
      lead to a remote crash bug. Fixes bug 6530; bugfix on 0.2.2.6-alpha.
    - Try to leak less information about what relays a client is
      choosing to a side-channel attacker. Previously, a Tor client would
      stop iterating through the list of available relays as soon as it
      had chosen one, thus finishing a little earlier when it picked
      a router earlier in the list. If an attacker can recover this
      timing information (nontrivial but not proven to be impossible),
      they could learn some coarse-grained information about which relays
      a client was picking (middle nodes in particular are likelier to
      be affected than exits). The timing attack might be mitigated by
      other factors (see bug 6537 for some discussion), but it's best
      not to take chances. Fixes bug 6537; bugfix on 0.0.8rc1.
  o Minor features:
    - Try to make the warning when giving an obsolete SOCKSListenAddress
      a little more useful.
    - Terminate active server managed proxies if Tor stops being a
      relay. Addresses parts of bug 6274; bugfix on 0.2.3.6-alpha.
    - Provide a better error message about possible OSX Asciidoc failure
      reasons. Fixes bug 6436.
    - Warn when Tor is configured to use accounting in a way that can
      link a hidden service to some other hidden service or public
      address. Resolves ticket 6490.
  o Minor bugfixes:
    - Check return value of fputs() when writing authority certificate
      file. Fixes Coverity issue 709056; bugfix on 0.2.0.1-alpha.
    - Ignore ServerTransportPlugin lines when Tor is not configured as
      a relay. Fixes bug 6274; bugfix on 0.2.3.6-alpha.
    - When disabling guards for having too high a proportion of failed
      circuits, make sure to look at each guard. Fixes bug 6397; bugfix
      on 0.2.3.17-beta.
  o Packaging (RPM):
    - Update our default RPM spec files to work with mock and rpmbuild
      on RHEL/Fedora. They have an updated set of dependencies and
      conflicts, a fix for an ancient typo when creating the "_tor"
      user, and better instructions. Thanks to Ondrej Mikle for the
      patch series. Fixes bug 6043.
  o Testing:
    - Make it possible to set the TestingTorNetwork configuration
      option using AlternateDirAuthority and AlternateBridgeAuthority
      as an alternative to setting DirServer. Addresses ticket 6377.
  o Documentation:
    - Clarify the documentation for the Alternate*Authority options.
      Fixes bug 6387.
    - Fix some typos in the manpages. Patch from A. Costa. Fixes bug 6500.
  o Code simplification and refactoring:
    - Do not use SMARTLIST_FOREACH for any loop whose body exceeds
      10 lines. Also, don't nest them. Doing so in the past has
      led to hard-to-debug code. The new style is to use the
      SMARTLIST_FOREACH_{BEGIN,END} pair. Addresses issue 6400.

@_date: 2012-08-08 05:50:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, July 2012 
Here's what I said at the beginning of July that I hoped to do:
Done. It was a great dev meeting and hack fest -- we had something like
40 Tor developers in one place. How the community has grown!
Thanks again to Gunner for helping us making sure everything went smoothly
and we kept moving forward:
David Fifield gave a fantastic talk on our Flash Proxy design:
I talked to Greg Norcie a lot about Tor Browser usability issues, progress
we've made so far, and what remains to be done:
If we had enough money we should totally be funding research grants for
people like Greg to do further usability analysis. On the other hand, we
have a pile of known problems and not enough developers to actually fix
them -- so accruing *more* known problems, while great, maybe shouldn't
be the most immediate goal.
I should also draw your attention to Yossi Gilad's paper, "Spying in
the Dark: TCP and Tor Traffic Analysis":
It's another in the line of congestion-based traffic analysis papers
(watch Alice's connection into the Tor network, send some packets to the
suspected exit relay and/or destination website to reduce its TCP window,
and then see if the flow on Alice's side slows down). It's unclear how
bad it is in practice (i.e. how practical the attack is), but it's a
nice example of how congestion attacks are not yet fully understood.
The next PETS will be at Indiana University next summer.
The ecrypt workshop was a tough combination of people who already did
Tor research and people who didn't know that Tor doesn't mix. It ended
up being in part a group discussion of Tor's toughest research attacks,
to try to raise awareness of issues rather than suggest solutions.
Done. I met with EFF people for a day (mainly Peter Eckersley, talking
with Mike Perry and Isis about how to salvage our browser situation
in the face of both Firefox and Chrome including new privacy-invasive
features at a faster clip than we can keep up with).
I had lunch with Prateek Mittal, a post-doc at Berkeley who used to be in
Nikita Borisov's lab at Illinois. Prateek is working on Sybil resistance
and social-network-based security -- e.g. routing through your social
network to resist some of the attacks that Tor has problems with.
I also met briefly with Doug Tygar, a Berkeley prof who is working on
evaluating circumvention tools, and with Vern Paxson's group at ICSI,
who are looking into how to reason about pluggable transports and find
ways to do better at the arms race.
I talked to Karsten and Rob about performance work at the dev meeting,
and we moved each ticket forward individually. I haven't had a chance to
sit down and organize them en masse though:
Nickm now has a list of specific Tor development tasks (mostly of the form
"clean up this patch so it's something we'd be willing to merge").
And Rob has been doing simulations on our current patches to help us
decide which ones should actually help:
I helped Mike get the Tor Browser Hacker job description up and announced:
Now we need to get enough applications and interest that we have great
people to select from.
I just added Andrea to the core people page, along with some other
people who have been core people for a while but never made it onto
the page. We continue to have a blurry line between which of our fine
volunteers happens to make it into the core people page. I think we
should probably put more of them on it -- isis and Moritz come to mind,
as well as David Fifield, Philipp Winter, the Tails people, Ian Goldberg,
and others.
All that said, I don't think we've actually done any sort of announcement
or acknowledgement about the core dev spot. Should we?
Tariq, Ian, I, and others ended up adapting the paper into a WPES
submission, which focuses on Tariq's framework for how to answer questions
about bridge churn.
I still think the investigation has uncovered a really interesting
privacy vulnerability: if the Tor client has perfect connectivity, it
will pick three guards, and if one of them goes offline it will continue
in a degraded "two guard" state rather than picking a fourth guard
and risking showing its circuits to a new relay. So far so good. But a
client with bad connectivity will end up with dozens or even hundreds
of guards on its list, and when one of its top three goes away it will
move to a fourth. Somewhere in there it would seem this is suboptimal
behavior. More research required, as they say.
We released 0.2.3.19-rc on 2012-07-06.
I spent much of my second half of July on this topic, including individual
mail threads with many of the fast exit and non-exit relay operators,
to strengthen the community and learn who is in a good position for
growing their relay.
We have several trac tickets following the "diversity metrics" side:
I also talked to Sathya about having him do his undergrad thesis on the
question of measuring and tracking diversity in the Tor network. It would
be great to see more Tor research groups take an interest and give him
some guidance.
Next steps for me on the exit relay front are to hit up my contacts
at universities (Boston University and University of Waterloo run fast
exits, but many more want to if I just help them enough); figure out how
logistically we can get money to the exit relay operators who need it;
and figure out how to integrate Moritz into the "continuing to strengthen
the relay operator community" role.
Not started. Should do rsn.
I talked to Ian Goldberg about it, and got him talking to George (asn)
at PETS. I believe they have a plan, and I think Brandon Wiley (our
gsoc student) is even planning to integrate it into his python pluggable
transport library. Stay tuned for more details.

@_date: 2012-08-14 16:17:31
@_author: Roger Dingledine 
@_subject: [tor-talk] traffic down 
Actually, it's lower than the minimum. Right now moria1 votes for
flags using these cutoffs:
Aug 14 15:50:01.000 [info] Cutoffs: For Stable, 448725 sec uptime,
565689 sec MTBF. For Fast: 32342 bytes/sec. For Guard: WFU 97.989%,
time-known 691200 sec, and bandwidth 128000 or 131072 bytes/sec.
So if you have less than 32KB/s of bandwidthrate, you won't get
the Fast flag, and basically all the clients will ignore you.
See also

@_date: 2012-08-17 03:40:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Warning: ISP resurrected old tor node 
Agreed, it does appear to be.
Thanks. I say we let it run for a while and see what happens. Tor's
"distributed trust" design means that no single server can do too
much damage to anonymity. (They could perhaps be trying to watch the
exit traffic, but if they wanted to do that, why not just let you keep
running it?)
Sounds to me like you're describing a growing ISP.
Yes indeed.

@_date: 2012-08-21 16:50:59
@_author: Roger Dingledine 
@_subject: [tor-talk] Analyzing the traffic between nodes in my private 
TCP is the transport, and TLS is the application-level data that goes
over TCP.
So your question doesn't make any sense.
Perhaps the monitoring tools you're using are different, or are configured

@_date: 2012-08-21 19:11:07
@_author: Roger Dingledine 
@_subject: [tor-talk] End-to-end correlation for fun and profit 
I think your numbers may not be right (there are a lot of other subtleties
to the calculation), but your point is still generally correct. The Tor
network doesn't have enough diversity relative to an ideal Tor network we
could imagine. Worse, the Internet itself doesn't have as much diversity
as we'd like either.
all examine AS-level path diversity.
See also for another worrying concern about bottlenecks besides ASes. I also
worry about the bottleneck created by trans-ocean cables.
For more details calculating diversity, see
Help appreciated on those tickets!
Really? Across jurisdictions? And for 'all traffic of those relays'?
I don't want to downplay the risk too far, but I think you overestimate
"unsophisticated law enforcement operations".
Well, do you have an alternative design that scales adequately to 6 or
7 figures of users, provides roughly-real-time browsing and other TCP
connections, works on the Internet that we have, and has better traffic
confirmation resistance?
Or said another way, how well do other usable low-latency anonymity
systems hold up to ongoing wiretaps at 25 arbitrary network locations? I
believe the answer is 'mostly less well than Tor'.
tagnaq pointed to my response to a similar question on the tor-relays
talking about the tradeoff between "make it faster but more concentrated"
vs "make it less fast but less concentrated".
It would be interesting to see your stats on as AS level rather than
a /24 netblock level. But the challenge really is that we need to know
what networks the traffic flows traverse upstream -- e.g. how pervasive
a surveiller of Tor traffic could Deutsch Telekom be? This topic goes
back to my earlier blog post:
I think we still do a pretty good job explaining the risks and limitations
of using a system like Tor, e.g. in each Tor talk.
Tor used to print a warning message on start, to explain that it isn't
perfect. But a) no Windows users saw it, and b) it backfired in surprising
ways, like having journalists write "Tor recommends that you use something
else for now, since they're not ready yet":
Thanks for presenting the code too!

@_date: 2012-08-22 16:36:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Reliable server hosting company for Tor exits? 
Tor relays (regardless of exit policy) are listed in the Tor consensus,
which is public -- it has to be so clients can get the list.
As for the problem the blacklisters were trying to solve, at best
they were thinking "I want to block Tor, I'll scrape this page I found
and block all the IPs in it." At worst, they were taking the path all
blacklists eventually take, of "I will punish everything associated with
this thing I hate, in hopes that it will die or at least its neighbors
will pressure it."
See the link at the bottom of
for a fun read.

@_date: 2012-08-30 21:42:44
@_author: Roger Dingledine 
@_subject: [tor-talk] tor browser without tor 
What is "Toiyfy"?
Whatever it is, it is unlikely to have good instructions. :)
Yes, that's correct. Mike decided he couldn't maintain Torbutton's toggle
mode in the face of Mozilla's new release schedule. I can't blame him.
So, to be clearer, Torbutton is no longer intended to be run in your
own Firefox.
The recommended way to do this is to use Tor Browser Bundle (and not
any other Tor thing). If you don't want to use a browser for anything,
then just ignore the browser that comes up. If you want to use something
else like Thunderbird with this Tor, then on Windows you just configure
it to use localhost port 9050, and on Linux or OS X see
You should also be aware that you're probably screwing up your privacy at
the application layer if you use Thunderbird with Tor. The new "Torbirdy"
extension is a good start, but it sure isn't a complete solution yet.

@_date: 2012-12-02 04:19:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Sept 2012 
I've let my status reports lapse while focusing on getting "real" work
done. Here's a start at getting back on track.
- Karen and I attended a conference at the German Foreign Office to help
them decide what role Germany and the EU should have at regulating the
sale of censorship and surveillance tools to dictators:
  - I liked Eric King (from Privacy International)'s suggestion that
    when companies are submitting their tools for export evaluation,
    they should be required to submit their brochures too. Some of these
    companies are just shameless in terms of how they pitch their tool
    in terms of number of bloggers you can round up per unit time. I'm
    convinced that controlling "the worst of the worst" in terms of how
    they can present their product will influence how these products
    spread.
  - That said, these were all (foreign) policy experts, not technologists.
    They all seemed to take it for granted that you could draw a line
    between "bad" products and acceptable / dual-use products. I tried
    to hold back from saying "every time you people try to come up with
    legal phrasings about what technologies are ok, you end up putting
    tools like mine on the wrong side of the line." In retrospect,
    I should have said it more loudly.
  - They were really proud to have Tor representatives there. Having us
    there let them show the world that they had "real technologists"
    at their meeting. There were several cases where the whole breakout
    session turned to me and wanted to know what Tor thought about the
    given question.
  - I met a nice man who worked for a telco/DPI company that deploys
    its products in the Middle East. He raised a compelling argument:
    "Look, you folks are the ones that mandated backdoors in the telco
    equipment we produce, using the term 'lawful intercept'. And
    now you're surprised and upset when bad people use these same
    backdoors? You made us build it that way!" It certainly is easier for
    officials in countries like Germany to think of the world as divided
    between "good" places and "bad" places, but it sure isn't that simple.
- I went to Dagstuhl after that:
I did a talk on the last day about the state of attacks on anonymous
communications systems. I found myself in the curious position of
preparing a talk for serious crypto people, to try to give them
some research topics they can grapple with, and then having a few of
them derail the conversation by arguing that deployment and incentive
questions are the most pressing problems Tor sees, not anonymity research
questions. I think that's probably true, but it doesn't mean that crypto
people are the right ones to tackle those questions. I'm increasingly
pessimistic that the 'serious crypto people' have much to offer real-world
security research.
I had some good chats with other anonymity researchers at Dagstuhl,
including a start on a more scaleable design to hide presence information
for hidden-service chat; and helping George Danezis work through the
tradeoffs in how Tor chooses its paths, and how Tor chooses what circuit
to put a stream on, so he can better analyze Tor's anonymity.
- After that I did a Tor talk for Srdjan Capkun's group at ETH Zurich.
It went very well -- we had a full crowd, and afterwards everybody was
fired up to talk about Tor. The security people at ETH are really sharp
and focused -- I was impressed (and having done a lot of talks at a lot
of universities lately, I don't say that lightly).
- While in Zurich I met with Bernd Fix, board member for the Wau Holland
Foundation. I'd like to sign them up to be our partner in Europe for
disbursing Tor exit relay funding. Progress continues. I also hope we'll
find some partners in the US who can do the same.
- Released Tor 0.2.3.21-rc:
- Released Tor 0.2.4.1-alpha:
- Released Tor 0.2.4.2-alpha:
- Released Tor 0.2.3.22-rc:
- Released Tor 0.2.2.29:
- Released Tor 0.2.4.3-alpha:
- Talked to Collin Anderson about his tech report about Iran's "national
internet" plans. Check out his resulting document:
- Met with SponsorF plus a bunch of other researchers funded under the
same program, to discuss the impact of increased Tor network capacity
on our torperf graphs. I think the meeting happened because the program
manager saw this graph:
along with
the green lines on
and concluded that more capacity was hurting rather than helping. The bigger
picture looks like this though:
showing that the brief spike was just a temporary thing. In fact, the
torperf spike happened at that point because the Tor network was having
overload issues due to some load balancing hiccups. I turned the meeting
around to discuss the various Tor performance improvements I've been
looking at:

@_date: 2012-12-03 04:01:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Oct 2012 
1) I attended WPES and the first day of CCS:
There are a bunch of new Tor-related research papers:
  - "Changing of the Guards: A Framework for Understanding and Improving
    Entry Guard Selection in Tor"
        Basically Tariq has written a suite of tools for analyzing how
    likely an adversary is to be able to see a Tor user's circuits given
    various values for guard selection and guard rotation. Early results
    include "three guards is probably the wrong number" and "we probably
    shouldn't rotate guards so often". Later results I hope will include
    "here's an algorithm for assigning the Guard flag to relays that
    makes users safer".
  - "Torchestra: Reducing interactive traffic delays over Tor"
        This paper suggests having two parallel TLS connections between each
    pair of relays -- one for the loud circuits and one for the quiet
    ones. I've had a series of debates with Rob Jansen over whether this
    should really help, or if it's just shifting the round-robining to
    a deeper level (e.g. kernel-level buffers). My current opinion is
    that it should really help, not because it writes important bytes
    out faster, but because the other side can *read* important bytes
    faster -- in the current state a relay can't predict which incoming
    bytes are going to be high-priority, but when high-priority bytes
    come on a separate TCP connection, it's easy to tell.
  - "Enhancing Tor's Performance using Real-time Traffic Classification"
        I haven't read it in detail yet, but it looks at using machine
    learning to classify circuits depending on what sort of traffic
    they're carrying. This direction is worthwhile, but it skips over
    the question that Rob and I are currently wrestling with, which is
    "ok, so you've decided to give lower priority to a circuit. What
    should you actually do to make that circuit put less load on the
    network?" See also Rob's Usenix Security paper:
      - "SkypeMorph: Protocol Obfuscation for Tor Bridges"
        The idea is to use the actual Skype program to make a (TCP) video call
    between user and bridge, and then drop the call and start up your
    own UDP traffic flows that mimic Skype's UDP flows in terms of size
    and timing. I'm not clear that trying to look like Skype is a game
    we can win (especially with DPI-level adversaries already playing
    the arms race to detect and block 'real' Skype, and with the wasted
    bandwidth that comes with pretending to be a Skype video call), but
    I think we can get a lot of mileage out of a Tor pluggable transport
    that carries Tor traffic over a UDP flow -- especially with recent
    rumors of a Syrian ISP throttling all TCP flows.
  - "StegoTorus: A Camouflage Proxy for the Tor Anonymity System"
        Stegotorus is an obfsproxy fork with two goals: first, chop up Tor
    traffic flows so you can't recognize Tor traffic just by looking for
    more 586-byte TCP packets than usual; and second, transport those
    chopped-up flows over a variety of steg modules, to hide the traffic
    in protocols that the adversary is unwilling to block (as opposed to
    obfsproxy's goal, which is to make a flow that's hard enough to DPI
    for that the adversary has to choose between blocking all unrecognized
    protocols or letting the flows through). Unfortunately, there aren't
    any great steg modules yet; rather, it aims to be a framework where
    if you *did* have a great steg module, you could just pop it in.
  - "CensorSpoofer: Asymmetric Communication using IP Spoofing for
    Censorship-Resistant Web Browsing"
        It's designed for censored users who mostly consume bytes rather
    than produce them. This design also uses a UDP stream to deliver the
    bytes, but they spoof the stream as coming from a plausible-looking
    voip client rather than from the real source. Then they need some
    low-latency low-bandwidth way (e.g. instant messaging) to get the
    upstream packets to the server.
    This recent variety of pluggable-transport designs and research
    papers is great. It also makes me realize that somebody should
    put some effort into identifying the various components that a Tor
    transport system needs, and which papers provide which components. For
    example, it sounds like SkypeMorph and CensorSpoofer could share
    the same details for the link encryption and flow control for their
    UDP stream, rather than inventing two separately. Similarly, the
    "small upstream channel" requirement from CensorSpoofer reminds me
    of the similar goal that David's Flashproxy design faces.
  - There's also "Touching from a Distance: Website Fingerprinting
    Attacks and Defenses"
        But I confess I haven't looked at it yet. Website fingerprinting
    remains a huge and open issue that needs more attention.
2) Then I attended an FBI conference, as part of my work to try to
keep Tor on good relations with law enforcement. My first goal is to
remind them of all the good uses of Tor, so if they ever find themselves
lobbying to outlaw anonymity online, they'll understand what they're
giving up. The second goal is to make sure they understand what Tor is
and how it works, so if they encounter it in their investigations they'll
hassle our exit relay operators less. (Here's a great way that one FBI
person explained it to me: "I've got 10 leads, and 48 hours before this
case doesn't matter anymore. If you can help me understand which leads
*not* to follow, I can do my job better.") My third goal is to help
them be able to use Tor correctly for their own jobs -- remember that
diversity of users is part of what makes Tor safe for everybody to use.
Overall, we've been doing a pretty good job at teaching US-based law
enforcement about Tor. At the end of the conference, one of the FBI agents
took me aside and asked "surely you have *some* sort of way of tracking
your users?" When I pointed at various of his FBI colleagues in the room
who had told me they use Tor every day for their work, and asked if he'd
be comfortable if we had a way of tracing *them*, I think he got it.
I met a nice man from the DEA who worked on the "Farmer's Market" bust.
This was in the news a lot back in April, where apparently some people
were selling drugs online, and using a Tor hidden service for their
website. At the time I thought the news stories could be summarized
simply as "idiot drug sellers accept paypal payments, get busted." It
turns out they were pretty smart about how to accept paypal payments --
they just had random Americans receive the paypal payments, take a cut,
and then turn them into a Panama-based digital currency, and the Panama
company didn't want to help trace where the money went. The better summary
for the news stories should actually have been "idiot drug sellers use
hushmail, get busted." Way before they switched to a Tor hidden service,
the two main people used Hushmail to communicate. After a subpoena
(and apparently a lot of patience since Canada still isn't quite the
same as the US), Hushmail rolled over and gave up copies of all the
emails. Many more details here:
I should still note that Tor doesn't introduce any magic new silver
bullet that causes criminals to be uncatchable when before they weren't.
The Farmer's Market people ran their webserver from Malaysia before
they switched to a Tor hidden service, and just the fact that Malaysia
didn't want to cooperate in busting them was enough to make that a dead
end. Jurisdictional arbitrage is alive and well in the world.
3) While there, I talked to some friends from MIT who now work on the
Akamai security team. I walked them through how they could usefully
contribute to Tor, and now they're running a pile of fast exit relays:
4) From there, I went to DC for a week to participate in the SponsorF
"red team" event: they're funding some smart network security hackers to
evaluate Tor, obfsproxy, Stegotorus, etc and try to find holes in our
design and implementation.
They mostly ignored Tor, since it's gotten so much analysis and attention
from others in the research community. I wrote this list of attacks to
help convince them to focus on our other tools:
Useful outcomes included:
  -   -   -   - The realization that as the arms races continue, pluggable transport
    designs will have to embed their messages inside the traffic generated
    by the actual programs they're trying to imitate: e.g. we'll need
    to ship a browser if we want our traffic to look like a browser
    generated it. Anything else is a recipe for losing the arms race.
5) That week I finished hammering out the list of items that we're going
to promise for year3 of the grant:
There are also a bunch of items we brainstormed that didn't make the final
list; hopefully those other items will make further censorship-research
funding proposals smoother.
6) From there, I went to UT Austin to do a talk for Vitaly Shmatikov's
research group. Nikita Borisov's grad student, Amir Houmansadr,
is post-docing with Vitaly, and they're working on interesting
pluggable-transport-related research. More details when their papers
get accepted.
Other things I did in October:
- Helped plan for some extra funding from SponsorJ, which
resulted in new tasks 10-13 at the end of the list on
We're going to need to hire some more browser hackers at this rate.
- Put out the blurb for the Flashproxy position, and helped David Fifield
look at some candidates. The result is that we're now paying Alexandre
Allaire to work on Flashproxy. Woo! And we could in theory pay some more
people if the perfect people show up.
- Put out the blurb for our Project Coordinator position. Helped to
interview some candidates, but we have many more to interview. It seems
we could really use a project coordinator to help us coordinate the
process of hiring a project coordinator.
- Released Tor 0.2.3.23-rc:
- Released Tor 0.2.4.4-alpha:
- Released Tor 0.2.3.24-rc:
including writing up the Tor 0.2.3 Release Notes:
- Released Tor 0.2.4.5-alpha:

@_date: 2012-12-10 03:25:21
@_author: Roger Dingledine 
@_subject: [tor-talk] Aggregate-type settings in torrc 
I believe the answer is "because the code can't yet handle the concept
of having a bridge configured for a given pluggable transport yet not
having that transport ready for use".
See also
It would be great to get this fixed, so we can include various pluggable
transports in the default client bundles.

@_date: 2012-12-13 15:47:36
@_author: Roger Dingledine 
@_subject: [tor-talk] obfsproxy like approach against website traffic 
Obfsproxy transforms each byte, but it doesn't change timing or size. So
I expect it does nothing against website fingerprinting.
To protect against somebody recognizing that the obfsproxied flows
are really Tor traffic underneath (i.e. by noticing a lot of 586-byte
packets), you'll want a chopper as well as obfsproxy. See the Stegotorus
paper: But ultimately, the good website fingerprinting attacks look at overall
flow volume, so you'll want something that pads your sent/received flows
so they collide with a lot of other potential websites, without adding
too much overhead.
For the latest website fingerprinting paper, see Rob Johnson's "Touching
from a Distance" paper 2012.

@_date: 2012-12-15 04:41:30
@_author: Roger Dingledine 
@_subject: [tor-talk] traffic down 
The directory authorities assign the Fast flag to the top 7/8s of
relays by bandwidth:
Lately this cutoff has been around the 40KB mark.
It's an area of active research what the relationship is between this
"minimum bandwidth cutoff" and the resulting performance changes:
but I am increasingly suspecting that raising it to 100KB or even 500KB
would produce an improvement.

@_date: 2012-12-19 00:58:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Nov 2012 
Six big things I did in November:
1) Attended the NSF PI meeting for our new grant (joint with Georgia
Tech and Princeton). Met dozens of professors and renewed connections
to dozens more. One standout: I met a nice economist who framed our
exit relay funding debate as an "if you" vs "now that" game. When you
incentivize people with "if you X, I'll Y", they behave differently than
when it's "now that you've X, I'll Y".
2) Went to Georgia Tech to meet with Nick Feamster's group about the NSF
grant. It will be about Tor network measurement, circumvention evaluation,
OONI, and in the spirit of NSF grants, whatever other research projects
the group finds worthwhile. We (me, Jake, Arturo, Isis, maybe others)
will meet with them again in mid January.
3) Helped Nick Hopper submit an NSF "medium" proposal around
privacy-preserving Tor network / user behavior measurements. We're still
on track to hire Nick as our research director for his sabbatical year
starting this summer, and this funding would help him have good students.
4) Wrote proposal 213 ("Remove stream-level sendmes from the design"):
After discussion, one of the flaws in the proposal turns out to be a flaw
in the n23 congestion control algorithm too:
(thanks to Andreas Krey)
5) Attended Foreign Policy's "Global Thinkers Gala" where they named Nick,
Paul, and me as global foreign policy thinkers:
I talked to a lot of journalists who had never heard of Bluecoat or
their exports to Syria :(, as well as a lot of State Dept people whose
jobs are to create foreign policy. One person I met was tasked by Congress
with designing and deploying the US sanctions against Iran.
6) Released Tor 0.2.4.6-alpha:
Released Tor 0.2.3.25, the first stable in the 0.2.3 branch:
But I still haven't mailed tor-announce because our new Windows and OSX
TBB packages still have bugs.

@_date: 2012-12-21 03:43:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Please make a screenshot of your favorite Tor component 
Hi folks,
I'm preparing our talk for next week at 29c3.
So far I've made a preliminary list of software in the Tor ecosystem:
Since words are so boring in slides, I've started collecting a set of
screenshots / images to use instead. You can see the URLs listed in the
above link.
If I don't have a URL next to a component you like (or if you have one
that's better), please make an image, send it to me, and I'll add it to
the list.
Note that I'm going to project these onto a screen, so lots of tiny text
isn't so good. That said, I can just show the cool part if it's a big
screenshot with a particular cool part.  And something is better than
nothing, so don't be shy.
Also, if I missed any components that we should let the world know about,
please let me know that too.

@_date: 2012-12-25 02:27:53
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.7-alpha is out 
Tor 0.2.4.7-alpha introduces a new approach to providing fallback
directory mirrors for more robust bootstrapping; fixes more issues where
clients with changing network conditions refuse to make any circuits;
adds initial support for exiting to IPv6 addresses; resumes being able
to update our GeoIP database, and includes the geoip6 file this time;
turns off the client-side DNS cache by default due to privacy risks;
and fixes a variety of other issues.
Packages will come later (it's an alpha after all).
Changes in version 0.2.4.7-alpha - 2012-12-24
  o Major features (client resilience):
    - Add a new "FallbackDir" torrc option to use when we can't use
      a directory mirror from the consensus (either because we lack a
      consensus, or because they're all down). Currently, all authorities
      are fallbacks by default, and there are no other default fallbacks,
      but that will change. This option will allow us to give clients a
      longer list of servers to try to get a consensus from when first
      connecting to the Tor network, and thereby reduce load on the
      directory authorities. Implements proposal 206, "Preconfigured
      directory sources for bootstrapping". We also removed the old
      "FallbackNetworkstatus" option, since we never got it working well
      enough to use it. Closes bug 572.
    - If we have no circuits open, use a relaxed timeout (the
      95-percentile cutoff) until a circuit succeeds. This heuristic
      should allow Tor to succeed at building circuits even when the
      network connection drastically changes. Should help with bug 3443.
  o Major features (IPv6):
    - Tor now has (alpha) support for exiting to IPv6 addresses. To
      enable it as an exit node, make sure that you have IPv6
      connectivity, then set the IPv6Exit flag to 1. Also make sure your
      exit policy reads as you would like: the address * applies to all
      address families, whereas *4 is IPv4 address only, and *6 is IPv6
      addresses only. On the client side, you'll need to wait until the
      authorities have upgraded, wait for enough exits to support IPv6,
      apply the "IPv6Traffic" flag to a SocksPort, and use Socks5. Closes
      ticket 5547, implements proposal 117 as revised in proposal 208.
      We DO NOT recommend that clients with actual anonymity needs start
      using IPv6 over Tor yet, since not enough exits support it yet.
  o Major features (geoip database):
    - Maxmind began labelling Tor relays as being in country "A1",
      which breaks by-country node selection inside Tor. Now we use a
      script to replace "A1" ("Anonymous Proxy") entries in our geoip
      file with real country codes. This script fixes about 90% of "A1"
      entries automatically and uses manual country code assignments to
      fix the remaining 10%. See src/config/README.geoip for details.
      Fixes bug 6266. Also update to the December 5 2012 Maxmind GeoLite
      Country database, as modified above.
  o Major bugfixes (client-side DNS):
    - Turn off the client-side DNS cache by default. Updating and using
      the DNS cache is now configurable on a per-client-port
      level. SOCKSPort, DNSPort, etc lines may now contain
      {No,}Cache{IPv4,IPv6,}DNS lines to indicate that we shouldn't
      cache these types of DNS answers when we receive them from an
      exit node in response to an application request on this port, and
      {No,}UseCached{IPv4,IPv6,DNS} lines to indicate that if we have
      cached DNS answers of these types, we shouldn't use them. It's
      potentially risky to use cached DNS answers at the client, since
      doing so can indicate to one exit what answers we've gotten
      for DNS lookups in the past. With IPv6, this becomes especially
      problematic. Using cached DNS answers for requests on the same
      circuit would present less linkability risk, since all traffic
      on a circuit is already linkable, but it would also provide
      little performance benefit: the exit node caches DNS replies
      too. Implements a simplified version of Proposal 205. Implements
      ticket 7570.
  o Major bugfixes (other):
    - Alter circuit build timeout measurement to start at the point
      where we begin the CREATE/CREATE_FAST step (as opposed to circuit
      initialization). This should make our timeout measurements more
      uniform. Previously, we were sometimes including ORconn setup time
      in our circuit build time measurements. Should resolve bug 3443.
    - Fix an assertion that could trigger in hibernate_go_dormant() when
      closing an or_connection_t: call channel_mark_for_close() rather
      than connection_mark_for_close(). Fixes bug 7267. Bugfix on
      0.2.4.4-alpha.
    - Include the geoip6 IPv6 GeoIP database in the tarball. Fixes bug
      7655; bugfix on 0.2.4.6-alpha.
  o Minor features:
    - Add a new torrc option "ServerTransportListenAddr" to let bridge
      operators select the address where their pluggable transports will
      listen for connections. Resolves ticket 7013.
    - Allow an optional $ before the node identity digest in the
      controller command GETINFO ns/id/, for consistency with
      md/id/ and desc/id/. Resolves ticket 7059.
    - Log packaged cell fullness as part of the heartbeat message.
      Diagnosis to try to determine the extent of bug 7743.
  o Minor features (IPv6):
    - AutomapHostsOnResolve now supports IPv6 addresses. By default, we
      prefer to hand out virtual IPv6 addresses, since there are more of
      them and we can't run out. To override this behavior and make IPv4
      addresses preferred, set NoPreferIPv6Automap on whatever SOCKSPort
      or DNSPort you're using for resolving. Implements ticket 7571.
    - AutomapHostsOnResolve responses are now randomized, to avoid
      annoying situations where Tor is restarted and applications
      connect to the wrong addresses.
    - Never try more than 1000 times to pick a new virtual address when
      AutomapHostsOnResolve is set. That's good enough so long as we
      aren't close to handing out our entire virtual address space;
      if you're getting there, it's best to switch to IPv6 virtual
      addresses anyway.
  o Minor bugfixes:
    - The ADDRMAP command can no longer generate an ill-formed error
      code on a failed MAPADDRESS. It now says "internal" rather than
      an English sentence fragment with spaces in the middle. Bugfix on
      Tor 0.2.0.19-alpha.
    - Fix log messages and comments to avoid saying "GMT" when we mean
      "UTC". Fixes bug 6113.
    - Compile on win64 using mingw64. Fixes bug 7260; patches from
      "yayooo".
    - Fix a crash when debugging unit tests on Windows: deallocate a
      shared library with FreeLibrary, not CloseHandle. Fixes bug 7306;
      bugfix on 0.2.2.17-alpha. Reported by "ultramage".
  o Renamed options:
    - The DirServer option is now DirAuthority, for consistency with
      current naming patterns. You can still use the old DirServer form.
  o Code simplification and refactoring:
    - Move the client-side address-map/virtual-address/DNS-cache code
      out of connection_edge.c into a new addressmap.c module.
    - Remove unused code for parsing v1 directories and "running routers"
      documents. Fixes bug 6887.

@_date: 2012-12-27 00:26:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Nov 2012 
I asked for more details, and here's the answer:
Check out Daniel Pink's book titled "drive."  The first one is called
"If-then" reward structure and the other one is called "Now-that" reward
structure. Hope that helps.
Apparently there's a TED talk that is a pretty good stand-in for the book.

@_date: 2012-12-30 00:24:13
@_author: Roger Dingledine 
@_subject: [tor-talk] Telex Circumvention tool 
There are actually three variations on this idea:
Ian Goldberg, one of the Telex authors, is on our board and is a
Tor researcher.
Current status is that it needs deployment in a router where it would
have popular websites behind it that censors don't want to block.
There's also plenty more coding work, etc.

@_date: 2012-02-06 17:47:46
@_author: Roger Dingledine 
@_subject: [tor-talk] tor-blocking sites 
Google doesn't specifically single out exit relays. Google pops up a
captcha when a given IP address has asked it too many questions recently.
It's a defense mechanism against crawlers from, say, Bing who are trying
to steal their precious secret sauce.
You may like In theory the Tor protocol supports an "exit bridge" concept: the Tor
design separates the relaying component (how to establish a circuit given
a set of relays) from the discovery component (how to learn what relays
to use), so you could just bolt on another discovery mechanism. But
nobody has designed or implemented one.

@_date: 2012-02-10 06:58:53
@_author: Roger Dingledine 
@_subject: [tor-talk] Help users in Iran reach the internet 
Note that obfsproxy bridges currently don't contribute to the stats. You
can think of them like private bridges in that respect.
But it also means that while Iran maintains its network-wide SSL
filtering, the public metrics numbers will drop for Iran even if all
the users there have switched to obfsproxy.
Yep. We've made a Windows Tor Browser Bundle with obfsproxy and some fast
obfsproxy bridges built-in. Current plan is to keep testing that bundle,
and tomorrow ish we'll put out a newer bundle with a larger array of
bridges built-in, and then let our friends in-country spread the word.

@_date: 2012-02-10 08:34:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Help users in Iran reach the internet 
If you have to choose, I'd say stick with the middle node. After all,
we need there to be a robust fast Tor network for people to get to.
Surprisingly, Iran only uses DPI and not IP:port filters. That's not
entirely true anymore (e.g. apparently they blocked one of the A records
for  but it's still mostly true.

@_date: 2012-02-10 08:43:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Help users in Iran reach the internet 
You need to be running Tor 0.2.3.11-alpha or later.

@_date: 2012-02-11 21:57:55
@_author: Roger Dingledine 
@_subject: [tor-talk] obfsproxy on CentOS 6 (help Iran) 
Please don't run an obfsproxy bridge with Tor 0.2.2 though.
Your clients will very likely be running 0.2.3.x, and they'll get bitten
by bug 4013:
which will be fixed in Tor 0.2.3.12-alpha (not yet released).
Even once they're running our patch, your bridge will still cause them
to downgrade to the older more cumbersome directory design, which will
delay bootstrapping.
So feel free to run your obfsproxy as an external proxy, but your
clients will like you more if you run it with Tor 0.2.3.x.

@_date: 2012-02-13 11:26:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.12-alpha is out 
Tor 0.2.3.12-alpha lets fast exit relays scale better, allows clients
to use bridges that run Tor 0.2.2.x, and resolves several big bugs
when Tor is configured to use a pluggable transport like obfsproxy.
(Packages coming eventually.)
Changes in version 0.2.3.12-alpha - 2012-02-13
  o Major bugfixes:
    - Fix builds when the path to sed, openssl, or sha1sum contains
      spaces, which is pretty common on Windows. Fixes bug 5065; bugfix
      on 0.2.2.1-alpha.
    - Set the SO_REUSEADDR socket option before we call bind() on outgoing
      connections. This change should allow busy exit relays to stop
      running out of available sockets as quickly. Fixes bug 4950;
      bugfix on 0.2.2.26-beta.
    - Allow 0.2.3.x clients to use 0.2.2.x bridges. Previously the client
      would ask the bridge for microdescriptors, which are only supported
      in 0.2.3.x, and then fail to bootstrap when it didn't get the
      answers it wanted. Fixes bug 4013; bugfix on 0.2.3.2-alpha.
    - Avoid an assert when managed proxies like obfsproxy are configured,
      and we receive HUP signals or configuration values too rapidly. This
      situation happens most commonly when Vidalia tries to attach to
      Tor or tries to configure the Tor it's attached to. Fixes bug 5084;
      bugfix on 0.2.3.6-alpha.
    - Properly set up obfsproxy's environment when in managed mode. The
      Tor Browser Bundle needs LD_LIBRARY_PATH to be passed to obfsproxy,
      and when you run your Tor as a daemon, there's no HOME. Fixes bugs
      5076 and 5082; bugfix on 0.2.3.6-alpha.
  o Minor features:
    - Use the dead_strip option when building Tor on OS X. This reduces
      binary size by almost 19% when linking openssl and libevent
      statically, which we do for Tor Browser Bundle.
    - Fix broken URLs in the sample torrc file, and tell readers about
      the OutboundBindAddress, ExitPolicyRejectPrivate, and
      PublishServerDescriptor options. Addresses bug 4652.
    - Update to the February 7 2012 Maxmind GeoLite Country database.
  o Minor bugfixes:
    - Downgrade the "We're missing a certificate" message from notice
      to info: people kept mistaking it for a real problem, whereas it
      is seldom the problem even when we are failing to bootstrap. Fixes
      bug 5067; bugfix on 0.2.0.10-alpha.
    - Don't put "TOR_PT_EXTENDED_SERVER_PORT=127.0.0.1:4200" in a
      managed pluggable transport server proxy's environment.
      Previously, we would put it there, even though Tor doesn't
      implement an 'extended server port' yet, and even though Tor
      almost certainly isn't listening at that address. For now, we set
      it to an empty string to avoid crashing older obfsproxies. Bugfix
      on 0.2.3.6-alpha.
    - Log the heartbeat message every HeartbeatPeriod seconds, not every
      HeartbeatPeriod + 1 seconds. Fixes bug 4942; bugfix on
      0.2.3.1-alpha. Bug reported by Scott Bennett.
    - Calculate absolute paths correctly on Windows. Fixes bug 4973;
      bugfix on 0.2.3.11-alpha.
    - Update "ClientOnly" man page entry to explain that there isn't
      really any point to messing with it. Resolves ticket 5005.
    - Use the correct CVE number for CVE-2011-4576 in our comments and
      log messages. Found by "fermenthor". Resolves bug 5066; bugfix on
      0.2.3.11-alpha.
  o Code simplifications and refactoring:
    - Use the _WIN32 macro throughout our code to detect Windows.
      (Previously we had used the obsolete 'WIN32' and the idiosyncratic
      'MS_WINDOWS'.)

@_date: 2012-02-19 14:24:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor directory servers 
The correct way to do it is to fetch the descriptors and look at
their exit policy. Whether a given relay is an exit router is not a
boolean thing:
Run your own Tor client (using Tor 0.2.2.x), and look in your datadir for
the consensus file and the descriptors. You can read about the formats
in the dir-spec.txt file in the torspec git repository.
And if those sentences didn't make sense, maybe you should take a step
back and explain what your script is trying to do?

@_date: 2012-02-21 12:58:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor users trackable with common proxy? 
Not feasible (assuming you're using Tor correctly).

@_date: 2012-02-21 13:48:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor users trackable with common proxy? 
Yeah, this paragraph smells like FUD. It all comes down to what they mean
by "track down a person online". Concentrating all their traffic through
a single proxy means that it's easy for them to see where your traffic is
going. In the case of Tor, they will see that your traffic is going to a
Tor relay (if they know how to look. If you're using a Tor bridge, they'd
have to notice the Tor protocol; if you're using obfsproxy, they'd have
to notice the obfsproxy protocol). But in all of these cases, they'd need
to break Tor in order to learn what actual destination you're asking for.
In short, it sounds like one of those cases where they're trying to
scare you away from using Tor, so you'll do something they can break
more easily.

@_date: 2012-02-23 19:21:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor bridge with no traffic 
Sounds like you are thinking that the last hop in the circuit is called
the exit node, and earlier hops in the circuit are called bridges? This
is not so.
The last hop in the circuit is the exit relay. Hops other than the last
are called non-exit relays. The first hop is called the entry relay or
entry guard.
Bridges are unlisted entry relays. They replace the first hop (which
ordinarily would be in the public list of relays and thus easy to find
and block) with one that the user has found through some other process
and explicitly configured.
Maybe you are wanting to be a non-exit relay?

@_date: 2012-02-29 12:34:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Does obfsproxy make any sense for relays 
Actually, this scenario happens in practice in Iran.
Somebody needs to sit down and solve
first, or clients that configure your relay as their bridge will
trigger an assert after a while. Solving it involves refactoring how
we keep track of what purpose each descriptor is for. (In the past,
small bandaids have turned out not to be a good idea.)

@_date: 2012-01-08 06:25:49
@_author: Roger Dingledine 
@_subject: [tor-talk] How to uninstall? 
It all depends on how you installed it.
Assuming you installed the Tor Browser Bundle (the recommended download),
it's a standalone thing that would not have messed with any of your
other applications.

@_date: 2012-01-08 06:58:20
@_author: Roger Dingledine 
@_subject: [tor-talk] A question about Tor & Hidden Services 
Not currently. We'd welcome a control protocol patch to implement that.

@_date: 2012-01-22 00:26:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor plus VPN (was re: Hi all!) 
Another advantage here is that it prevents Tor from seeing who you are
behind the VPN. So if somebody does manage to break Tor and learn the IP
address your traffic is coming from, but your VPN was actually following
through on their promises (they won't watch, they won't remember, and
they will somehow magically make it so nobody else is watching either),
then you'll be better off.
Even if you pay for them anonymously, you're making a bottleneck where
all your traffic goes -- the VPN can build a profile of everything you
do, and over time that will probably be really dangerous.
In short, I think "You -> VPN provider -> Tor network" can be a fine idea,
assuming your VPN provider's network is in fact sufficiently safer than
your own network; but "You -> Tor network -> VPN provider" is generally
a really poor plan.

@_date: 2012-01-22 03:55:05
@_author: Roger Dingledine 
@_subject: [tor-talk] IDEA: Compress traffic at exit 
Yep. We actually had this idea way back in 2003:
We even partially implemented it. The implementation got messy quicker
than expected, so we abandoned it.
It's possible that with the new libevent2 "filter layer" design it would
be a lot easier in the future.
We decided at the time that it was ok to abandon it on the theory that a)
most big things on the internet are compressed already, and b) if it's
not a big thing, then compressing it isn't really going to buy you a
whole lot. It would be great to see some numbers to support or refute
this theory.
Theory: Good webservers compress by default if the browser headers
indicate it's supported; and good browsers offer to receive compressed
content by default.
Again, it would be great to get some numbers to support/refute. It would
also be good to confirm that we don't screw any of that up with Torbutton.
This idea was also listed on the 2003 post. :)
For more details, there's even a paper written about the topic:
This idea comes with an additional advantage: it can improve anonymity,
since it breaks up the timing and volume characteristics of the flows
at each side.
Ultimately, the deal-breaker here is that the legal liability question
shifts dramatically when you change from being a transit provider ("bytes
go in, bytes go out") to having content stored "at" the relays. From a
technical perspective we might just put the cache in ram and thus there's
no stored content; but it's really not worth introducing the possibility
that some poor exit relay operator will have to sit down with the judge,
jury, and lawyers and try to teach them how computers work -- in terms
that fit a telephone metaphor since that's what most of the laws expect.

@_date: 2012-01-22 04:07:54
@_author: Roger Dingledine 
@_subject: [tor-talk] IDEA: Compress traffic at exit 
I think these are all important problems to tackle. It is certainly the
case that the Tor network doesn't have enough capacity these days to
handle all the users who want to use it. Tor relays that have a huge
amount of capacity start to hit up against CPU and file descriptor
limits. Most Tor relays are bandwidth-limited though.
I'm told that networking people think of networks as hopelessly congested
when their load passes 10% or 20% of capacity. We have a long way to go
before we can reach that. :)
For huge relays, I tend to agree. For most of the rest, it would help.
Things get complexer though because even if the exit relay has plenty
of spare capacity, that doesn't mean the middle or entry relay in the
circuit does. And the exit relay isn't supposed to know the topology of
the circuit.
Right -- I think it's clearly better for the application level to compress
its traffic, rather than having Tor do it blindly.
I think blindly doing compression wouldn't run afoul of the "you're
looking at content" issues. But I totally agree that examining the
content to decide what (or whether) to compress is madness.

@_date: 2012-01-22 04:41:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Could BACKLIT be implemented by Tor 
It could be implemented by Tor. There's a lot of research remaining
though. The first hurdle would be how to approximate all the knowledge
that the detector gets in their paper when you don't get to be root or
watch the raw packets. The second would be trying to reproduce their
results on a non toy network.
I'd be curious to learn what sort of efficiency it can get, and at what
performance cost, especially as the arms race continues (i.e. when the
next traffic watermarking paper comes out claiming that backlit can't
find it).
See also However, even if it were implemented by Tor, it would not actually
do what you hope. That is, it would not protect its users from
traffic analysis. That's because *passive* traffic confirmation
attacks, without any need for active mucking with the flows,
already work great through Tor, and there are no known fixes.
See  for background here.
Then see

@_date: 2012-01-22 05:40:45
@_author: Roger Dingledine 
@_subject: [tor-talk] tor-bundle , ssh , torsock howto ? 
You don't want to use tortunnel or torproxy. Tortunnel is an independent
implementation of a Tor client, which aims to provide better performance
by screwing your anonymity.
Specifically, it tries to cheat and use a one-hop circuit, which is
dangerous for the relay operators and foolish for your anonymity:
(This trick doesn't work on exit relays running 0.2.2.17-alpha or later.)
Depending on your OS, you might like

@_date: 2012-01-23 03:17:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.11-alpha is out 
Tor 0.2.3.11-alpha marks feature-freeze for the 0.2.3 tree. It deploys
the last step of the plan to limit maximum circuit length, includes
a wide variety of hidden service performance and correctness fixes,
works around an OpenSSL security flaw if your distro is too stubborn
to upgrade, and fixes a bunch of smaller issues.
Note that the tarball and git tags are signed by my newer (4096 bit)
gpg key, 0x19F78451.
(Packages coming eventually.)
Changes in version 0.2.3.11-alpha - 2012-01-22
  o Major features:
    - Now that Tor 0.2.0.x is completely deprecated, enable the final
      part of "Proposal 110: Avoiding infinite length circuits" by
      refusing all circuit-extend requests that do not use a relay_early
      cell. This change helps Tor resist a class of denial-of-service
      attacks by limiting the maximum circuit length.
    - Adjust the number of introduction points that a hidden service
      will try to maintain based on how long its introduction points
      remain in use and how many introductions they handle. Fixes
      part of bug 3825.
    - Try to use system facilities for enumerating local interface
      addresses, before falling back to our old approach (which was
      binding a UDP socket, and calling getsockname() on it). That
      approach was scaring OS X users whose draconian firewall
      software warned about binding to UDP sockets, regardless of
      whether packets were sent. Now we try to use getifaddrs(),
      SIOCGIFCONF, or GetAdaptersAddresses(), depending on what the
      system supports. Resolves ticket 1827.
  o Major security workaround:
    - When building or running with any version of OpenSSL earlier
      than 0.9.8s or 1.0.0f, disable SSLv3 support. These OpenSSL
      versions have a bug (CVE-2011-4576) in which their block cipher
      padding includes uninitialized data, potentially leaking sensitive
      information to any peer with whom they make a SSLv3 connection. Tor
      does not use SSL v3 by default, but a hostile client or server
      could force an SSLv3 connection in order to gain information that
      they shouldn't have been able to get. The best solution here is to
      upgrade to OpenSSL 0.9.8s or 1.0.0f (or later). But when building
      or running with a non-upgraded OpenSSL, we disable SSLv3 entirely
      to make sure that the bug can't happen.
  o Major bugfixes:
    - Fix the SOCKET_OK test that we use to tell when socket
      creation fails so that it works on Win64. Fixes part of bug 4533;
      bugfix on 0.2.2.29-beta. Bug found by wanoskarnet.
    - Correct our replacements for the timeradd() and timersub() functions
      on platforms that lack them (for example, Windows). The timersub()
      function is used when expiring circuits, while timeradd() is
      currently unused. Bug report and patch by Vektor. Fixes bug 4778;
      bugfix on 0.2.2.24-alpha and 0.2.3.1-alpha.
    - Do not use OpenSSL 1.0.0's counter mode: it has a critical bug
      that was fixed in OpenSSL 1.0.0a. We test for the counter mode
      bug at runtime, not compile time, because some distributions hack
      their OpenSSL to mis-report its version. Fixes bug 4779; bugfix
      on 0.2.3.9-alpha. Found by Pascal.
  o Minor features (controller):
    - Use absolute path names when reporting the torrc filename in the
      control protocol, so a controller can more easily find the torrc
      file. Resolves bug 1101.
    - Extend the control protocol to report flags that control a circuit's
      path selection in CIRC events and in replies to 'GETINFO
      circuit-status'. Implements part of ticket 2411.
    - Extend the control protocol to report the hidden service address
      and current state of a hidden-service-related circuit in CIRC
      events and in replies to 'GETINFO circuit-status'. Implements part
      of ticket 2411.
    - When reporting the path to the cookie file to the controller,
      give an absolute path. Resolves ticket 4881.
    - Allow controllers to request an event notification whenever a
      circuit is cannibalized or its purpose is changed. Implements
      part of ticket 3457.
    - Include the creation time of a circuit in CIRC and CIRC2
      control-port events and the list produced by the 'GETINFO
      circuit-status' control-port command.
  o Minor features (directory authorities):
    - Directory authorities now reject versions of Tor older than
      0.2.1.30, and Tor versions between 0.2.2.1-alpha and 0.2.2.20-alpha
      inclusive. These versions accounted for only a small fraction of
      the Tor network, and have numerous known security issues. Resolves
      issue 4788.
    - Authority operators can now vote for all relays in a given
      set of countries to be BadDir/BadExit/Invalid/Rejected.
    - Provide two consensus parameters (FastFlagMinThreshold and
      FastFlagMaxThreshold) to control the range of allowable bandwidths
      for the Fast directory flag. These allow authorities to run
      experiments on appropriate requirements for being a "Fast" node.
      The AuthDirFastGuarantee config value still applies.
    - Document the GiveGuardFlagTo_CVE_2011_2768_VulnerableRelays
      directory authority option (introduced in Tor 0.2.2.34).
  o Minor features (other):
    - Don't disable the DirPort when we cannot exceed our AccountingMax
      limit during this interval because the effective bandwidthrate is
      low enough. This is useful in a situation where AccountMax is only
      used as an additional safeguard or to provide statistics.
    - Prepend an informative header to generated dynamic_dh_params files.
    - If EntryNodes are given, but UseEntryGuards is set to 0, warn that
      EntryNodes will have no effect. Resolves issue 2571.
    - Log more useful messages when we fail to disable debugger
      attachment.
    - Log which authority we're missing votes from when we go to fetch
      them from the other auths.
    - Log (at debug level) whenever a circuit's purpose is changed.
    - Add missing documentation for the MaxClientCircuitsPending,
      UseMicrodescriptors, UserspaceIOCPBuffers, and
      _UseFilteringSSLBufferevents options, all introduced during
      the 0.2.3.x series.
    - Update to the January 3 2012 Maxmind GeoLite Country database.
  o Minor bugfixes (hidden services):
    - Don't close hidden service client circuits which have almost
      finished connecting to their destination when they reach
      the normal circuit-build timeout. Previously, we would close
      introduction circuits which are waiting for an acknowledgement
      from the introduction point, and rendezvous circuits which have
      been specified in an INTRODUCE1 cell sent to a hidden service,
      after the normal CBT. Now, we mark them as 'timed out', and launch
      another rendezvous attempt in parallel. This behavior change can
      be disabled using the new CloseHSClientCircuitsImmediatelyOnTimeout
      option. Fixes part of bug 1297; bugfix on 0.2.2.2-alpha.
    - Don't close hidden-service-side rendezvous circuits when they
      reach the normal circuit-build timeout. This behaviour change can
      be disabled using the new
      CloseHSServiceRendCircuitsImmediatelyOnTimeout option. Fixes the
      remaining part of bug 1297; bugfix on 0.2.2.2-alpha.
    - Make sure we never mark the wrong rendezvous circuit as having
      had its introduction cell acknowleged by the introduction-point
      relay. Previously, when we received an INTRODUCE_ACK cell on a
      client-side hidden-service introduction circuit, we might have
      marked a rendezvous circuit other than the one we specified in
      the INTRODUCE1 cell as INTRO_ACKED, which would have produced
      a warning message and interfered with the hidden service
      connection-establishment process. Fixes bug 4759; bugfix on
      0.2.3.3-alpha, when we added the stream-isolation feature which
      might cause Tor to open multiple rendezvous circuits for the same
      hidden service.
    - Don't trigger an assertion failure when we mark a new client-side
      hidden-service introduction circuit for close during the process
      of creating it. Fixes bug 4796; bugfix on 0.2.3.6-alpha. Reported
      by murb.
  o Minor bugfixes (log messages):
    - Correctly spell "connect" in a log message on failure to create a
      controlsocket. Fixes bug 4803; bugfix on 0.2.2.26-beta and
      0.2.3.2-alpha.
    - Fix a typo in a log message in rend_service_rendezvous_has_opened().
      Fixes bug 4856; bugfix on Tor 0.0.6.
    - Fix the log message describing how we work around discovering
      that our version is the ill-fated OpenSSL 0.9.8l. Fixes bug
      4837; bugfix on 0.2.2.9-alpha.
    - When logging about a disallowed .exit name, do not also call it
      an "invalid onion address". Fixes bug 3325; bugfix on 0.2.2.9-alpha.
  o Minor bugfixes (build fixes):
    - During configure, detect when we're building with clang version
      3.0 or lower and disable the -Wnormalized=id and -Woverride-init
      CFLAGS. clang doesn't support them yet.
    - During configure, search for library containing cos function as
      libm lives in libcore on some platforms (BeOS/Haiku). Linking
      against libm was hard-coded before. Fixes the first part of bug
      4727; bugfix on 0.2.2.2-alpha. Patch and analysis by Martin Hebnes
      Pedersen.
    - Detect attempts to build Tor on (as yet hypothetical) versions
      of Windows where sizeof(intptr_t) != sizeof(SOCKET). Partial
      fix for bug 4533. Bugfix on 0.2.2.28-beta.
    - Preprocessor directives should not be put inside the arguments
      of a macro. This would break compilation with GCC releases prior
      to version 3.3. We would never recommend such an old GCC version,
      but it is apparently required for binary compatibility on some
      platforms (namely, certain builds of Haiku). Fixes the other part
      of bug 4727; bugfix on 0.2.3.3-alpha. Patch and analysis by Martin
      Hebnes Pedersen.
  o Minor bugfixes (other):
    - Older Linux kernels erroneously respond to strange nmap behavior
      by having accept() return successfully with a zero-length
      socket. When this happens, just close the connection. Previously,
      we would try harder to learn the remote address: but there was
      no such remote address to learn, and our method for trying to
      learn it was incorrect. Fixes bugs 1240, 4745, and 4747. Bugfix
      on 0.1.0.3-rc. Reported and diagnosed by "r1eo".
    - Fix null-pointer access that could occur if TLS allocation failed.
      Fixes bug 4531; bugfix on 0.2.0.20-rc. Found by "troll_un". This was
      erroneously listed as fixed in 0.2.3.9-alpha, but the fix had
      accidentally been reverted.
    - Fix our implementation of crypto_random_hostname() so it can't
      overflow on ridiculously large inputs. (No Tor version has ever
      provided this kind of bad inputs, but let's be correct in depth.)
      Fixes bug 4413; bugfix on 0.2.2.9-alpha. Fix by Stephen Palmateer.
    - Find more places in the code that should have been testing for
      invalid sockets using the SOCKET_OK macro. Required for a fix
      for bug 4533. Bugfix on 0.2.2.28-beta.
    - Fix an assertion failure when, while running with bufferevents, a
      connection finishes connecting after it is marked for close, but
      before it is closed. Fixes bug 4697; bugfix on 0.2.3.1-alpha.
    - test_util_spawn_background_ok() hardcoded the expected value
      for ENOENT to 2. This isn't portable as error numbers are
      platform specific, and particularly the hurd has ENOENT at
      0x40000002. Construct expected string at runtime, using the correct
      value for ENOENT. Fixes bug 4733; bugfix on 0.2.3.1-alpha.
    - Reject attempts to disable DisableDebuggerAttachment while Tor is
      running. Fixes bug 4650; bugfix on 0.2.3.9-alpha.
    - Use an appropriate-width type for sockets in tor-fw-helper on
      win64. Fixes bug 1983 at last. Bugfix on 0.2.3.9-alpha.
  o Feature removal:
    - When sending or relaying a RELAY_EARLY cell, we used to convert
      it to a RELAY cell if the connection was using the v1 link
      protocol. This was a workaround for older versions of Tor, which
      didn't handle RELAY_EARLY cells properly. Now that all supported
      versions can handle RELAY_EARLY cells, and now that we're enforcing
      the "no RELAY_EXTEND commands except in RELAY_EARLY cells" rule,
      remove this workaround. Addresses bug 4786.
  o Code simplifications and refactoring:
    - Use OpenSSL's built-in SSL_state_string_long() instead of our
      own homebrewed ssl_state_to_string() replacement. Patch from
      Emile Snyder. Fixes bug 4653.
    - Use macros to indicate OpenSSL versions, so we don't need to worry
      about accidental hexadecimal bit shifts.
    - Remove some workaround code for OpenSSL 0.9.6 (which is no longer
      supported).
    - Convert more instances of tor_snprintf+tor_strdup into tor_asprintf.
    - Use the smartlist_add_asprintf() alias more consistently.
    - Use a TOR_INVALID_SOCKET macro when initializing a socket to an
      invalid value, rather than just -1.
    - Rename a handful of old identifiers, mostly related to crypto
      structures and crypto functions. By convention, our "create an
      object" functions are called "type_new()", our "free an object"
      functions are called "type_free()", and our types indicate that
      they are types only with a final "_t". But a handful of older
      types and functions broke these rules, with function names like
      "type_create" or "subsystem_op_type", or with type names like
      type_env_t.

@_date: 2012-01-26 13:05:03
@_author: Roger Dingledine 
@_subject: [tor-talk] Fwd: ANONdroid 
There is no such thing as "an order and some Tor patches that they
wouldn't be able to turn down". You always have the option of stopping
your relay. If you fail to fight the request, you should shut down
your relay, and then tell the world. Backdoored Tor relays will hurt
the network -- and hurt the general fight to legitimize anonymous
communication around the world -- more than they help it.
This was the trap that the JAP and Anon folks fell into -- and at the
time their network was small enough that they basically had the choice of
shutting down the network or deploying the backdoor. They reasoned that
it was better to have a service that provided anonymity to some people
than to have no service at all. The exact details made the decision even
messier (for example, it involved the police basically threatening a
university official at his house on a weekend; and the lawyers who had
signed up to fight such requests were not thrilled that the backdoor was
deployed without giving the lawyers enough time or warning to fight it).
Unfortunately, while "never install a backdoor; turn it off instead" is
an easy heuristic to follow, it's not enough by itself to ensure Tor's
anonymity. Remember that the best way to beat Tor is to observe both the
traffic flow going into the Tor network and also the traffic flow leaving
the Tor network, and then use statistics to realize they're correlated. So
people with bad orders can just go a hop upstream from your relay, where
your ISP generally cares more about its business than its users. And if
you somehow have a better ISP than that, just go to *its* upstream.
The traffic confirmation attack is the best way to beat the mix cascade
topology too -- and in that case there are fewer places to watch, and you
know exactly which exit point to watch for a given entry point. Bad news.
But don't lose sight of the really big picture: the differences in
philosophy and threat model between Tor and JonDoNym are much smaller
than the differences between distributed-trust anonymity designs and a
single-hop centralized proxy like hidemyass.com.

@_date: 2012-07-07 05:00:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.19-rc is out 
Tor 0.2.3.19-rc is the second release candidate for the Tor 0.2.3.x
series. It fixes the compile on Windows, reverts to a GeoIP database
that isn't as broken, and fixes a flow control bug that has been around
since the beginning of Tor.
(Packages coming eventually.)
Changes in version 0.2.3.19-rc - 2012-07-06
  o Major bugfixes:
    - Fix a bug handling SENDME cells on nonexistent streams that could
      result in bizarre window values. Report and patch contributed
      pseudonymously. Fixes part of bug 6271. This bug was introduced
      before the first Tor release, in svn commit r152.
    - Revert to the May 1 2012 Maxmind GeoLite Country database. In the
      June 2012 database, Maxmind marked many Tor relays as country "A1",
      which will cause risky behavior for clients that set EntryNodes
      or ExitNodes. Addresses bug 6334; bugfix on 0.2.3.17-beta.
    - Instead of ENOBUFS on Windows, say WSAENOBUFS. Fixes compilation
      on Windows. Fixes bug 6296; bugfix on 0.2.3.18-rc.
  o Minor bugfixes:
    - Fix wrong TCP port range in parse_port_range(). Fixes bug 6218;
      bugfix on 0.2.1.10-alpha.

@_date: 2012-07-07 11:41:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, June 2012 
(What is this mail? See my explanation from the May mail I sent:
 )

@_date: 2012-07-17 15:46:53
@_author: Roger Dingledine 
@_subject: [tor-talk] BridgeDB reCAPTCHA deployed 
If English speakers have problems here, I wonder what that means for
non-English speakers. Or said another way, what's the state of recaptcha
support for Chinese, Farsi, Arabic, etc?
Sounds great to me.

@_date: 2012-07-21 11:54:22
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB lags behind as Firefox ESR 10.0.6 is released 
Yep. I believe TBB 2.2.37-2 is still in the QA process on our side.
We're still working on sorting out how to make our build-and-QA process
not suck, since "put together a bundle and release it immediately"
has resulted in recent problems too.
You'll be happy to know that we have plans to hire a QA/build automation
person sometime in late 2012 or early 2013. I'm afraid the ride will
stay pretty bumpy until at least then. :/
I think you misunderstand the rationale for setting up the tor-reports
list. It wasn't that we said "I know, what the Tor community needs most
is developers writing emails once a month!" These emails were _already_
getting written -- they were just going only to other developers. Now
they're going to a broader audience too.
As for a forum, I want a forum too. But we want to set one up that
isn't worse than the current situation -- the Tails people set up
a forum, and I hear they hate it so much that at this point they
wish they had nothing rather than the one they have.
You may like  as an alternative
answer. Stay tuned (but if you're holding your breath, be prepared to
hold it a while longer).

@_date: 2012-07-29 02:51:07
@_author: Roger Dingledine 
@_subject: [tor-talk] new tld question 
In short, no. Tor clients treat .onion addresses specially, and don't
go to dns servers for them at all.
The only way it would matter is if your Tor client configuration is
screwed up and your browser isn't actually using Tor. In the current case
you'll ask your local dns server about the address, and it (you hope) will
return a "resolve failed" answer. If somebody registers the .onion tld,
then maybe it would send you somewhere else if your Tor is misconfigured.
With the Tor Browser Bundle, such misconfigurations are pretty uncommon
these days (assuming users actually use the bundle we provide).
See also
Oh, and I guess if whoever gets .onion puts content on it that Tor users
want to reach, we might want to reconsider. But come on, how likely is
that? :)

@_date: 2012-06-06 00:34:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.16-alpha is out 
Tor 0.2.3.16-alpha introduces a workaround for a critical renegotiation
bug in OpenSSL 1.0.1 (where 20% of the Tor network can't talk to itself
currently). It also fixes a variety of smaller bugs and other cleanups
that get us closer to a release candidate.
The workaround for the OpenSSL bug will be part of the upcoming 0.2.2.37
release too.
(Packages coming eventually.)
Changes in version 0.2.3.16-alpha - 2012-06-05
  o Major bugfixes (general):
    - Work around a bug in OpenSSL that broke renegotiation with TLS
      1.1 and TLS 1.2. Without this workaround, all attempts to speak
      the v2 Tor connection protocol when both sides were using OpenSSL
      1.0.1 would fail. Resolves ticket 6033.
    - When waiting for a client to renegotiate, don't allow it to add
      any bytes to the input buffer. This fixes a potential DoS issue.
      Fixes bugs 5934 and 6007; bugfix on 0.2.0.20-rc.
    - Pass correct OR address to managed proxies (like obfsproxy),
      even when ORListenAddress is used. Fixes bug 4865; bugfix on
      0.2.3.9-alpha.
    - The advertised platform of a router now includes only its operating
      system's name (e.g., "Linux", "Darwin", "Windows 7"), and not its
      service pack level (for Windows) or its CPU architecture (for Unix).
      We also no longer include the "git-XYZ" tag in the version. Resolves
      part of bug 2988.
  o Major bugfixes (clients):
    - If we are unable to find any exit that supports our predicted ports,
      stop calling them predicted, so that we don't loop and build
      hopeless circuits indefinitely. Fixes bug 3296; bugfix on 0.0.9pre6,
      which introduced predicted ports.
    - Fix an edge case where if we fetch or publish a hidden service
      descriptor, we might build a 4-hop circuit and then use that circuit
      for exiting afterwards -- even if the new last hop doesn't obey our
      ExitNodes config option. Fixes bug 5283; bugfix on 0.2.0.10-alpha.
    - Check at each new consensus whether our entry guards were picked
      long enough ago that we should rotate them. Previously, we only
      did this check at startup, which could lead to us holding a guard
      indefinitely. Fixes bug 5380; bugfix on 0.2.1.14-rc.
    - When fetching a bridge descriptor from a bridge authority,
      always do so anonymously, whether we have been able to open
      circuits or not. Partial fix for bug 1938; bugfix on 2.0.7-alpha.
      This behavior makes it *safer* to use UpdateBridgesFromAuthority,
      but we'll need to wait for bug 6010 before it's actually usable.
  o Major bugfixes (directory authorities):
    - When computing weight parameters, behave more robustly in the
      presence of a bad bwweightscale value. Previously, the authorities
      would crash if they agreed on a sufficiently broken weight_scale
      value: now, they use a reasonable default and carry on. Partial
      fix for 5786; bugfix on 0.2.2.17-alpha.
    - Check more thoroughly to prevent a rogue authority from
      double-voting on any consensus directory parameter. Previously,
      authorities would crash in this case if the total number of
      votes for any parameter exceeded the number of active voters,
      but would let it pass otherwise. Partial fix for bug 5786; bugfix
      on 0.2.2.2-alpha.
  o Minor features:
    - Rate-limit log messages when asked to connect anonymously to
      a private address. When these hit, they tended to hit fast and
      often. Also, don't bother trying to connect to addresses that we
      are sure will resolve to 127.0.0.1: getting 127.0.0.1 in a directory
      reply makes us think we have been lied to, even when the address the
      client tried to connect to was "localhost." Resolves ticket 2822.
    - Allow packagers to insert an extra string in server descriptor
      platform lines by setting the preprocessor variable TOR_BUILD_TAG.
      Resolves the rest of ticket 2988.
    - Raise the threshold of server descriptors needed (75%) and exit
      server descriptors needed (50%) before we will declare ourselves
      bootstrapped. This will make clients start building circuits a
      little later, but makes the initially constructed circuits less
      skewed and less in conflict with further directory fetches. Fixes
      ticket 3196.
    - Close any connection that sends unrecognized junk before the
      handshake. Solves an issue noted in bug 4369.
    - Improve log messages about managed transports. Resolves ticket 5070.
    - Tag a bridge's descriptor as "never to be sent unencrypted".
      This shouldn't matter, since bridges don't open non-anonymous
      connections to the bridge authority and don't allow unencrypted
      directory connections from clients, but we might as well make
      sure. Closes bug 5139.
    - Expose our view of whether we have gone dormant to the controller,
      via a new "GETINFO dormant" value. Torbutton and other controllers
      can use this to avoid doing periodic requests through Tor while
      it's dormant (bug 4718). Fixes bug 5954.
    - Tell GCC and Clang to check for any errors in format strings passed
      to the tor_v*(print|scan)f functions.
    - Update to the May 1 2012 Maxmind GeoLite Country database.
  o Minor bugfixes (already included in 0.2.2.36):
    - Reject out-of-range times like 23:59:61 in parse_rfc1123_time().
      Fixes bug 5346; bugfix on 0.0.8pre3.
    - Correct parsing of certain date types in parse_http_time().
      Without this patch, If-Modified-Since would behave
      incorrectly. Fixes bug 5346; bugfix on 0.2.0.2-alpha. Patch from
      Esteban Manchado Vel??zques.
    - Make our number-parsing functions always treat too-large values
      as an error, even when those values exceed the width of the
      underlying type. Previously, if the caller provided these
      functions with minima or maxima set to the extreme values of the
      underlying integer type, these functions would return those
      values on overflow rather than treating overflow as an error.
      Fixes part of bug 5786; bugfix on 0.0.9.
    - If we hit the error case where routerlist_insert() replaces an
      existing (old) server descriptor, make sure to remove that
      server descriptor from the old_routers list. Fix related to bug
      1776. Bugfix on 0.2.2.18-alpha.
    - Clarify the behavior of MaxCircuitDirtiness with hidden service
      circuits. Fixes issue 5259.
  o Minor bugfixes (coding cleanup, on 0.2.2.x and earlier):
    - Prevent a null-pointer dereference when receiving a data cell
      for a nonexistent stream when the circuit in question has an
      empty deliver window. We don't believe this is triggerable,
      since we don't currently allow deliver windows to become empty,
      but the logic is tricky enough that it's better to make the code
      robust. Fixes bug 5541; bugfix on 0.0.2pre14.
    - Fix a memory leak when trying to launch a DNS request when the
      network is disabled or the nameservers are unconfigurable. Fixes
      bug 5916; bugfix on Tor 0.1.2.1-alpha (for the unconfigurable
      nameserver case) and on 0.2.3.9-alpha (for the DisableNetwork case).
    - Don't hold a windows file handle open for every file mapping;
      the file mapping handle is sufficient. Fixes bug 5951; bugfix on
      0.1.2.1-alpha.
    - Avoid O(n^2) performance characteristics when parsing a large
      extrainfo cache. Fixes bug 5828; bugfix on 0.2.0.1-alpha.
    - Format more doubles with %f, not %lf. Patch from grarpamp to make
      Tor build correctly on older BSDs again. Fixes bug 3894; bugfix on
      Tor 0.2.0.8-alpha.
    - Make our replacement implementation of strtok_r() compatible with
      the standard behavior of strtok_r(). Patch by nils. Fixes bug 5091;
      bugfix on 0.2.2.1-alpha.
    - Fix a NULL-pointer dereference on a badly formed
      SETCIRCUITPURPOSE command. Found by mikeyc. Fixes bug 5796;
      bugfix on 0.2.2.9-alpha.
    - Fix a build warning with Clang 3.1 related to our use of vasprint.
      Fixes bug 5969. Bugfix on 0.2.2.11-alpha.
    - Defensively refactor rend_mid_rendezvous() so that protocol
      violations and length checks happen in the beginning. Fixes
      bug 5645.
    - Set _WIN32_WINNT to 0x0501 consistently throughout the code, so
      that IPv6 stuff will compile on MSVC, and compilation issues
      will be easier to track down. Fixes bug 5861.
  o Minor bugfixes (correctness, on 0.2.2.x and earlier):
    - Exit nodes now correctly report EADDRINUSE and EADDRNOTAVAIL as
      resource exhaustion, so that clients can adjust their load to
      try other exits. Fixes bug 4710; bugfix on 0.1.0.1-rc, which
      started using END_STREAM_REASON_RESOURCELIMIT.
    - Don't check for whether the address we're using for outbound
      connections has changed until after the outbound connection has
      completed. On Windows, getsockname() doesn't succeed until the
      connection is finished. Fixes bug 5374; bugfix on 0.1.1.14-alpha.
    - If the configuration tries to set MyFamily on a bridge, refuse to
      do so, and warn about the security implications. Fixes bug 4657;
      bugfix on 0.2.0.3-alpha.
    - If the client fails to set a reasonable set of ciphersuites
      during its v2 handshake renegotiation, allow the renegotiation to
      continue nevertheless (i.e. send all the required certificates).
      Fixes bug 4591; bugfix on 0.2.0.20-rc.
    - When we receive a SIGHUP and the controller __ReloadTorrcOnSIGHUP
      option is set to 0 (which Vidalia version 0.2.16 now does when
      a SAVECONF attempt fails), perform other actions that SIGHUP
      usually causes (like reopening the logs). Fixes bug 5095; bugfix
      on 0.2.1.9-alpha.
    - If we fail to write a microdescriptor to the disk cache, do not
      continue replacing the old microdescriptor file. Fixes bug 2954;
      bugfix on 0.2.2.6-alpha.
    - Exit nodes don't need to fetch certificates for authorities that
      they don't recognize; only directory authorities, bridges,
      and caches need to do that. Fixes part of bug 2297; bugfix on
      0.2.2.11-alpha.
    - Correctly handle checking the permissions on the parent
      directory of a control socket in the root directory. Bug found
      by Esteban Manchado Vel????zquez. Fixes bug 5089; bugfix on Tor
      0.2.2.26-beta.
    - When told to add a bridge with the same digest as a preexisting
      bridge but a different addr:port, change the addr:port as
      requested. Previously we would not notice the change. Fixes half
      of bug 5603; fix on 0.2.2.26-beta.
    - End AUTHCHALLENGE error messages (in the control protocol) with
      a CRLF. Fixes bug 5760; bugfix on 0.2.2.36 and 0.2.3.13-alpha.
  o Minor bugfixes (on 0.2.3.x):
    - Turn an assertion (that the number of handshakes received as a
      server is not < 1) into a warning. Fixes bug 4873; bugfix on
      0.2.3.1-alpha.
    - Format IPv4 addresses correctly in ADDRMAP events. (Previously,
      we had reversed them when the answer was cached.) Fixes bug
      5723; bugfix on 0.2.3.1-alpha.
    - Work correctly on Linux systems with accept4 support advertised in
      their headers, but without accept4 support in the kernel. Fix
      by murb. Fixes bug 5762; bugfix on 0.2.3.1-alpha.
    - When told to add a bridge with the same addr:port as a preexisting
      bridge but a different transport, change the transport as
      requested. Previously we would not notice the change. Fixes half
      of bug 5603; fix on 0.2.3.2-alpha.
    - Avoid a "double-reply" warning when replying to a SOCKS request
      with a parse error. Patch from Fabian Keil. Fixes bug 4108;
      bugfix on 0.2.3.4-alpha.
    - Fix a bug where a bridge authority crashes if it has seen no
      directory requests when it's time to write statistics to disk.
      Fixes bug 5891; bugfix on 0.2.3.6-alpha. Also fixes bug 5508 in
      a better way.
    - Don't try to open non-control listeners when DisableNetwork is set.
      Previously, we'd open all listeners, then immediately close them.
      Fixes bug 5604; bugfix on 0.2.3.9-alpha.
    - Don't abort the managed proxy protocol if the managed proxy
      sends us an unrecognized line; ignore it instead. Fixes bug
      5910; bugfix on 0.2.3.9-alpha.
    - Fix a compile warning in crypto.c when compiling with clang 3.1.
      Fixes bug 5969, bugfix on 0.2.3.9-alpha.
    - Fix a compilation issue on GNU Hurd, which doesn't have PATH_MAX.
      Fixes bug 5355; bugfix on 0.2.3.11-alpha.
    - Remove bogus definition of "_WIN32" from src/win32/orconfig.h, to
      unbreak the MSVC build. Fixes bug 5858; bugfix on 0.2.3.12-alpha.
    - Resolve numerous small warnings and build issues with MSVC. Resolves
      bug 5859.
  o Documentation fixes:
    - Improve the manual's documentation for the NT Service command-line
      options. Addresses ticket 3964.
    - Clarify SessionGroup documentation slightly; resolves ticket 5437.
    - Document the changes to the ORPort and DirPort options, and the
      fact that {OR/Dir}ListenAddress is now unnecessary (and
      therefore deprecated). Resolves ticket 5597.
  o Removed files:
    - Remove the torrc.bridge file: we don't use it for anything, and
      it had become badly desynchronized from torrc.sample. Resolves
      bug 5622.

@_date: 2012-06-07 02:26:18
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB 2.2.36-1 fails to include Firefox 13 
Well, because it just came out, for one.
Every new Firefox release these days includes a pile of new privacy
disasters that Mike is scrambling to keep up with.
You might like These days, you really don't want the shiniest newest Firefox as soon
as it comes out. For the stable TBB tree, our plan is to move to Firefox

@_date: 2012-06-08 17:21:41
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB 2.2.36-1 fails to include Firefox 13 
Currently 2.2.35-12 and 2.2.36-1 are both acceptable TBB versions to
use on Linux / OSX. We try to only nag people to upgrade when there's
a good reason -- after all, we nag people to upgrade often enough already.
There will be a 2.2.37 package coming out pretty soon (with a workaround
for a bug in openssl 1.0.1), and it's likely that one will mean we
unrecommend both 2.2.35-12 and 2.2.36-1.

@_date: 2012-06-15 04:52:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.17-beta is out 
Tor 0.2.3.17-beta enables compiler and linker hardening by default,
gets our TLS handshake back on track for being able to blend in with
Firefox, fixes a big bug in 0.2.3.16-alpha that broke Tor's interaction
with Vidalia, and otherwise continues to get us closer to a release
(Packages coming eventually.)
Changes in version 0.2.3.17-beta - 2012-06-15
  o Major features:
    - Enable gcc and ld hardening by default. Resolves ticket 5210.
    - Update TLS cipher list to match Firefox 8 and later. Resolves
      ticket 4744.
    - Implement the client side of proposal 198: remove support for
      clients falsely claiming to support standard ciphersuites that
      they can actually provide. As of modern OpenSSL versions, it's not
      necessary to fake any standard ciphersuite, and doing so prevents
      us from using better ciphersuites in the future, since servers
      can't know whether an advertised ciphersuite is really supported or
      not. Some hosts -- notably, ones with very old versions of OpenSSL
      or where OpenSSL has been built with ECC disabled -- will stand
      out because of this change; TBB users should not be affected.
  o Major bugfixes:
    - Change the default value for DynamicDHGroups (introduced in
      0.2.3.9-alpha) to 0. This feature can make Tor relays less
      identifiable by their use of the mod_ssl DH group, but at
      the cost of some usability ( and bridge tracing (
      regressions. Resolves ticket 5598.
    - Send a CRLF at the end of each STATUS_* control protocol event. This
      bug tickled a bug in Vidalia which would make it freeze. Fixes
      bug 6094; bugfix on 0.2.3.16-alpha.
  o Minor bugfixes:
    - Disable writing on marked-for-close connections when they are
      blocked on bandwidth, to prevent busy-looping in Libevent. Fixes
      bug 5263; bugfix on 0.0.2pre13, where we first added a special
      case for flushing marked connections.
    - Detect SSL handshake even when the initial attempt to write the
      server hello fails. Fixes bug 4592; bugfix on 0.2.0.13-alpha.
    - Change the AllowDotExit rules so they should actually work.
      We now enforce AllowDotExit only immediately after receiving an
      address via SOCKS or DNSPort: other sources are free to provide
      .exit addresses after the resolution occurs. Fixes bug 3940;
      bugfix on 0.2.2.1-alpha.
    - Fix a (harmless) integer overflow in cell statistics reported by
      some fast relays. Fixes bug 5849; bugfix on 0.2.2.1-alpha.
    - Make sure circuitbuild.c checks LearnCircuitBuildTimeout in all the
      right places and never depends on the consensus parameters or
      computes adaptive timeouts when it is disabled. Fixes bug 5049;
      bugfix on 0.2.2.14-alpha.
    - When building Tor on Windows with -DUNICODE (not default), ensure
      that error messages, filenames, and DNS server names are always
      NUL-terminated when we convert them to a single-byte encoding.
      Fixes bug 5909; bugfix on 0.2.2.16-alpha.
    - Make Tor build correctly again with -DUNICODE -D_UNICODE defined.
      Fixes bug 6097; bugfix on 0.2.2.16-alpha.
    - Fix an edge case where TestingTorNetwork is set but the authorities
      and relays all have an uptime of zero, where the private Tor network
      could briefly lack support for hidden services. Fixes bug 3886;
      bugfix on 0.2.2.18-alpha.
    - Correct the manpage's descriptions for the default values of
      DirReqStatistics and ExtraInfoStatistics. Fixes bug 2865; bugfix
      on 0.2.3.1-alpha.
    - Fix the documentation for the --hush and --quiet command line
      options, which changed their behavior back in 0.2.3.3-alpha.
    - Fix compilation warning with clang 3.1. Fixes bug 6141; bugfix on
      0.2.3.11-alpha.
  o Minor features:
    - Rate-limit the "Weighted bandwidth is 0.000000" message, and add
      more information to it, so that we can track it down in case it
      returns again. Mitigates bug 5235.
    - Check CircuitBuildTimeout and LearnCircuitBuildTimeout in
      options_validate(); warn if LearnCircuitBuildTimeout is disabled and
      CircuitBuildTimeout is set unreasonably low. Resolves ticket 5452.
    - Warn the user when HTTPProxy, but no other proxy type, is
      configured. This can cause surprising behavior: it doesn't send
      all of Tor's traffic over the HTTPProxy -- it sends unencrypted
      directory traffic only. Resolves ticket 4663.
    - Issue a notice if a guard completes less than 40% of your circuits.
      Threshold is configurable by torrc option PathBiasNoticeRate and
      consensus parameter pb_noticepct. There is additional, off-by-
      default code to disable guards which fail too many circuits.
      Addresses ticket 5458.
    - Update to the June 6 2012 Maxmind GeoLite Country database.
  o Code simplifications and refactoring:
    - Remove validate_pluggable_transports_config(): its warning
      message is now handled by connection_or_connect().

@_date: 2012-06-23 18:20:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, May 2012 
Hi folks!
As the Tor Project has grown in scope, we've been struggling to keep up
with simultaneously a) doing all the development that needs to be done
(including meeting deliverables for our funders), and b) keeping the
community up-to-date on our in-progress work.
Lately I've been writing monthly status summaries, much like what we have
our GSoC students do. In an effort to be more transparent, I'm going to
start sending them to tor-talk rather than just to the other developers.
Note that I will need to omit or anonymize things sometimes -- some
research groups I meet with don't want to announce their paper draft
until it gets accepted at a conference, some funders don't want the
publicity that would come from admitting their interest in Internet
freedom, etc. I'll try to err on the side of sunlight though.
For those here who are totally taken by surprise by this email (and
the fact that Tor does things :), I encourage you to to lurk on the irc
channels if you want to follow along more closely.
And finally, please do ask questions! Here's your chance to understand my
role in Tor and how it fits with what other people are doing. But since
the root of the problem here has been that we do too many things and
don't have time to do more, please focus on your most burning question(s).

@_date: 2012-06-23 19:04:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Orbot Data Overhead 
Hi Patrick,
You should compare Tor 0.2.2.x with Tor 0.2.3.x in terms of idle bandwidth
load. Tor 0.2.3.x uses microdescriptors rather than descriptors for
directory information, so it should reduce the daily amount of stuff
your Tor has to fetch to keep informed about what relays are available.
Also, if your Tor stays idle for long periods of time (like, days),
you might find interesting (not yet implemented).

@_date: 2012-06-30 05:27:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.18-rc is out 
Tor 0.2.3.18-rc is the first release candidate for the Tor 0.2.3.x
series. It fixes a few smaller bugs, but generally appears stable.
Please test it and let us know whether it is!
(Packages coming eventually.)
Changes in version 0.2.3.18-rc - 2012-06-28
  o Major bugfixes:
    - Allow wildcarded mapaddress targets to be specified on the
      controlport. Partially fixes bug 6244; bugfix on 0.2.3.9-alpha.
    - Make our linker option detection code more robust against linkers
      such as on FreeBSD 8, where a bad combination of options completes
      successfully but makes an unrunnable binary. Fixes bug 6173;
      bugfix on 0.2.3.17-beta.
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Avoid a false positive in the util/threads unit test by increasing
      the maximum timeout time. Fixes bug 6227; bugfix on 0.2.0.4-alpha.
    - Replace "Sending publish request" log messages with "Launching
      upload", so that they no longer confusingly imply that we're
      sending something to a directory we might not even be connected
      to yet. Fixes bug 3311; bugfix on 0.2.0.10-alpha.
    - Make sure to set *socket_error in all error cases in
      connection_connect(), so it can't produce a warning about
      errno being zero from errno_to_orconn_end_reason(). Bugfix on
      0.2.1.1-alpha; resolves ticket 6028.
    - Downgrade "Got a certificate, but we already have it" log messages
      from warning to info, except when we're a dirauth. Fixes bug 5238;
      bugfix on 0.2.1.7-alpha.
    - When checking for requested signatures on the latest consensus
      before serving it to a client, make sure to check the right
      consensus flavor. Bugfix on 0.2.2.6-alpha.
    - Downgrade "eventdns rejected address" message to LOG_PROTOCOL_WARN.
      Fixes bug 5932; bugfix on 0.2.2.7-alpha.
  o Minor bugfixes (on 0.2.3.x):
    - Make format_helper_exit_status() avoid unnecessary space padding
      and stop confusing log_from_pipe(). Fixes ticket 5557; bugfix
      on 0.2.3.1-alpha.
    - Downgrade a message about cleaning the microdescriptor cache to
      "info" from "notice". Fixes bug 6238; bugfix on 0.2.3.1-alpha.
    - Log a BUG message at severity INFO if we have a networkstatus with
      a missing entry for some microdescriptor. Continues on a patch
      to 0.2.3.2-alpha.
    - Improve the log message when a managed proxy fails to launch. Fixes
      bug 5099; bugfix on 0.2.3.6-alpha.
    - Don't do DNS lookups when parsing corrupted managed proxy protocol
      messages. Fixes bug 6226; bugfix on 0.2.3.6-alpha.
    - When formatting wildcarded address mappings for the controller,
      be sure to include "*." as appropriate. Partially fixes bug 6244;
      bugfix on 0.2.3.9-alpha.
    - Avoid a warning caused by using strcspn() from glibc with clang 3.0.
      Bugfix on 0.2.3.13-alpha.
    - Stop logging messages about running with circuit timeout learning
      enabled at severity LD_BUG. Fixes bug 6169; bugfix on 0.2.3.17-beta.
    - Disable a spurious warning about reading on a marked and flushing
      connection. We shouldn't be doing that, but apparently we
      sometimes do. Fixes bug 6203; bugfix on 0.2.3.17-beta.
    - Fix a bug that stopped AllowDotExit from working on addresses
      that had an entry in the DNS cache. Fixes bug 6211; bugfix on
      0.2.3.17-beta.
  o Code simplification, refactoring, unit tests:
    - Move tor_gettimeofday_cached() into compat_libevent.c, and use
      Libevent's notion of cached time when possible.
    - Remove duplicate code for invoking getrlimit() from control.c.
    - Add a unit test for the environment_variable_names_equal function.
  o Documentation:
    - Document the --defaults-torrc option, and the new (in 0.2.3)
      semantics for overriding, extending, and clearing lists of
      options. Closes bug 4748.

@_date: 2012-06-30 18:17:18
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, May 2012 
============================== START ==============================
Here's the first go at the page:
I bet those count as new things if you didn't already know about them. :)
There are a few other research groups working on related topics -- I'm
trying to convince them that "tech report it asap so other people can give
you feedback" is a smart move in academia, but I have not yet succeeded.
Technically speaking, anonbib can handle comments on papers. For
example, Now all that remains is for well-informed people to write up more

@_date: 2012-03-04 04:51:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Who is 93.114.40.75? Tor check page lists it and 
That's a false negative. In this case it happens because the Tor relay
exits from a different IP address than it advertises in its descriptor.
The relay in this case is "proxyleaks", and its descriptor says it's
reachable at 93.114.43.29.
The relay is multi-homed in this case: it has multiple IP addresses.
That's perfectly normal, especially for fast relays.

@_date: 2012-03-10 19:10:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Can't access Tor network 
Your Tor is unable to complete the TCP connection to whichever directory
authority it chose.
A) Are you behind a captive portal? Is your network actually on? What
else can you reach?
B) Try using a Tor bridge:
if "a certain network" is blocking the Tor directory authorities by IP
C) You could try the obfsproxy bundle:
but based on your log I bet it won't help.

@_date: 2012-03-23 01:09:07
@_author: Roger Dingledine 
@_subject: [tor-talk] Google was maddened? 
In the past, Google required that you have a Google cookie or they
wouldn't even give you a captcha.
You can get a Google cookie by loading the google page before doing your
query (as opposed to doing it straight from the Firefox search box).
Does that help?

@_date: 2012-03-28 05:39:21
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.13-alpha is out 
Tor 0.2.3.13-alpha fixes a variety of stability and correctness bugs
in managed pluggable transports, as well as providing other cleanups
that get us closer to a release candidate.
(Packages coming eventually. Speaking of packages, deb.torproject.org
now offers Tor Debian packages for armel on sid, wheezy, squeeze, lucid,
natty, and oneiric; and for armhf on sid and wheezy.)
Changes in version 0.2.3.13-alpha - 2012-03-26
  o Directory authority changes:
    - Change IP address for maatuska (v3 directory authority).
  o Security fixes:
    - Provide controllers with a safer way to implement the cookie
      authentication mechanism. With the old method, if another locally
      running program could convince a controller that it was the Tor
      process, then that program could trick the contoller into telling
      it the contents of an arbitrary 32-byte file. The new "SAFECOOKIE"
      authentication method uses a challenge-response approach to prevent
      this attack. Fixes bug 5185, implements proposal 193.
    - Never use a bridge or a controller-supplied node as an exit, even
      if its exit policy allows it. Found by wanoskarnet. Fixes bug
      5342. Bugfix on 0.1.1.15-rc (for controller-purpose descriptors)
      and 0.2.0.3-alpha (for bridge-purpose descriptors).
    - Only build circuits if we have a sufficient threshold of the total
      descriptors that are marked in the consensus with the "Exit"
      flag. This mitigates an attack proposed by wanoskarnet, in which
      all of a client's bridges collude to restrict the exit nodes that
      the client knows about. Fixes bug 5343.
  o Major bugfixes (on Tor 0.2.3.x):
    - Avoid an assert when managed proxies like obfsproxy are configured,
      and we receive HUP signals or setconf attempts too rapidly. This
      situation happens most commonly when Vidalia tries to attach to
      Tor or tries to configure the Tor it's attached to. Fixes bug 5084;
      bugfix on 0.2.3.6-alpha.
    - Fix a relay-side pluggable transports bug where managed proxies were
      unreachable from the Internet, because Tor asked them to bind on
      localhost. Fixes bug 4725; bugfix on 0.2.3.9-alpha.
    - Stop discarding command-line arguments when TestingTorNetwork
      is set. Discovered by Kevin Bauer. Fixes bug 5373; bugfix on
      0.2.3.9-alpha, where task 4552 added support for two layers of
      torrc files.
    - Resume allowing the unit tests to run in gdb. This was accidentally
      made impossible when the DisableDebuggerAttachment option was
      introduced. Fixes bug 5448; bugfix on 0.2.3.9-alpha.
    - Resume building with nat-pmp support. Fixes bug 4955; bugfix on
      0.2.3.11-alpha. Reported by Anthony G. Basile.
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Ensure we don't cannibalize circuits that are longer than three hops
      already, so we don't end up making circuits with 5 or more
      hops. Patch contributed by wanoskarnet. Fixes bug 5231; bugfix on
      0.1.0.1-rc which introduced cannibalization.
    - Detect and reject certain misformed escape sequences in
      configuration values. Previously, these values would cause us
      to crash if received in a torrc file or over an authenticated
      control port. Bug found by Esteban Manchado Vel??zquez, and
      independently by Robert Connolly from Matta Consulting who further
      noted that it allows a post-authentication heap overflow. Patch
      by Alexander Schrijver. Fixes bugs 5090 and 5402 (CVE 2012-1668);
      bugfix on 0.2.0.16-alpha.
    - Fix a compile warning when using the --enable-openbsd-malloc
      configure option. Fixes bug 5340; bugfix on 0.2.0.20-rc.
    - Directory caches no longer refuse to clean out descriptors because
      of missing v2 networkstatus documents, unless they're configured
      to retrieve v2 networkstatus documents. Fixes bug 4838; bugfix on
      0.2.2.26-beta. Patch by Daniel Bryg.
    - Update to the latest version of the tinytest unit testing framework.
      This includes a couple of bugfixes that can be relevant for
      running forked unit tests on Windows, and removes all reserved
      identifiers.
  o Minor bugfixes (on 0.2.3.x):
    - On a failed pipe() call, don't leak file descriptors. Fixes bug
      4296; bugfix on 0.2.3.1-alpha.
    - Spec conformance: on a v3 handshake, do not send a NETINFO cell
      until after we have received a CERTS cell. Fixes bug 4361; bugfix
      on 0.2.3.6-alpha. Patch by "frosty".
    - When binding to an IPv6 address, set the IPV6_V6ONLY socket
      option, so that the IP stack doesn't decide to use it for IPv4
      too. Fixes bug 4760; bugfix on 0.2.3.9-alpha.
    - Ensure that variables set in Tor's environment cannot override
      environment variables that Tor passes to a managed
      pluggable-transport proxy. Previously, Tor would pass every
      variable in its environment to managed proxies along with the new
      ones, in such a way that on many operating systems, the inherited
      environment variables would override those which Tor tried to
      explicitly set. Bugfix on 0.2.3.12-alpha for most Unixoid systems;
      bugfix on 0.2.3.9-alpha for Windows.
  o Minor features:
    - A wide variety of new unit tests by Esteban Manchado Vel??zquez.
    - Shorten links in the tor-exit-notice file. Patch by Christian Kujau.
    - Update to the March 6 2012 Maxmind GeoLite Country database.

@_date: 2012-05-07 01:48:19
@_author: Roger Dingledine 
@_subject: [tor-talk] 2.2.35-11, 
Setting the value to false was the quick workaround. It basically
breaks all websockets for you. The better fix is to make websockets work
without leaking your DNS query:
for the variety of other things we need to do to Firefox to make it safe
to use. We're working with a Mozilla engineer to get these fixes back into
mainline so we don't keep diverging even more -- but that's tough going.

@_date: 2012-05-07 02:20:10
@_author: Roger Dingledine 
@_subject: [tor-talk] how bridges work 
The client in Syria can connect through the bridge in the US to reach
the Tor network. Simplifying a bit, the bridge provides the reachability,
and the Tor network provides the anonymity.
See also Note that in Syria, at least today, you don't need a bridge to reach
the Tor network. But if they started blocking the public Tor relays by
IP address, then a bridge would solve that.

@_date: 2012-05-08 02:25:41
@_author: Roger Dingledine 
@_subject: [tor-talk] how bridges work 
Also, using a bridge even when you don't need one can
be a smart idea for improved security. Point 'e' on
 says
So in certain places where the user considers simply using Tor could be
risky, using a bridge can be smarter.
Of course, if you're in this situation, you should also consider where
your bridge came from -- if your attacker signs up hundreds of bridges
in hopes you'll pick his, and you just choose a random bridge from the
set we give out, then an attacker who otherwise wouldn't be able to see
your traffic could get to see when you're using the Tor network (even
if the layers of encryption mean he still can't read what you say or
what destinations you ask for).

@_date: 2012-05-10 23:58:48
@_author: Roger Dingledine 
@_subject: [tor-talk] tor/netfilter: packets without uid 
These statements are contradictory. If the destination is a Tor relay,
and the destination port is 443, then it's a Tor relay whose ORPort is
443. (Many relays listen on 443 so they can be reachable by firewalled
users.) Your firefox user probably has nothing to do with it.
This I do not know.
It does sound like your iptables failing to categorize the packet,
rather than an actual application-level leak, though.

@_date: 2012-05-16 02:37:38
@_author: Roger Dingledine 
@_subject: [tor-talk] unsubscribe me from mailing list 
At the bottom of every email to the list (including the one you just sent)
is a url to help you unsubscribe.

@_date: 2012-05-18 22:23:56
@_author: Roger Dingledine 
@_subject: [tor-talk] OpenSSL library does not load unless bridges are used 
Sounds like Looks like nobody's going to fix it anytime soon unless somebody
here helps. :)
No, your Tor refetches bridge descriptors periodically since it's
cheap and in case they change.

@_date: 2012-05-26 02:03:10
@_author: Roger Dingledine 
@_subject: [tor-talk] anonymity: bridge users vs. entry guard users 
Yes. See also Item  on
including proposal 188:
Bridges are basically not blocked at all outside of China. In China,
Tor is currently blocked by protocol. See Philipp Winter's "How China
Is Blocking Tor", as well as
(Pluggable transports like obfsproxy continue to work fine in China.)
Depends how much they care to use Tor. Rotation in the bridge case is
manual, and rotation in the entry guard case is automated.
They're probably more vulnerable, but I don't know if I'd say
"sufficiently". There are a lot of attacks to balance. I would worry
just as much about "most bridge users don't know the identity fingerprint
of their bridge":
and I'd probably worry even more about "there are different requirements
to get the Guard flag than there are to sign up as a bridge":
Seems to me that the current bridge approach is unmanageable, because we
need more varied bridge addresses, better transports, better distribution
strategies, etc:
Stay tuned to  for more.

@_date: 2012-11-07 15:39:30
@_author: Roger Dingledine 
@_subject: [tor-talk] DoS and TOR? 
I haven't looked in detail at the LOIC design, but:
a) If you're trying to send UDP packets (or anything other than correctly
formed TCP streams), it won't work because Tor doesn't transport that.
b) If you're trying to open a bazillion TCP connections or something,
you'll likely end up DoSing the Tor network way before your target
site notices.
Or to phrase it more simply: "don't do that and also it wouldn't do what
you want."

@_date: 2012-11-09 13:42:32
@_author: Roger Dingledine 
@_subject: [tor-talk] check.torproject.org 
Yes. Apparently it doesn't start on reboot. Also, it's old and buggy.
We're looking into ways to improve it, but all the Tor developers are
distracted by other things, so it keeps falling out of the priority list.

@_date: 2012-11-09 15:30:37
@_author: Roger Dingledine 
@_subject: [tor-talk] sock proxy port 
The Windows TBB doesn't set the ports to auto, since too many crappy
Windows antivirus tools freak out when a program asks the OS to select
what port it will bind to. So Windows TBB users have 9050 and 9051
by default.
There is a tiny difference: see point 1 at
But it shouldn't matter much.
I'm guessing you're looking at outbound connections, not listener
connections, in whatever 'network monitor' this is.

@_date: 2012-11-09 18:25:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Unsigned Mac OS X binary for TorBrowser 
I agree with you about the 'safety of users' side. But I'm not so clear
on the 'credibility' side. Last I checked, to become an official Apple
developer, they required you to sign an NDA *in order to see the agreement
they would then ask you to sign*.
We at Tor aren't big on signing blanket broad NDAs with large
corporations, so you can see why we'd be hesitating (to put it nicely). I
imagine we're not the only ones.

@_date: 2012-11-09 18:41:06
@_author: Roger Dingledine 
@_subject: [tor-talk] misconfigured mailing list (mailman software) for 
I won't use the phrase "industry standard mailing list software" because
I hate it when other people use that phrase. But really, this is how
every free-software mailing list system works these days.
I'd be surprised if more than a trivial number of users on the Tor
lists picked a password at all. Typically people just let it choose
a random password for them, and it's nice to have that reminder sent
monthly because nobody ever knows their list password (for good reason --
there's barely a need to have a password for a mailing list subscription
in the first place).
Maybe we should find a way to wrestle it into not letting you pick a
password for yourself?

@_date: 2012-11-11 02:35:04
@_author: Roger Dingledine 
@_subject: [tor-talk] please test the new obfsproxy bridge debian/ubuntu 
Hi folks,
George and I have put together some instructions on how to set up
a Tor bridge + obfsproxy on Debian/Ubuntu:
Getting more obfsproxy bridges up and running is useful because right
now they're the best way for users in China to get to the Tor network.
The recent Tor 0.2.4.x releases know how to automatically report your
obfsproxy address to the bridge directory authority, so we can give
out your address like we give out normal bridge addresses.
So: if you're on Debian or Ubuntu and have a moment to try out our
instructions, please do! Let us know where you get stuck, what Debian
flavors the instructions fail on, etc.

@_date: 2012-11-13 01:45:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.6-alpha is out 
Tor 0.2.4.6-alpha fixes an assert bug that has been plaguing relays,
makes our defense-in-depth memory wiping more reliable, and begins to
count IPv6 addresses in bridge statistics,
Changes in version 0.2.4.6-alpha - 2012-11-13
  o Major bugfixes:
    - Fix an assertion failure that could occur when closing a connection
      with a spliced rendezvous circuit. Fix for bug 7212; bugfix on
      Tor 0.2.4.4-alpha.
    - Tor tries to wipe potentially sensitive data after using it, so
      that if some subsequent security failure exposes Tor's memory,
      the damage will be limited. But we had a bug where the compiler
      was eliminating these wipe operations when it decided that the
      memory was no longer visible to a (correctly running) program,
      hence defeating our attempt at defense in depth. We fix that
      by using OpenSSL's OPENSSL_cleanse() operation, which a compiler
      is unlikely to optimize away. Future versions of Tor may use
      a less ridiculously heavy approach for this. Fixes bug 7352.
      Reported in an article by Andrey Karpov.
  o Minor features:
    - Add GeoIP database for IPv6 addresses. The new config option
      is GeoIPv6File.
    - Bridge statistics now count bridge clients connecting over IPv6:
      bridge statistics files now list "bridge-ip-versions" and
      extra-info documents list "geoip6-db-digest". The control protocol
      "CLIENTS_SEEN" and "ip-to-country" queries now support IPv6. Initial
      implementation by "shkoo", addressing ticket 5055.
  o Minor bugfixes:
    - Warn when we are binding low ports when hibernation is enabled;
      previously we had warned when we were _advertising_ low ports with
      hibernation enabled. Fixes bug 7285; bugfix on 0.2.3.9-alpha.
    - Fix a harmless bug when opting against publishing a relay descriptor
      because DisableNetwork is set. Fixes bug 7464; bugfix on
      0.2.3.9-alpha.
    - Add warning message when a managed proxy dies during configuration.
      Fixes bug 7195; bugfix on 0.2.4.2-alpha.
    - Fix a linking error when building tor-fw-helper without miniupnp.
      Fixes bug 7235; bugfix on 0.2.4.2-alpha. Fix by Anthony G. Basile.
    - Check for closing an or_connection_t without going through correct
      channel functions; emit a warning and then call
      connection_or_close_for_error() so we don't assert as in bugs 7212
      and 7267.
    - Compile correctly on compilers without C99 designated initializer
      support. Fixes bug 7286; bugfix on 0.2.4.4-alpha.
    - Avoid a possible assert that can occur when channel_send_destroy() is
      called on a channel in CHANNEL_STATE_CLOSING, CHANNEL_STATE_CLOSED,
      or CHANNEL_STATE_ERROR when the Tor process is resumed after being
      blocked for a long interval. Fixes bug 7350; bugfix on 0.2.4.4-alpha.
    - Fix a memory leak on failing cases of channel_tls_process_certs_cell.
      Fixes bug 7422; bugfix on 0.2.4.4-alpha.
  o Code simplification and refactoring:
    - Start using OpenBSD's implementation of queue.h, so that we don't
      need to hand-roll our own pointer and list structures whenever we
      need them. (We can't rely on a sys/queue.h, since some operating
      systems don't have them, and the ones that do have them don't all
      present the same extensions.)

@_date: 2012-11-14 04:47:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Guard flag vs relay bandwidth 
Right. I've got a half-drafted "the lifecycle of a new Tor relay" blog
post sitting around here somewhere. What you describe happens because
clients avoid using relays with the Guard flag for hops other than the
first hop, since they assume they've got lots of load from clients who
are using them for the first hop -- but when you first get your Guard
flag, nobody uses you as a guard yet, so you don't have much traffic.
That said, the drop shouldn't last all that long. Clients replace their
guards every 45 days on average. So you should see a roughly linear
growth in load from getting the Guard flag for 4-8 weeks, and then it
should level off.
"Don't worry be happy" is my best suggestion here. If you want to read
a lot more about guard flag allocation, see
"Changing of the Guards: A Framework for Understanding and Improving
Entry Guard Selection in Tor"
published at this year's WPES:
The more network capacity that has the Guard flag, the less clients
avoid using Guards for non-first hops. So, convince all your friends to
run fast stable relays. :)
Thanks for running a relay!
Oh, and I'll leave you with one final thought: ensuring "maximum possible
bandwidth consumption" might not actually be the best goal here. Every
time your relay's bandwidthrate token bucket runs dry, that's a pile of
Tor users who have to wait another second before their bytes will move
forward. The best Tor network is one where no relays are bottlenecked.

@_date: 2012-11-17 16:38:23
@_author: Roger Dingledine 
@_subject: [tor-talk] Appropriate methods of estimating daily tor users 
See "Privacy-preserving ways to estimate the number of Tor users"
and then also "Counting daily bridge users"

@_date: 2012-11-20 03:55:53
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.25 is out 
The Tor 0.2.3 release series is dedicated to the memory of Len "rabbi"
Sassaman (1980-2011), a long-time cypherpunk, anonymity researcher,
Mixmaster maintainer, Pynchon Gate co-designer, CodeCon organizer,
programmer, and friend. Unstinting in his dedication to the cause of
freedom, he inspired and helped many of us as we began our work on
anonymity, and inspires us still. Please honor his memory by writing
software to protect people's freedoms, and by helping others to do so.
Tor 0.2.3.25, the first stable release in the 0.2.3 branch, features
significantly reduced directory overhead (via microdescriptors),
enormous crypto performance improvements for fast relays on new
enough hardware, a new v3 TLS handshake protocol that can better
resist fingerprinting, support for protocol obfuscation plugins (aka
pluggable transports), better scalability for hidden services, IPv6
support for bridges, performance improvements like allowing clients
to skip the first round-trip on the circuit ("optimistic data") and
refilling token buckets more often, a new "stream isolation" design
to isolate different applications on different circuits, and many
stability, security, and privacy fixes.
There aren't any packages yet, other than the tarball. I'll do a more
official announcement to tor-announce, once we have packages.
Changes in version 0.2.3.25 - 2012-11-19
  Major features (v3 directory protocol):
    - Clients now use microdescriptors instead of regular descriptors
      to build circuits. Microdescriptors are authority-generated
      summaries of regular descriptors' contents, designed to change very
      rarely (see proposal 158 for details). This feature is designed
      to save bandwidth, especially for clients on slow internet
      connections. Use "UseMicrodescriptors 0" to disable it.
    - Caches now download, cache, and serve microdescriptors, as well
      as multiple "flavors" of the consensus, including a flavor that
      describes microdescriptors.
  o Major features (build hardening):
    - Enable gcc and ld hardening by default. Resolves ticket 5210.
  o Major features (relay scaling):
    - When built to use OpenSSL 1.0.1, and built for an x86 or x86_64
      instruction set, take advantage of OpenSSL's AESNI, bitsliced, or
      vectorized AES implementations as appropriate. These can be much,
      much faster than other AES implementations.
    - When using OpenSSL 1.0.0 or later, use OpenSSL's counter mode
      implementation. It makes AES_CTR about 7% faster than our old one
      (which was about 10% faster than the one OpenSSL used to provide).
      Resolves ticket 4526.
    - Use OpenSSL's EVP interface for AES encryption, so that all AES
      operations can use hardware acceleration (if present). Resolves
      ticket 4442.
    - Unconditionally use OpenSSL's AES implementation instead of our
      old built-in one. OpenSSL's AES has been better for a while, and
      relatively few servers should still be on any version of OpenSSL
      that doesn't have good optimized assembly AES.
  o Major features (blocking resistance):
    - Update TLS cipher list to match Firefox 8 and later. Resolves
      ticket 4744.
    - Remove support for clients falsely claiming to support standard
      ciphersuites that they can actually provide. As of modern OpenSSL
      versions, it's not necessary to fake any standard ciphersuite,
      and doing so prevents us from using better ciphersuites in the
      future, since servers can't know whether an advertised ciphersuite
      is really supported or not. Some hosts -- notably, ones with very
      old versions of OpenSSL or where OpenSSL has been built with ECC
      disabled -- will stand out because of this change; TBB users should
      not be affected. Implements the client side of proposal 198.
    - Implement a new handshake protocol (v3) for authenticating Tors to
      each other over TLS. It should be more resistant to fingerprinting
      than previous protocols, and should require less TLS hacking for
      future Tor implementations. Implements proposal 176.
    - Allow variable-length padding cells, to disguise the length of
      Tor's TLS records. Implements part of proposal 184.
    - While we're trying to bootstrap, record how many TLS connections
      fail in each state, and report which states saw the most failures
      in response to any bootstrap failures. This feature may speed up
      diagnosis of censorship events. Implements ticket 3116.
  o Major features (pluggable transports):
    - Clients and bridges can now be configured to use a separate
      "transport" proxy. This approach makes the censorship arms race
      easier by allowing bridges to use protocol obfuscation plugins.
      Implements proposal 180 (tickets 2841 and 3472).
  o Major features (DoS resistance):
    - Now that Tor 0.2.0.x is completely deprecated, enable the final
      part of "Proposal 110: Avoiding infinite length circuits" by
      refusing all circuit-extend requests that do not use a relay_early
      cell. This change helps Tor resist a class of denial-of-service
      attacks by limiting the maximum circuit length.
    - Tear down the circuit if we get an unexpected SENDME cell. Clients
      could use this trick to make their circuits receive cells faster
      than our flow control would have allowed, or to gum up the network,
      or possibly to do targeted memory denial-of-service attacks on
      entry nodes. Fixes bug 6252. Bugfix on the 54th commit on Tor --
      from July 2002, before the release of Tor 0.0.0.
  o Major features (hidden services):
    - Adjust the number of introduction points that a hidden service
      will try to maintain based on how long its introduction points
      remain in use and how many introductions they handle. Fixes
      part of bug 3825.
    - Add a "tor2web mode" for clients that want to connect to hidden
      services non-anonymously (and possibly more quickly). As a safety
      measure to try to keep users from turning this on without knowing
      what they are doing, tor2web mode must be explicitly enabled at
      compile time, and a copy of Tor compiled to run in tor2web mode
      cannot be used as a normal Tor client. Implements feature 2553.
  o Major features (IPv6):
    - Clients can now connect to private bridges over IPv6. Bridges
      still need at least one IPv4 address in order to connect to
      other relays. Note that we don't yet handle the case where the
      user has two bridge lines for the same bridge (one IPv4, one
      IPv6). Implements parts of proposal 186.
  o Major features (directory authorities):
    - Use a more secure consensus parameter voting algorithm. Now at
      least three directory authorities or a majority of them must
      vote on a given parameter before it will be included in the
      consensus. Implements proposal 178.
    - Remove the artificially low cutoff of 20KB to guarantee the Fast
      flag. In the past few years the average relay speed has picked
      up, and while the "top 7/8 of the network get the Fast flag" and
      "all relays with 20KB or more of capacity get the Fast flag" rules
      used to have the same result, now the top 7/8 of the network has
      a capacity more like 32KB. Bugfix on 0.2.1.14-rc. Fixes bug 4489.
  o Major features (performance):
    - Exit nodes now accept and queue data on not-yet-connected streams.
      Previously, the client wasn't allowed to send data until the
      stream was connected, which slowed down all connections. This
      change will enable clients to perform a "fast-start" on streams
      and send data without having to wait for a confirmation that the
      stream has opened. Patch from Ian Goldberg; implements the server
      side of Proposal 174.
    - When using an exit relay running 0.2.3.x, clients can now
      "optimistically" send data before the exit relay reports that
      the stream has opened. This saves a round trip when starting
      connections where the client speaks first (such as web browsing).
      This behavior is controlled by a consensus parameter (currently
      disabled). To turn it on or off manually, use the "OptimisticData"
      torrc option. Implements proposal 181; code by Ian Goldberg.
    - Add a new TokenBucketRefillInterval option to refill token buckets
      more frequently than once per second. This should improve network
      performance, alleviate queueing problems, and make traffic less
      bursty. Implements proposal 183; closes ticket 3630. Design by
      Florian Tschorsch and Bj??rn Scheuermann; implementation by
      Florian Tschorsch.
    - Raise the threshold of server descriptors needed (75%) and exit
      server descriptors needed (50%) before we will declare ourselves
      bootstrapped. This will make clients start building circuits a
      little later, but makes the initially constructed circuits less
      skewed and less in conflict with further directory fetches. Fixes
      ticket 3196.
  o Major features (relays):
    - Relays now try regenerating and uploading their descriptor more
      frequently if they are not listed in the consensus, or if the
      version of their descriptor listed in the consensus is too
      old. This fix should prevent situations where a server declines
      to re-publish itself because it has done so too recently, even
      though the authorities decided not to list its recent-enough
      descriptor. Fix for bug 3327.
  o Major features (stream isolation):
    - You can now configure Tor so that streams from different
      applications are isolated on different circuits, to prevent an
      attacker who sees your streams as they leave an exit node from
      linking your sessions to one another. To do this, choose some way
      to distinguish the applications: have them connect to different
      SocksPorts, or have one of them use SOCKS4 while the other uses
      SOCKS5, or have them pass different authentication strings to the
      SOCKS proxy. Then, use the new SocksPort syntax to configure the
      degree of isolation you need. This implements Proposal 171.
    - There's a new syntax for specifying multiple client ports (such as
      SOCKSPort, TransPort, DNSPort, NATDPort): you can now just declare
      multiple *Port entries with full addr:port syntax on each.
      The old *ListenAddress format is still supported, but you can't
      mix it with the new *Port syntax.
  o Major features (bufferevents):
    - Tor can now optionally build with the "bufferevents" buffered IO
      backend provided by Libevent 2. To use this feature, make sure you
      have the latest possible version of Libevent, and pass the
      --enable-bufferevents flag to configure when building Tor from
      source. This feature will make our networking code more flexible,
      let us stack layers on each other, and let us use more efficient
      zero-copy transports where available.
    - Add experimental support for running on Windows with IOCP and no
      kernel-space socket buffers. This feature is controlled by a new
      "UserspaceIOCPBuffers" config option (off by default), which has
      no effect unless Tor has been built with bufferevents enabled,
      you're running on Windows, and you've set "DisableIOCP 0". In the
      long run, this may help solve or mitigate bug 98.
  o Major features (path selection):
    - The EntryNodes option can now include country codes like {de} or IP
      addresses or network masks. Previously we had disallowed these
      options because we didn't have an efficient way to keep the list up
      to date. Addresses ticket 1982, but see bug 2798 for an unresolved
      issue here.
  o Major features (port forwarding):
    - Add support for automatic port mapping on the many home routers
      that support NAT-PMP or UPnP. To build the support code, you'll
      need to have the libnatpnp library and/or the libminiupnpc library,
      and you'll need to enable the feature specifically by passing
      "--enable-upnp" and/or "--enable-natpnp" to ./configure. To turn
      it on, use the new PortForwarding option.
  o Major features (logging):
    - Add a new 'Heartbeat' log message type to periodically log a message
      describing Tor's status at level Notice. This feature is meant for
      operators who log at notice, and want to make sure that their Tor
      server is still working. Implementation by George Kadianakis.
    - Make logging resolution configurable with a new LogTimeGranularity
      option, and change the default from 1 millisecond to 1 second.
      Implements enhancement 1668.
  o Major features (other):
    - New "DisableNetwork" config option to prevent Tor from launching any
      connections or accepting any connections except on a control port.
      Bundles and controllers can set this option before letting Tor talk
      to the rest of the network, for example to prevent any connections
      to a non-bridge address. Packages like Orbot can also use this
      option to instruct Tor to save power when the network is off.
    - Try to use system facilities for enumerating local interface
      addresses, before falling back to our old approach (which was
      binding a UDP socket, and calling getsockname() on it). That
      approach was scaring OS X users whose draconian firewall
      software warned about binding to UDP sockets regardless of
      whether packets were sent. Now we try to use getifaddrs(),
      SIOCGIFCONF, or GetAdaptersAddresses(), depending on what the
      system supports. Resolves ticket 1827.
    - Add experimental support for a "defaults" torrc file to be parsed
      before the regular torrc. Torrc options override the defaults file's
      options in the same way that the command line overrides the torrc.
      The SAVECONF controller command saves only those options which
      differ between the current configuration and the defaults file. HUP
      reloads both files. Implements task 4552.
  o New directory authorities:
    - Add Faravahar (run by Sina Rabbani) as the ninth v3 directory
      authority. Closes ticket 5749.
  o Security/privacy fixes:
    - Avoid read-from-freed-memory and double-free bugs that could occur
      when a DNS request fails while launching it. Fixes bug 6480;
      bugfix on 0.2.0.1-alpha.
    - Reject any attempt to extend to an internal address. Without
      this fix, a router could be used to probe addresses on an internal
      network to see whether they were accepting connections. Fixes bug
      6710; bugfix on 0.0.8pre1.
    - Close any connection that sends unrecognized junk before the TLS
      handshake. Solves an issue noted in bug 4369.
    - The advertised platform of a relay now includes only its operating
      system's name (e.g., "Linux", "Darwin", "Windows 7"), and not
      its service pack level (for Windows) or its CPU architecture
      (for Unix). Also drop the "git-XYZ" tag in the version. Packagers
      can insert an extra string in the platform line by setting the
      preprocessor variable TOR_BUILD_TAG. Resolves bug 2988.
    - Disable TLS session tickets. OpenSSL's implementation was giving
      our TLS session keys the lifetime of our TLS context objects, when
      perfect forward secrecy would want us to discard anything that
      could decrypt a link connection as soon as the link connection
      was closed. Fixes bug 7139; bugfix on all versions of Tor linked
      against OpenSSL 1.0.0 or later. Found by Florent Daigni??re.
    - Tor tries to wipe potentially sensitive data after using it, so
      that if some subsequent security failure exposes Tor's memory,
      the damage will be limited. But we had a bug where the compiler
      was eliminating these wipe operations when it decided that the
      memory was no longer visible to a (correctly running) program,
      hence defeating our attempt at defense in depth. We fix that
      by using OpenSSL's OPENSSL_cleanse() operation, which a compiler
      is unlikely to optimize away. Future versions of Tor may use
      a less ridiculously heavy approach for this. Fixes bug 7352.
      Reported in an article by Andrey Karpov.
  o Major bugfixes (crashes and asserts):
    - Avoid a pair of double-free and use-after-mark bugs that can
      occur with certain timings in canceled and re-received DNS
      requests. Fixes bug 6472; bugfix on 0.0.7rc1.
    - Fix a denial of service attack by which any directory authority
      could crash all the others, or by which a single v2 directory
      authority could crash everybody downloading v2 directory
      information. Fixes bug 7191; bugfix on 0.2.0.10-alpha.
    - Fix an assert that directory authorities could trigger on sighup
      during some configuration state transitions. We now don't treat
      it as a fatal error when the new descriptor we just generated in
      init_keys() isn't accepted. Fixes bug 4438; bugfix on 0.2.1.9-alpha.
    - Avoid segfault when starting up having run with an extremely old
      version of Tor and parsing its state file. Fixes bug 6801; bugfix
      on 0.2.2.23-alpha.
  o Major bugfixes (clients):
    - If we are unable to find any exit that supports our predicted ports,
      stop calling them predicted, so that we don't loop and build
      hopeless circuits indefinitely. Fixes bug 3296; bugfix on 0.0.9pre6,
      which introduced predicted ports.
    - Check at each new consensus whether our entry guards were picked
      long enough ago that we should rotate them. Previously, we only
      did this check at startup, which could lead to us holding a guard
      indefinitely. Fixes bug 5380; bugfix on 0.2.1.14-rc.
    - When fetching a bridge descriptor from a bridge authority,
      always do so anonymously, whether we have been able to open
      circuits or not. Partial fix for bug 1938; bugfix on 0.2.0.7-alpha.
      This behavior makes it *safer* to use UpdateBridgesFromAuthority,
      but we'll need to wait for bug 6010 before it's actually usable.
  o Major bugfixes (directory voting):
    - Check more thoroughly to prevent a rogue authority from
      double-voting on any consensus directory parameter. Previously,
      authorities would crash in this case if the total number of
      votes for any parameter exceeded the number of active voters,
      but would let it pass otherwise. Partially fixes bug 5786; bugfix
      on 0.2.2.2-alpha.
    - When computing weight parameters, behave more robustly in the
      presence of a bad bwweightscale value. Previously, the authorities
      would crash if they agreed on a sufficiently broken weight_scale
      value; now, they use a reasonable default and carry on. Fixes the
      rest of bug 5786; bugfix on 0.2.2.17-alpha.
    - If authorities are unable to get a v2 consensus document from other
      directory authorities, they no longer fall back to fetching
      them from regular directory caches. Fixes bug 5635; bugfix on
      0.2.2.26-beta, where routers stopped downloading v2 consensus
      documents entirely.
  o Major bugfixes (relays):
    - Fix a bug handling SENDME cells on nonexistent streams that could
      result in bizarre window values. Report and patch contributed
      pseudonymously. Fixes part of bug 6271. This bug was introduced
      before the first Tor release, in svn commit r152.
    - Don't update the AccountingSoftLimitHitAt state file entry whenever
      tor gets started. This prevents a wrong average bandwidth
      estimate, which would cause relays to always start a new accounting
      interval at the earliest possible moment. Fixes bug 2003; bugfix
      on 0.2.2.7-alpha. Reported by Bryon Eldridge, who also helped
      immensely in tracking this bug down.
    - Fix a possible crash bug when checking for deactivated circuits
      in connection_or_flush_from_first_active_circuit(). Fixes bug 6341;
      bugfix on 0.2.2.7-alpha. Bug report and fix received pseudonymously.
    - Set the SO_REUSEADDR socket option before we call bind() on outgoing
      connections. This change should allow busy exit relays to stop
      running out of available sockets as quickly. Fixes bug 4950;
      bugfix on 0.2.2.26-beta.
  o Major bugfixes (blocking resistance):
    - Bridges no longer include their address in NETINFO cells on outgoing
      OR connections, to allow them to blend in better with clients.
      Removes another avenue for enumerating bridges. Reported by
      "troll_un". Fixes bug 4348; bugfix on 0.2.0.10-alpha, when NETINFO
      cells were introduced.
    - Warn the user when HTTPProxy, but no other proxy type, is
      configured. This can cause surprising behavior: it doesn't send
      all of Tor's traffic over the HTTPProxy -- it sends unencrypted
      directory traffic only. Resolves ticket 4663.
  o Major bugfixes (hidden services):
    - Improve hidden service robustness: when an attempt to connect to
      a hidden service ends, be willing to refetch its hidden service
      descriptors from each of the HSDir relays responsible for them
      immediately. Previously, we would not consider refetching the
      service's descriptors from each HSDir for 15 minutes after the last
      fetch, which was inconvenient if the hidden service was not running
      during the first attempt. Bugfix on 0.2.0.18-alpha; fixes bug 3335.
    - Hidden services now ignore the timestamps on INTRODUCE2 cells.
      They used to check that the timestamp was within 30 minutes
      of their system clock, so they could cap the size of their
      replay-detection cache, but that approach unnecessarily refused
      service to clients with wrong clocks. Bugfix on 0.2.1.6-alpha, when
      the v3 intro-point protocol (the first one which sent a timestamp
      field in the INTRODUCE2 cell) was introduced; fixes bug 3460.
    - When one of a hidden service's introduction points appears to be
      unreachable, stop trying it. Previously, we would keep trying
      to build circuits to the introduction point until we lost the
      descriptor, usually because the user gave up and restarted Tor.
      Fixes part of bug 3825.
  o Changes to default torrc file:
    - Stop listing "socksport 9050" in torrc.sample. We open a socks
      port on 9050 by default anyway, so this should not change anything
      in practice.
    - Stop mentioning the deprecated *ListenAddress options in
      torrc.sample. Fixes bug 5438.
    - Document unit of bandwidth-related options in sample torrc.
      Fixes bug 5621.
    - Fix broken URLs in the sample torrc file, and tell readers about
      the OutboundBindAddress, ExitPolicyRejectPrivate, and
      PublishServerDescriptor options. Addresses bug 4652.
  o Minor features (directory authorities):
    - Consider new, removed or changed IPv6 OR ports a non-cosmetic
      change when the authority is deciding whether to accept a newly
      uploaded descriptor. Implements ticket 6423.
    - Directory authorities are now a little more lenient at accepting
      older router descriptors, or newer router descriptors that don't
      make big changes. This should help ameliorate past and future
      issues where routers think they have uploaded valid descriptors,
      but the authorities don't think so. Fix for ticket 2479.
    - Authority operators can now vote for all relays in a given
      set of countries to be BadDir/BadExit/Invalid/Rejected.
    - Provide two consensus parameters (FastFlagMinThreshold and
      FastFlagMaxThreshold) to control the range of allowable bandwidths
      for the Fast directory flag. These allow authorities to run
      experiments on appropriate requirements for being a "Fast" node.
      The AuthDirFastGuarantee config value still applies. Implements
      ticket 3946.
  o Minor features (bridges / bridge authorities):
    - Make bridge SSL certificates a bit more stealthy by using random
      serial numbers, in the same fashion as OpenSSL when generating
      self-signed certificates. Implements ticket 4584.
    - Tag a bridge's descriptor as "never to be sent unencrypted".
      This shouldn't matter, since bridges don't open non-anonymous
      connections to the bridge authority and don't allow unencrypted
      directory connections from clients, but we might as well make
      sure. Closes bug 5139.
    - The Bridge Authority now writes statistics on how many bridge
      descriptors it gave out in total, and how many unique descriptors
      it gave out. It also lists how often the most and least commonly
      fetched descriptors were given out, as well as the median and
      25th/75th percentile. Implements tickets 4200 and 4294.
  o Minor features (IPv6):
    - Make the code that clients use to detect an address change be
      IPv6-aware, so that it won't fill clients' logs with error
      messages when trying to get the IPv4 address of an IPv6
      connection. Implements ticket 5537.
    - Relays now understand an IPv6 address when they get one from a
      directory server. Resolves ticket 4875.
  o Minor features (hidden services):
    - Expire old or over-used hidden service introduction points.
      Required by fix for bug 3460.
    - Reduce the lifetime of elements of hidden services' Diffie-Hellman
      public key replay-detection cache from 60 minutes to 5 minutes. This
      replay-detection cache is now used only to detect multiple
      INTRODUCE2 cells specifying the same rendezvous point, so we can
      avoid launching multiple simultaneous attempts to connect to it.
    - When a hidden service's introduction point times out, consider
      trying it again during the next attempt to connect to the
      HS. Previously, we would not try it again unless a newly fetched
      descriptor contained it. Required by fixes for bugs 1297 and 3825.
  o Minor features (relays):
    - Relays now include a reason for regenerating their descriptors
      in an HTTP header when uploading to the authorities. This will
      make it easier to debug descriptor-upload issues in the future.
    - Turn on directory request statistics by default and include them in
      extra-info descriptors. Don't break if we have no GeoIP database.
    - Replace files in stats/ rather than appending to them. Now that we
      include statistics in extra-info descriptors, it makes no sense to
      keep old statistics forever. Implements ticket 2930.
    - Relays that set "ConnDirectionStatistics 1" write statistics on the
      bidirectional use of connections to disk every 24 hours.
    - Add a GeoIP file digest to the extra-info descriptor. Implements
      ticket 1883.
  o Minor features (new config options):
    - New config option "DynamicDHGroups" (disabled by default) provides
      each bridge with a unique prime DH modulus to be used during
      SSL handshakes. This option attempts to help against censors
      who might use the Apache DH modulus as a static identifier for
      bridges. Addresses ticket 4548.
    - New config option "DisableDebuggerAttachment" (on by default)
      to prevent basic debugging attachment attempts by other processes.
      Supports Mac OS X and Gnu/Linux. Resolves ticket 3313.
    - Ordinarily, Tor does not count traffic from private addresses (like
      127.0.0.1 or 10.0.0.1) when calculating rate limits or accounting.
      There is now a new option, CountPrivateBandwidth, to disable this
      behavior. Patch from Daniel Cagara.
  o Minor features (different behavior for old config options):
    - Allow MapAddress directives to specify matches against super-domains,
      as in "MapAddress *.torproject.org *.torproject.org.torserver.exit".
      Implements issue 933.
    - Don't disable the DirPort when we cannot exceed our AccountingMax
      limit during this interval because the effective bandwidthrate is
      low enough. This is useful in a situation where AccountMax is only
      used as an additional safeguard or to provide statistics.
    - Add port 6523 (Gobby) to LongLivedPorts. Patch by intrigeri;
      implements ticket 3439.
    - When configuring a large set of nodes in EntryNodes, and there are
      enough of them listed as Guard so that we don't need to consider
      the non-guard entries, prefer the ones listed with the Guard flag.
    - If you set the NumCPUs option to 0, Tor will now try to detect how
      many CPUs you have. This is the new default behavior.
    - The NodeFamily option -- which let you declare that you want to
      consider nodes to be part of a family whether they list themselves
      that way or not -- now allows IP address ranges and country codes.
  o Minor features (new command-line config behavior):
    - Slightly change behavior of "list" options (that is, config
      options that can appear more than once) when they appear both in
      torrc and on the command line. Previously, the command-line options
      would be appended to the ones from torrc. Now, the command-line
      options override the torrc options entirely. This new behavior
      allows the user to override list options (like exit policies and
      ports to listen on) from the command line, rather than simply
      appending to the list.
    - You can get the old (appending) command-line behavior for "list"
      options by prefixing the option name with a "+".
    - You can remove all the values for a "list" option from the command
      line without adding any new ones by prefixing the option name
      with a "/".
  o Minor features (controller, new events):
    - Extend the control protocol to report flags that control a circuit's
      path selection in CIRC events and in replies to 'GETINFO
      circuit-status'. Implements part of ticket 2411.
    - Extend the control protocol to report the hidden service address
      and current state of a hidden-service-related circuit in CIRC
      events and in replies to 'GETINFO circuit-status'. Implements part
      of ticket 2411.
    - Include the creation time of a circuit in CIRC and CIRC2
      control-port events and the list produced by the 'GETINFO
      circuit-status' control-port command.
    - Add a new CONF_CHANGED event so that controllers can be notified
      of any configuration changes made by other controllers, or by the
      user. Implements ticket 1692.
    - Add a new SIGNAL event to the controller interface so that
      controllers can be notified when Tor handles a signal. Resolves
      issue 1955. Patch by John Brooks.
  o Minor features (controller, new getinfo options):
    - Expose our view of whether we have gone dormant to the controller,
      via a new "GETINFO dormant" value. Torbutton and other controllers
      can use this to avoid doing periodic requests through Tor while
      it's dormant (bug 4718). Resolves ticket 5954.
    - Add a new GETINFO option to get total bytes read and written. Patch
      from pipe, revised by atagar. Resolves ticket 2345.
    - Implement new GETINFO controller fields to provide information about
      the Tor process's pid, euid, username, and resource limits.
  o Minor features (controller, other):
    - Allow controllers to request an event notification whenever a
      circuit is cannibalized or its purpose is changed. Implements
      part of ticket 3457.
    - Use absolute path names when reporting the torrc filename in the
      control protocol, so a controller can more easily find the torrc
      file. Resolves bug 1101.
    - When reporting the path to the cookie file to the controller,
      give an absolute path. Resolves ticket 4881.
  o Minor features (log messages):
    - Add more information to a log statement that might help track down
      bug 4091. If you're seeing "Bug: tor_addr_is_internal() called with a
      non-IP address" messages (or any Bug messages, for that matter!),
      please let us know about it.
    - If EntryNodes are given, but UseEntryGuards is set to 0, warn that
      EntryNodes will have no effect. Resolves issue 2571.
    - Try to make the introductory warning message that Tor prints on
      startup more useful for actually finding help and information.
      Resolves ticket 2474.
    - When the system call to create a listener socket fails, log the
      error message explaining why. This may help diagnose bug 4027.
  o Minor features (other):
    - When we fail to initialize Libevent, retry with IOCP disabled so we
      don't need to turn on multi-threading support in Libevent, which in
      turn requires a working socketpair(). This is a workaround for bug
      4457, which affects Libevent versions from 2.0.1-alpha through
      2.0.15-stable.
    - When starting as root and then changing our UID via the User
      control option, and we have a ControlSocket configured, make sure
      that the ControlSocket is owned by the same account that Tor will
      run under. Implements ticket 3421; fix by J??r??my Bobbio.
    - Accept attempts to include a password authenticator in the
      handshake, as supported by SOCKS5. This handles SOCKS clients that
      don't know how to omit a password when authenticating. Resolves
      bug 1666.
    - Check for and recover from inconsistency in the microdescriptor
      cache. This will make it harder for us to accidentally free a
      microdescriptor without removing it from the appropriate data
      structures. Fixes issue 3135; issue noted by "wanoskarnet".
    - Shorten links in the tor-exit-notice file. Patch by Christian Kujau.
  o Minor bugfixes (code security):
    - Prevent a null-pointer dereference when receiving a data cell
      for a nonexistent stream when the circuit in question has an
      empty deliver window. We don't believe this is triggerable,
      since we don't currently allow deliver windows to become empty,
      but the logic is tricky enough that it's better to make the code
      robust. Fixes bug 5541; bugfix on 0.0.2pre14.
    - Fix a (harmless) integer overflow in cell statistics reported by
      some fast relays. Fixes bug 5849; bugfix on 0.2.2.1-alpha.
    - Fix our implementation of crypto_random_hostname() so it can't
      overflow on ridiculously large inputs. (No Tor version has ever
      provided this kind of bad inputs, but let's be correct in depth.)
      Fixes bug 4413; bugfix on 0.2.2.9-alpha. Fix by Stephen Palmateer.
    - Add a (probably redundant) memory clear between iterations of
      the router status voting loop, to prevent future coding errors
      where data might leak between iterations of the loop. Resolves
      ticket 6514.
  o Minor bugfixes (wrapper functions):
    - Abort if tor_vasprintf() fails in connection_printf_to_buf() (a
      utility function used in the control-port code). This shouldn't
      ever happen unless Tor is completely out of memory, but if it did
      happen and Tor somehow recovered from it, Tor could have sent a log
      message to a control port in the middle of a reply to a controller
      command. Fixes part of bug 3428; bugfix on 0.1.2.3-alpha.
    - Fix some (not actually triggerable) buffer size checks in usage of
      tor_inet_ntop(). Fixes bug 4434; bugfix on Tor 0.2.0.1-alpha. Patch
      by Anders Sundman.
    - Fix parsing of some corner-cases with tor_inet_pton(). Fixes
      bug 4515; bugfix on 0.2.0.1-alpha; fix by Anders Sundman.
    - Enforce correct return behavior of tor_vsscanf() when the '%%'
      pattern is used. Fixes bug 5558. Bugfix on 0.2.1.13.
    - Make our replacement implementation of strtok_r() compatible with
      the standard behavior of strtok_r(). Patch by nils. Fixes bug 5091;
      bugfix on 0.2.2.1-alpha.
    - Find more places in the code that should have been testing for
      invalid sockets using the SOCKET_OK macro. Required for a fix
      for bug 4533. Bugfix on 0.2.2.28-beta.
  o Minor bugfixes (code correctness):
    - Check return value of fputs() when writing authority certificate
      file. Fixes Coverity issue 709056; bugfix on 0.2.0.1-alpha.
    - When building Tor on Windows with -DUNICODE (not default), ensure
      that error messages, filenames, and DNS server names are always
      NUL-terminated when we convert them to a single-byte encoding.
      Fixes bug 5909; bugfix on 0.2.2.16-alpha.
    - Fix a memory leak when trying to launch a DNS request when the
      nameservers are unconfigurable. Fixes bug 5916; bugfix on Tor
      0.1.2.1-alpha.
    - Correct file sizes when reading binary files on Cygwin, to avoid
      a bug where Tor would fail to read its state file. Fixes bug 6844;
      bugfix on 0.1.2.7-alpha.
    - Make sure to set *socket_error in all error cases in
      connection_connect(), so it can't produce a warning about
      errno being zero from errno_to_orconn_end_reason(). Bugfix on
      0.2.1.1-alpha; resolves ticket 6028.
    - Initialize conn->addr to a valid state in spawn_cpuworker(). Fixes
      bug 4532; found by "troll_un".
  o Minor bugfixes (clients):
    - Allow one-hop directory-fetching circuits the full "circuit build
      timeout" period, rather than just half of it, before failing them
      and marking the relay down. This fix should help reduce cases where
      clients declare relays (or worse, bridges) unreachable because
      the TLS handshake takes a few seconds to complete. Fixes bug 6743;
      bugfix on 0.2.2.2-alpha, where we changed the timeout from a static
      30 seconds.
    - Ensure we don't cannibalize circuits that are longer than three hops
      already, so we don't end up making circuits with 5 or more
      hops. Patch contributed by wanoskarnet. Fixes bug 5231; bugfix on
      0.1.0.1-rc which introduced cannibalization.
  o Minor bugfixes (relays):
    - Don't publish a new relay descriptor when we reload our onion key,
      unless the onion key has actually changed. Fixes bug 3263 and
      resolves another cause of bug 1810. Bugfix on 0.1.1.11-alpha.
    - When relays refuse a "create" cell because their queue of pending
      create cells is too big (typically because their cpu can't keep up
      with the arrival rate), send back reason "resource limit" rather
      than reason "internal", so network measurement scripts can get a
      more accurate picture. Bugfix on 0.1.1.11-alpha; fixes bug 7037.
    - Exit nodes don't need to fetch certificates for authorities that
      they don't recognize; only directory authorities, bridges,
      and caches need to do that. Fixes part of bug 2297; bugfix on
      0.2.2.11-alpha.
  o Minor bugfixes (directory authority / mirrors):
    - Avoid O(n^2) performance characteristics when parsing a large
      extrainfo cache. Fixes bug 5828; bugfix on 0.2.0.1-alpha.
    - Authorities no longer include any router in their microdescriptor
      consensuses for which they couldn't generate or agree on a
      microdescriptor. Fixes the second piece of bug 6404; fix on
      0.2.2.6-alpha.
    - When checking for requested signatures on the latest consensus
      before serving it to a client, make sure to check the right
      consensus flavor. Bugfix on 0.2.2.6-alpha.
    - Fix an edge case where TestingTorNetwork is set but the authorities
      and relays all have an uptime of zero, so the private Tor network
      could briefly lack support for hidden services. Fixes bug 3886;
      bugfix on 0.2.2.18-alpha.
    - Directory caches no longer refuse to clean out descriptors because
      of missing v2 networkstatus documents, unless they're configured
      to retrieve v2 networkstatus documents. Fixes bug 4838; bugfix on
      0.2.2.26-beta. Patch by Daniel Bryg.
    - Don't serve or accept v2 hidden service descriptors over a relay's
      DirPort. It's never correct to do so, and disabling it might
      make it more annoying to exploit any bugs that turn up in the
      descriptor-parsing code. Fixes bug 7149.
  o Minor bugfixes (hidden services, client-side):
    - Assert that hidden-service-related operations are not performed
      using single-hop circuits. Previously, Tor would assert that
      client-side streams are not attached to single-hop circuits,
      but not that other sensitive operations on the client and service
      side are not performed using single-hop circuits. Fixes bug 3332;
      bugfix on 0.0.6.
    - Avoid undefined behaviour when parsing the list of supported
      rendezvous/introduction protocols in a hidden service descriptor.
      Previously, Tor would have confused (as-yet-unused) protocol version
      numbers greater than 32 with lower ones on many platforms. Fixes
      bug 6827; bugfix on 0.2.0.10-alpha. Found by George Kadianakis.
    - Don't close hidden service client circuits which have almost
      finished connecting to their destination when they reach
      the normal circuit-build timeout. Previously, we would close
      introduction circuits which are waiting for an acknowledgement
      from the introduction point, and rendezvous circuits which have
      been specified in an INTRODUCE1 cell sent to a hidden service,
      after the normal CBT. Now, we mark them as 'timed out', and launch
      another rendezvous attempt in parallel. This behavior change can
      be disabled using the new CloseHSClientCircuitsImmediatelyOnTimeout
      option. Fixes part of bug 1297; bugfix on 0.2.2.2-alpha.
  o Minor bugfixes (hidden services, service-side):
    - Don't close hidden-service-side rendezvous circuits when they
      reach the normal circuit-build timeout. This behaviour change can
      be disabled using the new
      CloseHSServiceRendCircuitsImmediatelyOnTimeout option. Fixes the
      remaining part of bug 1297; bugfix on 0.2.2.2-alpha.
    - Don't launch more than 10 service-side introduction-point circuits
      for a hidden service in five minutes. Previously, we would consider
      launching more introduction-point circuits if at least one second
      had passed without any introduction-point circuits failing. Fixes
      bug 4607; bugfix on 0.0.7pre1.
  o Minor bugfixes (config option behavior):
    - If the user tries to set MyFamily on a bridge, refuse to
      do so, and warn about the security implications. Fixes bug 4657;
      bugfix on 0.2.0.3-alpha.
    - The "--quiet" and "--hush" options now apply not only to Tor's
      behavior before logs are configured, but also to Tor's behavior in
      the absense of configured logs. Fixes bug 3550; bugfix on
      0.2.0.10-alpha.
    - Change the AllowDotExit rules so they should actually work.
      We now enforce AllowDotExit only immediately after receiving an
      address via SOCKS or DNSPort: other sources are free to provide
      .exit addresses after the resolution occurs. Fixes bug 3940;
      bugfix on 0.2.2.1-alpha.
    - Make "LearnCircuitBuildTimeout 0" work more reliably. Specifically,
      don't depend on the consensus parameters or compute adaptive
      timeouts when it is disabled. Fixes bug 5049; bugfix on
      0.2.2.14-alpha.
    - After we pick a directory mirror, we would refuse to use it if
      it's in our ExcludeExitNodes list, resulting in mysterious failures
      to bootstrap for people who just wanted to avoid exiting from
      certain locations. Fixes bug 5623; bugfix on 0.2.2.25-alpha.
    - When told to add a bridge with the same digest as a preexisting
      bridge but a different addr:port, change the addr:port as
      requested. Previously we would not notice the change. Fixes half
      of bug 5603; fix on 0.2.2.26-beta.
  o Minor bugfixes (controller):
    - Allow manual 'authenticate' commands to the controller interface
      from netcat (nc) as well as telnet. We were rejecting them because
      they didn't come with the expected whitespace at the end of the
      command. Bugfix on 0.1.1.1-alpha; fixes bug 2893.
    - Report a real bootstrap problem to the controller on router
      identity mismatch. Previously we just said "foo", which probably
      made a lot of sense at the time. Fixes bug 4169; bugfix on
      0.2.1.1-alpha.
    - When we receive a SIGHUP and the controller __ReloadTorrcOnSIGHUP
      option is set to 0 (which Vidalia version 0.2.16 now does when
      a SAVECONF attempt fails), perform other actions that SIGHUP
      usually causes (like reopening the logs). Fixes bug 5095; bugfix
      on 0.2.1.9-alpha.
    - Correctly handle checking the permissions on the parent
      directory of a control socket in the root directory. Bug found
      by Esteban Manchado Vel??zquez. Fixes bug 5089; bugfix on Tor
      0.2.2.26-beta.
    - End AUTHCHALLENGE error messages (in the control protocol) with
      a CRLF. Fixes bug 5760; bugfix on 0.2.2.36.
  o Minor bugfixes (network reading/writing):
    - Disable writing on marked-for-close connections when they are
      blocked on bandwidth, to prevent busy-looping in Libevent. Fixes
      bug 5263; bugfix on 0.0.2pre13, where we first added a special
      case for flushing marked connections.
    - Make sure that there are no unhandled pending TLS errors before
      reading from a TLS stream. We had checks in 0.1.0.3-rc, but
      lost them in 0.1.0.5-rc when we refactored read_to_buf_tls().
      Bugfix on 0.1.0.5-rc; fixes bug 4528.
    - Detect SSL handshake even when the initial attempt to write the
      server hello fails. Fixes bug 4592; bugfix on 0.2.0.13-alpha.
    - If the client fails to set a reasonable set of ciphersuites
      during its v2 handshake renegotiation, allow the renegotiation to
      continue nevertheless (i.e. send all the required certificates).
      Fixes bug 4591; bugfix on 0.2.0.20-rc.
  o Minor bugfixes (other):
    - Exit nodes now correctly report EADDRINUSE and EADDRNOTAVAIL as
      resource exhaustion, so that clients can adjust their load to
      try other exits. Fixes bug 4710; bugfix on 0.1.0.1-rc, which
      started using END_STREAM_REASON_RESOURCELIMIT.
    - Don't check for whether the address we're using for outbound
      connections has changed until after the outbound connection has
      completed. On Windows, getsockname() doesn't succeed until the
      connection is finished. Fixes bug 5374; bugfix on 0.1.1.14-alpha.
    - Don't hold a Windows file handle open for every file mapping;
      the file mapping handle is sufficient. Fixes bug 5951; bugfix on
      0.1.2.1-alpha.
    - Fix wrong TCP port range in parse_port_range(). Fixes bug 6218;
      bugfix on 0.2.1.10-alpha.
    - If we fail to write a microdescriptor to the disk cache, do not
      continue replacing the old microdescriptor file. Fixes bug 2954;
      bugfix on 0.2.2.6-alpha.
  o Minor bugfixes (log messages, path selection):
    - Downgrade "set buildtimeout to low value" messages to "info"
      severity; they were never an actual problem, there was never
      anything reasonable to do about them, and they tended to spam logs
      from time to time. Fixes bug 6251; bugfix on 0.2.2.2-alpha.
    - Rate-limit the "Weighted bandwidth is 0.000000" message, and add
      more information to it, so that we can track it down in case it
      returns again. Mitigates bug 5235.
    - Check CircuitBuildTimeout and LearnCircuitBuildTimeout in
      options_validate(); warn if LearnCircuitBuildTimeout is disabled and
      CircuitBuildTimeout is set unreasonably low. Resolves ticket 5452.
    - Issue a log message if a guard completes less than 40% of your
      circuits. Threshold is configurable by torrc option
      PathBiasNoticeRate and consensus parameter pb_noticepct. There is
      additional, off-by-default code to disable guards which fail too
      many circuits. Addresses ticket 5458.
  o Minor bugfixes (log messages, client):
    - Downgrade "Got a certificate, but we already have it" log messages
      from warning to info, except when we're a dirauth. Fixes bug 5238;
      bugfix on 0.2.1.7-alpha.
    - Fix the log message describing how we work around discovering
      that our version is the ill-fated OpenSSL 0.9.8l. Fixes bug
      4837; bugfix on 0.2.2.9-alpha.
    - When logging about a disallowed .exit name, do not also call it
      an "invalid onion address". Fixes bug 3325; bugfix on 0.2.2.9-alpha.
    - Fix a log message suggesting that people contact a non-existent
      email address. Fixes bug 3448.
    - Rephrase the log message emitted if the TestSocks check is
      successful. Patch from Fabian Keil; fixes bug 4094.
    - Log (at debug level) whenever a circuit's purpose is changed.
    - Log SSL state transitions at log level DEBUG, log domain
      HANDSHAKE. This can be useful for debugging censorship events.
      Implements ticket 3264.
    - We now log which torrc file we're using on startup. Implements
      ticket 2444.
    - Rate-limit log messages when asked to connect anonymously to
      a private address. When these hit, they tended to hit fast and
      often. Also, don't bother trying to connect to addresses that we
      are sure will resolve to 127.0.0.1: getting 127.0.0.1 in a directory
      reply makes us think we have been lied to, even when the address the
      client tried to connect to was "localhost." Resolves ticket 2822.
  o Minor bugfixes (log messages, non-client):
    - Downgrade "eventdns rejected address" message to LOG_PROTOCOL_WARN.
      Fixes bug 5932; bugfix on 0.2.2.7-alpha.
    - Don't log that we have "decided to publish new relay descriptor"
      unless we are actually publishing a descriptor. Fixes bug 3942;
      bugfix on 0.2.2.28-beta.
    - Log which authority we're missing votes from when we go to fetch
      them from the other auths.
    - Replace "Sending publish request" log messages with "Launching
      upload", so that they no longer confusingly imply that we're
      sending something to a directory we might not even be connected
      to yet. Fixes bug 3311; bugfix on 0.2.0.10-alpha.
    - Warn when Tor is configured to use accounting in a way that can
      link a hidden service to some other hidden service or public
      address. Resolves ticket 6490.
    - Fix a minor formatting issue in one of tor-gencert's error messages.
      Fixes bug 4574.
  o Testing:
    - Update to the latest version of the tinytest unit testing framework.
      This includes a couple of bugfixes that can be relevant for
      running forked unit tests on Windows, and removes all reserved
      identifiers.
    - Avoid a false positive in the util/threads unit test by increasing
      the maximum timeout time. Fixes bug 6227; bugfix on 0.2.0.4-alpha.
    - Make it possible to set the TestingTorNetwork configuration
      option using AlternateDirAuthority and AlternateBridgeAuthority
      as an alternative to setting DirServer. Addresses ticket 6377.
    - Add a unit test for the environment_variable_names_equal() function.
    - A wide variety of new unit tests by Esteban Manchado Vel??zquez.
    - Numerous new unit tests for functions in util.c and address.c by
      Anders Sundman.
    - The long-disabled benchmark tests are now split into their own
      ./src/test/bench binary.
    - The benchmark tests can now use more accurate timers than
      gettimeofday() when such timers are available.
    - Use tt_assert(), not tor_assert(), for checking for test failures.
      This makes the unit tests more able to go on in the event that
      one of them fails.
  o Build improvements:
    - Use the dead_strip option when building Tor on OS X. This reduces
      binary size by almost 19% when linking openssl and libevent
      statically, which we do for Tor Browser Bundle.
    - Provide a better error message about possible OSX Asciidoc failure
      reasons. Fixes bug 6436.
    - Detect attempts to build Tor on (as yet hypothetical) versions
      of Windows where sizeof(intptr_t) != sizeof(SOCKET). Partial
      fix for bug 4533. Bugfix on 0.2.2.28-beta.
    - On Windows, we now define the _WIN32_WINNT macros only if they
      are not already defined. This lets the person building Tor decide,
      if they want, to require a later version of Windows.
    - Our autogen.sh script now uses autoreconf to launch autoconf,
      automake, and so on. This is more robust against some of the failure
      modes associated with running the autotools pieces on their own.
    - Running "make version" now displays the version of Tor that
      we're about to build. Idea from katmagic; resolves issue 4400.
    - Make 'tor --digests' list hashes of all Tor source files. Bugfix
      on 0.2.2.4-alpha; fixes bug 3427.
    - New --enable-static-tor configure option for building Tor as
      statically as possible. Idea, general hackery and thoughts from
      Alexei Czeskis, John Gilmore, Jacob Appelbaum. Implements ticket
      2702.
    - Limited, experimental support for building with nmake and MSVC.
  o Build requirements:
    - Building Tor with bufferevent support now requires Libevent
      2.0.13-stable or later. Previous versions of Libevent had bugs in
      SSL-related bufferevents and related issues that would make Tor
      work badly with bufferevents. Requiring 2.0.13-stable also allows
      Tor with bufferevents to take advantage of Libevent APIs
      introduced after 2.0.8-rc.
    - Our build system requires automake 1.6 or later to create the
      Makefile.in files. Previously, you could have used 1.4.
      This only affects developers and people building Tor from git;
      people who build Tor from the source distribution without changing
      the Makefile.am files should be fine.
    - Detect when we try to build on a platform that doesn't define
      AF_UNSPEC to 0. We don't work there, so refuse to compile.
  o Build fixes (compile/link):
    - Format more doubles with %f, not %lf. Patch from grarpamp to make
      Tor build correctly on older BSDs again. Fixes bug 3894; bugfix on
      Tor 0.2.0.8-alpha.
    - When building with --enable-static-tor on OpenBSD, do not
      erroneously attempt to link -lrt. Fixes bug 5103.
    - Set _WIN32_WINNT to 0x0501 consistently throughout the code, so
      that IPv6 stuff will compile on MSVC, and compilation issues
      will be easier to track down. Fixes bug 5861.
    - Fix build and 64-bit compile warnings from --enable-openbsd-malloc.
      Fixes bug 6379. Bugfix on 0.2.0.20-rc.
    - Make Tor build correctly again with -DUNICODE -D_UNICODE defined.
      Fixes bug 6097; bugfix on 0.2.2.16-alpha.
  o Build fixes (other):
    - Use the _WIN32 macro throughout our code to detect Windows.
      (Previously we had used the obsolete 'WIN32' and the idiosyncratic
      'MS_WINDOWS'.)
    - Properly handle the case where the build-tree is not the same
      as the source tree when generating src/common/common_sha1.i,
      src/or/micro-revision.i, and src/or/or_sha1.i. Fixes bug 3953;
      bugfix on 0.2.0.1-alpha.
    - During configure, search for library containing cos function as
      libm lives in libcore on some platforms (BeOS/Haiku). Linking
      against libm was hard-coded before. Fixes the first part of bug
      4727; bugfix on 0.2.2.2-alpha. Patch and analysis by Martin Hebnes
      Pedersen.
    - Prevent a false positive from the check-spaces script, by disabling
      the "whitespace between function name and (" check for functions
      named 'op()'.
  o Packaging (RPM) changes:
    - Update our default RPM spec files to work with mock and rpmbuild
      on RHEL/Fedora. They have an updated set of dependencies and
      conflicts, a fix for an ancient typo when creating the "_tor"
      user, and better instructions. Thanks to Ondrej Mikle for the
      patch series. Fixes bug 6043.
    - On OpenSUSE, create the /var/run/tor directory on startup if it
      is not already created. Patch from Andreas Stieger. Fixes bug 2573.
  o Code refactoring (safety):
    - Do not use SMARTLIST_FOREACH for any loop whose body exceeds
      10 lines. Also, don't nest them. Doing so in the past has
      led to hard-to-debug code. The new style is to use the
      SMARTLIST_FOREACH_{BEGIN,END} pair. Addresses issue 6400.
    - Use macros to indicate OpenSSL versions, so we don't need to worry
      about accidental hexadecimal bit shifts.
    - Use tor_sscanf() in place of scanf() in more places through the
      code. This makes us a little more locale-independent, and
      should help shut up code-analysis tools that can't tell
      a safe sscanf string from a dangerous one.
    - Convert more instances of tor_snprintf+tor_strdup into tor_asprintf.
    - Use the smartlist_add_asprintf() alias more consistently.
  o Code refactoring (consolidate):
    - A major revision to our internal node-selecting and listing logic.
      Tor already had at least two major ways to look at the question of
      "which Tor servers do we know about": a list of router descriptors,
      and a list of entries in the current consensus. With
      microdescriptors, we're adding a third. Having so many systems
      without an abstraction layer over them was hurting the codebase.
      Now, we have a new "node_t" abstraction that presents a consistent
      interface to a client's view of a Tor node, and holds (nearly) all
      of the mutable state formerly in routerinfo_t and routerstatus_t.
    - Move tor_gettimeofday_cached() into compat_libevent.c, and use
      Libevent's notion of cached time when possible.
    - Remove duplicate code for invoking getrlimit() from control.c.
    - Use OpenSSL's built-in SSL_state_string_long() instead of our
      own homebrewed ssl_state_to_string() replacement. Patch from
      Emile Snyder. Fixes bug 4653.
    - Change the symmetric cipher interface so that creating and
      initializing a stream cipher are no longer separate functions.
  o Code refactoring (separate):
    - Make a new "entry connection" struct as an internal subtype of "edge
      connection", to simplify the code and make exit connections smaller.
    - Split connection_about_to_close() into separate functions for each
      connection type.
    - Rewrite the listener-selection logic so that parsing which ports
      we want to listen on is now separate from binding to the ports
      we want.
  o Code refactoring (name changes):
    - Rename a handful of old identifiers, mostly related to crypto
      structures and crypto functions. By convention, our "create an
      object" functions are called "type_new()", our "free an object"
      functions are called "type_free()", and our types indicate that
      they are types only with a final "_t". But a handful of older
      types and functions broke these rules, with function names like
      "type_create" or "subsystem_op_type", or with type names like
      type_env_t.
    - Rename Tor functions that turn strings into addresses, so that
      "parse" indicates that no hostname resolution occurs, and
      "lookup" indicates that hostname resolution may occur. This
      should help prevent mistakes in the future. Fixes bug 3512.
    - Use the name "CERTS" consistently to refer to the new cell type;
      we were calling it CERT in some places and CERTS in others.
    - Use a TOR_INVALID_SOCKET macro when initializing a socket to an
      invalid value, rather than just -1.
    - Rename the bench_{aes,dmap} functions to test_*, so that tinytest
      can pick them up when the tests aren't disabled. Bugfix on
      0.2.2.4-alpha which introduced tinytest.
  o Code refactoring (other):
    - Defensively refactor rend_mid_rendezvous() so that protocol
      violations and length checks happen in the beginning. Fixes
      bug 5645.
    - Remove the pure attribute from all functions that used it
      previously. In many cases we assigned it incorrectly, because the
      functions might assert or call impure functions, and we don't have
      evidence that keeping the pure attribute is worthwhile. Implements
      changes suggested in ticket 4421.
    - Move the replay-detection cache for the RSA-encrypted parts of
      INTRODUCE2 cells to the introduction point data structures.
      Previously, we would use one replay-detection cache per hidden
      service. Required by fix for bug 3460.
    - The helper programs tor-gencert, tor-resolve, and tor-checkkey
      no longer link against Libevent: they never used it, but
      our library structure used to force them to link it.
  o Removed features and files:
    - Remove all internal support for unpadded RSA. We never used it, and
      it would be a bad idea to start.
    - Remove some workaround code for OpenSSL 0.9.6 (which is no longer
      supported).
    - Remove some redundant  directives throughout the code.
      Patch from Andrea Gelmini.
    - Remove some old code to remember statistics about which descriptors
      we've served as a directory mirror. The feature wasn't used and
      is outdated now that microdescriptors are around.
    - Remove some old code to work around even older versions of Tor that
      used forked processes to handle DNS requests. Such versions of Tor
      are no longer in use as relays.
    - The "torify" script no longer supports the "tsocks" socksifier
      tool, since tsocks doesn't support DNS and UDP right for Tor.
      Everyone should be using torsocks instead. Fixes bugs 3530 and
      5180. Based on a patch by "ugh".
    - Remove the torrc.bridge file: we don't use it for anything, and
      it had become badly desynchronized from torrc.sample. Resolves
      bug 5622.
  o Documentation:
    - Begin a doc/state-contents.txt file to explain the contents of
      the Tor state file. Fixes bug 2987.
    - Clarify the documentation for the Alternate*Authority options.
      Fixes bug 6387.
    - Document the --defaults-torrc option, and the new semantics for
      overriding, extending, and clearing lists of options. Closes
      bug 4748.
    - Add missing man page documentation for consensus and microdesc
      files. Resolves ticket 6732.
    - Fix some typos in the manpages. Patch from A. Costa. Fixes bug 6500.
  o Documentation fixes:
    - Improve the manual's documentation for the NT Service command-line
      options. Addresses ticket 3964.
    - Clarify SessionGroup documentation slightly; resolves ticket 5437.
    - Document the changes to the ORPort and DirPort options, and the
      fact that {OR/Dir}ListenAddress is now unnecessary (and
      therefore deprecated). Resolves ticket 5597.
    - Correct a broken faq link in the INSTALL file. Fixes bug 2307.
    - Clarify that hidden services are TCP only. Fixes bug 6024.

@_date: 2012-11-20 12:50:11
@_author: Roger Dingledine 
@_subject: [tor-talk] Trouble with signal newnym 
Newnym tells Tor that new application requests should go to a new circuit.
But Polipo generally keeps its TCP connection to the webserver open,
for pipelining.
Thus from Tor's perspective there may not be a new application request,
since from Polipo's perspective, the old one (on the old circuit) is
still working fine.
I believe the simplest fix might be "don't use Polipo then".

@_date: 2012-10-01 12:11:18
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor exit node IPv6 
IPv6 bridges and guards work, but exiting isn't implemented yet.
(You could help. :)

@_date: 2012-10-03 13:31:03
@_author: Roger Dingledine 
@_subject: [tor-talk] [tor-relays]  clockskewer attack 
In theory you don't need the open http server -- the Tor relay will tell
you what time it thinks it is during the TLS handshake (or if you do a
directory fetch of /tor/server/authority and look at the http headers
in its answer).
But yes, running a hidden service on a public relay may not be the
greatest idea. Even ignoring this 'clock skew fingerprinting' issue,
you can do much simpler things like correlate relay up/down time with
hidden service up/down time.
And just so nobody digs out papers in the future and is shocked, here are
some related papers you could read:

@_date: 2012-10-20 14:39:45
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.23-rc is out 
Tor 0.2.3.23-rc adds a new v3 directory authority, fixes a privacy
vulnerability introduced by a change in OpenSSL, and fixes a variety
of smaller bugs in preparation for the release.
I hope this will be the final release candidate for the 0.2.3 series.
That is, if we don't find any urgent issues, the next release will be
called stable.
(Packages coming eventually, hopefully soon since this is the final
release candidate.)
Changes in version 0.2.3.23-rc - 2012-10-20
  o New directory authorities:
    - Add Faravahar (run by Sina Rabbani) as the ninth v3 directory
      authority. Closes ticket 5749.
  o Major bugfixes (security/privacy):
    - Disable TLS session tickets. OpenSSL's implementation was giving
      our TLS session keys the lifetime of our TLS context objects, when
      perfect forward secrecy would want us to discard anything that
      could decrypt a link connection as soon as the link connection
      was closed. Fixes bug 7139; bugfix on all versions of Tor linked
      against OpenSSL 1.0.0 or later. Found by Florent Daigni??re.
    - Discard extraneous renegotiation attempts once the V3 link
      protocol has been initiated. Failure to do so left us open to
      a remotely triggerable assertion failure. Fixes CVE-2012-2249;
      bugfix on 0.2.3.6-alpha. Reported by "some guy from France".
  o Major bugfixes:
    - Fix a possible crash bug when checking for deactivated circuits
      in connection_or_flush_from_first_active_circuit(). Fixes bug 6341;
      bugfix on 0.2.2.7-alpha. Bug report and fix received pseudonymously.
  o Minor bugfixes (on 0.2.3.x):
    - Fix two cases in src/or/transports.c where we were calling
      fmt_addr() twice in a parameter list. Bug found by David
      Fifield. Fixes bug 7014; bugfix on 0.2.3.9-alpha.
    - Convert an assert in the pathbias code to a log message. The assert
      appears to only be triggerable by Tor2Web mode. Fixes bug 6866;
      bugfix on 0.2.3.17-beta.
    - Fix memory leaks whenever we logged any message about the "path
      bias" detection. Fixes bug 7022; bugfix on 0.2.3.21-rc.
  o Minor bugfixes (on 0.2.2.x and earlier):
    - Don't serve or accept v2 hidden service descriptors over a relay's
      DirPort. It's never correct to do so, and disabling it might
      make it more annoying to exploit any bugs that turn up in the
      descriptor-parsing code. Fixes bug 7149.
    - When relays refuse a "create" cell because their queue of pending
      create cells is too big (typically because their cpu can't keep up
      with the arrival rate), send back reason "resource limit" rather
      than reason "internal", so network measurement scripts can get a
      more accurate picture. Bugfix on 0.1.1.11-alpha; fixes bug 7037.
    - Correct file sizes when reading binary files on Cygwin, to avoid
      a bug where Tor would fail to read its state file. Fixes bug 6844;
      bugfix on 0.1.2.7-alpha.
    - Avoid undefined behaviour when parsing the list of supported
      rendezvous/introduction protocols in a hidden service descriptor.
      Previously, Tor would have confused (as-yet-unused) protocol version
      numbers greater than 32 with lower ones on many platforms. Fixes
      bug 6827; bugfix on 0.2.0.10-alpha. Found by George Kadianakis.
  o Documentation fixes:
    - Clarify that hidden services are TCP only. Fixes bug 6024.

@_date: 2012-10-21 18:36:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.4-alpha is out 
Tor 0.2.4.4-alpha adds a new v3 directory authority, fixes a privacy
vulnerability introduced by a change in OpenSSL, fixes a remotely
triggerable assert, and adds new channel_t and circuitmux_t abstractions
that will make it easier to test new connection transport and cell
scheduling algorithms.
Changes in version 0.2.4.4-alpha - 2012-10-20
  o New directory authorities (also in 0.2.3.23-rc):
    - Add Faravahar (run by Sina Rabbani) as the ninth v3 directory
      authority. Closes ticket 5749.
  o Major bugfixes (security/privacy, also in 0.2.3.23-rc):
    - Disable TLS session tickets. OpenSSL's implementation was giving
      our TLS session keys the lifetime of our TLS context objects, when
      perfect forward secrecy would want us to discard anything that
      could decrypt a link connection as soon as the link connection
      was closed. Fixes bug 7139; bugfix on all versions of Tor linked
      against OpenSSL 1.0.0 or later. Found by Florent Daigni??re.
    - Discard extraneous renegotiation attempts once the V3 link
      protocol has been initiated. Failure to do so left us open to
      a remotely triggerable assertion failure. Fixes CVE-2012-2249;
      bugfix on 0.2.3.6-alpha. Reported by "some guy from France".
  o Internal abstraction features:
    - Introduce new channel_t abstraction between circuits and
      or_connection_t to allow for implementing alternate OR-to-OR
      transports. A channel_t is an abstract object which can either be a
      cell-bearing channel, which is responsible for authenticating and
      handshaking with the remote OR and transmitting cells to and from
      it, or a listening channel, which spawns new cell-bearing channels
      at the request of remote ORs. Implements part of ticket 6465.
    - Also new is the channel_tls_t subclass of channel_t, adapting it
      to the existing or_connection_t code. The V2/V3 protocol handshaking
      code which formerly resided in command.c has been moved below the
      channel_t abstraction layer and may be found in channeltls.c now.
      Implements the rest of ticket 6465.
    - Introduce new circuitmux_t storing the queue of circuits for
      a channel; this encapsulates and abstracts the queue logic and
      circuit selection policy, and allows the latter to be overridden
      easily by switching out a policy object. The existing EWMA behavior
      is now implemented as a circuitmux_policy_t. Resolves ticket 6816.
  o Required libraries:
    - Tor now requires OpenSSL 0.9.8 or later. OpenSSL 1.0.0 or later is
      strongly recommended.
  o Minor features:
    - Warn users who run hidden services on a Tor client with
      UseEntryGuards disabled that their hidden services will be
      vulnerable to  (the
      attack which motivated Tor to support entry guards in the first
      place). Resolves ticket 6889.
    - Tor now builds correctly on Bitrig, an OpenBSD fork. Patch from
      dhill. Resolves ticket 6982.
  o Minor bugfixes (also in 0.2.3.23-rc):
    - Don't serve or accept v2 hidden service descriptors over a
      relay's DirPort. It's never correct to do so, and disabling it
      might make it more annoying to exploit any bugs that turn up in the
      descriptor-parsing code. Fixes bug 7149.
    - Fix two cases in src/or/transports.c where we were calling
      fmt_addr() twice in a parameter list. Bug found by David
      Fifield. Fixes bug 7014; bugfix on 0.2.3.9-alpha.
    - Fix memory leaks whenever we logged any message about the "path
      bias" detection. Fixes bug 7022; bugfix on 0.2.3.21-rc.
    - When relays refuse a "create" cell because their queue of pending
      create cells is too big (typically because their cpu can't keep up
      with the arrival rate), send back reason "resource limit" rather
      than reason "internal", so network measurement scripts can get a
      more accurate picture. Fixes bug 7037; bugfix on 0.1.1.11-alpha.
  o Minor bugfixes:
    - Command-line option "--version" implies "--quiet". Fixes bug 6997.
    - Free some more still-in-use memory at exit, to make hunting for
      memory leaks easier. Resolves bug 7029.
    - When a Tor client gets a "truncated" relay cell, the first byte of
      its payload specifies why the circuit was truncated. We were
      ignoring this 'reason' byte when tearing down the circuit, resulting
      in the controller not being told why the circuit closed. Now we
      pass the reason from the truncated cell to the controller. Bugfix
      on 0.1.2.3-alpha; fixes bug 7039.
    - Downgrade "Failed to hand off onionskin" messages to "debug"
      severity, since they're typically redundant with the "Your computer
      is too slow" messages. Fixes bug 7038; bugfix on 0.2.2.16-alpha.
    - Make clients running with IPv6 bridges connect over IPv6 again,
      even without setting new config options ClientUseIPv6 and
      ClientPreferIPv6ORPort. Fixes bug 6757; bugfix on 0.2.4.1-alpha.
    - Use square brackets around IPv6 addresses in numerous places
      that needed them, including log messages, HTTPS CONNECT proxy
      requests, TransportProxy statefile entries, and pluggable transport
      extra-info lines. Fixes bug 7011; patch by David Fifield.
  o Code refactoring and cleanup:
    - Source files taken from other packages now reside in src/ext;
      previously they were scattered around the rest of Tor.
    - Avoid use of reserved identifiers in our C code. The C standard
      doesn't like us declaring anything that starts with an
      underscore, so let's knock it off before we get in trouble. Fix
      for bug 1031; bugfix on the first Tor commit.

@_date: 2012-10-23 22:17:43
@_author: Roger Dingledine 
@_subject: [tor-talk] How do I know the number of Tor users nearby? 
It's when the number of users in the country is sufficiently below
(or above) the expected number of users in the country, relative to
how usage numbers change in other countries at the same time.
Nearly all such "censorship events" are false positives currently.
See also

@_date: 2012-10-26 01:04:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.24-rc is out 
Tor 0.2.3.24-rc fixes two important security vulnerabilities that
could lead to remotely triggerable relay crashes, and fixes
a major bug that was preventing clients from choosing suitable exit
I hope this will be the final release candidate for the 0.2.3 series.
That is, if we don't find any urgent issues, the next release will be
called stable.
(Packages coming eventually, hopefully soon since this is the final
release candidate.)
Changes in version 0.2.3.24-rc - 2012-10-25
  o Major bugfixes (security):
    - Fix a group of remotely triggerable assertion failures related to
      incorrect link protocol negotiation. Found, diagnosed, and fixed
      by "some guy from France". Fix for CVE-2012-2250; bugfix on
      0.2.3.6-alpha.
    - Fix a denial of service attack by which any directory authority
      could crash all the others, or by which a single v2 directory
      authority could crash everybody downloading v2 directory
      information. Fixes bug 7191; bugfix on 0.2.0.10-alpha.
  o Major bugfixes:
    - When parsing exit policy summaries from microdescriptors, we had
      previously been ignoring the last character in each one, so that
      "accept 80,443,8080" would be treated by clients as indicating
      a node that allows access to ports 80, 443, and 808. That would
      lead to clients attempting connections that could never work,
      and ignoring exit nodes that would support their connections. Now
      clients parse these exit policy summaries correctly. Fixes bug 7192;
      bugfix on 0.2.3.1-alpha.
  o Minor bugfixes:
    - Clients now consider the ClientRejectInternalAddresses config option
      when using a microdescriptor consensus stanza to decide whether
      an exit relay would allow exiting to an internal address. Fixes
      bug 7190; bugfix on 0.2.3.1-alpha.

@_date: 2012-10-26 01:47:25
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.5-alpha is out 
Tor 0.2.4.5-alpha comes hard at the heels of 0.2.4.4-alpha, to fix
two important security vulnerabilities that could lead to remotely
triggerable relay crashes, fix a major bug that was preventing clients
from choosing suitable exit nodes, and refactor some of our code.
Changes in version 0.2.4.5-alpha - 2012-10-25
  o Major bugfixes (security, also in 0.2.3.24-rc):
    - Fix a group of remotely triggerable assertion failures related to
      incorrect link protocol negotiation. Found, diagnosed, and fixed
      by "some guy from France". Fix for CVE-2012-2250; bugfix on
      0.2.3.6-alpha.
    - Fix a denial of service attack by which any directory authority
      could crash all the others, or by which a single v2 directory
      authority could crash everybody downloading v2 directory
      information. Fixes bug 7191; bugfix on 0.2.0.10-alpha.
  o Major bugfixes (also in 0.2.3.24-rc):
    - When parsing exit policy summaries from microdescriptors, we had
      previously been ignoring the last character in each one, so that
      "accept 80,443,8080" would be treated by clients as indicating
      a node that allows access to ports 80, 443, and 808. That would
      lead to clients attempting connections that could never work,
      and ignoring exit nodes that would support their connections. Now
      clients parse these exit policy summaries correctly. Fixes bug 7192;
      bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (also in 0.2.3.24-rc):
    - Clients now consider the ClientRejectInternalAddresses config option
      when using a microdescriptor consensus stanza to decide whether
      an exit relay would allow exiting to an internal address. Fixes
      bug 7190; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes:
    - Only disable TLS session ticket support when running as a TLS
      server. Now clients will blend better with regular Firefox
      connections. Fixes bug 7189; bugfix on Tor 0.2.3.23-rc.
  o Code simplification and refactoring:
    - Start using OpenBSD's implementation of queue.h (originally by
      Niels Provos).
    - Move the entry node code from circuitbuild.c to its own file.
    - Move the circuit build timeout tracking code from circuitbuild.c
      to its own file.

@_date: 2012-09-05 19:35:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.21-rc is out 
Tor 0.2.3.21-rc is the fourth release candidate for the Tor 0.2.3.x
series. It fixes a trio of potential security bugs, fixes a bug where
we were leaving some of the fast relays out of the microdescriptor
consensus, resumes interpreting "ORPort 0" and "DirPort 0" correctly,
and cleans up other smaller issues.
(Packages coming eventually.)
Changes in version 0.2.3.21-rc - 2012-09-05
  o Major bugfixes (security):
    - Tear down the circuit if we get an unexpected SENDME cell. Clients
      could use this trick to make their circuits receive cells faster
      than our flow control would have allowed, or to gum up the network,
      or possibly to do targeted memory denial-of-service attacks on
      entry nodes. Fixes bug 6252. Bugfix on the 54th commit on Tor --
      from July 2002, before the release of Tor 0.0.0. We had committed
      this patch previously, but we had to revert it because of bug 6271.
      Now that 6271 is fixed, this patch appears to work.
    - Reject any attempt to extend to an internal address. Without
      this fix, a router could be used to probe addresses on an internal
      network to see whether they were accepting connections. Fixes bug
      6710; bugfix on 0.0.8pre1.
    - Do not crash when comparing an address with port value 0 to an
      address policy. This bug could have been used to cause a remote
      assertion failure by or against directory authorities, or to
      allow some applications to crash clients. Fixes bug 6690; bugfix
      on 0.2.1.10-alpha.
  o Major bugfixes:
    - Remove the upper bound on microdescriptor length. We were hitting
      the limit for routers with complex exit policies or family
      declarations, causing clients to not use them. Fixes the first
      piece of bug 6404; fix on 0.2.2.6-alpha.
    - Detect "ORPort 0" as meaning, uniformly, that we're not running
      as a relay. Previously, some of our code would treat the presence
      of any ORPort line as meaning that we should act like a relay,
      even though our new listener code would correctly not open any
      ORPorts for ORPort 0. Similar bugs in other Port options are also
      fixed. Fixes the first half of bug 6507; bugfix on 0.2.3.3-alpha.
  o Minor bugfixes:
    - Avoid a pair of double-free and use-after-mark bugs that can
      occur with certain timings in canceled and re-received DNS
      requests. Fixes bug 6472; bugfix on 0.0.7rc1.
    - Fix build and 64-bit compile warnings from --enable-openbsd-malloc.
      Fixes bug 6379. Bugfix on 0.2.0.20-rc.
    - Allow one-hop directory fetching circuits the full "circuit build
      timeout" period, rather than just half of it, before failing them
      and marking the relay down. This fix should help reduce cases where
      clients declare relays (or worse, bridges) unreachable because
      the TLS handshake takes a few seconds to complete. Fixes bug 6743;
      bugfix on 0.2.2.2-alpha, where we changed the timeout from a static
      30 seconds.
    - Authorities no longer include any router in their microdescriptor
      consensuses for which they couldn't generate or agree on a
      microdescriptor. Fixes the second piece of bug 6404; fix on
      0.2.2.6-alpha.
    - Detect and reject attempts to specify both "FooPort" and
      "FooPort 0" in the same configuration domain. (It's still okay
      to have a FooPort in your configuration file, and use "FooPort 0"
      on the command line to disable it.) Fixes the second half of bug
      6507; bugfix on 0.2.3.3-alpha.
    - Make wildcarded addresses (that is, ones beginning with "*.") work
      when provided via the controller's MapAddress command. Previously,
      they were accepted, but we never actually noticed that they were
      wildcards. Fixes bug 6244; bugfix on 0.2.3.9-alpha.
    - Avoid crashing on a malformed state file where EntryGuardPathBias
      precedes EntryGuard. Fixes bug 6774; bugfix on 0.2.3.17-beta.
    - Add a (probably redundant) memory clear between iterations of
      the router status voting loop, to prevent future coding errors
      where data might leak between iterations of the loop. Resolves
      ticket 6514.
  o Minor bugfixes (log messages):
    - Downgrade "set buildtimeout to low value" messages to "info"
      severity; they were never an actual problem, there was never
      anything reasonable to do about them, and they tended to spam logs
      from time to time. Fixes bug 6251; bugfix on 0.2.2.2-alpha.
    - Downgrade path-bias warning messages to "info". We'll try to get
      them working better in 0.2.4. Add internal circuit construction
      state to protect against the noisy warn message "Unexpectedly high
      circuit_successes". Also add some additional rate-limited notice
      messages to help determine the root cause of the warn. Fixes bug
      6475. Bugfix against 0.2.3.17-beta.
    - Move log message when unable to find a microdesc in a routerstatus
      entry to parse time. Previously we'd spam this warning every time
      we tried to figure out which microdescriptors to download. Fixes
      the third piece of bug 6404; fix on 0.2.3.18-rc.
  o Minor features:
    - Consider new, removed or changed IPv6 OR ports a non-cosmetic
      change when the authority is deciding whether to accept a newly
      uploaded descriptor. Implements ticket 6423.
    - Add missing documentation for consensus and microdesc files.
      Resolves ticket 6732.

@_date: 2012-09-05 20:50:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.1-alpha is out 
Tor 0.2.4.1-alpha lets bridges publish their pluggable transports to
bridgedb; lets relays use IPv6 addresses and directory authorities
advertise them; and switches to a cleaner build interface.
This is the first alpha release in a new series, so expect there to
be bugs. Users who would rather test out a more stable branch should
stay with 0.2.3.x for now.
(Packages coming eventually.)
Changes in version 0.2.4.1-alpha - 2012-09-05
  o Major features (bridges):
    - Bridges now report the pluggable transports they support to the
      bridge authority, so it can pass the supported transports on to
      bridgedb and/or eventually do reachability testing. Implements
      ticket 3589.
  o Major features (IPv6):
    - Bridge authorities now accept IPv6 bridge addresses and include
      them in network status documents. Implements ticket 5534.
    - Clients who set "ClientUseIPv6 1" may connect to entry nodes over
      IPv6. Set "ClientPreferIPv6ORPort 1" to make this even more likely
      to happen. Implements ticket 5535.
    - All kind of relays, not just bridges, can now advertise an IPv6
      OR port. Implements ticket 6362.
    - Directory authorities vote on IPv6 OR ports using the new consensus
      method 14. Implements ticket 6363.
  o Major features (build):
    - Switch to a nonrecursive Makefile structure. Now instead of each
      Makefile.am invoking other Makefile.am's, there is a master
      Makefile.am that includes the others. This change makes our build
      process slightly more maintainable, and improves parallelism for
      building with make -j. Original patch by Stewart Smith; various
      fixes by Jim Meyering.
    - Where available, we now use automake's "silent" make rules by
      default, so that warnings are easier to spot. You can get the old
      behavior with "make V=1". Patch by Stewart Smith for ticket 6522.
  o Minor features (code security and spec conformance):
    - Clear keys and key-derived material left on the stack in
      rendservice.c and rendclient.c. Check return value of
      crypto_pk_write_private_key_to_string() in end_service_load_keys().
      These fixes should make us more forward-secure against cold-boot
      attacks and the like. Fixes bug 2385.
    - Reject EXTEND cells sent to nonexistent streams. According to the
      spec, an EXTEND cell sent to _any_ nonzero stream ID is invalid, but
      we were only checking for stream IDs that were currently in use.
      Found while hunting for more instances of bug 6271. Bugfix on
      0.0.2pre8, which introduced incremental circuit construction.
  o Minor features (streamlining);
    - No longer include the "opt" prefix when generating routerinfos
      or v2 directories: it has been needless since Tor 0.1.2. Closes
      ticket 5124.
    - Remove some now-needless code that tried to aggressively flush
      OR connections as data was added to them. Since 0.2.0.1-alpha, our
      cell queue logic has saved us from the failure mode that this code
      was supposed to prevent. Removing this code will limit the number
      of baroque control flow paths through Tor's network logic. Reported
      pseudonymously on IRC. Fixes bug 6468; bugfix on 0.2.0.1-alpha.
  o Minor features (controller):
    - Add a "GETINFO signal/names" control port command. Implements
      ticket 3842.
    - Provide default values for all options via "GETINFO config/defaults".
      Implements ticket 4971.
  o Minor features (IPv6):
    - New config option "AuthDirHasIPv6Connectivity 1" that directory
      authorities should set if they have IPv6 connectivity and want to
      do reachability tests for IPv6 relays. Implements feature 5974.
    - A relay with an IPv6 OR port now sends that address in NETINFO
      cells (in addition to its other address). Implements ticket 6364.
  o Minor features (log messages):
    - Omit the first heartbeat log message, because it never has anything
      useful to say, and it clutters up the bootstrapping messages.
      Resolves ticket 6758.
    - Don't log about reloading the microdescriptor cache at startup. Our
      bootstrap warnings are supposed to tell the user when there's a
      problem, and our bootstrap notices say when there isn't. Resolves
      ticket 6759; bugfix on 0.2.2.6-alpha.
    - Don't log "I learned some more directory information" when we're
      reading cached directory information. Reserve it for when new
      directory information arrives in response to a fetch. Resolves
      ticket 6760.
    - Prevent rounding error in path bias counts when scaling
      them down, and use the correct scale factor default. Also demote
      some path bias related log messages down a level and make others
      less scary sounding. Fixes bug 6647. Bugfix against 0.2.3.17-beta.
    - We no longer warn so much when generating manpages from their
      asciidoc source.
  o Code simplifications and refactoring:
    - Enhance our internal sscanf replacement so that we can eliminate
      the last remaining uses of the system sscanf. (Though those uses
      of sscanf were safe, sscanf itself is generally error prone, so
      we want to eliminate when we can.) Fixes ticket 4195 and Coverity
      CID 448.
    - Move ipv6_preferred from routerinfo_t to node_t. Addresses bug 4620.
    - Move last_reachable and testing_since from routerinfo_t to node_t.
      Implements ticket 5529.
    - Add replaycache_t structure, functions and unit tests, then refactor
      rend_service_introduce() to be more clear to read, improve, debug,
      and test. Resolves bug 6177.
    - Finally remove support for malloc_good_size and malloc_usable_size.
      We had hoped that these functions would let us eke a little more
      memory out of our malloc implementation. Unfortunately, the only
      implementations that provided these functions are also ones that
      are already efficient about not overallocation: they never got us
      more than 7 or so bytes per allocation. Removing them saves us a
      little code complexity and a nontrivial amount of build complexity.
  o New requirements:
    - Tor maintainers now require Automake version 1.9 or later to build
      Tor from the Git repository. (Automake is not required when building
      from a source distribution.)

@_date: 2012-09-07 05:11:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, August 2012 
Here's what I said at the beginning of August that I hoped to do:
Done. FOCI went really well -- we had 30-40 people there, and I think
most of the talks were interesting.
I've attempted to pass the torch to Jed Crandall and Joss Wright
for next year's FOCI. But it looks like there will be some early
stumbling blocks around whether Usenix wants to keep FOCI attached
to Usenix Security. We'll see how that plays out.
I spent much of my Usenix Security talking to research groups about
setting up fast exit relays. See more about that below.
I also talked to George Kadianakis about Tor network diversity metrics,
and got him talking to a wide variety of other researchers for further
I talked to him, but we didn't come to any conclusions. Most of the fixes
are delicate and have poorly understood tradeoffs. I left him with the
plan that he would write a Tor design proposal or two, so we can think
through the implications.
Done. We did a bunch of huge simulations using Amazon EC2, and ended
up finding that mysterious bugs were ruining our results. We decided
to focus on the simplest simulation question, and try to sort out the
bugs. You can read our saga here:
and as of early September, we've found and/or solved some good ones. Hard
to say how many more remain before Shadow can solve all our problems, but
I think we're getting closer.
Continued. You can read some of my discussions at
George suggested that we try to turn them into a survey list of Tor
attacks. Feel free to get that started if you like the idea.
We have a few fast bridges running. The real challenge here will be the
traditional bridge distribution strategy question: we need to give them
out to people who need them without letting the bad guy find them. We're
trying out some not-so-automated strategies first.  I think the handful
of fast stable bridges we have should be enough for now, on the principle
that for any strategy that doesn't tell so many people that the bad guy
learns too, a stable 100mbit bridge can handle all the good users who
learn about it. In parallel we should continue exploring tricks like
Philipp Winter's brdgrd tool:
and maybe later on we'll move on to alternate transports like Obfsproxy.
We've got immediate plans from CMU and Penn that I know of, and promises
from Georgia Tech and Michigan:
Moritz and I wrote up
which has so far been useful.
Steve Bellovin at Columbia suggested that we get EFF to write a letter
that university professors can hand to their general counsel, explaining
what Tor is. I'm still talking to EFF people about what exactly they
could write.
There's also now a tor-relays-universities list as a support group for
people trying to run exit relays at universities:
Not done. I believe Andrew met with Tor's lawyers to discuss how to
position it so that we continue to pass our audits, etc. (Making new
organizational and bureaucratic ways to attack Tor doesn't sound great,
at least not until we understand them better.) I'm hoping to team up
with a couple of other organizations so that we can give them large bulk
grants, and they can divide the money up further. If that should be you,
please let us know!
I'm hoping Moritz can take charge of this topic and make it happen.
I got 0.2.3.20-rc out:
Turns out 0.2.3.21-rc waited until September.
Not done, but done in September.
Done. I'm going to Berlin next week:
Dagstuhl after that:
and ETH Zurich after that to do a talk at Srdjan Capkun's group on
Sept 25.
Still unsorted.
Not yet scheduled. The other PIs are overloaded with other things,
so I guess there's no rush, so long as we're doing useful research things.
He's written the web page, but hasn't announced it or linked it yet. I
guess I'll leave that timing up to him
Done. I even managed to be on vacation for some of it.

@_date: 2012-09-09 02:59:03
@_author: Roger Dingledine 
@_subject: [tor-talk] hidden services and stream isolation (file transfer 
Tricks like this make sense when the bottleneck is at the edges of the
network. But when the bottleneck is in the core of the network (which is
the case with Tor, since it has way too much load compared to the relay
capacity), then trying to 'optimize' your transfer by pretending to be
multiple people is an arms race that just makes things worse.
6 hops.
But yes, this is a risk. We're trying to resolve it in general with both
a) the relay consensus weights (to shift traffic to the relays that can
handle it better) and
b) the circuit-build-timeout computation (where you as a client discard
the slowest 20% of your circuits).
If everybody moved to the fastest 20% of the relays, though, it would
be worse than what it is now. Good load balancing means using the
slower relays too, just less often.
(But not *too* slow:
 )
I think you aren't considering how much cpu load is added by opening a
new circuit. In this case (for hidden services), the circuit creation will
be on-demand (rather than preemptive), which means you'll be waiting for
each circuit to open (which involves many circuits, for a hidden service
rendezvous) before you can use it. This latency you will experience is
exactly the sort of thing that will get worse if people start overloading
the network with extra circuits.
This is another instance of the general problem that we see from a lot
of researchers: "I think Tor is slow because of X. Therefore I will
change my client behavior to do this other thing. It works better for
me now. Therefore every client should make this change." That's why Rob
and I have been pushing Shadow so much:
since whole-Tor-network simulators are the right way to evaluate
largescale client behavior changes.
I wonder if it would be worthwhile to try to rig up a Shadow simulation
to see results. My guess is that if my clients do it, it will ruin the
network for the clients who don't; whether it also ruins the network
for the clients that *also* do it remains to be seen. See also
While I'm at it, there *are* several steps that would lead to
significantly improving hidden service performance:
plus the various performance and security fixes in the 'Tor hidden
service' category.
I know it can be tempting to treat the Tor design and code as a black
box and try to hack around it, but I think in this case the clear right
thing to do is to make the code not suck so much.

@_date: 2012-09-10 18:49:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.2-alpha is out 
Tor 0.2.4.2-alpha enables port forwarding for pluggable transports,
raises the default rate limiting even more, and makes the bootstrapping
log messages less noisy.
(Packages coming eventually.)
Changes in version 0.2.4.2-alpha - 2012-09-10
  o Major features:
    - Automatically forward the TCP ports of pluggable transport
      proxies using tor-fw-helper if PortForwarding is enabled. Implements
      ticket 4567.
  o Major bugfixes:
    - Raise the default BandwidthRate/BandwidthBurst values from 5MB/10MB
      to 1GB/1GB. The previous defaults were intended to be "basically
      infinite", but it turns out they're now limiting our 100mbit+
      relays and bridges. Fixes bug 6605; bugfix on 0.2.0.10-alpha (the
      last time we raised it).
  o Minor features:
    - Detect when we're running with a version of OpenSSL other than the
      one we compiled with. This has occasionally given people hard-to-
      track-down errors.
    - Log fewer lines at level "notice" about our OpenSSL and Libevent
      versions and capabilities when everything is going right. Resolves
      part of ticket 6736.
    - Directory authorities no long accept descriptors for any version of
      Tor before 0.2.2.35, or for any 0.2.3 release before 0.2.3.10-alpha.
      These versions are insecure, unsupported, or both. Implements
      ticket 6789.
  o Minor bugfixes:
    - Rename the (internal-use-only) UsingTestingNetworkDefaults option
      to start with a triple-underscore so the controller won't touch it.
      Patch by Meejah. Fixes bug 3155. Bugfix on 0.2.2.23-alpha.
    - Avoid segfault when starting up having run with an extremely old
      version of Tor and parsing its state file. Fixes bug 6801; bugfix
      on 0.2.2.23-alpha.
    - Rename the (testing-use-only) _UseFilteringSSLBufferevents option
      so it doesn't start with _. Fixes bug 3155. Bugfix on 0.2.3.1-alpha.
    - Don't follow the NULL pointer if microdescriptor generation fails.
      (This does not appear to be triggerable, but it's best to be safe.)
      Found by "f. tp.". Fixes bug 6797; bugfix on 0.2.4.1-alpha.
    - Fix mis-declared dependencies on src/common/crypto.c and
      src/or/tor_main.c that could break out-of-tree builds under some
      circumstances. Fixes bug 6778; bugfix on 0.2.4.1-alpha.
    - Avoid a warning when building common_sha1.i out of tree. Fixes bug
      6778; bugfix on 0.2.4.1-alpha.
    - Fix a harmless (in this case) build warning for implicitly
      converting a strlen() to an int. Bugfix on 0.2.4.1-alpha.
  o Removed features:
    - Now that all versions before 0.2.2.x are disallowed, we no longer
      need to work around their missing features. Thus we can remove a
      bunch of compatibility code.
  o Code refactoring:
    - Tweak tor-fw-helper to accept an arbitrary amount of arbitrary
      TCP ports to forward. In the past it only accepted two ports:
      the ORPort and the DirPort.

@_date: 2012-09-10 18:55:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.2-alpha is out 
Ok, I lied. While 0.2.2 and 0.2.3 are both still alive, it is unwise
to clutter our download page with alpha releases. You can find the
tarballs at

@_date: 2012-09-12 05:12:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.3.22-rc is out 
Tor 0.2.3.22-rc fixes another opportunity for a remotely triggerable
We'll be putting out 0.2.2.39 packages shortly that fix the issue too.
(Packages coming eventually.)
Changes in version 0.2.3.22-rc - 2012-09-11
  o Security fixes:
    - Fix an assertion failure in tor_timegm() that could be triggered
      by a badly formatted directory object. Bug found by fuzzing with
      Radamsa. Fixes bug 6811; bugfix on 0.2.0.20-rc.
  o Minor bugfixes:
    - Avoid segfault when starting up having run with an extremely old
      version of Tor and parsing its state file. Fixes bug 6801; bugfix
      on 0.2.2.23-alpha.

@_date: 2012-09-19 15:19:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Italy - third highest number users 
France and Spain show similar growth.
We've seen some overall growth in total Tor user count too, perhaps due
to the recent growth in network capacity.
But it's interesting that other countries like the US stay flat during
this period.
Let me renew my caution that these usage numbers are very rough --
we're not quite in the 'numerology' category, but close.

@_date: 2012-09-22 06:55:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.3-alpha is out 
Tor 0.2.4.3-alpha fixes another opportunity for a remotely triggerable
assertion, resumes letting relays test reachability of their DirPort,
and cleans up a bunch of smaller bugs.
Changes in version 0.2.4.3-alpha - 2012-09-22
  o Security fixes:
    - Fix an assertion failure in tor_timegm() that could be triggered
      by a badly formatted directory object. Bug found by fuzzing with
      Radamsa. Fixes bug 6811; bugfix on 0.2.0.20-rc.
  o Major bugfixes:
    - Fix a possible crash bug when checking for deactivated circuits
      in connection_or_flush_from_first_active_circuit(). Fixes bug 6341;
      bugfix on 0.2.2.7-alpha. Bug report and fix received pseudonymously.
    - Allow routers to detect that their own DirPorts are running. When
      we removed support for versions_supports_begindir, we also
      accidentally removed the mechanism we used to self-test our
      DirPort. Diagnosed with help from kargig. Fixes bugs 6814 and 6815;
      bugfix on 0.2.4.2-alpha.
  o Security features:
    - Switch to a completely time-invariant approach for picking nodes
      weighted by bandwidth. Our old approach would run through the
      part of the loop after it had made its choice slightly slower
      than it ran through the part of the loop before it had made its
      choice. Addresses ticket 6538.
    - Disable the use of Guard nodes when in Tor2WebMode. Guard usage
      by tor2web clients allows hidden services to identity tor2web
      clients through their repeated selection of the same rendezvous
      and introduction point circuit endpoints (their guards). Resolves
      ticket 6888.
  o Minor features:
    - Enable Tor to read configuration, state, and key information from
      a FIFO. Previously Tor would only read from files with a positive
      stat.st_size. Code from meejah; fixes bug 6044.
  o Minor bugfixes:
    - Correct file sizes when reading binary files on Cygwin, to avoid
      a bug where Tor would fail to read its state file. Fixes bug 6844;
      bugfix on 0.1.2.7-alpha.
    - Correctly handle votes with more than 31 flags. Fixes bug 6853;
      bugfix on 0.2.0.3-alpha.
    - When complaining about a client port on a public address, log
      which address we're complaining about. Fixes bug 4020; bugfix on
      0.2.3.3-alpha. Patch by Tom Fitzhenry.
    - Convert an assert in the pathbias code to a log message. The assert
      appears to only be triggerable by Tor2Web mode. Fixes bug 6866;
      bugfix on 0.2.3.17-beta.
    - Our new buildsystem was overzealous about rebuilding manpages: it
      would rebuild them all whenever any one of them changed. Now our
      dependency checking should be correct. Fixes bug 6843; bugfix on
      0.2.4.1-alpha.
    - Don't do reachability testing over IPv6 unless AuthDirPublishIPv6
      is set. Fixes bug 6880. Bugfix on 0.2.4.1-alpha.
    - Correct log printout about which address family is preferred
      when connecting to a bridge with both an IPv4 and IPv6 OR port.
      Fixes bug 6884; bugfix on 0.2.4.1-alpha.
  o Minor bugfixes (code cleanliness):
    - Fix round_to_power_of_2() so it doesn't invoke undefined behavior
      with large values. This situation was untriggered, but nevertheless
      incorrect. Fixes bug 6831; bugfix on 0.2.0.1-alpha.
    - Reject consensus votes with more than 64 known-flags. We aren't even
      close to that limit yet, and our code doesn't handle it correctly.
      Fixes bug 6833; bugfix on 0.2.0.1-alpha.
    - Avoid undefined behaviour when parsing the list of supported
      rendezvous/introduction protocols in a hidden service descriptor.
      Previously, Tor would have confused (as-yet-unused) protocol version
      numbers greater than 32 with lower ones on many platforms. Fixes
      bug 6827; bugfix on 0.2.0.10-alpha. Found by George Kadianakis.
    - Fix handling of rendezvous client authorization types over 8.
      Fixes bug 6861; bugfix on 0.2.1.5-alpha.
    - Fix building with older versions of GCC (2.95, for one) that don't
      like preprocessor directives inside macro arguments. Found by
      grarpamp. Fixes bug 6842; bugfix on 0.2.4.2-alpha.
    - Switch weighted node selection rule from using a list of doubles
      to using a list of int64_t. This change should make the process
      slightly easier to debug and maintain. Needed to finish ticket 6538.
  o Code simplification and refactoring:
    - Move the generic "config" code into a new file, and have "config.c"
      hold only torrc- and state-related code. Resolves ticket 6823.
    - Move the core of our "choose a weighted element at random" logic
      into its own function, and give it unit tests. Now the logic is
      testable, and a little less fragile too.
    - Removed the testing_since field of node_t, which hasn't been used
      for anything since 0.2.0.9-alpha.
  o Documentation fixes:
    - Clarify that hidden services are TCP only. Fixes bug 6024.
    - Resolve a typo in torrc.sample.in. Fixes bug 6819; bugfix on
      0.2.3.14-alpha.

@_date: 2012-09-22 07:16:34
@_author: Roger Dingledine 
@_subject: [tor-talk] need only tor-browser firefox and chrome 
Not currently. Right now the only safe way to use Tor as a client
is with the Tor Browser Bundle.
See  for the variety
of issues that it addresses. Running a separate Tor is possible in theory,
but we assume you'll get it wrong so we discourage it.
Note that on Linux and OS X, the Tor in TBB picks a random port, so it
should be compatible with (or at least not conflict with) a system Tor.
But see which says "The random port selection has been temporarily disabled in the
Linux and Mac OS X alpha bundles. Most of you probably didn't notice any
random port selection happpening at all, but if you encounter a problem
running a system Tor and your Tor Browser Bundle at the same time, you
can switch to the stable bundles for now. The next update should have
a fix that allows us to re-enable automatic port selection."
See also

@_date: 2012-09-22 08:17:31
@_author: Roger Dingledine 
@_subject: [tor-talk] A question about mac addresses 
Try a google for "who can see my mac address".
On first glance, I like

@_date: 2012-09-29 10:17:07
@_author: Roger Dingledine 
@_subject: [tor-talk] How do I change tor's socks5 port from 9050 to 9051? 
I don't think Vidalia can do it. You'll have to edit your torrc file
That said, 9051 is typically the control port, so you'll probably be
screwing things up and inviting confusing error messages by setting your
socksport to 9051.

@_date: 2012-09-30 10:30:06
@_author: Roger Dingledine 
@_subject: [tor-talk] DNSPort & googlemail.com 
$ host 173.194.41.150
150.41.194.173.in-addr.arpa domain name pointer lhr08s03-in-f22.1e100.net.
$ host 74.125.230.150
150.230.125.74.in-addr.arpa domain name pointer lhr14s02-in-f22.1e100.net.
$ host 74.125.230.149
149.230.125.74.in-addr.arpa domain name pointer lhr14s02-in-f21.1e100.net.
Looks like they're all the 'right' answer. My guess is that Google is
doing some sort of geodns where it chooses its answers based on where
you're asking from.

@_date: 2013-04-10 07:13:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Mar 2013 
Five things I did in March 2013:
1) Released Tor 0.2.4.11-alpha:
2) Attended the "tech at state" conference in DC, where various groups
that the US State Dept is funding got together to talk. I was on a panel
about circumvention technology. Every time I go to DC there are literally
scores of people that it would be useful for me to spend more time with;
now I know why so many people end up moving there.
3) Briefed SponsorF on know what we've been up to in the past few months.
4) Started to explain Tor's ecosystem to Tom (our new project
coordinator). Mainly I started walking him through who's on the people
page, and also explained all the hats I wear and we discussed which are
smartest to try to give away.
5) Reviewed PETS papers. Several of them are Tor-related and are
getting in. I'm shepherding two. More news once the 'accepted papers'
list comes out.

@_date: 2013-04-15 04:45:04
@_author: Roger Dingledine 
@_subject: [tor-talk] anonymity at the outset 
First check out
and click on various combinations of "Tor" and "HTTPS".
Then read

@_date: 2013-04-16 07:24:51
@_author: Roger Dingledine 
@_subject: [tor-talk] Where to get latest exe for Tor obfsproxy browser 
If it works for you, there's no need to configure anything. This bundle
comes pre-configured to use several obfsproxy servers run by various
The bundle also comes pre-configured with Flash Proxy, a second pluggable
transport design. So if the Obfsproxy part stops working for some reason,
you might try the Flash Proxy part. To use it, you'll need to enable
port-forwarding (on port 9000 by default) so your system is reachable
from the outside world:
This step is easy for some people and hard for others (it depends how
much control you have over your Internet connection). That's why the
pluggable transport bundle comes with several options.

@_date: 2013-04-18 08:05:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.12-alpha is out 
Tor 0.2.4.12-alpha moves Tor forward on several fronts: it starts the
process for lengthening the guard rotation period, makes directory
authority opinions in the consensus a bit less gameable, makes socks5
username/password circuit isolation actually work, and fixes a wide
variety of other issues.
Changes in version 0.2.4.12-alpha - 2013-04-18
  o Major features:
    - Raise the default time that a client keeps an entry guard from
      "1-2 months" to "2-3 months", as suggested by Tariq Elahi's WPES
      2012 paper. (We would make it even longer, but we need better client
      load balancing first.) Also, make the guard lifetime controllable
      via a new GuardLifetime torrc option and a GuardLifetime consensus
      parameter. Start of a fix for bug 8240; bugfix on 0.1.1.11-alpha.
    - Directory authorities now prefer using measured bandwidths to
      advertised ones when computing flags and thresholds. Resolves
      ticket 8273.
    - Directory authorities that have more than a threshold number
      of relays with measured bandwidths now treat relays with unmeasured
      bandwidths as having bandwidth 0. Resolves ticket 8435.
  o Major bugfixes (assert / resource use):
    - Avoid a bug where our response to TLS renegotiation under certain
      network conditions could lead to a busy-loop, with 100% CPU
      consumption. Fixes bug 5650; bugfix on 0.2.0.16-alpha.
    - Avoid an assertion when we discover that we'd like to write a cell
      onto a closing connection: just discard the cell. Fixes another
      case of bug 7350; bugfix on 0.2.4.4-alpha.
  o Major bugfixes (client-side privacy):
    - When we mark a circuit as unusable for new circuits, have it
      continue to be unusable for new circuits even if MaxCircuitDirtiness
      is increased too much at the wrong time, or the system clock jumps
      backwards. Fixes bug 6174; bugfix on 0.0.2pre26.
    - If ClientDNSRejectInternalAddresses ("do not believe DNS queries
      which have resolved to internal addresses") is set, apply that
      rule to IPv6 as well. Fixes bug 8475; bugfix on 0.2.0.7-alpha.
    - When an exit relay rejects a stream with reason "exit policy", but
      we only know an exit policy summary (e.g. from the microdesc
      consensus) for it, do not mark the relay as useless for all exiting.
      Instead, mark just the circuit as unsuitable for that particular
      address. Fixes part of bug 7582; bugfix on 0.2.3.2-alpha.
    - Allow applications to get proper stream isolation with
      IsolateSOCKSAuth. Many SOCKS5 clients that want to offer
      username/password authentication also offer "no authentication". Tor
      had previously preferred "no authentication", so the applications
      never actually sent Tor their auth details. Now Tor selects
      username/password authentication if it's offered. You can disable
      this behavior on a per-SOCKSPort basis via PreferSOCKSNoAuth. Fixes
      bug 8117; bugfix on 0.2.3.3-alpha.
  o Major bugfixes (other):
    - When unable to find any working directory nodes to use as a
      directory guard, give up rather than adding the same non-working
      nodes to the directory guard list over and over. Fixes bug 8231;
      bugfix on 0.2.4.8-alpha.
  o Minor features:
    - Reject as invalid most directory objects containing a NUL.
      Belt-and-suspender fix for bug 8037.
    - In our testsuite, create temporary directories with a bit more
      entropy in their name to make name collisions less likely. Fixes
      bug 8638.
    - Add CACHED keyword to ADDRMAP events in the control protocol
      to indicate whether a DNS result will be cached or not. Resolves
      ticket 8596.
    - Update to the April 3 2013 Maxmind GeoLite Country database.
  o Minor features (build):
    - Detect and reject attempts to build Tor with threading support
      when OpenSSL has been compiled without threading support.
      Fixes bug 6673.
    - Clarify that when autoconf is checking for nacl, it is checking
      specifically for nacl with a fast curve25519 implementation.
      Fixes bug 8014.
    - Warn if building on a platform with an unsigned time_t: there
      are too many places where Tor currently assumes that time_t can
      hold negative values. We'd like to fix them all, but probably
      some will remain.
  o Minor bugfixes (build):
    - Fix some bugs in tor-fw-helper-natpmp when trying to build and
      run it on Windows. More bugs likely remain. Patch from Gisle Vanem.
      Fixes bug 7280; bugfix on 0.2.3.1-alpha.
    - Add the old src/or/micro-revision.i filename to CLEANFILES.
      On the off chance that somebody has one, it will go away as soon
      as they run "make clean". Fix for bug 7143; bugfix on 0.2.4.1-alpha.
    - Build Tor correctly on 32-bit platforms where the compiler can build
      but not run code using the "uint128_t" construction. Fixes bug 8587;
      bugfix on 0.2.4.8-alpha.
    - Fix compilation warning with some versions of clang that would
      prefer the -Wswitch-enum compiler flag to warn about switch
      statements with missing enum values, even if those switch
      statements have a "default:" statement. Fixes bug 8598; bugfix
      on 0.2.4.10-alpha.
  o Minor bugfixes (protocol):
    - Fix the handling of a TRUNCATE cell when it arrives while the
      circuit extension is in progress. Fixes bug 7947; bugfix on 0.0.7.1.
    - Fix a misframing issue when reading the version numbers in a
      VERSIONS cell. Previously we would recognize [00 01 00 02] as
      'version 1, version 2, and version 0x100', when it should have
      only included versions 1 and 2. Fixes bug 8059; bugfix on
      0.2.0.10-alpha. Reported pseudonymously.
    - Make the format and order of STREAM events for DNS lookups
      consistent among the various ways to launch DNS lookups. Fixes
      bug 8203; bugfix on 0.2.0.24-rc. Patch by "Desoxy."
    - Correct our check for which versions of Tor support the EXTEND2
      cell. We had been willing to send it to Tor 0.2.4.7-alpha and
      later, when support was really added in version 0.2.4.8-alpha.
      Fixes bug 8464; bugfix on 0.2.4.8-alpha.
  o Minor bugfixes (other):
    - Correctly store microdescriptors and extrainfo descriptors with
      an internal NUL byte. Fixes bug 8037; bugfix on 0.2.0.1-alpha.
      Bug reported by "cypherpunks".
    - Increase the width of the field used to remember a connection's
      link protocol version to two bytes. Harmless for now, since the
      only currently recognized versions are one byte long. Reported
      pseudonymously. Fixes bug 8062; bugfix on 0.2.0.10-alpha.
    - If the state file's path bias counts are invalid (presumably from a
      buggy Tor prior to 0.2.4.10-alpha), make them correct. Also add
      additional checks and log messages to the scaling of Path Bias
      counts, in case there still are remaining issues with scaling.
      Should help resolve bug 8235.
    - Eliminate several instances where we use "Nickname=ID" to refer to
      nodes in logs. Use "Nickname (ID)" instead. (Elsewhere, we still use
      "$ID=Nickname", which is also acceptable.) Fixes bug 7065. Bugfix
      on 0.2.3.21-rc, 0.2.4.5-alpha, 0.2.4.8-alpha, and 0.2.4.10-alpha.
  o Minor bugfixes (syscalls):
    - Always check the return values of functions fcntl() and
      setsockopt(). We don't believe these are ever actually failing in
      practice, but better safe than sorry. Also, checking these return
      values should please analysis tools like Coverity. Patch from
      'flupzor'. Fixes bug 8206; bugfix on all versions of Tor.
    - Use direct writes rather than stdio when building microdescriptor
      caches, in an attempt to mitigate bug 8031, or at least make it
      less common.
  o Minor bugfixes (config):
    - When rejecting a configuration because we were unable to parse a
      quoted string, log an actual error message. Fixes bug 7950; bugfix
      on 0.2.0.16-alpha.
    - Behave correctly when the user disables LearnCircuitBuildTimeout
      but doesn't tell us what they would like the timeout to be. Fixes
      bug 6304; bugfix on 0.2.2.14-alpha.
    - When autodetecting the number of CPUs, use the number of available
      CPUs in preference to the number of configured CPUs. Inform the
      user if this reduces the number of available CPUs. Fixes bug 8002;
      bugfix on 0.2.3.1-alpha.
    - Make it an error when you set EntryNodes but disable UseGuardNodes,
      since it will (surprisingly to some users) ignore EntryNodes. Fixes
      bug 8180; bugfix on 0.2.3.11-alpha.
    - Allow TestingTorNetworks to override the 4096-byte minimum for
      the Fast threshold. Otherwise they can't bootstrap until they've
      observed more traffic. Fixes bug 8508; bugfix on 0.2.4.10-alpha.
    - Fix some logic errors when the user manually overrides the
      PathsNeededToBuildCircuits option in torrc. Fixes bug 8599; bugfix
      on 0.2.4.10-alpha.
  o Minor bugfixes (log messages to help diagnose bugs):
    - If we fail to free a microdescriptor because of bug 7164, log
      the filename and line number from which we tried to free it.
    - Add another diagnostic to the heartbeat message: track and log
      overhead that TLS is adding to the data we write. If this is
      high, we are sending too little data to SSL_write at a time.
      Diagnostic for bug 7707.
    - Add more detail to a log message about relaxed timeouts, to help
      track bug 7799.
    - Warn more aggressively when flushing microdescriptors to a
      microdescriptor cache fails, in an attempt to mitigate bug 8031,
      or at least make it more diagnosable.
    - Improve debugging output to help track down bug 8185 ("Bug:
      outgoing relay cell has n_chan==NULL. Dropping.")
    - Log the purpose of a path-bias testing circuit correctly.
      Improves a log message from bug 8477; bugfix on 0.2.4.8-alpha.
  o Minor bugfixes (0.2.4.x log messages that were too noisy):
    - Don't attempt to relax the timeout of already opened 1-hop circuits.
      They might never timeout. This should eliminate some/all cases of
      the relaxed timeout log message.
    - Use circuit creation time for network liveness evaluation. This
      should eliminate warning log messages about liveness caused
      by changes in timeout evaluation. Fixes bug 6572; bugfix on
      0.2.4.8-alpha.
    - Reduce a path bias length check from notice to info. The message
      is triggered when creating controller circuits. Fixes bug 8196;
      bugfix on 0.2.4.8-alpha.
    - Fix a path state issue that triggered a notice during relay startup.
      Fixes bug 8320; bugfix on 0.2.4.10-alpha.
    - Reduce occurrences of warns about circuit purpose in
      connection_ap_expire_building(). Fixes bug 8477; bugfix on
      0.2.4.11-alpha.
  o Minor bugfixes (pre-0.2.4.x log messages that were too noisy):
    - If we encounter a write failure on a SOCKS connection before we
      finish our SOCKS handshake, don't warn that we closed the
      connection before we could send a SOCKS reply. Fixes bug 8427;
      bugfix on 0.1.0.1-rc.
    - Correctly recognize that [::1] is a loopback address. Fixes
      bug 8377; bugfix on 0.2.1.3-alpha.
    - Fix a directory authority warn caused when we have a large amount
      of badexit bandwidth. Fixes bug 8419; bugfix on 0.2.2.10-alpha.
    - Don't log inappropriate heartbeat messages when hibernating: a
      hibernating node is _expected_ to drop out of the consensus,
      decide it isn't bootstrapped, and so forth. Fixes bug 7302;
      bugfix on 0.2.3.1-alpha.
    - Don't complain about bootstrapping problems while hibernating.
      These complaints reflect a general code problem, but not one
      with any problematic effects (no connections are actually
      opened). Fixes part of bug 7302; bugfix on 0.2.3.2-alpha.
  o Documentation fixes:
    - Update tor-fw-helper.1.txt and tor-fw-helper.c to make option
      names match. Fixes bug 7768.
    - Make the torify manpage no longer refer to tsocks; torify hasn't
      supported tsocks since 0.2.3.14-alpha.
    - Make the tor manpage no longer reference tsocks.
    - Fix the GeoIPExcludeUnknown documentation to refer to
      ExcludeExitNodes rather than the currently nonexistent
      ExcludeEntryNodes. Spotted by "hamahangi" on tor-talk.
  o Removed files:
    - The tor-tsocks.conf is no longer distributed or installed. We
      recommend that tsocks users use torsocks instead. Resolves
      ticket 8290.

@_date: 2013-04-22 10:27:46
@_author: Roger Dingledine 
@_subject: [tor-talk] NPA to urge Internet providers to block users of 
It seems they are blurring the line between recommending that websites
refuse to answer connections from the Tor network, vs recommending that
ISPs prevent their users from reaching the Tor network.
I wonder if that blur is intentional, or if somebody in the reporting
chain is confused, or what.

@_date: 2013-04-29 15:06:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor's reputation problem with pedo, 
Hi Chris,
I agree with you. Part of what we have done a poor job communicating
is that hidden services are a tiny fraction of overall Tor use. The
wikipedia article on Tor is mostly written by hidden service enthusiasts
(as far as I can tell), which further misleads people.
That's just the thing. This phrase "the community" assumes there's just
one community. Most Tor users just use Tor to get around surveillance
or censorship, to reach normal web sites. They wouldn't know what you
mean by the community.
I guess that leads to a very clear item that people can help with: we
need somebody to take charge of the Tor wikipedia page and make it more
accurate / useful.
That said, there are actually some very good uses of hidden services
happening right now. But they try not to be high profile (that's partly
the point, right?)

@_date: 2013-04-29 15:15:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor's reputation problem with pedo, 
The problem, as explained to me by several Dutch policemen, is that
taking down a few individual sites doesn't actually work. That is,
it doesn't reduce the number of criminals (or crimes) in the world.
These are social problems, and as such aren't really amenable to technical
solutions -- you quickly get to the "well, then let's ban cameras" step.
And at that point it doesn't make much sense to have a thread about it on
tor-talk either.

@_date: 2013-04-29 16:03:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor's reputation problem with pedo, 
Please do!
That said, you're already falling into a trap when you say "all the
directories". I know the person who ran "the hidden wiki" -- he shut
it down in 2003. Now there are a pile of hidden service websites, all
claiming to be "the directory". There's clearly a need for this role,
but there is no official center or starting point. This is both good
and bad, as you can imagine.
You should be aware that OnionBrowser isn't made by any Tor people.
I think that's the name for the closed-source package for various Apple
platforms, yes? (I hear it has some Tor components inside, but who knows.)

@_date: 2013-08-05 02:04:00
@_author: Roger Dingledine 
@_subject: [tor-talk] HS drop 
How are you estimating 'total' here?
(The way I'd do it is by running a bunch of relays with the HSDir flag,
and approximating the total number of descriptor publishes based on the
number that go to my relays. That approach would harm network diversity

@_date: 2013-08-05 11:13:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor security advisory: Old Tor Browser Bundles vulnerable 
This is a critical security announcement.
  An attack that exploits a Firefox vulnerability in JavaScript [1]
  has been observed in the wild. Specifically, Windows users using the
  Tor Browser Bundle (which includes Firefox plus privacy patches [2])
  appear to have been targeted.
  This vulnerability was fixed in Firefox 17.0.7 ESR [3]. The following
  versions of the Tor Browser Bundle include this fixed version:
    2.3.25-10 (released June 26 2013) [4]
    2.4.15-alpha-1 (released June 26 2013) [4]
    2.4.15-beta-1 (released July 8 2013) [5]
    3.0alpha2 (released June 30 2013) [6]
  Tor Browser Bundle users should ensure they're running a recent enough
  bundle version, and consider taking further security precautions as
  described below.
WHO IS AFFECTED:
  In principle, all users of all Tor Browser Bundles earlier than
  the above versions are vulnerable. But in practice, it appears that
  only Windows users with vulnerable Firefox versions were actually
  exploitable by this attack.
  (If you're not sure what version you have, click on "Help -> About
  Torbrowser" and make sure it says Firefox 17.0.7. Here's a video: [7])
  To be clear, while the Firefox vulnerability is cross-platform, the
  attack code is Windows-specific. It appears that TBB users on Linux
  and OS X, as well as users of LiveCD systems like Tails, were not
  exploited by this attack.
  The vulnerability allows arbitrary code execution, so an attacker
  could in principle take over the victim's computer. However, the
  observed version of the attack appears to collect the hostname and MAC
  address of the victim computer, send that to a remote webserver over
  a non-Tor connection, and then crash or exit [8]. The attack appears
  to have been injected into (or by) various Tor hidden services [9],
  and it's reasonable to conclude that the attacker now has a list of
  vulnerable Tor users who visited those hidden services.
  We don't currently believe that the attack modifies anything on the
  victim computer.
WHAT TO DO:
  First, be sure you're running a recent enough Tor Browser Bundle. That
  should keep you safe from this attack.
  Second, be sure to keep up-to-date in the future. Tor Browser Bundle
  automatically checks whether it's out of date, and notifies you on its
  homepage when you need to upgrade. Recent versions also add a flashing
  exclamation point over the Tor onion icon. We also post about new
  versions on the Tor blog:   Third, realize that this wasn't the first Firefox vulnerability, nor
  will it be the last [10]. Consider disabling JavaScript (click the blue
  "S" beside the green onion, and select "Forbid Scripts Globally").
  Disabling JavaScript will reduce your vulnerability to other attacks
  like this one, but disabling JavaScript will make some websites not work
  like you expect. A future version of Tor Browser Bundle will have an
  easier interface for letting you configure your JavaScript settings [11].
  You might also like Request Policy [12]. And you might want to randomize
  your MAC address, install various firewalls, etc.
  Fourth, consider switching to a "live system" approach like Tails [13].
  Really, switching away from Windows is probably a good security move
  for many reasons.
  And finally, be aware that many other vectors remain for vulnerabilities
  in Firefox. JavaScript is one big vector for attack, but many other
  big vectors exist, like css, svg, xml, the renderer, etc. We need
  help improving usability of (and doing more security analysis of)
  better sandboxing approaches [14] as well as VM-based approaches like
  Whonix [15] and WiNoN [16]. Please help!
[1] [2] [3] [4] [5] [6] [7] [8] [9] [10] [11] [12] [13] [14] [15] [16]

@_date: 2013-08-07 03:46:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Javascript vs privacy? 
(I'm more optimistic about the second one, in terms of having a useful
impact long-term.)

@_date: 2013-08-07 10:15:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Verifying Tor packages. 
Yep. There's a bug report here:
I'll notice that Mike is doing it a better way for his TBB 3.x
links to
which has a single file
that's signed by all the people who can reproduce the builds.
Hopefully we can make that approach scale.

@_date: 2013-08-08 20:17:07
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Check Problem? 
Check could really use some love. Any volunteers please?

@_date: 2013-08-09 12:10:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Secure email with limited usable metadata 
While I don't really have an opinion on whether this service should stay
dormant, I do hope they leave the TorMail name behind. Too many users got
confused about whether it was an official Tor service (it wasn't). And I
can't help but conclude that this confusion was intentional and welcome
on the part of the service operators -- which I confess makes me have
little sympathy for them disappearing.

@_date: 2013-08-10 14:42:49
@_author: Roger Dingledine 
@_subject: [tor-talk] So what about Pirate Browser? 
Well, at least they didn't try to shmush the word Tor into the name.
More power to them, I say.
Though I would also recommend that they get in touch with Mike, Erinn,
and others about the Tor Browser Bundle, so they can be aware of upcoming
development plans (for example: I bet their Pirate Browser would be
even better if it were based on thew new Tor Browser Bundle 3.0 series,
once it's stable enough).
That said, why only Windows? They won't get as much help from developers
if they have only a Windows version.
(Also, they say Iran, but I suspect their current bundle won't work in
Iran since vanilla Tor (without Obfsproxy) is blocked there. But then,
it's probably just a publicity stunt to start their country list with
Iran and North Korea.)
Randolph, please stop calling your thing "torbrowser". I hope no users
are stupid enough to think they should get their Tor Browser Bundle from
you, but your choice of name makes it clear that you're not trying to
be a member of the Tor community.

@_date: 2013-08-10 14:54:57
@_author: Roger Dingledine 
@_subject: [tor-talk] So what about Pirate Browser? 
Jake and I tried to emphasize the "censorship implies surveillance"
meme in our 28c3 talk.
Right. I expect they're going to have a real challenge teaching
their users about what they're getting and what they're not getting. I
appreciate the experiment and want to see how it goes -- but that said,
we should keep an eye out for sentences that start with "And since you're
using Tor", since a downside for the Tor world could be that they start
mis-educating other Tor users.
As an aside, we already experience this mis-education in the context
of for-profit VPN companies, where they compete to see who can write
"100% guaranteed bulletproof encryption" in the blinkiest font on their
websites, whereas Tor instead works to explain that some parts of the
protocol provide encryption and others don't:
I assume they just assume that Tor magically gets around all censorship,
and haven't explored any further than that. Happy to be shown wrong.

@_date: 2013-08-10 19:48:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.16-rc is out 
Tor 0.2.4.16-rc is the second release candidate for the Tor 0.2.4.x
series. It fixes several crash bugs in the 0.2.4 branch.
Changes in version 0.2.4.16-rc - 2013-08-10
  o Major bugfixes:
    - Fix a bug in the voting algorithm that could yield incorrect results
      when a non-naming authority declared too many flags. Fixes bug 9200;
      bugfix on 0.2.0.3-alpha.
    - Fix an uninitialized read that could in some cases lead to a remote
      crash while parsing INTRODUCE 1 cells. Bugfix on 0.2.4.1-alpha.
      Anybody running a hidden service on the experimental 0.2.4.x
      branch should upgrade. (This is, so far as we know, unrelated to
      the recent news.)
    - Avoid an assertion failure when processing DNS replies without the
      answer types we expected. Fixes bug 9337; bugfix on 0.2.4.7-alpha.
    - Avoid a crash when using --hash-password. Fixes bug 9295; bugfix on
      0.2.4.15-rc. Found by stem integration tests.
  o Minor bugfixes:
    - Fix an invalid memory read that occured when a pluggable
      transport proxy failed its configuration protocol.
      Fixes bug 9288; bugfix on 0.2.4.1-alpha.
    - When evaluating whether to use a connection that we haven't
      decided is canonical using a recent link protocol version,
      decide that it's canonical only if it used address _does_
      match the desired address. Fixes bug 9309; bugfix on
      0.2.4.4-alpha. Reported by skruffy.
    - Make the default behavior of NumDirectoryGuards be to track
      NumEntryGuards. Now a user who changes only NumEntryGuards will get
      the behavior she expects. Fixes bug 9354; bugfix on 0.2.4.8-alpha.
    - Fix a spurious compilation warning with some older versions of
      GCC on FreeBSD. Fixes bug 9254; bugfix on 0.2.4.14-alpha.
  o Minor features:
    - Update to the July 3 2013 Maxmind GeoLite Country database.

@_date: 2013-08-12 12:16:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Updated "Why JavaScript is enabled" FAQ entry 
Hi folks,
I rewrote our two FAQ entries on JavaScript-in-TBB, and merged them
into one:
Did I leave out any important points, or are there ways to make the
issues clearer?
(Please don't turn this into a "you should change the default you
idiots" thread, but please do point out if I've made one of the points
inadequately. Hopefully that's a distinction that will work here.)

@_date: 2013-08-14 11:59:19
@_author: Roger Dingledine 
@_subject: [tor-talk] obfsproxy failure: obfs3 
Right. Debian's openssl doesn't build with that option. Search the web for
"debian enable-ec_nistp_64_gcc_128" and you'll find some tickets about
it -- the short version is that both Debian and Ubuntu are waiting for
openssl to turn it on by default.

@_date: 2013-08-15 00:19:42
@_author: Roger Dingledine 
@_subject: [tor-talk] obfsproxy failure: obfs3 
Well, that's because it's unreachable. (I just tried.)
Can you try following the suggestion in the log message?

@_date: 2013-08-22 19:45:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Can I use a non-Tor exit node? 
Yep, that's a totally fine and legitimate solution, if it works for you.
The only caution I'd add is if the destination website is using https,
then the web proxy will typically initiate the https connection on
your behalf, thus getting to see all your traffic (no end-to-end
confidentiality) and also preventing your browser from verifying that
it's really the site (no end-to-end authentication).
(https is already confusing to users, and the world of web proxies sure
doesn't make it easier.)

@_date: 2013-08-23 16:33:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Run the shell script 
Unfortunately, some variants of Ubuntu have a new perspective on
whether to let users click-click on shell scripts. I think it might
be Unity-related?
See also but alas that ticket doesn't really have a clear explanation of the issue,
nor a clear best solution.

@_date: 2013-08-25 19:58:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Isn't it time to ADMIT that Tor is cracked by now?? 
Reminds me of my response when in 2011 some Dutch police broke into
a hidden service:
"If you have an instant messaging conversation with a Tor user and
convince her to tell you her address, did you break Tor? Having an
http conversation with a webserver running over a Tor hidden service,
and convincing it to tell you its address, is not much different."
We don't know in this case if they did it through exploiting the software
running on the other end of the hidden service, or by the old "follow
the money" trick, or by having an insider provide the info, or what.
It could in fact have been by attacking the Tor protocol directly (see
below). But I think in many cases, even with the various known weaknesses,
the above "just bypass Tor and attack them in other ways" approaches
are even easier. (This observation should scare you more, not less.)
The fact that somebody started serving malware on the various hidden
makes me think that they got in via the software running the webserver.
I mean, heck, I heard he let strangers run php scripts in his webserver.
For another case of a hidden service being compromised, see
The summary sentence there is "Way before they switched to a Tor hidden
service, the two main people used Hushmail to communicate."
This part is unfortunately (well, ok maybe fortunately, but either
way) false. Hidden services are weaker than normal Tor circuits for two
reasons: a) they stay in the same place over time, and b) you, the user,
can choose how often they make circuits. These two properties combine
to produce a variety of other problems. I described some of them briefly
in the 29c3 talk this past December, but see
 for
many more details, including references to academic papers on the topic.

@_date: 2013-08-26 19:08:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Inquiry about Vidalia/Tor bundle 
Not quite -- it is a bundle that includes a variety of software
including Firefox, Vidalia, and Tor, configured in the way they wanted
to configure it.
Specifically, don't be confused into thinking this is a Tor product,
or that it will keep you safe in some particular way.
In fact, they even have a disclaimer saying that it's not an anonymity
tool. And in this case that's not just a disclaimer, it's an accurate
decompiling it to find out what it is really), it includes Foxyproxy,
configured to only go through Tor for a select set of sites that are
commonly censored. The rest of the sites bypass Tor.
Again, please remember this is somebody else's program, called Pirate
Browser, and not anything made by Tor. Though it does include tools
written by Tor, but tools-written-by-Tor only perform the way Tor had
in mind if you configure them that way.
That sounds compatible with my Foxyproxy theory above.
Hope that helps,

@_date: 2013-08-27 03:08:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Many more Tor users in the past week? 
Hi folks,
Check out
(for posterity, the longer-term link will be
 )
The number of Tor clients running appears to have doubled since August 19:
And it's not just a fluke in the metrics data -- it appears that
there really are twice as many Tor clients running as before:
There's a slight increase (worsening) in the performance measurements:
but it's hard to say if that's a real difference. So while there are a
bunch of new Tor clients running, it would seem they're not doing much.
Anybody know details? It's easy to speculate (Pirate Browser publicity
gone overboard? People finally reading about the NSA thing? Botnet?),
but some good solid facts would sure be useful.

@_date: 2013-08-28 16:01:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Default clients to be non-exit relay LibTech x 
Done naively, this is a poor idea: if you fetch only a subset of
relays, and the adversary can learn or guess which subset you have,
then partitioning attacks can significantly degrade your anonymity. For
example, a middle relay sees the first and third relays, and then asks
itself which users have those three relays in their subset.
See  plus the papers it
cites for details.
There are two plausible approaches to fetching a subset of the network
when it gets too big for every client to fetch all of it:
A) Use a DHT-like design to anonymize which relays you're learning about.
For background there, see
and this line of papers sort of ran out of steam without producing a
crisp simple non-flawed design.
B) Fetch your subset anonymously through PIR:
I'm inclined to prefer 'B', because it seems simpler, but maybe that's
only because nobody has fleshed out the actual engineering part of how
we'd deploy it.
You might like proposal 175:
Now all we need is somebody to do it.
Also, be sure to read
In particular point 3 (more relays equals more sockets used on each relay)
and point 4 (there are anonymity attacks that get much easier when the
list of users is known). Especially point 4.

@_date: 2013-08-28 16:02:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Default clients to be non-exit relay LibTech x 
Take a look at
"The Path Less Travelled: Overcoming Tor's Bottlenecks with Traffic Splitting"

@_date: 2013-08-30 00:37:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Many more Tor users in the past week? 
Thanks for the visualizations Collin.
Heck of a confluence. And as Runa points out, it includes great gains
in countries where that makes little sense.
I think the most plausible explanation is that a Tor client got bundled
in something and a lot of users upgraded. What that something is is
anybody's guess.
But I am compelled to point out that your table has one data point that
will keep the bellies of conspiracy theorists full for months: the only --
only! -- country that didn't gain was Israel.

@_date: 2013-08-31 00:25:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Contents of PirateBrowser 0.6b 
Just for the record, the three lines here don't help speed much (or
maybe at all).
This first line says it's ok to use relays that allow you to make one-hop
circuits. Roughly speaking, there aren't any relays like that in the
network (it's not the default). And even if there were, it wouldn't make
the circuits your client builds any speedier (except I guess through
a second-order effect where you're willing to use relays that all the
other clients are unwilling to use).
This makes you willing to use more than one relay on a given /16 subnet
in your circuits. So if there are two relays on a single computer, you
might use one as your entry and one as your exit. This could help your
performance, but it sure does reduce your anonymity. (Also, it makes
Pirate Browser distinguishable from normal Tor clients in a really
interesting way -- for example, middle nodes can sometimes distinguish
This disables a protection that prevents Tor controllers from manually
selecting relays that allow single-hop circuits. Assuming they didn't
also change the controller to do such a thing -- and remember also that
there are roughly no such relays anyway -- it doesn't help speed any
that they disabled it.
This line probably has the biggest impact on performance. Whether it
improves or reduces performance I cannot say, though. Depends on a lot
of complex variables around Internet topologies.

@_date: 2013-08-31 16:42:45
@_author: Roger Dingledine 
@_subject: [tor-talk] Contents of PirateBrowser 0.6b 
To be clear: you will still use 3-hop circuits when you set
ExcludeSingleHopRelays to 0.

@_date: 2013-12-03 19:45:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, November 2013 
Six things I did in November 2013:
1) Wrote a 2014 budget. Several of our current contracts ended in 2013,
so unless we can replace them we're going to be shifting back into the
more familiar "some funded people and many volunteers" model from a few
years back.
I updated the sponsors page to be more accurate into the future:
We've also been pondering lately how to do a fundraising or donations
drive, to help move us off our reliance on government funders. What
we're missing most actually is support for maintenance and development
of the program called "tor", since it's the core of so many components
but funders always prefer to support shiny new things.
2) Attended WPES / CCS:
which provided 11 new Tor-related papers on anonbib, starting at
I had a lot of good conversations about website fingerprinting,
correlation attacks, performance improvements, traffic transformations
for DPI-resistance, and other research topics that people are working on.
3) Attended the PI meeting for SponsorF. Here are the slides I used to
update them on the past six months of our work there:
4) Released 0.2.4.18-rc:
5) Helped more journalists understand Tor, e.g.
Also encouraged folks to start gathering press articles:
I'd love some help sorting through the new articles, and moving the best
ones onto the Tor press page:
6) Attended an FBI meeting, as part of my work to try to keep Tor on
good relations with US law enforcement. See
for an earlier example and
for the broader topic.
I talked to a DEA person who repeated the "we busted the silk road guy
using good old-fashioned police work" line. I guess that doesn't resolve
any conspiracy theories if you already believe the conspiracy theories.
I also talked to a lawyer from the Department of Justice who had been
involved in the Freedom Hosting case. It's increasingly clear that I
should go do another talk for DoJ to help reinforce what Tor is and why
its existence benefits the world.
I brought up the phrase "parallel construction" over and over in my
discussions with FBI people. They were adamant that they don't get
tips from NSA's illegal surveillance program (which led to statements
from me like "Ok, so how much am I oversimplifying by concluding that
either you're lying to me, or they're lying to you?") I need to get
a better understanding of how their cases work, since there seems to
be an extremely subtle distinction in their minds between "we got an
anonymous tip, so we set about getting evidence that is admissible in
court" (apparently standard practice) and "we got a tip from a source
that some people say uses methods that violate the constitution, so
we set about getting evidence that is admissible in court" (which many
Americans are rightly upset about).

@_date: 2013-12-04 23:17:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Any risks with another application using Tor's SOCKS 
These are good questions for the Tor Browser Team (Mike Perry, Georg
Koppen, and the Pearl Crescent folks). Mike and Georg are probably easiest
to find on irc (we're alas all overloaded these days with people trying
to contact us).
Don't be confused into thinking that private browsing mode provides
protections against a network adversary (e.g. ISP, website, or ad
network). It has primarily to do with local storage.
You might also like Mike's paper, "Do Not Beg: Moving Beyond DNT through
Privacy by Design"
Yep. Can't argue with that.
(The Gettor service is alas in need of some more love lately. Various
folks added a bunch of new features recently and then stopped working
on it right before everything became smooth.)
I actually look at it in the opposite way: in the single-hop proxy case
(aka the VPN case) the proxy gets to learn both you and what you're
doing. In the distributed-trust case, even when you're not using
end-to-end encryption, the exit relay gets to know what *somebody* is
doing but doesn't necessarily get to learn who is doing it (or where in
the world the somebody is today).
So the model is that somebody uses their browser to reach a cgiproxy
that's run somewhere else, and the cgiproxy runs its own Tor client
and passes its requests into Tor?
I think you want to be really careful about describing the security
properties you're aiming for there -- it isn't useless, but I worry that
it's easy for users to think they're getting "Tor" when actually they're
getting a single-hop proxy that can spy on them (plus also Tor).

@_date: 2013-12-08 13:37:20
@_author: Roger Dingledine 
@_subject: [tor-talk] Shutting down the relay-search service by the end of 
As usual, I think I'm the one using more of the metrics services than
For the most recent case where I found it useful, see
How sad. I guess if it has to go, it should go. But I do use it. :)
Changing the links sounds like a fine plan to me.

@_date: 2013-12-12 00:47:48
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.19 is released 
The Tor 0.2.4 release series is dedicated to the memory of Aaron Swartz
(1986-2013). Aaron worked on diverse projects including helping to guide
Creative Commons, playing a key role in stopping SOPA/PIPA, bringing
transparency to the U.S. government's PACER documents, and contributing
design and development for Tor and Tor2Web. Aaron was one of the latest
martyrs in our collective fight for civil liberties and human rights,
and his death is all the more painful because he was one of us.
Tor 0.2.4.19, the first stable release in the 0.2.4 branch, features
a new circuit handshake and link encryption that use ECC to provide
better security and efficiency; makes relays better manage circuit
creation requests; uses "directory guards" to reduce client enumeration
risks; makes bridges collect and report statistics about the pluggable
transports they support; cleans up and improves our geoip database;
gets much closer to IPv6 support for clients, bridges, and relays; makes
directory authorities use measured bandwidths rather than advertised
ones when computing flags and thresholds; disables client-side DNS
caching to reduce tracking risks; and fixes a big bug in bridge
reachability testing. This release introduces two new design
abstractions in the code: a new "channel" abstraction between circuits
and or_connections to allow for implementing alternate relay-to-relay
transports, and a new "circuitmux" abstraction storing the queue of
circuits for a channel. The release also includes many stability,
security, and privacy fixes.
Packages coming soon, at which point I'll announce this new stable tree
on the tor-announce list too. (Tor 0.2.4.19 has no real changes since
0.2.4.18-rc if you want to get a head start.)
Changes in version 0.2.4.19 - 2013-12-11
  o Major features (new circuit handshake):
    - Tor now supports a new circuit extension handshake designed by Ian
      Goldberg, Douglas Stebila, and Berkant Ustaoglu. Our original
      circuit extension handshake, later called "TAP", was a bit slow
      (especially on the relay side), had a fragile security proof, and
      used weaker keys than we'd now prefer. The new circuit handshake
      uses Dan Bernstein's "curve25519" elliptic-curve Diffie-Hellman
      function, making it significantly more secure than the older
      handshake, and significantly faster. Tor can use one of two built-in
      pure-C curve25519-donna implementations by Adam Langley, or it
      can link against the "nacl" library for a tuned version if present.
      The built-in version is very fast for 64-bit systems when building
      with GCC. The built-in 32-bit version is still faster than the
      old TAP protocol, but using libnacl is better on most such hosts.
      Implements proposal 216; closes ticket 7202.
  o Major features (better link encryption):
    - Relays can now enable the ECDHE TLS ciphersuites when available
      and appropriate. These ciphersuites let us negotiate forward-secure
      TLS secret keys more safely and more efficiently than with our
      previous use of Diffie-Hellman modulo a 1024-bit prime. By default,
      public relays prefer the (faster) P224 group, and bridges prefer
      the (more common) P256 group; you can override this with the
      TLSECGroup option.
      This feature requires clients running 0.2.3.17-beta or later,
      and requires both sides to be running OpenSSL 1.0.0 or later
      with ECC support. OpenSSL 1.0.1, with the compile-time option
      "enable-ec_nistp_64_gcc_128", is highly recommended.
      Implements the relay side of proposal 198; closes ticket 7200.
    - Re-enable TLS 1.1 and 1.2 when built with OpenSSL 1.0.1e or later.
      Resolves ticket 6055. (OpenSSL before 1.0.1 didn't have TLS 1.1 or
      1.2, and OpenSSL from 1.0.1 through 1.0.1d had bugs that prevented
      renegotiation from working with TLS 1.1 or 1.2, so we had disabled
      them to solve bug 6033.)
  o Major features (relay performance):
    - Instead of limiting the number of queued onionskins (aka circuit
      create requests) to a fixed, hard-to-configure number, we limit
      the size of the queue based on how many we expect to be able to
      process in a given amount of time. We estimate the time it will
      take to process an onionskin based on average processing time
      of previous onionskins. Closes ticket 7291. You'll never have to
      configure MaxOnionsPending again.
    - Relays process the new "NTor" circuit-level handshake requests
      with higher priority than the old "TAP" circuit-level handshake
      requests. We still process some TAP requests to not totally starve
      0.2.3 clients when NTor becomes popular. A new consensus parameter
      "NumNTorsPerTAP" lets us tune the balance later if we need to.
      Implements ticket 9574.
  o Major features (client bootstrapping resilience):
    - Add a new "FallbackDir" torrc option to use when we can't use
      a directory mirror from the consensus (either because we lack a
      consensus, or because they're all down). Currently, all authorities
      are fallbacks by default, and there are no other default fallbacks,
      but that will change. This option will allow us to give clients a
      longer list of servers to try to get a consensus from when first
      connecting to the Tor network, and thereby reduce load on the
      directory authorities. Implements proposal 206, "Preconfigured
      directory sources for bootstrapping". We also removed the old
      "FallbackNetworkstatus" option, since we never got it working well
      enough to use it. Closes bug 572.
    - If we have no circuits open, use a relaxed timeout (the
      95th-percentile cutoff) until a circuit succeeds. This heuristic
      should allow Tor to succeed at building circuits even when the
      network connection drastically changes. Should help with bug 3443.
  o Major features (use of guards):
    - Support directory guards (proposal 207): when possible, clients now
      use their entry guards for non-anonymous directory requests. This
      can help prevent client enumeration. Note that this behavior only
      works when we have a usable consensus directory, and when options
      about what to download are more or less standard. In the future we
      should re-bootstrap from our guards, rather than re-bootstrapping
      from the preconfigured list of directory sources that ships with
      Tor. Resolves ticket 6526.
    - Raise the default time that a client keeps an entry guard from
      "1-2 months" to "2-3 months", as suggested by Tariq Elahi's WPES
      2012 paper. (We would make it even longer, but we need better client
      load balancing first.) Also, make the guard lifetime controllable
      via a new GuardLifetime torrc option and a GuardLifetime consensus
      parameter. Start of a fix for bug 8240; bugfix on 0.1.1.11-alpha.
  o Major features (bridges with pluggable transports):
    - Bridges now report the pluggable transports they support to the
      bridge authority, so it can pass the supported transports on to
      bridgedb and/or eventually do reachability testing. Implements
      ticket 3589.
    - Automatically forward the TCP ports of pluggable transport
      proxies using tor-fw-helper if PortForwarding is enabled. Implements
      ticket 4567.
  o Major features (geoip database):
    - Maxmind began labelling Tor relays as being in country "A1",
      which breaks by-country node selection inside Tor. Now we use a
      script to replace "A1" ("Anonymous Proxy") entries in our geoip
      file with real country codes. This script fixes about 90% of "A1"
      entries automatically and uses manual country code assignments to
      fix the remaining 10%. See src/config/README.geoip for details.
      Fixes bug 6266.
    - Add GeoIP database for IPv6 addresses. The new config option
      is GeoIPv6File.
    - Update to the October 2 2013 Maxmind GeoLite Country database.
  o Major features (IPv6):
    - Clients who set "ClientUseIPv6 1" may connect to entry nodes over
      IPv6. Set "ClientPreferIPv6ORPort 1" to make this even more likely
      to happen. Implements ticket 5535.
    - All kind of relays, not just bridges, can now advertise an IPv6
      OR port. Implements ticket 6362.
    - Relays can now exit to IPv6 addresses: make sure that you have IPv6
      connectivity, then set the IPv6Exit flag to 1. Also make sure your
      exit policy reads as you would like: the address * applies to all
      address families, whereas *4 is IPv4 address only, and *6 is IPv6
      addresses only. On the client side, you'll need to wait for enough
      exits to support IPv6, apply the "IPv6Traffic" flag to a SocksPort,
      and use Socks5. Closes ticket 5547, implements proposal 117 as
      revised in proposal 208.
    - Bridge authorities now accept IPv6 bridge addresses and include
      them in network status documents. Implements ticket 5534.
    - Directory authorities vote on IPv6 OR ports. Implements ticket 6363.
  o Major features (directory authorities):
    - Directory authorities now prefer using measured bandwidths to
      advertised ones when computing flags and thresholds. Resolves
      ticket 8273.
    - Directory authorities that vote measured bandwidths about more
      than a threshold number of relays now treat relays with
      unmeasured bandwidths as having bandwidth 0 when computing their
      flags. Resolves ticket 8435.
    - Directory authorities now support a new consensus method (17)
      where they cap the published bandwidth of relays for which
      insufficient bandwidth measurements exist. Fixes part of bug 2286.
    - Directory authorities that set "DisableV2DirectoryInfo_ 1" no longer
      serve any v2 directory information. Now we can test disabling the
      old deprecated v2 directory format, and see whether doing so has
      any effect on network load. Begins to fix bug 6783.
  o Major features (build and portability):
    - Switch to a nonrecursive Makefile structure. Now instead of each
      Makefile.am invoking other Makefile.am's, there is a master
      Makefile.am that includes the others. This change makes our build
      process slightly more maintainable, and improves parallelism for
      building with make -j. Original patch by Stewart Smith; various
      fixes by Jim Meyering.
    - Where available, we now use automake's "silent" make rules by
      default, so that warnings are easier to spot. You can get the old
      behavior with "make V=1". Patch by Stewart Smith for ticket 6522.
    - Resume building correctly with MSVC and Makefile.nmake. This patch
      resolves numerous bugs and fixes reported by ultramage, including
      7305, 7308, 7309, 7310, 7312, 7313, 7315, 7316, and 7669.
  o Security features:
    - Switch to a completely time-invariant approach for picking nodes
      weighted by bandwidth. Our old approach would run through the
      part of the loop after it had made its choice slightly slower
      than it ran through the part of the loop before it had made its
      choice. Addresses ticket 6538.
    - Disable the use of Guard nodes when in Tor2WebMode. Guard usage
      by tor2web clients allows hidden services to identify tor2web
      clients through their repeated selection of the same rendezvous
      and introduction point circuit endpoints (their guards). Resolves
      ticket 6888.
  o Major bugfixes (relay denial of service):
    - When we have too much memory queued in circuits (according to a new
      MaxMemInCellQueues option), close the circuits that have the oldest
      queued cells, on the theory that those are most responsible for
      us running low on memory. This prevents us from running out of
      memory as a relay if circuits fill up faster than they can be
      drained. Fixes bugs 9063 and 9093; bugfix on the 54th commit of
      Tor. This bug is a further fix beyond bug 6252, whose fix was
      merged into 0.2.3.21-rc.
    - Reject bogus create and relay cells with 0 circuit ID or 0 stream
      ID: these could be used to create unexpected streams and circuits
      which would count as "present" to some parts of Tor but "absent"
      to others, leading to zombie circuits and streams or to a bandwidth
      denial-of-service. Fixes bug 7889; bugfix on every released version
      of Tor. Reported by "oftc_must_be_destroyed".
    - Avoid a bug where our response to TLS renegotiation under certain
      network conditions could lead to a busy-loop, with 100% CPU
      consumption. Fixes bug 5650; bugfix on 0.2.0.16-alpha.
  o Major bugfixes (asserts, crashes, leaks):
    - Prevent the get_freelists() function from running off the end of
      the list of freelists if it somehow gets an unrecognized
      allocation. Fixes bug 8844; bugfix on 0.2.0.16-alpha. Reported by
      eugenis.
    - Avoid a memory leak where we would leak a consensus body when we
      find that a consensus which we couldn't previously verify due to
      missing certificates is now verifiable. Fixes bug 8719; bugfix
      on 0.2.0.10-alpha.
    - If we are unable to save a microdescriptor to the journal, do not
      drop it from memory and then reattempt downloading it. Fixes bug
      9645; bugfix on 0.2.2.6-alpha.
    - Fix an assertion failure that would occur when disabling the
      ORPort setting on a running Tor process while accounting was
      enabled. Fixes bug 6979; bugfix on 0.2.2.18-alpha.
    - Avoid an assertion failure on OpenBSD (and perhaps other BSDs)
      when an exit connection with optimistic data succeeds immediately
      rather than returning EINPROGRESS. Fixes bug 9017; bugfix on
      0.2.3.1-alpha.
    - Fix a memory leak that would occur whenever a configuration
      option changed. Fixes bug 8718; bugfix on 0.2.3.3-alpha.
  o Major bugfixes (relay rate limiting):
    - When a TLS write is partially successful but incomplete, remember
      that the flushed part has been flushed, and notice that bytes were
      actually written. Reported and fixed pseudonymously. Fixes bug 7708;
      bugfix on Tor 0.1.0.5-rc.
    - Raise the default BandwidthRate/BandwidthBurst values from 5MB/10MB
      to 1GB/1GB. The previous defaults were intended to be "basically
      infinite", but it turns out they're now limiting our 100mbit+
      relays and bridges. Fixes bug 6605; bugfix on 0.2.0.10-alpha (the
      last time we raised it).
    - No longer stop reading or writing on cpuworker connections when
      our rate limiting buckets go empty. Now we should handle circuit
      handshake requests more promptly. Resolves bug 9731.
  o Major bugfixes (client-side privacy):
    - When we mark a circuit as unusable for new circuits, have it
      continue to be unusable for new circuits even if MaxCircuitDirtiness
      is increased too much at the wrong time, or the system clock jumps
      backwards. Fixes bug 6174; bugfix on 0.0.2pre26.
    - If ClientDNSRejectInternalAddresses ("do not believe DNS queries
      which have resolved to internal addresses") is set, apply that
      rule to IPv6 as well. Fixes bug 8475; bugfix on 0.2.0.7-alpha.
    - When an exit relay rejects a stream with reason "exit policy", but
      we only know an exit policy summary (e.g. from the microdesc
      consensus) for it, do not mark the relay as useless for all exiting.
      Instead, mark just the circuit as unsuitable for that particular
      address. Fixes part of bug 7582; bugfix on 0.2.3.2-alpha.
  o Major bugfixes (stream isolation):
    - Allow applications to get proper stream isolation with
      IsolateSOCKSAuth. Many SOCKS5 clients that want to offer
      username/password authentication also offer "no authentication". Tor
      had previously preferred "no authentication", so the applications
      never actually sent Tor their auth details. Now Tor selects
      username/password authentication if it's offered. You can disable
      this behavior on a per-SOCKSPort basis via PreferSOCKSNoAuth. Fixes
      bug 8117; bugfix on 0.2.3.3-alpha.
    - Follow the socks5 protocol when offering username/password
      authentication. The fix for bug 8117 exposed this bug, and it
      turns out real-world applications like Pidgin do care. Bugfix on
      0.2.3.2-alpha; fixes bug 8879.
  o Major bugfixes (client circuit building):
    - Alter circuit build timeout measurement to start at the point
      where we begin the CREATE/CREATE_FAST step (as opposed to circuit
      initialization). This should make our timeout measurements more
      uniform. Previously, we were sometimes including ORconn setup time
      in our circuit build time measurements. Should resolve bug 3443.
    - If the circuit build timeout logic is disabled (via the consensus,
      or because we are an authority), then don't build testing circuits.
      Fixes bug 9657; bugfix on 0.2.2.14-alpha.
  o Major bugfixes (client-side DNS):
    - Turn off the client-side DNS cache by default. Updating and using
      the DNS cache is now configurable on a per-client-port
      level. SOCKSPort, DNSPort, etc lines may now contain
      {No,}Cache{IPv4,IPv6,}DNS lines to indicate that we shouldn't
      cache these types of DNS answers when we receive them from an
      exit node in response to an application request on this port, and
      {No,}UseCached{IPv4,IPv6,DNS} lines to indicate that if we have
      cached DNS answers of these types, we shouldn't use them. It's
      potentially risky to use cached DNS answers at the client, since
      doing so can indicate to one exit what answers we've gotten
      for DNS lookups in the past. With IPv6, this becomes especially
      problematic. Using cached DNS answers for requests on the same
      circuit would present less linkability risk, since all traffic
      on a circuit is already linkable, but it would also provide
      little performance benefit: the exit node caches DNS replies
      too. Implements a simplified version of Proposal 205. Implements
      ticket 7570.
  o Major bugfixes (hidden service privacy):
    - Limit hidden service descriptors to at most ten introduction
      points, to slow one kind of guard enumeration. Fixes bug 9002;
      bugfix on 0.1.1.11-alpha.
  o Major bugfixes (directory fetching):
    - If the time to download the next old-style networkstatus is in
      the future, do not decline to consider whether to download the
      next microdescriptor networkstatus. Fixes bug 9564; bugfix on
      0.2.3.14-alpha.
    - We used to always request authority certificates by identity digest,
      meaning we'd get the newest one even when we wanted one with a
      different signing key. Then we would complain about being given
      a certificate we already had, and never get the one we really
      wanted. Now we use the "fp-sk/" resource as well as the "fp/"
      resource to request the one we want. Fixes bug 5595; bugfix on
      0.2.0.8-alpha.
  o Major bugfixes (bridge reachability):
    - Bridges now send AUTH_CHALLENGE cells during their v3 handshakes;
      previously they did not, which prevented them from receiving
      successful connections from relays for self-test or bandwidth
      testing. Also, when a relay is extending a circuit to a bridge,
      it needs to send a NETINFO cell, even when the bridge hasn't sent
      an AUTH_CHALLENGE cell. Fixes bug 9546; bugfix on 0.2.3.6-alpha.
  o Major bugfixes (control interface):
    - When receiving a new configuration file via the control port's
      LOADCONF command, do not treat the defaults file as absent.
      Fixes bug 9122; bugfix on 0.2.3.9-alpha.
  o Major bugfixes (directory authorities):
    - Stop marking every relay as having been down for one hour every
      time we restart a directory authority. These artificial downtimes
      were messing with our Stable and Guard flag calculations. Fixes
      bug 8218 (introduced by the fix for 1035). Bugfix on 0.2.2.23-alpha.
    - When computing directory thresholds, ignore any rejected-as-sybil
      nodes during the computation so that they can't influence Fast,
      Guard, etc. (We should have done this for proposal 109.) Fixes
      bug 8146.
    - When marking a node as a likely sybil, reset its uptime metrics
      to zero, so that it cannot time towards getting marked as Guard,
      Stable, or HSDir. (We should have done this for proposal 109.) Fixes
      bug 8147.
    - Fix a bug in the voting algorithm that could yield incorrect results
      when a non-naming authority declared too many flags. Fixes bug 9200;
      bugfix on 0.2.0.3-alpha.
  o Internal abstraction features:
    - Introduce new channel_t abstraction between circuits and
      or_connection_t to allow for implementing alternate OR-to-OR
      transports. A channel_t is an abstract object which can either be a
      cell-bearing channel, which is responsible for authenticating and
      handshaking with the remote OR and transmitting cells to and from
      it, or a listening channel, which spawns new cell-bearing channels
      at the request of remote ORs. Implements part of ticket 6465.
    - Make a channel_tls_t subclass of channel_t, adapting it to the
      existing or_connection_t code. The V2/V3 protocol handshaking
      code which formerly resided in command.c has been moved below the
      channel_t abstraction layer and may be found in channeltls.c now.
      Implements the rest of ticket 6465.
    - Introduce new circuitmux_t storing the queue of circuits for
      a channel; this encapsulates and abstracts the queue logic and
      circuit selection policy, and allows the latter to be overridden
      easily by switching out a policy object. The existing EWMA behavior
      is now implemented as a circuitmux_policy_t. Resolves ticket 6816.
  o New build requirements:
    - Tor now requires OpenSSL 0.9.8 or later. OpenSSL 1.0.0 or later is
      strongly recommended.
    - Tor maintainers now require Automake version 1.9 or later to build
      Tor from the Git repository. (Automake is not required when building
      from a source distribution.)
  o Minor features (protocol):
    - No longer include the "opt" prefix when generating routerinfos
      or v2 directories: it has been needless since Tor 0.1.2. Closes
      ticket 5124.
    - Reject EXTEND cells sent to nonexistent streams. According to the
      spec, an EXTEND cell sent to _any_ nonzero stream ID is invalid, but
      we were only checking for stream IDs that were currently in use.
      Found while hunting for more instances of bug 6271. Bugfix on
      0.0.2pre8, which introduced incremental circuit construction.
    - Tor relays and clients now support a better CREATE/EXTEND cell
      format, allowing the sender to specify multiple address, identity,
      and handshake types. Implements Robert Ransom's proposal 200;
      closes ticket 7199.
    - Reject as invalid most directory objects containing a NUL.
      Belt-and-suspender fix for bug 8037.
  o Minor features (security):
    - Clear keys and key-derived material left on the stack in
      rendservice.c and rendclient.c. Check return value of
      crypto_pk_write_private_key_to_string() in rend_service_load_keys().
      These fixes should make us more forward-secure against cold-boot
      attacks and the like. Fixes bug 2385.
    - Use our own weak RNG when we need a weak RNG. Windows's rand() and
      Irix's random() only return 15 bits; Solaris's random() returns more
      bits but its RAND_MAX says it only returns 15, and so on. Motivated
      by the fix for bug 7801; bugfix on 0.2.2.20-alpha.
  o Minor features (control protocol):
    - Add a "GETINFO signal/names" control port command. Implements
      ticket 3842.
    - Provide default values for all options via "GETINFO config/defaults".
      Implements ticket 4971.
    - Allow an optional $ before the node identity digest in the
      controller command GETINFO ns/id/, for consistency with
      md/id/ and desc/id/. Resolves ticket 7059.
    - Add CACHED keyword to ADDRMAP events in the control protocol
      to indicate whether a DNS result will be cached or not. Resolves
      ticket 8596.
    - Generate bootstrapping status update events correctly when fetching
      microdescriptors. Fixes bug 9927.
  o Minor features (path selection):
    - When deciding whether we have enough descriptors to build circuits,
      instead of looking at raw relay counts, look at which fraction
      of (bandwidth-weighted) paths we're able to build. This approach
      keeps clients from building circuits if their paths are likely to
      stand out statistically. The default fraction of paths needed is
      taken from the consensus directory; you can override it with the
      new PathsNeededToBuildCircuits option. Fixes ticket 5956.
    - When any country code is listed in ExcludeNodes or ExcludeExitNodes,
      and we have GeoIP information, also exclude all nodes with unknown
      countries "??" and "A1". This behavior is controlled by the
      new GeoIPExcludeUnknown option: you can make such nodes always
      excluded with "GeoIPExcludeUnknown 1", and disable the feature
      with "GeoIPExcludeUnknown 0". Setting "GeoIPExcludeUnknown auto"
      gets you the default behavior. Implements feature 7706.
  o Minor features (hidden services):
    - Improve circuit build timeout handling for hidden services.
      In particular: adjust build timeouts more accurately depending
      upon the number of hop-RTTs that a particular circuit type
      undergoes. Additionally, launch intro circuits in parallel
      if they timeout, and take the first one to reply as valid.
    - The Tor client now ignores sub-domain components of a .onion
      address. This change makes HTTP "virtual" hosting
      possible:  and
       can be two different websites
      hosted on the same hidden service. Implements proposal 204.
    - Enable Tor to read configuration, state, and key information from
      a FIFO. Previously Tor would only read from files with a positive
      stat.st_size. Code from meejah; fixes bug 6044.
  o Minor features (clients):
    - Teach bridge-using clients to avoid 0.2.2.x bridges when making
      microdescriptor-related dir requests, and only fall back to normal
      descriptors if none of their bridges can handle microdescriptors
      (as opposed to the fix in ticket 4013, which caused them to fall
      back to normal descriptors if *any* of their bridges preferred
      them). Resolves ticket 4994.
    - Tweak tor-fw-helper to accept an arbitrary amount of arbitrary
      TCP ports to forward. In the past it only accepted two ports:
      the ORPort and the DirPort.
  o Minor features (protecting client timestamps):
    - Clients no longer send timestamps in their NETINFO cells. These were
      not used for anything, and they provided one small way for clients
      to be distinguished from each other as they moved from network to
      network or behind NAT. Implements part of proposal 222.
    - Clients now round timestamps in INTRODUCE cells down to the nearest
      10 minutes. If a new Support022HiddenServices option is set to 0, or
      if it's set to "auto" and the feature is disabled in the consensus,
      the timestamp is sent as 0 instead. Implements part of proposal 222.
    - Stop sending timestamps in AUTHENTICATE cells. This is not such
      a big deal from a security point of view, but it achieves no actual
      good purpose, and isn't needed. Implements part of proposal 222.
    - Reduce down accuracy of timestamps in hidden service descriptors.
      Implements part of proposal 222.
  o Minor features (bridges):
    - Make bridge relays check once a minute for whether their IP
      address has changed, rather than only every 15 minutes. Resolves
      bugs 1913 and 1992.
    - Bridge statistics now count bridge clients connecting over IPv6:
      bridge statistics files now list "bridge-ip-versions" and
      extra-info documents list "geoip6-db-digest". The control protocol
      "CLIENTS_SEEN" and "ip-to-country" queries now support IPv6. Initial
      implementation by "shkoo", addressing ticket 5055.
    - Add a new torrc option "ServerTransportListenAddr" to let bridge
      operators select the address where their pluggable transports will
      listen for connections. Resolves ticket 7013.
    - Randomize the lifetime of our SSL link certificate, so censors can't
      use the static value for filtering Tor flows. Resolves ticket 8443;
      related to ticket 4014 which was included in 0.2.2.33.
  o Minor features (relays):
    - Option OutboundBindAddress can be specified multiple times and
      accepts IPv6 addresses. Resolves ticket 6876.
  o Minor features (IPv6, client side):
    - AutomapHostsOnResolve now supports IPv6 addresses. By default, we
      prefer to hand out virtual IPv6 addresses, since there are more of
      them and we can't run out. To override this behavior and make IPv4
      addresses preferred, set NoPreferIPv6Automap on whatever SOCKSPort
      or DNSPort you're using for resolving. Implements ticket 7571.
    - AutomapHostsOnResolve responses are now randomized, to avoid
      annoying situations where Tor is restarted and applications
      connect to the wrong addresses.
    - Never try more than 1000 times to pick a new virtual address when
      AutomapHostsOnResolve is set. That's good enough so long as we
      aren't close to handing out our entire virtual address space;
      if you're getting there, it's best to switch to IPv6 virtual
      addresses anyway.
  o Minor features (IPv6, relay/authority side):
    - New config option "AuthDirHasIPv6Connectivity 1" that directory
      authorities should set if they have IPv6 connectivity and want to
      do reachability tests for IPv6 relays. Implements feature 5974.
    - A relay with an IPv6 OR port now sends that address in NETINFO
      cells (in addition to its other address). Implements ticket 6364.
  o Minor features (directory authorities):
    - Directory authorities no long accept descriptors for any version of
      Tor before 0.2.2.35, or for any 0.2.3 release before 0.2.3.10-alpha.
      These versions are insecure, unsupported, or both. Implements
      ticket 6789.
    - When directory authorities are computing thresholds for flags,
      never let the threshold for the Fast flag fall below 4096
      bytes. Also, do not consider nodes with extremely low bandwidths
      when deciding thresholds for various directory flags. This change
      should raise our threshold for Fast relays, possibly in turn
      improving overall network performance; see ticket 1854. Resolves
      ticket 8145.
    - Directory authorities now include inside each vote a statement of
      the performance thresholds they used when assigning flags.
      Implements ticket 8151.
    - Add an "ignoring-advertised-bws" boolean to the flag-threshold lines
      in directory authority votes to describe whether they have enough
      measured bandwidths to ignore advertised (relay descriptor)
      bandwidth claims. Resolves ticket 8711.
  o Minor features (path bias detection):
    - Path Use Bias: Perform separate accounting for successful circuit
      use. Keep separate statistics on stream attempt rates versus stream
      success rates for each guard. Provide configurable thresholds to
      determine when to emit log messages or disable use of guards that
      fail too many stream attempts. Resolves ticket 7802.
    - Create three levels of Path Bias log messages, as opposed to just
      two. These are configurable via consensus as well as via the torrc
      options PathBiasNoticeRate, PathBiasWarnRate, PathBiasExtremeRate.
      The default values are 0.70, 0.50, and 0.30 respectively.
    - Separate the log message levels from the decision to drop guards,
      which also is available via torrc option PathBiasDropGuards.
      PathBiasDropGuards still defaults to 0 (off).
    - Deprecate PathBiasDisableRate in favor of PathBiasDropGuards
      in combination with PathBiasExtremeRate.
    - Increase the default values for PathBiasScaleThreshold and
      PathBiasCircThreshold from (200, 20) to (300, 150).
    - Add in circuit usage accounting to path bias. If we try to use a
      built circuit but fail for any reason, it counts as path bias.
      Certain classes of circuits where the adversary gets to pick your
      destination node are exempt from this accounting. Usage accounting
      can be specifically disabled via consensus parameter or torrc.
    - Convert all internal path bias state to double-precision floating
      point, to avoid roundoff error and other issues.
    - Only record path bias information for circuits that have completed
      *two* hops. Assuming end-to-end tagging is the attack vector, this
      makes us more resilient to ambient circuit failure without any
      detection capability loss.
  o Minor features (build):
    - Tor now builds correctly on Bitrig, an OpenBSD fork. Patch from
      dhill. Resolves ticket 6982.
    - Compile on win64 using mingw64. Fixes bug 7260; patches from
      "yayooo".
    - Work correctly on Unix systems where EAGAIN and EWOULDBLOCK are
      separate error codes; or at least, don't break for that reason.
      Fixes bug 7935. Reported by "oftc_must_be_destroyed".
  o Build improvements (autotools):
    - Warn if building on a platform with an unsigned time_t: there
      are too many places where Tor currently assumes that time_t can
      hold negative values. We'd like to fix them all, but probably
      some will remain.
    - Do not report status verbosely from autogen.sh unless the -v flag
      is specified. Fixes issue 4664. Patch from Onizuka.
    - Detect and reject attempts to build Tor with threading support
      when OpenSSL has been compiled without threading support.
      Fixes bug 6673.
    - Try to detect if we are ever building on a platform where
      memset(...,0,...) does not set the value of a double to 0.0. Such
      platforms are permitted by the C standard, though in practice
      they're pretty rare (since IEEE 754 is nigh-ubiquitous). We don't
      currently support them, but it's better to detect them and fail
      than to perform erroneously.
    - We no longer warn so much when generating manpages from their
      asciidoc source.
    - Use Ville Laurikari's implementation of AX_CHECK_SIGN() to determine
      the signs of types during autoconf. This is better than our old
      approach, which didn't work when cross-compiling.
  o Minor features (log messages, warnings):
    - Detect when we're running with a version of OpenSSL other than the
      one we compiled with. This conflict has occasionally given people
      hard-to-track-down errors.
    - Warn users who run hidden services on a Tor client with
      UseEntryGuards disabled that their hidden services will be
      vulnerable to  (the
      attack which motivated Tor to support entry guards in the first
      place). Resolves ticket 6889.
    - Warn when we are binding low ports when hibernation is enabled;
      previously we had warned when we were _advertising_ low ports with
      hibernation enabled. Fixes bug 7285; bugfix on 0.2.3.9-alpha.
    - Issue a warning when running with the bufferevents backend enabled.
      It's still not stable, and people should know that they're likely
      to hit unexpected problems. Closes ticket 9147.
  o Minor features (log messages, notices):
    - Refactor resolve_my_address() so it returns the method by which we
      decided our public IP address (explicitly configured, resolved from
      explicit hostname, guessed from interfaces, learned by gethostname).
      Now we can provide more helpful log messages when a relay guesses
      its IP address incorrectly (e.g. due to unexpected lines in
      /etc/hosts). Resolves ticket 2267.
    - Track how many "TAP" and "NTor" circuit handshake requests we get,
      and how many we complete, and log it every hour to help relay
      operators follow trends in network load. Addresses ticket 9658.
  o Minor features (log messages, diagnostics):
    - If we fail to free a microdescriptor because of bug 7164, log
      the filename and line number from which we tried to free it.
    - We compute the overhead from passing onionskins back and forth to
      cpuworkers, and report it when dumping statistics in response to
      SIGUSR1. Supports ticket 7291.
    - Add another diagnostic to the heartbeat message: track and log
      overhead that TLS is adding to the data we write. If this is
      high, we are sending too little data to SSL_write at a time.
      Diagnostic for bug 7707.
    - Log packaged cell fullness as part of the heartbeat message.
      Diagnosis to try to determine the extent of bug 7743.
    - Add more detail to a log message about relaxed timeouts, to help
      track bug 7799.
    - When learning a fingerprint for a bridge, log its corresponding
      transport type. Implements ticket 7896.
    - Warn more aggressively when flushing microdescriptors to a
      microdescriptor cache fails, in an attempt to mitigate bug 8031,
      or at least make it more diagnosable.
    - Improve the log message when "Bug/attack: unexpected sendme cell
      from client" occurs, to help us track bug 8093.
    - Improve debugging output to help track down bug 8185 ("Bug:
      outgoing relay cell has n_chan==NULL. Dropping.")
  o Minor features (log messages, quieter bootstrapping):
    - Log fewer lines at level "notice" about our OpenSSL and Libevent
      versions and capabilities when everything is going right. Resolves
      part of ticket 6736.
    - Omit the first heartbeat log message, because it never has anything
      useful to say, and it clutters up the bootstrapping messages.
      Resolves ticket 6758.
    - Don't log about reloading the microdescriptor cache at startup. Our
      bootstrap warnings are supposed to tell the user when there's a
      problem, and our bootstrap notices say when there isn't. Resolves
      ticket 6759; bugfix on 0.2.2.6-alpha.
    - Don't log "I learned some more directory information" when we're
      reading cached directory information. Reserve it for when new
      directory information arrives in response to a fetch. Resolves
      ticket 6760.
    - Don't complain about bootstrapping problems while hibernating.
      These complaints reflect a general code problem, but not one
      with any problematic effects (no connections are actually
      opened). Fixes part of bug 7302; bugfix on 0.2.3.2-alpha.
  o Minor features (testing):
    - In our testsuite, create temporary directories with a bit more
      entropy in their name to make name collisions less likely. Fixes
      bug 8638.
    - Add benchmarks for DH (1024-bit multiplicative group) and ECDH
      (P-256) Diffie-Hellman handshakes to src/or/bench.
    - Add benchmark functions to test onion handshake performance.
  o Renamed options:
    - The DirServer option is now DirAuthority, for consistency with
      current naming patterns. You can still use the old DirServer form.
  o Minor bugfixes (protocol):
    - Fix the handling of a TRUNCATE cell when it arrives while the
      circuit extension is in progress. Fixes bug 7947; bugfix on 0.0.7.1.
    - When a Tor client gets a "truncated" relay cell, the first byte of
      its payload specifies why the circuit was truncated. We were
      ignoring this 'reason' byte when tearing down the circuit, resulting
      in the controller not being told why the circuit closed. Now we
      pass the reason from the truncated cell to the controller. Bugfix
      on 0.1.2.3-alpha; fixes bug 7039.
    - Fix a misframing issue when reading the version numbers in a
      VERSIONS cell. Previously we would recognize [00 01 00 02] as
      'version 1, version 2, and version 0x100', when it should have
      only included versions 1 and 2. Fixes bug 8059; bugfix on
      0.2.0.10-alpha. Reported pseudonymously.
    - Make the format and order of STREAM events for DNS lookups
      consistent among the various ways to launch DNS lookups. Fixes
      bug 8203; bugfix on 0.2.0.24-rc. Patch by "Desoxy".
  o Minor bugfixes (syscalls and disk interaction):
    - Always check the return values of functions fcntl() and
      setsockopt(). We don't believe these are ever actually failing in
      practice, but better safe than sorry. Also, checking these return
      values should please analysis tools like Coverity. Patch from
      'flupzor'. Fixes bug 8206; bugfix on all versions of Tor.
    - Avoid double-closing the listener socket in our socketpair()
      replacement (used on Windows) in the case where the addresses on
      our opened sockets don't match what we expected. Fixes bug 9400;
      bugfix on 0.0.2pre7. Found by Coverity.
    - Correctly store microdescriptors and extrainfo descriptors that
      include an internal NUL byte. Fixes bug 8037; bugfix on
      0.2.0.1-alpha. Bug reported by "cypherpunks".
    - If for some reason we fail to write a microdescriptor while
      rebuilding the cache, do not let the annotations from that
      microdescriptor linger in the cache file, and do not let the
      microdescriptor stay recorded as present in its old location.
      Fixes bug 9047; bugfix on 0.2.2.6-alpha.
    - Use direct writes rather than stdio when building microdescriptor
      caches, in an attempt to mitigate bug 8031, or at least make it
      less common.
  o Minor fixes (config options):
    - Warn and fail if a server is configured not to advertise any
      ORPorts at all. (We need *something* to put in our descriptor,
      or we just won't work.)
    - Behave correctly when the user disables LearnCircuitBuildTimeout
      but doesn't tell us what they would like the timeout to be. Fixes
      bug 6304; bugfix on 0.2.2.14-alpha.
    - Rename the (internal-use-only) UsingTestingNetworkDefaults option
      to start with a triple-underscore so the controller won't touch it.
      Patch by Meejah. Fixes bug 3155. Bugfix on 0.2.2.23-alpha.
    - Rename the (testing-use-only) _UseFilteringSSLBufferevents option
      so it doesn't start with _. Fixes bug 3155. Bugfix on 0.2.3.1-alpha.
    - When autodetecting the number of CPUs, use the number of available
      CPUs in preference to the number of configured CPUs. Inform the
      user if this reduces the number of available CPUs. Fixes bug 8002;
      bugfix on 0.2.3.1-alpha.
    - Command-line option "--version" implies "--quiet". Fixes bug 6997.
    - Make it an error when you set EntryNodes but disable UseGuardNodes,
      since it will (surprisingly to some users) ignore EntryNodes. Fixes
      bug 8180; bugfix on 0.2.3.11-alpha.
    - Avoid overflows when the user sets MaxCircuitDirtiness to a
      ridiculously high value, by imposing a (ridiculously high) 30-day
      maximum on MaxCircuitDirtiness.
  o Minor bugfixes (control protocol):
    - Stop sending a stray "(null)" in some cases for the server status
      "EXTERNAL_ADDRESS" controller event. Resolves bug 8200; bugfix
      on 0.1.2.6-alpha.
    - The ADDRMAP command can no longer generate an ill-formed error
      code on a failed MAPADDRESS. It now says "internal" rather than
      an English sentence fragment with spaces in the middle. Bugfix on
      Tor 0.2.0.19-alpha.
  o Minor bugfixes (clients / edges):
    - When we receive a RELAY_END cell with the reason DONE, or with no
      reason, before receiving a RELAY_CONNECTED cell, report the SOCKS
      status as "connection refused". Previously we reported these cases
      as success but then immediately closed the connection. Fixes bug
      7902; bugfix on 0.1.0.1-rc. Reported by "oftc_must_be_destroyed".
    - If the guard we choose first doesn't answer, we would try the
      second guard, but once we connected to the second guard we would
      abandon it and retry the first one, slowing down bootstrapping.
      The fix is to treat all our initially chosen guards as acceptable
      to use. Fixes bug 9946; bugfix on 0.1.1.11-alpha.
    - When choosing which stream on a formerly stalled circuit to wake
      first, make better use of the platform's weak RNG. Previously,
      we had been using the % ("modulo") operator to try to generate a
      1/N chance of picking each stream, but this behaves badly with
      many platforms' choice of weak RNG. Fixes bug 7801; bugfix on
      0.2.2.20-alpha.
  o Minor bugfixes (path bias detection):
    - If the state file's path bias counts are invalid (presumably from a
      buggy Tor prior to 0.2.4.10-alpha), make them correct. Also add
      additional checks and log messages to the scaling of Path Bias
      counts, in case there still are remaining issues with scaling.
      Should help resolve bug 8235.
    - Prevent rounding error in path bias counts when scaling
      them down, and use the correct scale factor default. Also demote
      some path bias related log messages down a level and make others
      less scary sounding. Fixes bug 6647. Bugfix on 0.2.3.17-beta.
    - Remove a source of rounding error during path bias count scaling;
      don't count cannibalized circuits as used for path bias until we
      actually try to use them; and fix a circuit_package_relay_cell()
      warning message about n_chan==NULL. Fixes bug 7802.
    - Paste the description for PathBias parameters from the man
      page into or.h, so the code documents them too. Fixes bug 7982;
      bugfix on 0.2.3.17-beta.
  o Minor bugfixes (relays):
    - Stop trying to resolve our hostname so often (e.g. every time we
      think about doing a directory fetch). Now we reuse the cached
      answer in some cases. Fixes bugs 1992 (bugfix on 0.2.0.20-rc)
      and 2410 (bugfix on 0.1.2.2-alpha).
    - When examining the list of network interfaces to find our address,
      do not consider non-running or disabled network interfaces. Fixes
      bug 9904; bugfix on 0.2.3.11-alpha. Patch from "hantwister".
  o Minor bugfixes (blocking resistance):
    - Only disable TLS session ticket support when running as a TLS
      server. Now clients will blend better with regular Firefox
      connections. Fixes bug 7189; bugfix on Tor 0.2.3.23-rc.
  o Minor bugfixes (IPv6):
    - Use square brackets around IPv6 addresses in numerous places
      that needed them, including log messages, HTTPS CONNECT proxy
      requests, TransportProxy statefile entries, and pluggable transport
      extra-info lines. Fixes bug 7011; patch by David Fifield.
  o Minor bugfixes (directory authorities):
    - Reject consensus votes with more than 64 known-flags. We aren't even
      close to that limit yet, and our code doesn't handle it correctly.
      Fixes bug 6833; bugfix on 0.2.0.1-alpha.
    - Correctly handle votes with more than 31 flags. Fixes bug 6853;
      bugfix on 0.2.0.3-alpha.
  o Minor bugfixes (memory leaks):
    - Avoid leaking memory if we fail to compute a consensus signature
      or we generate a consensus we can't parse. Bugfix on 0.2.0.5-alpha.
    - Fix a memory leak when receiving headers from an HTTPS proxy. Bugfix
      on 0.2.1.1-alpha; fixes bug 7816.
    - Fix a memory leak during safe-cookie controller authentication.
      Bugfix on 0.2.3.13-alpha; fixes bug 7816.
    - Free some more still-in-use memory at exit, to make hunting for
      memory leaks easier. Resolves bug 7029.
  o Minor bugfixes (code correctness):
    - Increase the width of the field used to remember a connection's
      link protocol version to two bytes. Harmless for now, since the
      only currently recognized versions are one byte long. Reported
      pseudonymously. Fixes bug 8062; bugfix on 0.2.0.10-alpha.
    - Fix a crash when debugging unit tests on Windows: deallocate a
      shared library with FreeLibrary, not CloseHandle. Fixes bug 7306;
      bugfix on 0.2.2.17-alpha. Reported by "ultramage".
    - When detecting the largest possible file descriptor (in order to
      close all file descriptors when launching a new program), actually
      use _SC_OPEN_MAX. The old code for doing this was very, very broken.
      Fixes bug 8209; bugfix on 0.2.3.1-alpha. Found by Coverity; this
      is CID 743383.
    - Avoid a crash if we fail to generate an extrainfo descriptor.
      Fixes bug 8208; bugfix on 0.2.3.16-alpha. Found by Coverity;
      this is CID 718634.
    - Avoid an off-by-one error when checking buffer boundaries when
      formatting the exit status of a pluggable transport helper.
      This is probably not an exploitable bug, but better safe than
      sorry. Fixes bug 9928; bugfix on 0.2.3.18-rc. Bug found by
      Pedro Ribeiro.
    - Get rid of a couple of harmless clang warnings, where we compared
      enums to ints. These warnings are newly introduced in clang 3.2.
  o Minor bugfixes (code cleanliness):
    - Avoid use of reserved identifiers in our C code. The C standard
      doesn't like us declaring anything that starts with an
      underscore, so let's knock it off before we get in trouble. Fix
      for bug 1031; bugfix on the first Tor commit.
    - Fix round_to_power_of_2() so it doesn't invoke undefined behavior
      with large values. This situation was untriggered, but nevertheless
      incorrect. Fixes bug 6831; bugfix on 0.2.0.1-alpha.
    - Fix an impossible buffer overrun in the AES unit tests. Fixes
      bug 8845; bugfix on 0.2.0.7-alpha. Found by eugenis.
    - Fix handling of rendezvous client authorization types over 8.
      Fixes bug 6861; bugfix on 0.2.1.5-alpha.
    - Remove a couple of extraneous semicolons that were upsetting the
      cparser library. Patch by Christian Grothoff. Fixes bug 7115;
      bugfix on 0.2.2.1-alpha.
    - When complaining about a client port on a public address, log
      which address we're complaining about. Fixes bug 4020; bugfix on
      0.2.3.3-alpha. Patch by Tom Fitzhenry.
  o Minor bugfixes (log messages, warnings):
    - If we encounter a write failure on a SOCKS connection before we
      finish our SOCKS handshake, don't warn that we closed the
      connection before we could send a SOCKS reply. Fixes bug 8427;
      bugfix on 0.1.0.1-rc.
    - Fix a directory authority warn caused when we have a large amount
      of badexit bandwidth. Fixes bug 8419; bugfix on 0.2.2.10-alpha.
    - Downgrade "Failed to hand off onionskin" messages to "debug"
      severity, since they're typically redundant with the "Your computer
      is too slow" messages. Fixes bug 7038; bugfix on 0.2.2.16-alpha.
    - Avoid spurious warnings when configuring multiple client ports of
      which only some are nonlocal. Previously, we had claimed that some
      were nonlocal when in fact they weren't. Fixes bug 7836; bugfix on
      0.2.3.3-alpha.
  o Minor bugfixes (log messages, other):
    - Fix log messages and comments to avoid saying "GMT" when we mean
      "UTC". Fixes bug 6113.
    - When rejecting a configuration because we were unable to parse a
      quoted string, log an actual error message. Fixes bug 7950; bugfix
      on 0.2.0.16-alpha.
    - Correctly recognize that [::1] is a loopback address. Fixes
      bug 8377; bugfix on 0.2.1.3-alpha.
    - Don't log inappropriate heartbeat messages when hibernating: a
      hibernating node is _expected_ to drop out of the consensus,
      decide it isn't bootstrapped, and so forth. Fixes bug 7302;
      bugfix on 0.2.3.1-alpha.
    - Eliminate several instances where we use "Nickname=ID" to refer to
      nodes in logs. Use "Nickname (ID)" instead. (Elsewhere, we still use
      "$ID=Nickname", which is also acceptable.) Fixes bug 7065. Bugfix
      on 0.2.3.21-rc.
  o Minor bugfixes (build):
    - Fix some bugs in tor-fw-helper-natpmp when trying to build and
      run it on Windows. More bugs likely remain. Patch from Gisle Vanem.
      Fixes bug 7280; bugfix on 0.2.3.1-alpha.
  o Documentation fixes:
    - Make the torify manpage no longer refer to tsocks; torify hasn't
      supported tsocks since 0.2.3.14-alpha.
    - Make the tor manpage no longer reference tsocks.
    - Fix the GeoIPExcludeUnknown documentation to refer to
      ExcludeExitNodes rather than the currently nonexistent
      ExcludeEntryNodes. Spotted by "hamahangi" on tor-talk.
    - Resolve a typo in torrc.sample.in. Fixes bug 6819; bugfix on
      0.2.3.14-alpha.
    - Say "KBytes" rather than "KB" in the man page (for various values
      of K), to further reduce confusion about whether Tor counts in
      units of memory or fractions of units of memory. Resolves ticket 7054.
    - Update tor-fw-helper.1.txt and tor-fw-helper.c to make option
      names match. Fixes bug 7768.
    - Fix the documentation of HeartbeatPeriod to say that the heartbeat
      message is logged at notice, not at info.
    - Clarify the usage and risks of setting the ContactInfo torrc line
      for your relay or bridge. Resolves ticket 9854.
    - Add anchors to the manpage so we can link to the html version of
      the documentation for specific options. Resolves ticket 9866.
    - Replace remaining references to DirServer in man page and
      log entries. Resolves ticket 10124.
  o Removed features:
    - Stop exporting estimates of v2 and v3 directory traffic shares
      in extrainfo documents. They were unneeded and sometimes inaccurate.
      Also stop exporting any v2 directory request statistics. Resolves
      ticket 5823.
    - Drop support for detecting and warning about versions of Libevent
      before 1.3e. Nothing reasonable ships with them any longer; warning
      the user about them shouldn't be needed. Resolves ticket 6826.
    - Now that all versions before 0.2.2.x are disallowed, we no longer
      need to work around their missing features. Remove a bunch of
      compatibility code.
  o Removed files:
    - The tor-tsocks.conf is no longer distributed or installed. We
      recommend that tsocks users use torsocks instead. Resolves
      ticket 8290.
    - Remove some of the older contents of doc/ as obsolete; move others
      to torspec.git. Fixes bug 8965.
  o Code simplification:
    - Avoid using character buffers when constructing most directory
      objects: this approach was unwieldy and error-prone. Instead,
      build smartlists of strings, and concatenate them when done.
    - Rename "isin" functions to "contains", for grammar. Resolves
      ticket 5285.
    - Rename Tor's logging function log() to tor_log(), to avoid conflicts
      with the natural logarithm function from the system libm. Resolves
      ticket 7599.
    - Start using OpenBSD's implementation of queue.h, so that we don't
      need to hand-roll our own pointer and list structures whenever we
      need them. (We can't rely on a sys/queue.h, since some operating
      systems don't have them, and the ones that do have them don't all
      present the same extensions.)
    - Start using OpenBSD's implementation of queue.h (originally by
      Niels Provos).
    - Enhance our internal sscanf replacement so that we can eliminate
      the last remaining uses of the system sscanf. (Though those uses
      of sscanf were safe, sscanf itself is generally error prone, so
      we want to eliminate when we can.) Fixes ticket 4195 and Coverity
      CID 448.
    - Replace all calls to snprintf() outside of src/ext with
      tor_snprintf(). Also remove the  to replace snprintf with
      _snprintf on Windows; they have different semantics, and all of
      our callers should be using tor_snprintf() anyway. Fixes bug 7304.
  o Refactoring:
    - Add a wrapper function for the common "log a message with a
      rate-limit" case.
    - Split the onion.c file into separate modules for the onion queue
      and the different handshakes it supports.
    - Move the client-side address-map/virtual-address/DNS-cache code
      out of connection_edge.c into a new addressmap.c module.
    - Move the entry node code from circuitbuild.c to its own file.
    - Move the circuit build timeout tracking code from circuitbuild.c
      to its own file.
    - Source files taken from other packages now reside in src/ext;
      previously they were scattered around the rest of Tor.
    - Move the generic "config" code into a new file, and have "config.c"
      hold only torrc- and state-related code. Resolves ticket 6823.
    - Move the core of our "choose a weighted element at random" logic
      into its own function, and give it unit tests. Now the logic is
      testable, and a little less fragile too.
    - Move ipv6_preferred from routerinfo_t to node_t. Addresses bug 4620.
    - Move last_reachable and testing_since from routerinfo_t to node_t.
      Implements ticket 5529.
    - Add replaycache_t structure, functions and unit tests, then refactor
      rend_service_introduce() to be more clear to read, improve, debug,
      and test. Resolves bug 6177.
  o Removed code:
    - Remove some now-needless code that tried to aggressively flush
      OR connections as data was added to them. Since 0.2.0.1-alpha, our
      cell queue logic has saved us from the failure mode that this code
      was supposed to prevent. Removing this code will limit the number
      of baroque control flow paths through Tor's network logic. Reported
      pseudonymously on IRC. Fixes bug 6468; bugfix on 0.2.0.1-alpha.
    - Remove unused code for parsing v1 directories and "running routers"
      documents. Fixes bug 6887.
    - Remove the marshalling/unmarshalling code for sending requests to
      cpuworkers over a socket, and instead just send structs. The
      recipient will always be the same Tor binary as the sender, so
      any encoding is overkill.
    - Remove the testing_since field of node_t, which hasn't been used
      for anything since 0.2.0.9-alpha.
    - Finally remove support for malloc_good_size and malloc_usable_size.
      We had hoped that these functions would let us eke a little more
      memory out of our malloc implementation. Unfortunately, the only
      implementations that provided these functions are also ones that
      are already efficient about not overallocation: they never got us
      more than 7 or so bytes per allocation. Removing them saves us a
      little code complexity and a nontrivial amount of build complexity.

@_date: 2013-12-17 01:33:51
@_author: Roger Dingledine 
@_subject: [tor-talk] $50k Access Innovation Prize for Endpoint Security 
Hi Michael,
Thanks for letting us know.
The interesting Tor-related projects that come to mind are TBB 3.5:
And Tails / WiNoN:
(the WiNoN folks are working on a patch to Tails so they can become
one thing).

@_date: 2013-12-20 01:37:25
@_author: Roger Dingledine 
@_subject: [tor-talk] OS X: Version Info + 64-bit 
Hi Art,
I suggest you help with
"intentionally neglected" is a bit strong. We have not enough packaging
people, not enough developers, and way too much to do. If 32-bit works
adequately for now I totally understand triaging that and moving on for
the release. The main race was to get something out with Firefox 24,
since Firefox 17 is no longer supported.

@_date: 2013-12-21 19:18:06
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB3.5, Vidalia, 
No, you are mistaken -- it's been on by default the whole time. See also

@_date: 2013-12-22 04:26:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Upcoming Tor 0.2.4.20 tarball, please test if you like 
Hi folks,
I'm going to sign and tag 0.2.4.20 shortly. The current snapshot is:
Its sha256sum is
If you are so inclined, please beat on it for a while and see if
I introduced any new issues.

@_date: 2013-12-23 02:21:35
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.20 is released 
Tor 0.2.4.20 fixes potentially poor random number generation for users
who 1) use OpenSSL 1.0.0 or later, 2) set "HardwareAccel 1" in their
torrc file, 3) have "Sandy Bridge" or "Ivy Bridge" Intel processors,
and 4) have no state file in their DataDirectory (as would happen on
first start). Users who generated relay or hidden service identity
keys in such a situation should discard them and generate new ones.
This release also fixes a logic error that caused Tor clients to build
many more preemptive circuits than they actually need.
Packages coming soon, including a new TBB 3.5.1 with some other fixes,
at which point I'll announce on the tor-announce list too.
Changes in version 0.2.4.20 - 2013-12-22
  o Major bugfixes:
    - Do not allow OpenSSL engines to replace the PRNG, even when
      HardwareAccel is set. The only default builtin PRNG engine uses
      the Intel RDRAND instruction to replace the entire PRNG, and
      ignores all attempts to seed it with more entropy. That's
      cryptographically stupid: the right response to a new alleged
      entropy source is never to discard all previously used entropy
      sources. Fixes bug 10402; works around behavior introduced in
      OpenSSL 1.0.0. Diagnosis and investigation thanks to "coderman"
      and "rl1987".
    - Fix assertion failure when AutomapHostsOnResolve yields an IPv6
      address. Fixes bug 10465; bugfix on 0.2.4.7-alpha.
    - Avoid launching spurious extra circuits when a stream is pending.
      This fixes a bug where any circuit that _wasn't_ unusable for new
      streams would be treated as if it were, causing extra circuits to
      be launched. Fixes bug 10456; bugfix on 0.2.4.12-alpha.
  o Minor bugfixes:
    - Avoid a crash bug when starting with a corrupted microdescriptor
      cache file. Fixes bug 10406; bugfix on 0.2.2.6-alpha.
    - If we fail to dump a previously cached microdescriptor to disk,
      avoid freeing duplicate data later on. Fixes bug 10423; bugfix on
      0.2.4.13-alpha. Spotted by "bobnomnom".

@_date: 2013-12-24 00:24:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Shutting down the relay-search service by the end of 
I have found another wrinkle here: Atlas and Globe both require
Javascript, which some quite reasonable people choose to disable.
I guess one answer is to hope that some nice person wants to write an
Atlas / Globe version (or derivative) that doesn't rely on Javascript
so much. (Anybody want to do that? :)
Another answer is to downplay Atlas and Globe too, for other reasons
than the one you raised above. That's sort of a crummy answer.
Did I miss any?

@_date: 2013-12-25 01:38:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.19 is released 
Looks like Erinn is in the process of uploading new ones:
but she deleted the old ones before changing the links (oops).
You can always find older ones at

@_date: 2013-12-27 23:37:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Internal error bug: Got an INTRODUCE2 cell ... 
Looks like another case of the "hidden services need more love"
issue -- nobody has the time+expertise to fix bugs like this one.
Perhaps somebody wants to work on it? rransom's last comment looks
like a pretty good lead.

@_date: 2013-02-03 12:47:51
@_author: Roger Dingledine 
@_subject: [tor-talk] TOR Fone - p2p secure and anonymous VoIP tool 
Ugh! Another project using the Tor name in a confusing way (which
will make people think it is supported or endorsed by Tor), without
understanding our trademark policy:
I'll try to find some time to contact the person off-line and suggest
changing the name to 'OnionFone' or something more generic. Please feel
free to do so in parallel to me, since I know somebody here has much
more free time than I do. :)

@_date: 2013-02-04 02:59:11
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia Network Map list blank 
It's fixed in Vidalia 0.2.21, but Tails has Vidalia 0.2.20.
Yep. It's just a bug in Vidalia's display. Tor is still working fine

@_date: 2013-02-04 19:31:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.10-alpha is out 
Tor 0.2.4.10-alpha adds defenses at the directory authority level from
certain attacks that flood the network with relays; changes the queue
for circuit create requests from a sized-based limit to a time-based
limit; resumes building with MSVC on Windows; and fixes a wide variety
of other issues.
Changes in version 0.2.4.10-alpha - 2013-02-04
  o Major bugfixes (directory authority):
    - When computing directory thresholds, ignore any rejected-as-sybil
      nodes during the computation so that they can't influence Fast,
      Guard, etc. (We should have done this for proposal 109.) Fixes
      bug 8146.
    - When marking a node as a likely sybil, reset its uptime metrics
      to zero, so that it cannot time towards getting marked as Guard,
      Stable, or HSDir. (We should have done this for proposal 109.) Fixes
      bug 8147.
  o Major bugfixes:
    - When a TLS write is partially successful but incomplete, remember
      that the flushed part has been flushed, and notice that bytes were
      actually written. Reported and fixed pseudonymously. Fixes bug
      7708; bugfix on Tor 0.1.0.5-rc.
    - Reject bogus create and relay cells with 0 circuit ID or 0 stream
      ID: these could be used to create unexpected streams and circuits
      which would count as "present" to some parts of Tor but "absent"
      to others, leading to zombie circuits and streams or to a bandwidth
      denial-of-service. Fixes bug 7889; bugfix on every released version
      of Tor. Reported by "oftc_must_be_destroyed".
    - Rename all macros in our local copy of queue.h to begin with "TOR_".
      This change seems the only good way to permanently prevent conflicts
      with queue.h on various operating systems. Fixes bug 8107; bugfix
      on 0.2.4.6-alpha.
  o Major features (relay):
    - Instead of limiting the number of queued onionskins (aka circuit
      create requests) to a fixed, hard-to-configure number, we limit
      the size of the queue based on how many we expect to be able to
      process in a given amount of time. We estimate the time it will
      take to process an onionskin based on average processing time
      of previous onionskins. Closes ticket 7291. You'll never have to
      configure MaxOnionsPending again.
  o Major features (portability):
    - Resume building correctly with MSVC and Makefile.nmake. This patch
      resolves numerous bugs and fixes reported by ultramage, including
      7305, 7308, 7309, 7310, 7312, 7313, 7315, 7316, and 7669.
    - Make the ntor and curve25519 code build correctly with MSVC.
      Fix on 0.2.4.8-alpha.
  o Minor features:
    - When directory authorities are computing thresholds for flags,
      never let the threshold for the Fast flag fall below 4096
      bytes. Also, do not consider nodes with extremely low bandwidths
      when deciding thresholds for various directory flags. This change
      should raise our threshold for Fast relays, possibly in turn
      improving overall network performance; see ticket 1854. Resolves
      ticket 8145.
    - The Tor client now ignores sub-domain components of a .onion
      address. This change makes HTTP "virtual" hosting
      possible:  and
       can be two different websites
      hosted on the same hidden service. Implements proposal 204.
    - We compute the overhead from passing onionskins back and forth to
      cpuworkers, and report it when dumping statistics in response to
      SIGUSR1. Supports ticket 7291.
  o Minor features (path selection):
    - When deciding whether we have enough descriptors to build circuits,
      instead of looking at raw relay counts, look at which fraction
      of (bandwidth-weighted) paths we're able to build. This approach
      keeps clients from building circuits if their paths are likely to
      stand out statistically. The default fraction of paths needed is
      taken from the consensus directory; you can override it with the
      new PathsNeededToBuildCircuits option. Fixes ticket 5956.
    - When any country code is listed in ExcludeNodes or ExcludeExitNodes,
      and we have GeoIP information, also exclude all nodes with unknown
      countries "??" and "A1". This behavior is controlled by the
      new GeoIPExcludeUnknown option: you can make such nodes always
      excluded with "GeoIPExcludeUnknown 1", and disable the feature
      with "GeoIPExcludeUnknown 0". Setting "GeoIPExcludeUnknown auto"
      gets you the default behavior. Implements feature 7706.
    - Path Use Bias: Perform separate accounting for successful circuit
      use. Keep separate statistics on stream attempt rates versus stream
      success rates for each guard. Provide configurable thresholds to
      determine when to emit log messages or disable use of guards that
      fail too many stream attempts. Resolves ticket 7802.
  o Minor features (log messages):
    - When learning a fingerprint for a bridge, log its corresponding
      transport type. Implements ticket 7896.
    - Improve the log message when "Bug/attack: unexpected sendme cell
      from client" occurs, to help us track bug 8093.
  o Minor bugfixes:
    - Remove a couple of extraneous semicolons that were upsetting the
      cparser library. Patch by Christian Grothoff. Fixes bug 7115;
      bugfix on 0.2.2.1-alpha.
    - Remove a source of rounding error during path bias count scaling;
      don't count cannibalized circuits as used for path bias until we
      actually try to use them; and fix a circuit_package_relay_cell()
      warning message about n_chan==NULL. Fixes bug 7802.
    - Detect nacl when its headers are in a nacl/ subdirectory. Also,
      actually link against nacl when we're configured to use it. Fixes
      bug 7972; bugfix on 0.2.4.8-alpha.
    - Compile correctly with the --disable-curve25519 option. Fixes
      bug 8153; bugfix on 0.2.4.8-alpha.
  o Build improvements:
    - Do not report status verbosely from autogen.sh unless the -v flag
      is specified. Fixes issue 4664. Patch from Onizuka.
    - Replace all calls to snprintf() outside of src/ext with
      tor_snprintf(). Also remove the  to replace snprintf with
      _snprintf on Windows; they have different semantics, and all of
      our callers should be using tor_snprintf() anyway. Fixes bug 7304.
    - Try to detect if we are ever building on a platform where
      memset(...,0,...) does not set the value of a double to 0.0. Such
      platforms are permitted by the C standard, though in practice
      they're pretty rare (since IEEE 754 is nigh-ubiquitous). We don't
      currently support them, but it's better to detect them and fail
      than to perform erroneously.
  o Removed features:
    - Stop exporting estimates of v2 and v3 directory traffic shares
      in extrainfo documents. They were unneeded and sometimes inaccurate.
      Also stop exporting any v2 directory request statistics. Resolves
      ticket 5823.
    - Drop support for detecting and warning about versions of Libevent
      before 1.3e. Nothing reasonable ships with them any longer;
      warning the user about them shouldn't be needed. Resolves ticket
      6826.
  o Code simplifications and refactoring:
    - Rename "isin" functions to "contains", for grammar. Resolves
      ticket 5285.
    - Rename Tor's logging function log() to tor_log(), to avoid conflicts
      with the natural logarithm function from the system libm. Resolves
      ticket 7599.

@_date: 2013-02-06 04:26:37
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Jan 2013 
Five things I did in January 2013:
1) Continued my rampage to teach law enforcement groups about Tor,
including a US DEA talk, a Dutch regional police talk, a Belgian FCCU
talk, and a Dutch KPN talk; and my parallel rampage to document and
publish the results:
Jake and I also did the closing keynote for the NCSC conference in
the Hague.
2) Helped organize, and attended, an OONI dev meeting in Amsterdam,
between the Tor OONI team, Nick Feamster's Georgia Tech group, and M-Lab:
Thanks once again to Bits of Freedom for hosting us!
3) Released Tor 0.2.4.8-alpha and 0.2.4.9-alpha:
4) Read and reviewed a paper from Ralf-Philipp Weinmann's research
group showing some cool new attacks on hidden services. More details
once we've helped them revise their paper for publication.
5) Helped discuss some (but not enough) SponsorF tasks for Karsten.

@_date: 2013-02-12 04:41:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Another Hidden Service question 
Yes -- your hidden service holds open circuits to its intro points,
and if it loses those circuits, it won't be able to hear about clients
who want to reach it.
I believe the current behavior is that when it loses those circuits,
it chooses new intro points and makes new circuits to them -- which
means anybody who has the old hidden service descriptor is going to be
introducing herself to the wrong intro points.
Sounds like the new feature you want is "if our intro circuits close, but
it was because our network failed and not because the intro points failed,
reestablish new intro circuits to the *old* intro points." The main tricky
point there is distinguishing "network failed" from "intro points failed".
If you want them to survive restarts of the Tor client, that's more
complex -- either Tor needs to cache its recent intro point choices to its
state file, or it needs to look up its own hidden service descriptor and
if it's recent enough, re-use those intro points. Both are kind of ugly.

@_date: 2013-02-21 19:23:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Where can I get Tor without the browser? 
Download the Tor Browser Bundle for OS X, unpack it, and use the Tor
binary that you find inside. (In Linux, it's in the App/ directory --
hopefully it's similar on OS X.)
That said, you should be aware of all the privacy fixes that Tor Browser
adds in over regular Firefox. There's a good chance you'll shoot yourself
in the foot if you do things differently.

@_date: 2013-01-10 14:31:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Dec 2012 
Six things I did in December 2012:
1) Attended the SponsorF PI meeting and demo. I did another 90 minute
talk for the research groups there, this time about the state of anonymity
research and traffic analysis attacks:
We also did a joint demo with several other research groups funded in
the same program. It went surprisingly smoothly.
2) Met with the Georgetown and NRL research teams about evaluating
Tor performance. Their next plan is to run their own Tor network in a
testbed, and log lots of things to get a handle on what performance data
is most useful to collect. Then we can work on privacy-preserving ways
of collecting exactly that data on the public Tor network, to learn how
the testbed compares to reality and to start identifying performance
bottlenecks in the deployed network.
3) Met with BBG to give them a status update on our task list, and on our
plans for funding exit relays. They are happy with our progress so far.
4) Met with Karsten to explain and elaborate on SponsorF Year3 Phase1
He's taking his notes and following up with each developer individually
to make sure all sides are communicating about what they expect.
5) Attended 29c3 in Hamburg, and did another joint talk with Jacob:
6) Released Tor 0.2.4.7-alpha:

@_date: 2013-01-14 17:41:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Project idea: TorBox 
First thought: we try not to mash the word 'Tor' together with generic
other words:
See e.g. a previous TorBOX:
I'm really nervous about the "transparently redirect the flow, whatever
it is, through Tor" model that everybody finds so intuitive.
See (and before that, for all the application-level ways that things can go wrong.
I think rather than transparent redirection, such devices will do better
putting up a captive portal to explain that you'd better go fetch a Tor
Browser Bundle and then it will work. I recognize there's a tradeoff
between safety and ease-of-use here, but I worry that "let them use IE
and feel that they're safe" is a really dangerous point on the line.
Sounds great. But why are the bundles not just running Tor themselves
and being done with it?
See the last bullet-point in my 29c3 trip report:

@_date: 2013-01-14 20:37:23
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.8-alpha is out 
Tor 0.2.4.8-alpha introduces directory guards to reduce user enumeration
risks, adds a new stronger and faster circuit handshake, and offers
stronger and faster link encryption when both sides support it.
Changes in version 0.2.4.8-alpha - 2013-01-14
  o Major features:
    - Preliminary support for directory guards (proposal 207): when
      possible, clients now use their entry guards for non-anonymous
      directory requests. This can help prevent client enumeration. Note
      that this behavior only works when we have a usable consensus
      directory, and when options about what to download are more or less
      standard. In the future we should re-bootstrap from our guards,
      rather than re-bootstrapping from the preconfigured list of
      directory sources that ships with Tor. Resolves ticket 6526.
    - Tor relays and clients now support a better CREATE/EXTEND cell
      format, allowing the sender to specify multiple address, identity,
      and handshake types. Implements Robert Ransom's proposal 200;
      closes ticket 7199.
  o Major features (new circuit handshake):
    - Tor now supports a new circuit extension handshake designed by Ian
      Goldberg, Douglas Stebila, and Berkant Ustaoglu. Our original
      circuit extension handshake, later called "TAP", was a bit slow
      (especially on the relay side), had a fragile security proof, and
      used weaker keys than we'd now prefer. The new circuit handshake
      uses Dan Bernstein's "curve25519" elliptic-curve Diffie-Hellman
      function, making it significantly more secure than the older
      handshake, and significantly faster. Tor can use one of two built-in
      pure-C curve25519-donna implementations by Adam Langley, or it
      can link against the "nacl" library for a tuned version if present.
      The built-in version is very fast for 64-bit systems when building
      with GCC. The built-in 32-bit version is still faster than the
      old TAP protocol, but using libnacl is better on most such hosts.
      Clients don't currently use this protocol by default, since
      comparatively few clients support it so far. To try it, set
      UseNTorHandshake to 1.
      Implements proposal 216; closes ticket 7202.
  o Major features (better link encryption):
    - Relays can now enable the ECDHE TLS ciphersuites when available
      and appropriate. These ciphersuites let us negotiate forward-secure
      TLS secret keys more safely and more efficiently than with our
      previous use of Diffie-Hellman modulo a 1024-bit prime. By default,
      public relays prefer the (faster) P224 group, and bridges prefer
      the (more common) P256 group; you can override this with the
      TLSECGroup option.
      Enabling these ciphers was a little tricky, since for a long time,
      clients had been claiming to support them without actually doing
      so, in order to foil fingerprinting. But with the client-side
      implementation of proposal 198 in 0.2.3.17-beta, clients can now
      match the ciphers from recent Firefox versions *and* list the
      ciphers they actually mean, so relays can believe such clients
      when they advertise ECDHE support in their TLS ClientHello messages.
      This feature requires clients running 0.2.3.17-beta or later,
      and requires both sides to be running OpenSSL 1.0.0 or later
      with ECC support. OpenSSL 1.0.1, with the compile-time option
      "enable-ec_nistp_64_gcc_128", is highly recommended.
      Implements the relay side of proposal 198; closes ticket 7200.
  o Major bugfixes:
    - Avoid crashing when, as a relay without IPv6-exit support, a
      client insists on getting an IPv6 address or nothing. Fixes bug
      7814; bugfix on 0.2.4.7-alpha.
  o Minor features:
    - Improve circuit build timeout handling for hidden services.
      In particular: adjust build timeouts more accurately depending
      upon the number of hop-RTTs that a particular circuit type
      undergoes. Additionally, launch intro circuits in parallel
      if they timeout, and take the first one to reply as valid.
    - Work correctly on Unix systems where EAGAIN and EWOULDBLOCK are
      separate error codes; or at least, don't break for that reason.
      Fixes bug 7935. Reported by "oftc_must_be_destroyed".
    - Update to the January 2 2013 Maxmind GeoLite Country database.
  o Minor features (testing):
    - Add benchmarks for DH (1024-bit multiplicative group) and ECDH
      (P-256) Diffie-Hellman handshakes to src/or/bench.
    - Add benchmark functions to test onion handshake performance.
  o Minor features (path bias detection):
    - Alter the Path Bias log messages to be more descriptive in terms
      of reporting timeouts and other statistics.
    - Create three levels of Path Bias log messages, as opposed to just
      two. These are configurable via consensus as well as via the torrc
      options PathBiasNoticeRate, PathBiasWarnRate, PathBiasExtremeRate.
      The default values are 0.70, 0.50, and 0.30 respectively.
    - Separate the log message levels from the decision to drop guards,
      which also is available via torrc option PathBiasDropGuards.
      PathBiasDropGuards still defaults to 0 (off).
    - Deprecate PathBiasDisableRate in favor of PathBiasDropGuards
      in combination with PathBiasExtremeRate.
    - Increase the default values for PathBiasScaleThreshold and
      PathBiasCircThreshold from (200, 20) to (300, 150).
    - Add in circuit usage accounting to path bias. If we try to use a
      built circuit but fail for any reason, it counts as path bias.
      Certain classes of circuits where the adversary gets to pick your
      destination node are exempt from this accounting. Usage accounting
      can be specifically disabled via consensus parameter or torrc.
    - Convert all internal path bias state to double-precision floating
      point, to avoid roundoff error and other issues.
    - Only record path bias information for circuits that have completed
      *two* hops. Assuming end-to-end tagging is the attack vector, this
      makes us more resilient to ambient circuit failure without any
      detection capability loss.
  o Minor bugfixes (log messages):
    - Rate-limit the "No circuits are opened. Relaxed timeout for a
      circuit with channel state open..." message to once per hour to
      keep it from filling the notice logs. Mitigates bug 7799 but does
      not fix the underlying cause. Bugfix on 0.2.4.7-alpha.
    - Avoid spurious warnings when configuring multiple client ports of
      which only some are nonlocal. Previously, we had claimed that some
      were nonlocal when in fact they weren't. Fixes bug 7836; bugfix on
      0.2.3.3-alpha.
  o Code simplifications and refactoring:
    - Get rid of a couple of harmless clang warnings, where we compared
      enums to ints. These warnings are newly introduced in clang 3.2.
    - Split the onion.c file into separate modules for the onion queue
      and the different handshakes it supports.
    - Remove the marshalling/unmarshalling code for sending requests to
      cpuworkers over a socket, and instead just send structs. The
      recipient will always be the same Tor binary as the sender, so
      any encoding is overkill.

@_date: 2013-01-15 16:02:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.9-alpha is out 
Tor 0.2.4.9-alpha provides a quick fix to make the new ntor handshake
work more robustly.
Changes in version 0.2.4.9-alpha - 2013-01-15
  o Major bugfixes:
    - Fix backward compatibility logic when receiving an embedded ntor
      handshake tunneled in a CREATE cell. This clears up the "Bug:
      couldn't format CREATED cell" warning. Fixes bug 7959; bugfix
      on 0.2.4.8-alpha.

@_date: 2013-01-15 20:56:12
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB as a deb (was Re: Tor 0.2.4.8-alpha is out) 
It sure would make things more convenient, I agree.
See for example
Basically there are a whole pile of logistical issues, stemming mainly
from the (quite reasonable) policies around how debs are allowed to
interact with each other.
So, it's something that a lot of smart Debian people have thought about,
and no clean-enough answer has emerged yet.
It is deeply unsatisfying to me that Linux, the platform most of our
developers use, is the one with the least user-friendly Tor package
support. But it will take a lot of juggling and coordination to produce
a solution that all sides find ok.

@_date: 2013-01-21 09:13:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor relay on small and cheap devices 
See also
where we're trying to work out enough measurement/evaluation/simulation
infrastructure to answer the question "If we drop all the relays with
capacity less than X, total network capacity goes down but speed goes
up. What does that look like for various values of X and various network
If you want to go even deeper into the research, check out these recent
tech reports that explore splitting circuits into multiple paths to take
better advantage of smaller relays:

@_date: 2013-07-02 17:35:53
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia error message with TorBirdy 
It sounds like your Thunderbird is attempting to access a destination
over Tor (probably your imap server) where the destination port is 143.
Port 143 is the default port for imap. Port 993 is the default port
for imaps.
Usually when you're using imap and not imaps, you don't use SSL. That
means somebody in between the exit relay and your destination (including
the exit relay itself) can watch you fetch your mail, read the mail,
log in after you and fetch some more of it, etc.
(I say "usually" and "default" in the above, since maybe you're actually
doing everything perfectly -- ports are just numbers and you can do
whatever you like over whatever port you like. But unless you know you're
safe, you probably aren't.)

@_date: 2013-07-03 00:04:19
@_author: Roger Dingledine 
@_subject: [tor-talk] Webpage autorefresh weakens onion routing 
Variations of this attack are in various research papers, e.g.
See also
Assuming he clicks 'new identity' in Torbutton, it will flush all his
browser state. There will be no more page X open.
Yep. That's why the Tor Browser doesn't allow this.
It's a tradeoff between usability and security. I think we'd end up
breaking a lot of pages if we disabled all refreshes.

@_date: 2013-07-03 14:05:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.15-rc is out 
Tor 0.2.4.15-rc is the first release candidate for the Tor 0.2.4.x
series. It fixes a few smaller bugs, but generally appears stable.
Please test it and let us know whether it is!
(Next step is clearly to get more user-usable bundles available with
this version, so actual users can actually test it. Coming soon I hope.)
Changes in version 0.2.4.15-rc - 2013-07-01
  o Major bugfixes:
    - When receiving a new configuration file via the control port's
      LOADCONF command, do not treat the defaults file as absent.
      Fixes bug 9122; bugfix on 0.2.3.9-alpha.
  o Minor features:
    - Issue a warning when running with the bufferevents backend enabled.
      It's still not stable, and people should know that they're likely
      to hit unexpected problems. Closes ticket 9147.

@_date: 2013-07-03 15:54:13
@_author: Roger Dingledine 
@_subject: [tor-talk] How intensely do you use Tor? 
Tor aims for a variety of anonymity properties:
1) Nobody watching your local network connection can learn where you're
2) Nobody watching your destination can learn where you're coming from.
2b) The destination can't learn where you're coming from.
3) No single relay in the path can link your location to your destination.
I think your phrase above is most like 2b above. But even then, while
paypal may know your physical address, why do they need to know that
you're vacationing in Italy this week? And why should somebody watching
Paypal's network connection get to learn that you're using Paypal right
now? And why should somebody watching *your* network connection (or the
company that your ISP sells all your clicklogs to [1]) learn that too?
That said, there *is* a reason to avoid using Tor for banking: a growing
number of banking websites use IP address to decide if you're really you,
and if you suddenly show up from Italy (whether on vacation or because
you're using Tor), they lock your account.
[1]

@_date: 2013-07-04 16:58:41
@_author: Roger Dingledine 
@_subject: [tor-talk] [Question] Making private Tor network 
Yes, that's correct. You need some directory authorities in your network,
in order to generate a consensus networkstatus document, so relays and
clients can know the list of relays in your network.
Relays don't just self-organize, because then it would be too easy for
attackers to trick clients into using the wrong relays:
We have a FAQ entry that used to explain what to do, but it is on the
wiki FAQ and I believe people have scribbled over it until it's no
longer useful.
Your best bet might be to fetch chutney:
and either look at how it constructs the directory authority torrc files,
or actually *use* chutney for your experiments.

@_date: 2013-07-05 17:45:04
@_author: Roger Dingledine 
@_subject: [tor-talk] TorWall - experimental transparent Tor proxy for 
Bastik pointed out the trademark thing:
But I'll take it a step farther to explain that there actually
already *is* a Torwall in the past:
which is an aborted little applet to turn on or off your firewall with
respect to allowing Tor. Hopefully that explains how easy the confusion
will be if you have a name like this.
Hm. These both seem like pretty big impediments. As intrigeri said, Tails
stopped doing the transparent proxy thing years ago, on the theory that
if the given application isn't specifically configured to use Tor, it's
probably going to screw up privacy-wise. Privoxy is really no substitute
for correctly anonymizing the application-level traffic.
(This is the same reason I'm wary of the "provide a wireless access point
that transparently Torifies traffic through it" ideas -- it seems like
those would be more safely done by giving the user a captive portal that
forces her to install TBB, and then only allows Tor traffic to a given
set of bridges / relays. But that's another topic.)
Back to this topic: is it intercepting outgoing port 80, or is it DPIing
on traffic flows to decide they're http? I would be nervous about both
of these in terms of the "corrupt plugin" you mention above.

@_date: 2013-07-06 07:23:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Should I warn against Tor? 
I don't want to tell you to stop worrying, but depending on how much
you think these intelligence agencies collaborate, I think the "and
de-anonymized" phrase might be overstated. For example, I would not be
surprised if French intelligence doesn't has enough of a reach on the
Internet to be able to break Tor easily -- simply because they haven't
made enough deals with enough backbone providers relative to the locations
of big Tor relays. Maybe they trade data with England and the US, but
then again maybe they don't (or don't trade all of it).
One of the unfortunate properties of the Internet is how it's much less
decentralized than we'd like (and than we used to think). But there are
still quite a few different places that you need to tap in order to have
a good chance of beating a Tor circuit. For background, you might like:
and there's a third paper in this chain of research which I'm hoping
the authors will make public soon -- stay tuned.
I think you're underestimating the problem here. You say "Part of my
traffic does not need to flow through big pipes and IXes but stays in
local, untapped regions of the Internet." I think for the typical web
user, basically _every single page they visit_ pulls in a component that
goes through these 'big pipes' you refer to.
In short, I think web users are in bad shape using Tor if their adversary
is "every intelligence agency combined", but they're in way way worse
shape when not using Tor.
While I'm at it -- you don't think Deutsche Telekom has a deal with
BND where they hand over all the internal German Internet traffic they
see? I hope the era where people say "My government is doing everything
that has been reported in the news so far, but surely they're not doing
anything else" is finally over, but I guess it will be a while yet.

@_date: 2013-07-13 16:19:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.15-rc is out -- please test! 
These packages are now up at
Please grab them and test them! If all goes well, we'll be calling the
Tor 0.2.4 branch stable very soon. So now is the perfect time to let us
know that it broke for you.
(To be clear, it is the Tor part of the Tor Browser Bundle that needs
testing. We know there are a growing pile of bugs in Vidalia, as well
as a set of issues in Torbutton. Both of these should improve with the
TBB 3.0 release. But that is a separate thread.)

@_date: 2013-07-13 17:53:28
@_author: Roger Dingledine 
@_subject: [tor-talk] Will Tor affect Internet Explorer? (newbie question) 
Not at all. Tor is a socks proxy, and Tor Browser Bundle is that plus
a Firefox fork which, if you use it correctly, can keep you safe when
you browse with it. If you have spyware installed, all bets are off.
Again, all bets are off if you have some other program messing with things
on your computer. Don't run dangerous things. And if you aren't sure
(roughly nobody is sure), consider running a livecd system like Tails.

@_date: 2013-07-13 20:39:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Will Tor affect Internet Explorer? (newbie question) 
It's great that there are so many new people learning about Tor these
days. But on the other hand, Tor (like security in general) is still
one of those things that takes some effort to learn about -- you have
to learn about a lot of other things while you're doing it.
I'd start with
and whenever you get stuck, ask Google, which will often send you to
Wikipedia for more details.
If you google for 'socks proxy', you'll find lots to read. See also
Happy learning! :)

@_date: 2013-07-14 00:25:37
@_author: Roger Dingledine 
@_subject: [tor-talk] Will Tor affect Internet Explorer? (newbie question) 
It occurs to me that I should clarify here. If you want to be a normal
Tor user, it's good to have a look through the above list, and try to
understand as much as you can. But you don't have to know what a socks
proxy is, or what it means to fork Firefox, in order to be a normal Tor
user. But in that case, you *do* need to just use Tor Browser Bundle or
Tails as-is. That's why we wrote them for you.
It's when you want to do non-standard things, like hook up another
browser to Tor, that you need to learn enough about what's going on to
realize why that's (usually) a bad idea.

@_date: 2013-07-16 14:14:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Would Conflux have a positive effect against website 
Good point -- I agree that it should help a lot against relay-level
(or in this case bridge-level) adversaries doing website fingerprinting
against the flows they see.
But it's far from clear to me that it will help much against an adversary
watching the user's network connection: in that case they get everything
they got before, if they just ignore which relay/bridge it's coming
To phrase that as a research question: what part of successful website
fingerprinting comes from looking at the sizes of the objects fetched,
and what part comes from looking at timing? If you can do an adequate job
at website fingerprinting just from how many bytes flow in each direction,
then Conflux won't change things much.
And I bet you *can* do an adequate job right now just with size. But I
also bet that it's easier to make changes to Tor to foil an attack that
uses just size. More research required, as they say.

@_date: 2013-07-18 20:19:22
@_author: Roger Dingledine 
@_subject: [tor-talk] NSA, Tempora, 
Probably not.
Your first question was "Can Tor defeat NSA, Tempora, PRISM?" and the
answer to that is also no.
This should be the point where you realize that it's complicated, and
you need to learn more about the issues.
You might start here:
which is the last time I answered this question here. There are a lot
of follow-ups with more details to discuss.
Hey, that looks like a pretty good website on first glance. Kudos to
whoever made it.
You might like
And you might also like
You're absolutely right that we should also take a few weeks to try to
explain Internet security to everybody. These days the questions that
everybody is asking change more often than that. Some of us are opting
to try to focus on making the technology keep up, rather than on making
the education component keep up.
Perhaps somebody here wants to draft a summary?

@_date: 2013-07-18 21:26:44
@_author: Roger Dingledine 
@_subject: [tor-talk] NSA, Tempora, 
Again, probably not?
They for sure do not have a deal with every ISP.
The question is whether they have enough deals with the *right* ISPs to
be able to see enough Tor traffic to have a good chance of breaking some
Tor circuits.
And that has to do with Internet topologies, politics and business deals,
the location of Tor relays relative to these, the paths between Tor
clients and relays, and the paths between Tor relays and your destination.
I think it's clear that these parameters produce bad news for some Tor
users, against an adversary this large. But not bad news for "every Tor
user every time they use Tor."

@_date: 2013-07-29 22:38:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Youtube becoming unusable 
It isn't this one, because we haven't done that yet.
For reference, moria1 is currently voting:
Jul 29 21:50:01.390 [info] dirserv_compute_performance_thresholds(): Cutoffs: For Stable, 746987 sec uptime, 1225459 sec MTBF. For Fast: 17 kilobytes/sec. For Guard: WFU 98.000%, time-known 691200 sec, and bandwidth 225 or 190 kilobytes/sec.

@_date: 2013-07-31 12:37:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Help wanted: bug when using a public relay as a bridge? 
Long ago we had a bug where your Tor client would crash or assert
if you configure a public relay to be your bridge:
We think we accidentally got rid of the problem when we switched to the
microdescriptor design in Tor 0.2.3.x.
I've asked Nick and Andrea to spend some more time tracking it down,
but to give us a sense of how important it is: a) do crashes happen
still? and b) how about when you use old-style descriptors rather than
So if you want to help us out,
1) Grab Tor 0.2.4.15-rc or later, and add some lines like
  UseBridges 1
  Bridge 128.31.0.34:9101
to your torrc.
(in this case you'd be adding my directory authority, moria1, as your
bridge. By all means feel free to pick another public relay instead.
If you experience connectivity problems, check to see if the relay you
picked is still up before reporting them).
In theory everything will work beautifully. If you get an assert error
or seg fault, we want to know! Add a comment to bug 1776, with details
like your Tor version.
2) If step one works without any problems, try adding
  UseMicrodescriptors 0
to your torrc as well as the above bridge lines. This will ask your
Tor client to go back to the original relay descriptor approach, which
we think might still trigger the bug. If you get an assert error or
seg fault, please let us know on bug 1776 (with details like your Tor

@_date: 2013-06-16 15:14:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.13-alpha is out 
Tor 0.2.4.13-alpha fixes a variety of potential remote crash
vulnerabilities, makes socks5 username/password circuit isolation
actually actually work (this time for sure!), and cleans up a bunch
of other issues in preparation for a release candidate.
Changes in version 0.2.4.13-alpha - 2013-06-14
  o Major bugfixes (robustness):
    - Close any circuit that has too many cells queued on it. Fixes
      bug 9063; bugfix on the 54th commit of Tor. This bug is a further
      fix beyond bug 6252, whose fix was merged into 0.2.3.21-rc.
    - Prevent the get_freelists() function from running off the end of
      the list of freelists if it somehow gets an unrecognized
      allocation. Fixes bug 8844; bugfix on 0.2.0.16-alpha. Reported by
      eugenis.
    - Avoid an assertion failure on OpenBSD (and perhaps other BSDs)
      when an exit connection with optimistic data succeeds immediately
      rather than returning EINPROGRESS. Fixes bug 9017; bugfix on
      0.2.3.1-alpha.
    - Fix a directory authority crash bug when building a consensus
      using an older consensus as its basis. Fixes bug 8833. Bugfix
      on 0.2.4.12-alpha.
  o Major bugfixes:
    - Avoid a memory leak where we would leak a consensus body when we
      find that a consensus which we couldn't previously verify due to
      missing certificates is now verifiable. Fixes bug 8719; bugfix
      on 0.2.0.10-alpha.
    - We used to always request authority certificates by identity digest,
      meaning we'd get the newest one even when we wanted one with a
      different signing key. Then we would complain about being given
      a certificate we already had, and never get the one we really
      wanted. Now we use the "fp-sk/" resource as well as the "fp/"
      resource to request the one we want. Fixes bug 5595; bugfix on
      0.2.0.8-alpha.
    - Follow the socks5 protocol when offering username/password
      authentication. The fix for bug 8117 exposed this bug, and it
      turns out real-world applications like Pidgin do care. Bugfix on
      0.2.3.2-alpha; fixes bug 8879.
    - Prevent failures on Windows Vista and later when rebuilding the
      microdescriptor cache. Diagnosed by Robert Ransom. Fixes bug 8822;
      bugfix on 0.2.4.12-alpha.
  o Minor bugfixes:
    - Fix an impossible buffer overrun in the AES unit tests. Fixes
      bug 8845; bugfix on 0.2.0.7-alpha. Found by eugenis.
    - If for some reason we fail to write a microdescriptor while
      rebuilding the cache, do not let the annotations from that
      microdescriptor linger in the cache file, and do not let the
      microdescriptor stay recorded as present in its old location.
      Fixes bug 9047; bugfix on 0.2.2.6-alpha.
    - Fix a memory leak that would occur whenever a configuration
      option changed. Fixes bug 8718; bugfix on 0.2.3.3-alpha.
    - Paste the description for PathBias parameters from the man
      page into or.h, so the code documents them too. Fixes bug 7982;
      bugfix on 0.2.3.17-beta and 0.2.4.8-alpha.
    - Relays now treat a changed IPv6 ORPort as sufficient reason to
      publish an updated descriptor. Fixes bug 6026; bugfix on
      0.2.4.1-alpha.
     - When launching a resolve request on behalf of an AF_UNIX control
       socket, omit the address field of the new entry connection, used in
       subsequent controller events, rather than letting tor_dup_addr()
       set it to "". Fixes bug 8639; bugfix on
       0.2.4.12-alpha.
  o Minor bugfixes (log messages):
    - Fix a scaling issue in the path bias accounting code that
      resulted in "Bug:" log messages from either
      pathbias_scale_close_rates() or pathbias_count_build_success().
      This represents a bugfix on a previous bugfix: the original fix
      attempted in 0.2.4.10-alpha was incomplete. Fixes bug 8235; bugfix
      on 0.2.4.1-alpha.
    - Give a less useless error message when the user asks for an IPv4
      address on an IPv6-only port, or vice versa. Fixes bug 8846; bugfix
      on 0.2.4.7-alpha.
  o Minor features:
    - Downgrade "unexpected SENDME" warnings to protocol-warn for 0.2.4.x,
      to tolerate bug 8093 for now.
    - Add an "ignoring-advertised-bws" boolean to the flag-threshold lines
      in directory authority votes to describe whether they have enough
      measured bandwidths to ignore advertised (relay descriptor)
      bandwidth claims. Resolves ticket 8711.
    - Update to the June 5 2013 Maxmind GeoLite Country database.
  o Removed documentation:
    - Remove some of the older contents of doc/ as obsolete; move others
      to torspec.git. Fixes bug 8965.
  o Code simplification and refactoring:
    - Avoid using character buffers when constructing most directory
      objects: this approach was unwieldy and error-prone. Instead,
      build smartlists of strings, and concatenate them when done.

@_date: 2013-03-05 03:36:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Fwd: Starting out: Project Coordinator 
That is certainly one of the challenging points. Once upon a time when
there was roughly 1 Tor developer, we put a priority on reviewing patches
from external folks -- since if you review it quickly enough, it makes
the volunteers create more patches, and everybody wins. Now that there
are n Tor developers though, there's always a choice between reading
the patch from the volunteer, and reading the patch from the paid
developer. Clearly the answer is "do both, they're both important!",
but that answer doesn't really work.
In summary, yes, finding better answers to this topic is one of the jobs
of our shiny new project coordinator (woo!).
We got one. Actually two.
If you run across more great Firefox hackers, we could in theory fund

@_date: 2013-03-05 05:53:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, Feb 2013 
Five things I did in February 2013:
1) Released Tor 0.2.4.10-alpha:
2) Explained the remaining items from SponsorF Year3 to Karsten:
3) Helped Nick Feamster write an NSF "major instrument" proposal,
to deploy a network of Internet "leaf" nodes that can give us better
Internet measurement results about network neutrality, performance,
censorship, etc from various edges of the Internet.
4) Blocked a Sybil attack on the Tor network. On Feb 4, researchers
signed up hundreds of Tor relays on Amazon, with the goal of becoming
all six hidden service directory points for hidden services. (Once they
control all six directory points, they still can't break the anonymity
of the hidden service, but they can censor it temporarily.) We've patched
the immediate protocol issues that allowed the attack:
but some of the broader design problems remain:
Fortunately, we know the research group. You'll be able to read more
details in their upcoming Oakland paper.
5) Attended the Yoko Ono Courage Award dinner, and met with the aide
to Ecuador's Foreign Minister. Ecuador is doing some really neat and
important things these days in terms of global freedom -- their plan
is that information freedom leads to peace, as opposed for example to
certain large countries that keep trying to escalate their military
reach. Internet freedom fits right into their goals. I expect a lot
of the world thinks that it's just a publicity stunt for them to offer
political asylum to Julian, but I think it's actually just one of the
many ways that they're showing they're serious about supporting global
freedom of information. They want to host a Tor dev meeting in Ecuador,
and use that to help establish more cooperation between Latin American
countries on the Internet Freedom topic. Sounds great to me.

@_date: 2013-03-06 04:53:05
@_author: Roger Dingledine 
@_subject: [tor-talk] How easy are Tor hidden services to locate? 
Hidden services are definitely weaker than regular Tor circuits, a)
because the adversary can induce them to speak, and b) because they stay
at the same place over time. Mostly 'a'.
That said, there are plenty of hidden services out there, and few
stories of people breaking their anonymity by breaking Tor. So they're
not foolproof for sure, but they're also not trivial to deanonymize.
I'll turn it around, and ask "easy compared to what?"
I wrote some suggestions on the second-to-last bullet point of
A lot of it depends on your expected adversary, and on how much you care.

@_date: 2013-03-06 17:13:23
@_author: Roger Dingledine 
@_subject: [tor-talk] How easy are Tor hidden services to locate? 
When you're a Tor client, you only use the Tor network when you choose
to access it (e.g. by trying to fetch a web page). So if the attacker has
some attack that works only a very small percentage of time, they have to
wait for you to initiate connections.
But for a hidden service, they can cause you to initiate a connection just
by visiting the hidden service. And they can do it as often as they want.
See  for the original paper about
this topic (and the reason we implemented entry guards).
And then see  for a more recent
example. The goal of that paper is to understand how long it takes in
normal operation (with entry guards going offline and being replaced)
before a typical user touches an adversary-controlled guard node. For
simplicity, the paper assumes that you use your guards every minute of
every day for however many weeks or months it takes. A realistic user
doesn't do that, so the paper overestimates the risk. But a realistic
hidden service *would* do that, if the adversary caused it to.

@_date: 2013-03-11 17:49:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.11-alpha is out 
Tor 0.2.4.11-alpha makes relay measurement by directory authorities
more robust, makes hidden service authentication work again, and
resolves a DPI fingerprint for Tor's SSL transport.
Changes in version 0.2.4.11-alpha - 2013-03-11
  o Major features (directory authorities):
    - Directory authorities now support a new consensus method (17)
      where they cap the published bandwidth of servers for which
      insufficient bandwidth measurements exist. Fixes part of bug 2286.
    - Directory authorities that set "DisableV2DirectoryInfo_ 1" no longer
      serve any v2 directory information. Now we can test disabling the
      old deprecated v2 directory format, and see whether doing so has
      any effect on network load. Begins to fix bug 6783.
    - Directory authorities now include inside each vote a statement of
      the performance thresholds they used when assigning flags.
      Implements ticket 8151.
  o Major bugfixes (directory authorities):
    - Stop marking every relay as having been down for one hour every
      time we restart a directory authority. These artificial downtimes
      were messing with our Stable and Guard flag calculations. Fixes
      bug 8218 (introduced by the fix for 1035). Bugfix on 0.2.2.23-alpha.
  o Major bugfixes (hidden services):
    - Allow hidden service authentication to succeed again. When we
      refactored the hidden service introduction code back
      in 0.2.4.1-alpha, we didn't update the code that checks
      whether authentication information is present, causing all
      authentication checks to return "false". Fix for bug 8207; bugfix
      on 0.2.4.1-alpha. Found by Coverity; this is CID 718615.
  o Minor features (relays, bridges):
    - Make bridge relays check once a minute for whether their IP
      address has changed, rather than only every 15 minutes. Resolves
      bugs 1913 and 1992.
    - Refactor resolve_my_address() so it returns the method by which we
      decided our public IP address (explicitly configured, resolved from
      explicit hostname, guessed from interfaces, learned by gethostname).
      Now we can provide more helpful log messages when a relay guesses
      its IP address incorrectly (e.g. due to unexpected lines in
      /etc/hosts). Resolves ticket 2267.
    - Teach bridge-using clients to avoid 0.2.2 bridges when making
      microdescriptor-related dir requests, and only fall back to normal
      descriptors if none of their bridges can handle microdescriptors
      (as opposed to the fix in ticket 4013, which caused them to fall
      back to normal descriptors if *any* of their bridges preferred
      them). Resolves ticket 4994.
    - Randomize the lifetime of our SSL link certificate, so censors can't
      use the static value for filtering Tor flows. Resolves ticket 8443;
      related to ticket 4014 which was included in 0.2.2.33.
  o Minor features (portability):
    - Tweak the curve25519-donna*.c implementations to tolerate systems
      that lack stdint.h. Fixes bug 3894; bugfix on 0.2.4.8-alpha.
    - Use Ville Laurikari's implementation of AX_CHECK_SIGN() to determine
      the signs of types during autoconf. This is better than our old
      approach, which didn't work when cross-compiling.
    - Detect the sign of enum values, rather than assuming that MSC is the
      only compiler where enum types are all signed. Fixes bug 7727;
      bugfix on 0.2.4.10-alpha.
  o Minor features (other):
    - Say "KBytes" rather than "KB" in the man page (for various values
      of K), to further reduce confusion about whether Tor counts in
      units of memory or fractions of units of memory. Resolves ticket 7054.
    - Clear the high bit on curve25519 public keys before passing them to
      our backend, in case we ever wind up using a backend that doesn't do
      so itself. If we used such a backend, and *didn't* clear the high bit,
      we could wind up in a situation where users with such backends would
      be distinguishable from users without. Fixes bug 8121; bugfix on
      0.2.4.8-alpha.
    - Update to the March 6 2013 Maxmind GeoLite Country database.
  o Minor bugfixes (clients):
    - When we receive a RELAY_END cell with the reason DONE, or with no
      reason, before receiving a RELAY_CONNECTED cell, report the SOCKS
      status as "connection refused". Previously we reported these cases
      as success but then immediately closed the connection. Fixes bug
      7902; bugfix on 0.1.0.1-rc. Reported by "oftc_must_be_destroyed".
    - Downgrade an assertion in connection_ap_expire_beginning to an
      LD_BUG message. The fix for bug 8024 should prevent this message
      from displaying, but just in case, a warn that we can diagnose
      is better than more assert crashes. Fixes bug 8065; bugfix on
      0.2.4.8-alpha.
    - Lower path use bias thresholds to .80 for notice and .60 for warn.
      Also make the rate limiting flags for the path use bias log messages
      independent from the original path bias flags. Fixes bug 8161;
      bugfix on 0.2.4.10-alpha.
  o Minor bugfixes (relays):
    - Stop trying to resolve our hostname so often (e.g. every time we
      think about doing a directory fetch). Now we reuse the cached
      answer in some cases. Fixes bugs 1992 (bugfix on 0.2.0.20-rc)
      and 2410 (bugfix on 0.1.2.2-alpha).
    - Stop sending a stray "(null)" in some cases for the server status
      "EXTERNAL_ADDRESS" controller event. Resolves bug 8200; bugfix
      on 0.1.2.6-alpha.
    - When choosing which stream on a formerly stalled circuit to wake
      first, make better use of the platform's weak RNG. Previously,
      we had been using the % ("modulo") operator to try to generate a
      1/N chance of picking each stream, but this behaves badly with
      many platforms' choice of weak RNG. Fixes bug 7801; bugfix on
      0.2.2.20-alpha.
    - Use our own weak RNG when we need a weak RNG. Windows's rand() and
      Irix's random() only return 15 bits; Solaris's random() returns more
      bits but its RAND_MAX says it only returns 15, and so on. Motivated
      by the fix for bug 7801; bugfix on 0.2.2.20-alpha.
  o Minor bugfixes (directory authorities):
    - Directory authorities now use less space when formatting identical
      microdescriptor lines in directory votes. Fixes bug 8158; bugfix
      on 0.2.4.1-alpha.
  o Minor bugfixes (memory leaks spotted by Coverity -- bug 7816):
    - Avoid leaking memory if we fail to compute a consensus signature
      or we generate a consensus we can't parse. Bugfix on 0.2.0.5-alpha.
    - Fix a memory leak when receiving headers from an HTTPS proxy. Bugfix
      on 0.2.1.1-alpha.
    - Fix a memory leak during safe-cookie controller authentication.
      Bugfix on 0.2.3.13-alpha.
    - Avoid memory leak of IPv6 policy content if we fail to format it into
      a router descriptor. Bugfix on 0.2.4.7-alpha.
  o Minor bugfixes (other code correctness issues):
    - Avoid a crash if we fail to generate an extrainfo descriptor.
      Fixes bug 8208; bugfix on 0.2.3.16-alpha. Found by Coverity;
      this is CID 718634.
    - When detecting the largest possible file descriptor (in order to
      close all file descriptors when launching a new program), actually
      use _SC_OPEN_MAX. The old code for doing this was very, very broken.
      Fixes bug 8209; bugfix on 0.2.3.1-alpha. Found by Coverity; this
      is CID 743383.
    - Fix a copy-and-paste error when adding a missing A1 to a routerset
      because of GeoIPExcludeUnknown. Fix for Coverity CID 980650.
      Bugfix on 0.2.4.10-alpha.
    - Fix an impossible-to-trigger integer overflow when estimating how
      long our onionskin queue would take. (This overflow would require us
      to accept 4 million onionskins before processing 100 of them.) Fixes
      bug 8210; bugfix on 0.2.4.10-alpha.
  o Code simplification and refactoring:
    - Add a wrapper function for the common "log a message with a
      rate-limit" case.

@_date: 2013-05-01 14:34:23
@_author: Roger Dingledine 
@_subject: [tor-talk] HTML5 video and Tor anonymity. 
Keep an eye on (and please contribute to!)
and its subtickets.

@_date: 2013-05-14 00:48:24
@_author: Roger Dingledine 
@_subject: [tor-talk] PETools workshop submissions due May 15 
PETools: Workshop on Privacy Enhancing Tools
July 9, 2013, Bloomington, Indiana, USA
Held in conjunction with PETS 2013
The goal of this workshop is to discuss the design of privacy tools
aimed at real-world deployments. This workshop will bring together
privacy practitioners and researchers with the aim to spark dialog and
collaboration between these communities.
Existing privacy enhancing tools range from web browser plugins to
specialized software, and are all aimed at empowering users to better
control their privacy. For widespread adoption and continued
effectiveness, however, these tools need to be made usable and be
continually refined and examined by researchers and developers. While
certain tools such as Tor have successfully received such attention,
this workshop seeks to stimulate such collaborative efforts for a
plethora of privacy enhancing tools and discuss the continued
evolution of privacy enhancing tools in the real world.
Topics of interest include researcher and developer efforts on
real-world tools related to:
* usability
* human factors
* privacy plugins and extensions
* encryption software
* email
* health
* advertising
* steganography
* anonymizers
* identity management
* social networking
* cloud computing and storage
* Internet telephony
* mobile and pervasive computing (e.g., smartphones and home
  automation)
* attacks on real-world PETools (aimed at improving these PETools)
* Anti-PETools (tools that attack privacy, spurring discussion on
  PETools to counter such Anti-PETools)
* and more
Important dates:
PETools submission deadline for abstracts: May 15, 2013, 23:59 UTC (8pm EDT)
PETools notification: June 5, 2013
PETools deadline for revised abstracts (for the online program): June 14, 2013
This workshop seeks submissions of two-page abstracts (excluding
bibliography and appendices; with 11pt font and reasonable margins) of
talks related to the improvement of privacy-enhancing tools aimed at
real-world deployments. Submissions should not be
anonymized. Submission types include:
* original scientific work
* preliminary research results
* recent results published elsewhere
* position papers
* research surveys
Submissions must be made in PDF format using EasyChair:
No proceedings:
The PETools Workshop has no official proceedings, and accepted
abstracts will not be included in the PETS proceedings. Since there
are no formal or archival proceedings, acceptance at this workshop
does not preclude publication at other venues. Accepted abstracts will
be made available online on this website to support discussion by the
workshop attendees.

@_date: 2013-11-02 05:49:57
@_author: Roger Dingledine 
@_subject: [tor-talk] A question about hidden services and tor in general 
Actually, technically, the analogy would be trying to deanonymize a
client from a subverted website.
The Tor client running the hidden service picks its own three hops,
so it's
HS -> Guard -> Middle -> Middle -> Rendpoint <- Middle <- Guard <- Client

@_date: 2013-11-10 00:29:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Request for "Tor, king of anonymity" graphic 
Hello graphics-inclined readers,
Among the October leaked slides:
was one from (I assume) GCHQ saying that Tor is "Still the King of high
secure, low latency Internet Anonymity" and that "There are no contenders
for the throne in waiting".
I periodically find myself doing presentations for law enforcement
and other government groups (like the NSA talk documented in the above
This clearly calls for a goofy mashup of a crown and the Tor onion, so
I can drive the point home in a memorable way.
Can somebody here mash them up in an attractive way?
For the Tor logo side, you might find something you like in
For any other component images, please use something
Creative-Commons-acceptable or similar. That way we can use it in the
future for, say, an April 1 Tor website too. ;)

@_date: 2013-11-13 21:38:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor for Opera? 
Even if it were to suddenly become open source, it would likely still be
a huge amount of work to deal with the application-level privacy issues.
So, not likely unless you or somebody does it and maintains it.

@_date: 2013-11-16 13:55:48
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.18-rc is out 
Tor 0.2.4.18-rc is the fourth release candidate for the Tor 0.2.4.x
series. It takes a variety of fixes from the 0.2.5.x branch to improve
stability, performance, and better handling of edge cases.
Changes in version 0.2.4.18-rc - 2013-11-16
  o Major features:
    - Re-enable TLS 1.1 and 1.2 when built with OpenSSL 1.0.1e or later.
      Resolves ticket 6055. (OpenSSL before 1.0.1 didn't have TLS 1.1 or
      1.2, and OpenSSL from 1.0.1 through 1.0.1d had bugs that prevented
      renegotiation from working with TLS 1.1 or 1.2, so we had disabled
      them to solve bug 6033.)
  o Major bugfixes:
    - No longer stop reading or writing on cpuworker connections when
      our rate limiting buckets go empty. Now we should handle circuit
      handshake requests more promptly. Resolves bug 9731.
    - If we are unable to save a microdescriptor to the journal, do not
      drop it from memory and then reattempt downloading it. Fixes bug
      9645; bugfix on 0.2.2.6-alpha.
    - Stop trying to bootstrap all our directory information from
      only our first guard. Discovered while fixing bug 9946; bugfix
      on 0.2.4.8-alpha.
    - The new channel code sometimes lost track of in-progress circuits,
      causing long-running clients to stop building new circuits. The
      fix is to always call circuit_n_chan_done(chan, 0) from
      channel_closed(). Fixes bug 9776; bugfix on 0.2.4.17-rc.
  o Minor bugfixes (on 0.2.4.x):
    - Correctly log long IPv6 exit policies, instead of truncating them
      or reporting an error. Fixes bug 9596; bugfix on 0.2.4.7-alpha.
    - Our default TLS ecdhe groups were backwards: we meant to be using
      P224 for relays (for performance win) and P256 for bridges (since
      it is more common in the wild). Instead we had it backwards. After
      reconsideration, we decided that the default should be P256 on all
      hosts, since its security is probably better, and since P224 is
      reportedly used quite little in the wild.  Found by "skruffy" on
      IRC. Fix for bug 9780; bugfix on 0.2.4.8-alpha.
    - Free directory authority certificate download statuses on exit
      rather than leaking them. Fixes bug 9644; bugfix on 0.2.4.13-alpha.
  o Minor bugfixes (on 0.2.3.x and earlier):
    - If the guard we choose first doesn't answer, we would try the
      second guard, but once we connected to the second guard we would
      abandon it and retry the first one, slowing down bootstrapping.
      The fix is to treat all our initially chosen guards as acceptable
      to use. Fixes bug 9946; bugfix on 0.1.1.11-alpha.
    - Fix an assertion failure that would occur when disabling the
      ORPort setting on a running Tor process while accounting was
      enabled. Fixes bug 6979; bugfix on 0.2.2.18-alpha.
    - When examining the list of network interfaces to find our address,
      do not consider non-running or disabled network interfaces. Fixes
      bug 9904; bugfix on 0.2.3.11-alpha. Patch from "hantwister".
    - Avoid an off-by-one error when checking buffer boundaries when
      formatting the exit status of a pluggable transport helper.
      This is probably not an exploitable bug, but better safe than
      sorry. Fixes bug 9928; bugfix on 0.2.3.18-rc. Bug found by
      Pedro Ribeiro.
  o Minor features (protecting client timestamps):
    - Clients no longer send timestamps in their NETINFO cells. These were
      not used for anything, and they provided one small way for clients
      to be distinguished from each other as they moved from network to
      network or behind NAT. Implements part of proposal 222.
    - Clients now round timestamps in INTRODUCE cells down to the nearest
      10 minutes. If a new Support022HiddenServices option is set to 0, or
      if it's set to "auto" and the feature is disabled in the consensus,
      the timestamp is sent as 0 instead. Implements part of proposal 222.
    - Stop sending timestamps in AUTHENTICATE cells. This is not such
      a big deal from a security point of view, but it achieves no actual
      good purpose, and isn't needed. Implements part of proposal 222.
    - Reduce down accuracy of timestamps in hidden service descriptors.
      Implements part of proposal 222.
  o Minor features (other):
    - Improve the circuit queue out-of-memory handler. Previously, when
      we ran low on memory, we'd close whichever circuits had the most
      queued cells. Now, we close those that have the *oldest* queued
      cells, on the theory that those are most responsible for us
      running low on memory. Based on analysis from a forthcoming paper
      by Jansen, Tschorsch, Johnson, and Scheuermann. Fixes bug 9093.
    - Generate bootstrapping status update events correctly when fetching
      microdescriptors. Fixes bug 9927.
    - Update to the October 2 2013 Maxmind GeoLite Country database.
  o Documentation fixes:
    - Clarify the usage and risks of setting the ContactInfo torrc line
      for your relay or bridge. Resolves ticket 9854.
    - Add anchors to the manpage so we can link to the html version of
      the documentation for specific options. Resolves ticket 9866.
    - Replace remaining references to DirServer in man page and
      log entries. Resolves ticket 10124.

@_date: 2013-11-17 17:25:49
@_author: Roger Dingledine 
@_subject: [tor-talk] How secure is check.torproject.org? 
Almost true. check.tp.o will no longer be the homepage (which also gives
a usability advantage on startup -- a local homepage will mean you're
not waiting for some outside page to load, and you're not doing it while
your Tor is bootstrapping its directory information, making things seem
even slower than they will be).
But TBB in the background will still fetch
to decide if you need to upgrade without telling anybody your version.
But that happens asynchronously, in the background, and doesn't need to
run javascript (at least, not externally fetched javascript).
So yes, the answer is that pretty soon the check website won't be the
bottleneck that it currently is.

@_date: 2013-11-17 17:31:24
@_author: Roger Dingledine 
@_subject: [tor-talk] New to TOR 
This last part is probably unwise. If you start messing with the Firefox
preferences, especially the proxy preferences, of your Tor Browser you're
likely to screw up your privacy in some way.
If there are sites you don't want to visit over Tor, use some other
browser besides TBB to do it.

@_date: 2013-11-17 23:31:03
@_author: Roger Dingledine 
@_subject: [tor-talk] A great way for you to help Tor: track down recent press 
It would be wonderful if somebody here could step up and held lead
Here's the text of the ticket:
"According to  the last time
there was a meaningful article about Tor was July 1. This is very far
from the case.
This is a great opportunity to crowd-source from our community and get
some newer articles listed.
Can one of our volunteers take point on this and set up a wiki page and
start tracking down articles? I think getting a good list from the past
6 months is the challenging part, and then getting that list onto the
web page will be the easy part.
(I also encourage Tor Weekly News to start listing interesting press
articles so it's easier to build the list in the future. I guess that
means some mechanism for the TWN authors to notice them.)

@_date: 2013-11-19 12:56:28
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB - Tor Browser didn't take keyboard input 
Try (I'm not clear on whether this is a Tor Browser bug or an ibus bug.)

@_date: 2013-11-23 00:20:31
@_author: Roger Dingledine 
@_subject: [tor-talk] How secure is check.torproject.org? 
Not necessarily. Imagine a local network attacker who sees your request
for a .onion address go out on the local network, and then supplies you
with a DNS answer and then a webpage when you ask for one. Now you're
not using Tor, but you think you are.
Now, it's harder for them to do that with because of the https part, but the attacker could just recognize requests
for check and route them through Tor, so the check page will congratulate
you on using Tor when you're mostly not.
The correct answer is for TBB to do some self-tests of its proxy settings,
and not ask the big bad scary internet.

@_date: 2013-11-23 00:25:02
@_author: Roger Dingledine 
@_subject: [tor-talk] StrictExitNodes deprecated? 
EntryNode $9695DFC35FFEB861329B9F1AB04C46397020CE31
ExitNode $073F27934762FF8BA956FFCE136AAC1CCF45EA13

@_date: 2013-11-23 03:16:29
@_author: Roger Dingledine 
@_subject: [tor-talk] StrictExitNodes deprecated? 
No, you should not use StrictNodes with EntryNodes or ExitNodes. It
won't do anything (except confuse you I guess).
This is likely still true.

@_date: 2013-11-23 04:09:20
@_author: Roger Dingledine 
@_subject: [tor-talk] How secure is check.torproject.org? 
If we're talking about TBB and it's working correctly, then there's no
need to check if it's working correctly, right? :)
Check.tp.o is from a time before TBB was standard, when users were trying
to muck with their proxy settings, install an extension, or otherwise
make their Tor work.
If you trusted the old check, you should trust the new about:tor page
in TBB 3 at least as much. It's more accurate, and it loads quicker too.
As for having a network map for TBB 3, I agree in theory. But somebody
needs to actually do it. Promising routes include writing it into Tor
Launcher (harder to do, but easier to maintain and probably safer)
or writing instructions for how best to attach your (old, eventually
obsolete) Vidalia to your shiny new TBB 3.

@_date: 2013-11-28 05:26:06
@_author: Roger Dingledine 
@_subject: [tor-talk] Why Crimekit Atrax will attract attention 
That said, not all ddos attacks involve just simple flooding with
traffic. Some of the attacks described on your url use very little
traffic, e.g. instead relying on clogging up the cpu of the target
machine by asking it to provide complex answers.
The right answer to those attacks is "then don't design your services
that way", but for many currently deployed services that's a long-term
dream, not a short-term fix.
*That* said, I would expect bots in this situation to use Tor for C&C,
and do the distributed attacks directly. It's pretty silly to do a
"distributed" attack from 5000 places but then funnel it all into Tor.
Or said more clearly, if you have a botnet, use it -- you don't need Tor.

@_date: 2013-10-02 13:28:40
@_author: Roger Dingledine 
@_subject: [tor-talk] A new check 
Right. Actually, you might look at the TBB 3.x homepage, and see if
you like any of the other components it has -- e.g. the "What Next?"
or the "You Can Help!" sections.
Or said another way, do not make the mistake of thinking that the current
check.torproject.org page is perfect in any way. :)

@_date: 2013-10-02 15:25:23
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.5.1-alpha is out 
Tor 0.2.5.1-alpha introduces experimental support for syscall sandboxing
on Linux, allows bridges that offer pluggable transports to report usage
statistics, fixes many issues to make testing easier, and provides
a pile of minor features and bugfixes that have been waiting for a
release of the new branch.
This is the first alpha release in a new series, so expect there to
be bugs. Users who would rather test out a more stable branch should
stay with 0.2.4.x for now.
I'm going to leave the download pages listing 0.2.3.x and 0.2.4.x,
so we don't have the confusion of three branches at once. I'm also not
sure yet how the packaging people plan to handle three branches.
Changes in version 0.2.5.1-alpha - 2013-10-02
  o Major features (security):
    - Use the seccomp2 syscall filtering facility on Linux to limit
      which system calls Tor can invoke. This is an experimental,
      Linux-only feature to provide defense-in-depth against unknown
      attacks. To try turning it on, set "Sandbox 1" in your torrc
      file. Please be ready to report bugs. We hope to add support
      for better sandboxing in the future, including more fine-grained
      filters, better division of responsibility, and support for more
      platforms. This work has been done by Cristian-Matei Toader for
      Google Summer of Code.
    - Re-enable TLS 1.1 and 1.2 when built with OpenSSL 1.0.1e or later.
      Resolves ticket 6055. (OpenSSL before 1.0.1 didn't have TLS 1.1 or
      1.2, and OpenSSL from 1.0.1 through 1.0.1d had bugs that prevented
      renegotiation from working with TLS 1.1 or 1.2, so we had disabled
      them to solve bug 6033.)
  o Major features (other):
    - Add support for passing arguments to managed pluggable transport
      proxies. Implements ticket 3594.
    - Bridges now track GeoIP information and the number of their users
      even when pluggable transports are in use, and report usage
      statistics in their extra-info descriptors. Resolves tickets 4773
      and 5040.
    - Make testing Tor networks bootstrap better: lower directory fetch
      retry schedules and maximum interval without directory requests,
      and raise maximum download tries. Implements ticket 6752.
    - Add make target 'test-network' to run tests on a Chutney network.
      Implements ticket 8530.
    - The ntor handshake is now on-by-default, no matter what the
      directory authorities recommend. Implements ticket 8561.
  o Major bugfixes:
    - Instead of writing destroy cells directly to outgoing connection
      buffers, queue them and intersperse them with other outgoing cells.
      This can prevent a set of resource starvation conditions where too
      many pending destroy cells prevent data cells from actually getting
      delivered. Reported by "oftc_must_be_destroyed". Fixes bug 7912;
      bugfix on 0.2.0.1-alpha.
    - If we are unable to save a microdescriptor to the journal, do not
      drop it from memory and then reattempt downloading it. Fixes bug
      9645; bugfix on 0.2.2.6-alpha.
    - The new channel code sometimes lost track of in-progress circuits,
      causing long-running clients to stop building new circuits. The
      fix is to always call circuit_n_chan_done(chan, 0) from
      channel_closed(). Fixes bug 9776; bugfix on 0.2.4.17-rc.
  o Build features:
    - Tor now builds each source file in two modes: a mode that avoids
      exposing identifiers needlessly, and another mode that exposes
      more identifiers for testing. This lets the compiler do better at
      optimizing the production code, while enabling us to take more
      radical measures to let the unit tests test things.
    - The production builds no longer include functions used only in
      the unit tests; all functions exposed from a module only for
      unit-testing are now static in production builds.
    - Add an --enable-coverage configuration option to make the unit
      tests (and a new src/or/tor-cov target) to build with gcov test
      coverage support.
  o Testing:
    - We now have rudimentary function mocking support that our unit
      tests can use to test functions in isolation. Function mocking
      lets the tests temporarily replace a function's dependencies with
      stub functions, so that the tests can check the function without
      invoking the other functions it calls.
    - Add more unit tests for the ->circuit map, and
      the destroy-cell-tracking code to fix bug 7912.
    - Unit tests for failing cases of the TAP onion handshake.
    - More unit tests for address-manipulation functions.
  o Minor features (protecting client timestamps):
    - Clients no longer send timestamps in their NETINFO cells. These were
      not used for anything, and they provided one small way for clients
      to be distinguished from each other as they moved from network to
      network or behind NAT. Implements part of proposal 222.
    - Clients now round timestamps in INTRODUCE cells down to the nearest
      10 minutes. If a new Support022HiddenServices option is set to 0, or
      if it's set to "auto" and the feature is disabled in the consensus,
      the timestamp is sent as 0 instead. Implements part of proposal 222.
    - Stop sending timestamps in AUTHENTICATE cells. This is not such
      a big deal from a security point of view, but it achieves no actual
      good purpose, and isn't needed. Implements part of proposal 222.
    - Reduce down accuracy of timestamps in hidden service descriptors.
      Implements part of proposal 222.
  o Minor features (config options):
    - Config (torrc) lines now handle fingerprints which are missing
      their initial '$'. Resolves ticket 4341; improvement over 0.0.9pre5.
    - Support a --dump-config option to print some or all of the
      configured options. Mainly useful for debugging the command-line
      option parsing code. Helps resolve ticket 4647.
    - Raise awareness of safer logging: notify user of potentially
      unsafe config options, like logging more verbosely than severity
      "notice" or setting SafeLogging to 0. Resolves ticket 5584.
    - Add a new configuration option TestingV3AuthVotingStartOffset
      that bootstraps a network faster by changing the timing for
      consensus votes. Addresses ticket 8532.
    - Add a new torrc option "ServerTransportOptions" that allows
      bridge operators to pass configuration parameters to their
      pluggable transports. Resolves ticket 8929.
    - The config (torrc) file now accepts bandwidth and space limits in
      bits as well as bytes. (Anywhere that you can say "2 Kilobytes",
      you can now say "16 kilobits", and so on.) Resolves ticket 9214.
      Patch by CharlieB.
  o Minor features (build):
    - Add support for `--library-versions` flag. Implements ticket 6384.
    - Return the "unexpected sendme" warnings to a warn severity, but make
      them rate limited, to help diagnose ticket 8093.
    - Detect a missing asciidoc, and warn the user about it, during
      configure rather than at build time. Fixes issue 6506. Patch from
      Arlo Breault.
  o Minor features (other):
    - Use the SOCK_NONBLOCK socket type, if supported, to open nonblocking
      sockets in a single system call. Implements ticket 5129.
    - Log current accounting state (bytes sent and received + remaining
      time for the current accounting period) in the relay's heartbeat
      message. Implements ticket 5526; patch from Peter Retzlaff.
    - Implement the TRANSPORT_LAUNCHED control port event that
      notifies controllers about new launched pluggable
      transports. Resolves ticket 5609.
    - If we're using the pure-C 32-bit curve25519_donna implementation
      of curve25519, build it with the -fomit-frame-pointer option to
      make it go faster on register-starved hosts. This improves our
      handshake performance by about 6% on i386 hosts without nacl.
      Closes ticket 8109.
    - Update to the September 4 2013 Maxmind GeoLite Country database.
  o Minor bugfixes:
    - Set the listen() backlog limit to the largest actually supported
      on the system, not to the value in a header file. Fixes bug 9716;
      bugfix on every released Tor.
    - No longer accept malformed http headers when parsing urls from
      headers. Now we reply with Bad Request ("400"). Fixes bug 2767;
      bugfix on 0.0.6pre1.
    - In munge_extrainfo_into_routerinfo(), check the return value of
      memchr(). This would have been a serious issue if we ever passed
      it a non-extrainfo. Fixes bug 8791; bugfix on 0.2.0.6-alpha. Patch
      from Arlo Breault.
    - On the chance that somebody manages to build Tor on a
      platform where time_t is unsigned, correct the way that
      microdesc_add_to_cache() handles negative time arguments.
      Fixes bug 8042; bugfix on 0.2.3.1-alpha.
    - Reject relative control socket paths and emit a warning. Previously,
      single-component control socket paths would be rejected, but Tor
      would not log why it could not validate the config. Fixes bug 9258;
      bugfix on 0.2.3.16-alpha.
  o Minor bugfixes (command line):
    - Use a single command-line parser for parsing torrc options on the
      command line and for finding special command-line options to avoid
      inconsistent behavior for torrc option arguments that have the same
      names as command-line options. Fixes bugs 4647 and 9578; bugfix on
      0.0.9pre5.
    - No longer allow 'tor --hash-password' with no arguments. Fixes bug
      9573; bugfix on 0.0.9pre5.
  o Minor fixes (build, auxiliary programs):
    - Stop preprocessing the "torify" script with autoconf, since
      it no longer refers to LOCALSTATEDIR. Fixes bug 5505; patch
      from Guilhem.
    - The tor-fw-helper program now follows the standard convention and
      exits with status code "0" on success. Fixes bug 9030; bugfix on
      0.2.3.1-alpha. Patch by Arlo Breault.
    - Corrected ./configure advice for what openssl dev package you should
      install on Debian. Fixes bug 9207; bugfix on 0.2.0.1-alpha.
  o Minor code improvements:
    - Remove constants and tests for PKCS1 padding; it's insecure and
      shouldn't be used for anything new. Fixes bug 8792; patch
      from Arlo Breault.
    - Remove instances of strcpy() from the unit tests. They weren't
      hurting anything, since they were only in the unit tests, but it's
      embarassing to have strcpy() in the code at all, and some analysis
      tools don't like it. Fixes bug 8790; bugfix on 0.2.3.6-alpha and
      0.2.3.8-alpha. Patch from Arlo Breault.
  o Removed features:
    - Remove migration code from when we renamed the "cached-routers"
      file to "cached-descriptors" back in 0.2.0.8-alpha. This
      incidentally resolves ticket 6502 by cleaning up the related code
      a bit. Patch from Akshay Hebbar.
  o Code simplification and refactoring:
    - Extract the common duplicated code for creating a subdirectory
      of the data directory and writing to a file in it. Fixes ticket
      4282; patch from Peter Retzlaff.
    - Since OpenSSL 0.9.7, the i2d_*() functions support allocating output
      buffer. Avoid calling twice: i2d_RSAPublicKey(), i2d_DHparams(),
      i2d_X509(), and i2d_PublicKey(). Resolves ticket 5170.
    - Add a set of accessor functions for the circuit timeout data
      structure. Fixes ticket 6153; patch from "piet".
    - Clean up exit paths from connection_listener_new(). Closes ticket
      8789. Patch from Arlo Breault.
    - Since we rely on OpenSSL 0.9.8 now, we can use EVP_PKEY_cmp()
      and drop our own custom pkey_eq() implementation. Fixes bug 9043.
    - Use a doubly-linked list to implement the global circuit list.
      Resolves ticket 9108. Patch from Marek Majkowski.
    - Remove contrib/id_to_fp.c since it wasn't used anywhere.

@_date: 2013-10-02 22:07:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
We just put up a statement on the blog which basically says that:

@_date: 2013-10-02 23:58:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
Our various Tor talks have long tried to explain that Tor doesn't
magically make "old-fashioned police work" obsolete, e.g.
"But remember that this doesn't mean that Tor is invulnerable. Traditional
police techniques can still be very effective against Tor, such as
investigating means, motive, and opportunity, interviewing suspects,
writing style analysis, technical analysis of the content itself, sting
operations, keyboard taps, and other physical investigations. The Tor
Project is also happy to work with everyone including law enforcement
groups to train them how to use the Tor software to safely conduct
investigations or anonymized activities online."
Too many police groups I've talked to just expect to have a newfangled
technology thing where you push a button and out pops the name of your
criminal. They all want it and it really screws up policy when they ask
for it, since when legislators hear it they also think it's a great idea.

@_date: 2013-10-03 18:24:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
This is a fine research paper attack:
and a good reason not to run your hidden service on your Tor relay,
but I think it's highly unlikely to have been relevant in this case.
That said, yes, the original question is unanswered still.

@_date: 2013-10-03 18:31:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
They're wondering about the botnet activity in late August, when all
the dates in the takedown pdf are in July?
I guess their conspiracy theory would go something like "those FBI people
lied about everything in their affidavit, and made up a smear campaign
about bad opsec to hide their actual attack"?
And at the same time, nobody who's said "I wonder if that botnet activity
is an anonymity attack of some sort" has provided any details on how
so many users might be needed to attack anonymity?
I think it's pretty clear by now that the August / September growth is
from a botnet. That plus the fact that nobody has described how "add
millions of users" is a required step for an anonymity-breaking attack,
plus the fact that the FBI would really have shot themselves in the foot
by lying so much (unless of course the pdf that everybody's reading is
a fake and a distraction -- down the rabbit hole we go!), makes me think
whoever wrote that article didn't do much of their homework.

@_date: 2013-10-03 18:54:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
Careful there -- while I assume they didn't lie in their affidavit, it's
quite reasonable to assume that they investigated all sorts of things,
all sorts of ways, and then afterwards chose to write down exactly the
set of facts that when lined up in the correct order makes it look like
a clean solid case.
It's a slippery slope from there to 'parallel construction', but I think
it's standard practice to start with some leads and use them to find
more solid facts, and it's also standard practice to not mention all
your leads in your affidavit.
To be more concrete, their job here is to link the guy to the website.
So if they had a pretty good idea of who the guy was, but not enough
evidence to bust him, it makes sense to me that they would go find one
of the servers, collect all the evidence they can from it, and hope
to find something specific that points back at the guy. And who knows,
maybe they did that several times before they found something they liked
enough to build a case from it.
Your theory that "he was sold out by one of his administrators" also
fits fine here -- the administrators pointed to the guy but then they
needed to build a solid-looking case.
Why? So everybody can abandon that VPN and move to a different one that
also responds to subpoenas but hasn't been written about in a high-profile
court case yet? :)

@_date: 2013-10-03 22:21:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Silk Road taken down by FBI 
Can you point to a specific statement in the affidavit that would be a
lie if the "NSA conspires to tip off FBI" theory were true?
Remember, the job of the guy writing the document is to lay out a set
of correct facts which together show clear evidence that he's a criminal.
Or to say it differently, it's his job to figure out the right way
(including the right order, and the right subset) of presenting his
facts so they make his case the best way he can.
And he's under no obligation to include all of the facts -- just the
ones that make his case most likely to win.
I'm not saying that this version of the conspiracy did or didn't happen
this way. You're right that "look, he screwed up enough different ways,
why do you need a more complicated theory?" is a convincing argument.
But if it *did* happen, there's no reason for them to have to lie --
they could have (should have) just gone and done all the things they
say they did, to be able to write a winning case.

@_date: 2013-10-04 11:38:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Guardian Tor article 
Just to start off the new media frenzy thread.
(Did I miss any good links?)

@_date: 2013-10-07 18:27:15
@_author: Roger Dingledine 
@_subject: [tor-talk] still unable to reach StartPage or Ixquick 
Tor 0.2.3.x is not so fun to use these days:
I recommend trying the TBB 3.0a4 (assuming you're not on Win XP and you
don't need pluggable transports):
We'll hopefully declare Tor 0.2.4.x stable real soon now. We keep getting
distracted though. Soon I hope! :)

@_date: 2013-10-15 17:16:57
@_author: Roger Dingledine 
@_subject: [tor-talk] funnel many computers through one TBB? 
Right, I agree with Moritz's answer.
Anything else is going to basically ruin the application-level privacy
for all the users -- see
 for all the things
Tor Browser does for you.
Putting a single Tor up somewhere and routing all traffic through it is
appealing, but a) it's not going to get you any of the things that Tor
Browser provides, b) you will have the problems people discussed with
mixing traffic from multiple users onto the same circuit, and c) you're
going to have a real mess if any of your users want to use Tor the *right*
way (by running it on their computer), since either you'll need to Torify
their Tor traffic (making it more than twice as slow, and it's also
a configuration we're going to disallow soon due to various anonymity
attacks) or disallow using Tor in the recommended safe configuration
(also bad).
And if the above paragraph sounded confusing to you, that's an extra
reason to use TBB in its recommended configuration. :)

@_date: 2013-10-17 02:47:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, September/October 2013 
Six things I did in September/October 2013:
1) Released Tor 0.2.4.17-rc:
including writing the fix to prioritize NTor handshakes so Tor 0.2.4.x
remains usable despite the five million new bot users:
Released Tor 0.2.5.1-alpha:
2) Wrote many blog posts:
with a follow-up summary at
and also answered hundreds of blog comments / questions.
3) Talked to many many journalists to explain Tor and the Internet.
My most useful quotes went to Bruce Schneier:
and Brian Fung:
and Dan Goodin:
4) Helped the Tor Stack Exchange beta get off the ground:
I zipped up to 1000+ reputation from answering questions in the first
few days, but then I disappeared because I was distracted by other work.
Hopefully other people have filled in the gap.
5) Helped sort out the 2013 Q4 budget, and also get the new SponsorO
projects off the ground:
6) Attended the SponsorF "red team assessment" where they funded some
smart DPI developers to evaluate and try to break Obfsproxy and Flash
Proxy. So far so good -- one of the outcomes is that we should set up
a performance testbed for Flash Proxy to see if we can replicate their
"sometimes when I upload a bunch of stuff it takes a long time" behavior.
I plan to talk to Arlo, once I'm back online, about doing that.

@_date: 2013-10-22 13:39:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Fwd: Can You Trust NIST? 
See the previous version of this thread (with more answers)
I recommend reading the rest of Nick Mathewson's posts on that page too.

@_date: 2013-10-25 15:04:02
@_author: Roger Dingledine 
@_subject: [tor-talk] New to list and questions about exit nodes 
Just so somebody's said it: there's a good chance that the machine
wasn't compromised. There are some jerks out there who use Tor to send
application-level traffic to webservers that tries to break into the
webserver. Somebody watching the webserver (or watching its network)
will notice the attack -- but since most attacks these days come through
compromised computers that are used as 'stepping stones', the mail that
the website operator sends won't say "stop attacking me!", but rather
it will say "your computer appears to be compromised." They don't have
any idea that it's running a Tor exit relay (and in many cases they have
no idea that something like Tor exists).
Then it's easy for the Tor relay operator to say "oh crap somebody on
the Internet told me my computer is compromised." (And to be fair, it's
hard for them to convince themselves that it's not true, so his response
in this case of "let's wipe it to be sure" was not unreasonable.)
See also

@_date: 2013-10-25 15:09:24
@_author: Roger Dingledine 
@_subject: [tor-talk] TOR network topology 
You might like You might also like That leaves you with the trivial graph: the Tor overlay network is
a clique.
What are you actually trying to learn?

@_date: 2013-10-25 16:25:42
@_author: Roger Dingledine 
@_subject: [tor-talk] tor browser bundle uninstalled 
Totally depends what extension you tried to install. Many of them will
screw things up (either functionality or privacy).
Feel free, but be aware that you're screwing up most of your privacy
properties. Read through
and then
and then
and ask yourself if you're certain you don't need any of that stuff.
As an alternative, you might give TBB 3.0alpha a try:

@_date: 2013-10-25 17:38:16
@_author: Roger Dingledine 
@_subject: [tor-talk] tor available for the iphone 5? 
Speaking of Onion Browser, it looks like it went open source a year or
so back when we weren't looking. That's great! (Is it really all wholly
open source now?)
Nathan, have you done anything to draw the Onion Browser
developer/development into our broader community?
Has anybody highlighted the parts of it that need auditing the most?
Is it worth building on? Are there plans to improve on the
application-level privacy, a la Tor Browser? More generally, what can
we do to make the Onion Browser guy into the (or at least a) Guardian
iOS Tor maintainer/developer?

@_date: 2013-10-25 20:33:26
@_author: Roger Dingledine 
@_subject: [tor-talk] New to list and questions about exit nodes 
"good hearted not network savvy" sounds like they'll enjoy being
non-exit relays much more.

@_date: 2013-10-27 18:41:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Thoughts on Tor-based social networking? 
Hi Bill,
Check out
including my response at the end
for the latest version of this answer.
As for "Tor based secret identities that can accrue reputation",
check out Nymble:
(and there are several other research groups with similar ideas).
But nobody has deployed a Nymble-like service in a usable way, and also
it's not clear that it would solve the types of problems you describe.

@_date: 2013-08-31 20:36:11
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and Financial Transparency 
Oh hey, funny you should mention that. We have an NSF grant, joint with
Georgia Tech and Princeton, to work on measuring censorship, evaluating
censorship circumvention approaches, and general work in the Internet
censorship area:
It's $750k split over 4 years, so it's not as much as the darpa grant,
but hopefully will still help diversify a little bit (I say a little bit
because it's still US government funding, just from a different piece).
And if all goes well we'll soon be a subcontractor for Nick Hopper's
research lab at University of Minnesota, to help him work on
privacy-preserving ways to measure Tor user and user behavior. These
measurements will especially help researchers who do performance,
scalability, and anonymity analysis on Tor to have a more accurate
model of user behavior -- which would have been especially useful in
e.g. "Methodically Modeling the Tor Network":
In the past, you could have read about these two grants in

@_date: 2013-08-31 23:45:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Many more Tor users in the past week? 
This data comes from "extrainfo" descriptors published by relays.
You can see them all at Or said more clearly, The Tor Project does not have any logs, so the
logs we don't have don't have IP addresses. :)
You might find interesting for a discussion of the sorts of data the relays collect
and why we think it's safe / worthwhile.
And you might like for the write-ups we've done about various ways to try to count
users despite not having much info about anything.

@_date: 2013-09-01 22:10:56
@_author: Roger Dingledine 
@_subject: [tor-talk] New paper : Users Get Routed: Traffic Correlation on 
Yep. They're part of the Tor research community. I have plans for writing
a blog post about the paper, to explain what it means, what it doesn't
mean, what we should do about it, and what research questions remain
open. Stuff keeps catching fire with bigger flames though.
The extremely short answer is "Yes, a big enough adversary can screw Tor
users. But we knew that. I think it's great that the paper presents the
dual risks of relay adversaries and link adversaries, since most of the
time when people are freaking out about one of them they're forgetting the
other one. And we really should raise the guard rotation period. If you
do their compromise graphs again with guards rotated every nine months,
they look way different."

@_date: 2013-09-03 03:46:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, August 2013 
Six things I did in August 2013:
1) Wrote a security advisory for the "Old Tor Browser Bundles
vulnerable" issue:
and then posted it to the blog and helped to manage the confusion there
(700+ comments!)
2) Attended FOCI and Usenix Security:
I mainly talked with grad students to help them understand Tor better
and focus more usefully on research questions. I also did a rump session
talk to summarize five "performance improvement" research directions
that look worth exploring.
3) Helped Karen, Nick, and Mike write a DRL funding proposal for more
core development and maintenance. If it works, this will be a two-year
grant to help with 1) turning more of the academic research prototype
pluggable transport designs into something clean that we can actually
give users; 2) better testing for the core "tor" program, including unit
tests, refactoring, and better use of our full network testing harness
named Chutney; and 3) build automation and a start at QA automation,
so we can have nightlies of everything, start automatically checking
for regressions, etc.
4) Released Tor 0.2.4.16-rc:
5) Helped Kelley and Mike write an RFA funding proposal to move TBB
3.0 development forward for the next year -- 1) identify and resolve
privacy and security issues in Firefox that impact TBB users, especially
with respect to the two upcoming new Firefox releases; 2) improve the
usability and functionality of the Firefox extensions that we include
with TBB; and 3) finish and extend our "reproducible build" design that
allows users to gain confidence that TBB includes exactly and only the
components we meant it to include.
6) Started to deal with the huge growth in Tor users that started
in mid-August. Current theory is that it's a botnet of some sort that
bundled a Tor 0.2.3 client. We'll need to do ongoing firefighting here.

@_date: 2013-09-03 13:55:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Roger's status report, August 2013 
Hi Graham,
Maybe you want to become the Tor envoy to them, to help them understand
what Tor projects are most worth working on?
We certainly need more people in the world who are familiar with Tor and
can help with teaching and advocacy.

@_date: 2013-09-03 14:09:58
@_author: Roger Dingledine 
@_subject: [tor-talk] New paper : Users Get Routed: Traffic Correlation on 
Excellent point. This is a good argument for being able to unpack a new
TBB on top of the old one -- which I'm told usually works, but doesn't
always work, and that's a big problem.
Longer term, the right answer is to use the Firefox update mechanism in
TBB 3.0 to update, in place, only the parts that need updating.
...unless there are better answers?

@_date: 2013-09-04 02:36:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Many more Tor users in the past week? 
Hi Asa,
Thanks for the timeline! Here are a few notes.
This was a censoring event I believe. The vanilla Tor TLS handshake
has been unreliable from inside Syria for much of 2013. Users are much
happier using obfs2 or obfs3, and we don't have much in the way of stats
for those yet.
For comparison, Tor sees 40+ million downloads of TBB a year from its
website. So careful jumping to conclusions about how many Pirate Browser
users there are based on how many downloads they counted. :)

@_date: 2013-09-05 06:36:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.17-rc is out 
Tor 0.2.4.17-rc is the third release candidate for the Tor 0.2.4.x
series. It adds an emergency step to help us tolerate the massive
influx of users: 0.2.4 clients using the new (faster and safer) "NTor"
circuit-level handshakes now effectively jump the queue compared to
the 0.2.3 clients using "TAP" handshakes. This release also fixes a
big bug hindering bridge reachability tests.
Changes in version 0.2.4.17-rc - 2013-09-05
  o Major features:
    - Relays now process the new "NTor" circuit-level handshake requests
      with higher priority than the old "TAP" circuit-level handshake
      requests. We still process some TAP requests to not totally starve
      0.2.3 clients when NTor becomes popular. A new consensus parameter
      "NumNTorsPerTAP" lets us tune the balance later if we need to.
      Implements ticket 9574.
  o Major bugfixes:
    - If the circuit build timeout logic is disabled (via the consensus,
      or because we are an authority), then don't build testing circuits.
      Fixes bug 9657; bugfix on 0.2.2.14-alpha.
    - Bridges now send AUTH_CHALLENGE cells during their v3 handshakes;
      previously they did not, which prevented them from receiving
      successful connections from relays for self-test or bandwidth
      testing. Also, when a relay is extending a circuit to a bridge,
      it needs to send a NETINFO cell, even when the bridge hasn't sent
      an AUTH_CHALLENGE cell. Fixes bug 9546; bugfix on 0.2.3.6-alpha.
    - If the time to download the next old-style networkstatus is in
      the future, do not decline to consider whether to download the
      next microdescriptor networkstatus. Fixes bug 9564; bugfix on
      0.2.3.14-alpha.
  o Minor bugfixes:
    - Avoid double-closing the listener socket in our socketpair()
      replacement (used on Windows) in the case where the addresses on
      our opened sockets don't match what we expected. Fixes bug 9400;
      bugfix on 0.0.2pre7. Found by Coverity.
  o Minor fixes (config options):
    - Avoid overflows when the user sets MaxCircuitDirtiness to a
      ridiculously high value, by imposing a (ridiculously high) 30-day
      maximum on MaxCircuitDirtiness.
    - Fix the documentation of HeartbeatPeriod to say that the heartbeat
      message is logged at notice, not at info.
    - Warn and fail if a server is configured not to advertise any
      ORPorts at all. (We need *something* to put in our descriptor,
      or we just won't work.)
  o Minor features:
    - Track how many "TAP" and "NTor" circuit handshake requests we get,
      and how many we complete, and log it every hour to help relay
      operators follow trends in network load. Addresses ticket 9658.
    - Update to the August 7 2013 Maxmind GeoLite Country database.

@_date: 2013-09-09 15:46:16
@_author: Roger Dingledine 
@_subject: [tor-talk] The reasoning behind the 'exit' flag definition 
The Exit flag used to not matter at all.
Now it matters because clients use it for load balancing. (If you have
the Exit flag then it's likely that other clients are using you as their
exit, so we should avoid using you for non-exit positions in our path.)
Does anybody actually do that?
My experience is that people make a list of all Tor relays at all, and
think of all of them as exiting anywhere, because they've never heard
of exit policies at all.
Correct. Consensus flags aren't meant for that.
This one is a poor idea, since it will ruin the load balancing which
is the only thing it's used for.
I guess we could do that. But I think it would be a burden on the network,
to say something that doesn't matter in any way and have every client
download it every few hours.
You don't like  ?
This is up and running now (exitlist.torproject.org answers these dns
queries), but unmaintained.
See also

@_date: 2013-09-10 18:38:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Updating Tor Browser Bundle 
No, the DNS part is solvable. But there are a bunch of deeper problems
with Chrome and privacy that are much harder to solve (and that so far
Chrome has shown little interest in solving).
See the links from

@_date: 2013-09-11 06:07:59
@_author: Roger Dingledine 
@_subject: [tor-talk] Updating Tor Browser Bundle 
Vanilla Firefox is free. Unless you count people with trademarks as
non-free, in which case maybe you will have a problem with Tor also? :)
Last I checked there's only one Anonym.OS. I know the people who worked
on it, and that was years ago. It has been abandoned since then.

@_date: 2013-09-11 19:43:59
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor browser can be fingerprinted 
I believe this to be false currently.
(But that doesn't mean we shouldn't fix it, because it will become true
some time in the next few decades, and we don't know when that will be.
(Good thing we're fixing it.))
Unfortunately, this one is more complex than you imply as well. Take a
look at "Anonymity Loves Company: Usability and the Network Effect"
for much more discussion here:

@_date: 2013-09-14 22:44:03
@_author: Roger Dingledine 
@_subject: [tor-talk] Your computer is too slow... 
It sounds like your Tor process is mysteriously disappearing.
You might like
My guess is that it's running out of memory, and the system is
quietly killing it. In that case 'dmesg' would give you some hints
to confirm it.
If that is the case, it's likely happening because all of these Tor
clients are creating many more TLS connections, and each of those TLS
connections makes OpenSSL use more memory. The current best fix is
'then give it more memory'.

@_date: 2013-09-23 16:27:37
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor companies 
We created TSC, a wholly owned subsidiary of Tor Project Inc, because BBG
changed its proposal process so only small businesses could apply, since
they wanted to keep the Lockheed Martins of the world from submitting
enormous wasteful proposals. Turns out that 501c3 non-profits, by
definition, are not small businesses -- a business must be for-profit
or it is not small. (Yes, I know, you can thank our fine government for
these definitions.) Fortunately, the definitions are such that we can
own a small business and it still gets to count as small.
I don't think there's any such thing as the Tor Solutions Group.

@_date: 2013-09-23 20:56:58
@_author: Roger Dingledine 
@_subject: [tor-talk] development interests 
Wow -- you have chosen an operating system that last got security updates
in 2007. Adventure.
Tor should build there (Tor should build everywhere).
However, I expect you're going to have a tough time getting a modern
Firefox working, and without that you're not going to have any good
protections from application-level privacy issues:

@_date: 2013-09-25 18:03:51
@_author: Roger Dingledine 
@_subject: [tor-talk] (no subject) 
But be careful following the instructions in the youtube video. It looks
like they made some deb somewhere and stuck Tor Browser Bundle in it
and want you to install that. A) Nobody's audited what exactly they're
having you install, now or in the future, and B) I have no idea how or
whether they'll keep that deb up to date.
It would be nice to make a deb that has Tor Browser in it. There are
a bunch of trac tickets on the topic. I think Micah from EFF has been
working on it as well; but I don't think this youtube video is pointing
to Micah's thing.

@_date: 2013-09-25 19:59:39
@_author: Roger Dingledine 
@_subject: [tor-talk] (no subject) 
No? As one example, if you're an activist in  you maybe
shouldn't get TBB from your government's website.
Speaking of which, I don't think that youtube video had any mention of
checking signatures or anything? (But I didn't watch it carefully and
didn't listen to it at all.) I guess it has you adding a separate deb
repository, and you fetch the keyring for that, so assuming you fetched it
right you're likely to get the package it wanted you to get -- whatever
that is.
As another example, until the TBB can update itself
(which is actually coming pretty soon I hope:
 ), we need users
to understand how and when to upgrade. We're doing a poor job of that
now, but having even more ways that people install it could make the
issue even worse.
I'd suggest checking out TBB 3.x and thinking about videos for that
Since I'm hoping we can drop TBB 2.x real soon now.

@_date: 2014-04-01 02:41:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Hidden Services Questions (mostly) Please? 
For those following along at home, check out
The first one knows that it's getting a connection from a non-relay so
can guess it's you. The last one knows it's being asked to exit to the
http server. The middle one(s) know it's not the first or last. If you
have multiple middle ones, they could perhaps use timing to guess what
hop they are.
We don't claim to hide from relays what position they are in the circuit,
since it seems hard to reliably hide it.
Also, it's really the first and last relays you should be concerned about:
Actually the client picks three hops and the hidden service picks
three hops, so there is no 'C' hop.
B <=> Rendezvous is encrypted yes.
B does not know it's the last node before connecting to a relay that's
used for rendezvous. However, B can know it's not the first hop, and
can look at Rendezvous's exit policy and learn that you're probably
not exiting from it, meaning you're probably doing something else. This
isn't something we try to (or think we can) hide. So, "assume yes but
maybe it's hard in practice".
It is. Exactly like the "client <=> A" hop is encrypted.
F can know it's the guard (first hop) for a Tor client. We assume it
can look at the traffic patterns and guess that the client it's being
a guard for is probably offering a hidden service. So, "assume yes".

@_date: 2014-04-07 19:17:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and Openssl bug CVE-2014-0160 
A new OpenSSL vulnerability on 1.0.1 through 1.0.1f is out today,
which can be used to reveal up to 64kB of memory to a connected client
or server.
The short version is: upgrade your openssl (unless you're running an
old one), and also more packages coming soon.

@_date: 2014-04-09 05:52:28
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB 3.5.4 says I should upgrade 
Yes, you're not supposed to overwrite your TBB.
Should be fixed in an upcoming TBB 3.6.x release.

@_date: 2014-04-10 13:57:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Small server, not much bandwidth 
Yes probably. Can't hurt, might help! :)
For obfsproxy, my current intuition is that it's best to (let it) pick
a random high-numbered port.
People who see an unrecognized protocol on a recognized port will think
it's weird. People who see an unrecognized protocol on an unrecognized
port will not be sure what to make of it.
Alas, if you don't open the ORPort to the Internet also, your bridge
won't find itself reachable, so it won't publish to the bridge
directory authority, and so bridges.torproject.org won't give out your
bridge address automatically:
So it is fine to leave ORPort closed if you're giving the bridge
address out manually, but if you want the automated system to do it,
you need ORPort reachable.
Fortunately, in practice China censors by IP:port, not by blacklisting
the whole IP address, for now.

@_date: 2014-04-11 18:28:36
@_author: Roger Dingledine 
@_subject: [tor-talk] The heartbleed bug, 
Huh. I think you're right. I've changed the blog post. Thanks.
It sure is showing interesting details as we explore it more.
For example, I think the SSL spec says that you shouldn't be able to ask
for a heartbeat until the SSL handshake is finished, but I think OpenSSL
lets you ask for a heartbeat during the SSL handshake. If so, that means
any local network mitm attacker, not just your entry guard, can intercept
your outgoing TCP connection and ask you for some heartbeats.

@_date: 2014-04-12 14:58:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Viewing current Dir Auth votes 
I have a cron job to copy moria1's perspective on the votes at 57
minutes after each hour to

@_date: 2014-04-14 14:43:22
@_author: Roger Dingledine 
@_subject: [tor-talk] browser fingerprinting 
Sorry, I suggest you all learn more about javascript and read the
links in question.
There aren't any known ways for JavaScript to learn the client's IP
address locally. Assuming there aren't further browser exploits of
course. And those exploits can be in any part of the browser, not
just JavaScript. Though historically a lot of vulnerabilities have been
in JavaScript.
The links in this thread point to external "what's my IP" sites that
you can ask the client to fetch -- but the fetch will go over Tor,
so it will tell you a Tor exit relay's IP address.
For more info on the Tor side, see
including the line in
where we're experimenting with disabling some Javascript implementation
optimizations that have historically been the source of many
and more broadly,
And yes, sandboxes and firewalls do seem like a great idea, for tolerating
implementation (and heck, protocol) flaws. I'm glad people are working
on making them both effective and usable. We need more people in the
world working on that.

@_date: 2014-04-14 14:46:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Heartbleed bug / Mainstream information 
It continued, including the NSA conspiracy theories, here:

@_date: 2014-08-01 17:43:38
@_author: Roger Dingledine 
@_subject: [tor-talk] 'relay early' attack logging at the infrastructure 
The patched relay also does a log message, yes.
But the relay can only see its immediate neighbor in the circuit, so it
will only log that. Whether the attacking relay is that (adjacent) one,
or one farther on the circuit, isn't something your relay can learn.

@_date: 2014-08-02 01:22:41
@_author: Roger Dingledine 
@_subject: [tor-talk] (FWD) ISC Update: StoryMaker 
An interesting-sounding success story of Tor in action -- and so well
integrated that people barely even mention Tor. :)
(Sorry for the horrible user-specific tracking links. You all get to be
me I guess.)

@_date: 2014-08-05 15:20:02
@_author: Roger Dingledine 
@_subject: [tor-talk] dutch police crawling hidden servers 
No, that's 2^80 addresses. Doing 2^80 lookups over Tor will take
millenia (if you're efficient).

@_date: 2014-08-13 17:05:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Performance 
Privoxy will be slower for two reasons:
A) It doesn't do the pipelining, etc that your browser can do. Earlier
versions of privoxy would fetch the whole page before passing any of
it to the browser. Maybe newer versions of Privoxy are smarter, but I
bet there are still web performance features that it disables by adding
another link in the chain.
B) It doesn't make use of Tor's "optimistic data" feature, which sends
the first chunk of application-level data along with the begin cell,
effectively cutting out one of the two round-trips for a new page fetch.
I guess the broader question is what the original poster was trying
to do -- if the goal is to give Tor's protection to everybody in the
organization, and the way they did it was to leave everybody using
Internet Explorer, and then redirect outgoing traffic into Privoxy
which sends it through Tor, then the users are missing out on all
the application-level privacy and security features that Tor Browser
gives you:

@_date: 2014-08-13 20:18:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Wired Story on Uncovering Users of Hidden Services. 
plus all the discussion under it.
Browser security is a big issue because there's so much surface area
to secure.
The defense is to stay up to date on your browser. It's not perfect
but it sure does help (and it was sufficient in this case).
In addition to the above links, you might also like

@_date: 2014-08-25 17:17:07
@_author: Roger Dingledine 
@_subject: [tor-talk] TOR tried to take a snapshot of my screen 
But the Firefox version is new, including the html5 canvas stuff. So I
think this is still a plausible direction to consider.
A search for 'zemana firefox' brings up several cases like
that look related -- people have had problems with the interactions
between these two programs in the past.
Well, one of the great features of Tor Browser is the deterministic
build process:
which basically means that anybody can produce a byte-for-byte identical
version of the Tor Browser download that you have -- and many people
reproduced the Tor Browser 3.6.3 and 3.6.4 versions that you have
(assuming of course that you fetched the real one).
So that means you can grab all the source code (mostly of Firefox)
and be sure that it's actually the thing you're running:
Now, I know it isn't fun to look through all of Firefox for compatibility
problems between it and your other Windows program. But the point is
that anybody can do it. So hopefully it is an answer to your above
conspiracy concerns -- if you think there's a screen capture feature
in Firefox, find it!
Hey, good thinking. Are there any other Zemana users here? I have never
heard of it, so maybe nobody else has either.

@_date: 2014-08-25 19:47:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Third-parties tracking me on Tor 
Hi folks,
I'd just like to remind you that every mail you send to tor-talk is
read by several thousand Tor users, activists, and developers.
The best way to use the list is to save up everything you wanted to say
about a thread and then write one coherent mail about it.
Otherwise you risk everybody deleting your thread, and worse, furthering
the tendency for everybody smart to ignore the list in general.
(And to contribute more usefully to this thread: it does sound like
endpoint security is the thing to look at more for this user -- some sort
of spyware on the user's computer could explain all of these problems.)

@_date: 2014-08-30 18:40:49
@_author: Roger Dingledine 
@_subject: [tor-talk] I have a quick question about security of tor with 3 
No, I don't think this makes sense. It doesn't matter if the first
hop knows it's first. It only matters if the two relays don't collude
to share notes -- since of them sees the user, and the other sees the
user's destination.
The reason Tor uses three hops rather than two is because the first hop
serves as an entry guard. The entry guard defends against the "over time,
if you didn't use one, the chance of getting screwed would go up every
time you switch circuits" issue. But the downside of sticking with the
same first hop is that it acts as a sort of identifier for the user.
If you only used two hops, and the first stayed static, then the exit
relay could build a profile of the sorts of things users do when they come
from that guard. How bad is that? I don't know, but the safe answer is to
put another dynamic (i.e. not associated with the user) relay in between.
For more reading on path selection, you might like
For a summary of some of the "first-last" correlation attacks and pointers
to the papers behind them, see

@_date: 2014-08-30 19:21:03
@_author: Roger Dingledine 
@_subject: [tor-talk] warns in logfile about onionskin length and non-OR 
A relay operator on  irc channel also reported seeing these (unless
that was you). It's harmless -- it basically means that some client sent
you a malformed (too short) create cell.
It's possible that this is a bug in our Tor client code, but I think
it's more likely that somebody else is working on a Tor client, and has
a bug in their code.
Since there isn't really much the relay operator can do about it, we've
downgraded the warning:
Upcoming 0.2.5.x releases will have a slightly more useful log message
if this happens again:

@_date: 2014-12-10 22:25:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor network too fast 
In particular, a lot of the slowness of Tor before (and still, if
you get unlucky) is because of queueing inside the relays. Tor isn't,
and never was, slow because of network latency. It's slow (when it is)
because other people are using it at the same time, and their traffic
is going through before yours so yours has to wait its turn. And it gets
especially bad when the relay you and the other person have selected is
rate limiting such that the relay stops and sits on your traffic data
until it's willing to send some more of it.
That's why designs like KIST can show such dramatic improvements (in the
lab, but I'm hopeful they will show improvements in reality too)
because they do a better job of prioritizing the cells that will
actually get through, rather than choosing ones that will just end up
waiting anyway.

@_date: 2014-12-11 17:07:32
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and solidarity against online harassment 
I'd like to draw your attention to
One of our colleagues has been the target of a sustained campaign of
harassment for the past several months. We have decided to publish this
statement to publicly declare our support for her, for every member of
our organization, and for every member of our community who experiences
this harassment. She is not alone and her experience has catalyzed us to
action. This statement is a start.
I'd love to get your feedback on this post, and your thoughts on how to
turn it into something more. This is a bigger struggle than just Tor's
piece of it.
And of course your signature on it too if you are interested. :)

@_date: 2014-12-11 17:32:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and solidarity against online harassment 
You might like
We won't put backdoors in Tor. Ever.

@_date: 2014-12-12 14:20:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and solidarity against online harassment 
Hello Mr. Tor hater,
We get funding from a variety of groups, including US government groups.
We do not "work for the pentagon" but that is a separate discussion and
it shouldn't derail this one.
We are indeed subjects of various governments, and some of those
governments have indeed been doing quite bad things lately. The notion
of a secret law makes me sick.
But when it comes to governments secretly forcing us to do things, no,
there *is* a choice. And that's why we're telling you we have made this
choice: No backdoors. Ever.
To quote the faq entry, which Nick and I wrote in 2004 and it remains
true today:
"We think that putting a backdoor in Tor would be tremendously
irresponsible to our users, and a bad precedent for security software
in general."
They can't make us put backdoors in. But they can make things miserable
for us if we don't go along with it -- see the Lavabit case for an example
(and hopefully one where people learned a lesson about centralization
too). That's a major part of why I try to keep talking to the folks who
might try to force us into something -- to explain that it won't work,
and that it will backfire because then *their* colleagues, who need
privacy too, will have fewer options, to remind them that there are
other jurisdictions in the world, and so on.
Thankfully, and I'd like to think in part because of this directed
advocacy, it has never come to this decision point for us. That is, to be
clear, nobody has yet tried to force us, with secret laws or otherwise,
into undermining Tor.
Now, you're right, these are just words. That's why we try to do all of
our development in public, and the source code is open, and the research
communities are active and public, and we engage with many communities
in person at a wide variety of conferences. Please do continue to audit
and observe and help find potential problems in Tor and the ecosystem
of software around it.
We've been working on Tor for more than a decade, and in that time the
world has been becoming a worse place in many ways for privacy and free
speech. Haters are going to hate, I accept this, but for the rest of you:
thanks for continuing to help us and to support privacy!
No backdoors. Ever.

@_date: 2014-12-12 19:17:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and solidarity against online harassment 
I am both very happy and very sad that we have involved the debate over
the word feminism in this broader discussion. It sure seems to have
a lot of different definitions for different communities, and those
terminology problems could distract from the (other) important discussion.
In the spirit of cooperation, please assume that many people, including
me, meant the one about equality rather than the one about being an
asshole. :)
I think part of this discussion is about exactly this question: how
much should Tor focus on just writing code that enables other people
to do things to make the world better, vs how much should Tor use its
reputation and context to make the world better in other ways. There
are no perfect answers here, but I think we're setting some more data
points as we move forward with blog posts like this one.
That said, I want also to amplify a point that Jean Camp made to me
recently, around what some people might think is the contradiction
between free speech and solidary against harassment:
Threats are not about speech, they are about silencing. Threats are the
opposite of dialogue. If a small minority of men can silence a great
number of women, speech is not served. Any person who is silenced by
threats of violence is damage to free speech.
Anonymity can and is targeted at supporting speech. Threats can and are
targeted at silencing speech.

@_date: 2014-12-14 23:34:35
@_author: Roger Dingledine 
@_subject: [tor-talk] Fwd: Developing an open-source, user-friendly tool 
Hi Alden,
Neat stuff! I encourage you to contact the researchers involved in the
previous papers anyway, even if you can't take code contributions because
of your thesis requirements. They likely will have a bunch of ideas on
how to make a more usable version of their program -- many programmers
who write unstable code don't do it because they have no taste, but
rather because they didn't have time to make it better. :)
In particular, I've already forwarded your mail to Rachel Greenstadt
so she can encourage people in her group to collaborate with you. I
encourage you also to contact Arvind Narayanan at Princeton as well.

@_date: 2014-12-19 17:19:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Possible upcoming attempts to disable the Tor network 
The Tor Project has learned that there may be an attempt to incapacitate
our network in the next few days through the seizure of specialized
servers in the network called directory authorities. (Directory
authorities help Tor clients learn the list of relays that make up the
Tor network.) We are taking steps now to ensure the safety of our users,
and our system is already built to be redundant so that users maintain
anonymity even if the network is attacked. Tor remains safe to use.

@_date: 2014-12-20 15:48:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Possible upcoming attempts to disable the Tor network 
No, it's (probably) not Russia.
Also, as I understand it, the Russian word in this situation was more
like asking researchers to propose for research grants. The translation
'bounty' or 'contest' was a bad translation and caused a string of
misleading articles. It is like saying that the National Science
Foundation is holding a contest for Tor research.
Please correct me if I am misunderstanding the translation.

@_date: 2014-12-21 12:44:59
@_author: Roger Dingledine 
@_subject: [tor-talk] Including Adblock to TBB to save bandwith 
Yep. These are some good reasons to keep adblock et al out of Tor Browser.
Another good reason mentioned on this thread is limiting attack surface.
But that said, here are two good reasons to put it in:
A) Reduction of bandwidth, as the original poster here pointed out.
As a bonus, since some pages don't render until certain of the components
are there, by fetching fewer components we could see speed-ups that are
more than just about bandwidth.
B) Potentially significant anonymity gains against certain attacks. If
traffic confirmation attacks are trivial (I'm not saying we know they are,
but it's simplest to act as if they are), and websites with ads cause you
to reach out to many more destinations than you would otherwise, then each
of those new destinations presents a new risk that an adversary could see
traffic going over that path. Thus reducing the number of destinations --
especially common ones like the centralized ad servers -- could help a
lot against this attack.
For more context, see the "The paper also makes me think about exit
traffic patterns" paragraph in
and the discussion around it.

@_date: 2014-12-21 22:59:17
@_author: Roger Dingledine 
@_subject: [tor-talk] Possible upcoming attempts to disable the Tor network 
Hi Naif,
You list two in NL, even though there is only one v3 directory authority
there. What is the other one (and also, why does your script think
it's down)?

@_date: 2014-12-22 16:18:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Possible upcoming attempts to disable the Tor network 
So far all is quiet on the directory authority front, and no news is
good news.
As for Thomas's servers, I should emphasize that Tor exit relays aren't
the same as Tor directory authorities. There are 1000+ exit relays in
the Tor network, and it is normal (and safe) for them to come and go for
all sorts of reasons. He took his relays down himself to be conservative
while investigating, but currently he's not thinking it has to do with
law enforcement. When he took them down, the Tor network temporarily
lost a little bit of exit capacity, but that too is normal.
There are six thousand plus relays in the Tor network right now, and
things are happening as usual. There's no indication currently that
anything in particular has happened recently.

@_date: 2014-02-07 10:17:29
@_author: Roger Dingledine 
@_subject: [tor-talk] The following directory authorities recommend other 
Nick and I met yesterday for some ticket closing and dev work, and part
of that ended up with the decision to un-recommend 0.2.2.39, mainly
because of general insecurity but also because it includes a hack for
hidden service reachability that we'd like to retire. And while we were
doing that, we decided to un-recommend a few more.
The 'recommended' versions list just controls whether a log message
appears in your logs -- so it is a pretty special user indeed who will
notice it. (In the past, the message also caused Vidalia to pop up a
little window for you. But at this point, anybody running an old Vidalia
bundle should probably upgrade.) The 0.2.2.39 version was only still in
the list because Debian oldstable ships it and we didn't want to upset
the Debian world; we will continue to keep compatibility for a few more
months until Debian oldstable goes away.
As usual it's a balance between crying wolf too often and keeping most of
the network up-to-date. At this point most relays are on pretty recent
versions (or on 0.2.3.25, but those are slowly disappearing). So long
as much of the network is resistant to Rob's attacks, the few remaining
relays that aren't don't pose that much of a threat. Also, 0.2.4.21 will
be coming out pretty soon, and there's another patch coming to do the
"exit stream" side of Rob's attacks. So I thought these steps would be the
right balance for now.
(And Sebastian, sorry for conspiring with tor26 to make these changes
while you were asleep. :) I'm still half expecting some Ubuntu or
something to be shipping one of the versions we un-recommended, and to
start getting a flood of user complaints. At which point we could back out
the changes until we'd made a better plan, or at least prepared better.)

@_date: 2014-02-09 20:33:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Tormium 
Be careful here!
Then see
for what Tor Browser does for application-layer privacy.
And see
for a variety of issues with Chrome that are for the most part still

@_date: 2014-02-09 22:45:23
@_author: Roger Dingledine 
@_subject: [tor-talk] SKKU43 Tor relay (was Re: Metrics fast exit page) 
Wow -- check out those URLs today.
And then see
which currently lists SKKU43 as 11% of the advertised bandwidth, and
7.3% of exit weights:
This relay advertises a self-measured bandwidth of 1GByte/s:
which is fine because self-measured bandwidth isn't used (at least
not directly) by clients. But then the torflow bwauths measure it at
w Bandwidth=10000 Measured=1230000 (moria1's opinion)
w Bandwidth=10000 Measured=67000   (gabelmoo's opinion)
w Bandwidth=10000 Measured=1450000 (tor26's opinion)
w Bandwidth=10000 Measured=617000  (maatuska's opinion)
Leading to a median of 617000 weight, which is more than twice the
second-most-weighted relay:
I think IPredator is actually carrying the traffic it claims. But I find
SKKU43's bandwidth line fishy-looking:
bandwidth 1200000000 1200000000 1000000000
So I guess the first question is, does it look like SKKU43 is actually
as good at carrying traffic as it appears to be?
And the second question is, should we lower the caps in torflow on how
much weight it will give a single relay? Or are the caps already low
and there's a bug?
Fun times,

@_date: 2014-02-11 09:26:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Obfsproxy on Raspberry Pi 
See  which says
"Raspbian is not Debian. These packages will be confusingly broken for
Raspbian users, since Raspbian called their architecture armhf but Debian
already has an armhf. See this post for details."

@_date: 2014-02-11 18:08:52
@_author: Roger Dingledine 
@_subject: [tor-talk] SKKU43 Tor relay (was Re: Metrics fast exit page) 
Hi Hyoung-Kee,
Thanks for letting us know. And now we're all curious: what was this
research on the Tor bandwidth scanner?
TorFlow really needs a maintainer currently, and indeed there are
many known attacks to manipulate the results, for example because
it calculates your consensus weight as a function of your current
self-measured bandwidth.
See also

@_date: 2014-02-13 16:47:43
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.5.2-alpha is out 
Tor 0.2.5.2-alpha includes all the fixes from 0.2.4.18-rc and 0.2.4.20,
like the "poor random number generation" fix and the "building too many
circuits" fix. It also further improves security against potential
adversaries who find breaking 1024-bit crypto doable, and launches
pluggable transports on demand (which gets us closer to integrating
pluggable transport support by default -- not to be confused with Tor
bundles enabling pluggable transports and bridges by default).
Changes in version 0.2.5.2-alpha - 2013-02-13
  o Major features (client security):
    - When we choose a path for a 3-hop circuit, make sure it contains
      at least one relay that supports the NTor circuit extension
      handshake. Otherwise, there is a chance that we're building
      a circuit that's worth attacking by an adversary who finds
      breaking 1024-bit crypto doable, and that chance changes the game
      theory. Implements ticket 9777.
    - Clients now look at the "usecreatefast" consensus parameter to
      decide whether to use CREATE_FAST or CREATE cells for the first hop
      of their circuit. This approach can improve security on connections
      where Tor's circuit handshake is stronger than the available TLS
      connection security levels, but the tradeoff is more computational
      load on guard relays. Implements proposal 221. Resolves ticket 9386.
  o Major features (bridges):
    - Don't launch pluggable transport proxies if we don't have any
      bridges configured that would use them. Now we can list many
      pluggable transports, and Tor will dynamically start one when it
      hears a bridge address that needs it. Resolves ticket 5018.
    - The bridge directory authority now assigns status flags (Stable,
      Guard, etc) to bridges based on thresholds calculated over all
      Running bridges. Now bridgedb can finally make use of its features
      to e.g. include at least one Stable bridge in its answers. Fixes
      bug 9859.
  o Major features (other):
    - Extend ORCONN controller event to include an "ID" parameter,
      and add four new controller event types CONN_BW, CIRC_BW,
      CELL_STATS, and TB_EMPTY that show connection and circuit usage.
      The new events are emitted in private Tor networks only, with the
      goal of being able to better track performance and load during
      full-network simulations. Implements proposal 218 and ticket 7359.
    - On some platforms (currently: recent OSX versions, glibc-based
      platforms that support the ELF format, and a few other
      Unix-like operating systems), Tor can now dump stack traces
      when a crash occurs or an assertion fails. By default, traces
      are dumped to stderr (if possible) and to any logs that are
      reporting errors. Implements ticket 9299.
  o Major bugfixes:
    - Avoid a segfault on SIGUSR1, where we had freed a connection but did
      not entirely remove it from the connection lists. Fixes bug 9602;
      bugfix on 0.2.4.4-alpha.
    - Do not treat streams that fail with reason
      END_STREAM_REASON_INTERNAL as indicating a definite circuit failure,
      since it could also indicate an ENETUNREACH connection error. Fixes
      part of bug 10777; bugfix on 0.2.4.8-alpha.
  o Major bugfixes (new since 0.2.5.1-alpha, also in 0.2.4.20):
    - Do not allow OpenSSL engines to replace the PRNG, even when
      HardwareAccel is set. The only default builtin PRNG engine uses
      the Intel RDRAND instruction to replace the entire PRNG, and
      ignores all attempts to seed it with more entropy. That's
      cryptographically stupid: the right response to a new alleged
      entropy source is never to discard all previously used entropy
      sources. Fixes bug 10402; works around behavior introduced in
      OpenSSL 1.0.0. Diagnosis and investigation thanks to "coderman"
      and "rl1987".
    - Fix assertion failure when AutomapHostsOnResolve yields an IPv6
      address. Fixes bug 10465; bugfix on 0.2.4.7-alpha.
    - Avoid launching spurious extra circuits when a stream is pending.
      This fixes a bug where any circuit that _wasn't_ unusable for new
      streams would be treated as if it were, causing extra circuits to
      be launched. Fixes bug 10456; bugfix on 0.2.4.12-alpha.
  o Major bugfixes (new since 0.2.5.1-alpha, also in 0.2.4.18-rc):
    - No longer stop reading or writing on cpuworker connections when
      our rate limiting buckets go empty. Now we should handle circuit
      handshake requests more promptly. Resolves bug 9731.
    - Stop trying to bootstrap all our directory information from
      only our first guard. Discovered while fixing bug 9946; bugfix
      on 0.2.4.8-alpha.
  o Minor features (bridges, pluggable transports):
    - Add threshold cutoffs to the networkstatus document created by
      the Bridge Authority. Fixes bug 1117.
    - On Windows, spawn background processes using the CREATE_NO_WINDOW
      flag. Now Tor Browser Bundle 3.5 with pluggable transports enabled
      doesn't pop up a blank console window. (In Tor Browser Bundle 2.x,
      Vidalia set this option for us.) Implements ticket 10297.
  o Minor features (security):
    - Always clear OpenSSL bignums before freeing them -- even bignums
      that don't contain secrets. Resolves ticket 10793. Patch by
      Florent Daigni??re.
  o Minor features (config options and command line):
    - Add an --allow-missing-torrc commandline option that tells Tor to
      run even if the configuration file specified by -f is not available.
      Implements ticket 10060.
    - Add support for the TPROXY transparent proxying facility on Linux.
      See documentation for the new TransProxyType option for more
      details. Implementation by "thomo". Closes ticket 10582.
  o Minor features (controller):
    - Add a new "HS_DESC" controller event that reports activities
      related to hidden service descriptors. Resolves ticket 8510.
    - New "DROPGUARDS" controller command to forget all current entry
      guards. Not recommended for ordinary use, since replacing guards
      too frequently makes several attacks easier. Resolves ticket 9934;
      patch from "ra".
  o Minor features (build):
    - Assume that a user using ./configure --host wants to cross-compile,
      and give an error if we cannot find a properly named
      tool-chain. Add a --disable-tool-name-check option to proceed
      nevertheless. Addresses ticket 9869. Patch by Benedikt Gollatz.
    - If we run ./configure and the compiler recognizes -fstack-protector
      but the linker rejects it, warn the user about a potentially missing
      libssp package. Addresses ticket 9948. Patch from Benedikt Gollatz.
  o Minor features (testing):
    - If Python is installed, "make check" now runs extra tests beyond
      the unit test scripts.
    - When bootstrapping a test network, sometimes very few relays get
      the Guard flag. Now a new option "TestingDirAuthVoteGuard" can
      specify a set of relays which should be voted Guard regardless of
      their uptime or bandwidth. Addresses ticket 9206.
  o Minor features (log messages):
    - When ServerTransportPlugin is set on a bridge, Tor can write more
      useful statistics about bridge use in its extrainfo descriptors,
      but only if the Extended ORPort ("ExtORPort") is set too. Add a
      log message to inform the user in this case. Resolves ticket 9651.
    - When receiving a new controller connection, log the origin address.
      Resolves ticket 9698; patch from "sigpipe".
    - When logging OpenSSL engine status at startup, log the status of
      more engines. Fixes ticket 10043; patch from Joshua Datko.
    - Turn "circuit handshake stats since last time" log messages into a
      heartbeat message. Fixes bug 10485; bugfix on 0.2.4.17-rc.
  o Minor features (new since 0.2.5.1-alpha, also in 0.2.4.18-rc):
    - Improve the circuit queue out-of-memory handler. Previously, when
      we ran low on memory, we'd close whichever circuits had the most
      queued cells. Now, we close those that have the *oldest* queued
      cells, on the theory that those are most responsible for us
      running low on memory. Based on analysis from a forthcoming paper
      by Jansen, Tschorsch, Johnson, and Scheuermann. Fixes bug 9093.
    - Generate bootstrapping status update events correctly when fetching
      microdescriptors. Fixes bug 9927.
    - Update to the October 2 2013 Maxmind GeoLite Country database.
  o Minor bugfixes (clients):
    - When closing a channel that has already been open, do not close
      pending circuits that were waiting to connect to the same relay.
      Fixes bug 9880; bugfix on 0.2.5.1-alpha. Thanks to skruffy for
      finding this bug.
  o Minor bugfixes (relays):
    - Treat ENETUNREACH, EACCES, and EPERM connection failures at an
      exit node as a NOROUTE error, not an INTERNAL error, since they
      can apparently happen when trying to connect to the wrong sort
      of netblocks. Fixes part of bug 10777; bugfix on 0.1.0.1-rc.
  o Minor bugfixes (bridges):
    - Fix a bug where the first connection works to a bridge that uses a
      pluggable transport with client-side parameters, but we don't send
      the client-side parameters on subsequent connections. (We don't
      use any pluggable transports with client-side parameters yet,
      but ScrambleSuit will soon become the first one.) Fixes bug 9162;
      bugfix on 0.2.0.3-alpha. Based on a patch from "rl1987".
  o Minor bugfixes (node selection):
    - If ExcludeNodes is set, consider non-excluded hidden service
      directory servers before excluded ones. Do not consider excluded
      hidden service directory servers at all if StrictNodes is
      set. (Previously, we would sometimes decide to connect to those
      servers, and then realize before we initiated a connection that
      we had excluded them.) Fixes bug 10722; bugfix on 0.2.0.10-alpha.
      Reported by "mr-4".
    - If we set the ExitNodes option but it doesn't include any nodes
      that have the Exit flag, we would choose not to bootstrap. Now we
      bootstrap so long as ExitNodes includes nodes which can exit to
      some port. Fixes bug 10543; bugfix on 0.2.4.10-alpha.
  o Minor bugfixes (controller and command-line):
    - If changing a config option via "setconf" fails in a recoverable
      way, we used to nonetheless write our new control ports to the
      file described by the "ControlPortWriteToFile" option. Now we only
      write out that file if we successfully switch to the new config
      option. Fixes bug 5605; bugfix on 0.2.2.26-beta. Patch from "Ryman".
    - When a command-line option such as --version or --help that
      ordinarily implies --hush appears on the command line along with
      --quiet, then actually obey --quiet. Previously, we obeyed --quiet
      only if it appeared later on the command line. Fixes bug 9578;
      bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (code correctness):
    - Previously we used two temporary files when writing descriptors to
      disk; now we only use one. Fixes bug 1376.
    - Remove an erroneous (but impossible and thus harmless) pointer
      comparison that would have allowed compilers to skip a bounds
      check in channeltls.c. Fixes bugs 10313 and 9980; bugfix on
      0.2.0.10-alpha. Noticed by Jared L Wong and David Fifield.
    - Fix an always-true assertion in pluggable transports code so it
      actually checks what it was trying to check. Fixes bug 10046;
      bugfix on 0.2.3.9-alpha. Found by "dcb".
  o Minor bugfixes (protocol correctness):
    - When receiving a VERSIONS cell with an odd number of bytes, close
      the connection immediately since the cell is malformed. Fixes bug
      10365; bugfix on 0.2.0.10-alpha. Spotted by "bobnomnom"; fix by
      "rl1987".
  o Minor bugfixes (build):
    - Restore the ability to compile Tor with V2_HANDSHAKE_SERVER
      turned off (that is, without support for v2 link handshakes). Fixes
      bug 4677; bugfix on 0.2.3.2-alpha. Patch from "piet".
    - Fix compilation warnings and startup issues when running with
      "Sandbox 1" and libseccomp-2.1.0. Fixes bug 10563; bugfix on
      0.2.5.1-alpha.
    - Fix compilation on Solaris 9, which didn't like us having an
      identifier named "sun". Fixes bug 10565; bugfix in 0.2.5.1-alpha.
  o Minor bugfixes (testing):
    - Fix a segmentation fault in our benchmark code when running with
      Fedora's OpenSSL package, or any other OpenSSL that provides
      ECDH but not P224. Fixes bug 10835; bugfix on 0.2.4.8-alpha.
  o Minor bugfixes (log messages):
    - Fix a bug where clients using bridges would report themselves
      as 50% bootstrapped even without a live consensus document.
      Fixes bug 9922; bugfix on 0.2.1.1-alpha.
    - Suppress a warning where, if there's only one directory authority
      in the network, we would complain that votes and signatures cannot
      be uploaded to other directory authorities. Fixes bug 10842;
      bugfix on 0.2.2.26-beta.
    - Report bootstrapping progress correctly when we're downloading
      microdescriptors. We had updated our "do we have enough microdescs
      to begin building circuits?" logic most recently in 0.2.4.10-alpha
      (see bug 5956), but we left the bootstrap status event logic at
      "how far through getting 1/4 of them are we?" Fixes bug 9958;
      bugfix on 0.2.2.36, which is where they diverged (see bug 5343).
  o Minor bugfixes (new since 0.2.5.1-alpha, also in 0.2.4.20):
    - Avoid a crash bug when starting with a corrupted microdescriptor
      cache file. Fixes bug 10406; bugfix on 0.2.2.6-alpha.
    - If we fail to dump a previously cached microdescriptor to disk, avoid
      freeing duplicate data later on. Fixes bug 10423; bugfix on
      0.2.4.13-alpha. Spotted by "bobnomnom".
  o Minor bugfixes on 0.2.4.x (new since 0.2.5.1-alpha, also in 0.2.4.18-rc):
    - Correctly log long IPv6 exit policies, instead of truncating them
      or reporting an error. Fixes bug 9596; bugfix on 0.2.4.7-alpha.
    - Our default TLS ecdhe groups were backwards: we meant to be using
      P224 for relays (for performance win) and P256 for bridges (since
      it is more common in the wild). Instead we had it backwards. After
      reconsideration, we decided that the default should be P256 on all
      hosts, since its security is probably better, and since P224 is
      reportedly used quite little in the wild.  Found by "skruffy" on
      IRC. Fix for bug 9780; bugfix on 0.2.4.8-alpha.
    - Free directory authority certificate download statuses on exit
      rather than leaking them. Fixes bug 9644; bugfix on 0.2.4.13-alpha.
  o Minor bugfixes on 0.2.3.x (new since 0.2.5.1-alpha, also in 0.2.4.18-rc):
    - If the guard we choose first doesn't answer, we would try the
      second guard, but once we connected to the second guard we would
      abandon it and retry the first one, slowing down bootstrapping.
      The fix is to treat all our initially chosen guards as acceptable
      to use. Fixes bug 9946; bugfix on 0.1.1.11-alpha.
    - Fix an assertion failure that would occur when disabling the
      ORPort setting on a running Tor process while accounting was
      enabled. Fixes bug 6979; bugfix on 0.2.2.18-alpha.
    - When examining the list of network interfaces to find our address,
      do not consider non-running or disabled network interfaces. Fixes
      bug 9904; bugfix on 0.2.3.11-alpha. Patch from "hantwister".
    - Avoid an off-by-one error when checking buffer boundaries when
      formatting the exit status of a pluggable transport helper.
      This is probably not an exploitable bug, but better safe than
      sorry. Fixes bug 9928; bugfix on 0.2.3.18-rc. Bug found by
      Pedro Ribeiro.
  o Removed code and features:
    - Clients now reject any directory authority certificates lacking
      a dir-key-crosscert element. These have been included since
      0.2.1.9-alpha, so there's no real reason for them to be optional
      any longer. Completes proposal 157. Resolves ticket 10162.
    - Remove all code that existed to support the v2 directory system,
      since there are no longer any v2 directory authorities. Resolves
      ticket 10758.
    - Remove the HSAuthoritativeDir and AlternateHSAuthority torrc
      options, which were used for designating authorities as "Hidden
      service authorities". There has been no use of hidden service
      authorities since 0.2.2.1-alpha, when we stopped uploading or
      downloading v0 hidden service descriptors. Fixes bug 10881; also
      part of a fix for bug 10841.
  o Code simplification and refactoring:
    - Remove some old fallback code designed to keep Tor clients working
      in a network with only two working relays. Elsewhere in the code we
      have long since stopped supporting such networks, so there wasn't
      much point in keeping it around. Addresses ticket 9926.
    - Reject 0-length EXTEND2 cells more explicitly. Fixes bug 10536;
      bugfix on 0.2.4.8-alpha. Reported by "cypherpunks".
    - Remove data structures which were introduced to implement the
      CellStatistics option: they are now redundant with the addition
      of a timestamp to the regular packed_cell_t data structure, which
      we did in 0.2.4.18-rc in order to resolve ticket 9093. Implements
      ticket 10870.
  o Documentation (man page) fixes:
    - Update manpage to describe some of the files you can expect to
      find in Tor's DataDirectory. Addresses ticket 9839.
    - Document that all but one DirPort entry must have the NoAdvertise
      flag set. Fixes bug 10470; bugfix on 0.2.3.3-alpha / 0.2.3.16-alpha.
  o Documentation fixes (new since 0.2.5.1-alpha, also in 0.2.4.18-rc):
    - Clarify the usage and risks of setting the ContactInfo torrc line
      for your relay or bridge. Resolves ticket 9854.
    - Add anchors to the manpage so we can link to the html version of
      the documentation for specific options. Resolves ticket 9866.
    - Replace remaining references to DirServer in man page and
      log entries. Resolves ticket 10124.
  o Tool changes:
    - Make the "tor-gencert" tool used by directory authority operators
      create 2048-bit signing keys by default (rather than 1024-bit, since
      1024-bit is uncomfortably small these days). Addresses ticket 10324.

@_date: 2014-02-24 20:11:03
@_author: Roger Dingledine 
@_subject: [tor-talk] how relays upgrade to latest version of Tor 
It really depends how they're installed.
Many of the larger relays use the Tor deb (for Debian or Ubuntu):
and they update their Tor as part of standard system updates.
There's definitely a balance between keeping software up-to-date and
maintaining independence and trust separation. I think I'd be pretty
uncomfortable with a silent auto update mechanism for Tor relays -- that's
why in the past when we talk about updates we talk about "secure update",
not "auto update". Words like "simultaneously" and "automatically"
are good for usability, but both good and scary for security.
In general we try to maintaining compatibility with many versions of
Tor other than the most recent release. That said, there is support in
the directory authorities for cutting out (unlisting) relays that are
running insufficiently recent Tor versions.
Hope that helps,

@_date: 2014-02-27 20:25:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Using HTTPS Everywhere to redirect to .onion 
This approach would work somewhat, but it loses some nice security
properties (mainly authentication). In the https-everywhere case,
you never (try to) touch the main website -- which means you can't get
sent to the wrong place with dns forgery, and you can't get snookered
by somebody who broke into TurkTrust, got a valid SSL certificate for
the website, and is now pretending to be the website (and chooses not
to do the rewrite for you).
In general, making choices on the browser side is safer than leaving it
to the server to keep you safe.
That said, the question in my mind is how to move this from "if you're
very smart, you can write your own https-everywhere rule for yourself"
to "ordinary TBB users get this benefit". I don't really want to get
into the business of writing an /etc/hosts file for public website ->
hidden service mappings.

@_date: 2014-02-27 23:40:43
@_author: Roger Dingledine 
@_subject: [tor-talk] RSS 
Do your logs indicate that Tor successfully established circuits in the
first place? Does your Tor work for reaching other sites?
Assuming yes, you can set "Safelogging 0" in your torrc to have Tor say
something more useful than [scrubbed]. In that case my guess is that
your destination is actually unreachable for the past week.
If your Tor doesn't work for other things, then you can focus on that, e.g.

@_date: 2014-01-10 14:10:04
@_author: Roger Dingledine 
@_subject: [tor-talk] (FWD) Jan 14 WATCH: Roger Dingledine on "The Tor Project 
This coming Tuesday I'll be doing a Tor talk for the National Science
Foundation (in the DC area), and you're welcome to join.
It will be a mash-up of our 28c3 talk ("How governments have tried to
block Tor"), my talk from PETools 2013 ("Lessons from Tor: How to Help
Developers and Researchers Improve your Privacy Tool"), and our 30c3
talk from last month on the recent social and political pressures on Tor.
Please spread the word!

@_date: 2014-01-12 20:34:03
@_author: Roger Dingledine 
@_subject: [tor-talk] [IDEA] Google App Engine, Tor Hidden Service Viewer 
Sounds like it would work.
But I also suspect that somebody will eventually get upset at some
content that somebody tries to reach through your mirrorrr, and I bet
Google App Engine will be pleased to shut you off at the first complaint.
See  for a project that already does all of this
(though not with Java and not with Google App Engine). You should learn
about their work building a community of people willing to host the
tor2web proxies.

@_date: 2014-01-23 23:19:49
@_author: Roger Dingledine 
@_subject: [tor-talk] I don't see any cookies in TBB 3.5 
You will like (or maybe not like, but still want to be aware of)

@_date: 2014-01-25 05:06:17
@_author: Roger Dingledine 
@_subject: [tor-talk] Terminology: Deep v Dark Web 
Check out for some statistics about the number of hidden services as of about
a year ago. It's not all that precise (and the fact that they could
collect these stats represents several bugs:
 )
but it's pretty darn clear that it's not "vast reaches of the Internet"

@_date: 2014-01-27 01:09:39
@_author: Roger Dingledine 
@_subject: [tor-talk] question about bridge relays 
The "find bridges" button was broken on Vidalia anyway, ever since
 added a captcha to make it harder for
bad guys to automate pretending to be lots of people and learn lots of
bridges addresses.
Now the right answer is to go to  and
learn some bridges. Then you can either choose 'configure' rather than
'connect' when you start TBB the first time, in which case it will walk
you through adding the bridges you found, or if you've already started
TBB, go to 'open network settings' in your Torbutton (the green onion near
the URL bar) and select 'my ISP blocks connections to the Tor network'.
If somebody reading this wants to make some updated screenshots for
that would be swell.

@_date: 2014-07-02 18:06:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Freehaven-dev archives 
Fixed now.
The archives were there the whole time, but the index page lied to
you about which months actually existed.

@_date: 2014-07-08 05:32:47
@_author: Roger Dingledine 
@_subject: [tor-talk] What are the PPTOR relays? 
It looks like PTOR0014 has the Unnamed flag. I wonder if Tor clients are
disregarding it because it's not named by fingerprint in the descriptor,
and because it has the Unnamed flag rather than the Named flag.
Seems like a bug.

@_date: 2014-07-14 06:56:19
@_author: Roger Dingledine 
@_subject: [tor-talk] Questions about NSA monitoring of Tor users. 
You might want to read many of my answers on
Directory authority, yes.
No, I haven't seen any rules that tag flows based on whether they are
accessing one of the 5000ish Tor relay IP addresses. I just skimmed over
the Wired article and it appears they do say that but I think they're
misreading or misunderstanding the rules.
That said, I believe xkeyscore does have rules that DPI on a flow to
see if it looks like a Tor handshake has just happened. But nobody has
published (and I don't know) specifics of exactly what data they run
any of these rules over:
I've lost track of their codenames for things, but I think Quantum is
probably different than their general surveillance infrastructure.
In any case, it is still unclear whether the surveillance happens closer
to the website, closer to the user, or both. It depends on which website
and which user you're thinking about.
And this point leads to speculation about how maybe if you're in Germany
and you access a German Tor directory authority, NSA's surveillance
infrastructure doesn't see you because your request doesn't go over a
big enough backbone Internet link.
...which leads to speculation that the BND and NSA team up to share data,
so they can together cover more of the Internet. And round and round
we go.
Yes. But I assume they get IPs and also timestamps. And now if they
see something else going on that involves that IP address, they can
ask their database what else that IP address has done.
This is exactly the sort of thing that should scare ordinary people,
because I assume they hand all this data to a human analyst who tries
to make a guess about whether to send a drone. And if that human analyst
thinks Tor is only used by a tiny number of people, all of whom are bad,
then she could easily come to wrong conclusions.
And if some programmer tries to automate the job of that analyst, because
they have too much data coming in and they want to automatically determine
the right places to send drones... things can go wrong in a hurry.
I think it isn't either of these. I'm sure some of them think Tor is
only used by bad people (all the press about Tor and drugs, etc lately
sure hasn't helped).
But I think the general idea is to collect as much information about as
many things as possible, and then "surely" when you put it all together
it'll point you to the bad guys.
In particular, once they find something suspicious, they want to be able
to go back and see what else that person / computer / network was doing
in the past. And to do that, they need to collect as much as they can
about as many things as they can.
This is also the logic that leads them to redefine "collect" to be the
point where they actually *use* the information, not the point where
they, ehm, collect it. Because they know the various committees that
try to oversee them haven't given them permission to gather it all,
but they have also convinced themselves that they can't do a good job
at fighting bad guys if they don't gather it all.
And finally, don't put too much weight on these particular DPI rules.
The news here is not "we finally learned what the NSA are spying on,
and it's Tor connections and people looking at the Mixminion website."
They very likely spy on way way more than this. But these are the ones
that some journalists decided to write about (which in turn means that
they're the ones some whistleblower decided to leak).

@_date: 2014-07-21 17:11:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Cancelled black hat talk 
Hi folks,
Journalists are asking us about the Black Hat talk on attacking Tor
that got cancelled. We're still working with CERT to do a coordinated
disclosure of the details (hopefully this week), but I figured I should
share a few details with you earlier than that.
1) We did not ask Black Hat or CERT to cancel the talk. We did (and still
do) have questions for the presenter and for CERT about some aspects
of the research, but we had no idea the talk would be pulled before the
announcement was made.
2) In response to our questions, we were informally shown some
materials. We never received slides or any description of what would
be presented in the talk itself beyond what was available on the Black
Hat Webpage.
3) We encourage research on the Tor network along with responsible
disclosure of all new and interesting attacks. Researchers who have told
us about bugs in the past have found us pretty helpful in fixing issues,
and generally positive to work with.

@_date: 2014-07-21 18:58:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Cancelled black hat talk 
I think I have a handle on what they did, and how to fix it. We've been
trying to find delicate ways to explain that we think we know what they
did, but also it sure would have been smoother if they'd opted to tell
us everything. The main reason for trying to be delicate is that I don't
want to discourage future researchers from telling us about neat things
that they find. I'm currently waiting for them to answer their mail so
I can proceed.
Based on our current plans, we'll be putting out a fix that relays can
apply that should close the particular bug they found. The bug is a nice
bug, but it isn't the end of the world. And of course these things are
never as simple as "close that one bug and you're 100% safe".
Less vague sentences soon I hope,

@_date: 2014-07-24 16:36:26
@_author: Roger Dingledine 
@_subject: [tor-talk] Why does requesting for bridges by email require a 
Because we need an adequately popular provider that makes it hard to
generate lots of addresses. Otherwise an attacker could make millions
of addresses and "be" millions of different people asking for bridges.
(Also, it recently became clear that it would be useful for people to
access this provider via https, rather than http, so a network adversary
can't just sniff the bridge addresses off the Internet when the user
reads her mail. And it would also be nice to not use providers that turn
their entire email databases over to the adversary, even unwittingly.
Lots of adversaries and lots of goals to manage at once here.)

@_date: 2014-07-27 15:34:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Android app: Torrific 
Hi CJ!
The main problem with the name is that it encourages other people to
name their thing with Tor in it too. And then we end up with a bunch
of projects all confusingly named Tor, some of which really shouldn't
be and some of which are probably fine, and it's hard for users to tell
which is which.
So yes, I understand that you like the name, but it will contribute
to more chaos and confusion down the road. Please pick something else.
Historically, we have encouraged people to use names with the more generic
word onion, or onion routing, or "or", to signify that they're not Tor.
I bet people here would be happy to help you brainstorm about names if
you need input. :)

@_date: 2014-07-27 19:47:03
@_author: Roger Dingledine 
@_subject: [tor-talk] Android app: Torrific 
Yes, when it's referring to anonymity software that can be confusing
to people about whether it's made or endorsed by Tor.
Just like Debian, etc have trademarks too.
(We have no problems with the city of Toronto, unless I guess it gets
into the anonymity business. ;)

@_date: 2014-07-27 20:35:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Android app: Torrific (renamed to orWall) 
Sounds good to me!
Thanks for being understanding -- it is sad that the people most willing
to be accommodating here are also the ones who are probably the ones
best suited for using our name correctly. Or said another way, it's the
folks who don't care at all, and don't want to talk to us, that we most
need to reach to get them to quit using the Tor name. I'm not sure how
to resolve that contradiction.
And hopefully this will also let the project grow into its own thing,
rather than always being in the shadow of the Tor name.
And finally, to add some useful content here, speaking of Orwell be
sure that you've seen the rap news video on the topic:

@_date: 2014-07-28 13:34:11
@_author: Roger Dingledine 
@_subject: [tor-talk] problem with tor in linux mint 17 
This indeed means it isn't bootstrapping. My first thought is that you
have some firewall or iptables rules or something preventing Tor from
reaching the network.
This version of Tor is significantly out of date.
This warning could matter a lot -- did you build Tor yourself? In
any case, "your openssl install is broken" could be related to "your
Tor couldn't finish any SSL handshakes".
Blocking by your ISP possible, but usually it's some other issue.

@_date: 2014-07-30 03:43:02
@_author: Roger Dingledine 
@_subject: [tor-talk] (FWD) Tor 0.2.4.23 is released 
Here's a reminder for those of you who aren't on tor-announce to be on it.

@_date: 2014-07-30 03:48:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.5.6-alpha is out 
Tor 0.2.5.6-alpha brings us a big step closer to slowing down the
risk from guard rotation, and fixes a variety of other issues to get
us closer to a release candidate.
Changes in version 0.2.5.6-alpha - 2014-07-28
  o Major features (also in 0.2.4.23):
    - Make the number of entry guards configurable via a new
      NumEntryGuards consensus parameter, and the number of directory
      guards configurable via a new NumDirectoryGuards consensus
      parameter. Implements ticket 12688.
  o Major bugfixes (also in 0.2.4.23):
    - Fix a bug in the bounds-checking in the 32-bit curve25519-donna
      implementation that caused incorrect results on 32-bit
      implementations when certain malformed inputs were used along with
      a small class of private ntor keys. This bug does not currently
      appear to allow an attacker to learn private keys or impersonate a
      Tor server, but it could provide a means to distinguish 32-bit Tor
      implementations from 64-bit Tor implementations. Fixes bug 12694;
      bugfix on 0.2.4.8-alpha. Bug found by Robert Ransom; fix from
      Adam Langley.
  o Major bugfixes:
    - Perform circuit cleanup operations even when circuit
      construction operations are disabled (because the network is
      disabled, or because there isn't enough directory information).
      Previously, when we were not building predictive circuits, we
      were not closing expired circuits either. Fixes bug 8387; bugfix on
      0.1.1.11-alpha. This bug became visible in 0.2.4.10-alpha when we
      became more strict about when we have "enough directory information
      to build circuits".
  o Minor features:
    - Authorities now assign the Guard flag to the fastest 25% of the
      network (it used to be the fastest 50%). Also raise the consensus
      weight that guarantees the Guard flag from 250 to 2000. For the
      current network, this results in about 1100 guards, down from 2500.
      This step paves the way for moving the number of entry guards
      down to 1 (proposal 236) while still providing reasonable expected
      performance for most users. Implements ticket 12690.
    - Update geoip and geoip6 to the July 10 2014 Maxmind GeoLite2
      Country database.
    - Slightly enhance the diagnostic message for bug 12184.
  o Minor bugfixes (also in 0.2.4.23):
    - Warn and drop the circuit if we receive an inbound 'relay early'
      cell. Those used to be normal to receive on hidden service circuits
      due to bug 1038, but the buggy Tor versions are long gone from
      the network so we can afford to resume watching for them. Resolves
      the rest of bug 1038; bugfix on 0.2.1.19.
    - Correct a confusing error message when trying to extend a circuit
      via the control protocol but we don't know a descriptor or
      microdescriptor for one of the specified relays. Fixes bug 12718;
      bugfix on 0.2.3.1-alpha.
  o Minor bugfixes:
    - Fix compilation when building with bufferevents enabled. (This
      configuration is still not expected to work, however.)
      Fixes bugs 12438, 12474, 11578; bugfixes on 0.2.5.1-alpha and
      0.2.5.3-alpha. Patches from Anthony G. Basile and Sathyanarayanan
      Gunasekaran.
    - Compile correctly with builds and forks of OpenSSL (such as
      LibreSSL) that disable compression. Fixes bug 12602; bugfix on
      0.2.1.1-alpha. Patch from "dhill".

@_date: 2014-07-30 05:49:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Cancelled black hat talk 
I have timed out on them and put out two new releases plus a security

@_date: 2014-07-30 18:22:21
@_author: Roger Dingledine 
@_subject: [tor-talk] Cancelled black hat talk 
The security advisory was that somebody had attacked real Tor users and
perhaps deanonymized some of them, and here's what we know.
The particular traffic confirmation channel they used wasn't a big deal.
(Or said another way, fixing it doesn't make a big impact on whether
this sort of attack is possible.)

@_date: 2014-07-31 14:12:09
@_author: Roger Dingledine 
@_subject: [tor-talk] Why make bad-relays a closed mailing list? 
Hm? ContactInfo is just a string. You can set it however you like.
Here's the stanza in the torrc file:
 Administrative contact information for this relay or bridge. This line
 can be used to contact you if your relay or bridge is misconfigured or
 something else goes wrong. Note that we archive and publish all
 descriptors containing these lines and that Google indexes them, so
 spammers might also collect them. You may want to obscure the fact that
 it's an email address and/or generate a new address for this purpose.
 Random Person  You might also include your PGP or GPG fingerprint if you have one:
 0xFFFFFFFF Random Person Another piece of the problem is that we don't enforce any particular
info in the ContactInfo line (or even that you set one at all). I guess
we could send a challenge to the email address, and demand a reply,
and otherwise set a cap on the capacity that the network will assign you.
Seems like that would be another barrier to our volunteer relay operators,
but maybe for exit relays it's worth it.

@_date: 2014-07-31 15:13:00
@_author: Roger Dingledine 
@_subject: [tor-talk] is torrc a manual page now? que? 
Well, it certainly isn't meant to be a secret. You should totally check
out the torrc.sample file that comes with the tarball, or (equivalently)
the torrc file that comes with the deb. It has come a long way since
the last time you looked at it. :)
For reference, here is a copy of the torrc.sample file from Tor
0.1.0.1-rc, released March 28 2005:
I agree -- there are some real downsides to requiring working contact
info for relays.
On the other hand, there are some real downsides to having large relays
where we don't know the operators. We know the operators of many of
the large relays in the network, but there are many more where we don't
know them.
And of course, confirming that some email address can receive email is
not the same as knowing the operators.
So much to do,

@_date: 2014-07-31 16:35:19
@_author: Roger Dingledine 
@_subject: [tor-talk] Why make bad-relays a closed mailing list? 
I think this is a really important point.
I'm usually on the side of transparency, and screw whether publishing
our methods and discussions impacts effectiveness.
But in this particular case I'm stuck, because the arms race is so
lopsidedly against us.
We can scan for whether exit relays handle certain websites poorly,
but if the list that we scan for is public, then exit relays can mess
with other websites and know they'll get away with it.
We can scan for incorrect behavior on various ports, but if the list
of ports and the set of behavior we do is public, then again relays are
free to mess with things we don't look for.
One way forward is a community-grown set of tools that are easy to
extend, and a bunch of people actively extending them and trying out
new things to look for. And then when they find something, they let
people know and others can verify it.
But then what -- we add that particular test to the set of official
tests that we do? And other people keep doing their secret "I wonder if
I can catch a new one" tests in the background? Or do we add all tests
that anybody has implemented, and try to cover everything that matters,
whatever that means?
Another way forward is to design and deploy an adaptive test system,
which e.g. searches google for some content, then fetches it with and
without Tor, and tries to figure out if the exit is messing with stuff.
That turns out to be a really tough research project, in that a lot of
web content is dynamic so your results will be mostly false positives
unless you account for that somehow. That's what SoaT was aiming to do:
Some researchers like Micah Sherr ("Validating Web Content with Senser")
might have components to contribute here, to recognize and discard false
positives (but at the cost of introducing new false negatives too).
So in summary, if we're going to dabble here and there and notice bad
exits in an ad hoc way, I think secrecy is one of the few tools we have to
not totally lose the arms race. If we're going to play the arms race more
seriously, then secrecy should become an increasingly less relevant tool.
But as usual a lot of research remains if we want to get there from here.

@_date: 2014-06-05 19:59:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Security concerns with running an exit relay 
You might like
which links to
Also, you should be aware of the tor-relays list, where things like
this are discussed more often.
Thanks for running a relay!

@_date: 2014-06-07 19:41:45
@_author: Roger Dingledine 
@_subject: [tor-talk] Is this safe 
See When using (somebody's package of) Tor on iOS, the main thing I'd worry
about is application-level (browser-level) privacy problems.
Tor Browser does a huge number of things to keep you safe from the
websites you talk to, the advertising companies they link to, etc:
and all of that is likely missing from whatever you installed on your

@_date: 2014-06-07 21:24:49
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidallia Issues 
Hi! Thanks for wanting to run a relay. As you have discovered, trying
to set it up via Vidalia is not going to be fun. Vidalia is deprecated
(which is a nice way of saying "outright abandoned"), and you'll be much
happier installing the system Tor package and then editing the torrc file.
I notice your Tor version is several versions behind. You might want to
bug your package maintainer to keep their Tor package up to date. (The
Tor packages for Debian are well-maintained.)
Sounds like you already have a system Tor daemon running? Messing with
running a second one at the same time with Vidalia will indeed bring
How many of the instructions on
work for Mint? I bet most of them do. Please let us know!

@_date: 2014-06-07 21:32:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidallia Issues 
I should also mention we've been helping many people on the  irc
channel lately who are trying to set up relays on various flavors of
Linux. So if you want more real-time interaction, that's a good place
to try.

@_date: 2014-06-10 19:09:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Not prompted to update Tor Browser 
Short version: you're fine.
See TBB 3.6.1 was a patch to fix a regression for those who use the
proxy settings:
and there was no need to upgrade if you weren't experiencing that bug.
TBB 3.6.2 came out today, and it looks like Mike decided to give it a
little while before un-recommending the older TBBs, so we can have time
to notice if it's broken as some users try to upgrade. (In the past,
he would unrecommend the old ones immediately, and then I'd notice that
the download links were all broken, and it would be a race to see how
many users would complain while I was trying to fix them. :)

@_date: 2014-06-19 15:43:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Calculation of Bandwidth weights 
The bandwidth weight in the consensus is calculated in a simple way:
it's the median of the bandwidth weights in each vote.
So now you should ask how each directory authority calculates the weight
it will use for its vote.
These two documents are good starts there:
and for distant history, you might like Mike's hotpets paper:
Or if you want the simpler answer: "Sorry, there is no simple way to
explain it. It is all a pile of hacks stacked on top of each other. It's
a great research area where somebody could improve it. Please do."

@_date: 2014-06-28 05:54:17
@_author: Roger Dingledine 
@_subject: [tor-talk] hardware acceleration OK or not? 
which points to
Basically, some Windows systems were crashing when Tor Browser had
hardware acceleration enabled.
I think we made that change in TBB 3.5rc1:
See the (alas not labelled with a ticket number) line:
"Misc Prefs: Disable layer acceleration to avoid crashes on Windows"
It looks from the various tickets like the issue is not entirely sorted
for all users.
Be careful! I think you asked here about hardware acceleration in Tor
Browser, aka our Firefox fork, but the man page you're quoting is for
the program called tor.

@_date: 2014-06-28 15:16:51
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia as stand-alone client??? 
It is now deprecated. It has been unsupported for years. :(
The exception for now is the relay-by-default and bridge-by-default
Windows bundles. But that's mostly because nobody has replaced them with
anything better. Please do!

@_date: 2014-06-29 02:22:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Bruce Schneier's Guardian Article about N_S_A and 
Right. This is why Bruce's choice of phrase "identifying an individual
Tor user" is a poor one. Probably the better phrase would be "seeing a
flow on the Internet that they decide they'd like to attack".
Jake and I talk about the issue more in our 30c3 talk:
One of the big issues I'm still unhappy about is that they say they
never attack Americans, yet something like 13% of Tor users are coming
from America, and if you attack 1000 Tor users, statistically you can't
really say that you've never attacked an American.
And as some of the other posts in this thread explain, one of the main
features of Tor is to make it hard for you to decide *which* Tor user
you're looking at, if you only see the flow coming out of the exit relay.
Now, I'm sure they have a secret interpretation of some law that lets
them conclude they've never attacked an American, so trying to fight
this by saying they've broken the law may be a losing battle.
Also, if you happen to be not an American, all this discussion of whether
they're "really" attacking Americans or not makes you pretty angry,
because from that perspective you've already been hung out to dry.
Here are two plausible approaches I've heard for how they decide whether
to attack a given flow: a) some website out there is so bad that they want
to attack every user going to it; b) they collaborate with the website,
so when the user logs in to the account they want to target, they launch
the attack. And of course, if the website doesn't use https or doesn't
use it enough, they don't even need to collaborate with the website,
since if they're watching the flow alreadty they can just watch it login.
You might also like
where I put a lot of energy into explaining the issues to Dan.
Hope that helps,

@_date: 2014-06-29 08:31:20
@_author: Roger Dingledine 
@_subject: [tor-talk] Illegal Activity As A Metric of Tor Security and 
Hi Mark,
I've tried to tolerate the conspiracy theories / trolling here, since
there are legitimate worries to be had about what attacks various
adversaries may have come up with, even if the way you're expressing them
isn't winning you many friends. But ad hominem attacks are not appropriate
for this list, and they will get you removed from it if they persist.

@_date: 2014-06-29 14:54:03
@_author: Roger Dingledine 
@_subject: [tor-talk] Illegal Activity As A Metric of Tor Security and 
"Wtf dude?"
I'm working on the dev meeting that starts tomorrow. I'll get to answering
your concerns... soon I hope. In the mean time you might watch our 30c3
talk again, which aims to answer all of these issues.

@_date: 2014-03-01 06:17:53
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.21 is released 
Tor 0.2.4.21 further improves security against potential adversaries who
find breaking 1024-bit crypto doable, and backports several stability
and robustness patches from the 0.2.5 branch.
Packages coming soon, at which point I'll announce on the tor-announce
list too.
Changes in version 0.2.4.21 - 2014-02-28
  o Major features (client security):
    - When we choose a path for a 3-hop circuit, make sure it contains
      at least one relay that supports the NTor circuit extension
      handshake. Otherwise, there is a chance that we're building
      a circuit that's worth attacking by an adversary who finds
      breaking 1024-bit crypto doable, and that chance changes the game
      theory. Implements ticket 9777.
  o Major bugfixes:
    - Do not treat streams that fail with reason
      END_STREAM_REASON_INTERNAL as indicating a definite circuit failure,
      since it could also indicate an ENETUNREACH connection error. Fixes
      part of bug 10777; bugfix on 0.2.4.8-alpha.
  o Code simplification and refactoring:
    - Remove data structures which were introduced to implement the
      CellStatistics option: they are now redundant with the new timestamp
      field in the regular packed_cell_t data structure, which we did
      in 0.2.4.18-rc in order to resolve bug 9093. Resolves ticket 10870.
  o Minor features:
    - Always clear OpenSSL bignums before freeing them -- even bignums
      that don't contain secrets. Resolves ticket 10793. Patch by
      Florent Daigniere.
    - Build without warnings under clang 3.4. (We have some macros that
      define static functions only some of which will get used later in
      the module. Starting with clang 3.4, these give a warning unless the
      unused attribute is set on them.) Resolves ticket 10904.
    - Update geoip and geoip6 files to the February 7 2014 Maxmind
      GeoLite2 Country database.
  o Minor bugfixes:
    - Set the listen() backlog limit to the largest actually supported
      on the system, not to the value in a header file. Fixes bug 9716;
      bugfix on every released Tor.
    - Treat ENETUNREACH, EACCES, and EPERM connection failures at an
      exit node as a NOROUTE error, not an INTERNAL error, since they
      can apparently happen when trying to connect to the wrong sort
      of netblocks. Fixes part of bug 10777; bugfix on 0.1.0.1-rc.
    - Fix build warnings about missing "a2x" comment when building the
      manpages from scratch on OpenBSD; OpenBSD calls it "a2x.py".
      Fixes bug 10929; bugfix on 0.2.2.9-alpha. Patch from Dana Koch.
    - Avoid a segfault on SIGUSR1, where we had freed a connection but did
      not entirely remove it from the connection lists. Fixes bug 9602;
      bugfix on 0.2.4.4-alpha.
    - Fix a segmentation fault in our benchmark code when running with
      Fedora's OpenSSL package, or any other OpenSSL that provides
      ECDH but not P224. Fixes bug 10835; bugfix on 0.2.4.8-alpha.
    - Turn "circuit handshake stats since last time" log messages into a
      heartbeat message. Fixes bug 10485; bugfix on 0.2.4.17-rc.
  o Documentation fixes:
    - Document that all but one DirPort entry must have the NoAdvertise
      flag set. Fixes bug 10470; bugfix on 0.2.3.3-alpha / 0.2.3.16-alpha.

@_date: 2014-03-12 16:15:26
@_author: Roger Dingledine 
@_subject: [tor-talk] How do I increase hops? 
First you should learn about anonymity, entry guards, and end-to-end
correlation attacks. You probably shouldn't want to do what you're
asking about.

@_date: 2014-03-17 02:54:14
@_author: Roger Dingledine 
@_subject: [tor-talk] status of Tor's speed issues? 
Some of them are resolved, and some of them remain as theoretical
issues. It turns out that the distance between the green line and
the purple line in this graph:
is way more influential on performance than we had realized. That is,
we can mask many of the underlying technical questions by having enough
capacity in the network.
But it remains the case that too much bulk traffic can really hose the
network, so it's still the case that people shouldn't do that.
I haven't gotten around to organizing everything into a "Why else is
Tor slow" document, to go with the first one:
But you can read some notes here:
In that last URL I tag five promising directions with '*'. With some work,
you can find papers corresponding to most of them at
Sounds like a great cause. You should mail Kelley and see if she can
help you.

@_date: 2014-03-23 20:36:25
@_author: Roger Dingledine 
@_subject: [tor-talk] What is the TOR network topology 
The Tor network is a clique -- all relays can reach all relays.
And clients choose the paths, rather than having paths chosen for them
by the network.
I recommend  for more reading.

@_date: 2014-03-27 04:55:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Failed to connect to tor netword with the provided 
Ok. If the other two stop working for you, maybe you will try
Flashproxy. :)
It looks like the obfs3 bridges in the bundle are blocked by your
network. And it looks like the fte bridges in the bundle are not blocked
by your network.
Are you in China perhaps?
Note that whether the particular bridges are blocked (probably by IP and
port) is a different question from whether the protocol (obfs3 or fte)
is blocked by deep packet inspection. That is, it could just be that
somebody at GFW fetched the bundle earlier and blocked the specific obfs3
bridges that it lists, whereas they haven't fetched a recent bundle to
block the fte bridges yet.
So if you found an obfs3 bridge that GFW hasn't found yet, it would
probably still work? Worth testing. But that said, assuming you are in
China, there aren't enough obfs3 bridges total, and it's not easy to
give them out to everybody without GFW learning them too:

@_date: 2014-03-27 05:25:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Introducing Torsion, 
Neat! I encourage people here to play with it and let us know what you
think (both of its usability and of its security).

@_date: 2014-03-30 16:02:53
@_author: Roger Dingledine 
@_subject: [tor-talk] fresh TBB is damaged and can't be opened on Mac OS X 
First check the signature and see if you have a genuine accurate copy
of TBB. It sounds like you probably don't. If you don't it's probably
because of a failed download, rather than somebody malicious -- try
downloading it again?
You might also like

@_date: 2014-03-30 23:15:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Project and Youtube is blocked in Turkey too 
It certainly won't be straightforward. Clients don't cache dns answers
anymore because of various attacks:
So if you can't do dns resolves, you basically can't connect anywhere
for users.
See also

@_date: 2014-05-18 20:18:38
@_author: Roger Dingledine 
@_subject: [tor-talk] anonymous connection to private address 
You can edit your torrc to include
SafeLogging 0
and it will tell you the address. Most likely it's 127.0.0.1, but maybe
it's 192.168.1.1 or similar.
It's probably one of the applications that you're running, like Tor
Browser, which is asking for a stream to 127.0.0.1 because some website
asked it to.
I've also found that pidgin generates these log lines for me sometimes,
presumably because jabber or aim asks for some destination hostname and
for some reason the hostname resolves to 127.0.0.1.

@_date: 2014-05-18 22:54:53
@_author: Roger Dingledine 
@_subject: [tor-talk] General questions about Tor proxy 
Yep. But increasingly, it's becoming clear that a relay that can do
100mbit is more than 10 times more valuable than a relay that can do
10mbit. Plus the 100mbit relay is way less than 10 times the price of
the 10mbit relay.
So from a capacity and performance perspective, we really want to cut
out all the low and medium speed relays (say, the ones under 10mbit):
And your intuition might be (mine was) that removing those small relays
really harms diversity (and thus anonymity), but actually, Tor's load
balancing and path selection means those relays are very rarely chosen
anyway, so they don't contribute much to the anonymity the Tor network
can provide.
But from a community perspective, that's a crummy way to run a project.
So we haven't moved forward with that plan -- but it makes me unexcited
to work on a plan to get many new small relays.
First, most home connections are quite poor indeed, especially if you
need symmetric bandwidth levels.
But the reason running exits at home is now considered extremist
is because every so often some jerk will do something through
the exit relay that attracts some law enforcement group, and
while we're making great progress at teaching some organizations
(like FBI) about why and how to check if the door they're about
to kick down is a Tor relay (bad for us, but also bad for them,
since it's a waste of time that could have been spent elsewhere:
 ),
it seems like there's always another law enforcement agency somewhere
in the world that claims jurisdiction but has no idea how the Internet
And when they kick down the door, they don't know what to take, so they
take everything electronic. And then they don't have the specialists
to examine the stuff they took, so it sits on a shelf for six months.
All it takes is a few stories of ordinary people who've had their spouse
surprised at 6am to make it seem like it happens to every relay operator
every time. But that said: how many such stories are too many? It's
really crummy when it happens to even one person who didn't expect it.
Are you arguing for forums? So far we've avoided having Tor forums
because most competent people will ignore them, leaving users to fend
for themselves among other users, which isn't really a great outcome.
The tor.stackexchange.com experiment is a step in the right direction
I think.
But to be clear, I should point out that your questions in your original
mail are all "expert" questions. If you want to use some application
with Tor that isn't Tor Browser, somebody needs to audit it to see if
it will work as you want. Very little auditing has been done so far,
and it's not really the sort of thing normal users should (can) do.
Did you try Tor's support service?
I think part of our challenge is that we have too *many* communities and
ways to interact with us -- there's the blog, the mailing lists, irc,
stackexchange, conferences, talking to journalists with traditional
phones, etc. Few people know about all of these avenues, but worse,
once somebody has found one they assume it's the only one.
Actually yes. Whether we're doing everything the right way is a separate
question, but there are in fact people who work on teaching broader
communities about Tor. You might like these two links to start:
Funny story, speaking of the law enforcement agency discussion above:
I was talking to an FBI agent recently who uses Tor for his job and
is a huge fan, and he pointed out that we have a PR problem, and his
suggestion was that we redirect 20 of our employees ("not too many,
but a few") to do PR for a while. He was stunned to learn that 20 is
more employees than we have in total -- he thought surely Tor is a 120
person company, what with all the great things we do and have done.
Tor has a special challenge in that we want to reach many different
user communities -- activists, ordinary people, companies, journalists,
law enforcement, and everyone in between -- and everybody thinks that
whatever they just learned about Tor is what everybody else learned too.
For more details you might like (or dislike) our 30c3 talk:
Please help make tor.stackexchange.com succeed.
Wow. I think that qualifies as enough off-topic that I'm going to
skip over it. But I encourage you to meet Tor people in person rather
than extrapolating from these assumptions.
They do -- see the above links for example. But it's certainly not only
on the mailing lists. You might also like the Tor Weekly News posts. But
most of all, we sure can't teach the whole world about security while
also making good software, so we need you all to step up and help.

@_date: 2014-05-19 02:00:18
@_author: Roger Dingledine 
@_subject: [tor-talk] General questions about Tor proxy 
Maybe you read
only 9 months ago? Hopefully that is less than years. :)
The 2013 audit is still in progress. If last year is any measure, you
should expect it in a few months. I expect the 2013 one to be, at a
high level, about the same as the 2012 one.

@_date: 2014-05-23 18:33:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Onion Pi and Tor Talk Meta 
No, Tails explicitly configures its applications to use Tor as a proxy,
and then drops all unexpected connections. That's the safer thing to do --
if you get a connection from an application that you didn't explicitly
configure to use Tor, it's unlikely to be using Tor safely.
The alternative is to just Torify everything blindly. In that situation
you end up with people using their Internet Explorer over Tor and
thinking they're doing it right, when actually they're missing all the
application-level security/privacy features from Tor Browser:

@_date: 2014-11-07 16:42:11
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and Anonymous browsing etc. 
To take this a step further: please don't use Tor for bulk downloading. It
hurts performance for the other Tor users, it confuses people about what
Tor is for, and in many cases it is technically unsafe as well:

@_date: 2014-11-12 20:53:03
@_author: Roger Dingledine 
@_subject: [tor-talk] "Hidden Services" vs "Onion services" 
Hi Virgil,
I think onion service is a fine phrase. It makes people have to learn
what it is rather than guessing (and often guessing wrong).
I worry that "Tor service" will confuse people, first because it might
make them think it's a thing run by Tor, but second because it might
reinforce that this use case of Tor is what Tor is. (I already have
journalists contacting me asking if other social media sites should
let their users reach them via Tor, and that isn't what they mean to be
asking but here we are.)
I also floated the phrase "protected service" on
but I don't think it stuck (and also it's a bit klunky).
The other one I've heard and liked was "Tor-enabled service", but I think
the jury is still out on whether that's a good one or too confusing like
"Tor service".
Thanks for checking first. There sure is a lot going on these days,
and I can see how some things might not seem to be land mines but
then turn out to be.
I'd say pick your favorite and start using it and see if it catches on?
I'm pretty sure by now if you say "onion service" people will know what
you mean, so that might be another vote in its favor.

@_date: 2014-11-14 19:42:42
@_author: Roger Dingledine 
@_subject: [tor-talk] Netflow analysis breaks Tor 
I put up a few pointers here for readers to get up to speed:
There sure are a lot of things going on in Tor-land these days, but I
don't think this has much to do with any of the other recent stories.
Rather, some journalist thought this would be a great time to drop
another story.
In summary, it's great to see more research on traffic confirmation
attacks, but a) traffic confirmation attacks are not a new area so don't
freak out without actually reading the papers, and b) this particular one,
while kind of neat, doesn't supercede all the previous papers.

@_date: 2014-11-14 21:17:15
@_author: Roger Dingledine 
@_subject: [tor-talk] ChatSecure Problem? 
Hi Juan,
Remember that this list has many thousands of people on it. Using it
for personal attacks and off-topic discussions harms everybody.
As Tor has continued to grow in attention and users lately, there are more
people paying attention and they all want to get involved in some way.
Let us all please work towards helping that involvement be a positive one.

@_date: 2014-11-23 20:37:25
@_author: Roger Dingledine 
@_subject: [tor-talk] Propsal for decentralization of the Tor network 
Check out
for another step in that direction.
And then
for another direction to consider.
The current situation is that nobody knows of a design that, in your
words, will "guarantee full independence and anonymity". The one we have
is well-studied and has well-understood downsides, so I'm not eager to
move to one that is poorly-studied and has poorly-understood downsides.

@_date: 2014-10-03 16:46:14
@_author: Roger Dingledine 
@_subject: [tor-talk] (FWD) 
The deadline for comments is Oct 17.
This isn't going to fit on my plate in this timeframe, but if anybody
here has partially written ideas that they want to put together into a
submission, please do!

@_date: 2014-10-06 22:27:43
@_author: Roger Dingledine 
@_subject: [tor-talk] isp monitoring tor 
I agree with the number two, but I would have picked different
attacks. The first is traffic correlation, which is the one discussed
in this thread. The second is website fingerprinting.
For the general background on Tor attacks, see
For the traffic confirmation attack, see the links in
And for website fingerprinting, see

@_date: 2014-10-11 19:17:32
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Relay Smartphone App 
Unfortunately, your smartphone likely doesn't have the cpu to push much
traffic, and also your home wifi or equivalent very likely doesn't have
the bandwidth to be a good relay.
So this is a really appealing idea in theory, but in practice such relays
are much much less useful than faster relays -- to the point that slow
relays actually hurt the network because they produce bad performance
for users who are unlucky enough to pick them.
It would be cool to live in a world where things were different --
perhaps one day somebody will do the rest of the research and
engineering work involved in making the Conflux design work:
But we took a step in the direction away from Conflux when we moved
from three guard nodes per user to one.

@_date: 2014-10-14 17:10:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Reasoning behind 10 minute circuit switch? 
It was alas picked arbitrarily. As Nick notes, it used to be 30 seconds,
and then when we started getting users, all the relays complained of
running at 100% cpu handling circuit handshakes. We changed it to 10
minutes, and the complaints went away -- at least until the botnet
showed up.
We've had an open research question listed for years now -- see bullet
point 4 on
Right now Tor clients are willing to reuse a given circuit for ten
minutes after it's first used. The goal is to avoid loading down the
network with too many circuit creations, yet to also avoid having
clients use the same circuit for so long that the exit node can build a
useful pseudonymous profile of them. Alas, ten minutes is probably way
too long, especially if connections from multiple protocols (e.g. IM and
web browsing) are put on the same circuit. If we keep fixed the overall
number of circuit extends that the network needs to do, are there more
efficient and/or safer ways for clients to allocate streams to circuits,
or for clients to build preemptive circuits? Perhaps this research item
needs to start with gathering some traces of what requests typical
clients try to launch, so you have something realistic to try to
Also note that if a stream request times out (or for certain similar
failures), you move to a new circuit earlier than the 10 minute period.
So it might be that users actively browsing will switch much more often
than every 10 minutes. Somebody should study what happens in practice.
The future plan is to isolate streams by domain, not by time interval:
But of course there are some tricky engineering and security
considerations there.
And lastly, see
for a standalone related analysis/research project that I wish somebody
would do. :)

@_date: 2014-10-16 14:51:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Wrong links on Tor Browser download page 
Confirmed. It looks like Andrew was the last to push to the website --
Andrew, can you check your ./publish process and make sure that it
includes an 'svn update' before the build and push step? Or can you
otherwise try to figure out what went wrong to avoid doing it again? :)
I've pushed a new (up-to-date) version of the website in the meantime.

@_date: 2014-10-16 15:51:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Wrong links on Tor Browser download page 
Yes. But it only checks every 90 minutes or so.
See for a clearer explanation.
I *think* if you just leave your TB 4.0 running, it will recover on its
own. Based on what Mike just told me. If not, a restart should help.

@_date: 2014-10-24 00:39:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Russian Tor exit relay messing with traffic 
Hi Josh,
I tried to write this comment at the bottom of
but your comment system wouldn't let me write into the name and email
address boxes. So I've written it here.
Thanks for the detailed analysis! We've now set the BadExit flag on
this relay, so others won't accidentally run across it. We certainly do
need more people thinking about more modules for the exitmap scanner. In
general, it seems like a tough arms race to play:
and as you say, the better approach is to have applications not blindly
trust unauthenticated bits they get from the Internet.
This discussion also reminds me of the very first misbehaving exit relay
we found:
It turned out to be a Tor relay in China that was getting attacking by
its ISP, and all the Tor users were just collateral damage from the ISP
attacking all its users. I think it is alas also hard to tell if this case
was a malicious Tor relay or an innocent Tor relay's malicious upstream.
Thanks again for your help, and please let us know if we can be useful
to you in the future.

@_date: 2014-10-27 07:20:36
@_author: Roger Dingledine 
@_subject: [tor-talk] recent firefox releases 
Vidalia was just a program to help you visualize what's going on with
Tor, and help you launch your Tor program. It didn't have anything to
do with Firefox.
But yes, you're right that long ago the Torbutton extension provided a way
to switch your Firefox between "using Tor" and "not using Tor". But that
turned out to be hard to keep safe:
and in retrospect it was probably a good decision:
Have you tried the recent Tor Browser releases? They start much faster
for me than the old ones.
Agreed, this is not a wise choice.
This is exactly what many of us do. Tor Browser is designed to not
interfere with your other Firefox install. They shouldn't be interfering
in any way. If they are, either you're using it wrong (in which case
maybe there's a usability issue we can fix), or there's a bug that it
would be great to hear about.

@_date: 2014-10-31 00:02:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Can Tor run over Tor? 
Also have a read through
for how we'd like to disable Tor-over-Tor one day to block an
attack (but there are tradeoffs).

@_date: 2014-10-31 08:54:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Facebook brute forcing hidden services 
I talked to them about this. The short answer is that they did the vanity
name thing for the first half of it ("facebook"), which is only 40 bits
so it's possible to generate keys over and over until you get some keys
whose first 40 bits of the hash match the string you want.
Then they had some keys whose name started with "facebook", and they
looked at the second half of each of them to decide which one they thought
would be most memorable for the second half of the name as well. This
one looked best to them -- meaning they could come up with a story about
why that's a reasonable name for Facebook to use -- so they went with it.
So to be clear, they would not be able to produce exactly this name
again if they wanted to. They could produce other hashes that started
with "facebook", but that's not brute forcing all of the hidden
service name (all 80 bits).
For those who want to explore the math more, read about the "birthday
And for those who want to learn more (please help!) about the improvements
we'd like to make for hidden services, including stronger keys and
stronger names see,

@_date: 2014-09-03 22:25:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Tentative results of analysis of data on 
Hi Virgil,
Neat analysis!
I think putting this up on the Tor blog, once it settles a bit, is a
fine plan.
You might also want to put it together as a Tor tech report, to go
with the other ones that Karsten has done, some of which are about
metrics data:
In the mean time, here are some thoughts:
- Figure 3 is a bit weird. Our bandwidth-per-relay stat is a function of
how many total relays we have, but not really a function of the growth
in total relays. So if for example we added a bunch of fast relays,
but we also added even more slow relays, then this graph would show
that bandwidth-per-relay isn't growing. So I guess the question is:
what conclusions should we draw from Figure 3? If it levels off or goes
down in the future, does that indicate a bad thing in any way?
Or said a different way, maybe we should be graphing the mean bandwidth
of the fastest k relays in the network? That's sort of what we had in
mind with
and it better shows the growth in capacity of the network, in a way
that wouldn't be dragged down by adding a whole bunch of fast relays
(which people use) but also adding a whole bunch of slow ones (which
people don't use).
Which leads to: we want something that takes into account Tor's
"clients choose relays proportional to their bandwidth" load balancing.
like you're trying to use bandwidth-per-relay as a stand-in for
expected-bandwidth-for-the-client, which I think it isn't because clients
don't select relays uniformly.
Also, it would appear that this Nielsen's law is about bandwidth that home
users get in one direction. I think that's probably quite different from
bandwidth that hosted servers get in both directions. Does Nielsen's law
say anything about upstream bandwidth? Did you bring it up just because
they both said 24 months, or am I missing the tie-in?
- When you say "Torperf speeds double" I get confused, because Torperf
primarily measures in seconds-to-fulfill-the-request, where lower is
better. Maybe you should avoid the word 'speed' and use either 'latency'
or 'throughput'?
(Several times you say 500 KiB when I think you mean 50 KiB?)
I think a lot of the explanation for Figure 5 comes from the fact that
Torperf mushes together two measurements -- first is the round-trip
involved in asking for the file, and second is receiving the cells that
make up the file. In the 50KB case it all fits in one flow control window,
so it really is just these two components (and we see the difference
clearly in the y-axes of your Figure 6b graphs). In the 1MB case that's
four or five congestion windows worth of cells, so it's again mushing
together round-trip times with throughput.
(Actually, let's think about that one more -- at 498 bytes of application
data per cell, and 500 cells per stream window, that's 249000 bytes per
stream window, so going through four stream windows means you've fetched
996000 bytes -- just shy of getting those last 9 data cells, and you then
have to wait for another round-trip! So I think one conclusion is that
our Torperf results for 1MB and 5MB are non-linear in quite subtle ways.)
So comparing our Torperf results to this Ookla data... which appears to
simply be throughput? If the round-trip latency does indeed play a bigger
role in Tor than it does on the normal Internet, then this comparison
might be apples to oranges. I wonder if there's a way, given the 50KB /
1MB / 5MB data, to separate out these two components?
- For your Figure 6a, there's a challenge here because the "number
of clients" graphs are the number of Tor clients running, not
the number of Tor clients clicking on something at once. Getting
a better handle on client behavior is an open research problem
(and Nick Hopper's lab at UMN is looking into exactly that:
 )
but some papers like  tend
to consider the set of "active" clients in the tens of thousands range,
not the millions range. It sure would be neat to get a better handle on
the number of clients who are typically vying for bandwith at once --
I bet it's way less than 2 million.

@_date: 2014-09-08 20:05:54
@_author: Roger Dingledine 
@_subject: [tor-talk] What should our 31c3 talk be? 
The 31c3 talk proposals are due this coming Sunday:
I wonder what would be the most useful topic for this year?
In brainstorming with folks on IRC, here are four options:
1) An update on pluggable transports: obfs3, obfs4, FTE, librtc and
uproxy, and other acronyms you don't recognize. Many transports are now
integrated into the default Tor Browser, we're starting to get some more
useful usage statistics, and pluggable transports have played an important
role in various countries in recent years. Plus we're soon going to start
some projects on evaluation and comparison of transport designs, e.g.
One of the most intriguing pieces of pluggable transports lately is
the convergence of "make it hard to DPI for the protocol so the censor
can't block it" with "make it hard to DPI for the protocol so the global
surveillance adversary doesn't know to add that flow to its database".
In particular, systems like Flashproxy might be especially effective
against the global surveillance adversary, since the many transient
addresses that separate the users from the known Tor relay addresses
make it harder to build a list of users that are worth watching.
2) News on the Tor Browser front: all about our deterministic builds, and
what they get us, and who else is jumping on the bandwagon. A discussion
of the upcoming secure update mechanism, and what security properties
it does/doesn't get us. Tradeoffs with blocking or not blocking ads,
or with enabling or disabling javascript.
3) Double down on the transparency push: walk through all the entries
in  and
explain what we're doing for each of them. I think it would be useful
for more of the Tor community to know more details here, but I'm not
sure how to do it in a way that doesn't just turn into a big laundry
list, like the 29c3 talk did:
4) Some sort of more generic Q&A where we raise a bunch of topics
to start, and then inefficiently take questions from the audience,
try to make sense of them, and then talk about whatever comes to mind
in response.
Two lessons I've learned from recent CCC talks:
A) Social commentary works much better than technical things. That is,
the audience respects us for our technical work, and now they want to hear
our perspective on what's going on in the world. So while my instinct
is to use the talks to make the audience more technically competent and
thus more able to help us in this growing global conflict, the talks
that work best these days are more like social rallies.
B) It won't work to pick a more technical topic and ask for a smaller room
to focus on the people who most want to help. The room will still get
mobbed by thousands of people who are there 'for the show'. We learned
this lesson in 29c3. And to be fair, Tor is a major component in the
modern security and privacy conversation, so following what Tor has to
say, even if you're not planning to do anything to help, makes sense.
Is there a fifth topic I should be considering?
So far item 1, the pluggable transport one, seems most plausible to me.

@_date: 2014-09-10 07:43:38
@_author: Roger Dingledine 
@_subject: [tor-talk] socks connect 
I think the "DNS requests are being done by your application rather
than passing the hostname into Tor" theory is a likely one.
But telling your Pidgin to use an http proxy (privoxy or polipo) as a
socks5 proxy is definitely not going to do what you want. :)
In my case I configure my Pidgin to use the proxy type called
"Tor/Privacy (SOCKS5)". This setting tells Pidgin that you really
do want the traffic to go through the proxy, and if it can't use the
proxy you would rather it not attempt the connection. If your Pidgin
doesn't have this proxy type, you should consider upgrading.
TestSocks 1
which will make your Tor client log more useful debugging things for you.
Hope that helps,

@_date: 2014-09-11 23:34:56
@_author: Roger Dingledine 
@_subject: [tor-talk] 5 million dollar company close to shut down due to 
I agree with Lunar here -- this is a story of some jerk on the Internet,
and Tor is barely in the picture.
(One could argue that without Tor's hidden service feature, websites
like this would not exist. But I think that's demonstrably not true,
given all the websites like this in the world that don't use Tor hidden
services. See also the tail end of the discussion about Farmer's Market at
If all the world were one jurisdiction, then we could start to talk
about how to handle edge cases like this one. But of course that scenario
would have problems of its own.)
For those who want to read about a related, but different, topic in a
different culture, check out

@_date: 2014-09-13 18:42:25
@_author: Roger Dingledine 
@_subject: [tor-talk] Comcast looking for Tor traffic, 
This article confuses me.
For example, it has this statement:
"Because Tor Browser provides online anonymity to its users, only the
ISP used along with it can ascertain what activity takes place on Tor."
which sure makes it sound like the author thinks that the local ISP
can learn what destinations you are visiting, which isn't (supposed to
be) true.
And then this statement:
"Comcast has previously been blacklisted by the Tor project." sounds
like maybe it's referring to
which a) has to do with recommended relay locations, and b) isn't
really "the Tor Project", but I can understand how they'd be confused.
That said, I guess part of the confusion here stems from a lack of
transparency on Comcast's side, about what guidance they're giving their
first-level helpdesk people. Is this two rogue underpaid undereducated
employees who read an article about Tor and decided it should stop
existing? Or is there some document that Comcast wrote? If the latter,
can somebody get us a copy of it?

@_date: 2014-09-14 01:16:54
@_author: Roger Dingledine 
@_subject: [tor-talk] What should our 31c3 talk be? 
I really like this idea. But I'm not in a good position to pull it
together -- I make a habit of not remembering the contact details for
the people who would be best for this.
Also, we have to get the right people, with a bit of vetting or practice
or something, else they will freeze up in front of 6000 people and then
things don't go as planned.
So I'm afraid my answer is "yes, somebody should do this", which is
usually equivalent to not answering at all. :/
Maybe somebody has a plan for moving it forward?

@_date: 2014-09-23 14:55:35
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.24 and 0.2.5.8-rc are out 
Tor 0.2.4.24 fixes a bug that affects consistency and speed when
connecting to hidden services, and it updates the location of one of
the directory authorities.
Tor 0.2.5.8-rc is the second release candidate for the Tor 0.2.5.x
series. It fixes a bug that affects consistency and speed when
connecting to hidden services, and it updates the location of one of
the directory authorities.
Changes in version 0.2.4.24 - 2014-09-22
  o Major bugfixes:
    - Clients now send the correct address for their chosen rendezvous
      point when trying to access a hidden service. They used to send
      the wrong address, which would still work some of the time because
      they also sent the identity digest of the rendezvous point, and if
      the hidden service happened to try connecting to the rendezvous
      point from a relay that already had a connection open to it,
      the relay would reuse that connection. Now connections to hidden
      services should be more robust and faster. Also, this bug meant
      that clients were leaking to the hidden service whether they were
      on a little-endian (common) or big-endian (rare) system, which for
      some users might have reduced their anonymity. Fixes bug 13151;
      bugfix on 0.2.1.5-alpha.
  o Directory authority changes:
    - Change IP address for gabelmoo (v3 directory authority).
  o Minor features (geoip):
    - Update geoip and geoip6 to the August 7 2014 Maxmind GeoLite2
      Country database.
Changes in version 0.2.5.8-rc - 2014-09-22
  o Major bugfixes:
    - Clients now send the correct address for their chosen rendezvous
      point when trying to access a hidden service. They used to send
      the wrong address, which would still work some of the time because
      they also sent the identity digest of the rendezvous point, and if
      the hidden service happened to try connecting to the rendezvous
      point from a relay that already had a connection open to it,
      the relay would reuse that connection. Now connections to hidden
      services should be more robust and faster. Also, this bug meant
      that clients were leaking to the hidden service whether they were
      on a little-endian (common) or big-endian (rare) system, which for
      some users might have reduced their anonymity. Fixes bug 13151;
      bugfix on 0.2.1.5-alpha.
  o Directory authority changes:
    - Change IP address for gabelmoo (v3 directory authority).

@_date: 2014-09-24 10:57:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.4.24 and 0.2.5.8-rc are out 
Debian Jessie will come out soon, and we decided along with our fine
Debian maintainer that getting Tor 0.2.5.x into Jessie was a good move.
Also, Tor 0.2.5.8-rc is a real live release candidate, meaning unless we
find horrible things wrong with it, Tor 0.2.5.9 will be the next stable
release (with changes only to documentation).
So what better way to find any remaining horrible things than to upgrade
all of our local deb users? :)

@_date: 2015-04-02 20:21:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor isn't opening a listening port... 
Tor doesn't open those ports. It simply interprets incoming (inside of
Tor) requests for that hidden service name and makes outgoing connections
to the address you specify. You have to run your own application on the
port if you want something to listen there.
Makes sense -- it sounds like you aren't running anything on that port.

@_date: 2015-04-19 19:26:37
@_author: Roger Dingledine 
@_subject: [tor-talk] Clarification of Tor's involvement with DARPA's Memex 
Hi Thomas,
Thanks for asking. I apologize for not explaining these answers
earlier. I'm still trying to find the right balance for my time between
mentoring people in the Tor community vs better broader communication too.
Let me give you some background, and then I'll answer your question.
First of all, yes indeed we've been getting some funding from the
Memex project. This is what has allowed us to pay attention to and move
forward on some of the really cool things we've been working on lately
for hidden services:
* Fixing many performance and consistency problems with hidden services,
* Fleshing out the design and analysis for the "direct onion service"
option that folks like Facebook want:
plus discussing other tradeoffs between upcoming design choices:
* The work to let Tor controllers configure a hidden service directly
without using the torrc file, which the Globaleaks folks (among others)
are really excited to start using:
* The privacy-preserving statistics that let us conclude numbers like
"3-4% of Tor traffic is hidden service related" and "there are around
30000 hidden services today":
* Assessing, triaging, and putting out new Tor releases to fix
hidden service security (stability) bugs recently:
* I hear that Rob Jansen and others have been working on a more realistic
replacement for TorPerf (
which will let us measure performance to a hidden service over time and
better understand where the bottlenecks are.
* I've also been talking to EFF about kicking off a Tor Onion Challenge
(to follow on from their Tor Relay Challenges), to a) get many people
to make their website or other service accessible as an onion site,
and b) come up with and/or build a novel use of onion services, to go
with the quite cool list that we have already but have done a poor job
of publicizing: Pond, Globaleaks, SecureDrop, Ricochet, OnionShare,
facebook's https onion, etc. You see, I used to be on the "making your
normal website reachable as an onion service is stupid" side of the fence,
but I have since come to realize that I was wrong. You know how, ten
years ago, website operators would say "I don't need to offer https for
my site, because my users ____" and they'd have some plausible-sounding
excuse? And now they sound selfish and short-sighted if they say that,
because everybody knows it should be the choice of the *user* what
security properties she gets when reaching a service? I now think onion
services are exactly in that boat: today we have plenty of people saying
"I don't need to offer a .onion for my site, because my users _____". We
need to turn it around so sites let their *users* decide what security
(encryption, authentication, trust) properties they want to achieve
while interacting with each site.
Our "3-4%" stat has actually been used by some of the other people (at
other groups) who are funded by Memex. They're talking to (among others)
the child porn division of the Department of Justice, and I've taught them
enough about Tor that they've basically turned into Tor advocates on our
behalf. They've found actual numbers to be really useful at countering the
FUD that some government people start out with. One of these people
explained to me last week that they listen to her more than she thinks
they'd listen to me, since she shows up as a neutral party. In any case
I am happy to have more people working on the "teach law enforcement
how Tor actually works" topic, which you can read more about here:
We do indeed need to be very careful and very thoughtful about what
things in the Tor network are safe to measure. The general heuristic we've
been using so far is: "Is that measurement taking advantage of something
that you could instead fix? If so, it's not ok to measure it." A prime
example here of what's over the line is running relays that get the
HSDir flag and then recording what hidden service descriptors they see
(and thus what hidden services they learn about). We would instead like
to treat that as a vulnerability and fix it:
and see also the "Attacks by Hidden Service Directory Servers" section of
as well as the section after it. (There are other researchers who have
used that technique, e.g.
 and also Gareth Owen's
talk at 31c3. But we need to hold ourselves to a higher standard.)
On the other hand, if people publish a .onion address on a normal
website and Google runs across it and indexes the name, then it seems
clear that that's public information. There are many other ways to learn
about hidden service names which are ethically in-between, e.g.
These are great topics for us as a community to keep discussing.
Similarly, if your .onion address is public, and your webserver
doesn't require any authentication, and somebody fetches the content
on it... that also seems like public information. And if, for example,
the onion service is a forum, and users go there and then write their
names down or provide other identifying information, that isn't really
a bug or design flaw that Tor can fix.
These days there are services like Ahmia that list and index a bunch of
onion names and content:
And to be clear, I think this is a great trend: we need to make onion
services easier to understand and more accessible (and faster and more
robust) for ordinary people, or we'll remain stuck with all the metaphors
that include the word 'dark'.
Ok, now that I've provided some background, I should try to answer your
question more clearly: we're using the Memex money to make hidden services
stronger, and we're teaching other people how Tor works. In terms of
teaching, it's the same thing I do for every other audience: explain about
all the projects Tor works on (Tor, Tor Browser, pluggable transports,
metrics, OONI, ...), which projects do what, how to measure and assess
Tor's anonymity, what problems we don't have great answers for, and so on.
Part of making Tor work better means that it works better for these people
too. And some of these people are indeed working on tools to gather and
organize public content from hidden services, with the intent that groups
like law enforcement will find their tools useful. We're not working
on these tools, but when Tor becomes better (for everybody) these tools
work better (for the groups they have in mind). It is a tricky balance,
but I think we have the balance right in this case.
Would I rather have funding where it's easier to find a good balance?
Absolutely. That's a major part of why we've been talking about funding
and funding diversity so much lately, and why we've been thinking about
crowdfunding specifically for hidden service design improvements, and
about growing our donation base and sustainability through donations
and other avenues. We need help from all of you to get there.
I don't want to play the "they'd do it anyway" card too strongly here --
first because who knows, maybe they wouldn't, and second because there
are definitely some activities that you stay away from no matter the
balance. I've talked a lot with the program manager of Memex, and he's
completely supportive of the "don't weaken Tor" mandate. In that sense
we're aligned: he very strongly believes that weakening Tor would screw up
this balance. I trust his intentions, and in any case we're the ones doing
the technical side of Tor so we can make sure that we do the right thing.
I should also make clear my opinion on some of the bad uses of Tor.
The folks who are using Tor for child porn, even though they are a tiny
fraction of overall Tor users, are greatly hurting Tor -- by changing
or reinforcing public perceptions of what privacy is for, and also
by attracting the attention and focus of law enforcement and making
that the way that law enforcement first learns about Tor. So, fuck
them, they should get off our network, that's not what Tor is for and
they're hurting all of us. Now, that doesn't mean we should weaken Tor,
even if we don't want them on the network. That slope is too easy to
slip down, and we must not get into the business of dictating what
is acceptable behavior for Tor users (which would eventually lead to
designing technical mechanisms to enforce these choices).
I just went back to re-read the Forbes article, and in retrospect it
sure makes it look like all of these companies are working on tools that
relate to Tor hidden services. They aren't. The main focus for Memex is
on automatically parsing and collecting info from ads on e.g. craigslist,
and generally getting better at the 'big data' side of searching and
organizing this data. More generally, Memex is made up of a bunch of
different companies, each doing their thing. I guess this is another
casualty of the ambiguity of the phrases 'dark web' and 'deep web',
since journalists find them hot to talk about but nobody reliably knows
what they refer to.
If you want to follow along with the actual technical work we're doing,
I invite you to observe or participate in the periodic "SponsorR"
meetings that happen on IRC:

@_date: 2015-04-23 00:08:05
@_author: Roger Dingledine 
@_subject: [tor-talk] SIGAINT email service targeted by 70 bad exit nodes 
Thanks for reporting them. Exciting times we live in.
Philipp, could you count up what fraction of the network (by capacity)
these relays were? It is fun to hear big numbers like 70 relays, but at
least in the past, these attacks that involved many relays have actually
been a tiny fraction of the network's capacity -- meaning even though
it seems like a lot of relays, in practice the chance that a Tor user
will stumble across any of them remains low.
Yes indeed. For those who want to read more about the badexit arms race,
check out my earlier post on this topic:
I'm sorry to hear that some jerk wants to break into your website.
See above question about number of relays vs capacity of the relays --
it would be great to learn more information before jumping to conclusions.
Some very dedicated jerk can probably spin up VPSes at a bunch of places,
at least for a while.
I guess that leads to the next question: how long were these relays
around, and with what patterns did they join the network?
This is not great logic. You're running a website without SSL, even though
you know people are attacking you? Shouldn't your users be hassling you
to give them better options? :)
As you say, SSL is not perfect, but it does raise the bar a lot. That
seems like the obvious next step for making your website safer for
your users.
Yes indeed. Thanks again for reporting them.

@_date: 2015-04-29 11:07:49
@_author: Roger Dingledine 
@_subject: [tor-talk] always get the same entry node 
This is indeed a feature. Check out
for the reasoning behind it.
And if you want to read way way more, also check out

@_date: 2015-08-03 02:23:56
@_author: Roger Dingledine 
@_subject: [tor-talk] TORBOX 
Hi! Can you give us more details about what this "torbox" thing is?
It is not a thing made by Tor, or endorsed by Tor.
But it sounds like their name has confused you into thinking it is. :(
If you can give us some hints, hopefully we can track them down and
encourage them to make it clearer to the world that they are not Tor,
to help future users not get confused.

@_date: 2015-08-03 02:52:59
@_author: Roger Dingledine 
@_subject: [tor-talk] Circuit Fingerprinting Attacks: Passive 
Hi Jon,
Yes. I wrote about it here:
(That text is actually a part of the Ars article that you quote above.)

@_date: 2015-08-13 03:30:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Multicore, bandwidth, relays, capacity, location 
(Ugh -- please don't cross-post across lists. I'm going to pick the
list that had the previous thread on it.)
Careful! I think this is a really bad conclusion. There is no practical
way for the Tor network to use all of its capacity, and we shouldn't
expect it to. Normal networks start to fall apart when they reach around
20-30% of total capacity. The Tor network is still way overloaded --
just not as overloaded as before.
First, operating at 100% capacity would imply that we somehow line
up every relay in every circuit to never have any spare capacity. In
practice, each circuit will have some relay that is smallest / most
congested at the time. The goal for performance is to have that smallest
relay be not too bad.
Second, a network operating "at" capacity pretty much guarantees
congestion at most relays. In an ideal world, every relay would have
spare capacity for every circuit. Or to put it another way, whenever
a relay runs out of bandwidth (e.g. it hits its rate limit), then that
adds a delay to all the circuits that are still hoping to get traffic
through it. Or to turn it around once more: we want to minimize the
number of cases where relays are operating at capacity. Excess capacity
is necessary for good performance.
For a historical perspective, you might enjoy the "Why Tor is slow"
document and video:
(Some of the issues have been fixed since then, and some of them have

@_date: 2015-12-12 04:34:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.7.6 is released 
Right. I hear there is a regularly scheduled Tor Browser update coming
out on Tuesdayish. There won't be another (regular scheduled) one of
those until mid January or something, so this seemed like a good time
to make sure we got a new 0.2.7 release out.
Right. The bug doesn't lead to deanonymization directly, but it can make
some existing attacks more effective.
First, for background, read
(I'm sorry that it's long, but this is an important topic which is not
easily summarized in a few simple sentences.)
Two of the existing attacks that I'm thinking of above are:
A) If you picked a guard and it went away the next day, you'd be forced
to pick another one. If this happened often, you'd end up "touching"
many more entry guards than you would in the ideal case where all guards
are up forever. We only assign the Guard flag to relays that tend to be
available a lot of the time, with the goal of reducing the impact from
this "natural churn". (Tariq's paper from the above blog post looks at
this question.) So if clients mistakenly treat all relays like they have
the Guard flag, then they might pick flaky ones, thus increasing the rate
of natural churn, thus increasing the expected number of entry guards a
client will touch in a given time period. I don't think this one is a big
deal -- it's certainly worth fixing, and fixing it will improve anonymity,
but I don't think the rate of natural churn is hugely higher for all the
relays than for just the relays with the Guard flag. Or said another way,
there are enough fast and stable relays that you'll probably hit upon a
good relay pretty early in the process. (Somebody here could use the
public metrics database to check, if they wanted!)
B) One of the nice side effects of only giving the Guard flag to relays
that have been around a while is that when some jerk signs up 100 relays
on Amazon EC2, these relays will never interact directly with users
for the first week or so. But if clients mistakenly treat all relays
like they have the Guard flag, then they don't necessarily have this
"waiting period" for newly born relays. I don't think this one is a
big deal either -- first because it takes several days before they get
measured by the bwauths, so some of this waiting period is still in place,
and second because clients with existing guards will probably not rotate
to a new guard at the moment that the new relays show up.
Clients still choose their new guards proportional to their speed, and
many of the fast relays have the Guard flag, so for many users there
won't be much difference. But for a tiny number of users, they could
end up picking an entry point that very few other people have picked,
and that could have crummy consequences for them. For more on issues
like those, you will enjoy this HotPETS paper from last year:
Hope that helps,

@_date: 2015-12-12 04:43:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Does #17772 affect entry or directory guard or both? 
In the default configuration, your client makes sure that it has at
least 1 entry guard to use for making its normal circuits, and at least
3 entry guards to use for fetching directory info.
On first boot, when you have no guards yet, the first thing your Tor does
is try to fetch directory info. At that point it selects 3 entry guards,
and goes about bootstrapping. When it's time to make a normal circuit,
it checks to see that it has at least 1 entry guard, and it does (it
has 3), so it is happy and continues.
The process of picking an entry guard to use as a directory guard (aka
"picking a directory guard") is a bit different than the process of
picking an entry guard to use for normal circuits, since you want to
make sure it has an open DirPort, it's a new enough version that it will
have answers to the directory questions you want to ask, etc. And the
bug was in the "picking a directory guard" piece.

@_date: 2015-12-12 05:53:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.7.6 is released 
If you upgrade, then the next time you rotate to a new guard, you'll
pick a smarter one.
It doesn't ditch your current guard. I figured I didn't want to force a
rotation, especially one that a lot of people will do around the same
time period. And anyway it will be all resolved in a few months after
the upgrade.
I also thought about changing the behavior so we avoid our current guard
whenever it is missing the Guard flag -- which would basically accomplish
your above goal. But that idea has problems of its own, and some of them
look worse than what it cures:

@_date: 2015-12-12 18:03:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.2.7.6 is released 
Actually, I think the reason is that when we moved to 0.2.7.5 as stable,
nobody updated the two places on the website that needed to be updated.
I've just done that. Also I filed
 so Nick can make
some guesses about how to improve the chances that it gets done for the
next stable transition.

@_date: 2015-12-14 17:45:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Machine readable index of stable/unstable release 
You might enjoy
(the top two lines are what you want)
(requires a bit more scraping)
In theory, one day we're going to switch away from wml for the website,
so that wmi file will break then. But that theory could continue to take
a good long while to come true.

@_date: 2015-12-14 18:14:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Machine readable index of stable/unstable release 
Yeah, we've pushed back against that approach so far, because of the
maddening user support interaction where we say "what version did you
fetch?" and they say "latest".
For normal users, they should be using Tor Browser, which updates itself
once you've got it installed, and in any case for Tor Browser versions,
the right answer is the (easily parsed)

@_date: 2015-02-08 00:14:46
@_author: Roger Dingledine 
@_subject: [tor-talk] browser differences between 4.0.3 and 4.5a3? (typo 
Check out
So as I understand it, the actual Firefox is the same in each case.
But note that TB 4.5a3 has changes to extensions like Torbutton, which
will change the behavior of the underlying browser.
You can read more about each bug number by going to e.g.

@_date: 2015-02-08 00:41:13
@_author: Roger Dingledine 
@_subject: [tor-talk] No update of Tor Expert Bundle 
They actually do still exist. The current one is:
as linked from the download page.
For more related tickets, see
(There are a couple of strong-willed Windows users who care, but very
few developers on the packaging side who have Windows, so we've been
working to find a lower-maintenance but still adequate solution so we
don't keep breaking the expert bundle when we change other things.)

@_date: 2015-02-08 19:23:48
@_author: Roger Dingledine 
@_subject: [tor-talk] When you forget to pay your Internet Bill, 
Reminds me of how for years the Nigerian mobile provider MTN would give
you free Internet (data) when you were using Tor, because you bypassed
their captive portal screen.
When they finally fixed it, we got a flood of support requests asking us
to fix our "free Internet workaround tool".
(Yes, Tor is for many things, and diversity of uses is part of why it's
strong. But no, if your adversary is your local ISP who is willing to
unplug you from the Internet, Tor isn't going to be your silver bullet.)

@_date: 2015-02-09 20:50:22
@_author: Roger Dingledine 
@_subject: [tor-talk] Removal of Vidalia content from our website 
Right. This is not an announcement of a change in policy. The policy
change happened, naturally, many years ago, when nobody was around to
maintain Vidalia and nobody did anything to fix that.
This thread is simply letting people know that we noticed that the last
remaining Vidalia bundles on the download page hadn't been updated in
many months either, meaning the libraries they contained (like openssl)
hadn't been updated either, so it was harmful to leave them up for users
to stumble across.
Thanks Sebastian!

@_date: 2015-02-09 21:17:16
@_author: Roger Dingledine 
@_subject: [tor-talk] Using Tor Hidden Services as Time Source 
Hi Patrick,
The first problem you're going to have here is that hidden services
don't work unless your time is approximately correct. So you will have a
chicken-and-egg problem using them to get an accurate time if you don't
already have one.
I really think the right thing to do is to teach Tor how to export what
time it thinks it is (via the control port), and to teach Tor to go get
some extra opinions from the directory authorities if it suspects that
your time is wrong. These are those two tickets:
Tor relays know what time it is, and some of them are quite trusted and
trustworthy, and your Tor already talks to them and learns the time in
a secure way.
There's some design work to be done still though.
Also, there are apparently some bugs in Tor where if you start Tor with
a wrong clock, and then something externally fixes the clock to be right,
Tor doesn't notice, or doesn't notice for a while.
I've just explored that one a bit more and posted a partial fix, but
more issues likely remain.

@_date: 2015-02-15 06:27:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Who said it takes hours of latency to fix anonymity? 
It's actually worse than that -- we have no idea.
I'd love to have a graph where the x axis is how much additional overhead
(latency, bandwidth, whatever) we're willing to add, and the y axis is
how much additional security (anonymity, privacy, whatever) we can get.
Currently we have zero data points for this graph.
The NRL folks have a fun paper on how to turn a defense against passive
timing attacks into a defense against active timing attacks:
But you have to have a defense against passive timing attacks or their
paper isn't useful to you yet.
On the 'bad news' side, check out
which shows reasonable scenarios against high-latency anonymity systems
where the anonymity breaks down over time against a passive observer.
Such attacks work especially well against a world where you have "users"
and you have "mixes", and the users don't participate consistently for
the entire existence of the system.
I've always been fond of
as an example of what you can do if all your users are mixes and no
users need to send or receive much traffic. But that paper also comes
with many hidden assumptions, so be careful thinking the next step is
to just build it.
On the 'good news' side, consider that with millions of traffic flows,
maybe you just have to drive the false positives up a little bit, and
suddenly an attacker with only a partial view of the system can't trust
his conclusions: see the "More precisely, it's possible that correlation
attacks don't scale well because" paragraph in
The PETS conference is where it's at in terms of progress so far. But
it's been a while since things have moved forward. One next step might
be to try to rephrase the question into something that somebody can
answer better.

@_date: 2015-02-17 08:40:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor over SSH (torsocks) (?) 
I believe many people happily use torsocks and rely on it. It's just
as safe now as it was then -- probably needs some audits, but probably
works pretty well.
You'll likely be happiest using torsocks 2, which might not be the
version that comes in your distro yet.

@_date: 2015-02-17 21:24:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor on Arm Device 
Unfortunately, the longer answer is that you're not going to match the
security offered by Tor Browser in this way.
Currently Tor Browser is a fork of Firefox, meaning there are 100+
patches applied to the code before it's built:
and some of the patches close serious privacy vulnerabilities that
Mozilla for whatever reason hasn't chosen to address.
You can read more about Tor Browser's goals here:
and an old but still useful discussion of attacks to consider is here:
So in conclusion, I would recommend against acting as though you've
made your arm Firefox thing 'close enough' to Tor Browser.

@_date: 2015-01-09 09:22:21
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB wants access to port 21 
There's a relay there:
Tor relays can listen on whatever port they want to listen on. Diversity
of these ports is useful -- somewhere in the world could be a network
that only lets people reach port 21.
So I guess the conclusion is that setting your littlesnitch to freak out
when Tor asks for a surprising port is eventually going to surprise you.

@_date: 2015-01-20 15:24:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Yelp blocking Tor users from viewing entire site 
See their two mentions in
I think Yelp blocks Tor for a similar reason to why Craigslist blocks
Tor -- their value-add is their web pages, and if their competitors
"steal" their web pages, they've got nothing else.
That kind of business model leads to jealously guarding all of their
pages from being crawled or otherwise viewed en masse -- which in turn
leads to being angry and bitter at every new Internet technology.
Unfortunately, since this business model is so fragile, I don't have
good ideas on how to make it compatible with Tor (or heck, with most
of the rest of the Internet).

@_date: 2015-01-21 18:36:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Which PTs shall we prioritize for inclusion in Tails? 
And I would similarly suggest meek over Flash Proxy, at least while Flash
Proxy requires that the Tor user be reachable, i.e. not be behind a NAT
or firewall.
(In the glorious future Flash Proxy + uProxy will use WebRTC transport
and be an unstoppable force for good, or something like that, but we
don't live in that future yet.)
Since you have obfs3 already, you might find meek to be a useful first
priority, since it's quite different from obfsx. And then obfs4 would
be next in line because obfs3 is becoming deprecated (in favor of obfs4)
as time passes.

@_date: 2015-01-23 17:51:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Vidalia problem 
Actually, you shouldn't use Tor to download with bittorrent.
It hurts the Tor network, and also it often doesn't provide the
anonymity that you might be expecting.

@_date: 2015-07-02 00:02:51
@_author: Roger Dingledine 
@_subject: [tor-talk] Suggestion, hard-coded related domains 
No, having a different circuit for every domain would be crazy -- mainly
because it would produce way way too many circuits (and thus load down the
network more), and secondarily because as you make and use more circuits,
you increase your exposure over time (which isn't the end of the world
due to the entry guard design, but is still not a great move probably).
Recent Tor Browsers aim to isolate *browser tabs* onto their own circuits.
Perhaps that is what you had in mind?

@_date: 2015-07-03 04:56:36
@_author: Roger Dingledine 
@_subject: [tor-talk] help needed to stress-test an onionbalanced HS - 
I should point out that this approach should do one rendezvous with the
onion service, and then re-use that circuit for each following request,
until the circuit fails at which point it builds one more and repeats.
While normal Tor circuits expire 10 minutes after the activity started,
circuits to onion services expire after 10 minutes of inactivity. We
chose that difference because the rendezvous process is so expensive
relative to normal Tor circuits.
A better approach here would be to flush the circuits and hidden service
descriptor between fetches -- the onionperf tools that various folks
are working on has code for this I think. But it would indeed be more
complex than what you are doing here. :)

@_date: 2015-07-05 13:55:11
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor v4.5.3 infected?? 
It sounds likely to be a false positive:
That is a very bad idea. Then you'll be running an old browser with
known old problems.
Good luck,

@_date: 2015-07-18 13:16:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Ubuntu Tor Packages 
Thanks for working on this.
If you want to read an example of a past mess between Tor and Ubuntu, see

@_date: 2015-07-30 21:23:21
@_author: Roger Dingledine 
@_subject: [tor-talk] Historically speaking, 
Hi everybody,
Please remember that the tor-talk list has many thousands of people on
it, and many of them are hoping to learn about how Tor works, as well
as contribute to making Tor work better.
Enormous threads like this one don't do anybody any good at actually
accomplishing either of these goals. Worse, it drives away the people
who would like to contribute but not in this sort of environment.
So when you're thinking about sending that next mail to tor-talk (this
applies to everybody -- I'm not trying to pick on any given person),
please think through whether it contributes usefully to the topic at
hand, and whether it contributes *sufficiently* for many thousands of
people to read it.

@_date: 2015-06-07 00:26:00
@_author: Roger Dingledine 
@_subject: [tor-talk] What's better than Tor for criminals? 
Right. The argument varies by type of criminal, but for the "what about
the terrorists" side, my argument goes something like:
"Scenario 1, I want to build a tool that handles millions of people,
that will work for the next year, and that I can tell you all about so
it can get peer review and people can trust it. That's the Tor problem.
Scenario 2, I want to build a tool that works for twenty people, for the
next two weeks, and I'm not going to tell you about it.
There are so many more ways to solve scenario 2 than there are to solve
scenario 1."
You can watch the rest of the argument in video form at
There's also
As an added twist, the original question here reminds me of a training
I was doing long ago for some activists:
where I used the "if you're willing to break laws" line, and they
stopped me and said "We're willing to break laws. How can we get better
anonymity than Tor can provide?"
So yes, it's clearly not just about willingness to break laws. Rather,
it's that the willingness is often correlated with other priorities that
may work well for certain small groups of people but that don't scale well
to the Tor context. And since much of Tor's safety comes from the number
and diversity of users, it's not a great fit for these other priorities.
(Please don't misinterpret these arguments as claiming that no bad people
use Tor. We've got millions of users now, and when you're at that scale
you have a cross section of the Internet, which of course includes bad
people too.)

@_date: 2015-06-10 18:37:33
@_author: Roger Dingledine 
@_subject: [tor-talk] Why are 2 Middle Nodes appearing in my circuits (4 
My guess is that this is an internal circuit, e.g. one used for onion
service connections. Tor circuits are "3 hops plus the number of hops
that are sensitive, e.g. chosen by somebody else".
You might enjoy
It's fine.

@_date: 2015-06-14 16:29:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Private Bridge 
Sounds great. I'm glad it's (mostly) working for you.
First, I should caution you against telling too many people the specific
bridge addresses you're using -- one issue is that they might read this
mailing list and decide to block them, and the second issue is that if
they want to monitor your traffic they now have a better idea of where
on the Internet to go watch if they want to see your traffic.
At least last I heard, Iran only blocks Tor by preventing connections
to the directory authorities:
which means if you bootstrap your Tor and then *stop* using bridges,
it may well still continue to work -- and in that case you won't have
to worry about accidentally having slow bridges.
Of course, using obfs3 (or even obfs4) bridges is the more robust
approach, because they're harder to block or throttle by DPI attacks,
which is one of the censorship approaches that Iran has historically
liked the most.
But you should try bootstrapping with a bridge and then not using
any bridges after that, in case it works and you are happier.

@_date: 2015-06-16 13:21:56
@_author: Roger Dingledine 
@_subject: [tor-talk] Panda antivirus now thinks Tor.exe is a virus 
The behavior detection aspect is especially vexing here -- many antivirus
tools have a "Not enough of our users have told us about this exe yet,
therefore it is scary by default" feature.
So by definition, the first n people who use that antivirus and fetch
a new version of Tor will have a bad experience. :(
(And that's also separate from the fact that the people running these
antivirus tools are uploading everything they are running to this third
party! Don't get me started there.)
While I'm here, I'll add a pointer to our FAQ on the topic:

@_date: 2015-06-16 14:46:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Some Tor downloads are 0 byte in size 
You're right!
looks like the right place to track it from here.

@_date: 2015-06-18 00:51:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Matryoshka: Are TOR holes intentional? 
"Traffic analysis is the first hole plugged by Matryoshka, but ignored
by TOR."
I couldn't figure out how to actually fetch this "Matryoshka" software,
but it sure looks like another case of somebody not understanding the
research field, and thinking that solving the traffic confirmation
attack is easy, without actually thinking through the engineering side,
the scaling side, or the statistics side.
For background see e.g.
It makes sense that if you think solving the problem is easy, you
wonder why Tor hasn't solved it.
But even full scale padding, ignoring the practical side of how to get a
Tor network that can afford to waste so much bandwidth, doesn't provide
protection in the face of active attacks where you induce a gap on one
side and then observe the gap on the other side. And it might even be
the case that these gaps happen naturally by themselves, due to network
congestion and so on, so maybe passive observers will be winners even
against a design that does full padding.
Also, to make it really work in practice, all users are going to need
to pad not just while fetching their web page or iso or whatever, but
sufficiently before and after that too, else an attacker can match up
start times and end times:
This is a great area for further research:
tl;dr the whole premise of this person's blog post is flawed, since
their design likely does not work as they think it does.

@_date: 2015-06-23 15:32:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Important Information for TorBirdy Users: OS upgrade 
OS R2)
Fixed; sorry for the trouble.
(I recommend sending more direct mail in the future, rather than tucking
it away in a tor-talk mail that people may or may not see in a timely
way :)

@_date: 2015-06-24 03:22:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Circuits in Orbot 
Tor clients build paths with 3+n hops, where n is the number that are
influenced by some third party. So for example, when you're doing a
hidden service rendezvous, you typically end up using 4-hop paths --
3 that you picked, and 1 that the other side picked.
In fact, for client-side introduction point circuits, in some cases you
could end up with 5-hop or 6-hop paths, since if an intro point fails,
the client just extends the existing circuit one more hop to the next
intro point to try it.
Hope this helps,

@_date: 2015-06-26 16:28:07
@_author: Roger Dingledine 
@_subject: [tor-talk] Clear net and Tor site on the same server 
Right, I think it is fine to run a normal website on the Internet and also
make it available as an onion site by running Tor on the same computer.
It all comes down to what security goals you have in mind. If one of
your goals is to protect the location of the website so people visiting
it cannot learn where it is, then you have many more things you ought
to think about.
But for your situation, it sounds fine. For background you might enjoy:
These phrases "Tor server" and "Tor node" are ambiguous. You might enjoy
Running a Tor relay can use quite a bit of memory depending on how much
traffic it's handling. Running a Tor bridge generally means you're
handling much less traffic, and so the memory footprint is much lower.
And running an onion service (aka hidden service) is usually very low
memory footprint too, but it depends how popular the service is.
Hope that helps,

@_date: 2015-06-30 08:59:28
@_author: Roger Dingledine 
@_subject: [tor-talk] Warning: 255 fake and booby trapped onion sites 
Thank you. Philipp made a list of these earlier today, and they now
have the badexit flag.
If somebody could investigate how the fake onion services differ from
the real ones, that would be neat.

@_date: 2015-05-05 11:51:35
@_author: Roger Dingledine 
@_subject: [tor-talk] German University signs up 24 tor relays 
Great. Thanks for letting us know.
Your details are very sparse though ("a research", "some period"). Can
you give us a summary of your research plans?
In particular,
- Are you monitoring or modifying traffic? If so, what kinds? Please
learn about the wiretapping laws in your country, my country, and
all the other countries. :)
- I notice that many of your relays are tiny -- a bandwidthrate of
50KB means you might never get the Fast flag, so your relays will
go mostly unused, except for edge cases like the HSDir flag (e.g.
 that we'd like to
resolve rather than let people exploit.
- If you tell us more about your research, we're more likely to be able
to tell you about parallel research projects that might spoil or
influence your results. See also

@_date: 2015-05-17 15:12:01
@_author: Roger Dingledine 
@_subject: [tor-talk] Making a Site Available as both a Hidden Service and 
Hi Ben!
Great list of topics. For your first one, I'll paste my paragraph from
the earlier tor-talk thread that included this topic:
I've also been talking to EFF about kicking off a Tor Onion Challenge
(to follow on from their Tor Relay Challenges), to a) get many people
to make their website or other service accessible as an onion site,
and b) come up with and/or build a novel use of onion services, to go
with the quite cool list that we have already but have done a poor job
of publicizing: Pond, Globaleaks, SecureDrop, Ricochet, OnionShare,
facebook's https onion, etc. You see, I used to be on the "making your
normal website reachable as an onion service is stupid" side of the fence,
but I have since come to realize that I was wrong. You know how, ten
years ago, website operators would say "I don't need to offer https for
my site, because my users ____" and they'd have some plausible-sounding
excuse? And now they sound selfish and short-sighted if they say that,
because everybody knows it should be the choice of the *user* what
security properties she gets when reaching a service? I now think onion
services are exactly in that boat: today we have plenty of people saying
"I don't need to offer a .onion for my site, because my users _____". We
need to turn it around so sites let their *users* decide what security
(encryption, authentication, trust) properties they want to achieve
while interacting with each site.
tl;dr: sounds great!
Don't forget the "decreasing load and reliance on exit relays" benefit,
in case we arrive in that dismal future where it grows increasingly hard
to operate exit relays in a diverse and well-dispersed set of locations.

@_date: 2015-05-20 17:32:21
@_author: Roger Dingledine 
@_subject: [tor-talk] reverse enumeration attacks on bridges (re: 100-foot 
This is
You might also enjoy the other tickets linked from
For more bridge discovery attacks, a good first reading material is

@_date: 2015-05-28 06:38:45
@_author: Roger Dingledine 
@_subject: [tor-talk] A thought experiment on direct action 
Sounds to me like a great way to make more people think that Tor exit
relays are immoral antisocial things, and that anything related to Tor
is a criminal plague that any good sysadmin should try to get rid of.
We're in a fight for public opinion here, and anything that makes
more people think that when they discover Tor, it is a malicious
infection that they should get rid of... will hurt the ordinary people
who need Tor for their continued safety.
And if that argument doesn't convince you :), consider also that very
fast Tor relays are much more useful to the network than slower ones.
You're unlikely to sneak a Tor relay into a stable 100mbit connection, or
if you do, it won't very long, and worse, you'll make that ISP hate Tor.
This last point reminds me of my "slash-and burn agriculture" analogy
for relay hosting:
Ah ha -- I think I've figured out the disconnect. Exit relays aren't
scarce because of governments that don't permit them. Exit relays are
scarce because ISPs are nervous to let people run them. It's a social
(ok, and economic) thing, not a legal thing.

@_date: 2015-05-28 09:26:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Are there any performance benefits for clients to 
Hi Virgil,
Can you clarify what you mean here?
Do you mean having the websites that run tor2web return AAAA records
when you resolve them?
Do you mean having the Tor clients on tor2web sites set "ClientUseIPv6 1"
and/or "ClientPreferIPv6 1"?
Or something else?

@_date: 2015-11-02 03:49:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Question Regarding Routing of Network-Traffic using 
Right, correct.
I would suggest you read and understand
before decreasing your guard rotation period so wildly.
That said, if you want to blow your whole foot off, we have a config
option for this: check out the 'UseEntryGuards 0' torrc option.

@_date: 2015-11-02 05:04:18
@_author: Roger Dingledine 
@_subject: [tor-talk] flash player 
This could be.
This isn't it -- Tor Browser normalizes the user-agent string across
all platforms, so they all claim to be Windows.

@_date: 2015-10-20 14:55:15
@_author: Roger Dingledine 
@_subject: [tor-talk] ethical repo criteria 
Fun list! Thanks for pointing it out.
It's also made me open

@_date: 2015-10-25 05:54:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Browser: playing videosHi 
I hope this isn't true? If it is -- that is, if Tor Browser on that
platform is willing to find and use the flash plugin -- please submit
a bug report with enough details for the Tor Browser folks to reproduce
the issue. Especially be sure to tell us which version of Tor Browser
you're using.
It is a feature, not a mistake, that it's missing. Flash is bad news for
your privacy, so Tor Browser takes many different steps to make sure it
isn't found, doesn't work even if it is found, etc.
(And it's not just privacy -- Flash is a mess in terms of code security
Have you actually tested this? It should not be the case.
Yeah, don't do this -- Tor Browser will work hard to not run it even if
you stick it in that directory.

@_date: 2015-10-29 08:54:42
@_author: Roger Dingledine 
@_subject: [tor-talk] TB 5.0.3 for OpenBSD released 
Awesome! Thanks for continuing to work on this.
Also, great job on the relay advocacy side too.
And for those following along at home, what they've done here is actually
a system-wide install for Tor Browser, so then when a user runs it,
she gets a local copy of the state that Tor Browser generates. This
is actually one of the directions that we want to explore for the Debian
package as well -- putting the core pieces into /usr/something, and
then when the user runs it, it copies over whatever it needs into the
user's home directory, and on subsequent runs it sees if a new version
has appeared and updates its local files as needed.
Yes please! I encourage interested people to follow up with them.

@_date: 2015-09-16 17:54:00
@_author: Roger Dingledine 
@_subject: [tor-talk] victory at kilton library 
Thanks for sticking with this Alison and others!
And for those here who want to get up to speed, I think this audio
clip is a great summary:

@_date: 2016-04-04 06:13:45
@_author: Roger Dingledine 
@_subject: [tor-talk] Innocent Seattle Exit Operators And Privacy 
Actually it's EFF's Tor legal faq:
("Should I run an exit relay from my home?")
Fixed. The url you want (easily findable via your search engine)
is apparently

@_date: 2016-04-18 15:01:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Comments on 
Yes, correct, it no longer holds true.
We indeed just got new ssl certs. Probably the fix there is to just
remove that FAQ entry.
Anybody who wants to help fix the FAQ, that would be grand. I started
going through it earlier but there are so many entries, and so many of
them have become subtly (or obviously) wrong in the past years, and also
many of them are not FA anymore.
The second best way to contribute is to generate a diff -u on
and open a ticket about it on trac.torproject.org in component website.
(The best way to contribute is to git clone the webwml repo, and make a
git branch with your change, and then open the ticket and point to your
git branch. But that's a lot more work than just making a diff -u.)

@_date: 2016-04-22 23:02:11
@_author: Roger Dingledine 
@_subject: [tor-talk] 1 Million People use Facebook over Tor 
I agree!
Thank you Alec and other security people at Facebook for seeing the
value in secure communications, and also for being willing to stand up
and talk about numbers.
For those who are now thinking "wait, what's the point in using Tor when
going to Facebook?", check out the earlier blog post on this topic:

@_date: 2016-04-22 23:33:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Comments on 
Hi lukep,
Nothing will happen with the FAQ unless somebody updates it. I put
some instructions in my previous mail:
The second best way to contribute is to generate a diff -u on
 and open a ticket about it
on trac.torproject.org in component website.
(The best way to contribute is to git clone the webwml repo, and make a
git branch with your change, and then open the ticket and point to your
git branch. But that's a lot more work than just making a diff -u.)
That could be you! :)

@_date: 2016-08-18 22:07:53
@_author: Roger Dingledine 
@_subject: [tor-talk] A community concern that needs to be addressed, 
Yay! Sign me up. There are many millions of people around the world
who can benefit from the things that Tor Browser can do for them,
but there's still a lot of work to be done.
In fact, wait a minute, I already wrote this text before. :) Here is the
middle chunk of my blog post from last December 1st -- I still believe
it all now, and I think it gives us some good ideas for a future roadmap
of Tor's priorities.
"We have much more work ahead of us in the coming years. First and
foremost, we care about our users and the usability of our tools. We
want to accelerate user growth: The Tor network sees millions of users
each day, but there are tens of millions more who are waiting for it to
be just a little bit faster, more accessible, or easier to install. We
want to get the word out that Tor is for everyone on the planet.
We also need to focus on outreach and education, and on helping our
allies who focus on public policy to succeed. Tor is still the best
system in the world against large adversaries like governments, but
these days the attackers are vastly outspending the defenders across the
board. So in addition to keeping Tor both strong and usable, we need to
provide technical advice and support to groups like EFF and ACLU while
they work to rein in the parts of our governments that have gone beyond
the permissions and limits that our laws meant to give them.
by continued work on transparency and communication, strengthening our
leadership, choosing our priorities well, and becoming more agile and
adapting to the most important issues as they arise.
Taller mountains await after these: We need to tackle the big open
anonymity problems like correlation attacks, we need to help websites
learn how to engage with users who care about privacy, and we need to
demonstrate to governments around the world that we don't have to choose
between security and privacy."

@_date: 2016-08-19 02:28:11
@_author: Roger Dingledine 
@_subject: [tor-talk] tor 0.2.8.5-rc connecting to 18.0.0.1 
Neat! It looks like that behavior is back.
Sounds like a regression. A search in the code for "18.0.0.1" led me to
get_interface_address6_via_udp_socket_hack(). Looking at the recent
commits that mention that function we have:
The ChangeLog entries are:
  o Minor features (relay, address discovery):
    - Add a family argument to get_interface_addresses_raw() and
      subfunctions to make network interface address interogation more
      efficient. Now Tor can specifically ask for IPv4, IPv6 or both
      types of interfaces from the operating system. Resolves
      ticket 17950.
    - When get_interface_address6_list(.,AF_UNSPEC,.) is called and
      fails to enumerate interface addresses using the platform-specific
      API, have it rely on the UDP socket fallback technique to try and
      find out what IP addresses (both IPv4 and IPv6) our machine has.
      Resolves ticket 17951.
That second one looks very related.
Can you open a new ticket on  pointing to
the original issue ( plus these two new ones? Hopefully teor and
rl1987 will notice and work on a fix.

@_date: 2016-08-20 05:11:03
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Bridge vs Tor Exit? 
I think exit relays is the right answer here, if all else is equal on
your side.
In favor of exit relays:
1) Not everybody is in a position to run an exit relay, so if you can
you should.
2) More exit relays can make Tor faster for everybody.
3) More exit relays (in more diverse locations) can make Tor more
anonymous for everybody, since it increases the variety of places that
adversaries have to watch.
Whereas on the obfs4 bridge side, right now our bridge address
distribution strategies are not very robust against the steps China takes
to discover the bridge addresses, and bridges are overkill basically
every other place besides China. So running a few more obfs4 bridges,
without also improving the distribution strategies, might not end up
benefiting as many people as you hope. Really we ought to do a push to
distribute bridges better, in parallel to asking people to run a lot
more of them, in parallel to making it super easy for people to run
them (apt-get install ..., done). For the first piece, see the "Salmon"
paper from this year's PETS for some ideas:
but that's really a whole separate topic, and historically it also
turns out to be more complicated than it sounds. :)
And see also
Thanks for wanting to help users!

@_date: 2016-12-08 15:01:18
@_author: Roger Dingledine 
@_subject: [tor-talk] Ahmia search engine works normally again 
Actually, that's part of the reason for the shift into calling them
"onion services" -- many people offer onion addresses for their website
or service because of the many other security properties they offer,
and not because they want to hide the existence or location of the Tor
client offering it.
If you're in the "wait, they're supposed to be hidden, I don't understand"
camp, I encourage you to watch our CCC talk from last year:

@_date: 2016-12-13 00:46:39
@_author: Roger Dingledine 
@_subject: [tor-talk] How to unsubscribe (was Re: confusion over verification 
These instructions are at the bottom of every post to the list.
They are the right way to unsubscribe from the list.
(See close to the bottom where it says "To unsubscribe from tor-talk, ...")

@_date: 2016-12-18 01:21:12
@_author: Roger Dingledine 
@_subject: [tor-talk] Mirai Botnet Relocates To Onions 
Yuck. The 2013 botnet operator from Ukraine apparently stopped using Tor
for controlling his bots (they were doing ad click fraud), because he
attracted way more attention signing them all up to Tor than they had
attracted before, and in the end he decided it wasn't worth it.
For a while I've been trying to figure out how to share his lesson with
other botnet operators around the world. The western journalists are alas
super excited to talk about how amazing and brilliant and insightful the
idea is to move your botnet over to Tor, and if some new botnet operator
only reads those stories, they won't get an accurate impression. :(
(Keep an eye on the user graph on the metrics page, because there's a good
chance that this story is nonsense and the graph won't change at all.)

@_date: 2016-12-26 08:56:04
@_author: Roger Dingledine 
@_subject: [tor-talk] 33c3 and tor? 
Julius reserved a workshop room for us on day 2, from 21:30 to 23:00,
in Hall B:
So you should feel free to come by and we'll talk about whatever you
want to talk about. Depending on how many people there are, we might
break into groups based on interests.
I think there is no separate relay operators meeting, so relay
operators are welcome in this workshop space too.
Many Tor people will be hanging out in the tea room at other times
as well.
I hope to see many of you there! :)

@_date: 2016-12-27 21:53:35
@_author: Roger Dingledine 
@_subject: [tor-talk] 33c3 and tor? 
We didn't: their talk is 20:30 to 21:30.
(We actually first scheduled it for 21:00 to 23:00, because the Fahrplan
wasn't out yet. When the Fahrplan came out, we noticed the conflict and
cut off the first 30 minutes of the workshop.)
So, go to the censorship talk, and then come to the workshop!

@_date: 2016-02-02 07:50:14
@_author: Roger Dingledine 
@_subject: [tor-talk] Exit Traffic classification and discrimination 
Well, the first question there is to learn whether your assumption
about destinations is actually true -- is most Tor traffic going to a
small number of sites, or are many Tor destinations in the "long tail"?
I spoke to Tariq Elahi at length about exactly this research question,
because they want to run some exit relays and try to answer it. They had
some good plans for how to do it safely -- use Privex to combine views
from several exits so you can't go back and learn which exit saw which
destination, write nothing to disk except the final answer, etc.
(I put together a draft set of guidelines for how to do safe research
like this as part of the 32c3 onion services talk:
My suggestion to him at the time was to write up the details for why his
design is safe, and get them vetted by other researchers in public, before
proceeding. I haven't talked to him about how it's going since then.
Hopefully he didn't skip too many of the recommended steps. :)

@_date: 2016-02-02 10:16:37
@_author: Roger Dingledine 
@_subject: [tor-talk] Recommended setting for NoScript's Javascript? 
It defaults to 'c', because otherwise many users would find websites
broken and not understand what's going on:
It sounds like you've figured out how NoScript works. It is indeed a
bit safer to leave JS disabled globally, and enable it site-by-site when
you find that you need it. If you're comfortable doing it that way, go
for it -- it will be a bit safer than leaving everything enabled.
I say "a bit safer" because, while reducing surface area for complex
things like JavaScript is good, there are many other parts of the browser
that are complex too. This is an area with quite some controversy over
the past years, since several attacks from the FBI have used JavaScript
vulnerabilities, and "they could have used other attacks" and "but they
*did* use this attack" are both valid points. (If you want to be one of
the users who disables JavaScript entirely, and then ends up even
angrier at Cloudflare, this is a legitimate choice too.)
Yes, this is a known thing. It's one of the reasons Micah wrote
up the best practices list for onion service operators:

@_date: 2016-02-03 18:14:11
@_author: Roger Dingledine 
@_subject: [tor-talk] 4 relays advertising >1000 MByte/s each 
The directory authorities didn't do anything; I noticed the thread some
hours after it started, and by that point the relays were already gone.

@_date: 2016-02-10 08:08:11
@_author: Roger Dingledine 
@_subject: [tor-talk] ExcludeExitNodes and ExitNodes, 
ExcludeExitNodes is supposed to take priority over ExitNodes.
for many more details.

@_date: 2016-02-15 17:20:49
@_author: Roger Dingledine 
@_subject: [tor-talk] How to make the Tor service to stop faster? 
Yes, this is it. Once you start the shutdown process, your relay refuses
new create cells, new begin cells, etc. The hope is that if somebody is
in the middle of fetching a web page via you, they finish fetching it
before you disappear.

@_date: 2016-02-17 00:47:35
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Weekly News ??? February 15th, 2016 
These meetings are on irc. In the original mail, you can see that it
says " irc.oftc.net". So that's the irc.oftc.net network,
in the  channel.
For the network team meeting in particular, the URL listed is
IRC is "Internet Relay Chat":
I'm afraid it isn't super-convenient to novices. But developers find it
reasonably efficient.
If you don't want to fight with an irc client, there are notes from
previous meetings here:
Hope that helps,

@_date: 2016-02-17 18:45:32
@_author: Roger Dingledine 
@_subject: [tor-talk] Bad exit/bad relay list 
There aren't great resources for this I think.
The simple answer is that you can look at your cached consensus file,
and the ones labelled BadExit are the bad exits, and the ones that are
missing (ha) are the bad relays.
If you want a way to visualize the consensus plus the votes that went
into it, check out
(warning, it's a huge page)
For a while it looks like somebody was maintaining
But ultimately this is a really crummy arms race to play, and while I'm
a fan of transparency for most development, it ends up making things
too asymmetric in the wrong direction in this case:
As for reporting bad relays, see
Hope this helps,

@_date: 2016-02-18 10:51:07
@_author: Roger Dingledine 
@_subject: [tor-talk] large increase in .onion domains 
Yep. Also, because each reporting relay adds noise, sometimes, due to
the math involved, more than half of the relays end up inflating their
number, so we end up with a higher number on that graph than is actually
true in reality.
Still, that is a large jump.
Let's wait a few days and see if it settles down.
If it doesn't, I'll guess that it's a real effect. But even then,
we don't know why this (daily!) number is so much larger than the
(total!) number of onion addresses that e.g. Ahmia knows about. Maybe
it's Onionshare users, who generate one onion address per document they
transfer? Maybe it's Ricochet users? Maybe it's measurement error? We need
to see more improvements in the field of privacy-preserving statistics
and measurements before we'll feel comfortable trying to get answers to
this question.

@_date: 2016-02-20 19:38:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Large spike in .onion addresses - port scan? 
No, there is no easy way to do this. That's because there is no central
repository of onion addresses. There are services like Ahmia that try to
enumerate what they can, by looking at various sources like the content
on a set of known onion sites. But that only lets you learn about sites
that wanted to let you find out about them.
This is actually a really complicated topic, because there are a wide
variety of ways of learning about onion addresses, each of which has
its own ethical questions around how invasive you have to be. For
example, you can get them by Googling for .onion addresses (probably
fine), or by being Verizon or Comcast and spying on the people who
use your DNS servers (not so fine), or by running Tor relays and spying
on the hidden service descriptors that people upload (not fine).
This complexity is why I picked this topic to illustrate the "guidelines
for doing your Tor research safely" part of our 32c3 talk: see the part
a bit after the 29 minute mark of
In fact, there appear to be some for-profit startups who are trying
to make money from doing exactly this (and then scaring companies with
"dark web" fud and selling the onion lists to the scared companies).
The long-term answer is some architecture improvements so there are
fewer points in the protocol where attackers can collect things that
users meant to keep private:
(see the "Attacks by Hidden Service Directory Servers" section)

@_date: 2016-02-29 18:14:27
@_author: Roger Dingledine 
@_subject: [tor-talk] large increase in .onion domains 
============================== START ==============================
This is true, but we don't know anything more than we did, and until
something changes we will continue to not know. My answer from earlier
still stands:
"We need to see more improvements in the field of privacy-preserving
statistics and measurements before we'll feel comfortable trying to get
answers to this question."
Also, let me clarify that it is not 80000 domains, but rather it is 80000
onion addresses worth of descriptors. There is nothing that says any of
these onion addresses ever had anything listening on them.  One person
can generate and publish thousands of onion descriptors, and the graph
would go up up up.
For many more details, here is the methodology for counting:
We've talked to special, the Ricochet developer, who said he didn't see
anything close to a jump in Ricochet downloads that would account for
this graph going up. My current guess is that it's just somebody
uploading a bunch of descriptors. But who knows.

@_date: 2016-01-04 01:44:49
@_author: Roger Dingledine 
@_subject: [tor-talk] On further minimizing harassment for Tor Exit Nodes 
Actually, AS-aware path selection could tend to move exits *closer* to
destinations, since one goal would be to minimize the number of different
organizations that get to see the traffic as it leaves the Tor network.
I guess that's another argument in favor of Moritz's "put your relay
in a different country than you" method.

@_date: 2016-01-14 13:22:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Escape NSA just to enter commercial surveillance? 
Right. Tor provides many different security (anonymity, privacy, safety,
whatever you want to call them) properties, and different users care
most about different properties.
See "part one" of
where (back in 2014) I addressed exactly this question.

@_date: 2016-01-15 02:14:20
@_author: Roger Dingledine 
@_subject: [tor-talk] Entry 
If you want more details than the faq entry provides, here are three
hopefully useful links for more reading:
(It sounds like you don't think the guard relay design is a smart one.
That's great -- the next step is to write up why exactly, and ideally
how some other design would handle all of the various attacks better.)

@_date: 2016-01-24 11:38:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Using VPN less safe? 
Yes, I think this is correct.
It's a tradeoff -- if somebody somehow breaks the anonymity of your Tor
circuit, it's nice to have another layer behind that. But if somebody
guesses that you're using a particular VPN, or you pick a VPN that they're
already monitoring for other reasons, then you basically let them see the
beginning of your circuit when otherwise they might not have been able to.
In a sense you're selecting your VPN to be your guard. If there were
one super-popular guard in the Tor network, and people used it forever
rather than doing normal guard rotation, seems to me it would become an
appealing point for surveillance.
Also, this issue is pretty much the same whether you're visiting onion
sites or other domains.

@_date: 2016-07-07 19:25:46
@_author: Roger Dingledine 
@_subject: [tor-talk] Anyone got the sourcecode for "CensorSpoofer" 
I would suggest mailing Amir and asking him.
That said, I would not at all be surprised to hear that there is
no source code, or that there is but it's only enough to make some
performance graphs, and not something an actual person could use. It
is unfortunately standard among academic research papers to describe a
system but not really build or deploy it.
Let us know what you find!

@_date: 2016-07-07 19:51:26
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor routing algorithm questions 
In fact, generally Tor clients go to domain names, not to straight
IP addresses, so the client wouldn't even know whether it's in this
situation until it was most of the way through making the request.
(Also, DNS isn't signed or anything, so you should imagine all the
terrible things that could happen if we make clients change their guard
selection based on destination IP address, yet exit relays can lie however
they like about what IP address the destination supposedly maps to.)
But speaking of all this, see also the research papers proposing to modify
route selection to reduce the chance of the same Autonomous System (AS)
appearing on two parts of the path. The most recent one is "DeNASA:
Destination-Naive AS-Awareness in Anonymous Communications" by Armon
Barton and Matthew Wright, and it should become available shortly as it
will be presented at PETS in just a few weeks. But the summary of that
paper is that clients should pick their guard based on their local IP
address and on the common destinations that clients might often go to,
to reduce the chance of picking a guard from a network location that
will see a lot of their exit traffic too.
No. How can we know whether the user has changed location a lot or a
little? IP addresses can be wildly different yet still located in the
same building, and we certainly wouldn't want to keep shifting guards
too much.
Also, if we *did* shift guards, should we shift back if we went back
to the old location? Does that mean Tor should keep track (on disk of
course) of its previous locations? Can a hostile DHCP server offer an
IP address from a suspected previous location and then see which guard
the client opts to use?
For a related (not the same) edge case, see also

@_date: 2016-07-15 18:14:31
@_author: Roger Dingledine 
@_subject: [tor-talk] Practical deanonymization using CPU load covert 
Neat! Hopefully that away-from-the-net part means you'll be at PETS in
Darmstadt? If so, many of us will be there too, and we'll be excited to
talk to you -- and you should be sure to sign up for a rump session slot
too. If not, that's sad because PETS is the perfect place for talking
more about these topics. :)
For the ping timing channels in particular, see also Nikita's paper
about that from long ago:

@_date: 2016-06-01 02:30:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Ntop nDPI 1.8 with enhanced Tor protocol dissector 
I think 'a' isn't really an option here, since the detection rule is so
darn easy.
I don't think this is an arms race we can win, at least not without
changing the rules. We could imagine cooler approaches, like hooking
Tor relays into the Let's Encrypt acme engine so they can get legit ssl
certs for each relay. But even then, they would need legit looking names
in the ssl certs -- we could start with dyndns addresses, but eventually
we'd need something better. The rabbit hole goes deep.
Ultimately, this situation is what pluggable transports are for --
either the "look like something" transports that trick the dissector into
knowing what the protocol is but it's wrong, or the "look like nothing"
transports where the dissector considers all the protocols it knows and
comes up empty.

@_date: 2016-06-20 20:10:25
@_author: Roger Dingledine 
@_subject: [tor-talk] Question for those who say "Tor is pwned" 
If you want to read a lot more on this topic -- including how Tor's
design changed in response and how it still needs to change -- check
out the blog post here:
(Also, yes, this mailing list has gotten out of control. We are all
distracted doing more urgent things, but I think we should soon find
the time anyway to proceed to the "clean up our lists" plan.)

@_date: 2016-03-06 11:42:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Interview Study on Anonymity and Peer Production 
You can see some of the results in this 32c3 video:
(It is missing the first few minutes of audio...oops).
I believe they don't have any actual paper ready yet.

@_date: 2016-03-10 02:20:04
@_author: Roger Dingledine 
@_subject: [tor-talk] Why does parameter "StrictExitNodes" exist? 
Strictexitnodes went away years ago. It no longer exists.
You might enjoy
for the history of how the design changed (back in 2010).

@_date: 2016-03-10 19:11:41
@_author: Roger Dingledine 
@_subject: [tor-talk] Why does parameter "StrictExitNodes" exist? 
No, this is wrong. StrictNodes has no effect on ExitNodes.
This is maybe a better description than the previous one I tried:

@_date: 2016-03-11 10:06:46
@_author: Roger Dingledine 
@_subject: [tor-talk] tor-onions on gmane 
This is fine with me.
To be clear, we have never done anything to interact with gmane. So
whatever they did for the other lists, they should do for this one.
If they want to.
(Maybe they have some form on their side where you request that they
follow a list?)

@_date: 2016-03-16 12:10:57
@_author: Roger Dingledine 
@_subject: [tor-talk] Reload "torrc" without restart TorBrowser possible? 
On Windows, yes.
On other operating systems (Linus, OS X, Unix), you can send a HUP
signal to the Tor process ("kill -HUP "), and Tor will reload
its torrc file.
All of that said, exiting and restarting is the most thorough (and thus
the simplest) approach.
(On Windows, the Tor control protocol interface lets you send "signal
reload" to do the equivalent to a hup signal. But it's not straightforward
to get an authenticated connection to Tor's control port in the Tor
Browser case, so I wouldn't call that an easy avenue either.)

@_date: 2016-03-16 12:13:40
@_author: Roger Dingledine 
@_subject: [tor-talk] Why my tor-assigned IP address differs from that of 
It's nothing to worry about, and also not a bug.
You might enjoy this stackexchange article which explains the topic:

@_date: 2016-03-18 23:40:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Traffic shaping attack 
Right. This general idea of a traffic confirmation attack is an issue
to consider for any low-latency system.
One of the questions to ask is how many points you need to watch in order
to be in a position to launch the attack. This is where Tor fares better
than centralized approaches like VPNs or single-hop proxies, and it's
Tor's best line of defense here.
Another question to ask is whether there will be false positives in the
statistics, i.e. how often your analysis says "yes, match" when actually
it's mistaken. In your scenario, the adversary is doing an active attack
on the traffic, so while I think it's legitimate to speculate about
how false positive rates maybe get high when you're looking at many
Tor flows across many relays (the NSA scenario -- and we even have a
document from an NSA analyst being frustrated by the false positives),
I think it's fair to say that if you generate the signals clearly enough,
false positives will be much less of a worry.
The third question you might ask is: can I inject these signals in a
way that they're still recognizable to me, but observers don't realize
that anything weird is going on with the traffic? That is, can I do
this active traffic modulation attack but still be undetectable? For
that topic, check out these papers:

@_date: 2016-03-19 21:56:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Traffic shaping attack 
This assumed scenario seems extremely unlikely to be happening in
practice. First because there aren't any relays that are doing 1gbit/s
of traffic, so no onion service would be able to do that to its guard
(unless it used many entry guards and spread the load over them, in which
case it would be screwing its own anonymity). And second because the
graph at shows there's only something like 1.4gbit/s of onion service traffic in
the whole network. And third because scalability issues in the current
design make onion services unable to keep up with the number of users
that you're describing.
So I worry that it sounds similar to the "omg they're hidden so they
must be *huge*" mistake that a lot of the media suffers from.
More details please? This is not a crazy possibility, but it would be good
to know exactly what evidence we have for its being true. For example,
if somebody noticed "I get a burst of cells from this onion service,
then a few seconds of silence, then I get another burst of cells",
that's actually a property of our current load balancing algorithm,
and not necessarily evidence of an intentional signal being injected
into the circuit.

@_date: 2016-03-29 06:32:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Religion provides statistical proof of the Creation 
see Eden and Exodus in superposition.
Sorry for the disturbance everyone. Yes indeed, this thread is
off-topic. I've removed the original poster from the list.

@_date: 2016-05-04 04:28:49
@_author: Roger Dingledine 
@_subject: [tor-talk] 'Refresh tor browser' - and then it wasn't one 
Hi Andreas,
Can you file a Tor Browser ticket on trac, with as much detail as you
can? Especially including which Tor Browser version it was, and what
platform it was for? And what path / where on your system you had
installed it to? And what happened when you tried restarting it?
There appear to be a bunch of recent tickets on update problems with
Tor Browser 6.0a5, e.g.:
But I haven't seen any tickets about Tor Browser 5.5.5 (the stable

@_date: 2016-05-05 09:24:08
@_author: Roger Dingledine 
@_subject: [tor-talk] "Sorry. You are not using Tor." 
(There are plenty of other good answers there too!)

@_date: 2016-05-06 10:38:54
@_author: Roger Dingledine 
@_subject: [tor-talk] Where is the Tor source code? [Was Re: FBI harassing 
Go to  and click on 'source
I don't think git is meant to be used that way. We have different git
repos for different projects:

@_date: 2016-05-12 00:19:29
@_author: Roger Dingledine 
@_subject: [tor-talk] Pluggable Transports and DPI 
Good stuff!
It's clear that they had a person look at the topic and decide on a way
to block it -- accepting some collateral damage and making a guess about
how many unhappy people it would produce. They benefited from the fact
that the customers behind this Cyberoam weren't an entire country, meaning
they were betting that a low collateral damage was not many people at all.
Do we know anything about how they decided to detect obfs4 (and what
collateral damage they decided was acceptable there)?

@_date: 2016-05-19 16:21:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Design : Differents keys used for connection. 
You might enjoy
It sounds like the 'ephemeral keys' you mention could be the circuit-level
keys, that is, the symmetric keys negotiated by the circuit handshake
and used for the lifetime of that circuit.

@_date: 2016-10-09 15:38:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Authority Search and 4th Amendment 
I think this reasoning represents a deep misunderstanding of how the
Internet works.
Shari and I wrote up this response back in February when the idea
first came out:

@_date: 2016-10-29 15:22:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor and macOS Sierra 
It is possible you are hitting
which is an underlying Tor bug:
I think that bug would bite users of the experimental Tor Browser 6.5a3
on Sierra, but should not bite users of the stable Tor Browser 6.0.5.
(I fear the tor-talk mailing list is a poor forum for back-and-forth
debugging of your particular software set-up though. So if "try the
stable" doesn't help, asking on irc is probably more effective than a
big thread here.)

@_date: 2016-09-17 19:20:58
@_author: Roger Dingledine 
@_subject: [tor-talk] Running a relay for some months 
I, on the human side, noticed part-way into the mails and set the
'moderated' bit on you in case it turned into a habit. :) I've removed
the moderated bit from you.
Also, to add some useful content and answer the original question
a bit more, check out especially the link at the bottom to
(warning, it is a huge page that your browser might find no fun to load)

@_date: 2016-09-18 23:20:43
@_author: Roger Dingledine 
@_subject: [tor-talk] benefits of onion services (was Re: getting Tor to 
Well, one feature is that the onion service design limits the surface area
to only that service. So you can't break in by e.g. sending malformed IP
packets that surprise the kernel. This feature isn't so helpful for huge
complicated websites that use php, since in that case the webserver is
the main vulnerability anyway, but it is pretty cool in the context of
an ssh server that is firewalled from all other access.
One benefit is that you're reducing load on the exit relays, so in theory
things can scale a lot better (you need folks to volunteer more non-exit
relays, but those are easier to get).
Another benefit is that you're no longer at the mercy of the Certificate
Authority mafia, and the mess which is the current CA model. (Alas when
it comes to site authentication we don't really replace the mess with
anything, so let's not get too carried away with how cool this benefit
is quite yet. :)
And there's actually lots more where that came from. Can I recommend our
32c3 talk for more info:

@_date: 2016-09-19 12:54:55
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor Browser 6.0.5 Released Early 
has your answer (and is also the page that Tor Browser pointed
you to after the update, I hope).

@_date: 2016-09-20 18:09:10
@_author: Roger Dingledine 
@_subject: [tor-talk] How do i check the archives? 
Here's a tarball I just made from the seul.org archives:
(It's 61MB compressed.)
People are welcome to do what they want with it to make it more
usable by whatever the cool kids use these days.
I wonder if longer-term the answer is that one of those more thoroughly
maintained mail archive websites should be doing this.

@_date: 2016-09-21 14:10:50
@_author: Roger Dingledine 
@_subject: [tor-talk] Wily repository 
It looks like your Ubuntu version is end-of-life:
It looks like our volunteer deb maintainer removed the wily repository
some time after it went end-of-life.
I found this related ticket:
and took the opportunity to resolve it (I hope).

@_date: 2017-08-09 21:53:15
@_author: Roger Dingledine 
@_subject: [tor-talk] Motivations for certificate issues for onion services 
Right -- I used to buy their reasoning, thinking "you're right, 1024-bit
RSA is indeed not as good as modern TLS, let's wait for the newer onion
design", but then I realized that they're comparing the *authentication
about whether you control the domain* step. That is, they are saying that
1024-bit RSA is not as strong as unauthenticated DNS and unauthenticated
BGP. Which is just nonsense.
At HotPETS this year we had a live demonstration, right there while
we all watched, of a BGP hijack on the real Internet, which obtained
a Let's Encrypt certificate for the hijacked domain. Piece of cake.
I'd say needing to factor a 1024-bit RSA, or needing to generate 2^80
keys to find one that matches the onion address you're trying to attack,
is still a much much higher bar.
Can you help me understand why this is not just more of the same poor
reasoning? One of the reasons we want to use modern TLS, i.e. get real
HTTPS certs, is to use those stronger cryptographic primitives. Waiting
for the stronger onion names is like saying you shouldn't be able to get
an HTTPS cert because we can't trust the DNS system -- and I don't hear
any of the CA vendors saying that.
The v3 onion service code is in the code review stage. The relay
side and HSDir side have been in place since Tor 0.3.0, and Nick just
merged the service-side code into master last night. There is a branch
("dgoulet/ticket17242_032_02") that implements the client side.
If you grab that branch, build it, and stick the resulting tor binary
into Browser/TorBrowser/Tor/tor in your tor browser, then you'll have
a tor browser which can successfully visit
It was recorded, and the Defcon people tell me that the video will be
appearing sometime in October or November.
I like Alec's list. Here's the subset of his list I find most compelling:
* We've taught users that https is what they should see in their browser
tab. Browsers are heading towards not letting you do stuff unless the
url says https. We can't, and shouldn't, fight that trend.
* Admins should be able to run their Tor onion service at a different
location than their webserver. "End to end" in onion encryption means
"Tor client to Tor client", but "end to end" in web encryption means
"Browser to Webserver". You should be able to have both. Never forget
the phrase "SSL added and removed here"!
* People who write complicated web services should be able to have very
simple "if it's not https, don't allow it" rules, and asking them to
create an onion-sized hole in their security rules is foolish and harmful.
It seems to me that an onion address, where you actually have a private
key that proves that you "are" the onion address, is a slam dunk for
a Domain Validated (DV) situation. It's exactly what everybody should
have wanted for DV certs from the beginning.
(In fact, technically speaking, there's no particular need to have a
trusted central third party do the validation, since onion domains are
*self* validating. If we made a tool to generate a cert chain using the
onion private key to certify the traditional TLS key, and we taught Tor
Browser how to verify those cert chains... we wouldn't need the sham
that is a DV certificate authority. But that is a different discussion. :)

@_date: 2017-08-18 02:29:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Is DNS required to connect to an entry node? 
Correct -- Tor clients don't do DNS requests of any sort.
For reaching the Tor relays that they want to reach, they just use the
IP address directly.
And when asking the Tor network to connect to, say, indymedia.org for
them, they write "indymedia.org port 443" in a "begin" cell and send it
down the circuit to the exit relay, and it's the exit relay that resolves
it (using its own DNS) and then connects.

@_date: 2017-08-23 03:40:22
@_author: Roger Dingledine 
@_subject: [tor-talk] MTor (multicast tor), is it going to be released? 
It's the standard story -- it's a research paper written by a research
group to show a concept, and then they moved on.
There is some code, but it was enough to do performance graphs, not
anything that they intended actual users to (be able to) use.
I don't remember the design in detail, but I remember based on the talk
at PETS thinking that they had really changed the threat model for Tor
to something much weaker, in exchange for better scalability in some
So, it is a fine idea to read about, and maybe it will spark some new
ideas when you read it, but it is not an obvious improvement for Tor in
terms of security, and also it was never intended to be an actual patch
that users could use.
All of that said, don't misunderstand me: yay research! If you haven't
read this blog post, check it out:

@_date: 2017-08-26 14:42:51
@_author: Roger Dingledine 
@_subject: [tor-talk] TBB User Agent - how decided? 
Tor Browser aims to make all the Tor Browser users look the same. That
is, the goal is to blend in with the other Tor users.
The goal *isn't* to blend in with "everything else using the Internet",
since that's a much harder goal.
See also the discussions in
And see item 5 in the list under
This question comes up every time there's a new Tor Browser release,
because somebody rushes to Panopticlick, finds that nobody else is using
the new Tor Browser version yet, and becomes concerned.

@_date: 2017-08-30 13:18:36
@_author: Roger Dingledine 
@_subject: [tor-talk] Neal Krawetz's abcission proposal, 
This is a really important point. Thinking of onion space right now as
the sum total of all that it can be is cutting off all of the future
My claim isn't "onion services are 3% of Tor traffic, so don't get
upset about anything you find on an onion service" -- my claim is "onion
services are still very early in terms of adoption, and as is usual for
many decentralized techologies the extra-early adopters are not great use
cases, and that means we need to help the space grow, and as it grows,
if we do it right, it will become more broad and thus more good".
One concrete example of an onion service that the proposed design would
cut off is Ricochet. Ricochet users want longterm-stable identifiers,
and they want the identifiers to be self-authenticating. And of course
making every Ricochet user register and maintain a domain, plus run a
webserver, is both silly and harmful.
This example also helps to illustrate why thinking of onion services as
only websites also artificially constrains their future. What if your
smart refridgerator registers an onion address when you first plug it
in, and it's only willing to receive secure updates via that channel,
meaning it has a hugely reduced surface area to attacks?
As Alec says, the list of "things that could benefit from having a safe
communication channel" is both enormous and open-ended. People like to
use phrases like "dark web" or "dark continent" to evoke mystery and
intrigue, but really, do you want to use the communications channel where
you know for sure that you're talking to the person you meant to talk
to, and you know that it's hard for somebody to eavesdrop on the content
or the metadata? Or do you want to use the communications channel where
you don't know who you're talking to, you don't know who is listening,
and you don't know whether somebody is modifying the traffic?
Calling onion services the "secure web" and everything else the "insecure
web" isn't very catchy, so maybe we should settle on calling everything
else (the places where you don't know who you're talking to or who's
listening) "dark". :)
For those following along who haven't watched our 32c3 onion services
talk, you might find it enlightening:
(The Defcon talk has a few more details about the next-generation onion
service design, but I'm told the video for it won't be up for another
couple of months.)
I think finding ways to tie onion addresses to normal ("insecure web")
domains, when a service has both, is really important too. I'd like to
live in a world where Let's Encrypt gives you an onion altname in your
https cert by default, and spins up a Tor client by default to let users
reach your webserver using whichever level of security they prefer.
And for those who made it this far down the mail, you might enjoy this
historical tor-talk mail too:
(see the paragraph towards the bottom that starts "I should also make
clear my opinion on some of the bad uses of Tor.")

@_date: 2017-12-28 23:40:50
@_author: Roger Dingledine 
@_subject: [tor-talk] CCC self-organised session - Tor research 
Hello angry person who fears science,
This is not a productive or helpful response here. It certainly doesn't
help other people think that this list is a productive or helpful space.
The research world has been critical for Tor, both in understanding
attacks and in helping to design a stronger system:
and while these social science approaches to studying Tor as a community
are not quite the same, they still don't deserve that response.
Please keep it not just civil but also productive,

@_date: 2017-02-05 14:38:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Published bridge? 
Great! Thanks for setting up a bridge. :)
Yes, bridgedb divides bridges up into different distribution
strategies, and one of those strategies is to give them out by
 For those bridges, it further divides
them up by where on the Internet you're coming from (for ipv4, it
divides by /16. For ipv6, I don't know what bitmask it picks).
So it is not surprising that you wouldn't find your own bridge on
 -- you are very likely not on an IP
address that would map to your bridge.
You can search for your nickname or identity fingerprint on
If you allow javascript, atlas even sends your browser some javascript
that hashes the fingerprint before your browser sends it to atlas, so
atlas never learns the fingerprint (onionoo only stores a hashed version
of bridge identity fingerprints, since if you know the fingerprint,
you can ask the bridge authority for the bridge descriptor and learn
everything else about it).
(If you don't allow javascript, that's fine too -- you send your actual
bridge identity fingerprint to atlas, which hashes it and then discards
the original.)
It looks promising!

@_date: 2017-02-15 12:49:52
@_author: Roger Dingledine 
@_subject: [tor-talk] What is preventing Bridge Enumeration? 
Yep! Another resource to look at is
There's plenty of work to be done, both in terms of research and in
terms of engineering, on making the bridge idea better.

@_date: 2017-01-04 21:43:29
@_author: Roger Dingledine 
@_subject: [tor-talk] List of ways to attack Tor 
Your list is pretty good, though it could do with some sorting and
some categories. :)
For another interesting set of attacks, see
These talks are some years old now, but many of the issues the talks
describe are hard to fix well so they remain an issue in some form.
If I were doing your 'short report', I would try to prioritize the various
attacks in terms of how hard they are to perform, and how damaging they
are if performed. You could imagine a two-dimensional graph where various
attacks correspond to a point on the graph.
I would also want to include a short section on how having a big list of
possible attacks does not indicate that it's a weaker system or weaker
design compared to a system or design that has a shorter but scarier list
of attacks. For example, centralized architectures don't need to think
about the more esoteric attacks, because they have the whole dataset of
what users went to which website right in front of them:
Let us know what you come up with,

@_date: 2017-01-06 18:10:34
@_author: Roger Dingledine 
@_subject: [tor-talk] [GetTor] Simple way of getting Tor countering 
Wayback Machine
Sounds like a great addition!
I wouldn't want to use that logic to add *any* website, but I think we
like archive.org at least as much as we like Google and Dropbox.

@_date: 2017-01-23 20:12:34
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.3.0.2-alpha is out! 
(Also, Tor 0.2.9.9 is out. If you didn't know, you should subscribe to
the tor-announce list and/or read the Tor blog!)
Tor 0.3.0.2-alpha fixes a denial-of-service bug where an attacker could
cause relays and clients to crash, even if they were not built with
the --enable-expensive-hardening option. This bug affects all 0.2.9.x
versions, and also affects 0.3.0.1-alpha: all relays running an affected
version should upgrade.
Tor 0.3.0.2-alpha also improves how exit relays and clients handle DNS
time-to-live values, makes directory authorities enforce the 1-to-1
mapping of relay RSA identity keys to ED25519 identity keys, fixes a
client-side onion service reachability bug, does better at selecting
the set of fallback directories, and more.
You can download the source code from  but
most users should wait for the upcoming 7.0a Tor Browser alpha release,
or for their upcoming system package updates.
Changes in version 0.3.0.2-alpha - 2017-01-23
  o Major bugfixes (security, also in 0.2.9.9):
    - Downgrade the "-ftrapv" option from "always on" to "only on when
      --enable-expensive-hardening is provided." This hardening option,
      like others, can turn survivable bugs into crashes--and having it
      on by default made a (relatively harmless) integer overflow bug
      into a denial-of-service bug. Fixes bug 21278 (TROVE-2017-001);
      bugfix on 0.2.9.1-alpha.
  o Major features (security):
    - Change the algorithm used to decide DNS TTLs on client and server
      side, to better resist DNS-based correlation attacks like the
      DefecTor attack of Greschbach, Pulls, Roberts, Winter, and
      Feamster. Now relays only return one of two possible DNS TTL
      values, and clients are willing to believe DNS TTL values up to 3
      hours long. Closes ticket 19769.
  o Major features (directory authority, security):
    - The default for AuthDirPinKeys is now 1: directory authorities
      will reject relays where the RSA identity key matches a previously
      seen value, but the Ed25519 key has changed. Closes ticket 18319.
  o Major bugfixes (client, guard, crash):
    - In circuit_get_global_origin_list(), return the actual list of
      origin circuits. The previous version of this code returned the
      list of all the circuits, and could have caused strange bugs,
      including possible crashes. Fixes bug 21118; bugfix
      on 0.3.0.1-alpha.
  o Major bugfixes (client, onion service, also in 0.2.9.9):
    - Fix a client-side onion service reachability bug, where multiple
      socks requests to an onion service (or a single slow request)
      could cause us to mistakenly mark some of the service's
      introduction points as failed, and we cache that failure so
      eventually we run out and can't reach the service. Also resolves a
      mysterious "Remote server sent bogus reason code 65021" log
      warning. The bug was introduced in ticket 17218, where we tried to
      remember the circuit end reason as a uint16_t, which mangled
      negative values. Partially fixes bug 21056 and fixes bug 20307;
      bugfix on 0.2.8.1-alpha.
  o Major bugfixes (DNS):
    - Fix a bug that prevented exit nodes from caching DNS records for
      more than 60 seconds. Fixes bug 19025; bugfix on 0.2.4.7-alpha.
  o Minor features (controller):
    - Add "GETINFO sr/current" and "GETINFO sr/previous" keys, to expose
      shared-random values to the controller. Closes ticket 19925.
  o Minor features (entry guards):
    - Add UseEntryGuards to TEST_OPTIONS_DEFAULT_VALUES in order to not
      break regression tests.
    - Require UseEntryGuards when UseBridges is set, in order to make
      sure bridges aren't bypassed. Resolves ticket 20502.
  o Minor features (fallback directories):
    - Select 200 fallback directories for each release. Closes
      ticket 20881.
    - Allow 3 fallback relays per operator, which is safe now that we
      are choosing 200 fallback relays. Closes ticket 20912.
    - Exclude relays affected by bug 20499 from the fallback list.
      Exclude relays from the fallback list if they are running versions
      known to be affected by bug 20499, or if in our tests they deliver
      a stale consensus (i.e. one that expired more than 24 hours ago).
      Closes ticket 20539.
    - Reduce the minimum fallback bandwidth to 1 MByte/s. Part of
      ticket 18828.
    - Require fallback directories to have the same address and port for
      7 days (now that we have enough relays with this stability).
      Relays whose OnionOO stability timer is reset on restart by bug
      18050 should upgrade to Tor 0.2.8.7 or later, which has a fix for
      this issue. Closes ticket 20880; maintains short-term fix
      in 0.2.8.2-alpha.
    - Require fallbacks to have flags for 90% of the time (weighted
      decaying average), rather than 95%. This allows at least 73% of
      clients to bootstrap in the first 5 seconds without contacting an
      authority. Part of ticket 18828.
    - Annotate updateFallbackDirs.py with the bandwidth and consensus
      weight for each candidate fallback. Closes ticket 20878.
    - Make it easier to change the output sort order of fallbacks.
      Closes ticket 20822.
    - Display the relay fingerprint when downloading consensuses from
      fallbacks. Closes ticket 20908.
  o Minor features (geoip, also in 0.2.9.9):
    - Update geoip and geoip6 to the January 4 2017 Maxmind GeoLite2
      Country database.
  o Minor features (next-gen onion service directories):
    - Remove the "EnableOnionServicesV3" consensus parameter that we
      introduced in 0.3.0.1-alpha: relays are now always willing to act
      as v3 onion service directories. Resolves ticket 19899.
  o Minor features (linting):
    - Enhance the changes file linter to warn on Tor versions that are
      prefixed with "tor-". Closes ticket 21096.
  o Minor features (logging):
    - In several places, describe unset ed25519 keys as "",
      rather than the scary "AAAAAAAA...AAA". Closes ticket 21037.
  o Minor bugfix (control protocol):
    - The reply to a "GETINFO config/names" request via the control
      protocol now spells the type "Dependent" correctly. This is a
      breaking change in the control protocol. (The field seems to be
      ignored by the most common known controllers.) Fixes bug 18146;
      bugfix on 0.1.1.4-alpha.
  o Minor bugfixes (bug resilience):
    - Fix an unreachable size_t overflow in base64_decode(). Fixes bug
      19222; bugfix on 0.2.0.9-alpha. Found by Guido Vranken; fixed by
      Hans Jerry Illikainen.
  o Minor bugfixes (build):
    - Replace obsolete Autoconf macros with their modern equivalent and
      prevent similar issues in the future. Fixes bug 20990; bugfix
      on 0.1.0.1-rc.
  o Minor bugfixes (client, guards):
    - Fix bug where Tor would think that there are circuits waiting for
      better guards even though those circuits have been freed. Fixes
      bug 21142; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (config):
    - Don't assert on startup when trying to get the options list and
      LearnCircuitBuildTimeout is set to 0: we are currently parsing the
      options so of course they aren't ready yet. Fixes bug 21062;
      bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (controller):
    - Make the GETINFO interface for inquiring about entry guards
      support the new guards backend. Fixes bug 20823; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (dead code):
    - Remove a redundant check for PidFile changes at runtime in
      options_transition_allowed(): this check is already performed
      regardless of whether the sandbox is active. Fixes bug 21123;
      bugfix on 0.2.5.4-alpha.
  o Minor bugfixes (documentation):
    - Update the tor manual page to document every option that can not
      be changed while tor is running. Fixes bug 21122.
  o Minor bugfixes (fallback directories):
    - Stop failing when a relay has no uptime data in
      updateFallbackDirs.py. Fixes bug 20945; bugfix on 0.2.8.1-alpha.
    - Avoid checking fallback candidates' DirPorts if they are down in
      OnionOO. When a relay operator has multiple relays, this
      prioritizes relays that are up over relays that are down. Fixes
      bug 20926; bugfix on 0.2.8.3-alpha.
    - Stop failing when OUTPUT_COMMENTS is True in updateFallbackDirs.py.
      Fixes bug 20877; bugfix on 0.2.8.3-alpha.
  o Minor bugfixes (guards, bootstrapping):
    - When connecting to a directory guard during bootstrap, do not mark
      the guard as successful until we receive a good-looking directory
      response from it. Fixes bug 20974; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (onion services):
    - Fix the config reload pruning of old vs new services so it
      actually works when both ephemeral and non-ephemeral services are
      configured. Fixes bug 21054; bugfix on 0.3.0.1-alpha.
    - Allow the number of introduction points to be as low as 0, rather
      than as low as 3. Fixes bug 21033; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (IPv6):
    - Make IPv6-using clients try harder to find an IPv6 directory
      server. Fixes bug 20999; bugfix on 0.2.8.2-alpha.
    - When IPv6 addresses have not been downloaded yet (microdesc
      consensus documents don't list relay IPv6 addresses), use hard-
      coded addresses for authorities, fallbacks, and configured
      bridges. Now IPv6-only clients can use microdescriptors. Fixes bug
      20996; bugfix on b167e82 from 19608 in 0.2.8.5-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a memory leak when configuring hidden services. Fixes bug
      20987; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (portability, also in 0.2.9.9):
    - Avoid crashing when Tor is built using headers that contain
      CLOCK_MONOTONIC_COARSE, but then tries to run on an older kernel
      without CLOCK_MONOTONIC_COARSE. Fixes bug 21035; bugfix
      on 0.2.9.1-alpha.
    - Fix Libevent detection on platforms without Libevent 1 headers
      installed. Fixes bug 21051; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (relay):
    - Honor DataDirectoryGroupReadable when tor is a relay. Previously,
      initializing the keys would reset the DataDirectory to 0700
      instead of 0750 even if DataDirectoryGroupReadable was set to 1.
      Fixes bug 19953; bugfix on 0.0.2pre16. Patch by "redfish".
  o Minor bugfixes (testing):
    - Remove undefined behavior from the backtrace generator by removing
      its signal handler. Fixes bug 21026; bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (unit tests):
    - Allow the unit tests to pass even when DNS lookups of bogus
      addresses do not fail as expected. Fixes bug 20862 and 20863;
      bugfix on unit tests introduced in 0.2.8.1-alpha
      through 0.2.9.4-alpha.
  o Code simplification and refactoring:
    - Refactor code to manipulate global_origin_circuit_list into
      separate functions. Closes ticket 20921.
  o Documentation (formatting):
    - Clean up formatting of tor.1 man page and HTML doc, where       blocks were incorrectly appearing. Closes ticket 20885.
  o Documentation (man page):
    - Clarify many options in tor.1 and add some min/max values for
      HiddenService options. Closes ticket 21058.

@_date: 2017-01-24 18:48:37
@_author: Roger Dingledine 
@_subject: [tor-talk] TAILS people 
Probably because you don't want the release candidate.

@_date: 2017-07-19 01:44:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Beware of insecure mobile Tor apps such as 
To be clear, right now there are no ios apps that are on par with the
protections that Tor Browser provides.
You can read more about the general issue at
tl;dr you should assume that there are proxy bypass flaws in every
single ios app that aims to be a Tor Browser replacement.

@_date: 2017-07-21 01:51:56
@_author: Roger Dingledine 
@_subject: [tor-talk] My ISP, university, 
It's a standard seo spammer, trying to get you to link to their thing
to boost its pagerank. Nothing to worry about.

@_date: 2017-07-23 01:40:02
@_author: Roger Dingledine 
@_subject: [tor-talk] tor 0.3.0.9 release notes 
Good find. It looks like there is an entry in the ChangeLog file in the
tarball, but not a corresponding entry in the ReleaseNotes file.
I've opened a ticket to see if there's some useful way to automate the
check in the future:

@_date: 2017-06-18 01:39:23
@_author: Roger Dingledine 
@_subject: [tor-talk] Is the recent growth in Ukrainian users confusing 
Motivated by a blog post comment:
It looks like a growing number of connections from Tor exits are being
treated by Google as being Ukrainian.
Anecdotally, I've experienced it too -- Google news keeps wanting to
give me Ukrainian news.
For those who haven't been paying attention, we got a jump in some
hundreds of thousands of .ua users recently:
and it looks like they're really users:
Here's my speculation:
You know how Google's proprietary geoip system is typically better
than Maxmind's, because they data mine the heck out of their traffic,
for example by deciding that the google maps address you ask about most
is probably your home address?
I wonder if a lot of ordinary people doing ordinary things via Tor,
and acting like people in the Ukraine, has tipped Google's sekrit-sauce
machine learning decision trees into labeling those IP addresses as
being in .ua.

@_date: 2017-03-15 15:43:10
@_author: Roger Dingledine 
@_subject: [tor-talk] A Pluggable Transport based on i2p? 
If somebody wants to build this, that sounds great to me! More options
are always good.
I agree that it could give you somewhat crummy performance, but hey,
that's a tradeoff that users can decide whether to make. Some bandwidth
is a lot better than no bandwidth in some situations.
Jonathan responded with:
But I think that's taking a very narrow view of pluggable transports.
Many people want to use Tor and/or pluggable transports to get around
censorship that otherwise prevents them from reaching the sites they
want to reach.
(Getting around censorship with no security at all is probably a bad
idea -- we keep learning that lesson as people from Iran, Egypt, etc say
"my government is stupid, they don't know how to surveil the Internet,
just let me get to Facebook" and then they realize once it's too late that
maybe they should have had some more security. So the Tor perspective is
that we should give them as many ways to get around censorship, while
getting most of Tor's security properties, as we can, but we shouldn't
help people with insecure approaches.)
That said, one of the side effects of making a successful i2p pluggable
transport would be that censors would have more incentive to censor
i2p connections. Speaking of which, I have no idea if i2p connections
right now are hard or easy to DPI for. But attracting the attention of
Tor's adversaries could speed up the arms race there, which could be a
sad result.

@_date: 2017-03-15 20:56:18
@_author: Roger Dingledine 
@_subject: [tor-talk] A Pluggable Transport based on i2p? 
This concern reminds me of the "criteria for prioritizing pluggable
transports", which started out as this email:
and then worked its way into the methodology that Yawning used for
evaluating pluggable transports:
There's lots of good reading there!

@_date: 2017-05-17 00:57:05
@_author: Roger Dingledine 
@_subject: [tor-talk] Stipends available for the Privacy Enhancing 
Hi tor-talk!
The PETS conference is where all of the academic privacy / anonymity
experts gather each year:
This year it's in Minneapolis, July 18-21. Please consider joining us --
and if you do, be sure to stay for the hike on July 22, which is where
many interactions and collaborations move forward.
The list of accepted papers is up (and of course it is open access):
Thanks to the generosity of the National Science Foundation and
(hopefully) Ford Foundation, we have stipends available again this year,
to help get people to the symposium:
The deadline for stipend application is May 31.
We especially want to use the stipends to attract perspectives
and motivations that are different from the usual academic
research-and-publishing crowd. In the past we've had great participation
from people who care about building and deploying the tools (aka hackers
and activists), and from people who care about the societal implications
of the research (aka artists and politicians).

@_date: 2017-05-21 18:01:02
@_author: Roger Dingledine 
@_subject: [tor-talk] Use of TBB behind a physically isolated Tor router? 
Right. For more on what Tor Browser does (and doesn't do) at the
application layer, see
That's one of the reasons why transparent tor proxies are bad
news. For other reasons, check out this thread from long ago:
The best way is to use that router as a firewall, to *prevent* any
communications that you didn't want coming out of the main computer,
rather than to scoop it all up and shove it through Tor and hope that
somehow that makes you safe.
The above posts have more details on how to do that well, and also
on why it's the better model.
(Projects like Whonix offer a variety of configurations for doing this
isolation, rather than building it yourself.)

@_date: 2017-11-03 16:23:11
@_author: Roger Dingledine 
@_subject: [tor-talk] [tor-announce] Tor Browser 7.0.9 is released 
Thanks again to Filippo Cavallarin for reporting this one to us!
I know that security researchers have a choice about where they can send
their bug reports, and some of the huge evil corporations pay pretty
well, so we should all applaud "We Are Segment" for choosing the path
that makes the world a safer place, rather than a less safe place.
Here is a link to their page about it:

@_date: 2017-11-04 16:02:04
@_author: Roger Dingledine 
@_subject: [tor-talk] What is mean "Guard context default" 
You're probably not doing yourself any favors by building a huge list of
addresses that you do and don't want to use. Tor does indeed have a lot
of config knobs you can turn, but you're probably not helping yourself
by this kind of setup.
Tor circuits typically consist of three relays. The first is your
guard (what I think you call the 'first gateway'), and the last is
your exit. The ExcludeExitNodes config option does not affect your
guard choice.
Part of the strength of Tor is the variety of possible points your traffic
might traverse, which makes it hard for an attacker to predict where on
the Internet they need to watch.
But more importantly here, it is very unlikely that your entry guard is
deciding what exit to use for you.
Well, first of all, the exit relays that you think are in the Ukraine
are not in the Ukraine. One is in Germany:
And another is in Sweden:
Google is mistaken about where these IP addresses are:
But second of all, maybe I'm misreading it, but do I see in your gmail
history that you're logging in via Chrome? If you're at all under threat,
using Chrome rather than Tor Browser is a terrible move:

@_date: 2017-10-05 17:20:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Multiplexing TCP streams within a circuit similar to 
Be sure to check out the KIST papers too!
Makes sense.
In fact, check out the hack that Mike Perry introduced to Tor Browser
to randomize the order of fetching things, with the goal of screwing up
website fingerprinting.
I think Tor Browser still includes this feature. But I also think most
of the WF researchers have concluded that, at least as currently built,
it doesn't do much.
There are a bunch of tickets on stream level fairness, some closed
and some still open.
Hopefully these are all useful directions to explore,

@_date: 2017-10-10 14:15:44
@_author: Roger Dingledine 
@_subject: [tor-talk] Why Tor can't load on my Linux? 
It is definitely not this.
Tor Browser uses DisableNetwork when it first starts to make sure that
your Tor doesn't try to interact with the network before you've selected
'connect directly' or 'I want to use bridges'. Otherwise your Tor goes out
and does "hello I am a Tor user!" behavior on the network when it starts,
and maybe you wanted to use a bridge to be more subtle on the network.
It is true: "my obfs4 bridges don't work" either means that you need
fresh obfs4 bridges, or something else is firewalling you or otherwise
wrong with your network connection.

@_date: 2017-10-25 22:15:39
@_author: Roger Dingledine 
@_subject: [tor-talk] Need a stable .onion address hosted by the Tor 
This is a good example of why "testing your local Tor configuration by
making a request out to the network" is a fragile approach. In this case,
a local attacker who knows the algorithm could respond to .onion dns
requests with an IP address in a range that makes your program think
everything is correct even when it's not.
Another problem with the approach, which might not seem like a big deal
now but has historically turned into a big deal in a surprising way,
is that users of your tool will always start out doing some specific
network activity, which immediately sets them apart from other users.
For example, if your tool hits the Facebook onion on startup, and then
the user actually visits the Facebook onion soon after, will there be
ways for Facebook to link the two visits together, and draw a conclusion
about whether the user who just logged into Facebook is using your tool?
I think the more stable answer long term is not to try to have some
resource always available on the Internet, but rather to change the
design of your checks so that they are correctly checking, locally,
whether your requests are making it to the Tor client as expected.
Tor Browser went through exactly this evolution: we used to have Tor
Browser hit check.torproject.org at startup, so the user could make sure
everything is ok. That approach led to a series of small miseries, where
the website would get overloaded, or a small fraction of requests would
end up with false negatives (since tordnsel, which feeds check.tp.o, is
not perfect).
The better approach turned out to be teaching Tor Launcher about the
Tor control interface, and then it can connect and see for itself (via
controller events) that its connections are indeed arriving at the local
Tor client. No actual network traffic needs to be generated.
In fact, in the distant past we had a special-purpose domain (like .onion)
in Tor named ".noconnect", which could be used for exactly this "try it
and check that it worked" purpose:
We removed that special-purpose domain though, right around the time we
disabled the ".exit" domain by default too -- there were too many cool
tricks that websites could do to manipulate your path selection.
I believe the eventual strategy that Tor Launcher settled upon was to
arrange so it was not possible to configure Tor Browser in any other
way besides sending its traffic through Tor. That approach was better
for usability *and* (thus) better for security.
Hope that helps,

@_date: 2017-10-29 14:59:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Ongoing client problem 
Right. That message comes when you tried to do a circuit-level handshake
with a relay, but you were using the wrong onion key for it.
A fine question. My first guess is that somehow your Tor client is trying
to build circuits using obsolete directory information.
Another more distant option is that you (or your platform) have hacked
together your own curve25519 implementation and it's not working right
for you.

@_date: 2017-09-01 23:22:26
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor users in US up by nearly 100,000 this month 
If you're thinking in that direction, I would suggest asking Akamai
instead. The question is "how many people are connecting from known Tor
IP addresses to your sites?"
Asking Cloudflare how many people are deciding to solve their captchas
today is measuring a different thing -- if I try to load a news article,
see a cloudflare captcha, and say "aw, fuck cloudflare, oh well" and
move on, am I a bot?

@_date: 2017-09-17 15:08:17
@_author: Roger Dingledine 
@_subject: [tor-talk] Advertised Bandwidth in tor atlas 
Thanks for wanting to run a bridge!
The short answer is that your bridge is not seeing much use. Bridge
addresses are given out to users who need them based on a variety of
distribution strategies, and each distribution strategy tries to pick
a different point on the "easy for users to find" vs "hard for censors
to find" spectrum. So some bridges are given out to many people, but
they end up blocked quickly in China; whereas other bridges are not
given out to many people, but also they aren't blocked as quickly.
At least, that's the theory -- in practice, unless you are offering the
obfs4 pluggable transport too (and it looks like you're not), your bridge
will get blocked quickly in China anyway, and most other countries right
now are able to reach the Tor network without needing bridges at all.
Perhaps you want to switch your bridge to being a normal public relay,
since it has quite a bit of bandwidth? See also
And lastly, in the future this question will get a more consistent
response on the tor-relays list:

@_date: 2017-09-18 17:50:03
@_author: Roger Dingledine 
@_subject: [tor-talk] "recently-used.xbel" file in TBB directory, 
I asked Georg about this, and he pointed to this ticket:
So yes, it looks like it's a real issue, and people should probably
help make progress on the ticket.

@_date: 2017-09-19 04:04:01
@_author: Roger Dingledine 
@_subject: [tor-talk] can't connect data bases and scientific journals 
Sorry for the disturbance everybody. This person is off-topic
for tor-talk, and I have set the person's "moderated" bit. (A good
thing too, since it caught a half dozen further emails before they
made it out to all of you.)

@_date: 2017-09-19 04:15:42
@_author: Roger Dingledine 
@_subject: [tor-talk] "the bad Tor like CP or drugs" 
I also set the "moderated" bit on this person. Please take your
dog whistles elsewhere. This is not what Tor is for or about.
Sorry for the distraction everyone.

@_date: 2018-08-01 12:01:32
@_author: Roger Dingledine 
@_subject: [tor-talk] Firewall setting in Tor Browser not working? 
Hm! I think this is a bug. It should probably both be like the simpler
Turns out there is this ticket open for fixing it:
You can find the reasoning for simplifying the interface on this ticket:
And you can read a similar thread to yours here:
Restricting your outgoing ports to 80,443 means that your Tor won't
attempt to connect to anything that isn't on port 80 or port 443.
So if your PT bridge is listening on some other port than 80 or 443, Tor
will choose not to try connecting to it, since that's what you asked for.
And if that is indeed what happened here, I think it is a further argument
in favor of simplifying the interface rather than sticking with the
current confusing one. :)

@_date: 2018-12-04 22:01:00
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor official list of new .onion addresses? 
Please don't.
In particular, if we notice that your relay is enumerating onion addresses
that it learns about, we will kick your relay out of the network.
That's because it's a known protocol bug with the old v2 onion service
design, and so we consider exploiting the bug to be a form of attacking
the network.
For a more detailed explanation, check out minutes 30-37 of
and you can follow along with slide 32 of
Or from yet another angle, if you're running a relay with the goal of
learning stuff about users, rather than the goal of providing safe
relaying for users, then I wonder what else you're willing to attack
or undermine rather than protect.
And if you're not forthcoming about your goals and why they're safe
enough, I worry that you're not a positive contributor to our community:
Hope this helps,

@_date: 2018-12-23 17:05:03
@_author: Roger Dingledine 
@_subject: [tor-talk] "Tor Circuit" list in TBB displaying incorrect exit 
bitcointalk is a cloudflare website. So is whatismyip.com.
Assuming the difference is "cloudflare vs not cloudflare", check out
You can also read
for related tickets that got closed as duplicates of  but might
still give you more context.

@_date: 2018-12-27 16:23:08
@_author: Roger Dingledine 
@_subject: [tor-talk] Abuse complaint 418289 
Port 22 is ssh, so turning it off would mean your relay won't be the exit
point for helping people reach their ssh servers while protecting their
communications metadata. Exiting to port 22 is a helpful thing to do,
but web browsing is by far the most common activity over Tor (or at least
it was last time we measured). Port 465 is for secure mail delivery,
which probably doesn't work so well over Tor these days anyway. And I
wonder what they meant by 576, and if it's a transcription error and
they meant some other port (like 587).
So, should you abandon them because they asked you to reject these extra
ports? It depends on your situation and your alternatives.
Answer  an exit that exits to 80 and 443 is still a very useful exit
relay. So turning off those small lesser-used ports is fine and
reasonable if it means you can keep running the main ports. See this
tor-relays thread for a similar discussion:
Answer  if you want to use this event as a reason to explore other
options, to figure out what other hosting places there are, how much
they would cost, and how friendly they would be, it is a fine excuse
for doing that. Who knows, you might even find a second great place
and now you could be running two exits. :)
Answer  it depends how many other relays are running at this
particular VPS hoster. If it's a huge number, then it makes more sense
to set out and find a place with fewer relays. If it's a tiny number,
then the diversity that the network gets, from having your relay there,
is a more important component.
Hope that helps! And thanks for running exits.

@_date: 2018-01-08 18:29:50
@_author: Roger Dingledine 
@_subject: [tor-talk] some websites are blocking me now 
Check out this blog post for a good start to the issue:
Craigslist's business model is basically to have a proprietary data set
that its users can interact with but that its competitors can't get. So
they're stuck being scared of the Internet and blocking connections from
anyplace that yelp, tripadvisor, etc might use to fetch their secrets.
As for getting Tor to switch circuits, Tor Browser has a "New Tor
Circuit for this Site" option (click the little green onion). But
for sites like Craiglist, moving to a new circuit will rarely help.

@_date: 2018-01-13 00:40:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Using a public relay as a bridge? 
There are actually still some subtle bugs, e.g.
(I know it's closed, but I think that's just as because it is a
rarely used configuration, not because it's actually fixed)
and my most recent favorite,
So, it mostly works, but if you want this behavior, it is much better
to set your EntryNodes option to the relay you want to use.
It depends! If you know they're safe to use, yes it's better to use
a trusted node as your first hop. Except, if the adversary guesses
that you think they're safe to use, then no it's worse, because what
if they run some middle relays and try to draw conclusions about the
circuits they see coming from your favorite relay. Also, even if you
totally trust the relay, you need to consider the network in between
your current location and that relay. Traffic routing can be surprising,
e.g. on the route from Bolivia to Brazil you might go through Miami.
For an entire paper on this topic (spoiler: it doesn't give you a concrete
answer either), check out

@_date: 2018-01-29 05:45:10
@_author: Roger Dingledine 
@_subject: [tor-talk] catastrophe: ip-api.com sees me 
Nothing is the matter, and everything sounds like it's working as
Using any browser with Tor besides Tor Browser is usually a bad idea:
You can read more about all the fixes in Tor Browser here:
Chrome, Opera, and others all have bugs that allow a website to route
traffic around the configured proxy -- and in some cases allow a website
to bypass VPNs too.
Stay safe out there,

@_date: 2018-07-08 02:54:19
@_author: Roger Dingledine 
@_subject: [tor-talk] Cannot access tor onion sites via FF 
You should first be aware that the right way to do what you want is to
use Tor Browser. Using any other browser with Tor is likely to not
provide the same behavior, protections, etc:
So if you have a great reason to not use Tor Browser, ok, but you are
in expert mode territory. :)
This could be explained by a lot of things. My first thought is that the
version of Tor you have is old, so it doesn't know about v3 onion service
names (the longer safer kind). And my first suggestion for fixing it is
to use Tor Browser.
Hope that helps,

@_date: 2018-07-08 19:38:17
@_author: Roger Dingledine 
@_subject: [tor-talk] Cannot access tor onion sites via FF 
Building Tor Browser is ugly because of another critical feature that
it provides: reproducible, aka deterministic, builds. You can read more
about that feature here:
and then if you want to build it yourself (it won't be easy), start at
But in terms of just the source code changes (from the various Firefox
releases), check out
One of the goals of Tor Browser is that Tor Browser users should blend
together as much as possible. So if you run javascript here and here
and here but not there and there and there, then this unique set of
configuration choices acts like a cookie for recognizing you. That's
why there's a security slider, to disable functionality in chunks so
that we don't splinter the anonymity sets too much.

@_date: 2018-07-11 04:33:20
@_author: Roger Dingledine 
@_subject: [tor-talk] How do tor users get past the recapacha and it's 
They did some internal measurements and realized that the number of
people connecting to Facebook over Tor was growing and had become huge:
To put that into context, that means something like 1 out of every 1000
Facebook users connected to Facebook over Tor in the month of April 2016.
And see also "part one" of
So yes, they needed an internal champion to get them to do the
measurements, but after that the measurements spoke for themselves.

@_date: 2018-03-18 07:45:10
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 4 
Dear Wanderingnet,
Please consider that there are many thousands of people on this list,
and while a variety of discussion topics are in-scope, people are more
likely to view your posts positively if you limit your volume.
Mailing lists are tough ways to interact these days (they were always
difficult to use well, but the difference these days is that fewer
people have experience using them well), so we all need to do our part
to keep the signal-to-noise ratio high.

@_date: 2018-05-14 01:46:24
@_author: Roger Dingledine 
@_subject: [tor-talk] Who controls Tor's DNS Traffic? 
For this particular issue, Tor has a feature where it tries to resolve a
few nonsense domains, and if they work, it remembers the IP addresses that
were returned, and whenever it sees those, it treats them as NXDOMAIN.
So I agree that DNS resolvers that try to sell you encyclopedias are
evil, but also Tor has some rudimentary defenses against them. :)

@_date: 2018-10-15 16:22:47
@_author: Roger Dingledine 
@_subject: [tor-talk] Questions about Directory Authority Servers 
Almost. First, it's actually only the nine v3 directory authorities.
The tenth one you see there, Serge, is a bridge authority, which is
different. And second, modern Tor clients fetch from a much larger
list, called the fallback directories, which are 100 or so relatively
stable relays.
The v3 directory authorities are responsible for collectively creating
the hourly networkstatus document, but that doesn't mean they need to
be the bottleneck for serving it.
You can learn more about the various roles here:
The simple answer is that we choose good people from among the core
Tor participant community.
You can learn more about the community here:
And more about our selection goals here:
In theory, not much happens if a minority of them are compromised. If
a majority are compromised, things start to go bad, for example because
the attacker could create their own competing networkstatus documents.
Overall the v3 directory design still seems like a win though in terms
of trust, compared to the more-complex more-decentralized approaches,
where the complexity brings in new attacks, e.g.:

@_date: 2018-10-23 01:55:27
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor VoIP PBX Architecture Discussion 
Reminds me of the early days in Guardian Project's voice support in Orbot,
where they essentially built a "push to talk" feature that encoded your
thing as an mp3 and sent it across the Tor network and played it on the
other end. I hear that, once you figured out how to use it, it was
remarkably usable.

@_date: 2018-09-07 16:28:30
@_author: Roger Dingledine 
@_subject: [tor-talk] Tor 0.3.4.6-rc is released 
Hi folks,
We screwed up and left out some changes entries in the 0.3.4.6-rc
changelog. They are now in the ChangeLog file in git:
and I've included them below for completeness. I don't think any of them
are super important, but sorry for the surprise.
  o Minor features (compilation):
    - When compiling with --enable-openbsd-malloc or --enable-tcmalloc,
      tell the compiler not to include the system malloc implementation.
      Fixes bug 20424; bugfix on 0.2.0.20-rc.
    - Don't try to use a pragma to temporarily disable the
      -Wunused-const-variable warning if the compiler doesn't support
      it. Fixes bug 26785; bugfix on 0.3.2.11.
  o Minor features (controller):
    - The control port now exposes the list of HTTPTunnelPorts and
      ExtOrPorts via GETINFO net/listeners/httptunnel and
      net/listeners/extor respectively. Closes ticket 26647.
  o Minor bugfixes (continuous integration):
    - Skip a pair of unreliable key generation tests on Windows, until
      the underlying issue in bug 26076 is resolved. Fixes bug 26830 and
      bug 26853; bugfix on 0.2.7.3-rc and 0.3.2.1-alpha respectively.
  o Minor bugfixes (directory authority):
    - When voting for recommended versions, make sure that all of the
      versions are well-formed and parsable. Fixes bug 26485; bugfix
      on 0.1.1.6-alpha.
   o Minor bugfixes (compilation):
    - Update build system so that tor builds again with --disable-unittests
      after recent refactoring. Fixes bug 26789; bugfix on 0.3.4.3-alpha.
  o Minor bugfixes (logging):
    - Improve the log message when connection initiators fail to
      authenticate direct connections to relays. Fixes bug 26927; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (portability):
    - Work around two different bugs in the OS X 10.10 and later SDKs
      that would prevent us from successfully targeting earlier versions
      of OS X. Fixes bug 26876; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (single onion services, Tor2web):
    - Log a protocol warning when single onion services or Tor2web
      clients fail to authenticate direct connections to relays. Fixes
      bug 26924; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (testing):
    - Disable core dumps in test_bt.sh, to avoid failures in "make
      distcheck". Fixes bug 26787; bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (v3 onion services):
    - Stop sending ed25519 link specifiers in v3 onion service introduce
      cells and descriptors, when the rendezvous or introduction point
      doesn't support ed25519 link authentication. Fixes bug 26627;
      bugfix on 0.3.2.4-alpha.

@_date: 2018-09-08 15:56:18
@_author: Roger Dingledine 
@_subject: [tor-talk] website typos (was re: Tor 0.3.4.6-rc is released) 
Thanks -- I've fixed it.
(Actually, it wasn't wrong yet: that page tells you what to do with a
stable Tor release, and no releases have been made yet of Tor 0.3.5.x,
which is where the path changed from src/or/tor to src/app/tor. So
hopefully I've changed it in a future-proof way. :)

@_date: 2019-01-01 17:59:38
@_author: Roger Dingledine 
@_subject: [tor-talk] Onion v3 Services in 2019 
I believe we, like debian and others, are waiting for onionbalance
support in the v3 design.
It turns out to be quite hard to change the v3 design to support the
original onionbalance approach. That's because the v3 design added
cross-certification between the overall onion descriptor and each
individual intro point component in the descriptor, so you can't just
take the individual intro points components and put them together into
your own custom frankendescriptor.
The ticket is here:
And I don't think anybody is working on it currently. :(
It already happened, starting in 0.3.5.x (which will be the next
See this changelog entry from 0.3.5.1-alpha:
  o Major features (onion services, UI change):
    - For a newly created onion service, the default version is now 3.
      Tor still supports existing version 2 services, but the operator
      now needs to set "HiddenServiceVersion 2" in order to create a new
      version 2 service. For existing services, Tor now learns the
      version by reading the key file. Closes ticket 27215.

@_date: 2019-01-02 00:00:51
@_author: Roger Dingledine 
@_subject: [tor-talk] Why some optional weights of router bandwidths are 
For those of you wondering what the heck we're talking about: these are
parameters that clients read from the consensus that help clients choose
paths in a way that is globally optimal for load balancing.
The idea stems from the realization that relays that can handle exiting
are going to get a lot of load already by clients who choose those relays
as the final hop in their circuit, so clients should avoid picking them
in *other* hops of their circuits, because that would just overload them
even more.
More info here:
You can see the current weights in your consensus file: search for the
"bandwidth-weights" line.
Ok. With that introduction, here we go:
I admit I've always found the per-position weightings logic to be a bit
of a mystery, but I believe the answer here is that these weights are
applied *in addition to* the individual weights for the relays, and the
goal of these weights is to give clients a chance to avoid using relays
in circuit positions that aren't globally optimal for the network.
With the current relays in the network, exit capacity is scarce. So the
current values for the weights mean that if a client is considering a
given relay for whether it should be the exit relay in their circuit,
its chance of being used as the exit relay should not be reduced. Or
said another way, these weights mean that if a client is thinking of
picking that relay as its exit, it's fine to do.
Compare this situation to
         Wgd - Weight for Guard+Exit-flagged nodes in the guard Position
That weight means that if a client is thinking of picking a relay for
its Guard position, and the relay has both the Guard flag and the Exit
flag, then it should adjust its chance of picking that relay by that
factor. In this case, since Wgd is 0 in the current consensus, it should
adjust its chance down to 0, meaning that clients will skip over relays
with both the Guard flag and the Exit flag when they're picking a relay
for the guard position (first hop) of their circuit.
In an alternate world where the Tor network had plenty of spare exit
capacity, the "Weg,Wem,Wee,Wed" weights might be less than 10000,
which would instruct clients to choose these various kinds of relays
less often for the Exit position, because the relays would presumably
already be getting other load from being chosen by other clients for
non-exit positions.
Hope this explanation helped rather than making things worse :)
