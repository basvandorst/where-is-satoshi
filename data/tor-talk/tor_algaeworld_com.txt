
@_date: 2004-12-08 05:18:44
@_author: tor 
@_subject: Tragedy of the Commons - was Re: (FWD) Re: BitTorrent - can it be 
Hi Roger,
     Welcome to the "Tragedy of the Commons", the issue that mojo-nation was designed to solve
although it has other issues and is not designed for the same target that tor is trying to hit.
blocking BT from the tor network , or better yet traffic shaping (possibly via trickle-like mechanisms),
could provide temporary mitagation ,especially if per protocol  accounting could be introduced on the exit nodes to throttle same,
as a user who was thinking about running several tor routers in the very near future,  I am quite concerned about DMCA takedown notices especially on any US domestic TOR nodes.
 I however was thinking about routing BT Traffic via TOR myself and have noticed that BT(at least the clients I have played with suffer from the bandwidth hog syndrome).
Additionally running an Active BT client on the same host a TOR client or router is running on executes a DOS on the tor usage.
I dont see BT over TOR as an issue if traffic shaping is imposed, and it could have to be dynamic-modifically to account for the usage of non-standard ports, or ANY port which starts sucking bandwidth.
    a tor user

@_date: 2004-12-08 05:51:38
@_author: tor 
@_subject: Traffic Congestion Control techniques. Re: Tragedy of the Commons 
Hi All,
     Hopefully this topic will server as a starting point for discussions about appropriate traffic congestion control/shaping
techniques/algorithms/tools for the TOR network.(sigh if this was standard TCP/IP we would just emit ICMP source quenchs to the source of the congestion to throttle the connection,(just 1 technique)).
So a couple of choices are in front of us, some constrained by the design goals of  TOR itself others by the effectiveness they either
provide or dont provide.
Client Throttling
has to be regarded as voluntary(nice clients).
a nasty/Bad/evil/incompetant  client can ruin the networks day or generate DMCA takedown notices via illegal BT traffic
for exit nodes, a DOS(permanent) against exit nodes in repressive jurisdictions(US etc).
Entry Router/Middleman Throttling
Is it possible given the current design?
 if so what protects traffic transiting the node from  per protocol traffic
analysis by the Entry/middleman node itself(evil node)?
are the attacks possible by an evil entry node different
from those possible via an evil middleman TOR?
exit throttling
Network is Still under load, is it possible to have traffic congestion control and have an anonymous network still.
without redesigning BT as a M out of N shares Secret splitting problem?
Doesnt Solve DMCA issue. BT users can switch port usage etc, would require port utilization tracking/analysis
to stop BT.
Additions suggestions comments to the list please...
    a tor user
p.s. Think of it as evolution in action(i.e. evolve or die)(as an anonymous network, the anonymous remailer network faced a lot of these issues :)

@_date: 2004-11-30 07:18:49
@_author: tor 
@_subject: some tor questions 
Use the attached code as a proxy command
i.e. in /etc/ssh_config or $HOME/.ssh/config and refer to it on the ssh command line
there is an entry pointing to a japanese site but the code was missing... here is the code
dont forget SSH now supports socks5.
   cheers
    a tor user
looking for a socks client library for OSX to socksify Bittorrent(ie socks cap and socksify.. DONT compile on OSX)

@_date: 2004-11-16 22:48:10
@_author: tor 
@_subject: 0.0.9.pre6 --list-fingerprint(key generation) for server fails  
Hi all,
        I have a 1-6 mb down and 1-4 mb line up and would gladly contribute at least a middleman server
but even though I have followed instructions on the wiki and the documentation and have defined the server
parameters in torrc(DataDirectory etc,) when running tor -f torrc --list-fingerprint I get 1 line denoting version
and then it stops, at least on Pre5 before it was fixed it listed a client fingerprint (either without torrc or with server parameters undefined in torrc) with current cvs or pre6,pre5,pre4 and server parameters defined and debug going to std-err I get the 1 line(no matter if Mac OSX 10.3(pre4) or OpenBSD -current (current, pre4 to pre6), linux 2.4.20(current, pre-6, pre4) with server parameters define in torrc... still the same 1 line output and not populated Datadirectory is it time to break out gdb or is this a known issue
     kind regards
     a wouldbe tor server

@_date: 2004-11-17 15:37:00
@_author: tor 
@_subject: 0.0.9.pre6 --list-fingerprint(key generation) for server fails 
hmm the keys finally showed up in the proper directory... guess I am just too impatient...
     thanx anyway
    a would be tor server
p.s. I wanted to be able to create the keys as part of image creation process so I guess I will be studying that code more closely

@_date: 2004-11-20 08:03:20
@_author: tor 
@_subject: 0.0.9.pre6 --list-fingerprint(key generation) for server fails 
============================== START ==============================
Hi Roger,
         its now core dumping when using --list-fingerprint BEFORE complete key generation is achieved(the secret keys get produced and it cores,(this is on OpenBSD), may be the current CVS, when its just started without --list-fingerprint then key generation appears as normal. just a minor issue for latter at this point. This is being SQA-ed:) in my lab, as I am developing
a script to write already keyed memory images suitable for CDROM, Compact-flash and USB-flash. These will be used for
internal distribution only to run further integration testing. Hmm couldnt find a --generate-key option and I could just fork tor as a child process, wait until all the files for server usage are generated(keys etc) and then kill via PID , then write all files produced
to my memory image. Should be a rather amusing shell script. After the images are installed at the user sites then we will
register the keys AND think about exit policies, got to coordinate that with the owners of the Internet connections.
just tried it again AND OpenBSD likes to core when list-fingerprint is used after key generation occurs leaves a  decimal 139
in the $? rc field of the shell, havent tried the other flavours yet.. got to get... more later.
          Thanx
           a Tor user

@_date: 2005-08-17 12:02:56
@_author: tor 
@_subject: Jabberd, AdiumX and TOR(reason for the crossposting..) 
Hi all,
         This was actually applicable to both groups. I have successfully been able to do the following
1. log in to a jabber server via adiumX using TOR as a transport and OTR encryption after logging.
2. run the c2s script of jabberd as a hidden service with a .onion address I am running the above under OpenBSD-current.
Steps needing to be done
torify(no that script doesnt work here) the jabberd2/resolver and the jabberd2/s2s components
I am thinking libnylon and LD_LIBRARY_PATH or something similar here.
this should allow jabberd2 to operate as a totally location hidden service.
I will update the tor wiki upon success.. question is has anyone else done this??
the OTR crowd was CCed on this due to the OTR/Adium sucess..
    a tor operator

@_date: 2005-08-17 12:56:24
@_author: tor 
@_subject: [OTR-users] Jabberd, AdiumX and TOR(reason for the crossposting..) 
Hi Clay,
via the .onion address of course
this part in  for c2s I have done and have going online at least to a .onion address for the jabber server :)
next I need to get jabberd2/resolver and jabberd2/s2s working via tor resolution and transport.
BTW I was never able to get file transport working under tor(I suspect dcc just will never work with .onion addresses)
    a tor operator
ps this is much more of a TOR post than an OTR related one now..
and again this part I have succeeded with I have the c2s portion of jabber operating with TLS and SASL via
TOR.. its linkup to other .onion based jabber server I am currently working on.

@_date: 2005-08-17 13:18:55
@_author: tor 
@_subject: [OTR-users] Jabberd, AdiumX and TOR(reason for the crossposting..) 
Hi Clay,
      Indeed by the same authors no less...
 Home address and ip address huh... this is a troll right??
      :)
     a tor operator

@_date: 2005-08-17 14:36:42
@_author: tor 
@_subject: Jabberd, AdiumX and TOR(reason for the crossposting..) 
Ahh!! thank you for responding peter and suggesting that path for onion resolution , I will try it as a first step,
and yes my real desire is to solve this issue by socks5 resolution via library redirection so that tor can do the onion resolution as normal.
     a tor operator

@_date: 2005-08-28 19:05:27
@_author: tor 
@_subject: reconsidering default exit policy 
an even more important reason is that port 6667-6669 is often used for remote control trojans..
    a tor operator

@_date: 2005-01-24 17:03:16
@_author: tor 
@_subject: Is Frank the host of wikipedia or merely a control freak in DRAG? 
Actually Frank I have a question are you merely a wikipedia user or do you host and run the wikipedia site? if the latter then you migh benefit from the technical discussions going on here.
If however you are merely a wikipedia user as a lot of us are then why do you think your points are more important that my anonymity? or are you a control freak in disguise...?
   interested readers wish to know?

@_date: 2005-01-04 22:25:48
@_author: tor 
@_subject: THIS Doesnt work for OSX  Re: Potential attack by associating onymous 
Repeat after me... tsocks neither compiles nor runs under OSX(libtool problems during compilation) and there is NO LD_PRE_LOAD under OSX.. NOR have I even been able to find even 1 socks 4/4a/5 client lib to compile under OSX..
   a tor user

@_date: 2005-01-05 12:10:44
@_author: tor 
@_subject: A Dynamic IP Problem handling it OSX style.. 
A problem I run into constantly with my Apple Powerbook 17 is operating wirelessly in several locations throughout the day and NOT rebooting my machine for days/weeks on end.(except for damned software update), I handled it at present by kill -HUP the tor process and the proper apple script way would be to wait on the network event check the current ip against an stored IP and if changed  then kill -HUP to reset the tor process, where I see this could be fouled up is having the same dhcp allocated(address reserve) IP across several dispersed routers, any Ideas?
    a tor user

@_date: 2005-07-25 21:26:48
@_author: tor 
@_subject: Soekris VPN-1401, OpenSSL,OpenBSD and TOR 
Gee roger... I dont have the time for patching.. as the board is only 76.00 can I ship one to you?
(this will benefit all hardware implementations.. :)
     a tor operator
ps need your icbm mail receiving address

@_date: 2005-07-01 11:48:11
@_author: tor 
@_subject: tor and Daemantools-0.76  
Hi All,
    as the current tor Alphas are somewhat unstable under OpenBSD AND I DONT have the time to track down the instability I have elected to put tor under DJ Bernsteins Daemontools to restart as needed.
below is the run script.. to be placed in /home/tor/tor/run
dont forget to mkdir -p /home/tor/tor/env
the run script
---cut here ---
exec 2>&1
exec envuidgid tor  envdir ./env softlimit -d3500000 /usr/bin/su tor -c ---cut here---
the -d3500000 should probably be tuned for your usage
   a tor operator

@_date: 2005-07-04 11:03:48
@_author: tor 
@_subject: tor and Daemantools-0.76 
Hi all,
       the -d3500000 is perfectly acceptable for running as a hidden service or client... I did say you needed to tune for your usage.
I did NOT post a server example...  unfortunately tor on openbsd current seems to just disappear and I have found neither core or assert messages. I am currently working on a systrace version of Daemontools, tor and privoxy for use as a server with settings appropriate for that AS I use hidden services as a VPN for certain ssh/http servers this seems to work.
Servers I have also been experimenting with are on FreeBSD5.3, OSX(Tiger and Panther), Debian-unstable as well as miscellaneous others.
and just for you Roger
a 100 second delay on restart:) ---cut here ---
sleep $SLEEP
exec 2>&1
exec envuidgid tor  envdir ./env softlimit -d3500000 /usr/bin/su tor -c ---cut here-
     a tor operator

@_date: 2005-07-05 11:08:41
@_author: tor 
@_subject: 3.5 mb data segment for clients and location hidden services was 
Hi Roger,  Tor was crashing as a simple client binary not as a server, it was providing location hidden services for a VPN and when it went down it was quite noticeable, thus using Daemontools was an obvious answer, the -d3500000 was from djbdns experiments under OpenBSD :).
              I did double check the 3.5mb data segment for client and location hidden services , and lastcom|grep tor returns no re invocations of the tor binary. I am working DB conversion and Video services this week so I wont get a chance to try servers settings till I get back to my lab next week(most machines are off pending move of machine room). Chris can you play with this on your servers and determine what is goodness for the data segment in terms of size for a server ?
I have managed to use video surveillance( via a location hidden service.
ssh port 22
Apache port 80 works
apache 443 works
apache/squid(httpd accelerator)   non-tested
webmin non-ssl  10000 works
webmin-SSL port 10000 doesnt work
usermin port 20000 untested
    a tor operator
ps chris I dont seem to be getting core dumps for tor failures.. is there a special switch beyond login.conf. coredumpsize to set this??
ps chris I dont seem to be getting core dumps for tor failures.. is there a special switch beyond login.conf.

@_date: 2005-07-12 13:37:44
@_author: tor 
@_subject: Soekris VPN-1401, OpenSSL,OpenBSD and TOR 
Recently I had the chance to obtain a soekris vpn-1401 PCI encryptor board, with the following ,
    * Hi/fn 7955 security accelerator chip
    * Total system throughput at up to 250 Mbps
    * Compression, LZS and MPPC at 420 to 510 Mbps
    * Encryption, 128/192/256 AES, DES, 3-DES and RC4 at 210 to 460 Mbps
    * Authentication, SHA-1 and MD5 at 325 to 360 Mbps
    * Public Key, RSA, DSA, SSL, IKE and DH, 24 to 70 connections/sec
      using 1024 bit keys
    * Hardware random number generator
    * vpn1401: Low Profile 33/66 Mhz 32 bit PCI 2.3, universal board for
      3.3V and 5V systems
    * vpn1411: 33/66 Mhz Mini-PCI type III form factor
    * Power max 1.8 Watt
    * Operating temperature 0-60 ?C
    * OpenBSD fully supported in latest release.
    * FreeBSD fully supported in latest release.
    * Linux support under development, see under support
      .
I will be using it as a hardware assist for AES encryption , I also picked up the mini-PC version the vpn-1411 for use in a mobile
EVDO/wifi router.. yes initially the stompbox but very quickly it will be openBSD based instead. Its my aim to have a mobile
EVDO based tor router. As the Soekris board used in the stompbox is a 486 type chip, the minipci- AES-encryptor seems to be the only way to run tor on such a lackluster CPU(it does have other tasks to do you know). The above specs would seem to indicate at least AES encryption/decryption wont be the bottleneck.
At 68-79.00 US and exportable with a certificate it would seem to be the cats meow for speeding up tor on certain platforms.
      a tor operator
ps I will try and get benchmarks as schedules permit. The slashdot IT tor hacking article was interesting so I decided to look at running  amap, nessus and others against location hidden services.onion addresses(I happen to be running a few of these :)
and see what information can be elicted from my hidden servers.

@_date: 2005-07-01 23:26:10
@_author: tor 
@_subject: tor and Daemontools-0.76 
Hi All,
    needless to say RunAsDaemon   should be set to 0 in torrc
(Daemontools has taken care of our running as a daemon as it needs to detect when the process quits by running it as a child)
   a tor operator

@_date: 2005-06-10 00:06:03
@_author: tor 
@_subject: Interception of tor exit traffic. 
Hey Ben,
Sorry about offending you personally BUT ALL of those 6 "lightweight" legal texts point out the fact that not ONLY do TOR operators in the US have a RIGHT to monitor the misuse of their facilities and that such monitoring can be freely turned over to USG, state or law enforcement. Add into the effect of stored communications exempted by Jackson and later Councilman , on technical interception, hooking the tor output buffers or simply using BPF/PCAP providers on the same node as the tor software which read out of memory locations not intercept communication in transit and presto you have a quite legally monitored network it would seem. That IS of interest to US based tor operators and as the user of tor has NO contract explicit or implicit with either the middleman or the exit nodes there ARE no legal remedies to this sort of interception at present.
As Chris in his official guise of Technical Manager of EFF has chosen answer the initial posting with rudeness and insults
and did NOT directly address the issue the postings have all pointed to and instead gave the usual IANAL.
 I elected to post very brief lightweight extracts of the pertinent Title 18 code to the list, as well as the case in which 4th amendment protections against electronic communications intercept were vanished with the decision of the court in Councilman. As it stands now this is US law. As I and many others run tor nodes from our place of business this branch of law is critical to our operation of same tor nodes lest we get hauled off to jail for a remote tor user fetching say child porn through an exit node in the US.
and when its a choice between myself and some NAMBLA member abusing little boys via tor you can bet how fast ALL of the legally gathered logs from my SHADOW IDS  I or any other operator has will wind up in the hands of law enforcement voluntarily  when the prosecutor comes knocking, same for kidnapping,murder,rape or other threats against anothers person transmitted via tor/webmail /tor/imap tor/pop3 etc.
TOR and ECPA ARE NOT a SHIELD for criminal acts...
     again sorry to anyone offended BUT I am looking for an official response from EFF attorneys not Chris Palmers IANAL.
As all statutes involving this and case law up to and exceeding Councilman would seem to support my position that
Monitoring TOR exit traffic  to enable the continued availability of that service in the face of these threats would seem on the face of it to be legal(GET a Lawyers advice as I did).
Laws for the individual states may differ from ECPA however, again see a     no for US Tor operators this is NOT spam it is legal survival
as this is OR-talk not OR-dev this forum is an entirely appropriate place for this discussion.
   a tor operator
ps Now I will shut up having said my piece and wait for others opinions on the Subject at hand
that of monitoring of tor exit traffic.

@_date: 2005-06-10 00:58:45
@_author: tor 
@_subject: call for OR-policy mailing list 
hi all,
As there seems to be some difference in opinions as to what such as ECPA and ECPA case law actually means to US Tor operators and at least one person here has objected to the "legal" nature of the discussion, may I suggest that a mailing list be created called
OR-Policy as sister mailing list to or-talk(as that seems to be more in the nature of a bug reporting and support list.)
The technical/legal issues involved could be freely expressed there without disturbing the work going on here, ever since the JAP case in Germany and others prior to that julfs anon server to name , the Australian PAX server(the first civilian pgp encrypted mailing list in 1992), and others, questions like this have been plaguing remailer operators, nym server operators , eternity service operators and now tor operators. If you are based at an EDU then at least Uni legal staff will sometimes back your play.
BUT when you are a small boutique security company then the costs of a "takeover" by the USG in the course of an investigation
of output traffic from a tor node you host could ruin and bankrupt your This subject matter needs to be addressed seriously without insulting the different participants as it is critical to operation  of US Tor nodes.
   a tor operator

@_date: 2005-06-10 02:28:20
@_author: tor 
@_subject: Why TOR Operators SHOULD always sniff their exit traffic... 
Hi Eugene ,
    I would say hard to intercept or trace under certain conditions rather than "unblockable"
   A tor carrying worm communicating via DNS tunneling might have considerable more success for the immediate future
   in penetrating "the Great FireWall of China"... although due to serialization concerns DNS/UDP is MUCH more suitable for first having a UDP/IP/TLS transport run over it first OpenVPN is what comes to mind and then anonymous circuits via tor/TCP could then be added. Its actually pretty neat/fast/cute on OC1 and faster networks . And it is a tremendous CPU hog as a server. plan for VIA Nehemiah? class processors with embedded AES crypto support and custom drivers for SSL/TLS possibly(ah the price of bleeding edge!!)
see "Black OPS of DNS" at Dan Kaminsky s site    for details on DNS tunneling .(I have spammed this list too much tonite according to at least one person:).. Dan has ssh and audio transports working via perl code over DNS/UDP. He has given demos at Codecon and other places for the past year or so of this capability..(there were 2 earlier efforts I am aware of that went public)
      a tor operator
ps JAP was tapped on at least one occasion via court order, and I believe at one point there were plans to have JAP support at least tor client usage, did that ever happen?

@_date: 2005-06-08 12:10:35
@_author: tor 
@_subject: IRCNet abuse 
Gee... if it can be exposed by sniffing then it isnt much of a privacy network. Tor operators/developers should Always sniff their servers traffic at least occasionally to see if holes or information is being   A tor/patcher who always sniffs his server traffic
    a tor user
ps not only is it NOT rude it is completely legal in the US at least to monitor the traffic to/from a given server if you own that server, this is completely a legal action under ECPA.

@_date: 2005-06-08 12:51:04
@_author: tor 
@_subject: Why TOR Operators SHOULD always sniff their exit traffic... 
gee this just hit slashdot a while ago...
yet another reason sniffing is a GOOD thing for tor operators...
*Schneier on Attack Trends: More Complex Worms*
Worms *Posted by timothy  on Wednesday June 08, *from the malice-on-the-loose dept.*
Gary W. Longsine  writes /"Bruce Schneier has posted an interesting entry on expected attack trends  to his blog. Of particular interest is the increasing sophistication of automated worm-based attacks. He cites the developing W32.spybot.KEG  worm -- once inside a network it scans for several vulnerabilities and reports its findings via IRC. Trend Micro also has information on a scanning-capable version of this worm, which they call: WORM_SPYBOT.ID

@_date: 2005-06-08 13:13:09
@_author: tor 
@_subject: IRCNet abuse 
Gee.. you really should actually read the text of the ECPA... examination of individual emails is perfectly OK
 with the courts as long as it was done on a service monitoring basis(i.e. the mails kicked into that bucket could have malware embedded , evidence of illegal transactions/blackmail/threats  etc(and working formerly as a mail admin for a large ISP all of this was encountered)) if you need/want privacy then USE encryption to the final delivery point  else EXPECT monitoring..
THIS IS REALITY..
     as far as Rude or unethical.. I consider it Rude and unethical to use a privacy system to harass or intimidate people spread malware, control Trojans(very common under IRC) , it has been my experience that this often happens, and I DONT care for an innocent being attacked by using the hardware/network connection I provide, there are such things as civil liability torts you know, if I was negligent in stopping this kind of attack appearing to originate from MY network connection, I could be sued quite successfully on this basis as I operate from a business NOT an EDU where University lawyers will defend the Universities property when it is misused by a student.
    A tor operator
 .

@_date: 2005-06-08 21:50:21
@_author: tor 
@_subject: Why TOR Operators SHOULD always sniff their exit traffic... 
No  chris I dont think you shall have that information.. AT present ANYONE can run a tor server and does.. this includes US government agencies to the best of my knowledge.. as far as what I do for a living.. you
 really dont have a clue. Come to think of this if EFF is now relying upon laws to protect anonymity  instead of technology and thinking that evil tor operators will submit their servername for excludenode inclusion then your organization is NOT giving good anonymity advice.
oh and BTW chris.. your BIO as well as your title says nothing about a juris doctor(n.b. a law degree) nor do you carry an Esq. suffix on your name(neither do I but I do have the advantage of having a actually paid a criminal law specialist for examination of my businesses legal position in running a server, have YOU??)   suffice to say that you have NO legal training to  make the claim my advice is stupid, and I have run a medium sized ISP as well as a Phone company with the legal advice I had to pay for, not obtain from someone who simply has the virtue of posting from an eff.org address and who is most definitely NOT a lawyer  nuff said in the meanwhile chris and the rest of the tor community that believe evil server operators will announce themselves  will indeed have a few sleepless nights over this Invisible IRC inside of TOR is one way of further protecting oneself on IRC.
ECPA and related case law is something I am VERY familiar with from the government investigator viewpoint BTW
I havent given ANYONE legal advice here,only stated how I run  my server(s) and the legal basis on which I perform monitoring of traffic exiting my property. You may not like it ,too bad, hopefully yours and others usage patterns of tor and associated software will become mature so that traffic analysis and monitoring are not a threat to you personally, but they are done and NOT by myself alone. This is one of the initial threats we examined when the 2 NRL folks who invented tor  approached myself and lucky at financial crypto in Anguilla to introduce tor and its inventors to the cypherpunk community.(It was a vastly different design in those days, solaris based :( and lots of other gotchas), I tend to implement EVERY attack possible at my node(s) to know what issues tor still has so I can avoid usage patterns that would tend to expose my true name as well as advise clients on its           a "possibly evil" tor operator
ps prior to calling someone stupid in public really should know who you are talking to / calling out other wise one risks making "stoopid" errors.
ps the pgp/cypherpunk/remailer community was not really evolving until David Sternlight provided LOTS irritation to us and Detweiler and others thoroughly exploited every weakness the various nym servers and remailers had to offer.
I hope I can force this group to evolve as fast as the above forced the cypherpunk community to alter their code and practices for more anonymity than laws can offer maybe then tor and eff can offer real resistance to the onrushing faith based police state

@_date: 2005-06-09 19:30:14
@_author: tor 
@_subject: The legal basis for Service monitoring Title 18 Section 2511.2.a.i 
Hi All,
BTW Chris... you may wish to examine with your EFF Attorney the following section of USC Code Title 18
     to wit:
TITLE 18--CRIMES AND CRIMINAL PROCEDURE
                             PART I--CRIMES
    CHAPTER 119--WIRE AND ELECTRONIC COMMUNICATIONS INTERCEPTION AND                    INTERCEPTION OF ORAL COMMUNICATIONS
Sec. 2511. Interception and disclosure of wire, oral, or         electronic communications prohibited
    (2)(a)(i) It shall not be unlawful under this chapter for an operator of a switchboard, or an officer, employee, or agent of a provider of wire or electronic communication service, whose facilities are used in the transmission of a wire or electronic communication, to intercept, disclose, or use that communication in the normal course of his employment while engaged in any activity which is a necessary incident to the rendition of his service or to the protection of the rights or property of the provider of that service, except that a provider of wire communication service to the public shall not utilize service observing or random monitoring except for mechanical or service quality control checks.
Note the phrase "to the protection of the rights or property of the provider of that service".
Note the prohibition of service observing/Random Monitoring applies to wire communication services only
(IE telephone companies). If current case law contradicts this please feel free to inform us all via the with specific cases etc...
please chris have the EFF lawyers comment on this aspect of ECPA. I am sure all us on the list would indeed be fascinated.
    a tor operator

@_date: 2005-06-09 19:52:31
@_author: tor 
@_subject: Addendum  Re: The legal basis for Service monitoring Title 18 Section 
In addition I came across these, as I quite often have acted under color of law when investigating computer intrusions/assisting law enforcement investigations. these are also very interesting
TITLE 18--CRIMES AND CRIMINAL PROCEDURE
                            PART I--CRIMES
   CHAPTER 119--WIRE AND ELECTRONIC COMMUNICATIONS INTERCEPTION AND                   INTERCEPTION OF ORAL COMMUNICATIONS
Sec. 2511. Interception and disclosure of wire, oral, or        electronic communications prohibited
   (2)(i)
and 3a
    (i) It shall not be unlawful under this chapter for a person acting under color of law to intercept the wire or electronic communications of a computer trespasser transmitted to, through, or from the protected computer, if--
        (I) the owner or operator of the protected computer authorizes     the interception of the computer trespasser's communications on the     protected computer;
        (II) the person acting under color of law is lawfully engaged in     an investigation;
        (III) the person acting under color of law has reasonable     grounds to believe that the contents of the computer trespasser's     communications will be relevant to the investigation; and
        (IV) such interception does not acquire communications other     than those transmitted to or from the computer trespasser.
    (3)(a) Except as provided in paragraph (b) of this subsection, a person or entity providing an electronic communication service to the public shall not intentionally divulge the contents of any communication (other than one to such person or entity, or an agent thereof) while in transmission on that service to any person or entity other than an addressee or intended recipient of such communication or an agent of such addressee or intended recipient.
    (b) A person or entity providing electronic communication service to the public may divulge the contents of any such communication--
        (i) as otherwise authorized in section 2511(2)(a) or 2517 of     this title;
        (ii) with the lawful consent of the originator or any addressee     or intended recipient of such communication;
        (iii) to a person employed or authorized, or whose facilities     are used, to forward such communication to its destination; or
        (iv) which were inadvertently obtained by the service provider     and which appear to pertain to the commission of a crime, if such     divulgence is made to a law enforcement agency.
note item iv
      again comment is invited from REAL EFF Lawyers as we are talking about the ECPA now and this is actually what the text of the law says.
   a tor operator

@_date: 2005-06-09 20:17:56
@_author: tor 
@_subject: Addendem II Re: Addendum  Re: The legal basis for Service monitoring 
exit traffic...
And in addition :)
from the U.S. Code On line via GPO Access
[Laws in effect as of January 7, 2003]
[Document not affected by Public Laws enacted between
  January 7, 2003 and February 12, 2003]
[*CITE*: *18USC2701*]
                 TITLE 18--CRIMES AND CRIMINAL PROCEDURE
                             PART I--CRIMES
CHAPTER 121--STORED WIRE AND ELECTRONIC COMMUNICATIONS AND TRANSACTIONAL                              RECORDS ACCESS
Sec. 2701. Unlawful access to stored communications
    (a) Offense.--Except as provided in subsection (c) of this section         (1) intentionally accesses without authorization a facility     through which an electronic communication service is provided; or
        (2) intentionally exceeds an authorization to access that     facility;
and thereby obtains, alters, or prevents authorized access to a wire or electronic communication while it is in electronic storage in such system shall be punished as provided in subsection (b) of this section.
    (b) Punishment.--The punishment for an offense under subsection (a) of this section is--
        (1) if the offense is committed for purposes of commercial     advantage, malicious destruction or damage, or private commercial     gain--
            (A) a fine under this title or imprisonment for not more         than one year, or both, in the case of a first offense under         this subparagraph; and
            (B) a fine under this title or imprisonment for not more         than two years, or both, for any subsequent offense under this         subparagraph; and
        (2) a fine under this title or imprisonment for not more than     six months, or both, in any other case.
    (c) Exceptions.--Subsection (a) of this section does not apply with respect to conduct authorized--
        (1) by the person or entity providing a wire or electronic     communications service;
        (2) by a user of that service with respect to a communication of     or intended for that user; or
        (3) in section 2703, 2704 or 2518 of this title.
Please note Exception C1 above...
    comment requested by EFF Attorneys..
     A tor operator

@_date: 2005-06-09 20:49:25
@_author: tor 
@_subject: Addendum III(this is the end  for now)Re: Addendem II Re: Addendum 
Why TOR Operators SHOULD always sniff their exit traffic...
and furthermore :)
                TITLE 18--CRIMES AND CRIMINAL PROCEDURE
                            PART I--CRIMES
CHAPTER 121--STORED WIRE AND ELECTRONIC COMMUNICATIONS AND TRANSACTIONAL                             RECORDS ACCESS
Sec. 2702. Voluntary disclosure of customer communications or         records
    (3) a provider of remote computing service or electronic     communication service to the public shall not knowingly divulge a     record or other information pertaining to a subscriber to or     customer of such service (not including the contents of     communications covered by paragraph (1) or (2)) to any governmental     entity.
    (b) Exceptions for disclosure of communications.--A provider described in subsection (a) may divulge the contents of a         (1) to an addressee or intended recipient of such communication     or an agent of such addressee or intended recipient;
        (2) as otherwise authorized in section 2517, 2511(2)(a), or 2703     of this title;
        (3) with the lawful consent of the originator or an addressee or     intended recipient of such communication, or the subscriber in the     case of remote computing service;
        (4) to a person employed or authorized or whose facilities are     used to forward such communication to its destination;
        (5) as may be necessarily incident to the rendition of the     service or to the protection of the rights or property of the     provider of that service; or
        (6) to a law enforcement agency--
            (A) if the contents--
                (i) were inadvertently obtained by the service provider;             and
                (ii) appear to pertain to the commission of a crime;
            (B) if required by section 227 of the Crime Control Act of         1990; or
            (C) if the provider reasonably believes that an emergency         involving immediate danger of death or serious physical injury         to any person requires disclosure of the information without         delay.
please note section 2702 section 3b4,5,6Ai,ii B and C..
Uh Chris... maybe you being technical manager at eff should actually study title 18 code pertaining to ECPA and ask the EFF attorney what it means  if you are that unclear about the law. These are just what I could come up with in about 30 minutes on access.gpo.gov. Or perhaps you live in a parallel
USA where persons and/or corporations who actually provide services are NOT allowed to defend their service and property
against misuse or criminal actions. The laws above are what govern the USA that I operate in for now...
   I am NOT a lawyer... sheesh...
 If I had a penny for every time I have heard this expression , then someone starts to spout legal advice...
All of you who have been following this discussion ARE well advised to take the above to their OWN Specialist in ECPA  law
(I suggest an ex us attorney might be particularly fit for this kind of advice and describe completely what actions you are planning to take.) The above is NOT construed to be legal advice BUT IS what the law actually says...
      a tor operator
ps sorry to all about the long US centric discussions about legal exceptions to ECPA et al

@_date: 2005-06-09 20:56:42
@_author: tor 
@_subject: Addendum III(this is the end  for now)Re: Addendem II Re: Addendum 
Why TOR Operators SHOULD always sniff their exit traffic...
oops section 4 would seem to apply also(dont know how that one got past     a tor operator

@_date: 2005-06-09 21:34:46
@_author: tor 
@_subject: US vs Councilman 03-1383   Re: Addendum III(this is the end  for 
Title 18 Section 2702.6A  Re: Why TOR Operators SHOULD always sniff their
 exit traffic...
and finally some recent gregarious examples of usage of the exception to title 18 section 2510
have a nice evening
a tor operator
ps the real questions here that interest myself and others of the tor community , if All exit/entry traffic from a node is captured and stored as part of normal IDS logging(think SHADOW) and that IDS is located on the node itself and owed/operated by the service observer, does that constitute electronic storage or does that constitute interception or does that "service observation" fall within legal boundaries(all of the ECPA statutes I have posted would seem to point to that fact) and the case law below would seem to also back that up.)
note the defendants did prevail
      *United States of America v. Bradford C. Councilman*
      No. 03-1383 (1st Cir., June 29, 2004)
Affirming the court below, the First Circuit, by a 2-1 vote, holds that defendant's alleged involvement in a scheme in which e-mails were copied while in transit to, but before their receipt by, their intended recipients, was not a violation of the Wiretap Act, 18 U.S.C. ?? 2510 _et_ _seq_. and accordingly dismisses an indictment charging defendant with conspiring to violate the Wiretap Act. In reaching this result, the Court held that the Wiretap Act does not apply to the interception of e-mails in storage. Because the e-mails at issue were in temporary storage when intercepted, no violation of the Wiretap Act occurred.
In a vigorous dissent, Circuit Judge Lipez warned that the majority's holding would effectively eliminate all protection for e-mail under the Wiretap Act, as all e-mail, when in transit, is stored in either the hard drives or RAM of the various computers involved in its delivery. As such, e-mail recipients would be relegated to the lesser protections provided by the Stored Communications Act, 18 U.S.C. ?? 2701 _et_ _seq_., which, among other things, provides certain exceptions for "conduct authorized by the person or entity providing a wire or electronic communications service ?", and lowers the showing law enforcement officials must make to access such stored communications. Judge Lipez accordingly would reverse the court below, and hold that the Wiretap Act applies to the unauthorized interception of e-mail while such e-mail is being transmitted, whether then in storage or not.
Interloc operated an online listing service for rare and out-of print books. To encourage the use of this service, Interloc provided e-mail service to various book dealer customers (the "Book Dealers") for whom it acted as an Internet Service Provider.
Defendant was responsible for supervising these ISP services. The Indictment alleged that, at defendant's behest, Interloc employees wrote a program which intercepted and copied all e-mails addressed to the Book Dealers from Amazon.com. These e-mails were allegedly read by defendant in the hopes of obtaining a competitive advantage.
These e-mails were accessed "as they were being transmitted" to their intended recipients. Importantly, however, the parties stipulated that at the time of their interception, "the messages existed in the random access memory (RAM) or in hard disks, or both, within Interloc's computer system." According to the Court, this is true of most, if not all e-mail, which is stored temporarily on various computers throughout most of its transmission from sender to recipient. As explained by the     An e-mail message, which is composed using an e-mail program, is
    transferred from one computer to another on its way to its final
    destination, the addressee. Building on the principle of store and
    forward, the message is handed to a Message Transfer Agent ("MTA")
    which stores the message locally. The message is routed through the
    network from one MTA to another until it reaches the recipient's
    mail server, which accepts it and stores it in a location accessible
    to the recipient. Once the e-nail is accessible to the recipient,
    final delivery has been completed. The final delivery process places
    the message into storage in a message store area. Often, a separate
    Mail Delivery Agent ("MDA") will be required to retrieve the e-mail
    from the MTA in order to make final delivery.
This was echoed by the dissent:
    All digital transmissions must be stored in RAM or on hard drives
    while they are being processed by computers during transmission.
    Every computer that forwards the packets that comprise an e-mail
    message must store those packets in memory while it reads their
    addresses, and every digital switch that makes up the
    telecommunications network through which the packets travel between
    computers must also store the packets while they are being routed
    across the network.
The defendant moved to dismiss the Indictment on the grounds that the Wiretap Act does not protect e-mail when it is in storage. Both the District Court and First Circuit agreed, holding that the Act only prohibits the interception of e-mail while in transit - it does not apply to e-mail that is in storage. Because defendant was not indicted under the Stored Communications Act 18 U.S.C. ?? 2701 _et_ _seq_., the dismissal of the Wiretap Act claims resulted in the dismissal of all claims against him.
In reaching the result, the Court relied upon the Act's then distinction between "wired communications" and "electronic communications." The Wiretap Act makes it a crime to "intercept" a "wire" or "electronic" communication 18 U.S.C. ?2511(1)(a). However, while the definition of "wired communication" in the Act included communications in "electronic storage," the definition of "electronic communications" did not. Thus, the Act defined "wired communications" as:
    any aural transfer made in whole or part through the use of
    facilities for the transmission of communications by the aid of
    wire, cable or other like connection between the point of origin and
    the point of reception furnished or operated by any person engaged
    in providing or operating such facilities ? _and such term includes
    any electronic storage of such communication_. 18 U.S.C. 2510(1)
The Act defined "electronic communication" as "any transfer of signs, signals, writing, images, sounds, data, or intelligence of any nature transmitted in whole or in part by a wire, radio, electromagnetic, photoelectronic or photooptical system." 18 U.S.C. ?2510(12).
Because of this distinction, the First Circuit held that the Act did not apply to "electronic communications" while they were in storage, and accordingly, affirmed the dismissal of the indictment against defendant. The Court found support for its holding in both _Steve Jackson Games Inc. v. U.S. Secret Service_, 36 F.3d 457 (5th Cir. 1994), which held that the Wiretap Act did not apply to the seizure of sent but unretrieved e-mail that was stored on a computer's hard drive, and _Konop v. Hawaiian Airlines Inc._, 302 F.3d 868 (9th Cir. 2002) _cert_. _den'd_. 537 U.S. 1193 (2003) which held that "for a web site such as Konop's to be 'intercepted' in violation of the Wiretap Act, it must be acquired during transmission, not while in electronic storage."
While the Court recognized that "it may well be that the protections of the Wiretap Act have been eviscerated as technology advances," it nonetheless felt constrained by the language of the statute to reach this result.
Circuit Judge Lipez strongly disagreed. He too noted that the Court's decision would leave e-mail effectively unprotected by the Wiretap Act, as all e-mail, while in transit, is stored on the various machines involved in its delivery. Judge Lipez believes that Congress did not intend such a result. Accordingly, he would hold that the Act applied to e-mail intercepted during its transmission, whether then in temporary storage or not.

@_date: 2005-06-09 21:50:06
@_author: tor 
@_subject: more ISP random monitoring of email Re: US vs Councilman 03-1383 
Re: The legal basis for Service monitoring Title 18 Section 2702.6A  Re:
 Why TOR Operators SHOULD always sniff their exit traffic...
this is yet another legal opinion on the issue of warrant less interception of email via ISP being forwarded to law enforcements
  The John Marhsall JournalofComputer & Information LawA
  publication of the Center for Information Technology and Privacy Law
  ofThe John Marshall Law School
Journal Home Page About the Journal  Past Issues  Search the Archives  Ordering Information  Manuscript Submission  Candidate Information  Contact the Journal   Comments
    The Fourth Amendment and the Wiretap Act Fail to Protect Against
    Random ISP Monitoring of E-mails for the Purpose of Assisting Law
    Enforcement
      Byline:
        Jim W. Ko
      Issue:
        VOL. XXII ? Winter 2004 ? NO. 2 (table of contents)
Order this issue       Abstract:
        This article takes the position that the Wiretap Act and the
        Electronic Communications Privacy Act (ECPA) does little to
        provide protection against internet service providers (ISPs)
        that randomly monitor e-mails for the purpose of turning over
        evidence of criminal activities to law enforcement officials.
        The article provides a background to the special privacy issues
        that arise in the context of computer technology and ISPs. An
        analysis of the Wiretap Act, as amended by the ECPA, reveals
        that an implicit statutory prohibition against random
        surveillance by ISPs for the purpose of assisting law
        enforcement does in fact exist. Further, remedies for violations
        of this provision are deficient because of many exceptions, and
        because criminal sanctions and the exclusionary rule are not
        included. Recent court decisions are analyzed which collectively
        suggest that the Fourth Amendment does not protect against
        evidence obtained from ISP surveillance. Finally, the article
        concludes by providing suggestions as to how the public?s
        privacy interests against random ISP monitoring can and should
        be protected.
      Related Articles:
    *
              Bench Memorandum: Whether the Monitoring and Recording of
              a Voice Mail Message in the Work Place Constitutes a
              Violation of the Electronic Communications Privacy Act or
              an Invasion of Privacy
    *
              Privacy on Federal Civilian Computer Networks: A Fourth
              Amendment Analysis of the Federal Intrusion Detection
              Network     *
              The Electronic Communications Privacy Act: Does the Answer
              to the Internet Information Privacy Problem Lie in a
              Fifteen Year Old Federal Statute? A Detailed Analysis
    *
              Warrantless Satellite Surveillance: Will our 4th Amendment
              Privacy Rights be Lost in Space?
    *
              /State v. Donis:/ The New Jersey Supreme Court Turns Its
              Back While Police Conduct Random Mobile Data Terminal
              Searches

@_date: 2005-05-20 11:32:46
@_author: tor 
@_subject: os x kernel panics 
Hi Phobos,
      I am running tor-cvs here on the latest tiger as well as on panther... not having the issues you are experiencing..
tor was compiled with the bundled compiler and userland for xcode 1.5 on panther and xcode-2.0 on tiger...
     a tor user

@_date: 2005-05-20 11:32:46
@_author: tor 
@_subject: os x kernel panics 
Hi Phobos,
      I am running tor-cvs here on the latest tiger as well as on panther... not having the issues you are experiencing..
tor was compiled with the bundled compiler and userland for xcode 1.5 on panther and xcode-2.0 on tiger...
     a tor user

@_date: 2005-11-25 18:09:20
@_author: tor 
@_subject: ATTN: for-profit Tor operators 
another problem under OSX is the layout in particular
ie /Library etc..
while darwinports will bring in daemontools I havent figured out how to use that version
I am thinking about rewriting the contrib/osx tools to use /usr/local instead as well as figuring out how to tell darwinports to do the same.
tor breaks quite often in this(OSX-Tiger) environment and if you are relying on it as an always up vpn then daemontools are a necessity
     a tor hidden services operator
ps   yummy... lots of hidden services
 to probe using the socat tunneling tricks the hackers will have a field

@_date: 2005-11-04 10:47:04
@_author: tor 
@_subject: Not so fast torpark doesnt have privoxy?  Re: Torpark if firefox 
hmm I think we need to take a step back here and look at what privoxy does to the datastream that
the browser doesnt do or does incorrectly. Privoxy actively modifies the bitstream to keep ads ,
window opens and other things you may not want happening in your browser.. not simply http
 to SOCKS4a or 5. It strips these before the more complex and vunerable browser ever sees them.
It also strips browser identifying information from the outgoing bitstream. I am sure other here could give
more complete synopsis of privoxy and its effects on the http1.1 protocol but as far as I know getting rid of privoxy
is not a gain its a loss of anonymity and privacy.
you may want to think about this quite carefully before running torpark in the configuration discussed here
or compare results when using a site like this:
  click on the Free Privacy test link and see what both systems report
keep in mind that privoxy strips advertisements and can be configured to lie to the inquiring website about
all sorts of details.
Privoxy is the "/Privacy Enhancing Proxy/".  from the privoxyFAQ
    *
      Web page content filtering (removes banners based on size,
      invisible "web-bugs", JavaScript and HTML annoyances, pop-up
      windows, etc.)
    *
      Modularized configuration that allows for standard settings and
      user settings to reside in separate files, so that installing
      updated actions files won't overwrite individual user settings.
    *
      Support for Perl Compatible Regular Expressions in the
      configuration files, and generally a more sophisticated and
      flexible configuration syntax over previous versions.
    *
      Improved cookie management features (e.g. session based cookies).
    *
      GIF de-animation.
    *
      Bypass many click-tracking scripts (avoids script redirection).
    *
      Multi-threaded (POSIX and native threads).
    *
      User-customizable HTML templates for all proxy-generated pages
      (e.g. "blocked" page).
    *
      Every feature now controllable on a per-site or per-location basis.
      regards
      A tor operator

@_date: 2005-11-08 15:13:33
@_author: tor 
@_subject: Launching Attacks via TOR Re: Hacker strikes through student's router 
They are probably referring to articles like the following:
    Launching Attacks via Tor July 10, 2005
I have written about Tor before . In my opinion, the Tor project  is an excellent effort towards protecting online privacy. I routinely use the Tor network, and it works well for me.
I believe that the merits of a project like Tor outweigh the channels of abuse it may grant malicious users. However, these channels of abuse do exist, and they cannot be ignored: if a malicious entity wants to scan or launch your network via the Internet, he or she can do this via the Tor network. This will make it incredibly difficult for you to track down the source of the attacks.
In order to demonstrate this, I setup a host on the Internet that I wanted to scan from my home network using the Nessus vulnerability scanner . Before an attacker can exploit a specific vulnerability, he or she will want to test the presence of the vulnerability using a scanner such as Nessus. Here are the steps I followed to launch the Nessus scan via Tor:
1) Install and Setup Tor .
2) Download desproxysocat  (Thanks Chris!). This tool will allow us to setup a local TCP listener that will tunnel connections via the Tor SOCKS server (listening on port 9050).
Let us assume that the IP address of the host I wanted to scan was 10.0.0.1 (yes I know this is non-routable over the Internet, but I don?t want to publish the real IP address of my host). I invoked |socat| like The above command causes |socat| to listen on port 8080, and tunnel all incoming connections to 10.0.0.1 (port 80) via the Tor SOCKS server.
[Updated July 12, 2005. Step 3 is not applicable now].
3) Configure |privoxy| to allow HTTP CONNECT requests via port 80. By default, only port 443 is allowed. To do this, configure your web browser to use |privoxy| as the HTTP proxy (127.0.0.1 81118) and browse to  Click on the "Edit" button next to the applicable "default.action" file, and choose the "Enable" radio button on the left side of ?limit-connect?. Enter ?80, 443? in the edit box and click on "Submit".
4) Install and configure Nessus 5) Launch a Nessus scan against 127.0.0.1 port 8080. Configure Nessus to limit the scan to port 8080 in the ?Scan Options? tab.
Here are some of the entries in my Apache log that were a result of the 192.168.1.1 - - [10/Jul/2005:17:29:56 -0700] "GET /Agents/ HTTP/1.1" 404 205 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:56 -0700] "GET HTTP/1.1" 404 217 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:57 -0700] "GET "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:57 -0700] "GET HTTP/1.1" 404 217 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:58 -0700] "GET HTTP/1.1" 404 217 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:58 -0700] "GET /Album/ HTTP/1.1" 404 204 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:59 -0700] "GET 404 209 "-" "Mozilla/4.75 [en] (X11, U; Nessus)"
192.168.1.1 - - [10/Jul/2005:17:29:59 -0700] "GET "Mozilla/4.75 [en] (X11, U; Nessus)"|
The 192.168.1.1 IP address represents the host that is the last onion router in the random circuit that was setup by the Tor software (NOTE: I don't want to publish the actual IP address of the last onion router that I noticed in my logs, so 192.168.1.1 is a place holder to serve as an example). Given the design of Tor, it would be extremely difficult (if not impossible) to determine the source IP address (i.e. my IP address - and not the IP address of the last onion router). The above instructions can also be used to exploit software flaws (using tools such as Metasploit ) in order to anonymously execute arbitrary commands on vulnerable hosts.
I am a big fan of the Tor project. However, potential attackers who may want to hide their tracks may abuse the anonymity granted by Tor. The aim of this post is to shed light on this fact, and I hope it is helpful to administrators are effected by attacks that seem to originate from a source that is a onion router in reality.

@_date: 2005-10-21 20:23:38
@_author: tor 
@_subject: TOR in Java? [signed] 
Java is simply a tool,
     use it incorrectly or in the wrong context and yes it can be insecure as insecure as ANY other language
and it can also be very secure indeed.
       any claims made to the contrary are simply that claims
 a tor port to java could be feasible for both security and performance  reasons provided that the correct context and environments are used(ie crypto accelerators and native compilation as well as systrace environments and binary protections)
and I DONT like programming in JAVA(but I have to do it in real life for             a Tor Operator
ps Christian I dont known about which lib that lexi is using BUT  seems to have some fairly good code
that is used in the financial crypto community

@_date: 2006-02-17 22:51:20
@_author: tor 
@_subject: got key? 
Version: GnuPG v1.2.4 (Darwin)
-----END PGP PUBLIC KEY BLOCK-----
