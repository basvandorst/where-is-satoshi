
@_date: 2006-08-22 17:58:43
@_author: Dave Korn 
@_subject: tor trying to pop mail from random IPs on win32 
I had the exact same experience some time ago as well:
 (and thread)
  In some cases it was a tor server on 110, in others it was a POP server but had previously been a TOR server on 110, other cases I couldn't be sure about.  I'm not entirely sure that somebody isn't trying to play games with carefully constructed extend requests to things that aren't actually tor servers and aren't actually listed in the directory.
  Blimey, I just had an interesting idea.    I bet if you start building a circuit, and tell your middleman server to extend it to some arbitrary IP/port of your own choosing, you can deduce from the error return whether the target port was open (but not running tor) or closed.  Somebody could be using this technique to turn Tor into an anonymous port scanner whilst bypassing exit node restrictions.  How's that for a theory?
    cheers,
        DaveK
Windows Live? Messenger has arrived. Click here to download it for free!

@_date: 2006-02-17 00:38:30
@_author: Dave Korn 
@_subject: Someone manipulating Tor routing? 
Why is it that my tor server tries to make outgoing connections to port 110, when my torrc says
ExitPolicy reject *:* # middleman only -- no exits allowed
and there aren't any servers listed in the directory that have port 110 open as a OR port and the IP of the outgoing connection isn't an IP listed in the directory either?  Is that meant to happen?
  Apart from anything else my AV scanner pops up and intercepts the connection, which is really not going to work.
     cheers,
          DaveK

@_date: 2006-02-18 18:18:28
@_author: Dave Korn 
@_subject: Someone manipulating Tor routing? 
No, it _really_ is a POP server:
Z:\csrrt-malware>echo USER guest | nc -v -v -w 5 200.222.72.146 110
200.222.72.146: inverse host lookup failed:  : Operation not permitted
(UNKNOWN) [200.222.72.146] 110 (pop3) open
+OK ready
+OK Password required for guest.
sent 13, rcvd 47
  Although it was at one stage a tor node or client:
G:\WINNT\Internet Logs>grep "200.222.72" ZALog.txt
FWIN,2005/12/27,13:42:28 +0:00 GMT,200.222.72.146:2843,82.18.35.54:9001,TCP And a little while later..
FWIN,2006/01/06,04:56:01 +0:00 GMT,200.222.72.146:0,82.18.35.54:0,ICMP FWIN,2006/01/06,10:50:11 +0:00 GMT,200.222.72.146:0,82.18.35.54:0,ICMP FWIN,2006/01/06,11:56:36 +0:00 GMT,200.222.72.146:0,82.18.35.54:0,ICMP It's also got some kind of webmail app on port 80.
But if it isn't listed in the directory, how come someone's trying to route to it?
I've seen it happen before, to other destination hosts.  One on cox.net, another which was iirc a domestic dsl line in germany.  Again, not listed in the directory.  Strange.  Here's the cox.net one:
G:\WINNT\Internet Logs>grep "68.110.196.110" ZALog.txt
PE,2005/11/16,12:46:11 +0:00 GMT,tor.exe,68.110.196.110:110,N/A
PE,2005/11/16,12:46:11 +0:00 GMT,tor.exe,68.110.196.110:110,N/A
PE,2005/11/23,09:22:57 +0:00 GMT,tor.exe,68.110.196.110:110,N/A
Which /is/ listed as a tor node on one web page I found
-> 02/18/06 18:12:04 dig 68.110.196.110 @ 194.168.4.100
Dig 110.196.110.68.in-addr.arpa at 194.168.4.100 ...
Non-authoritative answer
Recursive queries supported by this server
Query for 110.196.110.68.in-addr.arpa type=255 class=1
  110.196.110.68.in-addr.arpa PTR (Pointer) ip68-110-196-110.ri.ri.cox.net
..but doesn't seem to be there any more.  I'm still not sure what's going        DaveK
