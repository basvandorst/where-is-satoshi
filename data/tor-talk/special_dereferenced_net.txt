
@_date: 2008-12-23 09:56:59
@_author: John Brooks 
@_subject: Perfect MITM attack with valid SSL Certs 
I'm not certain which way you meant this, but just in the interest of
This sort of attack, or any PKI attacks, *do not* affect the way that tor
nodes authenticate or communicate with eachother - that is all based on the
directories, signatures, and certificate fingerprints. Those can't be faked
without breaking the math involved.
Where this does come into play, however, is communicating with external
services - smart use of this attack could allow an exit node to snoop on or
modify your SSL-encrypted communications. Tor is more susceptible to that
than most because anybody can be your exit node. In this instance, the exit
node would have to be prepared with certificates for various sites - it
couldn't pick any site at random and instantly impersonate that.
I think that may have been what you were saying, but I just wanted to state
it clearly to avoid misinterpretation.
 - John Brooks

@_date: 2009-02-03 12:12:14
@_author: John Brooks 
@_subject: Time Warner bad / VPS recommendations 
As of writing, 561 of 1250 (44.88%) active routers are flagged as exit. That
is by number of routers, not by bandwidth, but the point stands regardless.
Exits are absolutely important, and in an ideal world everything would be
exit, but entry/middle nodes are still extremely useful.
 - John Brooks
On Tue, Feb 3, 2009 at 11:44 AM, Thomas Hluchnik <

@_date: 2009-02-18 18:19:21
@_author: John Brooks 
@_subject: another reason to keep ExcludeNodes 
No, the middle node cannot change data. It can, however, randomly cut out
and drop circuits, connections, or drop off the face of the earth entirely.
That is probably what was happening to him. The middle node essentially
knows nothing (other than who the entry and exit nodes are), so there would
be no benefit to doing so either.
 - John Brooks

@_date: 2009-02-23 09:33:48
@_author: John Brooks 
@_subject: aes performance 
You're mistaken here. AES *always* has a block size of 128 bits (it was one
of the requirements for the competition to create the AES standard). The
algorithm on which AES is based (Rijndael) can support 192 or 256 bits, but
this is considered nonstandard today, and does not provide any provable
benefit to security. The variable in AES that we usually refer to (as in
aes-128) is the key size. Smaller key sizes mean a smaller key space
(technically, easier to bruteforce, but still unreasonably hard at present),
but they are also dramatically slower. If I recall correctly, aes-192 is
almost 50% slower than aes-128 and aes-256 is an additional 15-25% (but I
don't have a source for those numbers at this time). AES-128 is still
considered secure.
All of that aside, the encryption speed is a non-issue here. Unless you're
using a large portion of a gigabit connection, AES will work far faster than
your line speed on a modern processor. Additionally, just measuring the
speed of that algorithm is very far from the entire story; there are MACs
involved and tor has its own things that need to be applied, including
layers of encryption. Still, I don't see encryption being a large issue for
any but low-powered machines with high bandwidth connections.
 - John Brooks
On Mon, Feb 23, 2009 at 9:23 AM, Arjan

@_date: 2009-02-05 01:32:18
@_author: John Brooks 
@_subject: Time Warner bad / VPS recommendations 
No. Aside from the Family option (which aims to help prevent multiple nodes
operated by the same person or group from being used in a circuit, with
their cooperation), Tor will not choose similar IPs. Three IPs at the same
provider would probably be pretty similar (same /24 or /16), and tor would
avoid using only those. I believe it also takes the country into account
using the geoip stuff, but i'm not certain of that.
Anyway, point is, automated methods are used to avoid putting your entire
circuit into the same hands, and there is always the statistical
probability. There are a lot of legitimate nodes; you'd need to run a huge
number to get any notable chance of having an entire circuit, and they'd
have to be distinct IPs and so forth.
 - John Brooks

@_date: 2009-02-02 19:48:48
@_author: John Brooks 
@_subject: Time Warner bad / VPS recommendations 
Two very important factors to keep in mind for a tor node on a VPS are
memory and FD limits. A lot of VPS software will limit the number of sockets
available to each guest, which is usually a limit tor will run into quickly.
I run my 300 KB/s node with a limit of 8192 sockets, and it usually has
5000-6000 open. Aside from that, a tor node handling a significant amount of
traffic will start using ridiculous amounts of memory after running for a
couple days; I regularly see mine at 200-300mb. VPS systems are notoriously
low on those two resources, so you should keep that in mind while searching.
As for hosts that will allow Tor, the best recommendation I have is to be
up-front about it. Explain it and ask explicitly if you will have problems;
there is a good chance they'll give a vague answer to get the sale and go
back on it later, but still worth a try.
And just because somebody should say it, thanks for being so dedicated to
running a node. Tor depends on people like you ;)
 - John Brooks

@_date: 2009-01-13 13:32:53
@_author: John Brooks 
@_subject: redirect to meagpass.net while using Tor 
We haven't heard any reports of this problem prior to this thread
(indicating that it's a fairly new node), and quite a few people so far have
reported it - which makes me think it might be a pretty high bandwidth node
(and subsequently more likely to get lots of traffic); so, my theory is that
there is a low-uptime high bandwidth node involved here.
So, I started testing google.com exiting with various high-bandwidth exit
nodes that have very little uptime, and found a hit: 'apple' (2329 86CD 9605
56CD 8053 CBEC 47C1 8908 2B34 EF09) and seen at
redirecting my traffic to the same megapass.net location. There may be
others, but this is probably the one you've all seen. Can we get the
authorities to flag that?
For the record, I exited successfully with desync, kyirong, whistlersmother,
digineol, kallio, and dumboo; these are probably okay.
 - John Brooks

@_date: 2009-01-13 14:58:49
@_author: John Brooks 
@_subject: Asynchronous bandwidth limiting 
First off, thanks for running a node - the network always needs more
As far as i'm aware, it isn't possible to specify incoming and outgoing
limits separately, and if it were, the outgoing would always be higher. For
the most part, relayed traffic is pretty close to 1:1; for everything that
comes in, there is equal data going out (to the next node in the chain, the
source, or the destination). The one major exception to this is the
directory; requests for the directory are very small, but the results can be
pretty large - but, that just means more outgoing than incoming. There is no
benefit to having more incoming bandwidth than you do outgoing bandwidth.
You can always disable the directory (DirPort 0) if you want to avoid that
little bit of outgoing traffic, but usually it isn't too significant.
Hope that helps.
 - John Brooks

@_date: 2009-01-13 15:23:23
@_author: John Brooks 
@_subject: Asynchronous bandwidth limiting 
Interesting; I wouldn't have expected it to be so high. I only measure my
bandwidth globally, not per-port. In that case, it may be a good idea for
Sebastian to disable the dirport to keep outgoing traffic roughly equivalent
to incoming, since outgoing is his limitation.
 - John Brooks

@_date: 2009-01-17 12:01:30
@_author: John Brooks 
@_subject: Am I really helping tor 
I think that ivvmm is slightly confused about the terminology here - which
is perfectly understandable. In the interest of clarity:
A bridge is not handling general tor traffic; it's not put into the
directory. Bridges exist to assist people in countries that attempt to block
tor, by giving them a place to connect to that is not listed in any tor
directory. As no countries currently attempt to block tor (to my knowledge),
that is mostly a feature for when that day comes. This means that bridges
handle far less traffic and don't get used much at all (currently).
A relay is a normal server relaying data for the network, as entry, middle,
or exit. These are listed in the directories and chosen by the clients as
their circuit. Relays are very important; every relay added increases
anonymity and available bandwidth to the network. Relays *do not* have to
allow exit traffic - you can keep the ExitPolicy as rejecting everything,
and your relay will only handle entry and middle node traffic (which avoids
abuse issues). Exit and non-exit are both very useful to the network. In my
experience, a relay will use about as much bandwidth as you let it use,
which is a sign of how desperate the network is for more of them.
I *think* that what you're going for here is running a non-exit relay; that
is more useful to the network than a bridge (although bridges are very good
too, as roger mentioned), and not allowing exit traffic avoids abuse and
most legal issues.
Sorry if this is redundant, I just wasn't certain that this was made clear
to you ;)
 - John Brooks

@_date: 2009-01-13 09:42:59
@_author: John Brooks 
@_subject: redirect to meagpass.net while using Tor 
Figure out what exit is doing this (visit  while
it's happening) and add it by name or hash to the ExcludeNodes option in
your torrc - this should prevent it from being used for any exit traffic.
Also, let us know here so the authorities can mark it as a bad exit as well.
 - John Brooks

@_date: 2009-06-30 19:22:13
@_author: John Brooks 
@_subject: FYI: router BillyGoat is offline 
Unfortunately some ISPs just aren't willing to deal with the issues;
that's how it works. You could always run a non-exit relay if you wish
to, since they'll pretty much never have abuse complaints
(theoretically, you could receive complaints related to an end user
connecting to you, but that's quite unlikely). It's basically
impossible to run an exit node with an ISP that doesn't understand tor
or isn't willing to stand up for you in the instance of abuse
complaints; i've got an informal relationship with mine where all
abuse complaints are forwarded (as per their policy) and I reply to
them and the original sender with a template letter about Tor. I've
never had anything go beyond the first mailing, and never a complaint
from the ISP.
Anyway, rambling aside, if you wish to keep contributing, consider a
non-exit node (ExitPolicy reject *:*); other than the bandwidth, your
ISP would have no reason to complain about that.
  - John Brooks

@_date: 2009-06-02 05:36:43
@_author: John Brooks 
@_subject: Banners injected in web pages at exit nodes TRHCourtney* 
Definitely abusive. Fortunately, because of how nearby most of the IPs
are, Tor will treat them as family even if the operator neglected to,
so it doesn't pose a risk to anonymity (other than the one outlying
node, but even then it's a maximum of two), but this definitely looks
like a badexit situation.
Honestly, why does somebody run a tor node if they keep
connection/session logs? Seems like an odd place to look for a
  - John Brooks

@_date: 2009-03-14 00:16:00
@_author: John Brooks 
@_subject: more on the Comcast 250 GB/mo. problem 
There is absolutely value to running tor residentially - the extra nodes add
significantly to the anonymity aspects of Tor. However, it is not true that
1,000 20KB nodes is the same amount of bandwidth to clients as 10 2000KB
nodes. The slowest node in a connection is going to define the maximum
throughput of that connection, so slow nodes will restrict client speeds. In
terms of high throughput, faster nodes are better, but in terms of
anonymity, the slower ones prevail due to numbers. Tor has a healthy mix of
both, which is probably the best solution ;)
 - John Brooks

@_date: 2009-05-14 01:23:43
@_author: John Brooks 
@_subject: Iptables configuration for a transparent proxy for a single user 
Removing '-t nat' from the last rule should do what you need. Only the
first two really need to be in the NAT table (because they are
modifying the traffic, not filtering it).
  - John Brooks
On Wed, May 13, 2009 at 11:15 PM, leandro noferini

@_date: 2010-02-04 18:34:04
@_author: John Brooks 
@_subject: Searching for "good" ISPs 
2010/2/4 Attac Heidenheim :
I've ran a fairly high bandwidth (~2TB/mo) non-exit node with Leaseweb
for almost two years, and have never had any problems. I did run exit
briefly and received a few abuse complaints, but after replying to
those with an explanation of tor, I never heard anything more about
them and never had any troubles. My choice to run non-exit is
unrelated to that.
If you're planning on running an exit node, I would suggest emailing
them, explaining Tor, and asking if there would be problems with the
handling of abuse. I expect that they would be fine with it. They've
always been a great provider, I have nothing but recommendations
Hope that helps.
 - John Brooks
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-17 18:41:03
@_author: John Brooks 
@_subject: Memory usage on relays 
This topic has been addressed before, but then the answer was often to
use/wait for 0.2.1.x or switch to another allocator. I'm thinking
there must be a real solution to this somewhere.
I run a reasonably fast (500KB/s) node with Guard+Fast+Stable, so it's
a popular destination. It runs at bandwidth capacity at all times. The
only problem with this is the massive memory usage that results; at
the moment, Tor has 748MB res usage, with almost 7 days of uptime.
Generally it escalates at a rate of 100-200MB per day after a restart,
and tops out around this number. My understanding is that most of that
memory usage is related to the open connections; socket buffers, SSL
buffers, etc. At the moment (according to /proc/x/fd), Tor has 5,364
open connections.
Short of limiting available FDs, which might harm the performance of
the node, what can I do to lower memory usage? It's currently running
the Debian testing build, 0.2.1.20-2, and openssl 0.9.8g-15+lenny6.
I'm not against doing custom builds of Tor or OpenSSL if it will help.
I did have similar problems on my previous machine running Gentoo,
where I had tried different the different allocator configurations,
and that had little or no effect.
Somebody else has to have come across this problem and some sort of
solution; I can't have Tor taking up half the available memory on my
system. Suggestions would be very appreciated.
  - John Brooks
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-17 21:29:29
@_author: John Brooks 
@_subject: Memory usage on relays 
Thanks for the prompt replies. I've got a custom-built Tor with
openssl 1.0.0-beta4 running now; i'll keep an eye on it and see if
things run better that way.
As a vaguely related sidenote, is it intentional that openssl is
statically linked? I would expect that Tor more than anything would
want to benefit from security updates as quickly as possible, and most
package managers / people won't rebuild it after an openssl update.
Seems a bit dangerous. I was able to confirm that I was running with
the right version, though, by adding the following right under Tor's
version notice:
  log(LOG_NOTICE, LD_GENERAL, "Built for %s, using %s",
OPENSSL_VERSION_TEXT, SSLeay_version(SSLEAY_VERSION));
That may be worth adding, to make which version is being used visible,
especially if it's going to be statically linked.
I'll let you know in a few days how things are going with this new setup.
 - John
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-28 11:51:05
@_author: John Brooks 
@_subject: Memory usage on relays 
As a belated update/conclusion to this thread, I've had Tor running
with openssl 1.0.0-beta5 for a bit over 7 days now. Current memory
usage is 133MB res, 155MB virtual, with 2107 open FDs. This is a very
significant improvement over the 750MB I had before, with the same
uptime. The SSL buffers do seem to have been the problem.
Thanks to everyone who helped.
 - John
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-10-06 21:02:42
@_author: John Brooks 
@_subject: Me <-> Tor <-> VPN <-> Internet? 
Then the traffic between the VPN and the actual destination won't be
encrypted, so the VPN sees everything you do. Same problem, different place.
There is no way you can encrypt traffic sent to a destination that doesn't
know how to decrypt it.
 - John Brooks

@_date: 2010-10-06 21:19:27
@_author: John Brooks 
@_subject: Me <-> Tor <-> VPN <-> Internet? 
Assuming it's not a free VPN, you also run the risk of being
identified by your billing information. If it is free, I would say
that there is just as much if not more risk of your traffic being used
You would need to find VPN software that uses TCP and will allow you
to send it through SOCKS. I don't know of any, but perhaps somebody
else does.
 - John Brooks
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.
