
@_date: 2009-07-03 10:25:41
@_author: Hans de Hartog 
@_subject: eliminating bogus port 43 exits 
After running my exit node for two weeks with info logging
switched on, my disk was getting full :-(
So I switched off info logging and ran the script again
(slightly changed to report percentages instead of counts)
and here are the results:
Port   percentage
 80          63.5
443          12.6
 43           2.6
187           1.0
All other ports less than 1%

@_date: 2009-06-14 09:57:31
@_author: Hans de Hartog 
@_subject: eliminating bogus port 43 exits 
Let's get back to the facts. I ran the following script last night
every 10 seconds for 10 hours on my exit node (lowest possible
bandwidth, i.e. 20 KBs).
Port Connections(cumulative for all runs)
443   131013
80     31367
43     306
Other ports neglectable, so why the fuzz about port 43?
The script:
netstat -n | awk '
   if(p[5] < 1000) cnt[p[5]]++
END { for (a in cnt) {
    printf("%4d %8d\n", a, cnt[a])
} }'

@_date: 2009-06-14 11:59:51
@_author: Hans de Hartog 
@_subject: eliminating bogus port 43 exits 
Thank you. I switched on info-logging and tomorrow I'll post the results
of your script.
Hans de Hartog

@_date: 2009-06-15 12:12:46
@_author: Hans de Hartog 
@_subject: eliminating bogus port 43 exits 
As promised, here are the results of Scott's script
24 hours after switching on info logging:
Sorted by port number (for ports < 1000)
   11 Jun 14 12:05:48.178 [info] Exit to port 21
    3 Jun 14 22:15:29.243 [info] Exit to port 22
    1 Jun 15 05:12:38.435 [info] Exit to port 29
 1191 Jun 14 11:51:28.925 [info] Exit to port 43
    2 Jun 15 03:39:32.109 [info] Exit to port 53
    1 Jun 14 12:54:54.073 [info] Exit to port 57
    2 Jun 15 05:19:21.415 [info] Exit to port 64
24043 Jun 14 11:07:00.997 [info] Exit to port 80
   25 Jun 14 12:37:02.716 [info] Exit to port 81
    5 Jun 14 11:29:10.296 [info] Exit to port 82
    2 Jun 14 16:34:00.878 [info] Exit to port 83
    3 Jun 14 18:04:02.749 [info] Exit to port 84
    5 Jun 14 11:16:10.207 [info] Exit to port 85
    1 Jun 14 14:52:40.523 [info] Exit to port 86
    4 Jun 14 13:41:44.467 [info] Exit to port 87
    3 Jun 14 16:34:02.507 [info] Exit to port 89
    1 Jun 15 04:44:09.560 [info] Exit to port 90
    1 Jun 15 04:27:40.454 [info] Exit to port 91
    1 Jun 14 23:32:00.738 [info] Exit to port 92
    1 Jun 15 01:24:52.137 [info] Exit to port 95
    1 Jun 14 16:12:14.378 [info] Exit to port 96
    4 Jun 15 00:03:03.627 [info] Exit to port 98
    4 Jun 14 16:08:53.067 [info] Exit to port 99
    1 Jun 15 03:42:39.595 [info] Exit to port 101
    2 Jun 14 14:00:35.252 [info] Exit to port 102
    1 Jun 14 18:04:49.153 [info] Exit to port 104
    1 Jun 14 11:38:37.984 [info] Exit to port 109
   48 Jun 14 14:38:07.948 [info] Exit to port 110
    6 Jun 14 15:22:22.942 [info] Exit to port 119
  541 Jun 14 12:00:24.675 [info] Exit to port 187
    1 Jun 14 21:36:46.609 [info] Exit to port 400
    1 Jun 15 04:55:13.365 [info] Exit to port 411
    1 Jun 14 19:16:05.586 [info] Exit to port 442
 2193 Jun 14 11:43:03.144 [info] Exit to port 443
    1 Jun 14 15:23:54.915 [info] Exit to port 462
    1 Jun 15 01:09:02.965 [info] Exit to port 554
    1 Jun 14 15:32:29.782 [info] Exit to port 623
    1 Jun 15 00:03:11.737 [info] Exit to port 666
    1 Jun 15 02:19:05.865 [info] Exit to port 800
    2 Jun 14 12:22:13.641 [info] Exit to port 808
    1 Jun 15 07:40:10.154 [info] Exit to port 809
    1 Jun 15 08:43:43.371 [info] Exit to port 888
   18 Jun 14 12:32:28.145 [info] Exit to port 995
Reverse sorted by count
24043 Jun 14 11:07:00.997 [info] Exit to port 80
 2193 Jun 14 11:43:03.144 [info] Exit to port 443
 1191 Jun 14 11:51:28.925 [info] Exit to port 43
  541 Jun 14 12:00:24.675 [info] Exit to port 187
  464 Jun 14 11:26:03.550 [info] Exit to port 5001
  173 Jun 14 11:16:51.925 [info] Exit to port 2710
  165 Jun 14 11:12:34.809 [info] Exit to port 8080
  121 Jun 14 11:34:26.406 [info] Exit to port 6667
  119 Jun 14 11:26:27.558 [info] Exit to port 51413
   94 Jun 14 11:54:26.254 [info] Exit to port 7000
   89 Jun 14 11:24:18.469 [info] Exit to port 8000
   78 Jun 14 23:48:17.454 [info] Exit to port 5004
   62 Jun 14 13:36:26.436 [info] Exit to port 5050
   48 Jun 14 14:38:07.948 [info] Exit to port 110
Will blocking/restricting port 43 improve the performance
of the tor-network? Or do we need more info (e.g. KBs/port/sec)?
Hans de Hartog

@_date: 2009-03-25 10:35:16
@_author: Hans de Hartog 
@_subject: Howto limit number of connections? 
I'm running a tor-relay for a few weeks now and I only have one problem My maxbandwidth is set to 50Kb (the minimum for also doing the DIR-stuff)
but after a few days the number of established connections for the ORport
has grown to about 1500 and my router doesn't like it (comes to a grinding
halt). Resetting the router fixes it. I have other users going thru the same router
and they start complaining.
netstat -n | grep 9001 | wc -l
Is the number of connections the problem (it's a Sitecom router WL-153)?
If yes, how can I decrease the number of connections? I'ts not an exit node.
Thanks in advance,

@_date: 2009-03-25 12:10:47
@_author: Hans de Hartog 
@_subject: [Fwd: Re: Howto limit number of connections?] 
My tor-version is 0.2.0.34 and I'm running on FreeBSD RELEASE-7.1.
The SiteCom router is provided by my ISP and is also used as wireless
accesspoint for a few laptops, wireless printer and all my telefony stuff.
The FreeBSD-box is connected to one of the fixed ports on the router.
It's a nice idea to use FreeBSD as primary router (or something else as
Eugen Leitl suggested, thank you) but I'm not sure if I'm able to make
it all work. Besides that, my ISP has probably some security hooks in
place related to the MAC-address of the router. So, going this way, I
might screw up. Besides that, my FreeBSD-box will be "promoted"
to a production status and I won't be free to "play" (i.e. reboot) with it
the way I used to.
Anyway, thanks for the answers!

@_date: 2009-03-14 13:51:40
@_author: Hans de Hartog 
@_subject: When is a relay stable? 
What are the criteria for a tor relay to be flagged as "stable" in the Tor Status pages?
Thanks in advance,

@_date: 2009-05-02 13:43:03
@_author: Hans de Hartog 
@_subject: Nameserver messages on tor's logfile 
Tor's logfile irregulary receives the following messages:
May 01 20:38:14.542 [warn] eventdns: All nameservers have failed
May 01 20:38:15.034 [notice] eventdns: Nameserver 127.0.0.1 is back up
May 01 20:52:01.832 [warn] eventdns: All nameservers have failed
May 01 20:52:02.942 [notice] eventdns: Nameserver 127.0.0.1 is back up
May 02 09:23:49.074 [warn] eventdns: All nameservers have failed
May 02 09:23:49.503 [notice] eventdns: Nameserver 127.0.0.1 is back up
May 02 12:52:15.519 [warn] eventdns: All nameservers have failed
May 02 12:52:25.533 [notice] eventdns: Nameserver 127.0.0.1 is back up
May 02 12:53:52.209 [warn] eventdns: All nameservers have failed
May 02 12:53:52.296 [notice] eventdns: Nameserver 127.0.0.1 is back up
I'm running tor 0.2.0.34 on FreeBSD 7.1-RELEASE and FWIW, I'm also
running the standard nameserver locally: BIND 9.4.2-P2.
It started after being up (as exit-relay) for about 8 days and after that, I see
those messages several times per day. My libevent-version is 1.4.10
Why is this happening? I don't see anything logged by the nameserver so
it must be libevent who thinks that the nameserver fails.
Something to worry about? Or can I simply ignore those messages?
Thanks for your time,
