
@_date: 2015-01-02 18:06:53
@_author: Jesse B. Crawford 
@_subject: [tor-talk] Giving Hidden Services some love 
Hash: SHA1
Respectfully, I think many people are missing the point of why there
is interest in HTTPS for Tor hidden sites. I think it is generally for
authentication, not session encryption.
Facebook having a signed SSL certificate for their hidden service
reliably anchors it to their corporate identity, preventing phishing
attacks and giving users confidence.
Really, the phishing problem for hidden sites is very bad. Hidden site
addresses, even "vanity" ones, contain a lot of random hexadecimal
characters that no one looks at. This makes it very easy to get
someone to click to the wrong domain.
Using a "vanity" address should be considered a best practice against
this since it requires attackers to put computational power into
finding another address with the same first n characters, but it only
increases the cost of the attack. I suspect that in the whole it is
still easier than for non-hidden services since users not deceived by
facebook.com.sketchy.ru will likely still be deceived by
I think this is a smaller risk profile for hidden services than open
internet websites since 1) users of hidden services will tend to be
more security conscious (although easy-to-use tools like the browser
bundle make this less true than it used to be) and 2) users will not
generally expect to get emails etc. with links to hidden services. But
of course 2 depends on 1 to some extent.
Obviously this identity authentication is completely irrelevant when
the hidden site operator intends to remain anonymous, but some hidden
site operators, like Facebook, do not. They benefit from the strong
authentication that SSL provides and Tor's built-in encryption does not.
(Well, Tor's built-in encryption does provide reliable tying of a
hidden service to its address - but so does DNS in most practical
situations, the whole problem is that users do not check that the
hostname/hidden service key is exactly correct but will hopefully
respond better to their browser's SSL indicator)
Yes, the CA infrastructure is not the best solution to the
authentication problem, but it is the best solution that is
implemented in user agents right now, so I think it is obvious and
desirable that hidden service operators that wish to prove their
identity as a corporation or natural person will use it.
(note: here we are using measures like GPG to prove our identities to
any list members who care that much - because of the huge risk of
phishing ALL web users should care that much)
Jesse B. Crawford
Student, Information Technology
New Mexico Inst. of Mining & Technology
 // jesse at jbcrawford.us
 // jcrawford at cs.nmt.edu

@_date: 2015-01-03 20:42:14
@_author: Jesse B. Crawford 
@_subject: [tor-talk] Giving Hidden Services some love 
What I mean is that the situations where DNS is compromised (malicious
DNS server, malicious local network operator, malicious third party
pulling a trick on the local network, etc...), while completely possible
and important to protect against, are far less common out there in the
wild than phishers using similar-but-wrong domains (we've probably all
seen a usbank.com.abunchofhexcharacters.numbers.cz before).
I realized that I missed something earlier. When I refer to SSL
certificates fixing this problem, I am referring to extended validation
(EV) certificates that validate legal entity, not to the various cheaper
certificates that only validate domain.
EV certificates tie a service to a real-world entity, typically by the
CA validating organizational documents (articles of incorporation,
charter, etc) and validating that the person who submitted the request
is an authorized agent of the organization. The certificates then
include as part of the principal not only the domain name of the host
but also the legal name of the operator.
What this means to users is that they get a green box in their address
bar with the legal entity name of the hidden service operator, which
gives them easy-peasy confidence that they are communicating with the
right party, as verified by a trusted third party.
Now, two HUGE caveats:
1) Facebook does not actually have an EV cert for their hidden service!
they have an OV cert with O=Facebook, Inc. but for various (largely
political but still largely valid) reasons Firefox does not trust the O
field and considers OV certificates no better than DV [1]. So why does
Facebook use SSL..? I don't know, perhaps they think that providing the
O field is significant (I'd say that it isn't because browsers don't
tell the user about it), or perhaps it's just for consistency with their
open web presence.
2) Don't think that I'm an advocate of the present CA infrastructure,
it's a terrible approach to the problem. But it is the approach that we
have right now. :)
Overall, what should be done? Layering SSL on top of the hidden service
system is not a good solution to the problem, but I'm also not
comfortable with just saying "users should be smart enough to validate
that they have the right address" and relying on the difficulty in
producing a near-collision address (keep in mind that many "important"
hidden services do not have a vanity address at all or have only
generated an address with a small number of chosen characters).
Probably the best solution is that hidden services that are attractive
for phishing/misdirection (just about anyone doing business in bitcoin
for example) should implement measures like showing secrets to the user
to prove the service identity, and users should of course beware. But
this solution requires service operator and user participation, making
it far less than ideal.
Hopefully I made my meaning more clear.
Jesse B. Crawford
Student, Information Technology
New Mexico Inst. of Mining & Technology
 // jesse at jbcrawford.us
 // jcrawford at cs.nmt.edu

@_date: 2015-01-04 13:31:17
@_author: Jesse B. Crawford 
@_subject: [tor-talk] Giving Hidden Services some love 
I am assuming here that users trust CAs - I think a fair assumption for
practical purposes since this is the foundation of the current
open-internet system. Fixing the problem in a general way is a much more
ambitious goal than just extending this assurance to Tor.
Yet organizations like Facebook, DuckDuckGo, and others that do not
intend to remain anonymous operate hidden services. Clearly there are
use cases where anonymity is not a requirement and is even undesirable.
These are probably a minority I agree, making this a small issue in the
grand scheme of things. Just one I thought worth explaining since SSL
came up.
Jesse B. Crawford
Student, Information Technology
New Mexico Inst. of Mining & Technology
 // jesse at jbcrawford.us
 // jcrawford at cs.nmt.edu

@_date: 2015-01-05 17:03:24
@_author: Jesse B. Crawford 
@_subject: [tor-talk] Giving Hidden Services some love 
Oh, I certainly don't intend to say that identification of either end
should be mandatory, and if I may be presumptuous I don't think that
anyone else in the conversation intends that either.
Rather, I just wanted to explain why some parties might want to use SSL
- because it allows them the option of identifying themselves in a
verifiable way, layered on top of the Tor system without needing any
additional functionality within Tor. In that way, it's actually a rather
slick solution to the problem.
The problem is, of course, that it ties into all the problems with the
CA infrastructure on the open internet, which are all essentially the
same when put through Tor (CAs aren't really that trustworthy on the
whole, for example).
It would be very cool if Tor could implement a better solution to this
problem, but I don't see any way myself. The problem is that verifying a
corporate or individual identity involves legwork that can't really be
automated, so there needs to be some human in a trusted position. And
the cost to do this work makes it impractical to do it in a distributed way.
Barring someone having a great insight about how to do this, I think the
current solution of allowing hidden service users to optionally prove
identity with SSL is the best way to go.
It may be good to write up some solid documentation (if it doesn't exist
right now, apologies if I just missed something) explaining this issue.
Basically that you do not need SSL for encryption because Tor does it
itself, and you don't need it for authentication as long as you publish
your hidden service identifier in a secured way (e.g. GPG signed) and
your users are cautious. You might choose to use SSL if you want to
prove identity to users easily with an EV cert, or if, like Facebook
apparently, it just makes the engineering easier on your end (at cost of
some performance hit). And apparently CA/B might standardize this process.
Jesse B. Crawford
Student, Information Technology
New Mexico Inst. of Mining & Technology
 // jesse at jbcrawford.us
 // jcrawford at cs.nmt.edu
