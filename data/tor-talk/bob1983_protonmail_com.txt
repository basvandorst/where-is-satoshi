
@_date: 2017-11-14 04:20:00
@_author: bob1983 
@_subject: [tor-talk] Layer-7 DoS Attack Against WWW Tor Hidden Service 
I'm the sysadmin of an unnamed computer club, we support online security and
privacy, so our website is available via a Tor hidden service. Recently, we
found a surge of CPU and RAM usage as soon as Tor has been started. A closer look
showed it was the result of a DoS script, likely a broken web crawler, or a bot
written by some script kiddies, which has been trapped inside an infinite loop
and made more than 20 requests per seconds 24 hours a day.
I have defeated the abuser by blacklisting the abused script, which takes a lot
of system resource to generate a webpage but never used by normal visitors. The
system is pretty good now, but I noticed that the Tor process still consumes
significant higher memory usage than before because of the persistent abuser.
Is there a way to limit resource usage originated from a single Tor circuit?

@_date: 2017-11-14 07:51:13
@_author: bob1983 
@_subject: [tor-talk] Layer-7 DoS Attack Against WWW Tor Hidden Service 
The first possible solution quickly came to my mind, was to do what i2p was
doing for years: assigning a placeholder IP address based on the 32-bit hash of
the circuit ID. It is not an ideal countermeasure, but it does work for simple
rate-limiting purpose and compatible with existing IP-based applications and
I've just checked the source code.
and it turned out that this feature from i2p was actually based on this patch
purposed in tor-dev mailing list!
[tor-dev] Patch: Hidden service: use inbound bind-address based on circuit ID
I don't know if it's still worth to try with this approach, or developing a
separate API should be the right way to go. Any other insights, anyone?

@_date: 2017-11-19 22:11:14
@_author: bob1983 
@_subject: [tor-talk] Privacy Pass from Cloudflare, and the CAPTCHA problem 
Cloudflare just announced its support of Privacy Pass, a challenge-response
protocol designed to avoid repetitive CAPTCHAs-solving for anonymous users,
while using Zero-Knowledge Proof to prevent the possibility of distinguishing
each user, to acquire both convenience and anonymity.
It is developed in collaboration with researchers from Royal Holloway and the
University of Waterloo.
What does the Tor community think about it? Could it be a possible solution to
the Tor-CAPTCHAs problem?
My own opinions,
1. Any 3rd-party extensions harm the anonymity of Tor Browser, don't install the
Privacy Pass plugin to your Tor Browser.
2. It only supports Cloudflare. Something like this could be a general and
standardized protocol. So we could get rid of Cloudflare CAPTCHAs, Google
CAPTCHAs, you-name-it website CAPTCHAs altogether. And we can integrate it
in our browsers and servers.
3. Even if this protocol is integrated in Tor Browser, after clicking "New
Identity", all local data will be erased. Considering this feature is frequently
used by Tor users, we still need to solve some CAPTCHAs.
Anyway, the Cloudflare-CAPTCHAs problem won't go away in the visible future,
though Privacy Pass may be a possible improvement.
4. Perhaps a good solution for now, can be a campaign, asking sysadmins to
whitelist Tor users from their Cloudflare's firewall rules. Yes, you can give
Tor users a free pass unconditionally for your website on your Cloudflare panel.
If it's not practical to do it for some websites, one can also change the stupid
CAPTCHAs to an less-disturbing automatic JavaScript challenge, so it's hard to
give an excuse for not doing anything.
It's a effective solution, we just need to ask people to do it.
This functionality is not well-known and many sysadmins are ignorant about
it. Perhaps a campaign website with a name like whitelist-tor.org can help,
we can put introduction and instructions and arguments about Cloudflare
whitelisting. So users can persuade the website to do it, sysadmins can be
educated, etc. I can host the website for the community, if there are people
who wish to join to design the web-page and write the text.
What is your opinions about Privacy Pass, CAPTCHA problem and my proposal?
