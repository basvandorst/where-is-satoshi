
@_date: 2005-08-08 19:58:56
@_author: Nils Vogels 
@_subject: Tor exiting: too many open files 
Hi there!
First of all, I'm a new tor user, so there might be some things I am
unaware of at this point :-)
After experimenting with tor a little bit, today I started my server
permanently and had it regged, so that I can also function as an
exitnode (default policy says no exitnode). I am running 0.1.0.12 from
freebsd-ports on FreeBSD 5.3-RELEASE-p2.
This morning I started my tor client, and this afternoon all was still
good. This eveing when coming home from work however, I saw that tor
had exited, and these were the famous last words:
Aug  8 18:13:34 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:35 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:35 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:35 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:36 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:36 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:36 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:36 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:37 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:37 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:37 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:37 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:38 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:39 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:39 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:42 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:43 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:43 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:44 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:44 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:45 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:46 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:46 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:47 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:48 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:48 euforia Tor: purge_expired_resolves(): Bug: Expiring a
dns resolve ('[scrubbed]') that's still pending. Forgot to cull it?
Aug  8 18:13:48 euforia Tor: dnsworker_main(): writing answer failed.
Child exiting.
Aug  8 18:13:48 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:48 euforia Tor: dns_cancel_pending_resolve(): Bug:
Address '[scrubbed]' is pending but has no pending connections!
Aug  8 18:13:49 euforia Tor: purge_expired_resolves(): Bug: Expiring a
dns resolve ('[scrubbed]') that's still pending. Forgot to cull it?
Aug  8 18:13:50 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:50 euforia Tor: connection_connect(): Error creating
network socket: Too many open files in system
Aug  8 18:13:50 euforia Tor: spawn_enough_dnsworkers(): 100 DNS
workers are spawned; all are busy. Killing one.
Aug  8 18:13:50 euforia Tor: Couldn't construct socketpair: Too many
open files in system
Aug  8 18:13:50 euforia kernel: Aug  8 18:13:50 euforia Tor: Couldn't
construct socketpair: Too many open files in system
That sure looks like a bug to me ... :-)
Does anyone have similar errors, and possibly, a way to keep tor
running for over 12 hours ? :)

@_date: 2005-08-08 20:38:01
@_author: Nils Vogels 
@_subject: Tor exiting: too many open files 
These are default BSD values, which usually (unless im dealing with a
_really_ busy webserver) isn't a bit problem:
euforia# su - _tor
$ tcsh
cputime      unlimited
filesize     unlimited
datasize     524288 kbytes
stacksize    65536 kbytes
coredumpsize unlimited
memoryuse    unlimited
vmemoryuse   unlimited
descriptors  1735
memorylocked unlimited
maxproc      867
sbsize       unlimited
Wouldnt 1500+ filedescs be enough ?

@_date: 2006-04-15 19:30:48
@_author: Nils Vogels 
@_subject: Cover Traffic 
Yes it most probably does, but it also effectively slows down the
entire Tor network bij 66%, at least when you are counting the cover
traffic in the bandwidth limits that you set for tor traffic.
Simple guidelines to happiness:
Work like you don't need the money,
Love like your heart has never been broken and
Dance like no one can see you.

@_date: 2006-08-21 08:13:07
@_author: Nils Vogels 
@_subject: tor trying to pop mail from random IPs on win32 
Your machine may be configured as TOR exit-node, allowing POP3 exit.
Have you ever changed your tor config files manually ?

@_date: 2006-10-31 11:56:27
@_author: Nils Vogels 
@_subject: Hidden Service (mysql, apache, php) 
They are no different from running a Hidden Service without the
router, since in the Tor network, the existance of routers is
effectively ignored.
 should be able
to help you out on that..
HTH & HAND,

@_date: 2007-08-28 08:48:42
@_author: Nils Vogels 
@_subject: Connections to botnet masters 
I had the same problem last week with my ISP. Also, botnet issues. I am
blocking IRC for now in my exitpolicy, to see if this solves the problem
I changed my exit nodes policy, now I only allow traffic to http(s),
If blocking IRC using Bill's example doesnt solve the issue, I'm tempted to
go that way as well. Offcourse, I would rather have an exit policy that is
as wide as possible, but I would also prefer not to be kicked off the
internet by my ISP :)

@_date: 2007-01-24 20:58:28
@_author: Nils Vogels 
@_subject: tor and p2p 
Not so much the design, but more the nature of the beast: Since you are
creating an overlay network, you will need to find a way to transport all
the data that users want.
That means you will have to have enough bandwidth to transport all the
various filetypes that are the current p2p hype, in the end, on top of the
bandwidth, you will have to encrypt and decrypt every single file exchange
going on out there.
This makes it very unlikely that any overlay network would ever be capable,
be it technologically or economically, to become big in p2p transports.
If you keep it small, yeah sure. But that kinda defeats the p2p way of

@_date: 2007-01-02 22:52:18
@_author: Nils Vogels 
@_subject: Tor and Thunderbird: Outgoing Email Unsafe? 
To overcome just this problem, I'm thinking about setting up an e-mail
service from WITHIN Tor as a set of hidden services. Basically, it
would be a webmail/pop3/imap/smtp service, that only accepts new
account requests from within tor and has a limit on the amount of
e-mails that could be sent per account per interval.
Does anyone know if this already exists, and if not, would it be a
welcome addition Tor?

@_date: 2007-01-03 11:49:49
@_author: Nils Vogels 
@_subject: Tor and Thunderbird: Outgoing Email Unsafe? 
I like to give people a choice .. if they want to enable all the
flashy shebang, just tick the option. Defaults to plain html,
offcourse ;)
That is a good idea, I will certainly give it some thought!

@_date: 2007-01-04 13:18:53
@_author: Nils Vogels 
@_subject: Question for Job and others / was: Re: Tor and Thunderbird: Outgoing Email Unsafe? 
Think about cases such as whistleblowing about for instance corporate
activities that are illegal or suspected illegal, without it having
reprecussions in your professional career, or personal situation.
Think possible AA-meetings over the internet, or discussing hobbies
that are frowned upon by activist groups in society, such as rituals
involving animals or crossdressing, just to name a few.
This reads to me that you are implying that if you are not annoying,
abusing or threatening, you have no need to hide your identity.
This, to me, is the world upside-down. My identity is not something I
give out to just anybody, especially not over the internet, where I
can not verify what happens with this information.

@_date: 2007-07-24 22:17:45
@_author: Nils Vogels 
@_subject: Proxying DIR port on standard port 80 
I'm no lighttpd expert, but when you combine $HTTP["host"] and
$HTTP["url"] I think you should be able to build something like:
$HTTP["host" ] == "imhotep.mummy.org" {
  $HTTP["url"] =~ "^/tor/" {
       proxy.server = (
          "" => (
              "host" => "localhost",
              "port" => 9030
           )
       )
   }

@_date: 2007-06-03 14:20:13
@_author: Nils Vogels 
@_subject: Compile TOR 0.1.2.14 under FreeBSD 
There is a small typo there.
Try this patch:
--- config.c.orig	Sun Jun  3 14:15:13 2007
+++ config.c	Sun Jun  3 14:15:17 2007
 -3901,7 +3901,7   defined(__OpenBSD__) || defined(__FreeBSD__) || defined(__NetBSD__)
   if (server && version < LE_13B) {
     thread_unsafe = 1;
-    sad_os = "BSD variants"
+    sad_os = "BSD variants";
       }
  defined(__APPLE__) || defined(__darwin__)
   if (server && version < LE_13B) {

@_date: 2007-06-03 14:38:44
@_author: Nils Vogels 
@_subject: Compile TOR 0.1.2.14 under FreeBSD 
Copy the patch as a file into your tor-1.2.14/src/or, and apply it like this:
# cp /tmp/patch tor-1.2.14/src/or
# cd tor-1.2.14/src/or
# patch -p0 < patch
# cd ../..
# ./configure && make
It's all in the patch manpage as well, btw.
HTH & HAND

@_date: 2007-06-03 16:07:43
@_author: Nils Vogels 
@_subject: Compile TOR 0.1.2.14 under FreeBSD 
Just FYI;
I've just submitted a pr to update the tor port to 1.2.14.

@_date: 2008-12-13 20:51:04
@_author: Nils Vogels 
@_subject: Need help with MPAA threats 
I've contacted the EFF about such a case in Europe about a year ago,
they still have to answer ..

@_date: 2008-01-24 13:44:55
@_author: Nils Vogels 
@_subject: Child pornography blocking again 
Just a few thoughts on this:
* Who would be the authority to decide what goes in the list and what
* How can you be sure that you are using the Authentic CP-List, instead of
the one that comes from The Great Wall and contains whitehouse.gov?

@_date: 2008-07-29 12:03:47
@_author: Nils Vogels 
@_subject: About US$3 Million Spent per Second on Pornography in Indonesia 
Looking at the archives of this list on seul.org, it says:
The or-talk mailing list is for all discussion about theory, design,
and development of Onion Routing. For more general discussion about
anonymity theory, including design and analysis not intended to affect
Onion Routing per se, please consult the nymip research group and its
mailing lists. For background on Onion Routing and related work
consult the old site and our anonymity bibliography.
It would seem to me that this is a more general discussion about
anonymity theory (and more general, the Internet as an authentic

@_date: 2008-05-06 21:56:56
@_author: Nils Vogels 
@_subject: Problems with XS4ALL in The Netherlands 
Hi list,
Unfortunately, I have the same experience, except for the threatning of
terminating the account.
This seems somewhat strange, since 'dizum', the new v3 authority, is run
within the XS4All network (or at least has an xs4all hostname)
Kind regards,

@_date: 2009-04-29 12:22:36
@_author: Nils Vogels 
@_subject: Version checking (was Re: 25 tbreg relays in directory) 
IMHO, just adding a list of allowed versions in the consensus will
accomplish just that, without the need of all that extra traffic and
CRC complexity.

@_date: 2009-08-04 10:47:25
@_author: Nils Vogels 
@_subject: Please help me test my hidden service 
Hi Scott,
Just trying to figure out what you are saying here:
A hidden service has it's own identifier and to my knowledge, there is
no link between the hidden service and the node that is running it,
you seem to suggest otherwise?
If there is a link between the hidden service and the node that is
running it, then I wonder how *hidden* a hidden service actually is
... since at that point it is just "a service running on node x" and
the term hidden service would be kind of deceiving.
Just because the node running it is a relay or a bridge, does that
make it less hidden? If there is no link between the service and the
node, I don't see how.

@_date: 2009-12-27 11:11:20
@_author: Nils Vogels 
@_subject: Vidalia GEOIP file problem... 
Looks like you are using the BridgeRecordUsageByCountry options, which
requires a GEOIP database to be present.
It looks like you can solve this in two ways:
Add "BridgeRecordUsageByCountry 0" to your torrc (it might break
vidalia, dunno) or install a geoip database at the location tor
expects it.

@_date: 2009-12-27 12:48:35
@_author: Nils Vogels 
@_subject: TOR is for anonymization; so how to add encryption as well? 
Traffic within TOR itself is encrypted as part of the anonimization:
When you are in the cloud, it is almost impossible to make heads or
tails out of the messages that are being sent.
When the traffic leaves the cloud, it is sent in the same way it was
entered into the cloud, ie. HTTP will still be HTTP, HTTPS will be
If you want your traffic to be both anonymous and encrypted throughout
the entire path, use an encrypted protocol, such as HTTPS, IMAPS,
POP3S, etc.
Please, also read  it will
answer not only this question, but also a few similar questions that
you might have when first starting to use tor.

@_date: 2009-12-27 19:49:57
@_author: Nils Vogels 
@_subject: Why Tor nodes based only on specific countries... 
While you are at it, please also consider the archives of this list,
you will find that you are almost never the first person to ask a
certain question:

@_date: 2009-07-01 19:33:12
@_author: Nils Vogels 
@_subject: @Scott Bennett 
Ansgar, Scott,
Guys, this is or-talk, in your previous posts I find all kinds of
insights in the?proper use of all kinds of forms of netiquette,
however nothing about tor.
I for one would greatly appreciate it if you could take your
netiquette posts off-list.
Simple guidelines to happiness:
Work like you don't need the money,
Love like your heart has never been broken and
Dance like no one can see you.

@_date: 2009-06-12 23:14:12
@_author: Nils Vogels 
@_subject: eliminating bogus port 43 exits 
Hey Scott,
I would like to suggest a functionality to make this a bit more easy:
Add support for dnsbl's to determine the exitpolicy. I know this would
be non-trivial to implement, especially given the possible abuse
scenario's and the fact that exitpolicy's are currently published in
the directory, but it would be great to have universal "known good"
and "known bad" destinations that exitnodes could use.

@_date: 2009-06-02 14:55:49
@_author: Nils Vogels 
@_subject: Banners injected in web pages at exit nodes TRHCourtney* 
Added to that,  seems to be an advertisement
system of some sorts. Seems odd to want to make a buck out of running
a tor node, at least one using the public directory.

@_date: 2009-06-20 18:01:27
@_author: Nils Vogels 
@_subject: Help Iranian dissidents 
Hey Karsten,
IMHO, Tor is, much like any other software, a tool. A tool is used to
accomplish a goal. In this case, the goal is freedom of information for the
Irani people or phrased otherwise evasion of lawful interception in Iran.
Now, one may think whatever one wants about the way a tool is used (a hammer
can be used to make a shed, or it can be used to permanently ventilate
brains), but the tool is still the tool. A tool cannot have a political
view, and I am convinced Roger et al will do their best not to let their
personal views on any matter bleed too much into the codebase of tor.

@_date: 2009-06-24 10:21:41
@_author: Nils Vogels 
@_subject: tor-mirrors (mirrors of the Tor Project website) 
Instead of removing them, it might be nicer to ask them to update their
mirror :-)

@_date: 2009-05-26 08:35:01
@_author: Nils Vogels 
@_subject: Out-of-date Tors (was Re: 25 tbreg relays in directory) 
Same here!
I am using Ubuntu from apt (but only as a client), and if needed I
could also provide updates. I used to be a package maintainer for
FreeBSD, but have moved completely off to Linux these days.
If the packagers need some help or are in time constraints, feel free
to drop me a line.

@_date: 2009-11-25 09:20:07
@_author: Nils Vogels 
@_subject: Danish TPB DNS Blocks 
Would changing the DNS server for the tor exitserver solve this? If
so, I think the exit admins should solve this, and if not risk a
badexit flag.

@_date: 2009-09-04 08:59:28
@_author: Nils Vogels 
@_subject: Please Help Me Test my Hidden Service Pt. 2 
Hey Ringo,
Doesn't seem to work using tor2web.com, but works fine using Tor from NL.
One thing tho: The content is a static HTML page, no drupal to be seen.

@_date: 2010-05-20 20:50:00
@_author: Nils Vogels 
@_subject: Family specifications (was: Re: perfect-privacy.com, Family  
Hey Andrew,
Would it be possible for my to include myself in the MyFamily line?
Would make it much simpeler to maintain, since at that point all nodes
in the family can have an identical MyFamily config statement ..
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-01-11 15:48:10
@_author: Nils Vogels 
@_subject: blutmagie law enforcement inquiry stats 
I think Olaf is expressing a concern, rather than a real-life situation for him.
On Tue, Jan 11, 2011 at 15:29, Orionjur Tor-admin

@_date: 2011-01-07 22:23:39
@_author: Nils Vogels 
@_subject: Index of hidden services? 
On Fri, Jan 7, 2011 at 20:22, Peter McCann
As long as the hidden services are manually added, i can see where
it's a good idea. The second some kind of automation starts kicking
in, scanning for hidden services, I think this is a Bad Idea.
Hidden services are called hidden for a reason: You need to look to
find them. And that is one of the features that is key here, IMHO.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-06-01 11:07:21
@_author: Nils Vogels 
@_subject: [tor-talk] Police was here - whats next? 
Hey Folkert,
On Wed, Jun 1, 2011 at 08:52, Folkert van Heusden
Most likely not. The department for Cybercrime has huge backlogs.
Officially: No.
Unofficially: They're learning.... trying to find a way to deal with Tor exits.

@_date: 2011-05-31 23:49:38
@_author: Nils Vogels 
@_subject: [tor-talk] Police was here - whats next? 
Hey Folkert,
On Tue, May 31, 2011 at 14:55, Folkert van Heusden
I was one of the exit nodes being raided in NL, and got my stuff back
after 2.5 years, after finally being able to explain face to face how
Tor works. Took a bunch of envelopes to explain the onion rings, but
it worked :)
