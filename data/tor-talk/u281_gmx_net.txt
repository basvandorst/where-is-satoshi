
@_date: 2005-06-10 11:04:48
@_author: Marcel 
@_subject: Anonymous/Nonymous Communication Coexisting? 
I configured myself like this too.  Very nice. I have one problem left
still. The machine on which the programs are, the router, doesn't want to
connect via squid nor transocks, i. e. transparent proxying works only for
the machines on the LAN, not the server/router itself.  Any hints?
Here are the pertinent iptables rules, and as one can see nothing's hitting
the OUPTUT chain:  ~# iptables-save -c -t nat
# Generated by iptables-save v1.2.11 on Fri Jun 10 10:59:23 2005
:PREROUTING ACCEPT [1204:84937]
:POSTROUTING ACCEPT [1456:101425]
:OUTPUT ACCEPT [0:0]
:SOCKSIFY - [0:0]
[101:5252] -A PREROUTING -s 192.168.167.0/255.255.255.0 -p tcp -m tcp \
[0:0] -A PREROUTING -i eth0 -p tcp -m tcp --dport 80 -j SOCKSIFY
[768:43008] -A POSTROUTING -p tcp -m tcp --tcp-flags SYN,RST SYN -j TCPMSS \
[0:0] -A POSTROUTING -s 192.168.167.0/255.255.255.0 -d ! \
[0:0] -A OUTPUT -p tcp -m tcp --tcp-flags SYN,RST,ACK SYN -j SOCKSIFY
[0:0] -A SOCKSIFY -o lo -j RETURN
[0:0] -A SOCKSIFY -p tcp -m tcp --dport 9055 -j RETURN
[0:0] -A SOCKSIFY -d 66.240.11.101 -j RETURN
[0:0] -A SOCKSIFY -d 143.247.254.11 -j RETURN
[0:0] -A SOCKSIFY -d 143.247.253.10 -j RETURN
[0:0] -A SOCKSIFY -d 216.239.64.140 -j RETURN
[0:0] -A SOCKSIFY -d 209.237.230.66 -j RETURN
[0:0] -A SOCKSIFY -d 206.241.31.21 -j RETURN
[36:1872] -A SOCKSIFY -d 192.168.167.0/255.255.255.0 -j RETURN
[0:0] -A SOCKSIFY -d 127.0.0.1 -j RETURN
[0:0] -A SOCKSIFY -s 127.0.0.1 -j RETURN
[65:3380] -A SOCKSIFY -p tcp -m tcp --tcp-flags SYN,RST,ACK SYN -j LOG \
[65:3380] -A SOCKSIFY -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8888
[0:0] -A SOCKSIFY -p tcp -j REDIRECT --to-ports 1211
# Completed on Fri Jun 10 10:59:24 2005
Many Thanks!
(GingkoBiloba server)

@_date: 2005-06-14 19:40:28
@_author: Marcel 
@_subject: Tor 0.1.0.10 is released 
Puzzled, it doesn't create its PID file and sits there:
linux486:/tmp/tor-0.1.0.10/src# /etc/init.d/tor2 start
Starting tor daemon: tor...
Jun 14 19:19:02.451 [notice] Tor v0.1.0.10. This is experimental software.
Do not rely on it for strong anonymity.
tor: epoll_create: Function not implemented
linux486:/tmp/tor-0.1.0.10# /etc/init.d/tor2 start
Starting tor daemon: tor...
Jun 14 19:21:59.106 [notice] tor_init(): Tor v0.0.9.9. This is experimental
software. Do not rely on it for strong anonymity.
I'm using Debian Sarge and /var/run/tor is 777 for testing.
Rescator (GingkoBiloba server)

@_date: 2005-06-18 16:32:07
@_author: Marcel 
@_subject: Tor ports 
This is mystifying me and I'd like to get this fixed.
Usually I get this, which is expected as my ports 9001 and 9030 as
configured are open in tcp:
Jun 15 11:23:39.366 [notice] Your ORPort is reachable from the outside.
Excellent. Publishing server descriptor.
Jun 15 11:25:19.288 [notice] Your DirPort is reachable from the outside.
But as soon I use a kernel with CONFIG_IP_NF_NAT_LOCAL=y
I get this instead:
Jun 18 16:22:30.626 [notice] Tor has successfully opened a circuit. Looks
like it's working.
Jun 18 16:22:30.627 [notice] Now checking whether ORPort and DirPort are
reachable... (this may take several minutes)
Jun 18 16:22:45.629 [notice] connection_ap_expire_beginning(): Stream is 15
seconds late on address '[scrubbed]'. Retrying.
Jun 18 16:22:45.630 [notice] circuit_log_path(): exit circ (length 3, exit
moria1): Buffy(open) marvin(open) moria1(open)
Jun 18 16:23:06.868 [notice] Tried for 60 seconds to get a connection to
[scrubbed]:9030. Giving up.
Jun 18 16:30:38.564 [warn] Your server (216.239.89.130:9001) has not
managed to confirm that its ORPort is reachable. Please check your
firewalls, ports, address, etc.
Jun 18 16:30:38.564 [warn] Your server (216.239.89.130:9030) has not
managed to confirm that its DirPort is reachable. Please check
your firewalls, ports, address, etc.

@_date: 2005-06-03 17:28:35
@_author: Marcel 
@_subject: Monitoring tor's bandwidth use. 
I use ipac-ng for that purpose with the following rules:
~# grep tor /etc/ipac-ng/rules.conf
# tor (port 9000-9005 9030-9035)
server tor in|ipac~o|+|tcp|0/0|0/0 9001 9002 9003 9004 9005 9030 9031 9032
9033 9034 9035||
server tor in|ipac~fi|+|tcp|0/0|0/0 9001 9002 9003 9004 9005 9030 9031 9032
9033 9034 9035||
server tor out|ipac~i|+|tcp|0/0 9001 9002 9003 9004 9005 9030 9031 9032
9033 9034 9035|0/0||
# tor 9001 (port 9000-9005)
client tor in|ipac~o|+|tcp|0/0 9001 9002 9003 9004 9005 9030 9031 9032 9033
9034 9035|0/0||
client tor in|ipac~fi|+|tcp|0/0 9001 9002 9003 9004 9005 9030 9031 9032
9033 9034 9035|0/0||
client tor out|ipac~i|+|tcp|0/0|0/0 9001 9002 9003 9004 9005 9030 9031 9032
9033 9034 9035||
This creates constant monitoring with iptables and here is the result in a
5 mins interval:
IP accounting summary
Host: linux486 / Time created: 2005/06/03 17:12:07 EDT
Data from 2005/06/03 17:07:07 EDT to 2005/06/03 17:12:07 EDT
  01 486 to internet                              :         7962648
  02 internet to 486                              :         8014212
  client dns in                                   :            2215
  client dns out                                  :            1176
  client http in                                  :          102572
  client http out                                 :          359072
  client https in                                 :            2018
  client https out                                :            1432
  client irc in                                   :           32185
  client irc out                                  :           17460
  client telnet in                                :           11710
  client telnet out                               :            5310
  client tor in                                   :          511531
  client tor out                                  :          140705
  server overnet in                               :         7085130
  server overnet out                              :         5210614
  server telnet in                                :            5310
  server telnet out                               :           11710
  server tor in                                   :          240527
  server tor out                                  :         1763970
Ipac-ng is able to produce graphs but I prefer to use rrdtool.  See the
example included.

@_date: 2005-06-08 11:38:54
@_author: Marcel 
@_subject: Anonymous/Nonymous Communication Coexisting? 
I'd be very happy to see an example of those iptable rules, Markus.  Sounds
pretty clever to me as a configuration.

@_date: 2005-06-08 15:05:59
@_author: Marcel 
@_subject: Anonymous/Nonymous Communication Coexisting? 
Cool Markus, Thank you very much.  I'll look deeper into it.
Seems pretty straightforward though.  You gave me a good point where to get
