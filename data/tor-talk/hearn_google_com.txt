
@_date: 2012-12-24 14:38:41
@_author: Mike Hearn 
@_subject: [tor-talk] Gmail and Tor 
To re-iterate previous threads on this topic, if you have at least one
successful login from a Tor exit node or other anonymizing proxy
service then the security system won't hassle you when you log in from
these networks. That's how you disable it - pass verification from a
Tor login.
I don't know what the reset process or weeks timeout refers to. If
they abandoned the login process after being asked to provide some
more information then the system assumes the hijack was real and
forces a password change. Perhaps that's what they mean.
With regards to why we do this, you can review the following
presentation I gave at the RIPE 64 conference:
    or (faster) this post from Urs:

@_date: 2012-10-10 13:47:14
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
I work for Google as TL of the account security system that is blocking
your access.
Access to Google accounts via Tor (or any anonymizing proxy service) is not
allowed unless you have established a track record of using those services
beforehand. You have several ways to do that:
1) With Tor active, log in via the web and answer a security quiz, if any
is presented. You may need to receive a code on your phone. If you don't
have a phone number on the account the access may be denied.
2) Log in via the web without Tor, then activate Tor and log in again
WITHOUT clearing cookies. The GAPS cookie on your browser is a large random
number that acts as a second factor and will whitelist your access.
Once we see that your account has a track record of being successfully
accessed via Tor the security checks are relaxed and you should be able to
use TorBirdy.
Hope that helps,
Mike Hearn
Google account security team

@_date: 2012-10-10 15:31:52
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
Yes, we know.
For the following discussion when I say "Tor" you can assume I mean
any anonymizing proxy service. We don't have any policies specific to
The assumption we have is that if you created a Google account without
using Tor, then you're OK with Google having some identity info, as
obviously, we already have unobfuscated IP addresses from you from
previous logins. If you wanted to remain completely untracable you
lost already. So our primary goal is to protect the account from
people who have stolen your password.
If you create an account via Tor, then you have given us evidence that
you want to use proxy services and the login security system will
largely leave you alone. Note that the signup security system WILL
phone verify you, but you don't have to use your own phone number for
that. Any number will do. It won't be saved in your account so you
won't be asked to receive a code on the same phone again. You could
get somebody else to do it for you, or (worst case scenario) buy an
account from somebody else. Buying accounts is risky because it
technically violates our ToS and if the supplier is creating a lot of
them (eg, for spammers) they may be automatically clustered and
terminated, but it's an option.
I don't want to discuss our policies around anonymizing proxies in
much detail for obvious reasons. Suffice it to say we are aware of
what's going on in these countries and are sensitive to the demand for
anonymizing proxy services there.
Proving to the system that you want to use Tor by logging in via the
web more or less disables the security system for logins coming from
Tor. So that's the simplest solution.
IMAP doesn't have any notion of cookies. If an IMAP client supports
the OAuth2 standard then you can use an authentication token gained
via a web login to do that. I doubt Thunderbird supports OAuth2. See
Note that we also support OAuth2 for XMPP/Jabber.
If TorBirdy sees that the user is trying to use a Gmail account, I
think a dialog box saying "Please ensure you log in via the web using
Tor first" would be sufficient.
I suspect what you're seeing is a little known warning designed for
people we believe are victims of state sponsored attacks. It's an
unrelated system. If it bothers you I can put you in touch with the
people who manage that and they can take you off the list of sensitive
We know the login audit trail we provide to end users is pretty poor
and it'd definitely be nice to improve it in future.

@_date: 2012-10-10 15:40:53
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
I think you can also opt to receive a phone call that says something
like "Your verification code is 12345". It doesn't mention Google and
certainly doesn't mention Tor. But it's been a while since I went
through this myself so I don't remember exactly.
I should note that this is the worst case scenario. For most users you
do NOT have to receive a verification code. We were considering
requiring that for all anonymizing proxy users in the past, but did
not do so. It's an option we reserve for the future though. For now,
answering a security quiz is good enough. Note that you can add a fake
phone number to your account (we don't presently verify them) and this
acts as a second password, more or less, so as long as it's a number
you can remember you can get through ID verification without receiving
any phone codes.
Yes, we know that saying "don't clear cookies" rather goes against the
advice and design of tools like the browser bundle. Potentially TBB
could have some specific hack for Google.
The GAPS cookie is the only one that's needed for a login to be
recognized as good. It's part of how we propagate goodness around
between second factors.
Simple example: you log in from an IP address that is nearby to one
you previously used (in physical or internet space), and don't have a
GAPS cookie. We issued you a new one when you visited the login page.
The act of logging in from a good IP whitelists that GAPS cookie.
Now you travel and log in from a new country. The IP is unknown but
the GAPS cookie you have was seen before. We let you in without hassle
because we know that device is legit. Your new IP geo is now
whitelisted too.
I agree. There was actually some work done on this around the time we
were considering requiring phone verification for all logins, but I
can't find it on our support site now. I think I need to chase that up

@_date: 2012-10-16 14:36:43
@_author: Mike Hearn 
@_subject: [tor-talk] registration for youtube, 
Hi, I'm that employee.
That post is specifically about login to existing accounts that were
created outside of Tor.
We have a policy of phone verifying every signup via anonymizing
proxies. If you signed up via Tor and didn't get asked to phone verify
it means the list of exit nodes we're using isn't up to date, or there
was a sync issue. Or you used an exit node that isn't in the list for
some reason. We use this one:
We appreciate the offer to solve 1000 CAPTCHAs. Unfortunately the cost
of 1000 CAPTCHAs is only about $1 on the open market, not exactly a
high bar.
The need for phone verification is unfortunate but real. If we had a
better way to throttle abuse we'd use it. Unfortunately we don't. In
the past I've researched and suggested using deposits of Bitcoin so we
could set the price of an account in a more nuanced way, see here for
a description of how it'd work:
  (bitcoin is my 20% project)
For a variety of practical reasons I don't think that'll happen for
Google accounts anytime soon, even assuming the software for it
existed, which it doesn't yet. But I think it'd be great if people who
are interested in making Tor usable with abusable services worked on
the Bitcoin approach. I'd start by integrating with MediaWiki,
blogging platforms etc, forum software etc, so if people want to run
wikis/forums/blogs as hidden services or otherwise they have a way to
make spam expensive without using the proxy of identity.
Of course it does move the problem to be "how can I acquire Bitcoin?"
but you get unlinkability. Even if the Bitcoin seller you used knows
your identity, the recipient of the coins does not.
So I'm afraid we don't have a good solution for people who want to
sign up to Google anonymously today beyond buying accounts and getting
unlinkability that way, but as I said, that's against our terms of
service and can easily be confused with abuse so it's somewhat

@_date: 2012-10-16 18:36:35
@_author: Mike Hearn 
@_subject: [tor-talk] registration for youtube, 
We blacklist SMS/voice forwarding services when we find them and
re-suspend the accounts that used them. We haven't focused on it much
so there are certainly services we haven't blacklisted yet.
Generally, using these services is dangerous. If spammers have used
the same numbers you get allocated to bypass verification, you can be
treated as part of the cluster and have your account terminated
without appeal.
I don't see the distinction between "pay somebody to create an account
for you" and "buy an account". Both types of activity are likely to
hit various tripwires that will result in forced phone verification of
the account later on. Bear in mind it's not just at signup. If we
suspect an account is being used abusively then the account can be
locked until you pass SMS too.
Right now I don't believe there is any safe way to use Google accounts
via Tor if you aren't willing to provide a phone number, nor do I
believe it's safe for any other large web service. Handling abuse
whilst allowing discardable identities is a fundamental research
problem the Tor team need to solve if they don't want Tor to be
restricted to a "read only" internet (to use Greg Maxwells phrasing).

@_date: 2012-10-16 19:34:30
@_author: Mike Hearn 
@_subject: [tor-talk] registration for youtube, 
It's not a form of ID verification. We don't really care who owns the
number (or indeed, who you are at all).
It's just a throttle. It's harder to get 1000 phone numbers that don't
cluster and automate them, than it is to buy 1000 CAPTCHA solutions.
End of story.

@_date: 2012-10-16 20:35:41
@_author: Mike Hearn 
@_subject: [tor-talk] registration for youtube, 
We do some of that, actually. Accounts that are young are examined
more closely and treated more aggressively than older more established
accounts. Account sellers know this and sometimes try and sell "aged
accounts" for a higher price (not that it works).
But as Andreas Key correctly points out, there must still be a way to
throttle abusive signups. When signup or login security fails badness
follows, often at huge scale.
There's always some collateral damage from these schemes
unfortunately. Eg, CAPTCHAs are poor for blind users. Phone
verification is poor for Tor users, or users without phones.
If you would like to see the effect our signup security efforts have
had for yourself, visit buyaccs.com and compare the price of gmail.com
vs hotmail.com accounts.

@_date: 2013-08-10 13:34:57
@_author: Mike Hearn 
@_subject: [tor-talk] Secure email with limited usable metadata 
We're still paying attention. Actually I don't work on Google anti-abuse
anymore (different project these days) but am still happy to provide our
perspective and contacts. Google is not an enemy of the Tor project, we
just struggle with the same issues all other providers do.
The "community suggestion" to use Bitcoin was actually my suggestion. It
didn't go anywhere partly because it's fairly complicated and partly
because Mike Perry and others from Tor felt Bitcoin wasn't anonymous
enough, and desired a different system. So it's not really clear what the
right approach is, technically.
You may be interested in checking out Pond, the work of another
crypto/Tor-friendly Googler:
It is an email-like messaging system that runs over Tor, has forward
security, tries to beat traffic analysis, TPM integration to beat log
structured filesystems that can't erase data and also has a variety of
other interesting features. It's not a drop in replacement for email by any
means, but with some more work it might be a reasonable alternative for
specialised use case.

@_date: 2013-08-11 15:21:49
@_author: Mike Hearn 
@_subject: [tor-talk] Secure email with limited usable metadata 
Yes, you can effectively swap coins with people, that's one way to go.
The issue of it being difficult to obtain coins anonymously is a maturity
issue. The economy is small, thus, coins go in and out of the economy via
exchanges very regularly. They don't circulate far before being converted
back into local currencies. Because exchanges are financial institutions by
law privacy is not allowed and state monitoring takes place.
The reason I suggested a Bitcoin based solution is that:
   1. The core principle of Tor has always been "anonymity loves company".
   If you aim for a 100% perfect solution and end up with nothing, you are
   worse off than having something that's mostly good enough.
   2. Over time the privacy properties of Bitcoin will get better as wallet
   software improves, the economy grows, etc. So you get all those
   improvements "for free".
   3. It requires no new third parties to be set up, as other schemes do.
   You could, theoretically, just download an app, give it some bitcoins you
   bought from a street vendor, and then manufacture yourself a
   proof-of-sacrifice that could be used to sign up for accounts/do any other
   abusable action. All you need is software.

@_date: 2013-01-14 18:52:30
@_author: Mike Hearn 
@_subject: [tor-talk] Gmail and Bitcoin? [OT] 
Feel free to CC me on such discussions, if you like. Google isn't
against Tor. We just wrestle with the same abuse issues every other
provider does.
As Mike Perry notes, targeted advertising doesn't actually know or
care about your real identity. It just wants to know that user 1234 is
more likely to click ad ABC than an DEF. And even for Google+, these
days you can register with a pseudonym if you want, there are policies
around proving that you really go by that pseudonym online so I don't
know how Tor-compatible it is, but the intention is there. The goal of
the "common names policy" (not actually a real names policy) is just
to ensure users don't sign up en-masse with names like PinkPony84 and
thus become a MySpace-style swamp of people who can't find or connect
with each other.
Anyway. As grarpamp notes, one of the problems with taking deposits is
suddenly you're taking payments and that comes with a host of
complicated accounting and legal issues. At least it does in the USA.
I was thinking lately about an alternative approach. Instead of
depositing some coins directly with the organization you want to
upload content to, you could establish a nym by making a non-trivial
sacrifice of coins to miner fees. By breaking up the sacrifice into
multiple payments spread over many sequential blocks you can put
together a proof of sacrifice that is hard to fake (eg, by mining your
own transactions). The coins aren't burned, they re-circulate into the
Once that proof is assembled, the hash of it can be your new nym, and
anyone who wants to accept it can verify the merkle branches included
in your proof up to their own copy of the block chain headers. If a
nym misbehaves, you can ban it/add it to a blacklist/etc. All the data
needed for a provider to calculate the size of the sacrifice is easily
included in the proof data.
If somebody wanted to actually pursue this idea, as I said before, I'd
do it by starting with MediaWiki. It's open source and widely used. If
you can make wiki-spamming hard you have a solid example of what other
service providers can do. You can use my own bitcoinj library to
implement it in a simple manner. If you ask on the bitcoinj mailing
list, or Bitcoin dev forums, I'll happily sketch out any design
details that are unclear.
Bitcoin and privacy is a complex topic perhaps best discussed in
another time and place. Whether it's strong enough will be something
each user has to judge for themselves, same as for Tor itself. Of
course, using Bitcoin does not exempt anyone from their jurisdictions
AML laws, and nothing stops a merchant demanding government issued ID
in order to trade with them.

@_date: 2013-01-14 20:56:16
@_author: Mike Hearn 
@_subject: [tor-talk] Gmail and Bitcoin? [OT] 
I'm not going to do things on an individual account level, sorry. I can't
even do what you're asking short of editing the source code, which
obviously isn't going to happen.
Re: are users who never click ads worth it. Well, there's a non-trivial
number of Google users who have never clicked an ad in the entire history
of their account. They don't get kicked out. Luckily for us (and them), the
users who find the ads relevant and useful bring in enough money to
subsidize the ones who don't. I note that you can find adverts useful even
if you are using a pseudonym. Maybe you'd see ads for anonymous hosting
services ;)
Are these users "interesting"? Well, Google has a fairly broad commitment
to freedom of expression. There are actually people whose entire job here
is to advocate for and work on freedom of expression. I know because I had
a lot of meetings with them about anonymizing proxy abuse :) Perhaps
because Sergey escaped the Soviet Union as a child, or maybe because it
makes sense regardless. For whatever reason, the interests of anonymous
users are represented here pretty well despite the lack of direct financial

@_date: 2013-01-14 21:01:09
@_author: Mike Hearn 
@_subject: [tor-talk] Gmail and Bitcoin? [OT] 
I don't think you even need a nym authority. All the proof of
sacrifice you need can be represented in a single data structure, like
a file. Think of the proof as a certificate. Then you could come up
with a simple set of HTTP extensions so browsers can sign a nonce
using the same keys used to sign the all-fee transactions.
Sending to non profits raises the question of which non-profits are
"good". Miners are politically neutral and virtually guaranteed to
spread the money out uniformly. Burning coins, please don't. It
reduces the resolution of the system for everyone else. I think
sending coins to miners is the simplest approach - it doesn't have any
messy political issues around who gets the coins, the coins are
guaranteed to be received by interested parties, and it doesn't hurt
the Bitcoin system. Actually it helps.

@_date: 2013-01-14 23:01:19
@_author: Mike Hearn 
@_subject: [tor-talk] Gmail and Bitcoin? [OT] 
That's rather the point - you have to impose some cost to getting blacklisted.
Good luck finding the private key for this address:

@_date: 2013-07-08 11:55:01
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
I no longer work on this system but I forwarded your mail to someone who

@_date: 2013-06-04 18:02:18
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
What do you mean by "lock", exactly?
I don't believe the policies changed recently, but I might be wrong as I no
longer work on that system.
Looking at your account history, I see a lot of logins that are being
whitelisted by this policy along with an occasional login that gets sent to
ID verification. Checking one, it's listed as an exit node now on
torstatus.blutmagie.de but wasn't detected as such by the login system.
Most likely, our exit node syncing is flaky, somehow not getting a complete
list of all exit nodes, or your traffic was routed via that exit in the
time window between it coming online and being synced to our system. I'll
ask the relevant person to take a look at how accurate/fast our syncing
process is and maybe it can be improved.
Now for what happened after that. If you abandon ID verification that was
triggered by a Tor login at any point, the system assumes there was a
failed hijacking attempt and the account goes into a "red alert" state. At
that point access via Tor is denied unless you have a second factor on the
account (such as a phone number we can send a code to). Access is
restricted in other ways, eg, the risk analysis becomes dramatically more
aggressive. One way to clear this state is to change your password, another
way is to wait a while until the red alert clears itself. But you already
know this.
So the action items are:
1) I will follow up internally and see if we can make exit node detection
more reliable somehow.
2) You should ensure you can reliably pass ID verification, and, never
abandon it!
The easiest way to do (2) is to set up 2-step verification but with a
device instead of a phone number. For instance any smartphone that can run
the (open source) Google Authenticator app will do, but it doesn't even
have to be that, as the Authenticator app just implements an open standard
for OTP generation. We don't get any private data this way. Although having
said that, I'm not sure if 2SV can be set up without a backup phone these
days. Hopefully it can be.

@_date: 2013-06-05 15:25:33
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
The issue is that we're scraping
 and, for example, 50.7.228.92
does not appear in that list. However, it is listed on
torstatus.blutmagie.de and apparently it is exiting traffic.
I am not sure how such confusion can arise. Doesn't Tor rely on centralised
directory servers to find exit nodes? Why would a node appear in one list
but not another? Is it expected that the official exit list is incomplete?

@_date: 2013-06-07 13:49:30
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
Thanks for the explanation. For now we're in the middle of including the
blutmagie list. But yes, switching off the entire system if there's
evidence of recent Tor usage is an alternative approach we should consider.

@_date: 2013-09-09 18:19:01
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
For a real fix we need to be able to identify Tor nodes that exit traffic.
The fact that some nodes exit traffic but aren't marked as exits would
appear to be a design issue with Tor itself. I don't think we can justify a
whole lot of engineering time to building a complicated system to identify
every possible exit - the only obvious alternative is to simply select
every Tor node which would be annoying for people who run relays but not

@_date: 2013-09-09 19:11:44
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
Yes, but then people who run relays would end up having to deal with the
suddenly changed security model. There were people complaining about
getting blocked by random websites just because they ran relays elsewhere
on this list. I don't think Google wants to actively discourage people from
contributing to the Tor network by challenging their logins more harshly.
Especially as our list of tor nodes might get used for more stuff in future.
It'd be better to find out why nodes that are exiting traffic don't get
marked as exits. Looking at that relay, it seems it doesn't allow web
traffic, but some ports are allowed. Perhaps the suspicious sign-in in
question wasn't a web signin?
What would be really useful not just for Google but I suppose the entire
internet community, would be a simple runnable tool that would take a set
of host/port-range pairs and identify any node with a compatible exit
policy. Then we could find any node that could potentially exit traffic
towards our servers.

@_date: 2013-09-09 19:26:43
@_author: Mike Hearn 
@_subject: [tor-talk] TorBirdy doesn't work with Gmail? 
Actually, re-reading this thread I recall that tagnaq suggested just
disabling the risk analysis entirely once we see a successful Tor login.
I've CCd Daniel Margolis who still works on this system (I moved on to
other things).
Daniel, what do you think?
(note that you may have to sign up to the public tor-talk list to reply-all
