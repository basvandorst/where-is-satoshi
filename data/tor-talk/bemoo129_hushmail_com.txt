
@_date: 2011-08-20 11:20:17
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] de-anonymization by correlating circuit changes 
The last days, i discovered this problem by using tor: According to the specification, every TOR circuit is used for 10 minutes. AFter this time, a new one will be choosen.
Many Providers have to log some Packets passing their networks (e.g. in Denmark every 500th IP-packet has to be logged.) First, I thought, thats not a problem for TOR, because nearly always more then one are using one server.
Bute if every users circuit has its own lifetime, you could very easy detect: At time X there are no Packets from IP x.x.x.x (viewed Website e.g.) anymore, and also no Packets to IP y.y.y.y (another TOR relay). You can also see: At time Y, IP x.x.x.x and y.y.y.y occour the first time (simultaniosly), so you know, they belong It would be much better, if every TOR relay would decide on its own, to close all circuits on the same Time - then you could corelate the time, because all Circuits are stopped/startet on the same time.
I tried to finde out, how this works in reality:
It was very strange, my TOR client sometimes uses a new circuit after only 5 minutes, sometimes after 4, sometimes after 7 for example. It would be nice, if someone could explain me this,

@_date: 2011-08-20 17:18:38
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] de-anonymization by correlating circuit changes 
Okay, but my question was, how traffic could be correlated if the atttacker has traffic-logs from all servers a possible user could use (e.g. all server operated by one provider/in one country) - but he does not know the user himself.
So, he could follow the tcp-stream,i think: At first, he examines the log of the exit-node, an he detects, that there is some specific traffic ingoing and ountgoing at the same time. And then, he follows this stream through the other relays...

@_date: 2011-08-21 20:13:26
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] de-anonymization by correlating circuit changes 
Well, yes, i meant exactly this scenario. Unfortunately, this is possible today. Some countries in europe have indroduced data renetion laws, like denmark. They log, for example, everz 100 or 500 IP Packet passing a providers network.
So, of course, you wont have a log with all packets, but i think, one, which enough information, to correlate the time of incoming packets (to the exit relay) and outgoing packets (to a website

@_date: 2011-08-21 23:22:51
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] de-anonymization by correlating circuit changes 
Well, does anybody know, how an exit relay behaves if a circuit is For example: Someone is surfing on one specific website. After 10 minutes, he will use another circuit for brwosing this website. But what about the first exit Node? Are tehre packets that are sent from the website to the exit node, allthough the circuit has been closed already?
This would be important to my question, because:
After 10 minutes, you dont find anything of the used middlenode in the exit nodes log, because the circuit is closed. But if there are packets from the website to the exit node, allthough there are no ones from the exit to the former middle, you cant correlate: This Website was viewed by this middlenode and so on. (well, only if the time difference is great enough, min. 20-30sec, i think.

@_date: 2011-08-23 01:20:55
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] de-anonymization by correlating circuit changes 
Thanks Curious Kid, I meant exactly what you wrote.
Are zou sure, TOR avoids circuits in which exit and entrz are in the same countrz? It happened not often, but im sure, I have got circuits with all relazs in the same country. I remember e.g. three netherland relays in one circuit, or three german...

@_date: 2011-08-23 01:25:16
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Tor selects entry Nodes which are no entrz Guards?? 
todaz, i saw mz Tor?Client building a circuit with a Entrz relay, which was not in mz .state-file (list of used entry guards). As I remember, there was onlz the name of the entrz relaz in the "vie network" tab ? but no complete chain with this unkown relay. After I closed Tor, and viewed the .state file, there were onlz the 3 nodes I used also before, the unkown new wasnt in the list.
Do zou think,its possible, that TOR uses a entry guard, and does not write this guard in the .state file?

@_date: 2011-07-15 16:05:36
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Traffic retention of TOR-Relays in Denmark 
recently I read about the danish law to log every 500. IP-Packet, which is on wire between Customer and ISP. Allthough this Law doesnt affect hostet Servers, i thin it is dangerous for Tor-Relays which run on a normal PC at home.
What do you think abou this? If very much Packets from Tor-Servers are logged due this law, are danish-Tor servers now very unsecure?

@_date: 2011-07-15 23:10:07
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Traffic retention of TOR-Relays in Denmark 
Thanks for your effords, but i think, we are talking about two different things. Of course, TOR does not want to hide that you use My worrys concern the TOR-Relays in Denmark. For example, there are 20-30 Relays running in Denmark, some at home, some in Datacenters. If danish ISPs have to log each 500. Packet, and you accidently use a circuit consisting only in danish Servers (thats not very likely, but it could happen I think), they can track everything you have done using TOR, i think.
Is there anything in TOR that does prevent this problem? Actually, I think, that danish law affects only home consumers, no hosting-
centers. Do you think there are many, who run TOR-Servers at home using normal customer dsl-connections?
On Fri, 15 Jul 2011 21:44:03 +0200 Andrew Lewman

@_date: 2011-07-16 01:14:35
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Traffic retention of TOR-Relays in Denmark 
Hi Klaus,
thanks for your information! Im not really sure if I understand you
correctly. You wrote, "In Denmark, for TCP traffic, the IP address
endpoints and the respective ports are logged for every packet"
Are you really sure, that danish providers log these information
(ip,port) about every(!) IP-Packet?
Thanks for the link, I read this already. Wikipedia says, danish
providers can choose between logging only first and last Packet of
an TCP-Connection, or, if this is impossible, every 500th packet.
Please correct me if Im wrong with this...if they only log the
initiating and terminating packet of a tcp-connection, this would
not affect TORs anonymity, i think (instead of logging every 500th).
I think,every TOR-Node has a TCP-Connection to many other Relays at
the same time, the logged data will only show, that the server has
many connections, but it would not possible to detect a user by
this.

@_date: 2011-07-16 15:58:23
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Traffic retention of TOR-Relays in Denmark 
Well, i think,many will run their TOR Servers at home. In this case, theit traffic will be logged, because they are end users/consumers. The Provider does not care about is there a TOR-
Server/Proxy or not, i think.
I think, the really important question ist, if the danish ISPs have implemented the first or second way of session logging. In the firstcase, there would be no problem, but what about the second (every 500th packet)? Does anybody know how danish Providers log?
On Sat, 16 Jul 2011 05:34:38 +0200 Moritz Bartl

@_date: 2011-07-22 13:39:32
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] Traffic retention of TOR-Relays in Denmark 
Hello Niels,
thank you for your Mail. I found a .pdf report about an EU-Meeting concerning the data retention.In this report, the Chief Security Officer of TDC explains, that they have implemented the 500th Packet solution, and this causes enourmous amounts of data, which they have to store.
But, im wondering about what he said exactly: "We have to log every 500th incoming ID/IP-Package (belonging to a customer)"
What do you think he did mean by "Incoming"? If this means, only every 500th Packet of the data stream from outside to the customer is logged, there would be no problem for Tor, phehaps. What do you think about this?

@_date: 2011-06-29 10:51:08
@_author: bemoo129@hushmail.com 
@_subject: [tor-talk] TOR-Client bug?/wrong package size? 
Does anybody know how TOR deals with TCP-Pakets?
For example, while logging my outgoing traffic via iptables or wireshark, i saw a large amount of TLS-encrypted packages - but they all had a differend size, sometimes 60bytes, sometimes more then 1000.
In the TOR Documentation they explain, TOR will sent no normal tcp-
packets via a tcp-connection, but "cell" packets - with have a fixed size of 512 byte.
I would be very thankful if someoune could explain me, why i see different package sizes during sniffing my tor client`s traffic.
