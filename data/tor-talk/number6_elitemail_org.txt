
@_date: 2012-02-12 15:41:49
@_author: Number Six 
@_subject: [tor-talk] Tor Browser Bundle 2.2.x Ubuntu AppArmor Profile 
I've spent some time creating Ubuntu AppArmor profiles for the Tor
Browser Bundle and its components and related apps. I've based them upon
publicly available profiles that needed some dusting off, updating, and
adapting to Tor.
For the unfamiliar, AppArmor is a least privilege access control system
that attempts to prevent exploited applications from accessing system
resources that they shouldn't normally need. It is similar to SELinux,
but it is much easier to create, understand and modify AppArmor profiles
than SELinux policies.
The profiles are not perfect, and they really need the new features in
the AppArmor dev series to make them awesome. In my opinion, the biggest
advantage of non-dev AppArmor right now is that it gives you the ability
to watch your logs for audit messages that could indicate
botched+blocked exploit attempts or bad behavior, and to protect your
personal files from exploited applications.
For information on working with AppArmor in Ubuntu (including how to
load these profiles), see: Here's a rundown of the policies I've created and their security
properties. The profiles themselves are at the pastebin links.
1. Tor Browser Bundle 2.2.x Profile: This profile isolates Tor, Vidalia, and Firefox to least privilege.
However, some AppArmor shortcomings mean that it is not as good as it
could be.  According to the AppArmor wiki, it looks like the features we
really want won't be available until AppArmor 2.8 or 3.0.
In particular, the profile will *not* have the ability to restrict
connections from Firefox to prevent non-Tor connections until AppArmor
supports more rule commands. Obviously this is a big issue if the prime
goal of an exploit is to learn your IP address, and if bugs of this sort
still exist in Firefox. Until AppArmor provides the ability to write
rules like 'network tcp connect from 127.0.0.1 on lo to 127.0.1:9050'
or even just 'network tcp dst 127.0.0.1', any arbitrary code exploit against Vidalia or Firefox can still connect to arbitrary IPs outside of Tor :/.
 for more details.
Additionally, Tor and Firefox are still free to perform UDP datagram
traffic, due to the desire on my part to squelch the audit log traffic
down to a minimum. (The AppArmor in Ubuntu currently has a bug that
causes it to always log UDP violations, even if you tell it to silence
with a 'deny'). Since I think watching audit logs closely is one of the
most useful properties of AppArmor, and since noise makes this
substantially harder, the profiles currently allow UDP.
Despite these major issues, the profile is significantly better than
nothing. The main benefit you get is that all file read and write access
is restricted to ~/Downloads and ~/Public, and TBB can't launch outside
apps, use ptrace, access /dev/, /tmp/, or interact with the desktop.
As a result, you will get a lot of permission denied errors from Firefox
when trying to download and upload files, because the TBB folder
defaults are screwy. Click through the errors and navigate to
~/Downloads/. Or change the directory in the AppArmor profile to
something you like.
2. Tor Profile: A separate profile for the system Tor binary, which some might find
useful for proxying non-browser activity.
3. Vidalia Profile: Same deal for the system Vidalia binary.
4. Pidgin Profile: This profile is based on the profile at
but with some additional restrictions.
In particular, I forbid ptrace. It was explicitly allowed by the profile
and still occasionally attempted by my client, but did not seem needed
to load plugins or otherwise function.
I also removed access to a lot of X window resources, and restricted
homedir access in a similar manner as to the TBB Firefox profile.
If you're interested in editing these profiles, see
 and
If you know basic UNIX, AppArmor is surprisingly easy to pick up and
customize with the documentation in-hand. Please let me know if you
make any improvements or figure out workarounds for current limitations.

@_date: 2012-03-08 19:54:37
@_author: Number Six 
@_subject: [tor-talk] Tor and HTTPS graphic 
Why do you assume that the NSA can break Tor but not HTTPS?
As I see it, if you extrapolate the timing attack literature to justify
ignoring fixing active attacks, why do you not extrapolate the work on
RSA key cracking to assume that the NSA can factor popular website keys
in bathtubs full of DNA?
Or, at the very least, why not extrapolate it to the NSA compromising
one of the 1000-some wildcard root certificates your own SSL Observatory
scan has detected?
This paywall (ie non-"dumpster available") abstract appears to indicate
that the research community is within striking distance of factoring an
RSA keys in use by many HTTPS servers today. At least, when compared to
how close timing attack research is to breaking Tor.
I guess I'm just wondering: where do we draw the line?
In addition to the decentralized HTTPS certificate observatory, one
could imagine a network verifying the DH parameters are the same when
received by two endpoints of an HTTPS session. If perfect forward
secrecy is universally deployed, a bathtub full of DNA or server
compromise that yielded an RSA private key for google.com could be used
transparently to escape your decentralized observatory scan, but a
DH-recording scanning network will still see different DH parameters at
the endpoints.
But how do deploy such a network? Is planetlab up to the task? Is anyone
studying endpoint consensus on DH parameters? Shouldn't they be?
It seems like our rabbit hole is very deep. Do we really have what it
takes to watch the watchers?
I fucking hope so, but it does seem that consensus reality wrt
cryptographic security is hard to establish.

@_date: 2012-03-19 01:11:22
@_author: Number Six 
@_subject: [tor-talk] Orbot and firewall? 
LBE Privacy Guard doesn't have a lot of info about it or any source code
available, and for some reason requests Phone State and Identity
permissions. It could be recording who you call and using it for ad
Of course either DroidWall or LBE could be listening to your phone calls
without having any permissions since they both require root.. But at
least DroidWall is open source.
Hrmm.. You might want to rethink that. Something about LBE is setting
off best practice alarms.
The other apps that provide this functionality require ROM patches
and/or reboots, and the only Open Source option appears to be PDdroid,
but again requires a ROM patch.
As much as I want a permissions editor too, I think DroidWall is still
the best solution to the Android privacy nightmare.
Maybe someone can convince Cyanogen to work with the PDroid guy to
develop a built-in solution?

@_date: 2012-03-19 23:28:10
@_author: Number Six 
@_subject: [tor-talk] Orbot and firewall? 
I just found that Cyanogen already supports editing permissions if you
go through the preferences to enable the feature. It's just disabled
per default.
Cyanogenmod Settings -> Application settings -> Permission management.
You can then disable/enable permissions by clicking on them in the
normal application manager. Quite slick.
With this + DroidWall, I feel like I've finally been liberated from
ceaseless Android surveillance!
Too bad my freedom probably an illusion until someone reverse engineers
and audits the radio firmware..  looks promising,
but seems a bit green still.
Still, freedom is within our grasp! Now if we could just do something
about the constant gassing, kidnapping, and those damned floating
- Six

@_date: 2012-03-20 22:11:21
@_author: Number Six 
@_subject: [tor-talk] Orbot and firewall? 
Careful, troll. Mike is concerned with practical security against likely
adversaries, so his reasons for using the software might be nuanced,
depending on who he believes his adversary is. For example, his blog
is pretty good about pointing out the need for differences in security
with respect to multiple adversaries. It was fairly widely circulated.
I'm actually curious if the implementation in LBE is better tolerant to
app failure than what Cyanogenmod has. The Cyanogenmod implementation
causes apps to get exceptions thrown at them when the code that needs
the permission tries to execute. Some apps catch these exceptions and
move on. Some simply die.
It is possible that what Mike means by "not nearly is good" is that
LBE's "state of the art hooking techniques" actually have a more elegant
solution to the exception problem (such as causing all APIs that require
the permission to silently fail without throwing exceptions).
It's also possible he has other entirely reasonable reasons for
preferring LBE.
Either way, I'd like to hear them.

@_date: 2012-03-21 23:18:33
@_author: Number Six 
@_subject: [tor-talk] Orbot and firewall? 
Interesting. While this is quite awesome, it does seem like a situation
where it would be really be useful to have the source code available...
Who knows if this "fake data" has been properly generated.. For all we
know, it could just transmit a randomly generated yet persistent GUID
for your IMEI... Or, more subtly, it could seed its PRNG with a constant
value (say your "Phone Identity"?) to ensure the same result...
Word. Having a permissions umask applied upon install does sound
very nice...
These sorts of permissions are available via DroidWall.. However, at
some point between initial install and my permissions enable/disable
audit (after discovering the Cyanogenmod feature the other day), I've
realized that DroidWall now also requests the "Phone State and Identity"
permission. Damnit all to hell...
Yeah, querying my installed app list by permission is also something
I've always wanted...
Can one of us agree to file a bug in the Cyanogenmod ticket tracker
asking for a better implementation of the permissions handling to more
closely match LBE's features?
I would volunteer, but I'm still afraid to actually run LBE...
I see 4 main advantages of LBE so far.
1. Don't throw exceptions. Return fake data and/or fail silently.
2. Apply some sort of permissions umask to freshly installed apps.
3. Provide the ability to view your installed apps by permissions.
4. Ship with a DroidWall that doesn't need "Phone Identity" perms.
Anything else?

@_date: 2012-03-21 23:59:37
@_author: Number Six 
@_subject: [tor-talk] Orbot and firewall? 
IMHO, the main benefit of Cyanogenmod is removing every carrier addon
that plagues your phone. CarrierIQ is just one of the many ways you get
screwed by the default firmware. There are all sorts of other data
sharing partnerships behind the scenes, and tons of sketchy apps with
obscene permissions that make it obvious what is going on.....
Yet still, without an open source radio firmware, we will never be free
from the "silent call" features that are /built in to the GSM protocol/
to allow it to ping and surveil users. Worse, now that the "good guys"
have finally audited GSM and found these backdoors, it only takes a bad
guy with GNU radio nearby for you to get pwnt... replicant.us!!!
P.S. Watch out for those floating beachballs, they will mess you up...
