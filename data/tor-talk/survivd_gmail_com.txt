
@_date: 2012-08-16 21:18:50
@_author: Name Withheld 
@_subject: [tor-talk] Warning: ISP resurrected old tor node 
Hey guys,
Just a heads-up on a weird issue:
I notice some of the tor directories are showing my old server as being online and routing traffic.  That server:
*Router Name:* 	00routin0packets
*Fingerprint:* 	DD03 46F6 56DA 5F0E C9F6 5D7B FE56 38DA F3FB 2F6B
IP: 95.211.153.115
I lost control of that server over a month ago when the ISP (Seedmonster) forced me offline for forum spam abuse complaints from the tor traffic.  I initially thought this was just some kind of weird statistics-ghost, but it looks like it really is still routing traffic.  The tor config the server is using still has me listed as the administrative contact (even though I can't log in and it was previously offline), so it's clear that it's my old VPS at that ISP.
You can see it's been offline (from when it got shutdown), but tor users mysteriously started spamming away from it again a few days ago:
Now, I don't know for certain that this is in any way nefarious -- maybe the host accidentally reactivated the VM it was running on or something (I had everything configured to autostart on boot). However, I've never heard of an ISP giving out "free" service like this, so I wanted to put out a notice that this server isn't being controlled by a tor operator, so it could plausibly be up to no good.
It just seems a little weird that they would restart the server of a customer they kicked out and let it keep running for over a week without On the up side, hey, free bandwidth for the swarm.
(P.S. If anyone ever has problems with stopforumspam.com, the admin is VERY pro-tor and will try to help you out.  He even wrote special extensions for people to exclude published tor exits from the spam reporting after I told him about the ISP problems.)

@_date: 2012-08-22 14:16:54
@_author: Name Withheld 
@_subject: [tor-talk] [Advanced configuration troubleshooting] Exit node 
Hi guys,
I've been running a kind-of 1gbps (voxility style 1gbps) exit server on Debian for a couple months, and while it started out very fast, it's gotten much slower over time.  The server itself hasn't slowed down -- if I do speed tests, it still pulls 25MB/s (bytes not bits) with no problem (on top of the tor load), but it never seems to push more than 10-12MB/s through the tor network, even if I run 6 tor processes with each separated onto a private cpu core.  Even if I stop the other tor processes and revert to a single-tor-instance server, it doesn't reach the old 20 MB/s anymore.
For a visual, you can see how it just sort of gave up on life around the beginning of August here (although some of that is accounted by extra tor instances cannibalizing stats):
Moritz et al previously previously helped me with configuring the server, when I ran into the 2-instances-per-IP limit, so I'm hoping maybe you  guys can help lightning strike twice and move me through this wall I've hit.  Has anybody had this kind of problem when they added additional IPs & instances to their server?  I think I must have messed up a setting somewhere...
Also, please dummy-check my configs (just the main instance):
Nickname 00Teh0Signul00
ContactInfo Administrator ORPort 10001
DirPort 10030
SocksPort 10050
RunAsDaemon 1
DisableDebuggerAttachment 0
BandwidthBurst 125 MB
BandwidthRate 80 MB
RelayBandwidthRate 80 MB
RelayBandwidthBurst 125 MB
MyFamily $F7360D25BF58BD1CD4E10199619B585A59CB5912, $374FF6496AB55D44208E6718110736FB88B339F6, $B3AFCD13E7683757083FAACD6B579B7D35DBD220, $8937E37AE18C4FEA062915D9CE3C4E3A55499966, ExitPolicy accept *:10000
ExitPolicy reject 0.0.0.0/8:*
ExitPolicy reject 169.254.0.0/16:*
ExitPolicy reject 10.0.0.0/8:*
ExitPolicy reject 172.16.0.0/12:*
ExitPolicy accept *:20
ExitPolicy accept *:21
ExitPolicy accept *:22
ExitPolicy accept *:23
ExitPolicy accept *:53
ExitPolicy accept *:69
ExitPolicy accept *:80
ExitPolicy accept *:443
ExitPolicy accept *:465
ExitPolicy accept *:563
ExitPolicy accept *:587
ExitPolicy accept *:992-995
ExitPolicy accept *:1863
ExitPolicy accept *:5190
ExitPolicy accept *:5500
ExitPolicy accept *:5800
ExitPolicy accept *:5900
ExitPolicy accept *:6660-6669
ExitPolicy accept *:6891-6901
ExitPolicy accept *:10001
ExitPolicy accept *:9001
ExitPolicy accept *:9090
ExitPolicy reject *:*
*sysctl* (straight c&p [minus the nf_conntrack entries] from Moritz' excellent guide.  nf_conntrack is not currently used on my server):
net.core.rmem_max = 33554432
net.core.wmem_max = 33554432
net.ipv4.tcp_rmem = 4096 87380 33554432
net.ipv4.tcp_wmem = 4096 65536 33554432
net.core.rmem_default = 524287
net.core.wmem_default = 524287
net.core.optmem_max = 524287
net.core.netdev_max_backlog = 300000
net.ipv4.tcp_mem = 33554432 33554432 33554432
net.ipv4.tcp_max_orphans = 30000
net.ipv4.tcp_max_syn_backlog = 300000
net.ipv4.tcp_fin_timeout = 4
vm.min_free_kbytes = 65536
net.ipv4.tcp_keepalive_time = 60
net.ipv4.tcp_keepalive_intvl = 10
net.ipv4.tcp_keepalive_probes = 3
net.ipv4.ip_local_port_range = 1025 65530
net.core.somaxconn = 30720
net.ipv4.tcp_max_tw_buckets = 2000000
net.ipv4.tcp_timestamps = 0
*ifconfig -a:*
eth0      Link encap:Ethernet  HWaddr e8:39:35:4d:d6:53
           inet addr:93.114.43.156  Bcast:93.114.43.191 Mask:255.255.255.192
           inet6 addr: fe80::ea39:35ff:fe4d:d653/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:5605736 errors:0 dropped:0 overruns:0 frame:0
           TX packets:5380620 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:20000
           RX bytes:4696777991 (4.3 GiB)  TX bytes:4190572765 (3.9 GiB)
           Interrupt:20 Memory:fe400000-fe420000
eth0:1    Link encap:Ethernet  HWaddr e8:39:35:4d:d6:53
           inet addr:93.114.40.194  Bcast:93.114.40.255 Mask:255.255.255.192
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           Interrupt:20 Memory:fe400000-fe420000
eth0:2    Link encap:Ethernet  HWaddr e8:39:35:4d:d6:53
           inet addr:93.114.43.233  Bcast:93.114.43.255 Mask:255.255.255.192
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           Interrupt:20 Memory:fe400000-fe420000
lo        Link encap:Local Loopback
           inet addr:127.0.0.1  Mask:255.0.0.0
           inet6 addr: ::1/128 Scope:Host
           UP LOOPBACK RUNNING  MTU:16436  Metric:1
           RX packets:2294 errors:0 dropped:0 overruns:0 frame:0
           TX packets:2294 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0
           RX bytes:4315831 (4.1 MiB)  TX bytes:4315831 (4.1 MiB)
nameserver 184.169.143.224
nameserver 79.172.201.120
nameserver 84.22.106.2
nameserver 8.8.8.8
nameserver 4.2.2.2
nameserver 209.244.0.3
nameserver 8.26.56.26
nameserver 198.153.192.1
Thanks again!
P.S. I've tried hundreds of things at this point (creating a "clean" torrc, conntrack, no conntrack, modifying MTUs, changing kernel setting per guides... unchanging them...), and none of them seem to make a significant difference.  I would be grateful for new ideas -- hoping I made an obvious mistake...

@_date: 2012-08-23 10:18:08
@_author: Name Withheld 
@_subject: [tor-talk] [Advanced configuration troubleshooting] Exit node 
1) I did contact the host.  They ran speed tests against a number of sources (basically the same thing I did, really), and noted that it had a lot of available b/w.  Also, my server is running at the same DC as gorz.torservers.net [109.163.233.205 ] , which looks to be pushing about the same 20MB/s that mine did pre-slowdown, so I'm confident this is a provider issue.  I'm pretty sure voxility "shares" lines, so if it were a saturation problem, I imagine gorz would have slowed down, too.
2) The lack of a stable flag is due to reboots and restarts trying to fix this issue.
3) I'm not sure where to view the advertised bandwidth graph, but what is this stat generated from?  I just double-checked the torrc for the main instance and it's 80MB+.  Updated to:
RelayBandwidthRate 100 MB  # Throttle traffic to 100KB/s (800Kbps)
RelayBandwidthBurst 125 MB # But allow bursts up to 200KB/s (1600Kbps)
Thanks for the responses, guys.

@_date: 2012-12-04 20:55:56
@_author: survivd 
@_subject: [tor-talk] Tor 0.2.3.25 is out 
The writer seems to have a Chinese name, and our virus scans (including
Norton) show no results, but his does.
Has no one considered that this might mean he's actually gotten a
poisoned binary?
Assuming he's operating in China or somewhere similar (and I know this
is a big assumption), this would seem to me be less of an indication
that Tor is truly causing false positives, and more of a hint that maybe
there's tampering occuring somewhere in the download stream.
Is there any way we can get SHA1 hashes for the legit binary and the one
the original author claims is getting flagged by Norton?  If they don't
match, I think we have something interesting to consider.

@_date: 2012-12-08 15:04:57
@_author: survivd 
@_subject: [tor-talk] Botnets through Tor 
I think some of the hysteria over this is overdone.
For unpublished nodes, nothing that I'm aware of.  Hidden services are
called that for a reason, and it's necessarily a dual-use technology.
You can't weaken it for botnet C&C servers without weakening it for
legitimate, vulnerable users.
If they're using unpublished, non-public Tor infrastructure (which seems
to be indicated), nothing.  They're just using the software and the
protocol, but restricting their paths to nodes they control.
If this became wildly popular and all botnets start using public
infrastructure for C&C, I would speculate the amounts of traffic Tor
sees might be change somewhat (more routing to hidden services, less
traffic exiting to the open net).  I wouldn't expect to see more abuse
complaints or a big performance impact, because:
1) C&C traffic is typically very small -- IRC & occasional plaintext
updates pulled through http.
2) Since it would be getting routed to hidden services, nobody really
sees it as "bad" traffic.  It's not like the bots are actually launching
attacks through Tor: this would be a pretty poor strategy, since:
A:] it doesn't take advantage of the compromised host's full bandwidth, and
B:] the bot herder doesn't really care if Granny in Lithuania gets her
door kicked down because her IP was a part of a DDoS -- he only needs
anonymity for HIMSELF (not all of his bots -- just his C&C infrastructure)
That said, someone who has done more study on tor-internal traffic could
probably give a better answer on "how things could change" if C&C starts
all getting routed through Tor.
Other than putting a lot of effort into trying to identify hidden
services hosts (which is dangerous for a number of reasons), I imagine
not much -- although if this becomes a huge trend and the security
community scrutinizes Tor, some new attacks against Tor might be found
(and patched).  As a "problem," this falls more to the A/V folks, since
this whole scheme revolves around spreading through client-side,
user-enabled exploitation via trojaned files, and their entire raison
d'etre is to prevent that.

@_date: 2012-12-31 13:09:05
@_author: survivd 
@_subject: [tor-talk] Wordpress blocking Tor? 
============================== START ==============================
Pretty sure this is due to people leaving comment spam via tor.  I know
one of my exits was implicated in a comment spam campaign, and I noticed
that IP was banned from a number of blog sites because of it.
If you know which exit node you were using at the time, you can write to
the admin contact and they might be able to answer the complaint or
change their IP so as to help other users.

@_date: 2012-07-03 19:32:58
@_author: Name Withheld 
@_subject: [tor-talk] [Need quick help] 30+ mbps node taken down by host 
My VPS fast tor exit got taken down by the host today for sending spam emails. Apparently the upstream provider complained to them about it. I thought SMTP was supposed to be disabled by default in the tor config, but apparently my node was sending stuff through (even though I didn't do anything to change the default setting for that).
The host is going to give me a chance to see if I can block it, but if I can't get the spam to stop, they're going to make me kill the node. I prefer not to do this kind of thing, but since it's their house, it's their rules.
Can someone please tell me precisely (what file, what entry) how to 1) Tor to block smtp
2) Local machine to block smtp egress
3) Any other possible way to detect/filter outgoing mail Thank you very

@_date: 2012-07-04 00:36:36
@_author: Name Withheld 
@_subject: [tor-talk] [Need quick help] 30+ mbps node taken down by host 
Thank you for the response. Unfortunately, it looks like this might be an impossible problem to solve, since they followed it up and said it's forum spam and hack attempts, not just email spam.  Basically, my node is pushing more traffic than most, so it's getting more abuse, faster (even though this is a tiny percentage of the overall traffic).
Here's what they sent me from their upstream provider:

@_date: 2012-07-04 12:29:55
@_author: Name Withheld 
@_subject: [tor-talk] 30+ mbps node taken down by host 
Thanks to everyone for their responses.
1) >>>> Just in case, does any have any recommendations for an unmetered, bulletproof host? <<<<
2) I'll update the wiki host page soon (Seedmonster.net is the host.  Very fast, but weak abuse protection).
3) I updated the exit policy per everyone's recommendations. Thank you for this!
4) I sent the EFF-style abuse explanations to the host (and I already had the Tor warning page set up for the www server), and told the host I'll work with the complainants to address the tickets, but the host doesn't seem swayed... I think the next time they get a complaint, they're just going to kill the node and I'll have to find a new host.  I've pushed up to 70mbps of traffic through them during peak hours, so I think they might just be tired of the traffic (even though I offered to throttle it).

@_date: 2012-07-26 10:40:29
@_author: Name Withheld 
@_subject: [tor-talk] Problem with new multiple-instance exit nodes never 
Hi guys,
I've got a 1gbps (shared) debian server set up as an exit that can't seem to handle all the b/w through a single instance of tor.  After getting some help from the tor lists previously, I've started setting up additional instances of tor that run simultaneously to help handle more Unfortunately, only the first of the extra instances works (even though I copied the config from the "known good" config and only changed the ports during other attempts).  Other instances seem to work at first, setting up the initial tunnels and passing very small amounts of traffic for about a half hour, but never seem to get listed in the directory, so they never get any other traffic once the initial tunnels all close, even after many hours pass.
Does anyone know why this is happening, and what I need to do to fix it?
Thank you.
Jul 26 12:26:06.064 [notice] Tor v0.2.3.19-rc (git-adf14e42194ebfb7) running on Linux.
Jul 26 12:26:06.064 [notice] Tor can't help you if you use it wrong! Learn how to be safe at Jul 26 12:26:06.064 [notice] Read configuration file "/etc/tor/tor4.cfg".
Jul 26 12:26:06.065 [notice] Initialized libevent version 1.4.13-stable using method epoll. Good.
Jul 26 12:26:06.065 [notice] Opening Socks listener on 127.0.0.1:10054
Jul 26 12:26:06.065 [notice] Opening Control listener on 127.0.0.1:9054
Jul 26 12:26:06.065 [notice] Opening OR listener on 0.0.0.0:10004
Jul 26 12:26:06.065 [notice] Opening Directory listener on 0.0.0.0:10034
Jul 26 12:26:06.000 [notice] Not disabling debugger attaching for unprivileged users.
Jul 26 12:26:06.000 [notice] Parsing GEOIP file /usr/share/tor/geoip.
Jul 26 12:26:06.000 [notice] Configured to measure statistics. Look for the *-stats files that will first be written to the data directory in 24   from now.
Jul 26 12:26:06.000 [warn] You are running Tor as root. You don't need to, and you probably shouldn't.
Jul 26 12:26:06.000 [notice] No AES engine found; using AES_* functions.
Jul 26 12:26:06.000 [notice] This version of OpenSSL has a slow implementation of counter mode; not using it.
Jul 26 12:26:06.000 [notice] OpenSSL OpenSSL 0.9.8o 01 Jun 2010 looks like version 0.9.8m or later; I will try SSL_OP to enable renegotiation
Jul 26 12:26:06.000 [notice] Your Tor server's identity key fingerprint is '00Teh0S1gnul00 26F728EF33D03C054B9417FAE92C809DCDEF5ED4'
Jul 26 12:26:06.000 [notice] Reloaded microdescriptor cache.  Found 3016 Jul 26 12:26:06.000 [notice] We now have enough directory information to build circuits.
Jul 26 12:26:06.000 [notice] Bootstrapped 80%: Connecting to the Tor *Jul 26 12:26:07.000 [notice] Heartbeat: It seems like we are not in the cached consensus.**
*Jul 26 12:26:07.000 [notice] Heartbeat: Tor's uptime is 0:00 hours, with 2 circuits open. I've sent 2 kB and received 2 kB.
Jul 26 12:26:07.000 [notice] Bootstrapped 85%: Finishing handshake with first hop.
Jul 26 12:26:07.000 [notice] We weren't able to find support for all of the TLS ciphersuites that we wanted to advertise. This won't hurt security, bu
t it might make your Tor (if run as a client) more easy for censors to Jul 26 12:26:07.000 [notice] To correct this, use a more recent OpenSSL, built without disabling any secure ciphers or features.
Jul 26 12:26:08.000 [notice] Bootstrapped 90%: Establishing a Tor circuit.
Jul 26 12:26:09.000 [notice] Tor has successfully opened a circuit. Looks like client functionality is working.
Jul 26 12:26:09.000 [notice] Bootstrapped 100%: Done.
Jul 26 12:26:09.000 [notice] Now checking whether ORPort 93.114.43.156:10004 and DirPort 93.114.43.156:10034 are reachable... (this may take up to 20
minutes -- look for log messages indicating success)
Jul 26 12:26:10.000 [notice] Self-testing indicates your ORPort is reachable from the outside. Excellent. Publishing server descriptor.
Jul 26 12:26:13.000 [notice] Self-testing indicates your DirPort is reachable from the outside. Excellent.
Jul 26 12:26:19.000 [notice] Performing bandwidth self-test...done.
Jul 26 12:29:25.000 [notice] New control connection opened.
Jul 26 12:36:43.000 [notice] New control connection opened.
Jul 26 12:36:52.000 [notice] Received reload signal (hup). Reloading config and resetting internal state.
Jul 26 12:36:52.000 [notice] Read configuration file "/etc/tor/tor4.cfg".
Jul 26 12:54:25.000 [notice] Received reload signal (hup). Reloading config and resetting internal state.
Jul 26 12:54:25.000 [notice] Read configuration file "/etc/tor/tor4.cfg".
*Jul 26 18:26:07.000 [notice] Heartbeat: It seems like we are not in the cached consensus.**
**Jul 26 18:26:07.000 [notice] Heartbeat: Tor's uptime is 6:00 hours, with 0 circuits open. I've sent 1.32 MB and received 4.44 MB.*
Jul 26 23:05:50.000 [notice] Received reload signal (hup). Reloading config and resetting internal state.
Jul 26 23:05:50.000 [notice] Read configuration file "/etc/tor/tor4.cfg".

@_date: 2012-07-26 17:48:30
@_author: Name Withheld 
@_subject: [tor-talk] Problem with new multiple-instance exit nodes never 
Thank you for the response.  I'm assuming you're implying option A) (get
the dirauth operators to increase the value) is not actually serious.
Please correct me if I'm wrong (because I see know way of going about this).
For B), this is probably a total newbie question, since I've never had to
run a program like this before.  If I can get a second IP from the ISP for
the same physical server, is there a configuration option in Debian (or
something in the torrc file) I'll need to set to get it to the additional
tor daemons binding to the secondary address?
Much obliged!

@_date: 2012-11-17 11:34:36
@_author: Name Withheld 
@_subject: [tor-talk] Appropriate methods of estimating daily tor users 
Hey guys,
I noticed my guard/exit nodes seemed to be pushing much more traffic
than usual during the first week of November.  Happy as that made me
(though it returned to the mean shortly thereafter), it got me to
thinking -- does anyone know of an appropriate method for estimating a
(rough) number of how many users per day make use of your node?
The only thing I can think of is extrapolating tor-arm's client locale
usage summary when you have a guard flag (you know, the stat screen that
shows number of connections by country-of-origin).  Then I realized I
don't know how reliable that would be, as tor is supposed to change
routes every (correct me if I'm wrong) 15 minutes by default -- and I
thought guard nodes were changed less frequently (or was it re-used more
frequently)-- which sort of confounds my ability to estimate based on
Has anybody looked at this before and come up with a good method?

@_date: 2012-11-18 18:15:29
@_author: survivd 
@_subject: [tor-talk] Need help -- File descriptors problem after update 
I recently updated to I just 0.2.3.24-rc, and when i view my server in
arm, I see the following notice types on my tor processes:
*desc: 888 / 992 (89%)
04:44:31 [ARM_WARN] Tor's file descriptor usage is at 89%. If you run
out Tor will be
  unable to continue functioning.
*It doesn't seem like this should be a problem, because tor is running
as root and my /etc/security/limits.conf shows:
*               soft    nofile          4096
*               hard    nofile          65535
*Does anyone know how I can fix this?  I don't know where the "992"
number limit is coming from.  Thank you.**

@_date: 2013-02-21 12:58:32
@_author: survivd 
@_subject: [tor-talk] Email provider for privacy-minded folk 
Seems like there's a bit of confusion regarding what a bad exit node can
and can't do here.
For many sites, you can trivially strip the SSL connection request as
the exit node, downgrading it to vulnerable plaintext just by using
ssl-strip.  There'd be no cert warning, but smart users will notice the
connection is http instead of https.
Gmail is not one of those sites.  Gmail forces HSTS, so he couldn't
ignore the certificate warning even if he wanted to because the HSTS req
is pinned in the browser itself (with any reasonably modern browser) and
if you've EVER securely visited gmail, an HSTS token indicating the
proper cert for the site is set that should prevent MITM "replacement
cert" attacks.  Bottom line: an exit node simply can't SSL-strip an HSTS
site, and MITM is practically impossible, because you must catch the
very first connection on an empty browser store.
That said, it's still basically effortless for an exit node to exploit
it clients by injecting fingerprint-based iframe-style attacks into
whatever lowsec http pages you've requested, which gives abu al-badguy,
as an inherent consequence of his fresh root, access to the plaintext of
your https connections.  Basically, trojaning your box and snagging your
un/pw fields clientside is much more reliable for HSTS sites.
Torproject doesn't currently do very much to detect this kind of attack
(imo they should at least have an agent automatically comparing
known-good site requests with what they actually receive from each exit
and flagging unusual variations), and the "bad exit" vector is unlikely
to go away soon.  In fairness, there are only so many devs, and most of
them pooh-pooh realistic (paranoid) threat models.

@_date: 2013-02-21 23:22:01
@_author: survivd 
@_subject: [tor-talk] Email provider for privacy-minded folk 
Specific location will depend on the browser and implementation.  There
may be guidance in the RFC but I can't remember the specifics.  You
could check  and the chrome/firefox
implementations to get the exact details.
*"because you must catch the very first connection on an _empty browser
This is referring to the blackhat's perspective.  If you want to do a
cert replacement mitm attack against a client for an hsts site, you'd
have to perform it ("catch" the victim's request) the very first time
they ever visit that hsts site (because otherwise a long-lived
authentication token is set in the browser's data store that says "hey,
this is the specific ssl certificate this site should have, and if it
doesn't match this, it's bullshit").  Basically, if you try to swap the
cert and the browser knows that's not the right cert, it should
hard-fail (not just give you a "hey, are you sure this is the right
cert?" dummy box) because it knows there are shenanigans afoot.
*as an inherent consequence of his fresh root* blah blah
This is explaining that since you can't easily downgrade https
(encrypted) connections to http (unencrypted) for HSTS sites as a "bad
exit" by modifying the connection requests themselves (which is how ssl
stripping works), you would use a different vector.  It's a little less
convenient, but still pretty easy for a reasonably sophisticated actor.
 Basically, instead of trying to mess with the https connections, you
poison the content of any requested http pages proxied through your exit
node with browser exploits (you can drop in any you choose on the fly)
targeting the fingerprint of that particular browser (or just
shotgunning it if you don't care about being noisy, but that's lazy).
Since the idea of a browser exploit is to execute arbitrary code (i.e.
whatever the attacker wants), the bad guy can basically give himself
persistent root (administrator) access to the victim's machine.  This is
obviously a way more reliable approach than the blackhat simply crossing
his fingers and hoping he catches somebody's first access to an HSTS
site.  Once he has root, he gets the plaintext of the victim's https
connections (since he owns your machine... he can see your tx/rx data
before you've encrypted it to the server and after you've decrypted it
from the server).
As a fringe benefit, this now works for him regardless of whether or not
you're connected to Tor, because he owns your machine basically until
you reformat.
Make sense?
