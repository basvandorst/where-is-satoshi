
@_date: 2006-08-03 10:25:55
@_author: =?ISO-8859-1?B?sKSmpsej83fxX9Dodu+jX9/zpaampLA=?= 
@_subject: Using Tor signals on Win32 NT (eg. pseudo-signals)? 
Because your not a progammer and I just so happen to have some free
time I wrote up this small sample for you (should be vbscript but its
been a long time since I used it), it makes use of Toolsack's Socket
(  its free and easy to use)
to connect to Tor's control port and send signal hup, which will tell
Tor to reload its config file. Copy and paste from the -- to -- and
save it in a file with the extantion .vbs Run it and Tor should reload
its config. I commented it so you know what everything does. I have
tested it and it works fine. The only thing I didnt add was some kind
of error checking for the connection, but if it cant connect you will
get an error message from the interpreter saying so anyways.
'Make torsock out socket name
set torsck = CreateObject("Toolsack.Socket")
'Connect to Tor's control port
torsck.Connect "localhost", 9051
'Auth so we can send commands
torsck.Write "AUTHENTICATE" & vbcrlf
'Read the buffer so we know what to do
chktxt = torsck.ReadLine
if (chktxt = "250 OK") then
  'If we get an OK then send the reload signal
  torsck.Write "SIGNAL HUP" & vbcrlf
  'Other wise goto a failed message box
  call failed
end if
'Again read the buffer
chktxt = torsck.ReadLine
if (chktxt = "250 OK") then
  'If we get an OK then Tor reloaded its config
  msgbox "Tor config reloaded."
  'Other wise goto failed message box
  call failed2
end if
'Everything went good so finish the connection
call finish
sub failed
  'Message box for failed auth
  msgbox "Failed to authenticate."
  call finish
end sub
sub failed2
  'Message box for failed reload signal
  msgbox "Failed to send reload signal."
  call finish
end sub
sub finish
  'Send a QUIT command to Tor and close the connection
  torsck.Write "QUIT" & vbcrlf
  'Again read the buffer
  chktxt = torsck.ReadLine
  if (chktxt = "250 closing connection") then
    'Do nothing because the Tor closed the connection for us
  else
    'Something happen when trying to clsoe the connection so close it anyway
    torsck.Close
  end if
end sub
If you have any questions I will try my best to answer them. You can
contact me via email (below in my sig) if you need to.
clowndevil at gmail.com

@_date: 2006-08-03 18:50:09
@_author: =?ISO-8859-1?B?sKSmpsej83fxX9Dodu+jX9/zpaampLA=?= 
@_subject: Using Tor signals on Win32 NT (eg. pseudo-signals)? 
The only problem with using Microsoft Winsock Controls is that when
used in WSH it requires a developers license in your registry or you
cant use it. There is a workaround posted somewhere, but if I am not
mistaken its a copyright problem when you include your license in the
file for distribution (even though thats what seems to happen when you
add a mswinsck control to your app in vb or vc).
I could probably make a mswinsck version (if I ever remember the
methods it uses for wsh) and include the work around for the license.
You should then beable to use it on and Windows system that has
mswinsck.ocx registered.
