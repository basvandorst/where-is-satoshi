
@_date: 2008-12-11 23:25:40
@_author: Bernhard Fischer 
@_subject: How many hidden service circuits built? 
If I connect through the SOCKS interface several times at the same time to the same hidden service, does TOR open a bunch of circuits in parallel to the designated hidden service or does it just open a single one and then reuse it for every of the incoming SOCKS request?

@_date: 2008-12-12 09:59:40
@_author: Bernhard Fischer 
@_subject: How many hidden service circuits built? 
Is it possible to change this behavior (maybe by a slight modification of the Best regards,

@_date: 2008-12-12 13:35:50
@_author: Bernhard Fischer 
@_subject: How many hidden service circuits built? 
Sorry, I didn't see this before. I'll read your paper and I appreciate all improvements regarding hidden services. You guessed pretty good ;)
While TOR is building circuits there's always some kind of randomness involved. As far as I know TOR chooses nodes based on directory flags (like "fast", "stable", ...) and the randomizes those matching some criteria.
Obviously the flag "fast" is somehow misleading because bandwidth is a local property and does not necessarily mean that it's also fast across the network to any other node.
I'm interested in performance improvements of hidden services, but I'm talking about RTT once the connections are established and not so much on the connection setup time (which of course is also important but this time is only spent once)
I did some RTT measurements and my observations are really ugly. It usually is never below 5s. What you can observe is that when the circuit is rotated the RTT also changes signifficant.
My idea now was to open several circuits to the same hidden service. If they're connected through different nodes (because of the random selection) also the RTT will be different. Then I continuously do RTT measurements on all those circuits and always use that one with the lowest time for user Best regard,

@_date: 2008-12-16 12:00:56
@_author: Bernhard Fischer 
@_subject: Hidden Service Performance [was: Re: How many hidden service circuits built?] 
Thanks, I had a look at it. Your measurements regarding message transfer reflect pretty much the observations I did.
Of course, you are right. Changes in the path selection algorithm should be done with caution. But it was just an idea which looked feasible for me from a user perspective (SOCKS interface) without changing TOR, thus not risking loss of anonymity.
That could also be possible. I didn't scientifically proven measurements yet, but I will do. Maybe it's a problem of TOR *and* hidden services.
QoS sounds good but I think it might have same troubles in its deployment as it has in plain Internet.
QoS was foreseen in IP since decades but never used network-wide.
Until today QoS is always a local service limited to the network of a provider or company. I can imagine that QoS deployment will last very long until it works TOR-network-wide for similar reasons.
Regarding authorization: Thanks, I already knew proposal 121 before and I did test those authorizations features. They work and seem to be very useful for some scenarios.
Best Regards,

@_date: 2008-06-22 10:54:53
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
OnionCat creates a transparent IPv6 layer on top of TOR's hidden services. It transmits any kind of IP-based data transparently through the TOR network on a location hidden basis.  You can think of it as a point-to-multipoint VPN between hidden services.
for further information.

@_date: 2008-06-24 20:33:50
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
OnionCat changes the UID to an unprivileged user as soon as the tun device configuration is finished.

@_date: 2008-06-24 21:45:08
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
The basic trick of OnionCat is that it converts the hidden service's onion id into an IP adress. The onion id has 80bit, hence, it would not fit into an IPv4 address but IPv6 has enough bits to do this.
Of course, an all-in-one package would be nice and maybe we will have something like that some days but IMO OnionCat currently is too maiden for such a project.
Well, basically that's no technical reason.
It's because the purpose of TOR is not to support people in illegally downloading/sharing stuff thereby eating up all the bandwith of the network. TOR is for protecting people's rights and privacy.
But I'm sure those issues were discussed many times on this list ;)

@_date: 2008-06-24 22:01:27
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Yes, with some limitations. OnionCat (currently) does not route packets.
You can not forward packets to arbitrary destinations to onioncat, only those with destinations which are associated a hidden service. It is a "hidden service connector" and not an "anonymizing network layer" (currently).
That means that people running TOR and OnionCat can share data with torrent/donkey/... together, anonymously, on top of OnionCat but you can not just mix it with some "legacy" Internet-Users.
Not desired by who?
Sorry, don't know.

@_date: 2008-06-25 11:37:59
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Of Course you are right.
But the major development motivation for OnionCat is to make hidden services more useful and usable but it's obvious that someone immediately comes up with the idea of P2P sharing.

@_date: 2008-06-25 11:55:41
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Yes that's also my idea.
But as I already told OnionCat is in an early development state and we tried to not mix it with TOR code as also TOR itself is permanently under But if our project gets accepted as useful idea and piece of code by the TOR guys it's not very difficult to bundle it.
I have it on my TODO-List. I need to add routing capability for OnionCat what basically is not a big problem, but I'd like to have some interoperability with the kernel routing table and that adds portability troubles. So I could use my own routing table which is easy to write portable code. Im not perfectly sure yet.
But beside of technical issues it may create security issues.
Basically it is not so easy while using TOR to configure every software in that way that it does not reveal some information about the user. That's getting even a harder problem with onioncat because data forwarding is much easier because no additional settings (proxy, SOCKS,...) are necessary.

@_date: 2008-06-25 13:15:00
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Yes, this should work. But why would you like to do this? TOR's hidden services are not very fast even though no exit nodes are required.
And if you connect to your own computer, anonymity is not an issue.
If you only want to have encryption I suggest to use ssh oder openvpn.

@_date: 2008-06-26 09:34:04
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Yes, that's a good solution.
Direct connections through onioncat currently don't work because it does not route packets.

@_date: 2008-06-26 09:41:39
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Of course fd87:d87e:eb43:e20e:a09d:5e14:fabb:edf3.
The fe80 is just a link local address and it's part of the IPv6 protocol standard but forget it for normal purpose.

@_date: 2008-06-26 09:45:34
@_author: Bernhard Fischer 
@_subject: OnionCat -- An IP-Transparent TOR Hidden Service Connector 
Yes of course you do need authentication anyway!!!
Because everybody who knows the onion-id (or IPv6-derivative can also connect to your hidden service (OnionCat) through TOR.

@_date: 2008-11-11 23:34:08
@_author: Bernhard Fischer 
@_subject: is tor an email mixmaster? 
There's no hidden service directory available any more for this service.
Long time ago I wrote a small tool to check for hidden services. It consists of a shell script an a C program. Compile the program and then run the shell script with the .onion-URL as a parameter.
Find the souces below.
if [ -z "$1" ] ; then
   echo "usage: $0 "
   exit 1
HPID=`echo "$1" | cut -d . -f 1`
rm "$HPID" >/dev/null 2>&1
wget -q "$TDIR/tor/rendezvous/$HPID"
if [ ! -f "$HPID" ] ; then
   echo "could download \"$HPID\" from directory \"$TDIR\""
   exit 1
./getdesc < "$HPID"
      FRAME_SIZE 2048
int main(int argc, char *argv[])
   char buf[FRAME_SIZE];
   char timestr[32];
   char *ptr = buf;
   int len, intro, i;
   time_t ts;
   struct tm *tm;
   read(0, buf, FRAME_SIZE);
   len = ntohs(*((uint16_t*) ptr));
   ptr += len + 2;
   ts = ntohl(*((uint32_t*) ptr));
   tm = localtime(&ts);
   strftime(timestr, 32, "%c", tm);
   ptr += 4;
   intro = ntohs(*((uint16_t*) ptr));
   ptr += 2;
   printf("key_len = %d\ntimestamp = \"%s\" (%ld)\nintro_point_cnt = %d\n", len, timestr, ts, intro);
   for (i = 0; i < intro; i++)
   {
      printf("intro_point[%d] = \"%s\"\n", i, ptr);
      ptr += strlen(ptr) + 1;
   }
   return 0;

@_date: 2008-11-14 16:34:45
@_author: Bernhard Fischer 
@_subject: privoxy 
Please give a bit more information about your configuration to understand your

@_date: 2008-11-18 08:56:27
@_author: Bernhard Fischer 
@_subject: Limiting hops 
If you just want to encrypt data across a wireless network you should probably use another another technique instead of TOR, e.g. OpenVPN.

@_date: 2008-11-18 20:14:49
@_author: Bernhard Fischer 
@_subject: OT RE: Limiting hops 
As already mentioned, have a look at OpenVPN:
It's supported by "all" OSes and is easy to install and use.

@_date: 2008-11-04 09:42:32
@_author: Bernhard Fischer 
@_subject: Hidden Service Key Length fixed? 
I tried to use a hidden service private key with a length > 1024 bits but unfortunately tor (2.0.31) fails to use it.
Is there a specific reason that the key length is limited to 1024 bits?

@_date: 2008-10-28 08:12:34
@_author: Bernhard Fischer 
@_subject: Monitoring TOR 
You could use Nagios. It has some default probes for monitoring your network and your server and you can add your own hand-crafted probes.
You should watch your network and OS anyway because I'm not sure if this problem only is a matter of TOR.

@_date: 2008-09-15 16:16:50
@_author: Bernhard Fischer 
@_subject: OnionCat 0.1.9 now supports IPv4 
We have a new version of OnionCat ready which is now capable of
Read  for further instructions on how to use OnionCat and IP.

@_date: 2008-09-15 20:23:42
@_author: Bernhard Fischer 
@_subject: OnionCat 0.1.9 now supports IPv4 
What somebody would define as "acceptable" may be different but basically your concern about it is right.
TCP over TCP is an issue which has some kind of "rubber-band" effects on the packet transmission but that's a problem that share all kinds of VPNs. Hopefully TOR will work with UDP eventually because in respect to performance this would give lower latencies in my opinion and would also make OnionCat more powerful.
Specifically with TOR and OnionCat the rubber-band effect can even be observed when sending pings over OnionCat (and that's ICMP over TCP ;).
I'm not sure but I think that's because of the numerous concatenated TCP sessions that TOR circuits are built of.
But the real biggest problem currently is the bad performance of hidden services in general which overlays all other difficulties.
The advantage of OnionCat is its IP-transparency and together with TOR it is location hidden. If someone wants or needs to use hidden services he will also use OnionCat, there's not really a difference in performace.

@_date: 2008-09-15 21:09:37
@_author: Bernhard Fischer 
@_subject: OnionCat 0.1.9 now supports IPv4 
No, there's no difference. It's more or less the same code.
As I wrote before UDP would perform better but I have no influence on that -- TOR is based on TCP.

@_date: 2009-01-16 20:53:53
@_author: Bernhard Fischer 
@_subject: SMTPD Hidden Server 
You might also consider runnning your mail server on top of OnionCat.

@_date: 2009-07-03 08:23:30
@_author: Bernhard Fischer 
@_subject: TOR Exit via Squid 
This can easily be done with Squid running in transparent mode. You need a redirect rule that redirects all traffic going to any IP tcp port 80 to the local squid port, but it is rather simple with iptables.

@_date: 2009-06-18 10:45:44
@_author: Bernhard Fischer 
@_subject: Hetzner 
That's also my opinion. We also ran an exit node at Hetzner which lead to several discussions with their abuse people. One time the server simply was shut down and it took me days and much discussion to bring them to activate the network again.
They have been very uncooperative all the time. As a consequence, we moved our services away from Hetzner.

@_date: 2009-06-09 16:25:37
@_author: Bernhard Fischer 
@_subject: OnionCat 0.1.13 released 
We are proud to announce the stable version 0.1.13 of OnionCat after a longer test phase and minor bugfixes.
Information regarding OnionCat, the IP-transparent hidden service connector, can be found at  .
The latest source tarball is found at  .
The newer development versions will be numbered starting from 0.2.0. Serious bugs will be backported.
The future development plans for the next releases are
(*) I2P interworking (at last)
(*) better config file support
(*) config interface for GUI adapters (e.g. systray apps)
(*) incoming connection authentication
Best regards,
OnionCat - Creating a New Anonymous Internet

@_date: 2009-03-04 09:00:34
@_author: Bernhard Fischer 
@_subject: OnionCat News 
OnionCat ( is getting more stable and we successfully ported it to several OSes, most notably WindowsXP. Unfortunately we still lag behind with documentation but we have tasks to enhance this Currently it seems to run stable on and was explicitly ported to
(*) Windows XP (Cygwin)
(*) Linux
(*) OpenBSD
(*) FreeBSD
(*) MacOSX
For Windows we are working on an installation package, for installation from source have a look at Ubuntu package is ready ( Debian package is under construction. The debuild sources already exists within the svn tree.
OnionCat is checked in into OpenBSD ports tree -- unfortunately exactly that revision segfaults but an update will follow after release of OpenBSD 4.5.
On FreeBSD it will be checked in soon and also a MacOSX package will follow.
The Solaris port is already under construction.
Additional development is undertaken to build a special adapter (Socks5) for I2P. This will make OC run with Tor and I2P.
For further information have a look at  . Don't hesitate to contact me personally or register to our mailinglist ocat-talk at cypherpunk.at (ocat-talk-subscribe at cypherpunk.at).
Best regards,

@_date: 2013-04-02 12:20:37
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Can OpenVPN servers be run as Tor hidden services? 
OC works point-to-point but of course several "clients" could connect to one central point. I put "clients" under quotes because OC implements the peer-to-
peer-model and not the client-server-model.
Since it offers a transparent IP connection you can additionally setup any kind of routing.

@_date: 2013-04-02 12:28:13
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Can OpenVPN servers be run as Tor hidden services? 
Yes, you are right. The destination OC reuses the TCP session of the incoming But it would be not much effort to implement this into OC. Actually I did it by intense because using a separate connection back would double the HS connection setup time which was extremely high (up to 30 seconds) at the time OC was developed.
We are currently polishing the website, the code of OC and so on up. Probably I'll add this feature.

@_date: 2013-03-27 06:38:36
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Can OpenVPN servers be run as Tor hidden services? 
If you are trying to build an IP connection between hosts based on hidden services, you may also use OnionCat. It does exactly what you are looking for.
 Best regards,

@_date: 2015-02-16 09:16:31
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] [onioncat]  Paper for OnionCat and Tor New Crypto 
Yes, that's the "old" version, i.e. how it works right now.

@_date: 2015-02-16 09:19:51
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] [onioncat] Paper for OnionCat and Tor New Crypto 
Unfortunately not yet.
I'll write a proposal in English on my blog.

@_date: 2016-08-28 13:41:52
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] IPv6 /48 for OnionCat 
Yes, you can specify a different network prefix. But be aware, that this
would break routing with other OnionCats, i.e. you'll create your own
private network.
The prefix is defined hard-coded as the cpp macro TOR_PREFIX in
ocat_netdesc.h. Just modify it up to your needs an recompile it.

@_date: 2016-08-29 07:09:35
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] IPv6 /48 for OnionCat 
Exactly. To be more precise, OnionCat does not "route packets" in terms
of the IP protocol. In respect to IP, OC is like an Ethernet switch,
i.e. it works on layer 2.
Thus, routing has to be set up on the host computer (your Linux box, or
whatever) as usual. Think of Onioncat (and its tun device) as being just
another Ethernet port on you computer.
This basically implies all kinds of security risks (firewalling,...) you
could have on a network port with an IP address assigned to it.
You may also have a look at
For me, it sounds very complicated what you are trying to do. So even
one /48 prefix contains more addresses than the whole IPv4 address space.
And OC is not a multi-cast network, thus you cannot simply "arp" for
other OCs.
So why would you try to use several different /48 prefixes?

@_date: 2016-08-29 07:11:28
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] IPv6 /48 for OnionCat 
Yes, right.
Have a look at my previous reply a minute before.

@_date: 2019-08-20 22:31:08
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Onioncat and Tor Hidden Services V3 
Dear list,
I finally wrote a HOWTO on using OnionCat with v3 hidden services. I
also did some patches to OnionCat to have a better integration.
Best regards,

@_date: 2019-12-07 09:04:49
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Onioncat and Tor Hidden Services V3 
For v3 to integrate smoothly into OnionCat (and similar services), any
kind of external mapping database is necessary (as I already mentioned
in an earlier post).
I suggest 2 possible options:
1) Integrate v2->v3 lookup mechanism (I call it hs descriptor v2a) into
the HS directory. It should be like a v2 descriptor, but containing the
v3 public id and being signed by the v3 key, which is found in the
according v3 desriptor.
2) We implement any new database which offers such a lookup facility.
This option has several disadvantages: a) it works only if there is a
sufficient number of such databases up, and b) it's a little bit like
reinventing the wheel.
The V2a procedure could look like the following:
1) The V3 service creates a V3 descriptor and publishes it into the HS
dir as usual.
2) The v3 service creates a V2a descriptor which is the following:
V2a-id ... 80-bit truncated v3 public id (v3-id -> v2a-id = trunc80(v3-id) )
V3-id.... The full V3 id
sig ... Digital signature of all fields above, created with the v3
private key.
3) Publish the V2a descriptor in the HS dir with the v2a-id being the
primary key.
The V2a lookup should work as follows
1) Client has v2a-id (e.g. OnionCat, derived from IP address)
2) lookup V2a-id in HS dir and retrieve v2a descriptor
3) lookup and retrieve V3 descriptor in HS dir which was found in v2a
4) check signaturs of V3 and V2a descriptor.
5) connect to V3 HS
Best regards,

@_date: 2019-09-15 10:00:26
@_author: Bernhard R. Fischer 
@_subject: [tor-talk] Onioncat and Tor Hidden Services V3 
The article shows, that it is possible to use OnionCat with HSv3,
although v3 kills the full automatic addressing method.
For having a full automatic addressing (i.e. association between v3-id
und IPv6) some kind of lookup mechanism is necessary. Although this
could theoretically be managed by DNS, this is NOT a solution because of
the well-known DNS leakage problem (and because the private network's
reverse delegations are not globally registered and would need some
IMO a solution could be a HSv3-HSv2 compatibility system within the HS
directory let's call it HSv23.
I propose to create HSv23 entries in the HS dir, which are almost the
same as HSv2 but with an additional field including the HSv3-id and the
signature is created by the HSv3 key. The index (i.e. the onion-id) of
the HSv2a entry is an 80 bit truncated HSv3 id.
The lookup then works as follows:
1. Convert IPv6 to onion-id (80 bit)
2. Retreive the HSv23 entry of the HS dir
3. Retreive the HSv3 entry
4. Check signatures of HSv23 und HSv3 entry
5. Connect to HSv3 service
Recently, I also wrote an Security Considerations article on OnionCat
which also includes a short discussion of the Hsv2/Hsv3 security in
respect to OnionCat:
Best regards,
