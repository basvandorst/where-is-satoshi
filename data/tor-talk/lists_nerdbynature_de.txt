
@_date: 2010-04-09 20:58:32
@_author: Christian Kujau 
@_subject: [or-talk] where are the exit nodes gone? 
The fastest Tor node out there, kudos!
Hm, we do not seem to monitor exit nodes over time (or do we?).
Looking at the tor.eff.org frontpage however there's an ad suggesting
that we were at 1755 exit nodes at one point. The current TNS sites
count only 584 exit nodes, a factor of three indeed :-\
Might this just be caused by some Tor code change leading to the TNS sites being unable to reliably determine if it's an exit node or not?

@_date: 2010-04-09 21:47:25
@_author: Christian Kujau 
@_subject: [or-talk] where are the exit nodes gone? 
Thanks for the link!
Yeah, I know. But the old URL is so much shorter! :-)

@_date: 2010-04-13 18:18:02
@_author: Christian Kujau 
@_subject: [or-talk] Re: huge pages, was where are the exit nodes gone? 
...and some of them are running on old notebooks and the tor process is only a few megabytes in size :-|
However, if it turns out that using hugepages in Linux would help larger Tor installations (and "superpages" can be recommended for *BSD systems[0]
as well), maybe this can be documented somehwere under doc/ or in the wiki. But let's see how Olaf's experiment turns out.
[0]     This is disabled by default and can be enabled by setting a loader     tunable vm.pmap.pg_ps_enabled to 1.

@_date: 2012-02-22 12:53:24
@_author: Christian Kujau 
@_subject: [tor-talk] Tor bridge with no traffic 
I'm running a Tor bridge for some days now (after shutting down an exit node, due to too many DMCA complaints) but it's hardly getting any   Heartbeat: Tor's uptime is 1 day 11:59 hours, with 2 circuits open.
  I've sent 7.34 MB and received 24.86 MB.
I feel like it's configured wrongly, though the log file does not report any errors:
Tor 0.2.3.12-alpha-dev (git-81fe3e438b39cd14) opening log file.
No AES engine found; using AES_* functions.
This version of OpenSSL has a slow implementation of counter mode; not using it.
OpenSSL OpenSSL 0.9.8o 01 Jun 2010 looks like version 0.9.8m or later; I will try SSL_OP to enable renegotiation
Your Tor server's identity key fingerprint is xxxx
Configured hibernation. This interval begins at 2012-02-21 00:00:00 and ends at 2012-02-22 00:00:00. We have no prior estimate for bandwidth, so we will start out awake and hibernate when we exhaust our quota.
Parsing GEOIP file /opt/tor/share/tor/geoip.
Configured to measure statistics. Look for the *-stats files that will first be written to the data directory in 24 hours from now.
This version of Tor (0.2.3.12-alpha-dev) is newer than any recommended version, according to the directory authorities. Recommended versions are: 0.2.1.32,0.2.2.35,0.2.3.10-alpha,0.2.3.11-alpha,0.2.3.12-alpha
Reloaded microdescriptor cache.  Found 2910 descriptors.
We now have enough directory information to build circuits.
Bootstrapped 80%: Connecting to the Tor network.Heartbeat: Tor's uptime is 0:00 hours, with 4 circuits open. I've sent 0 kB and received 0 kB.
Bootstrapped 85%: Finishing handshake with first hop.
Bootstrapped 90%: Establishing a Tor circuit.
Guessed our IP address as x.x.x.x (source: x.x.x.x).
Tor has successfully opened a circuit. Looks like client functionality is working. Bootstrapped 100%: Done.
Now checking whether ORPort x.x.x.x:9001 is reachable... (this may take up to 20 minutes -- look for log messages indicating success)
Self-testing indicates your ORPort is reachable from the outside. Excellent. Publishing server descriptor.
Performing bandwidth self-test...done.
I've forwarded port 9001/tcp from the internet-facing router to the machine where tor is running, of course.
My torrc looks like this:
SocksListenAddress 127.0.0.1:9050
SocksPolicy accept 127.0.0.1
SocksPolicy reject *:*
Log notice file /var/log/tor/notices.log
RunAsDaemon 1
DataDirectory /var/lib/tor
ControlPort 9051
ControlListenAddress 127.0.0.1:9051
HashedControlPassword xxx
ORPort 9001
Nickname xxx
RelayBandwidthRate  100 KB
RelayBandwidthBurst 250 KB
AccountingMax 4 GB
AccountingStart day 00:00
ContactInfo xxx
ExitPolicy reject *:*
BridgeRelay 1
I've also installed a bridge in an Amazon EC2 with the TorCloud project and here I have the same problem:
  Heartbeat: Tor's uptime is 23:59 hours, with 0 circuits open.
  I've sent 2.44 MB and received 13.41 MB.
Network-wise things seem to look fine:
  Feb 21 20:42:17.000 [notice] Self-testing indicates your ORPort is   reachable from the outside. Excellent. Publishing server descriptor.
The torrc for the EC2 bridge:
Nickname xxx
ContactInfo xxx
SocksPort 0
ORPort 9001
ORListenAddress 0.0.0.0:9001
BridgeRelay 1
AccountingStart week 1 10:00
AccountingMax 10 GB
ExitPolicy reject *:*
Any ideas on how to get the bridge going?

@_date: 2012-02-23 03:43:40
@_author: Christian Kujau 
@_subject: [tor-talk] Tor bridge with no traffic 
But, isn't this a problem? Porxying through tor is slow enough and when I was running an exit node, there was lots of traffic there. When bridges are not "announced", no one will use them - sounds like a real bottleneck.
I''ll wait. My IP address is almost never changing though.
Is there some other way to announce the bridge?

@_date: 2012-02-23 16:11:58
@_author: Christian Kujau 
@_subject: [tor-talk] Tor bridge with no traffic 
You mean, people can configure their tor-enabled client just to connect to a (public) exit-node? Isn't this a privacy issue? what about the onion-model? Or maybe I misunderstood what you said.
Won't do :-)

@_date: 2012-02-24 12:57:20
@_author: Christian Kujau 
@_subject: [tor-talk] Tor bridge with no traffic 
Understood now. Thanks for clearing this up for me.

@_date: 2015-11-25 02:36:39
@_author: Christian Kujau 
@_subject: [tor-talk] Interrupt: we have stopped accepting new connections 
I'm running a Tor relay on Ubuntu 15.10 and today I upgraded from 0.2.6.10 to 0.2.7.5 (0.2.7.5-1~vivid+1). Since then the Tor node starts, builds up ~280 connections - and then accepts no new connections. "telnet localhost 9001" comes back with connection refused. And in the log this infamous[0] message gets logged every ~2.5 minutes:
  > Interrupt: we have stopped accepting new connections, and will shut
  > down in 30 seconds. Interrupt again to exit now.
I'm not using "monit" or other monitoring tools that would stop Tor - it appears to stop itself. The changelog[1] for the new version mentions:
 * Split systemd service timeout into start and stop timeout, and raise
   them to 120 and 60 seconds from 45 (closes: tor
Could this be related to what I'm seeing? I can't debug any further now but hopefully tomorrow. I wasn't able to find a tor_0.2.7.3-rc-1_amd64.deb, all the mirrors already have caught up with the new version.
My torrc (which hasn't changed for months):
SocksPort               0
RunAsDaemon             1
DataDirectory           /var/lib/tor
ControlPort             9051
HashedControlPassword   ...
ORPort                  9001
Nickname                ...
RelayBandwidthRate      1536 KBytes
RelayBandwidthBurst     2048 KBytes
AccountingStart         week 1 00:00
ContactInfo             ...
DirPort                 9030
MyFamily                ...,...
ExitRelay               0
ExitPolicy              reject *:*
DisableDebuggerAttachment 0
Any ideas?
[0] [1]

@_date: 2015-11-25 23:02:58
@_author: Christian Kujau 
@_subject: [tor-talk] Interrupt: we have stopped accepting new connections 
As it turns, it has nothing to do with Tor. I tested vanilla tor-0.2.7.5 and started it manually and Tor works just fine.
This message ("Interrupt: we have stopped accepting new connections") gets triggerd when Tor receives a -SIGINT signal to shutdown gracefully.
So something on the system is sending -SIGINT to Tor every ~2.5 minutes. This being an Ubuntu/wily system, the first suspect would be systemd. I have two systemd "things" here, maybe its configuration must be tuned not to send out -SIGINT signals:
  $ systemctl | grep -w tor
  tor at default.service loaded failed failed    Anonymizing overlay network for TCP
  system-tor.slice    loaded active active    system-tor.slice
I'll try to find some time to debug through this mess in the next days, but for now I'll just run Tor manually.
