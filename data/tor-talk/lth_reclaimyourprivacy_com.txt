
@_date: 2014-11-01 17:09:31
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Hi Everybody, As some of you may have noticed, a new Tor Router project called Cloak was just launched on Kickstarter. In the wake of the Anonabox roller coaster, I would like to present our own justification for the Cloak project, and a bit of background. Please accept my apology if this comes across as a shameless plug. That is not my intention. We - the team behind Cloak - and me (the networking and embedded Linux guy in the team) are genuinely concerned about privacy and we really would like this product to be what the TorRouter never became and the main reason to post this here is to - hopefully - provoke an interesting exchange of opinions about products such as this. For us, the idea of Cloak actually started about 9 month back. Adrian (who is the guy backing this project on Kickstarter) came up with the idea and I (the guy who was working with embedded Linux systems in general) furiously maintained that it was an idiotic idea and that it couldn't be done. As things goes, Adrian finally manage to wear me down and I actually decided to give it a shot. At that time I was messing around with a cheap Wireless router module out of China called Oolite (this is funnily enough the EXACT same module that Anonabox claimed to have developed themselves - their prototype 2 which is a standard dev board from a company called Gainstrong). This particular module have 16 MB of Flash and 64 MB of RAM and much to my surprise Tor actually performed quite well on it. The result of these experiments - which dates back to around February or so - was 1: That I have been running Tor on my own home gateway ever since and 2: That I managed to port OpenWrt to the Oolite module (and got that included in OpenWrt trunk). At that time the Tor Gateway/Router got on a bit of a back burner since real life took over for a while. The day job being that we actually develop smart Internet of Things modules - both hard- and software.
About a month ago the Tor Router idea (which at some point had been dubbed Cloak) resurfaced as a potential kickstarter idea. The reason was that in the past 6 month we had actually developed quite a lot of experience with design and manufacture of the Internet of Things modules and all of a sudden it no longer seemed impossible to actually manufacture hardware for a Tor Router. We threw together a project plan and decided to launch around November/December.
In comes Anonabox. At first read it was quite a shock to be beaten by a small margin and of course a huge disappointment as the project got immensely popular very fast. Reading through the Kickstarter page and the web-site I did notice two things:
1. The lie about the hardware (since I had a 9 month old Oolite module)
2. The complete lack of his so-called Open Source software posted (only a bunch of config files that looked pretty standard to me apart from the hardcoded passwords)
But in general I didn't really think much about these issues and I actually felt the guy had pretty much done what we had been planning for a while and that in principle it was OK.
When Anonabox was suspended on Kickstarter, we realised that we simply had to get this posted immediately but of course be very aware not to repeat any of the mistakes made by the earlier attempt.
The first step was to isolate the Tor/Cloak related stuff from my internal source tree and actually put a builtable source online on Github. That is currently available here: Second step was to document the hardware development to convince everybody (hopefully) that we _are_ actually capable of having a device such as this manufactured at a competitive price. Most of that documentation went on our web-site ( and schematics/PCB design on Github (same url as before).
I had already (9 month back) come up with some sensible firewall rules that would pretty much force all TCP traffic through Tor and since I had been running it for 9 month it was at that time fairly well tested (including Tor on hardware similar to our own). One thing that was missing was to create an OpenWrt build that would start up with sensible defaults everywhere.
One problem which Anonabox was criticised for was his hardcoded root password and WiFi keys. I agree with that criticism completely because most people who would be interested in a device such as this would never change their default password. Fortunately we had a quite elegant solution to this problem. Since we plan to produce these modules, firmware can and will be loaded in the factory as part of the production process (actually it happens during the semi-automated test after board assembly) and at that time we could generate a random root password and WiFi key, flash that to a small dedicated R/O partition on the flash, print it on a label attached to the box (along with Serial number and MAC address). That way each device will have a default password, but nobody except the owner of the device will know it.
Phew that was a relatively long rant and I apologize if I have caused extreme boredom. I can however now, that I have explained the background, come to the questions which is the primary reason for me writing here.
First of all, I would like to hear more opinions about the value of a device such as this. I realize that most technically adept people will frown on a a "toy" such as the Cloak, but this device is really not meant for anybody who can install the Tor software on their own or someone who can install Tor on a Rasberry Pi. It is meant for my parents, my kids or anyone else who - deserve privacy but might not be technically able to achieve it. I fully understand and appreciate that a Tor Router such as Cloak will NEVER in itself be able to provide any form of anonymity or security. It is merely a tool that if used correctly can help enforce a certain level of privacy (the newly introduced or discussed Australian data retention laws spring to mind and I am certain other countries are introducing the same laws). A secondary justification are devices which does not support Tor. I've got a Media player in my house and that does "phone home" every single time I play a movie on it and there is no way I could possibly install Tor on it. With Cloak and NO login - that is fairly anonymous.
Second of all I would sincerely like a discussion about the firewall rules and other security or usability issues with a device as this. The source is on Github for everybody to check and I will be happy to discuss any technical aspect and appreciate any constructive criticism.  I am of course also happy to respond to any questions thrown in my direction.

@_date: 2014-11-01 17:52:43
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Facebook brute forcing hidden services 
Wikipedia describe "Privacy" as "the ability of an individual or group to seclude themselves, or information about themselves, and thereby express themselves selectively" - the key here being "selectively".  Using Facebook is a choice - users of Facebook chose to accept the terms.  What is, at least in some cases, not a choice is ISP's monitoring usage data of their customers and selling such data.  By using Facebook as a hidden service at least it is clearly a matter of what I choose to tell Facebook and I don't have to worry about someone else spying on the traffic.  I agree that in the end that boils down to if you trust Facebook or not :)
Personally I think it is immensely cool that Facebook did this and I can't wait to see if Twitter and/or Google feel they have to follow that one.

@_date: 2014-11-02 11:10:13
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Yeah I guess we are less "marketing oriented" perhaps even to a fault.  Anonabox definitely kicked up more interest than Cloak have done so far.
The enclosure design has not been finalized but we do have an idea and a designer working on it and Adrian have just changed the image to show the first rendering.  Do check it out if you feel like it - I think the "stealth look'n'feel) is quite cool.  Size wise it will be smaller than a TP-Link MR3020.
I am aware of some but I am also quite sure there are some I haven't considered, so input is appreciated.
I think the hardest part is to make non-technical users aware that a Tor router can only do so much.  Their behavior using such a router is just as important (or more).
The trick is to find a balance and I guess that is what I personally hope to find by discussing it here.  If a general consensus over a reasonable list of ports that are routed through Tor could be reached that would be great.
HTTPS you say.  What about for example XMPP, IMAP etc? The Tor over Tor that you mention (and someone else mentioned it too) is interesting.  That I hadn't thought about at all honestly.
Question is - can that actually be done technically at a networking level?  Can Tor in fact bootstrap itself over a Tor connection?
Hmmm, I am a little confused about the node.js question.  As I mentioned I am developing Internet of Things modules based on the same hardware design and I have actually managed to get node.js running on it.  We were looking for a scripting language that didn't put too much strain on the rather limited hardware resources (python, perl, erlang and well node.js) and node.js was by far the most well behaved.  It is not small though.  I think the Flash footprint was in the region of 3-4 MB and it is quite memory hungry.  Essentially node.js take more resources to itself than the tor daemon.
That depends really.  By themselves yes they are smaller.  But the node.js is not small and memory is perhaps the biggest issue.  Like all scripting languages node.js rely on some garbage collection of resources that are no longer used and it tends to leave a lot of wasted resources around for a while.
My personal expertise is networking and embedded Linux and I would be happy to run some tests on this and/or participate in any projects getting something like this going.

@_date: 2014-11-02 12:08:15
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
At source level what would happen is that I update one Makefile to pull the new version of Tor and then build a new firmware.  Provided Tor hasn't changed in a way that causes it not to build that is about it.  I described that here: But I know that wasn't your question...
I am open for any and all suggestions as to what would be the best approach.  My goal would be to archive a good balance between security and usability.  Let me throw some possibilities up for discussion:
1. 100 % Automatic
The device check at regular intervals if a new binary firmware is available and if that is the case it just updates.  This one is entirely possible and not hard to implement.  I am however not sure I like it.  If someone managed to hijack our domain name that someone could brick all devices in one go.  There is also the possibility of accidental bricking of thousands devices (even Microsoft have released updates that crashed Windows, and Google have screwed up their android updates quite often).  In short - I personally don't like this one but I am willing to stand corrected and be convinced otherwise.
2. Automatic update of Tor alone
This is a bit software as in the binary firmware stays as it is but only the Tor package gets updated.  It's got the same security issues as number 1, but less of a risk of bricking accidentally and a path to recovery IF a bad update was submitted.
3. Visual indication of "action needed"
In our current hardware design we actually included a RGB LED for this very reason.  We could have that flashing RED (and label it "Update needed" on the box) if not up to date but still leave it for the user to update.  I am personally leaning towards this one unless the issues with 1 or 2 can be solved but I am aware that a lot of people won't update.
4. Refuse to function unless updated
Would flash red as in 3 but refuse to run unless the firmware is updated.  I personally think this one is too annoying from a usability point of view.
As mentioned I am right now leaning towards number 3, but I am quite willing to be persuaded that I am wrong.
I don't disagree with you at all except I obviously think a device such as this is a brilliant idea :)  I/we have no intention of misleading people into a false sense of privacy!  I am originally from Denmark but I have lived most of my life in countries that are significantly less democratic than Denmark and at the moment it would appear that most of the world is going in the wrong direction.  I actually think that using Tor for everything where you ARE have a value even if it doesn't mean much in the global scale of things.  Removing the possibility for my local telco to keep meta data of what I do is important I think if not for a security reason then at least to make a loud public statement.
The new Facebook initiative is a good example.  Of course the whole idea of privacy is ridiculous when talking about Facebook, but still - when I choose to share something on Facebook that is a choice - a choice to share that particular thing and a choice to trust Facebook will only share it with the people I choose to share it with.  However, I want to be reasonable certain that nobody is "sniffing" that data in between.  I did NOT choose to share that information with my Internet provider or the government in the country where I stay.

@_date: 2014-11-02 14:16:13
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
No, we haven't done that yet apart from me trying to start this discussion here on the mailing list (which is the recommended way according to   I (and Adrian - the project leader on Kickstarter) will be happy to engage in any discussion on or off list.
Some of them (currently cloak, cloak-luci, cloak-packages) are forks with changes, cloak-management and cloak-routing are not modified and cloak-cloak (yeah I know - that one came out silly) is addons that are not part of OpenWrt or override something in OpenWrt.  I have added a note on each repository that clearly states the upstream.
That would be the preferred approach except:
1. When I started working with OpenWrt they still used Subversion with NO git interface.
2. The main OpenWrt git repository is still hosted on git.openwrt.org and not on Github.
In fact they only moved to Github a few month back (I think Luci is about a month back).
I have contributed a bit of code to OpenWrt in the past and believe me I wish they would accept pull requests.  They don't - they expect a patch on a mailing list.  So yes, the current approach is not ideal at all but is a result of some legacy (as in OpenWrt using Subversion until not long ago) and perhaps also my own struggles with Git (I have used Git for a couple of years and it still messes with my brain occasionally).
I regard Cloak as 100 % Open Source and it will remain so.  As long as I am the only one working on it I guess it will run in the best way I can think of.  If more people want to join or contribute in that development that approach can and will be adjusted as better options show up.
Just to clarify how I am currently working on Cloak:
1. My primary (origin) repository is an internal Git server (legacy from OpenWrt using Subversion)
2. I regularly pull/merge the official OpenWrt repositories into my own 3. The branch master is pushed to Github
Currently it is really hard to keep up with OpenWrt as they are in a transition phase.  I actually think most will end up on Github and if/when it does I will probably make a proper fork on Github and use those as primary repositories.
You are welcome!
As open as hardware can ever be :)  We were careful not to use the term "open source hardware" because it makes little sense.  Doing electronics is like a lego kit but there will always be parts where you have to trust the specifications from the supplier.
Thanx - that is a great suggestion and we will definitely do that.  The short story right here is:
Obviously you are _never_ going to get Qualcomm Atheros to provide their design details.  Same goes for all the other IC's (flash, RAM).
At this very moment there are some issues/unknowns regarding the Dragino HE module.  Schematics will be available but the PCB design probably not (working on a clear statement on that one).
Everything developed specifically for the Cloak device will be on Github - schematics and PCB.
Arduino Yun is suffering the same issue as the Dragino HE module - and that issue is Qualcomm Atheros insistance on NDA's for accessing their reference designs (it is known as AP121 - a google search for "ap121 ar9331" should provide tons of links to the schematics most in Chinese).
No it is not complicated to make the rules, but it is somewhat complicated to determine which rules are the best balance between actually providing a degree of privacy and usability.
One example I have been thinking about a lot is my media player.  I've got a cheap as chips media player device connected to my TV an that device is actually quite chatty on the network.  It regularly phones home and it pull various data off the Internet - movie posters, descriptions, plots etc.  It can also be used with various online services - youtube for example.  Nowhere have I provided any login information.  I think for a device like that it makes sense just to force everything it tried to do on the Internet through Tor and pretty much let it do whatever it wants (since blocking some of the ports would probably render the device either useless or crippled).  That is obviously an extreme end of the possible use cases - a device that is more or less completely out of my control.
Another example I have mentioned in another mail is that I - while being Danish - have lived most of my life in countries that are - let's just say - significantly less democratic than Denmark.  In general I would say that there is a point in ensuring my Internet Service Provider hasn't got a clue what I am doing.  What they don't know they can't be forced to tell anyone.
The current version of the default configuration is simple - allow DNS but route through Tor, allow all TCP but route through Tor, disallow UDP.  That should probably be changed to a positive list instead - so specifically allow a list of services that benefit from being used through Tor.
One suggestion I could make is this.  Currently the Cloak defaults to two networks: open and cloaked.  The open one is - well - open.  The cloaked route all TCP traffic through Tor - end of.  How would it sound if we made 3 networks instead:
1. Open
2. Cloaked
3. Isolated
Where 1 and 2 were as now (perhaps with Cloaked a bit more locked down) and 3 only allowing https.  That combined of course with CLEAR documentation to the end user of the consequences of using either network.  That approach would be easy to implement, relatively easy to explain and offer a choice to the end user.
Now, that one is interesting!  And that is definitely something we could easily do (provided of course we get funded on Kickstarter which to be fair doesn't look all that promising at the moment).  I think - and I hope you will agree with me - that this is not worth spending a fortune on.  There _are_ xxxx certified random generator IC's out there, but they would probably double the cost of the device and you would still have to trust the vendor (and trust that we don't get screwed somewhere in the supply chain and end up with a Chinese fake).  Some approaches (that could all easily be achived within the current budget without adding significant cost to the device):
1. A random key is generated at production time from a well defined and generally accepted source and written to the read-only partition in each device.  It will stay there for the life of the device but it will be unique and unpredictable for each device.  2. Use the radio calibration data as seed.  At production time each device is calibrated to compensate for tolerances in various HF components.  I have yet to see two devices where this calibration data is exactly the same and it would certainly be very hard to predict it.  This data could be used to as seed - possibly combined with 1.
3. A White Noise on-board generator
There are multiple ways of doing this relatively simple typically based on a transistor base-emitter break down voltage or some random oscillator - examples:
Again, none of these are true random number generators but they are certainly quite impossible to predict - especially combined with 1 and/or 2
I would love to implement any or all of these in the Cloak device but I will need some input on which method would be the best in relation to Tor.
Now, that is a very very good start :)  I hope we (and others that might join this discussion) can reach a consensus on which balance between privacy and usability is the best.
I understand and appreciate that fully.
That is exactly what I am getting at.  It would be next to impossible to make a solution that off-the-shelf would fit and/or suit all.  But the Cloak device is intended to be as open as possible and certainly fully documented (in English) with an Open Source firmware that anybody with the technical skills can modify to suit them perfectly.  The tricky part is to make a sensible default off-the-shelf setting that is suitable for those who do not know the details about Tor.
This one is interesting in that I really didn't think of that at all.  I will need some input there.  Is that at all possible at a network level.  I would assume it's the bootstrap of Tor that needs to be prevented?
I was writing about this in an earlier email.  It is a little bit tricky for a device such as this.  I personally find it hard to accept the idea of fully automatic updates, but I am quite open for ideas on how to do this best.
Unfortunately I don't think Tor itself would benefit from my coding skills :)
Ah that one.  My original thought was that the best approach would be to donate a percentage of each sales to the Tor Project and if that is the preferred way for the Tor Project AND the Kickstarter project is successful we can most certainly do that in the future.  Unfortunately that approach was probably not acceptable to Kickstarter (they specifically disallow contributing to charities and we simply didn't have the time to figure out if contributing to Tor Project was considered a charity or the Tor Project actually wanted this approach or not).
Another issue was/is a simple matter of economics.  When we realized that we needed to do something I immediately established one exit node.  The primary reason is to get experience running those.  I _know_ there will be bitching from the service provider, but I don't exactly know how much.  Based on anonabox we were absolutely paranoid NOT getting caught with our pants down in a lie, so we had to put a promise there that we were absolutely certain we could keep.  The message I had hoped to send with the above was: "We know that a device such as the Cloak will put an extra load on the Tor network and we have every intention of compensating for that extra load."
Have you got an estimate of the average exit capacity needed per Tor user?
Every second is greatly appreciated!

@_date: 2014-11-03 09:50:22
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
That is of course true and like every other project that at the end of the day depends on the interest there is for such a product.  I have bought technology products in the past for which the support was dropped merely weeks after I purchased them (Nokia N9 springs to mind).  It is of course a valid concern, but I guess the best I can say is that if the Kickstarter campaign were to be successful or we found other means to fund this this is a product that I would like to develop continuously and even if that for some reason didn't happen at least every bit of source code is on Github for someone else to fork and keep maintaining.
Note to self: I need to test this.  As mentioned somewhere I've had Tor running on similar hardware for the past 7-8 month with number of clients fluctuating between 4 and 10 or thereabouts.  Never had an issue and never had to restart the gateway.  I'll revert with some proper test results.
That is absolutely correct which is why I think it is essential that a device such as this comes with some form of "Tor tax" (as in part of the proceeds goes towards maintaining the Tor network).
I am aware of some but the primary reason I wrote to this list in the first place was to learn more and see if it was possible to come up with a model that was genuinely useful.
I am not sure I understand this one.  Nobody will be connected to a Cloak device without knowing they connected to it.  As per other suggestions in this forum I am working to see if it is possible to use a captive portal approach to at least display a warning before continuing.
No, please - that I have never said.  What I have said and will stand by is that a product such as Cloak probably doesn't target people who are skilled enough to take a Rasberry Pi and figure out how to get Tor up and running on that.  I am quite convinced I never used the word stupid about such people.
This is technically not a problem.  The Cloak product could be an isolating proxy instead of a transparent one.  Or as I suggested in an earlier message it could be both depending on which Wi-Fi network the user decide to connect to.  What I am trying to do here is establish which approach is best and your opinion is definitely noted!
I doubt that will be possible for $50.
Fair enough.
I gave my reasons here: It is all a matter of cost.  The guy behind Anonabox planned to use an off-the-shelf chinese produced router.  What I don't think he considered fully was the time that would have to be spend loading the firmware on said devices.  Even if that process was semi automated, having to unpack a box, connect it to some rig, run the upgrade and repack it would add perhaps 5 minutes to each device.  In Europe or US that would be quite a significant increase.  In the case of Cloak, that step can be included in the production line (actually the final step - the test - where firmware is flashed anyway). It is a lot easier to support ONE piece of hardware than it would be to support "any old box".
Well, yes - so far planned is (of the top of my head): System, WAN, LAN, Wi-Fi and a RGB led which we haven't really decided exactly what to do with yet - but it was imagined as a status indicator of sort (say: Green all ok, Yellow Tor is not ready, Red no internet, Flashing red UPGRADE needed).
As explained earlier I am aware that one is a tad vague, but I (we) don't like to make promises we can't keep and this one was formulated in a way such as we knew we could do it.  My preferred approach personally would be to allocate a percentage directly to torproject, but that was not possible (allowed) on Kickstarter.
No doubt - it is really ambitious ;)

@_date: 2014-11-03 10:34:26
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
It is quite clear that the Cloak will not be able to provide bridge and/or exits - it simply does not have the resources.  Hidden services however should be within the realm of possibility.  The public Wi-Fi is definitely a use case we are quite aware of.
Even the Tor browser is facing the same issues if used wrongly.  On the Download page of Tor there is a list of 5 warnings.  One of these warnings read:
"Tor will encrypt your traffic to and within the Tor network, but the encryption of your traffic to the final destination website depends upon on that website. To help ensure private encryption to websites, the Tor Browser includes HTTPS Everywhere to force the use of HTTPS encryption with major websites that support it. However, you should still watch the browser URL bar to ensure that websites you provide sensitive information to display a blue or green URL bar button, include https:// in the URL, and display the proper expected name for the website. Also see EFF's interactive page explaining how Tor and HTTPS relate."
If a consensus is reached that a device such as Cloak must only allow certain traffic to be reasonable safe, then - well - that is the way the firmware should be build.  My personal take is that no solution is perfect and no solution will be able to prevent what NSA described as the "Epic Fail" - the user who is careless with the information he or she provides.  Any and all solutions - the Tor Bundle too - are making compromises to ensure usability (Javascript springs to mind - last time I checked that was enabled by default in the Tor Browser - that might have changed though).
WiFi clients are isolated from each other so no - if someone break Wi-Fi security they can access the Tor network (or the internet - depending on which Wi-Fi network they break), but in order to sniff traffic from other devices the Cloak device itself would have to be accessed (ie. root password guessed) and the device reconfigured (disable wifi isolation).
This one surprises me a bit.  The Tor manual states:
Don?t share circuits with streams from a different client address. (On by default and strongly recommended; you can disable it with NoIsolateClientAddr.)
Each client will have their own address so it is my understanding circuits will not be shared.
Wouldn't that be solved by enabling:
Don?t share circuits with streams targetting a different destination port.
Which is why the device will be highly portable ;)  I get what you mean but as stated earlier, everything security related is at the end of the day a matter of compromise.
Here is one running on Linux:
The team members didn't appreciate my skills as a camera man, so it never went on the web-site or kickstarter page.

@_date: 2014-11-03 10:44:10
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Doesn't this already exist?  According to the Tor manual:
Don?t share circuits with streams from a different client address. (On by default and strongly recommended; you can disable it with NoIsolateClientAddr.)
Don?t share circuits with streams using a different protocol. (SOCKS 4, SOCKS 5, TransPort connections, NATDPort connections, and DNSPort requests are all considered to be different protocols.)
Don?t share circuits with streams targetting a different destination port.
Don?t share circuits with streams targetting a different destination address.
Ah - I just tested it - those two options are not recognized at all.

@_date: 2014-11-03 13:59:15
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
What is the story with those "IsolateXXXX" configuration options.  They are documented in the Tor manual, but I tried them using the latest Tor RC and they were not recognized.

@_date: 2014-11-03 14:07:09
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I thought of another one that might be the best option so far:
5. Have a dedicated status LED that will flash RED if system need upgrade.  I don't like the idea of a fully automatic upgrade, but the device _will_ have a button and it could be that when the RED upgrade LED flashes, the device can be upgraded with a press of the button.  That approach is still to some degree vulnerable to a man in the middle (DNS hijack) attack though.

@_date: 2014-11-03 14:11:18
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I just tried with the current Cloak build.  And different clients use different circuits.  However, none of the configuration options appear to work, so I reckon it is down to:
Don?t share circuits with streams from a different client address. (On by default and strongly recommended; you can disable it with NoIsolateClientAddr.)
"On by default"?

@_date: 2014-11-03 15:00:49
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
As you can see from earlier posts - finding the best method for updating is still very much a work in progress.  One thing is for sure though - the hardware will be open and the source open source, so anybody will be able to write and build their own firmware and update the device.
"Firmware signature check" is a bit hard to do with any authority if the hardware in itself is open enough for people to write their own firmware, but I was thinking https certificate check for the automatic updates - in fact playing with that already (

@_date: 2014-11-03 15:26:21
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
In the case of a standard Cloak (as least as it is envisioned right now) that is not a problem for Cloak then.  Cloak _will_ be the Wireless Access Point, it will enforce client isolation at Wi-Fi level and it will hand out separate address to each client.
Hey - one challenge down :)
I think that was explained in another message already.

@_date: 2014-11-04 09:12:48
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Well, in theory (that is if it works as advertised) Client Isolation should do the trick.  I have not read through the source code and I have not done a really thorough test of this, but I believe it works at driver level by actually manipulating arp responses to each client.  In short - each client will only be able to see itself and the access point and no traffic should be passed between them.  That should take care of stuff like arp poisoning and fake DHCP.
Yeah I think so.
Yes - P2P might actually lead this device to exhaust it's memory, but then again - P2P is not really encouraged on Tor in the first place for obvious reasons.  And yes - traffic from one client using the same protocol to the same server would probably always pass through the same circuit.  I would think that is pretty unavoidable unless someone make a "IsolateSrcPort" in Tor.
Do you reckon that would be a huge problem.  I do believe the primary concern here (as I understand it) is the following scenario:
1. You want to browse a web site anonymously
2. While you do that - some other application - say Windows Update - phone home
If that traffic passed the same circuit you would be vulnerable at the exit node.  However, it is extremely unlikely that the server you were browsing anonymously is exactly the same server that another application were accessing, so this kind of traffic would already pass through different circuits and thus use different exit nodes.  Am I wrong here?

@_date: 2014-11-04 09:27:28
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
There are no other similar Kickstarter projects.
Your opinion is duly noted.
You may not agree with what we are doing.  That is your opinion and that is perfectly acceptable for me.  I do find it slightly (but I am thick skinned so no worries) offensive that you feel we are trying to take advantage of anyone.  I am not saying a device such as Cloak is the perfect magical box.  But I _do_ believe it has it's place and it can benefit some people (even some non-stupid and non-daft ones) and that belief is the only reason why I and the rest of the team have thrown an huge amount of effort into this project.
That is great.  Would you mind teaching my Western Digital media player how to do that on my behalf?

@_date: 2014-11-04 10:12:05
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Aarrrggghhh - I obviously can't read :)  Sorry and yes those options work on the TransPort as well, I have just tested it and it work.

@_date: 2014-11-04 10:51:34
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I do believe those option exist already on TransPort - I have just tested it and it works.  I currently use:
IsolateClientAddr (which is enabled by default)
Before these options if I on a device went to 2-3 "what is my IP address" sites they would all show the same IP.  Now they all use different exit nodes.  Brilliant!
It will obviously establish a lot more circuits - even just for loading a simple page, but it did not seem to have a huge impact on Tor memory consumption.  It still hovers around 28-29 % of the device memory (that was with 2 rather chatty android phones and 1 netbook connected).

@_date: 2014-11-04 17:18:25
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I have now enabled IsolateDestAddr and I think that will remain enabled.  It's too important to sacrifice for performance.  Performance took a small hit but not too bad (primarily wait time before page load while circuit gets established).
So - status from tor-talk discussion so far:
1. Wi-Fi clients are isolated from each other - no way to do sniffing, arp spoofing etc.
2. Both IsolateClientAddr and IsolateDestAddr are enabled - no more shared circuits.
Major one with no clear consensus is how best to do updates.

@_date: 2014-11-05 12:19:03
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I will definitely look into this one.  This should be quite easy to implement by messing a bit with the firewall tables :)
Only problem I see is that to make it useful I think it would have to time out at some point.  One example I have bought up a few times is my cheap and rather chatty media player.  I have not dug into the details exactly but I _know_ it "phones home" regularly and it is definitely a use case where the Tor browser bundle would be impossible.  Problem is that one is unattended so if I were to do a captive portal kind of page and that would require a positive acceptance, the Cloak would be useless for this scenario.
Number of wireless networks are not an issue so I _am_ beginning to think that more than two is necessary.  For example:
1. Open - Open network - no Tor
2. Transparent proxy - all tcp traffic allowed - forced through Tor - everything on separate circuits  - captive warning
3. Transparent proxy as 2 minus captive portal (for gadgets or someone who know what they are doing)
4. Isolating proxy - only https allowed - forced through Tor - everything on separate circuits and everything else blocked
It is not really a problem to make more than two so if this makes the Cloak more flexible I'd say it's the way to go.

@_date: 2014-11-09 17:03:34
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
And he just managed - sort of - to do it again.  This time he has resurfaced in Indiegogo claiming to use PORTAL (the OpenWrt version hasn't been updated for 2 years so I am not sure why he think that will make it better).
There is a new 3D rendering which will be uploaded today.
I think the only approach is proper documentation.
Problem is that would require protocol inspection and that is probably a bit outside the real of possibility for a processor of the size we imagine in the Cloak.  I think the best approach is to close everything by default and then have a whitelist of well defined ports that is well documented - including the possible dangers.
Let's move that one off-list, but I'll be happy to discuss any ideas you might have.

@_date: 2014-11-09 17:11:35
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I guess a certificate check is the best way to protect against a man-in-the-middle attack.  MD5 sum can verify the update package is downloaded successfully.
Well, problem is Anonabox seems quite good at selling his idea and we are probably too nerdy to gain traction :)

@_date: 2014-11-09 17:20:06
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
That is one option but I generally dislike hard coding stuff like that.
In the case of my media player I don't really provide it with login details, so it is merely a matter of preventing it's chattiness to be tied to my IP address.  I'll be fine if everything from that is just pushed through Tor.  I don't do streaming much by the way (live in a place with relatively slow Internet), so the chattiness is mostly downloading covers, movie descriptions etc.
I am not sure I get your time out idea.  Do you remember when it was discussed or the subject - then I can go back and read the archive.
The beauty of Open Source in general :)  I must admit after the Anonabox thing I expected to hit more hostility on this list, but I am quite happy with the discussion so far.

@_date: 2014-11-09 17:27:03
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I haven't really decided.  The box have a wan as well as a lan port.  I sort of expected to leave the lan port open and it certainly is in the current firmware version.  One option would be to make it possible to toggle it with a press on a button, but I really haven't thought that one through at all.  Any ideas appreciated.
I think that is mostly related to the target audience for a device such as this.  The less that needs to be configured the better - assuming that most users  interested in a box such as the Cloak won't want to make massive reconfiguration.  Of course a "power user" can squeeze the box to run exactly as they prefer.  But it's important to me to have sensible default so that as many people as possible can use it without changing anything.
Question - is Bittorrent still an issue at all?  I actually tried a few days ago - a quite popular torrent (thousands of seeds) bootstrapping using a magnet link - my netbook connected to a Cloak prototype with every single TCP port routed through Tor.  After 24 hours the magnet hadn't even downloaded - not a single byte received.  I suspect all trackers are using UDP now - and I guess most bittorrent clients too.

@_date: 2014-11-09 17:28:32
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
I reckon if the multiple WiFi idea is considered the best approach the "everything through tor" interface should allow HTTP as well as HTTPS, while the isolating proxy one should only allow HTTPS.

@_date: 2014-11-10 18:41:13
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
That's actually quite a good idea and in reality it could probably be based on exactly the same OpenWrt source.  OpenWrt compiles just fine for ARM processors as well as MIPS based Routers.
Something like this:
Would run an OpenWrt build with Tor as Relay/Exit just fine.  And I would be quite OK if the Relay/Exit version required some technical skills for installation (as in was not available as a ready flashed plug-and-go device).
My own area of expertise is mainly the embedded Linux part and some solid network/unix foundation, but yes - I'd be happy to help and as mentioned earlier whatever source produced or maintained on Github currently I'd be quite happy to move to a torproject server if that is preferred.

@_date: 2014-11-11 17:09:07
@_author: Lars Boegild Thomsen 
@_subject: [tor-talk] Cloak Tor Router 
Not to mention only board I could find with 2 Ethernet ports :)
