
@_date: 2009-07-01 13:18:07
@_author: Bill McGonigle 
@_subject: General question about exit policies... 
thinking aloud...
What if:
o Google was supportive of "good" uses of Tor, for its services
o Google ran an exit in its IP space(s) matching the exits as masked above
o Tor had a method to back-propagate signed kill commands based on the
key of the originating node
Then, if Google were being abused by a spammer running tor, it could
sign a message, originating in its IP space, asking to kill requests for
its IP space from a particular tor entry (these would have to expire
fairly soon).  Tor nodes could note, exchange, and drop those
connections.  Such messages from other IP spaces would be ignored.
If abusers are hard to catch and rampantly abusing tor this could lead
to really big tables.  But short of that it might make for Tor being too
hard to use for abuse, and disinterest those people.
Problems would be: Google being evil, somebody with control of lots of
IP spaces joining tor and trying to fill relays' memory with lots of
such rules.  An additional layer of trust could be built outside tor
such that somebody at Tor project could sign Google's kill key, using
PGP WOT or similar; even X.509 if we trust that (throw up a CSR-like
thing on webpage secured by HTTPS).
To the extent that somebody like Google has lots of data centers,
anycasts, etc., their cost would be higher to implement such policies,
but probably they have the capacity.

@_date: 2009-06-23 00:47:56
@_author: Bill McGonigle 
@_subject: ShutdownWaitLength vs. 'restart' in init scripts 
Hi folks,
I noticed a problem with the init script I have with the tor package on
Fedora 10.  The 'restart' command (just a start and stop) sends a -INT
to the running process, but doesn't account for ShutdownWaitLength.  It
looks like the old server instance unbinds, so the new one can start up,
but then when the old one is really ready to die, it takes them all out,
which leaves an inconsistent lockfile state and no tor running.  I first
noticed this on a version upgrade (which runs a 'restart').
Looks like this:
  Jun 22 22:09:39.260 [notice] Performing bandwidth self-test...done.
  Jun 22 22:09:57.620 [notice] Clean shutdown
So, I'm curious what other folks are doing to handle this.  I'm thinking
in order of preference:
 * wait for the pid file to disappear
 * extract ShutdownWaitLength from the config and wait that long
 * send a double -INT on stop()
 * wait 30 seconds
or, perhaps even better: fixing the server shutdown process so the old
server can't take out the new server.
But today is the first time I've ever run a tor relay, and I don't know
the codebase or what I don't know, so pointers appreciated from those
who may have already figured this out.

@_date: 2009-06-24 13:41:40
@_author: Bill McGonigle 
@_subject: Help Iranian dissidents 
The Fonera 2 might be a candidate platform.  Half the price, 32MB RAM,
built-in wifi, support for 3g modems.  IIRC, somebody already did a tor
mod for the first version.
A camouflaged case could be produced that would incorporate localized
power connectors.  Maybe even pass-through.

@_date: 2009-06-24 19:02:32
@_author: Bill McGonigle 
@_subject: Help Iranian dissidents 
I can't speak to the others, but for this one:
There could be at least four reasons:
1) they don't believe it.
They're just throwing ideas at the wall, to see who will do free work
for them.  They wouldn't spend a dime of their own money to do it.
2) lack of capital
They think it's a good idea, but don't have the funds to
allocate/acquire the manpower to get it done.  If only they were better
at raising money they'd get it done.
Summer of Code, perhaps other outlets for these folks?
3) ideological inefficiency
They think it's a tor feature, Tor Project alone should do it, even if
they have the capital and believe the business case.  I trust in
individual self-interest too much to believe this is real.
4) Confusion
They'd do it themselves but it's not obvious what they need to do.
Being opaque, they work on other things first.
I suspect this is possible, so I started a wiki page that could, in a
future form, be useful to this class:
  It would be great if those with experience could add info/links here,
especially architectural elements with broad commonality among potential

@_date: 2009-06-25 21:50:16
@_author: Bill McGonigle 
@_subject: ShutdownWaitLength vs. 'restart' in init scripts 
OK.  Is this ideological, or because it's no good?  I can work to fix
the latter (I don't think anybody at Fedora wants a bad RPM).  In my
experience automatic security updates [aside: which are currently borked
for the Fedora tor package, but that's another story, which I think I've
gotten the right people to resolve at this point] are worth many
trade-offs.  People just don't do security updates the way we wish they
this makes sense.
agreed, do you see any reason not to extract ShutdownWaitLength from the
config file?
OK, so to be more clear:
Let's call the old tor process we're taking down torA and the new one we
want torB.
1) torA is sent an INT to tell it to stop.  It begins its shutdown process.
2) The init script isn't waiting or watching, so it starts torB.
Because torA is no longer bound to its listener port, torB can start up
just fine. The init script is out of the picture now.
3) torA reaches ShutdownWaitLength time.  It kills itself.  <---guess
4) torB gets taken out by torA's final shutdown.
At this point the init script's lockfiles reflect torB running, when
actually no tor is running.  So it behaves inappropriately.
I realize there's no point in addressing the current Fedora RPM init
script here, but assuming 4) is correct, it would seem that however torA
is finding torB, it shouldn't do it that way.

@_date: 2009-06-29 10:56:32
@_author: Bill McGonigle 
@_subject: Question About Security Threat from Tor 
Another way to add a layer is to use a virtualization.  I'm going to be
converting my tor server to Xen shortly anyway (for another task it
does), so tor will probably get its own VM, for good measure.  It
already has its own IP, so it's pretty straightforward to do.
I've also seen some valgrind comments in the source.  Not sure if any
static analysis tools like clang are used.
