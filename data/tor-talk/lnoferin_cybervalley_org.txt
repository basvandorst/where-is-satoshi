
@_date: 2005-12-09 01:04:04
@_author: leandro noferini 
@_subject: My tor client does not work anymore 
Ciao a tutti,
I have a client that does not  work anymore since a few days via privoxy
and either directly.
It worked very well for many weeks for all the computers of my home lan. It comes from debian installation  on a Debian/sarge i386 with these apt
# Tor
deb  sarge main
deb-src  sarge main
Do I need to change version?

@_date: 2005-12-09 23:46:28
@_author: leandro noferini 
@_subject: My tor client does not work anymore 
Well! The  only things  was changed  (but many  days ago  before) was  the tor
server I put  on the same computer. This server does  not work also like
client (SocksPort 0) and it appears working fine. I saw only this:
root at xxx:~# tail -f /var/log/tor/log
Dec 09 16:54:46.299 [notice] Tried for 60 seconds to get a connection to [scrubbed]:80. Giving up.

@_date: 2005-12-11 13:47:52
@_author: leandro noferini 
@_subject: My tor client does not work anymore 
I think there  is something related to this because  I changed the torrc
for the  server removing the "accounting"  section (so there  is no more
hybernation) and things go better and also the client works fine. Before I followed the FAQ at
to make client and server indipendant.
Don't  think so:  do  I need  to post  here  the two  torrc (client  and
server)?

@_date: 2005-12-11 18:00:36
@_author: leandro noferini 
@_subject: My tor client does not work anymore 
- the  client starts  using the  script coming  from the  debian package
  (/etc/init.d/tor start)
- the  server  runs  using  a  different  user and  it  does  not  start
  automatically after the boot but I need to start it "by hand" using su
  - torserver and /usr/bin/tor -f torrc
torrc for client
root at xxx:~# egrep -v '^( /etc/tor/torrc
SocksPort 9050 # what port to open for local application connections
SocksBindAddress 192.168.10.6 # accept connections only from localhost
SocksPolicy accept 192.168.10.0/24
SocksPolicy reject *
AllowUnverifiedNodes middle,rendezvous
DataDirectory /var/lib/tor
Nickname CyberTorValley
Address cybervalley.homelinux.org
ContactInfo 1024D/A05672B5 Leandro Noferini torrc for server
root at xxx:~# egrep -v '^( /home/torserver/torrc
SocksPort 0 # what port to open for local application connections
SocksBindAddress 127.0.0.1 # accept connections only from localhost
SocksPolicy reject *
AllowUnverifiedNodes middle,rendezvous
Log notice file /home/torserver/log/notices.log
Log debug stderr
RunAsDaemon 1
DataDirectory /home/torserver/data
Nickname CyberTorValley
Address cybervalley.homelinux.org
ContactInfo 1024D/A05672B5 Leandro Noferini ORPort 9001
DirPort 9030 # what port to advertise for directory connections
BandwidthRate 20 KB
BandwidthBurst 25 KB
MaxAdvertisedBandwidth 20 KB
PIDFile /var/run/tor/tor-server.pid
ExitPolicy reject *:* # middleman only -- no exits allowed

@_date: 2006-01-05 00:18:25
@_author: leandro noferini 
@_subject: Running a server on the 80 and 443 ports 
Ciao a tutti,
I am  going to setup  a new server  with a good connection:  this server
will run on  a dedicated ip so I  would like to run on the  ports 80 and
443  as requested  at but I am finding this problem. The server will run  as a special user not and root  will only start the
program so I put these two lines on torrc to let the change of user
User torserver
Group torgruppo
but the same I get this error in log file
Jan 05 00:05:07.731  [warn] connection_create_listener(): Could not bind
to port 443: Permission denied
Jan  05 00:05:07.731  [err] options_act():  Failed  to bind  one of  the
listener ports. Jan 05  00:05:07.731 [err] init_from_config(): Acting  on config options
left us in a broken state. Dying.

@_date: 2006-07-19 10:31:07
@_author: Tortuga admin 
@_subject: low bandwidth utilization 
On tortuga server we have experienced this (notice.log):
Jul 16 18:15:15.652 [err] dnsworker_main(): writing answer failed. Child exiting.
[Many lines like this]
Jul 16 18:17:24.204 [notice] connection_dns_remove(): Address [scrubbed] is not pending. Dropping.
Jul 16 18:44:37.328 [err] dns.c:181: purge_expired_resolves: Assertion pend->conn->s == -1 failed; aborting.
And then the server dies.

@_date: 2006-03-23 15:06:47
@_author: leandro noferini 
@_subject: Rotate log problem 
Ciao a tutti,
I found a  trouble rotating log for the tor server  tortuga: log will be
rotated using the program savelog in a cron job (on GNU/Linux). When the
job ends I find the logs empty  and I need to restart the server to have
something in the logs. Is there another way to resolve this?

@_date: 2008-11-13 09:05:51
@_author: leandro noferini 
@_subject: is tor an email mixmaster? 
M. Peterson ha scritto:
I wrote a  small document about the use of some  email programs for unix
shell (mutt,  msmtp and fetchmail)  and socat to concatenate  these with
tor to send and receive anonymous emails.
The  work  is  quite done  but  I  found  the  entire process  too  much
complicated so I began to think that the trasparent proxy approach would
be better.

@_date: 2008-11-13 09:08:21
@_author: leandro noferini 
@_subject: Error "Making tunnel to dirserver failed" 
Ciao a tutti,
I found this error in syslog
Nov 13 08:38:23 nemo Tor[2370]: Requested exit point '$847B1F850344D7876491A54892F845934E4EB85D' is not known. Closing.
Nov 13 08:38:23 nemo Tor[2370]: Making tunnel to dirserver failed.
What does it mean?

@_date: 2008-11-02 20:05:40
@_author: leandro noferini 
@_subject: Found a bug in documentation on the site? 
Ciao a tutti,
I was making some experiments with fetchmail + tor and I found a strange
behaviour: at the address
there is this example:
set no spambounce set no bouncemail
poll provider
    plugin "socat STDIO SOCKS4A:127.0.0.1:%h:%p,socksport=9050"
    protocol imap
    user user with password password, ssl
    mda "/usr/bin/procmail -d userlocal"
but sniffing the  traffic I see a dns query for  the address of provider
_at the beginning_ of session:  looks like fetchmail doing these queries
at the  beginning of the  session without any  help from socat  and only
then it calls socat to download the messages, actually (?) late.
I think this behaviour must at least indicated in that page.

@_date: 2009-08-17 21:53:50
@_author: leandro noferini 
@_subject: New mirror for torproject 
Ciao a tutti
From  today   17  august   2009  is  active   a  new  mirror   of  the
    site    reachable    at    the    address
  The mirror  is updated  every four
P.S.: do  you know  if it will  be possible  to have an  ssl certificate
      signed the same like the main site?

@_date: 2009-12-13 10:46:15
@_author: leandro noferini 
@_subject: Freenode's (irc) Tor Catch 22? Two hidden services = zero? 
I found this problem too but  as I could understand the registration for
the accounts with gpg  need to be made "by hand" by  the operators so we
need to wait one or two weeks.
I also be waiting.

@_date: 2009-02-28 14:22:33
@_author: leandro noferini 
@_subject: Excluding some networks 
Ciao a tutti,
I use the trasparent proxy through tor to connect for a user but I would
like to exclude some networks  (vpn with a 192.168.X.X address): I could

@_date: 2009-01-07 06:32:52
@_author: leandro noferini 
@_subject: Needed changings for new version of iptables 
Ciao a tutti,
I am using the method explained at
  to have
a trasparent proxy for a specifical user on a debian/i386 unstable.
I use these rules for iptables:
iptables -t nat -A OUTPUT -p tcp -m owner --uid-owner anoymous -m tcp --syn -j REDIRECT --to-ports 9040
iptables -t nat -A OUTPUT -p udp -m owner --uid-owner anoymous -m udp --dport 53 -j REDIRECT --to-ports 53
iptables -t nat -A OUTPUT -m owner --uid-owner anoymous -j DROP
But since some  days ago a new version of  iptables (1.4.2-2) arrived in
distribution and I am having this error message:
The "nat" table is not intended  for filtering, hence the use of DROP is
deprecated and will permanently be disabled in the next iptables release. Please adjust your scripts.
How I could change the above script for the new iptables version?

@_date: 2009-07-29 19:26:21
@_author: leandro noferini 
@_subject: Two different hidden service on the same tor client 
Ciao a tutti,
I have a tor client running 24h  and I would like to serve two different
hidden services via  http on it. So I run two  different web server, one
on 8183 and another on 8184 port and I wrote these lines in my torrc
HiddenServiceDir /var/lib/tor/server-1/
HiddenServicePort 80 127.0.0.1:8183
HiddenServiceDir /var/lib/tor/server-2/
HiddenServicePort 81 127.0.0.1:8184
so if I try to connect to these hidden service they work.
Now comes  the question: is possibile  to run the two  hidden service on
port 80 together? If I change the above lines in HiddenServiceDir /var/lib/tor/server-1/
HiddenServicePort 80 127.0.0.1:8183
HiddenServiceDir /var/lib/tor/server-2/
HiddenServicePort 80 127.0.0.1:8184
                  ^^
I could not reach the second service.
Is this correct?

@_date: 2009-07-04 20:32:27
@_author: leandro noferini 
@_subject: tor-mirrors (mirrors of the Tor Project website) 
jon ha scritto:
I would like  to setup a mirror for  tor website but I need  to know how
much disk space needs.

@_date: 2009-07-06 19:44:08
@_author: leandro noferini 
@_subject: tor-mirrors (mirrors of the Tor Project website) 
jon ha scritto:
Uhmmm,  ok I  have not  so much  free space  for all  but only  for dist
eventually: is this kind of mirror really useful?
And how much space it will be needed in future? Is dist growing or it is
quite always the same?

@_date: 2009-03-01 10:32:46
@_author: leandro noferini 
@_subject: Excluding some networks 
Marco Bonetti ha scritto:
Yes, this is true.
I have a problem connecting but this is not due to tor, I think.

@_date: 2009-05-14 07:15:30
@_author: leandro noferini 
@_subject: Iptables configuration for a transparent proxy for a single user 
Ciao a tutti,
in tor wiki at the address
explains the way to apply a trasparent proxy for a specific user.
The rules for iptables are iptables -t nat -A OUTPUT -p tcp -m owner --uid-owner anonymous -m tcp --syn -j REDIRECT --to-ports 9040 iptables -t nat -A OUTPUT -p udp -m owner --uid-owner anonymous -m udp --dport 53 -j REDIRECT --to-ports 53 iptables -t nat -A OUTPUT -m owner --uid-owner anonymous -j DROP
In my debian  unstable linux (kernel 2.6.29 and  iptables 1.4.3.2-2 from
package) these  rules don't  work anymore and  this is the  message from
The "nat" table is not intended for filtering, the use of DROP is therefore inhibited.
Does anyone know the changes needed tomake it work again?

@_date: 2009-05-14 22:46:37
@_author: leandro noferini 
@_subject: Iptables configuration for a transparent proxy for a single user 
John Brooks ha scritto:
Ok, now ipfilter does not complain but I cannot connect anymore.
I will investigate more.

@_date: 2009-05-14 23:16:47
@_author: leandro noferini 
@_subject: Iptables configuration for a transparent proxy for a single user 
leandro noferini ha scritto:
I applied these rules for iptables (in this order):
iptables -A OUTPUT -p tcp -m owner --uid-owner anonymous -m tcp --syn -j REDIRECT --to-ports 9040
iptables -t nat  -A OUTPUT -p udp -m owner  --uid-owner anonymous -m udp --dport 53 -j REDIRECT --to-ports 53
iptables -A OUTPUT -m owner --uid-owner anonymous -j DROP
that gave this firewall.rules (saved with iptables-save)
# Generated by iptables-save v1.4.3.2 on Thu May 14 22:38:12 2009
:INPUT ACCEPT [16071:6425763]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [15031:2354190]
-A OUTPUT -m owner --uid-owner anonymous -j DROP # Completed on Thu May 14 22:38:12 2009
# Generated by iptables-save v1.4.3.2 on Thu May 14 22:38:12 2009
:PREROUTING ACCEPT [350:71565]
:POSTROUTING ACCEPT [264:19517]
:OUTPUT ACCEPT [264:19517]
-A OUTPUT -p tcp -m owner --uid-owner anonymous -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j REDIRECT --to-ports 9040 -A OUTPUT -p udp -m owner --uid-owner anonymous -m udp --dport 53 -j REDIRECT --to-ports 53 # Completed on Thu May 14 22:38:12 2009
But now the user cannot connect anywhere and if I try to see what the
configuration for iptables is I get this
minchioncino:~# iptables -L
Chain INPUT (policy ACCEPT)
target      prot opt source     destination
Chain FORWARD (policy ACCEPT)
target        prot opt source   destination
Chain OUTPUT (policy ACCEPT)
target       prot opt source    destination
DROP         all  --  anywhere  anywhere            owner UID match anonymous
I think this is not correct  because all traffic coming from the user is
dropped, right?

@_date: 2009-09-21 06:54:22
@_author: leandro noferini 
@_subject: Hidden service usage 
Ciao a tutti,
I  would  like  to control  the  usage  (the  amount of  connections  or
something like) to a hidden service I have.
In the man page (0.2.2.1-alpha-1 version) I found these directives:
As I can  understand I need to enable all to  have something, right? The
first option is not only for directory servers?
And also, what kind of information I will have?

@_date: 2009-09-21 22:11:45
@_author: leandro noferini 
@_subject: Hidden service usage 
Karsten Loesing ha scritto:
Well, so I understood right!
Yes I could have some informations like these "indirectly" using grep on
log files but I liked to have something also from tor server.

@_date: 2011-08-21 12:27:21
@_author: Leandro Noferini 
@_subject: [tor-talk] msmtp + .onion [Re:  The project "tormail"] 
I think you need also socat to use msmtp with a hidden service: try to
look at  for some

@_date: 2012-05-13 23:18:09
@_author: Leandro Noferini 
@_subject: [tor-talk] Socks5 and msmtp 
Il 06/05/2012 20:19, grarpamp ha scritto:
I use msmtp + socat and they works fine together with a tor relay.
I am also interested to help your effort too!

@_date: 2012-05-21 21:10:06
@_author: Leandro Noferini 
@_subject: [tor-talk] Socks5 and msmtp 
Sorry for delay!
Also in private mail for this delay.
socat -d -d -d -lu TCP4-LISTEN:2526,fork SOCKS4A:localhost:realsmtp.net:587,socksport=9050
now what you need is to point your mua to localhost:2526 as smtp server.
It works.

@_date: 2012-05-22 10:53:49
@_author: Leandro Noferini 
@_subject: [tor-talk] Socks5 and msmtp 
Il 22/05/2012 07:16, grarpamp ha scritto:
No, msmtp could be configured not to check ssl certs with
tls_certcheck off
option in .msmtprc
You could use different ports with different smtp relays.
It is not easy but I did not find anything better.
Tor too.
Some of them sure!

@_date: 2012-05-23 22:19:13
@_author: Leandro Noferini 
@_subject: [tor-talk] Socks5 and msmtp 
Yes, sure!
Sorry, I did not read this with sufficient attention.
Well, what could we begin to do?

@_date: 2012-05-25 23:16:46
@_author: Leandro Noferini 
@_subject: [tor-talk] Socks5 and msmtp 
I could not follow these notations now, please wait!
fetchmail leacks inesorably (?) dns requests also used through a proxy
socks -  this is my experience.
I found fdm ( really better: it has native
socks support and in my probes it does not leaks.
I don't know.
I don't know too.
