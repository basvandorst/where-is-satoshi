
@_date: 2014-02-18 14:03:58
@_author: Max Jakob Maass 
@_subject: [tor-talk] torproject.org censorship detection using RIPE atlas? 
Hash: SHA512
Hello everyone,
I am currently running two RIPE Atlas probes [0] and had accumulated
some points to use their measurement API, so I set up a measurement to
check the SSL Certificate of torproject.org from as many countries as
possible to detect MITM attacks on the website (mostly from state
actors). I also requested the DNS A-Record for torproject.org (to
check for falsified DNS records).
The results are preliminary, as a bunch of probes were completely
unable to connect to torproject.org (possibly due to censorship,
possibly due to bad luck in the selection of probes), but a few
interesting things surfaced so far:
First off, chinas results are actually quite interesting. A bunch of
probes got the correct certificate, one got a certificate signed by
apac.proxy.dsv.com, and a bunch of probes got no result at all
(probably being blocked). I'd have expected some sort of MITM or just
plain old blocking from China, but at least the SSL certificate seems
to be retrievable in many cases.
Then, there are some US-american probes that are returning an
SSL-Certificate for *.opendns.com instead of the correct result. I
have no idea what's going on there, but as opendns is a sponsor of the
RIPE atlas, it may be that they are hosting a bunch of probes behind a
SSL-terminating firewall for some reason. Still, if someone wants to
look into it, it may be interesting.
The results for the global SSL Measurements can be found at [1] and
[2], the one specific to china at [3]. Be careful when opening them in
your browser, as they contain large json-formatted strings, so you may
want to wget or curl them instead. Note that "no result" does not
necessarily mean that torproject.org is filtered, as the Atlas API
allows to schedule requests for offline probes, which will then fail
in this way.
As for the DNS survey, I have not had a chance to properly parse the
results yet, but you can download them at [4] (again, large JSON ahead).
Now for the real purpose of this mail: Has someone from the Tor
Project considered using the RIPE Atlas API to schedule these
measurements (a daily measurement ought to be enough) and
automatically parse the results to check for MITM, Censorship, and
maybe just plain old bad routing? The necessary API credits are easily
earned by hosting a single probe [5], or maybe someone is a member of
the RIPE NCC anyway, in which case he / she has basically unlimited
credits [6] anyway.
If someone wants to play around with the API without hosting a probe,
get in touch and I'll transfer you a bunch of credits (you'll have to
have an account with the RIPE NCC and have to be willing to disclose
the associated eMail address to me, as I need it for the transfer).
Feel free to use the data from the measurements and find more
interesting things in them, I'm curious what you can find.
[0] [1] [2] [3] [4] [5] [6]

@_date: 2014-02-18 15:33:21
@_author: Max Jakob Maass 
@_subject: [tor-talk] helping write Tor user stories 
Hash: SHA512
similar to what you are doing, the website team gathered some
"Personas" on this page:
They are functionally similar to what you are doing, and I think both
lists can benefit from each other.

@_date: 2014-02-20 11:32:23
@_author: Max Jakob Maass 
@_subject: [tor-talk] torproject.org censorship detection using RIPE atlas? 
Hash: SHA512
Yes, the measurement downloads the entire certificate and checks if it
differs at any point, not just if the CN or CA is identical.

@_date: 2014-01-09 10:30:18
@_author: Max Jakob Maass 
@_subject: [tor-talk] 1) Torproject certificate, 
4) I am working on something similar to Tor
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
An example would be "Certificate Patrol"
for Firefox. It implements Certificate Pinning and will notify you if
certificates change (even with special warnings if they change way
before they are due, and if the CA changes, both very handy features
when dealing with a compromised / Government MITM CA).
It does not, however, implement a Cert Web-of-Trust that compares the
certificate you are seeing to those other people are seeing. I am not
aware of any addon or browser that does that, so I'd be curious to
hear which ones implement that (as your message sounded like there are
indeed some implementations of this). I am also unaware of any addon
for Chrom{e,ium} or other browsers that does the job of certificate
patrol... If anyone knows about any, please let me know.

@_date: 2014-01-19 11:34:44
@_author: Max Jakob Maass 
@_subject: [tor-talk] Those Broken-Record Questions 
Hash: SHA512
Maybe something like "Tor is only ever used by pedophiles / drug
addicts / [insert stereotype here]". It's already answered here [0],
but having it in more places is always good.
Thank you for your work.
[0]

@_date: 2014-01-21 10:18:26
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
I see the same behaviour with the latest Chrome running Linux:
$ nc -l -p 1234
GET / HTTP/1.1
Host: 127.0.0.1:1234
Connection: keep-alive
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML,
like Gecko) Chrome/32.0.1700.77 Safari/537.36
Origin: Accept: */*
DNT: 1
Referer: Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8,de;q=0.6
So, appearently, Google does not enforce a same origin policy on this,

@_date: 2014-01-21 10:21:51
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
Interestingly enough, my Linux FF 26.0 running NoScript does _not_
allow connections, even when NoScript is allowing everything globally.

@_date: 2014-01-21 10:28:29
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
Christ. Chrome even allows to connect to other machines in LAN. I
successfully connected to my Raspberry Pi (only reachable via LAN) by
changing the IP in the source code from 127.0.0.1 to the relevant IP.
So, appearently, Chrome allows you to enumerate the LAN and interact
with other machines in it. I'll see if there is a bug report for that
Thanks for the Info, TT Security.

@_date: 2014-01-21 11:10:15
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
Well, this happens if you don't have an apache ready to really test
this stuff and only use netcat. Thanks for the info, I'll show myself out.

@_date: 2014-01-21 13:18:21
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
Tor actually rejected my attempted XMLHttpRequest to a non-loopback
address (Log-Message stating that the SocksProxy did not allow local
connections). But then again, it also did not successfully receive
data from localhost:80 (nc showed something, but the testing site gave
an error message when trying to connect to my apache2 on port 80). Did
it behave differently for you?

@_date: 2014-01-21 15:53:39
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
I'm not TT Security, but you can use my version:
It's not very pretty, but it is only a minor modification of the
original that includes this ability.

@_date: 2014-01-21 16:02:45
@_author: Max Jakob Maass 
@_subject: [tor-talk] Security issue. Firefox in Tor Browser Bundle allows 
Hash: SHA512
I'm also hosting it as a hidden service, to see if that makes any
difference. If you want to test it:
My results were: It makes no difference. Tor rejects local addresses
that are not 127.0.0.1, even the IP of my machine, with the log
message "[warn] Rejecting SOCKS request for anonymous connection to
private address [scrubbed].".
Have fun playing around with it.
