
@_date: 2008-05-19 10:59:00
@_author: Nick Mathewson 
@_subject: ContactInfo? 
Though when we want it, we *really* want it.  :) The short-key format
is usually good enough, though if you want to include a fingerprint or
a long keyid, that would probably be fine.
(A line with a long keyid would look like:
   ContactInfo 1024R/FFFFFFFFFFFFFFFF Somebody You can make gpg emit long keyids rather than short ones by specifying
"--keyid-format long" on the command line.)

@_date: 2008-05-19 10:54:10
@_author: Nick Mathewson 
@_subject: Tor server for port 443 
A port-443-only exit would definitely be useful.  The usefulness of an
exit is IMO basically what you allow, not what you restrict.

@_date: 2009-04-28 15:19:37
@_author: Nick Mathewson 
@_subject: Be ready: We're switching version control systems 
[...]
Exactly, though I'd like to make an appeal here.  If you are working
on a Tor-related project, the time to get in touch with us and the
rest of the community is probably _not_ when you think your code is
ready to be merged.  Working in the dark like this can lead to
duplicated effort (if you work on something someone else is also
working on), and wasted effort (if your approach, on review, would
have proved to have problems that you didn't see).
Somebody should really expand the "HACKING" document to explain how to
get started enhancing Tor, how to write a design proposal, what needs
a design proposal, what versions are okay for new features vs
bugfixes, how portable the code needs to be, why or-talk is not
or-dev, and so on.

@_date: 2009-04-30 00:57:30
@_author: Nick Mathewson 
@_subject: The Git conversion is done. 
Tor is now in Git.  The repository is at
   git://git.freehaven.net/git/tor.git
There is also a historical-interest repository at
   git://git.freehaven.net/git/tor-history.git
It has all the obsolete branches that we would never have put into svn
in the first place if we had been working with a DVCS. [*]
I've revised our internal Git Howto document a bit, with help from
Marcus Griep.  It might be a good starting point if you're new to Git:
   Happy hacking,

@_date: 2009-04-30 01:15:35
@_author: Nick Mathewson 
@_subject: The Git conversion is done. 
ARGH.  That should be git.torproject.org, not git.freehaven.net.  I
have had a very long day.

@_date: 2009-02-15 10:39:01
@_author: Nick Mathewson 
@_subject: Reminder: Please use the friendly bugtracker. 
Hi, all!  This is a reminder to everybody who's been sending bug
reports to the or-talk mailing list.
There is a bug tracker for Tor at
       .
The purpose of the bugtracker is to collect all the information about
each bug in one place, to help diagnose it, and to make sure that we
don't lose track of any bugs.
Please, unless there is some reason you can't, report bugs there.
Why?  Because the alternative kinda sucks.  If a bug _isn't_ on the
bug tracker, then there is more risk that we'll lose track of who is
working on which bug; or which bugs are the same as other bugs; or
which bug got fixed in which version, or worse: which bugs are fixed
and which aren't.  (When I run into a bug on or-talk, I try to copy it
to a "tor-bugs" mailbox, but I worry that I miss some, or that other
people more suited to fixing particular bugs aren't seeing them.)
(Yes, I know that the 'flyspray' tracker is annoying.  Some time
around when we start 0.2.2.x development, we'll probably be switching
to Trac.)
Thanks again for everybody's help in making a better Tor!

@_date: 2009-02-15 10:40:03
@_author: Nick Mathewson 
@_subject: No such file or directory: router-stabilit; unverified-consensus, cached-extrainfo 
You can ignore those; they're at level "info".  If they were important
they'd be at "warn".
They're there because Tor is trying to read some files to see whether
they're present.

@_date: 2009-02-15 10:54:56
@_author: Nick Mathewson 
@_subject: Excludenodes not considered? 
1) Whois is not a good way to find out where a computer actually is.
   Whois tells you about where the DNS name is registered, not where the
   computer is physically located.  GeoIP is a better bet.
   (FWIW, both of those addresses seem to be in Germany according to
   GeoIP too.  But I just wanted to mention that whois is a poor
   choice here.)
2) What version of Tor are you running?  You didn't say.
3) Tor needs a geoip file to have country detection work.  Yours was
   installed, right?
4) For some features, like hidden services, Tor needs to use
   particular nodes, since those were chosen by the service provider
   as introduction points, or they wound up as HS directories.  Do you
   know if you were you contacting or publishing a hidden service at
   the time?
5) Do you know what position in your circuit these nodes occupied?
6) Did you get an INFO log by any chance?  (Please don't post it to
   the list if it's huge.)
hope this helps,

@_date: 2009-02-16 11:34:47
@_author: Nick Mathewson 
@_subject: Excludenodes not considered? 
Okay.  Thanks to help from "lark" on IRC, I think we've chased this
one down.  It should be fixed in r18575 in trunk.  If anybody else can
build from source and try it out, that'd be great.
(The problem was that we had an internal data structure to represent
the union of ExcludeNodes and ExcludeExitNodes, but we weren't ever
updating it with country info from the geoip file.)

@_date: 2009-06-05 19:44:45
@_author: Nick Mathewson 
@_subject: unable to submit bug report 
Thank you so much for the stack traces!  I have found a bug that I
think might have caused this.  (It's a little hard to tell for sure,
because a bunch of functions got inlined.)  Can you try this patch
(also uploaded to flyspray)?
diff --git a/src/or/policies.c b/src/or/policies.c
index cb914d1..d55e86c 100644
--- a/src/or/policies.c
+++ b/src/or/policies.c
 -411,6 +411,7  load_policy_from_option(config_line_t *config,
smartlist_t **policy,
         memcpy(&newp, n, sizeof(newp));
         newp.prt_min = 1;
         newp.prt_max = 65535;
+        newp.is_canonical = 0;
         c = addr_policy_get_canonical_entry(&newp);
         SMARTLIST_REPLACE_CURRENT(*policy, n, c);
         addr_policy_free(n);
(Also, when we next switch bugtrackers, we should probably switch to
one with an email gateway that works.)

@_date: 2009-05-19 13:54:51
@_author: Nick Mathewson 
@_subject: A tor error message prior to crash 
I have a patch in the repository that might fix it.  If you can build
from source, please try out the latest maint-0.2.1 branch to see
whether the bug is gone for you.
(There might be some warning messages in the log that start with
"Bug".  If there are, please let me know.)

@_date: 2009-11-05 15:52:44
@_author: Nick Mathewson 
@_subject: TLS Man-In-The-Middle Vulnerability 
FWIW, this doesn't affect Tor.  The problem here is not renegotiation
per se; the problem is doing renegotiation, then acting as though data
sent _before_ the renegotiation were authenticated with the
rengotiated credentials.
The Tor protocol isn't vulnerable here because 1) it doesn't allow data
to be sent before the renegotiation step, and 2) it doesn't treat a
renegotiation as authenticating previously exchanged data (because
there isn't any).
Browser users, though, should watch out--especially if you use client
certificates for anything.

@_date: 2009-10-13 14:21:44
@_author: Nick Mathewson 
@_subject: Less OT: Here's a Solaris crypto acceleration branch to try. 
Since people are interested in Solaris crypto acceleration, I should
point out that there's an unfinished solaris-aes branch in my public
git repository[1].  (It's off an older version of 2.0.x, so you would
want to merge it into the latest master to try it out.[2])
The original code here was by Wyllys Ingersoll; I cleaned it up a bit
to be a bit closer to our house style.  It is supposed to take
advantage of the AES_CTR mode from Solaris's PKCS11 support.  Wyllys
said that his original patch gave him a 25x improvement for relay
payload encryption on a Sun Niagara 2 with AES_CTR from the n2cp
The branch needs more work if anybody wants to take a shot at it.
  1) It needs to detect at build time whether we actually have PKCS11
     support, and define the USE_PKCS11_FRAMEWORK macro if so.
  2) It needs to support using the aes_set_iv function to adjust the
     AES counter, or else hidden services will break.
  3) We actually need to try building it on a version of solaris with
     the right PKCS11 support, to make sure it still works after my
     cleanups.
  4) We need to actually try building it on a version of solaris
     *without* PKCS11 support, to make sure we didn't break those.
I haven't got a Solaris installation, so I'm not in a good position to
do any of these, but if somebody who knows Solaris wants to give it a
shot, that would be grand.
[1] git://git.torproject.org/~nickm/git/tor
[2] Here's some Git help.  To get a copy of the master branch with the
    solaris-aes branch merged in, you would do something like this,
    assuming you already have a checked-out version of the main Tor
    repository:
       git remote add nickm git://git.torproject.org/~nickm/git/tor
       git fetch nickm
       git branch solaris-aes-merged master
       git checkout solaris-aes-merged
       git merge nickm/solaris-aes
    This is no substitute for reading the Git tutorial, though.

@_date: 2009-10-13 15:53:54
@_author: Nick Mathewson 
@_subject: Less OT: Here's a Solaris crypto acceleration branch to try. 
Oh man, I can't type today.  It's off an older version of 0.2.2.x.
Sorry for my confusion.

@_date: 2009-09-23 03:38:45
@_author: Nick Mathewson 
@_subject: Random chaff [was: more work for Grobbages] 
The issue with padding isn't that it doesn't work at all, but that it
doesn't work well enough to do any good.  Last I checked, the state of
the art in low-volume padding could slow down correlation attacks by
10-50%, depending on how you're counting.
This sounds good until you think about how fast correlation attacks
actually are.  If a correlating attacker (one watching both ends of
the communication) needs only a second of traffic to link sender and
receiver, then forcing him to collect an extra half-second of traffic
doesn't actually help the user very much, assuming that the user
intends to use Tor for more than a second and a half.
What would need to change for padding to become useful? If it turns
out that correlation attacks are far more difficult than the research
community thinks, or if somebody comes up with a padding approach that
actually delays correlation enough[**], I think we should come back
to the question.
[*] You can do high-cost methods that defeat correlation[***] pretty
    easily: constant-rate traffic is one of them.  There's a FAQ
    entry about why constant-rate traffic probably won't work in
    the wild:
      [**] What's "enough"?  I'd say "the lifetime of a circuit," but I
      might be wrong.
[***] But you'd still need to worry about active attacks in this case.

@_date: 2010-01-14 21:49:33
@_author: Nick Mathewson 
@_subject: Failed to decode requested authority digest 
This looks like some kind of broken client to me.  Look at all those
%20s in the string: that looks like http encoding of a space (" ")
character, so somebody's program is requesting "14C131 27B6B5 585769
81349F E2A2AF E8A9C4" with the spaces HTTP-encoded.  Unless I'm
mistaken, the proper format is using + signs, not spaces.
It's also possible that they've got an HTTP proxy that is re-encoding
their request for some reason.
Either way, it's nothing to worry about on your side.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-15 03:07:33
@_author: Nick Mathewson 
@_subject: Failed to decode requested authority digest 
For this URL, dir-spec.txt specifies:
       Where F1, F2, etc. are authority identity fingerprints the client trusts=
  Servers will only return a consensus if more than half of the requested
  authorities have signed the document, otherwise a 404 error will be sent
  back.  The fingerprints can be shortened to a length of any multiple of
  two, using only the leftmost part of the encoded fingerprint.  Tor uses
  3 bytes (6 hex characters) of the fingerprint.
The last sentence should probably start "The Tor client uses..."
The plus signs have been required as long as I can remember, though I
agree that a more standards-friendly use of HTTP would accept any
equivalent URI-encoded string. I'd welcome a patch or two to handle
proper URI-encoding better, or alternatively a patch to dir-spec.txt
to be more explicit about anything at all.
Agreed.  The closest it comes is saying,
]      ]   where  is the fingerprint of the other authority's identity key.

@_date: 2010-01-16 01:12:27
@_author: Nick Mathewson 
@_subject: Latest router selection algorithm 
2010/1/10 ilter y?ksel :
The best document is still path-spec.txt, though proposals 160 and 161
may be of interest.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-18 14:28:52
@_author: Nick Mathewson 
@_subject: Memory usage on relays 
[...]
Tor links against openssl dynamically for me, at least.  Let us know
if there's some more magic we need to do in src/or/Makefile.am to make
it dynamically linke for others.
I'm not sure openssl builds shared libraries by default, though: could
that be the problem.

@_date: 2010-03-09 14:46:34
@_author: Nick Mathewson 
@_subject: tor 0.2.1.24 crashes on Sparc-Solaris10 
Can you get a stack trace?  That's usually the best way to start
debugging a crash.

@_date: 2011-08-30 20:45:50
@_author: Nick Mathewson 
@_subject: [tor-talk] tor-0.2.2.32 compilation failure 
Wow.  Your compiler doesn't like 'double d; printf("%lf", d);'  .
That's pretty... special.  :)
Attached are two more patches.  Let us know if they work?
(Also, if they don't work, try sending the output of "make -k" so that
we get to see all the errors at once, and not just one file at a

@_date: 2011-06-27 16:39:43
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.2.x will be stable soon; please try it out 
Hi, all!
If you have a chance, please try out Tor 0.2.2.29-beta release some
time soon!  It's going to be stable pretty soon, and if we're going to
find any more bugs in it, the best time to do so is now.
The next release will probably be an -rc (release candidate) release,
unless there are significant new bugs that we need to track down in
it.  At that point, unless more testing turns up bugs, we'll call it a
stable "0.2.2.x" for some appropriate x, and it will be the new stable
Tor release series.
If you run into any bugs, please open a ticket at trac.torproject.org.
many thanks,

@_date: 2011-06-29 11:01:26
@_author: Nick Mathewson 
@_subject: [tor-talk] embedding tor into apps? 
I think this is right.  Tor is really not designed to have anything
else running in the same process as it, so fork() then tor_main() is
your best bet.  In the future, if we change this architecture, it's
likely to be via a move in the opposite direction, with *more* process
isolation between the parts of Tor, not less.
If you really and truly must have everything running in the same
process, the next best option is to pretend that  it's a separate
process: launch tor_main() in its own thread, then never run any other
tor functions or alter other tor data structures: instead use a local
control port to communicate with the Tor thread group.
all the best,

@_date: 2011-06-29 11:26:06
@_author: Nick Mathewson 
@_subject: [tor-talk] TOR-Client bug?/wrong package size? 
Cells are 512 bytes.
Cells are sent over TLS, which adds its own message over head.
Because of the way that Tor's internal buffers work, the TLS
implemantation may decide to send any number (not necessarily integer)
of cells in a TLS record that it wants.
TLS  records are sent over TCP.  The TLS implementation delivers TLS
records to the kernel's TCP stack using the send() call [or write(),
or writev(), or WSASend(), depending on which network backend it's
using].  The TCP stack is then free to send these TLS records in as
many or as few TCP records as it wants.
So you shouldn't expect to see TCP packets that are an even multiple
of 512 bytes: the TLS and TCP implementations are both free to package
or split byte streams.

@_date: 2011-11-02 22:06:45
@_author: Nick Mathewson 
@_subject: [tor-talk] The Stop Online Piracy Act 
Hi. Usually I try to keep it technical, since that's where I get my
biggest multiplier for effort-to-results, so you don't usually see me
talking about politics.  But this stuff here is really important.  So
far, it's been one among several things driving up my blood pressure
and making me lose sleep -- but if it passes, it may well be problem
number one.
So, please don't do just _one_ of the above.  Please help the EFF,
Fight for the Future, and/or whatever other groups opposing this bill
you are comfortable with.  Learn what it involves, and why it's a
danger for free speech in the US. Sign petitions.  Get involved.  And
if you're a US person, please ALSO call your representatives.  I've
called mine, and I hope you will too.  Learn about the bill first, so
you have something cogent to say, and remember to be polite.
This one matters.
getting back to software soon I hope,

@_date: 2011-11-03 15:04:54
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.2.34 crashes 
Hi, Thomas!
This looks like you're using a Unix box, which makes stuff easier.
The best way to debug a crash is by getting a stack trace -- either
getting a core dump, or by running Tor under gdb.  That will tell us
exactly which part of the program is failing.
Just let us know if you need help doing that and you can't find good
instructions online.

@_date: 2011-11-08 10:29:09
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor and AES-NI acceleration , and Tor profiling 
Hmm.  On examination it looks like there might be some uses of
OpenSSL's AES_encrypt function left around in your profile.  Try
changing the beginning of Tor's aes.c so that the line that now says:
   USE_OPENSSL_EVP
now says
   USE_OPENSSL_EVP
Does that improve matters at all?

@_date: 2011-11-08 23:59:24
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor and AES-NI acceleration , and Tor profiling 
See trac issue 4442 for a fuller fix here, and trac issue 4443 for
another opportunity for making our CTR mode faster on x86 and x86_64

@_date: 2011-11-20 00:35:35
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor and AES-NI acceleration , and Tor profiling 
Curious whether you had a chance to try this.  From   the latest
profile, your biggest timesink is _x86_64_AES_encrypt_compact.  But
that's not the AESNI version.  I think that using EVP there would get
the right result, if I understand how engines work correctly.

@_date: 2011-11-30 10:04:45
@_author: Nick Mathewson 
@_subject: [tor-talk] segfault at 8 ip ... error 4 in tor 
I think somebody mentioned this on the list the other day.  What we really
need to make progress tracking this down is a stack trace (e.g., from
gdb).  If you need help generating one, just ask.

@_date: 2011-10-29 10:43:18
@_author: Nick Mathewson 
@_subject: [tor-talk] bug found on the Tor v0.2.3.6-alpha 
Thanks, Tim!
If you aren't on windows, and you're comfortable building from source, I'd
ask if you can try out the latest version of either the master branch or the
maint-0.2.2 branch.  I *think* we've got the known non-windows issues pretty
well squashed there, so more testing to try to discover more problems would
be great.

@_date: 2012-08-06 12:50:31
@_author: Nick Mathewson 
@_subject: [tor-talk] Strong anonymization in a fixed group of participants 
The system you describe is approximately a one-hop mix, with Tor layered in
front of the mix to prevent the mix (the leader in your design) from
learning who submitted which message.  So the security against learning
group membership will reduce to the security of Tor; the security against
the leader learning who sent what reduces to the security of Tor; and the
security against a third party learning who sent what reduces to breaking
Tor *and* breaking a one-hop mix.
(Incidentally, there's an extensive literature on how to build mixes: it
turns out that "delay a random interval" isn't optimal.)
To answer your original question though, it would help to know the threat
model!  Tor will provide anonymity in this case so long as no adversary has
compromised or controls enough of the network to observe a message as it
enters and exits.  But if an attacker sees the same message entering and
exiting the tor network, they can (probabilistically) match them based on
size and timing.  This doesn't give the attacker a win against your
protocol though (IIUC) unless they also defeat the leader's mixing.
Other systems to look into here will come from the general anonymous
communications literature. DC-nets are great for low-volume broadcast among
a small number of participants, if you don't care about performance or
DoS-robustness.  Or since what you're talking about already incorporates a
mix, you could look at other mix designs for ideas.  Have a look through
 if you haven't already.
Best wishes,

@_date: 2012-12-29 01:42:38
@_author: Nick Mathewson 
@_subject: [tor-talk] Servers might want to avoid 0.2.4.7-alpha: there's a 
Hi, folks!
There appears to be a crash bug[1] in 0.2.4.7-alpha's IPv6 code that
can get triggered on a server when a client sets the wrong set of IPv6
options.  No cause for major alarm: It doesn't appear to allow remote
code execution or anything -- but it *does* make servers segfault.  So
if you've got a server you don't want crashing, maybe you shouldn't
run 0.2.4.7-alpha on it.
Clients running 0.2.4.7-alpha are likely to be annoyed by the
log-message-spewing bug[2] that Mike's trying to track down.
If you want to track the 0.2.4.x series but you can't bear crashes,
you might want to stay at 0.2.4.6-alpha and wait for 0.2.4.8-alpha or
0.2.4.9-alpha.  Or if you're a dauntless soul who wants to try the fix
for the crash issue in [1] to see if it works (or if you're a bug
hipster who wants to experience all the new bugs before anybody else
has even heard of them), just run the master branch from git, version
51c2dd8f8954d5 or later.  Or if you hate unstable branches with a
burning passion, you might want to stick with 0.2.3.x until 0.2.4.x is
farther along on its development cycle.
Sorry for the inconvenience here.  Bugs are always annoying, even when
the release version says "alpha".  I hope everybody has a good new
[1] [2]

@_date: 2012-01-05 14:34:51
@_author: Nick Mathewson 
@_subject: [tor-talk] "Invalid Server Certificate" accessing 
Adam Langley reported a likely solution on IRC:
20:15 < agl> We've had a couple of reports of certificate errors with various
             torproject.org sites (i.e.
             20:16 < agl> the  cert is signed with SHA-256, which isn't
             supported by Windows XP nor Windows 2003
20:16 < agl> so, if you're hitting that, see
             20:28 < nickm> agl: Can we cut-and-paste your statements above to the mailing
               list?
20:31 < agl> nickm: sure
20:32 < agl> nickm: and if you get reports where the users aren't on WinXP or
             2003, please throw them at crbug.com (assuming that it's Chrome,
             of course.)

@_date: 2013-04-18 14:36:05
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor project creating a replacement for TrueCrypt? 
This is the first I've heard about it.
(So unless it's a random remark somebody made offhand about a project
they'd like to do someday, I'd guess it probably isn't true.)

@_date: 2013-04-19 21:40:29
@_author: Nick Mathewson 
@_subject: [tor-talk] PSA: watch out for trojans 
Hi, folks.
Somebody just stopped by a couple of the Tor IRC channels and linked
to something that was supposed to be the result of "redoing vadalia
[sic] in java."  Instead, it turned out to be (apparently[*]) an
updated variant of the Java trojan described in
I called the guy out within the first minutes after he posted, so I
*hope* that nobody actually ran the thing, but I thought it would be a
good idea to remind everybody:
Do not run random binaries from random people off the internet-- even
if those people say those binaries do something awesome.  They might
not do what the random people say they do.
Yes, you all know this, but it's a good idea to get reminded
periodically that there are people really trying to do this attack in
the wild, against members of this community like me and you.  The next
attempt may not be so transparent.
(And finally, if you actually *ARE* a software developer writing a
pure-Java version of Vidalia which for some reason you tried to
distribute anonymously as an obfuscated Jar using the same obfuscator
as an established Trojan... really, you should know better.)
[*] At least, it appears to use the same obfuscation technique as the
trojan described there.  Thanks to "ditzydoo" on IRC for picking at
the thing long enough to confirm.

@_date: 2013-06-18 16:26:25
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.4.14-alpha is out 
Hi, everybody!
Usually, Roger sends these announcements out, but he's away from the
internet this week, and I thought it was a good idea to get this one
out soon, given the discussion in the last thread on this list.  For
obvious reasons, it'll be signed with my GPG key, not Roger's.
I don't do releases too often, so it's possible I've messed up
building or uploading or publishing something.  I hope not, though!
Please let me know if there's anything I need to resolve.
It would be a great help if a bunch of people could test this one out
once it exists in your preferred package format: we're hoping to get
0.2.4.x into a stable status as soon as we can, and we're also
planning to backport a number of fixes from this release into a new
0.2.3.x release soon if they prove to be stable.  Testing helps us
backport fixes with confidence, and reach stability in a timely
Tor 0.2.4.14-alpha fixes a pair of client guard enumeration problems
present in 0.2.4.13-alpha.  It also includes all of the various fixes
present in 0.2.4.13-alpha; see the ChangeLog for full details there.
The source is up now at:
   There should be more packages uploaded once they're ready.
  o Major bugfixes:
    - When we have too much memory queued in circuits (according to a new
      MaxMemInCellQueues option), close the circuits consuming the most
      memory. This prevents us from running out of memory as a relay if
      circuits fill up faster than they can be drained. Fixes bug 9063;
      bugfix on the 54th commit of Tor. This bug is a further fix beyond
      bug 6252, whose fix was merged into 0.2.3.21-rc.
      This change also fixes an earlier approach taken in 0.2.4.13-alpha,
      where we tried to solve this issue simply by imposing an upper limit
      on the number of queued cells for a single circuit. That approach
      proved to be problematic, since there are ways to provoke clients to
      send a number of cells in excess of any such reasonable limit. Fixes
      bug 9072; bugfix on 0.2.4.13-alpha.
    - Limit hidden service descriptors to at most ten introduction
      points, to slow one kind of guard enumeration. Fixes bug 9002;
      bugfix on 0.1.1.11-alpha.

@_date: 2013-09-23 16:21:53
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor companies 
One of these is ours. If I understand correctly, we started it as a wholly
owned subsidiary of the nonprofit when we were applying for a grant that
required applicants to be small businesses -- and defined "small business"
in a way that excluded nonprofit corporations. They dropped the
requirement, though, so we just applied as the nonprofit instead.  To the
best of my knowledge, we haven't used the subsidiary for anything since
then: we're keeping it around in case we need it for something similar in
the future.
Andrew can chime in if there's more here, or if I've gotten something wrong.
Best wishes,

@_date: 2014-04-23 10:51:57
@_author: Nick Mathewson 
@_subject: [tor-talk] heartbleed: ETA for tor release(s) that blacklist 
My goal is to get out a new alpha with the blacklist this week, and an
0.2.4 release by the end of the month.
This is a goal; I don't know if I'm going to be able to make it, and I
can't make mpromises there.
If you like, it could be entirely reasonable to backport the code in
question; the relevant commits are:
best wishes,

@_date: 2014-04-23 13:03:03
@_author: Nick Mathewson 
@_subject: [tor-talk] heartbleed: ETA for tor release(s) that blacklist 
[...]
For future reference, don't just look at 024-backport -- that's for
tickets that are currently in 0.2.5 or later but which should (maybe!)
get backported to 0.2.4 after a fix.  Also look at the tickets in
milestone "Tor: 0.2.4.x-final": those include ones that were never
marked as backportable when they were in 0.2.5, but which, after
resolving them, somebody decided we should consider for backport
(It doesn't make a difference in this case, IMO, but it's something to
be aware of.)
It depends what you consider a "fix" versus a "feature", and what you
think is "important".
The only ones I'd consider to maybe meet your criteria are:
       -- those two will make clients significantly more resistant to using
bad cryptography at the TLS layer.
Also -- since you're asking for a solid confirmation here -- I need to
insert the disclaimer that this is only based on what I know about
today.  I might be forgetting something, and we might learn about
something tomorrow that would change all of this.  In other words,
it's a prediction, not a promise. ;)
best wishes,

@_date: 2014-12-31 13:27:53
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.6.2-alpha is now released! 
Hi, all!
The second alpha release for the 0.2.6 series has just been tagged and
uploaded. You can download the source code from the website right now.
Packages should become available some time over the next several days.
There's still more to come in the 0.2.6 series, but I'd like to get
one more alpha out in 2014. :)   You can read the changelog below to
see what's new.
happy new year,
    --  Nick
Changes in version 0.2.6.2-alpha - 2014-12-31
  Tor 0.2.6.2-alpha is the second alpha release in the 0.2.6.x series.
  It introduces a major new backend for deciding when to send cells on
  channels, which should lead down the road to big performance
  increases. It contains security and statistics features for better
  work on hidden services, and numerous bugfixes.
  This release contains many new unit tests, along with major
  performance improvements for running testing networks using Chutney.
  Thanks to a series of patches contributed by "teor", testing networks
  should now bootstrap in seconds, rather than minutes.
  o Major features (relay, infrastructure):
    - Complete revision of the code that relays use to decide which cell
      to send next. Formerly, we selected the best circuit to write on
      each channel, but we didn't select among channels in any
      sophisticated way. Now, we choose the best circuits globally from
      among those whose channels are ready to deliver traffic.
      This patch implements a new inter-cmux comparison API, a global
      high/low watermark mechanism and a global scheduler loop for
      transmission prioritization across all channels as well as among
      circuits on one channel. This schedule is currently tuned to
      (tolerantly) avoid making changes in network performance, but it
      should form the basis for major circuit performance increases in
      the future. Code by Andrea; tuning by Rob Jansen; implements
      ticket 9262.
  o Major features (hidden services):
    - Make HS port scanning more difficult by immediately closing the
      circuit when a user attempts to connect to a nonexistent port.
      Closes ticket 13667.
    - Add a HiddenServiceStatistics option that allows Tor relays to
      gather and publish statistics about the overall size and volume of
      hidden service usage. Specifically, when this option is turned on,
      an HSDir will publish an approximate number of hidden services
      that have published descriptors to it the past 24 hours. Also, if
      a relay has acted as a hidden service rendezvous point, it will
      publish the approximate amount of rendezvous cells it has relayed
      the past 24 hours. The statistics themselves are obfuscated so
      that the exact values cannot be derived. For more details see
      proposal 238, "Better hidden service stats from Tor relays". This
      feature is currently disabled by default. Implements feature 13192.
  o Major bugfixes (client, automap):
    - Repair automapping with IPv6 addresses. This automapping should
      have worked previously, but one piece of debugging code that we
      inserted to detect a regression actually caused the regression to
      manifest itself again. Fixes bug 13811 and bug 12831; bugfix on
      0.2.4.7-alpha. Diagnosed and fixed by Francisco Blas
      Izquierdo Riera.
  o Major bugfixes (hidden services):
    - When closing an introduction circuit that was opened in parallel
      with others, don't mark the introduction point as unreachable.
      Previously, the first successful connection to an introduction
      point would make the other introduction points get marked as
      having timed out. Fixes bug 13698; bugfix on 0.0.6rc2.
  o Directory authority changes:
    - Remove turtles as a directory authority.
    - Add longclaw as a new (v3) directory authority. This implements
      ticket 13296. This keeps the directory authority count at 9.
  o Major removed features:
    - Tor clients no longer support connecting to hidden services
      running on Tor 0.2.2.x and earlier; the Support022HiddenServices
      option has been removed. (There shouldn't be any hidden services
      running these versions on the network.) Closes ticket 7803.
  o Minor features (client):
    - Validate hostnames in SOCKS5 requests more strictly. If SafeSocks
      is enabled, reject requests with IP addresses as hostnames.
      Resolves ticket 13315.
  o Minor features (controller):
    - Add a "SIGNAL HEARTBEAT" controller command that tells Tor to
      write an unscheduled heartbeat message to the log. Implements
      feature 9503.
  o Minor features (geoip):
    - Update geoip and geoip6 to the November 15 2014 Maxmind GeoLite2
      Country database.
  o Minor features (hidden services):
    - When re-enabling the network, don't try to build introduction
      circuits until we have successfully built a circuit. This makes
      hidden services come up faster when the network is re-enabled.
      Patch from "akwizgran". Closes ticket 13447.
    - When we fail to a retrieve hidden service descriptor, send the
      controller an "HS_DESC FAILED" controller event. Implements
      feature 13212.
    - New HiddenServiceDirGroupReadable option to cause hidden service
      directories and hostname files to be created group-readable. Patch
      from "anon", David Stainton, and "meejah". Closes ticket 11291.
  o Minor features (systemd):
    - Where supported, when running with systemd, report successful
      startup to systemd. Part of ticket 11016. Patch by Michael Scherer.
    - When running with systemd, support systemd watchdog messages. Part
      of ticket 11016. Patch by Michael Scherer.
  o Minor features (transparent proxy):
    - Update the transparent proxy option checks to allow for both ipfw
      and pf on OS X. Closes ticket 14002.
    - Use the correct option when using IPv6 with transparent proxy
      support on Linux. Resolves 13808. Patch by Francisco Blas
      Izquierdo Riera.
  o Minor bugfixes (preventative security, C safety):
    - When reading a hexadecimal, base-32, or base-64 encoded value from
      a string, always overwrite the whole output buffer. This prevents
      some bugs where we would look at (but fortunately, not reveal)
      uninitialized memory on the stack. Fixes bug 14013; bugfix on all
      versions of Tor.
    - Clear all memory targetted by tor_addr_{to,from}_sockaddr(), not
      just the part that's used. This makes it harder for data leak bugs
      to occur in the event of other programming failures. Resolves
      ticket 14041.
  o Minor bugfixes (client, microdescriptors):
    - Use a full 256 bits of the SHA256 digest of a microdescriptor when
      computing which microdescriptors to download. This keeps us from
      erroneous download behavior if two microdescriptor digests ever
      have the same first 160 bits. Fixes part of bug 13399; bugfix
      on 0.2.3.1-alpha.
    - Reset a router's status if its microdescriptor digest changes,
      even if the first 160 bits remain the same. Fixes part of bug
      13399; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (compilation):
    - Silence clang warnings under --enable-expensive-hardening,
      including implicit truncation of 64 bit values to 32 bit, const
      char assignment to self, tautological compare, and additional
      parentheses around equality tests. Fixes bug 13577; bugfix
      on 0.2.5.4-alpha.
    - Fix a clang warning about checking whether an address in the
      middle of a structure is NULL. Fixes bug 14001; bugfix
      on 0.2.1.2-alpha.
  o Minor bugfixes (hidden services):
    - Correctly send a controller event when we find that a rendezvous
      circuit has finished. Fixes bug 13936; bugfix on 0.1.1.5-alpha.
    - Pre-check directory permissions for new hidden-services to avoid
      at least one case of "Bug: Acting on config options left us in a
      broken state. Dying." Fixes bug 13942; bugfix on 0.0.6pre1.
    - When adding a new hidden service (for example, via SETCONF), Tor
      no longer congratulates the user for running a relay. Fixes bug
      13941; bugfix on 0.2.6.1-alpha.
    - When fetching hidden service descriptors, we now check not only
      for whether we got the hidden service we had in mind, but also
      whether we got the particular descriptors we wanted. This prevents
      a class of inefficient but annoying DoS attacks by hidden service
      directories. Fixes bug 13214; bugfix on 0.2.1.6-alpha. Reported
      by "special".
  o Minor bugfixes (Linux seccomp2 sandbox):
    - Make transparent proxy support work along with the seccomp2
      sandbox. Fixes part of bug 13808; bugfix on 0.2.5.1-alpha. Patch
      by Francisco Blas Izquierdo Riera.
    - Fix a memory leak in tor-resolve when running with the sandbox
      enabled. Fixes bug 14050; bugfix on 0.2.5.9-rc.
  o Minor bugfixes (logging):
    - Downgrade warnings about RSA signature failures to info log level.
      Emit a warning when an extra info document is found incompatible
      with a corresponding router descriptor. Fixes bug 9812; bugfix
      on 0.0.6rc3.
    - Make connection_ap_handshake_attach_circuit() log the circuit ID
      correctly. Fixes bug 13701; bugfix on 0.0.6.
  o Minor bugfixes (misc):
    - Stop allowing invalid address patterns like "*/24" that contain
      both a wildcard address and a bit prefix length. This affects all
      our address-range parsing code. Fixes bug 7484; bugfix
      on 0.0.2pre14.
  o Minor bugfixes (testing networks, fast startup):
    - Allow Tor to build circuits using a consensus with no exits. If
      the consensus has no exits (typical of a bootstrapping test
      network), allow Tor to build circuits once enough descriptors have
      been downloaded. This assists in bootstrapping a testing Tor
      network. Fixes bug 13718; bugfix on 0.2.4.10-alpha. Patch
      by "teor".
    - When V3AuthVotingInterval is low, give a lower If-Modified-Since
      header to directory servers. This allows us to obtain consensuses
      promptly when the consensus interval is very short. This assists
      in bootstrapping a testing Tor network. Fixes parts of bugs 13718
      and 13963; bugfix on 0.2.0.3-alpha. Patch by "teor".
    - Stop assuming that private addresses are local when checking
      reachability in a TestingTorNetwork. Instead, when testing, assume
      all OR connections are remote. (This is necessary due to many test
      scenarios running all relays on localhost.) This assists in
      bootstrapping a testing Tor network. Fixes bug 13924; bugfix on
      0.1.0.1-rc. Patch by "teor".
    - Avoid building exit circuits from a consensus with no exits. Now
      thanks to our fix for 13718, we accept a no-exit network as not
      wholly lost, but we need to remember not to try to build exit
      circuits on it. Closes ticket 13814; patch by "teor".
    - Stop requiring exits to have non-zero bandwithcapacity in a
      TestingTorNetwork. Instead, when TestingMinExitFlagThreshold is 0,
      ignore exit bandwidthcapacity. This assists in bootstrapping a
      testing Tor network. Fixes parts of bugs 13718 and 13839; bugfix
      on 0.2.0.3-alpha. Patch by "teor".
    - Add "internal" to some bootstrap statuses when no exits are
      available. If the consensus does not contain Exits, Tor will only
      build internal circuits. In this case, relevant statuses will
      contain the word "internal" as indicated in the Tor control-
      spec.txt. When bootstrap completes, Tor will be ready to build internal
      circuits.  If a future consensus contains Exits, exit
      circuits may become available. Fixes part of bug 13718; bugfix on
      0.2.4.10-alpha. Patch by "teor".
    - Decrease minimum consensus interval to 10 seconds when
      TestingTorNetwork is set, or 5 seconds for the first consensus.
      Fix assumptions throughout the code that assume larger intervals.
      Fixes bugs 13718 and 13823; bugfix on 0.2.0.3-alpha.
      Patch by "teor".
    - Avoid excluding guards from path building in minimal test
      networks, when we're in a test network and excluding guards would
      exclude all relays. This typically occurs in incredibly small tor
      networks, and those using "TestingAuthVoteGuard *".
      Fixes part of bug 13718; bugfix on 0.1.1.11-alpha. Patch
      by "teor".
  o Code simplification and refactoring:
    - Stop using can_complete_circuits as a global variable; access it
      with a function instead.
    - Avoid using operators directly as macro arguments: this lets us
      apply coccinelle transformations to our codebase more directly.
      Closes ticket 13172.
    - Combine the functions used to parse ClientTransportPlugin and
      ServerTransportPlugin into a single function. Closes ticket 6456.
    - Add inline functions and convenience macros for inspecting
      channel state. Refactor the
      code to use convenience macros instead of checking channel state
      directly. Fixes issue 7356.
    - Document all members of was_router_added_t and rename
      ROUTER_WAS_NOT_NEW to ROUTER_IS_ALREADY_KNOWN to make it less
      confusable with ROUTER_WAS_TOO_OLD. Fixes issue 13644.
    - In connection_exit_begin_conn(), use END_CIRC_REASON_TORPROTOCOL
      constant instead of hardcoded value. Fixes issue 13840.
    - Refactor our generic strmap and digestmap types into a single
      implementation, so that we can add a new digest256map
      type trivially.
  o Documentation:
    - Document the bridge-authority-only 'networkstatus-bridges' file.
      Closes ticket 13713; patch from "tom".
    - Fix typo in PredictedPortsRelevanceTime option description in
      manpage. Resolves issue 13707.
    - Stop suggesting that users specify relays by nickname: it isn't a
      good idea. Also, properly cross-reference how to specify relays in
      all parts of manual documenting options that take a list of relays.
      Closes ticket 13381.
    - Clarify the HiddenServiceDir option description in manpage to make it
      clear that relative paths are taken with respect to the current
      working directory. Also clarify that this behavior
      is not guaranteed to remain indefinitely. Fixes issue 13913.
  o Testing:
    - New tests for many parts of channel, relay, and circuitmux
      functionality. Code by Andrea; part of 9262.
    - New tests for parse_transport_line(). Part of ticket 6456.
    - In the unit tests, use chgrp() to change the group of the unit
      test temporary directory to the current user, so that the sticky
      bit doesn't interfere with tests that check directory groups.
      Closes 13678.
    - Add unit tests for resolve_my_addr(). Part of ticket 12376; patch
      by 'rl1987'.

@_date: 2014-06-20 10:15:16
@_author: Nick Mathewson 
@_subject: [tor-talk] Reminder: Tor 0.2.2 and earlier are deprecated and will 
Hi, all!
This is a reminder that Tor 0.2.2 has been deprecated for quite a
while now: Tor 0.2.2.x servers are no longer listed on the Tor
network, and haven't been for a while.  With the upcoming 0.2.6.x
series, we will begin dropping support for some of the older protocol
features that 0.2.2.x clients and servers would use.
In particular, if for some reason you are running a hidden service on
0.2.2.x, you should upgrade.  Clients are likely going to stop
supporting them some time soon.

@_date: 2014-03-22 23:48:28
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.5.3-alpha is released. 
Changes in version 0.2.5.3-alpha - 2014-03-23
  Tor 0.2.5.3-alpha includes all the fixes from 0.2.4.21. It contains
  two new anti-DoS features for Tor relays, resolves a bug that kept
  SOCKS5 support for IPv6 from working, fixes several annoying usability
  issues for bridge users, and removes more old code for unused
  directory formats.
  The Tor 0.2.5.x release series is now in patch-freeze: no feature
  patches not already written will be considered for inclusion in 0.2.5.x.
  The source is ready today; packages should be ready in the next several days.
  (I'm trying to take some load off of Roger's shoulders by doing
releases myself.  This means that the signatures on the release are be
made with my PGP key, not Roger's.  Please don't freak out.)
    o Major features (relay security, DoS-resistance):
    - When deciding whether we have run out of memory and we need to
      close circuits, also consider memory allocated in buffers for
      streams attached to each circuit.
      This change, which extends an anti-DoS feature introduced in
      0.2.4.13-alpha and improved in 0.2.4.14-alpha, lets Tor exit relays
      better resist more memory-based DoS attacks than before. Since the
      MaxMemInCellQueues option now applies to all queues, it is renamed
      to MaxMemInQueues. This feature fixes bug 10169.
    - Avoid hash-flooding denial-of-service attacks by using the secure
      SipHash-2-4 hash function for our hashtables. Without this
      feature, an attacker could degrade performance of a targeted
      client or server by flooding their data structures with a large
      number of entries to be stored at the same hash table position,
      thereby slowing down the Tor instance. With this feature, hash
      table positions are derived from a randomized cryptographic key,
      and an attacker cannot predict which entries will collide. Closes
      ticket 4900.
    - Decrease the lower limit of MaxMemInQueues to 256 MBytes (but leave
      the default at 8GBytes), to better support Raspberry Pi users. Fixes
      bug 9686; bugfix on 0.2.4.14-alpha.
  o Minor features (bridges, pluggable transports):
    - Bridges now write the SHA1 digest of their identity key
      fingerprint (that is, a hash of a hash of their public key) to
      notice-level logs, and to a new hashed-fingerprint file. This
      information will help bridge operators look up their bridge in
      Globe and similar tools. Resolves ticket 10884.
    - Improve the message that Tor displays when running as a bridge
      using pluggable transports without an Extended ORPort listener.
      Also, log the message in the log file too. Resolves ticket 11043.
  o Minor features (other):
    - Add a new option, PredictedPortsRelevanceTime, to control how long
      after having received a request to connect to a given port Tor
      will try to keep circuits ready in anticipation of future requests
      for that port. Patch from "unixninja92"; implements ticket 9176.
    - Generate a warning if any ports are listed in the SocksPolicy,
      DirPolicy, AuthDirReject, AuthDirInvalid, AuthDirBadDir, or
      AuthDirBadExit options. (These options only support address
      ranges.) Fixes part of ticket 11108.
    - Update geoip and geoip6 to the February 7 2014 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (new since 0.2.5.2-alpha, also in 0.2.4.21):
    - Build without warnings under clang 3.4. (We have some macros that
      define static functions only some of which will get used later in
      the module. Starting with clang 3.4, these give a warning unless the
      unused attribute is set on them.) Resolves ticket 10904.
    - Fix build warnings about missing "a2x" comment when building the
      manpages from scratch on OpenBSD; OpenBSD calls it "a2x.py".
      Fixes bug 10929; bugfix on 0.2.2.9-alpha. Patch from Dana Koch.
  o Minor bugfixes (client):
    - Improve the log message when we can't connect to a hidden service
      because all of the hidden service directory nodes hosting its
      descriptor are excluded. Improves on our fix for bug 10722, which
      was a bugfix on 0.2.0.10-alpha.
    - Raise a control port warning when we fail to connect to all of
      our bridges. Previously, we didn't inform the controller, and
      the bootstrap process would stall. Fixes bug 11069; bugfix on
      0.2.1.2-alpha.
    - Exit immediately when a process-owning controller exits.
      Previously, tor relays would wait for a little while after their
      controller exited, as if they had gotten an INT signal -- but this
      was problematic, since there was no feedback for the user. To do a
      clean shutdown, controllers should send an INT signal and give Tor
      a chance to clean up. Fixes bug 10449; bugfix on 0.2.2.28-beta.
    - Stop attempting to connect to bridges before our pluggable
      transports are configured (harmless but resulted in some erroneous
      log messages). Fixes bug 11156; bugfix on 0.2.3.2-alpha.
    - Fix connections to IPv6 addresses over SOCKS5. Previously, we were
      generating incorrect SOCKS5 responses, and confusing client
      applications. Fixes bug 10987; bugfix on 0.2.4.7-alpha.
  o Minor bugfixes (relays and bridges):
    - Avoid crashing on a malformed resolv.conf file when running a
      relay using Libevent 1. Fixes bug 8788; bugfix on 0.1.1.23.
    - Non-exit relays no longer launch mock DNS requests to check for
      DNS hijacking. This has been unnecessary since 0.2.1.7-alpha, when
      non-exit relays stopped servicing DNS requests. Fixes bug 965;
      bugfix on 0.2.1.7-alpha. Patch from Matt Pagan.
    - Bridges now report complete directory request statistics. Related
      to bug 5824; bugfix on 0.2.2.1-alpha.
    - Bridges now never collect statistics that were designed for
      relays. Fixes bug 5824; bugfix on 0.2.3.8-alpha.
    - Stop giving annoying warning messages when we decide not to launch
      a pluggable transport proxy that we don't need (because there are
      no bridges configured to use it). Resolves ticket 5018; bugfix
      on 0.2.5.2-alpha.
    - Give the correct URL in the warning message when trying to run a
      relay on an ancient version of Windows. Fixes bug 9393.
  o Minor bugfixes (backtrace support):
    - Support automatic backtraces on more platforms by using the
      "-fasynchronous-unwind-tables" compiler option. This option is
      needed for platforms like 32-bit Intel where "-fomit-frame-pointer"
      is on by default and table generation is not. This doesn't yet
      add Windows support; only Linux, OSX, and some BSDs are affected.
      Reported by 'cypherpunks'; fixes bug 11047; bugfix on 0.2.5.2-alpha.
    - Avoid strange behavior if two threads hit failed assertions at the
      same time and both try to log backtraces at once. (Previously, if
      this had happened, both threads would have stored their intermediate
      results in the same buffer, and generated junk outputs.) Reported by
      "cypherpunks". Fixes bug 11048; bugfix on 0.2.5.2-alpha.
    - Fix a compiler warning in format_number_sigsafe(). Bugfix on
      0.2.5.2-alpha; patch from Nick Hopper.
  o Minor bugfixes (unit tests):
    - Fix a small bug in the unit tests that might have made the tests
      call 'chmod' with an uninitialized bitmask. Fixes bug 10928;
      bugfix on 0.2.5.1-alpha. Patch from Dana Koch.
  o Removed code:
    - Remove all remaining code related to version-0 hidden service
      descriptors: they have not been in use since 0.2.2.1-alpha. Fixes
      the rest of bug 10841.
  o Documentation:
    - Document in the manpage that "KBytes" may also be written as
      "kilobytes" or "KB", that "Kbits" may also be written as
      "kilobits", and so forth. Closes ticket 9222.
    - Document that the ClientOnly config option overrides ORPort.
      Our old explanation made ClientOnly sound as though it did
      nothing at all. Resolves bug 9059.
    - Explain that SocksPolicy, DirPolicy, and similar options don't
      take port arguments. Fixes the other part of ticket 11108.
    - Fix a comment about the rend_server_descriptor_t.protocols field
      to more accurately describe its range. Also, make that field
      unsigned, to more accurately reflect its usage. Fixes bug 9099;
      bugfix on 0.2.1.5-alpha.
    - Fix the manpage's description of HiddenServiceAuthorizeClient:
      the maximum client name length is 16, not 19. Fixes bug 11118;
      bugfix on 0.2.1.6-alpha.
  o Code simplifications and refactoring:
    - Get rid of router->address, since in all cases it was just the
      string representation of router->addr. Resolves ticket 5528.
  o Test infrastructure:
    - Update to the latest version of tinytest.
    - Improve the tinytest implementation of string operation tests so
      that comparisons with NULL strings no longer crash the tests; they
      now just fail, normally. Fixes bug 9004; bugfix on 0.2.2.4-alpha.

@_date: 2014-10-14 22:15:26
@_author: Nick Mathewson 
@_subject: [tor-talk] New SSLv3 attack: Turn off SSLv3 in your TorBrowser 
Hi!  It's a new month, so that means there's a new attack on TLS.
This time, the attack is that many clients, when they find a server
that doesn't support TLS, will downgrade to the ancient SSLv3.  And
SSLv3 is subject to a new padding oracle attack.
There is a readable summary of the issue at
 .
Tor itself is not affected: all released versions for a long time have
shipped with TLSv1 enabled, and we have never had a fallback mechanism
to SSLv3. Furthermore, Tor does not send the same secret encrypted in
the same way in multiple connection attempts, so even if you could
make Tor fall back to SSLv3, a padding oracle attack probably wouldn't
help very much.
TorBrowser, on the other hand, does have the same default fallback
mechanisms as Firefox.  I expect and hope the TorBrowser team will be
releasing a new version soon with SSLv3 enabled.  But in the meantime,
I think you can disable SSLv3 yourself by changing the value of the
"security.tls.version.min" preference to 1.
To do that:
1.  enter "about:config" in the URL bar.
2. Then you click "I'll be careful, I promise".
3. Then enter "security.tls.version.min" in the preference "search"
field underneath the URL bar.  (Not the search box next to the URL
4. You should see an entry that says "security.tls.version.min" under
"Preference Name".  Double-click on it, then enter the value "1" and
click okay.
You should now see that the value of "security.tls.version.min" is set to one.
(Note that I am not a Firefox developer or a TorBrowser developer: if
you're cautious, you might want to wait until one of them says
something here before you try this workaround.)
Obviously, this isn't a convenient way to do this; if you are
uncertain of your ability to do so, waiting for an upgrade might be a
good move.  In the meantime, if you have serious security requirements
and you cannot disable SSLv3, it might be a good idea to avoid using
the Internet for a week or two while this all shakes out.
best wishes to other residents of interesting times,

@_date: 2014-10-20 15:16:02
@_author: Nick Mathewson 
@_subject: [tor-talk] ANN: Tor-0.2.5.9-rc is released; packages to follow 
Hi, all!
We've almost got the Tor 0.2.5 release series done.  This morning I
released Tor 0.2.5.9-rc, which I hope will be the final release
Packages are not built yet, but will follow soon.
You can download the source from the usual places, including
 .
The changelog is as follows:
Changes in version 0.2.5.9-rc - 2014-10-20
  Tor 0.2.5.9-rc is the third release candidate for the Tor 0.2.5.x
  series. It disables SSL3 in response to the recent "POODLE" attack
  (even though POODLE does not affect Tor). It also works around a crash
  bug caused by some operating systems' response to the "POODLE" attack
  (which does affect Tor). It also contains a few miscellaneous fixes.
  o Major security fixes:
    - Disable support for SSLv3. All versions of OpenSSL in use with Tor
      today support TLS 1.0 or later, so we can safely turn off support
      for this old (and insecure) protocol. Fixes bug 13426.
  o Major bugfixes (openssl bug workaround):
    - Avoid crashing when using OpenSSL version 0.9.8zc, 1.0.0o, or
      1.0.1j, built with the 'no-ssl3' configuration option. Fixes bug
      13471. This is a workaround for an OpenSSL bug.
  o Minor bugfixes:
    - Disable the sandbox name resolver cache when running tor-resolve:
      tor-resolve doesn't use the sandbox code, and turning it on was
      breaking attempts to do tor-resolve on a non-default server on
      Linux. Fixes bug 13295; bugfix on 0.2.5.3-alpha.
  o Compilation fixes:
    - Build and run correctly on systems like OpenBSD-current that have
      patched OpenSSL to remove get_cipher_by_char and/or its
      implementations. Fixes issue 13325.
  o Downgraded warnings:
    - Downgrade the severity of the 'unexpected sendme cell from client'
      from 'warn' to 'protocol warning'. Closes ticket 8093.

@_date: 2014-10-20 22:43:31
@_author: Nick Mathewson 
@_subject: [tor-talk] Fwd: Advisory: remote DoS when using Tor with recent 
Forwarded from the tor-relays mailing list.
---------- Forwarded message ----------
Hello, relay operators!
There's one important bugfix in the 0.2.5.9-rc release that relay
operators should know about. If you have a version of OpenSSL that
came out last week (like 1.0.1j, 1.0.0, ) and if your version of
openssl is built with the "no-ssl3" flag, then it's possible to crash
your Tor relay remotely if you don't upgrade to 0.2.5.9-rc or to
0.2.4.25 (when that's out).
This appears to be an OpenSSL bug.  The Tor releases in question
contain a workaround for it.
To tell if your version of openssl was built with 'no-ssl3': run
"openssl s_client -ssl3 -connect   If it gives
you an output beginning with something like:
140632971298688:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3
alert handshake failure:s3_pkt.c:1257:SSL alert number 40
140632971298688:error:1409E0E5:SSL routines:SSL3_WRITE_BYTES:ssl
handshake failure:s3_pkt.c:596:
then you're fine and you don't need to upgrade Tor on your relay.  But if it
says something that starts like:
unknown option -ssl3
usage: s_client args
then you need to upgrade your Tor.
=== Some questions and answers:
Q: Does this affect clients?
A: No.  Only relays.
Q: Does this affect me if I'm running a version of OpenSSL other than
1.0.1j, 1.0.0o, or 0.9.8zc?
A: No. Only those versions.
Q: Does this affect me if I'm running a version of OpenSSL configured
without the "no-ssl3" option?
A: No. Only versions that were built with the "no-ssl3" option are affected.
Q: Does the openssl team know?
A: Yes. Have a look at this thread.
 .  Also, before
I saw that thread, I informed them the other day.
Q: Does this affect Tor packages?
A: I don't think that we shipped any packages where we used the
"no-ssl3" flag to diable ssl3.  So only if you're using OpenSSL from
another source (say, your operating system) will you be affected.
Q: What can I do to remediate this problem?
A: You can upgrade to the most recent Tor, or you can use a version of
OpenSSL built without the "no-ssl3" flag.  Downgrading your OpenSSL is
not recommended.
Q: What is the potential impact of this bug?
A: If a relay is affected by this bug, anybody can make the relay exit
remotely. It does not enable any data leaks or remote code execution.
Still, the ability to selectively disable relays might enable a
sophisticated attacker to do some kinds of traffic analysis more
efficiently.  So, fix your relay if it's affected.
Q: Should we run in circles and freak out?
A: Not this time. We should just make sure we fix affected relays.
Q: Hey, Nick, you didn't explain this properly!
A: Please send a follow-up message that explains it better. :)
best wishes,

@_date: 2014-10-25 13:20:43
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.5.10 (new stable) is released 
Hi, all!
I just sent a release announcement to the tor-announce mailing list.
If you're not on that mailing list, you should subscribe; it is very
Synopsis: There is a new stable out.  Some packages are up-to-date,
more packages should be up-to-date over the next week.  Usually I
don't announce a stable till there are packages, but people have been
asking me about this one, and I'd rather have an official release
announcement than a series of weird rumors.

@_date: 2014-10-30 10:27:55
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.6.1-alpha is now released! 
Hi, all!
The first alpha release for the 0.2.6 series has just been tagged and
uploaded.  Packages should become available some some operating
systems over the next several days; and I hope I didn't miss the
cutoff to get this into the TBB alpha.
There's a lot more to come in the 0.2.6 series, but we'd accumulated
enough changes that a release made sense.
best wishes,
     -- Nick
Changes in version 0.2.6.1-alpha - 2014-10-30
  Tor 0.2.6.1-alpha is the first release in the Tor 0.2.6.x series. It
  includes numerous code cleanups and new tests, and fixes a large
  number of annoying bugs. Out-of-memory conditions are handled better
  than in 0.2.5, pluggable transports have improved proxy support, and
  clients now use optimistic data for contacting hidden services. Also,
  we are now more robust to changes in what we consider a parseable
  directory object, so that tightening restrictions does not have a risk
  of introducing infinite download loops.
  This is the first alpha release in a new series, so expect there to be
  bugs. Users who would rather test out a more stable branch should stay
  with 0.2.5.x for now.
  o New compiler and system requirements:
    - Tor 0.2.6.x requires that your compiler support more of the C99
      language standard than before. The 'configure' script now detects
      whether your compiler supports C99 mid-block declarations and
      designated initializers. If it does not, Tor will not compile.
      We may revisit this requirement if it turns out that a significant
      number of people need to build Tor with compilers that don't
      bother implementing a 15-year-old standard. Closes ticket 13233.
    - Tor no longer supports systems without threading support. When we
      began working on Tor, there were several systems that didn't have
      threads, or where the thread support wasn't able to run the
      threads of a single process on multiple CPUs. That no longer
      holds: every system where Tor needs to run well now has threading
      support. Resolves ticket 12439.
  o Removed platform support:
    - We no longer include special code to build on Windows CE; as far
      as we know, nobody has used Tor on Windows CE in a very long time.
      Closes ticket 11446.
  o Major features (bridges):
    - Expose the outgoing upstream HTTP/SOCKS proxy to pluggable
      transports if they are configured via the "TOR_PT_PROXY"
      environment variable. Implements proposal 232. Resolves
      ticket 8402.
  o Major features (client performance, hidden services):
    - Allow clients to use optimistic data when connecting to a hidden
      service, which should remove a round-trip from hidden service
      initialization. See proposal 181 for details. Implements
      ticket 13211.
  o Major features (directory system):
    - Upon receiving an unparseable directory object, if its digest
      matches what we expected, then don't try to download it again.
      Previously, when we got a descriptor we didn't like, we would keep
      trying to download it over and over. Closes ticket 11243.
  o Major features (sample torrc):
    - Add a new, infrequently-changed "torrc.minimal". This file is
      similar to torrc.sample, but it will change as infrequently as
      possible, for the benefit of users whose systems prompt them for
      intervention whenever a default configuration file is changed.
      Making this change allows us to update torrc.sample to be a more
      generally useful "sample torrc".
  o Major bugfixes (directory authorities):
    - Do not assign the HSDir flag to relays if they are not Valid, or
      currently hibernating. Fixes  Bugfix on tor-0.2.0.10-alpha
  o Major bugfixes (directory bandwidth performance):
    - Don't flush the zlib buffer aggressively when compressing
      directory information for clients. This should save about 7% of
      the bandwidth currently used for compressed descriptors and
      microdescriptors. Fixes bug 11787; bugfix on 0.1.1.23.
  o Minor features (security, memory wiping):
    - Ensure we securely wipe keys from memory after
      crypto_digest_get_digest and init_curve25519_keypair_from_file
      have finished using them. Resolves ticket 13477.
  o Minor features (security, out-of-memory handling):
    - When handling an out-of-memory condition, allocate less memory for
      temporary data structures. Fixes issue 10115.
    - When handling an out-of-memory condition, consider more types of
      buffers, including those on directory connections, and zlib
      buffers. Resolves ticket 11792.
  o Minor features:
    - When identity keypair is generated for first time, log a
      congratulatory message that links to the new relay lifecycle
      document. Implements feature 10427.
  o Minor features (client):
    - Clients are now willing to send optimistic data (before they
      receive a 'connected' cell) to relays of any version. (Relays
      without support for optimistic data are no longer supported on the
      Tor network.) Resolves ticket 13153.
  o Minor features (directory authorities):
    - Don't list relays with a bandwidth estimate of 0 in the consensus.
      Implements a feature proposed during discussion of bug 13000.
    - In tor-gencert, report an error if the user provides the same
      argument more than once.
    - If a directory authority can't find a best consensus method in the
      votes that it holds, it now falls back to its favorite consensus
      method. Previously, it fell back to method 1. Neither of these is
      likely to get enough signatures, but "fall back to favorite"
      doesn't require us to maintain support an obsolete consensus
      method. Implements part of proposal 215.
  o Minor features (logging):
    - On Unix-like systems, you can now use named pipes as the target of
      the Log option, and other options that try to append to files.
      Closes ticket 12061. Patch from "carlo von lynX".
    - When opening a log file at startup, send it every log message that
      we generated between startup and opening it. Previously, log
      messages that were generated before opening the log file were only
      logged to stdout. Closes ticket 6938.
    - Add a TruncateLogFile option to overwrite logs instead of
      appending to them. Closes ticket   o Minor features (portability, Solaris):
    - Threads are no longer disabled by default on Solaris; we believe
      that the versions of Solaris with broken threading support are all
      obsolete by now. Resolves ticket 9495.
  o Minor features (relay):
    - Re-check our address after we detect a changed IP address from
      getsockname(). This ensures that the controller command "GETINFO
      address" will report the correct value. Resolves ticket 11582.
      Patch from "ra".
    - A new AccountingRule option lets Relays set whether they'd like
      AccountingMax to be applied separately to inbound and outbound
      traffic, or applied to the sum of inbound and outbound traffic.
      Resolves ticket 961. Patch by "chobe".
  o Minor features (testing networks):
    - Add the TestingDirAuthVoteExit option, which lists nodes to assign
      the "Exit" flag regardless of their uptime, bandwidth, or exit
      policy. TestingTorNetwork must be set for this option to have any
      effect. Previously, authorities would take up to 35 minutes to
      give nodes the Exit flag in a test network. Partially implements
      ticket 13161.
  o Minor features (validation):
    - Check all date/time values passed to tor_timegm and
      parse_rfc1123_time for validity, taking leap years into account.
      Improves HTTP header validation. Implemented with bug 13476.
    - In correct_tm(), limit the range of values returned by system
      localtime(_r) and gmtime(_r) to be between the years 1 and 8099.
      This means we don't have to deal with negative or too large dates,
      even if a clock is wrong. Otherwise we might fail to read a file
      written by us which includes such a date. Fixes bug 13476.
  o Minor bugfixes (bridge clients):
    - When configured to use a bridge without an identity digest (not
      recommended), avoid launching an extra channel to it when
      bootstrapping. Fixes bug 7733; bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (bridges):
    - When DisableNetwork is set, do not launch pluggable transport
      plugins, and if any are running, terminate them. Fixes bug 13213;
      bugfix on 0.2.3.6-alpha.
  o Minor bugfixes (C correctness):
    - Fix several instances of possible integer overflow/underflow/NaN.
      Fixes bug 13104; bugfix on 0.2.3.1-alpha and later. Patches
      from "teor".
    - In circuit_build_times_calculate_timeout() in circuitstats.c,
      avoid dividing by zero in the pareto calculations. This traps
      under clang's "undefined-trap" sanitizer. Fixes bug 13290; bugfix
      on tor-0.2.2.2-alpha.
    - Fix an integer overflow in format_time_interval(). Fixes bug
      13393; bugfix on 0.2.0.10-alpha.
    - Set the correct day of year value when the system's localtime(_r)
      or gmtime(_r) functions fail to set struct tm. Not externally
      visible. Fixes bug 13476; bugfix on 0.0.2pre14.
    - Avoid unlikely signed integer overflow in tor_timegm on systems
      with 32-bit time_t. Fixes bug 13476; bugfix on 0.0.2pre14.
  o Minor bugfixes (client):
    - Fix smartlist_choose_node_by_bandwidth() so that relays with the
      BadExit flag are not considered worthy candidates. Fixes bug
      13066; bugfix on 0.1.2.3-alpha.
    - Use the consensus schedule for downloading consensuses, and not
      the generic schedule. Fixes bug 11679; bugfix on 0.2.2.6-alpha.
    - Handle unsupported or malformed SOCKS5 requests properly by
      responding with the appropriate error message before closing the
      connection. Fixes bugs 12971 and 13314; bugfix on 0.0.2pre13.
  o Minor bugfixes (client, torrc):
    - Stop modifying the value of our DirReqStatistics torrc option just
      because we're not a bridge or relay. This bug was causing Tor
      Browser users to write "DirReqStatistics 0" in their torrc files
      as if they had chosen to change the config. Fixes bug 4244; bugfix
      on 0.2.3.1-alpha.
    - When GeoIPExcludeUnkonwn is enabled, do not incorrectly decide
      that our options have changed every time we SIGHUP. Fixes bug
      9801; bugfix on 0.2.4.10-alpha. Patch from "qwerty1".
  o Minor bugfixes (controller):
    - Return an error when the second or later arguments of the
      "setevents" controller command are invalid events. Previously we
      would return success while silently skipping invalid events. Fixes
      bug 13205; bugfix on 0.2.3.2-alpha. Reported by "fpxnns".
  o Minor bugfixes (directory system):
    - Always believe that v3 directory authorities serve extra-info
      documents, whether they advertise "caches-extra-info" or not.
      Fixes part of bug 11683; bugfix on 0.2.0.1-alpha.
    - When running as a v3 directory authority, advertise that you serve
      extra-info documents so that clients who want them can find them
      from you too. Fixes part of bug 11683; bugfix on 0.2.0.1-alpha.
    - Check the BRIDGE_DIRINFO flag bitwise rather than using equality.
      Previously, directories offering BRIDGE_DIRINFO and some other
      flag (i.e. microdescriptors or extrainfo) would be ignored when
      looking for bridges. Partially fixes bug 13163; bugfix
      on 0.2.0.7-alpha.
  o Minor bugfixes (networking):
    - Check for orconns and use connection_or_close_for_error() rather
      than connection_mark_for_close() directly in the getsockopt()
      failure case of connection_handle_write_impl(). Fixes bug 11302;
      bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (relay):
    - When generating our family list, remove spaces from around the
      entries. Fixes bug 12728; bugfix on 0.2.1.7-alpha.
    - If our previous bandwidth estimate was 0 bytes, allow publishing a
      new relay descriptor immediately. Fixes bug 13000; bugfix
      on 0.1.1.6-alpha.
  o Minor bugfixes (testing networks):
    - Fix TestingDirAuthVoteGuard to properly give out Guard flags in a
      testing network. Fixes bug 13064; bugfix on 0.2.5.2-alpha.
    - Stop using the default authorities in networks which provide both
      AlternateDirAuthority and AlternateBridgeAuthority. Partially
      fixes bug 13163; bugfix on 0.2.0.13-alpha.
  o Minor bugfixes (testing):
    - Stop spawn test failures due to a race condition between the
      SIGCHLD handler updating the process status, and the test reading
      it. Fixes bug 13291; bugfix on 0.2.3.3-alpha.
  o Minor bugfixes (testing, Windows):
    - Avoid passing an extra backslash when creating a temporary
      directory for running the unit tests on Windows. Fixes bug 12392;
      bugfix on 0.2.2.25-alpha. Patch from Gisle Vanem.
  o Minor bugfixes (windows):
    - Remove code to special-case handling of NTE_BAD_KEYSET when
      acquiring windows CryptoAPI context. This error can't actually
      occur for the parameters we're providing. Fixes bug 10816; bugfix
      on 0.0.2pre26.
  o Minor bugfixes (zlib):
    - Avoid truncating a zlib stream when trying to finalize it with an
      empty output buffer. Fixes bug 11824; bugfix on 0.1.1.23.
  o Build fixes:
    - Allow our configure script to build correctly with autoconf 2.62
      again. Fixes bug 12693; bugfix on 0.2.5.2-alpha.
    - Improve the error message from ./configure to make it clear that
      when asciidoc has not been found, the user will have to either add
      --disable-asciidoc argument or install asciidoc. Resolves
      ticket 13228.
  o Code simplification and refactoring:
    - Change the entry_is_live() function to take named bitfield
      elements instead of an unnamed list of booleans. Closes
      ticket 12202.
    - Refactor and unit-test entry_is_time_to_retry() in entrynodes.c.
      Resolves ticket 12205.
    - Use calloc and reallocarray functions in preference to multiply-
      then-malloc. This makes it less likely for us to fall victim to an
      integer overflow attack when allocating. Resolves ticket 12855.
    - Use the standard macro name SIZE_MAX, instead of our
      own SIZE_T_MAX.
    - Document usage of the NO_DIRINFO and ALL_DIRINFO flags clearly in
      functions which take them as arguments. Replace 0 with NO_DIRINFO
      in a function call for clarity. Seeks to prevent future issues
      like 13163.
    - Avoid 4 null pointer errors under clang shallow analysis by using
      tor_assert() to prove that the pointers aren't null. Fixes
      bug 13284.
    - Rework the API of policies_parse_exit_policy() to use a bitmask to
      represent parsing options, instead of a confusing mess of
      booleans. Resolves ticket 8197.
    - Introduce a helper function to parse ExitPolicy in
      or_options_t structure.
  o Documentation:
    - Add a doc/TUNING document with tips for handling large numbers of
      TCP connections when running busy Tor relay. Update the warning
      message to point to this file when running out of sockets
      operating system is allowing to use simultaneously. Resolves
      ticket 9708.
  o Removed code:
    - We no longer remind the user about configuration options that have
      been obsolete since 0.2.3.x or earlier. Patch by Adrien Bak.
  o Removed features:
    - Remove the --disable-curve25519 configure option. Relays and
      clients now are required to support curve25519 and the
      ntor handshake.
    - The old "StrictEntryNodes" and "StrictExitNodes" options, which
      used to be deprecated synonyms for "StrictNodes", are now marked
      obsolete. Resolves ticket 12226.
    - The "AuthDirRejectUnlisted" option no longer has any effect, as
      the fingerprints file (approved-routers) has been deprecated.
    - Directory authorities do not support being Naming dirauths anymore.
      The "NamingAuthoritativeDir" config option is now obsolete.
    - Directory authorities do not support giving out the BadDirectory
      flag anymore.
    - Clients don't understand the BadDirectory flag in the consensus
      anymore, and ignore it.
  o Testing:
    - Refactor the function that chooses guard nodes so that it can more
      easily be tested; write some tests for it.
    - Fix and re-enable the fgets_eagain unit test. Fixes bug 12503;
      bugfix on 0.2.3.1-alpha. Patch from "cypherpunks."
    - Create unit tests for format_time_interval(). With bug 13393.
    - Add unit tests for tor_timegm signed overflow, tor_timegm and
      parse_rfc1123_time validity checks, correct_tm year clamping. Unit
      tests (visible) fixes in bug 13476.
    - Add a "coverage-html" make target to generate HTML-visualized
      coverage results when building with --enable-coverage. (Requires
      lcov.) Patch from Kevin Murray.
    - Enable the backtrace handler (where supported) when running the
      unit tests.
    - Revise all unit tests that used the legacy test_* macros to
      instead use the recommended tt_* macros. This patch was generated
      with coccinelle, to avoid manual errors. Closes ticket 13119.
  o Distribution (systemd):
    - systemd unit file: only allow tor to write to /var/lib/tor and
      /var/log/tor. The rest of the filesystem is accessible for reading
      only. Patch by intrigeri; resolves ticket 12751.
    - systemd unit file: ensure that the process and all its children
      can never gain new privileges. Patch by intrigeri; resolves
      ticket 12939.
    - systemd unit file: set up /var/run/tor as writable for the Tor
      service. Patch by intrigeri; resolves ticket 13196.
  o Removed features (directory authorities):
    - Remove code that prevented authorities from listing Tor relays
      affected by CVE-2011-2769 as guards. These relays are already
      rejected altogether due to the minimum version requirement of
      0.2.3.16-alpha. Closes ticket 13152.
    - Directory authorities no longer advertise or support consensus
      methods 1 through 12 inclusive. These consensus methods were
      obsolete and/or insecure: maintaining the ability to support them
      served no good purpose. Implements part of proposal 215; closes
      ticket 10163.
  o Testing (test-network.sh):
    - Stop using "echo -n", as some shells' built-in echo doesn't
      support "-n". Instead, use "/bin/echo -n". Partially fixes
      bug 13161.
    - Stop an apparent test-network hang when used with make -j2. Fixes
      bug 13331.
    - Add a --delay option to test-network.sh, which configures the
      delay before the chutney network tests for data transmission.
      Partially implements ticket 13161.

@_date: 2014-09-11 21:41:20
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.5.7-rc is released 
Changes in version 0.2.5.7-rc - 2014-09-11
  Tor 0.2.5.7-rc fixes several regressions from earlier in the 0.2.5.x
  release series, and some long-standing bugs related to ORPort reachability
  testing and failure to send CREATE cells. It is the first release
  candidate for the Tor 0.2.5.x series.
  The source is ready today; packages should be ready in the next several days.
  (I'm taking some load off of Roger's shoulders by doing releases
myself.  This means that the signatures on the release are made with
my PGP key, not Roger's.  Please don't freak out. Please remember to
check signatures.)
    o Major bugfixes (client, startup):
    - Start making circuits as soon as DisabledNetwork is turned off.
      When Tor started with DisabledNetwork set, it would correctly
      conclude that it shouldn't build circuits, but it would mistakenly
      cache this conclusion, and continue believing it even when
      DisableNetwork is set to 0. Fixes the bug introduced by the fix
      for bug 11200; bugfix on 0.2.5.4-alpha.
    - Resume expanding abbreviations for command-line options. The fix
      for bug 4647 accidentally removed our hack from bug 586 that
      rewrote HashedControlPassword to __HashedControlSessionPassword
      when it appears on the commandline (which allowed the user to set
      her own HashedControlPassword in the torrc file while the
      controller generates a fresh session password for each run). Fixes
      bug 12948; bugfix on 0.2.5.1-alpha.
    - Warn about attempts to run hidden services and relays in the same
      process: that's probably not a good idea. Closes ticket 12908.
  o Major bugfixes (relay):
    - Avoid queuing or sending destroy cells for circuit ID zero when we
      fail to send a CREATE cell. Fixes bug 12848; bugfix on 0.0.8pre1.
      Found and fixed by "cypherpunks".
    - Fix ORPort reachability detection on relays running behind a
      proxy, by correctly updating the "local" mark on the controlling
      channel when changing the address of an or_connection_t after the
      handshake. Fixes bug 12160; bugfix on 0.2.4.4-alpha.
  o Minor features (bridge):
    - Add an ExtORPortCookieAuthFileGroupReadable option to make the
      cookie file for the ExtORPort g+r by default.
  o Minor features (geoip):
    - Update geoip and geoip6 to the August 7 2014 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (logging):
    - Reduce the log severity of the "Pluggable transport proxy does not
      provide any needed transports and will not be launched." message,
      since Tor Browser includes several ClientTransportPlugin lines in
      its torrc-defaults file, leading every Tor Browser user who looks
      at her logs to see these notices and wonder if they're dangerous.
      Resolves bug 13124; bugfix on 0.2.5.3-alpha.
    - Downgrade "Unexpected onionskin length after decryption" warning
      to a protocol-warn, since there's nothing relay operators can do
      about a client that sends them a malformed create cell. Resolves
      bug 12996; bugfix on 0.0.6rc1.
    - Log more specific warnings when we get an ESTABLISH_RENDEZVOUS
      cell on a cannibalized or non-OR circuit. Resolves ticket 12997.
    - When logging information about an EXTEND2 or EXTENDED2 cell, log
      their names correctly. Fixes part of bug 12700; bugfix
      on 0.2.4.8-alpha.
    - When logging information about a relay cell whose command we don't
      recognize, log its command as an integer. Fixes part of bug 12700;
      bugfix on 0.2.1.10-alpha.
    - Escape all strings from the directory connection before logging
      them. Fixes bug 13071; bugfix on 0.1.1.15. Patch from "teor".
  o Minor bugfixes (controller):
    - Restore the functionality of CookieAuthFileGroupReadable. Fixes
      bug 12864; bugfix on 0.2.5.1-alpha.
    - Actually send TRANSPORT_LAUNCHED and HS_DESC events to
      controllers. Fixes bug 13085; bugfix on 0.2.5.1-alpha. Patch
      by "teor".
  o Minor bugfixes (compilation):
    - Fix compilation of test.h with MSVC. Patch from Gisle Vanem;
      bugfix on 0.2.5.5-alpha.
    - Make the nmake make files work again. Fixes bug 13081. Bugfix on
      0.2.5.1-alpha. Patch from "NewEraCracker".
    - In routerlist_assert_ok(), don't take the address of a
      routerinfo's cache_info member unless that routerinfo is non-NULL.
      Fixes bug 13096; bugfix on 0.1.1.9-alpha. Patch by "teor".
    - Fix a large number of false positive warnings from the clang
      analyzer static analysis tool. This should make real warnings
      easier for clang analyzer to find. Patch from "teor". Closes
      ticket 13036.
  o Distribution (systemd):
    - Verify configuration file via ExecStartPre in the systemd unit
      file. Patch from intrigeri; resolves ticket 12730.
    - Explicitly disable RunAsDaemon in the systemd unit file. Our
      current systemd unit uses "Type = simple", so systemd does not
      expect tor to fork. If the user has "RunAsDaemon 1" in their
      torrc, then things won't work as expected. This is e.g. the case
      on Debian (and derivatives), since there we pass "--defaults-torrc
      /usr/share/tor/tor-service-defaults-torrc" (that contains
      "RunAsDaemon 1") by default. Patch by intrigeri; resolves
      ticket 12731.
  o Documentation:
    - Adjust the URLs in the README to refer to the new locations of
      several documents on the website. Fixes bug 12830. Patch from
      Matt Pagan.
    - Document 'reject6' and 'accept6' ExitPolicy entries. Resolves
      ticket 12878.

@_date: 2015-02-19 17:31:30
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.6.3-alpha is now released! 
Hi, all!
The second alpha release for the 0.2.6 series has just been tagged and
uploaded. You can download the source code from the website right now.
Packages should become available some time over the next several days.
The 0.2.6 series is now in hard feature freeze.  No new feature
proposals will be considered. Only regression bugs, major bugs, and
significant security issues will be considered for fix.  I hope we can
get this one stable soon as we start on 0.2.7 development.
greetings from a snowy place,
    --  Nick
Changes in version 0.2.6.3-alpha - 2015-02-19
  Tor 0.2.6.3-alpha is the third (and hopefully final) alpha release in
  the 0.2.6.x series. It introduces support for more kinds of sockets,
  makes it harder to accidentally run an exit, improves our
  multithreading backend, incorporates several fixes for the
  AutomapHostsOnResolve option, and fixes numerous other bugs besides.
  If no major regressions or security holes are found in this version,
  the next version will be a release candidate.
  o Deprecated versions:
    - Tor relays older than 0.2.4.18-rc are no longer allowed to
      advertise themselves on the network. Closes ticket 13555.
  o Major features (security, unix domain sockets):
    - Allow SocksPort to be an AF_UNIX Unix Domain Socket. Now high risk
      applications can reach Tor without having to create AF_INET or
      AF_INET6 sockets, meaning they can completely disable their
      ability to make non-Tor network connections. To create a socket of
      this type, use "SocksPort unix:/path/to/socket". Implements
      ticket 12585.
    - Support mapping hidden service virtual ports to AF_UNIX sockets.
      The syntax is "HiddenServicePort 80 unix:/path/to/socket".
      Implements ticket 11485.
  o Major features (changed defaults):
    - Prevent relay operators from unintentionally running exits: When a
      relay is configured as an exit node, we now warn the user unless
      the "ExitRelay" option is set to 1. We warn even more loudly if
      the relay is configured with the default exit policy, since this
      can indicate accidental misconfiguration. Setting "ExitRelay 0"
      stops Tor from running as an exit relay. Closes ticket 10067.
  o Major features (directory system):
    - When downloading server- or microdescriptors from a directory
      server, we no longer launch multiple simultaneous requests to the
      same server. This reduces load on the directory servers,
      especially when directory guards are in use. Closes ticket 9969.
    - When downloading server- or microdescriptors over a tunneled
      connection, do not limit the length of our requests to what the
      Squid proxy is willing to handle. Part of ticket 9969.
    - Authorities can now vote on the correct digests and latest
      versions for different software packages. This allows packages
      that include Tor to use the Tor authority system as a way to get
      notified of updates and their correct digests. Implements proposal
      227. Closes ticket 10395.
  o Major features (performance):
    - Make the CPU worker implementation more efficient by avoiding the
      kernel and lengthening pipelines. The original implementation used
      sockets to transfer data from the main thread to the workers, and
      didn't allow any thread to be assigned more than a single piece of
      work at once. The new implementation avoids communications
      overhead by making requests in shared memory, avoiding kernel IO
      where possible, and keeping more requests in flight at once.
      Implements ticket 9682.
  o Major features (relay):
    - Raise the minimum acceptable configured bandwidth rate for bridges
      to 50 KiB/sec and for relays to 75 KiB/sec. (The old values were
      20 KiB/sec.) Closes ticket 13822.
  o Major bugfixes (exit node stability):
    - Fix an assertion failure that could occur under high DNS load.
      Fixes bug 14129; bugfix on Tor 0.0.7rc1. Found by "jowr";
      diagnosed and fixed by "cypherpunks".
  o Major bugfixes (mixed relay-client operation):
    - When running as a relay and client at the same time (not
      recommended), if we decide not to use a new guard because we want
      to retry older guards, only close the locally-originating circuits
      passing through that guard. Previously we would close all the
      circuits through that guard. Fixes bug 9819; bugfix on
      0.2.1.1-alpha. Reported by "skruffy".
  o Minor features (build):
    - New --disable-system-torrc compile-time option to prevent Tor from
      looking for the system-wide torrc or torrc-defaults files.
      Resolves ticket 13037.
  o Minor features (controller):
    - Include SOCKS_USERNAME and SOCKS_PASSWORD values in controller
      events so controllers can observe circuit isolation inputs. Closes
      ticket 8405.
    - ControlPort now supports the unix:/path/to/socket syntax as an
      alternative to the ControlSocket option, for consistency with
      SocksPort and HiddenServicePort. Closes ticket 14451.
    - New "GETINFO bw-event-cache" to get information about recent
      bandwidth events. Closes ticket 14128. Useful for controllers to
      get recent bandwidth history after the fix for ticket 13988.
  o Minor features (Denial of service resistance):
    - Count the total number of bytes used storing hidden service
      descriptors against the value of MaxMemInQueues. If we're low on
      memory, and more than 20% of our memory is used holding hidden
      service descriptors, free them until no more than 10% of our
      memory holds hidden service descriptors. Free the least recently
      fetched descriptors first. Resolves ticket 13806.
    - When we have recently been under memory pressure (over 3/4 of
      MaxMemInQueues is allocated), then allocate smaller zlib objects
      for small requests. Closes ticket 11791.
  o Minor features (geoip):
    - Update geoip and geoip6 files to the January 7 2015 Maxmind
      GeoLite2 Country database.
  o Minor features (guard nodes):
    - Reduce the time delay before saving guard status to disk from 10
      minutes to 30 seconds (or from one hour to 10 minutes if
      AvoidDiskWrites is set). Closes ticket 12485.
  o Minor features (hidden service):
    - Make Sybil attacks against hidden services harder by changing the
      minimum time required to get the HSDir flag from 25 hours up to 96
      hours. Addresses ticket 14149.
    - New option "HiddenServiceAllowUnknownPorts" to allow hidden
      services to disable the anti-scanning feature introduced in
      0.2.6.2-alpha. With this option not set, a connection to an
      unlisted port closes the circuit. With this option set, only a
      RELAY_DONE cell is sent. Closes ticket 14084.
  o Minor features (interface):
    - Implement "-f -" command-line option to read torrc configuration
      from standard input, if you don't want to store the torrc file in
      the file system. Implements feature 13865.
  o Minor features (logging):
    - Add a count of unique clients to the bridge heartbeat message.
      Resolves ticket 6852.
    - Suppress "router info incompatible with extra info" message when
      reading extrainfo documents from cache. (This message got loud
      around when we closed bug 9812 in 0.2.6.2-alpha.) Closes
      ticket 13762.
    - Elevate hidden service authorized-client message from DEBUG to
      INFO. Closes ticket 14015.
  o Minor features (stability):
    - Add assertions in our hash-table iteration code to check for
      corrupted values that could cause infinite loops. Closes
      ticket 11737.
  o Minor features (systemd):
    - Various improvements and modernizations in systemd hardening
      support. Closes ticket 13805. Patch from Craig Andrews.
  o Minor features (testing networks):
    - Drop the minimum RendPostPeriod on a testing network to 5 seconds,
      and the default on a testing network to 2 minutes. Drop the
      MIN_REND_INITIAL_POST_DELAY on a testing network to 5 seconds, but
      keep the default on a testing network at 30 seconds. This reduces
      HS bootstrap time to around 25 seconds. Also, change the default
      time in test-network.sh to match. Closes ticket 13401. Patch
      by "teor".
    - Create TestingDirAuthVoteHSDir to correspond to
      TestingDirAuthVoteExit/Guard. Ensures that authorities vote the
      HSDir flag for the listed relays regardless of uptime or ORPort
      connectivity. Respects the value of VoteOnHidServDirectoriesV2.
      Partial implementation for ticket 14067. Patch by "teor".
  o Minor features (tor2web mode):
    - Introduce the config option Tor2webRendezvousPoints, which allows
      clients in Tor2webMode to select a specific Rendezvous Point to be
      used in HS circuits. This might allow better performance for
      Tor2Web nodes. Implements ticket 12844.
  o Minor bugfixes (client DNS):
    - Report the correct cached DNS expiration times on SOCKS port or in
      DNS replies. Previously, we would report everything as "never
      expires." Fixes bug 14193; bugfix on 0.2.3.17-beta.
    - Avoid a small memory leak when we find a cached answer for a
      reverse DNS lookup in a client-side DNS cache. (Remember, client-
      side DNS caching is off by default, and is not recommended.) Fixes
      bug 14259; bugfix on 0.2.0.1-alpha.
  o Minor bugfixes (client, automapping):
    - Avoid crashing on torrc lines for VirtualAddrNetworkIPv[4|6] when
      no value follows the option. Fixes bug 14142; bugfix on
      0.2.4.7-alpha. Patch by "teor".
    - Fix a memory leak when using AutomapHostsOnResolve. Fixes bug
      14195; bugfix on 0.1.0.1-rc.
    - Prevent changes to other options from removing the wildcard value
      "." from "AutomapHostsSuffixes". Fixes bug 12509; bugfix
      on 0.2.0.1-alpha.
    - Allow MapAddress and AutomapHostsOnResolve to work together when
      an address is mapped into another address type (like .onion) that
      must be automapped at resolve time. Fixes bug 7555; bugfix
      on 0.2.0.1-alpha.
  o Minor bugfixes (client, bridges):
    - When we are using bridges and we had a network connectivity
      problem, only retry connecting to our currently configured
      bridges, not all bridges we know about and remember using. Fixes
      bug 14216; bugfix on 0.2.2.17-alpha.
  o Minor bugfixes (client, IPv6):
    - Reject socks requests to literal IPv6 addresses when IPv6Traffic
      flag is not set; and not because the NoIPv4Traffic flag was set.
      Previously we'd looked at the NoIPv4Traffic flag for both types of
      literal addresses. Fixes bug 14280; bugfix on 0.2.4.7-alpha.
  o Minor bugfixes (compilation):
    - The address of an array in the middle of a structure will always
      be non-NULL. clang recognises this and complains. Disable the
      tautologous and redundant check to silence this warning. Fixes bug
      14001; bugfix on 0.2.1.2-alpha.
    - Avoid warnings when building with systemd 209 or later. Fixes bug
      14072; bugfix on 0.2.6.2-alpha. Patch from "h.venev".
    - Compile correctly with (unreleased) OpenSSL 1.1.0 headers.
      Addresses ticket 14188.
    - Build without warnings with the stock OpenSSL srtp.h header, which
      has a duplicate declaration of SSL_get_selected_srtp_profile().
      Fixes bug 14220; this is OpenSSL's bug, not ours.
    - Do not compile any code related to Tor2Web mode when Tor2Web mode
      is not enabled at compile time. Previously, this code was included
      in a disabled state. See discussion on ticket 12844.
    - Remove the --disable-threads configure option again. It was
      accidentally partially reintroduced in 29ac883606d6d. Fixes bug
      14819; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (controller):
    - Report "down" in response to the "GETINFO entry-guards" command
      when relays are down with an unreachable_since value. Previously,
      we would report "up". Fixes bug 14184; bugfix on 0.1.2.2-alpha.
    - Avoid crashing on a malformed EXTENDCIRCUIT command. Fixes bug
      14116; bugfix on 0.2.2.9-alpha.
    - Add a code for the END_CIRC_REASON_IP_NOW_REDUNDANT circuit close
      reason. Fixes bug 14207; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (directory authority):
    - Allow directory authorities to fetch more data from one another if
      they find themselves missing lots of votes. Previously, they had
      been bumping against the 10 MB queued data limit. Fixes bug 14261;
      bugfix on 0.1.2.5-alpha.
    - Do not attempt to download extrainfo documents which we will be
      unable to validate with a matching server descriptor. Fixes bug
      13762; bugfix on 0.2.0.1-alpha.
    - Fix a bug that was truncating AUTHDIR_NEWDESC events sent to the
      control port. Fixes bug 14953; bugfix on 0.2.0.1-alpha.
    - Enlarge the buffer to read bwauth generated files to avoid an
      issue when parsing the file in dirserv_read_measured_bandwidths().
      Fixes bug 14125; bugfix on 0.2.2.1-alpha.
  o Minor bugfixes (file handling):
    - Stop failing when key files are zero-length. Instead, generate new
      keys, and overwrite the empty key files. Fixes bug 13111; bugfix
      on all versions of Tor. Patch by "teor".
    - Stop generating a fresh .old RSA onion key file when the .old file
      is missing. Fixes part of 13111; bugfix on 0.0.6rc1.
    - Avoid overwriting .old key files with empty key files.
    - Skip loading zero-length extrainfo store, router store, stats,
      state, and key files.
    - Avoid crashing when trying to reload a torrc specified as a
      relative path with RunAsDaemon turned on. Fixes bug 13397; bugfix
      on 0.2.3.11-alpha.
  o Minor bugfixes (hidden services):
    - Close the introduction circuit when we have no more usable intro
      points, instead of waiting for it to time out. This also ensures
      that no follow-up HS descriptor fetch is triggered when the
      circuit eventually times out. Fixes bug 14224; bugfix on 0.0.6.
    - When fetching a hidden service descriptor for a down service that
      was recently up, do not keep refetching until we try the same
      replica twice in a row. Fixes bug 14219; bugfix on 0.2.0.10-alpha.
    - Successfully launch Tor with a nonexistent hidden service
      directory. Our fix for bug 13942 didn't catch this case. Fixes bug
      14106; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (logging):
    - Avoid crashing when there are more log domains than entries in
      domain_list. Bugfix on 0.2.3.1-alpha.
    - Add a string representation for LD_SCHED. Fixes bug 14740; bugfix
      on 0.2.6.1-alpha.
    - Don't log messages to stdout twice when starting up. Fixes bug
      13993; bugfix on 0.2.6.1-alpha.
  o Minor bugfixes (parsing):
    - Stop accepting milliseconds (or other junk) at the end of
      descriptor publication times. Fixes bug 9286; bugfix on 0.0.2pre25.
    - Support two-number and three-number version numbers correctly, in
      case we change the Tor versioning system in the future. Fixes bug
      13661; bugfix on 0.0.8pre1.
  o Minor bugfixes (path counting):
    - When deciding whether the consensus lists any exit nodes, count
      the number listed in the consensus, not the number we have
      descriptors for. Fixes part of bug 14918; bugfix on 0.2.6.2-alpha.
    - When deciding whether we have any exit nodes, only examine
      ExitNodes when the ExitNodes option is actually set. Fixes part of
      bug 14918; bugfix on 0.2.6.2-alpha.
    - Get rid of redundant and possibly scary warnings that we are
      missing directory information while we bootstrap. Fixes part of
      bug 14918; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (portability):
    - Fix the ioctl()-based network interface lookup code so that it
      will work on systems that have variable-length struct ifreq, for
      example Mac OS X.
    - Fix scheduler compilation on targets where char is unsigned. Fixes
      bug 14764; bugfix on 0.2.6.2-alpha. Reported by Christian Kujau.
  o Minor bugfixes (sandbox):
    - Allow glibc fatal errors to be sent to stderr before Tor exits.
      Previously, glibc would try to write them to /dev/tty, and the
      sandbox would trap the call and make Tor exit prematurely. Fixes
      bug 14759; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (shutdown):
    - When shutting down, always call event_del() on lingering read or
      write events before freeing them. Otherwise, we risk double-frees
      or read-after-frees in event_base_free(). Fixes bug 12985; bugfix
      on 0.1.0.2-rc.
  o Minor bugfixes (small memory leaks):
    - Avoid leaking memory when using IPv6 virtual address mappings.
      Fixes bug 14123; bugfix on 0.2.4.7-alpha. Patch by Tom van
      der Woerdt.
  o Minor bugfixes (statistics):
    - Increase period over which bandwidth observations are aggregated
      from 15 minutes to 4 hours. Fixes bug 13988; bugfix on 0.0.8pre1.
  o Minor bugfixes (systemd support):
    - Fix detection and operation of systemd watchdog. Fixes part of bug
      14141; bugfix on 0.2.6.2-alpha. Patch from Tomasz Torcz.
    - Run correctly under systemd with the RunAsDaemon option set. Fixes
      part of bug 14141; bugfix on 0.2.5.7-rc. Patch from Tomasz Torcz.
    - Inform the systemd supervisor about more changes in the Tor
      process status. Implements part of ticket 14141. Patch from
      Tomasz Torcz.
    - Cause the "--disable-systemd" option to actually disable systemd
      support. Fixes bug 14350; bugfix on 0.2.6.2-alpha. Patch
      from "blueness".
  o Minor bugfixes (TLS):
    - Check more thoroughly throughout the TLS code for possible
      unlogged TLS errors. Possible diagnostic or fix for bug 13319.
  o Minor bugfixes (transparent proxy):
    - Use getsockname, not getsockopt, to retrieve the address for a
      TPROXY-redirected connection. Fixes bug 13796; bugfix
      on 0.2.5.2-alpha.
  o Code simplification and refactoring:
    - Move fields related to isolating and configuring client ports into
      a shared structure. Previously, they were duplicated across
      port_cfg_t, listener_connection_t, and edge_connection_t. Failure
      to copy them correctly had been the cause of at least one bug in
      the past. Closes ticket 8546.
    - Refactor the get_interface_addresses_raw() doom-function into
      multiple smaller and simpler subfunctions. Cover the resulting
      subfunctions with unit-tests. Fixes a significant portion of
      issue 12376.
    - Remove workaround in dirserv_thinks_router_is_hs_dir() that was
      only for version <= 0.2.2.24 which is now deprecated. Closes
      ticket 14202.
    - Remove a test for a long-defunct broken version-one
      directory server.
  o Documentation:
    - Adding section on OpenBSD to our TUNING document. Thanks to mmcc
      for writing the OpenBSD-specific tips. Resolves ticket 13702.
    - Make the tor-resolve documentation match its help string and its
      options. Resolves part of ticket 14325.
    - Log a more useful error message from tor-resolve when failing to
      look up a hidden service address. Resolves part of ticket 14325.
  o Downgraded warnings:
    - Don't warn when we've attempted to contact a relay using the wrong
      ntor onion key. Closes ticket 9635.
  o Removed features:
    - To avoid confusion with the "ExitRelay" option, "ExitNode" is no
      longer silently accepted as an alias for "ExitNodes".
    - The --enable-mempool and --enable-buf-freelists options, which
      were originally created to work around bad malloc implementations,
      no longer exist. They were off-by-default in 0.2.5. Closes
      ticket 14848.
  o Testing:
    - Make the checkdir/perms test complete successfully even if the
      global umask is not 022. Fixes bug 14215; bugfix on 0.2.6.2-alpha.
    - Test that tor does not fail when key files are zero-length. Check
      that tor generates new keys, and overwrites the empty key files.
    - Test that tor generates new keys when keys are missing
      (existing behavior).
    - Test that tor does not overwrite key files that already contain
      data (existing behavior). Tests bug 13111. Patch by "teor".
    - New "make test-stem" target to run stem integration tests.
      Requires that the "STEM_SOURCE_DIR" environment variable be set.
      Closes ticket 14107.
    - Make the test_cmdline_args.py script work correctly on Windows.
      Patch from Gisle Vanem.
    - Move the slower unit tests into a new "./src/test/test-slow"
      binary that can be run independently of the other tests. Closes
      ticket 13243.
    - Avoid undefined behavior when sampling huge values from the
      Laplace distribution. This made unittests fail on Raspberry Pi.
      Bug found by Device. Fixes bug 14090; bugfix on 0.2.6.2-alpha.

@_date: 2015-01-01 15:56:15
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.6.2-alpha is now released! 
On Dec 31, 2014 3:03 PM, "Sebastian G. <bastik.tor>" <
Yeah, it's often a matter of opinion what to call a bug and what to call a
missing feature.
Say,  everybody who is looking for issues in the changelog: would there be
a good way to involve you earlier next time? It seems that before I put a
release out is when I need the most feedback, but also when I have to beg
the most to get it.  Maybe I should get a mail out to tor-talk a day or two
*before* the next release, to better make use of this help.
Happy new years,

@_date: 2015-01-05 10:43:25
@_author: Nick Mathewson 
@_subject: [tor-talk] Libevent CVE-2014-6272 does not affect Tor 
There's a security advisory for Libevent here:
   Briefly: there are integer overflows in the evbuffer code, such that
if an application can be tricked into trying add a ridiculously huge
amount of data to an evbuffer in a single chunk, there could be a heap
overflow or infinite loop.  (Most applications using libevent cannot
actually be tricked into doing this.)
Some of you will likely be wondering: "Tor uses Libevent. Does this affect Tor?"
The answer is:  this does not affect Tor.
1. In the way that most people build Tor, the relevant "evbuffer"
feature in Libevent is not used.
2. When Tor is compiled with the (experimental, rarely used)
--enable-bufferevents option, Tor doesn't actually work.  Also, I do
not believe that any of the Tor code for that case has any of the
programming mistakes that would turn the Libevent bug into a
3. Some of our older pluggable transport code uses Libevent too.  On
an audit, I found that it does not appear to have any of the
programming mistakes that would turn the Libevent bug into a
So, no worries here on the Tor front, if my analysis is right.
best wishes,

@_date: 2015-07-27 13:57:32
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.7.2-alpha is released 
This, the second alpha in the Tor 0.2.7 series, has a number of new
features, including a way to manually pick the number of introduction
points for hidden services, and the much stronger Ed25519 signing key
algorithm for regular Tor relays (including support for encrypted
offline identity keys in the new algorithm).
Support for Ed25519 on relays is currently limited to signing router
descriptors; later alphas in this series will extend Ed25519 key
support to more parts of the Tor protocol.
You can download the source from the usual place on the website.
Packages should be up in a few days.
NOTE: This is an alpha release. Please expect bugs.
  o Major features (Ed25519 identity keys, Proposal 220):
    - All relays now maintain a stronger identity key, using the Ed25519
      elliptic curve signature format. This master key is designed so
      that it can be kept offline. Relays also generate an online
      signing key, and a set of other Ed25519 keys and certificates.
      These are all automatically regenerated and rotated as needed.
      Implements part of ticket 12498.
    - Directory authorities now vote on Ed25519 identity keys along with
      RSA1024 keys. Implements part of ticket 12498.
    - Directory authorities track which Ed25519 identity keys have been
      used with which RSA1024 identity keys, and do not allow them to
      vary freely. Implements part of ticket 12498.
    - Microdescriptors now include Ed25519 identity keys. Implements
      part of ticket 12498.
    - Add support for offline encrypted Ed25519 master keys. To use this
      feature on your tor relay, run "tor --keygen" to make a new master
      key (or to make a new signing key if you already have a master
      key). Closes ticket 13642.
  o Major features (Hidden services):
    - Add the torrc option HiddenServiceNumIntroductionPoints, to
      specify a fixed number of introduction points. Its maximum value
      is 10 and default is 3. Using this option can increase a hidden
      service's reliability under load, at the cost of making it more
      visible that the hidden service is facing extra load. Closes
      ticket 4862.
    - Remove the adaptive algorithm for choosing the number of
      introduction points, which used to change the number of
      introduction points (poorly) depending on the number of
      connections the HS sees. Closes ticket 4862.
  o Major features (onion key cross-certification):
    - Relay descriptors now include signatures of their own identity
      keys, made using the TAP and ntor onion keys. These signatures
      allow relays to prove ownership of their own onion keys. Because
      of this change, microdescriptors will no longer need to include
      RSA identity keys. Implements proposal 228; closes ticket 12499.
  o Major features (performance):
    - Improve the runtime speed of Ed25519 operations by using the
      public-domain Ed25519-donna by Andrew M. ("floodyberry").
      Implements ticket 16467.
    - Improve the runtime speed of the ntor handshake by using an
      optimized curve25519 basepoint scalarmult implementation from the
      public-domain Ed25519-donna by Andrew M. ("floodyberry"), based on
      ideas by Adam Langley. Implements ticket 9663.
  o Major bugfixes (client-side privacy, also in 0.2.6.9):
    - Properly separate out each SOCKSPort when applying stream
      isolation. The error occurred because each port's session group
      was being overwritten by a default value when the listener
      connection was initialized. Fixes bug 16247; bugfix on
      0.2.6.3-alpha. Patch by "jojelino".
  o Major bugfixes (hidden service clients, stability, also in 0.2.6.10):
    - Stop refusing to store updated hidden service descriptors on a
      client. This reverts commit 9407040c59218 (which indeed fixed bug
      14219, but introduced a major hidden service reachability
      regression detailed in bug 16381). This is a temporary fix since
      we can live with the minor issue in bug 14219 (it just results in
      some load on the network) but the regression of 16381 is too much
      of a setback. First-round fix for bug 16381; bugfix
      on 0.2.6.3-alpha.
  o Major bugfixes (hidden services):
    - When cannibalizing a circuit for an introduction point, always
      extend to the chosen exit node (creating a 4 hop circuit).
      Previously Tor would use the current circuit exit node, which
      changed the original choice of introduction point, and could cause
      the hidden service to skip excluded introduction points or
      reconnect to a skipped introduction point. Fixes bug 16260; bugfix
      on 0.1.0.1-rc.
  o Major bugfixes (open file limit):
    - The open file limit wasn't checked before calling
      tor_accept_socket_nonblocking(), which would make Tor exceed the
      limit. Now, before opening a new socket, Tor validates the open
      file limit just before, and if the max has been reached, return an
      error. Fixes bug 16288; bugfix on 0.1.1.1-alpha.
  o Major bugfixes (stability, also in 0.2.6.10):
    - Stop crashing with an assertion failure when parsing certain kinds
      of malformed or truncated microdescriptors. Fixes bug 16400;
      bugfix on 0.2.6.1-alpha. Found by "torkeln"; fix based on a patch
      by "cypherpunks_backup".
    - Stop random client-side assertion failures that could occur when
      connecting to a busy hidden service, or connecting to a hidden
      service while a NEWNYM is in progress. Fixes bug 16013; bugfix
      on 0.1.0.1-rc.
  o Minor features (directory authorities, security, also in 0.2.6.9):
    - The HSDir flag given by authorities now requires the Stable flag.
      For the current network, this results in going from 2887 to 2806
      HSDirs. Also, it makes it harder for an attacker to launch a sybil
      attack by raising the effort for a relay to become Stable to
      require at the very least 7 days, while maintaining the 96 hours
      uptime requirement for HSDir. Implements ticket 8243.
  o Minor features (client):
    - Relax the validation of hostnames in SOCKS5 requests, allowing the
      character '_' to appear, in order to cope with domains observed in
      the wild that are serving non-RFC compliant records. Resolves
      ticket 16430.
    - Relax the validation done to hostnames in SOCKS5 requests, and
      allow a single trailing '.' to cope with clients that pass FQDNs
      using that syntax to explicitly indicate that the domain name is
      fully-qualified. Fixes bug 16674; bugfix on 0.2.6.2-alpha.
    - Add GroupWritable and WorldWritable options to unix-socket based
      SocksPort and ControlPort options. These options apply to a single
      socket, and override {Control,Socks}SocketsGroupWritable. Closes
      ticket 15220.
  o Minor features (control protocol):
    - Support network-liveness GETINFO key and NETWORK_LIVENESS event in
      the control protocol. Resolves ticket 15358.
  o Minor features (directory authorities):
    - Directory authorities no longer vote against the "Fast", "Stable",
      and "HSDir" flags just because they were going to vote against
      "Running": if the consensus turns out to be that the router was
      running, then the authority's vote should count. Patch from Peter
      Retzlaff; closes issue 8712.
  o Minor features (geoip, also in 0.2.6.10):
    - Update geoip to the June 3 2015 Maxmind GeoLite2 Country database.
    - Update geoip6 to the June 3 2015 Maxmind GeoLite2 Country database.
  o Minor features (hidden services):
    - Add the new options "HiddenServiceMaxStreams" and
      "HiddenServiceMaxStreamsCloseCircuit" to allow hidden services to
      limit the maximum number of simultaneous streams per circuit, and
      optionally tear down the circuit when the limit is exceeded. Part
      of ticket 16052.
  o Minor features (portability):
    - Use C99 variadic macros when the compiler is not GCC. This avoids
      failing compilations on MSVC, and fixes a log-file-based race
      condition in our old workarounds. Original patch from Gisle Vanem.
  o Minor bugfixes (compilation, also in 0.2.6.9):
    - Build with --enable-systemd correctly when libsystemd is
      installed, but systemd is not. Fixes bug 16164; bugfix on
      0.2.6.3-alpha. Patch from Peter Palfrader.
  o Minor bugfixes (controller):
    - Add the descriptor ID in each HS_DESC control event. It was
      missing, but specified in control-spec.txt. Fixes bug 15881;
      bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (crypto error-handling, also in 0.2.6.10):
    - Check for failures from crypto_early_init, and refuse to continue.
      A previous typo meant that we could keep going with an
      uninitialized crypto library, and would have OpenSSL initialize
      its own PRNG. Fixes bug 16360; bugfix on 0.2.5.2-alpha, introduced
      when implementing ticket 4900. Patch by "teor".
  o Minor bugfixes (hidden services):
    - Fix a crash when reloading configuration while at least one
      configured and one ephemeral hidden service exists. Fixes bug
      16060; bugfix on 0.2.7.1-alpha.
    - Avoid crashing with a double-free bug when we create an ephemeral
      hidden service but adding it fails for some reason. Fixes bug
      16228; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (Linux seccomp2 sandbox):
    - Use the sandbox in tor_open_cloexec whether or not O_CLOEXEC is
      defined. Patch by "teor". Fixes bug 16515; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (Linux seccomp2 sandbox, also in 0.2.6.10):
    - Allow pipe() and pipe2() syscalls in the seccomp2 sandbox: we need
      these when eventfd2() support is missing. Fixes bug 16363; bugfix
      on 0.2.6.3-alpha. Patch from "teor".
  o Minor bugfixes (Linux seccomp2 sandbox, also in 0.2.6.9):
    - Fix sandboxing to work when running as a relay, by allowing the
      renaming of secret_id_key, and allowing the eventfd2 and futex
      syscalls. Fixes bug 16244; bugfix on 0.2.6.1-alpha. Patch by
      Peter Palfrader.
    - Allow systemd connections to work with the Linux seccomp2 sandbox
      code. Fixes bug 16212; bugfix on 0.2.6.2-alpha. Patch by
      Peter Palfrader.
  o Minor bugfixes (relay):
    - Fix a rarely-encountered memory leak when failing to initialize
      the thread pool. Fixes bug 16631; bugfix on 0.2.6.3-alpha. Patch
      from "cypherpunks".
  o Minor bugfixes (systemd):
    - Fix an accidental formatting error that broke the systemd
      configuration file. Fixes bug 16152; bugfix on 0.2.7.1-alpha.
    - Tor's systemd unit file no longer contains extraneous spaces.
      These spaces would sometimes confuse tools like deb-systemd-
      helper. Fixes bug 16162; bugfix on 0.2.5.5-alpha.
  o Minor bugfixes (tests):
    - Use the configured Python executable when running test-stem-full.
      Fixes bug 16470; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (tests, also in 0.2.6.9):
    - Fix a crash in the unit tests when built with MSVC2013. Fixes bug
      16030; bugfix on 0.2.6.2-alpha. Patch from "NewEraCracker".
  o Minor bugfixes (threads, comments):
    - Always initialize return value in compute_desc_id in rendcommon.c
      Patch by "teor". Fixes part of bug 16115; bugfix on 0.2.7.1-alpha.
    - Check for NULL values in getinfo_helper_onions(). Patch by "teor".
      Fixes part of bug 16115; bugfix on 0.2.7.1-alpha.
    - Remove undefined directive-in-macro in test_util_writepid clang
      3.7 complains that using a preprocessor directive inside a macro
      invocation in test_util_writepid in test_util.c is undefined.
      Patch by "teor". Fixes part of bug 16115; bugfix on 0.2.7.1-alpha.
  o Code simplification and refactoring:
    - Define WINVER and _WIN32_WINNT centrally, in orconfig.h, in order
      to ensure they remain consistent and visible everywhere.
    - Remove some vestigial workarounds for the MSVC6 compiler. We
      haven't supported that in ages.
    - The link authentication code has been refactored for better
      testability and reliability. It now uses code generated with the
      "trunnel" binary encoding generator, to reduce the risk of bugs
      due to programmer error. Done as part of ticket 12498.
  o Documentation:
    - Include a specific and (hopefully) accurate documentation of the
      torrc file's meta-format in doc/torrc_format.txt. This is mainly
      of interest to people writing programs to parse or generate torrc
      files. This document is not a commitment to long-term
      compatibility; some aspects of the current format are a bit
      ridiculous. Closes ticket 2325.
  o Removed features:
    - Tor no longer supports copies of OpenSSL that are missing support
      for Elliptic Curve Cryptography. (We began using ECC when
      available in 0.2.4.8-alpha, for more safe and efficient key
      negotiation.) In particular, support for at least one of P256 or
      P224 is now required, with manual configuration needed if only
      P224 is available. Resolves ticket 16140.
    - Tor no longer supports versions of OpenSSL before 1.0. (If you are
      on an operating system that has not upgraded to OpenSSL 1.0 or
      later, and you compile Tor from source, you will need to install a
      more recent OpenSSL to link Tor against.) These versions of
      OpenSSL are still supported by the OpenSSL, but the numerous
      cryptographic improvements in later OpenSSL releases makes them a
      clear choice. Resolves ticket 16034.
    - Remove the HidServDirectoryV2 option. Now all relays offer to
      store hidden service descriptors. Related to 16543.
    - Remove the VoteOnHidServDirectoriesV2 option, since all
      authorities have long set it to 1. Closes ticket 16543.
  o Testing:
    - Document use of coverity, clang static analyzer, and clang dynamic
      undefined behavior and address sanitizers in doc/HACKING. Include
      detailed usage instructions in the blacklist. Patch by "teor".
      Closes ticket 15817.
    - The link authentication protocol code now has extensive tests.
    - The relay descriptor signature testing code now has
      extensive tests.
    - The test_workqueue program now runs faster, and is enabled by
      default as a part of "make check".
    - Now that OpenSSL has its own scrypt implementation, add an unit
      test that checks for interoperability between libscrypt_scrypt()
      and OpenSSL's EVP_PBE_scrypt() so that we could not use libscrypt
      and rely on EVP_PBE_scrypt() whenever possible. Resolves
      ticket 16189.

@_date: 2015-03-09 21:49:55
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.6.4-rc is released! 
Hi, all!
I've just tagged and uploaded Tor 0.2.6.4-rc to the usual places.
This is the first release candidate for the 0.2.6.x series, and I hope
the next release for 0.2.6 will be the stable release.
The source is available in the usual places on the website; packages
should follow. I'll put out an updated 0.2.5.11 in a few days, once
the changes in this release have seen more testing.
Changes in version 0.2.6.4-rc - 2015-03-09
  Tor 0.2.6.4-rc fixes an issue in the directory code that an
  attacker might be able to use in order to crash certain Tor
  directories. It also resolves some minor issues left over from, or
  introduced in, Tor 0.2.6.3-alpha or earlier.
  o Major bugfixes (crash, OSX, security):
    - Fix a remote denial-of-service opportunity caused by a bug in
      OSX's _strlcat_chk() function. Fixes bug 15205; bug first appeared
      in OSX 10.9.
  o Major bugfixes (relay, stability, possible security):
    - Fix a bug that could lead to a relay crashing with an assertion
      failure if a buffer of exactly the wrong layout is passed to
      buf_pullup() at exactly the wrong time. Fixes bug 15083; bugfix on
      0.2.0.10-alpha. Patch from "cypherpunks".
    - Do not assert if the 'data' pointer on a buffer is advanced to the
      very end of the buffer; log a BUG message instead. Only assert if
      it is past that point. Fixes bug 15083; bugfix on 0.2.0.10-alpha.
  o Major bugfixes (FreeBSD IPFW transparent proxy):
    - Fix address detection with FreeBSD transparent proxies, when
      "TransProxyType ipfw" is in use. Fixes bug 15064; bugfix
      on 0.2.5.4-alpha.
  o Major bugfixes (Linux seccomp2 sandbox):
    - Pass IPPROTO_TCP rather than 0 to socket(), so that the Linux
      seccomp2 sandbox doesn't fail. Fixes bug 14989; bugfix
      on 0.2.6.3-alpha.
    - Allow AF_UNIX hidden services to be used with the seccomp2
      sandbox. Fixes bug 15003; bugfix on 0.2.6.3-alpha.
    - Upon receiving sighup with the seccomp2 sandbox enabled, do not
      crash during attempts to call wait4. Fixes bug 15088; bugfix on
      0.2.5.1-alpha. Patch from "sanic".
  o Minor features (controller):
    - Messages about problems in the bootstrap process now include
      information about the server we were trying to connect to when we
      noticed the problem. Closes ticket 15006.
  o Minor features (geoip):
    - Update geoip to the March 3 2015 Maxmind GeoLite2 Country database.
    - Update geoip6 to the March 3 2015 Maxmind GeoLite2
      Country database.
  o Minor features (logs):
    - Quiet some log messages in the heartbeat and at startup. Closes
      ticket 14950.
  o Minor bugfixes (certificate handling):
    - If an authority operator accidentally makes a signing certificate
      with a future publication time, do not discard its real signing
      certificates. Fixes bug 11457; bugfix on 0.2.0.3-alpha.
    - Remove any old authority certificates that have been superseded
      for at least two days. Previously, we would keep superseded
      certificates until they expired, if they were published close in
      time to the certificate that superseded them. Fixes bug 11454;
      bugfix on 0.2.1.8-alpha.
  o Minor bugfixes (compilation):
    - Fix a compilation warning on s390. Fixes bug 14988; bugfix
      on 0.2.5.2-alpha.
    - Fix a compilation warning on FreeBSD. Fixes bug 15151; bugfix
      on 0.2.6.2-alpha.
  o Minor bugfixes (testing):
    - Fix endianness issues in unit test for resolve_my_address() to
      have it pass on big endian systems. Fixes bug 14980; bugfix on
      Tor 0.2.6.3-alpha.
    - Avoid a side-effect in a tor_assert() in the unit tests. Fixes bug
      15188; bugfix on 0.1.2.3-alpha. Patch from Tom van der Woerdt.
    - When running the new 'make test-stem' target, use the configured
      python binary. Fixes bug 15037; bugfix on 0.2.6.3-alpha. Patch
      from "cypherpunks".
    - When running the zero-length-keys tests, do not use the default
      torrc file. Fixes bug 15033; bugfix on 0.2.6.3-alpha. Reported
      by "reezer".
  o Directory authority IP change:
    - The directory authority Faravahar has a new IP address. This
      closes ticket 14487.
  o Removed code:
    - Remove some lingering dead code that once supported mempools.
      Mempools were disabled by default in 0.2.5, and removed entirely
      in 0.2.6.3-alpha. Closes more of ticket 14848; patch
      by "cypherpunks".

@_date: 2015-03-12 15:23:25
@_author: Nick Mathewson 
@_subject: [tor-talk] Upcoming stable releases in need of testing. (Requires 
Do you like to build allegedly stable versions of Tor from source code
and try them out looking for new bugs?
If so, head over to
   There is a GPG-signed document listing the sha256sum digests and URLs
for a couple of packages that *are not yet* official Tor releases
0.2.4.26 and 0.2.5.11, but which might soon be.  Check the signature,
check the digests, and give them a spin!
I'm especially interested in regressions -- that is, bugs that are in
0.2.4.26 but not in 0.2.4.25, or bugs that are in 0.2.5.11 but not in
If you find anything, please open a ticket on
  I'm aiming for a release some time next week.  Possibly a stable 0.2.6
as well, who knows?

@_date: 2015-05-12 11:50:58
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.7.1-alpha is released 
Tor 0.2.7.1-alpha is the first alpha release in its series. It
includes numerous small features and bugfixes against previous Tor
versions, and numerous small infrastructure improvements. The most
notable features are several new ways for controllers to interact with
the hidden services subsystem.
You can download the source from the usual place on the website.
Packages should be up in a few days.
NOTE: This is an alpha release. Please expect bugs.
Changes in version 0.2.7.1-alpha - 2015-05-12
  o New system requirements:
    - Tor no longer includes workarounds to support Libevent versions
      before 1.3e. Libevent 2.0 or later is recommended. Closes
      ticket 15248.
  o Major features (controller):
    - Add the ADD_ONION and DEL_ONION commands that allow the creation
      and management of hidden services via the controller. Closes
      ticket 6411.
    - New "GETINFO onions/current" and "GETINFO onions/detached"
      commands to get information about hidden services created via the
      controller. Part of ticket 6411.
    - New HSFETCH command to launch a request for a hidden service
      descriptor. Closes ticket 14847.
    - New HSPOST command to upload a hidden service descriptor. Closes
      ticket 3523. Patch by "DonnchaC".
  o Major bugfixes (hidden services):
    - Revert commit that made directory authorities assign the HSDir
      flag to relay without a DirPort; this was bad because such relays
      can't handle BEGIN_DIR cells. Fixes bug 15850; bugfix
      on tor-0.2.6.3-alpha.
  o Minor features (clock-jump tolerance):
    - Recover better when our clock jumps back many hours, like might
      happen for Tails or Whonix users who start with a very wrong
      hardware clock, use Tor to discover a more accurate time, and then
      fix their clock. Resolves part of ticket 8766.
  o Minor features (command-line interface):
    - Make --hash-password imply --hush to prevent unnecessary noise.
      Closes ticket 15542. Patch from "cypherpunks".
    - Print a warning whenever we find a relative file path being used
      as torrc option. Resolves issue 14018.
  o Minor features (controller):
    - Add DirAuthority lines for default directory authorities to the
      output of the "GETINFO config/defaults" command if not already
      present. Implements ticket 14840.
    - Controllers can now use "GETINFO hs/client/desc/id/..." to
      retrieve items from the client's hidden service descriptor cache.
      Closes ticket 14845.
    - Implement a new controller command "GETINFO status/fresh-relay-
      descs" to fetch a descriptor/extrainfo pair that was generated on
      demand just for the controller's use. Implements ticket 14784.
  o Minor features (DoS-resistance):
    - Make it harder for attackers to overload hidden services with
      introductions, by blocking multiple introduction requests on the
      same circuit. Resolves ticket 15515.
  o Minor features (geoip):
    - Update geoip to the April 8 2015 Maxmind GeoLite2 Country database.
    - Update geoip6 to the April 8 2015 Maxmind GeoLite2
      Country database.
  o Minor features (HS popularity countermeasure):
    - To avoid leaking HS popularity, don't cycle the introduction point
      when we've handled a fixed number of INTRODUCE2 cells but instead
      cycle it when a random number of introductions is reached, thus
      making it more difficult for an attacker to find out the amount of
      clients that have used the introduction point for a specific HS.
      Closes ticket 15745.
  o Minor features (logging):
    - Include the Tor version in all LD_BUG log messages, since people
      tend to cut and paste those into the bugtracker. Implements
      ticket 15026.
  o Minor features (pluggable transports):
    - When launching managed pluggable transports on Linux systems,
      attempt to have the kernel deliver a SIGTERM on tor exit if the
      pluggable transport process is still running. Resolves
      ticket 15471.
    - When launching managed pluggable transports, setup a valid open
      stdin in the child process that can be used to detect if tor has
      terminated. The "TOR_PT_EXIT_ON_STDIN_CLOSE" environment variable
      can be used by implementations to detect this new behavior.
      Resolves ticket 15435.
  o Minor features (testing):
    - Add a test to verify that the compiler does not eliminate our
      memwipe() implementation. Closes ticket 15377.
    - Add make rule `check-changes` to verify the format of changes
      files. Closes ticket 15180.
    - Add unit tests for control_event_is_interesting(). Add a compile-
      time check that the number of events doesn't exceed the capacity
      of control_event_t.event_mask. Closes ticket 15431, checks for
      bugs similar to 13085. Patch by "teor".
    - Command-line argument tests moved to Stem. Resolves ticket 14806.
    - Integrate the ntor, backtrace, and zero-length keys tests into the
      automake test suite. Closes ticket 15344.
    - Remove assertions during builds to determine Tor's test coverage.
      We don't want to trigger these even in assertions, so including
      them artificially makes our branch coverage look worse than it is.
      This patch provides the new test-stem-full and coverage-html-full
      configure options. Implements ticket 15400.
  o Minor bugfixes (build):
    - Improve out-of-tree builds by making non-standard rules work and
      clean up additional files and directories. Fixes bug 15053; bugfix
      on 0.2.7.0-alpha.
  o Minor bugfixes (command-line interface):
    - When "--quiet" is provided along with "--validate-config", do not
      write anything to stdout on success. Fixes bug 14994; bugfix
      on 0.2.3.3-alpha.
    - When complaining about bad arguments to "--dump-config", use
      stderr, not stdout.
  o Minor bugfixes (configuration, unit tests):
    - Only add the default fallback directories when the DirAuthorities,
      AlternateDirAuthority, and FallbackDir directory config options
      are set to their defaults. The default fallback directory list is
      currently empty, this fix will only change tor's behavior when it
      has default fallback directories. Includes unit tests for
      consider_adding_dir_servers(). Fixes bug 15642; bugfix on
      90f6071d8dc0 in 0.2.4.7-alpha. Patch by "teor".
  o Minor bugfixes (correctness):
    - For correctness, avoid modifying a constant string in
      handle_control_postdescriptor. Fixes bug 15546; bugfix
      on 0.1.1.16-rc.
    - Remove side-effects from tor_assert() calls. This was harmless,
      because we never disable assertions, but it is bad style and
      unnecessary. Fixes bug 15211; bugfix on 0.2.5.5, 0.2.2.36,
      and 0.2.0.10.
  o Minor bugfixes (hidden service):
    - Fix an out-of-bounds read when parsing invalid INTRODUCE2 cells on
      a client authorized hidden service. Fixes bug 15823; bugfix
      on 0.2.1.6-alpha.
    - Remove an extraneous newline character from the end of hidden
      service descriptors. Fixes bug 15296; bugfix on 0.2.0.10-alpha.
  o Minor bugfixes (interface):
    - Print usage information for --dump-config when it is used without
      an argument. Also, fix the error message to use different wording
      and add newline at the end. Fixes bug 15541; bugfix
      on 0.2.5.1-alpha.
  o Minor bugfixes (logs):
    - When building Tor under Clang, do not include an extra set of
      parentheses in log messages that include function names. Fixes bug
      15269; bugfix on every released version of Tor when compiled with
      recent enough Clang.
  o Minor bugfixes (network):
    - When attempting to use fallback technique for network interface
      lookup, disregard loopback and multicast addresses since they are
      unsuitable for public communications.
  o Minor bugfixes (statistics):
    - Disregard the ConnDirectionStatistics torrc options when Tor is
      not a relay since in that mode of operation no sensible data is
      being collected and because Tor might run into measurement hiccups
      when running as a client for some time, then becoming a relay.
      Fixes bug 15604; bugfix on 0.2.2.35.
  o Minor bugfixes (test networks):
    - When self-testing reachability, use ExtendAllowPrivateAddresses to
      determine if local/private addresses imply reachability. The
      previous fix used TestingTorNetwork, which implies
      ExtendAllowPrivateAddresses, but this excluded rare configurations
      where ExtendAllowPrivateAddresses is set but TestingTorNetwork is
      not. Fixes bug 15771; bugfix on 0.2.6.1-alpha. Patch by "teor",
      issue discovered by CJ Ess.
  o Minor bugfixes (testing):
    - Check for matching value in server response in ntor_ref.py. Fixes
      bug 15591; bugfix on 0.2.4.8-alpha. Reported and fixed
      by "joelanders".
    - Set the severity correctly when testing
      get_interface_addresses_ifaddrs() and
      get_interface_addresses_win32(), so that the tests fail gracefully
      instead of triggering an assertion. Fixes bug 15759; bugfix on
      0.2.6.3-alpha. Reported by Nicolas Derive.
  o Code simplification and refactoring:
    - Move the hacky fallback code out of get_interface_address6() into
      separate function and get it covered with unit-tests. Resolves
      ticket 14710.
    - Refactor hidden service client-side cache lookup to intelligently
      report its various failure cases, and disentangle failure cases
      involving a lack of introduction points. Closes ticket 14391.
    - Use our own Base64 encoder instead of OpenSSL's, to allow more
      control over the output. Part of ticket 15652.
  o Documentation:
    - Improve the descriptions of statistics-related torrc options in
      the manpage to describe rationale and possible uses cases. Fixes
      issue 15550.
    - Improve the layout and formatting of ./configure --help messages.
      Closes ticket 15024. Patch from "cypherpunks".
    - Standardize on the term "server descriptor" in the manual page.
      Previously, we had used "router descriptor", "server descriptor",
      and "relay descriptor" interchangeably. Part of ticket 14987.
  o Removed code:
    - Remove `USE_OPENSSL_BASE64` and the corresponding fallback code
      and always use the internal Base64 decoder. The internal decoder
      has been part of tor since tor-0.2.0.10-alpha, and no one should
      be using the OpenSSL one. Part of ticket 15652.
    - Remove the 'tor_strclear()' function; use memwipe() instead.
      Closes ticket 14922.
  o Removed features:
    - Remove the (seldom-used) DynamicDHGroups feature. For anti-
      fingerprinting we now recommend pluggable transports; for forward-
      secrecy in TLS, we now use the P-256 group. Closes ticket 13736.
    - Remove the undocumented "--digests" command-line option. It
      complicated our build process, caused subtle build issues on
      multiple platforms, and is now redundant since we started
      including git version identifiers. Closes ticket 14742.
    - Tor no longer contains checks for ancient directory cache versions
      that didn't know about microdescriptors.
    - Tor no longer contains workarounds for stat files generated by
      super-old versions of Tor that didn't choose guards sensibly.

@_date: 2015-11-22 20:51:30
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.7.5 is released! 
Hi, all!
Tor 0.2.7.5 is the first stable release in the Tor 0.2.7 series. It
makes no changes beyond those in 0.2.7.4-rc; the summary below lists
all changes in the 0.2.7 series.
You can download the source from the usual place on the website.
Packages should be up in a few days.
(Below is the 0.2.7.5 changelog.  See the ReleaseNotes for a complete
list of everything that changed in 0.2.7)
Changes in version 0.2.7.5 - 2015-11-20
  The Tor 0.2.7 release series is dedicated to the memory of Tor user
  and privacy advocate Caspar Bowden (1961-2015). Caspar worked
  tirelessly to advocate human rights regardless of national borders,
  and oppose the encroachments of mass surveillance. He opposed national
  exceptionalism, he brought clarity to legal and policy debates, he
  understood and predicted the impact of mass surveillance on the world,
  and he laid the groundwork for resisting it. While serving on the Tor
  Project's board of directors, he brought us his uncompromising focus
  on technical excellence in the service of humankind. Caspar was an
  inimitable force for good and a wonderful friend. He was kind,
  humorous, generous, gallant, and believed we should protect one
  another without exception. We honor him here for his ideals, his
  efforts, and his accomplishments. Please honor his memory with works
  that would make him proud.
  Tor 0.2.7.5 is the first stable release in the Tor 0.2.7 series.
  The 0.2.7 series adds a more secure identity key type for relays,
  improves cryptography performance, resolves several longstanding
  hidden-service performance issues, improves controller support for
  hidden services, and includes small bugfixes and performance
  improvements throughout the program. This release series also includes
  more tests than before, and significant simplifications to which parts
  of Tor invoke which others.
  (This release contains no code changes since 0.2.7.4-rc.)

@_date: 2015-10-22 09:17:49
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.7.4-rc is released 
Tor 0.2.7.4-rc is the second release candidate in the 0.2.7 series. It
  fixes some important memory leaks, and a scary-looking (but mostly
  harmless in practice) invalid-read bug. It also has a few small
  bugfixes, notably fixes for compilation and portability on different
  platforms. If no further significant bounds are found, the next
  release will the the official stable release.
You can download the source from the usual place on the website.
Packages should be up in a few days.
NOTE: This is a release candidate.  We think we've squashed most of
the bugs, but there are probably a few left over.
Changes in version 0.2.7.4-rc - 2015-10-21
  o Major bugfixes (security, correctness):
    - Fix an error that could cause us to read 4 bytes before the
      beginning of an openssl string. This bug could be used to cause
      Tor to crash on systems with unusual malloc implementations, or
      systems with unusual hardening installed. Fixes bug 17404; bugfix
      on 0.2.3.6-alpha.
  o Major bugfixes (correctness):
    - Fix a use-after-free bug in validate_intro_point_failure(). Fixes
      bug 17401; bugfix on 0.2.7.3-rc.
  o Major bugfixes (memory leaks):
    - Fix a memory leak in ed25519 batch signature checking. Fixes bug
      17398; bugfix on 0.2.6.1-alpha.
    - Fix a memory leak in rend_cache_failure_entry_free(). Fixes bug
      17402; bugfix on 0.2.7.3-rc.
    - Fix a memory leak when reading an expired signing key from disk.
      Fixes bug 17403; bugfix on 0.2.7.2-rc.
  o Minor features (geoIP):
    - Update geoip and geoip6 to the October 9 2015 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (compilation):
    - Repair compilation with the most recent (unreleased, alpha)
      vesions of OpenSSL 1.1. Fixes part of ticket 17237.
    - Fix an integer overflow warning in test_crypto_slow.c. Fixes bug
      17251; bugfix on 0.2.7.2-alpha.
    - Fix compilation of sandbox.c with musl-libc. Fixes bug 17347;
      bugfix on 0.2.5.1-alpha. Patch from 'jamestk'.
  o Minor bugfixes (portability):
    - Use libexecinfo on FreeBSD to enable backtrace support. Fixes
      part of bug 17151; bugfix on 0.2.5.2-alpha. Patch from
      Marcin Cie?lak.
  o Minor bugfixes (sandbox):
    - Add the "hidserv-stats" filename to our sandbox filter for the
      HiddenServiceStatistics option to work properly. Fixes bug 17354;
      bugfix on tor-0.2.6.2-alpha. Patch from David Goulet.
  o Minor bugfixes (testing):
    - Add unit tests for get_interface_address* failure cases. Fixes bug
      17173; bugfix on 0.2.7.3-rc. Patch by fk/teor.
    - Fix breakage when running 'make check' with BSD make. Fixes bug
      17154; bugfix on 0.2.7.3-rc. Patch by Marcin Cie?lak.
    - Make the get_ifaddrs_* unit tests more tolerant of different
      network configurations. (Don't assume every test box has an IPv4
      address, and don't assume every test box has a non-localhost
      address.) Fixes bug 17255; bugfix on 0.2.7.3-rc. Patch by "teor".
    - Skip backtrace tests when backtrace support is not compiled in.
      Fixes part of bug 17151; bugfix on 0.2.7.1-alpha. Patch from
      Marcin Cie?lak.
  o Documentation:
    - Fix capitalization of SOCKS in sample torrc. Closes ticket 15609.
    - Note that HiddenServicePorts can take a unix domain socket. Closes
      ticket 17364.

@_date: 2015-09-25 12:42:04
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.7.3-rc is released 
This, the first release candidate in the 0.2.7 series, contains
numerous usability fixes for Ed25519 keys, safeguards against several
misconfiguration problems, significant simplifications to Tor's
callgraph, and numerous bugfixes and small features.
This is the most tested release of Tor to date. The unit tests cover
39.40% of the code, and the integration tests (accessible with "make
test-full-online", requiring stem and chutney and a network
connection) raise the coverage to 64.49%.
You can download the source from the usual place on the website.
Packages should be up in a few days.
NOTE: This is a release candidate.  We think we've squashed most of
the bugs, but there are probably a few left over.
Changes in version 0.2.7.3-rc - 2015-09-25
  o Major features (security, hidden services):
    - Hidden services, if using the EntryNodes option, are required to
      use more than one EntryNode, in order to avoid a guard discovery
      attack. (This would only affect people who had configured hidden
      services and manually specified the EntryNodes option with a
      single entry-node. The impact was that it would be easy to
      remotely identify the guard node used by such a hidden service.
      See ticket for more information.) Fixes ticket 14917.
  o Major features (Ed25519 keys, keypinning):
    - The key-pinning option on directory authorities is now advisory-
      only by default. In a future version, or when the AuthDirPinKeys
      option is set, pins are enforced again. Disabling key-pinning
      seemed like a good idea so that we can survive the fallout of any
      usability problems associated with Ed25519 keys. Closes
      ticket 17135.
  o Major features (Ed25519 performance):
    - Improve the speed of Ed25519 operations and Curve25519 keypair
      generation when built targeting 32 bit x86 platforms with SSE2
      available. Implements ticket 16535.
    - Improve the runtime speed of Ed25519 signature verification by
      using Ed25519-donna's batch verification support. Implements
      ticket 16533.
  o Major features (performance testing):
    - The test-network.sh script now supports performance testing.
      Requires corresponding chutney performance testing changes. Patch
      by "teor". Closes ticket 14175.
  o Major features (relay, Ed25519):
    - Significant usability improvements for Ed25519 key management. Log
      messages are better, and the code can recover from far more
      failure conditions. Thanks to "s7r" for reporting and diagnosing
      so many of these!
    - Add a new OfflineMasterKey option to tell Tor never to try loading
      or generating a secret Ed25519 identity key. You can use this in
      combination with tor --keygen to manage offline and/or encrypted
      Ed25519 keys. Implements ticket 16944.
    - Add a --newpass option to allow changing or removing the
      passphrase of an encrypted key with tor --keygen. Implements part
      of ticket 16769.
    - On receiving a HUP signal, check to see whether the Ed25519
      signing key has changed, and reload it if so. Closes ticket 16790.
  o Major bugfixes (relay, Ed25519):
    - Avoid crashing on 'tor --keygen'. Fixes bug 16679; bugfix on
      0.2.7.2-alpha. Reported by "s7r".
    - Improve handling of expired signing keys with offline master keys.
      Fixes bug 16685; bugfix on 0.2.7.2-alpha. Reported by "s7r".
  o Minor features (client-side privacy):
    - New KeyAliveSOCKSAuth option to indefinitely extend circuit
      lifespan when IsolateSOCKSAuth and streams with SOCKS
      authentication are attached to the circuit. This allows
      applications like TorBrowser to manage circuit lifetime on their
      own. Implements feature 15482.
    - When logging malformed hostnames from SOCKS5 requests, respect
      SafeLogging configuration. Fixes bug 16891; bugfix on 0.1.1.16-rc.
  o Minor features (compilation):
    - Give a warning as early as possible when trying to build with an
      unsupported OpenSSL version. Closes ticket 16901.
    - Fail during configure if we're trying to build against an OpenSSL
      built without ECC support. Fixes bug 17109, bugfix on 0.2.7.1-alpha
      which started requiring ECC.
  o Minor features (geoip):
    - Update geoip and geoip6 to the September 3 2015 Maxmind GeoLite2
      Country database.
  o Minor features (hidden services):
    - Relays need to have the Fast flag to get the HSDir flag. As this
      is being written, we'll go from 2745 HSDirs down to 2342, a ~14%
      drop. This change should make some attacks against the hidden
      service directory system harder. Fixes ticket 15963.
    - Turn on hidden service statistics collection by setting the torrc
      option HiddenServiceStatistics to "1" by default. (This keeps
      track only of the fraction of traffic used by hidden services, and
      the total number of hidden services in existence.) Closes
      ticket 15254.
    - Client now uses an introduction point failure cache to know when
      to fetch or keep a descriptor in their cache. Previously, failures
      were recorded implicitly, but not explicitly remembered. Closes
      ticket 16389.
  o Minor features (testing, authorities, documentation):
    - New TestingDirAuthVote{Exit,Guard,HSDir}IsStrict flags to
      explicitly manage consensus flags in testing networks. Patch by
      "robgjansen", modified by "teor". Implements part of ticket 14882.
  o Minor bugfixes (security, exit policies):
    - ExitPolicyRejectPrivate now also rejects the relay's published
      IPv6 address (if any), and any publicly routable IPv4 or IPv6
      addresses on any local interfaces. ticket 17027. Patch by "teor".
      Fixes bug 17027; bugfix on 0.2.0.11-alpha.
  o Minor bug fixes (torrc exit policies):
    - In torrc, "accept6 *" and "reject6 *" ExitPolicy lines now only
      produce IPv6 wildcard addresses. Previously they would produce
      both IPv4 and IPv6 wildcard addresses. Patch by "teor". Fixes part
      of bug 16069; bugfix on 0.2.4.7-alpha.
    - When parsing torrc ExitPolicies, we now warn for a number of cases
      where the user's intent is likely to differ from Tor's actual
      behavior. These include: using an IPv4 address with an accept6 or
      reject6 line; using "private" on an accept6 or reject6 line; and
      including any ExitPolicy lines after accept *:* or reject *:*.
      Related to ticket 16069.
    - When parsing torrc ExitPolicies, we now issue an info-level
      message when expanding an "accept/reject *" line to include both
      IPv4 and IPv6 wildcard addresses. Related to ticket 16069.
    - In each instance above, usage advice is provided to avoid the
      message. Resolves ticket 16069. Patch by "teor". Fixes part of bug
      16069; bugfix on 0.2.4.7-alpha.
  o Minor bugfixes (authority):
    - Don't assign "HSDir" to a router if it isn't Valid and Running.
      Fixes bug 16524; bugfix on 0.2.7.2-alpha.
    - Downgrade log messages about Ed25519 key issues if they are in old
      cached router descriptors. Fixes part of bug 16286; bugfix
      on 0.2.7.2-alpha.
    - When we find an Ed25519 key issue in a cached descriptor, stop
      saying the descriptor was just "uploaded". Fixes another part of
      bug 16286; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (control port):
    - Repair a warning and a spurious result when getting the maximum
      number of file descriptors from the controller. Fixes bug 16697;
      bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (correctness):
    - When calling channel_free_list(), avoid calling smartlist_remove()
      while inside a FOREACH loop. This partially reverts commit
      17356fe7fd96af where the correct SMARTLIST_DEL_CURRENT was
      incorrectly removed. Fixes bug 16924; bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (documentation):
    - Advise users on how to configure separate IPv4 and IPv6 exit
      policies in the manpage and sample torrcs. Related to ticket 16069.
    - Fix the usage message of tor-resolve(1) so that it no longer lists
      the removed -F option. Fixes bug 16913; bugfix on 0.2.2.28-beta.
    - Fix an error in the manual page and comments for
      TestingDirAuthVoteHSDir[IsStrict], which suggested that a HSDir
      required "ORPort connectivity". While this is true, it is in no
      way unique to the HSDir flag. Of all the flags, only HSDirs need a
      DirPort configured in order for the authorities to assign that
      particular flag. Patch by "teor". Fixed as part of 14882; bugfix
      on 0.2.6.3-alpha.
  o Minor bugfixes (Ed25519):
    - Fix a memory leak when reading router descriptors with expired
      Ed25519 certificates. Fixes bug 16539; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Allow bridge authorities to run correctly under the seccomp2
      sandbox. Fixes bug 16964; bugfix on 0.2.5.1-alpha.
    - Allow routers with ed25519 keys to run correctly under the
      seccomp2 sandbox. Fixes bug 16965; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (open file limit):
    - Fix set_max_file_descriptors() to set by default the max open file
      limit to the current limit when setrlimit() fails. Fixes bug
      16274; bugfix on tor- 0.2.0.10-alpha. Patch by dgoulet.
  o Minor bugfixes (portability):
    - Try harder to normalize the exit status of the Tor process to the
      standard-provided range. Fixes bug 16975; bugfix on every version
      of Tor ever.
    - Check correctly for Windows socket errors in the workqueue
      backend. Fixes bug 16741; bugfix on 0.2.6.3-alpha.
    - Fix the behavior of crypto_rand_time_range() when told to consider
      times before 1970. (These times were possible when running in a
      simulated network environment where time()'s output starts at
      zero.) Fixes bug 16980; bugfix on 0.2.7.1-alpha.
    - Restore correct operation of TLS client-cipher detection on
      OpenSSL 1.1. Fixes bug 14047; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (relay):
    - Ensure that worker threads actually exit when a fatal error or
      shutdown is indicated. This fix doesn't currently affect the
      behavior of Tor, because Tor workers never indicates fatal error
      or shutdown except in the unit tests. Fixes bug 16868; bugfix
      on 0.2.6.3-alpha.
    - Unblock threads before releasing the work queue mutex to ensure
      predictable scheduling behavior. Fixes bug 16644; bugfix
      on 0.2.6.3-alpha.
  o Code simplification and refactoring:
    - Change the function that's called when we need to retry all
      downloads so that it only reschedules the downloads to happen
      immediately, rather than launching them all at once itself. This
      further simplifies Tor's callgraph.
    - Move some format-parsing functions out of crypto.c and
      crypto_curve25519.c into crypto_format.c and/or util_format.c.
    - Move the client-only parts of init_keys() into a separate
      function. Closes ticket 16763.
    - Simplify the microdesc_free() implementation so that it no longer
      appears (to code analysis tools) to potentially invoke a huge
      suite of other microdesc functions.
    - Simply the control graph further by deferring the inner body of
      directory_all_unreachable() into a callback. Closes ticket 16762.
    - Treat the loss of an owning controller as equivalent to a SIGTERM
      signal. This removes a tiny amount of duplicated code, and
      simplifies our callgraph. Closes ticket 16788.
    - When generating an event to send to the controller, we no longer
      put the event over the network immediately. Instead, we queue
      these events, and use a Libevent callback to deliver them. This
      change simplifies Tor's callgraph by reducing the number of
      functions from which all other Tor functions are reachable. Closes
      ticket 16695.
    - Wrap Windows-only C files inside ' _WIN32' so that tools
      that try to scan or compile every file on Unix won't decide that
      they are broken.
    - Remove the unused "nulterminate" argument from buf_pullup().
  o Documentation:
    - Recommend a 40 GB example AccountingMax in torrc.sample rather
      than a 4 GB max. Closes ticket 16742.
    - Include the TUNING document in our source tarball. It is referred
      to in the ChangeLog and an error message. Fixes bug 16929; bugfix
      on 0.2.6.1-alpha.
  o Removed code:
    - The internal pure-C tor-fw-helper tool is now removed from the Tor
      distribution, in favor of the pure-Go clone available from
       . The libraries
      used by the C tor-fw-helper are not, in our opinion, very
      confidence- inspiring in their secure-programming techniques.
      Closes ticket 13338.
    - Remove the code that would try to aggressively flush controller
      connections while writing to them. This code was introduced in
      0.1.2.7-alpha, in order to keep output buffers from exceeding
      their limits. But there is no longer a maximum output buffer size,
      and flushing data in this way caused some undesirable recursions
      in our call graph. Closes ticket 16480.
  o Testing:
    - Make "bridges+hs" the default test network. This tests almost all
      tor functionality during make test-network, while allowing tests
      to succeed on non-IPv6 systems. Requires chutney commit 396da92 in
      test-network-bridges-hs. Closes tickets 16945 (tor) and 16946
      (chutney). Patches by "teor".
    - Autodetect CHUTNEY_PATH if the chutney and Tor sources are side-
      by-side in the same parent directory. Closes ticket 16903. Patch
      by "teor".
    - Use environment variables rather than autoconf substitutions to
      send variables from the build system to the test scripts. This
      change should be easier to maintain, and cause 'make distcheck' to
      work better than before. Fixes bug 17148.
    - Add a new set of callgraph analysis scripts that use clang to
      produce a list of which Tor functions are reachable from which
      other Tor functions. We're planning to use these to help simplify
      our code structure by identifying illogical dependencies.
    - Add new 'test-full' and 'test-full-online' targets to run all
      tests, including integration tests with stem and chutney.
    - Make the test-workqueue test work on Windows by initializing the
      network before we begin.
    - New make target (make test-network-all) to run multiple applicable
      chutney test cases. Patch from Teor; closes 16953.
    - Unit test dns_resolve(), dns_clip_ttl() and dns_get_expiry_ttl()
      functions in dns.c. Implements a portion of ticket 16831.
    - When building Tor with testing coverage enabled, run Chutney tests
      (if any) using the 'tor-cov' coverage binary.
    - When running test-network or test-stem, check for the absence of
      stem/chutney before doing any build operations.

@_date: 2016-08-08 17:56:50
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.1-alpha is released 
Hi, everybody!
  Tor 0.2.9.1-alpha is the first alpha release in the 0.2.9 development
  series. It improves our support for hardened builds and compiler
  warnings, deploys some critical infrastructure for improvements to
  hidden services, includes a new timing backend that we hope to use for
  better support for traffic padding, makes it easier for programmers to
  log unexpected events, and contains other small improvements to
  security, correctness, and performance.
You can download the source from the usual place on the website.
Packages should be available over the next several days. Remember
to check the signatures!
Please note: This is an alpha release. You should only try this one if
you are interested in tracking Tor development, testing new features,
making sure that Tor still builds on unusual platforms, or generally
trying to hunt down bugs.
Below are the changes since 0.2.8.6.
Changes in version 0.2.9.1-alpha - 2016-08-08
 o New system requirements:
    - Tor now requires Libevent version 2.0.10-stable or later. Older
      versions of Libevent have less efficient backends for several
      platforms, and lack the DNS code that we use for our server-side
      DNS support. This implements ticket 19554.
    - Tor now requires zlib version 1.2 or later, for security,
      efficiency, and (eventually) gzip support. (Back when we started,
      zlib 1.1 and zlib 1.0 were still found in the wild. 1.2 was
      released in 2003. We recommend the latest version.)
  o Major features (build, hardening):
    - Tor now builds with -ftrapv by default on compilers that support
      it. This option detects signed integer overflow (which C forbids),
      and turns it into a hard-failure. We do not apply this option to
      code that needs to run in constant time to avoid side-channels;
      instead, we use -fwrapv in that code. Closes ticket 17983.
    - When --enable-expensive-hardening is selected, stop applying the
      clang/gcc sanitizers to code that needs to run in constant time.
      Although we are aware of no introduced side-channels, we are not
      able to prove that there are none. Related to ticket 17983.
  o Major features (compilation):
    - Our big list of extra GCC warnings is now enabled by default when
      building with GCC (or with anything like Clang that claims to be
      GCC-compatible). To make all warnings into fatal compilation
      errors, pass --enable-fatal-warnings to configure. Closes
      ticket 19044.
    - Use the Autoconf macro AC_USE_SYSTEM_EXTENSIONS to automatically
      turn on C and POSIX extensions. (Previously, we attempted to do
      this on an ad hoc basis.) Closes ticket 19139.
  o Major features (directory authorities, hidden services):
    - Directory authorities can now perform the shared randomness
      protocol specified by proposal 250. Using this protocol, directory
      authorities generate a global fresh random value every day. In the
      future, this value will be used by hidden services to select
      HSDirs. This release implements the directory authority feature;
      the hidden service side will be implemented in the future as part
      of proposal 224. Resolves ticket 16943; implements proposal 250.
  o Major features (downloading, random exponential backoff):
    - When we fail to download an object from a directory service, wait
      for an (exponentially increasing) randomized amount of time before
      retrying, rather than a fixed interval as we did before. This
      prevents a group of Tor instances from becoming too synchronized,
      or a single Tor instance from becoming too predictable, in its
      download schedule. Closes ticket 15942.
  o Major bugfixes (exit policies):
    - Avoid disclosing exit outbound bind addresses, configured port
      bind addresses, and local interface addresses in relay descriptors
      by default under ExitPolicyRejectPrivate. Instead, only reject
      these (otherwise unlisted) addresses if
      ExitPolicyRejectLocalInterfaces is set. Fixes bug 18456; bugfix on
      0.2.7.2-alpha. Patch by teor.
  o Major bugfixes (hidden service client):
    - Allow Tor clients with appropriate controllers to work with
      FetchHidServDescriptors set to 0. Previously, this option also
      disabled descriptor cache lookup, thus breaking hidden services
      entirely. Fixes bug 18704; bugfix on 0.2.0.20-rc. Patch by "twim".
  o Minor features (build, hardening):
    - Detect and work around a libclang_rt problem that would prevent
      clang from finding __mulodi4() on some 32-bit platforms, and thus
      keep -ftrapv from linking on those systems. Closes ticket 19079.
    - When building on a system without runtime support for the runtime
      hardening options, try to log a useful warning at configuration
      time, rather than an incomprehensible warning at link time. If
      expensive hardening was requested, this warning becomes an error.
      Closes ticket 18895.
  o Minor features (code safety):
    - In our integer-parsing functions, ensure that maxiumum value we
      give is no smaller than the minimum value. Closes ticket 19063;
      patch from U+039b.
  o Minor features (controller):
    - Implement new GETINFO queries for all downloads that use
      download_status_t to schedule retries. This allows controllers to
      examine the schedule for pending downloads. Closes ticket 19323.
    - Allow controllers to configure basic client authorization on
      hidden services when they create them with the ADD_ONION control
      command. Implements ticket 15588. Patch by "special".
    - Fire a STATUS_SERVER controller event whenever the hibernation
      status changes between "awake"/"soft"/"hard". Closes ticket 18685.
  o Minor features (directory authority):
    - Directory authorities now only give the Guard flag to a relay if
      they are also giving it the Stable flag. This change allows us to
      simplify path selection for clients. It should have minimal effect
      in practice, since >99% of Guards already have the Stable flag.
      Implements ticket 18624.
    - Directory authorities now write their v3-status-votes file out to
      disk earlier in the consensus process, so we have a record of the
      votes even if we abort the consensus process. Resolves
      ticket 19036.
  o Minor features (hidden service):
    - Stop being so strict about the payload length of "rendezvous1"
      cells. We used to be locked in to the "TAP" handshake length, and
      now we can handle better handshakes like "ntor". Resolves
      ticket 18998.
  o Minor features (infrastructure, time):
    - Tor now uses the operating system's monotonic timers (where
      available) for internal fine-grained timing. Previously we would
      look at the system clock, and then attempt to compensate for the
      clock running backwards. Closes ticket 18908.
    - Tor now includes an improved timer backend, so that we can
      efficiently support tens or hundreds of thousands of concurrent
      timers, as will be needed for some of our planned anti-traffic-
      analysis work. This code is based on William Ahern's "timeout.c"
      project, which implements a "tickless hierarchical timing wheel".
      Closes ticket 18365.
  o Minor features (logging):
    - Provide a more useful warning message when configured with an
      invalid Nickname. Closes ticket 18300; patch from "icanhasaccount".
    - When dumping unparseable router descriptors, optionally store them
      in separate files, named by digest, up to a configurable size
      limit. You can change the size limit by setting the
      MaxUnparseableDescSizeToLog option, and disable this feature by
      setting that option to 0. Closes ticket 18322.
    - Add a set of macros to check nonfatal assertions, for internal
      use. Migrating more of our checks to these should help us avoid
      needless crash bugs. Closes ticket 18613.
  o Minor features (performance):
    - Changer the "optimistic data" extension from "off by default" to
      "on by default". The default was ordinarily overridden by a
      consensus option, but when clients were bootstrapping for the
      first time, they would not have a consensus to get the option
      from. Changing this default When fetching a consensus for the
      first time, use optimistic data. This saves a round-trip during
      startup. Closes ticket 18815.
  o Minor features (relay, usability):
    - When the directory authorities refuse a bad relay's descriptor,
      encourage the relay operator to contact us. Many relay operators
      won't notice this line in their logs, but it's a win if even a few
      learn why we don't like what their relay was doing. Resolves
      ticket 18760.
  o Minor features (testing):
    - Let backtrace tests work correctly under AddressSanitizer. Fixes
      part of bug 18934; bugfix on 0.2.5.2-alpha.
    - Move the test-network.sh script to chutney, and modify tor's test-
      network.sh to call the (newer) chutney version when available.
      Resolves ticket 19116. Patch by teor.
    - Use the lcov convention for marking lines as unreachable, so that
      we don't count them when we're generating test coverage data.
      Update our coverage tools to understand this convention. Closes
      ticket 16792.
  o Minor bugfixes (bootstrap):
    - Remember the directory we fetched the consensus or previous
      certificates from, and use it to fetch future authority
      certificates. This change improves bootstrapping performance.
      Fixes bug 18963; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (build):
    - The test-stem and test-network makefile targets now depend only on
      the tor binary that they are testing. Previously, they depended on
      "make all". Fixes bug 18240; bugfix on 0.2.8.2-alpha. Based on a
      patch from "cypherpunks".
  o Minor bugfixes (circuits):
    - Make sure extend_info_from_router() is only called on servers.
      Fixes bug 19639; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (compilation):
    - When building with Clang, use a full set of GCC warnings.
      (Previously, we included only a subset, because of the way we
      detected them.) Fixes bug 19216; bugfix on 0.2.0.1-alpha.
  o Minor bugfixes (directory authority):
    - Authorities now sort the "package" lines in their votes, for ease
      of debugging. (They are already sorted in consensus documents.)
      Fixes bug 18840; bugfix on 0.2.6.3-alpha.
    - When parsing a detached signature, make sure we use the length of
      the digest algorithm instead of an hardcoded DIGEST256_LEN in
      order to avoid comparing bytes out-of-bounds with a smaller digest
      length such as SHA1. Fixes bug 19066; bugfix on 0.2.2.6-alpha.
  o Minor bugfixes (documentation):
    - Document the --passphrase-fd option in the tor manpage. Fixes bug
      19504; bugfix on 0.2.7.3-rc.
    - Fix the description of the --passphrase-fd option in the
      tor-gencert manpage. The option is used to pass the number of a
      file descriptor to read the passphrase from, not to read the file
      descriptor from. Fixes bug 19505; bugfix on 0.2.0.20-alpha.
  o Minor bugfixes (ephemeral hidden service):
    - When deleting an ephemeral hidden service, close its intro points
      even if they are not completely open. Fixes bug 18604; bugfix
      on 0.2.7.1-alpha.
  o Minor bugfixes (guard selection):
    - Use a single entry guard even if the NumEntryGuards consensus
      parameter is not provided. Fixes bug 17688; bugfix
      on 0.2.5.6-alpha.
    - Don't mark guards as unreachable if connection_connect() fails.
      That function fails for local reasons, so it shouldn't reveal
      anything about the status of the guard. Fixes bug 14334; bugfix
      on 0.2.3.10-alpha.
  o Minor bugfixes (hidden service client):
    - Increase the minimum number of internal circuits we preemptively
      build from 2 to 3, so a circuit is available when a client
      connects to another onion service. Fixes bug 13239; bugfix
      on 0.1.0.1-rc.
  o Minor bugfixes (logging):
    - When logging a directory ownership mismatch, log the owning
      username correctly. Fixes bug 19578; bugfix on 0.2.2.29-beta.
  o Minor bugfixes (memory leaks):
    - Fix a small, uncommon memory leak that could occur when reading a
      truncated ed25519 key file. Fixes bug 18956; bugfix
      on 0.2.6.1-alpha.
  o Minor bugfixes (testing):
    - Allow clients to retry HSDirs much faster in test networks. Fixes
      bug 19702; bugfix on 0.2.7.1-alpha. Patch by teor.
    - Disable ASAN's detection of segmentation faults while running
      test_bt.sh, so that we can make sure that our own backtrace
      generation code works. Fixes another aspect of bug 18934; bugfix
      on 0.2.5.2-alpha. Patch from "cypherpunks".
    - Fix the test-network-all target on out-of-tree builds by using the
      correct path to the test driver script. Fixes bug 19421; bugfix
      on 0.2.7.3-rc.
  o Minor bugfixes (time):
    - Improve overflow checks in tv_udiff and tv_mdiff. Fixes bug 19483;
      bugfix on all released tor versions.
    - When computing the difference between two times in milliseconds,
      we now round to the nearest millisecond correctly. Previously, we
      could sometimes round in the wrong direction. Fixes bug 19428;
      bugfix on 0.2.2.2-alpha.
  o Minor bugfixes (user interface):
    - Display a more accurate number of suppressed messages in the log
      rate-limiter. Previously, there was a potential integer overflow
      in the counter. Now, if the number of messages hits a maximum, the
      rate-limiter doesn't count any further. Fixes bug 19435; bugfix
      on 0.2.4.11-alpha.
    - Fix a typo in the passphrase prompt for the ed25519 identity key.
      Fixes bug 19503; bugfix on 0.2.7.2-alpha.
  o Code simplification and refactoring:
    - Remove redundant declarations of the MIN macro. Closes
      ticket 18889.
    - Rename tor_dup_addr() to tor_addr_to_str_dup() to avoid confusion.
      Closes ticket 18462; patch from "icanhasaccount".
    - Split the 600-line directory_handle_command_get function into
      separate functions for different URL types. Closes ticket 16698.
  o Documentation:
    - Fix spelling of "--enable-tor2web-mode" in the manpage. Closes
      ticket 19153. Patch from "U+039b".
  o Removed features:
    - Remove support for "GET /tor/bytes.txt" DirPort request, and
      "GETINFO dir-usage" controller request, which were only available
      via a compile-time option in Tor anyway. Feature was added in
      0.2.2.1-alpha. Resolves ticket 19035.
    - There is no longer a compile-time option to disable support for
      TransPort. (If you don't want TransPort; just don't use it.) Patch
      from "U+039b". Closes ticket 19449.
  o Testing:
    - Run more workqueue tests as part of "make check". These had
      previously been implemented, but you needed to know special
      command-line options to enable them.
    - We now have unit tests for our code to reject zlib "compression
      bombs". (Fortunately, the code works fine.)

@_date: 2016-08-24 14:55:52
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.2-alpha is released 
Hi, all!  There is a new alpha release of the Tor source code, with
fixes for several important bugs, and numerous other updates.
(If you are about to reply saying "please take me off this list",
instead please follow these instructions:
 .  You will have to enter the actual email address you used to subscribe.)
You can download the source from the usual place on the website.
Packages should be up in a few days.
(There is also a concurrent release of Tor 0.2.8-7; for stable
announcements, please see tor-announce@ or the blog.)
Changes in version 0.2.9.2-alpha - 2016-08-24
  Tor 0.2.9.2-alpha continues development of the 0.2.9 series with
  several new features and bugfixes. It also includes an important
  authority update and an important bugfix from 0.2.8.7. Everyone who
  sets the ReachableAddresses option, and all bridges, are strongly
  encouraged to upgrade to 0.2.8.7, or to 0.2.9.2-alpha.
  o Directory authority changes (also in 0.2.8.7):
    - The "Tonga" bridge authority has been retired; the new bridge
      authority is "Bifroest". Closes tickets 19728 and 19690.
  o Major bugfixes (client, security, also in 0.2.8.7):
    - Only use the ReachableAddresses option to restrict the first hop
      in a path. In earlier versions of 0.2.8.x, it would apply to
      every hop in the path, with a possible degradation in anonymity
      for anyone using an uncommon ReachableAddress setting. Fixes bug
      19973; bugfix on 0.2.8.2-alpha.
  o Major features (user interface):
    - Tor now supports the ability to declare options deprecated, so
      that we can recommend that people stop using them. Previously,
      this was done in an ad-hoc way. Closes ticket 19820.
  o Major bugfixes (directory downloads):
    - Avoid resetting download status for consensuses hourly, since we
      already have another, smarter retry mechanism. Fixes bug 8625;
      bugfix on 0.2.0.9-alpha.
  o Minor features (config):
    - Warn users when descriptor and port addresses are inconsistent.
      Mitigates bug 13953; patch by teor.
  o Minor features (geoip):
    - Update geoip and geoip6 to the August 2 2016 Maxmind GeoLite2
      Country database.
  o Minor features (user interface):
    - There is a new --list-deprecated-options command-line option to
      list all of the deprecated options. Implemented as part of
      ticket 19820.
  o Minor bugfixes (code style):
    - Fix an integer signedness conversion issue in the case conversion
      tables. Fixes bug 19168; bugfix on 0.2.1.11-alpha.
  o Minor bugfixes (compilation):
    - Build correctly on versions of libevent2 without support for
      evutil_secure_rng_add_bytes(). Fixes bug 19904; bugfix
      on 0.2.5.4-alpha.
    - Fix a compilation warning on GCC versions before 4.6. Our
      ENABLE_GCC_WARNING macro used the word "warning" as an argument,
      when it is also required as an argument to the compiler pragma.
      Fixes bug 19901; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (compilation, also in 0.2.8.7):
    - Remove an inappropriate "inline" in tortls.c that was causing
      warnings on older versions of GCC. Fixes bug 19903; bugfix
      on 0.2.8.1-alpha.
  o Minor bugfixes (fallback directories, also in 0.2.8.7):
    - Avoid logging a NULL string pointer when loading fallback
      directory information. Fixes bug 19947; bugfix on 0.2.4.7-alpha
      and 0.2.8.1-alpha. Report and patch by "rubiate".
  o Minor bugfixes (logging):
    - Log a more accurate message when we fail to dump a microdescriptor.
      Fixes bug 17758; bugfix on 0.2.2.8-alpha. Patch from Daniel Pinto.
  o Minor bugfixes (memory leak):
    - Fix a series of slow memory leaks related to parsing torrc files
      and options. Fixes bug 19466; bugfix on 0.2.1.6-alpha.
  o Deprecated features:
    - A number of DNS-cache-related sub-options for client ports are now
      deprecated for security reasons, and may be removed in a future
      version of Tor. (We believe that client-side DNS cacheing is a bad
      idea for anonymity, and you should not turn it on.) The options
      are: CacheDNS, CacheIPv4DNS, CacheIPv6DNS, UseDNSCache,
      UseIPv4Cache, and UseIPv6Cache.
    - A number of options are deprecated for security reasons, and may
      be removed in a future version of Tor. The options are:
      AllowDotExit, AllowInvalidNodes, AllowSingleHopCircuits,
      AllowSingleHopExits, ClientDNSRejectInternalAddresses,
      CloseHSClientCircuitsImmediatelyOnTimeout,
      CloseHSServiceRendCircuitsImmediatelyOnTimeout,
      ExcludeSingleHopRelays, FastFirstHopPK, TLSECGroup,
      UseNTorHandshake, and WarnUnsafeSocks.
    - The *ListenAddress options are now deprecated as unnecessary: the
      corresponding *Port options should be used instead. These options
      may someday be removed. The affected options are:
      ControlListenAddress, DNSListenAddress, DirListenAddress,
      NATDListenAddress, ORListenAddress, SocksListenAddress,
      and TransListenAddress.
  o Documentation:
    - Correct the IPv6 syntax in our documentation for the
      VirtualAddrNetworkIPv6 torrc option. Closes ticket 19743.
  o Removed code:
    - We no longer include the (dead, deprecated) bufferevent code in
      Tor. Closes ticket 19450. Based on a patch from U+039b.

@_date: 2016-12-02 11:17:25
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.6-rc is released. 
Hi, all!  There is a new release candidate for the Tor source code,
with numerous bugfixes.
You can download the source from the usual place on the website.
Packages should be up in a few days. This should appear in an alpha
TorBrowser release around December 14.
(There is also a concurrent release of Tor 0.2.8.10; for stable
announcements, please see tor-announce@ or the blog.)
Please test this one out: we hope it can become a stable release soon.
Changes in version 0.2.9.6-rc - 2016-12-02
  Tor 0.2.9.6-rc fixes a few remaining bugs found in the previous alpha
  version. We hope that it will be ready to become stable soon, and we
  encourage everyone to test this release. If no showstopper bugs are
  found here, the next 0.2.9 release will be stable.
  o Major bugfixes (relay, resolver, logging):
    - For relays that don't know their own address, avoid attempting a
      local hostname resolve for each descriptor we download. This
      will cut down on the number of "Success: chose address 'x.x.x.x'"
      log lines, and also avoid confusing clock jumps if the resolver
      is slow. Fixes bugs 20423 and 20610; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (client, fascistfirewall):
    - Avoid spurious warnings when ReachableAddresses or FascistFirewall
      is set. Fixes bug 20306; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (hidden services):
    - Stop ignoring the anonymity status of saved keys for hidden
      services and single onion services when first starting tor.
      Instead, refuse to start tor if any hidden service key has been
      used in a different hidden service anonymity mode. Fixes bug
      20638; bugfix on 17178 in 0.2.9.3-alpha; reported by ahf.
  o Minor bugfixes (portability):
    - Work around a bug in the OSX 10.12 SDK that would prevent us from
      successfully targeting earlier versions of OSX. Resolves
      ticket 20235.
    - Run correctly when built on Windows build environments that
      require _vcsprintf(). Fixes bug 20560; bugfix on 0.2.2.11-alpha.
  o Minor bugfixes (single onion services, Tor2web):
    - Stop complaining about long-term one-hop circuits deliberately
      created by single onion services and Tor2web. These log messages
      are intended to diagnose issue 8387, which relates to circuits
      hanging around forever for no reason. Fixes bug 20613; bugfix on
      0.2.9.1-alpha. Reported by "pastly".
  o Minor bugfixes (unit tests):
    - Stop spurious failures in the local interface address discovery
      unit tests. Fixes bug 20634; bugfix on 0.2.8.1-alpha; patch by
      Neel Chauhan.
  o Documentation:
    - Correct the minimum bandwidth value in torrc.sample, and queue a
      corresponding change for torrc.minimal. Closes ticket 20085.

@_date: 2016-12-12 08:23:29
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.7-rc is released: small changes, nearly done! 
Hi, all!  I just tagged and uploaded Tor 0.2.9.7-rc.  The source is
available at the usual place in the website.  Other packages should be
available soon.  This Tor release will probably go into the hardened
TB series coming out in the next couple of days. (I hear that
0.2.9.6-rc will be in the regular alphas, since those builds froze a
little before I finished this Tor release.)
We're rapidly running out of serious bugs to fix in 0.2.9.x, so this
is probably the last release candidate before stable ... unless you
find bugs while testing!  Please try these releases, and let us know
if anything breaks.  Testing either 0.2.9.6-rc or 0.2.9.7-rc would be
quite helpful.
Changes in version 0.2.9.7-rc - 2016-12-12
  Tor 0.2.9.7-rc fixes a few small bugs remaining in Tor 0.2.9.6-rc,
  including a few that had prevented tests from passing on
  some platforms.
  o Minor features (geoip):
    - Update geoip and geoip6 to the December 7 2016 Maxmind GeoLite2
      Country database.
  o Minor bugfix (build):
    - The current Git revision when building from a local repository is
      now detected correctly when using git worktrees. Fixes bug 20492;
      bugfix on 0.2.3.9-alpha.
  o Minor bugfixes (directory authority):
    - When computing old Tor protocol line version in protover, we were
      looking at 0.2.7.5 twice instead of a specific case for
      0.2.9.1-alpha. Fixes bug 20810; bugfix on tor-0.2.9.4-alpha.
  o Minor bugfixes (download scheduling):
    - Resolve a "bug" warning when considering a download schedule whose
      delay had approached INT_MAX. Fixes 20875; bugfix on 0.2.9.5-alpha.
  o Minor bugfixes (logging):
    - Downgrade a harmless log message about the
      pending_entry_connections list from "warn" to "info". Mitigates
      bug 19926.
  o Minor bugfixes (memory leak):
    - Fix a small memory leak when receiving AF_UNIX connections on a
      SocksPort. Fixes bug 20716; bugfix on 0.2.6.3-alpha.
    - When moving a signed descriptor object from a source to an
      existing destination, free the allocated memory inside that
      destination object. Fixes bug 20715; bugfix on tor-0.2.8.3-alpha.
  o Minor bugfixes (memory leak, use-after-free, linux seccomp2 sandbox):
    - Fix a memory leak and use-after-free error when removing entries
      from the sandbox's getaddrinfo() cache. Fixes bug 20710; bugfix on
      0.2.5.5-alpha. Patch from "cypherpunks".
  o Minor bugfixes (portability):
    - Use the correct spelling of MAC_OS_X_VERSION_10_12 on configure.ac
      Fixes bug 20935; bugfix on 0.2.9.6-rc.
  o Minor bugfixes (unit tests):
    - Stop expecting NetBSD unit tests to report success for ipfw. Part
      of a fix for bug 19960; bugfix on 0.2.9.5-alpha.
    - Fix tolerances in unit tests for monotonic time comparisons
      between nanoseconds and microseconds. Previously, we accepted a 10
      us difference only, which is not realistic on every platform's
      clock_gettime(). Fixes bug 19974; bugfix on 0.2.9.1-alpha.
    - Remove a double-free in the single onion service unit test. Stop
      ignoring a return value. Make future changes less error-prone.
      Fixes bug 20864; bugfix on 0.2.9.6-rc.

@_date: 2016-12-19 14:19:17
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.0.1-alpha is out! 
(Also, Tor 0.2.9.8 and Tor 0.2.8.12 are out.  If you didn't know, you
should subscribe to tor-announce an/or read the Tor blog!)
You can find the Tor 0.3.0.1-alpha source on the website at the usual
place.  It's an alpha, so please expect plenty of bugs, and be ready
to report them.  Packages should be out over the next weeks -- I'd
expect this to hit Tor Browser alphas by the end of January or so.
Changes in version 0.3.0.1-alpha - 2016-12-19
  Tor 0.3.0.1-alpha is the first alpha release in the 0.3.0 development
  series. It strengthens Tor's link and circuit handshakes by
  identifying relays by their Ed25519 keys, improves the algorithm that
  clients use to choose and maintain their list of guards, and includes
  additional backend support for the next-generation hidden service
  design. It also contains numerous other small features and
  improvements to security, correctness, and performance.
  Below are the changes since 0.2.9.8.
  o Major features (guard selection algorithm):
    - Tor's guard selection algorithm has been redesigned from the
      ground up, to better support unreliable networks and restrictive
      sets of entry nodes, and to better resist guard-capture attacks by
      hostile local networks. Implements proposal 271; closes
      ticket 19877.
  o Major features (next-generation hidden services):
    - Relays can now handle v3 ESTABLISH_INTRO cells as specified by
      prop224 aka "Next Generation Hidden Services". Service and clients
      don't use this functionality yet. Closes ticket 19043. Based on
      initial code by Alec Heifetz.
    - Relays now support the HSDir version 3 protocol, so that they can
      can store and serve v3 descriptors. This is part of the next-
      generation onion service work detailled in proposal 224. Closes
      ticket 17238.
  o Major features (protocol, ed25519 identity keys):
    - Relays now use Ed25519 to prove their Ed25519 identities and to
      one another, and to clients. This algorithm is faster and more
      secure than the RSA-based handshake we've been doing until now.
      Implements the second big part of proposal 220; Closes
      ticket 15055.
    - Clients now support including Ed25519 identity keys in the EXTEND2
      cells they generate. By default, this is controlled by a consensus
      parameter, currently disabled. You can turn this feature on for
      testing by setting ExtendByEd25519ID in your configuration. This
      might make your traffic appear different than the traffic
      generated by other users, however. Implements part of ticket
      15056; part of proposal 220.
    - Relays now understand requests to extend to other relays by their
      Ed25519 identity keys. When an Ed25519 identity key is included in
      an EXTEND2 cell, the relay will only extend the circuit if the
      other relay can prove ownership of that identity. Implements part
      of ticket 15056; part of proposal 220.
  o Major bugfixes (scheduler):
    - Actually compare circuit policies in ewma_cmp_cmux(). This bug
      caused the channel scheduler to behave more or less randomly,
      rather than preferring channels with higher-priority circuits.
      Fixes bug 20459; bugfix on 0.2.6.2-alpha.
  o Minor features (controller):
    - When HSFETCH arguments cannot be parsed, say "Invalid argument"
      rather than "unrecognized." Closes ticket 20389; patch from
      Ivan Markin.
  o Minor features (diagnostic, directory client):
    - Warn when we find an unexpected inconsistency in directory
      download status objects. Prevents some negative consequences of
      bug 20593.
  o Minor features (directory authority):
    - Add a new authority-only AuthDirTestEd25519LinkKeys option (on by
      default) to control whether authorities should try to probe relays
      by their Ed25519 link keys. This option will go away in a few
      releases--unless we encounter major trouble in our ed25519 link
      protocol rollout, in which case it will serve as a safety option.
  o Minor features (directory cache):
    - Relays and bridges will now refuse to serve the consensus they
      have if they know it is too old for a client to use. Closes
      ticket 20511.
  o Minor features (ed25519 link handshake):
    - Advertise support for the ed25519 link handshake using the
      subprotocol-versions mechanism, so that clients can tell which
      relays can identity themselves by Ed25519 ID. Closes ticket 20552.
  o Minor features (fingerprinting resistence, authentication):
    - Extend the length of RSA keys used for TLS link authentication to
      2048 bits. (These weren't used for forward secrecy; for forward
      secrecy, we used P256.) Closes ticket 13752.
  o Minor features (infrastructure):
    - Implement smartlist_add_strdup() function. Replaces the use of
      smartlist_add(sl, tor_strdup(str)). Closes ticket 20048.
  o Minor bugfixes (client):
    - When clients that use bridges start up with a cached consensus on
      disk, they were ignoring it and downloading a new one. Now they
      use the cached one. Fixes bug 20269; bugfix on 0.2.3.12-alpha.
  o Minor bugfixes (configuration):
    - Accept non-space whitespace characters after the severity level in
      the `Log` option. Fixes bug 19965; bugfix on 0.2.1.1-alpha.
    - Support "TByte" and "TBytes" units in options given in bytes.
      "TB", "terabyte(s)", "TBit(s)" and "terabit(s)" were already
      supported. Fixes bug 20622; bugfix on 0.2.0.14-alpha.
  o Minor bugfixes (consensus weight):
    - Add new consensus method that initializes bw weights to 1 instead
      of 0. This prevents a zero weight from making it all the way to
      the end (happens in small testing networks) and causing an error.
      Fixes bug 14881; bugfix on 0.2.2.17-alpha.
  o Minor bugfixes (descriptors):
    - Correctly recognise downloaded full descriptors as valid, even
      when using microdescriptors as circuits. This affects clients with
      FetchUselessDescriptors set, and may affect directory authorities.
      Fixes bug 20839; bugfix on 0.2.3.2-alpha.
  o Minor bugfixes (directory system):
    - Download all consensus flavors, descriptors, and authority
      certificates when FetchUselessDescriptors is set, regardless of
      whether tor is a directory cache or not. Fixes bug 20667; bugfix
      on all recent tor versions.
    - Bridges and relays now use microdescriptors (like clients do)
      rather than old-style router descriptors. Now bridges will blend
      in with clients in terms of the circuits they build. Fixes bug
      6769; bugfix on 0.2.3.2-alpha.
  o Minor bugfixes (ed25519 certificates):
    - Correctly interpret ed25519 certificates that would expire some
      time after 19 Jan 2038. Fixes bug 20027; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (hidden services):
    - Stop ignoring misconfigured hidden services. Instead, refuse to
      start tor until the misconfigurations have been corrected. Fixes
      bug 20559; bugfix on multiple commits in 0.2.7.1-alpha
      and earlier.
  o Minor bugfixes (memory leak at exit):
    - Fix a small harmless memory leak at exit of the previously unused
      RSA->Ed identity cross-certificate. Fixes bug 17779; bugfix
      on 0.2.7.2-alpha.
  o Minor bugfixes (util):
    - When finishing writing a file to disk, if we were about to replace
      the file with the temporary file created before and we fail to
      replace it, remove the temporary file so it doesn't stay on disk.
      Fixes bug 20646; bugfix on tor-0.2.0.7-alpha. Patch by fk.
  o Minor bugfixes (Windows):
    - Check for getpagesize before using it to mmap files. This fixes
      compilation in some MinGW environments. Fixes bug 20530; bugfix on
      0.1.2.1-alpha. Reported by "ice".
  o Code simplification and refactoring:
    - Abolish all global guard context in entrynodes.c; replace with new
      guard_selection_t structure as preparation for proposal 271.
      Closes ticket 19858.
    - Introduce rend_service_is_ephemeral() that tells if given onion
      service is ephemeral. Replace unclear NULL-checkings for service
      directory with this function. Closes ticket 20526.
    - Extract magic numbers in circuituse.c into defined variables.
    - Refactor circuit_is_available_for_use to remove unnecessary check.
    - Refactor circuit_predict_and_launch_new for readability and
      testability. Closes ticket 18873.
    - Refactor large if statement in purpose_needs_anonymity to use
      switch statement instead. Closes part of ticket 20077.
    - Refactor the hashing API to return negative values for errors, as
      is done as throughout the codebase. Closes ticket 20717.
    - Remove data structures that were used to index or_connection
      objects by their RSA identity digests. These structures are fully
      redundant with the similar structures used in the
      channel abstraction.
    - Remove duplicate code in the channel_write_*cell() functions.
      Closes ticket 13827; patch from Pingl.
    - Remove redundant behavior of is_sensitive_dir_purpose, refactor to
      use only purpose_needs_anonymity. Closes part of ticket 20077.
    - The code to generate and parse EXTEND and EXTEND2 cells has been
      replaced with code automatically generated by the
      "trunnel" utility.
  o Documentation:
    - Include the "TBits" unit in Tor's man page. Fixes part of bug
      20622; bugfix on tor-0.2.5.1-alpha.
    - Change '1' to 'weight_scale' in consensus bw weights calculation
      comments, as that is reality. Closes ticket 20273. Patch
      from pastly.
    - Correct the value for AuthDirGuardBWGuarantee in the manpage, from
      250 KBytes to 2 MBytes. Fixes bug 20435; bugfix
      on tor-0.2.5.6-alpha.
    - Stop the man page from incorrectly stating that HiddenServiceDir
      must already exist. Fixes 20486.
    - Clarify that when ClientRejectInternalAddresses is enabled (which
      is the default), multicast DNS hostnames for machines on the local
      network (of the form *.local) are also rejected. Closes
      ticket 17070.
  o Removed features:
    - The AuthDirMaxServersPerAuthAddr option no longer exists: The same
      limit for relays running on a single IP applies to authority IP
      addresses as well as to non-authority IP addresses. Closes
      ticket 20960.
    - The UseDirectoryGuards torrc option no longer exists: all users
      that use entry guards will also use directory guards. Related to
      proposal 271; implements part of ticket 20831.
  o Testing:
    - New unit tests for tor_htonll(). Closes ticket 19563. Patch
      from "overcaffeinated".
    - Perform the coding style checks when running the tests and fail
      when coding style violations are found. Closes ticket 5500.
    - Add tests for networkstatus_compute_bw_weights_v10.
    - Add unit tests circuit_predict_and_launch_new.
    - Extract dummy_origin_circuit_new so it can be used by other
      test functions.

@_date: 2016-02-04 18:24:03
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.8.1-alpha is released. 
Tor 0.2.8.1-alpha is the first alpha release in its series. It
  includes numerous small features and bugfixes against previous Tor
  versions, and numerous small infrastructure improvements. The most
  notable features are a set of improvements to the directory subsystem.
You can download the source from the usual place on the website.
Packages should be available over the next several days.
PLEASE NOTE: This is an alpha release.  Expect a lot of bugs.  Only
run this release if you're willing to find bugs and report them. :)
Changes in version 0.2.8.1-alpha - 2016-02-04
  Tor 0.2.8.1-alpha is the first alpha release in its series. It
  includes numerous small features and bugfixes against previous Tor
  versions, and numerous small infrastructure improvements. The most
  notable features are a set of improvements to the directory subsystem.
  o Major features (security, Linux):
    - When Tor starts as root on Linux and is told to switch user ID, it
      can now retain the capability to bind to low ports. By default,
      Tor will do this only when it's switching user ID and some low
      ports have been configured. You can change this behavior with the
      new option KeepBindCapabilities. Closes ticket 8195.
  o Major features (directory system):
    - When bootstrapping multiple consensus downloads at a time, use the
      first one that starts downloading, and close the rest. This
      reduces failures when authorities or fallback directories are slow
      or down. Together with the code for feature 15775, this feature
      should reduces failures due to fallback churn. Implements ticket
      4483. Patch by "teor". Implements IPv4 portions of proposal 210 by
      "mikeperry" and "teor".
    - Include a trial list of default fallback directories, based on an
      opt-in survey of suitable relays. Doing this should make clients
      bootstrap more quickly and reliably, and reduce the load on the
      directory authorities. Closes ticket 15775. Patch by "teor".
      Candidates identified using an OnionOO script by "weasel", "teor",
      "gsathya", and "karsten".
    - Previously only relays that explicitly opened a directory port
      (DirPort) accepted directory requests from clients. Now all
      relays, with and without a DirPort, accept and serve tunneled
      directory requests that they receive through their ORPort. You can
      disable this behavior using the new DirCache option. Closes
      ticket 12538.
  o Major key updates:
    - Update the V3 identity key for the dannenberg directory authority:
      it was changed on 18 November 2015. Closes task 17906. Patch
      by "teor".
  o Minor features (security, clock):
    - Warn when the system clock appears to move back in time (when the
      state file was last written in the future). Tor doesn't know that
      consensuses have expired if the clock is in the past. Patch by
      "teor". Implements ticket 17188.
  o Minor features (security, exit policies):
    - ExitPolicyRejectPrivate now rejects more private addresses by
      default. Specifically, it now rejects the relay's outbound bind
      addresses (if configured), and the relay's configured port
      addresses (such as ORPort and DirPort). Fixes bug 17027; bugfix on
      0.2.0.11-alpha. Patch by "teor".
  o Minor features (security, memory erasure):
    - Set the unused entries in a smartlist to NULL. This helped catch
      a (harmless) bug, and shouldn't affect performance too much.
      Implements ticket 17026.
    - Use SecureMemoryWipe() function to securely clean memory on
      Windows. Previously we'd use OpenSSL's OPENSSL_cleanse() function.
      Implements feature 17986.
    - Use explicit_bzero or memset_s when present. Previously, we'd use
      OpenSSL's OPENSSL_cleanse() function. Closes ticket 7419; patches
      from  and .
    - Make memwipe() do nothing when passed a NULL pointer or buffer of
      zero size. Check size argument to memwipe() for underflow. Fixes
      bug 18089; bugfix on 0.2.3.25 and 0.2.4.6-alpha. Reported by "gk",
      patch by "teor".
  o Minor features (security, RNG):
    - Adjust Tor's use of OpenSSL's RNG APIs so that they absolutely,
      positively are not allowed to fail. Previously we depended on
      internal details of OpenSSL's behavior. Closes ticket 17686.
    - Never use the system entropy output directly for anything besides
      seeding the PRNG. When we want to generate important keys, instead
      of using system entropy directly, we now hash it with the PRNG
      stream. This may help resist certain attacks based on broken OS
      entropy implementations. Closes part of ticket 17694.
    - Use modern system calls (like getentropy() or getrandom()) to
      generate strong entropy on platforms that have them. Closes
      ticket 13696.
  o Minor features (accounting):
    - Added two modes to the AccountingRule option: One for limiting
      only the number of bytes sent ("AccountingRule out"), and one for
      limiting only the number of bytes received ("AccountingRule in").
      Closes ticket 15989; patch from "unixninja92".
  o Minor features (build):
    - Since our build process now uses "make distcheck", we no longer
      force "make dist" to depend on "make check". Closes ticket 17893;
      patch from "cypherpunks."
    - Tor now builds successfully with the recent OpenSSL 1.1
      development branch, and with the latest LibreSSL. Closes tickets
      17549, 17921, and 17984.
  o Minor features (controller):
    - Adds the FallbackDir entries to 'GETINFO config/defaults'. Closes
      tickets 16774 and 17817. Patch by George Tankersley.
    - New 'GETINFO hs/service/desc/id/' command to retrieve a hidden
      service descriptor from a service's local hidden service
      descriptor cache. Closes ticket 14846.
    - Add 'GETINFO exit-policy/reject-private/[default,relay]', so
      controllers can examine the the reject rules added by
      ExitPolicyRejectPrivate. This makes it easier for stem to display
      exit policies.
  o Minor features (crypto):
    - Add SHA512 support to crypto.c. Closes ticket 17663; patch from
      George Tankersley.
    - Add SHA3 and SHAKE support to crypto.c. Closes ticket 17783.
    - When allocating a digest state object, allocate no more space than
      we actually need. Previously, we would allocate as much space as
      the state for the largest algorithm would need. This change saves
      up to 672 bytes per circuit. Closes ticket 17796.
    - Improve performance when hashing non-multiple of 8 sized buffers,
      based on Andrew Moon's public domain SipHash-2-4 implementation.
      Fixes bug 17544; bugfix on 0.2.5.3-alpha.
  o Minor features (directory downloads):
    - Wait for busy authorities and fallback directories to become non-
      busy when bootstrapping. (A similar change was made in 6c443e987d
      for directory caches chosen from the consensus.) Closes ticket
      17864; patch by "teor".
    - Add UseDefaultFallbackDirs, which enables any hard-coded fallback
      directory mirrors. The default is 1; set it to 0 to disable
      fallbacks. Implements ticket 17576. Patch by "teor".
  o Minor features (geoip):
    - Update geoip and geoip6 to the January 5 2016 Maxmind GeoLite2
      Country database.
  o Minor features (IPv6):
    - Add an argument 'ipv6=address:orport' to the DirAuthority and
      FallbackDir torrc options, to specify an IPv6 address for an
      authority or fallback directory. Add hard-coded ipv6 addresses for
      directory authorities that have them. Closes ticket 17327; patch
      from Nick Mathewson and "teor".
    - Add address policy assume_action support for IPv6 addresses.
    - Limit IPv6 mask bits to 128.
    - Warn when comparing against an AF_UNSPEC address in a policy, it's
      almost always a bug. Closes ticket 17863; patch by "teor".
    - Allow users to configure directory authorities and fallback
      directory servers with IPv6 addresses and ORPorts. Resolves
      ticket 6027.
    - routerset_parse now accepts IPv6 literal addresses. Fixes bug
      17060; bugfix on 0.2.1.3-alpha. Patch by "teor".
    - Make tor_ersatz_socketpair work on IPv6-only systems. Fixes bug
      17638; bugfix on 0.0.2pre8. Patch by "teor".
  o Minor features (logging):
    - When logging to syslog, allow a tag to be added to the syslog
      identity (the string prepended to every log message). The tag can
      be configured with SyslogIdentityTag and defaults to none. Setting
      it to "foo" will cause logs to be tagged as "Tor-foo". Closes
      ticket 17194.
  o Minor features (portability):
    - Use timingsafe_memcmp() where available. Closes ticket 17944;
      patch from .
  o Minor features (relay, address discovery):
    - Add a family argument to get_interface_addresses_raw() and
      subfunctions to make network interface address interogation more
      efficient. Now Tor can specifically ask for IPv4, IPv6 or both
      types of interfaces from the operating system. Resolves
      ticket 17950.
    - When get_interface_address6_list(.,AF_UNSPEC,.) is called and
      fails to enumerate interface addresses using the platform-specific
      API, have it rely on the UDP socket fallback technique to try and
      find out what IP addresses (both IPv4 and IPv6) our machine has.
      Resolves ticket 17951.
  o Minor features (replay cache):
    - The replay cache now uses SHA256 instead of SHA1. Implements
      feature 8961. Patch by "teor", issue reported by "rransom".
  o Minor features (unix file permissions):
    - Defer creation of Unix sockets until after setuid. This avoids
      needing CAP_CHOWN and CAP_FOWNER when using systemd's
      CapabilityBoundingSet, or chown and fowner when using SELinux.
      Implements part of ticket 17562. Patch from Jamie Nguyen.
    - If any directory created by Tor is marked as group readable, the
      filesystem group is allowed to be either the default GID or the
      root user. Allowing root to read the DataDirectory prevents the
      need for CAP_READ_SEARCH when using systemd's
      CapabilityBoundingSet, or dac_read_search when using SELinux.
      Implements part of ticket 17562. Patch from Jamie Nguyen.
    - Introduce a new DataDirectoryGroupReadable option. If it is set to
      1, the DataDirectory will be made readable by the default GID.
      Implements part of ticket 17562. Patch from Jamie Nguyen.
  o Minor bugfixes (accounting):
    - The max bandwidth when using 'AccountRule sum' is now correctly
      logged. Fixes bug 18024; bugfix on 0.2.6.1-alpha. Patch
      from "unixninja92".
  o Minor bugfixes (code correctness):
    - When closing an entry connection, generate a warning if we should
      have sent an end cell for it but we haven't. Fixes bug 17876;
      bugfix on 0.2.3.2-alpha.
    - Assert that allocated memory held by the reputation code is freed
      according to its internal counters. Fixes bug 17753; bugfix
      on tor-0.1.1.1-alpha.
    - Assert when the TLS contexts fail to initialize. Fixes bug 17683;
      bugfix on 0.0.6.
  o Minor bugfixes (compilation):
    - Mark all object files that include micro-revision.i as depending
      on it, so as to make parallel builds more reliable. Fixes bug
      17826; bugfix on 0.2.5.1-alpha.
    - Don't try to use the pthread_condattr_setclock() function unless
      it actually exists. Fixes compilation on NetBSD-6.x. Fixes bug
      17819; bugfix on 0.2.6.3-alpha.
    - Fix backtrace compilation on FreeBSD. Fixes bug 17827; bugfix
      on tor-0.2.5.2-alpha.
    - Fix compilation of sandbox.c with musl-libc. Fixes bug 17347;
      bugfix on 0.2.5.1-alpha. Patch from 'jamestk'.
    - Fix search for libevent libraries on OpenBSD (and other systems
      that install libevent 1 and libevent 2 in parallel). Fixes bug
      16651; bugfix on 0.1.0.7-rc. Patch from "rubiate".
    - Isolate environment variables meant for tests from the rest of the
      build system. Fixes bug 17818; bugfix on tor-0.2.7.3-rc.
    - Replace usage of 'INLINE' with 'inline'. Fixes bug 17804; bugfix
      on tor-0.0.2pre8.
    - Remove config.log only from make distclean, not from make clean.
      Fixes bug 17924; bugfix on 0.2.4.1-alpha.
  o Minor bugfixes (crypto):
    - Check the return value of HMAC() and assert on failure. Fixes bug
      17658; bugfix on 0.2.3.6-alpha. Patch by "teor".
  o Minor bugfixes (fallback directories):
    - Mark fallbacks as "too busy" when they return a 503 response,
      rather than just marking authorities. Fixes bug 17572; bugfix on
      0.2.4.7-alpha. Patch by "teor".
  o Minor bugfixes (IPv6):
    - Update the limits in max_dl_per_request for IPv6 address length.
      Fixes bug 17573; bugfix on 0.2.1.5-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Fix a crash when using offline master ed25519 keys with the Linux
      seccomp2 sandbox enabled. Fixes bug 17675; bugfix on 0.2.7.3-alpha.
  o Minor bugfixes (logging):
    - In log messages that include a function name, use __FUNCTION__
      instead of __PRETTY_FUNCTION__. In GCC, these are synonymous, but
      with clang __PRETTY_FUNCTION__ has extra information we don't
      need. Fixes bug 16563; bugfix on 0.0.2pre8. Fix by Tom van
      der Woerdt.
    - Remove needless quotes from a log message about unparseable
      addresses. Fixes bug 17843; bugfix on 0.2.3.3-alpha.
  o Minor bugfixes (portability):
    - Remove an  from configure.ac so that we correctly detect the
      presence of in6_addr.s6_addr32. Fixes bug 17923; bugfix
      on 0.2.0.13-alpha.
  o Minor bugfixes (relays):
    - Check that both the ORPort and DirPort (if present) are reachable
      before publishing a relay descriptor. Otherwise, relays publish a
      descriptor with DirPort 0 when the DirPort reachability test takes
      longer than the ORPort reachability test. Fixes bug 18050; bugfix
      on 0.1.0.1-rc. Reported by "starlight", patch by "teor".
  o Minor bugfixes (relays, hidden services):
    - Refuse connection requests to private OR addresses unless
      ExtendAllowPrivateAddresses is set. Previously, tor would connect,
      then refuse to send any cells to a private address. Fixes bugs
      17674 and 8976; bugfix on 0.2.3.21-rc. Patch by "teor".
  o Minor bugfixes (safe logging):
    - When logging a malformed hostname received through socks4, scrub
      it if SafeLogging says we should. Fixes bug 17419; bugfix
      on 0.1.1.16-rc.
  o Minor bugfixes (statistics code):
    - Consistently check for overflow in round_*_to_next_multiple_of
      functions, and add unit tests with additional and maximal values.
      Fixes part of bug 13192; bugfix on 0.2.2.1-alpha.
    - Handle edge cases in the laplace functions: avoid division by
      zero, avoid taking the log of zero, and silence clang type
      conversion warnings using round and trunc. Add unit tests for edge
      cases with maximal values. Fixes part of bug 13192; bugfix
      on 0.2.6.2-alpha.
  o Minor bugfixes (testing):
    - The test for log_heartbeat was incorrectly failing in timezones
      with non-integer offsets. Instead of comparing the end of the time
      string against a constant, compare it to the output of
      format_local_iso_time when given the correct input. Fixes bug
      18039; bugfix on 0.2.5.4-alpha.
    - Make unit tests pass on IPv6-only systems, and systems without
      localhost addresses (like some FreeBSD jails). Fixes bug 17632;
      bugfix on 0.2.7.3-rc. Patch by "teor".
    - Fix a memory leak in the ntor test. Fixes bug 17778; bugfix
      on 0.2.4.8-alpha.
    - Check the full results of SHA256 and SHA512 digests in the unit
      tests. Bugfix on 0.2.2.4-alpha. Patch by "teor".
  o Code simplification and refactoring:
    - Move logging of redundant policy entries in
      policies_parse_exit_policy_internal into its own function. Closes
      ticket 17608; patch from "juce".
    - Extract the more complicated parts of circuit_mark_for_close()
      into a new function that we run periodically before circuits are
      freed. This change removes more than half of the functions
      currently in the "blob". Closes ticket 17218.
    - Clean up a little duplicated code in
      crypto_expand_key_material_TAP(). Closes ticket 17587; patch
      from "pfrankw".
    - Decouple the list of streams waiting to be attached to circuits
      from the overall connection list. This change makes it possible to
      attach streams quickly while simplifying Tor's callgraph and
      avoiding O(N) scans of the entire connection list. Closes
      ticket 17590.
    - When a direct directory request fails immediately on launch,
      instead of relaunching that request from inside the code that
      launches it, instead mark the connection for teardown. This change
      simplifies Tor's callback and prevents the directory-request
      launching code from invoking itself recursively. Closes
      ticket 17589
    - Remove code for configuring OpenSSL dynamic locks; OpenSSL doesn't
      use them. Closes ticket 17926.
  o Documentation:
    - Add a description of the correct use of the '--keygen' command-
      line option. Closes ticket 17583; based on text by 's7r'.
    - Document the minimum HeartbeatPeriod value. Closes ticket 15638.
    - Explain actual minima for BandwidthRate. Closes ticket 16382.
    - Fix a minor formatting typo in the manpage. Closes ticket 17791.
    - Mention torspec URL in the manpage and point the reader to it
      whenever we mention a document that belongs in torspce. Fixes
      issue 17392.
  o Removed features:
    - Remove client-side support for connecting to Tor relays running
      versions of Tor before 0.2.3.6-alpha. These relays didn't support
      the v3 TLS handshake protocol, and are no longer allowed on the
      Tor network. Implements the client side of ticket 11150. Based on
      patches by Tom van der Woerdt.
  o Testing:
    - Add unit tests to check for common RNG failure modes, such as
      returning all zeroes, identical values, or incrementing values
      (OpenSSL's rand_predictable feature). Patch by "teor".
    - Log more information when the backtrace tests fail. Closes ticket
      17892. Patch from "cypherpunks."
    - Always test both ed25519 backends, so that we can be sure that our
      batch-open replacement code works. Part of ticket 16794.
    - Cover dns_resolve_impl() in dns.c with unit tests. Implements a
      portion of ticket 16831.
    - More unit tests for compat_libevent.c, procmon.c, tortls.c,
      util_format.c, directory.c, and options_validate.c. Closes tickets
      17075, 17082, 17084, 17003, and 17076 respectively. Patches from
      Ola Bini.
    - Unit tests for directory_handle_command_get. Closes ticket 17004.
      Patch from Reinaldo de Souza Jr.

@_date: 2016-07-07 13:02:18
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.8.5-rc is released 
Tor 0.2.8.5-rc is the second release candidate in the Tor 0.2.8
  series. If we find no new bugs or regressions here, the first stable
  0.2.8 release will be identical to it. It has a few small bugfixes
  against previous versions.
You can download the source from the usual place on the website.
Packages should be available over the next several days. Remember
to check the signatures!
PLEASE NOTE: This is a release candidate. We think that we solved all
of the showstopper bugs, but we also thought the same thing about
0.2.8.4-rc: crucial bugs may remain. Please only run this release if
you're willing to test and find bugs. If no showstopper bugs are
found, we'll be putting out 0.2.8.6 as a stable release.
The changelog follows:
 Changes in version 0.2.8.5-rc - 2016-07-07
  o Directory authority changes:
    - Urras is no longer a directory authority. Closes ticket 19271.
  o Major bugfixes (heartbeat):
    - Fix a regression that would crash Tor when the periodic
      "heartbeat" log messages were disabled. Fixes bug 19454; bugfix on
      tor-0.2.8.1-alpha. Reported by "kubaku".
  o Minor features (build):
    - Tor now again builds with the recent OpenSSL 1.1 development
      branch (tested against 1.1.0-pre6-dev). Closes ticket 19499.
    - When building manual pages, set the timezone to "UTC", so that the
      output is reproducible. Fixes bug 19558; bugfix on 0.2.2.9-alpha.
      Patch from intrigeri.
  o Minor bugfixes (fallback directory selection):
    - Avoid errors during fallback selection if there are no eligible
      fallbacks. Fixes bug 19480; bugfix on 0.2.8.3-alpha. Patch
      by teor.
  o Minor bugfixes (IPv6, microdescriptors):
    - Don't check node addresses when we only have a routerstatus. This
      allows IPv6-only clients to bootstrap by fetching microdescriptors
      from fallback directory mirrors. (The microdescriptor consensus
      has no IPv6 addresses in it.) Fixes bug 19608; bugfix
      on 0.2.8.2-alpha.
  o Minor bugfixes (logging):
    - Reduce pointlessly verbose log messages when directory servers
      can't be found. Fixes bug 18849; bugfix on 0.2.8.3-alpha and
      0.2.8.1-alpha. Patch by teor.
    - When a fallback directory changes its fingerprint from the hard-
      coded fingerprint, log a less severe, more explanatory log
      message. Fixes bug 18812; bugfix on 0.2.8.1-alpha. Patch by teor.
  o Minor bugfixes (Linux seccomp2 sandboxing):
    - Allow statistics to be written to disk when "Sandbox 1" is
      enabled. Fixes bugs 19556 and 19957; bugfix on 0.2.5.1-alpha and
      0.2.6.1-alpha respectively.
  o Minor bugfixes (user interface):
    - Remove a warning message "Service [scrubbed] not found after
      descriptor upload". This message appears when one uses HSPOST
      control command to upload a service descriptor. Since there is
      only a descriptor and no service, showing this message is
      pointless and confusing. Fixes bug 19464; bugfix on 0.2.7.2-alpha.
  o Fallback directory list:
    - Add a comment to the generated fallback directory list that
      explains how to comment out unsuitable fallbacks in a way that's
      compatible with the stem fallback parser.
    - Update fallback whitelist and blacklist based on relay operator
      emails. Blacklist unsuitable (non-working, over-volatile)
      fallbacks. Resolves ticket 19071. Patch by teor.
    - Update hard-coded fallback list to remove unsuitable fallbacks.
      Resolves ticket 19071. Patch by teor.

@_date: 2016-06-15 13:00:22
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.8.4-rc is released 
Tor 0.2.8.4-rc is the first release candidate in the Tor 0.2.8 series.
  If we find no new bugs or regressions here, the first stable 0.2.8
  release will be identical to it. It has a few small bugfixes against
  previous versions.
You can download the source from the usual place on the website.
Packages should be available over the next several days. Remember
to check the signatures!
PLEASE NOTE: This is a release candidate. We think that we solved all
of the showstopper bugs, but crucial bugs may remain. Please only run
this release if you're willing to test and find bugs. If no
showstopper bugs are found, we'll be putting out 0.2.8.5 as a stable
The changelog follows.
Changes in version 0.2.8.4-rc - 2016-06-15
  o Major bugfixes (user interface):
    - Correctly give a warning in the cases where a relay is specified
      by nickname, and one such relay is found, but it is not officially
      Named. Fixes bug 19203; bugfix on 0.2.3.1-alpha.
  o Minor features (build):
    - Tor now builds once again with the recent OpenSSL 1.1 development
      branch (tested against 1.1.0-pre5 and 1.1.0-pre6-dev).
  o Minor features (geoip):
    - Update geoip and geoip6 to the June 7 2016 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (compilation):
    - Cause the unit tests to compile correctly on mingw64 versions that
      lack sscanf. Fixes bug 19213; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (downloading):
    - Predict more correctly whether we'll be downloading over HTTP when
      we determine the maximum length of a URL. This should avoid a
      "BUG" warning about the Squid HTTP proxy and its URL limits. Fixes
      bug 19191.

@_date: 2016-03-28 16:00:51
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.8.2-alpha is released 
Tor 0.2.8.2-alpha is the second alpha in its series. It fixes numerous
  bugs in earlier versions of Tor, including some that prevented
  authorities using Tor 0.2.7.x from running correctly. IPv6 and
  directory support should also be much improved.
You can download the source from the usual place on the website.
Packages should be available over the next several days.
PLEASE NOTE: This is an alpha release.  Expect a lot of bugs.  Only
run this release if you're willing to find bugs and report them. :)
Changes in version 0.2.8.2-alpha - 2016-03-28
Changes in version 0.2.8.2-alpha - 2016-03-28
  Tor 0.2.8.2-alpha is the second alpha in its series. It fixes numerous
  bugs in earlier versions of Tor, including some that prevented
  authorities using Tor 0.2.7.x from running correctly. IPv6 and
  directory support should also be much improved.
  o New system requirements:
    - Tor no longer supports versions of OpenSSL with a broken
      implementation of counter mode. (This bug was present in OpenSSL
      1.0.0, and was fixed in OpenSSL 1.0.0a.) Tor still detects, but no
      longer runs with, these versions.
    - Tor no longer attempts to support platforms where the "time_t"
      type is unsigned. (To the best of our knowledge, only OpenVMS does
      this, and Tor has never actually built on OpenVMS.) Closes
      ticket 18184.
    - Tor now uses Autoconf version 2.63 or later, and Automake 1.11 or
      later (released in 2008 and 2009 respectively). If you are
      building Tor from the git repository instead of from the source
      distribution, and your tools are older than this, you will need to
      upgrade. Closes ticket 17732.
  o Major bugfixes (security, pointers):
    - Avoid a difficult-to-trigger heap corruption attack when extending
      a smartlist to contain over 16GB of pointers. Fixes bug 18162;
      bugfix on 0.1.1.11-alpha, which fixed a related bug incompletely.
      Reported by Guido Vranken.
  o Major bugfixes (bridges, pluggable transports):
    - Modify the check for OR connections to private addresses. Allow
      bridges on private addresses, including pluggable transports that
      ignore the (potentially private) address in the bridge line. Fixes
      bug 18517; bugfix on 0.2.8.1-alpha. Reported by gk, patch by teor.
  o Major bugfixes (compilation):
    - Repair hardened builds under the clang compiler. Previously, our
      use of _FORTIFY_SOURCE would conflict with clang's address
      sanitizer. Fixes bug 14821; bugfix on 0.2.5.4-alpha.
  o Major bugfixes (crash on shutdown):
    - Correctly handle detaching circuits from muxes when shutting down.
      Fixes bug 18116; bugfix on 0.2.8.1-alpha.
    - Fix an assert-on-exit bug related to counting memory usage in
      rephist.c. Fixes bug 18651; bugfix on 0.2.8.1-alpha.
  o Major bugfixes (crash on startup):
    - Fix a segfault during startup: If a Unix domain socket was
      configured as listener (such as a ControlSocket or a SocksPort
      "unix:" socket), and tor was started as root but not configured to
      switch to another user, tor would segfault while trying to string
      compare a NULL value. Fixes bug 18261; bugfix on 0.2.8.1-alpha.
      Patch by weasel.
  o Major bugfixes (dns proxy mode, crash):
    - Avoid crashing when running as a DNS proxy. Fixes bug 16248;
      bugfix on 0.2.0.1-alpha. Patch from "cypherpunks".
  o Major bugfixes (relays, bridge clients):
    - Ensure relays always allow IPv4 OR and Dir connections. Ensure
      bridge clients use the address configured in the bridge line.
      Fixes bug 18348; bugfix on 0.2.8.1-alpha. Reported by sysrqb,
      patch by teor.
  o Major bugfixes (voting):
    - Actually enable support for authorities to match routers by their
      Ed25519 identities. Previously, the code had been written, but
      some debugging code that had accidentally been left in the
      codebase made it stay turned off. Fixes bug 17702; bugfix
      on 0.2.7.2-alpha.
    - When collating votes by Ed25519 identities, authorities now
      include a "NoEdConsensus" flag if the ed25519 value (or lack
      thereof) for a server does not reflect the majority consensus.
      Related to bug 17668; bugfix on 0.2.7.2-alpha.
    - When generating a vote with keypinning disabled, never include two
      entries for the same ed25519 identity. This bug was causing
      authorities to generate votes that they could not parse when a
      router violated key pinning by changing its RSA identity but
      keeping its Ed25519 identity. Fixes bug 17668; fixes part of bug
      18318. Bugfix on 0.2.7.2-alpha.
  o Minor features (security, win32):
    - Set SO_EXCLUSIVEADDRUSE on Win32 to avoid a local port-stealing
      attack. Fixes bug 18123; bugfix on all tor versions. Patch
      by teor.
  o Minor features (bug-resistance):
    - Make Tor survive errors involving connections without a
      corresponding event object. Previously we'd fail with an
      assertion; now we produce a log message. Related to bug 16248.
  o Minor features (build):
    - Detect systems with FreeBSD-derived kernels (such as GNU/kFreeBSD)
      as having possible IPFW support. Closes ticket 18448. Patch from
      Steven Chamberlain.
  o Minor features (code hardening):
    - Use tor_snprintf() and tor_vsnprintf() even in external and low-
      level code, to harden against accidental failures to NUL-
      terminate. Part of ticket 17852. Patch from jsturgix. Found
      with Flawfinder.
  o Minor features (crypto):
    - Validate the hard-coded Diffie-Hellman parameters and ensure that
      p is a safe prime, and g is a suitable generator. Closes
      ticket 18221.
  o Minor features (geoip):
    - Update geoip and geoip6 to the March 3 2016 Maxmind GeoLite2
      Country database.
  o Minor features (hidden service directory):
    - Streamline relay-side hsdir handling: when relays consider whether
      to accept an uploaded hidden service descriptor, they no longer
      check whether they are one of the relays in the network that is
      "supposed" to handle that descriptor. Implements ticket 18332.
  o Minor features (IPv6):
    - Add ClientPreferIPv6DirPort, which is set to 0 by default. If set
      to 1, tor prefers IPv6 directory addresses.
    - Add ClientUseIPv4, which is set to 1 by default. If set to 0, tor
      avoids using IPv4 for client OR and directory connections.
    - Try harder to obey the IP version restrictions "ClientUseIPv4 0",
      "ClientUseIPv6 0", "ClientPreferIPv6ORPort", and
      "ClientPreferIPv6DirPort". Closes ticket 17840; patch by teor.
  o Minor features (linux seccomp2 sandbox):
    - Reject attempts to change our Address with "Sandbox 1" enabled.
      Changing Address with Sandbox turned on would never actually work,
      but previously it would fail in strange and confusing ways. Found
      while fixing 18548.
  o Minor features (robustness):
    - Exit immediately with an error message if the code attempts to use
      Libevent without having initialized it. This should resolve some
      frequently-made mistakes in our unit tests. Closes ticket 18241.
  o Minor features (unix domain sockets):
    - Add a new per-socket option, RelaxDirModeCheck, to allow creating
      Unix domain sockets without checking the permissions on the parent
      directory. (Tor checks permissions by default because some
      operating systems only check permissions on the parent directory.
      However, some operating systems do look at permissions on the
      socket, and tor's default check is unneeded.) Closes ticket 18458.
      Patch by weasel.
  o Minor bugfixes (exit policies, security):
    - Refresh an exit relay's exit policy when interface addresses
      change. Previously, tor only refreshed the exit policy when the
      configured external address changed. Fixes bug 18208; bugfix on
      0.2.7.3-rc. Patch by teor.
  o Minor bugfixes (security, hidden services):
    - Prevent hidden services connecting to client-supplied rendezvous
      addresses that are reserved as internal or multicast. Fixes bug
      8976; bugfix on 0.2.3.21-rc. Patch by dgoulet and teor.
  o Minor bugfixes (build):
    - Do not link the unit tests against both the testing and non-
      testing versions of the static libraries. Fixes bug 18490; bugfix
      on 0.2.7.1-alpha.
    - Avoid spurious failures from configure files related to calling
      exit(0) in TOR_SEARCH_LIBRARY. Fixes bug 18625; bugfix on
      0.2.0.1-alpha. Patch from "cypherpunks".
    - Silence spurious clang-scan warnings in the ed25519_donna code by
      explicitly initializing some objects. Fixes bug 18384; bugfix on
      0.2.7.2-alpha. Patch by teor.
  o Minor bugfixes (client, bootstrap):
    - Count receipt of new microdescriptors as progress towards
      bootstrapping. Previously, with EntryNodes set, Tor might not
      successfully repopulate the guard set on bootstrapping. Fixes bug
      16825; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (code correctness):
    - Update to the latest version of Trunnel, which tries harder to
      avoid generating code that can invoke memcpy(p,NULL,0). Bug found
      by clang address sanitizer. Fixes bug 18373; bugfix
      on 0.2.7.2-alpha.
  o Minor bugfixes (configuration):
    - Fix a tiny memory leak when parsing a port configuration ending in
      ":auto". Fixes bug 18374; bugfix on 0.2.3.3-alpha.
  o Minor bugfixes (containers):
    - If we somehow attempt to construct a heap with more than
      1073741822 elements, avoid an integer overflow when maintaining
      the heap property. Fixes bug 18296; bugfix on 0.1.2.1-alpha.
  o Minor bugfixes (correctness):
    - Fix a bad memory handling bug that would occur if we had queued a
      cell on a channel's incoming queue. Fortunately, we can't actually
      queue a cell like that as our code is constructed today, but it's
      best to avoid this kind of error, even if there isn't any code
      that triggers it today. Fixes bug 18570; bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (directory):
    - When generating a URL for a directory server on an IPv6 address,
      wrap the IPv6 address in square brackets. Fixes bug 18051; bugfix
      on 0.2.3.9-alpha. Patch from Malek.
  o Minor bugfixes (fallback directory mirrors):
    - When requesting extrainfo descriptors from a trusted directory
      server, check whether it is an authority or a fallback directory
      which supports extrainfo descriptors. Fixes bug 18489; bugfix on
      0.2.4.7-alpha. Reported by atagar, patch by teor.
  o Minor bugfixes (hidden service, client):
    - Handle the case where the user makes several fast consecutive
      requests to the same .onion address. Previously, the first six
      requests would each trigger a descriptor fetch, each picking a
      directory (there are 6 overall) and the seventh one would fail
      because no directories were left, thereby triggering a close on
      all current directory connections asking for the hidden service.
      The solution here is to not close the connections if we have
      pending directory fetches. Fixes bug 15937; bugfix
      on 0.2.7.1-alpha.
  o Minor bugfixes (hidden service, control port):
    - Add the onion address to the HS_DESC event for the UPLOADED action
      both on success or failure. It was previously hardcoded with
      UNKNOWN. Fixes bug 16023; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (hidden service, directory):
    - Bridges now refuse "rendezvous2" (hidden service descriptor)
      publish attempts. Suggested by ticket 18332.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Allow the setrlimit syscall, and the prlimit and prlimit64
      syscalls, which some libc implementations use under the hood.
      Fixes bug 15221; bugfix on 0.2.5.1-alpha.
    - Avoid a 10-second delay when starting as a client with "Sandbox 1"
      enabled and no DNS resolvers configured. This should help TAILS
      start up faster. Fixes bug 18548; bugfix on 0.2.5.1-alpha.
    - Fix the sandbox's interoperability with unix domain sockets under
      setuid. Fixes bug 18253; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (logging):
    - When logging information about an unparsable networkstatus vote or
      consensus, do not say "vote" when we mean consensus. Fixes bug
      18368; bugfix on 0.2.0.8-alpha.
    - Scrub service name in "unrecognized service ID" log messages.
      Fixes bug 18600; bugfix on 0.2.4.11-alpha.
    - Downgrade logs and backtraces about IP versions to info-level.
      Only log backtraces once each time tor runs. Assists in diagnosing
      bug 18351; bugfix on 0.2.8.1-alpha. Reported by sysrqb and
      Christian, patch by teor.
  o Minor bugfixes (memory safety):
    - Avoid freeing an uninitialized pointer when opening a socket fails
      in get_interface_addresses_ioctl(). Fixes bug 18454; bugfix on
      0.2.3.11-alpha. Reported by toralf and "cypherpunks", patch
      by teor.
    - Correctly duplicate addresses in get_interface_address6_list().
      Fixes bug 18454; bugfix on 0.2.8.1-alpha. Reported by toralf,
      patch by "cypherpunks".
    - Fix a memory leak in tor-gencert. Fixes part of bug 18672; bugfix
      on 0.2.0.1-alpha.
    - Fix a memory leak in "tor --list-fingerprint". Fixes part of bug
      18672; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (private directory):
    - Prevent a race condition when creating private directories. Fixes
      part of bug 17852; bugfix on 0.0.2pre13. Part of ticket 17852.
      Patch from jsturgix. Found with Flawfinder.
  o Minor bugfixes (test networks, IPv6):
    - Allow internal IPv6 addresses in descriptors in test networks.
      Fixes bug 17153; bugfix on 0.2.3.16-alpha. Patch by teor, reported
      by karsten.
  o Minor bugfixes (testing):
    - We no longer disable assertions in the unit tests when coverage is
      enabled. Instead, we require you to say --disable-asserts-in-tests
      to the configure script if you need assertions disabled in the
      unit tests (for example, if you want to perform branch coverage).
      Fixes bug 18242; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (time parsing):
    - Avoid overflow in tor_timegm when parsing dates in and after 2038
      on platforms with 32-bit time_t. Fixes bug 18479; bugfix on
      0.0.2pre14. Patch by teor.
  o Minor bugfixes (tor-gencert):
    - Correctly handle the case where an authority operator enters a
      passphrase but sends an EOF before sending a newline. Fixes bug
      17443; bugfix on 0.2.0.20-rc. Found by junglefowl.
  o Code simplification and refactoring:
    - Quote all the string interpolations in configure.ac -- even those
      which we are pretty sure can't contain spaces. Closes ticket
      17744. Patch from zerosion.
    - Remove specialized code for non-inplace AES_CTR. 99% of our AES is
      inplace, so there's no need to have a separate implementation for
      the non-inplace code. Closes ticket 18258. Patch from Malek.
    - Simplify return types for some crypto functions that can't
      actually fail. Patch from Hassan Alsibyani. Closes ticket 18259.
  o Documentation:
    - Change build messages to refer to "Fedora" instead of "Fedora
      Core", and "dnf" instead of "yum". Closes tickets 18459 and 18426.
      Patches from "icanhasaccount" and "cypherpunks".
  o Removed features:
    - We no longer maintain an internal freelist in memarea.c.
      Allocators should be good enough to make this code unnecessary,
      and it's doubtful that it ever had any performance benefit.
  o Testing:
    - Fix several warnings from clang's address sanitizer produced in
      the unit tests.
    - Treat backtrace test failures as expected on FreeBSD until we
      solve bug 17808. Closes ticket 18204.

@_date: 2016-05-05 09:24:28
@_author: Nick Mathewson 
@_subject: [tor-talk] Reminder: we have nightly builds! 
Hi, friends!
Here's a reminder about one way you can help make sure that our
releases are good and work well.
If you like running software that might break all the time, and
reporting bugs in it, you should check out our nightly builds!  They
live at
       They are automatically built every night from the latest TorBrowser
source code.  By testing these, you can help us find bugs _before_ we
ship our code to the userbase at large.
   * Did I mention there might be bugs?
   * These nightly builds do not have an automated update channel.
Automated updates won't work, even though you'll get regular warnings
that there is a newer TorBrowser.
   * If you're not sure how to install these or how to check the
signatures, you should probably avoid the nightly builds. :)
best wishes and many thanks,

@_date: 2016-05-26 21:10:52
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.8.3-alpha is released. 
Tor 0.2.8.3-alpha resolves several bugs, most of them introduced over
  the course of the 0.2.8 development cycle. It improves the behavior of
  directory clients, fixes several crash bugs, fixes a gap in compiler
  hardening, and allows the full integration test suite to run on
  more platforms.
You can download the source from the usual place on the website.
Packages should be available over the next several days. Remember
to check the signatures!
PLEASE NOTE: This is an alpha release.  Expect a lot of bugs.  Only
run this release if you're willing to find bugs and report them. :)
The changelog follows.
Changes in version 0.2.8.3-alpha - 2016-05-26
  Tor 0.2.8.3-alpha resolves several bugs, most of them introduced over
  the course of the 0.2.8 development cycle. It improves the behavior of
  directory clients, fixes several crash bugs, fixes a gap in compiler
  hardening, and allows the full integration test suite to run on
  more platforms.
  o Major bugfixes (security, client, DNS proxy):
    - Stop a crash that could occur when a client running with DNSPort
      received a query with multiple address types, and the first
      address type was not supported. Found and fixed by Scott Dial.
      Fixes bug 18710; bugfix on 0.2.5.4-alpha.
  o Major bugfixes (security, compilation):
    - Correctly detect compiler flags on systems where _FORTIFY_SOURCE
      is predefined. Previously, our use of -D_FORTIFY_SOURCE would
      cause a compiler warning, thereby making other checks fail, and
      needlessly disabling compiler-hardening support. Fixes one case of
      bug 18841; bugfix on 0.2.3.17-beta. Patch from "trudokal".
  o Major bugfixes (security, directory authorities):
    - Fix a crash and out-of-bounds write during authority voting, when
      the list of relays includes duplicate ed25519 identity keys. Fixes
      bug 19032; bugfix on 0.2.8.2-alpha.
  o Major bugfixes (client, bootstrapping):
    - Check if bootstrap consensus downloads are still needed when the
      linked connection attaches. This prevents tor making unnecessary
      begindir-style connections, which are the only directory
      connections tor clients make since the fix for 18483 was merged.
    - Fix some edge cases where consensus download connections may not
      have been closed, even though they were not needed. Related to fix
      for 18809.
    - Make relays retry consensus downloads the correct number of times,
      rather than the more aggressive client retry count. Fixes part of
      ticket 18809.
    - Stop downloading consensuses when we have a consensus, even if we
      don't have all the certificates for it yet. Fixes bug 18809;
      bugfix on 0.2.8.1-alpha. Patches by arma and teor.
  o Major bugfixes (directory mirrors):
    - Decide whether to advertise begindir support in the the same way
      we decide whether to advertise our DirPort. Allowing these
      decisions to become out-of-sync led to surprising behavior like
      advertising begindir support when hibernation made us not
      advertise a DirPort. Resolves bug 18616; bugfix on 0.2.8.1-alpha.
      Patch by teor.
  o Major bugfixes (IPv6 bridges, client):
    - Actually use IPv6 addresses when selecting directory addresses for
      IPv6 bridges. Fixes bug 18921; bugfix on 0.2.8.1-alpha. Patch
      by "teor".
  o Major bugfixes (key management):
    - If OpenSSL fails to generate an RSA key, do not retain a dangling
      pointer to the previous (uninitialized) key value. The impact here
      should be limited to a difficult-to-trigger crash, if OpenSSL is
      running an engine that makes key generation failures possible, or
      if OpenSSL runs out of memory. Fixes bug 19152; bugfix on
      0.2.1.10-alpha. Found by Yuan Jochen Kang, Suman Jana, and
      Baishakhi Ray.
  o Major bugfixes (testing):
    - Fix a bug that would block 'make test-network-all' on systems where
      IPv6 packets were lost. Fixes bug 19008; bugfix on tor-0.2.7.3-rc.
    - Avoid "WSANOTINITIALISED" warnings in the unit tests. Fixes bug 18668;
      bugfix on 0.2.8.1-alpha.
  o Minor features (clients):
    - Make clients, onion services, and bridge relays always use an
      encrypted begindir connection for directory requests. Resolves
      ticket 18483. Patch by "teor".
  o Minor features (fallback directory mirrors):
    - Give each fallback the same weight for client selection; restrict
      fallbacks to one per operator; report fallback directory detail
      changes when rebuilding list; add new fallback directory mirrors
      to the whitelist; update fallback directories based on the latest
      OnionOO data; and any other minor simplifications and fixes.
      Closes tasks 17158, 17905, 18749, bug 18689, and fixes part of bug
      18812 on 0.2.8.1-alpha; patch by "teor".
  o Minor features (geoip):
    - Update geoip and geoip6 to the May 4 2016 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (assert, portability):
    - Fix an assertion failure in memarea.c on systems where "long" is
      shorter than the size of a pointer. Fixes bug 18716; bugfix
      on 0.2.1.1-alpha.
  o Minor bugfixes (bootstrap):
    - Consistently use the consensus download schedule for authority
      certificates. Fixes bug 18816; bugfix on 0.2.4.13-alpha.
  o Minor bugfixes (build):
    - Remove a pair of redundant AM_CONDITIONAL declarations from
      configure.ac. Fixes one final case of bug 17744; bugfix
      on 0.2.8.2-alpha.
    - Resolve warnings when building on systems that are concerned with
      signed char. Fixes bug 18728; bugfix on 0.2.7.2-alpha
      and 0.2.6.1-alpha.
    - When libscrypt.h is found, but no libscrypt library can be linked,
      treat libscrypt as absent. Fixes bug 19161; bugfix
      on 0.2.6.1-alpha.
  o Minor bugfixes (client):
    - Turn all TestingClientBootstrap* into non-testing torrc options.
      This changes simply renames them by removing "Testing" in front of
      them and they do not require TestingTorNetwork to be enabled
      anymore. Fixes bug 18481; bugfix on 0.2.8.1-alpha.
    - Make directory node selection more reliable, mainly for IPv6-only
      clients and clients with few reachable addresses. Fixes bug 18929;
      bugfix on 0.2.8.1-alpha. Patch by "teor".
  o Minor bugfixes (controller, microdescriptors):
    - Make GETINFO dir/status-vote/current/consensus conform to the
      control specification by returning "551 Could not open cached
      consensus..." when not caching consensuses. Fixes bug 18920;
      bugfix on 0.2.2.6-alpha.
  o Minor bugfixes (crypto, portability):
    - The SHA3 and SHAKE routines now produce the correct output on Big
      Endian systems. No code calls either algorithm yet, so this is
      primarily a build fix. Fixes bug 18943; bugfix on 0.2.8.1-alpha.
    - Tor now builds again with the recent OpenSSL 1.1 development
      branch (tested against 1.1.0-pre4 and 1.1.0-pre5-dev). Closes
      ticket 18286.
  o Minor bugfixes (directories):
    - When fetching extrainfo documents, compare their SHA256 digests
      and Ed25519 signing key certificates with the routerinfo that led
      us to fetch them, rather than with the most recent routerinfo.
      Otherwise we generate many spurious warnings about mismatches.
      Fixes bug 17150; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (logging):
    - When we can't generate a signing key because OfflineMasterKey is
      set, do not imply that we should have been able to load it. Fixes
      bug 18133; bugfix on 0.2.7.2-alpha.
    - Stop periodic_event_dispatch() from blasting twelve lines per
      second at loglevel debug. Fixes bug 18729; fix on 0.2.8.1-alpha.
    - When rejecting a misformed INTRODUCE2 cell, only log at
      PROTOCOL_WARN severity. Fixes bug 18761; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (pluggable transports):
    - Avoid reporting a spurious error when we decide that we don't need
      to terminate a pluggable transport because it has already exited.
      Fixes bug 18686; bugfix on 0.2.5.5-alpha.
  o Minor bugfixes (pointer arithmetic):
    - Fix a bug in memarea_alloc() that could have resulted in remote
      heap write access, if Tor had ever passed an unchecked size to
      memarea_alloc(). Fortunately, all the sizes we pass to
      memarea_alloc() are pre-checked to be less than 128 kilobytes.
      Fixes bug 19150; bugfix on 0.2.1.1-alpha. Bug found by
      Guido Vranken.
  o Minor bugfixes (relays):
    - Consider more config options when relays decide whether to
      regenerate their descriptor. Fixes more of bug 12538; bugfix
      on 0.2.8.1-alpha.
    - Resolve some edge cases where we might launch an ORPort
      reachability check even when DisableNetwork is set. Noticed while
      fixing bug 18616; bugfix on 0.2.3.9-alpha.
  o Minor bugfixes (statistics):
    - We now include consensus downloads via IPv6 in our directory-
      request statistics. Fixes bug 18460; bugfix on 0.2.3.14-alpha.
  o Minor bugfixes (testing):
    - Allow directories in small networks to bootstrap by skipping
      DirPort checks when the consensus has no exits. Fixes bug 19003;
      bugfix on 0.2.8.1-alpha. Patch by teor.
    - Fix a small memory leak that would occur when the
      TestingEnableCellStatsEvent option was turned on. Fixes bug 18673;
      bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (time handling):
    - When correcting a corrupt 'struct tm' value, fill in the tm_wday
      field. Otherwise, our unit tests crash on Windows. Fixes bug
      18977; bugfix on 0.2.2.25-alpha.
  o Documentation:
    - Document the contents of the 'datadir/keys' subdirectory in the
      manual page. Closes ticket 17621.
    - Stop recommending use of nicknames to identify relays in our
      MapAddress documentation. Closes ticket 18312.

@_date: 2016-10-16 01:15:32
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor DNS Deanonymization 
[...]
Thanks, Philipp!
Could you comment at all about whether our current exit side dns
caching approach makes the attack harder, easier, or doesn't matter?
Best wishes,

@_date: 2016-10-17 16:58:54
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.4-alpha is released 
Hi, all!  There is a new alpha release of the Tor source code, with
fixes for a security bug. You should probably upgrade as packages
become available.
(If you are about to reply saying "please take me off this list",
instead please follow these instructions:
 .  You will have to enter the actual email address you used to subscribe.)
You can download the source from the usual place on the website.
Packages should be up within a few days.
If you maintain an older version of Tor, you can find backported
patches for this fix at
 .
(There is also a concurrent release of Tor 0.2.8.9; for stable
releases, see tor-announce@ or the blog.
Changes in version 0.2.9.4-alpha - 2016-10-17
  Tor 0.2.9.4-alpha fixes a security hole in previous versions of Tor
  that would allow a remote attacker to crash a Tor client, hidden
  service, relay, or authority. All Tor users should upgrade to this
  version, or to 0.2.8.9. Patches will be released for older versions
  of Tor.
  Tor 0.2.9.4-alpha also adds numerous small features and fix-ups to
  previous versions of Tor, including the implementation of a feature to
  future- proof the Tor ecosystem against protocol changes, some bug
  fixes necessary for Tor Browser to use unix domain sockets correctly,
  and several portability improvements. We anticipate that this will be
  the last alpha in the Tor 0.2.9 series, and that the next release will
  be a release candidate.
  o Major features (security fixes):
    - Prevent a class of security bugs caused by treating the contents
      of a buffer chunk as if they were a NUL-terminated string. At
      least one such bug seems to be present in all currently used
      versions of Tor, and would allow an attacker to remotely crash
      most Tor instances, especially those compiled with extra compiler
      hardening. With this defense in place, such bugs can't crash Tor,
      though we should still fix them as they occur. Closes ticket
      20384 (TROVE-2016-10-001).
  o Major features (subprotocol versions):
    - Tor directory authorities now vote on a set of recommended
      subprotocol versions, and on a set of required subprotocol
      versions. Clients and relays that lack support for a _required_
      subprotocol version will not start; those that lack support for a
      _recommended_ subprotocol version will warn the user to upgrade.
      Closes ticket 19958; implements part of proposal 264.
    - Tor now uses "subprotocol versions" to indicate compatibility.
      Previously, versions of Tor looked at the declared Tor version of
      a relay to tell whether they could use a given feature. Now, they
      should be able to rely on its declared subprotocol versions. This
      change allows compatible implementations of the Tor protocol(s) to
      exist without pretending to be 100% bug-compatible with particular
      releases of Tor itself. Closes ticket 19958; implements part of
      proposal 264.
  o Minor feature (fallback directories):
    - Remove broken fallbacks from the hard-coded fallback directory
      list. Closes ticket 20190; patch by teor.
  o Minor features (client, directory):
    - Since authorities now omit all routers that lack the Running and
      Valid flags, we assume that any relay listed in the consensus must
      have those flags. Closes ticket 20001; implements part of
      proposal 272.
  o Minor features (compilation, portability):
    - Compile correctly on MacOS 10.12 (aka "Sierra"). Closes
      ticket 20241.
  o Minor features (development tools, etags):
    - Teach the "make tags" Makefile target how to correctly find
      "MOCK_IMPL" function definitions. Patch from nherring; closes
      ticket 16869.
  o Minor features (geoip):
    - Update geoip and geoip6 to the October 4 2016 Maxmind GeoLite2
      Country database.
  o Minor features (unix domain sockets):
    - When configuring a unix domain socket for a SocksPort,
      ControlPort, or Hidden service, you can now wrap the address in
      quotes, using C-style escapes inside the quotes. This allows unix
      domain socket paths to contain spaces.
  o Minor features (virtual addresses):
    - Increase the maximum number of bits for the IPv6 virtual network
      prefix from 16 to 104. In this way, the condition for address
      allocation is less restrictive. Closes ticket 20151; feature
      on 0.2.4.7-alpha.
  o Minor bugfixes (address discovery):
    - Stop reordering IP addresses returned by the OS. This makes it
      more likely that Tor will guess the same relay IP address every
      time. Fixes issue 20163; bugfix on 0.2.7.1-alpha, ticket 17027.
      Reported by Ren Mayrhofer, patch by "cypherpunks".
  o Minor bugfixes (client, unix domain sockets):
    - Disable IsolateClientAddr when using AF_UNIX backed SocksPorts as
      the client address is meaningless. Fixes bug 20261; bugfix
      on 0.2.6.3-alpha.
  o Minor bugfixes (compilation, OpenBSD):
    - Detect Libevent2 functions correctly on systems that provide
      libevent2, but where libevent1 is linked with -levent. Fixes bug
      19904; bugfix on 0.2.2.24-alpha. Patch from Rubiate.
  o Minor bugfixes (configuration):
    - When parsing quoted configuration values from the torrc file,
      handle windows line endings correctly. Fixes bug 19167; bugfix on
      0.2.0.16-alpha. Patch from "Pingl".
  o Minor bugfixes (getpass):
    - Defensively fix a non-triggerable heap corruption at do_getpass()
      to protect ourselves from mistakes in the future. Fixes bug
       bugfix on 0.2.7.3-rc. Bug found by Guido Vranken, patch
      by nherring.
  o Minor bugfixes (hidden service):
    - Allow hidden services to run on IPv6 addresses even when the
      IPv6Exit option is not set. Fixes bug 18357; bugfix
      on 0.2.4.7-alpha.
  o Documentation:
    - Add module-level internal documentation for 36 C files that
      previously didn't have a high-level overview. Closes ticket   o Required libraries:
    - When building with OpenSSL, Tor now requires version 1.0.1 or
      later. OpenSSL 1.0.0 and earlier are no longer supported by the
      OpenSSL team, and should not be used. Closes ticket 20303.

@_date: 2016-10-19 10:31:21
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor DNS Deanonymization 
Thanks!  I've just pulled  (and its sibling,  into
consideration for 0.3.0.

@_date: 2016-09-23 16:07:33
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.2.9.3-alpha is released 
Hi, all!  There is a new alpha release of the Tor source code, with
fixes for several important bugs, and numerous other updates.
(If you are about to reply saying "please take me off this list",
instead please follow these instructions:
 .  You will have to enter the actual email address you used to subscribe.)
You can download the source from the usual place on the website.
Packages should be up in a few days.
(There is also a concurrent release of Tor 0.2.8.8; for stable
announcements, please see tor-announce@ or the blog.)
Changes in version 0.2.9.3-alpha - 2016-09-23
  Tor 0.2.9.3-alpha adds improved support for entities that want to make
  high-performance services available through the Tor .onion mechanism
  without themselves receiving anonymity as they host those services. It
  also tries harder to ensure that all steps on a circuit are using the
  strongest crypto possible, strengthens some TLS properties, and
  resolves several bugs -- including a pair of crash bugs from the 0.2.8
  series. Anybody running an earlier version of 0.2.9.x should upgrade.
  o Major bugfixes (crash, also in 0.2.8.8):
    - Fix a complicated crash bug that could affect Tor clients
      configured to use bridges when replacing a networkstatus consensus
      in which one of their bridges was mentioned. OpenBSD users saw
      more crashes here, but all platforms were potentially affected.
      Fixes bug 20103; bugfix on 0.2.8.2-alpha.
  o Major bugfixes (relay, OOM handler, also in 0.2.8.8):
    - Fix a timing-dependent assertion failure that could occur when we
      tried to flush from a circuit after having freed its cells because
      of an out-of-memory condition. Fixes bug 20203; bugfix on
      0.2.8.1-alpha. Thanks to "cypherpunks" for help diagnosing
      this one.
  o Major features (circuit building, security):
    - Authorities, relays and clients now require ntor keys in all
      descriptors, for all hops (except for rare hidden service protocol
      cases), for all circuits, and for all other roles. Part of
      ticket 19163.
    - Tor authorities, relays, and clients only use ntor, except for
      rare cases in the hidden service protocol. Part of ticket 19163.
  o Major features (single-hop "hidden" services):
    - Add experimental HiddenServiceSingleHopMode and
      HiddenServiceNonAnonymousMode options. When both are set to 1,
      every hidden service on a Tor instance becomes a non-anonymous
      Single Onion Service. Single Onions make one-hop (direct)
      connections to their introduction and renzedvous points. One-hop
      circuits make Single Onion servers easily locatable, but clients
      remain location-anonymous. This is compatible with the existing
      hidden service implementation, and works on the current tor
      network without any changes to older relays or clients. Implements
      proposal 260, completes ticket 17178. Patch by teor and asn.
  o Major features (resource management):
    - Tor can now notice it is about to run out of sockets, and
      preemptively close connections of lower priority. (This feature is
      off by default for now, since the current prioritizing method is
      yet not mature enough. You can enable it by setting
      "DisableOOSCheck 0", but watch out: it might close some sockets
      you would rather have it keep.) Closes ticket 18640.
  o Major bugfixes (circuit building):
    - Hidden service client-to-intro-point and service-to-rendezvous-
      point cicruits use the TAP key supplied by the protocol, to avoid
      epistemic attacks. Fixes bug 19163; bugfix on 0.2.4.18-rc.
  o Major bugfixes (compilation, OpenBSD):
    - Fix a Libevent-detection bug in our autoconf script that would
      prevent Tor from linking successfully on OpenBSD. Patch from
      rubiate. Fixes bug 19902; bugfix on 0.2.9.1-alpha.
  o Major bugfixes (hidden services):
    - Clients now require hidden services to include the TAP keys for
      their intro points in the hidden service descriptor. This prevents
      an inadvertent upgrade to ntor, which a malicious hidden service
      could use to distinguish clients by consensus version. Fixes bug
      20012; bugfix on 0.2.4.8-alpha. Patch by teor.
  o Minor features (security, TLS):
    - Servers no longer support clients that without AES ciphersuites.
      (3DES is no longer considered an acceptable cipher.) We believe
      that no such Tor clients currently exist, since Tor has required
      OpenSSL 0.9.7 or later since 2009. Closes ticket 19998.
  o Minor feature (fallback directories):
    - Remove broken entries from the hard-coded fallback directory list.
      Closes ticket 20190; patch by teor.
  o Minor features (geoip, also in 0.2.8.8):
    - Update geoip and geoip6 to the September 6 2016 Maxmind GeoLite2
      Country database.
  o Minor feature (port flags):
    - Add new flags to the *Port options to finer control over which
      requests are allowed. The flags are NoDNSRequest, NoOnionTraffic,
      and the synthetic flag OnionTrafficOnly, which is equivalent to
      NoDNSRequest, NoIPv4Traffic, and NoIPv6Traffic. Closes enhancement
      18693; patch by "teor".
  o Minor features (directory authority):
    - After voting, if the authorities decide that a relay is not
      "Valid", they no longer include it in the consensus at all. Closes
      ticket 20002; implements part of proposal 272.
  o Minor features (testing):
    - Disable memory protections on OpenBSD when performing our unit
      tests for memwipe(). The test deliberately invokes undefined
      behavior, and the OpenBSD protections interfere with this. Patch
      from "rubiate". Closes ticket 20066.
  o Minor features (testing, ipv6):
    - Add the single-onion and single-onion-ipv6 chutney targets to
      "make test-network-all". This requires a recent chutney version
      with the single onion network flavours (git c72a652 or later).
      Closes ticket 20072; patch by teor.
    - Add the hs-ipv6 chutney target to make test-network-all's IPv6
      tests. Remove bridges+hs, as it's somewhat redundant. This
      requires a recent chutney version that supports IPv6 clients,
      relays, and authorities. Closes ticket 20069; patch by teor.
  o Minor features (Tor2web):
    - Make Tor2web clients respect ReachableAddresses. This feature was
      inadvertently enabled in 0.2.8.6, then removed by bugfix 19973 on
      0.2.8.7. Implements feature 20034. Patch by teor.
  o Minor features (unit tests):
    - We've done significant work to make the unit tests run faster.
    - Our link-handshake unit tests now check that when invalid
      handshakes fail, they fail with the error messages we expected.
    - Our unit testing code that captures log messages no longer
      prevents them from being written out if the user asked for them
      (by passing --debug or --info or or --notice --warn to the "test"
      binary). This change prevents us from missing unexpected log
      messages simply because we were looking for others. Related to
      ticket 19999.
    - The unit tests now log all warning messages with the "BUG" flag.
      Previously, they only logged errors by default. This change will
      help us make our testing code more correct, and make sure that we
      only hit this code when we mean to. In the meantime, however,
      there will be more warnings in the unit test logs than before.
      This is preparatory work for ticket 19999.
    - The unit tests now treat any failure of a "tor_assert_nonfatal()"
      assertion as a test failure.
  o Minor bug fixes (circuits):
    - Use the CircuitBuildTimeout option whenever
      LearnCircuitBuildTimeout is disabled. Previously, we would respect
      the option when a user disabled it, but not when it was disabled
      because some other option was set. Fixes bug 20073; bugfix on
      0.2.4.12-alpha. Patch by teor.
  o Minor bugfixes (allocation):
    - Change how we allocate memory for large chunks on buffers, to
      avoid a (currently impossible) integer overflow, and to waste less
      space when allocating unusually large chunks. Fixes bug 20081;
      bugfix on 0.2.0.16-alpha. Issue identified by Guido Vranken.
    - Always include orconfig.h before including any other C headers.
      Sometimes, it includes macros that affect the behavior of the
      standard headers. Fixes bug 19767; bugfix on 0.2.9.1-alpha (the
      first version to use AC_USE_SYSTEM_EXTENSIONS).
    - Fix a syntax error in the IF_BUG_ONCE__() macro in non-GCC-
      compatible compilers. Fixes bug 20141; bugfix on 0.2.9.1-alpha.
      Patch from Gisle Vanem.
    - Stop trying to build with Clang 4.0's -Wthread-safety warnings.
      They apparently require a set of annotations that we aren't
      currently using, and they create false positives in our pthreads
      wrappers. Fixes bug 20110; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (directory authority):
    - Die with a more useful error when the operator forgets to place
      the authority_signing_key file into the keys directory. This
      avoids an uninformative assert & traceback about having an invalid
      key. Fixes bug 20065; bugfix on 0.2.0.1-alpha.
    - When allowing private addresses, mark Exits that only exit to
      private locations as such. Fixes bug 20064; bugfix
      on 0.2.2.9-alpha.
  o Minor bugfixes (documentation):
    - Document the default PathsNeededToBuildCircuits value that's used
      by clients when the directory authorities don't set
      min_paths_for_circs_pct. Fixes bug 20117; bugfix on 02c320916e02
      in tor-0.2.4.10-alpha. Patch by teor, reported by Jesse V.
    - Fix manual for the User option: it takes a username, not a UID.
      Fixes bug 19122; bugfix on 0.0.2pre16 (the first version to have
      a manpage!).
  o Minor bugfixes (hidden services):
    - Stop logging intro point details to the client log on certain
      error conditions. Fixed as part of bug 20012; bugfix on
      0.2.4.8-alpha. Patch by teor.
  o Minor bugfixes (IPv6, testing):
    - Check for IPv6 correctly on Linux when running test networks.
      Fixes bug 19905; bugfix on 0.2.7.3-rc; patch by teor.
  o Minor bugfixes (Linux seccomp2 sandbox):
    - Add permission to run the sched_yield() and sigaltstack() system
      calls, in order to support versions of Tor compiled with asan or
      ubsan code that use these calls. Now "sandbox 1" and
      "--enable-expensive-hardening" should be compatible on more
      systems. Fixes bug 20063; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (logging):
    - When logging a message from the BUG() macro, be explicit about
      what we were asserting. Previously we were confusing what we were
      asserting with what the bug was. Fixes bug 20093; bugfix
      on 0.2.9.1-alpha.
    - When we are unable to remove the bw_accounting file, do not warn
      if the reason we couldn't remove it was that it didn't exist.
      Fixes bug 19964; bugfix on 0.2.5.4-alpha. Patch from 'pastly'.
  o Minor bugfixes (option parsing):
    - Count unix sockets when counting client listeners (SOCKS, Trans,
      NATD, and DNS). This has no user-visible behaviour changes: these
      options are set once, and never read. Required for correct
      behaviour in ticket 17178. Fixes bug 19677; bugfix on
      0.2.6.3-alpha. Patch by teor.
  o Minor bugfixes (options):
    - Check the consistency of UseEntryGuards and EntryNodes more
      reliably. Fixes bug 20074; bugfix on tor- 0.2.4.12-alpha. Patch
      by teor.
    - Stop changing the configured value of UseEntryGuards on
      authorities and Tor2web clients. Fixes bug 20074; bugfix on
      commits 51fc6799 in tor-0.1.1.16-rc and acda1735 in tor-0.2.4.3-
      alpha. Patch by teor.
  o Minor bugfixes (Tor2web):
    - Prevent Tor2web clients running hidden services, these services
      are not anonymous due to the one-hop client paths. Fixes bug
      19678. Patch by teor.
  o Minor bugfixes (unit tests):
    - Fix a shared-random unit test that was failing on big endian
      architectures due to internal representation of a integer copied
      to a buffer. The test is changed to take a full 32 bytes of data
      and use the output of a python script that make the COMMIT and
      REVEAL calculation according to the spec. Fixes bug 19977; bugfix
      on 0.2.9.1-alpha.
    - The tor_tls_server_info_callback unit test no longer crashes when
      debug-level logging is turned on. Fixes bug 20041; bugfix
      on 0.2.8.1-alpha.

@_date: 2017-04-05 10:02:35
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.0.5-rc: almost stable! 
Hi all!
Tor 0.3.0.5-rc is now tagged and released.  It's in still "release
candidate" status, which means we think it should be pretty stable,
but we hope you'll find more bugs for us to fix.
You can download the source code from the usual place on the website.
Packages should be out over the next several weeks, including Tor
Browser alpha releases later this month.
If you do build from source, please remember to check the signatures!
Changes in version 0.3.0.5-rc - 2017-04-05
  Tor 0.3.0.5-rc fixes a few remaining bugs, large and small, in the
  0.3.0 release series.
  This is the second release candidate in the Tor 0.3.0 series, and has
  much fewer changes than the first. If we find no new bugs or
  regressions here, the first stable 0.3.0 release will be nearly
  identical to it.
  o Major bugfixes (crash, directory connections):
    - Fix a rare crash when sending a begin cell on a circuit whose
      linked directory connection had already been closed. Fixes bug
      21576; bugfix on 0.2.9.3-alpha. Reported by Alec Muffett.
  o Major bugfixes (guard selection):
    - Fix a guard selection bug where Tor would refuse to bootstrap in
      some cases if the user swapped a bridge for another bridge in
      their configuration file. Fixes bug 21771; bugfix on 0.3.0.1-alpha.
      Reported by "torvlnt33r".
  o Minor features (geoip):
    - Update geoip and geoip6 to the March 7 2017 Maxmind GeoLite2
      Country database.
  o Minor bugfix (compilation):
    - Fix a warning when compiling hs_service.c. Previously, it had no
      exported symbols when compiled for libor.a, resulting in a
      compilation warning from clang. Fixes bug 21825; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (hidden services):
    - Make hidden services check for failed intro point connections,
      even when they have exceeded their intro point creation limit.
      Fixes bug 21596; bugfix on 0.2.7.2-alpha. Reported by Alec Muffett.
    - Make hidden services with 8 to 10 introduction points check for
      failed circuits immediately after startup. Previously, they would
      wait for 5 minutes before performing their first checks. Fixes bug
      21594; bugfix on 0.2.3.9-alpha. Reported by Alec Muffett.
  o Minor bugfixes (memory leaks):
    - Fix a memory leak when using GETCONF on a port option. Fixes bug
      21682; bugfix on 0.3.0.3-alpha.
  o Minor bugfixes (relay):
    - Avoid a double-marked-circuit warning that could happen when we
      receive DESTROY cells under heavy load. Fixes bug 20059; bugfix
      on 0.1.0.1-rc.
  o Minor bugfixes (tests):
    - Run the entry_guard_parse_from_state_full() test with the time set
      to a specific date. (The guard state that this test was parsing
      contained guards that had expired since the test was first
      written.) Fixes bug 21799; bugfix on 0.3.0.1-alpha.
  o Documentation:
    - Update the description of the directory server options in the
      manual page, to clarify that a relay no longer needs to set
      DirPort in order to be a directory cache. Closes ticket 21720.

@_date: 2017-08-01 16:30:35
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.1.5-alpha is released! 
Hi, all!
There's a new alpha Tor release available!  The source is available
from the "download" page on the website on the website, and packages
should be available before long. The Tor Browser team expects to get a
release out early next week.
This is an alpha release: if you aren't up for finding and reporting
bugs, you should stick with a stable release series.
As usual, I'll be sending alpha announcements here, and stable
announcements to tor-announce.
Please test these alpha releases if you *can* report bugs: we want to
have all the bugs squashed before 0.3.1.x is finally declared stable.
Finally, this release also marks the end of support for the Tor
0.2.4.x, 0.2.6.x, and 0.2.7.x release series. Those releases will
receive no further bug or security fixes. Anyone still running or
distributing one of those versions should upgrade.
Changes in version 0.3.1.5-alpha - 2017-08-01
  Tor 0.3.1.5-alpha improves the performance of consensus diff
  calculation, fixes a crash bug on older versions of OpenBSD, and fixes
  several other bugs. If no serious bugs are found in this version, the
  next version will be a release candidate.
  o Major features (build system, continuous integration):
    - Tor's repository now includes a Travis Continuous Integration (CI)
      configuration file (.travis.yml). This is meant to help new
      developers and contributors who fork Tor to a Github repository be
      better able to test their changes, and understand what we expect
      to pass. To use this new build feature, you must fork Tor to your
      Github account, then go into the "Integrations" menu in the
      repository settings for your fork and enable Travis, then push
      your changes. Closes ticket 22636.
  o Major bugfixes (openbsd, denial-of-service):
    - Avoid an assertion failure bug affecting our implementation of
      inet_pton(AF_INET6) on certain OpenBSD systems whose strtol()
      handling of "0xfoo" differs from what we had expected. Fixes bug
      22789; bugfix on 0.2.3.8-alpha. Also tracked as TROVE-2017-007.
  o Major bugfixes (relay, performance):
    - Perform circuit handshake operations at a higher priority than we
      use for consensus diff creation and compression. This should
      prevent circuits from starving when a relay or bridge receives a
      new consensus, especially on lower-powered machines. Fixes bug
      22883; bugfix on 0.3.1.1-alpha.
  o Minor features (bridge authority):
    - Add "fingerprint" lines to the networkstatus-bridges file produced
      by bridge authorities. Closes ticket 22207.
  o Minor features (directory cache, consensus diff):
    - Add a new MaxConsensusAgeForDiffs option to allow directory cache
      operators with low-resource environments to adjust the number of
      consensuses they'll store and generate diffs from. Most cache
      operators should leave it unchanged. Helps to work around
      bug 22883.
  o Minor features (geoip):
    - Update geoip and geoip6 to the July 4 2017 Maxmind GeoLite2
      Country database.
  o Minor features (relay, performance):
    - Always start relays with at least two worker threads, to prevent
      priority inversion on slow tasks. Part of the fix for bug 22883.
    - Allow background work to be queued with different priorities, so
      that a big pile of slow low-priority jobs will not starve out
      higher priority jobs. This lays the groundwork for a fix for
      bug 22883.
  o Minor bugfixes (build system, rust):
    - Fix a problem where Rust toolchains were not being found when
      building without --enable-cargo-online-mode, due to setting the
      $HOME environment variable instead of $CARGO_HOME. Fixes bug
      22830; bugfix on 0.3.1.1-alpha. Fix by Chelsea Komlo.
  o Minor bugfixes (compatibility, zstd):
    - Write zstd epilogues correctly when the epilogue requires
      reallocation of the output buffer, even with zstd 1.3.0.
      (Previously, we worked on 1.2.0 and failed with 1.3.0). Fixes bug
      22927; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (compilation warnings):
    - Suppress -Wdouble-promotion warnings with clang 4.0. Fixes bug
      22915; bugfix on 0.2.8.1-alpha.
    - Fix warnings when building with libscrypt and openssl scrypt
      support on Clang. Fixes bug 22916; bugfix on 0.2.7.2-alpha.
    - Compile correctly when both openssl 1.1.0 and libscrypt are
      detected. Previously this would cause an error. Fixes bug 22892;
      bugfix on 0.3.1.1-alpha.
    - When building with certain versions of the mingw C header files,
      avoid float-conversion warnings when calling the C functions
      isfinite(), isnan(), and signbit(). Fixes bug 22801; bugfix
      on 0.2.8.1-alpha.
  o Minor bugfixes (coverity build support):
    - Avoid Coverity build warnings related to our BUG() macro. By
      default, Coverity treats BUG() as the Linux kernel does: an
      instant abort(). We need to override that so our BUG() macro
      doesn't prevent Coverity from analyzing functions that use it.
      Fixes bug 23030; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (directory authority):
    - When a directory authority rejects a descriptor or extrainfo with
      a given digest, mark that digest as undownloadable, so that we do
      not attempt to download it again over and over. We previously
      tried to avoid downloading such descriptors by other means, but we
      didn't notice if we accidentally downloaded one anyway. This
      behavior became problematic in 0.2.7.2-alpha, when authorities
      began pinning Ed25519 keys. Fixes bug 22349; bugfix
      on 0.2.1.19-alpha.
  o Minor bugfixes (error reporting, windows):
    - When formatting Windows error messages, use the English format to
      avoid codepage issues. Fixes bug 22520; bugfix on 0.1.2.8-alpha.
      Patch from "Vort".
  o Minor bugfixes (file limits, osx):
    - When setting the maximum number of connections allowed by the OS,
      always allow some extra file descriptors for other files. Fixes
      bug 22797; bugfix on 0.2.0.10-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Avoid a sandbox failure when trying to re-bind to a socket and
      mark it as IPv6-only. Fixes bug 20247; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a small memory leak when validating a configuration that uses
      two or more AF_UNIX sockets for the same port type. Fixes bug
      23053; bugfix on 0.2.6.3-alpha. This is CID 1415725.
  o Minor bugfixes (unit tests):
    - test_consdiff_base64cmp would fail on OS X because while OS X
      follows the standard of (less than zero/zero/greater than zero),
      it doesn't follow the convention of (-1/0/+1). Make the test
      comply with the standard. Fixes bug 22870; bugfix on 0.3.1.1-alpha.
    - Fix a memory leak in the link-handshake/certs_ok_ed25519 test.
      Fixes bug 22803; bugfix on 0.3.0.1-alpha.

@_date: 2017-12-01 09:18:37
@_author: Nick Mathewson 
@_subject: [tor-talk] New Tor security releases: 0.2.5.16, 0.2.8.17, 0.2.9.14, 
There are new releases of Tor to fix several security issues.
If you build Tor from source code, you can download them from the
download page on the website. If you need an older release series, go
to  .
For users who do not build from source: packages should be available
soon.  All users should upgrade when possible.
These releases fix the following security bugs. For more information
on each one, see the links from
TROVE-2017-009: Replay-cache ineffective for v2 onion services
TROVE-2017-010: Remote DoS attack against directory authorities
TROVE-2017-011: An attacker can make Tor ask for a password
TROVE-2017-012: Relays can pick themselves in a circuit path
TROVE-2017-013: Use-after-free in onion service v2
Remember that the following release series are approaching end-of-life:
   0.2.8 on 1 Jan 2018
   0.3.0 on 26 Jan 2018
   0.2.5 on 1 May 2018
If you need  a release series with long term support, stick to
0.2.9.x. Otherwise, please stay up-to-date with the latest stable
release series (or with the alphas, if you are feeling brave and you
like reporting bugs).
Below is the changelog for 0.3.2.6-alpha.  The changelogs for the
stable releases were sent to tor-announce as usual.
Changes in version 0.3.2.6-alpha - 2017-12-01
  This version of Tor is the latest in the 0.3.2 alpha series. It
  includes fixes for several important security issues. All Tor users
  should upgrade to this release, or to one of the other releases coming
  out today.
  o Major bugfixes (security):
    - Fix a denial of service bug where an attacker could use a
      malformed directory object to cause a Tor instance to pause while
      OpenSSL would try to read a passphrase from the terminal. (Tor
      instances run without a terminal, which is the case for most Tor
      packages, are not impacted.) Fixes bug 24246; bugfix on every
      version of Tor. Also tracked as TROVE-2017-011 and CVE-2017-8821.
      Found by OSS-Fuzz as testcase 6360145429790720.
    - Fix a denial of service issue where an attacker could crash a
      directory authority using a malformed router descriptor. Fixes bug
      24245; bugfix on 0.2.9.4-alpha. Also tracked as TROVE-2017-010
      and CVE-2017-8820.
    - When checking for replays in the INTRODUCE1 cell data for a
      (legacy) onion service, correctly detect replays in the RSA-
      encrypted part of the cell. We were previously checking for
      replays on the entire cell, but those can be circumvented due to
      the malleability of Tor's legacy hybrid encryption. This fix helps
      prevent a traffic confirmation attack. Fixes bug 24244; bugfix on
      0.2.4.1-alpha. This issue is also tracked as TROVE-2017-009
      and CVE-2017-8819.
  o Major bugfixes (security, onion service v2):
    - Fix a use-after-free error that could crash v2 Tor onion services
      when they failed to open circuits while expiring introduction
      points. Fixes bug 24313; bugfix on 0.2.7.2-alpha. This issue is
      also tracked as TROVE-2017-013 and CVE-2017-8823.
  o Major bugfixes (security, relay):
    - When running as a relay, make sure that we never build a path
      through ourselves, even in the case where we have somehow lost the
      version of our descriptor appearing in the consensus. Fixes part
      of bug 21534; bugfix on 0.2.0.1-alpha. This issue is also tracked
      as TROVE-2017-012 and CVE-2017-8822.
    - When running as a relay, make sure that we never choose ourselves
      as a guard. Fixes part of bug 21534; bugfix on 0.3.0.1-alpha. This
      issue is also tracked as TROVE-2017-012 and CVE-2017-8822.
  o Minor feature (relay statistics):
    - Change relay bandwidth reporting stats interval from 4 hours to 24
      hours in order to reduce the efficiency of guard discovery
      attacks. Fixes ticket 23856.
  o Minor features (directory authority):
    - Add an IPv6 address for the "bastet" directory authority. Closes
      ticket 24394.
  o Minor bugfixes (client):
    - By default, do not enable storage of client-side DNS values. These
      values were unused by default previously, but they should not have
      been cached at all. Fixes bug 24050; bugfix on 0.2.6.3-alpha.

@_date: 2017-12-14 14:06:30
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.2.7-rc is released! 
Hi, all!
Tor 0.3.2.7-rc is released.  If you build Tor from source code, why
not fetch it from our download page and try it out?  If you use
precompiled packages, then there should be releases soon, including a
Tor Browser alpha release likely next week.
Here are the changes since 0.3.2.6-alpha:
Changes in version 0.3.2.7-rc - 2017-12-14
  Tor 0.3.2.7-rc fixes various bugs in earlier versions of Tor,
  including some that could affect reliability or correctness.
  This is the first release candidate in the 0.3.2 series. If we find no
  new bugs or regression here, then the first stable 0.3.2. release will
  be nearly identical to this.
  o Major bugfixes (circuit prediction):
    - Fix circuit prediction logic so that a client doesn't treat a port
      as being "handled" by a circuit if that circuit already has
      isolation settings on it. This change should make Tor clients more
      responsive by improving their chances of having a pre-created
      circuit ready for use when a request arrives. Fixes bug 18859;
      bugfix on 0.2.3.3-alpha.
  o Minor features (logging):
    - Provide better warnings when the getrandom() syscall fails. Closes
      ticket 24500.
  o Minor features (portability):
    - Tor now compiles correctly on arm64 with libseccomp-dev installed.
      (It doesn't yet work with the sandbox enabled.) Closes
      ticket 24424.
  o Minor bugfixes (bridge clients, bootstrap):
    - Retry directory downloads when we get our first bridge descriptor
      during bootstrap or while reconnecting to the network. Keep
      retrying every time we get a bridge descriptor, until we have a
      reachable bridge. Fixes part of bug 24367; bugfix on 0.2.0.3-alpha.
    - Stop delaying bridge descriptor fetches when we have cached bridge
      descriptors. Instead, only delay bridge descriptor fetches when we
      have at least one reachable bridge. Fixes part of bug 24367;
      bugfix on 0.2.0.3-alpha.
    - Stop delaying directory fetches when we have cached bridge
      descriptors. Instead, only delay bridge descriptor fetches when
      all our bridges are definitely unreachable. Fixes part of bug
      24367; bugfix on 0.2.0.3-alpha.
  o Minor bugfixes (compilation):
    - Fix a signed/unsigned comparison warning introduced by our fix to
      TROVE-2017-009. Fixes bug 24480; bugfix on 0.2.5.16.
  o Minor bugfixes (correctness):
    - Fix several places in our codebase where a C compiler would be
      likely to eliminate a check, based on assuming that undefined
      behavior had not happened elsewhere in the code. These cases are
      usually a sign of redundant checking or dubious arithmetic. Found
      by Georg Koppen using the "STACK" tool from Wang, Zeldovich,
      Kaashoek, and Solar-Lezama. Fixes bug 24423; bugfix on various
      Tor versions.
  o Minor bugfixes (onion service v3):
    - Fix a race where an onion service would launch a new intro circuit
      after closing an old one, but fail to register it before freeing
      the previously closed circuit. This bug was making the service
      unable to find the established intro circuit and thus not upload
      its descriptor, thus making a service unavailable for up to 24
      hours. Fixes bug 23603; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (scheduler, KIST):
    - Properly set the scheduler state of an unopened channel in the
      KIST scheduler main loop. This prevents a harmless but annoying
      log warning. Fixes bug 24502; bugfix on 0.3.2.4-alpha.
    - Avoid a possible integer overflow when computing the available
      space on the TCP buffer of a channel. This had no security
      implications; but could make KIST allow too many cells on a
      saturated connection. Fixes bug 24590; bugfix on 0.3.2.1-alpha.
    - Downgrade to "info" a harmless warning about the monotonic time
      moving backwards: This can happen on platform not supporting
      monotonic time. Fixes bug 23696; bugfix on 0.3.2.1-alpha.

@_date: 2017-12-21 14:49:08
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.2.8-rc is released 
Hi, all!
Tor 0.3.2.8-rc is released.  If you build Tor from source code, why
not fetch it from our download page and try it out?  If you use
precompiled packages, then there should be releases soon.  There
probably won't be a Tor Browser release for this one; this issues
fixed here are mainly (but not exclusively) relevant to relays.
Changes in version 0.3.2.8-rc - 2017-12-21
  Tor 0.3.2.8-rc fixes a pair of bugs in the KIST and KISTLite
  schedulers that had led servers under heavy load to overload their
  outgoing connections. All relay operators running earlier 0.3.2.x
  versions should upgrade. This version also includes a mitigation for
  over-full DESTROY queues leading to out-of-memory conditions: if it
  works, we will soon backport it to earlier release series.
  This is the second release candidate in the 0.3.2 series. If we find
  no new bugs or regression here, then the first stable 0.3.2 release
  will be nearly identical to this.
  o Major bugfixes (KIST, scheduler):
    - The KIST scheduler did not correctly account for data already
      enqueued in each connection's send socket buffer, particularly in
      cases when the TCP/IP congestion window was reduced between
      scheduler calls. This situation lead to excessive per-connection
      buffering in the kernel, and a potential memory DoS. Fixes bug
      24665; bugfix on 0.3.2.1-alpha.
  o Minor features (geoip):
    - Update geoip and geoip6 to the December 6 2017 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (hidden service v3):
    - Bump hsdir_spread_store parameter from 3 to 4 in order to increase
      the probability of reaching a service for a client missing
      microdescriptors. Fixes bug 24425; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (memory usage):
    - When queuing DESTROY cells on a channel, only queue the circuit-id
      and reason fields: not the entire 514-byte cell. This fix should
      help mitigate any bugs or attacks that fill up these queues, and
      free more RAM for other uses. Fixes bug 24666; bugfix
      on 0.2.5.1-alpha.
  o Minor bugfixes (scheduler, KIST):
    - Use a sane write limit for KISTLite when writing onto a connection
      buffer instead of using INT_MAX and shoving as much as it can.
      Because the OOM handler cleans up circuit queues, we are better
      off at keeping them in that queue instead of the connection's
      buffer. Fixes bug 24671; bugfix on 0.3.2.1-alpha.

@_date: 2017-02-17 17:19:40
@_author: Nick Mathewson 
@_subject: [tor-talk] Towards new stable releases (0.2.4 through 0.2.9) 
Hi, all!
As part of an effort to actually be predictable about supporting old
releases, I'm hoping to put out stable releases of 0.2.4 through 0.2.9
some time early next month. (See [1] for our planned schedule of when
we're dropping support for what.)
This isn't an easy effort, though!  Some of those release series
haven't  seen updates in quite a while.  Moreover, the 0.2.7 branch
had drifted substantially far away from what a stable release should
backport, and I had to re-create it starting at the last 0.2.7 release
Because of this, these stable releases are probably going to need more
testing than usual before we can call them ready for mass consumption.
So instead of just testing them internally, I'm putting up the some
preliminary source distributions now.  You can see them at
 [3].  Each of
them has a "-dev" suffix in its version number to indicate that it is
a development version -- not yet an official release.
The changelogs are not yet correct for these tarballs.  I haven't even
started them yet.  I hope I'll find time over the next week or so.
You can look at the "changes" directories in the appropriate
release-0.2.* Git branches for the inputs that will go into the
If you're interested in helping make sure that the next stable
releases really are stable, and you're already experienced at building
from source, please give one or more of these releases a try.  (If you
don't build your own "tor" from source, don't worry. You probably
don't want to touch these yet.)
Any bug reports would be really helpful, especially if there are any
regressions since the previous stable version in each series.
I hope that in the future, a clear backport policy combined with a
more regular habit of putting out stable releases will keep us from
having to do big backport collections of this kind.
[1] [2] [3] I am aware of the contradiction in the URL.

@_date: 2017-02-28 11:11:22
@_author: Nick Mathewson 
@_subject: [tor-talk] Towards new stable releases (0.2.4 through 0.2.9) 
============================== START ==============================
Update: I have just uploaded new tarballs to the above directory.
They are still not the releases, but they may become the releases some
time this week.  They now have ChangeLogs files.  I'm not anticipating
any more fixes in these upcoming versions of 0.2.4 through 0.2.9,
though there are one or two more fixes we'd like to get into
0.3.0.4-rc before it comes out.
Same caveats and requests as before apply.

@_date: 2017-07-03 10:49:54
@_author: Nick Mathewson 
@_subject: [tor-talk] Reminder: Support for 0.2.4, 0.2.6, 
This is a reminder that we will not be making new releases for the
0.2.4, 0.2.6, or 0.2.7 release series after 1 August 2017.  If you are
running one of those series, please make a plan to upgrade some time
before then!
0.2.5 will still be supported until 1 May 2018.
0.2.9 support will continue until 1 Jan 2020 -- use that if you need a
release that will be supported long-term.
Versions 0.2.3 and earlier are not supported at all.
Support for other releases (0.3.1 and 0.3.0) will continue according
to the schedule at
best wishes,

@_date: 2017-06-08 13:04:33
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.1.3-alpha is released (with security fix for 
Hi!  The latest alpha, 0.3.1.3-alpha, is now released. The source is
available on the website, and packages should be available before too
long.  It has a security fix for hidden services, so if you are
running a hidden service, you should upgrade to this version (or to
one of the 7 other versions released today).
This is an alpha release: if you aren't up for finding and reporting
bugs, you should stick with a stable release series.
As usual, I'll be sending alpha announcements here, and stable
announcements to tor-announce.
Changes in version 0.3.1.3-alpha - 2017-06-08
  Tor 0.3.1.3-alpha fixes a pair of bugs that would allow an attacker to
  remotely crash a hidden service with an assertion failure. Anyone
  running a hidden service should upgrade to this version, or to some
  other version with fixes for TROVE-2017-004 and TROVE-2017-005.
  Tor 0.3.1.3-alpha also includes fixes for several key management bugs
  that sometimes made relays unreliable, as well as several other
  bugfixes described below.
  o Major bugfixes (hidden service, relay, security):
    - Fix a remotely triggerable assertion failure when a hidden service
      handles a malformed BEGIN cell. Fixes bug 22493, tracked as
      TROVE-2017-004 and as CVE-2017-0375; bugfix on 0.3.0.1-alpha.
    - Fix a remotely triggerable assertion failure caused by receiving a
      BEGIN_DIR cell on a hidden service rendezvous circuit. Fixes bug
      22494, tracked as TROVE-2017-005 and CVE-2017-0376; bugfix
      on 0.2.2.1-alpha.
  o Major bugfixes (relay, link handshake):
    - When performing the v3 link handshake on a TLS connection, report
      that we have the x509 certificate that we actually used on that
      connection, even if we have changed certificates since that
      connection was first opened. Previously, we would claim to have
      used our most recent x509 link certificate, which would sometimes
      make the link handshake fail. Fixes one case of bug 22460; bugfix
      on 0.2.3.6-alpha.
  o Major bugfixes (relays, key management):
    - Regenerate link and authentication certificates whenever the key
      that signs them changes; also, regenerate link certificates
      whenever the signed key changes. Previously, these processes were
      only weakly coupled, and we relays could (for minutes to hours)
      wind up with an inconsistent set of keys and certificates, which
      other relays would not accept. Fixes two cases of bug 22460;
      bugfix on 0.3.0.1-alpha.
    - When sending an Ed25519 signing->link certificate in a CERTS cell,
      send the certificate that matches the x509 certificate that we
      used on the TLS connection. Previously, there was a race condition
      if the TLS context rotated after we began the TLS handshake but
      before we sent the CERTS cell. Fixes a case of bug 22460; bugfix
      on 0.3.0.1-alpha.
  o Major bugfixes (torrc, crash):
    - Fix a crash bug when using %include in torrc. Fixes bug 22417;
      bugfix on 0.3.1.1-alpha. Patch by Daniel Pinto.
  o Minor features (code style):
    - Add "Falls through" comments to our codebase, in order to silence
      GCC 7's -Wimplicit-fallthrough warnings. Patch from Andreas
      Stieger. Closes ticket 22446.
  o Minor features (diagnostic):
    - Add logging messages to try to diagnose a rare bug that seems to
      generate RSA->Ed25519 cross-certificates dated in the 1970s. We
      think this is happening because of incorrect system clocks, but
      we'd like to know for certain. Diagnostic for bug 22466.
  o Minor bugfixes (correctness):
    - Avoid undefined behavior when parsing IPv6 entries from the geoip6
      file. Fixes bug 22490; bugfix on 0.2.4.6-alpha.
  o Minor bugfixes (directory protocol):
    - Check for libzstd >= 1.1, because older versions lack the
      necessary streaming API. Fixes bug 22413; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (link handshake):
    - Lower the lifetime of the RSA->Ed25519 cross-certificate to six
      months, and regenerate it when it is within one month of expiring.
      Previously, we had generated this certificate at startup with a
      ten-year lifetime, but that could lead to weird behavior when Tor
      was started with a grossly inaccurate clock. Mitigates bug 22466;
      mitigation on 0.3.0.1-alpha.
  o Minor bugfixes (storage directories):
    - Always check for underflows in the cached storage directory usage.
      If the usage does underflow, re-calculate it. Also, avoid a
      separate underflow when the usage is not known. Fixes bug 22424;
      bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (unit tests):
    - The unit tests now pass on systems where localhost is misconfigured
      to some IPv4 address other than 127.0.0.1. Fixes bug 6298; bugfix
      on 0.0.9pre2.
  o Documentation:
    - Clarify the manpage for the (deprecated) torify script. Closes
      ticket 6892.

@_date: 2017-06-29 18:55:34
@_author: Nick Mathewson 
@_subject: [tor-talk] 0.3.1.4-alpha is released (with guard-related security 
Hi, all!
The latest alpha, 0.3.1.3-alpha, is now released. The source is
available on the website, and packages should be available before
long. The Tor Browser team expects to get a release out early next
week.  This release has a security fix for clients, so if you are
running any 0.3.0.x or 0.3.1.x version released before today, you
should upgrade when you can.
This is an alpha release: if you aren't up for finding and reporting
bugs, you should stick with a stable release series.
As usual, I'll be sending alpha announcements here, and stable
announcements to tor-announce.
Please test these alpha releases if you *can* report bugs: we want to
have all the bugs squashed before 0.3.1.x is finally declared stable.
Changes in version 0.3.1.4-alpha - 2017-06-29
  Tor 0.3.1.4-alpha fixes a path selection bug that would allow a client
  to use a guard that was in the same network family as a chosen exit
  relay. This is a security regression; all clients running earlier
  versions of 0.3.0.x or 0.3.1.x should upgrade to 0.3.0.9
  or 0.3.1.4-alpha.
  This release also fixes several other bugs introduced in 0.3.0.x
  and 0.3.1.x, including others that can affect bandwidth usage
  and correctness.
  o New dependencies:
    - To build with zstd and lzma support, Tor now requires the
      pkg-config tool at build time. (This requirement was new in
      0.3.1.1-alpha, but was not noted at the time. Noting it here to
      close ticket 22623.)
  o Major bugfixes (path selection, security):
    - When choosing which guard to use for a circuit, avoid the exit's
      family along with the exit itself. Previously, the new guard
      selection logic avoided the exit, but did not consider its family.
      Fixes bug 22753; bugfix on 0.3.0.1-alpha. Tracked as TROVE-2016-
      006 and CVE-2017-0377.
  o Major bugfixes (compression, zstd):
    - Correctly detect a full buffer when decompressing a large zstd-
      compressed input. Previously, we would sometimes treat a full
      buffer as an error. Fixes bug 22628; bugfix on 0.3.1.1-alpha.
  o Major bugfixes (directory protocol):
    - Ensure that we send "304 Not modified" as HTTP status code when a
      client is attempting to fetch a consensus or consensus diff, and
      the best one we can send them is one they already have. Fixes bug
      22702; bugfix on 0.3.1.1-alpha.
  o Major bugfixes (entry guards):
    - When starting with an old consensus, do not add new entry guards
      unless the consensus is "reasonably live" (under 1 day old). Fixes
      one root cause of bug 22400; bugfix on 0.3.0.1-alpha.
  o Minor features (bug mitigation, diagnostics, logging):
    - Avoid an assertion failure, and log a better error message, when
      unable to remove a file from the consensus cache on Windows.
      Attempts to mitigate and diagnose bug 22752.
  o Minor features (geoip):
    - Update geoip and geoip6 to the June 8 2017 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (compression):
    - When compressing or decompressing a buffer, check for a failure to
      create a compression object. Fixes bug 22626; bugfix
      on 0.3.1.1-alpha.
    - When decompressing a buffer, check for extra data after the end of
      the compressed data. Fixes bug 22629; bugfix on 0.3.1.1-alpha.
    - When decompressing an object received over an anonymous directory
      connection, if we have already decompressed it using an acceptable
      compression method, do not reject it for looking like an
      unacceptable compression method. Fixes part of bug 22670; bugfix
      on 0.3.1.1-alpha.
    - When serving directory votes compressed with zlib, do not claim to
      have compressed them with zstd. Fixes bug 22669; bugfix
      on 0.3.1.1-alpha.
    - When spooling compressed data to an output buffer, don't try to
      spool more data when there is no more data to spool and we are not
      trying to flush the input. Previously, we would sometimes launch
      compression requests with nothing to do, which interferes with our
      22672 checks. Fixes bug 22719; bugfix on 0.2.0.16-alpha.
  o Minor bugfixes (defensive programming):
    - Detect and break out of infinite loops in our compression code. We
      don't think that any such loops exist now, but it's best to be
      safe. Closes ticket 22672.
    - Fix a memset() off the end of an array when packing cells. This
      bug should be harmless in practice, since the corrupted bytes are
      still in the same structure, and are always padding bytes,
      ignored, or immediately overwritten, depending on compiler
      behavior. Nevertheless, because the memset()'s purpose is to make
      sure that any other cell-handling bugs can't expose bytes to the
      network, we need to fix it. Fixes bug 22737; bugfix on
      0.2.4.11-alpha. Fixes CID 1401591.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Permit the fchmod system call, to avoid crashing on startup when
      starting with the seccomp2 sandbox and an unexpected set of
      permissions on the data directory or its contents. Fixes bug
      22516; bugfix on 0.2.5.4-alpha.
    - Fix a crash in the LZMA module, when the sandbox was enabled, and
      liblzma would allocate more than 16 MB of memory. We solve this by
      bumping the mprotect() limit in the sandbox module from 16 MB to
      20 MB. Fixes bug 22751; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (logging):
    - When decompressing, do not warn if we fail to decompress using a
      compression method that we merely guessed. Fixes part of bug
      22670; bugfix on 0.1.1.14-alpha.
    - When decompressing, treat mismatch between content-encoding and
      actual compression type as a protocol warning. Fixes part of bug
      22670; bugfix on 0.1.1.9-alpha.
    - Downgrade "assigned_to_cpuworker failed" message to info-level
      severity. In every case that can reach it, either a better warning
      has already been logged, or no warning is warranted. Fixes bug
      22356; bugfix on 0.2.6.3-alpha.
    - Demote a warn that was caused by libevent delays to info if
      netflow padding is less than 4.5 seconds late, or to notice
      if it is more (4.5 seconds is the amount of time that a netflow
      record might be emitted after, if we chose the maximum timeout).
      Fixes bug 22212; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (process behavior):
    - When exiting because of an error, always exit with a nonzero exit
      status. Previously, we would fail to report an error in our exit
      status in cases related to __OwningControllerProcess failure,
      lockfile contention, and Ed25519 key initialization. Fixes bug
      22720; bugfix on versions 0.2.1.6-alpha, 0.2.2.28-beta, and
      0.2.7.2-alpha respectively. Reported by "f55jwk4f"; patch
      from "huyvq".
  o Documentation:
    - Add a manpage description for the key-pinning-journal file. Closes
      ticket 22347.
    - Correctly note that bandwidth accounting values are stored in the
      state file, and the bw_accounting file is now obsolete. Closes
      ticket 16082.
    - Document more of the files in the Tor data directory, including
      cached-extrainfo, secret_onion_key{,_ntor}.old, hidserv-stats,
      approved-routers, sr-random, and diff-cache. Found while fixing
      ticket 22347.

@_date: 2017-06-29 18:57:04
@_author: Nick Mathewson 
@_subject: [tor-talk] 0.3.1.4-alpha is released (with guard-related 
Argh. I knew I'd make a copy-and-paste error.
The new release is 0.3.1.4-alpha, of course.

@_date: 2017-05-22 14:35:58
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.1.1-alpha is released! 
(Also, 0.3.0.7 was released last week.  If you didn't know, you should
subscribe to tor-announcements.)
Hi, all!
You can find the source code for Tor 0.3.0.1-alpha  at the usual place.  It's an alpha, so please expect plenty of bugs,
and be ready to report them.  Packages should be out over the next
weeks -- I'd expect this series to hit Tor Browser alpha releases some
time in the middle of June.
Changes in version 0.3.1.1-alpha - 2017-05-22
  Tor 0.3.1.1-alpha is the first release in the 0.3.1.x series. It
  reduces the bandwidth usage for Tor's directory protocol, adds some
  basic padding to resist netflow-based traffic analysis and to serve as
  the basis of other padding in the future, and adds rust support to the
  build system.
  It also contains numerous other small features and improvements to
  security, correctness, and performance.
  Below are the changes since 0.3.0.7.
  o Major features (directory protocol):
    - Tor relays and authorities can now serve clients an abbreviated
      version of the consensus document, containing only the changes
      since an older consensus document that the client holds. Clients
      now request these documents when available. When both client and
      server use this new protocol, they will use far less bandwidth (up
      to 94% less) to keep the client's consensus up-to-date. Implements
      proposal 140; closes ticket 13339. Based on work by Daniel Mart.
    - Tor can now compress directory traffic with lzma or with zstd
      compression algorithms, which can deliver better bandwidth
      performance. Because lzma is computationally expensive, it's only
      used for documents that can be compressed once and served many
      times. Support for these algorithms requires that tor is built
      with the libzstd and/or liblzma libraries available. Implements
      proposal 278; closes ticket 21662.
    - Relays now perform the more expensive compression operations, and
      consensus diff generation, in worker threads. This separation
      avoids delaying the main thread when a new consensus arrives.
  o Major features (experimental):
    - Tor can now build modules written in Rust. To turn this on, pass
      the "--enable-rust" flag to the configure script. It's not time to
      get excited yet: currently, there is no actual Rust functionality
      beyond some simple glue code, and a notice at startup to tell you
      that Rust is running. Still, we hope that programmers and
      packagers will try building Tor with Rust support, so that we can
      find issues and solve portability problems. Closes ticket 22106.
  o Major features (traffic analysis resistance):
    - Connections between clients and relays now send a padding cell in
      each direction every 1.5 to 9.5 seconds (tunable via consensus
      parameters). This padding will not resist specialized
      eavesdroppers, but it should be enough to make many ISPs' routine
      network flow logging less useful in traffic analysis against
      Tor users.
      Padding is negotiated using Tor's link protocol, so both relays
      and clients must upgrade for this to take effect. Clients may
      still send padding despite the relay's version by setting
      ConnectionPadding 1 in torrc, and may disable padding by setting
      ConnectionPadding 0 in torrc. Padding may be minimized for mobile
      users with the torrc option ReducedConnectionPadding. Implements
      Proposal 251 and Section 2 of Proposal 254; closes ticket 16861.
    - Relays will publish 24 hour totals of padding and non-padding cell
      counts to their extra-info descriptors, unless PaddingStatistics 0
      is set in torrc. These 24 hour totals are also rounded to
      multiples of 10000.
  o Major bugfixes (connection usage):
    - We use NETINFO cells to try to determine if both relays involved
      in a connection will agree on the canonical status of that
      connection. We prefer the connections where this is the case for
      extend cells, and try to close connections where relays disagree
      on their canonical status early. Also, we now prefer the oldest
      valid connection for extend cells. These two changes should reduce
      the number of long-term connections that are kept open between
      relays. Fixes bug 17604; bugfix on 0.2.5.5-alpha.
    - Relays now log hourly statistics (look for
      "channel_check_for_duplicates" lines) on the total number of
      connections to other relays. If the number of connections per
      relay is unexpectedly large, this log message is at notice level.
      Otherwise it is at info.
  o Major bugfixes (entry guards):
    - Don't block bootstrapping when a primary bridge is offline and we
      can't get its descriptor. Fixes bug 22325; fixes one case of bug
      21969; bugfix on 0.3.0.3-alpha.
  o Major bugfixes (linux TPROXY support):
    - Fix a typo that had prevented TPROXY-based transparent proxying
      from working under Linux. Fixes bug 18100; bugfix on 0.2.6.3-alpha.
      Patch from "d4fq0fQAgoJ".
  o Minor features (security, windows):
    - Enable a couple of pieces of Windows hardening: one
      (HeapEnableTerminationOnCorruption) that has been on-by-default
      since Windows 8, and unavailable before Windows 7; and one
      (PROCESS_DEP_DISABLE_ATL_THUNK_EMULATION) which we believe doesn't
      affect us, but shouldn't do any harm. Closes ticket 21953.
  o Minor features (config options):
    - Allow "%include" directives in torrc configuration files. These
      directives import the settings from other files, or from all the
      files in a directory. Closes ticket 1922. Code by Daniel Pinto.
    - Make SAVECONF return an error when overwriting a torrc that has
      includes. Using SAVECONF with the FORCE option will allow it to
      overwrite torrc even if includes are used. Related to ticket 1922.
    - Add "GETINFO config-can-saveconf" to tell controllers if SAVECONF
      will work without the FORCE option. Related to ticket 1922.
  o Minor features (controller):
    - Warn the first time that a controller requests data in the long-
      deprecated 'GETINFO network-status' format. Closes ticket 21703.
  o Minor features (defaults):
    - The default value for UseCreateFast is now 0: clients which
      haven't yet received a consensus document will now use a proper
      ntor handshake to talk to their directory servers whenever they
      can. Closes ticket 21407.
    - Onion key rotation and expiry intervals are now defined as a
      network consensus parameter, per proposal 274. The default
      lifetime of an onion key is increased from 7 to 28 days. Old onion
      keys will expire after 7 days by default. This change will make
      consensus diffs much smaller, and save significant bandwidth.
      Closes ticket 21641.
  o Minor features (fallback directory list):
    - Update the fallback directory mirror whitelist and blacklist based
      on operator emails. Closes task 21121.
    - Replace the 177 fallbacks originally introduced in Tor 0.2.9.8 in
      December 2016 (of which ~126 were still functional) with a list of
      151 fallbacks (32 new, 119 unchanged, 58 removed) generated in May
      2017. Resolves ticket 21564.
  o Minor features (hidden services, logging):
    - Log a message when a hidden service descriptor has fewer
      introduction points than specified in
      HiddenServiceNumIntroductionPoints. Closes tickets 21598.
    - Log a message when a hidden service reaches its introduction point
      circuit limit, and when that limit is reset. Follow up to ticket
      21594; closes ticket 21622.
    - Warn user if multiple entries in EntryNodes and at least one
      HiddenService are used together. Pinning EntryNodes along with a
      hidden service can be possibly harmful; for instance see ticket
      14917 or 21155. Closes ticket 21155.
  o Minor features (linux seccomp2 sandbox):
    - We now have a document storage backend compatible with the Linux
      seccomp2 sandbox. This backend is used for consensus documents and
      diffs between them; in the long term, we'd like to use it for
      unparseable directory material too. Closes ticket 21645
    - Increase the maximum allowed size passed to mprotect(PROT_WRITE)
      from 1MB to 16MB. This was necessary with the glibc allocator in
      order to allow worker threads to allocate more memory -- which in
      turn is necessary because of our new use of worker threads for
      compression. Closes ticket 22096.
  o Minor features (logging):
    - Log files are no longer created world-readable by default.
      (Previously, most distributors would store the logs in a non-
      world-readable location to prevent inappropriate access. This
      change is an extra precaution.) Closes ticket 21729; patch
      from toralf.
  o Minor features (performance):
    - Our Keccak (SHA-3) implementation now accesses memory more
      efficiently, especially on little-endian systems. Closes
      ticket 21737.
    - Add an O(1) implementation of channel_find_by_global_id(), to
      speed some controller functions.
  o Minor features (relay, configuration):
    - The MyFamily option may now be repeated as many times as desired,
      for relays that want to configure large families. Closes ticket
      4998; patch by Daniel Pinto.
  o Minor features (safety):
    - Add an explicit check to extrainfo_parse_entry_from_string() for
      NULL inputs. We don't believe this can actually happen, but it may
      help silence a warning from the Clang analyzer. Closes
      ticket 21496.
  o Minor features (testing):
    - Add a "--disable-memory-sentinels" feature to help with fuzzing.
      When Tor is compiled with this option, we disable a number of
      redundant memory-safety failsafes that are intended to stop bugs
      from becoming security issues. This makes it easier to hunt for
      bugs that would be security issues without the failsafes turned
      on. Closes ticket 21439.
    - Add a general event-tracing instrumentation support to Tor. This
      subsystem will enable developers and researchers to add fine-
      grained instrumentation to their Tor instances, for use when
      examining Tor network performance issues. There are no trace
      events yet, and event-tracing is off by default unless enabled at
      compile time. Implements ticket 13802.
    - Improve our version parsing tests: add tests for typical version
      components, add tests for invalid versions, including numeric
      range and non-numeric prefixes. Unit tests 21278, 21450, and
      21507. Partially implements 21470.
  o Minor bugfixes (bandwidth accounting):
    - Roll over monthly accounting at the configured hour and minute,
      rather than always at 00:00. Fixes bug 22245; bugfix on 0.0.9rc1.
      Found by Andrey Karpov with PVS-Studio.
  o Minor bugfixes (code correctness):
    - Accurately identify client connections by their lack of peer
      authentication. This means that we bail out earlier if asked to
      extend to a client. Follow-up to 21407. Fixes bug 21406; bugfix
      on 0.2.4.23.
  o Minor bugfixes (configuration):
    - Do not crash when starting with LearnCircuitBuildTimeout 0. Fixes
      bug 22252; bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (connection lifespan):
    - Allow more control over how long TLS connections are kept open:
      unify CircuitIdleTimeout and PredictedPortsRelevanceTime into a
      single option called CircuitsAvailableTimeout. Also, allow the
      consensus to control the default values for both this preference
      and the lifespan of relay-to-relay connections. Fixes bug 17592;
      bugfix on 0.2.5.5-alpha.
    - Increase the initial circuit build timeout testing frequency, to
      help ensure that ReducedConnectionPadding clients finish learning
      a timeout before their orconn would expire. The initial testing
      rate was set back in the days of TAP and before the Tor Browser
      updater, when we had to be much more careful about new clients
      making lots of circuits. With this change, a circuit build timeout
      is learned in about 15-20 minutes, instead of 100-120 minutes.
  o Minor bugfixes (controller):
    - GETINFO onions/current and onions/detached no longer respond with
      551 on empty lists. Fixes bug 21329; bugfix on 0.2.7.1-alpha.
    - Trigger HS descriptor events on the control port when the client
      fails to pick a hidden service directory for a hidden service.
      This can happen if all the hidden service directories are in
      ExcludeNodes, or they have all been queried within the last 15
      minutes. Fixes bug 22042; bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (directory authority):
    - When rejecting a router descriptor for running an obsolete version
      of Tor without ntor support, warn about the obsolete tor version,
      not the missing ntor key. Fixes bug 20270; bugfix on 0.2.9.3-alpha.
    - Prevent the shared randomness subsystem from asserting when
      initialized by a bridge authority with an incomplete configuration
      file. Fixes bug 21586; bugfix on 0.2.9.8.
  o Minor bugfixes (exit-side DNS):
    - Fix an untriggerable assertion that checked the output of a
      libevent DNS error, so that the assertion actually behaves as
      expected. Fixes bug 22244; bugfix on 0.2.0.20-rc. Found by Andrey
      Karpov using PVS-Studio.
  o Minor bugfixes (fallback directories):
    - Make the usage example in updateFallbackDirs.py actually work, and
      explain what it does. Fixes bug 22270; bugfix on 0.3.0.3-alpha.
    - Decrease the guard flag average required to be a fallback. This
      allows us to keep relays that have their guard flag removed when
      they restart. Fixes bug 20913; bugfix on 0.2.8.1-alpha.
    - Decrease the minimum number of fallbacks to 100. Fixes bug 20913;
      bugfix on 0.2.8.1-alpha.
    - Make sure fallback directory mirrors have the same address, port,
      and relay identity key for at least 30 days before they are
      selected. Fixes bug 20913; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (hidden services):
    - Stop printing a cryptic warning when a hidden service gets a
      request to connect to a virtual port that it hasn't configured.
      Fixes bug 16706; bugfix on 0.2.6.3-alpha.
    - Simplify hidden service descriptor creation by using an existing
      flag to check if an introduction point is established. Fixes bug
      21599; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (memory leak):
    - Fix a small memory leak at exit from the backtrace handler code.
      Fixes bug 21788; bugfix on 0.2.5.2-alpha. Patch from Daniel Pinto.
  o Minor bugfixes (protocol, logging):
    - Downgrade a log statement about unexpected relay cells from "bug"
      to "protocol warning", because there is at least one use case
      where it can be triggered by a buggy tor implementation. Fixes bug
      21293; bugfix on 0.1.1.14-alpha.
  o Minor bugfixes (testing):
    - Use unbuffered I/O for utility functions around the
      process_handle_t type. This fixes unit test failures reported on
      OpenBSD and FreeBSD. Fixes bug 21654; bugfix on 0.2.3.1-alpha.
    - Make display of captured unit test log messages consistent. Fixes
      bug 21510; bugfix on 0.2.9.3-alpha.
    - Make test-network.sh always call chutney's test-network.sh.
      Previously, this only worked on systems which had bash installed,
      due to some bash-specific code in the script. Fixes bug 19699;
      bugfix on 0.3.0.4-rc. Follow-up to ticket 21581.
  o Minor bugfixes (voting consistency):
    - Reject version numbers with non-numeric prefixes (such as +, -, or
      whitespace). Disallowing whitespace prevents differential version
      parsing between POSIX-based and Windows platforms. Fixes bug 21507
      and part of 21508; bugfix on 0.0.8pre1.
  o Minor bugfixes (windows, relay):
    - Resolve "Failure from drain_fd: No error" warnings on Windows
      relays. Fixes bug 21540; bugfix on 0.2.6.3-alpha.
  o Code simplification and refactoring:
    - Break up the 630-line function connection_dir_client_reached_eof()
      into a dozen smaller functions. This change should help
      maintainability and readability of the client directory code.
    - Isolate our use of the openssl headers so that they are only
      included from our crypto wrapper modules, and from tests that
      examine those modules' internals. Closes ticket 21841.
    - Simplify our API to launch directory requests, making it more
      extensible and less error-prone. Now it's easier to add extra
      headers to directory requests. Closes ticket 21646.
    - Our base64 decoding functions no longer overestimate the output
      space that they need when parsing unpadded inputs. Closes
      ticket 17868.
    - Remove unused "ROUTER_ADDED_NOTIFY_GENERATOR" internal value.
      Resolves ticket 22213.
    - The logic that directory caches use to spool request to clients,
      serving them one part at a time so as not to allocate too much
      memory, has been refactored for consistency. Previously there was
      a separate spooling implementation per type of spoolable data. Now
      there is one common spooling implementation, with extensible data
      types. Closes ticket 21651.
    - Tor's compression module now supports multiple backends. Part of
      the implementation for proposal 278; closes ticket 21663.
  o Documentation:
    - Clarify the behavior of the KeepAliveIsolateSOCKSAuth sub-option.
      Closes ticket 21873.
    - Correct documentation about the default DataDirectory value.
      Closes ticket 21151.
    - Document the default behavior of NumEntryGuards and
      NumDirectoryGuards correctly. Fixes bug 21715; bugfix
      on 0.3.0.1-alpha.
    - Document key=value pluggable transport arguments for Bridge lines
      in torrc. Fixes bug 20341; bugfix on 0.2.5.1-alpha.
    - Note that bandwidth-limiting options don't affect TCP headers or
      DNS. Closes ticket 17170.
  o Removed features (configuration options, all in ticket 22060):
    - These configuration options are now marked Obsolete, and no longer
      have any effect: AllowInvalidNodes, AllowSingleHopCircuits,
      AllowSingleHopExits, ExcludeSingleHopRelays, FastFirstHopPK,
      TLSECGroup, WarnUnsafeSocks. They were first marked as deprecated
      in 0.2.9.2-alpha and have now been removed. The previous default
      behavior is now always chosen; the previous (less secure) non-
      default behavior is now unavailable.
    - CloseHSClientCircuitsImmediatelyOnTimeout and
      CloseHSServiceRendCircuitsImmediatelyOnTimeout were deprecated in
      0.2.9.2-alpha and now have been removed. HS circuits never close
      on circuit build timeout; they have a longer timeout period.
    - {Control,DNS,Dir,Socks,Trans,NATD,OR}ListenAddress were deprecated
      in 0.2.9.2-alpha and now have been removed. Use the ORPort option
      (and others) to configure listen-only and advertise-only addresses.
  o Removed features (tools):
    - We've removed the tor-checkkey tool from src/tools. Long ago, we
      used it to help people detect RSA keys that were generated by
      versions of Debian affected by CVE-2008-0166. But those keys have
      been out of circulation for ages, and this tool is no longer
      required. Closes ticket 21842.

@_date: 2017-11-08 16:53:37
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: Tor 0.3.2.4-alpha 
Hello, everyone!
There's a groovy new alpha you can run and look for bugs in!  Because it's
an alpha, you should only run it if you're ready to find more bugs than
usual, and report them on trac.torproject.org.
The source code is available from the usual place on  ;
if you build Tor from source, why not give it a try?  And if you don't
build Tor from source, packages should be ready over the coming days, with
a Tor Browser alpha release likely by some time in the next week or so.
Here's what's new since 0.3.2.3-alpha!
Changes in version 0.3.2.4-alpha - 2017-11-08
  Tor 0.3.2.4-alpha is the fourth alpha release in the 0.3.2.x series.
  It fixes several stability and reliability bugs, especially including
  a major reliability issue that has been plaguing fast exit relays in
  recent months.
  o Major bugfixes (exit relays, DNS):
    - Fix an issue causing DNS to fail on high-bandwidth exit nodes,
      making them nearly unusable. Fixes bugs 21394 and 18580; bugfix on
      0.1.2.2-alpha, which introduced eventdns. Thanks to Dhalgren for
      identifying and finding a workaround to this bug and to Moritz,
      Arthur Edelstein, and Roger for helping to track it down and
      analyze it.
  o Major bugfixes (scheduler, channel):
    - Stop processing scheduled channels if they closed while flushing
      cells. This can happen if the write on the connection fails
      leading to the channel being closed while in the scheduler loop.
      Fixes bug 23751; bugfix on 0.3.2.1-alpha.
  o Minor features (logging, scheduler):
    - Introduce a SCHED_BUG() function to log extra information about
      the scheduler state if we ever catch a bug in the scheduler.
      Closes ticket 23753.
  o Minor features (removed deprecations):
    - The ClientDNSRejectInternalAddresses flag can once again be set in
      non-testing Tor networks, so long as they do not use the default
      directory authorities. This change also removes the deprecation of
      this flag from 0.2.9.2-alpha. Closes ticket 21031.
  o Minor features (testing):
    - Our fuzzing tests now test the encrypted portions of v3 onion
      service descriptors. Implements more of 21509.
  o Minor bugfixes (directory client):
    - On failure to download directory information, delay retry attempts
      by a random amount based on the "decorrelated jitter" algorithm.
      Our previous delay algorithm tended to produce extra-long delays
      too easily. Fixes bug 23816; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (IPv6, v3 single onion services):
    - Remove buggy code for IPv6-only v3 single onion services, and
      reject attempts to configure them. This release supports IPv4,
      dual-stack, and IPv6-only v3 onion services; and IPv4 and dual-
      stack v3 single onion services. Fixes bug 23820; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (logging, relay):
    - Give only a protocol warning when the ed25519 key is not
      consistent between the descriptor and microdescriptor of a relay.
      This can happen, for instance, if the relay has been flagged
      NoEdConsensus. Fixes bug 24025; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (manpage, onion service):
    - Document that the HiddenServiceNumIntroductionPoints option is
      0-10 for v2 services and 0-20 for v3 services. Fixes bug 24115;
      bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a minor memory leak at exit in the KIST scheduler. This bug
      should have no user-visible impact. Fixes bug 23774; bugfix
      on 0.3.2.1-alpha.
    - Fix a memory leak when decrypting a badly formatted v3 onion
      service descriptor. Fixes bug 24150; bugfix on 0.3.2.1-alpha.
      Found by OSS-Fuzz; this is OSS-Fuzz issue 3994.
  o Minor bugfixes (onion services):
    - Cache some needed onion service client information instead of
      constantly computing it over and over again. Fixes bug 23623;
      bugfix on 0.3.2.1-alpha.
    - Properly retry HSv3 descriptor fetches when missing required
      directory information. Fixes bug 23762; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (path selection):
    - When selecting relays by bandwidth, avoid a rounding error that
      could sometimes cause load to be imbalanced incorrectly.
      Previously, we would always round upwards; now, we round towards
      the nearest integer. This had the biggest effect when a relay's
      weight adjustments should have given it weight 0, but it got
      weight 1 instead. Fixes bug 23318; bugfix on 0.2.4.3-alpha.
    - When calculating the fraction of nodes that have descriptors, and
      all nodes in the network have zero bandwidths, count the number of
      nodes instead. Fixes bug 23318; bugfix on 0.2.4.10-alpha.
    - Actually log the total bandwidth in compute_weighted_bandwidths().
      Fixes bug 24170; bugfix on 0.2.4.3-alpha.
  o Minor bugfixes (relay, crash):
    - Avoid a crash when transitioning from client mode to bridge mode.
      Previously, we would launch the worker threads whenever our
      "public server" mode changed, but not when our "server" mode
      changed. Fixes bug 23693; bugfix on 0.2.6.3-alpha.
  o Minor bugfixes (testing):
    - Fix a spurious fuzzing-only use of an uninitialized value. Found
      by Brian Carpenter. Fixes bug 24082; bugfix on 0.3.0.3-alpha.
    - Test that IPv6-only clients can use microdescriptors when running
      "make test-network-all". Requires chutney master 61c28b9 or later.
      Closes ticket 24109.

@_date: 2017-11-22 08:28:08
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.2.5-alpha is released 
There's a fun new alpha you can run!  Because it's an alpha, you
should only run it if you're ready to find more bugs than usual, and
report them on trac.torproject.org.
The source code is available from the usual place on
 ; if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days.  There probably won't be a Tor Browser release
for this one -- it's likelier to include the next alpha instead, which
should be out in early December.
Here's what's new since 0.3.2.4-alpha:
Changes in version 0.3.2.5-alpha - 2017-11-22
  Tor 0.3.2.5-alpha is the fifth alpha release in the 0.3.2.x series. It
  fixes several stability and reliability bugs, including a fix for
  intermittent bootstrapping failures that some people have been seeing
  since the 0.3.0.x series.
  Please test this alpha out -- many of these fixes will soon be
  backported to stable Tor versions if no additional bugs are found
  in them.
  o Major bugfixes (bootstrapping):
    - Fetch descriptors aggressively whenever we lack enough to build
      circuits, regardless of how many descriptors we are missing.
      Previously, we would delay launching the fetch when we had fewer
      than 15 missing descriptors, even if some of those descriptors
      were blocking circuits from building. Fixes bug 23985; bugfix on
      0.1.1.11-alpha. The effects of this bug became worse in
      0.3.0.3-alpha, when we began treating missing descriptors from our
      primary guards as a reason to delay circuits.
    - Don't try fetching microdescriptors from relays that have failed
      to deliver them in the past. Fixes bug 23817; bugfix
      on 0.3.0.1-alpha.
  o Minor features (directory authority):
    - Make the "Exit" flag assignment only depend on whether the exit
      policy allows connections to ports 80 and 443. Previously relays
      would get the Exit flag if they allowed connections to one of
      these ports and also port 6667. Resolves ticket 23637.
  o Minor features (geoip):
    - Update geoip and geoip6 to the November 6 2017 Maxmind GeoLite2
      Country database.
  o Minor features (linux seccomp2 sandbox):
    - Update the sandbox rules so that they should now work correctly
      with Glibc 2.26. Closes ticket 24315.
  o Minor features (logging):
    - Downgrade a pair of log messages that could occur when an exit's
      resolver gave us an unusual (but not forbidden) response. Closes
      ticket 24097.
    - Improve the message we log when re-enabling circuit build timeouts
      after having received a consensus. Closes ticket 20963.
  o Minor bugfixes (compilation):
    - Fix a memory leak warning in one of the libevent-related
      configuration tests that could occur when manually specifying
      -fsanitize=address. Fixes bug 24279; bugfix on 0.3.0.2-alpha.
      Found and patched by Alex Xu.
    - When detecting OpenSSL on Windows from our configure script, make
      sure to try linking with the ws2_32 library. Fixes bug 23783;
      bugfix on 0.3.2.2-alpha.
  o Minor bugfixes (control port, linux seccomp2 sandbox):
    - Avoid a crash when attempting to use the seccomp2 sandbox together
      with the OwningControllerProcess feature. Fixes bug 24198; bugfix
      on 0.2.5.1-alpha.
  o Minor bugfixes (control port, onion services):
    - Report "FAILED" instead of "UPLOAD_FAILED" "FAILED" for the
      HS_DESC event when a service is not able to upload a descriptor.
      Fixes bug 24230; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (directory cache):
    - Recover better from empty or corrupt files in the consensus cache
      directory. Fixes bug 24099; bugfix on 0.3.1.1-alpha.
    - When a consensus diff calculation is only partially successful,
      only record the successful parts as having succeeded. Partial
      success can happen if (for example) one compression method fails
      but the others succeed. Previously we misrecorded all the
      calculations as having succeeded, which would later cause a
      nonfatal assertion failure. Fixes bug 24086; bugfix
      on 0.3.1.1-alpha.
  o Minor bugfixes (logging):
    - Only log once if we notice that KIST support is gone. Fixes bug
      24158; bugfix on 0.3.2.1-alpha.
    - Suppress a log notice when relay descriptors arrive. We already
      have a bootstrap progress for this so no need to log notice
      everytime tor receives relay descriptors. Microdescriptors behave
      the same. Fixes bug 23861; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (network layer):
    - When closing a connection via close_connection_immediately(), we
      mark it as "not blocked on bandwidth", to prevent later calls from
      trying to unblock it, and give it permission to read. This fixes a
      backtrace warning that can happen on relays under various
      circumstances. Fixes bug 24167; bugfix on 0.1.0.1-rc.
  o Minor bugfixes (onion services):
    - The introduction circuit was being timed out too quickly while
      waiting for the rendezvous circuit to complete. Keep the intro
      circuit around longer instead of timing out and reopening new ones
      constantly. Fixes bug 23681; bugfix on 0.2.4.8-alpha.
    - Rename the consensus parameter "hsdir-interval" to "hsdir_interval"
      so it matches dir-spec.txt. Fixes bug 24262; bugfix
      on 0.3.1.1-alpha.
    - Silence a warning about failed v3 onion descriptor uploads that
      can happen naturally under certain edge cases. Fixes part of bug
      23662; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (tests):
    - Fix a memory leak in one of the bridge-distribution test cases.
      Fixes bug 24345; bugfix on 0.3.2.3-alpha.
    - Fix a bug in our fuzzing mock replacement for crypto_pk_checksig(),
      to correctly handle cases where a caller gives it an RSA key of
      under 160 bits. (This is not actually a bug in Tor itself, but
      rather in our fuzzing code.) Fixes bug 24247; bugfix on
      0.3.0.3-alpha. Found by OSS-Fuzz as issue 4177.
  o Documentation:
    - Add notes in man page regarding OS support for the various
      scheduler types. Attempt to use less jargon in the scheduler
      section. Closes ticket 24254.

@_date: 2017-11-30 12:00:49
@_author: Nick Mathewson 
@_subject: [tor-talk] Security releases tomorrow for Tor 
============================== START ==============================
I'm sending this message to announce that we will be releasing new
stable and versions of Tor tomorrow, to fix 5 security bugs.  I
apologise for the short notice; we've had to move up our intended
release date in order to try to match with release deadlines for
downstream projects.
We have classified 3 of these bugs as Medium and 2 as High, per draft
security process at
.  The most serious bugs are a pair of denial-of-service issues, which
we treat as high security because of the possibility of escalating
them for traffic-analysis purposes.
Note that only the following series are supported, and only they will
receive updates: 0.2.5, 0.2.8, 0.2.9, 0.3.0, 0.3.1, and 0.3.2.  0.2.8
and 0.3.0 will become unsupported in January; 0.2.5 will become
unsupported in May.
best wishes,

@_date: 2017-10-27 12:06:05
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: 0.3.2.3-alpha 
Hi, all!
There's a fun new alpha you can run and look for bugs in!  Because it's an
alpha, you should only run it if you're ready to find more bugs than usual,
and report them on trac.torproject.org.
The source code is available from the usual place on  ;
if you build Tor from source, why not give it a try?  And if you don't
build Tor from source, packages should be ready over the coming days, with
a Tor Browser alpha release likely by some time in November.
(There were also new stable releases a few days ago, but they get announced
on the nice low-volume tor-announcements mailing list.)
Here's what's new since 0.3.2.2-alpha!
Changes in version 0.3.2.3-alpha - 2017-10-27
  Tor 0.3.2.3-alpha is the third release in the 0.3.2 series. It fixes
  numerous small bugs in earlier versions of 0.3.2.x, and adds a new
  directory authority, Bastet.
  o Directory authority changes:
    - Add "Bastet" as a ninth directory authority to the default list.
      Closes ticket 23910.
    - The directory authority "Longclaw" has changed its IP address.
      Closes ticket 23592.
  o Minor features (bridge):
    - Bridge relays can now set the BridgeDistribution config option to
      add a "bridge-distribution-request" line to their bridge
      descriptor, which tells BridgeDB how they'd like their bridge
      address to be given out. (Note that as of Oct 2017, BridgeDB does
      not yet implement this feature.) As a side benefit, this feature
      provides a way to distinguish bridge descriptors from non-bridge
      descriptors. Implements tickets 18329.
  o Minor features (client, entry guards):
    - Improve log messages when missing descriptors for primary guards.
      Resolves ticket 23670.
  o Minor features (geoip):
    - Update geoip and geoip6 to the October 4 2017 Maxmind GeoLite2
      Country database.
  o Minor bugfixes (bridge):
    - Overwrite the bridge address earlier in the process of retrieving
      its descriptor, to make sure we reach it on the configured
      address. Fixes bug 20532; bugfix on 0.2.0.10-alpha.
  o Minor bugfixes (documentation):
    - Document better how to read gcov, and what our gcov postprocessing
      scripts do. Fixes bug 23739; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (entry guards):
    - Tor now updates its guard state when it reads a consensus
      regardless of whether it's missing descriptors. That makes tor use
      its primary guards to fetch descriptors in some edge cases where
      it would previously have used fallback directories. Fixes bug
      23862; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (hidden service client):
    - When handling multiple SOCKS request for the same .onion address,
      only fetch the service descriptor once.
    - When a descriptor fetch fails with a non-recoverable error, close
      all pending SOCKS requests for that .onion. Fixes bug 23653;
      bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (hidden service):
    - Always regenerate missing hidden service public key files. Prior
      to this, if the public key was deleted from disk, it wouldn't get
      recreated. Fixes bug 23748; bugfix on 0.3.2.2-alpha. Patch
      from "cathugger".
    - Make sure that we have a usable ed25519 key when the intro point
      relay supports ed25519 link authentication. Fixes bug 24002;
      bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (hidden service, v2):
    - When reloading configured hidden services, copy all information
      from the old service object. Previously, some data was omitted,
      causing delays in descriptor upload, and other bugs. Fixes bug
      23790; bugfix on 0.2.1.9-alpha.
  o Minor bugfixes (memory safety, defensive programming):
    - Clear the target address when node_get_prim_orport() returns
      early. Fixes bug 23874; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (relay):
    - Avoid a BUG warning when receiving a dubious CREATE cell while an
      option transition is in progress. Fixes bug 23952; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (testing):
    - Adjust the GitLab CI configuration to more closely match that of
      Travis CI. Fixes bug 23757; bugfix on 0.3.2.2-alpha.
    - Prevent scripts/test/coverage from attempting to move gcov output
      to the root directory. Fixes bug 23741; bugfix on 0.2.5.1-alpha.
    - When running unit tests as root, skip a test that would fail
      because it expects a permissions error. This affects some
      continuous integration setups. Fixes bug 23758; bugfix
      on 0.3.2.2-alpha.
    - Stop unconditionally mirroring the tor repository in GitLab CI.
      This prevented developers from enabling GitLab CI on master. Fixes
      bug 23755; bugfix on 0.3.2.2-alpha.
    - Fix the hidden service v3 descriptor decoding fuzzing to use the
      latest decoding API correctly. Fixes bug 21509; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (warnings):
    - When we get an HTTP request on a SOCKS port, tell the user about
      the new HTTPTunnelPort option. Previously, we would give a "Tor is
      not an HTTP Proxy" message, which stopped being true when
      HTTPTunnelPort was introduced. Fixes bug 23678; bugfix
      on 0.3.2.1-alpha.

@_date: 2017-09-18 09:41:26
@_author: Nick Mathewson 
@_subject: [tor-talk] Advisory: Stack disclosure in hidden services logs when 
[TROVE-2017-008.  CVE-2017-0380. Severity: medium]
  We have found a possible problem with the code that reports an error
  during the construction of an introduction point circuit.  Because
  of this bug, it is possible that some hidden services will sometimes
  write sensitive information into their logs.
  This bug can only happen when the SafeLogging option is disabled,
  and SafeLogging is enabled by default.  If you have not disabled
  SafeLogging, then you should be fine.
  We are tracking this bug as TROVE-2017-008 and as ticket  It
  is also CVE-2017-0380.
   1. If you are not running a hidden service, then you don't need
      to do anything.  This bug does not affect you.
   2. If you are running 0.2.5.x, this bug does not affect you: it
      first appeared in 0.2.7.2-alpha.  Other bugs do affect you,
      though: 0.2.5.x is pretty old!
      (If you are running 0.2.4, or 0.2.6, or 0.2.7, you should just
      upgrade. We aren't supporting those releases.)
   3. Make sure that you did not change the value of the SafeLogging
      option in your configuration -- or if you did, that you set it
      to "1".  SafeLogging needs to be turned to "0" or "relay" for
      this bug to occur.
   4. If you did disable SafeLogging, re-enable it: Set it to 1, and
      use a HUP signal to tell Tor to reload its configuration.
   5. If you did disable SafeLogging, you should delete any old logs
      that were generated with SafeLogging disabled.
      (You should be regularly removing old logs anyway, as a best
      security practice.)
    We found this when we re-added scan-build's dead assignment
    checker into the checkers that we run on Tor.  Obviously, it's
    time to make sure that scan-build gets run more frequently.
    There are patches for this issue linked from ticket  on
    our bugtracker.
    I will be putting out updated releases today.  This bug will be
    fixed in 0.2.8.15, 0.2.9.12, 0.3.0.11, 0.3.1.7, and
    0.3.2.1-alpha.

@_date: 2017-09-18 14:34:29
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: 0.3.2.1-alpha (and new release series 
Hi, everybody!
After lots of work, we've got a tasty new alpha ready for you to find
bugs in!  Because it's an alpha, you should only run it if you're
ready to find more bugs than usual, and report them on
The source code is available from the usual place on
 ; if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by the
end of the month.
(There were also new stable releases today, but they get announced on
the nice low-volume tor-announcements mailing list.)
If everything goes well, we're hoping to get this release series
stabilized by mid-December.
Here's what's new!
Changes in version 0.3.2.1-alpha - 2017-09-18
  Tor 0.3.2.1-alpha is the first release in the 0.3.2.x series. It
  includes support for our next-generation ("v3") onion service
  protocol, and adds a new circuit scheduler for more responsive
  forwarding decisions from relays. There are also numerous other small
  features and bugfixes here.
  Below are the changes since Tor 0.3.1.7.
  o Major feature (scheduler, channel):
    - Tor now uses new schedulers to decide which circuits should
      deliver cells first, in order to improve congestion at relays. The
      first type is called "KIST" ("Kernel Informed Socket Transport"),
      and is only available on Linux-like systems: it uses feedback from
      the kernel to prevent the kernel's TCP buffers from growing too
      full. The second new scheduler type is called "KISTLite": it
      behaves the same as KIST, but runs on systems without kernel
      support for inspecting TCP implementation details. The old
      scheduler is still available, under the name "Vanilla". To change
      the default scheduler preference order, use the new "Schedulers"
      option. (The default preference order is "KIST,KISTLite,Vanilla".)
      Matt Traudt implemented KIST, based on research by Rob Jansen,
      John Geddes, Christ Wacek, Micah Sherr, and Paul Syverson. For
      more information, see the design paper at
       and the
      followup implementation paper at       Closes ticket 12541.
  o Major features (next-generation onion services):
    - Tor now supports the next-generation onion services protocol for
      clients and services! As part of this release, the core of
      proposal 224 has been implemented and is available for
      experimentation and testing by our users. This newer version of
      onion services ("v3") features many improvements over the legacy
      system, including:
      a) Better crypto (replaced SHA1/DH/RSA1024
      with SHA3/ed25519/curve25519)
      b) Improved directory protocol, leaking much less information to
      directory servers.
      c) Improved directory protocol, with smaller surface for
      targeted attacks.
      d) Better onion address security against impersonation.
      e) More extensible introduction/rendezvous protocol.
      f) A cleaner and more modular codebase.
      You can identify a next-generation onion address by its length:
      they are 56 characters long, as in
      "4acth47i6kxnvkewtm6q7ib2s3ufpo5sqbsnzjpbi7utijcltosqemad.onion".
      In the future, we will release more options and features for v3
      onion services, but we first need a testing period, so that the
      current codebase matures and becomes more robust. Planned features
      include: offline keys, advanced client authorization, improved
      guard algorithms, and statistics. For full details, see
      proposal 224.
      Legacy ("v2") onion services will still work for the foreseeable
      future, and will remain the default until this new codebase gets
      tested and hardened. Service operators who want to experiment with
      the new system can use the 'HiddenServiceVersion 3' torrc
      directive along with the regular onion service configuration
      options. We will publish a blog post about this new feature
      soon! Enjoy!
  o Major bugfixes (usability, control port):
    - Report trusted clock skew indications as bootstrap errors, so
      controllers can more easily alert users when their clocks are
      wrong. Fixes bug 23506; bugfix on 0.1.2.6-alpha.
  o Minor features (bug detection):
    - Log a warning message with a stack trace for any attempt to call
      get_options() during option validation. This pattern has caused
      subtle bugs in the past. Closes ticket 22281.
  o Minor features (client):
    - You can now use Tor as a tunneled HTTP proxy: use the new
      HTTPTunnelPort option to open a port that accepts HTTP CONNECT
      requests. Closes ticket 22407.
    - Add an extra check to make sure that we always use the newer guard
      selection code for picking our guards. Closes ticket 22779.
    - When downloading (micro)descriptors, don't split the list into
      multiple requests unless we want at least 32 descriptors.
      Previously, we split at 4, not 32, which led to significant
      overhead in HTTP request size and degradation in compression
      performance. Closes ticket 23220.
  o Minor features (command line):
    - Add a new commandline option, --key-expiration, which prints when
      the current signing key is going to expire. Implements ticket
      17639; patch by Isis Lovecruft.
  o Minor features (control port):
    - If an application tries to use the control port as an HTTP proxy,
      respond with a meaningful "This is the Tor control port" message,
      and log the event. Closes ticket 1667. Patch from Ravi
      Chandra Padmala.
    - Provide better error message for GETINFO desc/(id|name) when not
      fetching router descriptors. Closes ticket 5847. Patch by
      Kevin Butler.
    - Add GETINFO "{desc,md}/download-enabled", to inform the controller
      whether Tor will try to download router descriptors and
      microdescriptors respectively. Closes ticket 22684.
    - Added new GETINFO targets "ip-to-country/{ipv4,ipv6}-available",
      so controllers can tell whether the geoip databases are loaded.
      Closes ticket 23237.
    - Adds a timestamp field to the CIRC_BW and STREAM_BW bandwidth
      events. Closes ticket 19254. Patch by "DonnchaC".
  o Minor features (development support):
    - Developers can now generate a call-graph for Tor using the
      "calltool" python program, which post-processes object dumps. It
      should work okay on many Linux and OSX platforms, and might work
      elsewhere too. To run it, install calltool from
       and run
      "make callgraph". Closes ticket 19307.
  o Minor features (ed25519):
    - Add validation function to checks for torsion components in
      ed25519 public keys, used by prop224 client-side code. Closes
      ticket 22006. Math help by Ian Goldberg.
  o Minor features (exit relay, DNS):
    - Improve the clarity and safety of the log message from evdns when
      receiving an apparently spoofed DNS reply. Closes ticket 3056.
  o Minor features (integration, hardening):
    - Add a new NoExec option to prevent Tor from running other
      programs. When this option is set to 1, Tor will never try to run
      another program, regardless of the settings of
      PortForwardingHelper, ClientTransportPlugin, or
      ServerTransportPlugin. Once NoExec is set, it cannot be disabled
      without restarting Tor. Closes ticket 22976.
  o Minor features (logging):
    - Improve the warning message for specifying a relay by nickname.
      The previous message implied that nickname registration was still
      part of the Tor network design, which it isn't. Closes
      ticket 20488.
    - If the sandbox filter fails to load, suggest to the user that
      their kernel might not support seccomp2. Closes ticket 23090.
  o Minor features (portability):
    - Check at configure time whether uint8_t is the same type as
      unsigned char. Lots of existing code already makes this
      assumption, and there could be strict aliasing issues if the
      assumption is violated. Closes ticket 22410.
  o Minor features (relay, configuration):
    - Reject attempts to use relative file paths when RunAsDaemon is
      set. Previously, Tor would accept these, but the directory-
      changing step of RunAsDaemon would give strange and/or confusing
      results. Closes ticket 22731.
  o Minor features (startup, safety):
    - When configured to write a PID file, Tor now exits if it is unable
      to do so. Previously, it would warn and continue. Closes
      ticket 20119.
  o Minor features (static analysis):
    - The BUG() macro has been changed slightly so that Coverity no
      longer complains about dead code if the bug is impossible. Closes
      ticket 23054.
  o Minor features (testing):
    - The default chutney network tests now include tests for the v3
      hidden service design. Make sure you have the latest version of
      chutney if you want to run these. Closes ticket 22437.
    - Add a unit test to verify that we can parse a hardcoded v2 hidden
      service descriptor. Closes ticket 15554.
  o Minor bugfixes (certificate handling):
    - Fix a time handling bug in Tor certificates set to expire after
      the year 2106. Fixes bug 23055; bugfix on 0.3.0.1-alpha. Found by
      Coverity as CID 1415728.
  o Minor bugfixes (client, usability):
    - Refrain from needlessly rejecting SOCKS5-with-hostnames and
      SOCKS4a requests that contain IP address strings, even when
      SafeSocks in enabled, as this prevents user from connecting to
      known IP addresses without relying on DNS for resolving. SafeSocks
      still rejects SOCKS connections that connect to IP addresses when
      those addresses are _not_ encoded as hostnames. Fixes bug 22461;
      bugfix on Tor 0.2.6.2-alpha.
  o Minor bugfixes (code correctness):
    - Call htons() in extend_cell_format() for encoding a 16-bit value.
      Previously we used ntohs(), which happens to behave the same on
      all the platforms we support, but which isn't really correct.
      Fixes bug 23106; bugfix on 0.2.4.8-alpha.
    - For defense-in-depth, make the controller's write_escaped_data()
      function robust to extremely long inputs. Fixes bug 19281; bugfix
      on 0.1.1.1-alpha. Reported by Guido Vranken.
  o Minor bugfixes (compilation):
    - Fix unused-variable warnings in donna's Curve25519 SSE2 code.
      Fixes bug 22895; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (consensus expiry):
    - Check for adequate directory information correctly. Previously, Tor
      would reconsider whether it had sufficient directory information
      every 2 minutes. Fixes bug 23091; bugfix on 0.2.0.19-alpha.
  o Minor bugfixes (directory protocol):
    - Directory servers now include a "Date:" http header for response
      codes other than 200. Clients starting with a skewed clock and a
      recent consensus were getting "304 Not modified" responses from
      directory authorities, so without the Date header, the client
      would never hear about a wrong clock. Fixes bug 23499; bugfix
      on 0.0.8rc1.
    - Make clients wait for 6 seconds before trying to download a
      consensus from an authority. Fixes bug 17750; bugfix
      on 0.2.8.1-alpha.
  o Minor bugfixes (DoS-resistance):
    - If future code asks if there are any running bridges, without
      checking if bridges are enabled, log a BUG warning rather than
      crashing. Fixes bug 23524; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (format strictness):
    - Restrict several data formats to decimal. Previously, the
      BuildTimeHistogram entries in the state file, the "bw=" entries in
      the bandwidth authority file, and the process IDs passed to the
      __OwningControllerProcess option could all be specified in hex or
      octal as well as in decimal. This was not an intentional feature.
      Fixes bug 22802; bugfixes on 0.2.2.1-alpha, 0.2.2.2-alpha,
      and 0.2.2.28-beta.
  o Minor bugfixes (heartbeat):
    - If we fail to write a heartbeat message, schedule a retry for the
      minimum heartbeat interval number of seconds in the future. Fixes
      bug 19476; bugfix on 0.2.3.1-alpha.
  o Minor bugfixes (linux seccomp2 sandbox, logging):
    - Fix some messages on unexpected errors from the seccomp2 library.
      Fixes bug 22750; bugfix on 0.2.5.1-alpha. Patch from "cypherpunks".
  o Minor bugfixes (logging):
    - Remove duplicate log messages regarding opening non-local
      SocksPorts upon parsing config and opening listeners at startup.
      Fixes bug 4019; bugfix on 0.2.3.3-alpha.
    - Use a more comprehensible log message when telling the user
      they've excluded every running exit node. Fixes bug 7890; bugfix
      on 0.2.2.25-alpha.
    - When logging the number of descriptors we intend to download per
      directory request, do not log a number higher than then the number
      of descriptors we're fetching in total. Fixes bug 19648; bugfix
      on 0.1.1.8-alpha.
    - When warning about a directory owned by the wrong user, log the
      actual name of the user owning the directory. Previously, we'd log
      the name of the process owner twice. Fixes bug 23487; bugfix
      on 0.2.9.1-alpha.
    - The tor specification says hop counts are 1-based, so fix two log
      messages that mistakenly logged 0-based hop counts. Fixes bug
      18982; bugfix on 0.2.6.2-alpha and 0.2.4.5-alpha. Patch by teor.
      Credit to Xiaofan Li for reporting this issue.
  o Minor bugfixes (portability):
    - Stop using the PATH_MAX variable, which is not defined on GNU
      Hurd. Fixes bug 23098; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (relay):
    - When uploading our descriptor for the first time after startup,
      report the reason for uploading as "Tor just started" rather than
      leaving it blank. Fixes bug 22885; bugfix on 0.2.3.4-alpha.
    - Avoid unnecessary calls to directory_fetches_from_authorities() on
      relays, to prevent spurious address resolutions and descriptor
      rebuilds. This is a mitigation for bug 21789. Fixes bug 23470;
      bugfix on in 0.2.8.1-alpha.
  o Minor bugfixes (tests):
    - Fix a broken unit test for the OutboundAddress option: the parsing
      function was never returning an error on failure. Fixes bug 23366;
      bugfix on 0.3.0.3-alpha.
    - Fix a signed-integer overflow in the unit tests for
      dir/download_status_random_backoff, which was untriggered until we
      fixed bug 17750. Fixes bug 22924; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (usability, control port):
    - Stop making an unnecessary routerlist check in NETINFO clock skew
      detection; this was preventing clients from reporting NETINFO clock
      skew to controllers. Fixes bug 23532; bugfix on 0.2.4.4-alpha.
  o Code simplification and refactoring:
    - Extract the code for handling newly-open channels into a separate
      function from the general code to handle channel state
      transitions. This change simplifies our callgraph, reducing the
      size of the largest strongly connected component by roughly a
      factor of two. Closes ticket 22608.
    - Remove dead code for largely unused statistics on the number of
      times we've attempted various public key operations. Fixes bug
      19871; bugfix on 0.1.2.4-alpha. Fix by Isis Lovecruft.
    - Remove several now-obsolete functions for asking about old
      variants directory authority status. Closes ticket 22311; patch
      from "huyvq".
    - Remove some of the code that once supported "Named" and "Unnamed"
      routers. Authorities no longer vote for these flags. Closes
      ticket 22215.
    - Rename the obsolete malleable hybrid_encrypt functions used in TAP
      and old hidden services, to indicate that they aren't suitable for
      new protocols or formats. Closes ticket 23026.
    - Replace our STRUCT_OFFSET() macro with offsetof(). Closes ticket
      22521. Patch from Neel Chauhan.
    - Split the enormous circuit_send_next_onion_skin() function into
      multiple subfunctions. Closes ticket 22804.
    - Split the portions of the buffer.c module that handle particular
      protocols into separate modules. Part of ticket 23149.
    - Use our test macros more consistently, to produce more useful
      error messages when our unit tests fail. Add coccinelle patches to
      allow us to re-check for test macro uses. Closes ticket 22497.
  o Deprecated features:
    - Deprecate HTTPProxy/HTTPProxyAuthenticator config options. They
      only applies to direct unencrypted HTTP connections to your
      directory server, which your Tor probably isn't using. Closes
      ticket 20575.
  o Documentation:
    - Clarify in the manual that "Sandbox 1" is only supported on Linux
      kernels. Closes ticket 22677.
    - Document all values of PublishServerDescriptor in the manpage.
      Closes ticket 15645.
    - Improve the documentation for the directory port part of the
      DirAuthority line. Closes ticket 20152.
    - Restore documentation for the authorities' "approved-routers"
      file. Closes ticket 21148.
  o Removed features:
    - The AllowDotExit option has been removed as unsafe. It has been
      deprecated since 0.2.9.2-alpha. Closes ticket 23426.
    - The ClientDNSRejectInternalAddresses flag can no longer be set on
      non-testing networks. It has been deprecated since 0.2.9.2-alpha.
      Closes ticket 21031.
    - The controller API no longer includes an AUTHDIR_NEWDESCS event:
      nobody was using it any longer. Closes ticket 22377.

@_date: 2018-04-15 15:53:45
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.3.5-rc: source code is released! 
Hi, all!
There's a new Tor release candidate available as source code! Because it's
an release candidate, you should only run it if you're ready to find bugs,
and report them on trac.torproject.org.
The source code is available from the usual place on  if
you build Tor from source, why not give it a try?  And if you don' t build
Tor from source, packages should be ready over the coming days, with a Tor
Browser alpha release likely some time this week.
Here's what's new:
Changes in version 0.3.3.5-rc - 2018-04-15
  Tor 0.3.3.5-rc fixes various bugs in earlier versions of Tor,
  including some that could affect reliability or correctness.
  This is the first release candidate in the 0.3.3 series. If we find no
  new bugs or regression here, then the first stable 0.3.3 release will
  be nearly identical to this one.
  o Major bugfixes (security, protover, voting):
    - Revise Rust implementation of protover to use a more memory-
      efficient voting algorithm and corresponding data structures, thus
      avoiding a potential memory-based DoS attack where specially
      crafted protocol strings would expand to fill available memory.
      Fixes bug 24031; bugfix on 0.3.3.1-alpha.
  o Major bugfixes (performance, load balancing):
    - Directory authorities no longer vote in favor of the Guard flag
      for relays without directory support. Starting in Tor
      0.3.0.1-alpha, clients have been avoiding using such relays in the
      Guard position, leading to increasingly broken load balancing for
      the 5%-or-so of Guards that don't advertise directory support.
      Fixes bug 22310; bugfix on 0.3.0.6.
  o Minor feature (continuous integration):
    - Update the Travis CI configuration to use the stable Rust channel,
      now that we have decided to require that. Closes ticket 25714.
  o Minor features (config options):
    - Change the way the default value for MaxMemInQueues is calculated.
      We now use 40% of the hardware RAM if the system has 8 GB RAM or
      more. Otherwise we use the former value of 75%. Closes
      ticket 24782.
  o Minor features (geoip):
    - Update geoip and geoip6 to the April 3 2018 Maxmind GeoLite2
      Country database. Closes ticket 25718.
  o Minor bugfixes (client):
    - When using a listed relay as a bridge, and also using
      microdescriptors, and considering that relay as a non-bridge in a
      circuit, treat its microdescriptor as a valid source of
      information about that relay. This change should prevent a non-
      fatal assertion error. Fixes bug 25691; bugfix on 0.3.3.4-alpha.
  o Minor bugfixes (controller):
    - Restore the correct operation of the RESOLVE command, which had
      been broken since we added the ability to enable/disable DNS on
      specific listener ports. Fixes bug 25617; bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (distribution, compilation, rust):
    - Build correctly when the rust dependencies submodule is loaded,
      but the TOR_RUST_DEPENDENCIES environment variable is not set.
      Fixes bug 25679; bugfix on 0.3.3.1-alpha.
    - Actually include all of our Rust source in our source
      distributions. (Previously, a few of the files were accidentally
      omitted.) Fixes bug 25732; bugfix on 0.3.3.2-alpha.
  o Minor bugfixes (documentation):
    - Document that the PerConnBW{Rate,Burst} options will fall back to
      their corresponding consensus parameters only if those parameters
      are set. Previously we had claimed that these values would always
      be set in the consensus. Fixes bug 25296; bugfix on 0.2.2.7-alpha.
    - Revert a misformatting issue in the ExitPolicy documentation.
      Fixes bug 25582; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (exit node DNS retries):
    - Re-attempt timed-out DNS queries 3 times before failure, since our
      timeout is 5 seconds for them, but clients wait 10-15. Also allow
      slightly more timeouts per resolver when an exit has multiple
      resolvers configured. Fixes bug 21394; bugfix on 0.3.1.9.
  o Minor bugfixes (onion services):
    - Re-instate counting the client HSDir fetch circuits against the
      MaxClientCircuitsPending rate limit. Fixes bug 24989; bugfix
      on 0.3.3.1-alpha.
    - Remove underscores from the _HSLayer{2,3}Nodes options. This
      expert-user configuration can now be enabled as HSLayer{2,3}Nodes.
      Fixes bug 25581; bugfix on 0.3.3.1-alpha
  o Code simplification and refactoring:
    - Move the list of default directory authorities to its own file.
      Closes ticket 24854. Patch by "beastr0".
  o Documentation (manpage, denial of service):
    - Provide more detail about the denial-of-service options, by
      listing each mitigation and explaining how they relate. Closes
      ticket 25248.

@_date: 2018-08-07 20:09:10
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.4.6-rc is released 
Hi, all!
There's a new Tor release candidate!  Because it's not a stable
release yet, you should only run it if you're ready to find bugs and
report them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor
from source, why not give it a try?  And if you don't build Tor from
source, packages should be ready over the coming days, with a Tor
Browser alpha release likely by some time next month.
Here's what's new:
Changes in version 0.3.4.6-rc - 2018-08-06
  Tor 0.3.4.6-rc fixes several small compilation, portability, and
  correctness issues in previous versions of Tor. This version is a
  release candidate: if no serious bugs are found, we expect that the
  stable 0.3.4 release will be (almost) the same as this release.
  o Major bugfixes (event scheduler):
    - When we enable a periodic event, schedule it in the event loop
      rather than running it immediately. Previously, we would re-run
      periodic events immediately in the middle of (for example)
      changing our options, with unpredictable effects. Fixes bug 27003;
      bugfix on 0.3.4.1-alpha.
  o Minor features (compilation):
    - When building Tor, prefer to use Python 3 over Python 2, and more
      recent (contemplated) versions over older ones. Closes
      ticket 26372.
  o Minor features (geoip):
    - Update geoip and geoip6 to the July 3 2018 Maxmind GeoLite2
      Country database. Closes ticket 26674.
  o Minor features (Rust, portability):
    - Rust cross-compilation is now supported. Closes ticket 25895.
  o Minor bugfixes (compilation):
    - Fix a compilation warning on some versions of GCC when building
      code that calls routerinfo_get_my_routerinfo() twice, assuming
      that the second call will succeed if the first one did. Fixes bug
      26269; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (controller):
    - Report the port correctly when a port is configured to bind to
      "auto". Fixes bug 26568; bugfix on 0.3.4.1-alpha.
    - Parse the "HSADDRESS=" parameter in HSPOST commands properly.
      Previously, it was misparsed and ignored. Fixes bug 26523; bugfix
      on 0.3.3.1-alpha. Patch by "akwizgran".
  o Minor bugfixes (correctness, flow control):
    - Upon receiving a stream-level SENDME cell, verify that our window
      has not grown too large. Fixes bug 26214; bugfix on svn
      r54 (pre-0.0.1)
  o Minor bugfixes (memory, correctness):
    - Fix a number of small memory leaks identified by coverity. Fixes
      bug 26467; bugfix on numerous Tor versions.
  o Minor bugfixes (portability):
    - Avoid a compilation error in test_bwmgt.c on Solaris 10. Fixes bug
      26994; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (testing, compatibility):
    - When running the ntor_ref.py and hs_ntor_ref.py tests, make sure
      only to pass strings (rather than "bytes" objects) to the Python
      subprocess module. Python 3 on Windows seems to require this.
      Fixes bug 26535; bugfix on 0.2.5.5-alpha (for ntor_ref.py) and
      0.3.1.1-alpha (for hs_ntor_ref.py).

@_date: 2018-08-24 16:45:32
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.4.7-rc is released! 
Hi, all!
There's a new Tor release candidate! Because it's not an official
release,, you should only run it if you're ready to find more bugs
than usual, and report them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely in the
next couple of weeks.
Here's what's new:
Changes in version 0.3.4.7-rc - 2018-08-24
  Tor 0.3.4.7-rc fixes several small compilation, portability, and
  correctness issues in previous versions of Tor. This version is a
  release candidate: if no serious bugs are found, we expect that the
  stable 0.3.4 release will be (almost) the same as this release.
  o Minor features (bug workaround):
    - Compile correctly on systems that provide the C11 stdatomic.h
      header, but where C11 atomic functions don't actually compile.
      Closes ticket 26779; workaround for Debian issue 903709.
  o Minor features (continuous integration):
    - Backport Travis rust distcheck to 0.3.3. Closes ticket 24629.
    - Enable macOS builds in our Travis CI configuration. Closes
      ticket 24629.
    - Install libcap-dev and libseccomp2-dev so these optional
      dependencies get tested on Travis CI. Closes ticket 26560.
    - Only post Appveyor IRC notifications when the build fails.
      Implements ticket 27275.
    - Run asciidoc during Travis CI. Implements ticket 27087.
    - Use ccache in our Travis CI configuration. Closes ticket 26952.
  o Minor features (continuous integration, rust):
    - Use cargo cache in our Travis CI configuration. Closes
      ticket 26952.
  o Minor features (directory authorities):
    - Authorities no longer vote to make the subprotocol version
      "LinkAuth=1" a requirement: it is unsupportable with NSS, and
      hasn't been needed since Tor 0.3.0.1-alpha. Closes ticket 27286.
  o Minor features (geoip):
    - Update geoip and geoip6 to the August 7 2018 Maxmind GeoLite2
      Country database. Closes ticket 27089.
  o Minor bugfixes (compilation, windows):
    - Don't link or search for pthreads when building for Windows, even
      if we are using build environment (like mingw) that provides a
      pthreads library. Fixes bug 27081; bugfix on 0.1.0.1-rc.
  o Minor bugfixes (continuous integration):
    - Improve Appveyor CI IRC logging. Generate correct branches and
      URLs for pull requests and tags. Use unambiguous short commits.
      Fixes bug 26979; bugfix on master.
    - Build with zstd on macOS. Fixes bug 27090; bugfix on 0.3.1.5-alpha.
    - Pass the module flags to distcheck configure, and log the flags
      before running configure. (Backported to 0.2.9 and later as a
      precaution.) Fixes bug 27088; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (in-process restart):
    - Always call tor_free_all() when leaving tor_run_main(). When we
      did not, restarting tor in-process would cause an assertion
      failure. Fixes bug 26948; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Fix a bug in out sandboxing rules for the openat() syscall.
      Previously, no openat() call would be permitted, which would break
      filesystem operations on recent glibc versions. Fixes bug 25440;
      bugfix on 0.2.9.15. Diagnosis and patch from Daniel Pinto.
  o Minor bugfixes (onion services):
    - Fix bug that causes services to not ever rotate their descriptors
      if they were getting SIGHUPed often. Fixes bug 26932; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (portability):
    - Fix compilation of the unit tests on GNU/Hurd, which does not
      define PATH_MAX. Fixes bug 26873; bugfix on 0.3.3.1-alpha. Patch
      from "paulusASol".
  o Minor bugfixes (rust):
    - Backport test_rust.sh from master. Fixes bug 26497; bugfix
      on 0.3.1.5-alpha.
    - Consistently use ../../.. as a fallback for $abs_top_srcdir in
      test_rust.sh. Fixes bug 27093; bugfix on 0.3.4.3-alpha.
    - Protover parsing was accepting the presence of whitespace in
      version strings, which the C implementation would choke on, e.g.
      "Desc=1\t,2". Fixes bug 27177; bugfix on 0.3.3.5-rc.
    - Protover parsing was ignoring a 2nd hyphen and everything after
      it, accepting entries like "Link=1-5-foo". Fixes bug 27164; bugfix
      on 0.3.3.1-alpha.
    - Stop setting $CARGO_HOME. cargo will use the user's $CARGO_HOME, or
      $HOME/.cargo by default. Fixes bug 26497; bugfix on 0.3.1.5-alpha.
    - cd to ${abs_top_builddir}/src/rust before running cargo in
      src/test/test_rust.sh. This makes the working directory consistent
      between builds and tests. Fixes bug 26497; bugfix on 0.3.3.2-alpha.
  o Minor bugfixes (testing, bootstrap):
    - When calculating bootstrap progress, check exit policies and the
      exit flag. Previously, Tor would only check the exit flag, which
      caused race conditions in small and fast networks like chutney.
      Fixes bug 27236; bugfix on 0.2.6.3-alpha.
  o Minor bugfixes (testing, openssl compatibility):
    - Our "tortls/cert_matches_key" unit test no longer relies on
      OpenSSL internals. Previously, it relied on unsupported OpenSSL
      behavior in a way that caused it to crash with OpenSSL 1.0.2p.
      Fixes bug 27226; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (Windows, compilation):
    - Silence a compilation warning on MSVC 2017 and clang-cl. Fixes bug
      27185; bugfix on 0.2.2.2-alpha.

@_date: 2018-12-18 13:58:57
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.6-rc is released! 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by early
Here's what's new:
Changes in version 0.3.5.6-rc - 2018-12-18
  Tor 0.3.5.6-rc fixes numerous small bugs in earlier versions of Tor.
  It is the first release candidate in the 0.3.5.x series; if no further
  huge bugs are found, our next release may be the stable 0.3.5.x.
  o Minor features (continuous integration, Windows):
    - Always show the configure and test logs, and upload them as build
      artifacts, when building for Windows using Appveyor CI.
      Implements 28459.
  o Minor features (fallback directory list):
    - Replace the 150 fallbacks originally introduced in Tor
      0.3.3.1-alpha in January 2018 (of which ~115 were still
      functional), with a list of 157 fallbacks (92 new, 65 existing, 85
      removed) generated in December 2018. Closes ticket 24803.
  o Minor features (geoip):
    - Update geoip and geoip6 to the December 5 2018 Maxmind GeoLite2
      Country database. Closes ticket 28744.
  o Minor bugfixes (compilation):
    - Add missing dependency on libgdi32.dll for tor-print-ed-signing-
      cert.exe on Windows. Fixes bug 28485; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (continuous integration, Windows):
    - Explicitly specify the path to the OpenSSL library and do not
      download OpenSSL from Pacman, but instead use the library that is
      already provided by AppVeyor. Fixes bug 28574; bugfix on master.
  o Minor bugfixes (onion service v3):
    - When deleting an ephemeral onion service (DEL_ONION), do not close
      any rendezvous circuits in order to let the existing client
      connections finish by themselves or closed by the application. The
      HS v2 is doing that already so now we have the same behavior for
      all versions. Fixes bug 28619; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (restart-in-process, boostrap):
    - Add missing resets of bootstrap tracking state when shutting down
      (regression caused by ticket 27169). Fixes bug 28524; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (testing):
    - Use a separate DataDirectory for the test_rebind script.
      Previously, this script would run using the default DataDirectory,
      and sometimes fail. Fixes bug 28562; bugfix on 0.3.5.1-alpha.
      Patch from Taylor R Campbell.
    - Stop leaking memory in an entry guard unit test. Fixes bug 28554;
      bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (Windows):
    - Correctly identify Windows 8.1, Windows 10, and Windows Server
      2008 and later from their NT versions. Fixes bug 28096; bugfix on
      0.2.2.34; reported by Keifer Bly.
    - On recent Windows versions, the GetVersionEx() function may report
      an earlier Windows version than the running OS. To avoid user
      confusion, add "[or later]" to Tor's version string on affected
      versions of Windows. Fixes bug 28096; bugfix on 0.2.2.34; reported
      by Keifer Bly.
    - Remove Windows versions that were never supported by the
      GetVersionEx() function. Stop duplicating the latest Windows
      version in get_uname(). Fixes bug 28096; bugfix on 0.2.2.34;
      reported by Keifer Bly.
  o Testing:
    - Increase logging and tag all log entries with timestamps in
      test_rebind.py. Provides diagnostics for issue 28229.
  o Code simplification and refactoring (shared random, dirauth):
    - Change many tor_assert() to use BUG() instead. The idea is to not
      crash a dirauth but rather scream loudly with a stacktrace and let
      it continue run. The shared random subsystem is very resilient and
      if anything wrong happens with it, at worst a non coherent value
      will be put in the vote and discarded by the other authorities.
      Closes ticket 19566.
  o Documentation (onion services):
    - Document in the man page that changing ClientOnionAuthDir value or
      adding a new file in the directory will not work at runtime upon
      sending a HUP if Sandbox 1. Closes ticket 28128.
    - Note in the man page that the only real way to fully revoke an
      onion service v3 client authorization is by restarting the tor
      process. Closes ticket 28275.

@_date: 2018-02-10 10:14:02
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.3.2-alpha is released 
Hi, all!
There's a new alpha Tor release!  Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely in a
couple of weeks.
Here's what's new!
Changes in version 0.3.3.2-alpha - 2018-02-10
  Tor 0.3.3.2-alpha is the second alpha in the 0.3.3.x series. It
  introduces a mechanism to handle the high loads that many relay
  operators have been reporting recently. It also fixes several bugs in
  older releases. If this new code proves reliable, we plan to backport
  it to older supported release series.
  o Major features (denial-of-service mitigation):
    - Give relays some defenses against the recent network overload. We
      start with three defenses (default parameters in parentheses).
      First: if a single client address makes too many concurrent
      connections (>100), hang up on further connections. Second: if a
      single client address makes circuits too quickly (more than 3 per
      second, with an allowed burst of 90) while also having too many
      connections open (3), refuse new create cells for the next while
      (1-2 hours). Third: if a client asks to establish a rendezvous
      point to you directly, ignore the request. These defenses can be
      manually controlled by new torrc options, but relays will also
      take guidance from consensus parameters, so there's no need to
      configure anything manually. Implements ticket 24902.
  o Major bugfixes (netflow padding):
    - Stop adding unneeded channel padding right after we finish
      flushing to a connection that has been trying to flush for many
      seconds. Instead, treat all partial or complete flushes as
      activity on the channel, which will defer the time until we need
      to add padding. This fix should resolve confusing and scary log
      messages like "Channel padding timeout scheduled 221453ms in the
      past." Fixes bug 22212; bugfix on 0.3.1.1-alpha.
  o Major bugfixes (protocol versions):
    - Add Link protocol version 5 to the supported protocols list. Fixes
      bug 25070; bugfix on 0.3.1.1-alpha.
  o Major bugfixes (scheduler, consensus):
    - The scheduler subsystem was failing to promptly notice changes in
      consensus parameters, making it harder to switch schedulers
      network-wide. Fixes bug 24975; bugfix on 0.3.2.1-alpha.
  o Minor features (denial-of-service avoidance):
    - Make our OOM handler aware of the geoip client history cache so it
      doesn't fill up the memory. This check is important for IPv6 and
      our DoS mitigation subsystem. Closes ticket 25122.
  o Minor features (directory authority):
    - When directory authorities are unable to add signatures to a
      pending consensus, log the reason why. Closes ticket 24849.
  o Minor features (geoip):
    - Update geoip and geoip6 to the February 7 2018 Maxmind GeoLite2
      Country database.
  o Minor features (logging, diagnostic):
    - When logging a failure to create an onion service's descriptor,
      also log what the problem with the descriptor was. Diagnostic for
      ticket 24972.
  o Minor bugfix (channel connection):
    - Use the actual observed address of an incoming relay connection,
      not the canonical address of the relay from its descriptor, when
      making decisions about how to handle the incoming connection.
      Fixes bug 24952; bugfix on 0.2.4.11-alpha. Patch by "ffmancera".
  o Minor bugfix (directory authority):
    - Directory authorities, when refusing a descriptor from a rejected
      relay, now explicitly tell the relay (in its logs) to set a valid
      ContactInfo address and contact the bad-relays@ mailing list.
      Fixes bug 25170; bugfix on 0.2.9.1.
  o Minor bugfixes (all versions of Tor):
    - Use the "misspell" tool to detect and fix typos throughout the
      source code. Fixes bug 23650; bugfix on various versions of Tor.
      Patch from Deepesh Pathak.
  o Minor bugfixes (circuit, cannibalization):
    - Don't cannibalize preemptively-built circuits if we no longer
      recognize their first hop. This situation can happen if our Guard
      relay went off the consensus after the circuit was created. Fixes
      bug 24469; bugfix on 0.0.6.
  o Minor bugfixes (correctness):
    - Remove a nonworking, unnecessary check to see whether a circuit
      hop's identity digest was set when the circuit failed. Fixes bug
      24927; bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (logging):
    - Don't treat inability to store a cached consensus object as a bug:
      it can happen normally when we are out of disk space. Fixes bug
      24859; bugfix on 0.3.1.1-alpha.
    - Fix a (mostly harmless) race condition when invoking
      LOG_PROTOCOL_WARN message from a subthread while the torrc options
      are changing. Fixes bug 23954; bugfix on 0.1.1.9-alpha.
  o Minor bugfixes (onion services):
    - Remove a BUG() statement when a client fetches an onion descriptor
      that has a lower revision counter than the one in its cache. This
      can happen in normal circumstances due to HSDir desync. Fixes bug
      24976; bugfix on 0.3.2.1-alpha.
    - If we are configured to offer a single onion service, don't log
      long-term established one hop rendezvous points in the heartbeat.
      Fixes bug 25116; bugfix on 0.2.9.6-rc.
  o Minor bugfixes (performance):
    - Avoid calling protocol_list_supports_protocol() from inside tight
      loops when running with cached routerinfo_t objects. Instead,
      summarize the relevant protocols as flags in the routerinfo_t, as
      we do for routerstatus_t objects. This change simplifies our code
      a little, and saves a large amount of short-term memory allocation
      operations. Fixes bug 25008; bugfix on 0.2.9.4-alpha.
  o Minor bugfixes (Rust FFI):
    - Fix a minor memory leak which would happen whenever the C code
      would call the Rust implementation of
      protover_get_supported_protocols(). This was due to the C version
      returning a static string, whereas the Rust version newly allocated
      a CString to pass accross the FFI boundary. Consequently, the C
      code was not expecting to need to free() what it was given. Fixes
      bug 25127; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (scheduler, KIST):
    - Avoid adding the same channel twice in the KIST scheduler pending
      list, which would waste CPU cycles. Fixes bug 24700; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (unit test, monotonic time):
    - Increase a constant (1msec to 10msec) in the monotonic time test
      that makes sure the nsec/usec/msec times read are synchronized.
      This change was needed to accommodate slow systems like armel or
      when the clock_gettime() is not a VDSO on the running kernel.
      Fixes bug 25113; bugfix on 0.2.9.1.
  o Minor bugfixes (v3 onion services):
    - Look at the "HSRend" protocol version, not the "HSDir" protocol
      version, when deciding whether a consensus entry can support the
      v3 onion service protocol as a rendezvous point. Fixes bug 25105;
      bugfix on 0.3.2.1-alpha.
  o Code simplification and refactoring:
    - Remove the unused nodelist_recompute_all_hsdir_indices(). Closes
      ticket 25108.
    - Remove a series of counters used to track circuit extend attempts
      and connection status but that in reality we aren't using for
      anything other than stats logged by a SIGUSR1 signal. Closes
      ticket 25163.
  o Documentation (man page):
    - The HiddenServiceVersion torrc option accepts only one number:
      either version 2 or 3. Closes ticket 25026; bugfix
      on 0.3.2.2-alpha.

@_date: 2018-02-21 10:17:43
@_author: Nick Mathewson 
@_subject: [tor-talk] Upcoming security releases for Tor 0.2.9 and up. 
This coming week, we'll be putting out new stable releases for 0.2.9
and later to fix a few security bugs.  The highest-severity bug to be
fixed is severity "medium".
These releases will also backport the anti-DoS features from Tor 0.3.3.
Relays and authorities should be sure to upgrade once packages are
available; these issues are not high-priority for clients.
best wishes,

@_date: 2018-01-25 13:54:43
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.3.1-alpha is released! 
Hi, all!
There's a new alpha Tor release!  Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with an alpha Tor Browser release likely some
time in February.
Here's what's new!
Changes in version 0.3.3.1-alpha - 2018-01-25
  Tor 0.3.3.1-alpha is the first release in the 0.3.3.x series. It adds
  several new features to Tor, including several improvements to
  bootstrapping, and support for an experimental "vanguards" feature to
  resist guard discovery attacks. This series also includes better
  support for applications that need to embed Tor or manage v3
  onion services.
  o Major features (embedding):
    - There is now a documented stable API for programs that need to
      embed Tor. See tor_api.h for full documentation and known bugs.
      Closes ticket 23684.
    - Tor now has support for restarting in the same process.
      Controllers that run Tor using the "tor_api.h" interface can now
      restart Tor after Tor has exited. This support is incomplete,
      however: we fixed crash bugs that prevented it from working at
      all, but many bugs probably remain, including a possibility of
      security issues. Implements ticket 24581.
  o Major features (IPv6, directory documents):
    - Add consensus method 27, which adds IPv6 ORPorts to the microdesc
      consensus. This information makes it easier for IPv6 clients to
      bootstrap and choose reachable entry guards. Implements 23826.
    - Add consensus method 28, which removes IPv6 ORPorts from
      microdescriptors. Now that the consensus contains IPv6 ORPorts,
      they are redundant in microdescs. This change will be used by Tor
      clients on 0.2.8.x and later. (That is to say, with all Tor
      clients having IPv6 bootstrap and guard support.) Implements 23828.
    - Expand the documentation for AuthDirHasIPv6Connectivity when it is
      set by different numbers of authorities. Fixes 23870
      on 0.2.4.1-alpha.
  o Major features (onion service v3, control port):
    - The control port now supports commands and events for v3 onion
      services. It is now possible to create ephemeral v3 services using
      ADD_ONION. Additionally, several events (HS_DESC, HS_DESC_CONTENT,
      CIRC and CIRC_MINOR) and commands (GETINFO, HSPOST, ADD_ONION and
      DEL_ONION) have been extended to support v3 onion services. Closes
      ticket 20699; implements proposal 284.
  o Major features (onion services):
    - Provide torrc options to pin the second and third hops of onion
      service circuits to a list of nodes. The option HSLayer2Guards
      pins the second hop, and the option HSLayer3Guards pins the third
      hop. These options are for use in conjunction with experiments
      with "vanguards" for preventing guard enumeration attacks. Closes
      ticket 13837.
  o Major features (rust, portability, experimental):
    - Tor now ships with an optional implementation of one of its
      smaller modules (protover.c) in the Rust programming language. To
      try it out, install a Rust build environment, and configure Tor
      with "--enable-rust --enable-cargo-online-mode". This should not
      cause any user-visible changes, but should help us gain more
      experience with Rust, and plan future Rust integration work.
      Implementation by Chelsea Komlo. Closes ticket 22840.
  o Major features (storage, configuration):
    - Users can store cached directory documents somewhere other than
      the DataDirectory by using the CacheDirectory option. Similarly,
      the storage location for relay's keys can be overridden with the
      KeyDirectory option. Closes ticket 22703.
  o Major features (v3 onion services, ipv6):
    - When v3 onion service clients send introduce cells, they now
      include the IPv6 address of the rendezvous point, if it has one.
      Current v3 onion services running 0.3.2 ignore IPv6 addresses, but
      in future Tor versions, IPv6-only v3 single onion services will be
      able to use IPv6 addresses to connect directly to the rendezvous
      point. Closes ticket 23577. Patch by Neel Chauhan.
  o Major bugfixes (onion services, retry behavior):
    - Fix an "off by 2" error in counting rendezvous failures on the
      onion service side. While we thought we would stop the rendezvous
      attempt after one failed circuit, we were actually making three
      circuit attempts before giving up. Now switch to a default of 2,
      and allow the consensus parameter "hs_service_max_rdv_failures" to
      override. Fixes bug 24895; bugfix on 0.0.6.
    - New-style (v3) onion services now obey the "max rendezvous circuit
      attempts" logic. Previously they would make as many rendezvous
      circuit attempts as they could fit in the MAX_REND_TIMEOUT second
      window before giving up. Fixes bug 24894; bugfix on 0.3.2.1-alpha.
  o Major bugfixes (relays):
    - Fix a set of false positives where relays would consider
      connections to other relays as being client-only connections (and
      thus e.g. deserving different link padding schemes) if those
      relays fell out of the consensus briefly. Now we look only at the
      initial handshake and whether the connection authenticated as a
      relay. Fixes bug 24898; bugfix on 0.3.1.1-alpha.
  o Minor feature (IPv6):
    - Make IPv6-only clients wait for microdescs for relays, even if we
      were previously using descriptors (or were using them as a bridge)
      and have a cached descriptor for them. Implements 23827.
    - When a consensus has IPv6 ORPorts, make IPv6-only clients use
      them, rather than waiting to download microdescriptors.
      Implements 23827.
  o Minor features (cleanup):
    - Tor now deletes the CookieAuthFile and ExtORPortCookieAuthFile
      when it stops. Closes ticket 23271.
  o Minor features (defensive programming):
    - Most of the functions in Tor that free objects have been replaced
      with macros that free the objects and set the corresponding
      pointers to NULL. This change should help prevent a large class of
      dangling pointer bugs. Closes ticket 24337.
    - Where possible, the tor_free() macro now only evaluates its input
      once. Part of ticket 24337.
    - Check that microdesc ed25519 ids are non-zero in
      node_get_ed25519_id() before returning them. Implements 24001,
      patch by "aruna1234".
  o Minor features (directory authority):
    - Make the "Exit" flag assignment only depend on whether the exit
      policy allows connections to ports 80 and 443. Previously relays
      would get the Exit flag if they allowed connections to one of
      these ports and also port 6667. Resolves ticket 23637.
  o Minor features (embedding):
    - Tor can now start with a preauthenticated control connection
      created by the process that launched it. This feature is meant for
      use by programs that want to launch and manage a Tor process
      without allowing other programs to manage it as well. For more
      information, see the __OwningControllerFD option documented in
      control-spec.txt. Closes ticket 23900.
    - On most errors that would cause Tor to exit, it now tries to
      return from the tor_main() function, rather than calling the
      system exit() function. Most users won't notice a difference here,
      but it should make a significant for programs that run Tor inside
      a separate thread: they should now be able to survive Tor's exit
      conditions rather than having Tor shut down the entire process.
      Closes ticket 23848.
    - Applications that want to embed Tor can now tell Tor not to
      register any of its own POSIX signal handlers, using the
      __DisableSignalHandlers option. Closes ticket 24588.
  o Minor features (fallback directory list):
    - Avoid selecting fallbacks that change their IP addresses too
      often. Select more fallbacks by ignoring the Guard flag, and
      allowing lower cutoffs for the Running and V2Dir flags. Also allow
      a lower bandwidth, and a higher number of fallbacks per operator
      (5% of the list). Implements ticket 24785.
    - Update the fallback whitelist and blacklist based on opt-ins and
      relay changes. Closes tickets 22321, 24678, 22527, 24135,
      and 24695.
  o Minor features (fallback directory mirror configuration):
    - Add a nickname to each fallback in a C comment. This makes it
      easier for operators to find their relays, and allows stem to use
      nicknames to identify fallbacks. Implements ticket 24600.
    - Add a type and version header to the fallback directory mirror
      file. Also add a delimiter to the end of each fallback entry. This
      helps external parsers like stem and Relay Search. Implements
      ticket 24725.
    - Add an extrainfo cache flag for each fallback in a C comment. This
      allows stem to use fallbacks to fetch extra-info documents, rather
      than using authorities. Implements ticket 22759.
    - Add the generateFallbackDirLine.py script for automatically
      generating fallback directory mirror lines from relay fingerprints.
      No more typos! Add the lookupFallbackDirContact.py script for
      automatically looking up operator contact info from relay
      fingerprints. Implements ticket 24706, patch by teor and atagar.
    - Reject any fallback directory mirror that serves an expired
      consensus. Implements ticket 20942, patch by "minik".
    - Remove commas and equals signs from external string inputs to the
      fallback list. This avoids format confusion attacks. Implements
      ticket 24726.
    - Remove the "weight=10" line from fallback directory mirror
      entries. Ticket 24681 will maintain the current fallback weights
      by changing Tor's default fallback weight to 10. Implements
      ticket 24679.
    - Stop logging excessive information about fallback netblocks.
      Implements ticket 24791.
  o Minor features (forward-compatibility):
    - If a relay supports some link authentication protocol that we do
      not recognize, then include that relay's ed25519 key when telling
      other relays to extend to it. Previously, we treated future
      versions as if they were too old to support ed25519 link
      authentication. Closes ticket 20895.
  o Minor features (heartbeat):
    - Add onion service information to our heartbeat logs, displaying
      stats about the activity of configured onion services. Closes
      ticket 24896.
  o Minor features (instrumentation, development):
    - Add the MainloopStats option to allow developers to get
      instrumentation information from the main event loop via the
      heartbeat messages. We hope to use this to improve Tor's behavior
      when it's trying to sleep. Closes ticket 24605.
  o Minor features (log messages):
    - Improve a warning message that happens when we fail to re-parse an
      old router because of an expired certificate. Closes ticket 20020.
    - Make the log more quantitative when we hit MaxMemInQueues
      threshold exposing some values. Closes ticket 24501.
  o Minor features (logging, android):
    - Added support for the Android logging subsystem. Closes
      ticket 24362.
  o Minor features (performance):
    - Support predictive circuit building for onion service circuits
      with multiple layers of guards. Closes ticket 23101.
    - Use stdatomic.h where available, rather than mutexes, to implement
      atomic_counter_t. Closes ticket 23953.
  o Minor features (performance, 32-bit):
    - Improve performance on 32-bit systems by avoiding 64-bit division
      when calculating the timestamp in milliseconds for channel padding
      computations. Implements ticket 24613.
    - Improve performance on 32-bit systems by avoiding 64-bit division
      when timestamping cells and buffer chunks for OOM calculations.
      Implements ticket 24374.
  o Minor features (performance, OSX, iOS):
    - Use the mach_approximate_time() function (when available) to
      implement coarse monotonic time. Having a coarse time function
      should avoid a large number of system calls, and improve
      performance slightly, especially under load. Closes ticket 24427.
  o Minor features (performance, windows):
    - Improve performance on Windows Vista and Windows 7 by adjusting
      TCP send window size according to the recommendation from
      SIO_IDEAL_SEND_BACKLOG_QUERY. Closes ticket 22798. Patch
      from Vort.
  o Minor features (relay):
    - Implement an option, ReducedExitPolicy, to allow an Tor exit relay
      operator to use a more reasonable ("reduced") exit policy, rather
      than the default one. If you want to run an exit node without
      thinking too hard about which ports to allow, this one is for you.
      Closes ticket 13605. Patch from Neel Chauhan.
  o Minor features (testing, debugging, embedding):
    - For development purposes, Tor now has a mode in which it runs for
      a few seconds, then stops, and starts again without exiting the
      process. This mode is meant to help us debug various issues with
      ticket 23847. To use this feature, compile with
      --enable-restart-debugging, and set the TOR_DEBUG_RESTART
      environment variable. This is expected to crash a lot, and is
      really meant for developers only. It will likely be removed in a
      future release. Implements ticket 24583.
  o Minor bugfix (network IPv6 test):
    - Tor's test scripts now check if "ping -6 ::1" works when the user
      runs "make test-network-all". Fixes bug 24677; bugfix on
      0.2.9.3-alpha. Patch by "ffmancera".
  o Minor bugfixes (build, rust):
    - Fix output of autoconf checks to display success messages for Rust
      dependencies and a suitable rustc compiler version. Fixes bug
      24612; bugfix on 0.3.1.3-alpha.
    - When building with Rust on OSX, link against libresolv, to work
      around the issue at       Fixes bug 24652; bugfix on 0.3.1.1-alpha.
    - Don't pass the --quiet option to cargo: it seems to suppress some
      errors, which is not what we want to do when building. Fixes bug
      24518; bugfix on 0.3.1.7.
    - Build correctly when building from outside Tor's source tree with
      the TOR_RUST_DEPENDENCIES option set. Fixes bug 22768; bugfix
      on 0.3.1.7.
  o Minor bugfixes (directory authorities, IPv6):
    - When creating a routerstatus (vote) from a routerinfo (descriptor),
      set the IPv6 address to the unspecified IPv6 address, and
      explicitly initialize the port to zero. Fixes bug 24488; bugfix
      on 0.2.4.1-alpha.
  o Minor bugfixes (fallback directory mirrors):
    - Make updateFallbackDirs.py search harder for python. (Some OSs
      don't put it in /usr/bin.) Fixes bug 24708; bugfix
      on 0.2.8.1-alpha.
  o Minor bugfixes (hibernation, bandwidth accounting, shutdown):
    - When hibernating, close connections normally and allow them to
      flush. Fixes bug 23571; bugfix on 0.2.4.7-alpha. Also fixes
      bug 7267.
    - Do not attempt to launch self-reachability tests when entering
      hibernation. Fixes a case of bug 12062; bugfix on 0.0.9pre5.
    - Resolve several bugs related to descriptor fetching on bridge
      clients with bandwidth accounting enabled. (This combination is
      not recommended!) Fixes a case of bug 12062; bugfix
      on 0.2.0.3-alpha.
    - When hibernating, do not attempt to launch DNS checks. Fixes a
      case of bug 12062; bugfix on 0.1.2.2-alpha.
    - When hibernating, do not try to upload or download descriptors.
      Fixes a case of bug 12062; bugfix on 0.0.9pre5.
  o Minor bugfixes (IPv6, bridges):
    - Tor now always sets IPv6 preferences for bridges. Fixes bug 24573;
      bugfix on 0.2.8.2-alpha.
    - Tor now sets IPv6 address in the routerstatus as well as in the
      router descriptors when updating addresses for a bridge. Closes
      ticket 24572; bugfix on 0.2.4.5-alpha. Patch by "ffmancera".
  o Minor bugfixes (linux seccomp2 sandbox):
    - When running with the sandbox enabled, reload configuration files
      correctly even when %include was used. Previously we would crash.
      Fixes bug 22605; bugfix on 0.3.1. Patch from Daniel Pinto.
  o Minor bugfixes (memory leaks):
    - Avoid possible at-exit memory leaks related to use of Libevent's
      event_base_once() function. (This function tends to leak memory if
      the event_base is closed before the event fires.) Fixes bug 24584;
      bugfix on 0.2.8.1-alpha.
    - Fix a harmless memory leak in tor-resolve. Fixes bug 24582; bugfix
      on 0.2.1.1-alpha.
  o Minor bugfixes (OSX):
    - Don't exit the Tor process if setrlimit() fails to change the file
      limit (which can happen sometimes on some versions of OSX). Fixes
      bug 21074; bugfix on 0.0.9pre5.
  o Minor bugfixes (performance, fragile-hardening):
    - Improve the performance of our consensus-diff application code
      when Tor is built with the --enable-fragile-hardening option set.
      Fixes bug 24826; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (performance, timeouts):
    - Consider circuits for timeout as soon as they complete a hop. This
      is more accurate than applying the timeout in
      circuit_expire_building() because that function is only called
      once per second, which is now too slow for typical timeouts on the
      current network. Fixes bug 23114; bugfix on 0.2.2.2-alpha.
    - Use onion service circuits (and other circuits longer than 3 hops)
      to calculate a circuit build timeout. Previously, Tor only
      calculated its build timeout based on circuits that planned to be
      exactly 3 hops long. With this change, we include measurements
      from all circuits at the point where they complete their third
      hop. Fixes bug 23100; bugfix on 0.2.2.2-alpha.
  o Minor bugfixes (testing):
    - Give out Exit flags in bootstrapping networks. Fixes bug 24137;
      bugfix on 0.2.3.1-alpha.
    - Fix a memory leak in the scheduler/loop_kist unit test. Fixes bug
      25005; bugfix on 0.3.2.7-rc.
  o Code simplification and refactoring:
    - Remove /usr/athena from search path in configure.ac. Closes
      ticket 24363.
    - Remove duplicate code in node_has_curve25519_onion_key() and
      node_get_curve25519_onion_key(), and add a check for a zero
      microdesc curve25519 onion key. Closes ticket 23966, patch by
      "aruna1234" and teor.
    - Rewrite channel_rsa_id_group_set_badness to reduce temporary
      memory allocations with large numbers of OR connections (e.g.
      relays). Closes ticket 24119.
    - Separate the function that deletes ephemeral files when Tor
      stops gracefully.
    - Small changes to Tor's buf_t API to make it suitable for use as a
      general-purpose safe string constructor. Closes ticket 22342.
    - Switch -Wnormalized=id to -Wnormalized=nfkc in configure.ac to
      avoid source code identifier confusion. Closes ticket 24467.
    - The tor_git_revision[] constant no longer needs to be redeclared
      by everything that links against the rest of Tor. Done as part of
      ticket 23845, to simplify our external API.
    - We make extend_info_from_node() use node_get_curve25519_onion_key()
      introduced in ticket 23577 to access the curve25519 public keys
      rather than accessing it directly. Closes ticket 23760. Patch by
      Neel Chauhan.
    - Add a function to log channels' scheduler state changes to aid
      debugging efforts. Closes ticket 24531.
  o Documentation:
    - Add documentation on how to build tor with Rust dependencies
      without having to be online. Closes ticket 22907; bugfix
      on 0.3.0.3-alpha.
    - Clarify the behavior of RelayBandwidth{Rate,Burst} with client
      traffic. Closes ticket 24318.
    - Document that OutboundBindAddress doesn't apply to DNS requests.
      Closes ticket 22145. Patch from Aruna Maurya.
    - Document that operators who run more than one relay or bridge are
      expected to set MyFamily and ContactInfo correctly. Closes
      ticket 24526.
  o Code simplification and refactoring (channels):
    - Remove the incoming and outgoing channel queues. These were never
      used, but still took up a step in our fast path.
    - The majority of the channel unit tests have been rewritten and the
      code coverage has now been raised to 83.6% for channel.c. Closes
      ticket 23709.
    - Remove other dead code from the channel subsystem: All together,
      this cleanup has removed more than 1500 lines of code overall and
      adding very little except for unit test.
  o Code simplification and refactoring (circuit rendezvous):
    - Split the client-size rendezvous circuit lookup into two
      functions: one that returns only established circuits and another
      that returns all kinds of circuits. Closes ticket 23459.
  o Code simplification and refactoring (controller):
    - Make most of the variables in networkstatus_getinfo_by_purpose()
      const. Implements ticket 24489.

@_date: 2018-07-09 15:26:28
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.4.4-rc is released 
Hi, all!
There's a new Tor release candidate!  Because it's not a stable
release yet, you should only run it if you're ready to find bugs and
report them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by the
end of the month.
Here's what's new:
Changes in version 0.3.4.4-rc - 2018-07-09
  Tor 0.3.4.4-rc fixes several small compilation, portability, and
  correctness issues in previous versions of Tor. This version is a
  release candidate: if no serious bugs are found, we expect that the
  stable 0.3.4 release will be (almost) the same as this release.
  o Minor features (compilation):
    - When building Tor, prefer to use Python 3 over Python 2, and more
      recent (contemplated) versions over older ones. Closes
      ticket 26372.
  o Minor features (geoip):
    - Update geoip and geoip6 to the July 3 2018 Maxmind GeoLite2
      Country database. Closes ticket 26674.
  o Minor features (Rust, portability):
    - Rust cross-compilation is now supported. Closes ticket 25895.
  o Minor bugfixes (compilation):
    - Fix a compilation warning on some versions of GCC when building
      code that calls routerinfo_get_my_routerinfo() twice, assuming
      that the second call will succeed if the first one did. Fixes bug
      26269; bugfix on 0.2.8.2-alpha.
  o Minor bugfixes (control port):
    - Report the port correctly when a port is configured to bind to
      "auto". Fixes bug 26568; bugfix on 0.3.4.1-alpha.
    - Handle the HSADDRESS= argument to the HSPOST command properly.
      (Previously, this argument was misparsed and thus ignored.) Fixes
      bug 26523; bugfix on 0.3.3.1-alpha. Patch by "akwizgran".
  o Minor bugfixes (correctness, flow control):
    - Upon receiving a stream-level SENDME cell, verify that our window
      has not grown too large. Fixes bug 26214; bugfix on svn
      r54 (pre-0.0.1).
  o Minor bugfixes (memory, correctness):
    - Fix a number of small memory leaks identified by coverity. Fixes
      bug 26467; bugfix on numerous Tor versions.
  o Minor bugfixes (testing, compatibility):
    - When running the hs_ntor_ref.py test, make sure only to pass
      strings (rather than "bytes" objects) to the Python subprocess
      module. Python 3 on Windows seems to require this. Fixes bug
      26535; bugfix on 0.3.1.1-alpha.
    - When running the ntor_ref.py test, make sure only to pass strings
      (rather than "bytes" objects) to the Python subprocess module.
      Python 3 on Windows seems to require this. Fixes bug 26535; bugfix
      on 0.2.5.5-alpha.

@_date: 2018-06-26 09:11:30
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.4.3-alpha is released 
Hi, all!
There's a new alpha Tor release!  Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely over the
next several weeks.  (Tomorrow's planned TB alpha will probably still
have 0.3.4.2-alpha.)
Here's what's new!
Changes in version 0.3.4.3-alpha - 2018-06-26
  Tor 0.3.4.3-alpha fixes several bugs in earlier versions, including
  one that was causing stability issues on directory authorities.
  o Major bugfixes (directory authority):
    - Stop leaking memory on directory authorities when planning to
      vote. This bug was crashing authorities by exhausting their
      memory. Fixes bug 26435; bugfix on 0.3.3.6.
  o Major bugfixes (rust, testing):
    - Make sure that failing tests in Rust will actually cause the build
      to fail: previously, they were ignored. Fixes bug 26258; bugfix
      on 0.3.3.4-alpha.
  o Minor feature (directory authorities):
    - Stop warning about incomplete bw lines before the first complete
      bw line has been found, so that additional header lines can be
      ignored. Fixes bug 25960; bugfix on 0.2.2.1-alpha
  o Minor features (relay, diagnostic):
    - Add several checks to detect whether Tor relays are uploading
      their descriptors without specifying why they regenerated them.
      Diagnostic for ticket 25686.
  o Minor features (unit tests):
    - Test complete bandwidth measurements files, and test that
      incomplete bandwidth lines only give warnings when the end of the
      header has not been detected. Fixes bug 25947; bugfix
      on 0.2.2.1-alpha
  o Minor bugfixes (compilation):
    - Refrain from compiling unit testing related object files when
      --disable-unittests is set to configure script. Fixes bug 24891;
      bugfix on 0.2.5.1-alpha.
    - When linking the libtor_testing.a library, only include the
      dirauth object files once. Previously, they were getting added
      twice. Fixes bug 26402; bugfix on 0.3.4.1-alpha.
    - The --enable-fatal-warnings flag now affects Rust code as well.
      Closes ticket 26245.
  o Minor bugfixes (onion services):
    - Recompute some consensus information after detecting a clock jump,
      or after transitioning from a non-live consensus to a live
      consensus. We do this to avoid having an outdated state, and
      miscalculating the index for next-generation onion services. Fixes
      bug 24977; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (relay):
    - Relays now correctly block attempts to re-extend to the previous
      relay by Ed25519 identity. Previously they would warn in this
      case, but not actually reject the attempt. Fixes bug 26158; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (testing):
    - Fix compilation of the doctests in the Rust crypto crate. Fixes
      bug 26415; bugfix on 0.3.4.1-alpha.
    - Instead of trying to read the geoip configuration files from
      within the unit tests, instead create our own ersatz files with
      just enough geoip data in the format we expect. Trying to read
      from the source directory created problems on Windows with mingw,
      where the build system's paths are not the same as the platform's
      paths. Fixes bug 25787; bugfix on 0.3.4.1-alpha.
    - Refrain from trying to get an item from an empty smartlist in
      test_bridges_clear_bridge_list. Set DEBUG_SMARTLIST in unit tests
      to catch improper smartlist usage. Furthermore, enable
      DEBUG_SMARTLIST globally when build is configured with fragile
      hardening. Fixes bug 26196; bugfix on 0.3.4.1-alpha.

@_date: 2018-03-03 08:42:10
@_author: Nick Mathewson 
@_subject: [tor-talk] New releases today: relays, please consider upgrading. 
There are new security releases today.  The official announcement just
went to tor-announce, but I want to make sure that people on this list
see it too.
In brief:
  * Directory authorities should upgrade.
  * Relays running 0.3.2.1-alpha through 0.3.2.9 should upgrade.
  * Relays running 0.3.3.1-alpha should upgrade.
  * All other relays may wish to upgrade in order to improve their
resistance to denial-of-service attacks.
  * [Clients should not need to upgrade, but may wish to anyway, in
order to get other features or bugfixes.]
If you build Tor from source, the source code is available at
 .  Packages should be available over the
coming days.
For the complete announcement, including changelogs, see
best wishes,

@_date: 2018-03-29 11:55:48
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.3.4-alpha source code is released 
Hi, all!
There's a new alpha Tor release available as source code! Because it's
an alpha, you should only run it if you're ready to find more bugs
than usual, and report them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by some
time in April.
Here's what's new:
Changes in version 0.3.3.4-alpha - 2018-03-29
  Tor 0.3.3.4-alpha includes various bugfixes for issues found during
  the alpha testing of earlier releases in its series. We are
  approaching a stable 0.3.3.4-alpha release: more testing is welcome!
  o New system requirements:
    - When built with Rust, Tor now depends on version 0.2.39 of the
      libc crate. Closes tickets 25310 and 25664.
  o Major bugfixes (relay, connection):
    - If we have failed to connect to a relay and received a connection
      refused, timeout, or similar error (at the TCP level), do not try
      that same address/port again for 60 seconds after the failure has
      occurred. Fixes bug 24767; bugfix on 0.0.6.
  o Minor features (geoip):
    - Update geoip and geoip6 to the March 8 2018 Maxmind GeoLite2
      Country database. Closes ticket 25469.
  o Minor features (log messages):
    - Improve log message in the out-of-memory handler to include
      information about memory usage from the different compression
      backends. Closes ticket 25372.
  o Minor features (sandbox):
    - Explicitly permit the poll() system call when the Linux
      seccomp2-based sandbox is enabled: apparently, some versions of
      libc use poll() when calling getpwnam(). Closes ticket 25313.
  o Minor bugfixes (C correctness):
    - Fix a very unlikely (impossible, we believe) null pointer
      dereference. Fixes bug 25629; bugfix on 0.2.9.15. Found by
      Coverity; this is CID 1430932.
  o Minor bugfixes (channel, client):
    - Better identify client connection when reporting to the geoip
      client cache. Fixes bug 24904; bugfix on 0.3.1.7.
  o Minor bugfixes (compilation):
    - Fix a C99 compliance issue in our configuration script that caused
      compilation issues when compiling Tor with certain versions of
      xtools. Fixes bug 25474; bugfix on 0.3.2.5-alpha.
  o Minor bugfixes (controller, reliability):
    - Avoid a (nonfatal) assertion failure when extending a one-hop
      circuit from the controller to become a multihop circuit. Fixes
      bug 24903; bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (networking):
    - Tor will no longer reject IPv6 address strings from TorBrowser
      when they are passed as hostnames in SOCKS5 requests. Fixes bug
      25036, bugfix on Tor 0.3.1.2.
    - string_is_valid_hostname() will not consider IP strings to be
      valid hostnames. Fixes bug 25055; bugfix on Tor 0.2.5.5.
  o Minor bugfixes (onion service v3):
    - Avoid an assertion failure when the next the next onion service
      descriptor rotation type is out of sync with the consensus's
      valid-after time. Instead, log a warning message with extra
      information, so we can better hunt down the cause of this
      assertion. Fixes bug 25306; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (testing):
    - Avoid intermittent test failures due to a test that had relied on
      onion service introduction point creation finishing within 5
      seconds of real clock time. Fixes bug 25450; bugfix
      on 0.3.1.3-alpha.
    - Rust crates are now automatically detected and tested. Previously,
      some crates were not tested by `make test-rust` due to a static
      string in the `src/test/test_rust.sh` script specifying which
      crates to test. Fixes bug 25560; bugfix on 0.3.3.3-alpha.
  o Minor bugfixes (testing, benchmarks):
    - Fix a crash when running benchmark tests on win32 systems. The
      crash was due to a mutex that wasn't initialized before logging
      and options were initialized. Fixes bug 25479; bugfix
      on 0.3.3.3-alpha.
  o Minor bugfixes (warnings, ipv6):
    - Avoid a bug warning that could occur when trying to connect to a
      relay over IPv6. This warning would occur on a Tor instance that
      downloads router descriptors, but prefers to use microdescriptors.
      Fixes bug 25213; bugfix on 0.3.3.1-alpha.
  o Code simplification and refactoring:
    - Remove the old (deterministic) directory retry logic entirely:
      We've used exponential backoff exclusively for some time. Closes
      ticket 23814.
  o Documentation:
    - Improved the documentation of AccountingStart parameter. Closes
      ticket 23635.
    - Update the documentation for "Log" to include the current list of
      logging domains. Closes ticket 25378.

@_date: 2018-05-17 09:39:59
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.4.1-alpha: source code now released 
Hi, all!
There's a new alpha Tor release!  Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try?  And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely some
time in the coming weeks.
(And no, we haven't forgotten about the 0.3.3.x series -- there should
be a stable release out there "really soon now".)
Here's what's new since 0.3.3.5-rc!
Changes in version 0.3.4.1-alpha - 2018-05-17
  Tor 0.3.4.1-alpha is the first release in the 0.3.4.x series. It
  includes refactoring to begin reducing Tor's binary size and idle CPU
  usage on mobile, along with prep work for new bandwidth scanners,
  improvements to the experimental "vanguards" feature, and numerous
  other small features and bugfixes.
  o New system requirements:
    - Tor no longer tries to support old operating systems without
      mmap() or some local equivalent. Apparently, compilation on such
      systems has been broken for some time, without anybody noticing or
      complaining. Closes ticket 25398.
  o Major feature (directory authority, modularization):
    - The directory authority subsystem has been modularized. The code
      is now located in src/or/dirauth/, and is compiled in by default.
      To disable the module, the configure option
      --disable-module-dirauth has been added. This module may be
      disabled by default in some future release. Closes ticket 25610.
  o Major features (main loop, CPU usage):
    - When Tor is disabled (via DisableNetwork or via hibernation), it
      no longer needs to run any per-second events. This change should
      make it easier for mobile applications to disable Tor while the
      device is sleeping, or Tor is not running. Closes ticket 26063.
    - Tor no longer enables all of its periodic events by default.
      Previously, Tor would enable all possible main loop events,
      regardless of whether it needed them. Furthermore, many of these
      events are now disabled with Tor is hibernating or DisableNetwork
      is set. This is a big step towards reducing client CPU usage by
      reducing the amount of wake-ups the daemon does. Closes ticket
      25376 and 25762.
    - The bandwidth-limitation logic has been refactored so that
      bandwidth calculations are performed on-demand, rather than every
      TokenBucketRefillInterval milliseconds. This change should improve
      the granularity of our bandwidth calculations, and limit the
      number of times that the Tor process needs to wake up when it is
      idle. Closes ticket 25373.
    - Move responsibility for many operations from a once-per-second
      callback to a callback that is only scheduled as needed. Moving
      this functionality has allowed us to disable the callback when
      Tor's network is disabled. Once enough items are removed from our
      once-per-second callback, we can eliminate it entirely to conserve
      CPU when idle. The functionality removed includes: closing
      connections, circuits, and channels (ticket 25932); consensus
      voting (25937); flushing log callbacks (25951); honoring delayed
      SIGNEWNYM requests (25949); rescanning the consensus cache
      (25931); saving the state file to disk (25948); warning relay
      operators about unreachable ports (25952); and keeping track of
      Tor's uptime (26009).
  o Major bugfixes (directory authorities, security):
    - When directory authorities read a zero-byte bandwidth file, they
      would previously log a warning with the contents of an
      uninitialised buffer. They now log a warning about the empty file
      instead. Fixes bug 26007; bugfix on 0.2.2.1-alpha.
  o Major bugfixes (crash):
    - Avoid a rare assertion failure in the circuit build timeout code
      if we fail to allow any circuits to actually complete. Fixes bug
      25733; bugfix on 0.2.2.2-alpha.
  o Major bugfixes (directory authority):
    - Avoid a crash when testing router reachability on a router that
      could have an ed25519 ID, but which does not. Fixes bug 25415;
      bugfix on 0.3.3.2-alpha.
  o Major bugfixes (onion service):
    - Correctly detect when onion services get disabled after HUP. Fixes
      bug 25761; bugfix on 0.3.2.1.
  o Major bugfixes (protover, voting):
    - Revise Rust implementation of protover to use a more memory-
      efficient voting algorithm and corresponding data structures, thus
      avoiding a potential (but small impact) DoS attack where specially
      crafted protocol strings would expand to several potential
      megabytes in memory. In the process, several portions of code were
      revised to be methods on new, custom types, rather than functions
      taking interchangeable types, thus increasing type safety of the
      module. Custom error types and handling were added as well, in
      order to facilitate better error dismissal/handling in outside
      crates and avoid mistakenly passing an internal error string to C
      over the FFI boundary. Many tests were added, and some previous
      differences between the C and Rust implementations have been
      remedied. Fixes bug 24031; bugfix on 0.3.3.1-alpha.
  o Major bugfixes (relay, denial of service):
    - Impose a limit on circuit cell queue size. The limit can be
      controlled by a consensus parameter. Fixes bug 25226; bugfix
      on 0.2.4.14-alpha.
  o Minor features (accounting):
    - When Tor becomes dormant, it now uses a scheduled event to wake up
      at the right time. Previously, we would use the per-second timer
      to check whether to wake up, but we no longer have any per-second
      timers enabled when the network is disabled. Closes ticket 26064.
  o Minor features (code quality):
    - Add optional spell-checking for the Tor codebase, using the
      "misspell" program. To use this feature, run "make check-typos".
      Closes ticket 25024.
  o Minor features (compatibility):
    - Tor now detects versions of OpenSSL 1.1.0 and later compiled with
      the no-deprecated option, and builds correctly with them. Closes
      tickets 19429, 19981, and 25353.
    - Avoid some compilation warnings with recent versions of LibreSSL.
      Closes ticket 26006.
  o Minor features (compression, zstd):
    - When running with zstd, Tor now considers using advanced functions
      that the zstd maintainers have labeled as potentially unstable. To
      prevent breakage, Tor will only use this functionality when the
      runtime version of the zstd library matches the version with which
      Tor was compiled. Closes ticket 25162.
  o Minor features (configuration):
    - The "DownloadSchedule" options have been renamed to end with
      "DownloadInitialDelay". The old names are still allowed, but will
      produce a warning. Comma-separated lists are still permitted for
      these options, but all values after the first are ignored (as they
      have been since 0.2.9). Closes ticket 23354.
  o Minor features (continuous integration):
    - Our .travis.yml configuration now includes support for testing the
      results of "make distcheck". (It's not uncommon for "make check"
      to pass but "make distcheck" to fail.) Closes ticket 25814.
    - Our Travis CI configuration now integrates with the Coveralls
      coverage analysis tool. Closes ticket 25818.
  o Minor features (control port):
    - Introduce GETINFO "current-time/{local,utc}" to return the local
      and UTC times respectively in ISO format. This helps a controller
      like Tor Browser detect a time-related error. Closes ticket 25511.
      Patch by Neel Chauhan.
    - Introduce new fields to the CIRC_BW event. There are two new
      fields in each of the read and written directions. The DELIVERED
      fields report the total valid data on the circuit, as measured by
      the payload sizes of verified and error-checked relay command
      cells. The OVERHEAD fields report the total unused bytes in each
      of these cells. Closes ticket 25903.
  o Minor features (directory authority):
    - Directory authorities now open their key-pinning files as O_SYNC,
      to limit their chances of accidentally writing partial lines.
      Closes ticket 23909.
  o Minor features (directory authority, forward compatibility):
    - Make the lines of the measured bandwidth file able to contain
      their entries in any order. Previously, the node_id entry needed
      to come first. Closes ticket 26004.
  o Minor features (entry guards):
    - Introduce a new torrc option NumPrimaryGuards for controlling the
      number of primary guards. Closes ticket 25843.
  o Minor features (geoip):
    - Update geoip and geoip6 to the May 1 2018 Maxmind GeoLite2 Country
      database. Closes ticket 26104.
  o Minor features (performance):
    - Avoid a needless call to malloc() when processing an incoming
      relay cell. Closes ticket 24914.
    - Make our timing-wheel code run a tiny bit faster on 32-bit
      platforms, by preferring 32-bit math to 64-bit. Closes
      ticket 24688.
    - Avoid a needless malloc()/free() pair every time we handle an ntor
      handshake. Closes ticket 25150.
  o Minor features (testing):
    - Add a unit test for voting_schedule_get_start_of_next_interval().
      Closes ticket 26014, and helps make unit test coverage
      more deterministic.
    - A new unittests module specifically for testing the functions in
      the (new-ish) bridges.c module has been created with new
      unittests, raising the code coverage percentages. Closes 25425.
    - We now have improved testing for addressmap_get_virtual_address()
      function. This should improve our test coverage, and make our test
      coverage more deterministic. Closes ticket 25993.
  o Minor features (timekeeping, circuit scheduling):
    - When keeping track of how busy each circuit have been recently on
      a given connection, use coarse-grained monotonic timers rather
      than gettimeofday(). This change should marginally increase
      accuracy and performance. Implements part of ticket 25927.
  o Minor bugfixes (bandwidth management):
    - Consider ourselves "low on write bandwidth" if we have exhausted
      our write bandwidth some time in the last second. This was the
      documented behavior before, but the actual behavior was to change
      this value every TokenBucketRefillInterval. Fixes bug 25828;
      bugfix on 0.2.3.5-alpha.
  o Minor bugfixes (C correctness):
    - Add a missing lock acquisition in the shutdown code of the control
      subsystem. Fixes bug 25675; bugfix on 0.2.7.3-rc. Found by
      Coverity; this is CID 1433643.
  o Minor bugfixes (circuit path selection):
    - Don't count path selection failures as circuit build failures.
      This change should eliminate cases where Tor blames its guard or
      the network for situations like insufficient microdescriptors
      and/or overly restrictive torrc settings. Fixes bug 25705; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (client):
    - Don't consider Tor running as a client if the ControlPort is open,
      but no actual client ports are open. Fixes bug 26062; bugfix
      on 0.2.9.4-alpha.
  o Minor bugfixes (code style):
    - Fixed multiple includes of transports.h in src/or/connection.c
      Fixes bug 25261; bugfix on 0.2.5.1-alpha.
    - Remove the unused variable n_possible from the function
      channel_get_for_extend(). Fixes bug 25645; bugfix on 0.2.4.4-alpha
  o Minor bugfixes (control interface):
    - Respond with more human-readable error messages to GETINFO exit-
      policy/* requests. Also, let controller know if an error is
      transient (response code 551) or not (response code 552). Fixes
      bug 25852; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (controller):
    - Make CIRC_BW event reflect the total of all data sent on a
      circuit, including padding and dropped cells. Also fix a mis-
      counting bug when STREAM_BW events were enabled. Fixes bug 25400;
      bugfix on 0.2.5.2-alpha.
  o Minor bugfixes (directory client):
    - When unverified-consensus is verified, rename it to cached-
      consenus. Fixes bug 4187; bugfix on 0.2.0.3-alpha.
    - Fixed launching a certificate fetch always during the scheduled
      periodic consensus fetch by fetching only in those cases when
      consensus are waiting for certs. Fixes bug 24740; bugfix
      on 0.2.9.1-alpha.
  o Minor bugfixes (documentation):
    - Stop saying in the manual that clients cache ipv4 dns answers from
      exit relays. We haven't used them since 0.2.6.3-alpha, and in
      ticket 24050 we stopped even caching them as of 0.3.2.6-alpha, but
      we forgot to say so in the man page. Fixes bug 26052; bugfix
      on 0.3.2.6-alpha.
  o Minor bugfixes (error reporting):
    - Improve tolerance for directory authorities with skewed clocks.
      Previously, an authority with a clock more than 60 seconds ahead
      could cause a client with a correct clock to warn that the
      client's clock was behind. Now the clocks of a majority of
      directory authorities have to be ahead of the client before this
      warning will occur. Fixes bug 25756; bugfix on 0.2.2.25-alpha.
  o Minor bugfixes (Linux seccomp2 sandbox):
    - Allow the nanosleep() system call, which glibc uses to implement
      sleep() and usleep(). Fixes bug 24969; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (onion service):
    - Fix a memory leak when a v3 onion service is configured and gets a
      SIGHUP signal. Fixes bug 25901; bugfix on 0.3.2.1-alpha.
    - When parsing the descriptor signature, look for the token plus an
      extra white-space at the end. This is more correct but also will
      allow us to support new fields that might start with "signature".
      Fixes bug 26069; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (path selection):
    - Only select relays when they have the descriptors we prefer to use
      for them. This change fixes a bug where we could select a relay
      because it had _some_ descriptor, but reject it later with a
      nonfatal assertion error because it didn't have the exact one we
      wanted. Fixes bugs 25691 and 25692; bugfix on 0.3.3.4-alpha.
  o Minor bugfixes (portability):
    - Do not align mmap length, as it is not required by POSIX, and the
      getpagesize function is deprecated. Fixes bug 25399; bugfix
      on 0.1.1.23.
  o Minor bugfixes (portability, FreeBSD):
    - In have_enough_mem_for_dircache(), the variable DIRCACHE_MIN_MEM_MB
      does not stringify on FreeBSD, so we switch to tor_asprintf().
      Fixes bug 20887; bugfix on 0.2.8.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (relay statistics):
    - When a relay is collecting internal statistics about how many
      create cell requests it has seen of each type, accurately count
      the requests from relays that temporarily fall out of the
      consensus. (To be extra conservative, we were already ignoring
      requests from clients in our counts, and we continue ignoring them
      here.) Fixes bug 24910; bugfix on 0.2.4.17-rc.
  o Minor bugfixes (relay, crash):
    - Avoid a crash when running with DirPort set but ORPort tuned off.
      Fixes a case of bug 23693; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (restart-in-process):
    - When shutting down, Tor now clears all the flags in the control.c
      module. This should prevent a bug where authentication cookies are
      not generated on restart. Fixes bug 25512; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (testing):
    - When testing workqueue event-cancellation, make sure that we
      actually cancel an event, and that cancel each event with equal
      probability. (It was previously possible, though extremely
      unlikely, for our event-canceling test not to cancel any events.)
      Fixes bug 26008; bugfix on 0.2.6.3-alpha.
    - Repeat part of the test in test_client_pick_intro() a number of
      times, to give it consistent coverage. Fixes bug 25996; bugfix
      on 0.3.2.1-alpha.
    - Remove randomness from the hs_common/responsible_hsdirs test, so
      that it always takes the same path through the function it tests.
      Fixes bug 25997; bugfix on 0.3.2.1-alpha.
    - Change the behavior of the "channel/outbound" test so that it
      never causes a 10-second rollover for the EWMA circuitmux code.
      Previously, this behavior would happen randomly, and result in
      fluctuating test coverage. Fixes bug 25994; bugfix
      on 0.3.3.1-alpha.
    - Use X509_new() to allocate certificates that will be freed later
      with X509_free(). Previously, some parts of the unit tests had
      used tor_malloc_zero(), which is incorrect, and which caused test
      failures on Windows when they were built with extra hardening.
      Fixes bugs 25943 and 25944; bugfix on 0.2.8.1-alpha. Patch by
      Marcin Cielak.
    - While running the circuit_timeout test, fix the PRNG to a
      deterministic AES stream, so that the test coverage from this test
      will itself be deterministic. Fixes bug 25995; bugfix
      on 0.2.2.2-alpha.
  o Minor bugfixes (vanguards):
    - Allow the last hop in a vanguard circuit to be the same as our
      first, to prevent the adversary from influencing guard node choice
      by choice of last hop. Also prevent the creation of A - B - A
      paths, or A - A paths, which are forbidden by relays. Fixes bug
      25870; bugfix on 0.3.3.1-alpha.
  o Code simplification and refactoring:
    - Remove duplicate code in parse_{c,s}method_line and bootstrap
      their functionalities into a single function. Fixes bug 6236;
      bugfix on 0.2.3.6-alpha.
    - We remove the PortForwsrding and PortForwardingHelper options,
      related functions, and the port_forwarding tests. These options
      were used by the now-deprecated Vidalia to help ordinary users
      become Tor relays or bridges. Closes ticket 25409. Patch by
      Neel Chauhan.
    - In order to make the OR and dir checking function in router.c less
      confusing we renamed some functions and
      consider_testing_reachability() has been split into
      router_should_check_reachability() and
      router_do_reachability_checks(). Also we improved the documentation
      in some functions. Closes ticket 18918.
    - Initial work to isolate Libevent usage to a handful of modules in
      our codebase, to simplify our call structure, and so that we can
      more easily change event loops in the future if needed. Closes
      ticket 23750.
    - Introduce a function to call getsockname() and return tor_addr_t,
      to save a little complexity throughout the codebase. Closes
      ticket 18105.
    - Make hsdir_index in node_t a hsdir_index_t rather than a pointer
      as hsdir_index is always present. Also, we move hsdir_index_t into
      or.h. Closes ticket 23094. Patch by Neel Chauhan.
    - Merge functions used for describing nodes and suppress the
      functions that do not allocate memory for the output buffer
      string. NODE_DESC_BUF_LEN constant and format_node_description()
      function cannot be used externally from router.c module anymore.
      Closes ticket 25432. Patch by valentecaio.
    - Our main loop has been simplified so that all important operations
      happen inside events. Previously, some operations had to happen
      outside the event loop, to prevent infinite sequences of event
      activations. Closes ticket 25374.
    - Put a SHA1 public key digest in hs_service_intro_point_t, and use
      it in register_intro_circ() and service_intro_point_new(). This
      prevents the digest from being re-calculated each time. Closes
      ticket 23107. Patch by Neel Chauhan.
    - Refactor token-bucket implementations to use a common backend.
      Closes ticket 25766.
    - Remove extern declaration of stats_n_seconds_working variable from
      main, protecting its accesses with get_uptime() and reset_uptime()
      functions. Closes ticket 25081, patch by valentecaio.
    - Remove our previous logic for "cached gettimeofday()" -- our
      coarse monotonic timers are fast enough for this purpose, and far
      less error-prone. Implements part of ticket 25927.
    - Remove the return value for fascist_firewall_choose_address_base(),
      and sister functions such as fascist_firewall_choose_address_node()
      and fascist_firewall_choose_address_rs(). Also, while we're here,
      initialize the ap argument as leaving it uninitialized can pose a
      security hazard. Closes ticket 24734. Patch by Neel Chauhan.
    - Rename two fields of connection_t struct. timestamp_lastwritten is
      renamed to timestamp_last_write_allowed and timestamp_lastread is
      renamed to timestamp_last_read_allowed. Closes ticket 24714, patch
      by "valentecaio".
    - Since Tor requires C99, remove our old workaround code for libc
      implementations where free(NULL) doesn't work. Closes ticket 24484.
    - Use our standard rate-limiting code to deal with excessive
      libevent failures, rather than the hand-rolled logic we had
      before. Closes ticket 26016.
    - We remove the return value of node_get_prim_orport() and
      node_get_prim_dirport(), and introduce node_get_prim_orport() in
      node_ipv6_or_preferred() and node_ipv6_dir_preferred() in order to
      check for a null address. Closes ticket 23873. Patch by
      Neel Chauhan.
    - We switch to should_record_bridge_info() in
      geoip_note_client_seen() and options_need_geoip_info() instead of
      accessing the configuration values directly. Fixes bug 25290;
      bugfix on 0.2.1.6-alpha. Patch by Neel Chauhan.
  o Deprecated features:
    - As we are not recommending 0.2.5 anymore, we require relays that
      once had an ed25519 key associated with their RSA key to always
      have that key, instead of allowing them to drop back to a version
      that didn't support ed25519. This means they need to use a new RSA
      key if the want to downgrade to an older version of tor without
      ed25519. Closes ticket 20522.
  o Documentation:
    - Correct an IPv6 error in the documentation for ExitPolicy. Closes
      ticket 25857. Patch from "CTassisF".
  o Removed features:
    - Directory authorities will no longer support voting according to
      any consensus method before consensus method 25. This keeps
      authorities compatible with all authorities running 0.2.9.8 and
      later, and does not break any clients or relays. Implements ticket
      24378 and proposal 290.
    - The PortForwarding and PortForwardingHelper features have been
      removed. The reasoning is, given that implementations of NAT
      traversal protocols within common consumer grade routers are
      frequently buggy, and that the target audience for a NAT punching
      feature is a perhaps less-technically-inclined relay operator,
      when the helper fails to setup traversal the problems are usually
      deep, ugly, and very router specific, making them horrendously
      impossible for technical support to reliable assist with, and thus
      resulting in frustration all around. Unfortunately, relay
      operators who would like to run relays behind NATs will need to
      become more familiar with the port forwarding configurations on
      their local router. Closes 25409.
    - The TestingEnableTbEmptyEvent option has been removed. It was used
      in testing simulations to measure how often connection buckets
      were emptied, in order to improve our scheduling, but it has not
      been actively used in years. Closes ticket 25760.
    - The old "round-robin" circuit multiplexer (circuitmux)
      implementation has been removed, along with a fairly large set of
      code that existed to support it. It has not been the default
      circuitmux since we introduced the "EWMA" circuitmux in 0.2.4.x,
      but it still required an unreasonable amount of memory and CPU.
      Closes ticket 25268.

@_date: 2018-05-27 10:20:33
@_author: Nick Mathewson 
@_subject: [tor-talk] Post Quantum Tor 
For current work on postquantum handshake support in Tor, see
proposals 263, 269, 270, and ticket A digression:
Personally, I don't agree that the evidence is so convincing about the
NSA being able to break 256-bit ECDSA today: if they have it, then
they'd treat it as a big secret, and not go around cagily implying
that they had it.  When they brag publicly about their capabilities,
they're usually not doing so on order to advertise secret advances
that the world doesn't know about.
Of course, by the same argument, we don't have much evidence that
there *aren't* scalable quantum computers today.  If somebody has one,
it makes sense that they would be keeping quiet about it.
And even if there aren't large-scale quantum computers today, we need
to keep in mind that any future such quantum computer would be able to
decrypt today's traffic.
So I think the sensible thing to do is to be cautious, and work under
the assumption that we'll need to move our key exchange to a PQ
handshake, according to something like the proposals above.

@_date: 2018-11-08 08:57:09
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.4-alpha is released. 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the Download page on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by
Here's what's new:
Changes in version 0.3.5.4-alpha - 2018-11-08
  Tor 0.3.5.4-alpha includes numerous bugfixes on earlier versions and
  improves our continuous integration support. It continues our attempts
  to stabilize this alpha branch and build it into a foundation for an
  acceptable long-term-support release.
  o Major bugfixes (compilation, rust):
    - Rust tests can now build and run successfully with the
      --enable-fragile-hardening option enabled. Doing this currently
      requires the rust beta channel; it will be possible with stable
      rust once Rust version 1.31 is released. Patch from Alex Crichton.
      Fixes bugs 27272, 27273, and 27274. Bugfix on 0.3.1.1-alpha.
  o Major bugfixes (embedding, main loop):
    - When DisableNetwork becomes set, actually disable periodic events
      that are already enabled. (Previously, we would refrain from
      enabling new ones, but we would leave the old ones turned on.)
      Fixes bug 28348; bugfix on 0.3.4.1-alpha.
  o Minor features (continuous integration):
    - Add a Travis CI build for --enable-nss on Linux gcc. Closes
      ticket 27751.
    - Add new CI job to Travis configuration to run stem-based
      integration tests. Closes ticket 27913.
  o Minor features (Windows, continuous integration):
    - Build tor on Windows Server 2012 R2 and Windows Server 2016 using
      Appveyor's CI. Closes ticket 28318.
  o Minor bugfixes (C correctness, also in 0.3.4.9):
    - Avoid undefined behavior in an end-of-string check when parsing
      the BEGIN line in a directory object. Fixes bug 28202; bugfix
      on 0.2.0.3-alpha.
  o Minor bugfixes (compilation):
    - Fix a pair of missing headers on OpenBSD. Fixes bug 28303; bugfix
      on 0.3.5.1-alpha. Patch from Kris Katterjohn.
  o Minor bugfixes (compilation, OpenSolaris):
    - Fix compilation on OpenSolaris and its descendants by adding a
      missing include to compat_pthreads.c. Fixes bug 27963; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (configuration):
    - Refuse to start with relative file paths and RunAsDaemon set
      (regression from the fix for bug 22731). Fixes bug 28298; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (directory authority, also in 0.3.4.9):
    - Log additional info when we get a relay that shares an ed25519 ID
      with a different relay, instead of a BUG() warning with a
      backtrace. Fixes bug 27800; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (onion service v3):
    - Build the service descriptor's signing key certificate before
      uploading, so we always have a fresh one: leaving no chances for
      it to expire service side. Fixes bug 27838; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (onion service v3, client authorization):
    - Fix an assert() when adding a client authorization for the first
      time and then sending a HUP signal to the service. Before that,
      Tor would stop abruptly. Fixes bug 27995; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (onion services):
    - Unless we have explicitly set HiddenServiceVersion, detect the
      onion service version and then look for invalid options.
      Previously, we did the reverse, but that broke existing configs
      which were pointed to a v2 service and had options like
      HiddenServiceAuthorizeClient set. Fixes bug 28127; bugfix on
      0.3.5.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (portability):
    - Make the OPE code (which is used for v3 onion services) run
      correctly on big-endian platforms. Fixes bug 28115; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (protover, rust):
    - Reject extra commas in version strings. Fixes bug 27197; bugfix
      on 0.3.3.3-alpha.
  o Minor bugfixes (relay shutdown, systemd):
    - Notify systemd of ShutdownWaitLength so it can be set to longer
      than systemd's TimeoutStopSec. In Tor's systemd service file, set
      TimeoutSec to 60 seconds to allow Tor some time to shut down.
      Fixes bug 28113; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (rust, also in 0.3.4.9):
    - Fix a potential null dereference in protover_all_supported(). Add
      a test for it. Fixes bug 27804; bugfix on 0.3.3.1-alpha.
    - Return a string that can be safely freed by C code, not one
      created by the rust allocator, in protover_all_supported(). Fixes
      bug 27740; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (rust, directory authority, also in 0.3.4.9):
    - Fix an API mismatch in the rust implementation of
      protover_compute_vote(). This bug could have caused crashes on any
      directory authorities running Tor with Rust (which we do not yet
      recommend). Fixes bug 27741; bugfix on 0.3.3.6.
  o Minor bugfixes (testing):
    - Avoid hangs and race conditions in test_rebind.py. Fixes bug
      27968; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (testing, also in 0.3.4.9):
    - Treat backtrace test failures as expected on BSD-derived systems
      (NetBSD, OpenBSD, and macOS/Darwin) until we solve bug 17808.
      (FreeBSD failures have been treated as expected since 18204 in
      0.2.8.) Fixes bug 27948; bugfix on 0.2.5.2-alpha.
  o Documentation (onion service manpage):
    - Improve HSv3 client authorization by making some options more
      explicit and detailed. Closes ticket 28026. Patch by Mike Tigas.

@_date: 2018-11-16 11:29:03
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.5-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the downlaod page on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by the
end of next week.
Here's what's new:
Changes in version 0.3.5.5-alpha - 2018-11-16
  Tor 0.3.5.5-alpha includes numerous bugfixes on earlier releases,
  including several that we hope to backport to older release series in
  the future.
  o Major bugfixes (OpenSSL, portability):
    - Fix our usage of named groups when running as a TLS 1.3 client in
      OpenSSL 1.1.1. Previously, we only initialized EC groups when
      running as a relay, which caused clients to fail to negotiate TLS
      1.3 with relays. Fixes bug 28245; bugfix on 0.2.9.15 (when TLS 1.3
      support was added).
  o Minor features (geoip):
    - Update geoip and geoip6 to the November 6 2018 Maxmind GeoLite2
      Country database. Closes ticket 28395.
  o Minor bugfixes (compilation):
    - Initialize a variable unconditionally in aes_new_cipher(), since
      some compilers cannot tell that we always initialize it before
      use. Fixes bug 28413; bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (connection, relay):
    - Avoid a logging a BUG() stacktrace when closing connection held
      open because the write side is rate limited but not the read side.
      Now, the connection read side is simply shut down until Tor is
      able to flush the connection and close it. Fixes bug 27750; bugfix
      on 0.3.4.1-alpha.
  o Minor bugfixes (continuous integration, Windows):
    - Manually configure the zstd compiler options, when building using
      mingw on Appveyor Windows CI. The MSYS2 mingw zstd package does
      not come with a pkg-config file. Fixes bug 28454; bugfix
      on 0.3.4.1-alpha.
    - Stop using an external OpenSSL install, and stop installing MSYS2
      packages, when building using mingw on Appveyor Windows CI. Fixes
      bug 28399; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (documentation):
    - Make Doxygen work again after the code movement in the 0.3.5
      source tree. Fixes bug 28435; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (Linux seccomp2 sandbox):
    - Permit the "shutdown()" system call, which is apparently used by
      OpenSSL under some circumstances. Fixes bug 28183; bugfix
      on 0.2.5.1-alpha.
  o Minor bugfixes (logging):
    - Stop talking about the Named flag in log messages. Clients have
      ignored the Named flag since 0.3.2. Fixes bug 28441; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a harmless memory leak in libtorrunner.a. Fixes bug 28419;
      bugfix on 0.3.3.1-alpha. Patch from Martin Kepplinger.
  o Minor bugfixes (onion services):
    - On an intro point for a version 3 onion service, stop closing
      introduction circuits on an NACK. This lets the client decide
      whether to reuse the circuit or discard it. Previously, we closed
      intro circuits when sending NACKs. Fixes bug 27841; bugfix on
      0.3.2.1-alpha. Patch by Neel Chaunan.
    - When replacing a descriptor in the client cache, make sure to
      close all client introduction circuits for the old descriptor, so
      we don't end up with unusable leftover circuits. Fixes bug 27471;
      bugfix on 0.3.2.1-alpha.

@_date: 2018-10-17 14:49:47
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.3-alpha is released 
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely in a
couple of weeks.
Here's what's new:
Changes in version 0.3.5.3-alpha - 2018-10-17
  Tor 0.3.5.3-alpha fixes several bugs, mostly from previous 0.3.5.x
  versions. One important fix for relays addresses a problem with rate-
  limiting code from back in 0.3.4.x: If the fix works out, we'll be
  backporting it soon. This release is still an alpha, but we hope it's
  getting closer and closer to stability.
  o Major features (onion services):
    - Version 3 onion services can now use the per-service
      HiddenServiceExportCircuitID option to differentiate client
      circuits. It communicates with the service by using the HAProxy
      protocol to assign virtual IP addresses to inbound client
      circuits. Closes ticket 4700. Patch by Mahrud Sayrafi.
  o Major bugfixes (compilation):
    - Fix compilation on ARM (and other less-used CPUs) when compiling
      with OpenSSL before 1.1. Fixes bug 27781; bugfix on 0.3.4.1-alpha.
  o Major bugfixes (initialization, crash):
    - Fix an assertion crash that would stop Tor from starting up if it
      tried to activate a periodic event too early. Fixes bug 27861;
      bugfix on 0.3.5.1-alpha.
  o Major bugfixes (mainloop, bootstrap):
    - Make sure Tor bootstraps and works properly if only the
      ControlPort is set. Prior to this fix, Tor would only bootstrap
      when a client port was set (Socks, Trans, NATD, DNS or HTTPTunnel
      port). Fixes bug 27849; bugfix on 0.3.4.1-alpha.
  o Major bugfixes (relay):
    - When our write bandwidth limit is exhausted, stop writing on the
      connection. Previously, we had a typo in the code that would make
      us stop reading instead, leading to relay connections being stuck
      indefinitely and consuming kernel RAM. Fixes bug 28089; bugfix
      on 0.3.4.1-alpha.
  o Minor features (continuous integration):
    - Use the Travis Homebrew addon to install packages on macOS during
      Travis CI. The package list is the same, but the Homebrew addon
      does not do a `brew update` by default. Implements ticket 27738.
    - Report what program produced the mysterious core file that we
      occasionally see on Travis CI during make distcheck. Closes
      ticket 28024.
  o Minor features (geoip):
    - Update geoip and geoip6 to the October 9 2018 Maxmind GeoLite2
      Country database. Closes ticket 27991.
  o Minor bugfixes (code safety):
    - Rewrite our assertion macros so that they no longer suppress the
      compiler's -Wparentheses warnings. Fixes bug 27709; bugfix
      on 0.0.6.
  o Minor bugfixes (compilation):
    - Compile the ed25519-donna code with a correct declaration of
      crypto_strongest_rand(). Previously, we built it with one type,
      but linked it against another in the unit tests, which caused
      compilation failures with LTO enabled. This could have caused
      other undefined behavior in the tests. Fixes bug 27728; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (compilation, netbsd):
    - Add a missing include back into procmon.c. Fixes bug 27990; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (continuous integration, appveyor):
    - Install only the necessary mingw packages during our appveyor
      builds. This change makes the build a little faster, and prevents
      a conflict with a preinstalled mingw openssl that appveyor now
      ships. Fixes bugs 27765 and 27943; bugfix on 0.3.4.2-alpha.
  o Minor bugfixes (directory permissions):
    - When a user requests a group-readable DataDirectory, give it to
      them. Previously, when the DataDirectory and the CacheDirectory
      were the same, the default setting (0) for
      CacheDirectoryGroupReadable would override the setting for
      DataDirectoryGroupReadable. Fixes bug 26913; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a small memory leak when calling Tor with --dump-config. Fixes
      bug 27893; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (networking):
    - In retry_listeners_ports(), make sure that we're removing a member
      of old_conns smartlist at most once. Fixes bug 27808; bugfix
      on 0.3.5.1-alpha.
    - Refrain from attempting socket rebinding when old and new
      listeners are in different address families. Fixes bug 27928;
      bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (onion service v3):
    - Stop dumping a stack trace when trying to connect to an intro
      point without having a descriptor for it. Fixes bug 27774; bugfix
      on 0.3.2.1-alpha.
    - Don't warn so loudly when Tor is unable to decode an onion
      descriptor. This can now happen as a normal use case if a client
      gets a descriptor with client authorization but the client is not
      authorized. Fixes bug 27550; bugfix on 0.3.5.1-alpha.
    - When selecting a v3 rendezvous point, don't only look at the
      protover, but also check whether the curve25519 onion key is
      present. This way we avoid picking a relay that supports the v3
      rendezvous but for which we don't have the microdescriptor. Fixes
      bug 27797; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (protover):
    - Reject protocol names containing bytes other than alphanumeric
      characters and hyphens ([A-Za-z0-9-]). Fixes bug 27316; bugfix
      on 0.2.9.4-alpha.
  o Minor bugfixes (testing):
    - Make the hs_service tests use the same time source when creating
      the introduction point and when testing it. Now tests work better
      on very slow systems like ARM or Travis. Fixes bug 27810; bugfix
      on 0.3.2.1-alpha.
    - In test_rebind.py, check if the Python version is in the supported
      range. Fixes bug 27675; bugfix on 0.3.5.1-alpha.
  o Code simplification and refactoring:
    - Divide more large Tor source files -- especially ones that span
      multiple areas of functionality -- into smaller parts, including
      onion.c and main.c. Closes ticket 26747.
    - Divide the "routerparse.c" module into separate modules for each
      group of parsed objects. Closes ticket 27924.
    - Move protover_rust.c to the same place protover.c was moved to.
      Closes ticket 27814.
    - Split directory.c into separate pieces for client, server, and
      common functionality. Closes ticket 26744.
    - Split the non-statistics-related parts from the rephist.c and
      geoip.c modules. Closes ticket 27892.
    - Split the router.c file into relay-only and shared components, to
      help with future modularization. Closes ticket 27864.
  o Documentation:
    - In the tor-resolve(1) manpage, fix the reference to socks-
      extensions.txt by adding a web URL. Resolves ticket 27853.
    - Mention that we require Python to be 2.7 or newer for some
      integration tests that we ship with Tor. Resolves ticket 27677.

@_date: 2018-09-18 07:48:14
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.1-alpha is released! 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on the download page
of  if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely some
time this week.
NOTE 1: There are some UI changes in this one -- please read at least
the beginning of the changelog before you move forward.
NOTE 2: When you go to check the signature, gpg might tell you that my
subkeys are expired.  If that happens, you'll need to refresh the key
from a public keyserver, or fetch it from
 .  The key and
subkeys haven't changed -- only the expiration date has.
Here's what's new:
Changes in version 0.3.5.1-alpha - 2018-09-18
  Tor 0.3.5.1-alpha is the first release of the 0.3.5.x series. It adds
  client authorization for modern (v3) onion services, improves
  bootstrap reporting, begins reorganizing Tor's codebase, adds optional
  support for NSS in place of OpenSSL, and much more.
  o Major features (onion services, UI change):
    - For a newly created onion service, the default version is now 3.
      Tor still supports existing version 2 services, but the operator
      now needs to set "HiddenServiceVersion 2" in order to create a new
      version 2 service. For existing services, Tor now learns the
      version by reading the key file. Closes ticket 27215.
  o Major features (relay, UI change):
    - Relays no longer run as exits by default. If the "ExitRelay"
      option is auto (or unset), and no exit policy is specified with
      ExitPolicy or ReducedExitPolicy, we now treat ExitRelay as 0.
      Previously in this case, we allowed exit traffic and logged a
      warning message. Closes ticket 21530. Patch by Neel Chauhan.
    - Tor now validates that the ContactInfo config option is valid UTF-
      8 when parsing torrc. Closes ticket 27428.
  o Major features (bootstrap):
    - Don't report directory progress until after a connection to a
      relay or bridge has succeeded. Previously, we'd report 80%
      progress based on cached directory information when we couldn't
      even connect to the network. Closes ticket 27169.
  o Major features (new code layout):
    - Nearly all of Tor's source code has been moved around into more
      logical places. The "common" directory is now divided into a set
      of libraries in "lib", and files in the "or" directory have been
      split into "core" (logic absolutely needed for onion routing),
      "feature" (independent modules in Tor), and "app" (to configure
      and invoke the rest of Tor). See doc/HACKING/CodeStructure.md for
      more information. Closes ticket 26481.
      This refactoring is not complete: although the libraries have been
      refactored to be acyclic, the main body of Tor is still too
      interconnected. We will attempt to improve this in the future.
  o Major features (onion services v3):
    - Implement onion service client authorization at the descriptor
      level: only authorized clients can decrypt a service's descriptor
      to find out how to contact it. A new torrc option was added to
      control this client side: ClientOnionAuthDir . On the
      service side, if the "authorized_clients/" directory exists in the
      onion service directory path, client configurations are read from
      the files within. See the manpage for more details. Closes ticket
      27547. Patch done by Suphanat Chunhapanya (haxxpop).
    - Improve revision counter generation in next-gen onion services.
      Onion services can now scale by hosting multiple instances on
      different hosts without synchronization between them, which was
      previously impossible because descriptors would get rejected by
      HSDirs. Addresses ticket 25552.
  o Major features (portability, cryptography, experimental, TLS):
    - Tor now has the option to compile with the NSS library instead of
      OpenSSL. This feature is experimental, and we expect that bugs may
      remain. It is mainly intended for environments where Tor's
      performance is not CPU-bound, and where NSS is already known to be
      installed. To try it out, configure Tor with the --enable-nss
      flag. Closes tickets 26631, 26815, and 26816.
      If you are experimenting with this option and using an old cached
      consensus, Tor may fail to start. To solve this, delete your
      "cached-consensus" and "cached-microdesc-consensus" files,
      (if present), and restart Tor.
  o Major bugfixes (directory authority):
    - Actually check that the address we get from DirAuthority
      configuration line is valid IPv4. Explicitly disallow DirAuthority
      address to be a DNS hostname. Fixes bug 26488; bugfix
      on 0.1.2.10-rc.
  o Major bugfixes (restart-in-process):
    - Fix a use-after-free error that could be caused by passing Tor an
      impossible set of options that would fail during options_act().
      Fixes bug 27708; bugfix on 0.3.3.1-alpha.
  o Minor features (admin tools):
    - Add a new --key-expiration option to print the expiration date of
      the signing cert in an ed25519_signing_cert file. Resolves
      issue 19506.
  o Minor features (build):
    - If you pass the "--enable-pic" option to configure, Tor will try
      to tell the compiler to build position-independent code suitable
      to link into a dynamic library. (The default remains -fPIE, for
      code suitable for a relocatable executable.) Closes ticket 23846.
  o Minor features (code correctness, testing):
    - Tor's build process now includes a "check-includes" make target to
      verify that no module of Tor relies on any headers from a higher-
      level module. We hope to use this feature over time to help
      refactor our codebase. Closes ticket 26447.
  o Minor features (code layout):
    - We have a new "lowest-level" error-handling API for use by code
      invoked from within the logging module. With this interface, the
      logging code is no longer at risk of calling into itself if a
      failure occurs while it is trying to log something. Closes
      ticket 26427.
  o Minor features (compilation):
    - Tor's configure script now supports a --with-malloc= option to
      select your malloc implementation. Supported options are
      "tcmalloc", "jemalloc", "openbsd" (deprecated), and "system" (the
      default). Addresses part of ticket 20424. Based on a patch from
      Alex Xu.
  o Minor features (config):
    - The "auto" keyword in torrc is now case-insensitive. Closes
      ticket 26663.
  o Minor features (continuous integration):
    - Don't do a distcheck with --disable-module-dirauth in Travis.
      Implements ticket 27252.
    - Install libcap-dev and libseccomp2-dev so these optional
      dependencies get tested on Travis CI. Closes ticket 26560.
    - Only run one online rust build in Travis, to reduce network
      errors. Skip offline rust builds on Travis for Linux gcc, because
      they're redundant. Implements ticket 27252.
    - Skip gcc on OSX in Travis CI, because it's rarely used. Skip a
      duplicate hardening-off build in Travis on Tor 0.2.9. Skip gcc on
      Linux with default settings, because all the non-default builds
      use gcc on Linux. Implements ticket 27252.
  o Minor features (controller):
    - Emit CIRC_BW events as soon as we detect that we processed an
      invalid or otherwise dropped cell on a circuit. This allows
      vanguards and other controllers to react more quickly to dropped
      cells. Closes ticket 27678.
    - For purposes of CIRC_BW-based dropped cell detection, track half-
      closed stream ids, and allow their ENDs, SENDMEs, DATA and path
      bias check cells to arrive without counting it as dropped until
      either the END arrives, or the windows are empty. Closes
      ticket 25573.
    - Implement a 'GETINFO md/all' controller command to enable getting
      all known microdescriptors. Closes ticket 8323.
    - The GETINFO command now support an "uptime" argument, to return
      Tor's uptime in seconds. Closes ticket 25132.
  o Minor features (denial-of-service avoidance):
    - Make our OOM handler aware of the DNS cache so that it doesn't
      fill up the memory. This check is important for our DoS mitigation
      subsystem. Closes ticket 18642. Patch by Neel Chauhan.
  o Minor features (development):
    - Tor's makefile now supports running the "clippy" Rust style tool
      on our Rust code. Closes ticket 22156.
  o Minor features (directory authority):
    - There is no longer an artificial upper limit on the length of
      bandwidth lines. Closes ticket 26223.
    - When a bandwidth file is used to obtain the bandwidth measurements,
      include this bandwidth file headers in the votes. Closes
      ticket 3723.
    - Improved support for networks with only a single authority or a
      single fallback directory. Patch from Gabriel Somlo. Closes
      ticket 25928.
  o Minor features (embedding API):
    - The Tor controller API now supports a function to launch Tor with
      a preconstructed owning controller FD, so that embedding
      applications don't need to manage controller ports and
      authentication. Closes ticket 24204.
    - The Tor controller API now has a function that returns the name
      and version of the backend implementing the API. Closes
      ticket 26947.
  o Minor features (geoip):
    - Update geoip and geoip6 to the September 6 2018 Maxmind GeoLite2
      Country database. Closes ticket 27631.
  o Minor features (memory management):
    - Get Libevent to use the same memory allocator as Tor, by calling
      event_set_mem_functions() during initialization. Resolves
      ticket 8415.
  o Minor features (memory usage):
    - When not using them, store legacy TAP public onion keys in DER-
      encoded format, rather than as expanded public keys. This should
      save several megabytes on typical clients. Closes ticket 27246.
  o Minor features (OpenSSL):
    - When possible, use RFC5869 HKDF implementation from OpenSSL rather
      than our own. Resolves ticket 19979.
  o Minor features (Rust, code quality):
    - Improve rust code quality in the rust protover implementation by
      making it more idiomatic. Includes changing an internal API to
      take &str instead of &String. Closes ticket 26492.
  o Minor features (testing):
    - Add scripts/test/chutney-git-bisect.sh, for bisecting using
      chutney. Implements ticket 27211.
  o Minor features (tor-resolve):
    - The tor-resolve utility can now be used with IPv6 SOCKS proxies.
      Side-effect of the refactoring for ticket 26526.
  o Minor features (UI):
    - Log each included configuration file or directory as we read it,
      to provide more visibility about where Tor is reading from. Patch
      from Unto Sten; closes ticket 27186.
    - Lower log level of "Scheduler type KIST has been enabled" to INFO.
      Closes ticket 26703.
  o Minor bugfixes (bootstrap):
    - Try harder to get descriptors in non-exit test networks, by using
      the mid weight for the third hop when there are no exits. Fixes
      bug 27237; bugfix on 0.2.6.2-alpha.
  o Minor bugfixes (C correctness):
    - Avoid casting smartlist index to int implicitly, as it may trigger
      a warning (-Wshorten-64-to-32). Fixes bug 26282; bugfix on
      0.2.3.13-alpha, 0.2.7.1-alpha and 0.2.1.1-alpha.
    - Use time_t for all values in
      predicted_ports_prediction_time_remaining(). Rework the code that
      computes difference between durations/timestamps. Fixes bug 27165;
      bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (client, memory usage):
    - When not running as a directory cache, there is no need to store
      the text of the current consensus networkstatus in RAM.
      Previously, however, clients would store it anyway, at a cost of
      over 5 MB. Now, they do not. Fixes bug 27247; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (client, reachableaddresses):
    - Instead of adding a "reject *:*" line to ReachableAddresses when
      loading the configuration, add one to the policy after parsing it
      in parse_reachable_addresses(). This prevents extra "reject *.*"
      lines from accumulating on reloads. Fixes bug 20874; bugfix on
      0.1.1.5-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (code quality):
    - Rename sandbox_getaddrinfo() and other functions to no longer
      misleadingly suggest that they are sandbox-only. Fixes bug 26525;
      bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (configuration, Onion Services):
    - In rend_service_parse_port_config(), disallow any input to remain
      after address-port pair was parsed. This will catch address and
      port being whitespace-separated by mistake of the user. Fixes bug
      27044; bugfix on 0.2.9.10.
  o Minor bugfixes (continuous integration):
    - Stop reinstalling identical packages in our Windows CI. Fixes bug
      27464; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (controller):
    - Consider all routerinfo errors other than "not a server" to be
      transient for the purpose of "GETINFO exit-policy/*" controller
      request. Print stacktrace in the unlikely case of failing to
      recompute routerinfo digest. Fixes bug 27034; bugfix
      on 0.3.4.1-alpha.
  o Minor bugfixes (directory connection shutdown):
    - Avoid a double-close when shutting down a stalled directory
      connection. Fixes bug 26896; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (HTTP tunnel):
    - Fix a bug warning when closing an HTTP tunnel connection due to an
      HTTP request we couldn't handle. Fixes bug 26470; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (ipv6):
    - In addrs_in_same_network_family(), we choose the subnet size based
      on the IP version (IPv4 or IPv6). Previously, we chose a fixed
      subnet size of /16 for both IPv4 and IPv6 addresses. Fixes bug
      15518; bugfix on 0.2.3.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (logging):
    - As a precaution, do an early return from log_addr_has_changed() if
      Tor is running as client. Also, log a stack trace for debugging as
      this function should only be called when Tor runs as server. Fixes
      bug 26892; bugfix on 0.1.1.9-alpha.
    - Refrain from mentioning bug 21018 in the logs, as it is already
      fixed. Fixes bug 25477; bugfix on 0.2.9.8.
  o Minor bugfixes (logging, documentation):
    - When SafeLogging is enabled, scrub IP address in
      channel_tls_process_netinfo_cell(). Also, add a note to manpage
      that scrubbing is not guaranteed on loglevels below Notice. Fixes
      bug 26882; bugfix on 0.2.4.10-alpha.
  o Minor bugfixes (netflow padding):
    - Ensure circuitmux queues are empty before scheduling or sending
      padding. Fixes bug 25505; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (onion service v2):
    - Log at level "info", not "warning", in the case that we do not
      have a consensus when a .onion request comes in. This can happen
      normally while bootstrapping. Fixes bug 27040; bugfix
      on 0.2.8.2-alpha.
  o Minor bugfixes (onion service v3):
    - When the onion service directory can't be created or has the wrong
      permissions, do not log a stack trace. Fixes bug 27335; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (OS compatibility):
    - Properly handle configuration changes that move a listener to/from
      wildcard IP address. If the first attempt to bind a socket fails,
      close the old listener and try binding the socket again. Fixes bug
      17873; bugfix on 0.0.8pre-1.
  o Minor bugfixes (performance)::
    - Rework node_is_a_configured_bridge() to no longer call
      node_get_all_orports(), which was performing too many memory
      allocations. Fixes bug 27224; bugfix on 0.2.3.9.
  o Minor bugfixes (relay statistics):
    - Update relay descriptor on bandwidth changes only when the uptime
      is smaller than 24h, in order to reduce the efficiency of guard
      discovery attacks. Fixes bug 24104; bugfix on 0.1.1.6-alpha.
  o Minor bugfixes (relays):
    - Consider the fact that we'll be making direct connections to our
      entry and guard nodes when computing the fraction of nodes that
      have their descriptors. Also, if we are using bridges and there is
      at least one bridge with a full descriptor, treat the fraction of
      guards available as 100%. Fixes bug 25886; bugfix on 0.2.4.10-alpha.
      Patch by Neel Chauhan.
    - Update the message logged on relays when DirCache is disabled.
      Since 0.3.3.5-rc, authorities require DirCache (V2Dir) for the
      Guard flag. Fixes bug 24312; bugfix on 0.3.3.5-rc.
  o Minor bugfixes (rust, protover):
    - Compute protover votes correctly in the rust version of the
      protover code. Previously, the protover rewrite in 24031 allowed
      repeated votes from the same voter for the same protocol version
      to be counted multiple times in protover_compute_vote(). Fixes bug
      27649; bugfix on 0.3.3.5-rc.
    - Reject protover names that contain invalid characters. Fixes bug
      27687; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (testing):
    - Fix two unit tests to work when HOME environment variable is not
      set. Fixes bug 27096; bugfix on 0.2.8.1-alpha.
    - If a unit test running in a subprocess exits abnormally or with a
      nonzero status code, treat the test as having failed, even if the
      test reported success. Without this fix, memory leaks don't cause
      the tests to fail, even with LeakSanitizer. Fixes bug 27658;
      bugfix on 0.2.2.4-alpha.
    - When logging a version mismatch in our openssl_version tests,
      report the actual offending version strings. Fixes bug 26152;
      bugfix on 0.2.9.1-alpha.
    - Fix forking tests on Windows when there is a space somewhere in
      the path. Fixes bug 26437; bugfix on 0.2.2.4-alpha.
  o Code simplification and refactoring:
    - 'updateFallbackDirs.py' now ignores the blacklist file, as it's not
      longer needed. Closes ticket 26502.
    - Include paths to header files within Tor are now qualified by
      directory within the top-level src directory.
    - Many structures have been removed from the centralized "or.h"
      header, and moved into their own headers. This will allow us to
      reduce the number of places in the code that rely on each
      structure's contents and layout. Closes ticket 26383.
    - Remove ATTR_NONNULL macro from codebase. Resolves ticket 26527.
    - Remove GetAdaptersAddresses_fn_t. The code that used it was
      removed as part of the 26481 refactor. Closes ticket 27467.
    - Rework Tor SOCKS server code to use Trunnel and benefit from
      autogenerated functions for parsing and generating SOCKS wire
      format. New implementation is cleaner, more maintainable and
      should be less prone to heartbleed-style vulnerabilities.
      Implements a significant fraction of ticket 3569.
    - Split sampled_guards_update_from_consensus() and
      select_entry_guard_for_circuit() into subfunctions. In
      entry_guards_update_primary() unite three smartlist enumerations
      into one and move smartlist comparison code out of the function.
      Closes ticket 21349.
    - Tor now assumes that you have standards-conformant stdint.h and
      inttypes.h headers when compiling. Closes ticket 26626.
    - Unify our bloom filter logic. Previously we had two copies of this
      code: one for routerlist filtering, and one for address set
      calculations. Closes ticket 26510.
    - Use the simpler strcmpstart() helper in
      rend_parse_v2_service_descriptor instead of strncmp(). Closes
      ticket 27630.
    - Utility functions that can perform a DNS lookup are now wholly
      separated from those that can't, in separate headers and C
      modules. Closes ticket 26526.
  o Documentation:
    - Copy paragraph and URL to Tor's code of conduct document from
      CONTRIBUTING to new CODE_OF_CONDUCT file. Resolves ticket 26638.
    - Remove old instructions from INSTALL document. Closes ticket 26588.
    - Warn users that they should not include MyFamily line(s) in their
      torrc when running Tor bridge. Closes ticket 26908.
  o Removed features:
    - Tor no longer supports building with the dmalloc library. For
      debugging memory issues, we suggest using gperftools or msan
      instead. Closes ticket 26426.
    - Tor no longer attempts to run on Windows environments without the
      GetAdaptersAddresses() function. This function has existed since
      Windows XP, which is itself already older than we support.
    - Remove Tor2web functionality for version 2 onion services. The
      Tor2webMode and Tor2webRendezvousPoints options are now obsolete.
      (This feature was never shipped in vanilla Tor and it was only
      possible to use this feature by building the support at compile
      time. Tor2webMode is not implemented for version 3 onion services.)
      Closes ticket 26367.

@_date: 2018-09-21 12:07:04
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.3.5.2-alpha is released 
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release very soon.
Here's what's new:
Changes in version 0.3.5.2-alpha - 2018-09-21
  Tor 0.3.5.2-alpha fixes several bugs in 0.3.5.1-alpha, including one
  that made Tor think it had run out of sockets. Anybody running a relay
  or an onion service on 0.3.5.1-alpha should upgrade.
  o Major bugfixes (relay bandwidth statistics):
    - When we close relayed circuits, report the data in the circuit
      queues as being written in our relay bandwidth stats. This
      mitigates guard discovery and other attacks that close circuits
      for the explicit purpose of noticing this discrepancy in
      statistics. Fixes bug 23512; bugfix on 0.0.8pre3.
  o Major bugfixes (socket accounting):
    - In our socket accounting code, count a socket as closed even when
      it is closed indirectly by the TLS layer. Previously, we would
      count these sockets as still in use, and incorrectly believe that
      we had run out of sockets. Fixes bug 27795; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (32-bit OSX and iOS, timing):
    - Fix an integer overflow bug in our optimized 32-bit millisecond-
      difference algorithm for 32-bit Apple platforms. Previously, it
      would overflow when calculating the difference between two times
      more than 47 days apart. Fixes part of bug 27139; bugfix
      on 0.3.4.1-alpha.
    - Improve the precision of our 32-bit millisecond difference
      algorithm for 32-bit Apple platforms. Fixes part of bug 27139;
      bugfix on 0.3.4.1-alpha.
    - Relax the tolerance on the mainloop/update_time_jumps test when
      running on 32-bit Apple platforms. Fixes part of bug 27139; bugfix
      on 0.3.4.1-alpha.
  o Minor bugfixes (onion service v3):
    - Close all SOCKS request (for the same .onion) if the newly fetched
      descriptor is unusable. Before that, we would close only the first
      one leaving the other hanging and let to time out by themselves.
      Fixes bug 27410; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (memory leak):
    - Fix an unlikely memory leak when trying to read a private key from
      a ridiculously large file. Fixes bug 27764; bugfix on
      0.3.5.1-alpha. This is CID 1439488.
  o Minor bugfixes (NSS):
    - Correctly detect failure to open a dummy TCP socket when stealing
      ownership of an fd from the NSS layer. Fixes bug 27782; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (rust):
    - protover_all_supported() would attempt to allocate up to 16GB on
      some inputs, leading to a potential memory DoS. Fixes bug 27206;
      bugfix on 0.3.3.5-rc.
  o Minor bugfixes (testing):
    - Revise the "conditionvar_timeout" test so that it succeeds even on
      heavily loaded systems where the test threads are not scheduled
      within 200 msec. Fixes bug 27073; bugfix on 0.2.6.3-alpha.
  o Code simplification and refactoring:
    - Divide the routerlist.c and dirserv.c modules into smaller parts.
      Closes ticket 27799.

@_date: 2019-04-11 17:18:57
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.0.4-rc is released 
Hi, all!
There's a new Tor release candidate! It's not a release yet, but if no
serious bugs are found, the next stable release will be (almost)
identical to it.
The source code is available at
 .
If you build Tor from source, why not give it a try? Be sure to check
the signature, also available at  . And if
you don't build Tor from source, packages should be ready over the
coming days, with a Tor Browser alpha release likely quite soon.
Here's what's new:
Changes in version 0.4.0.4-rc - 2019-04-11
  Tor 0.4.0.4-rc is the first release candidate in its series; it fixes
  several bugs from earlier versions, including some that had affected
  stability, and one that prevented relays from working with NSS.
  o Major bugfixes (NSS, relay):
    - When running with NSS, disable TLS 1.2 ciphersuites that use
      SHA384 for their PRF. Due to an NSS bug, the TLS key exporters for
      these ciphersuites don't work -- which caused relays to fail to
      handshake with one another when these ciphersuites were enabled.
      Fixes bug 29241; bugfix on 0.3.5.1-alpha.
  o Minor features (bandwidth authority):
    - Make bandwidth authorities ignore relays that are reported in the
      bandwidth file with the flag "vote=0". This change allows us to
      report unmeasured relays for diagnostic reasons without including
      their bandwidth in the bandwidth authorities' vote. Closes
      ticket 29806.
    - When a directory authority is using a bandwidth file to obtain the
      bandwidth values that will be included in the next vote, serve
      this bandwidth file at /tor/status-vote/next/bandwidth. Closes
      ticket 21377.
  o Minor features (circuit padding):
    - Stop warning about undefined behavior in the probability
      distribution tests. Float division by zero may technically be
      undefined behavior in C, but it's well defined in IEEE 754.
      Partial backport of 29298. Closes ticket 29527; bugfix
      on 0.4.0.1-alpha.
  o Minor features (continuous integration):
    - On Travis Rust builds, cleanup Rust registry and refrain from
      caching the "target/" directory to speed up builds. Resolves
      issue 29962.
  o Minor features (dormant mode):
    - Add a DormantCanceledByStartup option to tell Tor that it should
      treat a startup event as cancelling any previous dormant state.
      Integrators should use this option with caution: it should only be
      used if Tor is being started because of something that the user
      did, and not if Tor is being automatically started in the
      background. Closes ticket 29357.
  o Minor features (geoip):
    - Update geoip and geoip6 to the April 2 2019 Maxmind GeoLite2
      Country database. Closes ticket 29992.
  o Minor features (NSS, diagnostic):
    - Try to log an error from NSS (if there is any) and a more useful
      description of our situation if we are using NSS and a call to
      SSL_ExportKeyingMaterial() fails. Diagnostic for ticket 29241.
  o Minor bugfixes (security):
    - Fix a potential double free bug when reading huge bandwidth files.
      The issue is not exploitable in the current Tor network because
      the vulnerable code is only reached when directory authorities
      read bandwidth files, but bandwidth files come from a trusted
      source (usually the authorities themselves). Furthermore, the
      issue is only exploitable in rare (non-POSIX) 32-bit architectures,
      which are not used by any of the current authorities. Fixes bug
      30040; bugfix on 0.3.5.1-alpha. Bug found and fixed by
      Tobias Stoeckmann.
    - Verify in more places that we are not about to create a buffer
      with more than INT_MAX bytes, to avoid possible OOB access in the
      event of bugs. Fixes bug 30041; bugfix on 0.2.0.16. Found and
      fixed by Tobias Stoeckmann.
  o Minor bugfix (continuous integration):
    - Reset coverage state on disk after Travis CI has finished. This
      should prevent future coverage merge errors from causing the test
      suite for the "process" subsystem to fail. The process subsystem
      was introduced in 0.4.0.1-alpha. Fixes bug 29036; bugfix
      on 0.2.9.15.
    - Terminate test-stem if it takes more than 9.5 minutes to run.
      (Travis terminates the job after 10 minutes of no output.)
      Diagnostic for 29437. Fixes bug 30011; bugfix on 0.3.5.4-alpha.
  o Minor bugfixes (bootstrap reporting):
    - During bootstrap reporting, correctly distinguish pluggable
      transports from plain proxies. Fixes bug 28925; bugfix
      on 0.4.0.1-alpha.
  o Minor bugfixes (C correctness):
    - Fix an unlikely memory leak in consensus_diff_apply(). Fixes bug
      29824; bugfix on 0.3.1.1-alpha. This is Coverity warning
      CID 1444119.
  o Minor bugfixes (circuitpadding testing):
    - Minor tweaks to avoid rare test failures related to timers and
      monotonic time. Fixes bug 29500; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (directory authorities):
    - Actually include the bandwidth-file-digest line in directory
      authority votes. Fixes bug 29959; bugfix on 0.4.0.2-alpha.
  o Minor bugfixes (logging):
    - On Windows, when errors cause us to reload a consensus from disk,
      tell the user that we are retrying at log level "notice".
      Previously we only logged this information at "info", which was
      confusing because the errors themselves were logged at "warning".
      Improves previous fix for 28614. Fixes bug 30004; bugfix
      on 0.4.0.2-alpha.
  o Minor bugfixes (pluggable transports):
    - Restore old behavior when it comes to discovering the path of a
      given Pluggable Transport executable file. A change in
      0.4.0.1-alpha had broken this behavior on paths containing a
      space. Fixes bug 29874; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (testing):
    - Backport the 0.3.4 src/test/test-network.sh to 0.2.9. We need a
      recent test-network.sh to use new chutney features in CI. Fixes
      bug 29703; bugfix on 0.2.9.1-alpha.
    - Fix a test failure on Windows caused by an unexpected "BUG"
      warning in our tests for tor_gmtime_r(-1). Fixes bug 29922; bugfix
      on 0.2.9.3-alpha.
  o Minor bugfixes (TLS protocol):
    - When classifying a client's selection of TLS ciphers, if the
      client ciphers are not yet available, do not cache the result.
      Previously, we had cached the unavailability of the cipher list
      and never looked again, which in turn led us to assume that the
      client only supported the ancient V1 link protocol. This, in turn,
      was causing Stem integration tests to stall in some cases. Fixes
      bug 30021; bugfix on 0.2.4.8-alpha.
  o Code simplification and refactoring:
    - Introduce a connection_dir_buf_add() helper function that detects
      whether compression is in use, and adds a string accordingly.
      Resolves issue 28816.
    - Refactor handle_get_next_bandwidth() to use
      connection_dir_buf_add(). Implements ticket 29897.
  o Documentation:
    - Clarify that Tor performs stream isolation among *Port listeners
      by default. Resolves issue 29121.

@_date: 2019-02-20 12:29:55
@_author: Nick Mathewson 
@_subject: [tor-talk] Upcoming stable releases to fix a medium-severity 
I'm planning to put out new Tor source releases some time Thursday or
Friday.  They will be versions 0.3.3.12, 0.3.4.11, 0.3.5.8, and
These versions will, among the usual array of bugfixes, fix a
medium-severity security issue: a remote denial-of-service attack
vector against relays and clients running version 0.3.2.1-alpha and
later. While we don't currently know an exploit for the issue, we hope
that all affected relays will upgrade.  The issue is traced as
TROVE-2019-001, Tor bug  and CVE-2019-8955.
One more reminder: the 0.3.3.x series was scheduled to reach
end-of-life as of February 22.  We've extended that to February 28,
but after that date, there will be no more security updates for the
0.3.3.x series.  If you need a version that will receive long-term
support, we recommend that you stick with 0.3.5.x, which will be
supported until 2022.
best wishes,

@_date: 2019-02-21 13:13:29
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.0.2-alpha is released 
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely in the
next few weeks.
This release fixes TROVE-2019-001, a possible security bug involving
the KIST cell scheduler code in versions 0.3.2.1-alpha and later.  We
are not certain that it is possible to exploit this bug in the wild,
but to be careful, we recommend that all affected users upgrade.  The
potential impact is a remote denial-of-service attack against clients
or relays.
Here's what's new:
Changes in version 0.4.0.2-alpha - 2019-02-21
  Tor 0.4.0.2-alpha is the second alpha in its series; it fixes several
  bugs from earlier versions, including several that had broken
  backward compatibility.
  It also includes a fix for a medium-severity security bug affecting Tor
  0.3.2.1-alpha and later. All Tor instances running an affected release
  should upgrade to 0.3.3.12, 0.3.4.11, 0.3.5.8, or 0.4.0.2-alpha.
  o Major bugfixes (cell scheduler, KIST, security):
    - Make KIST consider the outbuf length when computing what it can
      put in the outbuf. Previously, KIST acted as though the outbuf
      were empty, which could lead to the outbuf becoming too full. It
      is possible that an attacker could exploit this bug to cause a Tor
      client or relay to run out of memory and crash. Fixes bug 29168;
      bugfix on 0.3.2.1-alpha. This issue is also being tracked as
      TROVE-2019-001 and CVE-2019-8955.
  o Major bugfixes (networking):
    - Gracefully handle empty username/password fields in SOCKS5
      username/password auth messsage and allow SOCKS5 handshake to
      continue. Previously, we had rejected these handshakes, breaking
      certain applications. Fixes bug 29175; bugfix on 0.3.5.1-alpha.
  o Major bugfixes (windows, startup):
    - When reading a consensus file from disk, detect whether it was
      written in text mode, and re-read it in text mode if so. Always
      write consensus files in binary mode so that we can map them into
      memory later. Previously, we had written in text mode, which
      confused us when we tried to map the file on windows. Fixes bug
      28614; bugfix on 0.4.0.1-alpha.
  o Minor features (compilation):
    - Compile correctly when OpenSSL is built with engine support
      disabled, or with deprecated APIs disabled. Closes ticket 29026.
      Patches from "Mangix".
  o Minor features (developer tooling):
    - Check that bugfix versions in changes files look like Tor versions
      from the versions spec. Warn when bugfixes claim to be on a future
      release. Closes ticket 27761.
    - Provide a git pre-commit hook that disallows commiting if we have
      any failures in our code and changelog formatting checks. It is
      now available in scripts/maint/pre-commit.git-hook. Implements
      feature 28976.
  o Minor features (directory authority):
    - When a directory authority is using a bandwidth file to obtain
      bandwidth values, include the digest of that file in the vote.
      Closes ticket 26698.
  o Minor features (geoip):
    - Update geoip and geoip6 to the February 5 2019 Maxmind GeoLite2
      Country database. Closes ticket 29478.
  o Minor features (testing):
    - Treat all unexpected ERR and BUG messages as test failures. Closes
      ticket 28668.
  o Minor bugfixes (build, compatibility, rust):
    - Update Cargo.lock file to match the version made by the latest
      version of Rust, so that "make distcheck" will pass again. Fixes
      bug 29244; bugfix on 0.3.3.4-alpha.
  o Minor bugfixes (compilation):
    - Fix compilation warnings in test_circuitpadding.c. Fixes bug
      29169; bugfix on 0.4.0.1-alpha.
    - Silence a compiler warning in test-memwipe.c on OpenBSD. Fixes bug
      29145; bugfix on 0.2.9.3-alpha. Patch from Kris Katterjohn.
  o Minor bugfixes (documentation):
    - Describe the contents of the v3 onion service client authorization
      files correctly: They hold public keys, not private keys. Fixes
      bug 28979; bugfix on 0.3.5.1-alpha. Spotted by "Felixix".
  o Minor bugfixes (linux seccomp sandbox):
    - Fix startup crash when experimental sandbox support is enabled.
      Fixes bug 29150; bugfix on 0.4.0.1-alpha. Patch by Peter Gerber.
  o Minor bugfixes (logging):
    - Avoid logging that we are relaxing a circuit timeout when that
      timeout is fixed. Fixes bug 28698; bugfix on 0.2.4.7-alpha.
    - Log more information at "warning" level when unable to read a
      private key; log more information at "info" level when unable to
      read a public key. We had warnings here before, but they were lost
      during our NSS work. Fixes bug 29042; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (misc):
    - The amount of total available physical memory is now determined
      using the sysctl identifier HW_PHYSMEM (rather than HW_USERMEM)
      when it is defined and a 64-bit variant is not available. Fixes
      bug 28981; bugfix on 0.2.5.4-alpha. Patch from Kris Katterjohn.
  o Minor bugfixes (onion services):
    - Avoid crashing if ClientOnionAuthDir (incorrectly) contains more
      than one private key for a hidden service. Fixes bug 29040; bugfix
      on 0.3.5.1-alpha.
    - In hs_cache_store_as_client() log an HSDesc we failed to parse at
      "debug" level. Tor used to log it as a warning, which caused very
      long log lines to appear for some users. Fixes bug 29135; bugfix
      on 0.3.2.1-alpha.
    - Stop logging "Tried to establish rendezvous on non-OR circuit..."
      as a warning. Instead, log it as a protocol warning, because there
      is nothing that relay operators can do to fix it. Fixes bug 29029;
      bugfix on 0.2.5.7-rc.
  o Minor bugfixes (scheduler):
    - When re-adding channels to the pending list, check the correct
      channel's sched_heap_idx. This issue has had no effect in mainline
      Tor, but could have led to bugs down the road in improved versions
      of our circuit scheduling code. Fixes bug 29508; bugfix
      on 0.3.2.10.
  o Minor bugfixes (tests):
    - Fix intermittent failures on an adaptive padding test. Fixes one
      case of bug 29122; bugfix on 0.4.0.1-alpha.
    - Disable an unstable circuit-padding test that was failing
      intermittently because of an ill-defined small histogram. Such
      histograms will be allowed again after 29298 is implemented. Fixes
      a second case of bug 29122; bugfix on 0.4.0.1-alpha.
    - Detect and suppress "bug" warnings from the util/time test on
      Windows. Fixes bug 29161; bugfix on 0.2.9.3-alpha.
    - Do not log an error-level message if we fail to find an IPv6
      network interface from the unit tests. Fixes bug 29160; bugfix
      on 0.2.7.3-rc.
  o Documentation:
    - In the manpage entry describing MapAddress torrc setting, use
      example IP addresses from ranges specified for use in documentation
      by RFC 5737. Resolves issue 28623.
  o Removed features:
    - Remove the old check-tor script. Resolves issue 29072.

@_date: 2019-01-18 10:11:20
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.0.1-alpha is released! 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on the
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by the
end of the month.
Here's what's new:
Changes in version 0.4.0.1-alpha - 2019-01-18
  Tor 0.4.0.1-alpha is the first release in the new 0.4.0.x series. It
  introduces improved features for power and bandwidth conservation,
  more accurate reporting of bootstrap progress for user interfaces, and
  an experimental backend for an exciting new adaptive padding feature.
  There is also the usual assortment of bugfixes and minor features, all
  described below.
  o Major features (battery management, client, dormant mode):
    - When Tor is running as a client, and it is unused for a long time,
      it can now enter a "dormant" state. When Tor is dormant, it avoids
      network and CPU activity until it is reawoken either by a user
      request or by a controller command. For more information, see the
      configuration options starting with "Dormant". Implements tickets
      2149 and 28335.
    - The client's memory of whether it is "dormant", and how long it
      has spent idle, persists across invocations. Implements
      ticket 28624.
    - There is a DormantOnFirstStartup option that integrators can use
      if they expect that in many cases, Tor will be installed but
      not used.
  o Major features (bootstrap reporting):
    - When reporting bootstrap progress, report the first connection
      uniformly, regardless of whether it's a connection for building
      application circuits. This allows finer-grained reporting of early
      progress than previously possible, with the improvements of ticket
      27169. Closes tickets 27167 and 27103. Addresses ticket 27308.
    - When reporting bootstrap progress, treat connecting to a proxy or
      pluggable transport as separate from having successfully used that
      proxy or pluggable transport to connect to a relay. Closes tickets
      27100 and 28884.
  o Major features (circuit padding):
    - Implement preliminary support for the circuit padding portion of
      Proposal 254. The implementation supports Adaptive Padding (aka
      WTF-PAD) state machines for use between experimental clients and
      relays. Support is also provided for APE-style state machines that
      use probability distributions instead of histograms to specify
      inter-packet delay. At the moment, Tor does not provide any
      padding state machines that are used in normal operation: for now,
      this feature exists solely for experimentation. Closes
      ticket 28142.
  o Major features (refactoring):
    - Tor now uses an explicit list of its own subsystems when
      initializing and shutting down. Previously, these systems were
      managed implicitly in various places throughout the codebase.
      (There may still be some subsystems using the old system.) Closes
      ticket 28330.
  o Minor features (bootstrap reporting):
    - When reporting bootstrap progress, stop distinguishing between
      situations where only internal paths are available and situations
      where external paths are available. Previously, Tor would often
      erroneously report that it had only internal paths. Closes
      ticket 27402.
  o Minor features (continuous integration):
    - Log Python version during each Travis CI job. Resolves
      issue 28551.
  o Minor features (controller):
    - Add a DROPOWNERSHIP command to undo the effects of TAKEOWNERSHIP.
      Implements ticket 28843.
  o Minor features (developer tooling):
    - Provide a git hook script to prevent "fixup!" and "squash!"
      commits from ending up in the master branch, as scripts/main/pre-
      push.git-hook. Closes ticket 27993.
  o Minor features (directory authority):
    - Directory authorities support a new consensus algorithm, under
      which the family lines in microdescriptors are encoded in a
      canonical form. This change makes family lines more compressible
      in transit, and on the client. Closes ticket 28266; implements
      proposal 298.
  o Minor features (directory authority, relay):
    - Authorities now vote on a "StaleDesc" flag to indicate that a
      relay's descriptor is so old that the relay should upload again
      soon. Relays treat this flag as a signal to upload a new
      descriptor. This flag will eventually let us remove the
      'published' date from routerstatus entries, and make our consensus
      diffs much smaller. Closes ticket 26770; implements proposal 293.
  o Minor features (fallback directory mirrors):
    - Update the fallback whitelist based on operator opt-ins and opt-
      outs. Closes ticket 24805, patch by Phoul.
  o Minor features (FreeBSD):
    - On FreeBSD-based systems, warn relay operators if the
      "net.inet.ip.random_id" sysctl (IP ID randomization) is disabled.
      Closes ticket 28518.
  o Minor features (HTTP standards compliance):
    - Stop sending the header "Content-type: application/octet-stream"
      along with transparently compressed documents: this confused
      browsers. Closes ticket 28100.
  o Minor features (IPv6):
    - We add an option ClientAutoIPv6ORPort, to make clients randomly
      prefer a node's IPv4 or IPv6 ORPort. The random preference is set
      every time a node is loaded from a new consensus or bridge config.
      We expect that this option will enable clients to bootstrap more
      quickly without having to determine whether they support IPv4,
      IPv6, or both. Closes ticket 27490. Patch by Neel Chauhan.
    - When using addrs_in_same_network_family(), avoid choosing circuit
      paths that pass through the same IPv6 subnet more than once.
      Previously, we only checked IPv4 subnets. Closes ticket 24393.
      Patch by Neel Chauhan.
  o Minor features (log messages):
    - Improve log message in v3 onion services that could print out
      negative revision counters. Closes ticket 27707. Patch
      by "ffmancera".
  o Minor features (memory usage):
    - Save memory by storing microdescriptor family lists with a more
      compact representation. Closes ticket 27359.
    - Tor clients now use mmap() to read consensus files from disk, so
      that they no longer need keep the full text of a consensus in
      memory when parsing it or applying a diff. Closes ticket 27244.
  o Minor features (parsing):
    - Directory authorities now validate that router descriptors and
      ExtraInfo documents are in a valid subset of UTF-8, and reject
      them if they are not. Closes ticket 27367.
  o Minor features (performance):
    - Cache the results of summarize_protocol_flags(), so that we don't
      have to parse the same protocol-versions string over and over.
      This should save us a huge number of malloc calls on startup, and
      may reduce memory fragmentation with some allocators. Closes
      ticket 27225.
    - Remove a needless memset() call from get_token_arguments, thereby
      speeding up the tokenization of directory objects by about 20%.
      Closes ticket 28852.
    - Replace parse_short_policy() with a faster implementation, to
      improve microdescriptor parsing time. Closes ticket 28853.
    - Speed up directory parsing a little by avoiding use of the non-
      inlined strcmp_len() function. Closes ticket 28856.
    - Speed up microdescriptor parsing by about 30%, to help improve
      startup time. Closes ticket 28839.
  o Minor features (pluggable transports):
    - Add support for emitting STATUS updates to Tor's control port from
      a pluggable transport process. Closes ticket 28846.
    - Add support for logging to Tor's logging subsystem from a
      pluggable transport process. Closes ticket 28180.
  o Minor features (process management):
    - Add a new process API for handling child processes. This new API
      allows Tor to have bi-directional communication with child
      processes on both Unix and Windows. Closes ticket 28179.
    - Use the subsystem manager to initialize and shut down the process
      module. Closes ticket 28847.
  o Minor features (relay):
    - When listing relay families, list them in canonical form including
      the relay's own identity, and try to give a more useful set of
      warnings. Part of ticket 28266 and proposal 298.
  o Minor features (required protocols):
    - Before exiting because of a missing required protocol, Tor will
      now check the publication time of the consensus, and not exit
      unless the consensus is newer than the Tor program's own release
      date. Previously, Tor would not check the consensus publication
      time, and so might exit because of a missing protocol that might
      no longer be required in a current consensus. Implements proposal
      297; closes ticket 27735.
  o Minor features (testing):
    - Allow a HeartbeatPeriod of less than 30 minutes in testing Tor
      networks. Closes ticket 28840. Patch by Rob Jansen.
  o Minor bugfixes (client, clock skew):
    - Bootstrap successfully even when Tor's clock is behind the clocks
      on the authorities. Fixes bug 28591; bugfix on 0.2.0.9-alpha.
    - Select guards even if the consensus has expired, as long as the
      consensus is still reasonably live. Fixes bug 24661; bugfix
      on 0.3.0.1-alpha.
  o Minor bugfixes (compilation):
    - Compile correctly on OpenBSD; previously, we were missing some
      headers required in order to detect it properly. Fixes bug 28938;
      bugfix on 0.3.5.1-alpha. Patch from Kris Katterjohn.
  o Minor bugfixes (directory clients):
    - Mark outdated dirservers when Tor only has a reasonably live
      consensus. Fixes bug 28569; bugfix on 0.3.2.5-alpha.
  o Minor bugfixes (directory mirrors):
    - Even when a directory mirror's clock is behind the clocks on the
      authorities, we now allow the mirror to serve "future"
      consensuses. Fixes bug 28654; bugfix on 0.3.0.1-alpha.
  o Minor bugfixes (DNS):
    - Gracefully handle an empty or absent resolve.conf file by falling
      back to using "localhost" as a DNS server (and hoping it works).
      Previously, we would just stop running as an exit. Fixes bug
      21900; bugfix on 0.2.1.10-alpha.
  o Minor bugfixes (guards):
    - In count_acceptable_nodes(), the minimum number is now one bridge
      or guard node, and two non-guard nodes for a circuit. Previously,
      we had added up the sum of all nodes with a descriptor, but that
      could cause us to build failing circuits when we had either too
      many bridges or not enough guard nodes. Fixes bug 25885; bugfix on
      0.3.6.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (IPv6):
    - Fix tor_ersatz_socketpair on IPv6-only systems. Previously, the
      IPv6 socket was bound using an address family of AF_INET instead
      of AF_INET6. Fixes bug 28995; bugfix on 0.3.5.1-alpha. Patch from
      Kris Katterjohn.
  o Minor bugfixes (logging):
    - Rework rep_hist_log_link_protocol_counts() to iterate through all
      link protocol versions when logging incoming/outgoing connection
      counts. Tor no longer skips version 5, and we won't have to
      remember to update this function when new link protocol version is
      developed. Fixes bug 28920; bugfix on 0.2.6.10.
  o Minor bugfixes (networking):
    - Introduce additional checks into tor_addr_parse() to reject
      certain incorrect inputs that previously were not detected. Fixes
      bug 23082; bugfix on 0.2.0.10-alpha.
  o Minor bugfixes (onion service v3, client):
    - Stop logging a "BUG()" warning and stacktrace when we find a SOCKS
      connection waiting for a descriptor that we actually have in the
      cache. It turns out that this can actually happen, though it is
      rare. Now, tor will recover and retry the descriptor. Fixes bug
      28669; bugfix on 0.3.2.4-alpha.
  o Minor bugfixes (periodic events):
    - Refrain from calling routerlist_remove_old_routers() from
      check_descriptor_callback(). Instead, create a new hourly periodic
      event. Fixes bug 27929; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (pluggable transports):
    - Make sure that data is continously read from standard output and
      standard error pipes of a pluggable transport child-process, to
      avoid deadlocking when a pipe's buffer is full. Fixes bug 26360;
      bugfix on 0.2.3.6-alpha.
  o Minor bugfixes (unit tests):
    - Instead of relying on hs_free_all() to clean up all onion service
      objects in test_build_descriptors(), we now deallocate them one by
      one. This lets Coverity know that we are not leaking memory there
      and fixes CID 1442277. Fixes bug 28989; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (usability):
    - Stop saying "Your Guard ..." in pathbias_measure_{use,close}_rate().
      Some users took this phrasing to mean that the mentioned guard was
      under their control or responsibility, which it is not. Fixes bug
      28895; bugfix on Tor 0.3.0.1-alpha.
  o Code simplification and refactoring:
    - Reimplement NETINFO cell parsing and generation to rely on
      trunnel-generated wire format handling code. Closes ticket 27325.
    - Remove unnecessary unsafe code from the Rust macro "cstr!". Closes
      ticket 28077.
    - Rework SOCKS wire format handling to rely on trunnel-generated
      parsing/generation code. Resolves ticket 27620.
    - Split out bootstrap progress reporting from control.c into a
      separate file. Part of ticket 27402.
    - The .may_include files that we use to describe our directory-by-
      directory dependency structure now describe a noncircular
      dependency graph over the directories that they cover. Our
      checkIncludes.py tool now enforces this noncircularity. Closes
      ticket 28362.
  o Documentation:
    - Mention that you cannot add a new onion service if Tor is already
      running with Sandbox enabled. Closes ticket 28560.
    - Improve ControlPort documentation. Mention that it accepts
      address:port pairs, and can be used multiple times. Closes
      ticket 28805.
    - Document the exact output of "tor --version". Closes ticket 28889.
  o Removed features:
    - Stop responding to the 'GETINFO status/version/num-concurring' and
      'GETINFO status/version/num-versioning' control port commands, as
      those were deprecated back in 0.2.0.30. Also stop listing them in
      output of 'GETINFO info/names'. Resolves ticket 28757.
    - The scripts used to generate and maintain the list of fallback
      directories have been extracted into a new "fallback-scripts"
      repository. Closes ticket 27914.
  o Testing:
    - Run shellcheck for scripts in the in scripts/ directory. Closes
      ticket 28058.
    - Add unit tests for tokenize_string() and get_next_token()
      functions. Resolves ticket 27625.
  o Code simplification and refactoring (onion service v3):
    - Consolidate the authorized client descriptor cookie computation
      code from client and service into one function. Closes
      ticket 27549.
  o Code simplification and refactoring (shell scripts):
    - Cleanup scan-build.sh to silence shellcheck warnings. Closes
      ticket 28007.
    - Fix issues that shellcheck found in chutney-git-bisect.sh.
      Resolves ticket 28006.
    - Fix issues that shellcheck found in updateRustDependencies.sh.
      Resolves ticket 28012.
    - Fix shellcheck warnings in cov-diff script. Resolves issue 28009.
    - Fix shellcheck warnings in run_calltool.sh. Resolves ticket 28011.
    - Fix shellcheck warnings in run_trunnel.sh. Resolves issue 28010.
    - Fix shellcheck warnings in scripts/test/coverage. Resolves
      issue 28008.

@_date: 2019-07-25 21:52:33
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.1.4-rc is released 
============================== START ==============================
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available at
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the next month.
Here's what's new:
Changes in version 0.4.1.4-rc - 2019-07-25
  Tor 0.4.1.4-rc fixes a few bugs from previous versions of Tor, and
  updates to a new list of fallback directories. If no new bugs are
  found, the next release in the 0.4.1.x serious should be stable.
  o Major bugfixes (circuit build, guard):
    - When considering upgrading circuits from "waiting for guard" to
      "open", always ignore circuits that are marked for close. Otherwise,
      we can end up in the situation where a subsystem is notified that
      a closing circuit has just opened, leading to undesirable
      behavior. Fixes bug 30871; bugfix on 0.3.0.1-alpha.
  o Minor features (continuous integration):
    - Our Travis configuration now uses Chutney to run some network
      integration tests automatically. Closes ticket 29280.
  o Minor features (fallback directory list):
    - Replace the 157 fallbacks originally introduced in Tor 0.3.5.6-rc
      in December 2018 (of which ~122 were still functional), with a
      list of 148 fallbacks (70 new, 78 existing, 79 removed) generated
      in June 2019. Closes ticket 28795.
  o Minor bugfixes (circuit padding):
    - On relays, properly check that a padding machine is absent before
      logging a warning about it being absent. Fixes bug 30649; bugfix
      on 0.4.1.1-alpha.
    - Add two NULL checks in unreachable places to silence Coverity (CID
      144729 and 1447291) and better future-proof ourselves. Fixes bug
      31024; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (crash on exit):
    - Avoid a set of possible code paths that could try to use freed
      memory in routerlist_free() while Tor was exiting. Fixes bug
      31003; bugfix on 0.1.2.2-alpha.
  o Minor bugfixes (logging):
    - Fix a conflict between the flag used for messaging-domain log
      messages, and the LD_NO_MOCK testing flag. Fixes bug 31080; bugfix
      on 0.4.1.1-alpha.
  o Minor bugfixes (memory leaks):
    - Fix a trivial memory leak when parsing an invalid value from a
      download schedule in the configuration. Fixes bug 30894; bugfix
      on 0.3.4.1-alpha.
  o Code simplification and refactoring:
    - Remove some dead code from circpad_machine_remove_token() to fix
      some Coverity warnings (CID 1447298). Fixes bug 31027; bugfix
      on 0.4.1.1-alpha.

@_date: 2019-06-06 08:38:11
@_author: Nick Mathewson 
@_subject: [tor-talk] New release: Tor 0.4.1.2-alpha 
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from
 ;  if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely some time next week.
Here's what's new:
Changes in version 0.4.1.2-alpha - 2019-06-06
  Tor 0.4.1.2-alpha resolves numerous bugs--some of them from the
  previous alpha, and some much older. It also contains minor testing
  improvements, and an improvement to the security of our authenticated
  SENDME implementation.
  o Major bugfixes (bridges):
    - Consider our directory information to have changed when our list
      of bridges changes. Previously, Tor would not re-compute the
      status of its directory information when bridges changed, and
      therefore would not realize that it was no longer able to build
      circuits. Fixes part of bug 29875.
    - Do not count previously configured working bridges towards our
      total of working bridges. Previously, when Tor's list of bridges
      changed, it would think that the old bridges were still usable,
      and delay fetching router descriptors for the new ones. Fixes part
      of bug 29875; bugfix on 0.3.0.1-alpha.
  o Major bugfixes (flow control, SENDME):
    - Decrement the stream-level package window after packaging a cell.
      Previously, it was done inside a log_debug() call, meaning that if
      debug logs were not enabled, the decrement would never happen, and
      thus the window would be out of sync with the other end point.
      Fixes bug 30628; bugfix on 0.4.1.1-alpha.
  o Major bugfixes (onion service reachability):
    - Properly clean up the introduction point map and associated state
      when circuits change purpose from onion service circuits to
      pathbias, measurement, or other circuit types. This may fix some
      instances of introduction point failure. Fixes bug 29034; bugfix
      on 0.3.2.1-alpha.
  o Minor features (authenticated SENDME):
    - Ensure that there is enough randomness on every circuit to prevent
      an attacker from successfully predicting the hashes they will need
      to include in authenticated SENDME cells. At a random interval, if
      we have not sent randomness already, we now leave some extra space
      at the end of a cell that we can fill with random bytes. Closes
      ticket 26846.
  o Minor features (continuous integration):
    - When running coverage builds on Travis, we now set
      TOR_TEST_RNG_SEED, to avoid RNG-based coverage differences. Part
      of ticket 28878.
  o Minor features (maintenance):
    - Add a new "make autostyle" target that developers can use to apply
      all automatic Tor style and consistency conversions to the
      codebase. Closes ticket 30539.
  o Minor features (testing):
    - The circuitpadding tests now use a reproducible RNG implementation,
      so that if a test fails, we can learn why. Part of ticket 28878.
    - Tor's tests now support an environment variable, TOR_TEST_RNG_SEED,
      to set the RNG seed for tests that use a reproducible RNG. Part of
      ticket 28878.
    - When running tests in coverage mode, take additional care to make
      our coverage deterministic, so that we can accurately track
      changes in code coverage. Closes ticket 30519.
  o Minor bugfixes (configuration, proxies):
    - Fix a bug that prevented us from supporting SOCKS5 proxies that
      want authentication along with configured (but unused!)
      ClientTransportPlugins. Fixes bug 29670; bugfix on 0.2.6.1-alpha.
  o Minor bugfixes (controller):
    - POSTDESCRIPTOR requests should work again. Previously, they were
      broken if a "purpose=" flag was specified. Fixes bug 30580; bugfix
      on 0.4.1.1-alpha.
    - Repair the HSFETCH command so that it works again. Previously, it
      expected a body when it shouldn't have. Fixes bug 30646; bugfix
      on 0.4.1.1-alpha.
  o Minor bugfixes (developer tooling):
    - Fix pre-push hook to allow fixup and squash commits when pushing
      to non-upstream git remote. Fixes bug 30286; bugfix
      on 0.4.0.1-alpha.
  o Minor bugfixes (directory authority):
    - Move the "bandwidth-file-headers" line in directory authority
      votes so that it conforms to dir-spec.txt. Fixes bug 30316; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (NetBSD):
    - Fix usage of minherit() on NetBSD and other platforms that define
      MAP_INHERIT_{ZERO,NONE} instead of INHERIT_{ZERO,NONE}. Fixes bug
      30614; bugfix on 0.4.0.2-alpha. Patch from Taylor Campbell.
  o Minor bugfixes (out-of-memory handler):
    - When purging the DNS cache because of an out-of-memory condition,
      try purging just the older entries at first. Previously, we would
      always purge the whole thing. Fixes bug 29617; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (portability):
    - Avoid crashing in our tor_vasprintf() implementation on systems
      that define neither vasprintf() nor _vscprintf(). (This bug has
      been here long enough that we question whether people are running
      Tor on such systems, but we're applying the fix out of caution.)
      Fixes bug 30561; bugfix on 0.2.8.2-alpha. Found and fixed by
      Tobias Stoeckmann.
  o Minor bugfixes (shutdown, libevent, memory safety):
    - Avoid use-after-free bugs when shutting down, by making sure that
      we shut down libevent only after shutting down all of its users.
      We believe these are harmless in practice, since they only occur
      on the shutdown path, and do not involve any attacker-controlled
      data. Fixes bug 30629; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (static analysis):
    - Fix several spurious Coverity warnings about the unit tests, to
      lower our chances of missing real warnings in the future. Fixes
      bug 30150; bugfix on 0.3.5.1-alpha and various other Tor versions.
  o Testing:
    - Specify torrc paths (with empty files) when launching tor in
      integration tests; refrain from reading user and system torrcs.
      Resolves issue 29702.

@_date: 2019-06-25 12:08:46
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.1.3-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place at
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the next two weeks.
Here's what's new:
Changes in version 0.4.1.3-alpha - 2019-06-25
  Tor 0.4.1.3-alpha resolves numerous bugs left over from the previous
  alpha, most of them from earlier release series.
  o Major bugfixes (Onion service reachability):
    - Properly clean up the introduction point map when circuits change
      purpose from onion service circuits to pathbias, measurement, or
      other circuit types. This should fix some service-side instances
      of introduction point failure. Fixes bug 29034; bugfix
      on 0.3.2.1-alpha.
  o Minor features (geoip):
    - Update geoip and geoip6 to the June 10 2019 Maxmind GeoLite2
      Country database. Closes ticket 30852.
  o Minor features (logging):
    - Give a more useful assertion failure message if we think we have
      minherit() but we fail to make a region non-inheritable. Give a
      compile-time warning if our support for minherit() is incomplete.
      Closes ticket 30686.
  o Minor bugfixes (circuit isolation):
    - Fix a logic error that prevented the SessionGroup sub-option from
      being accepted. Fixes bug 22619; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (continuous integration):
    - Allow the test-stem job to fail in Travis, because it sometimes
      hangs. Fixes bug 30744; bugfix on 0.3.5.4-alpha.
    - Skip test_rebind on macOS in Travis, because it is unreliable on
      macOS on Travis. Fixes bug 30713; bugfix on 0.3.5.1-alpha.
    - Skip test_rebind when the TOR_SKIP_TEST_REBIND environment
      variable is set. Fixes bug 30713; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (directory authorities):
    - Stop crashing after parsing an unknown descriptor purpose
      annotation. We think this bug can only be triggered by modifying a
      local file. Fixes bug 30781; bugfix on 0.2.0.8-alpha.
  o Minor bugfixes (pluggable transports):
    - When running as a bridge with pluggable transports, always publish
      pluggable transport information in our extrainfo descriptor, even
      if ExtraInfoStatistics is 0. This information is needed by
      BridgeDB. Fixes bug 30956; bugfix on 0.4.1.1-alpha.
  o Documentation:
    - Mention URLs for Travis/Appveyor/Jenkins in ReleasingTor.md.
      Closes ticket 30630.

@_date: 2019-05-17 09:03:05
@_author: Nick Mathewson 
@_subject: [tor-talk] Reminder: 0.3.4 reaches end-of-life on June 10 
This is a reminder that we're going to stop supporting Tor 0.3.4 on
June 10, per our policy and schedule at
.  After this date, we won't do any more security fixes or bugfixes
for 0.3.4.
If you need the latest and greatest version of Tor, you should be
running the 0.4.0 series.  If you need a version with long term
support, you should be running 0.3.5, which we plan to support until
best wishes,

@_date: 2019-05-22 18:02:45
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.1.1-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place at
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the next couple of weeks.
Here's what's new:
Changes in version 0.4.1.1-alpha - 2019-05-22
  This is the first alpha in the 0.4.1.x series. It introduces
  lightweight circuit padding to make some onion-service circuits harder
  to distinguish, includes a new "authenticated SENDME" feature to make
  certain denial-of-service attacks more difficult, and improves
  performance in several areas.
  o Major features (circuit padding):
    - Onion service clients now add padding cells at the start of their
      INTRODUCE and RENDEZVOUS circuits, to make those circuits' traffic
      look more like general purpose Exit traffic. The overhead for this
      is 2 extra cells in each direction for RENDEZVOUS circuits, and 1
      extra upstream cell and 10 downstream cells for INTRODUCE
      circuits. This feature is only enabled when also supported by the
      circuit's middle node. (Clients may specify fixed middle nodes
      with the MiddleNodes option, and may force-disable this feature
      with the CircuitPadding torrc.) Closes ticket 28634.
  o Major features (code organization):
    - Tor now includes a generic publish-subscribe message-passing
      subsystem that we can use to organize intermodule dependencies. We
      hope to use this to reduce dependencies between modules that don't
      need to be related, and to generally simplify our codebase. Closes
      ticket 28226.
  o Major features (controller protocol):
    - Controller commands are now parsed using a generalized parsing
      subsystem. Previously, each controller command was responsible for
      parsing its own input, which led to strange inconsistencies.
      Closes ticket 30091.
  o Major features (flow control):
    - Implement authenticated SENDMEs as detailed in proposal 289. A
      SENDME cell now includes the digest of the traffic that it
      acknowledges, so that once an end point receives the SENDME, it
      can confirm the other side's knowledge of the previous cells that
      were sent, and prevent certain types of denial-of-service attacks.
      This behavior is controlled by two new consensus parameters: see
      the proposal for more details. Fixes ticket 26288.
  o Major features (performance):
    - Our node selection algorithm now excludes nodes in linear time.
      Previously, the algorithm was quadratic, which could slow down
      heavily used onion services. Closes ticket 30307.
  o Major features (performance, RNG):
    - Tor now constructs a fast secure pseudorandom number generator for
      each thread, to use when performance is critical. This PRNG is
      based on AES-CTR, using a buffering construction similar to
      libottery and the (newer) OpenBSD arc4random() code. It
      outperforms OpenSSL 1.1.1a's CSPRNG by roughly a factor of 100 for
      small outputs. Although we believe it to be cryptographically
      strong, we are only using it when necessary for performance.
      Implements tickets 29023 and 29536.
  o Major bugfixes (onion service v3):
    - Fix an unreachable bug in which an introduction point could try to
      send an INTRODUCE_ACK with a status code that Trunnel would refuse
      to encode, leading the relay to assert(). We've consolidated the
      ABI values into Trunnel now. Fixes bug 30454; bugfix
      on 0.3.0.1-alpha.
    - Clients can now handle unknown status codes from INTRODUCE_ACK
      cells. (The NACK behavior will stay the same.) This will allow us
      to extend status codes in the future without breaking the normal
      client behavior. Fixes another part of bug 30454; bugfix
      on 0.3.0.1-alpha.
  o Minor features (circuit padding):
    - We now use a fast PRNG when scheduling circuit padding. Part of
      ticket 28636.
    - Allow the padding machine designer to pick the edges of their
      histogram instead of trying to compute them automatically using an
      exponential formula. Resolves some undefined behavior in the case
      of small histograms and allows greater flexibility on machine
      design. Closes ticket 29298; bugfix on 0.4.0.1-alpha.
    - Allow circuit padding machines to hold a circuit open until they
      are done padding it. Closes ticket 28780.
  o Minor features (compile-time modules):
    - Add a "--list-modules" command to print a list of which compile-
      time modules are enabled. Closes ticket 30452.
  o Minor features (continuous integration):
    - Remove sudo configuration lines from .travis.yml as they are no
      longer needed with current Travis build environment. Resolves
      issue 30213.
    - In Travis, show stem's tor log after failure. Closes ticket 30234.
  o Minor features (controller):
    - Add onion service version 3 support to the HSFETCH command.
      Previously, only version 2 onion services were supported. Closes
      ticket 25417. Patch by Neel Chauhan.
  o Minor features (debugging):
    - Introduce tor_assertf() and tor_assertf_nonfatal() to enable
      logging of additional information during assert failure. Now we
      can use format strings to include information for trouble
      shooting. Resolves ticket 29662.
  o Minor features (defense in depth):
    - In smartlist_remove_keeporder(), set unused pointers to NULL, in
      case a bug causes them to be used later. Closes ticket 30176.
      Patch from Tobias Stoeckmann.
    - Tor now uses a cryptographically strong PRNG even for decisions
      that we do not believe are security-sensitive. Previously, for
      performance reasons, we had used a trivially predictable linear
      congruential generator algorithm for certain load-balancing and
      statistical sampling decisions. Now we use our fast RNG in those
      cases. Closes ticket 29542.
  o Minor features (developer tools):
    - Tor's "practracker" test script now checks for files and functions
      that seem too long and complicated. Existing overlong functions
      and files are accepted for now, but should eventually be
      refactored. Closes ticket 29221.
    - Add some scripts used for git maintenance to scripts/git. Closes
      ticket 29391.
    - Call practracker from pre-push and pre-commit git hooks to let
      developers know if they made any code style violations. Closes
      ticket 30051.
    - Add a script to check that each header has a well-formed and
      unique guard macro. Closes ticket 29756.
  o Minor features (geoip):
    - Update geoip and geoip6 to the May 13 2019 Maxmind GeoLite2
      Country database. Closes ticket 30522.
  o Minor features (HTTP tunnel):
    - Return an informative web page when the HTTPTunnelPort is used as
      an HTTP proxy. Closes ticket 27821, patch by "eighthave".
  o Minor features (IPv6, v3 onion services):
    - Make v3 onion services put IPv6 addresses in service descriptors.
      Before this change, service descriptors only contained IPv4
      addresses. Implements 26992.
  o Minor features (modularity):
    - The "--disable-module-dirauth" compile-time option now disables
      even more dirauth-only code. Closes ticket 30345.
  o Minor features (performance):
    - Use OpenSSL's implementations of SHA3 when available (in OpenSSL
      1.1.1 and later), since they tend to be faster than tiny-keccak.
      Closes ticket 28837.
  o Minor features (testing):
    - Tor's unit test code now contains helper functions to replace the
      PRNG with a deterministic or reproducible version for testing.
      Previously, various tests implemented this in various ways.
      Implements ticket 29732.
    - We now have a script, cov-test-determinism.sh, to identify places
      where our unit test coverage has become nondeterministic. Closes
      ticket 29436.
    - Check that representative subsets of values of `int` and `unsigned
      int` can be represented by `void *`. Resolves issue 29537.
  o Minor bugfixes (bridge authority):
    - Bridge authorities now set bridges as running or non-running when
      about to dump their status to a file. Previously, they set bridges
      as running in response to a GETINFO command, but those shouldn't
      modify data structures. Fixes bug 24490; bugfix on 0.2.0.13-alpha.
      Patch by Neel Chauhan.
  o Minor bugfixes (channel padding statistics):
    - Channel padding write totals and padding-enabled totals are now
      counted properly in relay extrainfo descriptors. Fixes bug 29231;
      bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (circuit padding):
    - Add a "CircuitPadding" torrc option to disable circuit padding.
      Fixes bug 28693; bugfix on 0.4.0.1-alpha.
    - Allow circuit padding machines to specify that they do not
      contribute much overhead, and provide consensus flags and torrc
      options to force clients to only use these low overhead machines.
      Fixes bug 29203; bugfix on 0.4.0.1-alpha.
    - Provide a consensus parameter to fully disable circuit padding, to
      be used in emergency network overload situations. Fixes bug 30173;
      bugfix on 0.4.0.1-alpha.
    - The circuit padding subsystem will no longer schedule padding if
      dormant mode is enabled. Fixes bug 28636; bugfix on 0.4.0.1-alpha.
    - Inspect a circuit-level cell queue before sending padding, to
      avoid sending padding while too much data is already queued. Fixes
      bug 29204; bugfix on 0.4.0.1-alpha.
    - Avoid calling monotime_absolute_usec() in circuit padding machines
      that do not use token removal or circuit RTT estimation. Fixes bug
      29085; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (compilation, unusual configurations):
    - Avoid failures when building with the ALL_BUGS_ARE_FATAL option
      due to missing declarations of abort(), and prevent other such
      failures in the future. Fixes bug 30189; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (controller protocol):
    - Teach the controller parser to distinguish an object preceded by
      an argument list from one without. Previously, it couldn't
      distinguish an argument list from the first line of a multiline
      object. Fixes bug 29984; bugfix on 0.2.3.8-alpha.
  o Minor bugfixes (directory authority, ipv6):
    - Directory authorities with IPv6 support now always mark themselves
      as reachable via IPv6. Fixes bug 24338; bugfix on 0.4.0.2-alpha.
      Patch by Neel Chauhan.
  o Minor bugfixes (documentation):
    - Improve the documentation for using MapAddress with ".exit". Fixes
      bug 30109; bugfix on 0.1.0.1-rc.
    - Improve the monotonic time module and function documentation to
      explain what "monotonic" actually means, and document some results
      that have surprised people. Fixes bug 29640; bugfix
      on 0.2.9.1-alpha.
    - Use proper formatting when providing an example on quoting options
      that contain whitespace. Fixes bug 29635; bugfix on 0.2.3.18-rc.
  o Minor bugfixes (logging):
    - Do not log a warning when running with an OpenSSL version other
      than the one Tor was compiled with, if the two versions should be
      compatible. Previously, we would warn whenever the version was
      different. Fixes bug 30190; bugfix on 0.2.4.2-alpha.
    - Warn operators when the MyFamily option is set but ContactInfo is
      missing, as the latter should be set too. Fixes bug 25110; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (memory leak):
    - Avoid a minor memory leak that could occur on relays when failing
      to create a "keys" directory. Fixes bug 30148; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (onion services):
    - Avoid a GCC 9.1.1 warning (and possible crash depending on libc
      implemenation) when failing to load an onion service client
      authorization file. Fixes bug 30475; bugfix on 0.3.5.1-alpha.
    - When refusing to launch a controller's HSFETCH request because of
      rate-limiting, respond to the controller with a new response,
      "QUERY_RATE_LIMITED". Previously, we would log QUERY_NO_HSDIR for
      this case. Fixes bug 28269; bugfix on 0.3.1.1-alpha. Patch by
      Neel Chauhan.
    - When relaunching a circuit to a rendezvous service, mark the
      circuit as needing high-uptime routers as appropriate. Fixes bug
      17357; bugfix on 0.4.0.2-alpha. Patch by Neel Chauhan.
    - Stop ignoring IPv6 link specifiers sent to v3 onion services.
      (IPv6 support for v3 onion services is still incomplete: see
      ticket 23493 for details.) Fixes bug 23588; bugfix on
      0.3.2.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (onion services, performance):
    - When building circuits to onion services, call tor_addr_parse()
      less often. Previously, we called tor_addr_parse() in
      circuit_is_acceptable() even if its output wasn't used. This
      change should improve performance when building circuits. Fixes
      bug 22210; bugfix on 0.2.8.12. Patch by Neel Chauhan.
  o Minor bugfixes (performance):
    - When checking whether a node is a bridge, use a fast check to make
      sure that its identity is set. Previously, we used a constant-time
      check, which is not necessary in this case. Fixes bug 30308;
      bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (pluggable transports):
    - Tor now sets TOR_PT_EXIT_ON_STDIN_CLOSE=1 for client transports as
      well as servers. Fixes bug 25614; bugfix on 0.2.7.1-alpha.
  o Minor bugfixes (probability distributions):
    - Refactor and improve parts of the probability distribution code
      that made Coverity complain. Fixes bug 29805; bugfix
      on 0.4.0.1-alpha.
  o Minor bugfixes (python):
    - Stop assuming that /usr/bin/python3 exists. For scripts that work
      with python2, use /usr/bin/python. Otherwise, use /usr/bin/env
      python3. Fixes bug 29913; bugfix on 0.2.5.3-alpha.
  o Minor bugfixes (relay):
    - When running as a relay, if IPv6Exit is set to 1 while ExitRelay
      is auto, act as if ExitRelay is 1. Previously, we would ignore
      IPv6Exit if ExitRelay was 0 or auto. Fixes bug 29613; bugfix on
      0.3.5.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (stats):
    - When ExtraInfoStatistics is 0, stop including bandwidth usage
      statistics, GeoIPFile hashes, ServerTransportPlugin lines, and
      bridge statistics by country in extra-info documents. Fixes bug
      29018; bugfix on 0.2.4.1-alpha.
  o Minor bugfixes (testing):
    - Call setrlimit() to disable core dumps in test_bt_cl.c. Previously
      we used `ulimit -c` in test_bt.sh, which violates POSIX shell
      compatibility. Fixes bug 29061; bugfix on 0.3.5.1-alpha.
    - Fix some incorrect code in the v3 onion service unit tests. Fixes
      bug 29243; bugfix on 0.3.2.1-alpha.
    - In the "routerkeys/*" tests, check the return values of mkdir()
      for possible failures. Fixes bug 29939; bugfix on 0.2.7.2-alpha.
      Found by Coverity as CID 1444254.
    - Split test_utils_general() into several smaller test functions.
      This makes it easier to perform resource deallocation on assert
      failure, and fixes Coverity warnings CID 1444117 and CID 1444118.
      Fixes bug 29823; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (tor-resolve):
    - Fix a memory leak in tor-resolve that could happen if Tor gave it
      a malformed SOCKS response. (Memory leaks in tor-resolve don't
      actually matter, but it's good to fix them anyway.) Fixes bug
      30151; bugfix on 0.4.0.1-alpha.
  o Code simplification and refactoring:
    - Abstract out the low-level formatting of replies on the control
      port. Implements ticket 30007.
    - Add several assertions in an attempt to fix some Coverity
      warnings. Closes ticket 30149.
    - Introduce a connection_dir_buf_add() helper function that checks
      for compress_state of dir_connection_t and automatically writes a
      string to directory connection with or without compression.
      Resolves issue 28816.
    - Make the base32_decode() API return the number of bytes written,
      for consistency with base64_decode(). Closes ticket 28913.
    - Move most relay-only periodic events out of mainloop.c into the
      relay subsystem. Closes ticket 30414.
    - Refactor and encapsulate parts of the codebase that manipulate
      crypt_path_t objects. Resolves issue 30236.
    - Refactor several places in our code that Coverity incorrectly
      believed might have memory leaks. Closes ticket 30147.
    - Remove redundant return values in crypto_format, and the
      associated return value checks elsewhere in the code. Make the
      implementations in crypto_format consistent, and remove redundant
      code. Resolves ticket 29660.
    - Rename tor_mem_is_zero() to fast_mem_is_zero(), to emphasize that
      it is not a constant-time function. Closes ticket 30309.
    - Replace hs_desc_link_specifier_t with link_specifier_t, and remove
      all hs_desc_link_specifier_t-specific code. Fixes bug 22781;
      bugfix on 0.3.2.1-alpha.
    - Simplify v3 onion service link specifier handling code. Fixes bug
      23576; bugfix on 0.3.2.1-alpha.
    - Split crypto_digest.c into NSS code, OpenSSL code, and shared
      code. Resolves ticket 29108.
    - Split control.c into several submodules, in preparation for
      distributing its current responsibilities throughout the codebase.
      Closes ticket 29894.
    - Start to move responsibility for knowing about periodic events to
      the appropriate subsystems, so that the mainloop doesn't need to
      know all the periodic events in the rest of the codebase.
      Implements tickets 30293 and 30294.
  o Documentation:
    - Document how to find git commits and tags for bug fixes in
      CodingStandards.md. Update some file documentation. Closes
      ticket 30261.
  o Removed features:
    - Remove the linux-tor-prio.sh script from contrib/operator-tools
      directory. Resolves issue 29434.
    - Remove the obsolete OpenSUSE initscript. Resolves issue 30076.
    - Remove the obsolete script at contrib/dist/tor.sh.in. Resolves
      issue 30075.
  o Code simplification and refactoring (shell scripts):
    - Clean up many of our shell scripts to fix shellcheck warnings.
      These include autogen.sh (ticket 26069), test_keygen.sh (ticket
      29062), test_switch_id.sh (ticket 29065), test_rebind.sh (ticket
      29063), src/test/fuzz/minimize.sh (ticket 30079), test_rust.sh
      (ticket 29064), torify (ticket 29070), asciidoc-helper.sh (29926),
      fuzz_multi.sh (30077), fuzz_static_testcases.sh (ticket 29059),
      nagios-check-tor-authority-cert (ticket 29071),
      src/test/fuzz/fixup_filenames.sh (ticket 30078), test-network.sh
      (ticket 29060), test_key_expiration.sh (ticket 30002),
      zero_length_keys.sh (ticket 29068), and test_workqueue_*.sh
      (ticket 29067).
  o Testing (chutney):
    - In "make test-network-all", test IPv6-only v3 single onion
      services, using the chutney network single-onion-v23-ipv6-md.
      Closes ticket 27251.

@_date: 2019-11-15 08:17:51
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.2.4-rc is released 
Hi, all!
There's a new Tor release candidate! Because it's a release candidate,
we'd really like to know about any remaining bugs in it, so we can try
to fix them before calling the series stable.  As usual you can report
bugs on trac.torproject.org.
The source code is available from the usual place at
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely by December 3.
Here's what's new:
Changes in version 0.4.2.4-rc - 2019-11-15
  Tor 0.4.2.4-rc is the first release candidate in its series. It fixes
  several bugs from earlier versions, including a few that would result in
  stack traces or incorrect behavior.
  o Minor features (build system):
    - Make pkg-config use --prefix when cross-compiling, if
      PKG_CONFIG_PATH is not set. Closes ticket 32191.
  o Minor features (geoip):
    - Update geoip and geoip6 to the November 6 2019 Maxmind GeoLite2
      Country database. Closes ticket 32440.
  o Minor bugfixes (client, onion service v3):
    - Fix a BUG() assertion that occurs within a very small race window
      between when a client intro circuit opens and when its descriptor
      gets cleaned up from the cache. The circuit is now closed early,
      which will trigger a re-fetch of the descriptor and continue the
      connection. Fixes bug 28970; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (code quality):
    - Fix "make check-includes" so it runs correctly on out-of-tree
      builds. Fixes bug 31335; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (configuration):
    - Log the option name when skipping an obsolete option. Fixes bug
      32295; bugfix on 0.4.2.1-alpha.
  o Minor bugfixes (crash):
    - When running Tor with an option like --verify-config or
      --dump-config that does not start the event loop, avoid crashing
      if we try to exit early because of an error. Fixes bug 32407;
      bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (directory):
    - When checking if a directory connection is anonymous, test if the
      circuit was marked for close before looking at its channel. This
      avoids a BUG() stacktrace if the circuit was previously closed.
      Fixes bug 31958; bugfix on 0.4.2.1-alpha.
  o Minor bugfixes (shellcheck):
    - Fix minor shellcheck errors in the git-*.sh scripts. Fixes bug
      32402; bugfix on 0.4.2.1-alpha.
    - Start checking most scripts for shellcheck errors again. Fixes bug
      32402; bugfix on 0.4.2.1-alpha.
  o Testing (continuous integration):
    - Use Ubuntu Bionic images for our Travis CI builds, so we can get a
      recent version of coccinelle. But leave chutney on Ubuntu Trusty,
      until we can fix some Bionic permissions issues (see ticket
      32240). Related to ticket 31919.
    - Install the mingw OpenSSL package in Appveyor. This makes sure
      that the OpenSSL headers and libraries match in Tor's Appveyor
      builds. (This bug was triggered by an Appveyor image update.)
      Fixes bug 32449; bugfix on 0.3.5.6-rc.
    - In Travis, use Xcode 11.2 on macOS 10.14. Closes ticket 32241.

@_date: 2019-10-07 09:28:40
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.2.2-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place at
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the next couple of weeks.
Here's what's new:
Changes in version 0.4.2.2-alpha - 2019-10-07
  This release fixes several bugs from the previous alpha release, and
  from earlier versions. It also includes a change in authorities, so
  that they begin to reject the currently unsupported release series.
  o Major features (directory authorities):
    - Directory authorities now reject relays running all currently
      deprecated release series. The currently supported release series
      are: 0.2.9, 0.3.5, 0.4.0, 0.4.1, and 0.4.2. Closes ticket 31549.
  o Major bugfixes (embedded Tor):
    - Avoid a possible crash when restarting Tor in embedded mode and
      enabling a different set of publish/subscribe messages. Fixes bug
      31898; bugfix on 0.4.1.1-alpha.
  o Major bugfixes (torrc parsing):
    - Stop ignoring torrc options after an %include directive, when the
      included directory ends with a file that does not contain any
      config options (but does contain comments or whitespace). Fixes
      bug 31408; bugfix on 0.3.1.1-alpha.
  o Minor features (auto-formatting scripts):
    - When annotating C macros, never generate a line that our check-
      spaces script would reject. Closes ticket 31759.
    - When annotating C macros, try to remove cases of double-negation.
      Closes ticket 31779.
  o Minor features (continuous integration):
    - When building on Appveyor and Travis, pass the "-k" flag to make,
      so that we are informed of all compilation failures, not just the
      first one or two. Closes ticket 31372.
  o Minor features (geoip):
    - Update geoip and geoip6 to the October 1 2019 Maxmind GeoLite2
      Country database. Closes ticket 31931.
  o Minor features (maintenance scripts):
    - Add a Coccinelle script to detect bugs caused by incrementing or
      decrementing a variable inside a call to log_debug(). Since
      log_debug() is a macro whose arguments are conditionally
      evaluated, it is usually an error to do this. One such bug was
      30628, in which SENDME cells were miscounted by a decrement
      operator inside a log_debug() call. Closes ticket 30743.
  o Minor features (onion services v3):
    - Assist users who try to setup v2 client authorization in v3 onion
      services by pointing them to the right documentation. Closes
      ticket 28966.
  o Minor bugfixes (Appveyor continuous integration):
    - Avoid spurious errors when Appveyor CI fails before the install
      step. Fixes bug 31884; bugfix on 0.3.4.2-alpha.
  o Minor bugfixes (best practices tracker):
    - When listing overbroad exceptions, do not also list problems, and
      do not list insufficiently broad exceptions. Fixes bug 31338;
      bugfix on 0.4.2.1-alpha.
  o Minor bugfixes (controller protocol):
    - Fix the MAPADDRESS controller command to accept one or more
      arguments. Previously, it required two or more arguments, and
      ignored the first. Fixes bug 31772; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (logging):
    - Add a missing check for HAVE_PTHREAD_H, because the backtrace code
      uses mutexes. Fixes bug 31614; bugfix on 0.2.5.2-alpha.
    - Disable backtrace signal handlers when shutting down tor. Fixes
      bug 31614; bugfix on 0.2.5.2-alpha.
    - Rate-limit our the logging message about the obsolete .exit
      notation. Previously, there was no limit on this warning, which
      could potentially be triggered many times by a hostile website.
      Fixes bug 31466; bugfix on 0.2.2.1-alpha.
    - When initialising log domain masks, only set known log domains.
      Fixes bug 31854; bugfix on 0.2.1.1-alpha.
  o Minor bugfixes (logging, protocol violations):
    - Do not log a nonfatal assertion failure when receiving a VERSIONS
      cell on a connection using the obsolete v1 link protocol. Log a
      protocol_warn instead. Fixes bug 31107; bugfix on 0.2.4.4-alpha.
  o Minor bugfixes (modules):
    - Explain what the optional Directory Authority module is, and what
      happens when it is disabled. Fixes bug 31825; bugfix
      on 0.3.4.1-alpha.
  o Minor bugfixes (multithreading):
    - Avoid some undefined behaviour when freeing mutexes. Fixes bug
      31736; bugfix on 0.0.7.
  o Minor bugfixes (relay):
    - Avoid crashing when starting with a corrupt keys directory where
      the old ntor key and the new ntor key are identical. Fixes bug
      30916; bugfix on 0.2.4.8-alpha.
  o Minor bugfixes (tests, SunOS):
    - Avoid a map_anon_nofork test failure due to a signed/unsigned
      integer comparison. Fixes bug 31897; bugfix on 0.4.1.1-alpha.
  o Code simplification and refactoring:
    - Refactor connection_control_process_inbuf() to reduce the size of
      a practracker exception. Closes ticket 31840.
    - Refactor the microdescs_parse_from_string() function into smaller
      pieces, for better comprehensibility. Closes ticket 31675.
    - Use SEVERITY_MASK_IDX() to find the LOG_* mask indexes in the unit
      tests and fuzzers, rather than using hard-coded values. Closes
      ticket 31334.
    - Interface for function `decrypt_desc_layer` cleaned up. Closes
      ticket 31589.
  o Documentation:
    - Document the signal-safe logging behaviour in the tor man page.
      Also add some comments to the relevant functions. Closes
      ticket 31839.
    - Explain why we can't destroy the backtrace buffer mutex. Explain
      why we don't need to destroy the log mutex. Closes ticket 31736.
    - The Tor source code repository now includes a (somewhat dated)
      description of Tor's modular architecture, in doc/HACKING/design.
      This is based on the old "tor-guts.git" repository, which we are
      adopting and superseding. Closes ticket 31849.

@_date: 2019-10-24 16:04:14
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.2.3-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely in a
couple of weeks.
Here's what's new:
Changes in version 0.4.2.3-alpha - 2019-10-24
  This release fixes several bugs from the previous alpha release, and
  from earlier versions of Tor.
  o Major bugfixes (relay):
    - Relays now respect their AccountingMax bandwidth again. When
      relays entered "soft" hibernation (which typically starts when
      we've hit 90% of our AccountingMax), we had stopped checking
      whether we should enter hard hibernation. Soft hibernation refuses
      new connections and new circuits, but the existing circuits can
      continue, meaning that relays could have exceeded their configured
      AccountingMax. Fixes bug 32108; bugfix on 0.4.0.1-alpha.
  o Major bugfixes (v3 onion services):
    - Onion services now always use the exact number of intro points
      configured with the HiddenServiceNumIntroductionPoints option (or
      fewer if nodes are excluded). Before, a service could sometimes
      pick more intro points than configured. Fixes bug 31548; bugfix
      on 0.3.2.1-alpha.
  o Minor feature (onion services, control port):
    - The ADD_ONION command's keyword "BEST" now defaults to ED25519-V3
      (v3) onion services. Previously it defaulted to RSA1024 (v2).
      Closes ticket 29669.
  o Minor features (testing):
    - When running tests that attempt to look up hostnames, replace the
      libc name lookup functions with ones that do not actually touch
      the network. This way, the tests complete more quickly in the
      presence of a slow or missing DNS resolver. Closes ticket 31841.
  o Minor features (testing, continuous integration):
    - Disable all but one Travis CI macOS build, to mitigate slow
      scheduling of Travis macOS jobs. Closes ticket 32177.
    - Run the chutney IPv6 networks as part of Travis CI. Closes
      ticket 30860.
    - Simplify the Travis CI build matrix, and optimise for build time.
      Closes ticket 31859.
    - Use Windows Server 2019 instead of Windows Server 2016 in our
      Appveyor builds. Closes ticket 32086.
  o Minor bugfixes (build system):
    - Interpret "--disable-module-dirauth=no" correctly. Fixes bug
      32124; bugfix on 0.3.4.1-alpha.
    - Interpret "--with-tcmalloc=no" correctly. Fixes bug 32124; bugfix
      on 0.2.0.20-rc.
    - Stop failing when jemalloc is requested, but tcmalloc is not
      found. Fixes bug 32124; bugfix on 0.3.5.1-alpha.
    - When pkg-config is not installed, or a library that depends on
      pkg-config is not found, tell the user what to do to fix the
      problem. Fixes bug 31922; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (connections):
    - Avoid trying to read data from closed connections, which can cause
      needless loops in Libevent and infinite loops in Shadow. Fixes bug
      30344; bugfix on 0.1.1.1-alpha.
  o Minor bugfixes (error handling):
    - Always lock the backtrace buffer before it is used. Fixes bug
      31734; bugfix on 0.2.5.3-alpha.
  o Minor bugfixes (mainloop, periodic events, in-process API):
    - Reset the periodic events' "enabled" flag when Tor is shut down
      cleanly. Previously, this flag was left on, which caused periodic
      events not to be re-enabled when Tor was relaunched in-process
      with tor_api.h after a shutdown. Fixes bug 32058; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (process management):
    - Remove overly strict assertions that triggered when a pluggable
      transport failed to launch. Fixes bug 31091; bugfix
      on 0.4.0.1-alpha.
    - Remove an assertion in the Unix process backend. This assertion
      would trigger when we failed to find the executable for a child
      process. Fixes bug 31810; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (testing):
    - Avoid intermittent test failures due to a test that had relied on
      inconsistent timing sources. Fixes bug 31995; bugfix
      on 0.3.1.3-alpha.
    - When testing port rebinding, don't busy-wait for tor to log.
      Instead, actually sleep for a short time before polling again.
      Also improve the formatting of control commands and log messages.
      Fixes bug 31837; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (tls, logging):
    - Log bugs about the TLS read buffer's length only once, rather than
      filling the logs with similar warnings. Fixes bug 31939; bugfix
      on 0.3.0.4-rc.
  o Minor bugfixes (v3 onion services):
    - Fix an implicit conversion from ssize_t to size_t discovered by
      Coverity. Fixes bug 31682; bugfix on 0.4.2.1-alpha.
    - Fix a memory leak in an unlikely error code path when encoding HS
      DoS establish intro extension cell. Fixes bug 32063; bugfix
      on 0.4.2.1-alpha.
    - When cleaning up intro circuits for a v3 onion service, don't
      remove circuits that have an established or pending circuit, even
      if they ran out of retries. This way, we don't remove a circuit on
      its last retry. Fixes bug 31652; bugfix on 0.3.2.1-alpha.
  o Documentation:
    - Correct the description of "GuardLifetime". Fixes bug 31189;
      bugfix on 0.3.0.1-alpha.
    - Make clear in the man page, in both the bandwidth section and the
      AccountingMax section, that Tor counts in powers of two, not
      powers of ten: 1 GByte is 1024*1024*1024 bytes, not one billion
      bytes. Resolves ticket 32106.

@_date: 2019-09-17 11:04:22
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.2.1-alpha is released! 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place at
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the next couple of weeks.
Here's what's new:
Changes in version 0.4.2.1-alpha - 2019-09-17
  This is the first alpha release in the 0.4.2.x series. It adds new
  defenses for denial-of-service attacks against onion services. It also
  includes numerous kinds of bugfixes and refactoring to help improve
  Tor's stability and ease of development.
  o Major features (onion service v3, denial of service):
    - Add onion service introduction denial of service defenses. Intro
      points can now rate-limit client introduction requests, using
      parameters that can be sent by the service within the
      ESTABLISH_INTRO cell. If the cell extension for this is not used,
      the intro point will honor the consensus parameters. Closes
      ticket 30924.
  o Major bugfixes (circuit build, guard):
    - When considering upgrading circuits from "waiting for guard" to
      "open", always ignore circuits that are marked for close.
      Previously we could end up in the situation where a subsystem is
      notified of a circuit opening, but the circuit is still marked for
      close, leading to undesirable behavior. Fixes bug 30871; bugfix
      on 0.3.0.1-alpha.
  o Major bugfixes (crash, Linux, Android):
    - Tolerate systems (including some Android installations) where
      madvise and MADV_DONTDUMP are available at build-time, but not at
      run time. Previously, these systems would notice a failed syscall
      and abort. Fixes bug 31570; bugfix on 0.4.1.1-alpha.
    - Tolerate systems (including some Linux installations) where
      madvise and/or MADV_DONTFORK are available at build-time, but not
      at run time. Previously, these systems would notice a failed
      syscall and abort. Fixes bug 31696; bugfix on 0.4.1.1-alpha.
  o Minor features (best practices tracker):
    - Our best-practices tracker now integrates with our include-checker
      tool to keep track of how many layering violations we have not yet
      fixed. We hope to reduce this number over time to improve Tor's
      modularity. Closes ticket 31176.
    - Add a TOR_PRACTRACKER_OPTIONS variable for passing arguments to
      practracker from the environment. We may want this for continuous
      integration. Closes ticket 31309.
    - Give a warning rather than an error when a practracker exception
      is violated by a small amount, add a --list-overbroad option to
      practracker that lists exceptions that are stricter than they need
      to be, and provide an environment variable for disabling
      practracker. Closes ticket 30752.
    - Our best-practices tracker now looks at headers as well as C
      files. Closes ticket 31175.
  o Minor features (build system):
    - Add --disable-manpage and --disable-html-manual options to
      configure script. This will enable shortening build times by not
      building documentation. Resolves issue 19381.
  o Minor features (compilation):
    - Log a more useful error message when we are compiling and one of
      the compile-time hardening options we have selected can be linked
      but not executed. Closes ticket 27530.
  o Minor features (configuration):
    - The configuration code has been extended to allow splitting
      configuration data across multiple objects. Previously, all
      configuration data needed to be kept in a single object, which
      tended to become bloated. Closes ticket 31240.
  o Minor features (continuous integration):
    - When running CI builds on Travis, put some random data in
      ~/.torrc, to make sure no tests are reading the Tor configuration
      file from its default location. Resolves issue 30102.
  o Minor features (debugging):
    - Log a nonfatal assertion failure if we encounter a configuration
      line whose command is "CLEAR" but which has a nonempty value. This
      should be impossible, according to the rules of our configuration
      line parsing. Closes ticket 31529.
  o Minor features (git hooks):
    - Our pre-commit git hook now checks for a special file before
      running practracker, so that practracker only runs on branches
      that are based on master. Since the pre-push hook calls the pre-
      commit hook, practracker will also only run before pushes of
      branches based on master. Closes ticket 30979.
  o Minor features (git scripts):
    - Add a "--" command-line argument, to separate git-push-all.sh
      script arguments from arguments that are passed through to git
      push. Closes ticket 31314.
    - Add a -r  argument to git-push-all.sh, so the script
      can push test branches to a personal remote. Closes ticket 31314.
    - Add a -t  argument to git-merge-forward.sh and
      git-push-all.sh, which makes these scripts create, merge forward,
      and push test branches. Closes ticket 31314.
    - Add a -u argument to git-merge-forward.sh, so that the script can
      re-use existing test branches after a merge failure and fix.
      Closes ticket 31314.
    - Add a TOR_GIT_PUSH env var, which sets the default git push
      command and arguments for git-push-all.sh. Closes ticket 31314.
    - Add a TOR_PUSH_DELAY variable to git-push-all.sh, which makes the
      script push master and maint branches with a delay between each
      branch. These delays trigger the CI jobs in a set order, which
      should show the most likely failures first. Also make pushes
      atomic by default, and make the script pass any command-line
      arguments to git push. Closes ticket 29879.
    - Call the shellcheck script from the pre-commit hook. Closes
      ticket 30967.
    - Skip pushing test branches that are the same as a remote
      maint/release/master branch in git-push-all.sh by default. Add a
      -s argument, so git-push-all.sh can push all test branches. Closes
      ticket 31314.
  o Minor features (IPv6, logging):
    - Log IPv6 addresses as well as IPv4 addresses when describing
      routerinfos, routerstatuses, and nodes. Closes ticket 21003.
  o Minor features (onion service v3):
    - Do not allow single hop clients to fetch or post an HS descriptor
      from an HSDir. Closes ticket 24964.
  o Minor features (onion service):
    - Disallow single-hop clients at the introduction point. We've
      removed Tor2web support a while back and single-hop rendezvous
      attempts are blocked at the relays. This change should remove load
      off the network from spammy clients. Close ticket 24963.
  o Minor features (stem tests):
    - Change "make test-stem" so it only runs the stem tests that use
      tor. This change makes test-stem faster and more reliable. Closes
      ticket 31554.
  o Minor features (testing):
    - Add a script to invoke "tor --dump-config" and "tor
      --verify-config" with various configuration options, and see
      whether tor's resulting configuration or error messages are what
      we expect. Use it for integration testing of our +Option and
      /Option flags. Closes ticket 31637.
    - Improve test coverage for our existing configuration parsing and
      management API. Closes ticket 30893.
    - Add integration tests to make sure that practracker gives the
      outputs we expect. Closes ticket 31477.
    - The practracker self-tests are now run as part of the Tor test
      suite. Closes ticket 31304.
  o Minor features (token bucket):
    - Implement a generic token bucket that uses a single counter, for
      use in anti-DoS onion service work. Closes ticket 30687.
  o Minor bugfixes (best practices tracker):
    - Fix a few issues in the best-practices script, including tests,
      tab tolerance, error reporting, and directory-exclusion logic.
      Fixes bug 29746; bugfix on 0.4.1.1-alpha.
    - When running check-best-practices, only consider files in the src
      subdirectory. Previously we had recursively considered all
      subdirectories, which made us get confused by the temporary
      directories made by "make distcheck". Fixes bug 31578; bugfix
      on 0.4.1.1-alpha.
  o Minor bugfixes (build system):
    - Do not include the deprecated  on Linux or Windows
      systems. Fixes bug 31673; bugfix on 0.2.5.4-alpha.
  o Minor bugfixes (chutney, makefiles, documentation):
    - "make test-network-all" now shows the warnings from each test-
      network.sh run on the console, so developers see new warnings
      early. We've also improved the documentation for this feature, and
      renamed a Makefile variable so the code is self-documenting. Fixes
      bug 30455; bugfix on 0.3.0.4-rc.
  o Minor bugfixes (compilation):
    - Add more stub functions to fix compilation on Android with link-
      time optimization when --disable-module-dirauth is used.
      Previously, these compilation settings would make the compiler
      look for functions that didn't exist. Fixes bug 31552; bugfix
      on 0.4.1.1-alpha.
    - Suppress spurious float-conversion warnings from GCC when calling
      floating-point classifier functions on FreeBSD. Fixes part of bug
      31687; bugfix on 0.3.1.5-alpha.
  o Minor bugfixes (configuration):
    - Invalid floating-point values in the configuration file are now
      treated as errors in the configuration. Previously, they were
      ignored and treated as zero. Fixes bug 31475; bugfix on 0.0.1.
  o Minor bugfixes (coverity):
    - Add an assertion when parsing a BEGIN cell so that coverity can be
      sure that we are not about to dereference a NULL address. Fixes
      bug 31026; bugfix on 0.2.4.7-alpha. This is CID 1447296.
    - In our siphash implementation, when building for coverity, use
      memcpy in place of a switch statement, so that coverity can tell
      we are not accessing out-of-bounds memory. Fixes bug 31025; bugfix
      on 0.2.8.1-alpha. This is tracked as CID 1447293 and 1447295.
    - Fix several coverity warnings from our unit tests. Fixes bug
      31030; bugfix on 0.2.4.1-alpha, 0.3.2.1-alpha, and 0.4.0.1-alpha.
  o Minor bugfixes (developer tooling):
    - Only log git script changes in the post-merge script when the
      merge was to the master branch. Fixes bug 31040; bugfix
      on 0.4.1.1-alpha.
  o Minor bugfixes (directory authorities):
    - Return a distinct status when formatting annotations fails. Fixes
      bug 30780; bugfix on 0.2.0.8-alpha.
  o Minor bugfixes (error handling):
    - On abort, try harder to flush the output buffers of log messages.
      On some platforms (macOS), log messages could be discarded when
      the process terminates. Fixes bug 31571; bugfix on 0.3.5.1-alpha.
    - Report the tor version whenever an assertion fails. Previously, we
      only reported the Tor version on some crashes, and some non-fatal
      assertions. Fixes bug 31571; bugfix on 0.3.5.1-alpha.
    - When tor aborts due to an error, close log file descriptors before
      aborting. Closing the logs makes some OSes flush log file buffers,
      rather than deleting buffered log lines. Fixes bug 31594; bugfix
      on 0.2.5.2-alpha.
  o Minor bugfixes (FreeBSD, PF-based proxy, IPv6):
    - When extracting an IPv6 address from a PF-based proxy, verify that
      we are actually configured to receive an IPv6 address, and log an
      internal error if not. Fixes part of bug 31687; bugfix
      on 0.2.3.4-alpha.
  o Minor bugfixes (git hooks):
    - Remove a duplicate call to practracker from the pre-push hook. The
      pre-push hook already calls the pre-commit hook, which calls
      practracker. Fixes bug 31462; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (git scripts):
    - Stop hard-coding the bash path in the git scripts. Some OSes don't
      have bash in /usr/bin, others have an ancient bash at this path.
      Fixes bug 30840; bugfix on 0.4.0.1-alpha.
    - Stop hard-coding the tor master branch name and worktree path in
      the git scripts. Fixes bug 30841; bugfix on 0.4.0.1-alpha.
    - Allow git-push-all.sh to be run from any directory. Previously,
      the script only worked if run from an upstream worktree directory.
      Closes ticket 31678.
  o Minor bugfixes (guards):
    - When tor is missing descriptors for some primary entry guards,
      make the log message less alarming. It's normal for descriptors to
      expire, as long as tor fetches new ones soon after. Fixes bug
      31657; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (ipv6):
    - Check for private IPv6 addresses alongside their IPv4 equivalents
      when authorities check descriptors. Previously, we only checked
      for private IPv4 addresses. Fixes bug 31088; bugfix on
      0.2.3.21-rc. Patch by Neel Chauhan.
    - When parsing microdescriptors, we should check the IPv6 exit
      policy alongside IPv4. Previously, we checked both exit policies
      for only router info structures, while microdescriptors were
      IPv4-only. Fixes bug 27284; bugfix on 0.2.3.1-alpha. Patch by
      Neel Chauhan.
  o Minor bugfixes (logging):
    - Change log level of message "Hash of session info was not as
      expected" to LOG_PROTOCOL_WARN. Fixes bug 12399; bugfix
      on 0.1.1.10-alpha.
    - Fix a code issue that would have broken our parsing of log domains
      as soon as we had 33 of them. Fortunately, we still only have 29.
      Fixes bug 31451; bugfix on 0.4.1.4-rc.
  o Minor bugfixes (memory management):
    - Stop leaking a small amount of memory in nt_service_install(), in
      unreachable code. Fixes bug 30799; bugfix on 0.2.0.7-alpha. Patch
      by Xiaoyin Liu.
  o Minor bugfixes (networking, IP addresses):
    - When parsing addresses via Tor's internal DNS lookup API, reject
      IPv4 addresses in square brackets, and accept IPv6 addresses in
      square brackets. This change completes the work started in 23082,
      making address parsing consistent between tor's internal DNS
      lookup and address parsing APIs. Fixes bug 30721; bugfix
      on 0.2.1.5-alpha.
    - When parsing addresses via Tor's internal address:port parsing and
      DNS lookup APIs, require IPv6 addresses with ports to have square
      brackets. But allow IPv6 addresses without ports, whether or not
      they have square brackets. Fixes bug 30721; bugfix
      on 0.2.1.5-alpha.
  o Minor bugfixes (onion service v3):
    - When purging the client descriptor cache, close any introduction
      point circuits associated with purged cache entries. This avoids
      picking those circuits later when connecting to the same
      introduction points. Fixes bug 30921; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (onion services):
    - In the hs_ident_circuit_t data structure, remove the unused field
      circuit_type and the respective argument in hs_ident_circuit_new().
      This field was set by clients (for introduction) and services (for
      introduction and rendezvous) but was never used afterwards. Fixes
      bug 31490; bugfix on 0.3.2.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (operator tools):
    - Make tor-print-ed-signing-cert(1) print certificate expiration
      date in RFC 1123 and UNIX timestamp formats, to make output
      machine readable. Fixes bug 31012; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (rust):
    - Correctly exclude a redundant rust build job in Travis. Fixes bug
      31463; bugfix on 0.3.5.4-alpha.
    - Raise the minimum rustc version to 1.31.0, as checked by configure
      and CI. Fixes bug 31442; bugfix on 0.3.5.4-alpha.
  o Minor bugfixes (sendme, code structure):
    - Rename the trunnel SENDME file definition from sendme.trunnel to
      sendme_cell.trunnel to avoid having twice sendme.{c|h} in the
      repository. Fixes bug 30769; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (statistics):
    - Stop removing the ed25519 signature if the extra info file is too
      big. If the signature data was removed, but the keyword was kept,
      this could result in an unparseable extra info file. Fixes bug
      30958; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (subsystems):
    - Make the subsystem init order match the subsystem module
      dependencies. Call windows process security APIs as early as
      possible. Initialize logging before network and time, so that
      network and time can use logging. Fixes bug 31615; bugfix
      on 0.4.0.1-alpha.
  o Minor bugfixes (testing):
    - Teach the util/socketpair_ersatz test to work correctly when we
      have no network stack configured. Fixes bug 30804; bugfix
      on 0.2.5.1-alpha.
  o Minor bugfixes (v2 single onion services):
    - Always retry v2 single onion service intro and rend circuits with
      a 3-hop path. Previously, v2 single onion services used a 3-hop
      path when rendezvous circuits were retried after a remote or
      delayed failure, but a 1-hop path for immediate retries. Fixes bug
      23818; bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (v3 single onion services):
    - Always retry v3 single onion service intro and rend circuits with
      a 3-hop path. Previously, v3 single onion services used a 3-hop
      path when rend circuits were retried after a remote or delayed
      failure, but a 1-hop path for immediate retries. Fixes bug 23818;
      bugfix on 0.3.2.1-alpha.
    - Make v3 single onion services fall back to a 3-hop intro, when all
      intro points are unreachable via a 1-hop path. Previously, v3
      single onion services failed when all intro nodes were unreachable
      via a 1-hop path. Fixes bug 23507; bugfix on 0.3.2.1-alpha.
  o Documentation:
    - Improve documentation in circuit padding subsystem. Patch by
      Tobias Pulls. Closes ticket 31113.
    - Include an example usage for IPv6 ORPort in our sample torrc.
      Closes ticket 31320; patch from Ali Raheem.
    - Use RFC 2397 data URL scheme to embed an image into tor-exit-
      notice.html so that operators no longer have to host it
      themselves. Closes ticket 31089.
  o Removed features:
    - No longer include recommended package digests in votes as detailed
      in proposal 301. The RecommendedPackages torrc option is
      deprecated and will no longer have any effect. "package" lines
      will still be considered when computing consensuses for consensus
      methods that include them. (This change has no effect on the list
      of recommended Tor versions, which is still in use.) Closes
      ticket 29738.
    - Remove torctl.in from contrib/dist directory. Resolves
      ticket 30550.
  o Testing:
    - Run shellcheck for all non-third-party shell scripts that are
      shipped with Tor. Closes ticket 29533.
    - When checking shell scripts, ignore any user-created directories.
      Closes ticket 30967.
  o Code simplification and refactoring (config handling):
    - Extract our variable manipulation code from confparse.c to a new
      lower-level typedvar.h module. Closes ticket 30864.
    - Lower another layer of object management from confparse.c to a
      more general tool. Now typed structure members are accessible via
      an abstract type. Implements ticket 30914.
    - Move our backend logic for working with configuration and state
      files into a lower-level library, since it no longer depends on
      any tor-specific functionality. Closes ticket 31626.
    - Numerous simplifications in configuration-handling logic: remove
      duplicated macro definitions, replace magical names with flags,
      and refactor "TestingTorNetwork" to use the same default-option
      logic as the rest of Tor. Closes ticket 30935.
    - Replace our ad-hoc set of flags for configuration variables and
      configuration variable types with fine-grained orthogonal flags
      corresponding to the actual behavior we want. Closes ticket 31625.
  o Code simplification and refactoring (misc):
    - Eliminate some uses of lower-level control reply abstractions,
      primarily in the onion_helper functions. Closes ticket 30889.
    - Rework bootstrap tracking to use the new publish-subscribe
      subsystem. Closes ticket 29976.
    - Rewrite format_node_description() and router_get_verbose_nickname()
      to use strlcpy() and strlcat(). The previous implementation used
      memcpy() and pointer arithmetic, which was error-prone. Closes
      ticket 31545. This is CID 1452819.
    - Split extrainfo_dump_to_string() into smaller functions. Closes
      ticket 30956.
    - Use the ptrdiff_t type consistently for expressing variable
      offsets and pointer differences. Previously we incorrectly (but
      harmlessly) used int and sometimes off_t for these cases. Closes
      ticket 31532.
    - Use the subsystems mechanism to manage the main event loop code.
      Closes ticket 30806.
    - Various simplifications and minor improvements to the circuit
      padding machines. Patch by Tobias Pulls. Closes tickets 31112
      and 31098.
  o Documentation (hard-coded directories):
    - Improve the documentation for the DirAuthority and FallbackDir
      torrc options. Closes ticket 30955.
  o Documentation (tor.1 man page):
    - Fix typo in tor.1 man page: the option is "--help", not "-help".
      Fixes bug 31008; bugfix on 0.2.2.9-alpha.

@_date: 2020-04-13 16:57:22
@_author: Nick Mathewson 
@_subject: [tor-talk] New release candidate: Tor 0.4.3.4-rc 
There's a Tor release candidate! Unless we find significant bugs in
it, the stable release for 0.4.3.4 will probably be about the same as
this one here.
The source code is available from the usual place on
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely (I believe) later this week.
Here's what's new:
Changes in version 0.4.3.4-rc - 2020-04-13
  Tor 0.4.3.4-rc is the first release candidate in its series. It fixes
  several bugs from earlier versions, including one affecting DoS
  defenses on bridges using pluggable transports.
  o Major bugfixes (DoS defenses, bridges, pluggable transport):
    - Fix a bug that was preventing DoS defenses from running on bridges
      with a pluggable transport. Previously, the DoS subsystem was not
      given the transport name of the client connection, thus failed to
      find the GeoIP cache entry for that client address. Fixes bug
      33491; bugfix on 0.3.3.2-alpha.
  o Minor feature (sendme, flow control):
    - Default to sending SENDME version 1 cells. (Clients are already
      sending these, because of a consensus parameter telling them to do
      so: this change only affects what clients would do if the
      consensus didn't contain a recommendation.) Closes ticket 33623.
  o Minor features (testing):
    - The unit tests now support a "TOR_SKIP_TESTCASES" environment
      variable to specify a list of space-separated test cases that
      should not be executed. We will use this to disable certain tests
      that are failing on Appveyor because of mismatched OpenSSL
      libraries. Part of ticket 33643.
  o Minor bugfixes (--disable-module-relay):
    - Fix an assertion failure when Tor is built without the relay
      module, and then invoked with the "User" option. Fixes bug 33668;
      bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (--disable-module-relay,--disable-module-dirauth):
    - Set some output arguments in the relay and dirauth module stubs,
      to guard against future stub argument handling bugs like 33668.
      Fixes bug 33674; bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (build system):
    - Correctly output the enabled module in the configure summary.
      Before that, the list shown was just plain wrong. Fixes bug 33646;
      bugfix on 0.4.3.2-alpha.
  o Minor bugfixes (client, IPv6):
    - Stop forcing all non-SocksPorts to prefer IPv6 exit connections.
      Instead, prefer IPv6 connections by default, but allow users to
      change their configs using the "NoPreferIPv6" port flag. Fixes bug
      33608; bugfix on 0.4.3.1-alpha.
    - Revert PreferIPv6 set by default on the SocksPort because it broke
      the torsocks use case. Tor doesn't have a way for an application
      to request the hostname to be resolved for a specific IP version,
      but torsocks requires that. Up until now, IPv4 was used by default
      so torsocks is expecting that, and can't handle a possible IPv6
      being returned. Fixes bug 33804; bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (key portability):
    - When reading PEM-encoded key data, tolerate CRLF line-endings even
      if we are not running on Windows. Previously, non-Windows hosts
      would reject these line-endings in certain positions, making
      certain key files hard to move from one host to another. Fixes bug
      33032; bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (logging):
    - Flush stderr, stdout, and file logs during shutdown, if supported
      by the OS. This change helps make sure that any final logs are
      recorded. Fixes bug 33087; bugfix on 0.4.1.6.
    - Stop closing stderr and stdout during shutdown. Closing these file
      descriptors can hide sanitiser logs. Fixes bug 33087; bugfix
      on 0.4.1.6.
  o Minor bugfixes (onion services v3):
    - Relax severity of a log message that can appear naturally when
      decoding onion service descriptors as a relay. Also add some
      diagnostics to debug any future bugs in that area. Fixes bug
      31669; bugfix on 0.3.0.1-alpha.
    - Block a client-side assertion by disallowing the registration of
      an x25519 client auth key that's all zeroes. Fixes bug 33545;
      bugfix on 0.4.3.1-alpha. Based on patch from "cypherpunks".
  o Code simplification and refactoring:
    - Disable our coding standards best practices tracker in our git
      hooks. (0.4.3 branches only.) Closes ticket 33678.
  o Testing:
    - Avoid conflicts between the fake sockets in tor's unit tests, and
      real file descriptors. Resolves issues running unit tests with
      GitHub Actions, where the process that embeds or launches the
      tests has already opened a large number of file descriptors. Fixes
      bug 33782; bugfix on 0.2.8.1-alpha. Found and fixed by
      Putta Khunchalee.
  o Testing (CI):
    - In our Appveyor Windows CI, copy required DLLs to test and app
      directories, before running tor's tests. This ensures that tor.exe
      and test*.exe use the correct version of each DLL. This fix is not
      required, but we hope it will avoid DLL search issues in future.
      Fixes bug 33673; bugfix on 0.3.4.2-alpha.
    - On Appveyor, skip the crypto/openssl_version test, which is
      failing because of a mismatched library installation. Fix
      for 33643.

@_date: 2020-08-10 09:44:44
@_author: Nick Mathewson 
@_subject: [tor-talk] Connection padding set to 1 vs auto 
I don't think it'll have much effect?  The "auto" option means "pad
when padding is negotiated"; the "1" option means "pad even if the
relay doesn't have padding support."  But all currently supported
relay versions ought to have padding support, so there shouldn't be a
difference, in theory.
If I understand correctly (and Mike could correct me here), in its
current form, the ConnectionPadding option helps against ISPs who are
using common flow-logging settings on their internet routers, or
against after-the-fact adversaries who get access to these logs later
on.  It isn't so useful against an adversary who has set up better
logging in advance.
(Mike, did I get this right?)

@_date: 2020-08-13 09:31:10
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.4.4-rc is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the coming weeks.
Here's what's new:
Changes in version 0.4.4.4-rc - 2020-08-13
  Tor 0.4.4.4-rc is the first release candidate in its series. It fixes
  several bugs in previous versions, including some that caused annoying
  behavior for relay and bridge operators.
  o Minor features (security):
    - Channels using obsolete versions of the Tor link protocol are no
      longer allowed to circumvent address-canonicity checks. (This is
      only a minor issue, since such channels have no way to set ed25519
      keys, and therefore should always be rejected for circuits that
      specify ed25519 identities.) Closes ticket 40081.
  o Minor features (defense in depth):
    - Wipe more data from connection address fields before returning
      them to the memory heap. Closes ticket 6198.
  o Minor bugfixes (correctness, buffers):
    - Fix a correctness bug that could cause an assertion failure if we
      ever tried using the buf_move_all() function with an empty input
      buffer. As far as we know, no released versions of Tor do this.
      Fixes bug 40076; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Fix startup crash with seccomp sandbox enabled when tor tries to
      open the data directory. Patch from Daniel Pinto. Fixes bug 40072;
      bugfix on 0.4.4.3-alpha-dev.
  o Minor bugfixes (onion service v3):
    - Remove a BUG() warning that could trigger in certain unlikely
      edge-cases. Fixes bug 34086; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (rate limiting, bridges, pluggable transports):
    - On a bridge, treat all connections from an ExtORPort as remote by
      default for the purposes of rate-limiting. Previously, bridges
      would treat the connection as local unless they explicitly
      received a "USERADDR" command. ExtORPort connections still count
      as local if there is a USERADDR command with an explicit local
      address. Fixes bug 33747; bugfix on 0.2.5.1-alpha.
  o Minor bugfixes (relay, self-testing):
    - When starting up as a relay, if we haven't been able to verify
      that we're reachable, only launch reachability tests at most once
      a minute. Previously, we had been launching tests up to once a
      second, which was needlessly noisy. Fixes bug 40083; bugfix
      on 0.2.8.1-alpha.
  o Minor bugfixes (testing):
    - When running the subsystem order check, use the Python binary
      configured with the PYTHON environment variable. Fixes bug 40095;
      bugfix on 0.4.4.1-alpha.
  o Minor bugfixes (windows):
    - Fix a bug that prevented Tor from starting if its log file grew
      above 2GB. Fixes bug 31036; bugfix on 0.2.1.8-alpha.

@_date: 2020-02-10 19:36:14
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: Tor 0.4.3.2-alpha 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 . If you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely in the coming week.
Here's what's new:
Changes in version 0.4.3.2-alpha - 2020-02-10
  This is the second stable alpha release in the Tor 0.4.3.x series. It
  fixes several bugs present in the previous alpha release. Anybody
  running the previous alpha should upgrade, and look for bugs in this
  one instead.
  o Major bugfixes (onion service client, authorization):
    - On a NEWNYM signal, purge entries from the ephemeral client
      authorization cache. The permanent ones are kept. Fixes bug 33139;
      bugfix on 0.4.3.1-alpha.
  o Minor features (best practices tracker):
    - Practracker now supports a --regen-overbroad option to regenerate
      the exceptions file, but only to revise exceptions to be _less_
      tolerant of best-practices violations. Closes ticket 32372.
  o Minor features (continuous integration):
    - Run Doxygen Makefile target on Travis, so we can learn about
      regressions in our internal documentation. Closes ticket 32455.
    - Stop allowing failures on the Travis CI stem tests job. It looks
      like all the stem hangs we were seeing before are now fixed.
      Closes ticket 33075.
  o Minor bugfixes (build system):
    - Revise configure options that were either missing or incorrect in
      the configure summary. Fixes bug 32230; bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (controller protocol):
    - Fix a memory leak introduced by refactoring of control reply
      formatting code. Fixes bug 33039; bugfix on 0.4.3.1-alpha.
    - Fix a memory leak in GETINFO responses. Fixes bug 33103; bugfix
      on 0.4.3.1-alpha.
    - When receiving "ACTIVE" or "DORMANT" signals on the control port,
      report them as SIGNAL events. Previously we would log a bug
      warning. Fixes bug 33104; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (logging):
    - If we encounter a bug when flushing a buffer to a TLS connection,
      only log the bug once per invocation of the Tor process.
      Previously we would log with every occurrence, which could cause
      us to run out of disk space. Fixes bug 33093; bugfix
      on 0.3.2.2-alpha.
    - When logging a bug, do not say "Future instances of this warning
      will be silenced" unless we are actually going to silence them.
      Previously we would say this whenever a BUG() check failed in the
      code. Fixes bug 33095; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (onion service v2):
    - Move a series of v2 onion service warnings to protocol-warning
      level because they can all be triggered remotely by a malformed
      request. Fixes bug 32706; bugfix on 0.1.1.14-alpha.
  o Minor bugfixes (onion service v3, client authorization):
    - When removing client authorization credentials using the control
      port, also remove the associated descriptor, so the onion service
      can no longer be contacted. Fixes bug 33148; bugfix
      on 0.4.3.1-alpha.
  o Minor bugfixes (pluggable transports):
    - When receiving a message on standard error from a pluggable
      transport, log it at info level, rather than as a warning. Fixes
      bug 33005; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (rust, build):
    - Fix a syntax warning given by newer versions of Rust that was
      creating problems for our continuous integration. Fixes bug 33212;
      bugfix on 0.3.5.1-alpha.
  o Minor bugfixes (TLS bug handling):
    - When encountering a bug in buf_read_from_tls(), return a "MISC"
      error code rather than "WANTWRITE". This change might help avoid
      some CPU-wasting loops if the bug is ever triggered. Bug reported
      by opara. Fixes bug 32673; bugfix on 0.3.0.4-alpha.
  o Code simplification and refactoring (mainloop):
    - Simplify the ip_address_changed() function by removing redundant
      checks. Closes ticket 33091.
  o Documentation (manpage):
    - Split "Circuit Timeout" options and "Node Selection" options into
      their own sections of the tor manpage. Closes tickets 32928 and
      32929. Work by Swati Thacker as part of Google Season of Docs.

@_date: 2020-01-22 20:44:29
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.3.1-alpha is released! 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely by mid-February.
Here's what's new:
Changes in version 0.4.3.1-alpha - 2020-01-22
  This is the first alpha release in the 0.4.3.x series. It includes
  improved support for application integration of onion services, support
  for building in a client-only mode, and newly improved internal
  documentation (online at  It
  also has numerous other small bugfixes and features, as well as
  improvements to our code's internal organization that should help us
  write better code in the future.
  o New system requirements:
    - When building Tor, you now need to have Python 3 in order to run
      the integration tests. (Python 2 is officially unsupported
      upstream, as of 1 Jan 2020.) Closes ticket 32608.
  o Major features (build system):
    - The relay code can now be disabled using the --disable-module-relay
      configure option. When this option is set, we also disable the
      dirauth module. Closes ticket 32123.
    - When Tor is compiled --disable-module-relay, we also omit the code
      used to act as a directory cache. Closes ticket 32487.
  o Major features (directory authority, ed25519):
    - Add support for banning a relay's ed25519 keys in the approved-
      routers file. This will help us migrate away from RSA keys in the
      future. Previously, only RSA keys could be banned in approved-
      routers. Resolves ticket 22029. Patch by Neel Chauhan.
  o Major features (onion service, controller):
    - New control port commands to manage client-side onion service
      authorization credentials. The ONION_CLIENT_AUTH_ADD command adds
      a credential, ONION_CLIENT_AUTH_REMOVE deletes a credential, and
      ONION_CLIENT_AUTH_VIEW lists the credentials. Closes ticket 30381.
  o Major features (onion service, SOCKS5):
    - Introduce a new SocksPort flag, ExtendedErrors, to support more
      detailed error codes in information for applications that support
      them. Closes ticket 30382; implements proposal 304.
  o Major features (proxy):
    - In addition to its current supported proxy types (HTTP CONNECT,
      SOCKS4, and SOCKS5), Tor can now make its OR connections through a
      HAProxy server. A new torrc option was added to specify the
      address/port of the server: TCPProxy  :.
      Currently the only supported protocol for the option is haproxy.
      Closes ticket 31518. Patch done by Suphanat Chunhapanya (haxxpop).
  o Major bugfixes (linux seccomp sandbox):
    - Correct how we use libseccomp. Particularly, stop assuming that
      rules are applied in a particular order or that more rules are
      processed after the first match. Neither is the case! In
      libseccomp <2.4.0 this lead to some rules having no effect.
      libseccomp 2.4.0 changed how rules are generated, leading to a
      different ordering, which in turn led to a fatal crash during
      startup. Fixes bug 29819; bugfix on 0.2.5.1-alpha. Patch by
      Peter Gerber.
    - Fix crash when reloading logging configuration while the
      experimental sandbox is enabled. Fixes bug 32841; bugfix on
      0.4.1.7. Patch by Peter Gerber.
  o Major bugfixes (networking):
    - Correctly handle IPv6 addresses in SOCKS5 RESOLVE_PTR requests,
      and accept strings as well as binary addresses. Fixes bug 32315;
      bugfix on 0.3.5.1-alpha.
  o Major bugfixes (onion service):
    - Report HS circuit failure back into the HS subsystem so we take
      appropriate action with regards to the client introduction point
      failure cache. This improves reachability of onion services, since
      now clients notice failing introduction circuits properly. Fixes
      bug 32020; bugfix on 0.3.2.1-alpha.
  o Minor feature (configure, build system):
    - Output a list of enabled/disabled features at the end of the
      configure process in a pleasing way. Closes ticket 31373.
  o Minor feature (heartbeat, onion service):
    - Add the DoS INTRODUCE2 defenses counter to the heartbeat DoS
      message. Closes ticket 31371.
  o Minor features (configuration validation):
    - Configuration validation can now be done by per-module callbacks,
      rather than a global validation function. This will let us reduce
      the size of config.c and some of its more cumbersome functions.
      Closes ticket 31241.
  o Minor features (configuration):
    - If a configured hardware crypto accelerator in AccelName is
      prefixed with "!", Tor now exits when it cannot be found. Closes
      ticket 32406.
    - We now use flag-driven logic to warn about obsolete configuration
      fields, so that we can include their names. In 0.4.2, we used a
      special type, which prevented us from generating good warnings.
      Implements ticket 32404.
  o Minor features (controller):
    - Add stream isolation data to STREAM event. Closes ticket 19859.
    - Implement a new GETINFO command to fetch microdescriptor
      consensus. Closes ticket 31684.
  o Minor features (debugging, directory system):
    - Don't crash when we find a non-guard with a guard-fraction value
      set. Instead, log a bug warning, in an attempt to figure out how
      this happened. Diagnostic for ticket 32868.
  o Minor features (defense in depth):
    - Add additional checks around tor_vasprintf() usage, in case the
      function returns an error. Patch by Tobias Stoeckmann. Fixes
      ticket 31147.
  o Minor features (developer tooling):
    - Remove the 0.2.9.x series branches from git scripts (git-merge-
      forward.sh, git-pull-all.sh, git-push-all.sh, git-setup-dirs.sh).
      Closes ticket 32772.
  o Minor features (developer tools):
    - Add a check_cocci_parse.sh script that checks that new code is
      parseable by Coccinelle. Add an exceptions file for unparseable
      files, and run the script from travis CI. Closes ticket 31919.
    - Call the check_cocci_parse.sh script from a 'check-cocci' Makefile
      target. Closes ticket 31919.
    - Add a rename_c_identifiers.py tool to rename a bunch of C
      identifiers at once, and generate a well-formed commit message
      describing the change. This should help with refactoring. Closes
      ticket 32237.
    - Add some scripts in "scripts/coccinelle" to invoke the Coccinelle
      semantic patching tool with the correct flags. These flags are
      fairly easy to forget, and these scripts should help us use
      Coccinelle more effectively in the future. Closes ticket 31705.
  o Minor features (Doxygen):
    - Update Doxygen configuration file to a more recent template (from
      1.8.15). Closes ticket 32110.
    - "make doxygen" now works with out-of-tree builds. Closes
      ticket 32113.
    - Make sure that doxygen outputs documentation for all of our C
      files. Previously, some were missing  declarations, causing
      them to be ignored. Closes ticket 32307.
    - Our "make doxygen" target now respects --enable-fatal-warnings by
      default, and does not warn about items that are missing
      documentation. To warn about missing documentation, run configure
      with the "--enable-missing-doc-warnings" flag: doing so suspends
      fatal warnings for doxygen. Closes ticket 32385.
  o Minor features (git scripts):
    - Add TOR_EXTRA_CLONE_ARGS to git-setup-dirs.sh for git clone
      customisation. Closes ticket 32347.
    - Add git-setup-dirs.sh, which sets up an upstream git repository
      and worktrees for tor maintainers. Closes ticket 29603.
    - Add TOR_EXTRA_REMOTE_* to git-setup-dirs.sh for a custom extra
      remote. Closes ticket 32347.
    - Call the check_cocci_parse.sh script from the git commit and push
      hooks. Closes ticket 31919.
    - Make git-push-all.sh skip unchanged branches when pushing to
      upstream. The script already skipped unchanged test branches.
      Closes ticket 32216.
    - Make git-setup-dirs.sh create a master symlink in the worktree
      directory. Closes ticket 32347.
    - Skip unmodified source files when doing some existing git hook
      checks. Related to ticket 31919.
  o Minor features (IPv6, client):
    - Make Tor clients tell dual-stack exits that they prefer IPv6
      connections. This change is equivalent to setting the PreferIPv6
      flag on SOCKSPorts (and most other listener ports). Tor Browser
      has been setting this flag for some time, and we want to remove a
      client distinguisher at exits. Closes ticket 32637.
  o Minor features (portability, android):
    - When building for Android, disable some tests that depend on $HOME
      and/or pwdb, which Android doesn't have. Closes ticket 32825.
      Patch from Hans-Christoph Steiner.
  o Minor features (relay modularity):
    - Split the relay and server pluggable transport config code into
      separate files in the relay module. Disable this code when the
      relay module is disabled. Closes part of ticket 32213.
    - When the relay module is disabled, reject attempts to set the
      ORPort, DirPort, DirCache, BridgeRelay, ExtORPort, or
      ServerTransport* options, rather than ignoring the values of these
      options. Closes part of ticket 32213.
  o Minor features (relay):
    - When the relay module is disabled, change the default config so
      that DirCache is 0, and ClientOnly is 1. Closes ticket 32410.
  o Minor features (release tools):
    - Port our ChangeLog formatting and sorting tools to Python 3.
      Closes ticket 32704.
  o Minor features (testing):
    - Detect some common failure cases for test_parseconf.sh in
      src/test/conf_failures. Closes ticket 32451.
    - Allow test_parseconf.sh to test expected log outputs for successful
      configs, as well as failed configs. Closes ticket 32451.
    - The test_parseconf.sh script now supports result variants for any
      combination of the optional libraries lzma, nss, and zstd. Closes
      ticket 32397.
  o Minor features (tests, Android):
    - When running the unit tests on Android, create temporary files in
      a subdirectory of /data/local/tmp. Closes ticket 32172. Based on a
      patch from Hans-Christoph Steiner.
  o Minor bugfixes (bridges):
    - Lowercase the configured value of BridgeDistribution before adding
      it to the descriptor. Fixes bug 32753; bugfix on 0.3.2.3-alpha.
  o Minor bugfixes (build system):
    - Fix "make autostyle" for out-of-tree builds. Fixes bug 32370;
      bugfix on 0.4.1.2-alpha.
  o Minor bugfixes (configuration handling):
    - Make control_event_conf_changed() take in a config_line_t instead
      of a smartlist of alternating key/value entries. Fixes bug 31531;
      bugfix on 0.2.3.3-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (configuration):
    - Check for multiplication overflow when parsing memory units inside
      configuration. Fixes bug 30920; bugfix on 0.0.9rc1.
    - When dumping the configuration, stop adding a trailing space after
      the option name when there is no option value. This issue only
      affects options that accept an empty value or list. (Most options
      reject empty values, or delete the entire line from the dumped
      options.) Fixes bug 32352; bugfix on 0.0.9pre6.
    - Avoid changing the user's value of HardwareAccel as stored by
      SAVECONF, when AccelName is set but HardwareAccel is not. Fixes
      bug 32382; bugfix on 0.2.2.1-alpha.
    - When creating a KeyDirectory with the same location as the
      DataDirectory (not recommended), respect the DataDirectory's
      group-readable setting if one has not been set for the
      KeyDirectory. Fixes bug 27992; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (controller):
    - In routerstatus_has_changed(), check all the fields that are
      output over the control port. Fixes bug 20218; bugfix
      on 0.1.1.11-alpha
  o Minor bugfixes (correctness checks):
    - Use GCC/Clang's printf-checking feature to make sure that
      tor_assertf() arguments are correctly typed. Fixes bug 32765;
      bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (developer tools):
    - Allow paths starting with ./ in scripts/add_c_file.py. Fixes bug
      31336; bugfix on 0.4.1.2-alpha.
  o Minor bugfixes (dirauth module):
    - Split the dirauth config code into a separate file in the dirauth
      module. Disable this code when the dirauth module is disabled.
      Closes ticket 32213.
    - When the dirauth module is disabled, reject attempts to set the
      AuthoritativeDir option, rather than ignoring the value of the
      option. Fixes bug 32213; bugfix on 0.3.4.1-alpha.
  o Minor bugfixes (embedded Tor):
    - When starting Tor any time after the first time in a process,
      register the thread in which it is running as the main thread.
      Previously, we only did this on Windows, which could lead to bugs
      like 23081 on non-Windows platforms. Fixes bug 32884; bugfix
      on 0.3.3.1-alpha.
  o Minor bugfixes (git scripts):
    - Avoid sleeping before the last push in git-push-all.sh. Closes
      ticket 32216.
    - Forward all unrecognised arguments in git-push-all.sh to git push.
      Closes ticket 32216.
  o Minor bugfixes (hidden service v3):
    - Do not rely on a "circuit established" flag for intro circuits but
      instead always query the HS circuit map. This is to avoid sync
      issue with that flag and the map. Fixes bug 32094; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (logging, crash):
    - Avoid a possible crash when trying to log a (fatal) assertion
      failure about mismatched magic numbers in configuration objects.
      Fixes bug 32771; bugfix on 0.4.2.1-alpha.
  o Minor bugfixes (onion service v2):
    - When sending the INTRO cell for a v2 Onion Service, look at the
      failure cache alongside timeout values to check if the intro point
      is marked as failed. Previously, we only looked at the relay
      timeout values. Fixes bug 25568; bugfix on 0.2.7.3-rc. Patch by
      Neel Chauhan.
  o Minor bugfixes (onion services v3, client):
    - Properly handle the client rendezvous circuit timeout. Previously
      Tor would sometimes timeout a rendezvous circuit awaiting the
      introduction ACK, and find itself unable to re-establish all
      circuits because the rendezvous circuit timed out too early. Fixes
      bug 32021; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (onion services):
    - In cancel_descriptor_fetches(), use
      connection_list_by_type_purpose() instead of
      connection_list_by_type_state(). Fixes bug 32639; bugfix on
      0.3.2.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (scripts):
    - Fix update_versions.py for out-of-tree builds. Fixes bug 32371;
      bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (test):
    - Use the same code to find the tor binary in all of our test
      scripts. This change makes sure we are always using the coverage
      binary when coverage is enabled. Fixes bug 32368; bugfix
      on 0.2.7.3-rc.
  o Minor bugfixes (testing):
    - Stop ignoring "tor --dump-config" errors in test_parseconf.sh.
      Fixes bug 32468; bugfix on 0.4.2.1-alpha.
    - When TOR_DISABLE_PRACTRACKER is set, do not apply it to the
      test_practracker.sh script. Doing so caused a test failure. Fixes
      bug 32705; bugfix on 0.4.2.1-alpha.
    - When TOR_DISABLE_PRACTRACKER is set, log a notice to stderr when
      skipping practracker checks. Fixes bug 32705; bugfix
      on 0.4.2.1-alpha.
  o Minor bugfixes (tests):
    - Our option-validation tests no longer depend on specially
      configured non-default, non-passing sets of options. Previously,
      the tests had been written to assume that options would _not_ be
      set to their defaults, which led to needless complexity and
      verbosity. Fixes bug 32175; bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (windows service):
    - Initialize the publish/subscribe system when running as a windows
      service. Fixes bug 32778; bugfix on 0.4.1.1-alpha.
  o Deprecated features:
    - Deprecate the ClientAutoIPv6ORPort option. This option was not
      true "Happy Eyeballs", and often failed on connections that
      weren't reliably dual-stack. Closes ticket 32942. Patch by
      Neel Chauhan.
  o Documentation:
    - Provide a quickstart guide for a Circuit Padding Framework, and
      documentation for researchers to implement and study circuit
      padding machines. Closes ticket 28804.
    - Add documentation in 'HelpfulTools.md' to describe how to build a
      tag file. Closes ticket 32779.
    - Create a high-level description of the long-term software
      architecture goals. Closes ticket 32206.
    - Describe the --dump-config command in the manual page. Closes
      ticket 32467.
    - Unite coding advice from this_not_that.md in torguts repo into our
      coding standards document. Resolves ticket 31853.
  o Removed features:
    - Our Doxygen configuration no longer generates LaTeX output. The
      reference manual produced by doing this was over 4000 pages long,
      and generally unusable. Closes ticket 32099.
    - The option "TestingEstimatedDescriptorPropagationTime" is now
      marked as obsolete. It has had no effect since 0.3.0.7, when
      clients stopped rejecting consensuses "from the future". Closes
      ticket 32807.
    - We no longer support consensus methods before method 28; these
      methods were only used by authorities running versions of Tor that
      are now at end-of-life. In effect, this means that clients,
      relays, and authorities now assume that authorities will be
      running version 0.3.5.x or later. Closes ticket 32695.
  o Testing:
    - Add more test cases for tor's UTF-8 validation function. Also,
      check the arguments passed to the function for consistency. Closes
      ticket 32845.
    - Improve test coverage for relay and dirauth config code, focusing
      on option validation and normalization. Closes ticket 32213.
    - Improve the consistency of test_parseconf.sh output, and run all
      the tests, even if one fails. Closes ticket 32213.
    - Re-enable the Travis CI macOS Chutney build, but don't let it
      prevent the Travis job from finishing. (The Travis macOS jobs are
      slow, so we don't want to have it delay the whole CI process.)
      Closes ticket 32629.
    - Run the practracker unit tests in the pre-commit git hook. Closes
      ticket 32609.
    - Turn off Tor's Sandbox in Chutney jobs, and run those jobs on
      Ubuntu Bionic. Turning off the Sandbox is a work-around, until we
      fix the sandbox errors in 32722. Closes ticket 32240.
  o Code simplification and refactoring (channel):
    - Channel layer had a variable length cell handler that was not used
      and thus removed. Closes ticket 32892.
  o Code simplification and refactoring (configuration):
    - Immutability is now implemented as a flag on individual
      configuration options rather than as part of the option-transition
      checking code. Closes ticket 32344.
    - Instead of keeping a list of configuration options to check for
      relative paths, check all the options whose type is "FILENAME".
      Solves part of ticket 32339.
    - Our default log (which ordinarily sends NOTICE-level messages to
      standard output) is now handled in a more logical manner.
      Previously, we replaced the configured log options if they were
      empty. Now, we interpret an empty set of log options as meaning
      "use the default log". Closes ticket 31999.
    - Remove some unused arguments from the options_validate() function,
      to simplify our code and tests. Closes ticket 32187.
    - Simplify the options_validate() code so that it looks at the
      default options directly, rather than taking default options as an
      argument. This change lets us simplify its interface. Closes
      ticket 32185.
    - Use our new configuration architecture to move most authority-
      related options to the directory authority module. Closes
      ticket 32806.
    - When parsing the command line, handle options that determine our
      "quiet level" and our mode of operation (e.g., --dump-config and
      so on) all in one table. Closes ticket 32003.
  o Code simplification and refactoring (controller):
    - Create a new abstraction for formatting control protocol reply
      lines based on key-value pairs. Refactor some existing control
      protocol code to take advantage of this. Closes ticket 30984.
    - Create a helper function that can fetch network status or
      microdesc consensuses. Closes ticket 31684.
  o Code simplification and refactoring (dirauth modularization):
    - Remove the last remaining HAVE_MODULE_DIRAUTH inside a function.
      Closes ticket 32163.
    - Replace some confusing identifiers in process_descs.c. Closes
      ticket 29826.
    - Simplify some relay and dirauth config code. Closes ticket 32213.
  o Code simplification and refactoring (misc):
    - Make all the structs we declare follow the same naming convention
      of ending with "_t". Closes ticket 32415.
    - Move and rename some configuration-related code for clarity.
      Closes ticket 32304.
    - Our include.am files are now broken up by subdirectory.
      Previously, src/core/include.am covered all of the subdirectories
      in "core", "feature", and "app". Closes ticket 32137.
    - Remove underused NS*() macros from test code: they make our tests
      more confusing, especially for code-formatting tools. Closes
      ticket 32887.
  o Code simplification and refactoring (relay modularization):
    - Disable relay_periodic when the relay module is disabled. Closes
      ticket 32244.
    - Disable relay_sys when the relay module is disabled. Closes
      ticket 32245.
  o Code simplification and refactoring (tool support):
    - Add numerous missing dependencies to our include files, so that
      they can be included in different reasonable orders and still
      compile. Addresses part of ticket 32764.
    - Fix some parts of our code that were difficult for Coccinelle to
      parse. Related to ticket 31705.
    - Fix some small issues in our code that prevented automatic
      formatting tools from working. Addresses part of ticket 32764.
  o Documentation (manpage):
    - Alphabetize the Client Options section of the tor manpage. Closes
      ticket 32846.
    - Alphabetize the General Options section of the tor manpage. Closes
      ticket 32708.
    - In the tor(1) manpage, reword and improve formatting of the
      COMMAND-LINE OPTIONS and DESCRIPTION sections. Closes ticket
      32277. Based on work by Swati Thacker as part of Google Season
      of Docs.
    - In the tor(1) manpage, reword and improve formatting of the FILES,
      SEE ALSO, and BUGS sections. Closes ticket 32176. Based on work by
      Swati Thacker as part of Google Season of Docs.
  o Testing (circuit, EWMA):
    - Add unit tests for circuitmux and EWMA subsystems. Closes
      ticket 32196.
  o Testing (continuous integration):
    - Use zstd in our Travis Linux builds. Closes ticket 32242.

@_date: 2020-07-09 13:29:07
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: Tor 0.4.4.2-alpha 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the usual place on
 if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely around the end of the month.
This release fixes numerous issues, including a denial-of-service
attack affecting all clients and relays using the NSS library. (If
your Tor is built with OpenSSL, which is the default, you don't need
to worry about this one. But if you're using NSS, you should upgrade.)
There are also new stable releases today: the announcements for them
will go to the tor-announce mailing list as usual.
Here's what's new:
Changes in version 0.4.4.2-alpha - 2020-07-09
  This is the second alpha release in the 0.4.4.x series. It fixes a few
  bugs in the previous release, and solves a few usability,
  compatibility, and portability issues.
  This release also fixes TROVE-2020-001, a medium-severity denial of
  service vulnerability affecting all versions of Tor when compiled with
  the NSS encryption library. (This is not the default configuration.)
  Using this vulnerability, an attacker could cause an affected Tor
  instance to crash remotely. This issue is also tracked as CVE-2020-
  15572. Anybody running a version of Tor built with the NSS library
  should upgrade to 0.3.5.11, 0.4.2.8, 0.4.3.6, or 0.4.4.2-alpha
  or later.
  o Major bugfixes (NSS, security):
    - Fix a crash due to an out-of-bound memory access when Tor is
      compiled with NSS support. Fixes bug 33119; bugfix on
      0.3.5.1-alpha. This issue is also tracked as TROVE-2020-001
      and CVE-2020-15572.
  o Minor features (bootstrap reporting):
    - Report more detailed reasons for bootstrap failure when the
      failure happens due to a TLS error. Previously we would just call
      these errors "MISC" when they happened during read, and "DONE"
      when they happened during any other TLS operation. Closes
      ticket 32622.
  o Minor features (directory authority):
    - Authorities now recommend the protocol versions that are supported
      by Tor 0.3.5 and later. (Earlier versions of Tor have been
      deprecated since January of this year.) This recommendation will
      cause older clients and relays to give a warning on startup, or
      when they download a consensus directory. Closes ticket 32696.
  o Minor features (entry guards):
    - Reinstate support for GUARD NEW/UP/DOWN control port events.
      Closes ticket 40001.
  o Minor features (linux seccomp2 sandbox, portability):
    - Allow Tor to build on platforms where it doesn't know how to
      report which syscall caused the linux seccomp2 sandbox to fail.
      This change should make the sandbox code more portable to less
      common Linux architectures. Closes ticket 34382.
    - Permit the unlinkat() syscall, which some Libc implementations use
      to implement unlink(). Closes ticket 33346.
  o Minor bugfix (CI, Windows):
    - Use the correct 64-bit printf format when compiling with MINGW on
      Appveyor. Fixes bug 40026; bugfix on 0.3.5.5-alpha.
  o Minor bugfix (onion service v3 client):
    - Remove a BUG() warning that could occur naturally. Fixes bug
      34087; bugfix on 0.3.2.1-alpha.
  o Minor bugfix (SOCKS, onion service client):
    - Detect v3 onion service addresses of the wrong length when
      returning the F6 ExtendedErrors code. Fixes bug 33873; bugfix
      on 0.4.3.1-alpha.
  o Minor bugfixes (compiler warnings):
    - Fix a compiler warning on platforms with 32-bit time_t values.
      Fixes bug 40028; bugfix on 0.3.2.8-rc.
  o Minor bugfixes (control port, onion service):
    - Consistently use 'address' in "Invalid v3 address" response to
      ONION_CLIENT_AUTH commands. Previously, we would sometimes say
      'addr'. Fixes bug 40005; bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (logging):
    - Downgrade a noisy log message that could occur naturally when
      receiving an extrainfo document that we no longer want. Fixes bug
      16016; bugfix on 0.2.6.3-alpha.
  o Minor bugfixes (onion services v3):
    - Avoid a non-fatal assertion failure in certain edge-cases when
      opening an intro circuit as a client. Fixes bug 34084; bugfix
      on 0.3.2.1-alpha.
  o Deprecated features (onion service v2):
    - Add a deprecation warning for version 2 onion services. Closes
      ticket 40003.
  o Removed features (IPv6, revert):
    - Revert the change in the default value of ClientPreferIPv6OrPort:
      it breaks the torsocks use case. The SOCKS resolve command has no
      mechanism to ask for a specific address family (v4 or v6), and so
      prioritizing IPv6 when an IPv4 address is requested on the SOCKS
      interface resulted in a failure. Tor Browser explicitly sets
      PreferIPv6, so this should not affect the majority of our users.
      Closes ticket 33796; bugfix on 0.4.4.1-alpha.

@_date: 2020-07-27 19:09:47
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.4.3-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on trac.torproject.org.
The source code is available from the download page at
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely by mid-August.
Here's what's new:
Changes in version 0.4.4.3-alpha - 2020-07-27
  Tor 0.4.4.3-alpha fixes several annoyances in previous versions,
  including one affecting NSS users, and several affecting the Linux
  seccomp2 sandbox.
  o Major features (fallback directory list):
    - Replace the 148 fallback directories originally included in Tor
      0.4.1.4-rc (of which around 105 are still functional) with a list
      of 144 fallbacks generated in July 2020. Closes ticket 40061.
  o Major bugfixes (NSS):
    - When running with NSS enabled, make sure that NSS knows to expect
      nonblocking sockets. Previously, we set our TCP sockets as
      nonblocking, but did not tell NSS, which in turn could lead to
      unexpected blocking behavior. Fixes bug 40035; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (linux seccomp2 sandbox):
    - Fix a regression on sandboxing rules for the openat() syscall. The
      fix for bug 25440 fixed the problem on systems with glibc >= 2.27
      but broke with versions of glibc. We now choose a rule based on
      the glibc version. Patch from Daniel Pinto. Fixes bug 27315;
      bugfix on 0.3.5.11.
    - Makes the seccomp sandbox allow the correct syscall for opendir
      according to the running glibc version. This fixes crashes when
      reloading torrc with sandbox enabled when running on glibc 2.15 to
      2.21 and 2.26. Patch from Daniel Pinto. Fixes bug 40020; bugfix
      on 0.3.5.11.
  o Minor bugfixes (relay, usability):
    - Adjust the rules for when to warn about having too many
      connections to other relays. Previously we'd tolerate up to 1.5
      connections per relay on average. Now we tolerate more connections
      for directory authorities, and raise the number of total
      connections we need to see before we warn. Fixes bug 33880; bugfix
      on 0.3.1.1-alpha.
  o Documentation:
    - Replace most http:// URLs in our code and documentation with
      https:// URLs. (We have left unchanged the code in src/ext/, and
      the text in LICENSE.) Closes ticket 31812. Patch from Jeremy Rand.
  o Removed features:
    - Our "check-local" test target no longer tries to use the
      Coccinelle semantic patching tool parse all the C files. While it
      is a good idea to try to make sure Coccinelle works on our C
      before we run a Coccinelle patch, doing so on every test run has
      proven to be disruptive. You can still run this tool manually with
      "make check-cocci". Closes ticket 40030.

@_date: 2020-06-16 17:52:13
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.4.1-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on the bugtracker (or here, while we're getting the new
bugtracker working).
The source code is available from the download page on
 if you build Tor from source, why not give it a
try? And if you don't build Tor from source, packages should be ready
over the coming days, with a Tor Browser alpha release likely by early
Here's what's new:
Changes in version 0.4.4.1-alpha - 2020-06-16
  This is the first alpha release in the 0.4.4.x series.  It improves
  our guard selection algorithms, improves the amount of code that
  can be disabled when running without relay support, and includes numerous
  small bugfixes and enhancements.  It also lays the ground for some IPv6
  features that we'll be developing more in the next (0.4.5) series.
  Here are the changes since 0.4.3.5.
  o Major features (Proposal 310, performance + security):
    - Implements Proposal 310, "Bandaid on guard selection". Proposal
      310 solves load-balancing issues with older versions of the guard
      selection algorithm, and improves its security. Under this new
      algorithm, a newly selected guard never becomes Primary unless all
      previously sampled guards are unreachable. Implements
      recommendation from 32088. (Proposal 310 is linked to the CLAPS
      project researching optimal client location-aware path selections.
      This project is a collaboration between the UCLouvain Crypto Group,
      the U.S. Naval Research Laboratory, and Princeton University.)
  o Major features (IPv6, relay):
    - Consider IPv6-only EXTEND2 cells valid on relays. Log a protocol
      warning if the IPv4 or IPv6 address is an internal address, and
      internal addresses are not allowed. But continue to use the other
      address, if it is valid. Closes ticket 33817.
    - If a relay can extend over IPv4 and IPv6, and both addresses are
      provided, it chooses between them uniformly at random. Closes
      ticket 33817.
    - Re-use existing IPv6 connections for circuit extends. Closes
      ticket 33817.
    - Relays may extend circuits over IPv6, if the relay has an IPv6
      ORPort, and the client supplies the other relay's IPv6 ORPort in
      the EXTEND2 cell. IPv6 extends will be used by the relay IPv6
      ORPort self-tests in 33222. Closes ticket 33817.
  o Major features (v3 onion services):
    - Allow v3 onion services to act as OnionBalance backend instances,
      by using the HiddenServiceOnionBalanceInstance torrc option.
      Closes ticket 32709.
  o Minor feature (developer tools):
    - Add a script to help check the alphabetical ordering of option
      names in the manual page. Closes ticket 33339.
  o Minor feature (onion service client, SOCKS5):
    - Add 3 new SocksPort ExtendedErrors (F2, F3, F7) that reports back
      new type of onion service connection failures. The semantics of
      these error codes are documented in proposal 309. Closes
      ticket 32542.
  o Minor feature (onion service v3):
    - If a service cannot upload its descriptor(s), log why at INFO
      level. Closes ticket 33400; bugfix on 0.3.2.1-alpha.
  o Minor feature (python scripts):
    - Stop assuming that /usr/bin/python exists. Instead of using a
      hardcoded path in scripts that still use Python 2, use
      /usr/bin/env, similarly to the scripts that use Python 3. Fixes
      bug 33192; bugfix on 0.4.2.
  o Minor features (client-only compilation):
    - Disable more code related to the ext_orport protocol when
      compiling without support for relay mode. Closes ticket 33368.
    - Disable more of our self-testing code when support for relay mode
      is disabled. Closes ticket 33370.
  o Minor features (code safety):
    - Check for failures of tor_inet_ntop() and tor_inet_ntoa()
      functions in DNS and IP address processing code, and adjust
      codepaths to make them less likely to crash entire Tor instances.
      Resolves issue 33788.
  o Minor features (compilation size):
    - Most server-side DNS code is now disabled when building without
      support for relay mode. Closes ticket 33366.
  o Minor features (continuous integration):
    - Run unit-test and integration test (Stem, Chutney) jobs with
      ALL_BUGS_ARE_FATAL macro being enabled on Travis and Appveyor.
      Resolves ticket 32143.
  o Minor features (control port):
    - Return a descriptive error message from the 'GETINFO status/fresh-
      relay-descs' command on the control port. Previously, we returned
      a generic error of "Error generating descriptor". Closes ticket
      32873. Patch by Neel Chauhan.
  o Minor features (developer tooling):
    - Refrain from listing all .a files that are generated by the Tor
      build in .gitignore. Add a single wildcard *.a entry that covers
      all of them for present and future. Closes ticket 33642.
    - Add a script ("git-install-tools.sh") to install git hooks and
      helper scripts. Closes ticket 33451.
  o Minor features (directory authority, shared random):
    - Refactor more authority-only parts of the shared-random scheduling
      code to reside in the dirauth module, and to be disabled when
      compiling with --disable-module-dirauth. Closes ticket 33436.
  o Minor features (directory):
    - Remember the number of bytes we have downloaded for each directory
      purpose while bootstrapping, and while fully bootstrapped. Log
      this information as part of the heartbeat message. Closes
      ticket 32720.
  o Minor features (IPv6 support):
    - Adds IPv6 support to tor_addr_is_valid(). Adds tests for the above
      changes and tor_addr_is_null(). Closes ticket 33679. Patch
      by MrSquanchee.
    - Allow clients and relays to send dual-stack and IPv6-only EXTEND2
      cells. Parse dual-stack and IPv6-only EXTEND2 cells on relays.
      Closes ticket 33901.
  o Minor features (logging):
    - When trying to find our own address, add debug-level logging to
      report the sources of candidate addresses. Closes ticket 32888.
  o Minor features (testing, architecture):
    - Our test scripts now double-check that subsystem initialization
      order is consistent with the inter-module dependencies established
      by our .may_include files. Implements ticket 31634.
    - Initialize all subsystems at the beginning of our unit test
      harness, to avoid crashes due to uninitialized subsystems. Follow-
      up from ticket 33316.
  o Minor features (v3 onion services):
    - Add v3 onion service status to the dumpstats() call which is
      triggered by a SIGUSR1 signal. Previously, we only did v2 onion
      services. Closes ticket 24844. Patch by Neel Chauhan.
  o Minor features (windows):
    - Add support for console control signals like Ctrl+C in Windows.
      Closes ticket 34211. Patch from Damon Harris (TheDcoder).
  o Minor bugfix (onion service v3):
    - Prevent an assert() that would occur when cleaning the client
      descriptor cache, and attempting to close circuits for a non-
      decrypted descriptor (lacking client authorization). Fixes bug
      33458; bugfix on 0.4.2.1-alpha.
  o Minor bugfix (refactoring):
    - Lift circuit_build_times_disabled() out of the
      circuit_expire_building() loop, to save CPU time when there are
      many circuits open. Fixes bug 33977; bugfix on 0.3.5.9.
  o Minor bugfixes (client performance):
    - Resume use of preemptively-built circuits when UseEntryGuards is set
      to 0. We accidentally disabled this feature with that config
      setting, leading to slower load times. Fixes bug 34303; bugfix
      on 0.3.3.2-alpha.
  o Minor bugfixes (directory authorities):
    - Directory authorities now reject votes that arrive too late. In
      particular, once an authority has started fetching missing votes,
      it no longer accepts new votes posted by other authorities. This
      change helps prevent a consensus split, where only some authorities
      have the late vote. Fixes bug 4631; bugfix on 0.2.0.5-alpha.
  o Minor bugfixes (git scripts):
    - Stop executing the checked-out pre-commit hook from the pre-push
      hook. Instead, execute the copy in the user's git directory. Fixes
      bug 33284; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (initialization):
    - Initialize the subsystems in our code in an order more closely
      corresponding to their dependencies, so that every system is
      initialized before the ones that (theoretically) depend on it.
      Fixes bug 33316; bugfix on 0.4.0.1-alpha.
  o Minor bugfixes (IPv4, relay):
    - Check for invalid zero IPv4 addresses and ports when sending and
      receiving extend cells. Fixes bug 33900; bugfix on 0.2.4.8-alpha.
  o Minor bugfixes (IPv6, relay):
    - Consider IPv6 addresses when checking if a connection is
      canonical. In 17604, relays assumed that a remote relay could
      consider an IPv6 connection canonical, but did not set the
      canonical flag on their side of the connection. Fixes bug 33899;
      bugfix on 0.3.1.1-alpha.
    - Log IPv6 addresses on connections where this relay is the
      responder. Previously, responding relays would replace the remote
      IPv6 address with the IPv4 address from the consensus. Fixes bug
      33899; bugfix on 0.3.1.1-alpha.
  o Minor bugfixes (linux seccomp sandbox nss):
    - Fix a startup crash when tor is compiled with --enable-nss and
      sandbox support is enabled. Fixes bug 34130; bugfix on
      0.3.5.1-alpha. Patch by Daniel Pinto.
  o Minor bugfixes (logging, testing):
    - Make all of tor's assertion macros support the ALL_BUGS_ARE_FATAL
      and DISABLE_ASSERTS_IN_UNIT_TESTS debugging modes. (IF_BUG_ONCE()
      used to log a non-fatal warning, regardless of the debugging
      mode.) Fixes bug 33917; bugfix on 0.2.9.1-alpha.
  o Minor bugfixes (logs):
    - Remove surprising empty line in the INFO-level log about circuit
      build timeout. Fixes bug 33531; bugfix on 0.3.3.1-alpha.
  o Minor bugfixes (mainloop):
    - Better guard against growing a buffer past its maximum 2GB in
      size. Fixes bug 33131; bugfix on 0.3.0.4-rc.
  o Minor bugfixes (manual page):
    - Update the man page to reflect that MinUptimeHidServDirectoryV2
      defaults to 96 hours. Fixes bug 34299; bugfix on 0.2.6.3-alpha.
  o Minor bugfixes (onion service v3, client):
    - Remove a BUG() that was causing a stacktrace when a descriptor
      changed at an unexpected time. Fixes bug 28992; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (onion service, logging):
    - Fix a typo in a log message PublishHidServDescriptors is set to 0.
      Fixes bug 33779; bugfix on 0.3.2.1-alpha.
  o Minor bugfixes (portability):
    - Fix a portability error in the configure script, where we were
      using "==" instead of "=". Fixes bug 34233; bugfix on 0.4.3.5.
  o Minor bugfixes (protocol versions):
    - Sort tor's supported protocol version lists, as recommended by the
      tor directory specification. Fixes bug 33285; bugfix
      on 0.4.0.1-alpha.
  o Minor bugfixes (relays):
    - Stop advertising incorrect IPv6 ORPorts in relay and bridge
      descriptors, when the IPv6 port was configured as "auto". Fixes
      bug 32588; bugfix on 0.2.3.9-alpha.
  o Code simplification and refactoring:
    - Define and use a new constant TOR_ADDRPORT_BUF_LEN which is like
      TOR_ADDR_BUF_LEN but includes enough space for an IP address,
      brackets, separating colon, and port number. Closes ticket 33956.
      Patch by Neel Chauhan.
    - Merge the orconn and ocirc events into the "core" subsystem, which
      manages or connections and origin circuits. Previously they were
      isolated in subsystems of their own.
    - Move LOG_PROTOCOL_WARN to app/config. Resolves a dependency
      inversion. Closes ticket 33633.
    - Move the circuit extend code to the relay module. Split the
      circuit extend function into smaller functions. Closes
      ticket 33633.
    - Rewrite port_parse_config() to use the default port flags from
      port_cfg_new(). Closes ticket 32994. Patch by MrSquanchee.
    - Updated comments in 'scheduler.c' to reflect old code changes, and
      simplified the scheduler channel state change code. Closes
      ticket 33349.
  o Documentation:
    - Document the limitations of using %include on config files with
      seccomp sandbox enabled. Fixes documentation bug 34133; bugfix on
      0.3.1.1-alpha. Patch by Daniel Pinto.
    - Fix several doxygen warnings related to imbalanced groups. Closes
      ticket 34255.
  o Removed features:
    - Remove the ClientAutoIPv6ORPort option. This option attempted to
      randomly choose between IPv4 and IPv6 for client connections, and
      wasn't a true implementation of Happy Eyeballs. Often, this option
      failed on IPv4-only or IPv6-only connections. Closes ticket 32905.
      Patch by Neel Chauhan.
    - Stop shipping contrib/dist/rc.subr file, as it is not being used
      on FreeBSD anymore. Closes issue 31576.
  o Testing:
    - Add a basic IPv6 test to "make test-network". This test only runs
      when the local machine has an IPv6 stack. Closes ticket 33300.
    - Add test-network-ipv4 and test-network-ipv6 jobs to the Makefile.
      These jobs run the IPv4-only and dual-stack chutney flavours from
      test-network-all. Closes ticket 33280.
    - Remove a redundant distcheck job. Closes ticket 33194.
    - Run the test-network-ipv6 Makefile target in the Travis CI IPv6
      chutney job. This job runs on macOS, so it's a bit slow. Closes
      ticket 33303.
    - Sort the Travis jobs in order of speed. Putting the slowest jobs
      first takes full advantage of Travis job concurrency. Closes
      ticket 33194.
    - Stop allowing the Chutney IPv6 Travis job to fail. This job was
      previously configured to fast_finish (which requires
      allow_failure), to speed up the build. Closes ticket 33195.
    - Test v3 onion services to tor's mixed IPv4 chutney network. And
      add a mixed IPv6 chutney network. These networks are used in the
      test-network-all, test-network-ipv4, and test-network-ipv6 make
      targets. Closes ticket 33334.
    - Use the "bridges+hs-v23" chutney network flavour in "make test-
      network". This test requires a recent version of chutney (mid-
      February 2020). Closes ticket 28208.
    - When a Travis chutney job fails, use chutney's new "diagnostics.sh"
      tool to produce detailed diagnostic output. Closes ticket 32792.
  o Code simplification and refactoring (onion service):
    - Refactor configuration parsing to use the new config subsystem
      code. Closes ticket 33014.
  o Code simplification and refactoring (relay address):
    - Move a series of functions related to address resolving into their
      own files. Closes ticket 33789.
  o Documentation (manual page):
    - Add cross reference links and a table of contents to the HTML tor
      manual page. Closes ticket 33369. Work by Swati Thacker as part of
      Google Season of Docs.
    - Alphabetize the Denial of Service Mitigation Options, Directory
      Authority Server Options, Hidden Service Options, and Testing
      Network Options sections of the tor(1) manual page. Closes ticket
      33275. Work by Swati Thacker as part of Google Season of Docs.
    - Refrain from mentioning nicknames in manpage section for MyFamily
      torrc option. Resolves issue 33417.
    - Updated the options set by TestingTorNetwork in the manual page.
      Closes ticket 33778.

@_date: 2020-03-16 13:25:57
@_author: Nick Mathewson 
@_subject: [tor-talk] Upcoming Tor security releases to fix a 
Some time this week, we currently plan to put out a set of security
updates for all supported versions of Tor.  These releases will fix a
pair of denial-of-service bugs: one that we are classifying at "low"
severity, and one that we are classifying at "high" severity.
Our recommendation will be for everybody, including relays and
clients, to upgrade once packages are available for their platforms.
Although these vulnerabilities are "only" denial-of-service issues,
any denial-of-service attack against Tor could be leveraged by an
attacker to aid in a traffic analysis attack.
To the best of our knowledge, these vulnerabilities are not being
exploited in the wild.
Currently supported release series are 0.3.5, 0.4.1, 0.4.2, and 0.4.3
(alpha).  If you have not yet upgraded to one of those, the time to do
so is soon.
For our policy and process for handing security issues, please see:
best wishes,

@_date: 2020-03-18 12:28:54
@_author: Nick Mathewson 
@_subject: [tor-talk] New alpha release: 0.4.3.3-alpha (with security fix) 
There's a new alpha release available for download. If you build Tor
from source, you can download the source code for 0.4.3.3-alpha from
the download page on the website. Packages should be available over
the coming days, including  a new alpha Tor Browser release.
Remember, this is an alpha release: you should only run this if you'd
like to find and report more bugs than usual.
(There are also three stable releases coming out today: 0.3.5.10,
0.4.1.9, and 0.4.2.7. Stable releases get announced on the
tor-announce@ mailing list.)
These releases fix a couple of denial-of-service vulnerabilities.
Everybody running an older version should upgrade as packages become
Below is the full changelog for 0.4.3.3-alpha.
Changes in version 0.4.3.3-alpha - 2020-03-18
  Tor 0.4.3.3-alpha fixes several bugs in previous releases, including
  TROVE-2020-002, a major denial-of-service vulnerability that affected
  all released Tor instances since 0.2.1.5-alpha. Using this
  vulnerability, an attacker could cause Tor instances to consume a huge
  amount of CPU, disrupting their operations for several seconds or
  minutes. This attack could be launched by anybody against a relay, or
  by a directory cache against any client that had connected to it. The
  attacker could launch this attack as much as they wanted, thereby
  disrupting service or creating patterns that could aid in traffic
  analysis. This issue was found by OSS-Fuzz, and is also tracked
  as CVE-2020-10592.
  We do not have reason to believe that this attack is currently being
  exploited in the wild, but nonetheless we advise everyone to upgrade
  as soon as packages are available.
  o Major bugfixes (security, denial-of-service):
    - Fix a denial-of-service bug that could be used by anyone to
      consume a bunch of CPU on any Tor relay or authority, or by
      directories to consume a bunch of CPU on clients or hidden
      services. Because of the potential for CPU consumption to
      introduce observable timing patterns, we are treating this as a
      high-severity security issue. Fixes bug 33119; bugfix on
      0.2.1.5-alpha. Found by OSS-Fuzz. We are also tracking this issue
      as TROVE-2020-002 and CVE-2020-10592.
  o Major bugfixes (circuit padding, memory leak):
    - Avoid a remotely triggered memory leak in the case that a circuit
      padding machine is somehow negotiated twice on the same circuit.
      Fixes bug 33619; bugfix on 0.4.0.1-alpha. Found by Tobias Pulls.
      This is also tracked as TROVE-2020-004 and CVE-2020-10593.
  o Major bugfixes (directory authority):
    - Directory authorities will now send a 503 (not enough bandwidth)
      code to clients when under bandwidth pressure. Known relays and
      other authorities will always be answered regardless of the
      bandwidth situation. Fixes bug 33029; bugfix on 0.1.2.5-alpha.
  o Minor features (diagnostic):
    - Improve assertions and add some memory-poisoning code to try to
      track down possible causes of a rare crash (32564) in the EWMA
      code. Closes ticket 33290.
  o Minor features (directory authorities):
    - Directory authorities now reject descriptors from relays running
      Tor versions from the 0.2.9 and 0.4.0 series. The 0.3.5 series is
      still allowed. Resolves ticket 32672. Patch by Neel Chauhan.
  o Minor features (usability):
    - Include more information when failing to parse a configuration
      value. This should make it easier to tell what's going wrong when
      a configuration file doesn't parse. Closes ticket 33460.
  o Minor bugfix (relay, configuration):
    - Warn if the ContactInfo field is not set, and tell the relay
      operator that not having a ContactInfo field set might cause their
      relay to get rejected in the future. Fixes bug 33361; bugfix
      on 0.1.1.10-alpha.
  o Minor bugfixes (coding best practices checks):
    - Allow the "practracker" script to read unicode files when using
      Python 2. We made the script use unicode literals in 0.4.3.1-alpha,
      but didn't change the codec for opening files. Fixes bug 33374;
      bugfix on 0.4.3.1-alpha.
  o Minor bugfixes (continuous integration):
    - Remove the buggy and unused mirroring job. Fixes bug 33213; bugfix
      on 0.3.2.2-alpha.
  o Minor bugfixes (onion service v3, client):
    - Remove a BUG() warning that would cause a stack trace if an onion
      service descriptor was freed while we were waiting for a
      rendezvous circuit to complete. Fixes bug 28992; bugfix
      on 0.3.2.1-alpha.
  o Minor bugfixes (onion services v3):
    - Fix an assertion failure that could result from a corrupted
      ADD_ONION control port command. Found by Saibato. Fixes bug 33137;
      bugfix on 0.3.3.1-alpha. This issue is also tracked
      as TROVE-2020-003.
  o Documentation (manpage):
    - Alphabetize the Server and Directory server sections of the tor
      manpage. Also split Statistics options into their own section of
      the manpage. Closes ticket 33188. Work by Swati Thacker as part of
      Google Season of Docs.
    - Document the __OwningControllerProcess torrc option and specify
      its polling interval. Resolves issue 32971.
  o Testing (Travis CI):
    - Remove a redundant distcheck job. Closes ticket 33194.
    - Sort the Travis jobs in order of speed: putting the slowest jobs
      first takes full advantage of Travis job concurrency. Closes
      ticket 33194.
    - Stop allowing the Chutney IPv6 Travis job to fail. This job was
      previously configured to fast_finish (which requires
      allow_failure), to speed up the build. Closes ticket 33195.
    - When a Travis chutney job fails, use chutney's new "diagnostics.sh"
      tool to produce detailed diagnostic output. Closes ticket 32792.

@_date: 2020-11-01 16:53:08
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.5.1-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on gitlab.torproject.org.
The source code is available from the download page at
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely by later this month, assuming we figure out a fix
for We're likely to put out stable backport releases in the next week or
two: it would be great if people can test this alpha out, so we know
if there are any bugs.
Here's what's new:
Changes in version 0.4.5.1-alpha - 2020-11-01
  Tor 0.4.5.1-alpha is the first alpha release in the 0.4.5.x series. It
  improves support for IPv6, address discovery and self-testing, code
  metrics and tracing.
  This release also fixes TROVE-2020-005, a security issue that could be
  used, under certain cases, by an adversary to observe traffic patterns
  on a limited number of circuits intended for a different relay. To
  mount this attack, the adversary would need to actively extend
  circuits to an incorrect address, as well as compromise a relay's
  legacy RSA-1024 key. We'll be backporting this fix to other release
  series soon, after it has had some testing.
  Here are the changes since 0.4.4.5.
  o Major features (build):
    - When building Tor, first link all object files into a single
      static library. This may help with embedding Tor in other
      programs. Note that most Tor functions do not constitute a part of
      a stable or supported API: only those functions in tor_api.h
      should be used if embedding Tor. Closes ticket 40127.
  o Major features (metrics):
    - Introduce a new MetricsPort which exposes, through an HTTP
      interface, a series of metrics that tor collects at runtime. At
      the moment, the only supported output format is Prometheus data
      model. Closes ticket 40063. See the manual page for more
      information and security considerations.
  o Major features (relay, IPv6):
    - The torrc option Address now supports IPv6. This unifies our
      address discovery interface to support IPv4, IPv6, and hostnames.
      Closes ticket 33233.
    - Launch IPv4 and IPv6 ORPort self-test circuits on relays and
      bridges. Closes ticket 33222.
    - Relays now automatically bind on IPv6 for their ORPort, unless
      specified otherwise with the IPv4Only flag. Closes ticket 33246.
    - When a relay with IPv6 support is told to open a connection to
      another relay, and the extend cell lists both IPv4 and IPv6
      addresses, the first relay now picks randomly which address to
      use. Closes ticket 33220.
    - Relays now track their IPv6 ORPort reachability separately from
      the reachability of their IPv4 ORPort. They will not publish a
      descriptor unless _both_ ports appear to be externally reachable.
      Closes ticket 34067.
  o Major features (tracing):
    - Add event-tracing library support for USDT and LTTng-UST, and a
      few tracepoints in the circuit subsystem. More will come
      incrementally. This feature is compiled out by default: it needs
      to be enabled at configure time. See documentation in
      doc/HACKING/Tracing.md. Closes ticket 32910.
  o Major bugfixes (security):
    - When completing a channel, relays now check more thoroughly to
      make sure that it matches any pending circuits before attaching
      those circuits. Previously, address correctness and Ed25519
      identities were not checked in this case, but only when extending
      circuits on an existing channel. Fixes bug 40080; bugfix on
      0.2.7.2-alpha. Resolves TROVE-2020-005.
  o Major bugfixes (TLS, buffer):
    - When attempting to read N bytes on a TLS connection, really try to
      read all N bytes. Previously, Tor would stop reading after the
      first TLS record, which can be smaller than the N bytes requested,
      and not check for more data until the next mainloop event. Fixes
      bug 40006; bugfix on 0.1.0.5-rc.
  o Minor features (address discovery):
    - If no Address statements are found, relays now prioritize guessing
      their address by looking at the local interface instead of the
      local hostname. If the interface address can't be found, the local
      hostname is used. Closes ticket 33238.
  o Minor features (admin tools):
    - Add a new --format argument to -key-expiration option to allow
      specifying the time format of the expiration date. Adds Unix
      timestamp format support. Patch by Daniel Pinto. Closes
      ticket 30045.
  o Minor features (bootstrap reporting):
    - When reporting bootstrapping status on a relay, do not consider
      connections that have never been the target of an origin circuit.
      Previously, all connection failures were treated as potential
      bootstrapping failures, including connections that had been opened
      because of client requests. Closes ticket 25061.
  o Minor features (build):
    - When running the configure script, try to detect version
      mismatches between the OpenSSL headers and libraries, and suggest
      that the user should try "--with-openssl-dir". Closes 40138.
    - If the configure script has given any warnings, remind the user
      about them at the end of the script. Related to 40138.
  o Minor features (configuration):
    - Allow using wildcards (* and ?) with the %include option on
      configuration files. Closes ticket 25140. Patch by Daniel Pinto.
    - Allow the configuration options EntryNodes, ExcludeNodes,
      ExcludeExitNodes, ExitNodes, MiddleNodes, HSLayer2Nodes and
      HSLayer3Nodes to be specified multiple times. Closes ticket 28361.
      Patch by Daniel Pinto.
  o Minor features (control port):
    - Add a DROPTIMEOUTS command to drop circuit build timeout history
      and reset the current timeout. Closes ticket 40002.
    - When a stream enters the AP_CONN_STATE_CONTROLLER_WAIT status,
      send a control port event. Closes ticket 32190. Patch by
      Neel Chauhan.
    - Introduce GETINFO "stats/ntor/{assigned/requested}" and
      "stats/tap/{assigned/requested}" to get the NTor and TAP circuit
      onion handshake counts respectively. Closes ticket 28279. Patch by
      Neel Chauhan.
  o Minor features (control port, IPv6):
    - Tor relays now try to report to the controller when they are
      launching an IPv6 self-test. Closes ticket 34068.
    - Introduce "GETINFO address/v4" and "GETINFO address/v6" in the
      control port to fetch the Tor host's respective IPv4 or IPv6
      address. We keep "GETINFO address" for backwards-compatibility.
      Closes ticket 40039. Patch by Neel Chauhan.
  o Minor features (directory authorities):
    - Authorities now list a different set of protocols as required and
      recommended. These lists have been chosen so that only truly
      recommended and/or required protocols are included, and so that
      clients using 0.2.9 or later will continue to work (even though
      they are not supported), whereas only relays running 0.3.5 or
      later will meet the requirements. Closes ticket 40162.
    - Add a new consensus method 30 that removes the unnecessary "="
      padding from ntor-onion-key. Closes ticket 7869. Patch by
      Daniel Pinto.
    - Directory authorities now reject descriptors from relays running
      Tor versions from the obsolete 0.4.1 series. Resolves ticket
      34357. Patch by Neel Chauhan.
    - Make it possible to specify multiple ConsensusParams torrc lines.
      Now directory authority operators can for example put the main
      ConsensusParams config in one torrc file and then add to it from a
      different torrc file. Closes ticket 40164.
    - The AssumeReachable option no longer stops directory authorities
      from checking whether other relays are running. A new
      AuthDirTestReachability option can be used to disable these
      checks. Closes ticket 34445.
    - When looking for possible Sybil attacks, also consider IPv6
      addresses. Two routers are considered to have "the same" address
      by this metric if they are in the same /64 network. Patch from
      Maurice Pibouin. Closes ticket 7193.
  o Minor features (directory authorities, IPv6):
    - Make authorities add their IPv6 ORPort (if any) to the trusted
      servers list. Authorities previously added only their IPv4
      addresses. Closes ticket 32822.
  o Minor features (ed25519, relay):
    - Save a relay's base64-encoded ed25519 identity key to the data
      directory in a file named fingerprint-ed25519. Closes ticket
      30642. Patch by Neel Chauhan.
  o Minor features (heartbeat):
    - Include the total number of inbound and outbound IPv4 and IPv6
      connections in the heartbeat message. Closes ticket 29113.
  o Minor features (IPv6, ExcludeNodes):
    - Handle IPv6 addresses in ExcludeNodes; previously they were
      ignored. Closes ticket 34065. Patch by Neel Chauhan.
  o Minor features (logging):
    - Add the running glibc version to the log, and the compiled glibc
      version to the library list returned when using --library-versions.
      Patch from Daniel Pinto. Closes ticket 40047.
    - Consider an HTTP 301 response to be an error (like a 404) when
      processing a directory response. Closes ticket 40053.
    - Log directory fetch statistics as a single line. Closes
      ticket 40159.
    - Provide more complete descriptions of our connections when logging
      about them. Closes ticket 40041.
    - When describing a relay in the logs, we now include its ed25519
      identity. Closes ticket 22668.
  o Minor features (onion services):
    - Only overwrite an onion service's existing hostname file if its
      contents are wrong. This enables read-only onion-service
      directories. Resolves ticket 40062. Patch by Neel Chauhan.
  o Minor features (pluggable transports):
    - Add an OutboundBindAddressPT option to allow users to specify
      which IPv4 and IPv6 address pluggable transports should use for
      outgoing IP packets. Tor does not have a way to enforce that the
      pluggable transport honors this option, so each pluggable transport
      needs to implement support on its own. Closes ticket 5304.
  o Minor features (relay address tracking):
    - We now store relay addresses for OR connections in a more logical
      way. Previously we would sometimes overwrite the actual address of
      a connection with a "canonical address", and then store the "real
      address" elsewhere to remember it. We now track the "canonical
      address" elsewhere for the cases where we need it, and leave the
      connection's address alone. Closes ticket 33898.
  o Minor features (relay):
    - If a relay is unable to discover its address, attempt to learn it
      from the NETINFO cell. Closes ticket 40022.
    - Log immediately when launching a relay self-check. Previously we
      would try to log before launching checks, or approximately when we
      intended to launch checks, but this tended to be error-prone.
      Closes ticket 34137.
  o Minor features (relay, address discovery):
    - If Address option is not found in torrc, attempt to learn our
      address with the configured ORPort address if any. Closes
      ticket 33236.
  o Minor features (relay, IPv6):
    - Add an AssumeReachableIPv6 option to disable self-checking IPv6
      reachability. Closes part of ticket 33224.
    - Add new "assume-reachable" and "assume-reachable-ipv6" consensus
      parameters to be used in an emergency to tell relays that they
      should publish even if they cannot complete their ORPort self-
      checks. Closes ticket 34064 and part of 33224.
    - Allow relays to send IPv6-only extend cells. Closes ticket 33222.
    - Declare support for the Relay=3 subprotocol version. Closes
      ticket 33226.
    - When launching IPv6 ORPort self-test circuits, make sure that the
      second-last hop can initiate an IPv6 extend. Closes ticket 33222.
  o Minor features (specification update):
    - Several fields in microdescriptors, router descriptors, and
      consensus documents that were formerly optional are now required.
      Implements proposal 315; closes ticket 40132.
  o Minor features (state management):
    - When loading the state file, remove entries from the statefile
      that have been obsolete for a long time. Ordinarily Tor preserves
      unrecognized entries in order to keep forward-compatibility, but
      these entries have not actually been used in any release since
      before 0.3.5.x. Closes ticket 40137.
  o Minor features (statistics, ipv6):
    - Relays now publish IPv6-specific counts of single-direction versus
      bidirectional relay connections. Closes ticket 33264.
    - Relays now publish their IPv6 read and write statistics over time,
      if statistics are enabled. Closes ticket 33263.
  o Minor features (subprotocol versions):
    - Tor no longer allows subprotocol versions larger than 63.
      Previously version numbers up to UINT32_MAX were allowed, which
      significantly complicated our code. Implements proposal 318;
      closes ticket 40133.
    - Use the new limitations on subprotocol versions due to proposal
      318 to simplify our implementation. Part of ticket 40133.
  o Minor features (testing configuration):
    - The TestingTorNetwork option no longer implicitly sets
      AssumeReachable to 1. This change allows us to test relays' self-
      testing mechanisms, and to test authorities' relay-testing
      functionality. Closes ticket 34446.
  o Minor features (testing):
    - Added unit tests for channel_matches_target_addr_for_extend().
      Closes Ticket 33919. Patch by MrSquanchee.
  o Minor features (tests, v2 onion services):
    - Fix a rendezvous cache unit test that was triggering an underflow
      on the global rend cache allocation. Fixes bug 40125; bugfix
      on 0.2.8.1-alpha.
    - Fix another rendezvous cache unit test that was triggering an
      underflow on the global rend cache allocation. Fixes bug 40126;
      bugfix on 0.2.8.1-alpha.
  o Minor bugfixes (circuit padding):
    - When circpad_send_padding_cell_for_callback is called,
      `is_padding_timer_scheduled` flag was not reset. Now it is set to
      0 at the top of that function. Fixes bug 32671; bugfix
      on 0.4.0.1-alpha.
    - Add a per-circuit padding machine instance counter, so we can
      differentiate between shutdown requests for old machines on a
      circuit. Fixes bug 30992; bugfix on 0.4.1.1-alpha.
    - Add the ability to keep circuit padding machines if they match a
      set of circuit states or purposes. This allows us to have machines
      that start up under some conditions but don't shut down under
      others. We now use this mask to avoid starting up introduction
      circuit padding again after the machines have already completed.
      Fixes bug 32040; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (compatibility):
    - Strip '\r' characters when reading text files on Unix platforms.
      This should resolve an issue where a relay operator migrates a
      relay from Windows to Unix, but does not change the line ending of
      Tor's various state files to match the platform, and the CRLF line
      endings from Windows end up leaking into other files such as the
      extra-info document. Fixes bug 33781; bugfix on 0.0.9pre5.
  o Minor bugfixes (compilation):
    - Fix compiler warnings that would occur when building with
      "--enable-all-bugs-are-fatal" and "--disable-module-relay" at the
      same time. Fixes bug 40129; bugfix on 0.4.4.1-alpha.
    - Resolve a compilation warning that could occur in
      test_connection.c. Fixes bug 40113; bugfix on 0.2.9.3-alpha.
  o Minor bugfixes (configuration):
    - Fix bug where %including a pattern ending with */ would include
      files and folders (instead of folders only) in versions of glibc <
      2.19. Fixes bug 40141; bugfix on 0.4.5.0-alpha-dev. Patch by
      Daniel Pinto.
  o Minor bugfixes (control port):
    - Make sure we send the SOCKS request address in relay begin cells
      when a stream is attached with the purpose
      CIRCUIT_PURPOSE_CONTROLLER. Fixes bug 33124; bugfix on 0.0.5.
      Patch by Neel Chauhan.
  o Minor bugfixes (logging):
    - Remove a debug logging statement that uselessly spammed the logs.
      Fixes bug 40135; bugfix on 0.3.5.0-alpha.
    - When logging a rate-limited message about how many messages have
      been suppressed in the last N seconds, give an accurate value for
      N, rounded up to the nearest minute. Previously we would report
      the size of the rate-limiting interval, regardless of when the
      messages started to occur. Fixes bug 19431; bugfix
      on 0.2.2.16-alpha.
  o Minor bugfixes (relay configuration, crash):
    - Avoid a fatal assert() when failing to create a listener
      connection for an address that was in use. Fixes bug 40073; bugfix
      on 0.3.5.1-alpha.
  o Minor bugfixes (rust, protocol versions):
    - Declare support for the onion service introduction point denial of
      service extensions when building with Rust. Fixes bug 34248;
      bugfix on 0.4.2.1-alpha.
    - Make Rust protocol version support checks consistent with the
      undocumented error behavior of the corresponding C code. Fixes bug
      34251; bugfix on 0.3.3.5-rc.
  o Minor bugfixes (self-testing):
    - When receiving an incoming circuit, only accept it as evidence
      that we are reachable if the declared address of its channel is
      the same address we think that we have. Otherwise, it could be
      evidence that we're reachable on some other address. Fixes bug
      20165; bugfix on 0.1.0.1-rc.
  o Minor bugfixes (spec conformance):
    - Use the correct key type when generating signing->link
      certificates. Fixes bug 40124; bugfix on 0.2.7.2-alpha.
  o Minor bugfixes (subprotocol versions):
    - Consistently reject extra commas, instead of only rejecting
      leading commas. Fixes bug 27194; bugfix on 0.2.9.4-alpha.
    - In summarize_protover_flags(), treat empty strings the same as
      NULL. This prevents protocols_known from being set. Previously, we
      treated empty strings as normal strings, which led to
      protocols_known being set. Fixes bug 34232; bugfix on
      0.3.3.2-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (v2 onion services):
    - For HSFETCH commands on v2 onion services addresses, check the
      length of bytes decoded, not the base32 length. Fixes bug 34400;
      bugfix on 0.4.1.1-alpha. Patch by Neel Chauhan.
  o Code simplification and refactoring:
    - Add and use a set of functions to perform down-casts on constant
      connection and channel pointers. Closes ticket 40046.
    - Refactor our code that logs descriptions of connections, channels,
      and the peers on them, to use a single call path. This change
      enables us to refactor the data types that they use, and eliminates
      many confusing usages of those types. Closes ticket 40041.
    - Refactor some common node selection code into a single function.
      Closes ticket 34200.
    - Remove the now-redundant 'outbuf_flushlen' field from our
      connection type. It was previously used for an older version of
      our rate-limiting logic. Closes ticket 33097.
    - Rename "fascist_firewall_*" identifiers to "reachable_addr_*"
      instead, for consistency with other code. Closes ticket 18106.
    - Rename functions about "advertised" ports which are not in fact
      guaranteed to return the ports that have been advertised. Closes
      ticket 40055.
    - Split implementation of several command line options from
      options_init_from_torrc into smaller isolated functions. Patch by
      Daniel Pinto. Closes ticket 40102.
    - When an extend cell is missing an IPv4 or IPv6 address, fill in
      the address from the extend info. This is similar to what was done
      in ticket 33633 for ed25519 keys. Closes ticket 33816. Patch by
      Neel Chauhan.
  o Deprecated features:
    - The "non-builtin" argument to the "--dump-config" command is now
      deprecated. When it works, it behaves the same as "short", which
      you should use instead. Closes ticket 33398.
  o Documentation:
    - Replace URLs from our old bugtracker so that they refer to the new
      bugtracker and wiki. Closes ticket 40101.
  o Removed features:
    - We no longer ship or build a "tor.service" file for use with
      systemd. No distribution included this script unmodified, and we
      don't have the expertise ourselves to maintain this in a way that
      all the various systemd-based distributions can use. Closes
      ticket 30797.
    - We no longer ship support for the Android logging API. Modern
      versions of Android can use the syslog API instead. Closes
      ticket 32181.
    - The "optimistic data" feature is now always on; there is no longer
      an option to disable it from the torrc file or from the consensus
      directory. Closes part of 40139.
    - The "usecreatefast" network parameter is now removed; there is no
      longer an option for authorities to turn it off. Closes part
      of 40139.
  o Testing:
    - Add unit tests for bandwidth statistics manipulation functions.
      Closes ticket 33812. Patch by MrSquanchee.
  o Code simplification and refactoring (autoconf):
    - Remove autoconf checks for unused funcs and headers. Closes ticket
      31699; Patch by   o Code simplification and refactoring (maintainer scripts):
    - Disable by default the pre-commit hook. Use the environment
      variable TOR_EXTRA_PRE_COMMIT_CHECKS in order to run it.
      Furthermore, stop running practracker in the pre-commit hook and
      make check-local. Closes ticket 40019.
  o Code simplification and refactoring (relay address):
    - Most of IPv4 representation was using "uint32_t". It has now been
      moved to use the internal "tor_addr_t" interface instead. This is
      so we can properly integrate IPv6 along IPv4 with common
      interfaces. Closes ticket 40043.
  o Documentation (manual page):
    - Move them from doc/ to doc/man/. Closes ticket 40044.
    - Describe the status of the "Sandbox" option more accurately. It is
      no longer "experimental", but it _is_ dependent on kernel and libc
      versions. Closes ticket 23378.
  o Documentation (tracing):
    - Document in depth the circuit subsystem trace events in the new
      doc/tracing/EventsCircuit.md. Closes ticket 40036.

@_date: 2020-11-23 14:10:28
@_author: Nick Mathewson 
@_subject: [tor-talk] Tor 0.4.5.2-alpha is released 
Hi, all!
There's a new alpha Tor release! Because it's an alpha, you should
only run it if you're ready to find more bugs than usual, and report
them on gitlab.torproject.org.
The source code is available from the download page at
 ; if you build Tor from
source, why not give it a try? And if you don't build Tor from source,
packages should be ready over the coming days, with a Tor Browser
alpha release likely by mid-December.
Here's what's new:
Changes in version 0.4.5.2-alpha - 2020-11-23
  Tor 0.4.5.2-alpha is the second alpha release in the 0.4.5.x series.
  It fixes several bugs present in earlier releases, including one that
  made it impractical to run relays on Windows. It also adds a few small
  safety features to improve Tor's behavior in the presence of strange
  compile-time options, misbehaving proxies, and future versions
  of OpenSSL.
  o Major bugfixes (relay, windows):
    - Fix a bug in our implementation of condition variables on Windows.
      Previously, a relay on Windows would use 100% CPU after running
      for some time. Because of this change, Tor now require Windows
      Vista or later to build and run. Fixes bug 30187; bugfix on
      0.2.6.3-alpha. (This bug became more serious in 0.3.1.1-alpha with
      the introduction of consensus diffs.) Patch by Daniel Pinto.
  o Minor features (compilation):
    - Disable deprecation warnings when building with OpenSSL 3.0.0 or
      later. There are a number of APIs newly deprecated in OpenSSL
      3.0.0 that Tor still requires. (A later version of Tor will try to
      stop depending on these APIs.) Closes ticket 40165.
  o Minor features (protocol, proxy support, defense in depth):
    - Respond more deliberately to misbehaving proxies that leave
      leftover data on their connections, so as to make Tor even less
      likely to allow the proxies to pass their data off as having come
      from a relay. Closes ticket 40017.
  o Minor features (safety):
    - Log a warning at startup if Tor is built with compile-time options
      that are likely to make it less stable or reliable. Closes
      ticket 18888.
  o Minor bugfixes (circuit, handshake):
    - In the v3 handshaking code, use connection_or_change_state() to
      change the state. Previously, we changed the state directly, but
      this did not pass the state change to the pubsub or channel
      objects, potentially leading to bugs. Fixes bug 32880; bugfix on
      0.2.3.6-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (compilation):
    - Use the correct 'ranlib' program when building libtor.a.
      Previously we used the default ranlib, which broke some kinds of
      cross-compilation. Fixes bug 40172; bugfix on 0.4.5.1-alpha.
    - Remove a duplicate typedef in metrics_store.c. Fixes bug 40177;
      bugfix on 0.4.5.1-alpha.
    - When USDT tracing is enabled, and STAP_PROBEV() is missing, don't
      attempt to build. Linux supports that macro but not the BSDs.
      Fixes bug 40174; bugfix on 0.4.5.1-alpha.
  o Minor bugfixes (configuration):
    - Exit Tor on a misconfiguration when the Bridge line is configured
      to use a transport but no corresponding ClientTransportPlugin can
      be found. Prior to this fix, Tor would attempt to connect to the
      bridge directly without using the transport, making it easier for
      adversaries to notice the bridge. Fixes bug 25528; bugfix
      on 0.2.6.1-alpha.
    - Fix an issue where an ORPort was compared with other kinds of
      ports, when it should have been only checked against other
      ORPorts. This bug would lead to "DirPort auto" getting ignored.
      Fixes bug 40195; bugfix on 0.4.5.1-alpha.
    - Fix a bug where a second non-ORPort with a variant family (ex:
      SocksPort [::1]:9050) would be ignored due to a configuration
      parsing error. Fixes bug 40183; bugfix on 0.4.5.1-alpha.
  o Minor bugfixes (crash, relay, signing key):
    - Avoid assertion failures when we run Tor from the command line
      with `--key-expiration sign`, but an ORPort is not set. Fixes bug
      40015; bugfix on 0.3.2.1-alpha. Patch by Neel Chauhan.
  o Minor bugfixes (logging):
    - Remove trailing whitespace from control event log messages. Fixes
      bug 32178; bugfix on 0.1.1.1-alpha. Based on a patch by
      Amadeusz Pawlik.
    - Turn warning-level log message about SENDME failure into a debug-
      level message. (This event can happen naturally, and is no reason
      for concern). Fixes bug 40142; bugfix on 0.4.1.1-alpha.
  o Minor bugfixes (relay, address discovery):
    - Don't trigger an IP change when no new valid IP can be found.
      Fixes bug 40071; bugfix on 0.4.5.1-alpha.
    - When attempting to discover our IP, use a simple test circuit,
      rather than a descriptor fetch: the same address information is
      present in NETINFO cells, and is better authenticated there. Fixes
      bug 40071; bugfix on 0.4.5.1-alpha.
  o Minor bugfixes (testing):
    - Fix the `config/parse_tcp_proxy_line` test so that it works
      correctly on systems where the DNS provider hijacks invalid
      queries. Fixes part of bug 40179; bugfix on 0.4.3.1-alpha.
    - Fix unit tests that used newly generated list of routers so that
      they check them with respect to the date when they were generated,
      not with respect to the current time. Fixes bug 40187; bugfix
      on 0.4.5.1-alpha.
    - Fix our Python reference-implementation for the v3 onion service
      handshake so that it works correctly with the version of hashlib
      provided by Python 3.9. Fixes part of bug 40179; bugfix
      on 0.3.1.6-rc.
    - Fix the `tortls/openssl/log_one_error` test to work with OpenSSL
      3.0.0. Fixes bug 40170; bugfix on 0.2.8.1-alpha.
  o Removed features (controller):
    - Remove the "GETINFO network-status" controller command. It has
      been deprecated since 0.3.1.1-alpha. Closes ticket 22473.
