
@_date: 2008-04-18 15:11:52
@_author: Hans Schnehl 
@_subject: A Question to people from UK 
This is a not strictly tor-related matter, but  related to anonymity in the wider approach.
I was told in the UK you are obliged to deliver your
private gpg/pgp keys to the authorities as soon as you use one of these programs for yourself. I am aware of the fact, that in the UK you are threatened with quite
harsh laws (imprisonment for several years) if you do not deliver the key to encrypted
harddisks und else on demand.
What is new to me is the  "obligation" to deliver mentioned keys.
I hope this is a hoax, but just for informational reasons it would be nice if
someone with the appropriate knowledge could clarify this.
thx in advance.

@_date: 2008-08-05 10:47:43
@_author: Hans Schnehl 
@_subject: SIGHUP without effect 
Hi  As this was started on this list, I continue here for now.
By rereading a modified torrc, this signal causes tor also to upload
these modifications to the authorities.
What I tried to achieve is getting closer to the servers upper limits in bandwidth/performance, therefore publishing descriptors with different
bandwidths, sometimes within relatively short times. What I did not know
is the authorities' not accepting so called 'cosmetic' changes within a
certain timeframe. This is perfectly logic and makes sense, explains most my observations, though not all. Unfortunately there isn't even a log of the incident, nor did it happen
again, but that may be due to not using SIGHUP that often anymore now.
I did not (want to) try to reproduce the latter behaviour again yet, so presently there is nothing 'solid' to be filed. As soon as there are recurrences or any other noticable events I will try
to deliver more appropriate information in the right place.

@_date: 2008-08-07 11:59:34
@_author: Hans Schnehl 
@_subject: exit node "tortila" adds material to www.barnesandnoble.com 
This is AFAIK an excerpt of an essay about an article or book of an apparently female author referring to the diversity of attitudes in this world. This work appears to be dealing with gender related stuff. Nothing really smashing, and not very politically motivated (unless you want to see it that way).
The point is, this is written in way that hardly anyone, even native germans,
would bother to read it, so I'm not 100% convinced someone would deliberately  set this up for a broad audience to take notice of this content in that way.
It just doesn't make sense (but you never really now, see diversity of attitudes..).  But it definitely shouldn't be there.
Added to exclude list. Thx.

@_date: 2008-08-01 16:49:35
@_author: Hans Schnehl 
@_subject: torrc file changes and features - reversal request & possible 
Don't know about the rest, but it certainly is not a good idea to choose smtp
port 25.
Even in Tor's default configutration reject *:25  is standard, and I doubt
someone would deliberarely modify this. Gmail though accepts port 587 (encrypted traffic) which works just fine.

@_date: 2008-08-12 17:23:22
@_author: Hans Schnehl 
@_subject: tortila as a bad exit 
Yes, I can confirm this.  Sending single requests to random
addresses via this node  is sufficient. I did this on two following
days, the first go was quite immediately after a post in or-talk
regarding this issue, so possibly there were others also trying to
check this node at that time. The second go though was about 24
hours later, so the first 'rush' of testing tortila might have been
over, but results are similar.  Very few of the results were
requested via 'host.node.exit' but most were done with a  modified
torrc.  I chose sites that have content where I just about know what
to expect without double-checking.  These results were unforced,
meaning that only one request was sent at a time. But even the
honourable torproject.org site had a minor (bottom) change of
There is a simple browser feature, which is to simultanously open
all bookmarks in a bookmark folder. Doing this it was possible to
get results of mixing pages, one time the source site from where content
was merged into others plus the modified ones.  Streams seem to have
mixed up somehow with other pages' content or the page itself got
mixed up. On some altered pages 'noise' is to be found, that could
be interpreted as dump of encrypted traffic added unmodified in
between valid html/php/ or whatever tags.  Others are simply
incomplete, maybe the missing parts have merged into other streams.
Some of them show php/perl/html tags printed. I tried only one other node similar to 'tortila', which was 'nexus', but could not at all reproduce the results from 'tortila' there. Maybe I should continue with other methods.  As noted, this is done with very little effort, but I hope it can help.
As of today, 12th of August and a few more tries, it appears as if
this behaviour can be witnessed without any real effort, any
connection from the Tor network through 'tortila' is endangered of
being modified.  There is no obvious pattern, changes are random and
make no sense, yet I do not really believe this to be a bug in Tor.
There are the same javascript tags reappearing on a number of
altered pages, there is the same mixed nonsense, again javascript
related, within pages if requests for the same page are made at
another time.  There also seem to be pages more resistant or even
more or less immune against this as they do not use javascript. My best guess is some http proxy with filtering capabilities is
misconfigured to run with a Tor exitnode is the cause of this issue.
The worse guess is someone trying to make money with the Tor network
by adding payed ads to webpages in order to reach a rather huge
audience. If this is so, it is not very successful. But this
certainly is a 'bad exit' if the owner does not manage a proper
And yes,  stevepavlima is very frequent on modified pages.

@_date: 2008-12-09 14:23:00
@_author: Hans Schnehl 
@_subject: No data retention in germany for donated services 
This is great news for all Tornode operators in Germany, if it comes true
in the meaning of the local (german) jurisdiction has to accept this.
It saves German operators from having to chose between breaking anonymity
by loggging data or being criminalyzed, or art least heavily fined or
punished otherwise.
It also would save quite a lot of work and money to be spent for saving all the data. This would be, presuming it to become accepted, excellent.
Unfortunatelly it does not solve the problem, the mere fact traffic is
going to be logged and held for 6 months is the problem, not who does
the actual logging. So the necessary data will be easily obtained on request of executives from the isp's where nodes are hosted/running.
But it may keep up the number of nodes in that country.

@_date: 2008-02-29 10:38:18
@_author: Hans Schnehl 
@_subject: lefkada down 
Since a week these messages appeared:
Feb 29 08:21:07.148 [info] router_set_networkstatus_v2(): Not replacing network-status from directory server "lefkada" (published 2008-02-22 19:07:05); we already have it.
Consequently only four of five authorities listed in  cached-status matched a current
network-status since about one week.
After a  q&d  'rm -f  cached-status/* ' there is:
Feb 29 09:21:19.123 [info] connection_dir_request_failed(): Giving up on directory server at '140.247.60.64'; retrying
Now  there are only four authorities listed. Maybe hard to find a majority there ? All this  on  Tor v0.2.0.20-rc-dev (r13725). Am I missing something in my configuration?

@_date: 2008-02-29 11:42:49
@_author: Hans Schnehl 
@_subject: lefkada down 
Yes, I remember this was told in my life before ;)
Thanks for clearing.

@_date: 2008-01-06 15:50:34
@_author: Hans Schnehl 
@_subject: shinjiru closed exit node acceptnolimits 
just a possible provider, accoreding to their website you should even be able to
do something like anonymous payments.
Please take a look at : The appear to have a mixed reputation about their reliability and speed, but this is completely untested, so not a recommendation but a hint. Hans

@_date: 2008-01-07 22:16:46
@_author: Hans Schnehl 
@_subject: What to do at IP number change? 
The advantage of making it harder for  attackers  to find back your node (I wonder if
a serious attacker of a certain quality would really be stopped significantly) are IMHO negligible compare to the  advantage to more or less constantly relaying traffic.
Considering the time it needs for other servers and possible clients to realize your ever changing IP it may be a bad choice, as all of them will have to download the node's
new IP and during this time ther will be less traffic relayed as if the  node was wellknown.
I also live on a dial-up adsl2 line, and I can see how long it takes for traffic utilizing
the provided bandwidth after a reconnect. It is indeed a loss of bandwidth to the network. A word about obfuscation: If we run a tor node, we are as anonymous as Sta. Claus
hiding behind sunglasses to our ISP's. If they want, they can see that we are running a router/tor-node. Actually they can hardly miss it. Of course it may be fun to do somthing like tor-war-driving, but
as mentioned, not necessarily good for the network ;)
You may, but not necessarily have to. I made myself a little script catching the changed IP via mpd_linkup
(or ppp.linkup or what you may use) and changing the Address 123.123.123.123 into the new Address 234.234.234.234
and then sends a SIGHUP to Tor.

@_date: 2008-01-07 23:35:42
@_author: Hans Schnehl 
@_subject: What to do at IP number change? 
I am not familiar how to do this on linux and have no machine to try here, can please someone help out?
You need the following:
torpid= 'catch the PID'  like  the following should do then: (please someone "translate to a linux")
sed -i '' 's/^\(Address\) .*/\1 '$newip'/' /path/to/your/torrc
 to be put in a script and initiated by e.g. ip-up.local does the trick for me.
 Maybe this is a complete waste of time, if Tor is able to determine the new IP alone faster.
IN this case a simple:
should be fine.
What may be faster or more efficient, to HUP tor with a new IP, or to let the Authorities find out themselves
about a renewed IP, I do not know. Anyone?

@_date: 2008-01-08 21:04:45
@_author: Hans Schnehl 
@_subject: shinjiru closed exit node acceptnolimits 
Perfect and good to know!   Congratulations !
Hans

@_date: 2008-01-23 00:01:55
@_author: Hans Schnehl 
@_subject: Hostname 
I believe this is about not to show up in the publicly available lists
(TorStatus) on blutmagie, kprog and others. Of course the network must know 'itself', so there is no point in hiding from the Tor network and in the same time being a member.
But if my assumption is correct, you might want to set up your node as a bridge.
These are not listed in the mentioned status lists. give hints how to do this.
Hans

@_date: 2008-01-23 19:11:20
@_author: Hans Schnehl 
@_subject: We're missing a certificate from authority lefkada with 
this has already been discussed more than sufficiently on this list.
see Minor Bugfixes  -first...

@_date: 2008-01-25 11:02:45
@_author: Hans Schnehl 
@_subject: Which name servers do you use? 
AFAIK OpenDns are financing their service by 'hijacking' invalid requests.
They do actually announce this somewhere on their website, so people using them should know. It is their business-model to take unknown and invalid requests to
paid-for sites with the usual links etc. To my opinion this is all right,
as they in return provide a really fast service, as you mentioned. This consequently leads to Tor's above notice and the IP of the link-farm site
to be treated as 'not found'. And  that's just fine. There are sufficient numbers of  open nameservers out in the net, of which many try to earn money by taking invalid requests to linkfarms of various qualities, if
the word quality is appropriate in this context. I think these are not a bad choice for Tor, as they let especially dial-up Tor-ops avoid bothering their ISP's sometimes rotten nameservers. Some of those probably exist only for the purpose of logging requests, but that's
not crucial, the ISP can do this too. I use fast servers somewhere in Ukrainia which do the same thing, (advertising),
and so Tor comes up with the message and the reaction and everything else is fine.
(I also block the regarding IP's)  These are both a good choice, whereas OpenDNS certainly is faster (hopefully ORSN will get better soon).

@_date: 2008-01-02 14:16:04
@_author: Hans Schnehl 
@_subject: TLS errors 
Hi, I do have a lot of reoccurring entries as following with Tor logging on debug level. This is Tor v0.2.0.15-alpha-dev (r13006) but same was happening before with lower versions.   Here  is an excerpt:
%tail -f /usr/local/etc/tor/debug.log | grep error
Jan 02 12:45:57.965 [info] TLS error:  (errno=1: Operation not permitted)
Jan 02 12:45:57.965 [info] connection_handle_write(): tls error. breaking.
Jan 02 12:45:57.965 [info] TLS error:  (errno=1: Operation not permitted)
Jan 02 12:45:57.965 [info] connection_handle_write(): tls error. breaking.
Jan 02 12:46:06.204 [debug] TLS error:  (errno=54: Connection reset by peer)
Jan 02 12:46:06.204 [info] connection_read_to_buf(): tls error [connection reset]. breaking (nickname NoNickNode, address 111.112.113.114).
Jan 02 12:46:14.711 [debug] crypto error while performing RSA decryption: oaep decoding error (in rsa routines:RSA_padding_check_PKCS1_OAEP)
Jan 02 12:46:14.711 [debug] crypto error while performing RSA decryption: padding check failed (in rsa routines:RSA_EAY_PRIVATE_DECRYPT)
Jan 02 12:46:14.746 [debug] TLS error: unexpected close while reading
Jan 02 12:46:14.746 [info] connection_read_to_buf(): tls error [unexpected close]. breaking (nickname nevermind, address 011.211.311.411).
Jan 02 12:46:18.716 [debug] TLS error: unexpected close while reading
Jan 02 12:46:18.716 [info] connection_read_to_buf(): tls error [unexpected close]. breaking (nickname noneofmybusiness , address 167.102.266.121).
Jan 02 12:46:21.011 [info] TLS error:  (errno=1: Operation not permitted)
Jan 02 12:46:21.011 [info] connection_handle_write(): tls error. breaking.
Jan 02 12:46:25.718 [debug] TLS error:  (errno=54: Connection reset by peer)
Jan 02 12:46:25.718 [info] connection_read_to_buf(): tls error [connection reset]. breaking (nickname stclaus, address 123.321.213.312). Jan 02 12:46:47.523 [info] TLS error:  (errno=1: Operation not permitted)
Jan 02 12:46:47.523 [info] connection_handle_write(): tls error. breaking.
Jan 02 12:46:56.584 [debug] TLS error: unexpected close while reading
and so on.
Tor is running, but appears to be using only fractions of the bandwidth it is supposed to.
Can someone please give a short explanation?
(for a non-crypto-hacker)
Hans

@_date: 2008-01-02 15:52:36
@_author: Hans Schnehl 
@_subject: Map of surveillance societies 
just in case someone wishes to move servers around, see the map for where to avoid:
Interesting.  I  assume Germany is seen as before the new laws came into force.
Hans

@_date: 2008-01-02 18:55:52
@_author: Hans Schnehl 
@_subject: TLS errors 
Thx for the fast replies, I wasn't really scared but rather curious about what the logs were saying. I read the message, and there is a simularity, mayber there is something about openssl
with freebsd, as Scott Bennet  lso runs a freebsd machine.
Mine is running  now with freebsd7, but the logs did show up also with fbsd6-stable. All correct, the ones I cannot really understand are those:
Jan 02 12:46:14.711 [debug] crypto error while performing RSA decryption: oaep decoding error (in rsa routines:RSA_padding_check_PKCS1_OAEP)
Jan 02 12:46:14.711 [debug] crypto error while performing RSA decryption: padding check failed (in rsa routines:RSA_EAY_PRIVATE_DECRYPT)
and the ones with:
Jan 02 12:45:57.965 [info] TLS error:  (errno=1: Operation not permitted)
Jan 02 12:45:57.965 [info] connection_handle_write(): tls error. breaking.
Jan 02 12:45:57.965 [info] TLS error:  (errno=1: Operation not permitted) what should be not permitted ?
I reckon one reason for bandwidth behaviour is, the node runs with another secret-key, as I lost the original. It may take some time until it is 'named' again, so the 7 authorities handle the node  differently. How long does it take nowadays for a registered name to expire and the name to be used for (in my case the same) new machine ?
I had with Tor 0.2.0.7 and ..06 a full utilizatiojn of bandwidth within roughly 2 to three hours after reconnection,
but that was lost somewhere with the next -0.8- to todays -0.15.

@_date: 2008-01-01 15:10:17
@_author: Hans Schnehl 
@_subject: How are German Tor server people doing? 
nothing really changes here in Germany yet. There are, as sufficiently discussed,
some more or less promising attempts to stop the new law. But for the year
2008 there is no change for torizens yet, and actually some people including me
do not believe there will be an obligation to log anything for us in the time after. If, then it might happen in one year from now, and in that case I will close my German node and move somewhere else. But that is, as mentioned, in one year from now.
I think Germany has the highest density of Tornodes in the world if you
use the  number of citizens and the number of nodes as parameters.
At present the number of nodes (maybe also because of 24c3, which I missed) is increasing.
It's still going...
The raids on Tor operators are afaik not a part of a larger strategy
against Tor, but a pretty sad picture of the local policeforce and their massive lack of adaptive capabilities.
One side effect though is the diminishing number of exit-nodes here.
Doesn't help those raided during the last year, but the vast majority here did not encounter any raids.
Don't you worry, afaik most, here in Berlin (as of 15:00),  are still not very responsive, yet.
Disagree.  Not scared, but consequent ;) Last not least, there is no better occasion than now:  Happy new year everyone.

@_date: 2008-01-03 17:11:38
@_author: Hans Schnehl 
@_subject: shinjiru closed exit node acceptnolimits 
Even being of German nationality I do absolutely agree with you about the
 uselessness of deploying lawyers in such a case. All this takes months, if applicable   with other countries' laws at all, the costs of such an attempt may be out of any scope. You repeatedly mentioned your absolute anonymity against the malaysian company
your node was hosted on.
Have you   possibly taken it into your consideration that the so called 'Abuse'
they are referring to might be exactly that and _not_ Tor?

@_date: 2008-07-27 18:04:29
@_author: Hans Schnehl 
@_subject: SIGHUP without effect (was: 0.2.1.2-alpha failing to upload 
Very simular, on 0.2.0.28-rc (r15188) sending a SIGHUP did not do what it is supposed to. Trying to publish new descriptors (bandwidth) lead to quite unexpected
results. The authorities (cached-consensus) simply stopped listing the node and cached-descriptors(.new) were not updated any more.
This though did not have an immediate effect as there were enough machines using the node because of the previously downloaded descriptors and consensus.  It simply died away slowly when more and more machines 'forgot'
the node to exist. Some 12 hours later Tor had to be restartet when it was finally running
on some 30% of its previous capacity, but then uploading the new  descriptors then accepted (or recognized) correctly by the authorities.
The second SIGHUP for to publish altered descriptors didn't do anything a few days later. The reason again was to increase bandwidth and to become a HSDir-Server.
There might be things to be considered to set this flag I do not yet know,
and if there are, let me know, please.
The SIGHUP though did nothing at all.
 -HUP 12345 && tail -f ../debug.log (info) showed the signal being recieved and new descriptors uploaded to I believe 5 authorative servers, but only 4 responding. Some time later still no
change could be seen, so a new and very unpatient SIGHUP did not have any
result. I remember seeing this message:
...Consensus does not include configured authority 'dannenberg' at .....
but no change to the servers descriptors had been acknowledged.
The altered descriptors were then correctly uploaded or recognized with the
next schedule 18 hours after the previous one.
I suppose Tor's behaviour to ignore SIGHUP uploads with an unmodified torrc may be rather a feature, but I'm not sure about this if Tor ignores signals which  are sent for good reason.  This on a FreeBSD amd64 box, Scott runs FreeBSD i386, does this also happen with linux's ?
Bug or feature ? Happy ignoring ?
Regards P.S.: The moment I write this the box crashes hard. The reason for all
      this  reconfiguring was to find the limit of this tiny server.
      Think I found it :)

@_date: 2008-05-20 16:27:05
@_author: Hans Schnehl 
@_subject: How can a site still determine my browser language? [Mofify 
[snip] Privoxy does not handle https, nor does it claim to do so.
If altering Headers, Privoxy cannot deal with https traffic. So, as a result,
if google (or whoever) is accessed via https, the browser will send the headers
it reads in it's configuration. Some sites might just spawn one https connection
within all the ordinary http, just to check if headers are alike.
You can take care of that either in about:config or use a tool. I think firefox rewrites it's config in case of an update or for whatever reasons
the creators have decided to. There is an add-on called "modify headers" dealing with headers quite reliably.
Makes more sense to set the headers to something reasonable, else the purpose is
contradicted. Also pleasse take care that settings in Privoxy are the same as the
ones in "modify headers" else the effect is again contradicted. Or rather dismiss
this particular feature in Privoxy if using "modify headers".
To be found at addons.mozilla.org.
To take care of cookies you might consider another addon called "cookie culler" to
be found under the same address.
There actually is an option under Firefox-> Preferences -> Privacy -> Private Data
called "Always clear my private data when I close Firef..." at your choice, wiping
out fairly much or all what a data munger like google likes to know.
If you wish to stay anonymous against google, you NEVER, and this is literally NEVER
EVER login there without shelter and without tor.
There also is a recommended list of tools/addons to use with tor somewhere on tor's
 website.
Check your headers in http(s) at:
can be quite startling :)
scroll down to bottom, http, https check.

@_date: 2008-05-14 20:56:06
@_author: Hans Schnehl 
@_subject: Tor security advisory: Debian flaw causes weak identity keys 
Hi Sebastian
 Some, like my node, may never get listed "named" again.  Lost my keys roughly
one year ago (my fault), authorities never made it to agree on the "named" flag again.
Still get the "there is another router... you may consider using another ..."  message.
There are more important things, though.
Kind regards
Hans

@_date: 2008-11-23 10:58:52
@_author: Hans Schnehl 
@_subject: DoS attack 
due to the overlay in timing (parallel start of an 'attack'
on my machine) I believe this to be the same issue.
With standard *x tools (no intelligence sorcery or alike, for the
paranoid)  I managed to find the person in charge of the machine and called him up.
He then basically 'pulled the plug' as the box proved to be inresponsive and apparently had gone out of
control. Until failure there was a Tornode active.
The box was killed on 1 Oct 2008 at around 16:00 (UST).
Actually this is about the same time when the scroogle issue a bit earlier was solved, when, according to this post
an attack on scroogle  ceased, so I believe this all was
the same issue.
According to the person in charge the reason was a misconfigured or out of control machine.
If the above is not related to Karstens post, my apologies
for the noise.
I do not remember who I talked to, and I do not own any logs, the person was surprised but friendly and almost immediately responded to solve the matter.

@_date: 2008-11-04 10:15:05
@_author: Hans Schnehl 
@_subject: Consensus drops router 
vallenator disappeared from current-consensus.
The time is CET(0000 + 1), I did not change anything in my configuration.
Please see attached gif.
Anyone else seeing this ?

@_date: 2008-11-07 14:24:41
@_author: Hans Schnehl 
@_subject: any middlemen seeing DoS currently? 
now roughly 4.5  hours ago states went to the upper limit 10k.
Flushed tables the hard way but ten minutes later they were
 up on 10k again.
Talked to my ISP's helpline and according to them it may not be their responsibility, but hmmmm !?!

@_date: 2008-11-07 17:02:16
@_author: Hans Schnehl 
@_subject: any middlemen seeing DoS currently? 
you  may set the timeout values in pf.conf to rather low values.
Actually I start wondering if larger values are of any use anyway.
maybe like:
besides the default.
this will kick yourself too if the line is idle for too long.

@_date: 2008-11-07 23:48:31
@_author: Hans Schnehl 
@_subject: any middlemen seeing DoS currently? 
Correct. Thanks for bringing this up, these values are _not_ useful under normal circumstances. These settings will, under  conditions like  mentioned
in this threat, reduce the number of states in pf's table.
As soon as the state tables reach their upper limit no further
connections are accepted until the number drops under the limit again.
It is the choice of having useless states or trying to get rid of unused
connections rather fast in order to provide access for 'real' connections.
It reduced the number of states by 20% within an hour or so on vallenator.
AFAIK this present situation  will take some more time until the new certificate is through. _Until then_ , these 'emergency response  settings' may be helpful if using pf ;)

@_date: 2008-10-01 18:09:15
@_author: Hans Schnehl 
@_subject: DoS attack 
Hi all,
I had  a similar suspicion as my server was target for the last 17 hours
of something I suspected t opossibly be a DOS attack (if it grew a little more;).
It was *not*.
I called the owner of the IP and just in the last minutes he corrected this.
According to him the machine went amok, whatever.
 Relax guys, and please verify
the 'attack' is over.  :)
Hans

@_date: 2008-09-13 12:31:34
@_author: Hans Schnehl 
@_subject: invitation to directory server operators 
Just for clarification for Germans: Isps of various countries, even in Europe,  do _NOT_ force a 24 hour dis/reconnect with dialup adsl lines. Even if the line is disconnected, they _may_ just give away the same IP that
was used before to the same machine. They do not have to, but in practice they often do. (see below)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ For Non-Germans:
In Germany and some neighboring states  it's standard of isp's providing adsl dialups to disconnect _every_ line after 24 hours and reconnect with giving away a new IP.
AFAIK there is no exeption to the rule with dialup lines.
So the idea of running a HSDir server is probably limited to those with more permanent
IPs, unless the 24 hour waiting period for HSDir servers to become active is changed to
something shorter.

@_date: 2008-09-13 15:18:43
@_author: Hans Schnehl 
@_subject: invitation to directory server operators 
They do either run a rented server or pay a rather expensive price for that. For a private person who wishes to run a Tor-node with higher bandwidth and  undisrupted connectivity I assume it to be best to rent a server somewhere.
Prices have become quite moderate by now. Last not least this would contribute
more bandwidth, nodes and anonymity, and that's what it's all about, isn't it? Numismatic evaluation....  but back to topic ;)

@_date: 2009-01-02 21:40:14
@_author: Hans Schnehl 
@_subject: Jailed/sandboxed/chrooted applications 
please see:
handling a similar approach.
With FBSD Tor needs rw on /dev/pf for this to work,
apart from all necessary settings in pf.conf.
(As you do rdr maybe an anchor in the appropriate positions
would be good, if it works without, even better)
Hans

@_date: 2009-03-23 22:51:32
@_author: Hans Schnehl 
@_subject: Consensus drops node 
Hi all,
six hours ago the node 'vallenator's performance  began to decrease gradually
from around 18 mbit/s to about 1 mbit/s.
The node was running rather stable at it's upper level (see above) with an uptime
of now 32 days.
I did not do anything on this running machine, so I initially suspected my hoster
to intercept or interfere, not necessarily with a motivation against Tor, but
maybe for more or less genious technical reasons. But they did not do so.
What happened is, the node was actually 'forgotte'n, or dropped out of consensus
by the authoritive routers, it still is as of now. Since I do not have logging
enabled I am unable to search or provide logs with possible traces of what was
Anybody else experiencing this? I'll keep the node running 'as is' and watch for any changes to occur within the
next hours but probably I'll take the chance to rebuild a few things on that
machine if if there is no change.
Any ideas about this ?
Hans

@_date: 2009-03-24 12:28:04
@_author: Hans Schnehl 
@_subject: Consensus drops node 
The node came up again by itself.  It did so after 18 hours of gradually but
signifigantly loosing connections to the rest of the 'Tor-world' until there was
only noise left. I assume the built in scheduled 18hourly publishing of descriptors
caught some or all of the authorities by surprise in realising this box is still
there and never stopped working ;). For these 18 hours the node was not listed
in the current consensus. By now it is, again, with the number of connections
and utilized bandwidth increasing.
If you find vallenator on kprogs torstatus (trunk) this incident shows nicely
in the graphics.
Apparently there was a short but complete loss of connectivity or the node became
unresponsive for just a few minutes in the beginning of this.  Due to the number
of at that time already established connections, these and throughput reestablished
very fast back on the previous level. But since the node appeared to have gone
for the authorities, gradually connections to other nodes and the 'Tor-world'
The blackout itself might have been caused by some apprentice (like me) practising
to pull and reinsert plugs on the hosters side or other reasonable activity.
Kyle mentioned, this happened to him when he 'was testing the max througphut of
a embedded device' and it sounds a little like he was expecting this device to
fail sooner or later, and maybe it didn't fail and just became unresponsive at
the wrong moment.
My node was for a short period of time unresponsive to or disconnected from the
general network. The turn to publish descriptors fell exactly within this period
of unresponsiveness.  So there probably were no descriptors sent to the authorities
at the time they expected these to be there, ergo them dropping the router from
the lists. The node didn't really notice and sat there chewing it's fingernails
and wondering about all the evil in this world. ahemm.  Earlier versions of Tor
did publish descriptors  when sending it a SIGHUP, but this is not possible
anymore.  So probably presently  the only way of solving this is to either restart
Tor, or just wait 18 hours until Tor will republish it's descriptors, and hopefully
this doesn't happen in another unresponsive period.

@_date: 2010-04-17 16:33:39
@_author: Hans Schnehl 
@_subject: Consider traffic before setting AccountingStart in the middle 
sorry to say so,  but Tor it will *NOT* be aware of traffic before it
starts accounting, better watch you wallet ;)
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-04-27 13:07:24
@_author: Hans Schnehl 
@_subject: Botnet attack? [was: Re: Declining traffic] 
someone playing around, it's rather background noise...  relax, guys ;)
[lot's of snip]
There was a scan. yes. Happens.
But these -> [bad hdr length 12 - too short, < 20] <- are *NOT* a
maliciuos attempt of something but rather a matte ofr tcpdump running against
a pflog* interface. There are different expectations about the snaplen ,
so if increasse the snaplen to sth. higher than 68 bytes the message will
disappear, it is rather harmless.
PLease see man tcpdump TCP Packets
If  the  snapshot was small enough that tcpdump didn't capture the full
TCP header, it interprets as much of the header  as  it  can  and  then
reports  ``[|tcp]'' to indicate the remainder could not be interpreted.
If the header contains a bogus option (one with a length that's  either
too  small  or  beyond  the  end  of the header), tcpdump reports it as
``[bad opt]'' and does not interpret any further  options  (since  it's
impossible  to  tell where they start).  If the header length indicates
options are present but the IP datagram length is not long  enough  for
the  options  to  actually  be  there, tcpdump reports it as ``[bad hdr
on my bsd's a snaplen on 104 is sufficient, but you might try  256 or find
the appropriate value by checking it.
tcpdump ${wtf} -s 104 -i pflog*       To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-03 22:05:11
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
Sorry for jumping in , but please notice the above command might not
not work on all versions of FBSD, at least it doesn't on a  7-Stable jail.
Maybe the following just produces a similar sufficient output: _tor at ato# id
uid=256(_tor) gid=256(_tor) groups=256(_tor)
_tor at ato# sockstat -4 | grep tor
_tor     tor        4397  7  tcp4   172.27.72.202:9050    *:*
_tor     tor        4397  8  udp4   172.27.72.202:53      *:*
_tor     tor        4397  9  tcp4   172.27.72.202:9051    *:*
_tor     tor        4397  12 tcp4   172.27.72.202:54011   [scrubbed]:9001
_tor     tor        4397  15 tcp4   172.27.72.202:59374   [scrubbed]:9001
_tor     tor        4397  19 tcp4   172.27.72.202:59673   [scrubbed]:9001
_tor     tor        4397  20 tcp4   172.27.72.202:51946   [scrubbed]:443
_tor     tor        4397  22 tcp4   172.27.72.202:60344   [scrubbed]:9001
for *not*  displaying listening ports just use _tor at ato# sockstat -4 | grep tor| sed '/\*/d' _tor     tor        4397  4  tcp4   172.27.72.202:52420   [scrubbed]:443
_tor     tor        4397  12 tcp4   172.27.72.202:54011   [scrubbed]:9001
_tor     tor        4397  13 tcp4   172.27.72.202:51736   [scrubbed]:443
It certainly is !
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-03 23:04:52
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
Not working refers to Fabian's use of procstat.  I suppose  it would, but some (like me) tend to run tor in rather minimal
lsof isn't exactly a small application, so it might just make sense using
the base system's sockstat. At least that was the idea.
Up to the one porting arm  to FBSD, I guess. To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-05 14:54:01
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
Answering to Fabian's mail, which came a minute before I was about send a
more verbose answer.
Thanks, too.  BTW where is the git repo, please ?   It did work fine under FreeBSD 7.4-PRERELEASE with sockstat the way you
suggested. I modified in src/util/connections.py again to RUN_BSD_SOCKSTAT = "sockstat -4c | grep '%s%s' "
(See Fabian's patch.) This works fine, too. Just one cycle less.
Neither of the other options though did succeed in displaying a connection
Can verify this, running arm on a host connecting to a jail's tor controlport
results in this.
An old torrc located in the  host in the same path as the jail,  I
wondered where these odd configs came from. Removing the hosts torrc
gave    Unable to load the torrc so arm is trying to read a torrc on the host in the location it knows
which is displayed from the jail, but is ignoring the jail flag.
  Sorry for not getting deeper in this right now.
To Fabian, instead of adding another patch:
Running 'pgrep tor' might show  multiple results, anything containing the string
'tor' will present it's pid.
On 7 it's 'pgrep -x' to get an exact match of the argument ,see man pgrep(1).
Thanks for the patches !
To all :
The working connection list looks great !
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-05 15:32:10
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
15:08:52 [ARM_INFO] Terminal color support detected and enabled
15:08:52 [ARM_DEBUG] GETINFO events/names (runtime: 0.0002) [1 duplicate hidden]
15:08:52 [ARM_DEBUG] GETCONF ORPort (cache fetch) [19 duplicates hidden]
15:08:52 [ARM_DEBUG] GETINFO accounting/enabled (runtime: 0.0001)
15:08:52 [ARM_DEBUG] GETINFO desc/id/Unknown (runtime: 0.0001)
15:08:52 [ARM_DEBUG] GETINFO fingerprint (cache fetch) [2 duplicates hidden]
15:08:52 [ARM_WARN] Unable to resolve tor pid, abandoning connection listing
15:08:52 [ARM_DEBUG] GETINFO config/names (runtime: 0.0012)
15:08:52 [ARM_DEBUG] GETINFO config-text (runtime: 0.0016)
15:08:51 [ARM_DEBUG] GETINFO ns/id/Unknown (runtime: 0.0002)
15:08:51 [ARM_DEBUG] GETINFO fingerprint (runtime: 0.0002)
15:08:51 [ARM_DEBUG] GETINFO address (runtime: 0.0003)
15:08:51 [ARM_DEBUG] GETINFO status/version/current (runtime: 0.0002)
15:08:51 [ARM_DEBUG] GETINFO version (cache fetch)
15:08:51 [ARM_WARN] Unable to load torrc (no such file or directory: '/path/to/torrc')
  this is the path on the host, tor is running in a jail 15:08:51 [ARM_DEBUG] GETINFO config-file (runtime: 0.0002)
15:08:51 [ARM_DEBUG] system call: ps -o pid -C tor (runtime: 0.00)
15:08:51 [ARM_DEBUG] system call: netstat -npl | grep 127.0.0.1:9051 (runtime: 0.00)      ???? 15:08:51 [ARM_INFO] system call (failed): pidof tor (error: 'pidof' is unavailable)
15:08:51 [ARM_INFO] Loaded configuration descriptions from '/tmp/arm/torConfigDescriptions.txt' (runtime: 0.000)
15:08:51 [ARM_DEBUG] GETINFO version (runtime: 0.0002)
15:08:45 [ARM_NOTICE] No configuration found at '/home/user/.armrc', using defaults
See above.
To make it short: the sockstat (bsd) option works on FreeBSD 7.4-PRERELEASE.
This is nice. See above for log.
I would avoid lsof.
To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-07 03:07:13
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
FreeBSD jails resemble linux jails mainly by name :), and most probably
have an own IP somewhere within  RFC 1918. This IP serves as the internal adress to  the jail when
called from a local subnet, and may show  multiple connections to the SocksPort,
usually IP:9050. This is, what it looks like:
[Host's public gateway IP address scrubbed]:9050  -->    0.0s (OUTBOUND)
And what it 'SHOULD NEITHER' but with proper IP  look like:
[Jail's private  IP address scrubbed]:9050  -->    0.0s (OUTBOUND)
These connections are 'inbound' to the jail's SocksPort from the host or a  private 'GETINFO config-file' will show the  path to torrc from within the jail. So arm tries to read:
The location from the host though would be Reading the file in that way, I believe, is not a good idea.
All this only applies for systems running Tor in a jail and arm from the
host. Arm works nicely with Tor if both are  running on the same host or
inside a jail on FreeBSD. To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-12-07 04:17:05
@_author: Hans Schnehl 
@_subject: Arm Release 1.4.0 
Yes,  and maybe just ignore them. IMHO there's no point in seeing these.  Well, I personally do not like anything reading files in a jail in that
way and can do without this particular feature.
And if, setting 'features.pathPrefix /path/to/jail'  will get the desired
Thanks Damian, thanks Fabian    P.S. wonder where the list sentinels will start to grumble on this ...  To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2010-01-02 21:32:50
@_author: Hans Schnehl 
@_subject: Still problems with TLS negotiation 
You need to compile the mentioned versions of Tor against openssl-0.9.8.l,
which is the one in the FreeBSD ports tree. neither 7-stable or 8-stable
ship with openssl-0.9.8.l, but the versions or Tor you are trying to run
need that version of openssl.
You do not need to change that, just install the ports version in
No, it is not ! Keep going, please :) There is a thread under Tor-relays
dealing exactly with this issue. If you want to skip the 'introduction'
you may want to see :
which handles how to compile Tor  against openssl-0.9.8.l by using the ports
systems built in routines.
If you wish not to use this routine just scroll down and you will find a
description of how to do without.          To unsubscribe, send an e-mail to majordomo at torproject.org with
unsubscribe or-talk    in the body.

@_date: 2011-05-11 16:23:56
@_author: Hans Schnehl 
@_subject: [tor-talk] Cannot upgrade tor-devel under FreeBSD 
[...] Unless you really need it, change  WITH_TCMALLOC=true to WITHOUT_TCMALLOC=true
in /var/db/ports/tor/options   and it will buld just fine.
BTW, not building tcmal?loc is the default.
Otherwise tor will try to pull something  called google-perftools-1.7,
link against it and fails. This one's the culprit.
