
@_date: 2006-03-23 14:01:28
@_author: Julius Plenz 
@_subject: TOR traffic measurement with iptables 
I'm running a TOR server. To get an idea of how much traffic my server
produces, I use some custom shell scripts which use RRDtool to make
graphs. But in the traffic graph, I want to decide betwenn "regular"
traffic and TOR traffic.
For this I set up some iptables rules and parse the outputs from
`iptables -vnxL CHAIN'. This seems to work quite well for the output,
but I don't seem to get all the inbound traffic.
These are my rules:
# Input: 4321 = Tor, 4322 = Directory
iptables -A INPUT -i eth0 -p tcp --dport 4321 -j ACCEPT
iptables -A INPUT -i eth0 -p tcp --dport 4322 -j ACCEPT
# Output: Answers to the requests and every else traffic Tor produces
# (running as userid 108)
iptables -A OUTPUT -p tcp --sport 4321 -j ACCEPT
iptables -A OUTPUT -p tcp --sport 4322 -j ACCEPT
iptables -A OUTPUT -m owner --uid-owner 108 -j ACCEPT
I'd appreciate every suggestion or hint. Thank you!

@_date: 2006-03-24 14:55:48
@_author: Julius Plenz 
@_subject: TOR traffic measurement with iptables 
Hi, Marcel!
* Marcel  [2006-03-24 09:58]:
Cool, I didn't know this file existed. Looks like it gets updated
every 60 seconds, so it fits my needs.
It'd be nice, too, if I could take a look at your Perl Script.

@_date: 2006-03-24 14:57:59
@_author: Julius Plenz 
@_subject: TOR traffic measurement with iptables 
Hi, J?rgen!
* J?rgen Schinker  [2006-03-24 12:13]:
This wouldn't make much of a difference, since I'd add up the two
values of above anywany. Putting the TOR rules on top of all other
rules doesn't seem to help much, either. :-/
