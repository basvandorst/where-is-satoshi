
@_date: 1995-12-04 21:29:32
@_author: Phil Karlton 
@_subject: New version of SSL 3.0 
SSL 3.0 protocol has been substantially changed from earlier drafts to
fix a number of performance and cyrptographic issues. The latest version
can be found as PostScript in a compressed tar file on
where  is a digit in the range [2-8]. An HTML version should be
available in a day or two. I will post the URL when that happens.
Netscape is also in the process of submitting this draft to IETF.
Questions and comments about this specification should all be directed
to ssl-talk at netscape.com. Answers and replies will be posted there. We
are quite interested in your feedback.
As new eyes see the spec for the first time, I suspect that we will be
notified about typos and areas that are not as clear as they should be.
As a result, there will probably be an update in 2 weeks or so.

@_date: 1995-12-05 17:46:20
@_author: Phil Karlton 
@_subject: New version of SSL 3.0 
[This is the second try at sending this message.]
SSL 3.0 protocol has been substantially changed from earlier drafts to
fix a number of performance and cyrptographic issues. The latest version
can be found as PostScript in a compressed tar file on
        ftp://ftp.netscape.com/pub/review/ssl-spec.tar.Z
where  is a digit in the range [2-8]. An HTML version should be
available in a day or two. I will post the URL when that happens.
Netscape is also in the process of submitting this draft to IETF.
Questions and comments about this specification should all be directed
to ssl-talk at netscape.com. Answers and replies will be posted there. We
are quite interested in your feedback.
As new eyes see the spec for the first time, I suspect that we will be
notified about typos and areas that are not as clear as they should be.
As a result, there will probably be an update in 2 weeks or so.
Philip L. Karlton               karlton at netscape.com
Principal Curmudgeon            Netscape Communications

@_date: 1995-12-10 21:22:41
@_author: Phil Karlton 
@_subject: Paul Kocher's timing attack 
The ftp server does not seem to be working. You are better off starting at
or going directly to

@_date: 1995-11-23 09:53:38
@_author: Phil Karlton 
@_subject: Java & Netscape security [NOISE] 
Alice (or someone representing themselves as Alice) said:
And that is understable.
This is a complete non sequitur. See if you can follow this: only those
authorized by the company to speak for the company are authorized speak
for the company.
There is a genuine difference between a corporate officer saying
and some engineer from Amalgamated Widget saying
The consequence of every statement by every employee being taken as
company policy is that every employee (except for public relations) will
be prohibited from contributing to any public forum or even answering
apparently innocuous questions on the net. This would not be a desirable
Still speaking for myself,
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications

@_date: 1995-10-06 18:19:33
@_author: Phil Karlton 
@_subject: Certificates, Attributes, Web of Trust 
Here is a scenario under which it would have a point. This is not totally
secure, but that does not make it useless.
1) Register e-mail addresses.
2) Send the resulting signed certificates back to the registered
   subject name.
3) After you get your signed certificate, mail it to your friend. Now
   your friend can send you signed or encrypted messages.
4) If you ever get a certificate in e-mail from somebody, feel free
   to use the telephone to verify that it is coming from somebody
   you trust.
Remember, the service is free. In this case, I think you will be
getting more than you paid for.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-10-08 01:39:18
@_author: Phil Karlton 
@_subject: NEW Netscape RNG hole 
I think you mean lFindHandle. I'm not a windows programmer, so I have
no idea if the enumerator needs to be cleaned up, but I will forward
your message to the appropriate folks here.
Not really. SEC_SystemInfoForRNG is called ONCE for each execution.
This is true for servers and for clients. Did you rig up a test
bed that called SEC_SystemInfoForRNG in a loop? In addition, if
the server cannot open any more files, it will have difficulty
delivering any information (compromised or not) to any clients.
The clients use the SEC_GetNoise data each time they go idle to
re-initialize the PRNG seed. The servers also re-initialize the
PRNG seed periodically. That function does not use any file
SEC_FileForRNG does close every file it opens. As I said before,
I don't know what the rules are for closing the enumerators.
The tested servers worked? :-)
The code that was made available for download was the same that
was in the shipped updates.
That was me (Phil Karlton) and not Jeff who put his locks (pun intended)
at risk. You haven't demonstrated to me that there is significant
weakness. I'll keep my hair for another day.
I don't think you are going to get a shirt. It's hard to mail one
to an anonymous person. On the other hand, they are not mine to
give or withhold.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-10-16 10:50:04
@_author: Phil Karlton 
@_subject: NEW Netscape RNG hole 
[I sent this to the wrong address last week. A side effect seems to that
I now I have an anonymous ID.]
Yes. The README was not as explicit on this point as my original
message. SEC_SystemInfoForRNG is indeed among the global initialization
As was stated in the README, I cannot publish that code. It's derived
from (and remarkably similar to) code that Netscape has licensed. It's
not ours to divulge.
There seems to be little point in extracting isolated lines of
code out of the source to "prove" that we use the functions we
claim to use. If you have familiarity with RSAREF or the BSAFE
toolkit, you will be able to see how we mix and extract the
"random" bits.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-10-17 20:39:40
@_author: Phil Karlton 
@_subject: Netscape rewards are an insult 
I speak for myself. I am not an official Netscape spokescritter, and
have no desires to be one.
I don't have a lot of spare time, but I do consider reading the
messages going to cypherpunks as part of my job. (Well at least some
of each message. :-)
On what topic?
I am not quite sure what problem you are talking about? NFS and MITM
ftp attacks?
Can you expand on this? I am not aware that any of the executables
we have shipped do this. If you get a compromised version of any
program (i.e. one that some attacker has changed) then that changed
version will do whatever the attacker has built it to do. This is not
a Netscape specific issue.
Firewalls and proxies help against many attacks. Without knowing
which one you mean, it's impossible to respond intelligently. (In
particular I know of no sites that allow NFS packets to cross a
firewall boundary.)
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-20 13:15:25
@_author: Phil Karlton 
@_subject: "random" number seeds vs. Netscape 
Let me start off by saying that I speak for me and not Netscape. I
also tend to be UNIX centric since I know very little (nothing?) about
the internals of PCs and Macs.
I want to address the bug Netscape has with its currently released
product with respect to seed generation. For the most part this is not
a crypto issue, but rather a system issue.  Those bits of entropy can
only be gathered in a system dependent manner.
    We are relying on the MD5 hash algorithm to gather the string of
    potentially unpredictable sequences. I am assuming that feeding
    known bits along with the unknown will not compromise the
    "randomness" of the MD5 state.
    The basic idea is to feed a sequence of information into the MD5
    hash, expecting that some of the bits for each sub-sequence would
    be only be guessable. If we get enough unguessable bits into the mix,
    then the weak link in the chain would not be the seed generation.
Here is what the client will soon be doing:
    Netscape is available on Macs, Win-16 and Win-32 versions and
    8 different UNIX platforms. The exact details for each platform are
    quite system specific. The basic idea is to feed a sequence
    of information into the MD5 hash, expecting that some of the
    bits for each sub-sequence would be unguessable.
  At program start
    On all platforms:
    For UNIX we feed the following into the MD5 hash:
    For PCs
    For MACs:
    And then on all platforms
  Each time the client goes idle
    Reinitialize the seed with the most recent user event (probably
    a button or key down) along with the mouse position, and and
    relatively high resolution clocks.
Known weaknesses:
    If your X display is not the local machine then the X protocol can
    be watched. Given that, the data for the reseeding of the MD5 hash
    will be compromised. [Any scheme that relies on random user input
    to generate a seed suffers from the same problem.]  This is not
    quite as bad as it might be. The exact time of the client becoming
    idle can only be guessed. We should be able to get a few
    unguessable bits from the microsecond part of the time-of-day
    clock each time. Enough cycles of user actions should help to make
    the hash less subject to a brute force attack.
    In fact, the entire X protocol issue is one that could take up
    another 3 pages. An SSLized version of the server would help,
    but how would anybody export it? You "xhost +" fans are doomed.
    If the user launches the client to a secure home page then there
    will be no user actions involved before the first need for a seed.
Thoughts on guessing:
    If Eve has root access to the user's workstation, all bets are off.
    Replacement of one of the system libraries or patching the client
    executable are among the attacks that would make it trivial to
    breach any part of the security. Specific measures (like computing
    a hash over the text of the program) could help against some of
    these attacks, but it is not realisitic to believe that we can
    prevent the attack from a sophisticated person with root access.
    Multi-user Unix machines present a special problem. There are those
    at Netscape that argue that anybody who has login access to your
    machine may as well be considered to have root access. There are
    enough known attacks that this is true to a large extent.  However,
    I think we can do better than just giving up. Unfortunately most of
    the sources of entropy available to the client are also available
    to the attacker. For instance, the output of "ps" is not much help
    against this form of attacker. As Jeff Weinstein said earlier and I
    echo here: specific suggestions are more than welcome.
    When Eve has access to the wire for all of the packets into and out
    of the user's workstation, then some of the networking information
    can be guessed. See above about known weaknesses if Eve has access
    to the X protocol stream.
    I am most comfortable about the "randomness" of the generated seed
    if Eve is outside a fire wall sniffing packets. The difficulty in
    guessing what processes/tasks are running on the target machine is
    quite a bit of help here.
What I would like:
    Any OS has access to a number of real-world physical sources of
    randomness. This information is not made available to a user level
    process. How long did that last seek take? Was there any noise on
    the microphone? It would be good if the OS could gather that
    information and make some set of bits available to any process that
    asks. Having this be part of all OSes would make my job easier.
    More specifically: A "getnoise()" system call in UNIX could be
    better than anything I can do and easier. Can we convince the UNIX
    vendors to start providing that?
    My life would have been simpler if this attack had been done after
    the 2.0 version of the client had been released. :-) Believe it or
    not, we were beginning to beef up the seed generation a couple of
    weeks ago. The time spent on patching the current release will not
    all go to waste, but it has cut down on my limited opportunities to
    sleep.
For those that curious: being responsible for helping to fix a bug that
is getting front page coverage in major newspapers is not nearly as
much fun as it sounds.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-20 15:28:22
@_author: Phil Karlton 
@_subject: "random" number seeds vs. Netscape 
My assumption ws that if we conservatively counted at least 300 bits of entropy,
we would have 128 for sure. Not very scientific, Did that. It talks about a lot of the pitfalls. Unfortunately it does not address
(nor can it realistically be expected to address) details of what to look for
on a particular version of an OS running on some particular platform.
Gee, I thought I pointed out that we were putting that code in as part of
the going idle.
I don't know, but I'll forward this on to our PC guys. It might be a portability
We try to be careful about dealing with the subprocess failing to run.
We are constantly trying to improve this area of our code. We are still taking
By the way, the security engineers are doing what we can to make sure that we
can expose as much of the seed generation algorithms as possible. There is a
chance we can get permission to post the code.
It doesn't hurt. It's also information that is not available to the external
evesdropper. Other than execution time, why should I remove it from the list
of bits being fed into the hash? Successfully getting this information probably
involves physical access to the machine.
We will check this one out also. For the really low resolution clocks, the
answer will be zero most of the time. :-)
I agree, but I have a hard arguing with those that asser that the security
of UNIX is weak enough that given what we are doing for the patch it will
be easier to become root from a logged in account than to hack the seed.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-25 14:43:02
@_author: Phil Karlton 
@_subject: Netscape "random" number seed generator code available 
If you look at my home page (see below), you can see a picture from about
25 years ago. If I have to shave my head, I will post before and after
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-26 17:54:15
@_author: karlton 
@_subject: Netscape as vehicle for cypherpunk agenda/the cypherpunk bully pulpit 
Netscape has already annonced that for 2.0, the user will be able to accept (trust)
(or reject) any set of certificate authorities for signing of certificates.
I briefly looked for a copy of that announcement, but I could not find it.
Philip L. Karlton                       karlton at netscape.com
Principal Curmudgeon                    Netscape Communications Corporation

@_date: 1995-09-27 20:51:49
@_author: Phil Karlton 
@_subject: Patch release of Netscape available 
On ftp://ftp.netscape.com/pub/netscape, you can find the new UNIX,
Macintosh and Windows executables. Note that these executables only
support 40-bit RC4. We are working out a mechanism to be able to
upgrade the 128-bit versions that is acceptable to the U.S.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-27 21:02:43
@_author: Phil Karlton 
@_subject: NIS library code exposure 
Once again I speak for myself and not Netscape.
While investigating one of the crashes we ended up decompling some of
the code in the C library. It turns out that in some UNIX systems, the
code in gethostbyname_yp will copy the hostname argument onto a stack
local buffer. That buffer appears to be of size MAXHOSTNAMELEN. [This
is very efficient code at destroying the stack: it does not use strcpy
or sprintf; there is an inline loop copying characters until it finds a
An unstated (in any documentaton I could find) limitation on calls to
gethostbyname is that the "name" parameter must be a limited size
string for it to work at all. I suspect this bug has been in the NIS
(nee YP) code for some time.
Do you have any daemons that run as root and do networking? Are you
sure that all of them check the length of the host name before passing
it to gethostbyname?
[Avoid the fencepost error: MAXHOSTNAMELEN is really the size of the
buffer and not the maximal string length. You need room for the
trailing NUL.]
We have not looked into the networking libraries that are typically
found on a PC or Macintosh. The exposure may also be present there.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-27 22:16:58
@_author: Phil Karlton 
@_subject: Patch release of Netscape available 
Both. We fixed the overflow bugs we could find, including all the
examples mailed to cypherpunks.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1995-09-29 21:07:23
@_author: karlton 
@_subject: Netscape hole without .Xauthority (fwd) 
If your X server is not secure, then your pass phrases
are not secure. If your pass phrases are not secure then
private keys are compromised. If your private keys are
compromised ...
She swallowed a fly! Perhaps, she'll die.
Philip L. Karlton                       karlton at netscape.com
Principal Curmudgeon                    Netscape Communications Corporation

@_date: 1995-09-29 21:21:33
@_author: karlton 
@_subject: Netscape "random" number seed generator code available 
I will mail the relevant files to Mr. Diehl.
Philip L. Karlton                       karlton at netscape.com
Principal Curmudgeon                    Netscape Communications Corporation

@_date: 1996-04-04 19:46:22
@_author: Phil Karlton 
@_subject: Netscape 2.01 fixes server vulnerabilities by breaking the client... 
This is not good enough. Many people, feeling secure on their side of a
firewall, put proprietary information in their .plan files. Since the
the Navigator is running inside that firewall, we can't give access to
that data to sources coming from outside the firewall. Given the many
ways to construct a URL, the safest was to prevent any access to the
finger port (along with a number of others).
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-04-21 09:15:53
@_author: Phil Karlton 
@_subject: Add-in encryption module to Netscape 
For exportable clients and servers, the symmectric keys for doing bulk
encryption are 40 bits.
The symmetric (RSA) keys are at least 512 bits.
Netscape cannot get permission to distribute software with "pluggable"
crypto. This and the above restrictions are the result of U.S.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-08-27 10:25:48
@_author: Philip L. Karlton 
@_subject: Message Body Suppressed... 
A system admin had a brain freeze over the weekend and was
resubmitting some messages that bounced to a broken news
server on Thursday. Some of the messages were redirected
back to their originating mailing list.
I have no idea why the message bodies were "suppressed."
I can't tell when the messages were actually resent since
the news gateway software rewrites the Date: field of the
incoming messages.
In any event, I don't believe anything sinister or intentional
was done.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications

@_date: 1996-02-08 10:16:35
@_author: Phil Karlton 
@_subject: FV's Borenstein discovers keystroke capture programs! (pictures at 11!) 
This fact that the filtering can be done on the client side is nearly irrelevant. Most people do not hit enough keystrokes in a day to prevent sending the entire keyboard stream back to the filtering agent.
Since most folks do not spend most of their time typing in nonsense phrase, you could probably pick out the First Virtual account number also. With only a little more cleverness you can get the file containing private keys. With a few thousand tries through the stream you can decrypt that file using the user's pass phrase.
If you have the ability to change the software on the user's machine to something arbitrary, why bother stopping at something as "trivial" as a single credit card number.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation

@_date: 1996-02-25 07:35:58
@_author: Phil Karlton 
@_subject: REM_ote 
Marianne Mueller is a Sun employee, not a Netscape employee. The
original quote did not make that clear.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-03-28 11:49:18
@_author: Phil Karlton 
@_subject: Edited Edupage, 24 March 1996 
Personally, I have some trouble with the work proprietary above.
    SSL 2 and SSL 3 protocols have been IETF drafts from the beginning.
    Discussion has been going on in a public forum since
    There is no trademark or copyright on the name.
    Netscape makes an SSL 2 implementation available with a no-cost
    Other implementations done directly from the SSL 2 spec
SSL 3 has been made available to the newly convened IETF Transport Level
Security working group. If you want to be involved in the process send a
message to ietf-tls-request at w3.com with "subscribe" in the Subject
SSL does depend upon an underlying reliable bytestream. This means it is
not the best choice for all applications. There are many for which it is
more than adequate.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-03-29 07:56:40
@_author: Phil Karlton 
@_subject: Edited Edupage, 24 March 1996 
My apologies for misunderstanding what you wrote. It could be that I am
oversensitive on the issue since SSL has been "accused" of being
proprietary in many forums.
I am not an expert, but I do have some familiarity, and I wasn't talking
about it.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-05-03 10:57:48
@_author: Phil Karlton 
@_subject: [Fwd: Cylink can export 128-bit DH?] 
I cannot speak for the general case, but in SSL 3, the 3DES_EDE_CBC
cipher uses three keys.
Philip L. Karlton		karlton at netscape.com
Principal Curmudgeon		
Netscape Communications
     They that can give up essential liberty to obtain a little
     temporary safety deserve neither liberty nor safety.

@_date: 1996-11-04 16:35:04
@_author: Philip L. Karlton 
@_subject: free SSL CAs? 
It's up to the user (at least with the Netscape Navigator) to decide
what CA certificates or particular server certificates to trust.
Self-signed certificates are logically at the root of any certificate
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation
    Everything should be made as simple as possible, but not simpler.

@_date: 1996-10-02 09:34:24
@_author: Philip L. Karlton 
@_subject: Mousepad RNG's? 
The problem was with the seed; it was especially vulnerable to attacks
from somebody running on the same machine. Sufficient entropy is now
obtained during initialization and the PRNG is reseeded reasonably often
during execution. For the Navigator, this is every time the user event
loop cycles.
A pointer to the fixed code was posted to cypherpunks last year.
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation
    Everything should be made as simple as possible, but not simpler.

@_date: 1996-10-24 17:45:47
@_author: Philip L. Karlton 
@_subject: PIS_son 
Please explain your position. The engineering community at Netscape is
doing what it can, within the law, to provide strong crypto to our
Philip L. Karlton			karlton at netscape.com
Principal Curmudgeon			
Netscape Communications Corporation
    Everything should be made as simple as possible, but not simpler.
