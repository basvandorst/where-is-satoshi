
@_date: 1994-08-01 13:16:03
@_author: Bruce Schneier 
@_subject: PKP/Cylink Lawsuit 
It is strange.  Actually, Caro-Kann and RSADSI are partners, as
Cylink apparently formed a subsidiary just to shelter themselves
from the liability of being partners with Bidzos.  Cylink has
some RSA-based products, and Bidzos had formally threatened (in
writing) a lawsuit claiming Cylink doesn't have an RSA license.
Cylink claims Bidzos denied them a license, even though they have
agreements which obligate him otherwise.  It is unclear to me
whether this is just a royalty dispute (ie Cylink wants a *free*
license) or whether Bidzos doesn't want them in the RSA business.
At any rate, they appear to be bitter enemies now.  They have
jeapordized all of their future patent royalties by going to

@_date: 1994-12-11 15:26:26
@_author: Bruce Schneier 
@_subject: Articles on RC5 and GOST in January 95 Dr Dobbs Journal 
In the Jan 95 issue of Dr Dobbs Journal, you will find the following:
Remember, you can export cryptographic source code in paper form.

@_date: 1994-07-01 10:16:22
@_author: Bruce Schneier 
@_subject: Programmer Wanted - Second Salvo 
I recently posted a posting (whatever) looking for a programmer to do
some contract work.  After talking with a few people, someone suggested
that I post what I want on the mailing list.
What I am looking for is someone to do some of the odd programming
projects that I have been wishing someone would do.  This isn't work
that I have a contract to do, just things that I want to see done.
Most of it, probably all of it, will end up as public domain code.
I would do it myself, but 1) I am too busy, and 2) I am not really a good programmer.  I am willing to pay for time, but I can't
promise wages competitive with a commercial contract.
This stuff won't make anyone rich, but it will give someone a piece of
code you can put on your resume and may do some good for the world.
First I am looking for a simple MS-DOS file encrypter.  Something that
works off the command line and uses a few different algorithms.
Given that all of the algorithms are already in public domain C, I can't
believe this will take all that long.
After that I have an algorithm from Japan that I'd like to see coded up
in C.  Then an algorithm from South Africa.  Then some stuff on stream
ciphers.  And so on.
If anyone is interested, please give me some idea of what you would
consider a fair hourly rate.  And a telephone number, so I can call
and talk with you.
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier at chinet.com

@_date: 1994-07-01 21:15:42
@_author: Bruce Schneier 
@_subject: Dr. Dobbs Dev. Update 1/5 July 94 & Schneier 
EUROCRYPT '94 CONFERENCE
In the cryptographic world--at least, the cryptographic world
outside the military--there are two major annual conferences:
Crypto and Eurocrypt.  Eurocrypt '94 was held in Perugia, Italy,
on May 9-12.  There were about 300 people in attendance,
representing the best in academic cryptography from five
continents (I didn't notice anyone from South America or
Antarctica).  A total of 37 papers were presented at the main
session, and another twenty or so at an informal "rump session"
one evening.
Much of what was presented was very theoretical, and only of
marginal interest to front-line programmers actually implementing
this stuff.  Here is a list of what I found useful and important:
     Feedback with Carry Shift Registers (FCSRs):  Linear
Feedback Shift Registers (LFSRs) have been the workhorse of
military cryptography for years.  Goresky and Klapper have
discovered a new class of shift registers which should prove to
be just as useful.  There are analogues for most of the LFSR
theory that apply to FCSRs.  Algorithms that were implemented
with LFSRs can be implemented with FCSRs, possibly with different
degrees of security.  Even more interesting should be
cryptographic algorithms which use a mixture of LFSRs and FCSRs. I expect this development to dramatically change the development
of stream ciphers.
     Synthesis of Public-Key Algorithms:  There are a lot of
public-key digital signature algorithms in the literature based
on the problem of taking discrete logarithms in a finite field: ElGamal, Schnorr, and the Digital Signature Standard (DSS) are
three examples.  Nyberg and Rueppel presented a paper which
unified all of these algorithms (108 in total) into one unified
family.  They also showed how to do encryption with all of them. What this does it allow further research to proceed on the entire
family of algorithms, and not just on one particular one.  It
also lays to rest Schnorr's claim that the DSS infringed on his
patent; it is now clear that both Schnorr and DSS are specific
cases on this general algorithm.
     The Digital Signature Standard:  Naccache, M'Raihi,
Raphaeli, and Vaudenay presented enhancements to the DSS: one
that increases speed, one that reduces storage requirements
(important for smart-card implementations), etc.  Their most
interesting enhancement is the ability to verify multiple
signatures in a single operation.  A complaint against DSS is
that signature verification is slow; the batch verification
method in this paper should silence that complaint once and for
     Visual Cryptography:  Shamir developed a one-time-pad
cryptosystem that is suitable for encrypting visual images.  The
key is a pattern of black and white pixels on a transparency; the
ciphertext is another pattern of black and white pixels.  Overlay
the key on the ciphertext and the message appears.  This is
unconditionally secure; even alien civilizations with undreamed-
of computing power cannot break this cryptosystem.  Applications
include sending an encrypted message via fax: the receiver can
carry the key transparency with him and can receive the encrypted
fax from an insecure machine.  Cool stuff.
     Designated Confirmer Signatures:  Undeniable signatures are
signatures which need permission from the signer to verify. Applications include computer publication of data.  The recipient
of the data wants to be able to verify the publisher's signature,
so he knows that the data is authentic.  The publisher only wants
his signature to be verifiable by people who have paid for the
data, and not by people who have pirated it.  Undeniable
signatures do that.  Chaum's extension allows the publisher to
designate an agent who can help receivers verify the signatures.
     Differential and Linear Cryptanalysis:  Both of these
techniques were further refined by several people.  Two papers,
one by Biham and another by Chabaud and Vaudenay, looked at
similarities between the two.  Matsui found an alternate order
for the S-boxes that is resistant to linear cryptanalysis, but
unfortunately it is weak against differential cryptanalysis.
     Self-Shrinking Generator:  The shrinking generator was a big
hit at Crypto '93.  Basically, a LFSR is decimated by another
LFSR.  This stream algorithm is simple to implement, and looks
very strong.  Meyer and Staffelbach developed a variant of this
generator, which uses a single LFSR.  The even bits of the
generator are used to decimate the odd bits.  This is even
simpler to implement and is just as strong.
     Formal Protocol Design:  One of the problems with
authentication protocols, like Kerberos, is proving that they are
correct.  There's nothing more embarrassing than fielding a
protocol and finding a security problem two years later. Syverson and Meadows have developed an expert system that helps
detect security problems in protocols.
Several interesting papers were presented at the rump session.  Biham presented a paper showing that triple-DES in cipher
feedback mode, with triple-DES as the bock cipher, is more secure
than a large number of variant possibilities.  Knudsen found a
class of "weak" keys for DES and LOKI when those algorithms are
used as one-way hash functions.  There is nothing to worry about;
the odds of picking such a key at random is very small.  Charnes
and O'Connor presented some initial comments on the GOST
algorithm, an encryption algorithm from the Soviet Union.
Also interesting were the side discussions.  At least two
cryptographers are working on something called "higher-order
differential cryptanalysis."  Although this technique has had
great success against DES with only 5 rounds, no one knows how to
extend it to full 16-round DES.  One cryptographer has developed
an alternate set of DES S-boxes that is resistant to both
differential and linear cryptanalysis, while another has
developed a method for generating key-dependent S-boxes that
increase the effective key size of DES beyond 56 bits.  If there
are going to be any more attacks against DES, this--and Hellman's
attempts to combine differential and linear cryptanalysis--is
where to watch for them.
RSA-129 was recently factored.  This is the 129-digit number, the
product of two large primes, that was featured in Martin
Gardner's original Scientific American column about the RSA
algorithm.  Although this doesn't affect the security of the
1024-bit numbers used in programs like PGP, it does show how far
we've come in fifteen years.  Gardner was sure this number would
not be factored for millions of years.
The other big news is a security problem with the Secure Hash
Algorithm (SHA), discussed in the Apr 94 DDJ.  The cryptographers
at NSA have found a problem with the algorithm.  They won't tell
anyone what it is, or even how serious it is, but they promise a
fix soon.  Everyone is waiting with baited breath.

@_date: 1994-07-02 14:44:18
@_author: Bruce Schneier 
@_subject: Password Difficulties 
Figure that each English character has 1.8 bits of entropy.  (This is
a conservative number, because it doesn't take into account case, spacing,
or punctuation.)  If I want a passphrase that will map into a 64-bit keyspace, I need at least a 35-chararcter phrase.
I generally assume that I need about one word per byte of key.  Thus, if
I want to generate a 64-bit key, I need an eight-word phrase.

@_date: 1994-07-06 12:49:05
@_author: Bruce Schneier 
@_subject: stream ciphers and realtime communications? 
Stream ciphers are very efficient in hardware encryption applications, but
suck eggs in software.  They have been the workhorse of military cryptography
for at least 40 years, but those are all hardware applications.  If you
are working in software, it is much easier to deal with data in 64-bit
blocks than in individual bits.  The Shrinking Generator, which has only
two LFSRs, is slower than DES in software.  You need to iterate the
Shrinking Generator 64 times to encrypt the data that DES handles in just
one iteration.

@_date: 1994-07-06 14:48:31
@_author: Bruce Schneier 
@_subject: Please post your article 
Bruce Schneier
                                                730 Fair Oaks Ave
                                              Oak Park, IL  60302
                                                   (708) 524-9461
                                                        750 words
       IDEA - THE INTERNATIONAL DATA ENCRYPTION ALGORITHM
For the past fifteen years, most of us have relied on the Data
Encryption Standard, or DES, for encryption.  It's a good
algorithm, and very secure against the mid-1970s technology is
was designed for.  Advances in computing power and new
discoveries in cryptanalysis have made the algorithm vulnerable. DES is no longer secure against the world's most powerful
adversaries.  Cryptographers are looking for alternatives to
serve their needs well into the 21st century.  IDEA may be the
current best choice.
IDEA is the International Data Encryption Algorithm, and it was
invented in 1991 by James Massey and Xuejia Lai of ETH Zurich in
Switzerland.  An earlier variant of the algorithm was called PES:
Proposed Encryption Standard.  After strengthening the algorithm
against differential cryptanalysis, they changed its name to
IPES, for Improved Proposed Encryption Standard, and then to
The algorithm is structured along the same general lines of DES. It is an iterated block cipher, with a 64-bit block size and a
128-bit key size.  "Iterated" means that the algorithm uses a
simple encryption function multiple times.  "Block cipher" means
that the algorithm encrypts data in blocks: 64 bits of plaintext
go in one end, and 64 bits of ciphertext come out the other.  And
the algorithm accepts a 128-bit key.
This means that IDEA can be a plug-in replacement for DES, only
with a longer key length.  IDEA can be used in all the different
modes of operation--electronic codebook, cipher block chaining,
output feedback, and cipher feedback-- specified for DES in FIPS
PUB 81 or ANSI X3.106.
The design philosophy behind IDEA is one of "mixing operations
from different algebraic groups."  The operations are XOR,
modular addition, and modular multiplication.  All operations are
based on 16-bit words, and hence are efficiently implemented in
software.  (DES has numerous bit twiddling operations, making it
very inefficient in software.)  IDEA only has eight iterations,
compared with DES's 16, but each IDEA iteration can be thought of
as a double DES iteration.  IDEA is also faster than DES when
implemented in software.
IDEA's 128-bit key length over twice that of DES; its key length
is even longer than triple-DES.  And it is much faster than
triple-DES.  A brute-force attack against IDEA would have to try
2^128, or 3*10^38, possible keys.  Michael Wiener's brute-force
DES-cracking machine, which could find a DES key in an average of
3.5 hours would require 10^18 years to break IDEA.  A machine a
million times faster would still require 10^12, or one trillion,
years to break IDEA.
Does this mean that IDEA is secure?  Is there a more efficient
way to break IDEA than brute force?  No one knows.  IDEA is a
very new algorithm.  Remember that it took cryptographers fifteen
years of studying DES to invent differential cryptanalysis,
something that the NSA knew about all along.  Who knows what
tricks the NSA knows about now that allows them to break IDEA. Maybe they know none.  Maybe they know something that we will
discover for ourselves around the year 2006.
There are no assurances in the cryptography business.  Several
academic groups have tried to cryptanalyze IDEA with no success. Yet.  Several military intelligence agencies have tried to
cryptanalyze IDEA; they're not talking about what they found. IDEA is a good-looking algorithm, but it is also a new algorithm. Ten years from now we will all consider it an amazing feat of
security or an impressive failure.  I would bet on the former,
but recognize that it is a bet.
The most widespread product that uses IDEA is PGP: Pretty Good
Privacy.  PGP uses IDEA in cipher feedback mode for data
encryption.  Several other security companies offer the algorithm
as an optional alternative to DES.  It is available both in
software and as a custom ASIC.
Details of the algorithm (with source code) can be found in:      X. Lai, J. Massey, and S. Murphy, "Markov Ciphers and
     Differential Cryptanalysis," Advances in Cryptology--
     EUROCRYPT '91 Proceedings, Berlin: Springer-Verlag, 1991,
     pp. 17-38.
     B. Schneier, "The IDEA Encryption Algorithm." Dr. Dobbs
     Journal, Dec 93, pp. 50-56.
     B. Schneier, Applied Cryptography, New York: John Wiley &
     Sons, 1994.
IDEA is patented in the United States (J.L. Massey and X. Lai,
"Device for the Conversion of a Digital Block and the Use of
Same," U.S. Patent  25 May 1993) and in Europe.  The
patents are held by Ascom-Tech AG.  There is no license fee
required for noncommercial use.  Commercial users interested in
licensing the algorithm should contact: Dr. Peter Profos, Ascom
Tech AG, Solothurn Lab, Postfach 151, 4502 Solothurn,
Switzerland; telephone +41 65 242 885; facsimile +41 65 235 761.

@_date: 1994-07-31 21:50:23
@_author: Bruce Schneier 
@_subject: Philadelphia Enquirer Story on Clipper 
PHILADELPHIA INQUIRER
                  Copyright Philadelphia Newspapers Inc. 1994
 DATE: SATURDAY  July 23, 1994
 PAGE: A01                                         EDITION: FINAL
 SECTION: NATIONAL                                 LENGTH: LONG
 GRAPHICS: PHOTO AND DIAGRAM
 SOURCE: By Michael L. Rozansky, INQUIRER STAFF WRITER
                PHONE-SCRAMBLING CHIP STIRS A DEBATE ON*PRIVACY*
                 U.S. IS PROMOTING A CODE SYSTEM IT CAN CRACK.
    The FBI, CIA and National Security Agency say that advances in technology are making it impossible to wiretap and decode the phone calls and computer communications of terrorists and criminals.
    So they came up with this solution:
    This little square of silicon sealed in black plastic is called the Clipper chip that Uncle Sam wants businesses and individuals interested in keeping their telecommunications confidential to buy. It scrambles conversations so that no one who eavesdrops on a call can understand them.
    No one, that is, except the U.S. government.
    That's because the government's concept was to keep a copy of the electronic key to each Clipper chip that, with a court order, would allow it to unscramble calls and listen in.
    All this has provoked what one White House official has dubbed the ''the Bosnia of telecommunications policy.''
    The first great civil-liberties battle of the '90s is here, and it's being fought over*privacy*in cyberspace.
    This week the Clinton administration took the first step toward clipping the Clipper. Vice President Gore wrote to a congressional critic that the administration would consider alternatives. Indeed, it wanted to explore industry alternatives, he said.
    But there are no signs that the government is altering its fundamental drive to make sure that changes in technology and advances in encryption do not make it impossible for the government to tap into telephone conversations and data communications.
    Some critics hailed Gore's letter as a major victory, others said it was less than it seemed.
    ''They are not withdrawing Clipper, they are not relaxing export controls, it doesn't change anything,'' said Dave Banisar, a policy analyst at the nonprofit Electronic*Privacy*Information Center in Washington.
    The government says the Clipper chip lets people and businesses protect their*privacy,*while giving police and spy agencies the ability to wiretap, with a court order, to catch terrorists, drug dealers and mobsters.
    Opponents say it's part of a broad government assault on*privacy.*
    ''Clipper is the tip of the iceberg,'' says Banisar. ''It's part of a big push by law enforcement to have their fingers in a lot of pies.''
    In addition to Clipper, Uncle Sam has come up with Capstone, a system similar to Clipper, for high-speed computer communications. The government also wants the telephone industry to spend what may be billions of dollars reworking its system to make it easier for the government to tap     These and other plans have aroused the fury of an unlikely coalition of civil-liberties advocates and high-tech industry groups, which say those plans are unworkable, unnecessary and harmful to business.
    IBM and the International Chamber of Commerce oppose Clipper. So do the Cypherpunks, a band of cryptography buffs, computer hackers and programmers concerned with*privacy.*An anti-Clipper petition circulated on the Internet gathered 47,000 electronic signatures.
    The government was so intent on promoting Clipper that it eased rules covering its export while continuing to ban the export of competing systems capable of creating encryption that is almost unbreakable, known as ''strong encoding'' systems. Some strong encoding systems, which are classified as ''munitions,'' can be obtained free on the Internet.
    One result is that U.S. companies are losing business to foreign competitors that make the same type of encryption systems the United States refuses to export, said Douglas Miller, government-affairs manager for the Software Publishers Association. He said 340 foreign crytographic systems were available in 31 countries.
    But issues of liberty versus government prying are what dominate the     ''If the government succeeds in this effort, the resulting blow to freedom and*privacy*could be immeasurable,'' Jerry Berman, executive director of the Electronic Frontier Foundation of Washington, the leading cyberspace civil- liberties organization, wrote in an electronic memo posted on Internet bulletin boards.
   *''Privacy*is necessary for democracy and liberty,'' said cryptographer Bruce Schneier, author of Applied Cryptography. ''You can't have a real democracy if you're required to tell the government all your secrets.''
    He and other critics say the Clipper plan is ripe for mistakes or government abuse that will compromise*privacy.*
    Law-enforcement officials counter that the Clipper and the related proposal, the Capstone chip, do not give them any greater right to wiretap than they have now.
    They frame the debate in different terms, saying that the key issue is what happens if the government cannot break the encryption used by major     ''There's a potential for dire consequences, absolutely,'' said Jim Kallstrom, FBI special agent in charge of New York's electronic surveillance unit. ''If you're working on a kidnapping case, it's no good to get the criminal information a week later.''
    He adds: ''Are we going to have a cop on the (information) superhighway, or are we going to create a sanctuary for criminals?''
    Government officials say using Clipper - and its Capstone sister chip - is voluntary.
    ''There's nothing to say people can't ignore the government endorsement and use proprietary products,'' said F. Lynn McNulty, associate director for computer security at the National Institute for Standards and Technology, which developed the system.
    In practice, critics say, the government is not so neutral. Companies that have contracts to do sensitive work for the government, for example, may be required to use Clipper encryption. And the government is buying Clipper chips - the FBI alone has ordered 9,000 - which creates a market for Clipper and encourages more purchases. And the ban on exports of competing strong encoding systems also favors Clipper, the critics assert.
                                       *
    The Clipper chip was born largely out of fear - fear that the three-
letter police and spy agencies would lose their ability to wiretap.
    By the late '80s, the U.S. government worried that its old standard form of encoding, called the Data Encryption Standard, was getting easier to crack by newer, more powerful computers. Work began on a new standard form of     While that was underway, in 1991, AT&T Corp. told the government it was going to come out with a mass-market voice-scrambling box: the $1,195 Surity     Until then, very strong encryption was generally used for data, not voice communications, said the FBI's Kallstrom. For example, banks use encryption to electronically transfer billions of dollars. But most scrambling systems for phone calls degraded sound quality so badly they were rarely used, he     ''For the first time, there was something available that . . . was small, compact, inexpensive,'' and, ''for all practical purposes to law enforcement, was virtually unbreakable,'' Kallstrom said. ''That changed the balance of     The government's response was Clipper. In April of 1993, the government introduced a secret mathematical scrambling system, the Skipjack algorithm, which was encased in a computer chip to prevent tampering. It was supposed to be 16 million times tougher to crack  than the previously endorsed system.
    When the government asked for comment, 320 people responded. Only two wrote in support. Despite that, the Clipper plan was endorsed by the White House and became government policy in February.
    The government persuaded AT&T to use the Clipper system in its Surity box.
    AT&T, meanwhile, also sells two other versions of the box using its own proprietary encoding systems.
                                       *
    To limit government access to scrambled messages to occasions when a court authorizes a wiretap, Clipper uses a type of encryption called a ''key escrow'' system. When each Clipper chip is programmed at Mykotronx, in Torrance, Calif., an extra numerical key is created that can be used to decode that Clipper's signals. The extra key is split in two, with each half going to an escrow agent - in this plan, two different government agencies.
    Later, if law enforcement finds that a court-authorized wiretap picks up a Clipper-scrambled conversation, it can go to the escrow agents, get the key parts, assemble them and use the resulting key to decode that and subsequent calls from the tapped phone.
    In a separate, controversial move, the FBI proposed a ''Digital Telephony'' law that requires phone companies to modify their switching systems to facilitate wiretaps. The FBI says that new digital technology makes wiretapping tough, and new phone services such as call-forwarding and speed- dialing let people bypass wiretaps.
    The Digital Telephony bill would give the agency continued access to the phone system not just for wiretaps, but for  data on where and when calls are     ''If you think crime is bad now,'' FBI Director Louis J. Freeh warned in a May speech, ''just wait and see what happens if the FBI one day soon is no longer able to conduct court-approved electronic surveillance.''
    The bill, which has not been introduced yet, is being fought by the United States Telephone Association, which says it could cost $2 billion to implement and would raise public suspicions about a government ''trapdoor'' in the phone system.
    Opponents say it also will enable police to gather information about people's consumer, spending and even political habits from monitoring their transactions over phone or cable-television lines.
    ''It makes the presumption,'' Banisar said, ''that law enforcement and the military have needs above everyone else, and we have to satisfy those needs first and then satisfy everyone else's basic civil rights.''
    Freeh and other law-enforcement officials say electronic surveillance has been critical in cracking major cases of terrorism, drugs and kidnapping - such as the arrests in Chicago's El Rukn street gang, purportedly acting for Libya in a plot to shoot down a commercial airplane with a stolen military     Civil libertarians find the FBI's arguments misleading and inaccurate.
    ''They have a couple of horror stories about child molesters or whatever, but they account for just the smallest fraction of what wiretaps are used for,'' said Banisar, of the*privacy*information center.
    Banisar said law enforcement seeks and gets court permission for fewer than 1,000 electronic surveillance cases a year (there were 976 cases in 1993), but that those include electronic bugs. Banisar said 70 percent of the cases concern drugs.
    Banisar notes that in the El Rukn case the gang bought the stolen military rocket in an FBI sting.
    Clipper's critics concede that police may fail to solve some cases if strong encryption is widely available.
    ''I am willing to accept that law enforcement will be hamstrung. You're giving up some safety in exchange for personal freedom,'' said cryptographer Schneier. He said strong encryption protects ''both terrorists and Chinese     Daniel J. Weitzner, senior staff counsel of the Electronic Frontier Foundation, said the government certainly has the right to wiretap - but ''nowhere does it say that law enforcement is entitled to success in every search, which is what (Clipper) is saying.''
    Clipper's opponents say it's ineffective for a variety of reasons. Because its use is voluntary, they say, crooks can easily use some other kind of encryption.
    ''What criminal's dumb enough to go to Radio Shack to buy an encrypting device that says 'FBI approved' stamped on the package?'' Weitzner asks.
    That's not the point, say Clipper's defenders. They say the Clipper program will ensure at least that the biggest-selling form of encryption can be cracked. And, they add, crooks are often really dumb, pointing to lawbreakers who leave fingerprints, make calls from their home phones and -  in the World Trade Center bombing - tried to get back a deposit on the rented truck that carried the bomb.
    Allowing non-Clipper systems also seems to undercut any value Clipper has.
    ''It's doubtful that foreign buyers, especially foreign governments, will want an encryption system (if) . . . the U.S. government holds and has access to the keys,'' said Nanette DiTosto, manager of telecommunications for the U.S. Council for International Business.
    She said multinational companies might have to buy two encryption systems - one to deal with the U.S. government and another to deal with customers and governments overseas.
    Clipper's defenders brush aside many of the protests and focus instead on the ramifications of a world without Clipper. Dorothy E. Denning, chairman of the computer-science department at Georgetown University and a supporter of the Clipper plan, said such a world would be like ''highways without traffic lights and people without driver's licenses.'' She said the public was far more concerned with crime than*privacy.*
    Weitzner says the government's effort is tantamount to trying to suppress a language. ''Can the government ban a language it doesn't understand?'' asks Weitzner. ''If there are only two people left in the world who speak Navajo, can the government ban them from using the language?''
 GRAPHICS: PHOTO (3)
  1. (Uncaptioned) Clipper chip
  2. Analyst Dave Banisar of the Electronic*Privacy*Information Center said law enforcement wants ''to have their fingers in a lot of pies.'' (The Philadelphia Inquirer / MICHAEL MALLY)
  3. Daniel J. Weitzner of the Electronic Frontier Foundation says the government's Clipper effort is like trying to suppress a language. DIAGRAM (2)
  1-2. The Clipper Chip Controversy: How it works; Government Access (SOURCE: Mykotronx Inc., Federal agencies; The Philadelphia Inquirer / CRISTINA RIVERO)
 KEYWORDS: US GOVERNMENT COMPUTER COMMUNICATIONS SCIENCE AND TECHNOLOGY*PRIVACY* RIGHT
END OF DOCUMENT.

@_date: 1994-07-31 22:14:05
@_author: Bruce Schneier 
@_subject: Lawsuits Against PKP 
Two lawsuits were recently filed in federal court, northern district
of Calif, which may cripple Public Key Partners.
Cylink v. RSA Data Security, C-94-02332-CW, June 30, 1994, San Fran.
It alleges that the RSA patent is invalid.  RSA Data had denied Cylink
a patent license.
Schlafly v. Public Key Partners, C-94-20512-SW, July 27, 1994, San Jose.
It alleges that almost all of the PKP patent claims are invalid and
unenforceable.  From the complaint:
You can probably get a copy from the court by calling
Kinko's, 408-279-0655, 408-295-4336 fax.  Ask for document It is bulky, at about 270 pages.
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier at chinet.com

@_date: 1994-06-16 18:56:27
@_author: Bruce Schneier 
@_subject: no subject (file transmission) 
APPLIED CRYPTOGRAPHY
                         ERRATA
              Version 1.5.9 - June 15, 1994
This errata includes all errors I have found in the book,
including minor spelling and grammatical errors.  Please
distribute this errata sheet to anyone else who owns a copy of
the book.
Page xvii:  Third paragraph, first line:  "Part IV" should be
"Part III".
Page xviii:  "Xuija" should be "Xuejia".  "Mark Markowitz" should
be "Mike Markowitz".
Page 1:  First paragraph, fourth line:  "receiver cannot
intercept" should be "intermediary cannot intercept".
*****Page 2:  Third line:  "Outside the historical chapter"
should be "Outside the Classical Cryptography chapter".
*****Page 3:  Figure 1.2:  "with key" should be "with one key".
*****Page 4:  Eleventh line:  Delete the sentence which begins: "In instances where...."
*****Page 5:  "Chosen-plaintext attack":  "but they also choose
the encrypted plaintext" should be "but they choose the
plaintexts to encrypt".
Page 6:  Sixth and seventh lines:  "against symmetric" should be
"against a symmetric".
Page 8:  Second paragraph, first line:  "q code" should be "a
Page 10:  Second paragraph, fifth line:  Reference "[744]" should
be "[774]".
Page 11:  Second paragraph:  "The rotations of the rotors are a
Caesar Cipher" should be "Each rotor is an arbitrary permutation
of the alphabet".
*****Page 13:  Third paragraph:  Delete parenthetical remark. Fourth paragraph, second line:  "the key against" should be "the
ciphertext against".  Fifth paragraph:  "Shift the key" should be
"shift the ciphertext".  And:  "with text XORed with itself"
should be "with the plaintext XORed with itself shifted by the
key length."
*****Page 14:  Third line:  "to be any possible" should be "to
correspond to any possible".
Page 15:  Section 1.3, first line:  "Throughout this book use"
should be "Throughout this book I use".
*****Page 22:  Step (4): "gives the title" should be "gives the
title and keys".
Page 25:  "Attacks Against Protocols," first paragraph:  "the
protocol iself" should be "the protocol itself".
*****Page 27:  "One-Way Functions," second paragraph:  "millions
of years to compute this function" should be "millions of years
to compute the reverse function."  Fourth paragraph: "For
example, x^2" should be "For example, in a finite field x^2."
Page 28:  Third paragraph, third and fourth sentences should be
"How to put mail in a mailbox is public knowledge.  How to open
the mailbox is not public knowledge."
Page 29:  Third paragraph:  "If you only want" should be "If you
want only".
Page 30:  Fourth line:  "symmetric cryptosystems: by distributing
the key" should be "symmetric cryptosystems: distributing the
*****Page 30:  "Attacks Against Public Key Cryptography," first
sentence:  "In all these public-key digital signature protocols"
should be "In all these public-key protocols".  Second
paragraph:  "The obvious way to exchange" should be "The obvious
way to get".  And: "The database also has to be protected from
access by anyone" should be "The database also has to be
protected from write access by anyone".  Last paragraph:
"substitute a key of his choosing for Alice's" should be
"substitute a key of his own choosing for Bob's".
Page 30:  Last line:  "substitute that key for his own public
key" should be "substitute his own key for that public key".
Page 32:  Ninth line:  Delete the word "encrypted".
Page 34:  "Signing Documents with..."  First sentence:  "too
inefficient to encrypt long documents" should be "too inefficient
to sign long documents".
*****Page 35:  Step (4), second sentence should be:  "He then,
using the digital signature algorithm, verifies the signed hash
with Alice's public key."
Page 36:  Second line:  "document encrypted with" should be
"document signed with".  "Multiple Signatures," step (4):  "Alice
or Bob sends" should be "Alice sends".
Page 38:  Fifth paragraph:  "V_X = E_X and that S_X = D_X" should
be "V_X = E_X and S_X = D_X".
Page 40:  Third line:  "computer can exist" should be "computer
can be".  Second paragraph:  Delete "should be runs of zeros and
the other half should be runs of ones; half the runs".  At the
end of the sentence, add "The distribution of run lengths for
zeros and ones should be the same."
*****Page 41:  Second paragraph:  At the end of the paragraph,
add:  "Cryptographically secure pseudo-random sequence generators
can only be compressed if you know the secret."  Last paragraph
should be: "The output of a generator satisfying these three
properties will be good enough for a one-time pad, key
generation, and any other cryptographic features that require a
truly random sequence generator."
Page 44:  Ninth line: "for Alice's" should be "for Bob's".
*****Page 46:  "Key and Message Transmission":  Second steps (1)
and (2) should be (5) and (6).
*****Page 49:  Second line:  "the user" should be "Alice".  First
protocol, steps (1) and (3):  "secret key" should be "private
Page 50:  First step (3):  "With Alice's public key" should be
"with "Alice's" public key."
Page 51:  Step 5:  "with what he received from Bob" should be
"with what he received from Alice".
Page 55:  First step (2):  At the end of the step, add:  "He
sends both encrypted messages to Alice."
Page 58:  Last line: "Alice, Bob, and Carol" should be "Alice,
Bob, Carol, and Dave".
*****Page 59:  First line: "Alice, Bob, and Carol" should be
"Alice, Bob, Carol, and Dave".  Second paragraph:  "All Alice,
Bob, and Dave, combined, know" should be "All Alice, Bob, and
Dave, each, know".
*****Page 63:  Tenth line:  "signed timestamp" should be "signed
timestamped hash".  Step (3) is actually part of step (2), and
step (4) should be step (3).
*****Page 66:  Second line from bottom:  "identity" should be
Page 69:  Last line:  "tried to recover her private key" should
be "tries to recover Alice's private key".
*****Page 72:  The second set of steps (1) and (2) should be step
(3) and step (4)
*****Page 73:  "Bit Commitment Using One-Way Functions":  The
general class of one-way functions is suitable for this protocol,
not only one-way hash functions.  Last paragraph:  Second and
third sentences should be "Alice cannot cheat and find another
message (R_1,R_2',b'), such that H(R_1,R_2',b') = H(R_1,R_2,b). If Alice didn't send Bob R_1, then she could change the value of
both R_1 and R_2 and then the value of the bit."
Page 75:  First paragraph after quotation:  "over modem" should
be "over a modem".
Page 76:  First paragraph of text, third sentence: "Additionally,
f(x) must produce even and odd numbers with equal probability"
should be "Additionally, Alice should ensure that the random
number x takes even and odd values with equal probability". Fifth sentence: " For example, if f(x) produces even numbers 70%
of the time" should be "For example, if x takes even values 75%
of the time".
*****Page 77:  "Flipping Coins into a Well," first line: "neither party learns the result" should be "Alice and Bob don't
learn the result".  Third line:  parenthetical remark should be: "Alice in the first two protocls and Bob in the last one".
Page 78:  Step (1):  "Alice, Bob, and Carol all generate" should
be "Alice, Bob, and Carol each generate".
Page 80:  Second paragraph, second sentence.  It should read: "A
general n-player poker protocol that eliminates the problem of
information leakage was developed in [228]."
*****Page 81:  Last sentence:  delete it.
*****Page 83:  Fourth line:  "five" should be "n", twice.  Step
(2):  "This message must" should be "These messages must". Second sentence after protocol:  "Neither the KDC" should be
"Before this surerendering, neither the KDC".
*****Page 87:  Second sentence after protocol:  "so that Bob"
should be "so that Victor".  "Hamilton Cycles":  "Alice" should
be "Peggy".
*****Page 88:  "Graph Isomorphism", second sentence:  "Peggy
knows that two graphs, G_1 and G_2, are isomorphic" should be
"Peggy knows the isomorphism between two graphs, G_1 and G_2."
Page 90:  Last paragraph:  "step (3)" should be "step (4)".
Page 91:  Second line:  "step (3)" should be "step (4)".
Page 93:  "Blind Signatures," first line:  "An essential in all"
should be "An essential feature of all".
Page 98:  First paragraph after protocol, fourth line:  "to
determine the DES key with the other encrypted message" should be
"to determine the DES key that the other encrypted message was
encrypted in."
Page 115:  "Protocol  third paragraph:  "together determine
if f(a,b)" should be "together determine f(a,b)".
*****Page 121:  Second paragraph: Delete the colon in the third
line.  Step (11), sixth line:  "a diferent identity string"
should be "a different selector string".
Page 131:  Fifth paragraph:  "each capable of checking 265
million keys" should be "each capable of checking 256 million
Page 133:  Table 7.2:  Third number in third column, "1.2308"
should be "0.2308".
Page 134:  Table 7.3:  "1027" should be "10^27".
*****Page 135:  table 7.4:  "Cost-per-Period of Breaking a 56-bit
Key" should be "Cost-per-Period of Breaking a Given Length Key".
Page 139:  Indented paragraph:  "could break the system" should
be "could break the system within one year".
Page 141:  "Reduced Keyspaces," last sentence:  "don't expect
your keys to stand up" should be "don't expect short keys to
stand up".
Page 148:  Eighth line:  "2^24" should be "2^32".
Page 156:  Second paragraph:  "blocks 5 through 10" should be
"blocks 5 through 12".
Page 157:  Figure 8.2:  "IO" should be "IV".
Page 158:  Fifth line:  "P_i" and "D_K" should be in italics.
Page 159:  Figure 8.3:  "IO" should be "IV".
Page 161:  Figure 8.5:  "Decrypt" should be "Encrypt".
Page 162:  Figure 8.6:  "Encipherment" diagram: Input should be
"p_i" instead of "b_i", and output should be "c_i" instead of
"p_i".  "Decipherment" diagram:  "Decrypt" should be "Encrypt".
Page 164:  Figure 8.7:  "IO" should be "IV".
Page 165:  Last equation:  There should be a "(P)" at the end of
that equation.
Page 167:  Second paragraph, last line:  "2^(2n-4)" should be
Page 168:  Figure 8.8:  This figure is wrong.  The encryption
blocks in the second row should be off-centered from the
encryption blocks in the first and third row by half a block
length.  The pads are half a block length.
Page 174:  Middle of page:  Equations should be:
   k_2 = c'_2 XOR p', and then p_2 = c_2 XOR k_2
   k_3 = c'_3 XOR p_2, and then p_3 = c_3 XOR k_3
   k_4 = c'_4 XOR p_3, and then p_4 = c_4 XOR k_4
Page 175:  Last paragraph, second line:  "acting as the output
function" should be "acting as the next-state function".
Page 177:  Diffie's quote, second to last line:  "proposal to
built" should be "proposal to build".
Page 178:  Figure 8.20:  In "Node 2", the subscripts should be
"D_2" and "E_3".
Page 190:  Fourth paragraph, last line:  "to determine M" should
be "to determine P".
Page 191:  First paragraph:  "3.5" should be "6.8" in fourth
line.  "0.56" should be "0.15".  "EBCDIC (Extended Binary-Coded
Decimal Interchange Code)" should be "BAUDOT".  "0.30" should be
"0.76".  "0.70" should be "0.24".
Page 193:  Second sentence:  "but does guarantee security if it's
high" should be "but does not guarantee security if it's high."
Page 197:  Second paragraph, second sentence:  "it has never been
proven that P = NP" should be "it has never been proven that P =
NP or that P <> NP".  Third paragraph, fifth sentence:  "Thus
SATISFIABILITY is the hardest problem in NP" should be "Thus,
there is no problem harder than SATISFIABILITY in NP".
Page 198:  Fourth paragraph from bottom, second sentence:  "If a
and b are positive and a is less than n, you can think of a as
the remainder of b when divided by n" should be "If a and b are
positive and b is less than n, you can think of b as the
remainder of a when divided by n".
*****Page 199:  Middle of the page:  In the sentence "Calculating
the power of a number modulo a number", "a" should not be
italicized.  Fourth line from bottom:  "expresses n as a sum"
should be "expresses x as a sum".
Page 201:  First line of code:  Remove "assuming x and y are >
*****Page 202:  Ninth line:  "The modular reduction" should be
"the modular inverse".  Middle of the page:  In the sentence
"Now, how do you go about finding the inverse of a modulo n?" "a"
should be italicized.
*****Page 206:  Legendre Symbol:  "L(a,p) = 0 if a divides p"
should be "L(a,p) = 0 if a is divisible by p".  "L(a,p) = -1 if a
is a nonresidue mod p" should be "L(a,p) = -1 if a is a quadratic
nonresidue mod p".
Page 207:  "Jacobi Symbol," formula:  Variable "h" should be "a".
Also, J(0,n) = 0.
*****Page 208:  Thirteenth line: "If a = 1, then J(a/p) = 1"
should be "If a = 1, then J(a,p) = 1".  Third line from the
bottom:  "for each n from 0 to p-1" should be "for each n from 1
to p-1".
Page 209:  Fourth paragraph:  "If that value does not equal q"
should be "If that value does not equal 1".
Page 210:  Fifth line:  "age 21" should be "age 20".
Page 213:  Second to last paragraph:  "10^150" should be
"10^151", "one in log N" should be "one in ln N", and "would
still be 10^110 primes left over" should be "would still be
enough for 10^34 other universes".
Page 214: Solovay-Strassen, second sentence:  "Jacobi function"
should be "Jacobi symbol".  Last line:  "n" should be "p".  Lines
29, 30, and 31: "r" should be "a", and "gcd(p,r)" should be
Page 215:  Lehman test, step 5:  All three "(n-1)/2" should be
Page 217:  There should be an open parenthesis in front of the
second "ln" in both exponents.  Sixth paragraph:  "Guassian"
should be "Gaussian".
Page 222:  "Validation and Certification of DES Equipment," first
line:  "As part of the standard, the DES NIST" should be "As part
of DES, NIST".
Page 223:  Second to last paragraph, last line.  Reference
"[472]" should be "[473]".
Page 225:  Figure 10.2:  L_i is taken from R_(i-1) before the
expansion permutation, not after.  And "L_(i)-1" should be
Page 226:  Third sentence: "bit 1 to bit 58, bit 2 to bit 50, bit
3 to bit 42, etc." should be "bit 58 to bit 1, bit 50 to bit 2,
bit 42 to bit 3, etc."
Page 227:  Fourth line from bottom: "output positions that
correspond" should be "output positions correspond".
Page 228:  Fourth paragraph, last line:  "0 to 16" should be 0 to
Page 228:  Fifth paragraph should read:  "For example, assume
that the input to the sixth S-box (that is, bits 31 through 36 of
the XOR function) are 110010.  The first and last bits combine to
form 10, which corresponds to row 2 of the sixth S-box.  The
middle four bits combine to form 1001, which corresponds to
column 9 of the same S-box.  The entry under row 2, column 9 of
S-box 6 is 0.  (Remember, we count rows and columns from 0, and
not from 1.)  The value 0000 is substituted for 110010.
Page 230:  Fifth sentence:  "bit 4 moves to bit 21, while bit 23
moves to bit 4" should be "bit 21 moves to bit 4, while bit 4
moves to bit 31".  Second to last line:  delete "The key shift is
a right shift".
Page 231:  Table 10.9, sixth line:  "80286" should be "80386".
Page 233:  The second two weak keys should be:
   1F1F 1F1F 0E0E 0E0E     00000000 FFFFFFFF
   E0E0 E0E0 F1F1 F1F1     FFFFFFFF 00000000
Page 236:  Fifth paragraph: "would never be low enough" should be
"would never be high enough".
Page 238:  Next to last line before "Additional Results": "NSA's" should be "IBM's".
Page 238:  "Differential Cryptanalysis," third paragraph: "(1/16)^2" should be "(14/64)^2".
Page 239:  Figure 10.4:  "14/16" should be "14/64".
Page 242:  Table 10.14:  In "XORs by additions" line, "2^39,2^3"
should be "2^39,2^31".  In "Random" line, "2^21" should be"2^18-
2^20".  In "Random permutations" line, "2^44-2^48" should
Page 245:  Line 11"  "8 bits is" should be "8 bits was".
Page 247:  Section heading, "Cryptanalysis of the Madryga" should
be "Cryptanalysis of Madryga".
Page 250:  The two functions should be:
   S_0(a,b) = rotate left 2 bits ((a+b) mod 256)
   S_1(a,b) = rotate left 2 bits ((a+b+1) mod 256)
Note the difference in parentheses.
Page 250:  Figure 11.4:  Note that a is broken up into four 8-bit
substrings, a_0, a_1, a_2, and a_3.
Page 251:  Figure 11.6:  The definitions for S_0 and S_1 are
incorrect ("Y = S_0" and "Y = S_1").  See corrections from
previous page.  Also, "S1" should be "S_1".
Page 254:  "REDOC III," second sentence: "64-bit" should be "80-
bit".  "Security of REDOC III," second sentence:  Delete
clause after comma:  "even though it looks fairly weak."
Page 259:  First line:  "made the former algorithm slower" should
be "made Khafre slower".
Page 262:  Figure 11.9:  There is a line missing.  It should run
from the symbol where Z_5 is multiplied with the intermediate
result to the addition symbol directly to the right.
Page 263:  Table 11.1:  The decryption key sub-blocks that are
Z_n^(m)-1 should be Z_n^((m)-1).  Also, the second and third
column of decryption key sub-blocks in rounds 2 through 8 should
be switched.
Page 264:  First line:  "107.8 mm on a side" should be "107.8
square mm".
Page 265:  Figure 11.10:  There is a line missing.  It should run
from the symbol where Z_5 is multiplied with the intermediate
result to the addition symbol directly to the right.
Pages 266-7:  Since the publication of this book, MMB has been
broken.  Do not use this algorithm.
Page 267:  Sixth line from bottom:  Reference should be "[256]".
Page 269:  "Skipjack."  First paragraph.  Reference should be
Page 270:  "Karn."  Third paragraph.  Last sentence:  "append C_r
to C to produce" should be "append C_r to C_l to produce".
Page 270-1:  "Luby-Rackoff."  Step (4), equation should be:
     "L_1 = L_0 XOR H(K_r,R_1)"
In step (6), equation should be:
     "L_2 = L_1 XOR H(K_r,R_2)"
Page 271:  Middle of the page:  "(for example, MD2, MD5, Snefru"
should be "(for example, MD2, MD4, Snefru".
Page 272:  Second to last line:  "But it is be analyzed" should
be "but it is being analyzed".
Page 275:  Second to last paragraph:  "Using 1028 bits" should be
"using 1024 bits".
Page 277:  First lines:  The correct street address is "310 N
Mary Avenue" and the correct telephone number is "(408)
Page 278:  Second to last line: "greater than the largest number
in the sequence" should be "greater than the sum of all the
numbers in the sequence".  The example on page 279 is also wrong.
Page 281:  Third paragraph:  The correct street address is "310 N
Mary Avenue" and the correct telephone number is "(408)
Page 283:  Table 12.2:  "PRIVATE KEY: d e^(-1)" should be
"PRIVATE KEY: d = e^(-1)".
Page 284:  Fifth line should be:
   "c = 1570 2756 2091 2276 2423 158".
Page 286:  Third paragraph:  "Eve gets Alice to sign y," "y"
should be italicized.  Second to last line:  "Eve wants to Alice
to" should be "Eve wants Alice to".
Page 287:  Last line:  Wiener's attack is misstated.  If d is
less than one-quarter the length of the modulus, then the attack
can use e and n to find d quickly.
Page 288:  The correct street address is "310 N Mary Avenue" and
the correct telephone number is "(408) 735-5893".
Page 289:  The correct street address is "310 N Mary Avenue" and
the correct telephone number is "(408) 735-5893".
Page 291:  Fourth line:  "factoring, and it" should be
"factoring.  However, it".  "Feige-Fiat-Shamir," second
paragraph: "all foreign nationals" should be "all foreign
Page 292:  Fifth line:  "sqrt(x/v)" should be "sqrt(1/v)".
Page 294:  Second and third lines:  "Bob" should be "Victor."
Page 295:  First line:  "t random integers fewer than n" should
be "t random numbers less than n".
Page 297:  Last line:  "when" should be "where".
Page 301:  Middle of the page:  Delete the sentence "Since the
math is all correct, they do this step."
Page 302:  Fourth line from bottom:  "a" should be in italics.
Page 303:  "Authentication Protocol," step (1):  Add "She sends x
to Victor."
Page 305:  Third paragraph, parenthetical remark:  "NIST claimed
that having DES meant that both that both the algorithm and the
standard were too confusing" should be "NIST claimed that having
DES mean both the algorithm and the standard was too confusing".
Page 306:  Eighth line:  "cryptographers' paranoia" should be
Page 307:  "Description of the Algorithm":  "p = a prime number
2^L bits long" should be "p = a prime number L bits long".  "g =
h^((p-1)/q)" should be "g = h^((p-1)/q) mod p".
Page 309:  Third line:  "random k values and then precompute r
values" should be "random k-values and then precompute r-values".
Page 313:  "Subliminal Channel in DSS":  "see Section 16.7"
should be "see Section 16.6".
Page 314:  Protocol, step (1):  "when" should be "where".
*****Page 316:  Third and fourth paragraphs:  "k'" and "n'"
should be "k" and "n".
Page 318:  "Other Public-Key Algorithms," third paragraph: "methods for factorizing polynomials was invented" should be
"methods for factoring polynomials were invented".
Page 319:  There should be a blank line before "discrete
logarithm:" and another before "factoring:".  Fourth line from
the bottom:  "depends more on the" should be "depends on more
than the".
Page 321:  Third line:  "when h" should be "where h".
Page 322:  Second paragraph:  "over 500 pairs of people" should
be "253 pairs of people".
Page 326: In the definition of h_i, "H_(i-1)" should be "h_(i-
Page 330:  Definitions of FF, GG, HH, and II are wrong.  These
are correct:
   FF:  "a = b + ((a + F(b,c,d) + M_j + t_i) <<< s)"
   GG:  "a = b + ((a + G(b,c,d) + M_j + t_i) <<< s)"
   HH:  "a = b + ((a + H(b,c,d) + M_j + t_i) <<< s)"
   II:  "a = b + ((a + I(b,c,d) + M_j + t_i) <<< s)"
*****Page 332:  Round 4, second entry:  "0x411aff97" should be
Page 335:  Fifth line should be:
   "K_t = CA62C1D6, for the fourth 20 operations".
Eleventh line:  "represents a left shift" should be "represents a
circular left shift".
Page 336:  "HAVAL," sixth line:  "160, 92, 224" should be "160,
192, 224".
Page 339:  "LOKI Single Block":  In computation of Hi, drop final
"XOR M_i". Page 340:  "Modified Davies-Meyer":  In computation of H_i, "M_i"
should be subscripted.
Page 342:  "Tandem Davies-Meyer":  In computation of W_i, "M_i"
should be subscripted.
Page 345:  "Stream Cipher Mac", first line:"  "A truly elegant
MDC" should be "A truly elegant MAC".
Page 347:  Formula:  "aX_(n1)" should be "aX_(n-1)".  Second
paragraph:  "(For example, m should be chosen to be a prime
number.)" should be "(For example, b and m should be relatively
Page 351:  Second line of text:  "they hold current" should be
"they hold the current".
Page 353:  Third line:  ">> 7" should be ">> 31".  Fourth line: ">> 5" should be ">> 6".  Fifth line:  ">> 3" should be ">> 4". Eighth line:  "(ShiftRegister)" should be "(ShiftRegister))". Tenth line:  "< 31" should be "<< 31".  Second paragraph:  "are
often used from stream-cipher" should be "are often used for
Page 356:  Source code:  "ShiftRegister = (ShiftRegister ^ (mask
Page 360:  Equation should not be "l(2^1-1)^(n-1)", but "l(2^l-
1)^(n-1)".  (A letter, not a number.)
Page 362:  Figure 15.10:  "LFSR-B" should be "LFSR-A" and vice
versa.  The second "a(t+n-1)" should be "a(t+n-2)", and the
second "b(t+n-1)" should be "b(t+n-2)".
Page 363:  Fourth paragraph: "cellular automaton, such as an
CSPRNG" should be "cellular automaton as a CSPRNG".
Page 365:  "Blum-Micali Generator."  In the equation, "x_i"
should be an exponent of a, not a subscript.
Page 367:  Sixth paragraph:  "Ingmar" should be "Ingemar".
Page 370:  "Using "Random Noise."  Second paragraph, last line: "output 2 as the event" should be "output 0 as the event".
Page 371:  Sixth line:  "access/modify times of/dev/tty" should
be "access/modify times of /dev/tty".
Page 371:  "Biases and Correlations," third line:  "but there
many types" should be "but there are many types".
Page 374:  "Generating Random Permutations."  Note that the
obvious way of shuffling, using random (n-1) instead of random
(i) so that every position is swapped with a random position,
does not give a random distribution.
Page 376:  Seventh line: "send a message, M" should be "send a
message, P".
Page 380:  Step (4):  "K(R_B)" should be "K(R_A)".
Page 383 and 386:  "LaGrange" should be "Lagrange".
Page 391:  Second protocol, step (1):  "in his implementation of
DES" should be "in his implementation of DSS".  Next sentence: "such that r is either q quadratic" should be "such that r is
either a quadratic".
Page 401:  Second to last line:  "and x is randomly chosen"
should be "and x is secret".
Page 402:  Step (1):  "when all values of r are" should be "where
all r_i are".  Step (2):  "for all values of r" should be "for
all values of i".  Step (4):  "when j is the lowest value of i
for which b_i = 1" should be "when j is the lowest value for
which b_j = 1".  Line 18:  "2^t" should be "2^(-t)".
Page 406:  Step (5):  "ij".
Page 409:  Third paragraph:  "measuring them destroys" should be
"measuring it destroys".  Fifth paragraph:  "it has no
probability" should be "it has zero probability".
*****Page 410:  Third line from bottom:  "British Telcom" should
be "British Telecom".
Page 417:  Last paragraph:  "Kerberos is a service Kerberos on
the network" should be "Kerberos is a service on the network".
Page 421:  Figure 17.2:  In the top message "C" should be lower
Page 428:  "Privacy Enhanced Mail":  First line:  "adapted by the
Internet" should be "adopted by the Internet".
Page 435:  "RIPEM":  "Mark Riorden" should be "Mark Riordan".
Page 436:  "Pretty Good Privacy," third paragraph:  Delete fourth
sentence:  "After verifying the signature...."
Page 436:  Pretty Good Privacy is not in the public domain.  It
is copyrighted by Philip Zimmermann and available for free under
the "Copyleft" General Public License from the Free Software
Page 437:  Fifth line:  Delete "assess your own trust level". "Clipper," second paragraph:  reference should be
"[473]".  Fourth paragraph:  references should be
Page 438:  Middle of page:  reference should be "[654]". "Capstone," first paragraph:  reference should be "[655]".
Page 445:  The IACR is not the "International Association of
Cryptographic Research," but the "International Association for
Cryptologic Research."  This is also wrong in the table of
contents and the index.
Source Code:  The decrement operator, "--", was inadvertently
typesetted as an m-dash, "-".  This error is on pages 496, 510,
511, 523, 527, 528, 540, and 541.  There may be other places as
Page 472:  Third line: "2, 18, 11" should be "22, 18, 11". Eighteenth line: "for( i = 0; i<<16; i++ )" should be "for( i =
0; i<16; i++ )".
Page 473:  Function "cpkey(into)". "while (from endp)" should be
"while (from < endp)".
Page 478:  Fourth line: "leftt > 4" should be "leftt >> 4". Seventh line: "leftt > 16" should be "leftt >> 16".  Twentieth
line: "leftt > 31" should be "leftt >> 31".
Page 508:  Line 8:  "union U_INTseed" should be "union U_INT
Page 531:  "for( i = 0; i<; i++ )" should be "for( i = 0; i<2;
i++ )".
Page 558:  " int" should be " BOOLEAN int",
" should be " FALSE 0", and
" should be " TRUE (1==1)".
Page 564:  " BOOLEANint" should be " BOOLEAN int",
" FALSE0" should be " FALSE 0", and
" should be " TRUE (1==1)".
Page 569:  "rand() > 11" should be "rand() >> 11".
Page 569:  In "G13.H", " G13int" should be " G13
*****Page 571:  Reference [14:  "Hopcraft" should be "Hopcroft".
Page 572:  Reference [45]:  "Haglen" should be "Hagelin".
Page 576:  References [136] and [137]:  "Branstead" should be
Page 576:  Reference [148]:  The authors should be G. Brassard,
C. Crepeau, and J.-M. Robert.
Page 578:  Reference [184]  "Proof that DES Is Not a Group"
should be "DES Is Not a Group."  The correct page numbers are
*****Page 582:  Reference [286]:  The article appeared CRYPTO '89
Page 589:  Reference [475]:  The publisher should be E.S. Mittler
und Sohn, and the publication date should be 1863.
Page 601:  References [835] and [836]:  "Branstead" should be
Page 602:  Reference [842]:  "Solvay" should be "Solovay".
Page 603:  Reference [878]:  "Weiner" should be "Wiener."
This errata is updated periodically.  For a current errata sheet,
send a self-addressed stamped envelope to:  Bruce Schneier,
Counterpane Systems, 730 Fair Oaks Ave., Oak Park, IL  60302; or
send electronic mail to: schneier at chinet.com.

@_date: 1994-06-17 08:06:13
@_author: schneier@chinet.chinet.com 
@_subject: Applied Cyptography, Errata 1.5.9 
APPLIED CRYPTOGRAPHY
                         ERRATA
              Version 1.5.9 - June 15, 1994
This errata includes all errors I have found in the book,
including minor spelling and grammatical errors.  Please
distribute this errata sheet to anyone else who owns a copy of
the book.
Page xvii:  Third paragraph, first line:  "Part IV" should be
"Part III".
Page xviii:  "Xuija" should be "Xuejia".  "Mark Markowitz" should
be "Mike Markowitz".
Page 1:  First paragraph, fourth line:  "receiver cannot
intercept" should be "intermediary cannot intercept".
*****Page 2:  Third line:  "Outside the historical chapter"
should be "Outside the Classical Cryptography chapter".
*****Page 3:  Figure 1.2:  "with key" should be "with one key".
*****Page 4:  Eleventh line:  Delete the sentence which begins: "In instances where...."
*****Page 5:  "Chosen-plaintext attack":  "but they also choose
the encrypted plaintext" should be "but they choose the
plaintexts to encrypt".
Page 6:  Sixth and seventh lines:  "against symmetric" should be
"against a symmetric".
Page 8:  Second paragraph, first line:  "q code" should be "a
Page 10:  Second paragraph, fifth line:  Reference "[744]" should
be "[774]".
Page 11:  Second paragraph:  "The rotations of the rotors are a
Caesar Cipher" should be "Each rotor is an arbitrary permutation
of the alphabet".
*****Page 13:  Third paragraph:  Delete parenthetical remark. Fourth paragraph, second line:  "the key against" should be "the
ciphertext against".  Fifth paragraph:  "Shift the key" should be
"shift the ciphertext".  And:  "with text XORed with itself"
should be "with the plaintext XORed with itself shifted by the
key length."
*****Page 14:  Third line:  "to be any possible" should be "to
correspond to any possible".
Page 15:  Section 1.3, first line:  "Throughout this book use"
should be "Throughout this book I use".
*****Page 22:  Step (4): "gives the title" should be "gives the
title and keys".
Page 25:  "Attacks Against Protocols," first paragraph:  "the
protocol iself" should be "the protocol itself".
*****Page 27:  "One-Way Functions," second paragraph:  "millions
of years to compute this function" should be "millions of years
to compute the reverse function."  Fourth paragraph: "For
example, x^2" should be "For example, in a finite field x^2."
Page 28:  Third paragraph, third and fourth sentences should be
"How to put mail in a mailbox is public knowledge.  How to open
the mailbox is not public knowledge."
Page 29:  Third paragraph:  "If you only want" should be "If you
want only".
Page 30:  Fourth line:  "symmetric cryptosystems: by distributing
the key" should be "symmetric cryptosystems: distributing the
*****Page 30:  "Attacks Against Public Key Cryptography," first
sentence:  "In all these public-key digital signature protocols"
should be "In all these public-key protocols".  Second
paragraph:  "The obvious way to exchange" should be "The obvious
way to get".  And: "The database also has to be protected from
access by anyone" should be "The database also has to be
protected from write access by anyone".  Last paragraph:
"substitute a key of his choosing for Alice's" should be
"substitute a key of his own choosing for Bob's".
Page 30:  Last line:  "substitute that key for his own public
key" should be "substitute his own key for that public key".
Page 32:  Ninth line:  Delete the word "encrypted".
Page 34:  "Signing Documents with..."  First sentence:  "too
inefficient to encrypt long documents" should be "too inefficient
to sign long documents".
*****Page 35:  Step (4), second sentence should be:  "He then,
using the digital signature algorithm, verifies the signed hash
with Alice's public key."
Page 36:  Second line:  "document encrypted with" should be
"document signed with".  "Multiple Signatures," step (4):  "Alice
or Bob sends" should be "Alice sends".
Page 38:  Fifth paragraph:  "V_X = E_X and that S_X = D_X" should
be "V_X = E_X and S_X = D_X".
Page 40:  Third line:  "computer can exist" should be "computer
can be".  Second paragraph:  Delete "should be runs of zeros and
the other half should be runs of ones; half the runs".  At the
end of the sentence, add "The distribution of run lengths for
zeros and ones should be the same."
*****Page 41:  Second paragraph:  At the end of the paragraph,
add:  "Cryptographically secure pseudo-random sequence generators
can only be compressed if you know the secret."  Last paragraph
should be: "The output of a generator satisfying these three
properties will be good enough for a one-time pad, key
generation, and any other cryptographic features that require a
truly random sequence generator."
Page 44:  Ninth line: "for Alice's" should be "for Bob's".
*****Page 46:  "Key and Message Transmission":  Second steps (1)
and (2) should be (5) and (6).
*****Page 49:  Second line:  "the user" should be "Alice".  First
protocol, steps (1) and (3):  "secret key" should be "private
Page 50:  First step (3):  "With Alice's public key" should be
"with "Alice's" public key."
Page 51:  Step 5:  "with what he received from Bob" should be
"with what he received from Alice".
Page 55:  First step (2):  At the end of the step, add:  "He
sends both encrypted messages to Alice."
Page 58:  Last line: "Alice, Bob, and Carol" should be "Alice,
Bob, Carol, and Dave".
*****Page 59:  First line: "Alice, Bob, and Carol" should be
"Alice, Bob, Carol, and Dave".  Second paragraph:  "All Alice,
Bob, and Dave, combined, know" should be "All Alice, Bob, and
Dave, each, know".
*****Page 63:  Tenth line:  "signed timestamp" should be "signed
timestamped hash".  Step (3) is actually part of step (2), and
step (4) should be step (3).
*****Page 66:  Second line from bottom:  "identity" should be
Page 69:  Last line:  "tried to recover her private key" should
be "tries to recover Alice's private key".
*****Page 72:  The second set of steps (1) and (2) should be step
(3) and step (4)
*****Page 73:  "Bit Commitment Using One-Way Functions":  The
general class of one-way functions is suitable for this protocol,
not only one-way hash functions.  Last paragraph:  Second and
third sentences should be "Alice cannot cheat and find another
message (R_1,R_2',b'), such that H(R_1,R_2',b') = H(R_1,R_2,b). If Alice didn't send Bob R_1, then she could change the value of
both R_1 and R_2 and then the value of the bit."
Page 75:  First paragraph after quotation:  "over modem" should
be "over a modem".
Page 76:  First paragraph of text, third sentence: "Additionally,
f(x) must produce even and odd numbers with equal probability"
should be "Additionally, Alice should ensure that the random
number x takes even and odd values with equal probability". Fifth sentence: " For example, if f(x) produces even numbers 70%
of the time" should be "For example, if x takes even values 75%
of the time".
*****Page 77:  "Flipping Coins into a Well," first line: "neither party learns the result" should be "Alice and Bob don't
learn the result".  Third line:  parenthetical remark should be: "Alice in the first two protocls and Bob in the last one".
Page 78:  Step (1):  "Alice, Bob, and Carol all generate" should
be "Alice, Bob, and Carol each generate".
Page 80:  Second paragraph, second sentence.  It should read: "A
general n-player poker protocol that eliminates the problem of
information leakage was developed in [228]."
*****Page 81:  Last sentence:  delete it.
*****Page 83:  Fourth line:  "five" should be "n", twice.  Step
(2):  "This message must" should be "These messages must". Second sentence after protocol:  "Neither the KDC" should be
"Before this surerendering, neither the KDC".
*****Page 87:  Second sentence after protocol:  "so that Bob"
should be "so that Victor".  "Hamilton Cycles":  "Alice" should
be "Peggy".
*****Page 88:  "Graph Isomorphism", second sentence:  "Peggy
knows that two graphs, G_1 and G_2, are isomorphic" should be
"Peggy knows the isomorphism between two graphs, G_1 and G_2."
Page 90:  Last paragraph:  "step (3)" should be "step (4)".
Page 91:  Second line:  "step (3)" should be "step (4)".
Page 93:  "Blind Signatures," first line:  "An essential in all"
should be "An essential feature of all".
Page 98:  First paragraph after protocol, fourth line:  "to
determine the DES key with the other encrypted message" should be
"to determine the DES key that the other encrypted message was
encrypted in."
Page 115:  "Protocol  third paragraph:  "together determine
if f(a,b)" should be "together determine f(a,b)".
*****Page 121:  Second paragraph: Delete the colon in the third
line.  Step (11), sixth line:  "a diferent identity string"
should be "a different selector string".
Page 131:  Fifth paragraph:  "each capable of checking 265
million keys" should be "each capable of checking 256 million
Page 133:  Table 7.2:  Third number in third column, "1.2308"
should be "0.2308".
Page 134:  Table 7.3:  "1027" should be "10^27".
*****Page 135:  table 7.4:  "Cost-per-Period of Breaking a 56-bit
Key" should be "Cost-per-Period of Breaking a Given Length Key".
Page 139:  Indented paragraph:  "could break the system" should
be "could break the system within one year".
Page 141:  "Reduced Keyspaces," last sentence:  "don't expect
your keys to stand up" should be "don't expect short keys to
stand up".
Page 148:  Eighth line:  "2^24" should be "2^32".
Page 156:  Second paragraph:  "blocks 5 through 10" should be
"blocks 5 through 12".
Page 157:  Figure 8.2:  "IO" should be "IV".
Page 158:  Fifth line:  "P_i" and "D_K" should be in italics.
Page 159:  Figure 8.3:  "IO" should be "IV".
Page 161:  Figure 8.5:  "Decrypt" should be "Encrypt".
Page 162:  Figure 8.6:  "Encipherment" diagram: Input should be
"p_i" instead of "b_i", and output should be "c_i" instead of
"p_i".  "Decipherment" diagram:  "Decrypt" should be "Encrypt".
Page 164:  Figure 8.7:  "IO" should be "IV".
Page 165:  Last equation:  There should be a "(P)" at the end of
that equation.
Page 167:  Second paragraph, last line:  "2^(2n-4)" should be
Page 168:  Figure 8.8:  This figure is wrong.  The encryption
blocks in the second row should be off-centered from the
encryption blocks in the first and third row by half a block
length.  The pads are half a block length.
Page 174:  Middle of page:  Equations should be:
   k_2 = c'_2 XOR p', and then p_2 = c_2 XOR k_2
   k_3 = c'_3 XOR p_2, and then p_3 = c_3 XOR k_3
   k_4 = c'_4 XOR p_3, and then p_4 = c_4 XOR k_4
Page 175:  Last paragraph, second line:  "acting as the output
function" should be "acting as the next-state function".
Page 177:  Diffie's quote, second to last line:  "proposal to
built" should be "proposal to build".
Page 178:  Figure 8.20:  In "Node 2", the subscripts should be
"D_2" and "E_3".
Page 190:  Fourth paragraph, last line:  "to determine M" should
be "to determine P".
Page 191:  First paragraph:  "3.5" should be "6.8" in fourth
line.  "0.56" should be "0.15".  "EBCDIC (Extended Binary-Coded
Decimal Interchange Code)" should be "BAUDOT".  "0.30" should be
"0.76".  "0.70" should be "0.24".
Page 193:  Second sentence:  "but does guarantee security if it's
high" should be "but does not guarantee security if it's high."
Page 197:  Second paragraph, second sentence:  "it has never been
proven that P = NP" should be "it has never been proven that P =
NP or that P <> NP".  Third paragraph, fifth sentence:  "Thus
SATISFIABILITY is the hardest problem in NP" should be "Thus,
there is no problem harder than SATISFIABILITY in NP".
Page 198:  Fourth paragraph from bottom, second sentence:  "If a
and b are positive and a is less than n, you can think of a as
the remainder of b when divided by n" should be "If a and b are
positive and b is less than n, you can think of b as the
remainder of a when divided by n".
*****Page 199:  Middle of the page:  In the sentence "Calculating
the power of a number modulo a number", "a" should not be
italicized.  Fourth line from bottom:  "expresses n as a sum"
should be "expresses x as a sum".
Page 201:  First line of code:  Remove "assuming x and y are >
*****Page 202:  Ninth line:  "The modular reduction" should be
"the modular inverse".  Middle of the page:  In the sentence
"Now, how do you go about finding the inverse of a modulo n?" "a"
should be italicized.
*****Page 206:  Legendre Symbol:  "L(a,p) = 0 if a divides p"
should be "L(a,p) = 0 if a is divisible by p".  "L(a,p) = -1 if a
is a nonresidue mod p" should be "L(a,p) = -1 if a is a quadratic
nonresidue mod p".
Page 207:  "Jacobi Symbol," formula:  Variable "h" should be "a".
Also, J(0,n) = 0.
*****Page 208:  Thirteenth line: "If a = 1, then J(a/p) = 1"
should be "If a = 1, then J(a,p) = 1".  Third line from the
bottom:  "for each n from 0 to p-1" should be "for each n from 1
to p-1".
Page 209:  Fourth paragraph:  "If that value does not equal q"
should be "If that value does not equal 1".
Page 210:  Fifth line:  "age 21" should be "age 20".
Page 213:  Second to last paragraph:  "10^150" should be
"10^151", "one in log N" should be "one in ln N", and "would
still be 10^110 primes left over" should be "would still be
enough for 10^34 other universes".
Page 214: Solovay-Strassen, second sentence:  "Jacobi function"
should be "Jacobi symbol".  Last line:  "n" should be "p".  Lines
29, 30, and 31: "r" should be "a", and "gcd(p,r)" should be
Page 215:  Lehman test, step 5:  All three "(n-1)/2" should be
Page 217:  There should be an open parenthesis in front of the
second "ln" in both exponents.  Sixth paragraph:  "Guassian"
should be "Gaussian".
Page 222:  "Validation and Certification of DES Equipment," first
line:  "As part of the standard, the DES NIST" should be "As part
of DES, NIST".
Page 223:  Second to last paragraph, last line.  Reference
"[472]" should be "[473]".
Page 225:  Figure 10.2:  L_i is taken from R_(i-1) before the
expansion permutation, not after.  And "L_(i)-1" should be
Page 226:  Third sentence: "bit 1 to bit 58, bit 2 to bit 50, bit
3 to bit 42, etc." should be "bit 58 to bit 1, bit 50 to bit 2,
bit 42 to bit 3, etc."
Page 227:  Fourth line from bottom: "output positions that
correspond" should be "output positions correspond".
Page 228:  Fourth paragraph, last line:  "0 to 16" should be 0 to
Page 228:  Fifth paragraph should read:  "For example, assume
that the input to the sixth S-box (that is, bits 31 through 36 of
the XOR function) are 110010.  The first and last bits combine to
form 10, which corresponds to row 2 of the sixth S-box.  The
middle four bits combine to form 1001, which corresponds to
column 9 of the same S-box.  The entry under row 2, column 9 of
S-box 6 is 0.  (Remember, we count rows and columns from 0, and
not from 1.)  The value 0000 is substituted for 110010.
Page 230:  Fifth sentence:  "bit 4 moves to bit 21, while bit 23
moves to bit 4" should be "bit 21 moves to bit 4, while bit 4
moves to bit 31".  Second to last line:  delete "The key shift is
a right shift".
Page 231:  Table 10.9, sixth line:  "80286" should be "80386".
Page 233:  The second two weak keys should be:
   1F1F 1F1F 0E0E 0E0E     00000000 FFFFFFFF
   E0E0 E0E0 F1F1 F1F1     FFFFFFFF 00000000
Page 236:  Fifth paragraph: "would never be low enough" should be
"would never be high enough".
Page 238:  Next to last line before "Additional Results": "NSA's" should be "IBM's".
Page 238:  "Differential Cryptanalysis," third paragraph: "(1/16)^2" should be "(14/64)^2".
Page 239:  Figure 10.4:  "14/16" should be "14/64".
Page 242:  Table 10.14:  In "XORs by additions" line, "2^39,2^3"
should be "2^39,2^31".  In "Random" line, "2^21" should be"2^18-
2^20".  In "Random permutations" line, "2^44-2^48" should
Page 245:  Line 11"  "8 bits is" should be "8 bits was".
Page 247:  Section heading, "Cryptanalysis of the Madryga" should
be "Cryptanalysis of Madryga".
Page 250:  The two functions should be:
   S_0(a,b) = rotate left 2 bits ((a+b) mod 256)
   S_1(a,b) = rotate left 2 bits ((a+b+1) mod 256)
Note the difference in parentheses.
Page 250:  Figure 11.4:  Note that a is broken up into four 8-bit
substrings, a_0, a_1, a_2, and a_3.
Page 251:  Figure 11.6:  The definitions for S_0 and S_1 are
incorrect ("Y = S_0" and "Y = S_1").  See corrections from
previous page.  Also, "S1" should be "S_1".
Page 254:  "REDOC III," second sentence: "64-bit" should be "80-
bit".  "Security of REDOC III," second sentence:  Delete
clause after comma:  "even though it looks fairly weak."
Page 259:  First line:  "made the former algorithm slower" should
be "made Khafre slower".
Page 262:  Figure 11.9:  There is a line missing.  It should run
from the symbol where Z_5 is multiplied with the intermediate
result to the addition symbol directly to the right.
Page 263:  Table 11.1:  The decryption key sub-blocks that are
Z_n^(m)-1 should be Z_n^((m)-1).  Also, the second and third
column of decryption key sub-blocks in rounds 2 through 8 should
be switched.
Page 264:  First line:  "107.8 mm on a side" should be "107.8
square mm".
Page 265:  Figure 11.10:  There is a line missing.  It should run
from the symbol where Z_5 is multiplied with the intermediate
result to the addition symbol directly to the right.
Pages 266-7:  Since the publication of this book, MMB has been
broken.  Do not use this algorithm.
Page 267:  Sixth line from bottom:  Reference should be "[256]".
Page 269:  "Skipjack."  First paragraph.  Reference should be
Page 270:  "Karn."  Third paragraph.  Last sentence:  "append C_r
to C to produce" should be "append C_r to C_l to produce".
Page 270-1:  "Luby-Rackoff."  Step (4), equation should be:
     "L_1 = L_0 XOR H(K_r,R_1)"
In step (6), equation should be:
     "L_2 = L_1 XOR H(K_r,R_2)"
Page 271:  Middle of the page:  "(for example, MD2, MD5, Snefru"
should be "(for example, MD2, MD4, Snefru".
Page 272:  Second to last line:  "But it is be analyzed" should
be "but it is being analyzed".
Page 275:  Second to last paragraph:  "Using 1028 bits" should be
"using 1024 bits".
Page 277:  First lines:  The correct street address is "310 N
Mary Avenue" and the correct telephone number is "(408)
Page 278:  Second to last line: "greater than the largest number
in the sequence" should be "greater than the sum of all the
numbers in the sequence".  The example on page 279 is also wrong.
Page 281:  Third paragraph:  The correct street address is "310 N
Mary Avenue" and the correct telephone number is "(408)
Page 283:  Table 12.2:  "PRIVATE KEY: d e^(-1)" should be
"PRIVATE KEY: d = e^(-1)".
Page 284:  Fifth line should be:
   "c = 1570 2756 2091 2276 2423 158".
Page 286:  Third paragraph:  "Eve gets Alice to sign y," "y"
should be italicized.  Second to last line:  "Eve wants to Alice
to" should be "Eve wants Alice to".
Page 287:  Last line:  Wiener's attack is misstated.  If d is
less than one-quarter the length of the modulus, then the attack
can use e and n to find d quickly.
Page 288:  The correct street address is "310 N Mary Avenue" and
the correct telephone number is "(408) 735-5893".
Page 289:  The correct street address is "310 N Mary Avenue" and
the correct telephone number is "(408) 735-5893".
Page 291:  Fourth line:  "factoring, and it" should be
"factoring.  However, it".  "Feige-Fiat-Shamir," second
paragraph: "all foreign nationals" should be "all foreign
Page 292:  Fifth line:  "sqrt(x/v)" should be "sqrt(1/v)".
Page 294:  Second and third lines:  "Bob" should be "Victor."
Page 295:  First line:  "t random integers fewer than n" should
be "t random numbers less than n".
Page 297:  Last line:  "when" should be "where".
Page 301:  Middle of the page:  Delete the sentence "Since the
math is all correct, they do this step."
Page 302:  Fourth line from bottom:  "a" should be in italics.
Page 303:  "Authentication Protocol," step (1):  Add "She sends x
to Victor."
Page 305:  Third paragraph, parenthetical remark:  "NIST claimed
that having DES meant that both that both the algorithm and the
standard were too confusing" should be "NIST claimed that having
DES mean both the algorithm and the standard was too confusing".
Page 306:  Eighth line:  "cryptographers' paranoia" should be
Page 307:  "Description of the Algorithm":  "p = a prime number
2^L bits long" should be "p = a prime number L bits long".  "g =
h^((p-1)/q)" should be "g = h^((p-1)/q) mod p".
Page 309:  Third line:  "random k values and then precompute r
values" should be "random k-values and then precompute r-values".
Page 313:  "Subliminal Channel in DSS":  "see Section 16.7"
should be "see Section 16.6".
Page 314:  Protocol, step (1):  "when" should be "where".
*****Page 316:  Third and fourth paragraphs:  "k'" and "n'"
should be "k" and "n".
Page 318:  "Other Public-Key Algorithms," third paragraph: "methods for factorizing polynomials was invented" should be
"methods for factoring polynomials were invented".
Page 319:  There should be a blank line before "discrete
logarithm:" and another before "factoring:".  Fourth line from
the bottom:  "depends more on the" should be "depends on more
than the".
Page 321:  Third line:  "when h" should be "where h".
Page 322:  Second paragraph:  "over 500 pairs of people" should
be "253 pairs of people".
Page 326: In the definition of h_i, "H_(i-1)" should be "h_(i-
Page 330:  Definitions of FF, GG, HH, and II are wrong.  These
are correct:
   FF:  "a = b + ((a + F(b,c,d) + M_j + t_i) <<< s)"
   GG:  "a = b + ((a + G(b,c,d) + M_j + t_i) <<< s)"
   HH:  "a = b + ((a + H(b,c,d) + M_j + t_i) <<< s)"
   II:  "a = b + ((a + I(b,c,d) + M_j + t_i) <<< s)"
*****Page 332:  Round 4, second entry:  "0x411aff97" should be
Page 335:  Fifth line should be:
   "K_t = CA62C1D6, for the fourth 20 operations".
Eleventh line:  "represents a left shift" should be "represents a
circular left shift".
Page 336:  "HAVAL," sixth line:  "160, 92, 224" should be "160,
192, 224".
Page 339:  "LOKI Single Block":  In computation of Hi, drop final
"XOR M_i". Page 340:  "Modified Davies-Meyer":  In computation of H_i, "M_i"
should be subscripted.
Page 342:  "Tandem Davies-Meyer":  In computation of W_i, "M_i"
should be subscripted.
Page 345:  "Stream Cipher Mac", first line:"  "A truly elegant
MDC" should be "A truly elegant MAC".
Page 347:  Formula:  "aX_(n1)" should be "aX_(n-1)".  Second
paragraph:  "(For example, m should be chosen to be a prime
number.)" should be "(For example, b and m should be relatively
Page 351:  Second line of text:  "they hold current" should be
"they hold the current".
Page 353:  Third line:  ">> 7" should be ">> 31".  Fourth line: ">> 5" should be ">> 6".  Fifth line:  ">> 3" should be ">> 4". Eighth line:  "(ShiftRegister)" should be "(ShiftRegister))". Tenth line:  "< 31" should be "<< 31".  Second paragraph:  "are
often used from stream-cipher" should be "are often used for
Page 356:  Source code:  "ShiftRegister = (ShiftRegister ^ (mask
Page 360:  Equation should not be "l(2^1-1)^(n-1)", but "l(2^l-
1)^(n-1)".  (A letter, not a number.)
Page 362:  Figure 15.10:  "LFSR-B" should be "LFSR-A" and vice
versa.  The second "a(t+n-1)" should be "a(t+n-2)", and the
second "b(t+n-1)" should be "b(t+n-2)".
Page 363:  Fourth paragraph: "cellular automaton, such as an
CSPRNG" should be "cellular automaton as a CSPRNG".
Page 365:  "Blum-Micali Generator."  In the equation, "x_i"
should be an exponent of a, not a subscript.
Page 367:  Sixth paragraph:  "Ingmar" should be "Ingemar".
Page 370:  "Using "Random Noise."  Second paragraph, last line: "output 2 as the event" should be "output 0 as the event".
Page 371:  Sixth line:  "access/modify times of/dev/tty" should
be "access/modify times of /dev/tty".
Page 371:  "Biases and Correlations," third line:  "but there
many types" should be "but there are many types".
Page 374:  "Generating Random Permutations."  Note that the
obvious way of shuffling, using random (n-1) instead of random
(i) so that every position is swapped with a random position,
does not give a random distribution.
Page 376:  Seventh line: "send a message, M" should be "send a
message, P".
Page 380:  Step (4):  "K(R_B)" should be "K(R_A)".
Page 383 and 386:  "LaGrange" should be "Lagrange".
Page 391:  Second protocol, step (1):  "in his implementation of
DES" should be "in his implementation of DSS".  Next sentence: "such that r is either q quadratic" should be "such that r is
either a quadratic".
Page 401:  Second to last line:  "and x is randomly chosen"
should be "and x is secret".
Page 402:  Step (1):  "when all values of r are" should be "where
all r_i are".  Step (2):  "for all values of r" should be "for
all values of i".  Step (4):  "when j is the lowest value of i
for which b_i = 1" should be "when j is the lowest value for
which b_j = 1".  Line 18:  "2^t" should be "2^(-t)".
Page 406:  Step (5):  "ij".
Page 409:  Third paragraph:  "measuring them destroys" should be
"measuring it destroys".  Fifth paragraph:  "it has no
probability" should be "it has zero probability".
*****Page 410:  Third line from bottom:  "British Telcom" should
be "British Telecom".
Page 417:  Last paragraph:  "Kerberos is a service Kerberos on
the network" should be "Kerberos is a service on the network".
Page 421:  Figure 17.2:  In the top message "C" should be lower
Page 428:  "Privacy Enhanced Mail":  First line:  "adapted by the
Internet" should be "adopted by the Internet".
Page 435:  "RIPEM":  "Mark Riorden" should be "Mark Riordan".
Page 436:  "Pretty Good Privacy," third paragraph:  Delete fourth
sentence:  "After verifying the signature...."
Page 436:  Pretty Good Privacy is not in the public domain.  It
is copyrighted by Philip Zimmermann and available for free under
the "Copyleft" General Public License from the Free Software
Page 437:  Fifth line:  Delete "assess your own trust level". "Clipper," second paragraph:  reference should be
"[473]".  Fourth paragraph:  references should be
Page 438:  Middle of page:  reference should be "[654]". "Capstone," first paragraph:  reference should be "[655]".
Page 445:  The IACR is not the "International Association of
Cryptographic Research," but the "International Association for
Cryptologic Research."  This is also wrong in the table of
contents and the index.
Source Code:  The decrement operator, "--", was inadvertently
typesetted as an m-dash, "-".  This error is on pages 496, 510,
511, 523, 527, 528, 540, and 541.  There may be other places as
Page 472:  Third line: "2, 18, 11" should be "22, 18, 11". Eighteenth line: "for( i = 0; i<<16; i++ )" should be "for( i =
0; i<16; i++ )".
Page 473:  Function "cpkey(into)". "while (from endp)" should be
"while (from < endp)".
Page 478:  Fourth line: "leftt > 4" should be "leftt >> 4". Seventh line: "leftt > 16" should be "leftt >> 16".  Twentieth
line: "leftt > 31" should be "leftt >> 31".
Page 508:  Line 8:  "union U_INTseed" should be "union U_INT
Page 531:  "for( i = 0; i<; i++ )" should be "for( i = 0; i<2;
i++ )".
Page 558:  " int" should be " BOOLEAN int",
" should be " FALSE 0", and
" should be " TRUE (1==1)".
Page 564:  " BOOLEANint" should be " BOOLEAN int",
" FALSE0" should be " FALSE 0", and
" should be " TRUE (1==1)".
Page 569:  "rand() > 11" should be "rand() >> 11".
Page 569:  In "G13.H", " G13int" should be " G13
*****Page 571:  Reference [14:  "Hopcraft" should be "Hopcroft".
Page 572:  Reference [45]:  "Haglen" should be "Hagelin".
Page 576:  References [136] and [137]:  "Branstead" should be
Page 576:  Reference [148]:  The authors should be G. Brassard,
C. Crepeau, and J.-M. Robert.
Page 578:  Reference [184]  "Proof that DES Is Not a Group"
should be "DES Is Not a Group."  The correct page numbers are
*****Page 582:  Reference [286]:  The article appeared CRYPTO '89
Page 589:  Reference [475]:  The publisher should be E.S. Mittler
und Sohn, and the publication date should be 1863.
Page 601:  References [835] and [836]:  "Branstead" should be
Page 602:  Reference [842]:  "Solvay" should be "Solovay".
Page 603:  Reference [878]:  "Weiner" should be "Wiener."
This errata is updated periodically.  For a current errata sheet,
send a self-addressed stamped envelope to:  Bruce Schneier,
Counterpane Systems, 730 Fair Oaks Ave., Oak Park, IL  60302; or
send electronic mail to: schneier at chinet.com.
                          Received: from relay2.UU.net by bnr.ca id <19940617020406-0 at bnr.ca>; Thu, 16 Jun 1994 22:04:07 -0400
Received: from toad.com by relay2.UU.NET with SMTP Received: by toad.com id AA01878; Thu, 16 Jun 94 18:56:27 PDT
Received: from kitten.mcs.com by toad.com id AA01870; Thu, 16 Jun 94 18:56:17 PDT
Received: by kitten.mcs.com (/\==/\ Smail3.1.28.1 Received: by mercury.mcs.com (/\==/\ Smail3.1.28.1 Received: by chinet (/\==/\ Smail3.1.28.1

@_date: 1994-06-21 20:18:10
@_author: Bruce Schneier 
@_subject: Thoughts on the NSA's correction to SHA 
This is the fix to the Secure Hash Standard, NIST FIPS PUB 180:
     In Section 7 of FIPS 180 (page 9), the line which reads
     "b) For t=16 to 79 let Wt = Wt-3 XOR Wt-8 XOR Wt-14 XOR
     Wt-16."
     is to be replaced by
     "b) For t=16 to 79 let Wt = S1(Wt-3 XOR Wt-8 XOR Wt-14 XOR
     Wt-16)."
     where S1 is a left circular shift by one bit as defined in
     Section 3 of FIPS 180 (page 6):
     S1(X) = (X<<1) OR (X>>31).
This is exactly one additional line in assembly language.
The very fact that this correction had to made offers some
insights into the National Security Agency.
I believe that releasing DES to the public was the biggest
cryptography mistake that NSA ever made.  Consider the state of
research in cryptology before DES.  It was simplistic.  It was
haphazard.  There was little interest.  If any results of value
were ever discovered, the NSA could squash them with a secrecy
order.  No one cared.
Then, in the late 1970s, came DES.  Suddenly there was a an
algorithm to argue about, dissect, study, and learn from.  A
whole generation of cryptographers learned their craft from DES. Even today, we're still learning from DES.  We're learning new
techniques of cryptography and cryptanalysis.  DES has
transformed academic cryptology in ways the NSA never envisioned.
The NSA will not make this mistake again.  They will not release
Skipjack or any other algorithm to the public, because that could
galvanize another fifteen years of research in algorithm design
and analysis.  (Even so, I believe that Skipjack is similar in
design to DES; the NSA realizes that Clipper chips will be
reverse-engineered eventually.)
When it came time to propose an algorithm for the SHS, the NSA
chose not to use an algorithm from its own arsenal.  Instead it
chose to take an algorithm from academia, Ronald Rivest's MD4,
and modify it to produce a 160-bit hash.  While this approach did
not compromise any of NSA's work, it also short circuited NSA's
lengthy internal algorithm design and review process.  The SHA
was announced only two years after MD4.  By contrast, NSA claims
to have spent five years designing and analyzing their Skipjack
algorithm, based on an additional seven years of design.
There is no substitute for years of intense cryptanalysis, and
the flaw in SHA illustrates that.

@_date: 1994-06-21 20:47:03
@_author: Bruce Schneier 
@_subject: C Programmer Wanted for Cryptography Programming 
I am looking for a good C programmer who is interested in doing some
contract programming for me.
Anyone interested?
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier at chinet.com

@_date: 1994-10-02 19:00:41
@_author: Bruce Schneier 
@_subject: On Feistel Networks, S-Boxes, and Block Cipher Design 
ON FEISTEL NETWORKS, S-BOXES, AND BLOCK CIPHER DESIGN
Claude Shannon defined the cryptographic principles of confusion
and diffusion.  Fifty years after this paper was written, these
principles are still the cornerstone of good block cipher design.
Confusion serves to hide any relationship between the plaintext,
the ciphertext, and the key.  Remember how linear and
differential cryptanalysis can exploit even a slight relationship
between these three things?  Good confusion makes the
relationship statistics so complicated that even these powerful
cryptanalytic tools won't work.
Diffusion serves to spread the influence of individual plaintext
or key bits over as much of the ciphertext as possible.  This
also serves to hide statistical relationships, and make
cryptanalysis more difficult.
Confusion alone is enough.  A cipher that consisted of a single
lookup table of 64 bits of plaintext to 64 bits of ciphertext
based on a key would be plenty strong.  The problem is that large
lookup tables require large amounts of memory to implement: 1020
bytes of memory for the above table.  The whole point of block
cipher design is to create something that looks like a large
lookup table, but with much smaller memory requirements.
The trick is to repeatedly mix confusion (with much smaller
tables) and diffusion in a single cipher in different
combinations.  This is called a product cipher.  Sometimes a
block cipher that incorporates layers of substitution and
permutation is called a substitution-permutation network, or even
a SP network.
Look back at function f of DES.  The expansion permutation and P-
box perform diffusion; the S-boxes perform confusion.  The
expansion permutation and P-box are linear; the S-boxes are
nonlinear.  Each operation is pretty simple on its own, but
together they work pretty well.
DES also illustrates a few more principles of block cipher
design.  The first is the idea of an iterated block cipher.  This
simply means taking a simple round function and iterating it
multiple times.  Two-round DES isn't very strong; it takes five
rounds before all of the output bits are dependent on all of the
input bits and all of the key bits.  Sixteen-round DES is strong;
32-round DES is even stronger.
Feistel Ciphers
Most block algorithms that have appeared in the literature are
Feistel Ciphers.  The idea dates from the early 1970s.  Take a
block of length n and divide it into two halves of length n/2:  L
and R.  Of course, n must be even.  You can define an iterated
block cipher where the output of the ith round is determined from
the output of the previous round:
        L_i = R_(i-1)
        R_i = L_(i-1) XOR f(R_(i-1),K_i)
K_i is the subkey used in the ith round, and f is an arbitrary
round function.
You've seen this concept in DES, Lucifer, FEAL, Khufu, Khafre,
LOKI, and others.  Why is it such a big deal?  First off, the
function is guaranteed to be reversible.  Because XOR is used to
combine the left half with the output of the round function, it
is necessarily true that
        L_(i-1) XOR f(R_(i-1),K_i) XOR f(R_(i-1),K_i) = L_(i-1)
A cipher that uses this construction is guaranteed to be
invertible as long as the inputs to f in each round can be
reconstructed.  It doesn't matter what f is; f does not have to
invertible.  We can design f to be as complicated as we please,
and we don't have to implement two different algorithms--one for
encryption and another for decryption.  The structure of a
Feistel network takes care of all this automatically.
Simple Relations
DES has the property that if E_K(P) = C, then E_K'(P') = C',
where P', C', and K' are the bitwise complements of P, C, and K. This property reduces the complexity of a brute-force attack by a
factor of two.  LOKI has complementation properties that reduce
the complexity of a brute-force attack by a factor of 256.
A simple relation can be defined as [KNU94]:
        If E_K(P) = C, then E_f(K)(g(P,K) = h(C,K)
where f, g, and h are simple functions.  By simple I mean that
they are easy to compte, much easier than an iteration of the
block cipher.  In DES, f is the bitwise complement of K, g is the
bitwise complement of P, and h is the bitwise complement of C. This is a result of XORing the key into part of the text.
In a good block cipher, there are no simple relations.  Methods
for finding some of these weaknesses are in [KWA91B].
No Weak Keys
In a good block cipher, all keys are equally strong.  Algorithms
with a small number of weak keys, like DES, are generally no
problem.  The odds of picking one at random are very small, and
it's easy to test and discard them.  However, these weak keys can
sometimes be exploited if the block cipher is used as a one-way
hash function.
Strength Against Differential and Linear Cryptanalysis
The study of differential and linear cryptanalysis has shed
significant light on the theory of good block cipher design.  The
inventors of IDEA introduced the concept of differentials, a
generalization of the basic idea of characteristics [LAI91B]. They argued that block ciphers can be designed in such a way to
be resistant against this attack; IDEA is the result of that work
[LAI91B].  This concept was further formalized in [NYB93],
where Kaisia Nyberg and Lars Knudsen showed how to make block
ciphers that were provably secure against differential
Linear cryptanalysis is newer, and it is less clear what generic
design techniques will protect a cipher against linear
cryptanalysis.  Knudsen has made some progress, considering some
necessary (but not necessarily sufficient) criteria for what he
calls practically secure Feistel ciphers: ciphers that are
resistant to both linear and differential cryptanalysis [KNU94]. Nyberg introduced an analogy to the concept of differentials in
differential cryptanalysis in linear cryptanalysis [NYB94]. Other work that extends the idea of linear cryptanalysis can be
found in [PRE94A,KAL94B].
Interestingly enough, there seems to be a duality between
differential and linear cryptanalysis.  This duality becomes
apparent both in the design of techniques to construct good
differential characteristics and linear approximations
[BIH95,MAT95], and also in the design criteria for making
algorithms that are secure against both attacks [CHA95]. Exactly where this line of research will lead is still unknown.
S-Box Design
The strength of various Feistel ciphers--and specifically their
resistance to differential and linear cryptanalysis--is tied
directly to their S-boxes.  This has prompted a spate of research
on what constitutes a good S-box.
An S-box is simply a substitution: a mapping of m-bit inputs to
n-bit outputs.  Above I talked about a single lookup table of 64-
bit inputs to 64-bit outputs; that would be a single 64x64-bit S-
box.  A general S-box with an m-bit input and an n-bit output is
called a mxn-bit S-box.  S-boxes are generally the only non-
linear step in an algorithm; they are what give a block cipher
its security.  In general, the bigger they are the better.
DES has eight different 6x4-bit S-boxes.  Khufu and Khafre have a
single 8x32-bit S-box.  In IDEA the modular multiplication step
is effectively the S-box; it is a 32x32-bit S-box.  The larger
this S-box, the harder it is to find useful statistics about it
to attack [GOR83].  Also, while random S-boxes are usually not
optimal to protect against differential and linear attacks, it is
easier to find strong S-boxes if the S-boxes are larger.  Most
random S-boxes are nonlinear, nondegenerate, and have have strong
resistance to linear cryptanalysis--and the fraction that does
not goes down rapidly as the number of input bits decreases
The size of m is more important than the size of n.  Increasing
the size of n reduces the effectiveness of differential
cryptanalysis, but it increases the effectiveness of linear
cryptanalysis to a much greater degree.  In fact, if n >= 2m - m,
then there is definitely a linear relation of the input and
output bits of the S-box.  And if n >= 2m, then there is a linear
relation of only the output bits [BIH95].
Much of this work involves the study of Boolean functions.  In
order to be secure, the Boolean functions used in S-boxes must
satisfy specific conditions.  They should not be linear, nor
should they be close to linear [ADA90,NYB91,NYB93A].  There
should be a balance of zeros and ones, and no correlations
between different combinations of bits.  The output bits should
behave independently when any single input bit is complemented. These design criteria are also related to the study of bent
One property that seems very important is the diffusion of
information: how many output bits of an S-box change when some
subset of the input bits are changed.  This is called the
avalanche effect.  It's easy to impose conditions on Boolean
functions so that satisfy certain avalanche criteria, but
constructing them is a harder task.  The strict avalanche
criteria (SAC) guarantees that exactly half of the output bits
change when one input bit changes [WEB86].
A few years ago cryptographers proposed choosing S-boxes so that
the different distribution table for each S-box is uniform.  This
would provide immunity against differential cryptanalysis by
smoothing out the differentials in any particular round
[ADA92,DAW91A,DAW91,NYB91].  LOKI is an example of this
design.  However, this approach can sometimes aid in differential
cryptanalysis [BIH92B].  Actually, a better approach is making
sure that the maximum differential is as small as possible. Kwangjo Kim proposed five criteria for the construction of S-
boxes [KIM93A], similar to the design criteria for the DES S-
Choosing good S-boxes is not an easy task, and there are many
competing ideas on how to do it.  Four general approaches can be
     Choose randomly:  It is clear that small random S-boxes are
     insecure, but large random S-boxes may be good enough.      Random S-boxes with 8 or more inputs are quite strong.  And
     even more strength is added if the S-boxes are both random
     and key-dependent.  IDEA uses both large and key-dependent
     S-boxes.
     Choose and test:  Some ciphers generate random S-boxes and
     then test them for the requisite properties.  See [ADA90]
     for an example of this approach.
     Man-made:  This technique uses little mathematics; S-boxes
     are generated using more intuitive techniques.  Bart Preneel
     stated that "...theoretically interesting criteria are not
     sufficient [for choosing Boolean functions for S-boxes]..."
     and that "...ad hoc design criteria are required" [PRE93].
     Math-made:  Generating S-boxes according to mathematical
     principles so that they have proven security against
     differential and linear cryptanalysis, and good diffusive
     properties.  See [NYB94A] for an excellent example of this
     approach.
There has been some call for a combination of he "math-made" or
"man-made" approaches [ROB94], but the real debate seems to be
between randomly-chosen S-boxes and S-boxes--whether created or
culled--that have certain properties.  Certainly the latter
approach has the advantage of being optimal against known
attacks--linear and differential cryptanalysis--but it offers
unknown protection against unknown attacks.  The designers of DES
knew about differential cryptanalysis, and the DES S-boxes were
optimized against it.  They did not seem to know about linear
cryptanalysis, and the DES S-boxes are very weak against it
[MAT95].  Random S-boxes in DES would be weaker against
differential cryptanalysis and stronger against linear
On the other hand, random S-boxes may not be optimal against
known attacks but they can be made sufficiently large and
therefor sufficiently resistant.  And they are more likely to be
sufficiently resistant against unknown attacks.  The debate is
still going on, but my personal feeling is that S-boxes should be
as large as possible, random, and key-dependent.
[ADA92] C.M. Adams, "On Immunity Against Biham and Shamir's
     'Differential Cryptanalysis,'" Information Processing
     Letters, v. 41, n. 2, 1992, pp. 77-80.
[ADA90] C.M. Adams and S.E. Tavares, "The Structured Design of
     Cryptographically Good S-Boxes," Journal of Cryptology, v.
     3, n. 1, 1990, pp. 27-41.
[BIH95] E. Biham "On Matsui's Linear Cryptanalysis," Advances in
     Cryptology--EUROCRYPT '94 Proceedings, Springer-Verlag,
     1995, to appear.
[BIH92B] E. Biham and A. Shamir, Differential Cryptanalysis of
     the Data Encryption Standard, Springer-Verlag, 1993.
[CHA95] F. Chabaud and S. Vaudenay, "Links Between Differential
     and Linear Cryptanalysis," Advances in Cryptology--EUROCRYPT
     '94 Proceedings, Springer-Verlag, 1995, to appear.
[DAW91A] M.H. Dawson and S.E. Tavares, "An Expanded Set of Design
     Criteria for Substitution Boxes and their Use in
     Strengthening DES-like Cryptosystems," IEEE Pacific Rim
     Conference on Communications, Computers, and Signal
     Processing, IEEE, Victoria, BC, Canada, 9-10 Mary 1991, pp.
     191-195.
[DAW91] M.H. Dawson and S.E. Tavares, "An Expanded Set of S-box
     Design Criteria Based on Information Theory and its Relation
     to Differential-like Attacks," Advances in Cryptology--
     EUROCRYPT '91 Proceedings, Springer-Verlag, 1991, pp. 352-
     367.
[GOR83] J.A. Gordon and R. Retkin, "Are Big S-boxes Best?"
     Cryptography, Proceedings of the Workshop on Cryptography,
     Burg Feuerstein, Germany, March 29-April 2, 1982, Springer-
     Verlag, 1983, pp. 257-262.
[KAL94B] B.S. Kaliski and M.J.B. Robshaw, "Linear Cryptanalysis
     Using Multiple Approximations,"  Advances in Cryptology--
     CRYPTO '94 Proceedings, Springer-Verlag, 1994.
[KIM93A]  K. Kim, "Construction of DES-like S-boxes Based on
     Boolean Functions Satisfying the SAC,"  Advances in
     Cryptology--ASIACRYPT '91 Proceedings, Springer-Verlag,
     1993, pp. 59-72.
[KNU94] L.R. Knudsen, "Practically Secure Feistel Ciphers," Fast
     Software Encryption, Cambridge Security Workshop
     Proceedings, Springer-Verlag, 1994, pp. 211-221.
[KWA91B] M. Kwan and J. Pieprzyk, "A General Purpose Technique
     for Locating Key Scheduling Weakness in DES-like
     Cryptosystems," Advances in Cryptology--ASIACRYPT '91
     Proceedings, Springer-Verlag, 1991, pp. 237-246.
[LAI91B] X. Lai, J. Massey, and S. Murphy, "Markov Ciphers and
     Differential Cryptanalysis," Advances in Cryptology--
     EUROCRYPT '91 Proceedings, Springer-Verlag, 1991, pp. 17-38.
[MAT95] M. Matsui, "On Correlation Between the Order of the S-
     boxes and the Strength of DES," Advances in Cryptology--
     EUROCRYPT '94 Proceedings, Springer-Verlag, 1995, to appear.
[NYB91] K. Nyberg, "Perfect Nonlinear S-boxes," Advances in
     Cryptology--EUROCRYPT '91 Proceedings, Springer-Verlag,
     1991, pp. 378-386.
[NYB93A] K. Nyberg, "On the Construction of Highly Nonlinear
     Permutations," Advances in Cryptology--EUROCRYPT '92
     Proceedings, Springer-Verlag, 1991, pp. 92-98.
[NYB94] K. Nyberg, "Provable Security Against Differential
     Cryptanalysis," presented at the rump session of Eurocrypt
     '94, May 1994.
[NYB94A] K. Nyberg, "Differentially Uniform Mappings for
     Cryptography,"  Advances in Cryptology--EURORYPT '93
     Proceedings, Springer-Verlag, 1994, pp. 55-64.
[NYB93] K. Nyberg and L.R. Knudsen, "Provable Security Against
     Differential Cryptanalysis," Advances in Cryptology--CRYPTO
     '92 Proceedings, Springer-Verlag, 1993, pp. 566-574.
[OCO91] L. O'Connor, "Enumerating Nondegenerate Permutations,"
     Advances in Cryptology--EUROCRYPT '93 Proceedings, Springer-
     Verlag, 1994, pp. 368-377.
[OCO94] L. O'Connor, "On the Distribution of Characteristics in
     Bijective Mappings," Advances in Cryptology--EUROCRYPT '93
     Proceedings, Springer-Verlag, 1994, pp. 360-370.
[OCO94A] L. O'Connor, "On the Distributino of Chracteristics in
     Composite Permutations," Advances in Cryptology--CRYPTO '93
     Proceedings, Springer-Verlag, 1994, pp. 403-412.
[PRE93] B. Preneel, "Analysis and Design of Cryptographic Hash
     Functions," Ph.D. diss., Katholieke Universiteit Leuven, Jan
     1993.
[PRE94A] B. Preneel and V. Rijmen, "On Using Maximum Liklihood to
     Optimize Recent Cryptanalytic Techniques, " presented at the
     rump session of EUROCRYPT '94, May 1994.
[ROB94] M.J.B. Robshaw, "Block Ciphers," Technical Report TR-601,
     RSA Laboratories, Jul 1994.
[WEB86] A.F. Webster and S.E. Tavares, "On the Design of S-
     Boxes," Advances in Cryptology--CRYPTO '85 Proceedings,
     Springer-Verlag, 1986, pp. 523-534.

@_date: 1994-09-12 21:18:26
@_author: Bruce Schneier 
@_subject: RC4 
I've been out of e-mail range for a while, so some of sci.crypt has fallen
off the back end of my host.  And I don't read the full Cypherpunks feed.
So some of these may be dumb questions, but they're mine and I would like
them answered.
Does anyone know if this is really RC4?  Has anyone compiled it to see
if it will run?  Has anyone tried to use it to decrypt messages encrypted
with some commercial RC4 program?
I see that it has been posted anonymously.  Was it posted to Cypherpunks
only, or did it also get on sci.crypt?  If not, did someone from
Cypherpunks, anonymously or not, crosspost it to sci.crypt?
Has there been any reaction from anybody?  RSADS?  NSA?  NIST?  I just
sent a copy of Bidzos asking for comment.
This seems to be a REALLY GOOD THING, but I would like some verification
that it is not a hoax.
Inquiring minds want to know.

@_date: 1994-09-13 00:21:24
@_author: Bruce Schneier 
@_subject: RC4 
It occurs to me that if the code has not been posted to sci.crypt, then
some cypherpunks reader outside the US/Canada should do so.

@_date: 1994-09-13 07:15:56
@_author: Bruce Schneier 
@_subject: RC4 
Ah.  So the odd subject line resulted in many people not seeing.  I don't
know if any US residents would be willing to repost.  I'm not.

@_date: 1994-09-21 14:35:42
@_author: Bruce Schneier 
@_subject: National Research Council study of cryptography 
To interested parties:
  The committee membership for the NRC's study of national cryptography
  policy has been finalized, and the project description and final list of
  committee membership is attached.  I specifically call your attention to
  the part of the project description that invites members of the
  interested public to submit views on the questions the study will be
  addressing.
  The National Research Council appreciates your interest in this project.
  Please redistribute this message to anyone you think may be interested.
        A STUDY OF NATIONAL CRYPTOGRAPHY POLICY
                  September 14, 1994
  Cryptographic technologies are critical to a wide variety of important
  military and civilian applications involving sensitive or classified
  information that must be protected from unauthorized disclosure.  In
  addition, cryptography is a key component of most authentication
  technologies, i.e., technologies to guarantee the identity of a message's
  sender.  National cryptography policy has important implications for
  U.S. economic competitiveness, national security, law enforcement
  interests, and protection of the rights of private U.S. citizens.
  In an attempt to clarify some of the relevant policy issues, Public Law
  103-160 (passed by the U.S. Congress in November 1993) called for a
  comprehensive study from the National Research Council on
  cryptographic technologies and national cryptography policy.  The study
  will commence in the first week of October 1994.  As this study
  proceeds, the committee will make all feasible attempts to solicit a wide
  range of input and commentary from interested parties.  Input will be
  presented to the committee through a mix of briefings, presentations,
  consultations, invited and contributed papers, and testimony at regional
  public hearings. In addition, members of the interested public are
  invited to submit input to the committee as described below.
  The study plans to address the following issues:
    * the impact of current and possible future restrictions and standards
      regarding cryptographic technology on
        - the availability of such technology to foreign and domestic
          parties with interests hostile to or competitive with the
          national security, economic, commercial, and privacy
          interests of the U.S. government, U.S. industry, and private
          U.S. citizens;
        - the competitiveness of U.S. manufacturers of such technology
          in the international market;
        - the competitiveness and performance of commercial U.S.
          users of such technology;
        - U.S. national security and law enforcement interests;
    * the strength of various cryptographic technologies known and
      anticipated that are relevant for commercial and private purposes;
    * current and anticipated demand for information systems security
      based on cryptography;
    * the impact of foreign restrictions on the use of, importation of, and
      the market for cryptographic technology;
    * the extent to which current cryptography policy is adequate for
      protecting U.S. interests in privacy, public safety, national
      security, and economic competitiveness;
    * strengths and weaknesses of current key escrow implementation
      schemes;
    * how technology now and in the future can affect the feasible policy
      options for balancing the national security and law enforcement
      interests of government and the privacy and commercial interests
      of U.S. industry and private U.S. citizens;
    * recommendations for the process through which national security,
      law enforcement, commercial, and privacy interests are balanced
      in the formulation of national cryptography policy.
  The study will be conducted by a 17-member committee (listed at the
  end of this document) that collectively has expertise in computer and
  communications technology; cryptographic technologies and
  cryptanalysis; foreign, national security, and intelligence affairs; law
  enforcement; science policy; trade policy; commercial and business
  dimensions of computer technology (hardware and software vendors,
  users of cryptographic technologies); and interests in privacy and civil
  liberties.  A subpanel of the full committee will be cleared at the SI
  level and have access to all relevant information to ensure that the
  findings, conclusions, and recommendations of the unclassified report
  are consistent with what is known in the classified world.
  The project plan calls for the study to be delivered approximately two
  years after full processing of all necessary security clearances.
  However, the NRC will make every attempt to deliver the study sooner,
  and it currently believes that the core work of the study will be
  completed about 18 to 20 months after funding for the study has been
  received.  Additional time will be devoted to dissemination of the study
  report and follow-up activities.
  The final report of the study committee is subject to NRC review
  procedures that ensure the objectivity and integrity of all NRC reports.
  The main text of the report will be unclassified; classified annexes (if
  any) will be made available only to those with the appropriate security
  clearances.
  PROVIDING INPUT TO THE COMMITTEE
  The questions that the study is expected to examine are provided above.
  Members of the interested public are invited to submit their views on
  these questions and any other questions that you believe the committee
  should be addressing through either of the channels below.  If desired,
  requests for personal presentations to the committee should be submitted
  through these channels as well; the committee will respond affirmatively
  to as many such requests as possible, but time and resource constraints
  will limit the number of such requests that can be honored.
  Internet: send comments and other correspondence to
  CRYPTO at NAS.EDU.
  U.S. Mail:
      Cryptography Project
      Computer Science and Telecommunications Board
      National Research Council
      Mail Stop HA-560
      2101 Constitution Avenue, NW
      Washington, DC  20418
                  COMMITTEE TO STUDY
             NATIONAL CRYPTOGRAPHY POLICY
  Kenneth Dam, committee chair, was Deputy Secretary of State (1982-
  1985) and is currently the Max Pam Professor of American and Foreign
  Law at the University of Chicago Law School.
  General W. Y. Smith, retired, committee vice-chair, is president
  emeritus of the Institute for Defense Analyses, and has also served in a
  number of military posts including that of deputy commander in chief of
  the U.S. European Command in Germany.
  Lee Bollinger, formerly dean of the University of Michigan Law School,
  is currently provost of Dartmouth College and a constitutional scholar.
  Ann Caracristi, retired, was Deputy Director of the National Security
  Agency (1980-1982).
  Benjamin Civiletti was U.S. Attorney General (1979-1981), and is
  currently in private practice with the law firm Venable, Baetjer, Howard
  and Civiletti.
  Colin Crook is senior technology officer for Citicorp.
  Samuel Fuller is vice president of corporate research at Digital
  Equipment Corporation.
  Leslie Gelb is president of the Council on Foreign Relations.  He served
  as Assistant Secretary of State for Politico-Military Affairs
  (1977-1980).
  Ronald Graham is a director of information sciences at AT&T Bell Labs
  and a professor of mathematics at Rutgers University.
  Martin Hellman is professor of electrical engineering at Stanford
  University.  Dr. Hellman was one of the inventors of public key
  encryption.
  Julius Katz is president of Hills & Company, and was deputy United
  States trade representative (1989-1993).
  Peter Neumann is principal scientist in the Computer Science Laboratory
  at SRI International.  He is the chairman of the ACM committee on
  computers and public policy, and a member of the ACM study group on
  cryptography policy.
  Raymond Ozzie is president of Iris Associates, a wholly-owned
  subsidiary of the Lotus Development Corporation.  Iris Associates is the
  developer of Lotus Notes.
  Kumar Patel is vice chancellor for research at UCLA.
  Edward Schmults was Deputy Attorney General of the United States
  (1981-1984) and is a former senior vice president for external relations
  and general counsel for the GTE Corporation.
  Elliot Stone is executive director of the Massachusetts Health Data
  Consortium, which is responsible for the collection and analysis of the
  state's large health care databases.
  Willis Ware, retired, is with the RAND Corporation as senior computer
  scientist emeritus.  He chairs the Computer System Security and Privacy
  Advisory Board which was established by the Computer Security Act of
  1987.
                STAFF AND ORGANIZATIONS
  Marjory Blumenthal is director of the Computer Science and
  Telecommunications Board (CSTB).
  Herbert Lin is study director and senior staff officer of the CSTB.
  Inquiries about this study should be directed to him at 202-334-3191 or
  via Internet at HLIN at NAS.EDU.
  The National Research Council (NRC) is the operating arm of the
  Academy complex, which includes the National Academy of Sciences,
  the National Academy of Engineering, and the Institute of Medicine.
  The NRC provides impartial and independent advice to the federal
  government and other policy makers, by applying top scientific and
  technical talent to answer questions of national significance.  In
  addition, the NRC often acts as a neutral party in convening meetings
  among multiple stakeholders on various controversial issues, thereby
  facilitating the generation of consensus.
  Within the NRC, the CSTB considers technical and policy issues
  pertaining to computer science, telecommunications, and associated
  technologies as critical resources and sources of national economic
  strength.  A list of CSTB publications is available on request to
  CSTB at NAS.EDU or by calling 202-334-2605.

@_date: 1995-02-12 15:39:37
@_author: schneier@chinet.chinet.com 
@_subject: Factoring - State of the Art and Predictions 
((Comments are appreciated.  -Bruce))
Factoring large numbers is hard.  Unfortunately for algorithm
designers, it is getting easier.  Even worse, it is getting
easier faster than mathematicians expected.  In 1976 Richard Guy
 "I shall be surprised if anyone regularly factors numbers
of size 10^80 without special form during the present century." In 1977 Ron Rivest said that factoring a 125-digit number would
take 40 quadrillion years.  In 1994 a 129-digit number was
factored.  If there is any lesson in all this, it is that making
predictions is foolish.
Table 1 shows factoring records over the past dozen years.  The
fastest factoring algorithm during the time was the quadratic
         Table 1:  Factoring Using the Quadratic Sieve
         year     # of decimal               how many times harder to
                  digits factored            factor a 512-bit number
         1983     71                         > 20 million
         1985     80                         > 2 million
         1988     90                         250,000
         1989     100                        30,000
         1993     120                        500
         1994     129                        100
These numbers are pretty frightening.  Today it is not uncommon
to see 512-bit numbers used in operational systems.  Factoring
them, and thereby completely compromising their security, is well
in the range of possibility: A weekend-long worm on the Internet
could do it.
Computing power is generally measured in mips-years: a one-
million-instruction-per-second computer running for one year, or
about 3*10^13 instructions.  By convention, a 1 mips machine is
equivalent to the DEC VAX 11/780.  Hence, a mips-year is a VAX
11/780 running for a year, or the equivalent.
The 1983 factorization of a 71-digit number required 0.1 mips-
years; the 1994 factorization of a 129-digit number required
5000.  This dramatic increase in computing power resulted largely
from the introduction of distributed computing, using the idle
time on a network of workstations.  The 1983 factorization used
9.5 CPU hours on a single Cray X-MP; the 1994 factorization used
the idle time on 1600 computers around the world for about 8
months.  Modern factoring methods lend themselves to this kind of
distributed implementation.
The picture gets even worse.  A new factoring algorithm has taken
over from the quadratic sieve: the general number field sieve. In 1989 mathematicians would have told you that the general
number field sieve would never be practical.  In 1992 they would
have told you that it was practical, but only faster than the
quadratic sieve for numbers greater than 130-150 digits or so. Today it is known to be faster than the quadratic sieve for
numbers well below 116 digits.  The general number field sieve
can factor a 512-bit number over 10 times faster than the
quadratic sieve.  The algorithm would require less than a year to
run on an 1800-node Intel Paragon.  Table 2 gives the number of
mips-years required to factor numbers of different sizes, given
current implementations of the general number field sieve.
         Table 2: Factoring Using the General Number Field Sieve
         # of bits         mips-years required to factor
         512               30,000
         768               2*10^8
         1024              3*10^11
         1280              1*10^14
         1536              3*10^16
         2048              3*10^20
And the general number field sieve is still getting faster. Mathematicians keep coming up with new tricks, new optimizations,
new techniques.  There's no reason to think this trend won't
continue.  A related algorithm, the special number field sieve,
can already factor numbers of a certain specialized form--numbers
not generally used for cryptography--must faster than the general
number field sieve can factor general numbers of the same size. It is not unreasonable to assume that the general number field
sieve can be optimized to run this fast; it is possible that the
NSA already knows how to do this.  Table 3 gives the number of
mips-years required for the special number field sieve to factor
numbers of different lengths.
         Table 3: Factoring Using the Special Number Field Sieve
         # of bits         mips-years required to factor
         512               < 200
         768               100,000
         1024              3*10^7
         1280              3*10^9
         1536              2*10^11
         2048              4*10^14
At a European Institute for System Security workshop in 1992, the
participants agreed that a 1024-bit modulus should be sufficient
for long-term secrets through 2002.  However, they warned: "Although the participants of this workshop feel best qualified
in their respective areas, this statement [with respect to
lasting security] should be taken with caution."  This is good
The wise cryptographer is ultra-conservative when choosing
public-key key lengths.  To determine how long a key you need
requires you to look at both the intended security and lifetime
of the key, and the current state-of-the-art of factoring.  Today
you need a 1024-bit number to get the level of security you got
from a 512-bit number in the early 1980s.  If you want your keys
to remain secure for 20 years, 1024 bits is likely too short.
Even if your particular secrets aren't worth the effort required
to factor your modulus, you may be at risk.  Imagine an automatic
banking system that uses RSA for security.  Mallory can stand up
in court and say: "Did you read in the newspaper in 1994 that
RSA-129 was broken, and that 512-bit numbers can be factored by
any organization willing to spend a few million dollars and wait
a few months?  My bank uses 512-bit numbers for security, and by
the way I didn't make these seven withdrawals."  Even if Mallory
is lying, the judge will probably put the onus on the bank to
prove it.
Earlier I called making predictions foolish.  Now I am about to
make some.  Table 4 gives my recommendations for public-key
lengths, depending on how long you require the key to be secure. There are three key lengths for each year, one secure against an
individual, one secure against a major corporation, and the third
secure against a major government.
Here are some assumptions from the mathematicians who factored
         We believe that we could acquire 100 thousand machines
         without superhuman or unethical efforts.  That is, we would
         not set free an Internet worm or virus to find resources for
         us.  Many organizations have several thousand machines each
         on the net.  Making use of their facilities would require
         skillful diplomacy, but should not be impossible.  Assuming
         the 5 mips average power, and one year elapsed time, it is
         not too unreasonable to embark on a project which would
         require half a million mips years.
The project to factor the 129-digit number harnesses an estimated
0.03% of the total computing power of the Internet, and they
didn't even try very hard.  It isn't unreasonable to assume that
a well-publicized project can harness 0.1% of the world's
computing power for a year.
Assume a dedicated cryptanalyst can get his hands on 10,000 mips-
years, a large corporation can get 10^7 mips-years, and that a
large government can get 10^9 mips-years.  Also assume that
computing power will increase by a factor of ten every five
years.  And finally, assume that advances in factoring
mathematics allows us to factor general numbers at the speeds of
the special number field sieve.  Table 4 recommends different key
lengths for security during different years.
         Table 4: Recommended public-key key lengths (in bits)
         Year     vs. I             vs. C             vs. G
         1995      768              1280              1536
         2000     1024              1280              1536
         2005     1280              1536              2048
         2010     1280              1536              2048
         2015     1536              2048              2048
Remember to take the value of the key into account.  Public keys
are often used to secure things of great value for a long time:
the bank's master key for a digital cash system, the key the
government uses to certify its passports, a notary public's
digital signature key.  It probably isn't worth the effort to
spend months of computing time to break an individual's private
key, but if you can print your own money with a broken key the
idea becomes more attractive.  A 1024-bit key is long enough to
sign something that will be verified within the week, or month,
or even a few years.  But you don't want to stand up in court
twenty years from now with a digitally signed document, and have
the opposition demonstrate how to forge documents with the same
Making predictions beyond the near future is even more foolish. Who knows what kind of advances in computing, networking, and
mathematics are going to happen by 2020?  However, if you look at
the broad picture, in every decade we can factor numbers twice as
long as in the previous decade.  This leads to Table 5.
         Table 5:  Long-range factoring predictions          Year     Key length (in bits)
         1995     1024
         2005     2048
         2015     4096
         2025     8192
         2035     16,384
         2045     32,768
Not everyone will agree with my recommendations.  The NSA has
mandated 512-bit to 1024-bit keys for their Digital Signature
Standard--far less than I recommend for long-term security.  PGP
has a maximum RSA key length of 1280 bits.  Lenstra, the world's
most successful factorer, refuses to make predictions past ten
years.  And Table 6 gives Ron Rivest's key-length
recommendations, originally made in 1990, which I consider much
too optimistic.  While his analysis looks fine on paper, recent
history illustrates that surprises regularly happen.  It makes
sense to choose your keys to be resilient against future
         Table 6: Rivest's Optimistic Key-Length Recommendations (In
         Bits)
         Year     Low      Avg      High
         1990     398      515      1289
         1995     405      542      1399
         2000     422      572      1512
         2005     439      602      1628
         2010     455      631      1754
         2015     472      661      1884
         2020     489      677      2017
         Low estimates assume a budget of $25,000, the quadratic
         sieve algorithm, and a technology advance of 20% per year.          Average estimates assume a budget of $25 million, the
         general number field sieve algorithm, and a technology
         advance of 33% per year.  High estimates assume a budget of
         $25 billion, a general quadratic sieve algorithm running at
         the speed of the special number field sieve, and a
         technology advance of 45% per year.
There is always the possibility that an advance in factoring will
surprise me as well, but I think that unlikely.  But why trust
me?  I just proved my own foolishness by making predictions.

@_date: 1995-01-22 13:24:34
@_author: schneier@chinet.chinet.com 
@_subject: E-Mail Security - New Book 
E-MAIL SECURITY WITH PGP AND PEM:
          HOW TO KEEP YOUR ELECTRONIC MESSAGES PRIVATE
                 ...a new book by Bruce Schneier
                     John Wiley & Sons, 1995
                       ISBN  0-471-05318-X
                             $24.95
The world of e-mail is the world of postcards.  Between you and
your correspondents may lurk a foreign government, a business
competitor, an overzealous law enforcement agency, or even just a
nosy neighbor.  The problem is, all of these potential
eavesdroppers, given fairly simple access tools, can read your
messages as easy as a postal worker can read your postcards.
E-MAIL SECURITY is about protecting electronic mail fm spies,
interlopers, and spoofs--people who may want to destroy, alter,
or just look at your private communications.  The book shows how
you can protect the financial information, contract negotiations,
or personal correspondence you entrust to public or private
networks--and it shows how this protection is available right
now, with free or inexpensive software.
The book discusses PGP and PEM: how they work, how they are
different, and how to choose which one is right for you.
TABLE OF CONTENTS:
Part I:  Privacy and Electronic Mail
     Chapter 1:     The Problem
     Chapter 2:     Encryption
     Chapter 3:     Key Management
     Chapter 4:     Authentication
     Chapter 5:     Certificates
     Chapter 6:     Keeping Your Private Key Private
     Chapter 7:     Odds and Ends
     Chapter 8:     Patents, Governments, and Export Laws
Part II:  Achieving Electronic-Mail Privacy
     Chapter 9:     Requirements and Features
     Chapter 10:    Privacy Enhanced Mail (PEM)
     Chapter 11:    Pretty Good Privacy (PGP)
     Chapter 12:    Comparing PGP and PEM
     Chapter 13:    Attacks Against PGP and PEM
Appendix A:    Pretty Good Privacy
Appendix B:    Privacy Enhanced Mail
If you are interested in a copy of E-MAIL SECURITY, please send a
check for $25 + $5 postage (ask for rates abroad) to:
     Bruce Schneier
     730 Fair Oaks Ave
     Oak Park, IL  60302
The book won't be available until at least the end of the month,
so please be patient.
