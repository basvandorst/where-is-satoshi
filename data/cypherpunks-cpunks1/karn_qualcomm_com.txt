
@_date: 1992-12-01 02:24:57
@_author: Phil Karn 
@_subject: Secure Key exchange 
allegedly asks:
Get a copy of last Saturday's New York Times. John's picture appears
on page 7. Of course, it's always possible for the NSA to print up a
"special edition" of that paper just for you... :-)

@_date: 1992-12-01 02:28:08
@_author: Phil Karn 
@_subject: Secure key exchange 
Perhaps. But if it's someone you know well, the imposter may have a
hard time passing that particular Turing Test. For example, Jeff
Schiller called me the other night, nominally to compare our RSA
public keys before signing, but we ended up chewing the fat for nearly
an hour.  It would be hard for an imposter to duplicate that feat
without arousing my suspicion.
Another (somewhat more likely) possibility is that the NSA or FBI
might be holding a gun to the guy's head when you call him up to
verify the key you got with his name on it. Perhaps we need "duress"
hash codes. :-)

@_date: 1992-12-16 11:48:04
@_author: Phil Karn 
@_subject: tempest devices and use 
Eh? The specific purpose of TEMPESTing a computer that handles
classified information is to contain any incidental information-
bearing electromagnetic emissions so they cannot be received at a
distance. But shielding is not only a security issue, it is also
highly desirable to minimize interference to users of the radio
spectrum (e.g., broadcast TV sets and radios).
Now the FCC Part 15 rules (which govern "incidental radiation devices"
such as computers) are much less stringent than TEMPEST, but this is
only an economic tradeoff because full TEMPEST-level shielding of a
computer can be very expensive. In fact, many classified shops have
instead built "screen rooms" (or entire screened buildings, such as
those at the NSA) so they can use standard commercial-grade computer
hardware. Anyone is free to add as much shielding to their computer
equipment or their entire buildings as they want.  There's absolutely
nothing illegal about it; in fact it's highly commendable to do so.
The FCC (and your neighbors) will thank you for it.
Now if you wanted to "mask" your computer's RF emanations with some
sort of RF noise source (such as a Tesla coil) that's another story.
Most transmitters require licenses for the obvious reason that they
can interfere with other users of the radio spectrum. But this has
nothing to do with your right (or even duty) to shield your computers.
Unfortunately the TEMPEST rules themselves are classified, so we
really don't know how much shielding is necessary, or what one can
pick up from an unshielded system, or exactly how you'd do it.
Obviously this is an attempt to protect NSA's own SIGINT methods. But
there is, to coin a phrase, "equal protection under the laws of
physics".  Star Warriors' claims notwithstanding, they're the same
for everyone, black (classified) or white, and they're open for
all to discover and apply on their own.

@_date: 1992-12-22 20:07:09
@_author: Phil Karn 
@_subject: Signing ascii text 
I see some potential problems here as people start signing ASCII text
(e.g., email messages, etc). Is there a convention for the end of line
sequence that is to be used for the copy of the file that is run through
the hash function? If there isn't, then the file hash will depend on the
local end-of-line convention, which is bad.
I'm facing this problem right now in an experimental "XMD5" command that
I've added to my FTP server. The idea is to let you compute a hash on
a remote file so you can compare it with a local file without actually
having to send it. It works great in binary mode, but ascii mode is

@_date: 1992-12-22 21:10:41
@_author: Phil Karn 
@_subject: Signing ascii text 
Okay, the cr/lf convention is what I suspected was the case. That's what
I'll implement. Can't do much about the munged messages...

@_date: 1992-11-11 15:00:43
@_author: Phil Karn 
@_subject: PGP problems with large key rings? 
I'm encountering problems when I try to form a large key ring (on the
order of 150 keys, each with several signatures). The file is large
enough (60+ Kb) but it is apparently trashed; when I run "pgp -kv" on
it I only see 4 keys.
This is under UNIX, so I don't think memory exhaustion is the problem.
I'm not sure I have the latest version of the UNIX port, so if somebody
could steer me to the right repository I'd like to try that too.

@_date: 1992-11-15 13:58:13
@_author: Phil Karn 
@_subject: Apple including PKS? 
After reading the details of that (formerly) secret back-room agreement
between NSA and SPA, I don't think I'll *ever* trust a commercial
encryption package, especially one for which source code is unavailable
for scrutiny.
I've learned an important lesson in this business. You can never depend on
someone else to ensure your privacy. You have to do it yourself.

@_date: 1992-11-25 15:38:09
@_author: Phil Karn 
@_subject: RS232 Crypto Dongle (idea for widely accessible crypto technology) 
I've also been thinking about the risks of running crypto software on
hackable PCs and ways of protecting against this with external special
purpose devices.
My thinking is to limit the external "dongle" to the one function that
is truly sensitive and worthy of special protection: RSA secret key
It seems to me that whenever you use a PC to encrypt or decrypt
something, you have to accept the risk that it might have been hacked,
and whatever you do on it might be secretly recorded.
But when I now run PGP (or any similar package) on a machine, I must
risk much more than this every single time I type in my pass phrase,
namely *everything* that ever was or will ever be encrypted with this
same RSA key pair. This may well be an unacceptable risk, especially
if I'm temporarily borrowing somebody else's machine or using one in a
public area. I see this as THE major obstacle to our goal of routinely
encrypting all communications, sensitive or otherwise, as a way of
"desensitizing" the world to the use of cryptography.
The way around this risk is to move the RSA secret key storage and
processing operations to some external dongle. The device would have
only one primary function -- the execution of an RSA secret key
operation. It would not allow the secret key to be read out of the
device, although it might have a "zeroize" function to destroy it. (It
might also include a good random number generator for the convenience
of the host computer.)
Everything else (data compression and armoring, public key operations,
symmetric cryptography, etc) can and should go in the PC where cycles
and memory space are much more plentiful.
If the dongle has a built-in keypad, then it could store your RSA
secret key encrypted with a PIN that you'd have to enter to enable the
device. This would protect you if the device were stolen. Of course,
the best protection is to make the device so small that you can
conveniently keep it with you at all times instead of having to store
it someplace.
I believe that "smart cards" are already available on the market that
do these or similar functions, although they are much more widespread
in Europe than in the US.

@_date: 1992-11-25 16:47:49
@_author: Phil Karn 
@_subject: RS232 Crypto Dongle (idea for widely accessible crypto technology) 
I had this in mind too. But there's a problem -- if we have to depend
on commercial manufacturers to build these things, how will we know if
we can really trust them? I'm not impugning the manufacturers
themselves, as it's entirely possible that the FBI and/or NSA wouldn't
even let them build and sell a device like this if it's "too" secure.
That's the paradox of freely-available crypto software like PGP.  The
software, including source, is open for inspection by all. But because
it runs on general purpose computer hardware, it's vulnerable to all
of the usual computer security attacks (viruses, modifications to
secretly record or transmit keys, keystroke monitors, etc). Going to
small, dedicated pieces of hardware removes these vulnerabilities, but
then we're right back where we started -- with an opaque piece of
commercial hardware whose secure operation we can't verify.
Unless, of course, we can get the technology to build PCMCIA cards
ourselves out of readily available parts...

@_date: 1992-11-26 23:06:08
@_author: Phil Karn 
@_subject: The NSA Backs Down!! 
r a AM-DeclassifiedCodes     11-26 0287
^AM-Declassified Codes,0266<
^Government Reverses Itself, Declassifies Studies On Secret Codes<
itself and declassified two cryptography texts it previously had
insisted were secret even though they were available in public
under the Freedom of Information Act by a Silicon Valley computer
scientist who believes private companies should have more access to
secret code technology.
the 50-year-old studies on encryption _ the science of designing
prosecute Gilmore under a 1950s espionage law if he distributed
copies of the texts.
information could seriously damage national security. The agency is
in charge of protecting U.S. codes and cracking foreign ones.
of Cambridge, Mass.
necessary for private companies to make modern computer and
telephone systems secure from tampering.
and teach himself about encryption?'' asked Michael Godwin, a staff
counsel at the foundation.
made secret again by the Reagan administration, in public
libraries. They presently are used as texts in military classes.
libraries. The studies are about 1,000 pages long.

@_date: 1992-11-27 15:05:14
@_author: Phil Karn 
@_subject: How far is to far? 
I must concur with George Gleason's remarks about "sneaking around in
the shadows of legality". I find myself getting a little uncomfortable
with some of the more anarchistic ideas expounded in this and similar
My interest in cryptography is very simple. I'm not interested in
overthrowing the government by force. Although I find "digital cash"
to be an interesting concept worthy of pursuit at least as an academic
exercise, I'm not trying to evade income taxes, establish an
underground economy or conceal criminal activity.  And although I do
believe that drugs, gambling, prostitution and other vices ought to be
legalized on both practical and philosphical grounds, I am not
particularly interested in using cryptography to protect the lowlifes
who inhabit these professions.
I am *very* interested, however, in cryptography's enormous potential
to protect individual privacy. With widely available strong
cryptography, the average individual will finally have the technical
means to draw a tight circle around the private aspects of his or her
life. The individual need let no one, especially the government, enter
without his or her permission.
Until now, we have had to depend entirely on the goodwill of
government to respect and obey those provisions of the Bill of Rights
that deal with privacy. Often this "good will" has been sadly lacking.
But now we can finally put some real teeth into the guarantees of the
First, Fourth and Fifth Amendments.  If you want to plot political
strategy for an upcoming election, or if you want to talk to your
attorney about some legal action, or even if you just want to discuss
your sex life with your spouse or SO, cryptography can guarantee you
an unprecedented degree of privacy. Just as good fences make good
neighbors, we may well find that in the hands of the people, good
cryptography will make for good government.
That's why I find cryptography so interesting, and that's how we
should sell it to the public.

@_date: 1992-11-27 15:53:20
@_author: Phil Karn 
@_subject: More comments on dongles 
George Gleason says
"I believe that carrying out the entire crypto operation in the dongle is
preferable to having it only do the secret key RSA processing"
and argues for this position mainly on the basis of host compatibility
I still disagree. Even if all the crypto operations were done in the
dongle, it wouldn't be a "turnkey" device that could operate totally
automatically.  You'd still need a way for your host computer to turn
it off and on, to select a public key for encryption or signature
verification, to load new public keys, etc. I.e., you'd have to run
special driver software on the host anyway. So why not limit the
dongle to the specific purpose for which it was designed (protecting
your RSA secret key) and do the less sensitive operations where memory
and cycles are far more plentiful, i.e., on the host?
Limiting the dongle's function to RSA secret key operations also
minimizes the dongle's communication requirements.  The only data
you'd have to send to it in normal operation would be short blocks to
be run through your RSA secret key operation, a heavily compute-bound
process. If I want to decrypt a file, I'd send the dongle the IDEA (or
DES) key that had been encrypted with my public key. Once the dongle
responds with the decrypted IDEA key, I can perform the actual IDEA
decryption on my host computer with no further dongle interaction.
Regardless of the file size, this would go at host CPU and/or disk
speed, not the speed of the port that's talking to the dongle.
Similarly for signing -- the MD-5 hashing of the file would proceed at
near disk speed (since MD-5 is so fast) and only the resulting hash
code would have to be passed to the dongle for the RSA secret key
A palmtop DOS machine like the HP-95 or Atari Portfolio would make a
good platform for a prototype dongle.  Most have serial ports
(standard or optional), and you could just plug them into a spare
serial port on a PC (again, speed is not critical). The palmtop's
keypad would be used to control the dongle, e.g., by accepting a pass
phrase to decrypt the stored copy of your RSA secret key, so you
wouldn't have to type it into a possibly compromised PC. And they're
small enough to carry around with you, thus making it harder for
somebody to hack.
The only drawback I can see to all of this is that palmtops are not
exactly speed demons, and RSA secret key operations are pretty slow to
being with (much slower than the public key operations, which are less
sensitive). But secret key operations are the heart of RSA, so you
don't have much choice if you want real security.
Since it is a sensitive step, RSA key generation could also be done on
the palmtop (although it would probably take hours) or it could be
done on an external, trusted PC and loaded into the palmtop. If your
main reason for using the dongle is to limit the trust you have to
place in a borrowed PC (as opposed to protecting against your own home
PC being hacked), this may be a reasonable thing to do.
Another idea just occurred to me. If you have a trusted machine (e.g.
your home PC) available to you over the net, you could use it as a
"remote dongle". You'd send it data to be run through the RSA secret
key operation and it would return it. Obviously, to be secure the
network exchanges would have to be encrypted in both directions,
otherwise anybody could either pick up the "remote dongle's" responses
or worse, send it data of his own choosing. A simple symmetric cipher
(IDEA, DES) would be adequate here since you control both ends of the
The main drawback of this approach (other than the need for network
connectivity) is the physical vulnerability of your unattended home

@_date: 1992-11-27 18:49:41
@_author: Phil Karn 
@_subject: More comments on dongles 
If you don't trust the host, then why are you running your plaintext
through it?
As I said earlier, my decision whether to trust a particular machine
depends heavily on how much I would lose if that trust were abrogated.
I might be willing to take the chance that this particular borrowed or
public PC has been hacked if the worst that can happen is that the
only slightly sensitive plaintext I'm working on at the moment is
compromised. Heck, I might even be signing or decrypting totally
public information, just to help raise the amount of encrypted traffic
on the net. In this case I might not care at all if my plaintext is
secretly recorded or sent somewhere.
But I would probably NOT be willing to trust the same PC with my
secret key, because it would compromise EVERYTHING I have ever
protected (or will protect) with that secret key. Including THE most
sensitive stuff I might have, the plaintext to which I might entrust
only to a RAM disk on my own home PC. Do you understand the
distinction here?
I seriously doubt this will be practical, even with constant
interaction with the dongle's keyboard. Most palmtop keyboards are a
real pain to use, so I would definitely prefer to limit my use of it
to truly sensitive things, like typing in my pass phrase to decrypt my
RSA secret key, or perhaps hitting a key to re-enable the device after
every N secret key operation requests from the host, or to restart a
timer that would otherwise exit the program and clear RAM after a
timeout in the event the device is lost or stolen.
As I said earlier, your "fully-functional dongle" fails to prevent
this attack. If it sits on a serial port between your possibly hacked PC
and the outside world, then it clearly must pass decrypted plaintext
to the PC where it could still be quietly written to disk.
Eh? The model I have is a local PC, possibly hacked, with a serial
port connected to my personal dongle sitting right beside it.
Obviously it would not do to have an insecure link between the PC and
the dongle (unless you had encryption on that link, as I suggested in
the case of using a remote machine in place of the dongle.) It should
be fairly hard to inject your own traffic on my 1-foot RS-232 link,
especially if I provide my own cable.
The "basic dongle" would only need one RS-232 port, and it would not
have to be fast. This is a definite advantage.
This is the one valid reason I can see for your approach. But dumb terminals
are getting pretty rare these days, at least in the places I hang out.

@_date: 1992-11-29 14:04:10
@_author: Phil Karn 
@_subject: Secure key exchange 
How byzantine!
PGP 2.1 will have a much more convenient facility for verifying public
keys that you receive over the network. If you say "pgp -kvc karn",
for example, it will display the MD-5 hash of karn's public key as 16
hex bytes. If you know the sound of my voice, you can call me on the
phone and have me read off the hash code that I compute here on my key
so you can compare it to the value you computed. If they match, you
can sign my key with reasonable confidence.
About the only way to defeat this system is for the bad guy who feeds
you the bogus key in my name to come to my house and hold a gun to my
head as I receive your phone call.
I would much rather trust a simple verification procedure based on
redundancy and close personal relationships than a single, complex,
impersonal process involving people I don't know. This is not to
impugn your integrity, of course -- I'm simply speaking on principle.
People need to be very selective about the signatures they sign,
otherwise they will become meaningless. I've already had people sign
my public key without any verification that it is legit. This is a
no-no.  I am bothered by the message that PGP currently generates when
it reads in some new public keys asking if you'd like to certify each
new key. Even though the default is "no", it makes it too easy to sign
a key without really verifying its authenticity.

@_date: 1993-04-03 16:56:53
@_author: Phil Karn 
@_subject: TEMPEST in a teapot 
A few minor comments on a pretty comprehensive and well written article.
Although TEMPEST is closely related to EMI shielding, remember that
TEMPEST is concerned only with *information bearing* radiations, not
interference. In particular, the switching power supply, a potentially
prodigious source of EMI, is not a significant TEMPEST issue because
power supply emissions carry little if any information. (Varying loads
might cause minor modulations of switching frequencies, etc, but this is
probably something that only the paranoid "covert channel" types worry
about. Maybe you coull tell when the floppy drive motor starts and stops,
but I doubt you could do much else.)
Who knows, cutting down on power supply radiation might make it easier
to extract information from the emissions that remain, because of the
jamming effect of power supply noise. But don't let that stop you. It's
your duty to your neighbors to emit as little RF noise as possible. When
I lived in New Jersey, I learned to my chagrin that my two PC clones
made my next door neighbor's AM radio useless. Only 25 miles from New
York, he was unable to listen to WABC, a 50KW clear channel AM station!
The problem disappeared completely when I installed some inline AC RFI
filters in the power supplies. Since we shared a pole transformer, I
theorize that the noise was conducted from my computer to his radio
directly over the power lines.
Which brings me to my next point. I have not seen *any* clone-grade PC
power supplies with adequate power line filtering. They have a minimal
LC lowpass network on the power supply board itself, but this is usually
inadequate. Whenever I buy a new power supply, the first thing I do when
I get it home is to replace the IEC power connector with an integrated,
shielded power connector/RFI line filter. These devices are widely
available for several dollars from electronics surplus houses and
amateur radio "hamfests". I also use power cords with built-in ferrite
"lumps" but these are probably harder to find (one particular hamfest
vendor had a lot of them a few years ago, but I haven't seen them
Modern monitors are *much* better shielded than the early PC monitors,
especially those no-name Korean or Taiwanese copies of the original IBM
PC monochrome monitor. If you have the misfortune of owning one of those
old monitors, as I do on one of my systems, chances are the lion's share
of its emissions are coming from the +70V power lead that runs from the
main circuit board to the video output stage on the base of the CRT.
(Note! Do NOT confuse this with the high voltage lead going to the anode
of the CRT!)
The +70V power line to the video output driver acts as an antenna for
radiated video signals that can be *quite* strong. I suspect that the
reports we've seen of successfully picking up the image on a computer
display were taking advantage of this. To fix the problem, just replace
the plain wire with a piece of shielded coax, bypass the ends with .01
or .1 uF capacitors of sufficient working voltage, and ground the
shields to circuit board ground on both ends.

@_date: 1993-04-06 16:39:24
@_author: Phil Karn 
@_subject: PGP help and comments. 
I agree 100%. Security packages like PGP are meaningful only when you
have your own personal machine to run it on. Indeed, it would be nice if
PGP could somehow tell when it is being run over a network, and severely
warn the user when he is about to type something secret (like a passphrase).
I don't know of any clean way to do it, though.

@_date: 1993-04-06 18:00:45
@_author: Phil Karn 
@_subject: WB: public kiosks 
Indeed. By definition, a public kiosk is in a public area, with open
access to all including the Bad Guy's agents and investigators. And
tracking people's physical movements in public places is an art that
investigators have had many years to refine and perfect. Many more
than, say, factoring large RSA public keys...

@_date: 1993-04-07 14:23:13
@_author: Phil Karn 
@_subject: Real-time BBS Encryption?? 
Actually, I think a much more powerful solution is to run TCP/IP over
the serial link and to encrypt individual IP datagrams. This is the
charter of the IETF "ip-security" working group, and there is already
a prototype implementation of one approach working.

@_date: 1993-04-07 15:22:56
@_author: Phil Karn 
@_subject: EMI shielding 
Apropos the recent discussion about TEMPEST shielding, there's an
interesting product that might prove quite useful: CAPCON EMI
suppressant tubing. A colleague got a shipment of it today.
It's ordinary black rubber tubing that has been loaded with iron
oxide. It comes in 26 sizes from .04" ID to 1.25" ID, and is claimed
to have much better attenuation than ferrite beads, especially at UHF
and microwave frequencies.
You can shield entire cable lengths with it, or you can apply it in
short segments (1" to 1') just like ferrite beads and get plenty of
attenuation for less cost and weight (this stuff is *heavy*, and the
1/2" stuff cost several dollars per foot.)
It's also available as sheeting in various thicknesses for lining
cabinets, etc.
I got the bright idea to test the absorptivity claims for this stuff
by putting an 8" piece into a microwave oven. After 10 seconds, it was
too hot to handle. I'd say it's doing just what it's supposed to do.
Contact info:
Capcon, Inc
147 W 25th St
New York, NY 10001
212-645-0185 (fax)

@_date: 1993-04-12 23:36:15
@_author: Phil Karn 
@_subject: FWEE!: kiosks 
Eric's comment about the complementary natures of a public kiosk and
a person's home suggests a hybrid whistleblowing scheme that combines
the best of both. The whistleblower creates his file in the privacy
of his own home on a floppy disk, encrypts it in the public key of
the whistleblowing system, and carries it to a public kiosk where he
sends it.
This gives the whistleblower plenty of time and quite a bit of privacy
as he composes his message (unless the PTB have bugged his home
computer, a possibility for a suspected repeat "offender"). The
step of physically carrying his file to the kiosk eliminates anything
that could be done to the whistleblower's phone (including traffic
analysis), although it would not stop physical surveillance of the
And if the whistleblower is accosted on his way to the kiosk, all they
could seize would be the ciphertext of his message, encrypted in the
public key of the whistleblowing service -- which the whistleblower
himself would not be able to decrypt even if he wanted to.
Think of the kiosk more as a public mailbox than a public phone.

@_date: 1993-04-13 00:21:26
@_author: Phil Karn 
@_subject: Modem encryption proposal 
Crypto synchronization seems to be a problem mainly in real-time
appliations like digital voice, where you don't have a reliable
protocol underneath you.
I advocate two approaches that don't seem to have been pursued much
yet, at least in the Internet: per-packet encryption (and possibly)
authentication) just above the IP layer, and stream encryption just
above TCP.
The former technique has the advantage of denying your adversary the
maximum amount of information, because only the IP header is in the
clear.  The transport header and all user data is protected, so an
eavesdropper can't tell which applications are communicating. And with
IP-in-IP encapsulation, you can even deny him knowledge about which
machines are actually communicating - a network-level service
analogous to anonymous remailers. With authentication, network level
security also provides good protection against replay attacks.
The latter technique (encrypting above TCP) has the advantage of being
more efficient (it doesn't break Van Jacobson TCP/IP header
compression), which may make it desirable for some interactive
sessions. This is essentially how encrypted Kerberos Telnet works now,
although I would like to generalize the service to work with any TCP

@_date: 1993-04-13 01:15:15
@_author: Phil Karn 
@_subject: Security Dynamics 
Several years ago, before leaving Bellcore, I got so annoyed at the
SecurID cards and how they were being foisted on us by a paranoid
security organization that I built an alternative one-time password
system of my own. It's now called "S/KEY" (no, I didn't pick the name).
Essentially, I reinvented a scheme of Leslie Lamport involving iterated
one way functions. Each time you log in, you crunch your password
N-1 times through a one-way function like MD4 or MD5, where N is the
number of times you did it last time. The host crunches it once more
(to make its password file somewhat less sensitive) and compares it to
the stored password. If it matches, the file is updated and you get in.
A passive eavesdropper cannot generate the next password in the
sequence from the current one because that would require inverting the
one-way function.
The nice thing about this scheme is that it provides essentially the
same service as SecurID (protection against passive eavesdropping of
user passwords) without having to pay exhorbitant prices for cards and
integrating some really clunky hardware into your host. You have the
option of building the algorithm into your own comm programs, or even
the ultra-low-tech option of printing out a list in advance and
putting it in your wallet. (Use rice paper if you fear capture - you
can eat it!  :-))
The bad thing about this scheme is that it provides no more protection
than SecurID -- it doesn't stop someone from hijacking your session
after you've authenticated it, nor does it protect the session itself
against eavesdropping.  And frankly, at the time I was more concerned
about the security droids reading my email off the Ethernet than I was
about some outside cracker guessing my password.

@_date: 1993-04-17 23:23:43
@_author: Phil Karn 
@_subject: 1st Amendment Clipped? 
[cipher text deleted]
No, they won't. Possession of such an OBVIOUSLY subversive document
will prove conclusively that you're a dangerous enemy of the state,
and must be severely dealt with.
You'll be lucky to have a swift and painless execution.
Thought for the day:
"All I want is peace on earth, good will toward men."
"We're the United States Government. We don't do that sort of thing!"

@_date: 1993-04-19 23:53:42
@_author: Phil Karn 
@_subject: Sound bite time 
Paul E. Baclace:
I really, *REALLY* hope that this argument doesn't catch on.
Regardless of your opinions on gun control, you have to admit that
linking crypto to weapons saddles it with an enormous amount of
political baggage that we simply doesn't need. And it plays right into
the hands of those in the government who consider it as a "munition"
for export control purposes.
I think we already have plenty of strong arguments in defense of the
right to encrypt without opening up this can of worms. It can only
turn off a lot of people who would otherwise support us.

@_date: 1993-04-21 19:58:00
@_author: Phil Karn 
@_subject: The Family Key 
I think this is an extremely important point. The US precedents regarding
traffic analysis (e.g., telephone "pen registers") are very anti-privacy.
I would not be at all surprised to see decisions saying that law enforcement
could use the Chipper ID anyway they liked, without a warrant.

@_date: 1993-04-22 15:21:45
@_author: Phil Karn 
@_subject: WIRETAP: boycotts 
Boycotts seldom do much by direct economic pressure. If they accomplish
anything, they generally do so by the publicity they generate.

@_date: 1993-04-22 15:21:48
@_author: Phil Karn 
@_subject: CLIP: Legal Aspects 
I thought this was already true, at least in theory. It's known as the
"fruit of the poisoned tree" doctrine. Evidence gathered as a consequence
of illegally gathered evidence is in itself inadmissable. Of course,
this is probably what has been weakened the most by the Reagan/Bush
Supreme Court.
*This* is the fundamental problem. There are many possible ways that
illegal wiretaps can further the collection of other evidence, without
the existence of the illegal wiretap ever having to be revealed.

@_date: 1993-04-26 17:04:11
@_author: Phil Karn 
@_subject: Consumer phone privacy info sheet 
I suspect the Clipper chip will be used heavily in digital cellular phones,
if it isn't too much of a power hog.
I seriously doubt it. I could easily have done DES in software on our
CDMA digital cellphones using spare cycles in the CPU we already have
(a '186) had I been allowed to do so.  Why should I re-engineer my
already designed products to use a $30 IC instead?  Power is not the
only issue.

@_date: 1993-04-27 09:18:04
@_author: Phil Karn 
@_subject: Markey hearings on Thursday will be on the Internet MBone 
Does anybody know if the hearings will be carried on CSPAN?

@_date: 1993-04-29 12:09:02
@_author: Phil Karn 
@_subject: Tough Choices: PGP vs. RSA Data Security 
I think the ball's already in Bidzos's court. Consider the following Bidzos
quote a few days ago on the "billcryp" list:
Now the context of this quote was whether RSA could use its patents to
try to squash the more objectionable aspects of Clipper (particularly
key registration), but his wording is (perhaps unintentionally) much
more revealing. It implies to me that licensing PGP would be in
RSADSI's best business interests.  And so it would, if not for the
personal animosity between Bidzos and Zimmerman.
I sent a note to Bidzos asking him this exact question, but I have not
yet received a reply.
I am yet another person who would be glad to pay RSADSI a reasonable
fee to use RSA in the form of PGP. Cost is really not the main issue
here; PGP is the product I want to use, plain and simple. Nothing else
matches its features, especially the "web of trust" model for
certificates and the widespread availability of source code for
inspection.  Mailsafe isn't even in the running.
I use PGP only occasionally, in a personal and educational mode. I
would very much like to be able to recommend it to my company for
business use, but I can't do that under the present circumstances. And
that's too bad.

@_date: 1993-04-30 13:44:08
@_author: Phil Karn 
@_subject: npr report 
It's an even better analogy (for me) because of the experience I had a year
ago with a house I was renting. The owner had put it up for sale, so a
lockbox was installed on the garage door. One day I came home and noticed
that the box was open, and the key inside was missing.
Gave me a real warm and fuzzy feeling.
One of the really nice things about now owning a house (vs renting) is
that I can change the locks whenever I please and I don't have to give
a copy to *anybody*...

@_date: 1993-08-09 09:51:49
@_author: Phil Karn 
@_subject: ANON: Re: how does it work 
On most UNIX systems, nothing prevents an ordinary user (one without the
root password) from writing his/her own program for sending mail to a remote
site with SMTP/TCP/IP; there's no requirement to go through the normal
sendmail queue. Incoming mail is a different story, but at least you can
keep the outgoing half of your traffic from being logged.

@_date: 1993-08-09 11:11:46
@_author: Phil Karn 
@_subject: ANON: Re: how does it work 
You don't use the system telnet, you write your own socket application.
No UNIX systems I know log at this level, but it is certainly possible.
Or someone could record packets off the local Ethernet. There's not much
you can do about this.
You could hack up a copy of sendmail, but SMTP is so trivial that you
could do it yourself, especially since the functionality you need
is so limited.

@_date: 1993-08-09 20:01:56
@_author: Phil Karn 
@_subject: Secure voice software issues 
I recommend a signed Diffie Hellman key exchange for a secure phone.
That is, you generate a session key with Diffie Hellman, and you sign
your exchanges with RSA to guard against the meet-in-the-middle attack.
I agree that RSA public keys could be exchanged as needed during the
call, although this might require a few iterations before a party gets
a signature that it can trust. Finding a path through the PGP "web of
trust" back to a trusted public key that the other party already has
may be tricky. This is one thing that is much easier with a simple
tree a la PEM, as you simply give the path back up to a common, shared
root. I'm not sure how to do this with PGP. Perhaps the challenger could
list the public key(s) it trusts (perhaps just its own) and ask the
challenged party to find a (the) route through the web that connect
itself with the challenger's trusted key, and to return those keys and
signatures.  This might be easier than having the challenger remotely
"grope" through the paths in the challenged party's key database, one
signature/key at a time. Of course, keys and signatures ought to be
cached to speed the process the next time around. Or the users could
sign each others keys directly once they're satisified with their
If you first do Diffie Hellman and then immediately use the session
key it generates to conventionally encrypt the rest of the protocol,
including any RSA public key exchanges, this has the added benefit of
denying passive eavesdroppers any information that would identify the
parties to the call. The best an *active* eavesdropper (conducting a
man-in-the-middle attack against Diffie Hellman) could do is to trick
the parties into revealing their RSA public keys, and thus their
identities.  But the parties would quickly discover this at the
signature step, before the voice conversation actually starts.
Again, the *really* nice thing about this protocol is that once the DH
session key is destroyed, there's no way to recover it even if the RSA
secret keys are later compromised. And nothing (other than the
availability of CPU cycles) prevents you from rekeying periodically
during a single call.  The worst that could then happen if the phone
is captured and read out before it could be zeroized would be the
compromise of the conversation since the last rekey.

@_date: 1993-08-11 12:16:59
@_author: Phil Karn 
@_subject: Secure voice software issues 
You're creating an unnecessary vulnerability here. By using RSA to
encrypt the session key, all of your past conversations would be
compromised if your RSA secret key were ever revealed.
True, this is already the case for PGP-encrypted messages which are
usually sent over unidirectional mail channels. There you can't
really do much better.
Voice calls are different, as the availability of a two-way path lets
you do things much more securely. If you generate a session key with
DH and use PGP/RSA *only to sign the exchanges*, not to encrypt the
session key, then even if your RSA secret key is later compromised, it
would not compromise those session keys that had already been created,
used and destroyed.
This is a very powerful feature! Consider the profound effect it would
have on the whole topic of "rubber hose cryptanalysis", either in its
pure unadulterated form (blackmail, torture, death threats) or in its
"legal" form (being compelled to divulge an encryption key that could
be used against you, despite the 5th amendment). Session keys could be
created, authenticated, used and destroyed without the user ever
having to know them, or even having any way to recreate them after the
fact despite knowledge of the RSA secret key that was used to
authenticate them.

@_date: 1993-08-11 14:22:05
@_author: Phil Karn 
@_subject: Secure voice software issues 
Well...yes. *If* you know the person you are talking to, then you can
read off your session key (or preferably its hash) to guard against the
man in the middle. But let's say you are being referred to someone who
you don't already know (or you know them only by email, and have no idea
what they sound like). You trust this person, but you can't depend on
an oral challenge-response. The existing PGP web should be handy here.

@_date: 1993-08-11 15:42:05
@_author: Phil Karn 
@_subject: voluntary compliance 
Hmm...I have this strong feeling of deja vu. Where else have I heard this
expression before? Oh, right, the IRS! They always like to talk about how
our tax system is based on "voluntary compliance"...

@_date: 1993-08-11 19:07:35
@_author: Phil Karn 
@_subject: Secure voice software issues 
Yeah, but that kind of assumes connectivity to the net. It's rather inconvenient
for a pair of phones who only have dialup modems connected to each other
to do this on every call.
You could probably use temporary RSA key-pairs for each call, but RSA
key generation is notoriously slow. A lot slower than a Diffie-Hellman
key exchange.
Eh? No, as I've been saying, you can produce a very strong hybrid in
which both Diffie-Hellman and RSA each play an important part.
Diffie-Hellman generates the session keys, while RSA signs them.

@_date: 1993-08-11 19:52:05
@_author: Phil Karn 
@_subject: Secure voice software issues 
Whenever V.42 error correction (LAPM) is enabled, synchronous HDLC
frames are what actually pass over the link. So the start/stop bits are
already removed.  Unfortunately, the packetizing done by LAPM adds delay we
don't want for a real time voice application. And if you turn off LAPM,
you return to sending the start/stop bits over the wire.
Most V.32 and V.32bis modems provide for direct synchronous operation,
which would let us have our cake and eat it too, except that few PCs
can speak synchronously to a modem. This may require some extra
hardware (sigh).

@_date: 1993-08-12 12:42:54
@_author: Phil Karn 
@_subject: Secure voice software issues 
I see 160ms round trip times on my SLIP link from home to work, and I
can't account for all of this time by just adding up transmission
times and store-and-forward delays for the data rates and packet sizes
I'm using. And I don't think it can be explained by the trellis
decoding in V.32 bis, as that should account for only a few bits of
I've since heard of very similar figures for other modems, so It's not
just my modem. I'm beginning to suspect the V.42bis packetizing
algorithms. Although they're not described in the spec, I suspect that
real V.42bis implementations use timers to determine when to send the
the currently queued data as a frame. Or maybe there's a Nagle-like
algorithm like the one in TCP: immediately send the first byte of data
on an idle link, but keep additional traffic pending until the first
byte is acknowledged in order to aggregate stream traffic into larger
This is all speculation so far, but it does explain the long RTTs I
see with packet traffic even though raw character-at-a-time traffic
seems to be fast.  Stream traffic would see the worst delays of all,
which is ordinarily okay for a file transfer, but death to a real time
stream like voice. That's why we may be forced to turn off V.42
entirely and speak synchronously to the modem.
Time to haul out a protocol analyzer and do some timing measurements.

@_date: 1993-08-12 16:12:57
@_author: Phil Karn 
@_subject: Secure voice software issues 
Well, in theory turning off V.42bis entirely should get rid of these
delays, but in my exerience with Motorola Codex 3260 modems, it doesn't.
Don't know why.
Also, if you turn off LAPM you are back to sending start/stop bits again.

@_date: 1993-08-12 16:38:15
@_author: Phil Karn 
@_subject: Secure voice software issues 
I don't know about you, but 160ms *is* objectionable to me when typing
on a character-at-a-time telnet connection. And several people I've
tried to introduce to demand-dialed SLIP (instead of hogging annex
ports for hours with idle dumb terminals) have also complained about
the delay.
BTW, there's another problem with V.42bis compression that I haven't
mentioned yet. When you enable compression, most modems suck in
several seconds' worth of transmit data before they drop CTS to flow
control the host (this assumes the DTE speed is considerably faster
than the line speed, as it needs to be to get the most out of the
This is no problem if you're sending a large file with, say, ZMODEM;
presumably the modem buffers up all this data so it can figure out
whether to compress it or not. But this creates nasty delay problems
for SLIP/PPP when you try to mix bulk and interactive traffic streams.
Even if your router gives interactive (e.g., Telnet) packets priority
over bulk (e.g., FTP) traffic in its own interface send queues, it
can't do anything about the data that's already gone to the modem. So
if the modem buffers up 2 seconds of FTP data, then your telnet
packets will see 2 second delays even if it they have unconditional
priority in the router over your big background FTP transfer.
Worse still, some modems seem to buffer up all this data even when
you disable V.42bis compression. Sigh.
I point this out because many people would like to multiplex secure
voice with IP data over their SLIP links. This lets you use a single
phone line for voice and data simultaneously (especially if you have a
variable rate vocoder), and it lets you use the Internet for voice.
Not only does this let you bypass the long distance network, but it
would make a pen register on your modem line almost useless. It would
just show that you frequently call a local SLIP server to which you
presumably have legitimate access. :-)
But there are some problems yet to be solved. I'm rapidly coming to
the conclusion that the only way around the SLIP/PPP modem buffer/delay
problems is to speak raw synchronous data to the modems, even to the
point of implementing V.42bis and HDLC in the host computer instead of
using the modem's implementation.

@_date: 1993-08-13 01:08:26
@_author: Phil Karn 
@_subject: [uk.transport] Speed Camera with OCR 
Speaking of dummy speed traps, there's a great one on the road to
Aspen, Colorado (don't remember offhand the town name or the route, but
it's east of Aspen on the only road there).
Driving toward Aspen on a two lane road, we suddenly saw the classic
small-town speed trap: a cruiser parked off the other side of the
road, facing us with a radar gun pointed out the window and a cop in
the front seat.
Only as we went by did it become obvious (to me at least) that it was
a fake!  I stopped and went back with my camera to get a closer look.
The car was just an empty shell that had been rescued from the
junkyard, and the dummy in the front seat wasn't exactly up to Disney
AudioAnimatronics standards, if you know what I mean. But seen from a
distance in a moving car, it had the desired effect...
Don't forget low-tech! Of course, for those towns more interested in
collecting money than in getting people to slow down, this particular
approach may not appeal to them.

@_date: 1993-08-13 10:22:57
@_author: Phil Karn 
@_subject: Secure voice software issues 
I think there's a confusion here between the conflicting goals of low
delay and high throughput. Depending on which is more important to
your application, V.42bis will either "slow you down" or "speed you
up". Unfortunately, most modems don't give the user any way to say
whether delay or throughput is more important to you at the moment;
the modems themselves try to infer this automatically from the data
streams you send them. And they bias the decision in favor of greater
throughput. This is right for most computer applications, but not so
for real time voice.

@_date: 1993-08-13 10:48:27
@_author: Phil Karn 
@_subject: Beepers can also be used to track you down! 
Eh? Conventional pocket pagers are receive only. This is well known. Oh,
they probably do emit tiny amounts of RF from their local oscillators,
but I doubt much could be done with that.
Cell phones, on the other hand, *do* tell the system which cell you
are in, and they can do this even when you're not in a call. It's
called "registration".  The usual purpose is benign: directing pages
(land-to-mobile call requests) only to the cell you're in, instead of
having to "flood" them all over the system. But it *could* be used to
keep track of your location.
I carry both a pager and a cell phone.  Normally I keep the cell phone
turned off to save its batteries. When I get a page, I can turn the
phone on and return the call.  The pager/cellphone combination is very
nice, as I effectively get "caller ID" functionality.  Even better,
*I* get to choose when, how or even if to answer a particular page.
And since pagers are unidirectional (no acks) I can always lie about
not having gotten a page from somebody I don't want to talk to!  :-)

@_date: 1993-08-13 14:23:00
@_author: Phil Karn 
@_subject: Secure voice software issues 
Indeed. And because LAPM uses HDLC framing over the modem, you could
be completely compatible with a regular (asynch DTE interface) V.42bis
modem on the other end of the call. But by implementing V.42bis
yourself, you would have complete control over when frames get sent,
and how large they are.

@_date: 1993-08-15 01:31:52
@_author: Phil Karn 
@_subject: Pagers 
Yes, the microwave oven is designed to be especially effective at one
particular frequency. Look at the gasket on the inside surface of the
door.  Underneath is what is called a "quarter-wave choke". It looks
like a short circuit at the surface of the door, but only at 2450 Mhz,
the operating frequency of a microwave oven.
You probably still got a lot of shielding, it just wasn't enough.
Remember that modern communication receivers (even pocket pagers) are
capable of working with incredibly small amounts of signal energy by
human standards.  And paging systems are designed to blanket their
coverage areas with a *lot* of RF from multiple synchronized
transmitters, each running several hundred watts. This seeming
overkill is necessary to handle the very wide dynamic range in
propagation losses that terrestrial communication links can encounter
due to fading, multipath, terrain blockage, changing distances, etc.
Even a properly operating microwave oven that is well within all
radiation safety limits is *easily* detectable with a communications
receiver or spectrum analyzer (the latter is preferable because the
frequency is so unstable). I think I saw about -8dbm an inch from the
door seal of the oven I had back in NJ when I checked it. As I said,
this is well within biological safety limits but it is, by radio
communication standards, an *extremely* strong signal.
Amusing anecdote: recently I took one of our CDMA cellular phones into
a supposedly NSA-certified RF screen room at work (though it's not
used for government work). The cell antennas are on the roof of the
same building. I closed the room door and latched it, and the phone
still worked! I then put the phone into a conventional metal cabinet
in the room and my call finally dropped. It's conceivable that the
room still met specs (something like 100 dB), but that just wasn't
enough until I added a few more dB with the metal cabinet. Like I
said, mobile radio systems have to deal with some *very* wide dynamic

@_date: 1993-08-17 09:30:20
@_author: Phil Karn 
@_subject: ANON: alt.sexual.abuse.recovery 
One question is how he will enforce his ban on encryption if he only
rarely reads the messages passing through. He could probably write a
shell script that looks for PGP headers, but these could be stripped off.
He could probably look for ascii-encoded files with a flat character
distribution, but these could be uuencoded or binhexed.
Perhaps it's time to integrate one of the steganographic techniques
into the remailers as a configuration option. By inflating the size of
the messages it hides, that will increase the load through the
machines that don't like encrypted messages, but that's life.

@_date: 1993-08-21 11:41:46
@_author: Phil Karn 
@_subject: Cracking & auditing crypto protocols 
I knew one of the panelists, Ernie Brickell, when we were both at
Bellcore.  Of the five, he's probably the only one with claim to the
term Real Cryptanalyst, as we usually define the term (someone with a
proven track record in cracking real cryptosystems.)  He is generally
credited with putting the final nail into the coffin of the knapsack
public-key cryptosystem.  I was very disappointed when I heard that he
had agreed to let himself be used for such a crass political purpose
as the Clipper Committee.
Other than this minor point, your statement is absolutely correct.
The best known Real Cryptanalyst in civilian life, Adi Shamir, wasn't
involved, and even he took fifteen years to make the first dent in

@_date: 1993-08-27 13:13:24
@_author: Phil Karn 
@_subject: What, Me Worry? 
I follow the GPS universe fairly closely.  The term for the
intentional degrading of accuracy for "unauthorized" (civilian) users
is "Selective Availability" (SA).
The story gets even better. Although the DoD hasn't described how SA
works, it's now apparent that they add cryptographically generated
"phase noise" to the timebase on each satellite, probably with a
direct digital synthesizer. In other words, the satellite looks like
it has a noiser atomic clock than it really does. "Authorized" users
with the right keys can regenerate the same dither stream and subtract
it out of their observations.
During the Gulf War, the DoD quietly turned SA *off* because they
could only meet their immediate need for vast quantities of receivers
by tapping the commercial ("unauthorized") market.  Of course, this
did not go unnoted by the civilan GPS market; there were probably some
red faces in the Pentagon.  I do know there were a lot of broad grins
in the civilian world. It's almost as if they had decided to use PGP
on PC clones due to a lack of NSA-approved military crypto gear.
Unfortunately, after the war, DoD turned SA back on again. However,
the civies had a neat trick up their sleeves: "differential GPS". This
involves placing a GPS receiver in a fixed spot and having it
broadcast the difference between its known location and its current
position as determined by GPS. Because most of the errors in GPS are
strongly correlated between nearby receivers, this subtracts out
almost all the errors in the mobile user's position. Not just SA, but
ionospheric dispersion, orbital element inaccuracies, etc.  The result
is an accuracy of 1-3 meters, with or without SA.
The really fun part is this. Guess who's leading the effort to deploy
differential GPS beacons? The US Coast Guard! That's right, while one
side of the military intentionally sabotages the signal, another
military service (albeit under the Department of Transportation rather
than the DoD) works to un-sabotage it! Your tax dollars at work.
Actually, the Coast Guard says it would be doing differential GPS even
if SA were turned off.  With SA on, accuracy is typically on the order
of 100m; without it, accuracy improves only to about 25m, and this is
insufficient for many harbor approaches.
And here's yet another delightful irony in the GPS saga. The DoD
maintains a network of ground tracking stations that determine the
orbit of each GPS satellite. Every few hours they uplink these orbital
elements to the satellites so they can be broadcast to the users.
There was talk for a time of encrypting the low order bits of the
orbital elements as part of SA, but this apparently hasn't happened.
Nevertheless, GPS is so useful to the international scientific
community that they've set up their own network of tracking stations
to produce and disseminate their own GPS orbital elements. And while
the DoD-generated elements are good only to about 10-15m, the
civilians, having many more stations and better techniques, generate
sets good to less than 1m!

@_date: 1993-08-31 18:04:11
@_author: Phil Karn 
@_subject: (fwd'd) more Clipper inside? 
Yeah, the NIST folks have been on the road trying to sell Clipper to
those industry groups who don't yet (or should) know better. A month
or two ago, it was the TIA digital cellular folks.

@_date: 1993-12-01 01:37:53
@_author: Phil Karn 
@_subject: Cryptosplit 2.0 
I don't need to worry much about losing my secret key.  I can keep as
many backup copies as I like, in as many different places as I like --
all securely encrypted with my passphrase.
The application for secret sharing would be to allow some subset of
trusted people to regenerate your secret key *without your
assistance*. I could see several situations in which a voluntary
scheme like this could be useful, the main one being if you were to
die unexpectedly.

@_date: 1993-12-01 17:22:24
@_author: Phil Karn 
@_subject: A study of National Cryptography Policy 
A *two year*, *classified* study of national cryptography policy??
I suppose it's just as well. The closest thing we currently have to a
"national cryptography policy" are some ineffective and pointless
export controls that, if proposed legislation is adopted, may go away
in a few months anyway. That would leave civilian cryptography pretty
much unregulated -- exactly as it should be.
So sure, take all the time you like to "study" the issue. The longer
the better. The "cryptography genie" is already well out of its
bottle; in two years, it will be everywhere.
And yes, by all means, require security clearances of all the
participants and classify all of the proceedings. That will exclude
many of the biggest names in civilian cryptography -- those who are
not US citizens, who will not submit themselves to government
censorship, and who do not wish to lend any legitimacy to a government
effort that will inevitably try to regulate what will (and should) be
left alone. And it will stifle any embarassing public debates on minor
issues like free speech, freedom of association and personal privacy,
all of which are just annoying technicalities that keep law
enforcement and intelligence agencies from doing their jobs more
Better yet, restrict membership to these loyal law enforcement and
intelligence agencies, the same ones responsible for the silly current
state of export controls on cryptography. That should eliminate what
few shreds of credibility might remain in the Board's final report.

@_date: 1993-12-08 11:46:02
@_author: Phil Karn 
@_subject: San Jose Merc article on s/w industry crypto deal 
If the government really were to commit to removing export controls on
all civilian cryptography, and to ensuring that Clipper remains truly
voluntary, then I could see how the DPSG compromise *might* have some
merit.  With or without such an agreement, Clipper is a non-starter --
as long as better alternatives are readily available.
This is already true for general purpose computers. People can easily
run whatever encryption software they like on their PCs, whether the
NSA, FBI or anyone else likes it or not. Unfortunately, it is NOT true
for voice services like digital cellular. Although they contain
computers, digital phones are not as easily reprogrammed as PCs. And
even if they were, you still need the cooperation of the carrier to
decrypt your call at the base station (unless, of course, you encrypt
end-to-end, but then you need the right kind of data service from the
carrier, plus a compatible secure telephone on the land side of the
In theory, at least, under this "deal" the cellular vendors would be
free to support either Clipper or some other, better encryption
scheme, without fear of export controls destroying much of their
In reality, of course, the cellular carriers and manufacturers are
large and conservative enough (and do enough business with the
government) to be easily browbeaten into installing only Clipper, if
indeed they install any real encryption at all.  Indeed, the NSA
hardly had to lift a finger to browbeat the industry into installing a
trivial "voice privacy" scheme in TDMA cellular that can be broken by
any undergrad CS student in a few minutes.
So I'm not worried about the effect of this deal on general purpose
computer applications; it may even help, by getting rid of export
controls. But the big loser will inevitably be voice privacy.

@_date: 1993-12-10 16:39:38
@_author: Phil Karn 
@_subject: dithering, repudiable steganography 
I am not sure that your explanation of "granulation noise" and
dithering are quite correct. You showed how a low-amplitude sine wave
is quantized by the sampling process, but quantization errors are
unavoidable in any digital recording system, with or without
Here's another way to look at dithering. Let's say that I want to
represent a very low frequency audio signal ("low frequency" with
respect to the sampling rate). Let's assume further that over a period
of several samples, this signal has a relatively constant value of,
say, .25 microvolts in a system with 1 microvolt quantizing steps. If
I fed this into an ideal A/D converter, it would round it to the
closest representable level, i.e., 0 volts. And it would do so for
every sample, resulting in an constant error of .25 microvolts each
But suppose I add some analog noise to the signal before I sample it.
The analog noise I generate will be a uniformly distributed random
voltage between +.5 and -.5 microvolts. Now the resulting signal will
range uniformly between +.75 and -.25 microvolts. If it's between +.5
and +.75 microvolts, the A/D converter will round it to 1 microvolt;
if it's between -.25 and +.5 microvolts, it will round it to zero. The
first case will happen 25% of the time, and the second will happen 75%
of the time.
Now if you average the resulting samples using enough precision for
the sum, viola -- you get an average of .25 microvolts, instead of
zero. This is exactly what happens at the ear after the D/A
reconstruction process, if you turn the volume up high enough to hear
what's happening.  Sure, there's still noise, but at least the average
signal value is correct.
So one purpose of dithering is to better represent low-frequency, low
amplitude information. The effect on complex signals is to turn the
quantization noise that would otherwise occur in narrow frequency
bands (and be quite audible) and spread it out as constant, low level
white noise over the whole audio band, which is much less objectionable.
Dithering is important only when the original analog source material
is *very* clean. In most cases, the background noise in the room and
the noise generated in the low level microphone preamps is much more
than one LSB, so the signal is "self dithering".

@_date: 1993-12-28 14:17:42
@_author: Phil Karn 
@_subject: GPS and security 
I heard about this show, but missed it. Looks like 60 Minutes has
bought the military's scare story, hook line and sinker.
Sure, it's possible for a terrorist to build a GPS-guided bomb. But
terrorists have been building highly accurate (more accurate than GPS)
guided bombs long before GPS. The Japanese called them "kamikazes",
while in the Middle East the preference seems to be for heavy trucks.
As long as you've got fanatical pilots/drivers willing to sacrifice
themselves, who needs GPS?
I follow GPS and "selective availability" pretty closely. A complete
tutorial on this subject would be pretty long, but here are the major
GPS satellites broadcast several signals. Two RF carriers are used, L1
at 1575.42 Mhz and L2 at 1227.6 Mhz. All satellites use the same
frequencies; receivers can separate them because CDMA (code division
multiple access, a form of spread spectrum) is used.
These two carriers can carry two signals.  One is the C/A ("Coarse
Acquisition" or "Clear Access", depending on which reference you
read).  This is a 1.023 megachip/sec spread spectrum signal with a
short (1023) chip spreading sequence. The sequences (Gold codes, one
per satellite) are published. The second signal is the "P" (or
"Precision") code at 10.23 megachips/sec. This is a much longer
sequence that is restarted every week. Contrary to popular belief, the
P code is also published. It can, however, be encrypted with a
classified cipher to produce the "Y" code.
In general, the C/A code is only on the L1 carrier, while P/Y is on
both L1 and L2. The idea of having P/Y on two frequencies is to help a
receiver correct for ionospheric dispersion. Using the basic
principles of RF propagation through a plasma, by measuring the
difference between these two signals you can compute and correct for
the absolute dispersion delay.
Originally the C/A code was to be completely open, and the Y code
reserved to "authorized users" (i.e., the US military). The Y-code
encryption was more to prevent spoofing of the satellite signals than
to prevent its "unauthorized" use. That's why the Y-code mode is
usually called "antispoofing" mode, since someone who doesn't know the
encryption sequence can't produce a fake Y code.
The thinking was that the C/A code by itself wouldn't be accurate
enough to be a "threat".  But C/A receivers worked surprisingly well
(<25m), so the DoD got paranoid and introduced the notorious
"Selective Availability" (SA).  They haven't released the details of
how SA works, saying only that it will degrade accuracy to some
specified level, eg 100m with 95% confidence.  But many people have
observed SA in action and have a good idea how it works.
First, they can encrypt the low order bits of the satellite
ephemerides. These are the satellites' orbital elements that allow the
receiver to compute the position of each satellite as a function of
time. In order for the receiver to determine where it is, it needs to
know where the satellites are; if its estimate of a satellite's
position is incorrect, then so will its estimate of its own position.
Second, they can add cryptographically generated "phase noise" to the
atomic clock timebase. This adds "dither" to the ranges as measured
by the receiver, again leading to errors in the receiver's calculated
But there's a flaw in the ointment. If you take two GPS receivers and
place them side by side and tell them to track the same satellites, SA
will cause them to produce the SAME errors! This is the idea behind
"differential" GPS that has the DoD so spooked. Take a GPS receiver
and place it in a well-surveyed fixed spot. (Let it measure its
location for a month or two and average the results.) Then have it
periodically transmit, over a local radio link, the differences it
observes between the ranges it measures to each visible satellite and
what those ranges *should* be, given the receiver's accurately known
location. Other GPS receivers in the area can receive these
corrections and apply them to their own calculations.
Viola! Not only have you subtracted out all of the effects of SA, but
you've also corrected for several natural sources of error as well,
including ionospheric and troposperic dispersion. About the only
source of error remaining is each receiver's finite signal-to-noise
ratio, but this is minor compared to these other error sources.
Differential GPS accuracies of 2-3 m are not uncommon as long as the
reference receiver is within a few hundred km of the user receiver.
Since these accuracies are useful for many legitimate civilian
applications, e.g., harbor approach navigation, the US Coast Guard has
begun deploying differential GPS beacons along the US coast. The irony
here is amusing; first you have the DoD intentionally sabotaging the
signal with SA, and then another military service (albeit one under
the DoT rather than the Dod) comes along and undoes it. Your tax dollars
at work!
The Coast Guard also runs a GPS public information office. They have a
BBS and a watch officer you can call on the phone. They'll send you
information (e.g., the ICD-GPS-200 spec on the GPS signal interface)
free just for the asking.

@_date: 1993-12-28 15:07:35
@_author: Phil Karn 
@_subject: GPS and security 
You appear to be referring to Selective Availability. It was indeed turned
off during the Gulf War to allow the use of civilian C/A units. Companies
like Trimble couldn't keep up with the military demand during the buildup
to the war.
Selective availability was turned on again some months after the war
ended.  The effects were quite visible. The level of SA has varied
quite a bit since then.
False. SA-induced errors are time varying, so the differential trick
only works in *real time*. You need receivers at both the reference
location and the location to be measured at the same time. The
experience with differential GPS is that you need updates that are
less than 30 seconds old, otherwise accuracy degrades rapidly.
By the way, the differential updates include both range offset and
range-rate offset (relative velocity). The addition of range-rate
makes the updates last as long as 30 seconds, otherwise you'd need a
very high update rate to get 2-3m accuracy.
Also false. You need at least THREE satellites for any kind of GPS
position fix.  And you need to know your altitude ahead of time for
this to work.  Give a unit operating in 3 satellite mode the wrong
altitude, and it will give you the wrong latitude/longitude.  Four
satellites will give you a three-dimensional fix, i.e., the unit will
tell you your altitude.
Most units have an "auto 2D/3D" mode, where the unit remembers the
altitude from the last 3D (4 satellite) fix and uses it in 2D (3
satellite) mode.  Some other units, apparently including my Icom GP-22
unit, seem to assume you're at sea level whenever fewer than 4
satellites are visible. This may be a reasonable assumption for a unit
designed for marine use, but it is a bad assumption in places like
Colorado. When I took it there last summer, I often saw it give one
position as soon as it got 3 satellites, and then jump a half mile to
the correct position when it got the fourth.
About the only useful thing you can do with less than 3 visible
satellites is time transfer to a fixed station. A station in a known
location need only track one satellite in order to keep its clock
updated. At Qualcomm we use special GPS receivers (with built-in
rubidium clocks) in our CDMA base stations as time references to
synchronize our own spreading codes.

@_date: 1993-12-28 15:30:30
@_author: Phil Karn 
@_subject: GPS and security 
Well, yes, the USCG *is* building its first DGPS beacons along the
coasts, for obvious reasons. But there is precedent for the USCG
becoming involved in radionavigation coverage elsewhere in the
US. Several years ago, in conjunction with the FAA, the USCG built
several new Loran-C stations to fill in what had been known as the
"mid continent gap". Now there is good Loran-C coverage over the
entire continental US. If GPS becomes as popular for aviation as
Loran-C has become (at least for helicopter and general aviation, if
not commercial aviation) then I think it quite likely that the same
thing will be done with differential GPS stations.
The only catch is likely to be that if the primary "legitimate" user
of DGPS is aviation, then the DGPS beacons will be sited so as to give
good coverage to aircraft in flight and near airports, not necessarily
good coverage to any user anywhere on the ground. A similar situation
already exists with respect to VORs; get high enough and the entire
country is completely covered, but it's hard to hear one on the ground
unless you're very close to one.
The actual coverage of any DGPS beacon will depend on its frequency
and transmitter power. VHF or UHF would be the most natural places to
put these things for aviation use, and as everyone knows these tend to
be limited to near line of sight, just like VOR. The USCG is putting
its DGPS data on its existing LF (300 Khz range) marine
radiobeacons. These have wider coverage than VHF/UHF, but suffer from
noise and interference problems especially near major cities. Again,
these beacons are optimized for their intended users -- ships at sea,
not users on land.
I should note that the USCG isn't putting up DGPS beacons just to
defeat SA. Even without SA, plain C/A GPS isn't accurate enough for
precise harbor navigation. It just so happens that DGPS takes care of
SA as well as the natural errors they were originally worried about.
An alternative to the USCG-provided DGPS beacons is already provided
via FM broadcast subcarriers as a commercial service. The subscription
price is pretty high, though. They're probably trying to quickly
recoup their investment before the USCG beacons take much of their

@_date: 1993-02-06 18:17:30
@_author: Phil Karn 
@_subject: White Mail 
Hmm, I wonder what would happen if they start using PGP? After all,
the Federal government has full rights to use RSA. (Dunno about IDEA).
I have mixed feelings on this issue. On the one hand, the people have
a right to know how government authority is being exercised. On the other
hand, even people in government have privacy rights. And if you mandate
that their email is a public record, then they will just find other ways
to have private conversations.
Maybe the real answer lies in not giving them so much power in the first place.

@_date: 1993-02-07 22:07:22
@_author: Phil Karn 
@_subject: Compressed/Encrypted Voice using Modems 
Where do you get this figure of 22 kbps? I would tend to dispute it since
I use a Codex FAST modem on my SLIP link and it really does run at 24.0 kb/s
on the wire (not counting compression). The throughput display often reads
30 kb/s even when I'm shipping a pre-compressed or encrypted binary file,
although that's a phony figure because it includes the asynch
start/stop bits that aren't actually sent over the wire.
The usual Shannon limit of a phone line is more like 30 kb/s, although
it can vary enormously. Generalizations are dangerous. At the very least,
you can certainly say that it's no greater than 64kb/s, since it's almost
certain that your call passes through a mu-law codec somewhere.
Back to vocoders, their quality does tend to be a strong function of data
rate. 8kb/s CELP is really not that bad - a little warbly when there's
background noise, but not objectionably so in my opinion. In a mobile
environment (where I'm familiar with it), it's *much* less objectionable
than the usual impairments you get from ordinary FM analog transmission.
4kb/s is noticeably worse. Things get rapidly better as you go above 10-12
kb/s with present algorithms. Also, vocoders need not be constant rate.
Ours selects
one of four rates on the fly depending on voice activity, which doubles
capacity in a CDMA radio environment. It'd also be useful in a packet
network, although
the small frame sizes (2/5/10/22 bytes) can make header overhead rather

@_date: 1993-02-08 09:48:14
@_author: Phil Karn 
@_subject: Compressed/Encrypted Voice using Modems 
Sounds like we need a new unit that specifically means "bits/sec" but
is easier to say. How about "Shannons", as in "I just bought a 14.4
kiloshannon modem". :-)

@_date: 1993-02-08 09:48:44
@_author: Phil Karn 
@_subject: Modem Based Crypto Telephones 
It's true, dialup modems are becoming so fast that low bit rate vocoders
may well prove unnecessary for a secure phone with good voice quality. But
vocoders are still handy for allowing the use of a slower modem (e.g., over
impaired lines, such as those with a lot of taps :-)) and for freeing up
bandwidth that you might want to use for other purposes (e.g., data).

@_date: 1993-02-08 13:24:26
@_author: Phil Karn 
@_subject: Compressed/Encrypted Voice using Modems 
Sure he did. That's why the bandwidth term appears in his channel capacity
Shannon built on and generalized Nyquist's earlier work. Shannon's law
says only that it is theoretically *possible* to signal over a bandlimited
AGWN channel with specific bandwidth and S/N ratio with arbitrarily low
error as long as the signalling speed is less than the channel capacity
as given by his formula. What it doesn't show is *how* to do it. In
this respect, Shannon's law is much like the 2nd law of thermodynamics;
it tells you how efficient you can make a heat engine in theory, but it
doesn't tell a turbine designer how to shape his blades.
By the way, just to bring this back to crypto, everyone should be aware
that not only did Claude Shannon establish modern information theory,
he also wrote a seminal paper that established much of modern cryptography.
It was originally written during WWII and classified at that time, but
it was declassified soon after the war and appeared in the BSTJ in 1948,
I believe. Probably the most well known aspect of this paper is his
discussion of "product ciphers", whereby you can combine different
ciphers that are by themselves relatively weak (substitution and
permutation, which he calls "confusion" and "diffusion") and produce
a far more powerful cipher. DES is based on this principle, as are other
modern ciphers.
I bet this is one paper that the NSA wishes had never been declassified.
Far more important, in my opinion, than anything by Friedman.

@_date: 1993-02-10 21:14:12
@_author: Phil Karn 
@_subject: Compressed/Encrypted Voice using Modems 
As somebody else mentioned, you do want to turn off LAPM/V.42bis when
running a speech application, because speech is a real-time application
and LAPM retransmissions introduce delay. Compression is not likely
to add much but delay either, since the vocoder itself is already
compressing the speech much more effectively than V.42bis, which is
designed specifically for textual information.
Almost all modern modems support synchronous terminals, although the
feature is rarely used. This is how you get around wasting 2 bits out
of every 10 on start and stop bits.

@_date: 1993-02-11 23:09:26
@_author: Phil Karn 
@_subject: Compressed/Encrypted Voice using Modems 
But modern high speed modems already do quite a bit of FEC. I really
don't think more is really necessary. As long as the decryptor and voice
decoder automatically resynchronize after an error, there's no real
problem with letting a few through. It's certainly preferable to adding
long (or variable) delay.
The sychronization problem seems to occur in "real" (government) secure
phones too. They take a second or two to unmute following loss of clock
synchronization. But not every bit error causes loss of clock synch;
only a really bad line will do that.

@_date: 1993-02-21 15:02:12
@_author: Phil Karn 
@_subject: Trapdoors 
A bit count instruction would be very handy in a project I've been
working on lately, which is a new packet radio link level protocol
for amateur packet radio. This protocol uses forward error correction,
so it needs a highly reliable way to delimit the start of each
physical link frame. A pseudo-random "sync" sequence is the standard
way to do this, and you detect it with a correlator. The bit count
instruction would come in handy here, since the only other fast
way to do it is to use table lookup.

@_date: 1993-01-05 10:03:47
@_author: Phil Karn 
@_subject: purloined letter 
A couple of years ago somebody posted some clever programs to
sci.crypt that hid arbitrary (cipher)text in seemingly innocuous
"plaintext". You had two options: plaintext that looked like a running
commentary on a baseball game (with the ciphertext encoded in the
choices of names of players at bat, the sequence of balls and strikes,
etc) or plaintext that looked like the writings of a particular legal
scholar (I think). I don't remember his name, but he was chosen
because Senator Joseph Biden of Delaware plagairized his works during
law school, and Biden had recently introduced S.266 with the
now-infamous "resolution" against cryptography. A nice touch. :-)
Another approach to this problem is this: if you can't make the
needles inconspicuous by themselves, generate some big haystacks to
hide them in.  I.e., write a program that produces bogus PGP
"messages" and execute it frequently to produce background traffic. I
wrote a first-order bogus PGP message generator and posted it to
sci.crypt two weeks ago.  I say "first order" because it looks like a
PGP message to the naked eye, but is clearly invalid when fed to PGP -
I didn't bother generating correct checksums on the ciphertext.  The
ideal bogus message generator would produce a message
indistinguishable from a real PGP message encrypted with an unknown
public key, or perhaps with a known public key chosen at random. Anybody want to write this?

@_date: 1993-01-06 21:54:47
@_author: Phil Karn 
@_subject: Russian analysis of PGP 
Anybody familiar with the internals of PGP care to comment on this item
that just showed up on sci.crypt?
It's amazing to think that the famous "kremvax" joke was only a decade
ago. Now the Russians are openly reviewing our cryptosystems for us.
May you live in interesting times.

@_date: 1993-01-26 01:55:10
@_author: Phil Karn 
@_subject: 5th AMENDMENT & DECRYPTION 
Mike Godwin (formerly, I understand) of EFF and I had a lively
discussion on precisely this topic back at the Hackers' Conference.
Mike insists that there is no firm legal theory or case law on which
to base an assertion that the 5th amendment would shield you from
being compelled to divulge an encryption key that could then be used
to decrypt information to be used as evidence against you.
He says that the closest the Supreme Court came to this issue was an
offhand remark in a 5th amendment case to the effect that "of course,
we couldn't compel the defendant to, say, reveal the combination on a
lock".  I forget the precise legal term that Mike used to refer to
this comment, but he said it didn't establish a binding legal
precedent because it didn't relate directly to an issue in the case at
On the other hand, several other lawyers I've asked have responded "of
course!" when I ask them whether the 5th amendment would protect a
defendant from being compelled to divulge an encryption key without
immunity for the evidence it might decrypt.
My own opinion, given that I seem unable to get a complete consensus
from the lawyers, (has this *ever* been possible?)  is that the issue
is as yet untested in court and could go either way depending on the
actual case. But Mike seems much more pessimistic, and he *is* a
lawyer. I'm not.
Don't give up working on those steganographic schemes just yet. And
wherever practical (e.g., for communications as opposed to storage),
use a key management scheme that doesn't leave anything around that
can be seized or subpeonaed after the fact (e.g., Diffie's "perfect
forward secrecy" scheme.)

@_date: 1993-07-01 01:45:05
@_author: Phil Karn 
@_subject: LEB corruption in Clipper phones--the backdoor? 
Why are we pointing out these flaws publicly? You should let them
pass, so that the flawed Clipper chips get widely deployed. THEN you
go in front of Malarkey's subcommittee and demonstrate to the whole
world how to intercept any Clipper-encrypted conversation without the
escrowed keys. Then just stand back and watch the fun begin.
1/2 :-)

@_date: 1993-07-06 18:03:18
@_author: Phil Karn 
@_subject: "Let's kill all the lawyers..." 
Amen! Well spoken, Tim.
Last night I saw the Saferstein remarks you mention. I think they hit
the local California TV stations before being picked up by CNN. I
fully agree that PC is *really* getting out of hand if lawyers are now
to be considered one of the downtrodden minority groups.
Saferstein doesn't seem to understand the serious role satire plays in
actually *preventing* violence in our society. Lawyers and politicians
(lawyers being the larval stage of the latter) hold a tremendous
amount of power over the rest of us. Satire (including jokes,
political cartoons and the like) might not actually do much to lessen
that power, but it does give the rest of us a chance to vent some of
the resentment that might otherwise build into violence in more
And of course there is satire's unique selectivity. It's hard to
satirize somebody who doesn't deserve it. But a hypocritical lawyer or
a politician with a bloated ego... well, I don't think bullets ever
get any more magic than this.  *They* may still believe in their own
overriding self-importance, but thanks to satire, the rest of us don't
have to!
The real irony of trying to ban "lawyer bashing" is that some of the
best (most critical) lawyer jokes are told by the lawyers themselves!
So maybe we *should* pass a law against it. What better way to get
more lawyers off the street and where they belong? (Short of cloning
some more T. Rexes, of course...was there also applause in your
theater during that scene?)

@_date: 1993-07-22 16:21:32
@_author: Phil Karn 
@_subject: forged mail 
You should also bear in mind a fatal mistake that most people make when
they forge email. They test it first by sending themselves a forged note!
I'm told that when the guilty parties are confronted with the sendmail logs,
they usually confess quickly...

@_date: 1993-07-24 00:17:13
@_author: Phil Karn 
@_subject: Credit Reports and NS 
"national security" - the root password to the Constitution...sigh...

@_date: 1993-06-06 20:19:52
@_author: Phil Karn 
@_subject: Tempest@home? 
A good source of general info on RFI (radio frequency interference)
suppression can be found in amateur radio publications. THe same
techniques hams use to keep their computers from interfering with
their radios can be used to keep your computers from getting into
the NSA's receivers...

@_date: 1993-06-08 10:38:37
@_author: Phil Karn 
@_subject: CERT: the letter from CERT to berkeley.edu admin 
This seems to imply pretty strongly that the issue is not PGP, it's
the possible abuse of the cypherpunks upload area if it is world
Having CERT go specifically after the distribution of PGP would be pretty
amusing considering the several PGP keys I have on my keyring from CERT

@_date: 1993-06-09 10:38:04
@_author: Phil Karn 
@_subject: InfoWorld 
Well, to borrow Whit Diffie's great phrase, those of us who regularly
conspire to participate in the political process are already encrypting...

@_date: 1993-06-18 18:26:33
@_author: Phil Karn 
@_subject: Helping from Canada re Clipper 
Is this an actual Administration quote? If so, they're playing with fire
because France is the very same country that the US has recently
accused of using its national security apparatus to spy on foreign
corporations. It shouldn't be too hard to draw a link between these two
policies that would cause this particular quote to blow up in the
Administration's face.

@_date: 1993-06-18 18:26:34
@_author: Phil Karn 
@_subject: Software infrastructure 
I'm just catching up on a very large mail backlog (much of which is
Cypherpunks). Many Cypherpunks are apparently unaware of the security
work going on within the Internet Engineering Task Force (IETF). Besides
the infamous Privacy Enhanced Email (PEM), there are lesser known groups
working on application layer security interfaces and on IP-level
security (encryption and/or authentication of individual IP datagrams).
Okay, I'm not saying all this work is being done right. In some cases
it's not being done at all (or very slow progress is being made). In my
opinion, the situation is ripe for some highly motivated Cypherpunks to
read the stuff that's already been published (available from the
standard FTP repositories like nic.ddn.mil), digest and critique it, and
either implement the ideas that have been proposed or do them better
yourself. But you should really be aware of what other work is going on
in these areas before you reinvent the wheel.
My personal interests and preferences lie in doing security at the IP
layer. It doesn't solve all problems, but it is an approach that has
been almost totally unexplored until now. And with the ever-increasing
use and availability of low-cost dialup SLIP/PPP connections as an
alternative to dumb terminal emulators and UUCP, I think it's a powerful
technique. But I just don't have as much time to work on this as I'd
like, and it would really be nice to find others to help in the effort.

@_date: 1993-06-22 22:12:19
@_author: Phil Karn 
@_subject: Digital Cash$$$$ 
Recall that the US has money-laundering laws that require you to file a
form every time you move $10,000 or more in or out of the country. If the
First Digital Bank of Cyberspace is offshore, it could come under these
laws, at least with respect to priming your account with real money.
It's an interesting question whether they could then get you for sending
more than $10,000 of digital cash across the border without filing the
form. It's even more interesting if you encrypt all these cross-border
Another wonderful set of laws we can credit to the "war on drugs".

@_date: 1993-06-22 23:08:45
@_author: Phil Karn 
@_subject: 2600 testimony to Markey's subcommittee 
Having heard Markey in action (during John Gage's testimony, and again
during some hearings on HDTV), and having read his atrocious "scanner bill"
really drives home the old saying: a little knowledge is *dangerous*.
To which I would add "especially in the hands of a politician".

@_date: 1993-06-23 00:05:24
@_author: Phil Karn 
@_subject: YAA (yet another article) 
Amen. It was a real eye-opener to see the statistics on legal wiretaps
(the ones they tell us about, anyway). The vast majority, and I do mean
vast, are related to drugs. A distant second was gambling, and I think
"racketeering" was in there somewhere (not sure what makes that distinct
from "drugs" these days).
I must admit I'm disappointed to hear Hellman say something like this.
Every time somebody comes up with a "new" or "improved" key escrow scheme,
they give implicit approval to the whole basic idea of key escrow. Which
is fundamentally unacceptable in *any* form.
Although his idea may appeal to some naive people, I wonder how many have
actually seen any search warrant affidavits. I read the one for Steve
Jackson Games, and you certainly wouldn't know from that that they weren't
all guilty as sin. Too bad it was completely defective.
Do I sound like I don't place much faith in the warrant requirement acting
as a meaningful safeguard? You bet!

@_date: 1993-06-23 00:23:02
@_author: Phil Karn 
@_subject: YAA (yet another article) 
Not to dilute your argument or anything (you know I agree with it), but
the reading I've done on the history of the Fifth Amendment says that one
of the reasons torture was eventually banned in Western countries (through
mechanisms like the American Fifth Amendment) was the growing realization
that it actually was NOT particularly effective. People would falsely
confess to all sorts of crimes just to get the torture to stop. Consider
how many confessed witches were burned in New England.
One of the problematic things about encryption (as it's usually practiced
now) is that it's relatively easy to tell if an encryption key is the right
one or not. This makes it tempting to resort to torture (or a "contempt
of court citation", in modern terms) to extract it from an unwilling
defendant. That's why both steganography and "duress key" schemes will
remain important for some time, even if the 5th amendment were to be held
as applicable to compelling crypto keys. You could cry "torture", while the
police would claim that they discovered the key by other means (or that you
disclosed it "voluntarily") and it would be your word against theirs.

@_date: 1993-06-23 01:15:19
@_author: Phil Karn 
@_subject: Weak stenography. 
One thing keeps bugging me about steganography. Let's say that
"unlicensed cryptography", including the mere possession of ciphertext,
is totally outlawed. You may well be able to bury encrypted data in all
sorts of things (gif files, digital audio, "free" blocks on a hard disk,
etc). But if you ever want to be able to retrieve it, you have to leave
yourself an Achilles Heel: somewhere you need to keep a computer
program, in plaintext, that you can execute to extract and decrypt the
hidden ciphertext.
You may be able to get away with claiming that the low order bits of
your Doors tapes really *are* meaningless random bits picked up when you
dubbed all your worn-out LPs to DAT, but if they find "readdat.exe" on
your PC, disassemble it and discover that it's a program to extract and
decrypt ciphertext from DAT tapes, you're in trouble. And if you encrypt
your copy of "readdat.exe", well, you now need a plaintext decryption
program to decrypt THAT.
Short of devising a scheme that's so simple that you don't mind recoding
it from scratch (and from memory) every time you want to extract and
decrypt something, what can be done?

@_date: 1993-06-23 18:19:11
@_author: Phil Karn 
@_subject: Weak steganography 
Not necessarily. If you use pklite or lzexe, you produce an automatically
self-decompressing executable that will appear to have a much flatter
distribution than an ordinary exe file.
What we need is a crypto version of pklite - instead of (or in addition to)
compressing the executable, it encrypts it and sticks a stub decryptor
on the front of the executable. Each time you run it, it prompts you for
a password, decrypts and decompresses the executable and runs it.

@_date: 1993-06-23 18:19:15
@_author: Phil Karn 
@_subject: Contempt of court 
In the days of
Nitrocellulose. Very popular before the development of cellulose acetate,
mylar and other modern polymers. It was the standard material used for
movie film stock, which explains the bunker-like construction of the
projection rooms in many older movie houses. Newer theaters often display
signs in their projection rooms saying "Safety film only". (Now you know
the meaning of the phrase "KODAK Safety Film" along the edges of your
print negatives.)
Today the main civilian use of nitrocellulose that I know of (other than
in smokeless gunpowder) is to make ping-pong balls. Try igniting one
sometime (in a safe area!)
I've heard Gail Thackeray claim that hackers she'd raid would put big
electromagnets in doorways to erase magnetic media as it was being
seized. She never actually gave any proof of this, and it did always
seem just a little far-fetched given the relative ease with which a
hacker could just encrypt his/her incriminating data. I once asked her
what she'd do once the "bad guys" started encrypting, and she said
"I'm hoping you guys will tell us". (At the time I was one of the
so-called "good guys", working for Bellcore.)

@_date: 1993-06-23 18:39:57
@_author: Phil Karn 
@_subject: OTP dual decryption 
I have a better idea. You generate your D (dangerous) file and encrypt
it with IDEA or DES and a secret key K that you commit to memory. You then
destroy D. If (encrypt(D,K)) is seized and you are ordered to decrypt it,
then you produce a file F such that (F XOR encrypt(D,K)) produces whatever
bogus plaintext you desire and hand F over to the cops claiming that it's
your one-time pad.
Much simpler, and no chance of them discovering your plaintext, although
there's no guarantee that they won't suspect that you're still hiding
something (especially if they read cypherpunks).

@_date: 1993-06-23 18:39:58
@_author: Phil Karn 
@_subject: xor w/prbs 
Sigh. This is starting to look like the problem that skeptic groups
like the Committee for the Scientific Investigation of Claims of the
Paranormal have been facing for a long time. The basic problem is that
it's far easier to make a bogus claim than it is to carefully refute it.
In this case, it *ought* to suffice to simply point people who make
"unbreakable" but trivial ciphers at the existing volume of literature.
But they can get stubborn and insist that you actually break it, not
understanding that there's a big difference between a cipher that you
are confident that can be cracked and a cipher in which you can place your
confidence that it can't be cracked.
Plus ca la change, plus ca la meme chose.

@_date: 1993-06-24 15:33:15
@_author: Phil Karn 
@_subject: Karn's note... 
I tend to doubt that the spooks have voice recognition technology in
regular widespread use, at least not the kind of ultra sophisticated
stuff that AI types seem to dream about.  It's possible that they use
less sophisticated stuff as a "pre filter" (compress out silence,
perhaps distinguish male from female voices, etc), but I'm sure that
the bulk of the work is still very labor intensive. Tens of thousands
of clerks, intercept operators and natural language translators have
long been employed by the NSA and there don't seem to be mass layoffs
of these sorts of people around Fort Meade.
And sophisticated voice recognition really isn't necessary when you
consider all of the information that cell phones and base stations
emit that is almost trivially processed automatically by an intercept
device: electronic serial numbers, Mobile Identification Numbers
(telephone numbers), handoff messages, channel assignment messages,
etc. It's no big deal at all to build boxes that automatically
intercept all calls made to or from a specific phone, assuming you
have an RF path to the target (e.g., from a car tailing a suspect).
As a manufacturer of cellular telephones, we have such a box
(commercially made by IFR) in our lab. We use it to test our phones in
their FM/analog mode.  The spooks (NSA and otherwise) simply cannot be
uninterested in boxes like these -- and in preserving their
One point I keep making about Clipper: it makes this sort of automated
identity tracking as easy on regular telephone lines as it already is
on cellular, because the chip serial number in the Law Enforcement
Block can be decrypted with just the (common) Family Key - you don't
need the escrowed keys. And sometimes simple traffic analysis can be
almost as deadly as getting the actual contents of a conversation.

@_date: 1993-06-25 03:21:16
@_author: Phil Karn 
@_subject: Weak stenography. 
Tim May:
I like this idea, as long as the mere possession of such programs
isn't also criminalized. Don't laugh -- the government actually seems
to think that they can enforce laws banning the mere private
possession of certain types of bit patterns, like child pornography.
I have about two dozen CD-ROMs on my shelf, containing the usual
oodles of gigabytes of stuff. Mostly mirrors of anonymous FTP archives
and shareware BBSes. So far I have read only a tiny fraction of the
bits on those disks, and I expect I'll never read much more. There's
no reasonable way I could be expected to know if there isn't a
contraband file or two buried in all those gigabytes. But consider the
Akron BBS operator who got busted for a file that somebody had
uploaded to his machine, transferred off to backup and forgotten.  I
wonder how many similar files have already made it to CD-ROM?
Makes me kind of wish I had bought all my computer equipment and
software anonymously, for cash...

@_date: 1993-06-25 03:29:06
@_author: Phil Karn 
@_subject: DH for email (re: email protection and privacy) 
Phil Karn asks:
Mike Godwin replies:
I assume you're asking about civil versus criminal contempt.
Me again:
No, I was actually asking about the differences between subpoenas in
civil and criminal cases. Since the 5th amendment specifically
mentions criminal cases, I presume that means it can't shield you in a
civil case (unless perhaps the same information could also implicate
you in a crime.)

@_date: 1993-06-25 14:06:44
@_author: Phil Karn 
@_subject: triggerfish 
Sensitivity is not the issue. Two 1-watt walkie-talkies, one in (low)
orbit and one on the ground, can (and do) communicate with each other
as long as the earth isn't standing in the way. It's done on the ham
radio bands on just about every space shuttle mission (like the one
currently underway). Higher orbits require better antennas, but they're
no big deal.
The real problem with a space-based cellular telephone surveillance
system is interference - the best spot beam antenna you can make would
still take in *many* ground transmitters on the same channel in a
place like New York City. From orbit, you see everything, whether you
want to or not.
This is borne out again and again with tapes from the shuttle. Often
you hear nothing at all because there are so many ground stations all
transmitting at the same time that none of them are recoverable. Some hams
run ungodly amounts of power to get through, not because it's required for
the distance to be traveled, but to stand far enough above everybody else
that they can capture the shuttle's receiver. Both these systems and cellular
telephones use the same modulation method - FM.

@_date: 1993-03-18 18:35:46
@_author: Phil Karn 
@_subject: Cypher: Subject naming proposal 
Several years ago I wrote a UNIX utility that splits my incoming mail
(directly from the spool) into files based on the To: and Cc: fields.
I can specify the various mailing lists to which I subscribe in the
shell script, with all others going to a file named "other".
This way I can give higher priority to the mail that names me specifically
as a recipient, and put off the mailing lists for later. And I can use
any conventional mailer (like Mail) to read the split files.

@_date: 1993-03-24 18:57:35
@_author: Phil Karn 
@_subject: Many Important Items in the News 
I'm not sure I like this idea. In my own discussions with people on
this issue, I've found that "filterability" (for lack of a better
term) overcomes *many* (if not all) of the standard objections to
anonymous email.
I see email anonymity as directly analogous to Caller-ID in the
telephone network. Historically, telephony and email have taken
competely opposite tacks on the caller privacy issue: telephone calls
have always been anonymous while the Internet has effectively had
"Caller ID" with no blocking.  Caller ID changes the former
assumption, while the anonymous remailer changes the latter.
A consensus seems to be emerging on Caller ID: it's a good thing,
*provided* there's a way to block it. In other words, the calling and
called parties must agree on whether or not the caller will identify
himself. If they don't agree, the call won't go through.
Because the Caller ID messages explicitly state when the caller's
number is blocked (as opposed to simply being unavailable for other
reasons), it would be straightforward to build a call filter box that
would disable your ringer and return an error message to any caller
that invokes caller ID blocking. ("I'm sorry, the number you have
reached will not accept anonymous calls. If you wish to reach this
party, please unblock caller ID and try your call again.")
I think this approach strikes an eminently reasonable balance between
the privacy interests of the two parties. Personally, I would not use
such a box unless I was actually having problems with anonymous crank
calls. But a single woman living alone might well feel differently.
The important thing is to let each individual make that decision for
him/herself, not to impose one policy on the entire world.
I think this is also exactly the right solution for email. The policy
for the Internet should be that anonymous email is perfectly okay as
long as it is clearly labeled as such. Then anyone who doesn't want to
receive it can automatically remove it from their incoming mail
without ever having to set eyes on it.
This allows anonymous email to flourish wherever the recipients
consent to receiving it, while it could not be used (for very long,
anyway) to harass a nonconsenting recipient.
More elaborate filters could be constructed that would accept
anonymous email only when it had been signed by certain specific RSA
keys. This would let consenting parties communicate by means of
pseudonyms, without having to open themselves up to anonymous
harassment from the entire net.
What do you think?

@_date: 1993-03-25 13:51:17
@_author: Phil Karn 
@_subject: Many Important Items in the News 
I agree. It's time to take mail anonymity into the mainstream. There
are plenty of legitimate reasons for anonymity, as the Caller ID
debate shows.
I think an enlightened approach that eschews a single, network-wide
policy on the acceptability of anonymous messages in favor of leaving
it up to the individual email recipient is something that we could
sell to the Internet as a whole. We shouldn't have to treat this as a
confrontational either-or issue when there's a third way out that
balances everybody's interests.

@_date: 1993-03-25 21:02:14
@_author: Phil Karn 
@_subject: Many Important Items in the News 
Absolutely -- "Consenting adults" is the key phrase here. I think we
should stress it in everything we do as cypherpunks.
This profound concept once made it as far as an important Supreme
Court majority decision. But that was a long time ago. Look how far
downhill we've gone since then.

@_date: 1993-05-12 15:50:22
@_author: Phil Karn 
@_subject: CALLER ID? 
Interesting. As expected, when I called 1-800-235-1414 from a PBX
extension here at work, it read back the trunk number, not my actual
extension number.  The same for a developmental CDMA digital
cellphone, since we use PBX-style trunks from our switch.
But when I called it from a conventional AMPS (FM) cell phone using
Pac Tel Cellular, I also got a number that was different than my
mobile's real number. And when I called it back, I got a
number-not-valid intercept.
Interesting. Apparently one real cellular switch also looks like a PBX
as far as ANI goes.  I wonder how widespread this is. Anybody with a
cell phone on a service other than Pac Bell who is willing to give it
a try?

@_date: 1993-05-13 00:11:38
@_author: Phil Karn 
@_subject: CALLER ID? 
Well, gee. If I can avoid caller ID and 800 number ANI by simply using
any old cellular carrier for $0.40/minute (cheaper off peak), then why
should I pay $1.95/minute for the same service to 1-900-STOPPER?
Yeah, I know, that $1.95 probably includes the long distance portion too,
but I doubt there are any ordinary domestic calls that cost as much as

@_date: 1993-05-14 02:07:43
@_author: Phil Karn 
@_subject: Banning Laptops! 
You may be referring to the clip that appeared on CNN today that said
American Airlines had banned the use of laptop computers and CD players
*during takeoff and landing*. Use during cruise is OK.
I think this policy has been in effect for a while. I've been
flying American lately and have heard it mentioned.

@_date: 1993-05-18 00:11:16
@_author: Phil Karn 
@_subject: a valuable spy... 
The note from Watson could well be a decoy to draw the NSA off the track
of the *real* spy... :-)

@_date: 1993-05-24 10:49:41
@_author: Phil Karn 
@_subject: on privacy in digital communications 
Because the only credible suspect was killed two days later, and there is
no provision for posthumous trials in the US?
This reminds me of that great exchange in the movie "Sneakers" between
Dan Ackroyd and Sidney Poitier. From memory:
Ackroyd: "You know, the NSA shot Kennedy".
Poitier: "What? Now you're telling me that the NSA was responsible for
the JFK assassination??"
Ackroyd: "No, they only shot him. He's still alive..."
I think it would help enormously if we Cypherpunks stayed focused on
our core issue: the use of strong cryptography to protect personal
privacy against all potential intruders, private or government. It
will not help us to gain mainstream acceptance to blur our image with
fringe conspiracy theorists, gun nuts, survivalists and the like.

@_date: 1993-11-12 17:53:45
@_author: Phil Karn 
@_subject: Caller ID 
This is correct. Before Caller ID came along, about the only group
backward enough to still be using Bell 202 are the amateur packet
radio folks. So if you happen to be a ham with a packet TNC and a lot
of spare time, you could consider reprogramming one to decode caller
ID. Of course, you still have to sign up for the service before the CO
will send you the data.
And if your time is worth anything to you, it'd be better to just buy one
of the modems that already has caller-ID built in.

@_date: 1993-11-12 19:19:42
@_author: Phil Karn 
@_subject: LAW: Wireless interception 
Considering that analog cell phones and cordless phones use the very
same modulation method (FM), albeit at higher power for the cell
phones (making them much easier to intercept than cordless phones at a
distance), it would be much more accurate to say "...depends on
whether the specific technology involved has a large US industrial
base lobbying for it".
Cellular is protected under ECPA because it's big bucks for some
powerful US businesses. Cordless phones don't use a large domestic
infrastructure that charges for airtime. The only money in cordless
phones are in the phones themselves, which are invariably made
overseas.  And Japanese, Chinese and Korean businessmen can't vote in
US elections.

@_date: 1993-11-12 20:40:15
@_author: Phil Karn 
@_subject: TEMPEST, Van Eyck Radiation, and Eavesdropping 
I really DO wish this particular bit of misinformation would go away!
It is most definitely NOT illegal to shield one's computers against
TEMPEST surveillance. In fact, the FCC requires that manufacturers
limit the same spurious radiations that TEMPEST exploits to minimize
interference to nearby radio and TV receivers. The details appear in
Part 15 of the FCC rules.  They are more stringent ("Class B") for
devices intended for home use, since receivers are much more likely to
be nearby than for devices intended solely for office use ("Class A").
The Part 15 interference rules for computers came into being in the
mid 1980s, so anything you may read about the ease of intercepting
computer emissions that was written before that time is somewhat
suspect.  Thanks to the rules, modern computers are FAR quieter than
those sold in the 1970s and early 1980s, though they're still not
completely silent.

@_date: 1993-11-14 22:00:18
@_author: Phil Karn 
@_subject: LAW: Wireless interception 
Mike is correct that early models of cordless phones could often be
picked up on broadcast radios. Their base stations transmitted just
above the AM broadcast band (in the 1.7 Mhz region). Since then, all
new cordless phones operate on the 46 and 49 Mhz bands, which
generally require a scanner to receive.
However, cell phones still operate in what used to be UHF TV channels
70-83, and it is still possible in some cases to intercept cell phone
calls on a UHF TV set. So much for *that* theory. :-)
I still think my original explanation for the ECPA's distinction
between cordless and cellular phones is the dominant one.

@_date: 1993-11-17 22:14:28
@_author: Phil Karn 
@_subject: Secure phones - STU3 
As far as I can tell, basic compatibility among STU-IIIs calls for the
2400 bps LPC-10 coder as a minimum. So it's universal. It works, but it
sounds pretty bad, so there's been a lot of work on newer and better
vocoders. Correct me if I'm wrong, but I suspect the Motorola coder you
mention is probably one of several manufacturer-specific algorithms,
sort of like the manufacturer-specific high speed modes you find on some
fax machines.
FED-STD-1016 CELP (Codebook Excited Linear Prediction) at 4800 bps seems
to be the up-and-coming standard for newer phones, and it indeed does
provide *much* better voice quality than LPC-10. Unfortunately, it also
requires many more DSP cycles.

@_date: 1993-11-22 19:37:43
@_author: Phil Karn 
@_subject: Can NSA crack PGP? 
There is only one cipher that is provably secure: the one-time-pad.
All other ciphers are, at best, only "practically secure". That is,
they could, in theory, be cracked given enough time and computer
power, but in practice your enemy (even the NSA) *is* limited in his
There are several ways that NSA might crack PGP. Although I think it
relatively unlikely that they are true, there is nonetheless no way to
prove it. These include:
1. Attacking the RSA cryptosystem. This is a very well studied problem
in civilian cryptography, but it is always possible that NSA has found
a breakthrough in factoring that is still unknown to the civilian
2. Attacking the IDEA conventional cipher. IDEA is based on a
relatively new (and different) design technique than DES.  It has not
had nearly the attention of the civilian cryptographic community that
has been spent on RSA and DES.
3. Attacking the random number generators. This is often the weakest
part of many conventional cryptosystems, but the techniques now used
in PGP are thought to be pretty good. Lest people think that timing
keystrokes is a poor way to generate random numbers, I should say that
I once watched somebody key a STU-III (NSA-designed secure phone). At
one point the phone prompted him to hit the "*" key 20 times. It
didn't say why, of course, but it was pretty obvious to me.  And if
it's good enough for NSA...
4. Attacking the PGP implementation itself. A "black bag job" that
modifies the victim's PGP executable to store or transmit pass
phrases, or gives the spooks a chance to search the disk's free list
for old temporary files, is almost certainly the easiest way to attack
PGP.  Don't forget that all computer security ultimately rests, at
some level, on physical security.

@_date: 1993-11-22 21:27:44
@_author: Phil Karn 
@_subject: digital voice board at Comdex 
Last week at Comdex, I happened across Digicom Systems' booth. They're
selling a PC board with a programmable DSP chip from Analog Devices
that can be programmed to act as a sound card or as any of several
dial modems up to V.32bis. AND... it can be programmed with the GSM
vocoder algorithm (approx 13 kb/s).
The price was reasonable, too...in the $100 range, as I recall.
This could be the enabling product for a homebrew secure telephone.
The board can't act as a vocoder and modem simultaneously, so you'll
need either two boards, or one board plus a conventional modem. But a
vocoder that operates within dialup modem rates has been the roadblock
so far in a secure telephone. Anyone interested?
The address on Digicom Systems' flyer is 188 Topaz St, Milpitas CA
95035.  Voice: 800-833-8900. Fax 408-262-1390.
Naturally, I have no connection with this company other than as a
prospective customer.

@_date: 1993-11-22 23:27:45
@_author: Phil Karn 
@_subject: Secure Drive Copyleft / Export Problem 
So excise the IDEA code, and refer the reader to the December 1993
issue of Dr. Dobbs Journal, which includes a complete listing and
algorithm description of IDEA.

@_date: 1993-11-23 01:02:44
@_author: Phil Karn 
@_subject: Can NSA crack PGP? 
I fully agree.
I think this is less of a problem. Given a good cryptograpic hash
function, I would simply hash *all* of the clock bits, without regard
to which are the "hottest" ones. If (important 'if') there is
sufficient total entropy in the input bits, hashing should effectively
"distill" the input entropy into the output bits.

@_date: 1993-11-24 13:19:30
@_author: Phil Karn 
@_subject: Give me your password- OR ELSE! 
How do you know this? Clearly some crooks may have just moved to more
violent methods, but it's quite probable that others moved off to
other fields where it's easier to make a buck, either legal or
Although widely deployed strong cryptography may well cause an
increase in violent, rubber-hose cryptanalysis, this technique is
likely to be useful only for stored encrypted records and for
encrypted communications whose protocols are not secure against this
type of attack, e.g., PGP encrypted email.
But much better protocols exist where online two-way communication is
possible, e.g., signed Diffie-Hellman key exchange, with periodic
automatic rekeying. Once you rekey in such a system, no amount of
rubber hosing will obtain prior session keys; they're gone even to the
And even if you rubber-hose one of the participants into revealing the
RSA key he uses to sign his DH exchanges, this will only let you
masquerade as him in future conversations. In order to tap his future
conversations surreptitiously, you'd have to rubberhose him without
his knowledge, or hypnotize him into forgetting the incident. I'd say
this is difficult. More so than secretly hacking the machine he uses
to capture his secrets. Once again, it comes down to some level of
physical security, at least while the machine is in actual use.

@_date: 1993-10-04 11:44:43
@_author: Phil Karn 
@_subject: WestWord article - YOW! 
I noticed this apparent typo in the original article. I assume it is
indeed a typo (there were several others in the article as well).

@_date: 1993-10-04 14:19:44
@_author: Phil Karn 
@_subject: 2-part LA Times story 
I'm surprised no one has yet mentioned the *large* 2-part story that
appeared starting yesterday (Sunday October 3) in the LA Times. It
appeared in the top of column 1 on page 1 with the title "Demanding
the Ability to Snoop".  It deals primarily with Clipper, with sidebars
on the FBI Digital Telephony stuff.
Monday's article also appears in column 1 of page 1, but at the
bottom. It is titled "Computer Code's Security Worries Privacy
Watchdogs" and it begins with a quote from Mykotronix's president
commenting on how he felt about the Internet message carrying stuff
found in his garbage. The article is primarily about Mykotronix's
involvement with Clipper.
Inside is a sidebar on Dorothy Denning, complete with photograph
suitable for a dartboard.
It is *really* becoming a challenge to keep up with all the media
coverage lately!

@_date: 1993-10-15 20:40:13
@_author: Phil Karn 
@_subject: IRS LEARNING . . . 
Well, yes, I suppose you could then leave the country, find an Amex
office and file a claim for the missing $80,000 of travelers checks,
but wouldn't this generate precisely the kind of paper trail you're
trying to avoid?
Anyway, back to cryptography, I do suspect that the government will
eventually point to digital cash as justification for controlling all
of cryptography. Or they will refuse to back it up in court as legal
tender, thus helping undermine it. I know there's this concept called
"reputation" that's supposed to take the place of the government
enforcing contracts, but I have a hard time understanding just how it
will work for very large transactions between individuals (like buying
a house or even a used car).

@_date: 1993-10-20 23:17:52
@_author: Phil Karn 
@_subject: Clipper Chip report on 700 Club today (Wednesday) 
Thanks to the heads-up note here, I caught the whole thing on tape
when it repeated here on the West Coast at 10pm PDT. (I see there are
some advantages to living out here!)
If I hadn't seen the show with my own eyes, I never would have
believed it. The Religious Right, so ready to mind everyone else's
personal business and to reshape the government in its own image,
opposes something that would make it easier for the government to
control the private lives of its citizens. This cryptography stuff
sure makes some strange bedfellows. Wow.
Of course, the Religious Right is at odds with the current government,
what with talk of using the federal racketeering laws against
anti-abortion demonstrators.  So perhaps they can be forgiven for
their current anti-government stance.  Their tune might well change if
they ever succeed in overturning Roe V Wade. Imagine their glee
turning to horror when they discover that those satanic pro-choice
people are using encryption to coordinate *their* protests and perhaps
even to coordinate travel by women seeking abortions to places where
it is still legal. :-)
And there's supreme irony in the right to encryption and the right to
abortion both being founded in the same basic concept: personal
privacy.  It all depends on whose ox is being gored, I guess.

@_date: 1993-10-21 01:07:54
@_author: Phil Karn 
@_subject: TEMPEST: Re: Monitor radiation overlooking./DES weakness 
beam in the CRT that radiates, it's the electronics all around it.
I verified this years ago with an early Korean clone of the original
IBM PC monochome monitor. It was easy to demonstrate: when I turned
down the brightness control until the screen went completely dark, the
radio interference audible on a HF amateur rig was unchanged. When I
instead turned down the *contrast* control until the screen went dark,
however, the noise just about disappeared.
Why? In this particular monitor, the brightness control simply
controlled the DC bias on a CRT grid. It stopped the electron beam,
but did not change the RF noise level. That proved conclusively that
the noise wasn't coming from the electron beam.
Why not, given that the CRT contains the highest video signal levels
found in a monitor? Well, if you look at the back of a typical CRT,
you will notice that the sides are all coated, inside and out, by
conductive paints. These two painted surfaces -- ground on the
outside, B+ on the inside -- with the glass between them, form a
capacitor that filters the high voltage applied to the tube. (It is
vitally important to discharge this capacitor before you poke around
inside a monitor or TV!)  The inside of the screen must also be
conductive, since the electrons hitting it have to go somewhere. So in
effect, a CRT already comes with its own RF shielding.
On the other hand, the contrast knob was essentially a "video volume
control" just ahead of the (relatively high powered) video output
amplifier mounted on a daughter board plugged into the base of the
CRT, driving its cathode. The radiation came from the unshielded +70V
power supply lead into this daughter board.  Replacing that one wire
with shielded coax and bypassing both ends with capacitors reduced the
noise dramatically.
I got rid of what little noise was left by adding extra shielding to the
monitor's drive cable. I had already tediously painted the inside of
the cabinet with conductive paint, but that turned out to be largely
a waste of time; the noise level didn't seem to depend much on whether
the cabinet was on or off.
The bottom line: brute force shielding of an entire monitor is often
not required. It pays to figure out exactly where the radiation is
coming from, and work directly on the cause.
Caveat: this particular monitor, being very old, had no RFI mitigation
at all. Almost all newer monitors have much better RFI shielding. Open
them up and it will be obvious -- metal shields everywhere, ferrite
beads around cables, etc. Simply upgrading to a newer monitor may fix
the problem.

@_date: 1993-10-31 20:59:42
@_author: Phil Karn 
@_subject: Secure Phone Progress (fwd) 
There are a few minor misstatements in this note. Standard telephony
samples 8000 times per second, with 8 bits per sample. You can
easily sample fast enough to get all important speech frequencies into
14400 bps -- at the expense of reducing the resolution of each sample.
The resulting speech would be understandable, but highly distorted.
There are many other speech coding methods that work somewhat better,
including various forms of delta modulation (sending just the differences
between adjacent samples). These are probably the best in the bang-for-buck
department (Motorola's CVSD is already widely used in secure voice radios
operating at 16 kb/s or so). But if you really want high quality at low data rates, you pretty much have
to use a vocoder. All of the methods mentioned above try to reproduce the
(important parts of) the speech waveform.  Vocoders work by modeling
the human vocal tract and sending the parameters that describe it at any
particular moment, instead of attempting to encode the actual waveform.
Since these parameters correspond to things that move relatively slowly
in the modeled system (e.g., the muscles of the tongue, jaw, lips, etc)
they consume much less bandwidth than the actual sound that's produced.
What makes CELP so computationally expensive is the "C" part. CELP
stands for Codebook Excited Linear Prediction. The modeling scheme I
just mentioned is the Linear Prediction part; the Codebook Excitation
part is used to drive it. It corresponds to the vocal cords in the vocal tract.
As I understand it, the analyzer picks an entry in a predefined "codebook"
that produces the best results, i.e., synthesized speech that most closely
matches the original sound. This is a fairly brute-force process; we're talking
tens of DSP MIPS to do this in real time.  I don't  know anyone who has
done it in assembler on a widely available general purpose CPU, but I
would be ecstatic to be proven wrong.

@_date: 1993-09-03 08:20:31
@_author: Phil Karn 
@_subject: Gubment Bombmaker's Cookbook 
This is ridiculous. Have they never heard of The Anarchist's Cookbook?
I've seen it on the shelf of the local large bookstore, though now I'm
not sure whether I want to admit to buying a copy.
Have they not yet discovered rec.pyrotechnics?

@_date: 1993-09-07 23:42:47
@_author: Phil Karn 
@_subject: Super Phones? 
"Spread spectrum" does *not* imply "encrypted". The spreading
sequences are quite often just simple linear feedback shift registers,
which anyone with basic knowledge of cryptanalysis knows how to crack.
Anyone with knowledge of the signal format and the right hardware
could easily intercept such a signal. This *definitely* includes the
The fact that spread spectrum usually thwarts the average scanner
enthusiast is actually rather unfortunate in my opinion, because that
lessens the demand for truely secure cryptography.

@_date: 1993-09-10 21:17:58
@_author: Phil Karn 
@_subject: Digital warfare 
I want to echo Carl's sentiments. I do find talk about cryptographically
enforced underground economies to be interesting, but scary as well
precisely because I'm afraid of what the backlash might do to the
cryptographically enforced personal privacy that I'm primarily
interested in.

@_date: 1993-09-14 08:39:59
@_author: Phil Karn 
@_subject: Denning@ISSS Expo '93 
I've seen Denning's name on other security conferences, most recently several
weeks ago in DC. As usual, one can always make money by toading for the

@_date: 1993-09-17 01:00:55
@_author: Phil Karn 
@_subject: (fwd) Subpoena served on Crypto 
Get on the phone to EFF ASAP.
Here's the bibliography I promised earlier. If someone would put this up
on soda and perhaps even add to the list, I'd really appreciate it. --Phil
As a few people have requested, here's my current bibliography of DES
source code listings found in various widely published books or
magazines. Note that I have explicitly excluded the dozens of books
and publications that merely *describe* the DES algorithm -- even
descriptions complete enough to use as a basis for implementation.
They don't count because, as we all know, only Americans are smart
enough to turn an algorithm description into C code (or so our
government believes.)
Additions or corrections to this list are welcome. Again, I'm only
interested in actual code listings.  --Phil
"The Standard Data Encryption Algorithm", Harry Katzan Jr, Petrocelli
Books, 1977 ISBN 0-89433-016-0 (APL).
"Computer Networks", Andrew S. Tanenbaum, Prentice Hall (both
editions; second edition is ISBN 0-13-162959-X). (Pascal)
"Numerical Recipes", William H. Press et al, Cambridge University
Press.  (Fortran and Pascal version is ISBN 0-521-30811-9.  Also in
"Numerical Recipes in C").
"UNIX System Security", Wood and Kachan, Hayden. ISBN 0-8104-6267-2.
Byte Magazine, April 1977 (6502 Assembler).
"Cryptography: An Introduction to Computer Security", Seberry and Pieprzyk,
Prentice Hall Australia. (C)
"Mathematical Cryptology for Computer Scientists and Mathematicians",
Wayne Patterson, Rowman and Littlefield, 1987. ISBN 0-8476-7438-X.
Introduction to the Analysis of the Data Encryption Standard (DES),
by Wayne G. Barker, ISBN 0-89412-169-3 (soft cover), 0-89412-170-7 (library
bound), 1991, Aegean Park Press, Appendix G. (Basic, of all things).

@_date: 1993-09-23 01:03:46
@_author: Phil Karn 
@_subject: more than spread spectrum 
This idea of setting up your own independent network isn't as far fetched
as it sounds, at least in a relatively local area with critical mass.
The router nodes already exist, in the form of my own TCP/IP code for
the PC, or any of several other packages including the various freeware
UNIX clones.
Radio transmission equipment operating under Part 15 of the FCC rules
is already available. Under Part 15, you don't need a license; the
radio transmitter does have to be "type accepted" by the FCC but since
you buy that as a prepackaged box you don't have to worry about it.
The section of Part 15 that is particularly interesting is either
15.247 or 15.249 (can't remember which).  It allows you to run up to 1
watt of power, quite a bit for an unlicensed service, on any of
several "ISM" (aka "garbage") bands as long as you use spread spectrum
with a minimum processing gain of 10dB. The most popular is 902-928
Mhz, with another band in the vicinity of 2450 Ghz coming up fast.
Ahthough most Part 15 equipment is designed primarily for use within
office environments, it can be and is used over point-to-point paths
of 5-10 km with the proper directional antennas.
Although Part 15 users are not allowed to cause harmful interference
and must accept interference from other users (microwave ovens
generally operate on 2450 Mhz), in practice these nets seem to work
pretty well if they're properly engineered. Besides, the inherent
distributed redundancy available in a packet network should be able to
compensate for momentary outages due to interference.
Unlike the amateur service, which has some particularly draconian
"acceptable use" policies (despite a recent liberalization, encryption
is still illegal), there are *no* restrictions on the use of Part 15
equipment. Encryption is not only legal, some boards have hardware
encryption support (e.g., the NCR Wavelan has a DES chip). This
particular board operates at 2 megabits/sec on the 902-928 Mhz band
with 250 mW of power.
There is an even more interesting development in the works: "data
PCS".  In essence, this is "Part 15" style operation on dedicated
spectrum, i.e., new spectrum in the 1.8-2.2 Ghz band that will not
have to be shared.  The specific intent of data PCS is to allow users
to build their own ad-hoc networks without having to rely on the facilities
of (and pay money to) carriers such as telephone companies.

@_date: 1993-09-23 06:38:13
@_author: Phil Karn 
@_subject: First amendment and ITARs 
Many thanks for posting those opinions. It doesn't look good at first glance.
On the other hand, there are some differences with the present case. Here
there is no question that the technical data on which PGP was based is already
extremely widespread around the world, so there is a question about whether
the form (algorithm description vs source code) makes a difference. And
there's a question about whether it's enough to simply make something available
for FTP within the US to get in trouble, and if so, how one reconciles this
with the First Amendment.

@_date: 1993-09-28 23:31:39
@_author: Phil Karn 
@_subject: Clipper specifics 
As I recall from a note from Denning some months back, the bits of the
LEEF (Law Enforcement Exploitation Field, its original and far more
descriptive name) are spread out among the ciphertext in some
unspecified way precisely to make it difficult or impossible to
Damn. Now I remember one of the points I meant to make in my NIST
comments, but forgot: if the LEEF is added periodically to the
ciphertext stream, that implies that the ciphertext data rate must be
greater than the plaintext rate. And that precludes just dropping the
Clipper chip into existing synchronous communication systems such as
our CDMA digital cellular telephone system without *major* system
redesign. Everything in our system is designed around four specific
fixed frame "rates", specifically 16, 40, 80 or 171 bits every 20 ms:
the vocoder, which generates these "frames", the CDMA modem, the
Viterbi decoder, everything.
Encryption that simply performs a 1-to-1 mapping between plaintext and
ciphertext would be easy to add to this system. But an encryption chip
that has to add something to each frame to encode an LEEF is useless
to me.
Anybody know if there is a "reply comments" cutoff date for the
Clipper proposal?  Under the rules that usually govern this sort of
thing, if you can find someone else's comments on file that address
the point you make, you can usually file "reply comments" that address
this point beyond the original due date -- as long as it arrives by
the "reply comments" date (usually a month or two later).

@_date: 1993-09-28 23:36:22
@_author: Phil Karn 
@_subject: Orange book, the NSA, and the NCSC 
Better yet, send them large PGP-encrypted messages using maximum-length
public keys that are not registered with the key servers. That should
keep their Crays busy for a while. :-)

@_date: 1994-04-06 13:28:56
@_author: Phil Karn 
@_subject: Reporting the RSA129 story 
When you write your story, *please* help correct what already seems to
be a widespread misconception by emphasizing that solving RSA129 does
*not* mean that the RSA public key cryptosystem has been "broken". It
only means that one *particular* and relatively short RSA key, chosen
long ago for test purposes, has been broken by brute computational
An equally intensive effort would have to be mounted from scratch to
break any other RSA key of the same length; this is why it's good
practice to change "real" keys from time to time.
And, of course, the longer the RSA key, the more work it is to
crack. Barring major breakthroughs in the underlying algorithms for
attacking RSA, which have not occurred, a sufficiently long key (e.g.,
1024 bits) will be secure for quite some time even with present trends
in brute-force computer power.
The real importance of the RSA129 effort is that it provides a new
experimental "data point" on the security of a particular key length.
This is a good example of the seemingly paradoxical principle that
publishing the design of a cryptographic system and inviting attacks
by all comers can actually help to strengthen it in actual use.
This is in sharp contrast to, say, Clipper/Skipjack, where the NSA
classifies the algorithm and says "trust us, it's secure". The NSA may
believe that it's secure. It may even *be* secure (except, of course
for the gaping front door of key escrow). But without a sustained,
long-term public review there's no way to know if they missed

@_date: 1994-04-10 20:37:23
@_author: Phil Karn 
@_subject: Prime Numbers 
You seem to have rediscovered Fermat's Little Theorem, or something
very much like it. See page 203 of Schneier, which says:
This seems to be the basis of most of the primality testing algorithms
I've been studying lately. For example, the FermatTest() function in
RSAREF computes 2^a mod a and compares the result to 2. This is done
only if the candidate prime has already been verified not to be a multiple
of 3, 5, 7 or 11.
PGP works a little harder. After verifying that the candidate prime is
not divisible by primes up into the 4-digit range (using a lookup
table the size of which is a compile-time option), it computes
Fermat's formula up to four times using the values 2, 3, 5 and 7 for
The PGP source contains a comment that the Fermat test is much more than
50% effective at detecting composites, but gives no actual figures.
Can anyone comment on this?
I'm currently interested in prime generation because I'm working on a
Diffie-Hellman based IP security protocol (using RSAREF). As long as
the DH modulus is well chosen it can be relatively static and shared
by many people. Therefore I don't mind spending quite a bit of CPU
time on this if necessary to do a good job.
As I understand Brian LaMacchia's 1991 results on the discrete log
problem (see  the prime
modulus p used with Diffie-Hellman should be well above 512 bits long
(I'm currently planning 1024) and (p-1)/2 should also be
prime. Anybody know of any more recent results?

@_date: 1994-04-11 16:47:24
@_author: Phil Karn 
@_subject: number theory 
What estimates exist for the density of large Carmichael numbers, say
1000 bits long? I.e., what's the probability of running into one by
accident when generating primes by the usual technique of picking a
random starting point and searching up until you find a number that
passes seive or small factor tests and a few iterations of Fermat's
test? Are other probability tests like Miller-Rabin any more provably
likely to detect these?
I'm currently playing with the Miller-Rabin test. Boy, is modular
exponentiation a pig (at least the routine in RSAREF).

@_date: 1994-04-21 15:03:28
@_author: Phil Karn 
@_subject: Banyan Vines / USMC 
I've seen the Hadron. It's an impressive, fancy, TEMPESTed, MIL-SPEC
box. When I opened it up, I found an ordinary, production, amateur
packet radio TNC (terminal node controller) speaking AX.25.
Kind of scary when you think about it. :-)
What would normally cost a ham about $150-$200 probably cost the
government about $5K each.

@_date: 1994-04-21 16:07:24
@_author: Phil Karn 
@_subject: cryptophone ideas 
This is where a DSP really shines, since it's the fundamental
operation in digital filtering; indeed it wouldn't be a DSP if it
couldn't do a multiply/accumulate in a single clock cycle.
But I wouldn't be too surprised if general purpose CPUs eventually get
the same capability. And once they are, the distinction between a
"DSP" and a "general purpose" CPU will pretty much vanish. DSPs are
notoriously harder to program than general purpose CPUs, and being
lower volume items they won't be able to compete in price or clock
speed with general purpose CPUs made in the millions.
But that's in the future. There's not much alternative to using a DSP
chip right now if you want high quality low bit rate speech, but
unfortunately the low-cost DSPs now appearing on PC sound cards are
not quite up to the task yet. I think CELP encoding requires something
like 30 million multiplies per second, which is beyond the reach of a
12.5 Mhz AD2105. On the other hand, simpler schemes and/or clever
coding tricks might make it possible. And since these boards are now
widely available in computer stores, they're hard to ignore in a
project like this. Has anybody looked at them in detail?

@_date: 1994-04-25 22:24:35
@_author: Phil Karn 
@_subject: cryptophone ideas 
Actually, there'd be little reason to modify the code in the DSP, at
least the one in our CDMA phones. We use a DSP-16A to execute our
variable-rate variant of the CELP vocoder, but we also have a 80C186
general purpose CPU that does all of the other housekeeping functions
in the phone. This is where you'd probably want to add crypto code.
As an aside, a lot of people seem to think that DSP chips are
miniature Crays that can run any given program faster than any
"ordinary" computer. They're not. DSPs are special purpose CPUs
heavily optimized for the multiply-accumulate operation that is
fundamental to digital filtering.  They have no special gift for
general purpose computing.
This includes encryption.  Encryption is better done on a general
purpose CPU when you consider the much larger economies of scale for
general purpose CPUs as compared with DSPs, not to mention ease of
programming, higher clock speeds, wider availability, etc.

@_date: 1994-04-25 22:30:07
@_author: Phil Karn 
@_subject: cryptophone ideas 
Also, it is not sufficient to incorporate encryption merely into the
cellular phone itself. You need the cooperation of the base station,
at least if you want to interoperate with an ordinary telephone on the
land side of your connection.
Now it would be possible to provide your own encryption on an
end-to-end basis using a data (as opposed to voice) bearer service
from the carrier, but this would require the person you call to have
compatible equipment (vocoder, modem, encryption routines, keys, etc).

@_date: 1994-04-25 22:47:44
@_author: Phil Karn 
@_subject: cryptophone ideas 
Since I work in this digital cellular business, I think I can
confidently say that Perry *does* know what he is talking about. He's
right -- it's not enough to simply reprogram your phone, you must take
care of the other end too: the base station.
NSA has already let it be known that any cellular system that can
provide end-to-end encryption will not be exportable. It is not
exactly clear what this means, given that once you provide a
transparent *data* (as opposed to vocoded voice) bearer service, the
users can do whatever they want on an end-to-end basis without the
carrier's further cooperation or permission. I guess they figure this
won't be a common practice.
And they have indicated their willingness to allow export of *phones*
with strong encryption -- but not the base stations. This underscores
the uselessness of implementing strong encryption only on the mobile.

@_date: 1994-04-26 01:39:28
@_author: Phil Karn 
@_subject: CU Crypto Session Sat 
Some time ago I worked out the theoretical limits on spy satellite
resolution.  It's a simple exercise in optics, if you make optimistic
assumptions like no atmospheric distortion, etc. My only major
engineering assumption was that the objective mirror had to fit inside
the payload fairing of a Titan launcher, i.e., about 2 meters max. The
result, at visible wavelengths and for the slant ranges typical of spy
satellite orbits, was about 1 foot. This was completely consistent
with the leaked KH-11 photos of the Soviet aircraft carrier published
some time back in AW&ST and Deep Black.  Good, but not exactly good
enough to read poker hands, I would say.
Believe it or not, the laws of physics apply even to classified projects.

@_date: 1994-04-26 16:21:19
@_author: Phil Karn 
@_subject: Schneier's source code 
Oh come on, all this talk about OCR makes it sound like nobody would ever
be willing to just type in the code by hand. It only need be done once,
and the task could easily be divided up for a group. The listings for any
particular cipher just aren't that long.

@_date: 1994-04-26 22:43:14
@_author: Phil Karn 
@_subject: CU Crypto Session Sat 
July 1986. Most of the issue was devoted to articles on "national
technical means" for verifying arms control agreements. This has
always been jargon for spy satellites and other not-so-public

@_date: 1994-04-27 11:06:14
@_author: Phil Karn 
@_subject: Schneier's source code 
There is also the interesting realization that even if the Schneier
source code were to be mailed or FTP'ed outside the country, without
actual evidence of those acts there would be nothing to disprove an
assertion that it was typed in from the legally exportable book.
But, as they say, "that would be wrong".
I'm *still* waiting for a response to my CJ request for this disk. They
either ignore my calls or put me off with "it's coming soon", but it's
now almost May and I still don't have an official ruling on my "15-day"
request, which was filed in early March.

@_date: 1994-04-27 11:54:51
@_author: Phil Karn 
@_subject: Liberating Schneier's Code? 
...which would be more up to date, too. When I created a copy of the
disk to send to NSA along with my second CJ request, I found I had to
go back several versions of PGP to get the version of IDEA that had
been printed in the book. That's the problem with books -- they're
hard to update.

@_date: 1994-04-27 11:55:03
@_author: Phil Karn 
@_subject: CU Crypto Session Sat 
Remember that when they're joined, they must maintain an accuracy of a
small fraction of a wavelength to not spoil the results.
I'm not saying this is impossible, only very, very difficult. Even for
(especially for?) a well-funded black project.

@_date: 1994-04-27 14:50:02
@_author: Phil Karn 
@_subject: CU Crypto Session Sat 
Okay, "joined" in the sense that the light collected by each mirror must
be added coherently to produce the final image. This coherent addition
requires precise control of the phase of each component to a small fraction
of a wavelength. This is hard.
Someday there may be phased array antennas operating at optical wavelengths.
Not yet.

@_date: 1994-04-27 18:11:38
@_author: Phil Karn 
@_subject: Schneier's source code 
As you can tell from John Gilmore's files
(ftp://ftp.cygnus.com/pub/export) I filed my original request, for the
book itself, by fax on Feb 12.  The letter in response was dated March
2, but I didn't receive it in the mail until March 8. That puts it
within their 15 business day limit if you don't count the mail delay.
My second request (for the floppy containing exactly what was in the
book) was filed by fax on March 8. I had to revise the title, so the
actual filing date is more like March 10 (that's the date you get if
you call up their automatic license status system and punch in the
case number). That makes it 7 weeks, well over their 3-week (15
business day) limit.
Odd that it should take so long to clear information that has previously
been cleared on another medium, eh?
Yes, I think they're clearly stalling since either way they rule
they're putting themselves in a tough spot. That was exactly my
intention.  As to what to do next, I don't know. I don't think the
15-day rule is binding in the sense that 10 days is binding under the
FOIA (not that that makes any difference, of course). They say that CJ
requests normally take upwards of two months, and could claim that the
15-day rule is something they advertise without actually promising to
meet it. Just like 2-day priority mail.
It has occurred to me that it wouldn't hurt for others to file CJ
requests for other cases of published cryptographic source code, to
help build up a foundation of these things. There are plenty of
examples to choose from. For a list, see
 Filing CJ
requests is actually quite easy; see John's "CJR kit" (in the
aforementioned FTP directory on ftp.cygnus.com) for all the details.
If you do file a CJ request, be sure to send a copy to John so he
can include it in the files.

@_date: 1994-04-27 19:34:53
@_author: Phil Karn 
@_subject: your mail 
I have met a few NSA employees and contractors from time to time, and
they've all generally impressed me as intelligent and reasonable
people who just happen to work for a bad institution -- except Baker.
He *is* that bad institution.
I had the dubious pleasure of meeting Baker in person a year ago
during a CPSR-sponsored conference in DC. I had argued vigorously with
him during a break before I realized that he was NSA's general
counsel; afterwards, I realized that if I didn't have a file with them
before, I certainly would later. :-)
I argued that the bad guys would have strong cryptography no matter
what laws were passed, so we might as well make sure the good guys
could have it too. His retort, repeated quite a few times, was, "So,
your attitude toward the government is "Fuck 'em if they can't take a
joke?" It wasn't exactly a reasoned, logical debate.
One of the most arrogant people I've ever met. He would have been
right at home in the old Nixon White House.
But then again, I keep remembering the rule: don't get mad, get even.
Write code...

@_date: 1994-04-28 22:19:37
@_author: Phil Karn 
@_subject: WSJ editorial email or fax address? 
Anybody know if the WSJ accepts letters to the editor by fax or email?
I've drafted the following letter to the editor, but I couldn't find
anything but a snail mail address in today's paper.
I *did* send a copy to Mr. Bulkeley's MCI mail address, so please do
NOT forward it to him again...Phil
Wall Street Journal
Re: "Cipher Probe: Popularity Overseas of Encryption Code
    Has the US Worried", WSJ 4/28/94, Page 1.
The Zimmermann case is as much about the First Amendment as it is about
privacy and irrational US export controls on encryption.
Recently I obtained a formal ruling from the US State Department that a
new textbook, "Applied Cryptography" by Bruce Schneier, could be freely
exported anywhere in the world -- even though it prints actual source
code from Pretty Good Privacy (PGP).
The State Department applied a "public domain" exemption to my request.
Indeed, the First Amendment demands such an exemption. Dozens of other
books and journals on cryptography, many with similar source code
listings, enjoy the same protection.
However, the State Department has so far refused to approve my request
to export a floppy disk containing the same exact source code that
appears in Schneier's book. And they still insist that "publishing"
cryptographic software on the Internet is illegal.
Why the distinction? Do they seriously believe that only Americans can
program a computer, much less type? No, not even the government is THAT
stupid. They're using fear and intimidation in a desperate attempt to
delay the inevitable, no matter what the consequences.

@_date: 1994-04-29 21:03:31
@_author: Phil Karn 
@_subject: Random #'s via serial port dongle? 
The easiest way to get true random numbers on a PC nowadays is
with a sound board, preferably 16 bit. Just MD-5 hash some gibberish
speech and/or background noise.
I am looking at various ways of generating good random numbers for my
IP security protocol, so I'm thinking about this stuff. Unfortunately
I can't always depend on there being a sound board, so I'm still open
to other ideas. Recently I tried looking at phase jitter between the
CPU and timer crystals, but this doesn't work on every machine.
Timing keyboard hits is a tried-and-true technique in PGP, but I can't
necessarily rely on that either (I want this to work in a standalone
system that boots by itself). Suggestions would be appreciated.

@_date: 1994-08-11 00:45:22
@_author: Phil Karn 
@_subject: IDEA vs DES 
I'm specifically interested in *fixed point* multiply and divide
performance, since these operations appear to be crucial to IDEA and
high quality speech coding, not to mention multiple precision modular
exponentiation functions.
My 486 reference shows 13-42 clocks for a 32x32 multiply and 40 clocks
for a 64/32 divide.
I've heard that the PowerPC can do a multiply-accumulate (the basic
operation of a FIR digital filter) in one clock cycle, which qualifies
it as a DSP chip in my mind. If true, then it may become possible to
do high quality speech coding (essential for a secure phone) in
software on a widely available general purpose computer instead of
needing a high performance DSP subsystem that may be costly and/or
less readily available.
Here are some figures on my latest DES code. I'm placing it into the
public domain; how do I go about putting it on soda.berkeley.edu?
Measured execution speeds in crypts/sec:
11,488 (C version, 486DX-50, DOS, Borland C++ 3.1 -O2, 16-bit real mode)
39,185 (assembler version, same system)
62,814 (assembler version, 60 Mhz Pentium)
24,172 (C version, 486DX2-66, BSDI 1.1, GCC 1.42 -O, 32-bit prot mode)
64,185 (C version, 50 Mhz Sparc 10, GCC 2.5.8 -O)
The C version is essentially identical to Outerbridge's code in
Applied Cryptography, with a few extra tricks. The assembler version
is the same thing rewritten in assembler, with numerous optimizations
that were possible only in assembler.
Anybody have a tool for translating Intel 486 assembler code to the
Gnu assembler format?

@_date: 1994-08-12 22:34:44
@_author: Phil Karn 
@_subject: POST:Gaining ISDN Privacy with data encryption 
Looks like these guys haven't noticed that Diffie-Hellman was added to
RSAREF 2.0. Even with its highly suboptimum exponentiation code, I can
generate a 1K bit key in roughly 20 seconds on a 50 Mhz 486, assuming
precomputation of the first phase of the protocol (generating a random
number and exponentiating it). That's much faster than generating a
transient RSA key pair.

@_date: 1994-08-15 18:08:12
@_author: Phil Karn 
@_subject: RemailNet 
In theory, yes. But I've heard rumors from Canadian Bell people that
their American counterparts routinely call them up to ask that they
"throw switches" that they cannot legally throw themselves.
That, plus well documented history, is enough for me to always assume
that they *don't* follow the rules.

@_date: 1994-08-17 15:07:48
@_author: Phil Karn 
@_subject: Complaints: Schlafly's complaint against RSA & PKP 
These three statements are *most* interesting. The Diffie-Hellman
patent (4,200,770) itself references the Information Theory and AFIPS
papers and their publication dates. And as stated, the patent filing
date was Sept 6, 1977. Clearly anything in the AFIPS paper is fair
game since it appeared more than a year before filing. But for the IT
paper, I don't know whether the clock starts when the paper is
submitted or when it is actually published; that would make a
difference here. Anybody know?
36. The idea of public key cryptography and digital signatures is disclosed in a paper titled "Multiuser cryptographic techniques" by Whitfield Diffie and Martin E Hellman, National Computer Conference, vol. 45, 1976. The paper was presented at a public conference in mid-June 1976, and published as part of the conference proceedings shortly thereafter. This was more than one year before any patents were filed, and therefore in the public domain according to 35 USC 102(b). A copy of the paper is attached as Exhibit T. 37. Another paper by Diffie and Hellman, "New Directions in Cryptography", IEEE Transactions on Information Theory, vol. IT-22, no. 6, Nov. 1976, was submitted on June 3, 1976. It discloses the public key distribution system of the DiffieHellman patent. A copy of the paper is attached as Exhibit U. 38. A survey paper, "The First Ten Years of Public-Key Cryptography", was published by Diffie in Proceedings of the IEEE, vol. 76, no. 5, May 1988. A copy of the paper is attached as Exhibit V. It states on p. 563 that Exhibit U was publicly distributed in June 1976 and publicly disclosed at the National Computer Conference, also in June 1976. The Diffie-Hellman patent was filed on Sept. 6, 1977. This was more than one year later, and hence the patent is invalid and unenforceable according to 35 USC 102(b).

@_date: 1994-08-22 20:17:20
@_author: Phil Karn 
@_subject: cypherpunks-digest V1 #18 
This "arms race" would not have been necessary had the vendors and
cellular carriers not been so short sighted as to not put meaningful
cryptographic security into their system at the very beginning. All of
the technology necessary to prevent the now-rampant snooping and
replay of ESNs already existed in the early 1980s when AMPS was being
deployed. It certainly exists now.
Unfortunately, the TIA seems to be just as incompetent now as they
were back then.
The cellular industry is as bad as the credit card industry. Both
claim that cryptographic security mechanisms are not "economically
viable", but if you look more closely you'll discover this conclusion
is based solely on their own direct costs. They ignore the
consequences of bad security borne by others: the mail-order merchant
stuck with a bad debt, the honest customer with a credit rating
destroyed by a stolen card number, the taxpayers who have to pay the
police, courts and prisons to investigate, prosecute and punish credit
card and cellular fraud, and of course every customer who pays a
higher price to subsidize fraud.
As long as the credit card and cellular carriers don't have to carry
these costs themselves, they don't give a damn. And I can't get too
sympathetic when I see them trying to heap even more of the
consequences of their laziness on the legal system.

@_date: 1994-08-23 13:25:19
@_author: Phil Karn 
@_subject: Nuclear Weapons Material 
At the risk of pushing this even further from cryptography, I should
say that tritium is used in the "boosting" of *fission* weapons. A
mixture of tritium and deuterium is injected into the exploding
fission core to increase the "alpha" (neutron multiplication "gain")
of the system.  The D-T thermonuclear reactions themselves contribute
relatively little energy, but the increase in fission efficiency can
be dramatic.
Thermonuclear boosting was the second major improvement made to US
fission weapons after WWII. The first was the "levitated pit", a gap
between the conventional explosive/tamper assembly and the fissile pit
to allow the former to gain significant momentum before slamming into
the latter.
Both techniques result in considerably more efficient use of fissile
material, but are not absolutely necessary to make a usable weapon (as
shown at Hiroshima and Nagasaki). I believe the simple uranium gun
used at Hiroshima only fissioned a few percent of its U-235. Fat Man
did better, but not that much.

@_date: 1994-08-24 01:12:39
@_author: Phil Karn 
@_subject: Nuclear Weapons Material 
No, actually I have yet to read my first Clancey novel, though I did
see Hunt for Red October.
My information comes from "US Nuclear Weapons" by Chuck Hansen, Orion
Books, 1988. ISBN 0-517-56740-7. I wouldn't be surprised if Clancey
used the same source -- Hansen is the guy who wrote the open letter
that sabotaged the government's case in US vs. Progressive back in 1979.
Now can we return to cryptography? How about a discussion of fast
modular exponentiation algorithms, something we (or at least I) can
put to more immediate and constructive use than nuclear bomb designs?

@_date: 1994-08-27 10:01:42
@_author: Phil Karn 
@_subject: FCC Regulation (fwd) 
This particular spoof is best appreciated by a radio ham -- it was
clearly a parody of the FCC licensing system for ham radio. It also
points out the substantial cultural similarities between the Internet
and (traditional) ham radio.
Unfortunately, one year's joke often has a nasty habit of turning into
next year's reality.
Private Radio Bureau (which regulates ham radio) is surprisingly
enlightened.  In recent years they've worked hard to remove obsolete
licensing requirements like morse code for VHF/UHF and many (but not
all, unfortunately) of the more onerous restrictions on "acceptable
use" of the ham bands.
In these proceedings it became clear that the hams themselves are the
real problem. Some hams still want a big benevolent FCC to protect
them from people who personally offend them, and many of these people
have a following. Although this phenomenon is by no means
qualitatively unique to ham radio, it does seem to have grown
quantitatively beyond anything seen elsewhere.
It really gives one pause. Is government really the enemy of personal
freedoms, or does it merely reflect an intolerant and unenlightened
general population? It's easy to make a government that responds to
the will and whim of the majority, but how can one create a government
that rises above the petty illiberalism of the people it governs to
protect the rights of the individual?

@_date: 1994-08-27 23:52:57
@_author: Phil Karn 
@_subject: $10M breaks MD5 in 24 days 
On the other hand, I can't imagine that NSA is unaware that strong
cryptographic hash functions designed for authentication are also
useful building blocks for a confidentiality cipher. Which might make
them less than wholly enthusiastic about doing their best on a public
standard like SHA.
Caveat emptor NSA. (John Cleese, if you're out there, feel free to
correct my Latin).

@_date: 1994-08-28 00:01:00
@_author: Phil Karn 
@_subject: PGP availiable on magazine cover 
Uh, my experience so far with the book "Applied Cryptography" shows
that the government discriminates on the basis of recording medium --
inked Roman characters on paper are okay, but magnetic ASCII bytes on
mylar aren't, even if the information is exactly the same.
And yes, I've explained to them in great detail, in a formal
administrative appeal, why this distinction is silly, stupid, absurd
and most likely unconstitutional.
Stay tuned. The latest word is that a response to my appeal (filed in
early June and still pending despite a rule that calls for a 30-day
response) is supposed to arrive in mid-September. For background, see
the files ftp:/ftp.cygnus.com/pub/export/applied*.

@_date: 1994-08-31 17:45:21
@_author: Phil Karn 
@_subject: Cyberspatial governments? 
Indeed, many government policies can be understood only from this
perspective. Clipper is a perfect example. Key escrow exists only
because the NSA doesn't want to risk blame if some terrorist or drug
dealer were to use an unescrowed NSA-produced algorithm.
The fact that a terrorist or drug dealer can easily go elsewhere and
obtain other strong or stronger algorithms without key escrow is
irrelevant. The NSA simply doesn't care as long as *they* can't be
blamed for whatever happens. Classic CYA, nothing more.
A similar analysis applies to the export control regulations regarding

@_date: 1994-02-06 00:10:50
@_author: Phil Karn 
@_subject: archiving on inet 
Yeah. You guys should lighten up. You won't be able to keep your posts
off of CD-ROM collections, but you might still have some fun with the
The next release of my KA9Q NOS software, prior versions of which have
already appeared on quite a few CD-ROMs, will contain a copyright
notice that explicitly grants permission to CD-ROM publishers to carry
it for free -- on the condition that they send me a free copy of the
Most already do, as a courtesy, usually when I show up at their booths
at the Dayton Hamvention. My new notice should take care of the
rest. Heck, each one probably costs them no more than a buck to make,
so how could they object? Seems like a win-win situation to me. They
enhance their sales and I build up a nice CD-ROM collection quite
By the way, there's a very good reason why you should *welcome* the
availability of USENET archives on CD-ROM. Imagine that one day you
toss out on the net a clever little idea in the hope that someone may
find it useful. You don't think much of it at the time. Several years
later, much to your dismay, you discover that some slimeball has
stolen and been granted a patent on your idea. You're convinced they
got it from your original USENET article, but how do you prove it?
Simple -- if your original comments were preserved for posterity on a
commercial CD-ROM, complete with silk-screen label showing the dates
of the articles it contains.
Don't laugh - this has already happened to me. Fortunately, I had also
published my idea in a ham radio journal more than a year before the
bogus patent application was filed. But if I hadn't, I'd now be
frantically looking around for 5-year-old USENET archives.

@_date: 1994-02-07 19:16:32
@_author: Phil Karn 
@_subject: Atlantis Project/Oceania 
Depends entirely on what it's pointing at. The actual throughput for
a single transponder on a conventional Ku-band DOMSAT is more like 45
Because of fiber, satellites are fast falling out of favor for high
capacity point-to-point links. They're now used mainly for "thin
route" traffic, especially to remote or mobile locations, and for

@_date: 1994-02-07 21:36:43
@_author: Phil Karn 
@_subject: New remailer up 
Not quite. Very few, if any, Part 15 spread spectrum modems do automatic
transmitter power control, and as a result they generally run much more
power than necessary. That makes you much easier to spot. It also
pollutes the spectrum.
Even spread spectrum transmitters with tight power control (e.g, our
IS-95 cellular system) are easily detected (though not demodulated)
with simple AM scanners when you're close enough. Especially when the
mobile in question is a long way from the cell and transmitting near
full power as a result.
On the other hand, if you're not close, any particular mobile will be
drowned out by the several dozen others sharing the same channel.

@_date: 1994-02-07 23:10:43
@_author: Phil Karn 
@_subject: STEG: a real-life use for steganography 
The biggest problem I see with your scheme is that it won't remain secret
for very long, and the government will probably just ban all CD imports
as a result. And possession of a CD player or CDs (even "legit" ones)
would be enough to send you off to kamp.
There's a practical problem here. Audio CD players generally provide
no easy way to get the raw bits into a computer (SPDIF interface cards
exist for PCs, but they're rare and expensive). And I haven't yet
figured out how to get a CD-ROM drive to read the raw bits off an
audio CD; I suspect it requires munging the firmware in the drive,
which makes anything you do highly manufacturer specific.

@_date: 1994-02-22 15:50:38
@_author: Phil Karn 
@_subject: Disinformation (or the Truth?) About Clipper 
I agree completely. Telling the truth is all that's necessary.

@_date: 1994-02-28 13:42:48
@_author: Phil Karn 
@_subject: Dorothy Denning 
The "Dr." in "Dr. Dorothy Denning" should answer question B. Note also
that she's the chair of the CS dept at Georgetown; such positions are
not usually given to those without college degrees.
The answer to question A is somewhat more subjective. I know enough
about cryptography to know that I am NOT an expert in
cryptography. And that means I know much more about cryptography than
most people -- if you follow my meaning.  Although Dr. Denning has
written a highly regarded college textbook on cryptography, I have not
seen anything to demonstrate her expertise in designing a cipher and
evaluating it against attack. This is a far more arcane talent, one
shared by a relative handful of people. It should not be confused with
the ability to apply existing ciphers to various problems, a skill
that she clearly possesses, along with many other people.
This is why I questioned her inclusion on the clipper review
committee, as opposed to, say, Ernie Brickell, whose destruction of
the knapsack public key cryptosystem gives him the kind of actual
experience in cryptanalysis that is essential in such a review.
As for your other questions, I suggest that the case against Clipper
is strong enough that we do not need to resort to ad-hominem attacks
against individuals such as Dr. Denning. I agree that she is, at best,
seriously misguided, but it is not that uncommon for otherwise
intelligent people to disagree seriously on politics.  Remember that
her technical credentials, whatever they may be, gives her no special
insight over the rest of us into the purely political issues here.
Don't get mad, get even. Write code!

@_date: 1994-02-28 13:50:05
@_author: Phil Karn 
@_subject: DES Question 
That sounds like my code. That feature seemed like a good thing to do
at the time. Then I learned about differential cryptanalysis. No, you
cannot strengthen DES in this way, and in fact you could actually
weaken it unless you are sure to use 128 completely random bytes for
your key.
Mainly to sabotage the performance of DES software implementations.
Even back then the government knew it was much easier to control
the dissemination of hardware than software.

@_date: 1994-01-10 19:31:38
@_author: Phil Karn 
@_subject: Crypto not being used where needed 
There are several commercially available "RF service monitors" with
option modules specifically designed for AMPS (the North American
cellular standard). Manufacturers include IFR, HP and Marconi.
Among many other things, these monitors can be programmed to monitor
cellular access channels. Whenever someone nearby hits the SEND key on
their phone, the monitor instantly displays the called number, the
user's MIN (phone number) and ESN (electronic serial
number). Furthermore, it can be told to automatically follow the
conversation channel assignment message and any subsequent handoff
Or the unit can be programmed to monitor the forward paging link for
pages (land-to-mobile) calls directed to any particular mobile. When a
page is found, the unit can again switch to the appropriate
conversation channel and follow the conversation through any
subsequent handoffs. You do, of course, have to remain physically
close enough to the mobile in question to be able to hear the same
cell sites it is using.
As a manufacturer of cellular phones, we have legitimate need for such
units in testing our phones. We had one of these units in house a
while back and I had a chance to play with it. I can attest to its
effectiveness. It's not cheap, of course, but if we can afford one,
than so can any motivated government agency.

@_date: 1994-01-11 16:05:21
@_author: Phil Karn 
@_subject: Updated/corrected posting 
This sounds like the standard KGB practice to frame "spies". Have an
agent posing as a dissident ask you to carry a letter to the
West. When it changes hands, pounce. Then conduct a show trial
"proving" that "secret" information changed hands.
I'm seeing fewer and fewer differences between the present-day USA and
the former USSR.

@_date: 1994-01-14 01:05:46
@_author: Phil Karn 
@_subject: Public key encryption, in 
Indeed. Some years ago I ran into a guy at Newark Airport who was on
his way to Barbados. We struck up a conversation, and it turned out
that he ran a data entry business. He ships documents of various kinds
to Barbados where workers convert them to machine-readable form and
return the tapes. I asked why Barbados. The answer was very simple:
it's about the only English-speaking third-world country in the
western hemisphere with a decent literacy rate (99%, according to my
National Geographic atlas). The economy was bad, and the people were
happy to get the work.
This got me thinking about the impossibility of regulating and taxing
the international transmission of information. At the time I was
thinking more in terms of the impossibility of enforcing US import
duties; who's to say what a particular magtape is worth? If this guy
is still in business I suspect he has long since replaced physical
magtape shipments with electronic transfers, which bypasses Customs
I suspect there are many other similiar operations, and the trend is
strongly positive.

@_date: 1994-01-22 23:16:28
@_author: Phil Karn 
@_subject: Remailers: The Next Generation 
While you guys are thinking about where to take this stuff at the
application level, how about giving some thought to how you might do
it at the IP level?
Since IP is a much more fundamental Internet service than mail, any
anonymity functions we might add to it could have much wider
applicability.  For example, consider anonymous FTP sites that a)
insist on your IP address having an inverse DNS entry, whether it is
under your control or not, b) insist on a user's name and c) log every
file retrieval? An anonymous IP service could effectively put a stop
to this practice.

@_date: 1994-01-24 22:36:44
@_author: Phil Karn 
@_subject: Remailers: The Next Generation 
Indeed. I've been threatening to do this for some time. Define a
SLIP-over-Telnet protocol that encodes packets as lines of ascii
characters (one packet per line). Then login to your local public UNIX
system and telnet from there to a cooperative server somewhere on the
net that will turn your asciified packets back into real packets and
put them on the net. You'd have an IP address that belongs to the
server's net. One such server, well connected to the backbone, could
support quite a few users all over the world.
As far as the local UNIX host is concerned, you just spend all your
time telnetted to some random host on the net.
Although this could easily be done in my NOS code, I haven't actually
written it because a) it's an inelegant kludge, b) I have lots of
other active projects, and c) I had hoped that merely the threat of
doing so would shame the dialup SLIP/PPP service providers into
dropping their prices more into line with what they now charge for
UNIX-with-Internet-connectivity service. SLIP/PPP service should
actually cost *less* than interactive service to a public UNIX system
on the Internet because it uses fewer resources per unit of connect

@_date: 1994-01-25 03:06:47
@_author: Phil Karn 
@_subject: Randomness of a bit string 
Thanks to Tim May for his *excellent* tutorial on randomness, which
can be compressed into a single sentence:
"Randomness is in the eye of the beholder."

@_date: 1994-01-25 22:06:55
@_author: Phil Karn 
@_subject: NSA museum now open, if you can find it 
NSA coffee mugs *do* exist; I have one in my cupboard.
I had to bribe it away from a friend who works for IDA/CRD, the NSA
"think tank" in Princeton.

@_date: 1994-01-25 22:26:56
@_author: Phil Karn 
@_subject: clipper pin-compatible chip 
This may not be very practical for small devices like portable cell
phones.  They tend to use a lot of surface mount technology, and are
not very readily modified after manufacture.

@_date: 1994-01-25 23:06:56
@_author: Phil Karn 
@_subject: subpoenas of personal papers 
The Fifth Amendment applies only when *self*-incrimination is
involved.  With only a few exceptions, it's always been the case that
you can be compelled to testify against someone else, whether you want
to or not. The exceptions are limited to a few special relationships
such as those with your lawyer, spouse or priest.
There was a flurry of laws during the 1970s that extended somewhat
similar privileges to reporters and their sources, but they don't seem
to have held up very well since the Big Lurch to the Right.

@_date: 1994-01-26 01:44:12
@_author: Phil Karn 
@_subject: 4th ammendment and Cryptography 
I presume you are not a lawyer or law student. (Neither am I.)
Therefore I would start with a couple of books on the Constitution and
Bill of Rights that were written for general audiences to get a feel
for how they've been applied in real cases, to set a backdrop for what
you want to talk about.
Two recommendations:
"In Our Defense - The Bill of Rights in Action", Ellen Alderman and
Caroline Kennedy [yes, *that* Caroline Kennedy], Morrow, ISBN 0-688-07801-X.
"May It Please The Court", Peter Irons, ed. (Book with optional
cassettes).  Narrated excerpts from actual audio recordings of
important Supreme Court cases since 1955. I don't have the ISBN number
because I've since given this to my dad. Very well done.

@_date: 1994-01-28 11:28:01
@_author: Phil Karn 
@_subject: 4th ammendment and Cryptography 
I re-read the chapter on the 2nd amendment. I can't find *anything*
that qualifies as a statement of personal opinion. The closest is a
statement that "...the courts have not supported this interpretation",
referring to the claim by "the gun lobby and certain scholars" that
"citizens have a constitutional right to pack a gun". This is a
statement of fact about what the courts have said, not a statement of
the authors' personal opinions. The discussion of the Morton Grove
case that they chose to illustrate the issue contains many quotes from
both sides, including the gas station owner who was robbed because
he had stopped wearing a gun to appear to be in compliance with the law.
Sorry you didn't like it. I stand behind my recommendation; I think
it's an excellent collection of essays for the layman. Each essay
picks a clause of the Bill of Rights and shows how it was interpreted
by the courts in a real case. Included (and far more relevant to the
right to develop and use cryptography than the 2nd amendment) is
"US. vs The Progressive". In this 1979 case in Wisconsin, the
government obtained, for the first time ever, prior restraint against
the publication of privately generated and assembled information that
the government considered "sensitive" - in this case, a layman's
educated guess, working from open sources and his own understanding of
physics, as to how thermonuclear weapons work. The case was eventually
dropped, however, when another "nuclear hobbyist" published his own
work.  Since there has been at least one call to regulate cryptography
under the same "born classified" terms as nuclear weapons (by
Adm. Inman in the early 1980s), there are a lot of useful insights in
this case.
The section on the 4th amendment is also highly relevant (see the
subject line here). The authors chose "McSurely vs McClellan", a case
that I had never heard of. It showed just how egregious the police can
be in abusing their authority when they are politically motivated.
Although cryptography was not at issue here, it shouldn't be hard to
use this case as an example of its potential importance in defending
against unreasonable searches and seizures.

@_date: 1994-01-28 13:18:03
@_author: Phil Karn 
@_subject: 4th ammendment and Cryptography 
Well, according to the authors, "The courts have overwhelmingly
supported the collective-rights interpretation" of the Second
Amendment. "The federal courts in the Morton Grove case were no
exception. The district court held that Morton Grove's ordinance did
not violate the Illinois Constitution or the Second Amendment. It
based its holding on the fact that the Second Amendment has never been
incorporated into the Fourteenth and made applicable against the
states. The Second Amendment, therefore, acts only as a restriction on
the federal government, keeping it from passing legislation that would
infringe on a state's right to arm and train its militia [...] On
December 6, 1982, the US Court of Appeals for the Seventh Circuit
affirmed [...] Under the controlling authority of the only Supreme
Court case to address the scope of the Second Amendment, US v Miller,
the court concluded that 'the right to keep and bear handguns is not
guaranteed by the Second Amendment'. The US Supreme Court declined to
hear the case, letting the lower-court rulings stand."
You may well disagree with this state of affairs, but can you say that
any of this factual information about court rulings is reported
incorrectly?  That the Supreme Court declined to hear the case can
only mean that they agreed with the Appeals Court decision and almost
certainly would have voted to uphold it. Otherwise enough justices
would have voted to hear it on appeal. That's not *quite* the same
thing as saying that "no case has come before the court since
1939". Cases including Morton Grove *have* come before the Supreme
Court. They simply haven't agreed to hear any, presumably because
they've always agreed with the lower court opinions.
Once again, I would like to say that tying cryptography to the Second
Amendment is exceptionally bad strategy for the Cypherpunks. Not only
is it highly unlikely to do any good, given how the courts have ruled
on gun control cases in this century, but it is almost certain to
backfire. Many people who strongly support the right to use
cryptography to protect personal privacy are not strong supporters of
"gun rights". Indeed, many of us find cryptography so appealing
precisely because of its purely defensive nature. It protects my
privacy by simply making it *impossible* for people to read my mail,
rather than by threatening them with death or serious bodily harm
after the fact. Prevention is far more effective and moral than
threats and revenge, and for both reasons you will find it much easier
to get the public to accept and support it.
Worst of all are the complete loonies (some apparently on this list)
who assert that guns are an essential protection against a tyrannical
US Federal Government. Those who believe this have apparently never
heard of the US Civil War, because the South tried exactly this over
130 years ago. (They failed, BTW.)  It succeeded only in destroying
most of an entire generation of Americans, along with much of the
country. And that was before some rather significant advances in US
military weaponry, vis a vis privately owned weapons.
I am a strong believer in the right to protect one's personal privacy
through strong cryptography and other purely peaceful means. I'm not
trying to violently overthrow the government, and I'd rather not be
associated with gun fetishists who give the strong impression that
they are -- it can only hurt the cause I believe in.

@_date: 1994-01-30 11:38:57
@_author: Phil Karn 
@_subject: Today's OUTLAND cartoon 
Be sure to see it. The "Information Highway Patrol" has arrived...

@_date: 1994-07-05 18:08:42
@_author: Phil Karn 
@_subject: Password Difficulties 
There's a difference: as far as I know, ATM PINs can't be cracked
offline (somebody correct me if I'm wrong). The big problem here is
that you have to assume the attacker can do his thing offline. Require
an online trial for every test key and it becomes much easier to
detect this sort of thing.

@_date: 1994-07-05 21:33:02
@_author: Phil Karn 
@_subject: Dr. Dobbs Dev. Update 1/5 July 94 & Schneier 
This operation is ideal for computing the "hamming distance" between
two binary words, an important operation in the encoding and decoding
of forward error correcting codes. It's also used when correlating
binary streams, eg, searching for frame synchronization vectors or
despreading spread spectrum signals. All these operations are
fundamental to modern digital radio communications.
I've written software that implements a correlator, a convolutional
coder and a sequential decoder. All three make heavy use of this
operation, so I know first hand how useful it would be to have such an
instruction. The best I can do on the 386/486 when is to add the
results of table lookups on manageable pieces of the word (e.g., 8
bits at a time).
People keep assuming that NSA spends most (or even all) of its CPU
cycles on cryptanalysis. They forget that before you can attack a
cipher, you need some ciphertext. Usually this comes by radio. This
means analyzing, demodulating and decoding (as opposed to deciphering)
the digital RF modulation being used by your target. A Cray with a
library of signal analysis and demodulation programs would be ideal
for this purpose.
I would make an educated guess that this, and not cryptanalysis, is
NSA's biggest use for their Crays.  A Cray is not especially
cost-effective for cryptanalysis, at least compared with special
purpose hardware that could, say, attack DES far more cheaply.
And then there's this friend of mine who works for IDA/CRD, the NSA
think-tank in Princeton. His specialty is digital signal processing,
often using Crays. As a lark, he once demodulated some amateur packet
radio signals that were used in "Star Trek IV" as background sound
effects. Great fun.  Another time he helped the Russians demodulate
some telemetry signals from their "Vega" Venus balloon probe. Sucked
the bits right out of the noise.

@_date: 1994-07-12 02:03:57
@_author: Phil Karn 
@_subject: Gov't eyes public-key infrastructure 
All in all, I'd say this is a pretty good argument for PGP's web of trust

@_date: 1994-07-14 02:39:30
@_author: Phil Karn 
@_subject: "True Names," chat with Vinge, and Cypherpunks 
Yeah, sounds like a clean sweep. I spent Saturday afternoon trying to
get the mbone working on my workstation. I was unsuccessful. (It
hasn't worked ince I upgraded to a Sparc 10, not that I spent much
time on it before). I strongly suspect that our $ firewall was to
Puncturing fascist firewalls was one of the reasons I suggested swIPe
in the first place...

@_date: 1994-07-14 02:42:58
@_author: Phil Karn 
@_subject: MAKE.MONEY.FAST 
When has that ever stopped the Patent Office? I have had the bitter
experience of openly publishing an idea (a protocol for wireless LANs)
with the intent that it pass into the public domain. With much
surprise did I learn that Proxim, Inc, had filed for and was granted a
patent on the same exact thing, despite their filing date being more
than a year after the publication of my paper.
By the way, I notice that the Patent Office is taking comments until
August on whether their standards for nonobviousness should be
tightened. (Is the Pope Polish?) Here's your chance, although after
the way NIST totally ignored our comments on clipper, I don't know
what good it will do...

@_date: 1994-07-25 19:47:50
@_author: Phil Karn 
@_subject: Gore's "new and improved" key escrow proposal 
I think we need to distinguish between encrypted *storage* and
encrypted *communications*.  Voluntary key escrow may make sense for
encrypted stored business files, but communications is a different
story. Since there should be nobody out there recording packets, there
is no need to back up or escrow the keys used to encrypt them.

@_date: 1994-07-28 12:28:34
@_author: Phil Karn 
@_subject: Dallas Morning News article? 
I've heard that an article appeared in the Dallas Morning News,
apparently yesterday (wednesday) on the absurdity of crypto export
controls.  I understand that I was quoted in reference to my CJ
requests for Bruce Schneier's book and floppy disk (which is not
surprising since the writer interviewed me last week). Does anybody
have a copy of this article?  I have no easy way of getting a copy.

@_date: 1994-06-02 15:59:28
@_author: Phil Karn 
@_subject: Black Eye for NSA, NIST, and Denning 
Matt's attack doesn't require knowing where the checksums and unit IDs
are in the LEAF. Nor does it provide any insight into cracking
Skipjack itself, which would be required to learn the family key. He
simply determined that the chip will accept 1 out of every 65,536
randomly chosen LEAFs, which is a large enough fraction to make a
brute force search for one quite practical -- especially since it only
need be done once.

@_date: 1994-06-10 18:52:17
@_author: Phil Karn 
@_subject: The Crypto Home Shopping Network 
No, RC4 is not the European cellular phone encryption algorithm, but
that 32-bit figure *has* come up in discussions of what NSA will allow
the carriers to put into next-generation digital cellular telephones.
The fact that NSA lets out RC2/RC4 with 40 bit keys, but is limiting
new algorithms for cellular to 32 bits may or may not say something
about the strength of RC2/RC4.
I believe the current context for the discussions is data services, as
opposed to voice services.  This is of course a tempest in a teapot
since cellular data users will be in a much better position to encrypt
for themselves using whatever algorithms and protocols they like.
The battle for digital cellular voice privacy, on the other hand, was
lost several years ago. And most cellular users will not be in a
position to add their own strong encryption, especially since it
usually requires the cooperation of the carrier.

@_date: 1994-06-16 16:27:08
@_author: Phil Karn 
@_subject: The Crypto Home Shopping Network 
Technically, yes.
De facto, if not de jure. As has been the case for several years, the
NSA publicly maintains that it is not interested in controlling the
domestic use of strong cryptography. But the standards committee that
controls this stuff (the TIA TR45.0.A "Ad Hoc Authentication Group")
is made up largely of the technically incompetent and/or "spook
wannabees" sympathetic to the government.  With a single exception,
the members all represent cellular vendors and carriers, not end
users. The single exception is a NSA R&D employee legitimately
representing the US government as a potential end user of digital
It is clear that without a strong, organized demand by the US public
as a whole for meaningful cell phone privacy, the cellular industry
has no real incentive to provide it. NSA only had to suggest very
quietly that the lack of meaningful cryptographic privacy would make
it much easier to export digital cellular technology, and the industry
quickly got the hint. After all, they were really only concerned about
cellular fraud in the first place (hence the use of "authentication"
in the group name) and they'll care about end-user privacy only if it
hits them in the bottom line. So far it hasn't.
Indeed, we're now starting to see protests and demands for real
privacy from some of our potential non-US customers; how we could ever
meet it under the ITARs is a good question.

@_date: 1994-06-17 12:03:16
@_author: Phil Karn 
@_subject: swipe working on infinity.c2.org 
My unreleased KA9Q NOS version of SwIPe (I really need to converge to
ji/mab's version) adds a sequence number in the header just above IP
that is covered by the encryption (DES CBC). This acts as an IV that
ensures different ciphertext every time even when identical packets
are sent. The only part of the packet left in the clear is the IP
header. An eavesdropper has no knowledge of the application or the
transport protocol in use, or even if there's another IP datagram
buried inside the encrypted part (e.g., the swipe boxes are providing
a secure tunnel for other hosts).
These are all advantages of IP-level encryption over doing it above
TCP. The main disadvantage is overhead -- Van Jacobsen TCP/IP header
compression breaks.

@_date: 1994-06-18 10:53:03
@_author: Phil Karn 
@_subject: Another Cellular Victim 
Bear in mind that OJ himself placed a call to 911.  You sort of expect
to lose some of your privacy when you do that.
As everyone knows, when you call 911 from a landline telephone your
phone number and address are automatically displayed on the
dispatcher's console. As strongly pro-privacy as I am, I'd find it
hard to argue against this particular feature. If I called 911 in an
emergency, I'd *want* my address to show up. Especially if I was too
panicked or sick or whatever to give it over the phone.
What I don't know, and am trying to find out, is whether there are any
comparable features in the LA/Orange cellular and 911 systems that
would have displayed the caller's cell site to the 911 dispatcher, or
whether some ad-hoc telephone company help was required.
But however it was done, it worked. This does tend to undermine the
FBI's claim that they can't catch crooks using cell phone systems...

@_date: 1994-06-21 18:01:19
@_author: Phil Karn 
@_subject: Another Cellular Vict 
Not to mention our very own Omnitracs service, which uses spread
spectrum ranging via satellite to report the position of every mobile
user to roughly GPS accuracy (without actually using GPS). So far the
trucking companies to whom we sell this stuff have been pretty
enlightened in how they use this information.
We've also discussed adding position location to our CDMA cellular
system, although that wasn't originally a design consideration.
Depending on how far you go with modifying the existing system,
and depending on local terrain, you could locate a user somewhere on
a circle around a given cell (by round trip time measurements from
cell to mobile and back) or perhaps to a specific point by multi-cell
delay measurements during a handoff.
Which suggests a "stealth" phone that randomly dithers its round trip
delay a la GPS selective availability...

@_date: 1994-06-21 19:14:38
@_author: Phil Karn 
@_subject: your mail 
An even better idea: disconnect the antenna. Most of the noise comes
from the front end amplifier, not the galactic and cosmic background,
at least in your average consumer grade receiver. And this is a quantum
process that someone else definitely can't predict or copy.

@_date: 1994-06-22 01:52:49
@_author: Phil Karn 
@_subject: OJ`S CELL PHONE 
There is an optional mechanism called "registration" by which the
system can keep track of your approximate location even though you're
not actually making calls. The intent is not really to track your
location, although it could certainly be used for that purpose. It's
intended to minimize the amount of "flood paging" that goes on.
When somebody calls you on a cell phone and the system doesn't know
where you are, it has to broadcast the page (the message announcing
the call) on every cell in the system. In large busy systems, this can
cause quite a bit of congestion on the paging channels. So the system
has the option of asking the users to transmit occasionally so the
system can keep track of their location and direct incoming pages to
the last known cell, at least as a first try.
Think of the system as a large bridged Ethernet and you won't be far
off, at least on the concept. On the other hand, the fact that most
cell phones see very little use, and the use that they do see is
predominantly mobile originated, means that registration actually
doesn't buy that much in practice. It can even be counterproductive
because of all that non-revenue generating registration traffic that
takes up capacity on the access and paging channels. This probably
explains why registration isn't often used in practice, as far as I
The best way to make sure it isn't occurring, of course, is to turn
off your phone.

@_date: 1994-06-22 01:58:18
@_author: Phil Karn 
@_subject: OJ`S CELL PHONE 
I should have added in my remarks about registration that one very
easy way to "ping" a cellular phone is to call it. If the phone is
powered on and hears the page, it will automatically acknowledge it on
the access channel (the mobile-to-base link that is also used to
request a mobile-originated call). This will certainly reveal the
mobile's location to the closest cell.

@_date: 1994-06-22 02:14:55
@_author: Phil Karn 
@_subject: Cell phone tracking 
Yes, as I described in earlier mail this is certainly doable with our
CDMA system although position location was not one of the original
design goals for the system nor is it a requirement for the ones we're
currently building.
During drive tests in the demo/test system it was easy to tell by
watching a display in the cell when the test van had returned to the
starting point. We had a continuous display of round trip time which
would increase and then return to its original value. But we don't do
anything useful with this information at present. For data logging
purposes on field tests, we now use commercial Trimble GPS receivers
that have piezo gyros for dead reckoning through the GPS coverage
shadows. They work much better than the compass/wheel rotation counter
scheme used in the ETAK units we had before.
We already "net our time base with GPS" - each cell site has a GPS
timing receiver that controls frequencies and spreading codes within a
microsecond (limited mainly by SA dithering). This is needed to make
our soft-handoff work, but it does have the side effect of making
a potential location-determination system more practical.

@_date: 1994-06-22 14:38:10
@_author: Phil Karn 
@_subject: Hardware generators 
Is this trip really necessary?
Seems to me you can get strong random numbers without having to build
hardware from scratch. Just get a sound interface (widely available
for both ISA and parallel interfaces) and run the noise from an FM
receiver into the A/D converter. Hash the output with MD5 and you have
some pretty strong random numbers.
I wouldn't be surprised if with some 16-bit boards you could do away
with the FM receiver and just sample the noise from the analog preamp
and mixer stages. Many of those boards are rather noisy.
It is always better to buy than to build when you can make effective
use of some mass-market PC peripheral. Not only do you save a lot of
time, but it'll be much easier for others to replicate too.

@_date: 1994-06-23 14:20:06
@_author: Phil Karn 
@_subject: Another Cellular Vict 
Sure it can. We're not talking RTT in the Internet sense.  In a spread
spectrum system, deterministic pseudo-random sequences are used for
the spreading codes; the receiver always knows the future of the sequence.
We generate ours with conventional linear feedback shift
registers. The mobile phone tracks the code phase of the cell site and
slaves its own coded transmissions to that. All you'd have to do is to
add a random time-varying phase to the tracking loop. That would cause
the measured delay to be either greater than or less than the real
There would be limits to how far you could vary the delay, but the
tolerance at the cell has to be on the order of the cell radius for
the system to work anyway.

@_date: 1994-06-23 15:15:39
@_author: Phil Karn 
@_subject: your mail 
In my ham experience, almost all of the computer noise you might pick
up in such a receiver comes through the antenna. If you disconnect the
antenna, what remains is almost entirely thermal noise from the
receiver front end. And even if there were some computer noise mixed
in, MD5 hashing the output to concentrate the entropy should satisfy
even the most paranoid.
It's advisable to replace the antenna with a dummy load (matched
resistive terminator) to ensure that the front end remains stable; if
the receiver is sensitive enough you also pick up the thermal noise
generated by the terminator itself. (BTW, you can easily demonstrate
thermal noise with a *good* low-noise preamp and a linear, e.g., SSB
or AM -- not FM, receiver this way.  Turn off the receiver AGC and
dunk the terminator in liquid nitrogen.  The noise level will decrease
dramatically.  Take the terminator out of the N2 and let it warm up;
the noise level will return to normal. Be prepared to sacrifice the
coax you dunk into the N2; I've cracked a few rubber connector boots
this way.
It's a little more complicated than that. In general, as you go higher
in frequency the natural background noise power (lightning, sun noise,
galactic synchrotron radiation, 3K cosmic background, etc) decreases
rapidly, reaching a minimum in the 1-10 GHz range. Above that,
atmospheric components such as water vapor and oxygen again start to
contribute quite a bit of thermal noise.  (This low-noise window is
why the Search for Extraterrestrial Intelligence projects concentrate
on the 1-10Ghz range).  On the other hand, the noise contributed by
state-of-the-art receivers tends to increase with frequency, though
again the state of the art has gotten very good.
For cryptographic quality random numbers you want *only* local
receiver noise; if you rely on external sources like the galactic
background, your attacker also has access to them.

@_date: 1994-06-23 16:33:11
@_author: Phil Karn 
@_subject: Cellular Telephone Experimenter's Kit (2600 article) 
Several companies make cellular test sets (or optional modules for
more general purpose RF test sets) that perform functions very much
like those of the CTEK package. Since we manufacture cell phones, we
have a perfectly legitimate reason to have a few of those test sets
around here.  And I know of no special licensing requirements to buy
them (other than having $20,000 or so in cash).

@_date: 1994-06-23 18:03:46
@_author: Phil Karn 
@_subject: Unofficial Release 
Rumor has it that certain government applications do Diffie Hellman
with 2K-bit moduli. Given the apparent connections between factoring
and discrete logarithm (the complexity formulas seem to look very much
alike), it appears that at least one user feels that keys longer than
1K bits provide a desirable safety margin.

@_date: 1994-03-01 15:11:31
@_author: Phil Karn 
@_subject: Proposal: Another emergency session of Cypherpunks 
If you were to carry the Cypherpunks meeting over the MBONE, which I assume
you mean, I'd definitely be interested in joining in from San Diego.

@_date: 1994-03-03 23:33:27
@_author: Phil Karn 
@_subject: Export of "Top Secret Data Encryption Techniques" 
Speaking of the exportability of cryptography textbooks, I've filed a
15-day Commodity Jurisdiction Request with the State Dept for Bruce
Schneier's book "Applied Cryptography". No official response yet,
though I did get a phone call from an amused Commerce Dept engineer
who wanted me to know how much they enjoyed my filing (I did have fun
with some of the sections).

@_date: 1994-03-08 11:36:49
@_author: Phil Karn 
@_subject: Response to CJ request for Applied Cryptography 
In reply refer to
ODTC Case CJ 038-94
YOUR LETTER DATED: February 12, 1994
REQUEST FOR COMMODITY JURISDICTION DETERMINATION FOR: "Applied
Cryptography" Cryptographic Book by Bruce Schneier
Your commodity jurisdiction (CJ) request was referred to the
Departments of Commerce and Defense for their review and
recommendations. As a result, the Department of State has
determined that the referenced commodity is not subject to the
licensing jurisdiction of the Department of State since the item is
in the public domain. However, this ruling covers only the subject
book and not the two source code disks that the book references and
that are available from the author.
Should you require further assistance on this matter, please contact
Maj. Gary Oncale at (703) 875-5655.
Phil Karn
7431 Teasdale Avenue
San Diego, CA 92122

@_date: 1994-03-11 00:07:25
@_author: Phil Karn 
@_subject: Response to CJ request for Applied Cryptography 
I had to revise my second filing slightly. Early Wednesday morning,
I got a phone call from Maj. Gary Oncale stating that my title was too
vague. He asked me to resubmit it using a more specific title, so I did.
I've appended the revised version here. The only change is the title in
the second subject line.
I called him back later on Wednesday afternoon to confirm receipt. He
had received it, but had not yet assigned an official case number. He
thought the number would probably be 079-94.  I haven't called back to
verify this yet, I will try to remember to do so tomorrow. --Phil
ATTN: Maj Gary Oncale - 15 Day CJ Request
U.S. Department of State
Office of Defense Trade Controls
PM/DTC SA-6 Room 200
1701 N. Fort Myer Drive
Arlington, VA  22209-3113
Fax +1 703 875 5845
ATTN: 15 Day CJ Request Coordinator
National Security Agency
P.O. Box 246
Annapolis Junction, MD  20701
This is a Commodity Jurisdiction Request for mass market software with
encryption capabilities.  It is a followup to an earlier CJR (case
038-94, dated February 12, 1994) regarding the book "Applied
Cryptography" by Bruce Schneier, published by John Wiley and Sons,
ISBN 0-471-59756-2.
In your reply of March 2, 1994, you explicitly limited your
determination that the item was outside State jurisdiction to the book
itself, explicitly excluding the source code diskettes available from
the author. Hence my second request.
The newly released diskette that is the subject of the present request
should not be confused with the more comprehensive two-diskette set
also available from the author. This new diskette is strictly limited
to the source code that already appears in the book, which you have
already determined to be public domain. Character by character, the
information is exactly the same. The only difference is the medium:
magnetic impulses on mylar rather than inked characters on paper.
I have no DTC registration code.
I have reviewed and determined that this diskette, the subject of this
CJ request, meets paragraph 1 of the "Criteria for Determining the
Eligibility of A Mass Market Software Product for Expedited Handling."
I base this determination on the following facts:
a) this diskette is readily available from the author by mail-order,
thus qualifying it as mass market software;
b) sufficient documentation is included to allow installation and use
by any end user capable of compiling and executing it. To my knowledge
the author provides no "product support" as that term is generally
understood; and
c) the diskette contains source code for encryption software that
provides confidentiality.
A duplicate copy of this CJR has been sent to the 15 Day CJ Request
This diskette contains (and is limited to) the exact same source code
printed in Part 5 of "Applied Cryptography", the subject of ODTC Case
CJ 038-94. It is not to be confused with the more comprehensive
two-disk set previously released by Mr. Schneier and mentioned in his
Mr. Schneier's announcement (attached) lists the contents of this
ORIGIN OF COMMODITY
The diskette is available from Mr. Schneier, a US citizen living in the
US. The price is $15.
CURRENT USE
The software on this diskette is provided for those who wish to
incorporate encryption into their applications.
Examples of the commercial use of these ciphers include integrity
verification, authentication and confidentiality of electronic mail,
computer software, voice, video and other information in digitized
form.  For example, the Internet's Privacy Enhanced Mail (PEM) project
uses DES for confidentiality and MD5 for integrity. The Pretty Good
Privacy (PGP) package uses IDEA and MD5 for the same purposes. PGP is
now widely used around the world.
The uses of these ciphers have not changed significantly over time,
although their popularity has grown substantially.  Their present
military utility is unknown, except that it is believed that none of
these algorithms are approved for the protection of US classified
SPECIAL CHARACTERISTICS
There are no military standards or specifications that this diskette is
designed to meet.  There are no special characteristics of the diskette,
including no radiation-hardening, no ballistic protection, no hard
points (the corners of the diskette are rounded), no TEMPEST
capability, no thermal and no infrared signature reduction capability,
no surveillance, and no intelligence gathering capability.  The diskette
does not use image intensification tubes.
OTHER INFORMATION
I recommend that this diskette be determined to be in the jurisdiction of
the Commerce Department.  I believe that it qualifies for the general
license GTDA for General Technical Data to All Destinations, because
it qualifies as "publicly available".
I have enclosed the announcement of this diskette's availability as
published over various electronic mailing lists by the author.
APPLIED CRYPTOGRAPHY SOURCE CODE DISK
This disk includes all the source code from the book, Applied Cryptography:
The code is available either on a single 5.25 or 3.5 IBM-PC disk, or
on a single 3.5 Macintosh disk.
Cost: $15
Bruce Schneier
Counterpane Systems
730 Fair Oaks Ave
Oak Park, IL  60302
(708) 524-9461
schneier at chinet.com

@_date: 1994-03-14 12:27:31
@_author: Phil Karn 
@_subject: Nature of RSA's patent 
Why should my incoming PGP-encrypted communications be automatically considered
"infringing products", since I've got a copy of ViaCrypt PGP that was
produced under license from Public Key Partners?

@_date: 1994-03-15 21:52:47
@_author: Phil Karn 
@_subject: spyproofing your house/work building 
Yeah, this is getting pretty far afield, but if you want to see what
IR floodlight/camera combinations look like, visit Disneyland. That
park probably has one of the most extensive video surveillance systems
of any place readily accessible to the public. (I expect Disney World
is much the same).
IR cameras are everywhere in the inside rides, especially in dark
areas where visible floodlights would ruin the dramatic
effect. Perhaps the easiest place to see them is in Pirates of the
Caribbean. Just turn around and look backwards, and you'll see video
cameras mounted overhead next to dim red lights.
Other rides where they can be easily seen include People Mover (never
crowded), Haunted Mansion and Space Mountain.

@_date: 1994-03-23 12:50:40
@_author: Phil Karn 
@_subject: Parker on Clipper 
Exactly. Parker has been in the computer security field for a long
time, and he is well known for expressing views that can be best
described as ultra-conservative and extremely authoritarian. These
comments of his are about as surprising as those of George Bush
calling for the reversal of Roe v Wade.
But so what? The man is entitled to his opinions. Rather than jump on
him for expressing them, perhaps you should disseminate them as widely
as possible. I can't think of a much better way to rally the
opposition to Clipper.
Remember that the power to counter things like Clipper is already in
your hands. Don't let people like Parker just get you mad. Get even -
write code!

@_date: 1994-03-29 08:21:45
@_author: Phil Karn 
@_subject: Very funny, Polyanna :-( [namespace pollution] 
Isn't this really just a special case of the more general problem of
deciding which keys on a public key ring you're willing to trust?
Perhaps your mailer script should automatically encrypt only when a
keyid is found with a signature trail that you trust.
I do see a signature for that key from Miron Cuperman. Perhaps
you'd want to modify your trust parameters for him...

@_date: 1994-05-06 14:04:54
@_author: Phil Karn 
@_subject: Clipper on Science Friday 
Today's NPR Science Friday show was on Clipper. Flatow's gFrom owner-cypherpunks  Fri May  6 14:28:41 1994
Return-Path: Received: by toad.com id AA13801; Fri, 6 May 94 14:28:41 PDT
Received: from research.att.com (ninet.research.att.com) by toad.com id AA13790; Fri, 6 May 94 14:28:34 PDT
Received: by gryphon; Fri May  6 17:27:20 EDT 1994
Sender: owner-cypherpunks at toad.com
Precedence: bulk
I disagree with Perry, at least in the abstract.  The mbone is not
expensive, if no one is transmitting.  First of all, there's no bandwidth
reservation; if you're not sending anything, you don't consume anything.
Second, the bits are sent only to the networks used by the recipients;
a tree is constructed by the mbone routers based on IGMP (sic) packets
emitted by the participants.  So if IdiotS and IdiotD are having
an mbone session, no one else is likely to see any impact...
There are two exceptions:  the IGMP packets themselves, and the sd
announcements.  But those are both sent once per minute or less, so they're
not much of an issue.
For technical information, see Rich Stevens' book ``TCP/IP Illustrated'' has a good discussion of IGMP,
though I don't think he talks about mrouted, the mbone routing and
tunneling protocol.
Besides -- two of the important mbone tools, vat and wb, support
encryption.  What could be more ideal?
That said, an open party line is probably a bad idea.  The email load
is bad enough on cypherpunks -- there's a *lot* of noise -- without
having to listen to Cypherpunk Talk Radio (more likely Cypherpunk Shout
Radio...) all day.  But a semi-organized conference format, of a given
duration, might work.  It would be an interesting experiment to try.

@_date: 1994-05-11 14:32:44
@_author: Phil Karn 
@_subject: State Dept Response to my second CJ request 
What you said. Thanks for all the expressions of support.
At this point the best thing to do is to talk to all the lawyers who
know this stuff to decide what to do next. What may seem cut-and-dried
to us laymen usually isn't to a lawyer.
If you really want to contribute and can't wait, EFF already has a
cryptography defense fund. I've given to it myself, and suggest that
others do too.

@_date: 1994-05-11 18:34:49
@_author: Phil Karn 
@_subject: State Dept Response to my second CJ request 
Given that they already allowed the exact same information to be
exported in print form, there is the question of whether it is
constitutional to discriminate on the basis of the medium of
expression. In other words, this case comes pretty close to what
groups like EFF were originally created to protect.

@_date: 1994-05-12 10:02:17
@_author: Phil Karn 
@_subject: PGP 2.5 available from Electronic Frontier Foundation ftp site 
Read the ITARs. They're available by anonymous FTP from ftp.cygnus.com
as /pub/export/itar.in.full. There's a special section on exports to
Canada. Basically, most defense articles are exempt from ITAR export
licensing requirements to Canada; exceptions include things like
nuclear weapons components. However, there's apparently still a
reporting requirement, and I wonder how this applies to anonymous

@_date: 1994-05-12 13:42:42
@_author: Phil Karn 
@_subject: Encryption metaphor in Monty Python 
Recently I watched Monty Python and the Holy Grail again for the Nth
time. At the very end of the movie, as the police arrest King Arthur
and Sir Bedevere and break up the attack against the French castle,
one of the officers accosts a knight. Grabbing the knight's shield,
the officer says "Hey, that's an offensive weapon, that is!"
I'd say that pretty much sums up the government's attitude toward
cryptography, doesn't it? :-)

@_date: 1994-05-12 13:59:30
@_author: Phil Karn 
@_subject: NSA Chief Counsel in Wired, to appear on AOL 
Well, I guess we now know what our mission is as cypherpunks. :-)

@_date: 1994-05-12 14:22:02
@_author: Phil Karn 
@_subject: Case law re ITAR and export control 
See ITAR section 120.17 for the answers to both questions:
@ 120.17 -- Export.
   Export means:
   (1) Sending or taking a defense article out of the United States in any
manner, except by mere travel outside of the United States by a person whose                                                                       PAGE   19
                              58 FR 39280, *39285                                                                                                         FOCUS personal knowledge includes technical data; or
   (2) Transferring registration, control or ownership to a foreign person of
any aircraft, vessel, or satellite covered by the U.S. Munitions List, whether
in the United States or abroad; or
   (3) Disclosing (including oral or visual disclosure) or transferring in the
United States any defense article to an embassy, any agency or subdivision of a
foreign government (e.g., diplomatic missions); or
   (4) Disclosing (including oral or visual disclosure) or transferring
technical data to a foreign person, whether in the United States or abroad; or
   (5) Performing a defense service on behalf of, or for the benefit of, a
foreign person, whether in the United States or abroad.
   (6) A launch vehicle or payload shall not, by reason of the launching of such
vehicle, be considered an export for purposes of this subchapter. However, for
certain limited purposes (see @ 126.1 of this subchapter), the controls of this
subchapter may apply to any sale, transfer or proposal to sell or transfer
defense articles or defense services.

@_date: 1994-05-17 00:39:11
@_author: Phil Karn 
@_subject: Dr Dobbs "CD ROM" 
I hadn't heard about the CD ROM; thanks for the note.
It would seem that this may be another appropriate pair of subjects
for official State Department Commodity Jurisdiction requests. I could
certainly file them myself as I did for Applied Cryptography, but why
don't you do it? Anyone can file these requests, you don't have to be
a US citizen or resident of the US to do so. And all the information
you need is available by anonymous FTP from ftp.cygnus.com in
available there as a reference; feel free to plagairize.
It would certainly help to show State that not only is Applied
Cryptography just one of many similar items, but that I'm not the only
person who is concerned enough about the idiocy of the US export rules
to actually do something instead of just flaming on the net.
If you do this, please post copies of all correspondence here.

@_date: 1994-10-05 18:17:11
@_author: Phil Karn 
@_subject: It's MEME time!!! 
Uh, how come we can't stick to attacking the message, rather than the

@_date: 1994-10-05 22:16:24
@_author: Phil Karn 
@_subject: It's MEME time!!! 
I disagree. How do you react when you see an attack ad on TV. Does it
really want to make you vote for the sponsor? Or does it make you wish
they'd BOTH crawl off and die somewhere? After watching just a little
of the Huffington vs Feinstein Senate campaign here in CA, I know how
*I* feel.
We definitely have the upper hand on this issue. Dorothy Denning may
be a naive pawn of the government. She may hold beliefs that appall
the rest of us. She may have lost whatever credibility she had in the
crypto community by her position. But I still prefer to attack that
position and the (il)logic behind it rather than to resort to
attacking the person expressing it. Especially when the argument
itself is almost a no-brainer.

@_date: 1994-09-06 11:04:52
@_author: Phil Karn 
@_subject: How to find a primitive root of unity, for Diffe-Hellman? 
Maybe I can save you some trouble. Here is a "strong" 1024-bit prime
and generator that I've been using for Diffie Hellman key exchange to
set up keys for IP packet encryption. For a "strong" prime p, (p-1)/2 is also prime. This is thought to make
the discrete logarithm problem maximally hard. --Phil
Generator = 5
You're welcome to verify that this is indeed a strong prime; this should
be considerably faster than searching for one from scratch.

@_date: 1994-09-06 11:08:41
@_author: Phil Karn 
@_subject: How Did This Get Done? 
Another way that people often let themselves be caught is that they
inevitably send a test message to themselves right before the forged
message in question. This shows up clearly in the sending system's
sendmail logs. It's a point to consider with remailer chains too,
if you don't trust the last machine on the chain.

@_date: 1994-09-15 11:06:11
@_author: Phil Karn 
@_subject: RC4 Legal Issues 
This was my understanding *before* the recent jury decision in the
Microsoft vs Stac Electronics countersuit. When Stac sued Microsoft
for infringing their patents on disk compression, Microsoft
countersued Stac for trade secret infringement for having
reverse-engineered some hidden system calls in MS-DOS. Not only did
the jury uphold Stac's bogus software patent, but they also found in
favor of Microsoft on their ridiculous trade secret accusation!
Needless to say, this creates a very troubling precedent. Now you can
now apparently infringe a trade secret merely by examining fully
public information (e.g., commercially available object code.)

@_date: 1994-09-15 16:24:17
@_author: Phil Karn 
@_subject: RC4 compatibility testing 
FYI, there's a bill pending in the Senate that would change the term
of a US patent from 17 years from grant to 20 years from filing.  The
specific intent is to deal with "submarine" patents.
I understand it has already become quite controversial...

@_date: 1994-09-19 20:05:16
@_author: Phil Karn 
@_subject: [CyberCash Media hype] 
Perhaps the saying "security through obscurity doesn't work" should be
amended to say "security that depends on the secrecy of anything that
cannot be easily changed doesn't work".
In most cases, cryptographic keys are far more easily changed than
cryptographic algorithms. That's why it's bad to rely on the secrecy
of an algorithm, but okay to rely on the secrecy of a key.

@_date: 1994-09-19 22:45:12
@_author: Phil Karn 
@_subject: Copyright enforcement through crypto 
This job is pretty much unsolvable in the long run, because you have
to give all your secrets (algorithms and keys) to your "enemy". You
can slow him down a bit, but eventually he'll reverse engineer the
system -- especially if it runs on general purpose computer hardware.
It may be difficult, but it only needs to be done once because the
results can be quickly and widely disseminated in the underground.
Even without breaking the system per se, legitimate users will figure
out ways to copy its decrypted output and give it to their friends.
Why is this necessary? Many cable TV systems already carry
considerable amounts of copyright material despite having very weak
scrambling systems.  Even a strong system such as Videocipher II+,
which is based on the physical security of custom hardware, can still
have its output recorded and duplicated. Many cable companies openly
welcome VCR users -- they know it increases the appeal of the service.
What the photocopy machine started and the VCR moved into high gear,
the computer and the network will probably finish.  As John Perry
Barlow puts it, "Copyright is dead". It's not a matter of whether
copyright is morally right or wrong. It is simply going to become
utterly unenforceable -- like it or not. Instead of trying to patch it
we should find workable alternatives to replace its role in
compensating authors for their efforts.

@_date: 1994-09-20 16:31:38
@_author: Phil Karn 
@_subject: Laws Outside the U.S. 
Okay, how about the text of the French law regulating cryptography?
It's available as  It's
in French, and unfortunately my 3 years of high school study aren't up
to the task.  Anybody out there fluent in the language who would care
to prepare an English translation?
We really ought to know what the French law says, given that the US
government keeps citing it as precedent for a western country to
regulate cryptography.
By the way, the next time a pro-clipper person does this, point out
that our very own government has repeatedly accused French
intelligence of committing industrial espionage on behalf of its own
industries, and that there just might be a connection between these
two policies that the US is trying to emulate. At a CPSR/EFF meeting a
few years ago I succeeded in getting a real rise out of James
Kallstrom of the FBI with this comment. Great fun. But then again, he
*is* a rather excitable sort...

@_date: 1994-09-22 20:09:12
@_author: Phil Karn 
@_subject: National Research Council 
My thoughts exactly. The committee's classification/clearance policy
was undoubtedly intended to skew its membership much more than to
protect any legitimate government secret. After all, they're supposed
to be discussing openly available civilian encryption technologies.
Funny how the most obvious, no-brainer public policy questions always
seem to generate the most controversy...

@_date: 1994-09-26 21:10:02
@_author: Phil Karn 
@_subject: Letter from State Dept 
I received the following letter today from the State Dept. I filed my
appeal on June 7, 1994, and according to their own rules they're
supposed to respond in 30 days.
For background, see Philip R. Karn, Jr.
7431 Teasdale Avenue
San Diego, CA  92122
Dear Mr. Karn:
    I am writing with regard to your appeal of CJ Case 081-94,
concerning your "applied cryptography source code disk."
    As you undoubtedly realize, your appeal raises particularly
important and difficult issues.  We have met with your
attorney, Mr. Thomas J. Cooper, about the appeal, and have
consulted with him several times by telephone.  I wanted to
convey to you personally, as we have conveyed to him, the care
with which we are reviewing your appeal.  The review has
entailed widespread State Department and inter-agency
consultation.  To ensure that the various legal and policy
issues raised by your appeal are satisfactorily addressed, I
have found it necessary to extend the normal period for
consideration of such an appeal.
    The consideration of your appeal is now in its final
stages.  I appreciate the patience with this process that you
and your attorney have shown, and look forward to shortly
providing you with a response.

@_date: 1994-09-28 15:00:52
@_author: Phil Karn 
@_subject: 3DES 
This should probably be in a FAQ somewhere. As I understand it, the
intent is to build 3DES chips that can be backward compatible with
single DES by simply setting all three keys to the same
value. Naturally, nobody would be stupid enough to do single DES in
this way in a software implementation, but it doesn't really cost
anything extra when operating in 3DES mode either. DES decryption is
the same as encryption with a reversed key schedule, so the work
factor for both ciphering and attacking should be the same.
Question to the group: are there any precise standards for how 3DES
keys are specified?  Also, a 3DES verification suite similar to NIST's
suite for single DES would be very nice.

@_date: 1995-12-19 21:03:07
@_author: Phil Karn 
@_subject: New additions (12/18) for Karn vs State Dept 
I've just received, HTMLized and added two new documents to the web page
concerning my case against the State Dept. They are:
 (Joint Statement
of Facts Not In Dispute, 12/18/95) and
 (Reply
Memorandum In Further Support of Defendants' Motion to Dismiss, Or In
the Alternative, For Summary Judgment 12/18/95)
As before, the base URL for the case is
I'd like to thank the government's attorneys at the Department of
Justice for this time providing an electronic copy of their filing to
my attorneys. This made it easier for me to bring it to you on the
Last time I scanned in the government's documents on an OCR system,
the same one I used to scan in the 3DES code in Applied Cryptography
to demonstrate the process as part of my declaration.
However, I still had to convert the text files from WordPerfect to
ASCII and then HTMLize them by hand. If you find any formatting
errors, please let me know so I can fix them.

@_date: 1995-12-23 08:00:21
@_author: Phil Karn 
@_subject: More developments in Karn vs State Dept 
I have been updating my web page almost daily with developments
in my case. The latest is that we've written and asked the Court
to accept a Supplementary Memorandum opposing the government's
motion to toss out our suit, and I've backed it up with a Supplementary
Declaration. In it I explain how I just found all of the
source code at issue (the Applied Cryptography diskette) on a public
FTP site in Italy. This took about 10 minutes using Netscape.
I then downloaded the Triple DES code referenced in the earlier
Declarations by NSA Deputy Director Crowell and myself in 1.7
seconds, adding that this is somewhat less time that it takes me
to move to my computer, insert a floppy disk and return to the keyboard.
The government is now asking the judge not to accept these latest
filings. Stay tuned!
The URL again is

@_date: 1995-11-08 10:07:19
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
This is also my understanding, which I got from you in the first
place.  I take it there have been no dramatic breakthroughs in the
last few years in the discrete log problem? How heavily has it been
studied in comparison with factoring?
Yes, in theory once an attacker spends enough time precomputing a
table for a particular modulus he can then attack individual DH key
exchanges with ease. This seems entirely analogous to attacking
RSA. If you spend the time up front to factor my public RSA key, then
you can also easily attack individual messages to me.
So if I am willing to rely on a PGP key of, say, 1024 bits then I
should be equally willing to rely on a 1024-bit DH modulus.
Now there is admittedly a practical difference here -- people *can*
change their PGP RSA keys occasionally, though this is hard to do when
you have a lot of signatures.  And each user has his/her own PGP RSA
key, and cracking that gives you only the traffic to that user.  A
public DH modulus will be shared by many more people -- making it a
much more tempting target.
Still, requiring support of a fixed modulus for shared public use is
important to promote a basic level of interoperability. This has its
risks, but it should be okay *provided* it's a strong prime of
sufficient strength to preclude the precomputation of the discrete log
tables by even a highly motivated and resourceful attacker. And as a
backup the protocol should provide for the optional use of private
moduli between consenting parties. Sound reasonable?

@_date: 1995-11-08 10:07:27
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
Well, since we already require 56-bit DES in ESP in the interests of
promoting basic interoperability, wouldn't a 512-bit prime be
similarly sufficient?
Again, I'm *not* going to recommend that people use it, only provide it
for those who simply cannot use larger moduli for whatever reason (export
controls or CPU limits).

@_date: 1995-11-09 12:13:09
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
You've convinced me. I remove my proposal to include a recommended 512-bit
modulus. The smallest standard modulus will remain 1024-bits.

@_date: 1995-11-09 13:10:46
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
We already have a secondary 1024-bit modulus in the spec. The question is
whether the problem is better solved by allowing parties to use private
moduli rather than by filling up the spec with additional moduli. Remember
that the original reason for specifying a particular modulus as "required"
is to guarantee some minimum degree of interoperability, not to meet every
possible threat.

@_date: 1995-11-10 10:36:08
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
Hilarie suggested exactly this in private mail, and I've agreed. I'm
going to generate a 768-bit optional modulus.
Bill has also suggested a killer 4096-bit modulus for the truly
paranoid. Not sure my poor 32MB P90 can handle that without thrashing
its guts out, but I'll give it a try.

@_date: 1995-11-14 05:48:20
@_author: Phil Karn 
@_subject: Photuris Primality verification needed 
Thanks. That's pretty much what we are doing -- requiring a particular
1024-bit modulus but recommending several others as options. There's a
2048 bit optional modulus and may even be a 4096-bit option if I can
find one in reasonable time. There was going to be a 512-bit optional
modulus but the group has reacted so strongly to it that I'm willing to
withdraw it.

@_date: 1995-09-26 06:31:45
@_author: Phil Karn 
@_subject: Primality verification needed 
Hi. I've generated a 2047-bit "strong" prime number that I would like to
use with Diffie-Hellman key exchange. I assert that not only is this number
'p' prime, but so is (p-1)/2.
I've used the mpz_probab_prime() function in the Gnu Math Package (GMP) version
1.3.2 to test this number. This function uses the Miller-Rabin primality test.
However, to increase my confidence that this number really is a strong prime,
I'd like to ask others to confirm it with other tests. Here's the number in hex:
The generator, g, for this prime is 2.
Phil Karn

@_date: 1995-09-28 13:17:47
@_author: Phil Karn 
@_subject: Using sound cards to accelerate RSA? 
But most sound cards still don't have DSP chips. And modern general
purpose CPUs are beginning to give them such a good run for their money
that I wonder whether DSPs will ever become widespread.
I'd stick with running RSA on the main CPU for now.

@_date: 1996-03-26 10:57:18
@_author: Phil Karn 
@_subject: Bad news from Judge Richey 
Last Friday, Judge Richey issued a 36-page opinion dismissing my suit
against the State Dept.
I am waiting for a copy of the opinion, which should arrive in paper
form tomorrow. I'll post it on my web site when it's available in
electronic form. (
I'll be meeting my attorneys next Monday to plan an appeal strategy.

@_date: 1997-02-04 06:56:38
@_author: Phil Karn 
@_subject: PCS Encryption? 
Yup, I'm out here. Just buried under a pile of email.
No, it's not covered by NDA. It is, however, all heavily covered by
Qualcomm patents.  It's all specified in complete detail in TIA
IS-95A. The actual spec is copyrighted TIA (even though we did almost
all the work) but you can find an early version, plus a much more
readable overview paper, through my web page. The air interface is
essentially the same as you'll find on the air.
There is essentially no "encryption" in the usual sense of the word in
CDMA. It is true that the complexity (and until recently, the
obscurity) of the modulation method provides some modest protection
against casual eavesdropping (e.g., someone with a Radio Shack
scanner). But phones containing the necessary ASICs are now being
shipped by the hundreds of thousands per month, and as I said earlier
the complete air interface spec has been public for some time.
I do note that the forward (base to mobile) and reverse (mobile to
base) modulation methods are totally different, because the jobs they
have to do are different. Only the reverse link is truly CDMA, as
there you have many transmitters sending to a single receiver. Both
links are spread to 1.25 MHz bandwidths, but that's about where the
similarities end. The phone ASIC contains only a forward link
demodulator function and a reverse link modulator function. The base
station ASICs are not yet generally available. Also, an echo canceller
in the base station effectively blocks any reverse link audio from
coming back out on the forward link.
Consider also the very low and tightly controlled transmitter powers
typically used on the reverse link. One can now make certain
conclusions about the relative ease of intercepting the forward link
as compared to the reverse link.
The closest thing to "encryption" in CDMA is the "private long key"
mechanism. The private long key is the starting state of a 42-stage
linear feedback shift register (LFSR) that is used to spread (reverse
link) or scramble (forward link) the vocoder data. (The IS-95 signal
path is too complex to describe fully here -- see the documents on my
web page for the details, including the difference between scrambling
and spreading).
As anyone with even a rudimentary knowledge of cryptanalysis knows,
LFSRs are not at all cryptographically secure. The Massey-Berlekamp
algorithm can easily determine the state of the long code shift
register with a short (42-chip) sample of its output. Furthermore, the
long key sequence has other specified uses on the reverse link; in
particular it is used as a pseudorandom sequence generator to control
the puncturing (on-off transmitter gating pattern) when the phone is
transmitting at a low data rate between talk spurts. This obviously
suggests other ways to determine the LFSR state without demodulating
individual CDMA chips.
Nevertheless, NSA has repeatedly objected to the export of the
"private long code" feature, and I'm not even sure it's implemented on
the domestic models currently being deployed.

@_date: 1997-02-04 06:57:34
@_author: Phil Karn 
@_subject: PCS Encryption? 
Condor is, of course, a Fortezza (clipper) application, which makes it
less than useful to those outside the government. In fact, from what
I've heard even the potential government users are much more
interested in STU III support. I wonder why...

@_date: 1997-02-05 09:01:36
@_author: Phil Karn 
@_subject: Ireland: Bid To Ban "Tamper Proof" Phones 
Thanks for the info about the origins of the European GAK
initiative. It would still be interesting to know how much of a hand
the US has had (and continues to have) in influencing the crypto
policies of other countries.
Thanks also for the correction regarding divorce in Ireland.  My
sincere apologies if I offended anybody over there with my "socially
backward" comment.  Ireland is by no means unique even among western
nations in having certain restrictive laws and practices regarding
private social behavior. In general the US is not much better, and
parts (especially the southeast) are probably worse.
It is interesting that you would mention political terrorism and drug
smuggling as prime factors pushing towards GAK in Ireland. The forces
at work in the US government push towards GAK are quite similar.  I am
fond of saying that "national security" and "drugs" have become the
root passwords to the US Constitution...
Question: have there been any problems with the use of strong
encryption (PGP, SSH, etc) on the Internet in Ireland? Is it widely
used over there?

@_date: 1997-01-28 13:09:42
@_author: Phil Karn 
@_subject: [DES] DES Key Recovery Project, Progress Report #7 
And lacking that, the author can always print it out on paper and
physically mail it out of the country; this is specifically allowed by
the new Commerce rules as I understand them. And who's to say that the
overseas FTP copies weren't scanned from such a paper copy? :-)

@_date: 1997-01-28 18:58:56
@_author: Phil Karn 
@_subject: Machine readable form (was:RE: [DES] DES Key Recovery Project, Progress Report #7) 
Read the following text from the introduction to the new December 30,
1996 regulations:
This seems clear enough. If it's printed on paper, it's kosher for
export. But if we're really overt about it, we may goad the government
into attempting to control printed source code as well. That could
prove most interesting.

@_date: 1997-01-29 16:55:51
@_author: Phil Karn 
@_subject: Machine readable form (was:RE: [DES] DES Key Recovery Project, Progress Report #7) 
I think you're being far too subtle here. The issues have been clearly
drawn in my case. The government is also now officially on record as
reserving the authority to regulate the exports of even paper copies
of cryptographic source code (e.g., books). They have simply chosen
not to do so for now out of the goodness of their hearts. Or, more
likely, because even they understand the furor this would cause, and the
damage it would do to their position in court.

@_date: 1997-06-13 00:32:38
@_author: Phil Karn 
@_subject: Feds have lost battle against encryption 
The really ironic issue of late has been supercomputer exports. We now
have the spectacle of William Reinsch saying that export restrictions
on supercomputer *hardware* are unworkable because the technology is
available all around the world.
This is the very same Commerce official who still says with a straight
face that export controls on encryption *software* are workable and
And we have the chairman of the House Judiciary Committee, the same
committee that recently approved the SAFE act to deregulate crypto
exports, calling for an investigation into Commerce's approval of
recent supercomputer exports to China.
Yet I presume nobody minds that we can ship as many Pentiums as we
want to China.
Somebody really needs to say the words "distributed computing" to
Congress. Perhaps that will be the major benefit of the DES Challenge
project when (not if) it succeeds.

@_date: 1998-04-21 15:08:52
@_author: Phil Karn 
@_subject: Position escrow 
This is a really difficult issue. Even the most diehard cypherpunk
cannot doubt the usefulness of a cellular position reporting
capability in an emergency situation, when the user *wants* the cops
or whoever to know where he is.  The big problem is how to keep it
from being used (or abused) for "law enforcement" purposes without the
consent of the user.
The main reason GPS receivers are not being used is simple economics:
as small and cheap as they're getting, they're still too big and
expensive for a cell phone. It's not just the electronics, but the
antenna too. And they don't work too well indoors.  So the
manufacturers are developing ways to locate the phone using complexity
in the base station, where it can be shared. Various time-of-arrival
schemes are being proposed. CDMA has an inherent capability because
it (like GPS) uses spread spectrum, although there are near-far
problems to be solved.
I expect the main countermeasure to cellular position tracking will be
the use of one-way pagers. Keep your cell phone turned off, and if you
get a page when you're someplace you don't want them to know, wait
until you leave before you return the page.
Perhaps if the "just turn it off" approach is widely promoted, the
carriers and vendors will see the threat to their business and press
for some safeguards. Otherwise they just won't give a damn.

@_date: 1998-04-21 18:16:55
@_author: Phil Karn 
@_subject: Position escrow 
Well, given that I work in CDMA, and given that CDMA provides some
inherent positioning capabilities, the possibility of defeating
positioning by hacking the phone software to "dither" the return link
signal timing has occurred to me.  It wouldn't let you appear to be in
a different cell than the one you're in, but it would certainly
decrease the measurement precision. You could disable the dither if
you want when you make an E911 call.
What sweet revenge that would be against the government that inflicted
Selective Availability on all us civilian GPS users. :-)

@_date: 1998-04-21 18:54:01
@_author: Phil Karn 
@_subject: Position escrow 
I think you guys are worried about the wrong problem.
The E911 stuff is still years off. Even when it is deployed, it will
probably work only during a call, though this may depend on the exact
In my opinion, idle cell registrations -- which are already standard
cellular system practice -- represent the far more serious privacy
The cellular network uses registrations to locate mobiles so that page
(incoming call) messages can be directed to the user's cell instead of
being inefficiently "flooded" over the entire network. (I note that
each AMPS paging channel is 10 kb/s while the usual one-way paging
system operates in flood mode at something like .5 - 2 kb/s. But
cellular phone calls have to go through in seconds, while pager
messages often take minutes.)
While these registrations are not quite as precise as the E911
locating stuff under discussion, they can be precise enough. They'll
locate you to a given cell and sector, to say nothing of a given city.
In many heavily populated places, cells are pretty small.  And most
importantly, registrations occur whenever the phone is on -- whether
or not it's in a call. Even the most heavily used phones probably
spend most of their time idle, and many less heavily used phones are
probably idle for days at a time.
While it would seem that a cellular carrier would have no reason to
log these messages, many do. The main reasons, as I understand them,
have to do with resolving roamer billing disputes and detecting
cloning fraud. The FBI is already slobbering all over these registration logs and has
been battling the CTIA to get them under CALEA -- even though Louie
Freeh specifically disclaimed an interest in them during the
Congressional hearings on CALEA.  So far the CTIA has resisted. But
knowing them, the problem is almost certainly about money and not
anything as inconsequential as personal privacy.

@_date: 1998-04-22 10:28:44
@_author: Phil Karn 
@_subject: Position escrow (triangulation, cell "remailers") 
Yes, but it was a very time-consuming manual process. *Any* radio
signal can be located in this way. As a sport, radio hams have long
conducted "fox hunts", aka "hidden transmitter hunts", where somebody
hides with a transmitter and the rest try to find him. Mitnick was
found with classic ham-style fox-hunting techniques. His level of
activity was so high that he made it relatively easy.
Nothing really can thwart this method, other than never using your
phone.  Its saving grace for our purposes is that it is so labor
intensive that it cannot be done routinely.
Almost. In CDMA, the mobile station locks its timing to the base
station.  This lets the base station easily measure the round trip
time through the mobile and back and thereby the radial distance. With
just one base station, you can locate the user to a circle around the
base station.  Defeating this is what I had in mind yesterday when I
talked about dithering the mobile timebase a la Selective
Somebody then pointed out in private email that dithering wouldn't
defeat a differential timing measurement made by two or more base
stations. This is true, but these measurements are easily made only
when the mobile is in soft handoff (talking to two base stations at
once).  In CDMA, as in other digital cellular systems, handoffs are
"mobile assisted".  That is, the base station relies on "pilot
strength measurement" reports from the mobile as to which neighboring
cells it can hear so handoffs can be set up. If you hack the phone
software to lie about these measurements, you can keep handoffs from
being set up.  Your service quality will definitely suffer, especially
in the border regions between adjacent cells, but you will make it
much harder (but still not impossible) for them to locate you.
In analog, handoffs during calls are performed entirely by special
scanners in each base station. The mobiles do not assist the
process. Having only one receiver channel, they cannot look for
adjacent base stations while in a call.  CDMA receivers can do this
because they have a "searcher" channel whose sole function is to look
for pilot energy from any base station in range. While it would still
be possible for CDMA base stations to cooperate as analog stations now
do in locating an "uncooperative" mobile, this is not something that
could be done routinely. There are also near-far considerations
because every cell transmits on the same forward channel and every
mobile transmits on the same reverse channel, and tight power control
is used on both links to minimize co-channel interference.

@_date: 1998-04-22 10:33:48
@_author: Phil Karn 
@_subject: Position escrow (triangulation, cell "remailers") 
Exactly. And I think this brings the remailing concept full
circle. Wasn't the basic idea invented for telephones way back in
(alcohol) Prohibition days? As I recall, a device called a "cheesebox"
connected two phone lines. When a call came in on one line, it went
back out on the other. You'd place a cheesebox in some third party's
back room, e.g., a restaurant owner who was paid for the privilege and
to keep his mouth shut. If the cops traced a call, it would lead them
to the restaurant owner, who would tip off the bootleggers.
Does anyone have any historical references for these things? I think it
would be fun to see how an earlier age made use of anonymous remailers
based on a much simpler technology.

@_date: 1998-04-22 13:49:37
@_author: Phil Karn 
@_subject: Position escrow 
Very true.
There's already a way to do this: cloning. This is not always done
just to avoid paying for service.  Certain cloners are entirely able
and willing to pay for cellular service, but they demand anonymity.
Somebody should point out to the carriers that they could get rid of
much of the incentive to clone phones if they simply offered a
legit way to remain anonymous.
