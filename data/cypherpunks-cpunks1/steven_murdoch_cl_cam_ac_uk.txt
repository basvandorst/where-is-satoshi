
@_date: 2005-10-11 23:26:10
@_author: Steven J. Murdoch 
@_subject: Software from "Low-Cost Traffic Analysis of Tor" 
Some of you might have read the paper "Low-Cost Traffic analysis of
Tor"[1], by myself and George Danezis. I have now released the code I used
to run these experiments, in case it will help any future research.
For more information, and to download the code, see:
 If you have any comments, suggestions or questions, please let me
Steven Murdoch.
[1] w: Eugen* Leitl leitl
ICBM: 48.07100, 11.36820            8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE
[demime 1.01d removed an attachment of type application/pgp-signature which had a name of signature.asc]

@_date: 2005-09-29 00:27:51
@_author: Steven J. Murdoch 
@_subject: Hello directly from Jimbo at Wikipedia 
This would be very difficult to do using the existing Tor design as it
doesn't know anything about users or sessions. It lives at the TCP
layer and all it does is shift packets from one IP address to another,
giving some privacy to both ends. Adding higher layer functionality to
Tor increases the chance that it will do neither job well, so here is
a proposal which I think does what you want, but avoids this problem.
The goal is to increase the cost for a Tor user to commit abuse on
Wikipedia. It doesn't need to be full-proof, but just enough to make
them go elsewhere. Wikipedia could require Tor users to log in before
making edits, and ban accounts if they do something bad. However the
cost of creating new accounts is not very high. The goal of this
proposal is to impose a cost on creating accounts which can be used
though Tor. Non-Tor access works as normal and the cost can be small,
just enough to reduce the incentive of abuse.
Suppose Wikipedia allowed Tor users to only read articles and create
accounts, but not able to change anything. The Tor user then goes to a
different website, call it the "puzzle server". Here the Tor user does
some work, perhaps does a hashcash computation[1] or solves a
CAPTCHA[2], then enters the solution along with their new Wikipedia
username. The puzzle server (which may be run by Wikipedia or Tor
volunteers), records the fact that someone has solved a puzzle along
with the username entered. The puzzle server doesn't need the
Wikipedia password as there is no reason for someone to do work for
another person's account.
Now when that Tor user logs into their Wikipedia account to edit
something, the Wikipedia server asks the puzzle server whether this
account has ever solved a puzzle. If it has, the user can make the
edit, if not then the user is told to go to the puzzle server first.
This check can be very simple - just an HTTP request to the
puzzle server specifying the Wikipedia username, which returns "yes"
vs "no", or "200" vs "403". For performance reasons this can be
cached locally. There is no cryptography here, and I don't think it is
needed, but it can be added without much difficulty.
If the Tor user starts committing abuse, his account is cancelled. The
puzzle server doesn't need to be told about this, as Wikipedia will
not let that user make any edits. The reason this approach avoids the
usual problems with proof-of-work schemes[3] is that good Tor users
only have to solve the puzzle once, just after they create the
account. Bad Tor users will need to solve another puzzle every time
they are caught and had their account cancelled.
So my question to Jimbo is: what type of puzzle do you think would be
enough to reduce abuse through Tor to a manageable level? The
difficulty of the puzzle can be tuned over time but what would be
necessary for Wikipedia to try this out?
Hope this helps,
Steven Murdoch.
[1] [2] [3] "Proof-of-Work" Proves Not to Work by Ben Laurie and Richard
     Clayton: w: Eugen* Leitl leitl
ICBM: 48.07100, 11.36820            8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE
[demime 1.01d removed an attachment of type application/pgp-signature which had a name of signature.asc]

@_date: 2007-05-28 11:00:48
@_author: Steven Murdoch 
@_subject: Sampled Traffic Analysis by Internet-Exchange-Level Adversaries 
Some of you might remember my email to this list in February, where I
asked for help from operators of Tor nodes in the UK [1]. This was for
an experiment to establish how diverse the topology of the Tor network
is -- an important component of how secure it is against traffic
analysis. Thanks to all those who responded to my request; I had a
great response and very interesting results.
I've now finished the draft version of the resulting paper, which is
to be presented at the PET Workshop (Ottawa, Canada, June 20--22 2007)
[2]. The latest version of the paper can be found at this URL:
 There is also an introduction to the area, and a summary of the paper
on my research group's blog "Light Blue Touchpaper":
 My paper, co-authored with Piotr Zielinksi, is a follow-up to Nick
Feamster and Roger Dingledine's paper, "Location Diversity in
Anonymity Networks" [3]. In it, they point out that bouncing anonymity
network traffic around lots of countries might not be as good as it
seems because there are a small number of ISPs which show up on many
of the links to, from and between Tor nodes.
What our paper explores is that even if you deal with this problem,
and choose paths with a diverse collection of ISPs, there are still
Internet exchanges on many of the paths. These do not appear in the
BGP data that Feamster and Dingledine use, which is why I had to
resort to a more limited-scale traceroute-based study.
So not only are Internet Exchanges good places to put traffic analysis
equipment, but some (including LINX [4] and AMS-IX [5]) collect the
necessary data anyway, for performance measurement purposes. They only
record the headers of one in every few thousand packets, but our paper
also shows that, even with such low-quality data, traffic analysis
still works.
There's certainly no reason to panic about these results, as there is
still much more work to be done in this area. For example, the picture
in the US, where Internet exchanges are less popular, will likely be
different. I do hope that the paper will encourage future work on both
establishing more accurate estimates of attack costs and developing
[1] [2] [3] [4] [5]

@_date: 2007-05-28 12:03:10
@_author: Steven Murdoch 
@_subject: Sampled Traffic Analysis by Internet-Exchange-Level Adversaries 
The convention in anonymity research is to assume a global passive
adversary, since then any system shown to be secure under that model
is probably secure in the real world. The problem with this approach
is it eliminates all practical low-latency designs, hence the weaker
threat model adopted by Tor.
I do think that a global passive adversary is stronger than the real
world situation. For example, such an adversary could read traffic
between two computers in my office, which I suspect is outside of the
NSA's capabilities, unless I were targeted for special attention.
The actual capabilities will probably lie somewhere between the two
extremes. Sometimes your connections through Tor will go via enough
monitored nodes to be tracked, sometimes they won't. The interesting
question is the relative proportion between the two quantities, and
how to change it for the better.
I had thought about that aspect, but given the shortage of space
didn't include it. Perhaps I should for the final version. Traceroute
gives a more accurate picture of topology the BGP data (in that it
shows up IXes), but it is still not "true". For example, it only discovers devices which reduce the IP TTL, and so
will not find MPLS links or long-haul layer-2 VLANs. Then, as you
point out, it could be that seemingly disparate traffic is going
through the same cable-tunnel, if not the same fibre.
The point behind that section was to dispel the myth that traffic
analysis is easy, because you can just run tcpdump on off-the-shelf
hardware. Actually, on high-speed links it requires serious
engineering effort to even capture the data, let alone store it. That
said, there is demand for such capabilities and given enough hardware
it is possible.

@_date: 2008-01-30 00:52:18
@_author: Steven J. Murdoch 
@_subject: New Tor distribution for testing: Tor Browser Bundle 
Recently I have been working on creating a distribution of Tor which
includes a pre-configured browser -- the Tor Browser Bundle. It is
intended for being run off an USB flash drive, but will probably also
be helpful to users who want an easy-to-setup packaging of Tor.
More information and download links can be found here:
 The bundle contains Firefox, Tor, Vidalia, Polipo and Torbutton. No
installation is needed (just unpack the contents). All the components
are automatically started by one double-click.
The bundle is new, and contains development versions of Tor, Vidalia
and Torbutton, so should be considered a testing release. I do hope it
will be useful, and I'd appreciate comments, suggestions, and bug
