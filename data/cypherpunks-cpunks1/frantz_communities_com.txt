
@_date: 1997-06-14 03:21:30
@_author: Bill Frantz 
@_subject: Spam Libs (Frauenfelder on HotWired) 
Forwarded-by: Chip Morningstar Forwarded-by: Peter Langston Forwarded-by: Keith Bostic Forwarded-by: Jeff Moore This comes from HotWired's `packet' site, at:
    Spam Libs
Bulk email spawns ingenious offensives from the masses
Do you remember Droodles? They're those simple line drawings that look
like nonsense until you read the captions. Droodles were invented in the
'60s by a humorist named Roger Price, an author probably best known for
his stinging critique of American society, The Great Roob Revolution. I
was lucky enough to get to know Roger before he died in 1990. He had lots
of great comics, books, and original art (from people like MAD Magazine
creator Harvey Kurtzman) lying around his Studio City, California, home.
Beside Droodles, Roger also invented Mad Libs. You might remember these,
too. Mad Libs were little books with stories in them. But the stories had
several missing words, with instructions to insert verbs, nouns, and
adjectives in the blank spaces.  The game was played at parties, where
one person asked the others to supply the missing words. Then the story
was read out loud and everybody laughed heartily at the result.  (There
are dozens of Mad Lib knockoffs on the Web.)
Because spammers work their cons anonymously, hiding behind forged email
addresses and working out of PO boxes, our imaginations can run wild about
what they look like. My fantasy spammer is a rat-skinny, potbellied,
40-year-old with a greasy salt-and-pepper ponytail and beard.  And he's
rat-smart: After being spammed with get-rich-on-the-Net messages, he
bought the lists containing millions of email addresses, and he bought
the DIY spam software, and now he's in business for himself, working from
the spare bedroom of his mother's house in a Las Vegas suburb.  I'm
grateful to Roger and his Mad Libs for helping me come up with a fun spam
prank. It all started a couple of weeks ago when I received the following:
I copied this stupid message into my word processor, and using the
search-and-replace function, swapped every occurrence of the word "water"
with "urine," then sent the result to the Water Lady:
In a couple of hours, I got the following reply:
Heh - it sure was. Pleased with myself, I sent the mutated mail to my
friends. They got in on the action, respamming the Mad-Libbed message back
to The Urine Lady. Someone even posted the message on
alt.sex.fetish.watersports, with the subject "GOLDEN BOTTLES!" The post
was forged to look as though it were sent by The Urine Lady herself.
That same day, I got a spam trying to sell me a copy of Floodgate
software, a notorious spamming program. I copied the spam to my word
processor and did a few swaps. I changed "Floodgate" to "The Pig Spittle
Drinkers' Toolkit," "email" to "slobber bottle," "program" to
"pig-drool-extraction device," and "software" to "salivary-gland
stimulator." Here's what I sent back to the spammer:
Soon, my friends and I were mutating and resending almost every spam we
got. Most of the spammers wrote back saying they were mystified and
expressed dismay that anyone would want to hurt their wonderful home-based
business, apologized profusely, and promised that they'd get to the bottom
of the nefarious campaign to defame their good name.
This was our intent: to make them think that someone had intercepted their
spam and was ruining their good name with wacko faux-spam. Only once did
the spammer retaliate by flaming the messenger. Here's the original spam
that a friend received:
Here is his reply to the spammer:
The spammer sent 61 identical emails to my friend, which read:
(My friend said it took him "all of 30 seconds" to save the messages in
a folder.)
If you want to play the Mad Lib Mutated Spam game, here are some tips.
(Remember, some of this stuff might get you in trouble with the long
tentacle of the law, so proceed at your own risk.)
1. Usually, spams do not contain valid email addresses. But there are a
   couple of ways to get a real address. First, you can look up the
   spammer's domain name on InterNIC's Whois database. That'll yield a
   couple of email address you can use.  The other way is to visit the
   spammer's Web site, which is often listed in the spam. If it isn't,
   just try typing the spammer's domain into your Web browser, and see if
   anything pops up. As a last resort, you can fax or snailmail your
   mutated message to the spammer, as they usually list their phone number
   and mailing address in their desperate quest to get their sebum-coated
   hands on your money.
2. If you have an AOL account, create a special email address (you are
   allowed up to five different addresses per account). I send most of my
   Mad-Libbed spams through an AOL address used exclusively for
   antispamming.  That way, if the spammer flips out and decides to mail
   bomb you or forge your name on obscene Usenet postings, it won't
   matter. This also works with Web-based anonymous email services like
   HotMail.
3. If you're technically adept, you might want to try "linking two
   spammers to each other," as another friend suggests. By "sending
   mutated mail to other spammers," says my Mad Lib buddy, "maybe they
   will start suspecting each other of mutual spam mutating, and spamming
   will enter a new era of conspiracy and distrust."
If you get any especially good results from playing Mad Lib Mutated Spam,
please tell me about it!
[Mark Frauenfelder]
Send mail to Mark Frauenfelder at mark at wired.com
Illustration by Dave Plunkert
[to webmonkey]
[to netsurf central]

@_date: 1997-05-06 01:24:04
@_author: Bill Frantz 
@_subject: Fast Cheap Unreviewed Stream Cipher 
I received this code from another friend.
Here's a FAST somewhat cryptographically secure pseudo-random generator
written by a friend of mine that wishes to remain anonymous.  He has given
permission for the following code to be placed in the public domain, and to
be sent to cypherpunks and others for review.  Alas, I have never gotten
around to doing so.  As it states, on a PowerPC it'll produce bits fast
enough to be a pseudo-one-time pad / stream cipher for good digitized video
on a LAN (the purpose for which he originally sent it to me) and hence
should do point-to-point audio without even breathing hard.
For those who haven't heard, the scenario is for point-to-point audio to
use an affordable (weak) stream cipher, but to be changing keys frequently
using our strongly secure SSL channel.  Each costly break would only
compromise a few seconds or so of audio.  The following code may serve as
the affordable (but maybe better than weak) stream cipher.
     WORD_SIZE 32
unsigned long shiftRand();
static void refillShiftRand();
void seedShiftRand(unsigned long seed);
static unsigned long shiftRandArray[31] = { };            // to hold
internal state values
static unsigned long * arrayPtr = shiftRandArray;         // incremented as
state values are consumed
static unsigned long * const end = shiftRandArray + 31;   // marks end (and
need to refill array)
and the system rand function,
by xoring with high bits from other
resulting values are themselves obscured,
seed acts as a key.
void seedShiftRand(unsigned long seed) {
        srand(seed);
        long cyclesPerWord = ((WORD_SIZE + 7) >> 3) - 1; // will add a net
of 8 bits per call to rand
        unsigned long * arrPtr        = shiftRandArray;
        for (; arrPtr < end; arrPtr++) {
                unsigned long rand1 = rand();                // wrap this
value around word boundary:
                unsigned long element = (rand1 >> 8) | (rand1 << (WORD_SIZE
- 8));
                for (long i = 0; i < cyclesPerWord; i++) {
                        element ^= rand() << (8 * i);            //previous
8 high bits obscure 8 new low bits
                }
                *arrPtr = element;
        }
shift register (with moving taps
Higher-order bits have similar
xoring with a sequence
width of the word.
Applied Cryptography has
directly. This code avoids a
Numerical Recipes.
static void refillShiftRand() {
        unsigned long  * tap0  = shiftRandArray + 0;
        unsigned long  * tap13 = shiftRandArray + 13;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13 = shiftRandArray;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;   tap0++; tap13++;
        *tap0 = *tap0 + *tap13;
        return;
instruction-scheduling "optimization" is OFF.
static void refillShiftRand() {
        unsigned long  * tap0a  = shiftRandArray + 0;
        unsigned long  * tap0b  = shiftRandArray + 1;  // uses more registers
        unsigned long  * tap13a = shiftRandArray + 13;
        unsigned long  * tap13b = shiftRandArray + 14;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a =  shiftRandArray;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b = (shiftRandArray +
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;   tap0b += 2; tap13b += 2;
        *tap0a = *tap0a + *tap13a;   tap0a += 2; tap13a += 2;
        *tap0b = *tap0b + *tap13b;
        *tap0a = *tap0a + *tap13a;
        return;
mechanism for producing
but based on a large number of
on all bits of the same or
show strong correlations,
(The all-zero state
for this.)  Correlations
elements are eliminated
squaring operation
number of array element states,
inline unsigned long shiftRand() {
        ((arrayPtr == end) ?                     // '?:' instead of 'if' to
enable inlining by CW compiler
                  (refillShiftRand(),
                   arrayPtr = shiftRandArray,
                   0) : 0);
        unsigned long output = *arrayPtr++;
        unsigned long square = output * output;  // this multiplication
seems free on a 605
        return(square + (output >> (WORD_SIZE / 2)));
optimizations, 16.5 clocks per word.
void main () {
        SIOUXSettings.asktosaveonclose = FALSE;
        unsigned long sum = 0;
        seedShiftRand(12345);                    // easily guessed seed
        long start = clock();
        for (long i = 0; i < 2000000; i++) {
                sum += shiftRand();
                sum += shiftRand();
                sum += shiftRand();
                sum += shiftRand();
                sum += shiftRand();
        }
        unsigned long end = clock();
        printf("\n sum = %u", sum);
        printf("\n\n time = %d \n", (int)(1000.0 * ((float)(end - start) /

@_date: 1997-11-15 03:12:34
@_author: Bill Frantz 
@_subject: Humor? - WARRANTY CARD ON PURCHASED GOVERNMENT OFFICIAL[tm] 
WARRANTY CARD ON PURCHASED GOVERNMENT OFFICIAL[tm]
Dear Special Interest,
Congratulations on the purchase of your genuine Government Official[tm].
With regular maintenance your Government Official[tm] should provide you
with a lifetime of sweetheart deals, insider information, preferential
legislation and other fine services.
Before you begin using your product, we would appreciate it if you would
take the time to fill out this customer service card. This information will
not be sold to any other party, and will be used solely to aid us in better
fulfilling your future needs in political influence.
1. Which of our fine products did you buy?
__ President
__ Vice-President
__ Senator
__ Congressman
__ Governor
__ Cabinet Secretary - Commerce
__ Cabinet Secretary - Other_____________
__ Other Elected Official (please specify)______________
__ Other Appointed Official (please specify)_____________
2. How did you hear about your Government Official[tm]?
Please check all that apply.
__ TV ad.
__ Magazine / newspaper ad.
__ Shared jail cell with.
__ Former law partner of.
__ Unindicted co-conspirator with.
__ Arkansas crony of.
__ Procured for.
__ Related to.
__ Recommended by lobbyist.
__ Recommended by organized crime figure.
__ Frequently mentioned in conspiracy theories. (On Internet.)
__ Frequently mentioned in conspiracy theories. (Elsewhere.)
__ Spoke at fundraiser at my temple.
__ Solicited bribe from me.
__ Attempted to seduce me.
3. How do you expect to use your Government Official[tm]?
(Please check all that apply.)
__ Obtain lucrative government contracts.
__ Have my prejudices turned into law.
__ Obtain diplomatic concessions.
__ Obtain trade concessions.
__ Have embargo lifted from own nation / ally.
__ Have embargo imposed on enemy / rival nation / religious infidels.
__ Obtain patronage job for self / spouse / mistress.
__ Forestall military action against self / allies.
__ Instigate military action against internal enemies / aggressors /
      targets for future conquest.
__ Impede criminal / civil investigation of self / associates / spouse.
__ Obtain pardon for self / associates / spouse.
__ Inflict punitive legislation on class enemies / rivals / hated ethnic
      groups.
__ Inflict punitive regulation on business competitors / environmental
   exploiters / capitalist pigs.
4. What factors influenced your purchase?
(Please check all that apply.)
__ Performance of currently owned model.
__ Reputation.
__ Price.
__ Appearance.
__ Party affiliation.
__ Professed beliefs of Government Official[tm].
__ Actual beliefs of Government Official[tm].
__ Orders from boss / superior officer / foreign government.
__ Blackmail.
__ Celebrity endorsement.
5. Is this product intended as a replacement for a currently owned
Government Official[tm]? ______
If you answered "yes," please indicate your reason(s) for changing
__ Excessive operating / maintenance costs.
__ Needs have grown beyond capacity of current model.
__ Defect in current model:
__ Dead.
__ Senile.
__ Indicted.
__ Convicted.
__ Resigned in disgrace.
__ Switched parties / beliefs.
__ Outbribed by competing interest.
Thank you for your valuable time.
Always remember: in choosing a Government Official[tm] you have
chosen the best politician that money can buy.
[The joke appeared on a mailing list. No attribution.]

@_date: 1997-09-06 02:05:27
@_author: Bill Frantz 
@_subject: Key Recovery is Bad for US Security 
Here is a copy of an email I sent to the senior senator from California
this morning.
Senator Feinstein:
I am extremely disturbed to read your comments in favor of mandatory "key
recovery".  Besides being a disaster for American software companies, and a
clear violation of the constitution's protections of freedom of speech,
these systems are harmful to the security of the United States.
All cryptographic systems are extremely difficult to get right.  The SSL
protocol developed by Netscape Inc., which doesn't provide for "key
recovery", went through three versions before the major problems were
removed.  "Key recovery" systems are, as Professor Dorothy Denning
testified, much more complex than similar systems which do not include that
feature.  In fact, the key recovery system built into Clipper, with the
advice of the National Security Agency, had flaws as documented by Matt
Blaze of AT&T Bell Laboratories.  If the best cryptographic group in the
world can't get it right, how can we expect these systems to be secure.
What do we risk with insecure systems?  We risk compromising the legitimate
secrets of non-classified government agencies, including IRS records;
United States companies, including delicate international negotiations; and
individual Americans, including their medical records.  Even worse, if some
group should decide to launch an information war attack on the United
States, these flaws may allow them to access sensitive systems in the
finance, transportation, and energy sectors.  One simple way this attack
could occur is if the access codes are distributed using a flawed
encryption system.
I hope you will reconsider your stand on this issue.
William S. Frantz
16345 Englewood Ave.
Los Gatos, Ca 95032
Capability Security Architect - Electric Communities
Bill Frantz                                  Electric Communities
Capability Security Guru                     10101 De Anza Blvd.
frantz at communities.com                       Cupertino, CA 95014
408/342-9576
