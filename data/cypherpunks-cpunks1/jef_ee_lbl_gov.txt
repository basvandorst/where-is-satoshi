
@_date: 1993-12-26 10:40:19
@_author: Jef Poskanzer 
@_subject: Random numbers and "dirty" books 
Use of buzzwords can often be an inpediment to understanding.  When
the first-digit distribition thing came up in Martin Gardner's
column in Scientific American, "chaos" and "fractals" hadn't become
popularized yet, so he was reduced to actually figuring out what
was going on instead of giving it a mysterious and sexy-sounding label.

@_date: 1993-11-09 09:33:11
@_author: Jef Poskanzer 
@_subject: CRYPTO DATA warning sign 
I posted this to alt.hackers last Thursday, and I just joined cypherpunks
yesterday, so I don't know whether someone copied it to the list in the
intervening days.  If so, sorry for the duplication.  If not...
This is a warning sign in the style of the diamond-shaped ones that the
Department of Transportation requires on the back of vehicles carrying
hazardous loads.  It will look pretty butch on your read bumper.  I suggest
printing it onto sticker paper and then overspraying with clear acrylic
or polyurethane for weatherproofing.
%! dot_crypto.ps - draw a DOT cryptographic data warning symbol
% Copyright (C) 1989, 1993 by Jef Poskanzer .
% Permission to use, copy, modify, and distribute this software and its
% documentation for any purpose and without fee is hereby granted, provided
% that the above copyright notice appear in all copies and that both that
% copyright notice and this permission notice appear in supporting
% documentation.  This software is provided "as is" without express or
% implied warranty.
    dup stringwidth pop
    2 div neg  0  rmoveto
    show
} def
% Disk - actual size, centered at 0,0.
    newpath
    closepath
    closepath
    closepath
} def
    % Save args.
    /disk_line4 exch def
    /disk_line3 exch def
    /disk_line2 exch def
    /disk_line1 exch def
    % First draw drop-shadow.
    black
    gsave
    grestore
    % Fill with white.
    white
    disk_outline
    fill
    % Draw outline.
    disk_lw setlinewidth
    black
    disk_outline
    stroke
    % Label area.
    newpath
    stroke
    % Label lines and text.
    gsave
    grestore
    % Slide area.
    newpath
    stroke
    % Slide.
    newpath
    stroke
    % Slide hole.
    newpath
    closepath  stroke
} def
% DOT diamond - size 1, centered at 0,0.
    newpath
    closepath
} def
    gsave
    grestore
    newpath
    stroke
    0 setlinewidth
    gsave
    grestore
} def
    % Outer border.
    DOT_lw setlinewidth
    black
    newpath
    closepath  stroke
    % Fill inner area with 1's and 0's.
    gsave
    grestore
    % Inner border.
    DOT_inner_outline
    stroke
    % Disk.
    gsave
    grestore
    % "CRYPTO DATA".
    /Helvetica-Bold findfont DOT_fontsize scalefont setfont
    0 DOT_wordoffset DOT_fontsize 0.4 mul sub moveto
    (CRYPTO DATA) showcenter
    % "10".
    0 DOT_numoffset DOT_fontsize 0.4 mul sub moveto
    (10) showcenter
} def
% Main code.
%/preview true def
preview {
    /m_x_offset 0.5 in def
    /m_y_offset 0.5 in def
    /m_x_count 1 def
    /m_y_count 1 def
    /m_size 7.5 in def
    /m_x_space 0 def
    /m_y_space 0 in def
    /m_angle 0 def
} {
    /m_x_offset 0.375 in def
    /m_y_offset 0.75 in def
    /m_x_count 3 def
    /m_y_count 3 def
    /m_size 2.25 in def
    /m_x_space 0.50 in def
    /m_y_space 0.75 in def
    /m_angle 45 def
    % Use manual feed.
    { statusdict begin /manualfeed true def end } stopped pop
} ifelse
    m_x_offset m_y_offset translate
    0 1 m_y_count 1 sub {
    } for

@_date: 1993-11-14 21:50:18
@_author: Jef Poskanzer 
@_subject: "Applied Cryptography" at Cody's 
One fewer as of 16:30.  They had it hidden in the back room upstairs, but
I made them file the rest in the math section.  I'm about halfway through
it now.  It's pretty nifty!

@_date: 1993-11-14 22:34:00
@_author: Jef Poskanzer 
@_subject: *hot* pseudospoofing ideas! 
Say....  Does anyone have an archive of Detweiler's messages handy?
There's this nifty program called "travesty" that I suddenly have
an urge to play with.

@_date: 1993-11-15 07:40:30
@_author: Jef Poskanzer 
@_subject: Destroying data 
KNO3+sugar works fine.
By weight.
The iron oxide you get from ceramics supply places is plenty fine enough.
DO NOT ball mill the aluminum, it can explode.  If you're not a minor, chem
supply places should be willing to sell you 200-mesh Al, which works fine.
Not as far as I know.
Personally I'd rather use some sort of cryptographic file system,
with the key stored in volatile memory.  Connect the power switch
to your perimeter sensors and you're safe.  Thermite sounds macho
but the reality is messy and dangerous.  Do you really want to
risk a false alarm?

@_date: 1993-11-18 12:34:32
@_author: Jef Poskanzer 
@_subject: hohocon 
At Hackers 8.0 a hallway discussion (including Eric Hughes) came up
with an amusing variation on these sniff-resistant authentication schemes:
use a pager.  It goes like this.  You telnet from an insecure site to your
home system, and type your userid.  Instead of prompting you for a
password, your system looks up your pager number, dials out to the pager
service, and pages you with a random but syntactically valid phone
number.  Then it prompts you.  You receive the page and type that
number as your password.
Authentication is based on physical posession of the pager, and knowing
what userid/machine it corresponds to.  A possible attack would be
to monitor the pager frequencies and try to snag the number out of
the air.  Possible defense against this would be to require a special
password before the page is generated - an attacker would have to monitor
both the network and the radio.
Not military grade security, but lots of folks have pagers and could
hack together something like this in a day or so.

@_date: 1993-11-19 17:54:44
@_author: Jef Poskanzer 
@_subject: Privacy/Money Orders 
Still a few bugs in this system - amusing transcript appended.
Script started on Fri Nov 19 17:42:01 1993
% telnet locis.loc.gov
Trying 140.147.254.3...
Connected to locis.loc.gov.
Escape character is '^]'.
         L O C I S :  LIBRARY OF CONGRESS INFORMATION SYSTEM
          To make a choice: type a number, then press ENTER
  1   Library of Congress Catalog              4   Braille and Audio
  2   Federal Legislation                      5   Organizations
  3   Copyright Information                    6   Foreign Law
 *     *     *     *     *     *     *     *     *     *     *     *
  7   Searching Hours and Basics
  8   Documentation and Classes
  9   Library of Congress General Information
 12   Comments and Logoff
      Choice:
 2
                          FEDERAL LEGISLATION
These files track and describe legislation (bills and resolutions) introduced
in the US Congress, from 1973 (93rd Congress) to the current Congress (the
current Congress is the 103rd).  Each file covers a separate Congress.
 CHOICE                                                      FILE
   1    Congress, 1981-82        (97th)                      CG97
   2    Congress, 1983-84        (98th)                      CG98
   3    Congress, 1985-86        (99th)                      CG99
   4    Congress, 1987-88        (100th)                     C100
   5    Congress, 1989-90        (101st)                     C101
   6    Congress, 1991-92        (102nd)                     C102
   7    Current Congress, 1993-  (103rd)                     C103
   8    Search all Congresses from 1981-->current
   9    Search all Congresses on LOCIS 1973-->current
       Earlier Congresses: press ENTER
  12   Return to LOCIS MENU screen.
       Choice:
 7
FRIDAY, 11/19/93  08:43 P.M.
***C103- THE LEGISLATIVE INFORMATION FILE FOR THE 103RD CONGRESS,
         which was updated on 11/19/93 and contains 7,958 records,
         is now available for your search.
  CURRENCY: All information is NOT current through the above date, which is
            machine generated when ANY information is added to the file.
            Bill numbers, official titles, sponsors, and status (STEP) added
            within 48 hours.  Indexing terms and digests added later, in
            some cases several weeks after the bill is added to the file.
 TO START   RETRIEVE to find:                    EXAMPLES:
   SEARCH:    member name  -------------->    retrieve rep gingrich
                                              retrieve sen kennedy
              bill number  -------------->    retrieve h.r. 1
              subject keywords  --------->    retrieve day care
 FOR HELP:  Type the word HELP and press the ENTER key.
   READY FOR NEW COMMAND:
retrieve assault guns
 DFH2206I TRANSACTION BGNS ABEND AZI4 . BACKOUT SUCCESSFUL  20:44:36  help
 DFH2001I INVALID TRANSACTION IDENTIFICATION HELP - PLEASE RESUBMIT  20:45:34  ?
 DFH2001I INVALID TRANSACTION IDENTIFICATION ? - PLEASE RESUBMIT  20:45:39  oh boy
 DFH2001I INVALID TRANSACTION IDENTIFICATION OH - PLEASE RESUBMIT  20:45:48  select * from all
 DFH2206I TRANSACTION SELE ABEND SECV . BACKOUT SUCCESSFUL  20:46:05  quit
 DFH2001I INVALID TRANSACTION IDENTIFICATION QUIT - PLEASE RESUBMIT  20:46:23  logout
 DFH2312 - WELCOME TO CICS/MVS -
         FRIDAY            NOVEMBER 19, 1993.         08:46 PM         UX01
ACFAE138: ENTER YOUR PASSWORD:
IIIIIIIIIIIIIIIII  ACF01004 LOGONID UT NOT FOUND
 DFH2312 - WELCOME TO CICS/MVS -
         FRIDAY            NOVEMBER 19, 1993.         08:46 PM         UX01
ACFAE133: ENTER LOGON ID:
  quit
ACFAE138: ENTER YOUR PASSWORD:
IIIIIIIIIIIIIIIII  ACF01004 LOGONID QUIT NOT FOUND
 DFH2312 - WELCOME TO CICS/MVS -
         FRIDAY            NOVEMBER 19, 1993.         08:46 PM         UX01
ACFAE133: ENTER LOGON ID:
  ^]
telnet> close
Connection closed.
% exit
script done on Fri Nov 19 17:46:43 1993

@_date: 1993-11-24 13:48:19
@_author: Jef Poskanzer 
@_subject: holiday 
Since infinity is the product of all numbers, it was fairly easy
to factor.  Decrypted text appended.
  o&                 ____   ___o\_
 d|   "9,            ?H
,M     |b__o=q\    .d*" ___.       ,==\\`Ho.
H|      `""  J*  .,MT ,H$odH?     dH `&?.
M|         ,&' .dM*'  +R96]     `HMbHP    `9b.
Mi       .HP .     `""""'                 `9
M|       |H' HH                                 `H,
`b       H| dP                              #    `H,
 H      |M JM        .o                     9HdH  |b
 M.      M M|      ""HM.  ,.            .&"     MM
 H'      T.HH        `Mb &            `\.JM     M#
 H|      |b|M         `Hb.^d|            .,d    ,H
 T|       9L*b.         `M     dH'
M       `HL`H?.        `H/H&$$??????o/?&'    dM*
M.       `Hb ?M      `*&$P   ,H
  Mb         HHH? `*Mb.      `"   ,MP'
  MM.        ?H'     "HHb\               .
  TMb      .dP'        `"
   *M|   ,               ""TM"'""""'  *M|
    MH,.oH'                  .d|         .M|
MMH'                   .H*          HP
     TH,                   ,H'         .dP'

@_date: 1993-11-24 19:13:23
@_author: Jef Poskanzer 
@_subject: Give me your password- OR ELSE! 
Actually, I did that.  Turns out the supposed increase that got all the
media attention was solely due to the SFPD establishing a new statistical
category.  The actual number of incidents has not changed significantly.

@_date: 1994-04-01 16:30:34
@_author: Jef Poskanzer 
@_subject: The President's Analyst 
Indeed, President's Analyst was an instant classic and ahead of its
time.  The tpc.org domain is a reference to it.
See .sigquote below for another prescient James Coburn meme.
           Jef Poskanzer  jef at netcom.com  jef at well.sf.ca.us
          "An *actor* as President??" -- In Like Flint, 1967

@_date: 1994-08-17 11:04:34
@_author: Jef Poskanzer 
@_subject: First Virtual 
% whois first | egrep -i virtual
First Virtual Corporation (FVC-DOM)				       FVC.COM
First Virtual Corporation (NET-FVC) FVC				  199.181.72.0
First Virtual Holdings Inc. (NET-FV-NET) FV-NET			 199.171.113.0
First Virtual Holdings, Inc. (FV-DOM)					FV.COM
First Virtual Holdings, Inc. (THECARD-DOM)			   THECARD.COM
First Virtual Holdings, Inc. (CARD-DOM)				      CARD.COM
% whois fvc.com
First Virtual Corporation (FVC-DOM)
   3393 Octavius Drive, Suite 102
   Santa Clara, CA 95054
   Domain Name: FVC.COM
   Administrative Contact, Technical Contact, Zone Contact:
      Gallmeister, Bill  (BG43)  postmaster at FVC.COM
      (408) 738-2220
   Record last updated on 22-Apr-94.
   Domain servers in listed order:
   NS1.SVC.PORTAL.COM		156.151.6.20
   UUCP-GW-1.PA.DEC.COM		16.1.0.18
   UUCP-GW-2.PA.DEC.COM		16.1.0.19
% whois fv.com
First Virtual Holdings, Inc. (FV-DOM)
   POB 3627
   Rancho Santa Fe, CA 92067-3627
   Domain Name: FV.COM
   Administrative Contact:
      Stein, Lee  (LS48)  leestein at SCRIPPS.EDU
      1 619 759 9300
   Technical Contact, Zone Contact:
      Rose, Marshall T.  (MTR)  mrose at DBC.MTVIEW.CA.US
      (415) 968-1052
   Record last updated on 19-Mar-94.
   Domain servers in listed order:
   DBC.MTVIEW.CA.US		192.103.140.1
   TRYSTERO.RADIO.COM		192.101.98.3

@_date: 1994-12-19 17:33:22
@_author: Jef Poskanzer 
@_subject: Hiding strings in objects code 
When rtm used this technique in his worm I'm sure a lot of people,
such as myself, spent the five minutes necessary to hack up a program
that tries XORing the input with all 256 possible bytes.  I had the
program pipe the output of each try through strings and wc, to check
whether any significant text was uncovered.  Only 0x00 and the single
now-forgotten value he used got hits - no second XOR value.
Anyway the point is it's *really* by no means secure, and you can do
much better with a few minutes thought.  Set up a basic framework
using a Makefile that takes a file of
    MNEMONIC	"text string"
and runs it through an encoding program to produce a .h file of
    static char* text[] = {
     MNEMONIC 17
Then in your actual program you just call decode(text[MNEMONIC]);
Given that simple framework you can experiment with lots of different
encoding and decoding functions.

@_date: 1994-02-27 11:16:12
@_author: Jef Poskanzer 
@_subject: standard for stegonography? 
Is there a standard for stego yet?  I just added stego and de-stego
filters to my pbmplus image toolkit, using a simple protocol I made
up on the spot.  Now I'm wondering if I should make them compatible
with existing stego tools.

@_date: 1994-02-27 18:05:29
@_author: Jef Poskanzer 
@_subject: standard for stegonography? 
On reflection, it seems that some users will want an interoperable
standard, and other users will want complete stealth.  So what I'll
do is add a bunch of switches to pnmstego and pnmdestego, so that
the user can specify all sorts of different formats.  Letting the
switches default will get you a simple interoperable mode, so you
can send stuff to people without prior arrangement or put stuff on
an ftp server; but an attacker will be able to extract the bits and
try to decrypt them.  Specifying things like offsets and bit-usage
schedules will mean that the attacker won't even be able to extract
the bits; but the settings you use will be equivalent to that much
more key material that you have to communicate or remember.

@_date: 1994-07-10 20:08:10
@_author: Jef Poskanzer 
@_subject: using RSA-the-cryptosystem to secure RSA-the-company's patent? 
Apropos the recent thread on tamper-proof programs...
Can anyone think of a way that RSA-the-company could include some sort
of RSA-cryptosystem-secured check in a release of PGP so that it would
only interoperate with other versions that have the same check?  I don't
see how it could be done, but it's sure an intriguing idea.

@_date: 1994-07-10 21:44:20
@_author: Jef Poskanzer 
@_subject: using RSA-the-cryptosystem to secure RSA-the-company's patent? 
They got the stupid version number thing in; if they had thought of
a better trap, they could probably have gotten that in instead.
The point is, the secret key would not be in the source code.  I can't
think of a way to use that; you can't; RSA couldn't; but I'm not
convinced it's impossible.

@_date: 1994-07-26 15:13:41
@_author: Jef Poskanzer 
@_subject: New Threat on the Horizon: Software Key Escrow 
I don't see any defense in this description against using someone
else's public key.  The feds could still decrypt such messages,
but wouldn't know who was talking.  At least not from the envelope.
This could defeat casual mass traffic analysis by agencies who have
the private keys, because they'd have to look inside the messages for
identity cues.  It could also defeat *all* traffic analysis by
parties who don't have the private keys.  That would make it
preferable to Clipper.
Or does the proposed system also have some authentication component?

@_date: 1994-06-17 08:24:33
@_author: Jef Poskanzer 
@_subject: swipe working on infinity.c2.org 
I got one of the disks.  Amusing disclaimers on the back.  Haven't
tried reading it yet.
When I talked to Phil Karn months ago about IP encryption, he was
talking about encrypting each packet independently - I guess you have
to do that with IP since it's not a reliable protocol.  But it sounded
a little risky to me - maybe vulnerable to attack via known bits
at the start of each encrypted section.  Encrypting at the TCP
level would allow inter-packet mixing, but then you miss all the
UDP protocols such as (old) NFS.
Maybe you could post a quick summary of the encryption mode used?

@_date: 1994-06-17 19:25:39
@_author: Jef Poskanzer 
@_subject: Another Cellular Victim 
Really.  And what's more: when the Colombian drug lord was located
via his cellular use, the story was that the NSA had to bring special
equipment into the country to do the tracking.  That doesn't wash here.
It looks like at least some switches in Amerika are already equipped
to read out locations for individual phones.  They probably don't even
have to wait for you to make a call - they can call you, or even use
the phone's automatic pings.

@_date: 1994-06-18 16:13:05
@_author: Jef Poskanzer 
@_subject: No Subject 
Hmm.  And if an attacker discovers you're using this method, and
decides to send out a signal on the same frequency?  You might find
your "random" numbers are suddenly all zeros...

@_date: 1994-03-01 09:10:33
@_author: Jef Poskanzer 
@_subject: standard for stegonography? 
Indeed, that's what I implemented.  The current man page is appended.
pnmstego(1)               USER COMMANDS               pnmstego(1)
     pnmstego - insert a stegonographic message into  a  portable
     anymap
     pnmstego [-offset n] [-components rgb] [-bitsched  10010...]
     file [pnmfile]
     Reads a portable anymap as input.  Hides another file within
     the anymap by changing the low-order bits of each pixel, and
     writes the modified anymap to standard output.
     Stegonography means "hidden writing" - it's  for  storing  a
     message  in  such  a way that an opponent won't even be sure
     that the message is there, let alone  be  able  to  extract,
     decrypt, and read it.  Pnmstego lets you store a file in the
     low-order bits of a PPM or PGM image.  For a typical  maxval
     of  256, this means the pixel values will be changed by only
     1/256, which should not be noticable to someone viewing  the
     image.
     Only PGM and PPM images may be used - trying to hide a  file
     in a PBM image would be easily visible, so it's not allowed.
     The program has a bunch of flags that let you specify varia-
     tions  on  exactly how the bits are hidden in the image.  If
     you don't specify any flags, the default options give you  a
     reasonable storage method, to wit:
         -offset 0 -components b -bitsched 1
     Letting the options default like this has the advantage that
     you  can  send  a  stegoed file to someone without having to
     specify what flags you used.  You can also put the file on a
     public  FTP  server  for people to retrieve, without needing
     any other communication.  However, there is a  disadvantage:
     people  who  the  file  is  not intended for will be able to
     extract it too.  If the resulting file  is  recognizable  in
     some  way,  for instance if it's encrypted by PGP, then some
     of the purpose of the stegonographic storage will have  been
     compromised.   (A PGP file has a standard header and stores,
     in cleartext, the keyid needed to decrypt a file.)
     So, if you want the file to be absolutely positively hidden,
     you  can  use  non-default  settings  for the options.  Just
     don't forget what settings you used, and  remember  that  if
     you  want  to send the file to someone else you will have to
     communicate the necessary settings somehow.
     Now, as for what the options do:
     -offset     Specifies how far into the image to  start.   If
                 the file runs off the end of the image, it wraps
                 around back to the  beginning,  so  don't  worry
                 about  specifying too large an offset.  In fact,
                 you can even specify an offset larger  than  the
                 image  size  -  the  initial  value gets wrapped
                 around too  (modulus).   Basically,  any  32-bit
                 number can be used.
     -components This lets you specify which of the  red,  green,
                 or  blue  color  components  is used for storing
                 bits.  You give it a string made up from one  or
                 more of the letters r, g, and b.  The default is
                 b, use only the blue component.  See the section
                 below  on quantization for why the default isn't
                 rgb.  If the input image is a PGM file,  instead
                 of PPM, this option is silently ignored.
     -bitsched   This lets you skip using some possible bit posi-
                 tions  in  the image.  If the file you're hiding
                 is not so big that you need the whole  image  to
                 store  it,  you  can  use this option to hide it
                 better.  The  argument  is  just  an  arbitrary-
                 length string of 1's and 0's - the 1's say which
                 bit positions should be used, and the 0's  which
                 should  be  skipped.   The default is to use all
                 bit positions.
     Normally, to store an image in  a  colormapped  file  format
     such as GIF, you first run it through ppmquant.  However, if
     you try to quantize, then stego, and then  convert  to  GIF,
     you will find that the ppmquant step will fail with an error
     about too many colors.   This  is  because  the  stego  step
     increased  the number of colors.  You might think, ok, stego
     first, then quantize; nope, the quantization  would  destroy
     the  stegonographic  message.   Here's  what you do instead:
     quantize down to half the number of colors you want  in  the
     final  file,  and  then use only one of the three color com-
     ponents to store the hidden file.  Using only  one  bit  per
     pixel, the number of colors can at most double.  This is why
     the default for the -components flag is to  use  only  blue.
     So, the pipeline to use is:
         ppmquant 128 image.ppm | pnmstego message.txt |
           ppmtogif > hidden.ppm
SEE ALSO
     pnmdestego(1), pnm(5)
     Copyright (C) 1994 by Jef Poskanzer.

@_date: 1994-03-01 10:39:58
@_author: Jef Poskanzer 
@_subject: standard for stegonography? 
Actually, that interface is way too complicated and still not that
secure.  How about if the user just specifies a seed for a random
number generator.  Then that generator is used to make a *permutation*
of the bit locations in the image, and the file's bits are stored in
the permuted order.  And look, this hides the file-length longword and
any fixed file header real well, by spreading them through the image.
Now I just have to find a simple but robust RNG that I can include
in pbmplus, and some code to generate a permutation of a specified
I'm not going to have ITAR problems with this, am I?  RNGs are still
legal to export?
Oh, and to answer the original question: no standard.  If this idea works,
it's clearly better than existing stego systems at hiding the data; that's
more important than interoperability.

@_date: 1994-03-01 11:58:10
@_author: Jef Poskanzer 
@_subject: low-overhead encrypted telnet 
I've been talking about entrypted telnet with Craig Leres lately, and
he came up with an interesting idea.  The background is, sysadmins want
encrypted telnet so that passwords don't fly around in the clear, but
at the same time, they don't want to spend too many extra CPU cycles.
I figured at least some sysadmins would resist installing an
encryption-capable telnetd because of this concern about overhead.
What you'd really like to do so satisfy these people is encrypt only
when actually transmitting passwords.  Problem is, that's hard to
implement.  Kerberos does it by supplying new versions of a dozen
different programs, and it still only works within your organization,
and even there it doesn't handle chained logins (telnet from host A to
host B, then from host B to host C, etc.).  It's hard because you have
different levels of software trying to talk to each other.  A solution
that worked entirely within telnet would be a lot simpler.
A compromise I thought of a while back is to encrypt the first few
kilobytes and then switch to cleartext.  This lets you log in securely,
the average overhead for the session remains low, and there's no
interaction between different software levels.  But this also doesn't
handle chained logins, if the second login comes later in your session.
So here's Craig's idea: only encrypt the client-to-server direction.
That's the only direction that passwords go, so it's secure; and it's
low overhead because you generally type far fewer characters than you
Just a tidbit for anyone working on encrypted logins.

@_date: 1994-03-01 13:27:15
@_author: Jef Poskanzer 
@_subject: low-overhead encrypted telnet 
In practice, no, it doesn't.  This is not a technical problem,
but it's nevertheless quite real.  You will never see inter-realm
Kerberos set up at places line netcom, because netcom's sysadmins
have better things to do than manage secret keys for every
organization that wants to connect.  Only a system with completely
automated configuration and operation has a chance.
Yes, of course, if the A<->B link is encrypted then subsequent logins
are secure.  The point is to find a way to secure those logins *without*
full encryption of the A<->B link.
In practice, almost all of the time, it will.
Personally I agree with this.  Most sysadmins will not.
I'll check this out, but if it's based on Kerberos it's probably
useless for the reasons mentioned above.

@_date: 1994-03-02 22:32:48
@_author: Jef Poskanzer 
@_subject: Standard for Stenography? 
I disagree with pretty much everything in your message, and since I'm the
one who opened the topic and who is writing the code, my opinion would seem
to count for quite a bit more than yours.  I'm not going to repeat the
reasons why the kind of standard you propose is a bad idea, you can fetch
the messages as easily as I can.
The permutation idea remains the best.
By the way, this discussion is an example of something I have labelled the
"silence is invisible" phenomenon.  It goes like this: there's a discussion;
some of the participants work out an answer, and as far as they're concerned
the discussion is over.  However, other participants don't understand the
answer, and keep on talking.  In a physical meeting, the talkers would
notice the annoyed looks on the faces of everyone else; or if the meeting
had a good facilitator, he or she would catch on to the misunderstanding
and correct it; but in cyberspace, those feedback mechanisms don't happen.

@_date: 1994-03-03 09:10:41
@_author: Jef Poskanzer 
@_subject: Standard for Stenography? 
I already did - the offsets idea was my second thought, permutation
is third.
I'm a big fan of the rigidly separated software tools approach.  Just
look at the pbmplus tookkit.  But I also think it's perfectly ok to
combine functions when there's a good enough reason.  I think this is
such a case.  The problem is the length field - you've got to have it,
and it's recognizable because it begins with a run of 0s.  So the stego
program should hide it.  Mac Stego hides it by XORing with the
2nd-to-lsb of the following 32 bytes - that's a hack, and it won't slow
an attacker down for a microsecond.  jsteg, if I remember right, does
some variable field width encoding - better, but it also remains
recognizable to some extent.  My solution is to store the file's bits
in a specified pseudorandom permutation of the image's available bit
positions.  It's kind of like the frequency hopping of spread spectrum
radio.  This hides the length field very thoroughly.  It also happens
to hide anything else recognizable about the original file.  Yes, you
should use Stealth PGP for complete security, and my man page will tell
you this.  However, even with regular PGP the permutation will give you
good security against casual attacks, perhaps even commercial attacks.
Now, if you can think of a natural, simple interface for a standalone
file permutation generator, I'll be happy to separate that part out,
and make pnmstego just read bits and stick them in the image in order.
The problem with separating it is the bits you want to leave alone.
Either the file permutation generator has to generate *trinary* output,
which seems gross, or the stego pipeline will have to include an
initial DEstego step to extract the unmodified bits from the image.
Either of those possibilities is more complicated than just building
the permuter into pnmstego.

@_date: 1994-03-03 17:54:14
@_author: Jef Poskanzer 
@_subject: Standard for Stenography? 
Eli makes a reasonable case for leaving out the length field
altogether.  The desteg program would produce a file of width*height
bits, and it would be up to the next layer to produce text from that.
However, I'm not sure it's a *compelling* case.  If adding the length
doesn't actually hurt security, I'm inclined to keep it.
Slowness is not necessarily bad - it also makes it harder for
attackers to search through large numbers of images for ones
with hidden data.  But the main thing that the permutation
gives you is that it spreads out the data bits among unmodified
bits, making statistical tests harder.  For a 1000 byte message
in a 640x480 image, only 2% of the bits will be changed.  If that
2% was all jammed into the first 80000 pixels of the file, it
might be detectable; if it's spread evenly throughout the file,
it's probably safer.

@_date: 1994-03-04 07:22:43
@_author: Jef Poskanzer 
@_subject: How to do encrypted telnet without being root (tutorial, includes src) 
That's quite interesting, but it sure looks like it's unable to
encrypt the only part of the session that I really want to encrypt:
the password.

@_date: 1994-03-05 17:46:04
@_author: Jef Poskanzer 
@_subject: better way to generate a permutation? 
I'm putting the polish on pnmstega/pnmdestega.  Currently they spend
the largest part of their time generating the permuted list of bit positions
to use for storing the data bits.  Not surprising, I knew the first
version would be slow - it actually mallocs an array, fills it with
numbers, and shuffles them.  Now I'm looking for suggestions on better
methods.  I looked in Knuth, Sedgewick, and Schneier, and didn't
find anything.  Send email if you've got an idea.  Something with a
bit vector might work.

@_date: 1994-03-07 19:38:20
@_author: Jef Poskanzer 
@_subject: random number generator for pnmstega - comments? 
I combined the "minimal" generator from PGP with another one.  The key
length is still 31 bits.  The way I figure it, that's enough to deter
exhaustive search by most entities, but it's not so much that there
will be export problems.  As long as I put strong cautions in the doc
about relying on this RNG as your primary cipher, and as long as it
seems likely to be secure against cryptanalysis, I think this is a good
The minimal generator by itself is known to be insecure.  By using it
as input to a shift register, I think enough complexity is added that
it becomes an unknown again.
Comments are welcome.
** Simple, portable, reasonably robust random number generator.
** Copyright (C) 1994 by Jef Poskanzer.
** Permission to use, copy, modify, and distribute this software and its
** documentation for any purpose and without fee is hereby granted, provided
** that the above copyright notice appear in all copies and that both that
** copyright notice and this permission notice appear in supporting
** documentation.  This software is provided "as is" without express or
** implied warranty.
 "pbm.h"
** shift register.  Values from the LCG are used to keep a circular buffer
** filled; results are produced by xoring three values from the table.
** The modulus of the LCG must be a power of two for this to produce
** equidistributed results.  This LCG actually uses a modulus that's
** a power of two minus one, but that's close enough.
** DO NOT MODIFY, IMPROVE, EXPAND, ENHANCE, OR IN ANY WAY CHANGE this
** generator.  It is used for cryptographic storage of data - if the
** sequence is changed, the data will become unrecoverable.
** The linear congruential generator is:
**     Minimal Standard Pseudo-Random Number Generator
**     Author: Fuat C. Baran, Columbia University, 1988
**     Based on code in "Random Number Generators: Good Ones are Hard to Find",
**     by Stephen K. Park and Keith W. Miller in Communications of the ACM,
**     31, 10 (Oct. 1988) pp. 1192-1201.
** The feedback shift register is similar to the one described in "Algorithms",
** Robert Sedgewick, 1983, page 38.
 A 16807L
 M 2147483647L		/* Mersenne prime 2^31 -1 */
 Q 127773L		/* M div A (M / A) */
 R 2836L			/* M mod A (M % A) */
static long value = 1;
 TABLESIZE 55
 TAP1 0
 TAP2 23
 TAP3 (TABLESIZE-1)
static long table[TABLESIZE];
static int offset;
static long
    {
    long hi, lo;
    hi = value / Q;
    lo = value % Q;
    value = A * lo - R * hi;
    if ( value <= 0 )
    return value;
    }
pm_srandom( seed )
    long seed;
    {
    if ( seed == 0 )
    else
    for ( offset = 0; offset < TABLESIZE; ++offset )
    }
    {
    offset = ( offset + 1 ) % TABLESIZE;
    table[offset] = lcg();
    return table[offset] ^			/* TAP1 is zero, optimize */
    }

@_date: 1994-05-16 00:14:22
@_author: Jef Poskanzer 
@_subject: a couple of shell scripts for use with PGP 
pgpextract:  Given one or more keyids or userids, either on the command
line or on stdin, extracts the keys and writes them to stdout.
Basically just a more useful interface for 'pgp -kxa'.
pgpgetweb:  Given one or more keyids or userids, either on the command
line or on stdin, expands the "web of trust" out to the specified depth
and writes the resulting keyids to stdout.  You could feed the
resulting file to pgpextract to make a subset keyring of only your
'close neighbors'.
If I come up with more scripts I'll add them to the sharchive in
my ftp dir on netcom.
 /bin/sh
# This is a shell archive, meaning:
# 1. Remove everything above the  /bin/sh line.
# 2. Save the resulting text in a file.
# 3. Execute the file with /bin/sh (not csh) to create the files:
#	README
#	pgpscripts.1
#	Makefile
#	pgpextract
#	pgpgetweb
# This archive created: Mon May 16 00:11:13 1994
export PATH; PATH=/bin:$PATH
echo shar: extracting "'README'" '(536 characters)'
if test -f 'README'
sed 's/^X//' << \SHAR_EOF > 'README'
X            pgpscripts - shell scripts for using PGP
X		      version of 15may94
XSome simple scripts that give a more Unix-like interface to some
Xof PGP's functions.  See the manual entry for more details.
XFiles in this distribution:
X    README		this
X    Makefile		guess
X    pgpscripts.1	manual entry
X    pgpextract		script
X    pgpgetweb		...
XTo install:
X    Unpack the files.
X    Edit the Makefile to change the configuration options if necessary.
X    Make install.
XComments to:
X    Jef Poskanzer  jef at netcom.com  jef at well.sf.ca.us
if test 536 -ne "`wc -c < 'README'`"
fi # end of overwriting check
echo shar: extracting "'pgpscripts.1'" '(744 characters)'
if test -f 'pgpscripts.1'
sed 's/^X//' << \SHAR_EOF > 'pgpscripts.1'
X.TH pgpscripts 1 "15 May 1993"
X.SH NAME
Xpgpextract, pgpgetweb - shell scripts for using PGP
X.SH SYNOPSIS
X.B pgpextract
X.RI [ keyid... ]
X.B pgpgetweb
X.I depth
X.RI [ keyid... ]
X.SH DESCRIPTION
XDescription of each script:
X.I pgpextract
XGiven one or more keyids or userids, either on the command line or
Xon stdin, extracts the keys and writes them to stdout.  Basically
Xjust a more useful interface for 'pgp -kxa'.
X.I pgpgetweb
XGiven one or more keyids or userids, either on the command line or
Xon stdin, expands the "web of trust"
Xout to the specified depth and writes the resulting keyids to stdout.
XYou could feed the resulting file to
X.B pgpextract
Xto make a subset keyring of only your 'close neighbors'.
X.SH "SEE ALSO"
if test 744 -ne "`wc -c < 'pgpscripts.1'`"
fi # end of overwriting check
echo shar: extracting "'Makefile'" '(592 characters)'
if test -f 'Makefile'
sed 's/^X//' << \SHAR_EOF > 'Makefile'
X# CONFIGURE: the directory where you want the executables installed
XINSTDIR =	/usr/local/bin
X# CONFIGURE: the directory tree where you want the man pages installed
XMANDIR =	/usr/local/man
X# End of configurable definitions.
XSCRIPTS =	pgpextract pgpgetweb
Xall:		
Xinstall:	all
X	for i in $(SCRIPTS) ; do \
X	    rm -f $(INSTDIR)/$$i ; \
X	    cp $$i $(INSTDIR) ; \
X	done
X	rm -f $(MANDIR)/man1/pgpscripts.1
X	cp pgpscripts.1 $(MANDIR)/man1
X	for i in $(SCRIPTS) ; do ( \
X	    rm -f $(MANDIR)/man1/$$i.1 ; \
X	    echo '.so man1/pgpscripts.1' > $(MANDIR)/man1/$$i.1 ; \
X	) done
X	rm -f core
if test 592 -ne "`wc -c < 'Makefile'`"
fi # end of overwriting check
echo shar: extracting "'pgpextract'" '(894 characters)'
if test -f 'pgpextract'
sed 's/^X//' << \SHAR_EOF > 'pgpextract'
X# pgpextract - extract multiple pgp keys onto stdout
X# Copyright (C) 1994 by Jef Poskanzer .
X# Permission to use, copy, modify, and distribute this software and its
X# documentation for any purpose and without fee is hereby granted, provided
X# that the above copyright notice appear in all copies and that both that
X# copyright notice and this permission notice appear in supporting
X# documentation.  This software is provided "as is" without express or
X# implied warranty.
Xrm -f ${out} ${keya}
Xumask 077
X    if [ $# -eq 0 ] ; then
X	cat
X    else
X	while [ $# -ne 0 ] ; do
X	    echo $1
X	    shift
X	done
X    fi
X) | (
X    while read id ; do
X	pgp -kxa ${id} ${key} > ${out} 2>&1
X	if [ -z "`grep 'Key not found' ${out}`" ] ; then
X	    cat ${keya}
X	else
X	    echo "Keyid ${id} not found." >&2
X	fi
X	rm -f ${out} ${keya}
X    done
if test 894 -ne "`wc -c < 'pgpextract'`"
chmod +x 'pgpextract'
fi # end of overwriting check
echo shar: extracting "'pgpgetweb'" '(1338 characters)'
if test -f 'pgpgetweb'
sed 's/^X//' << \SHAR_EOF > 'pgpgetweb'
X# pgpgetweb - finds the keyids that comprise the 'web of trust' for
X#             specified ids
X# Copyright (C) 1994 by Jef Poskanzer .
X# Permission to use, copy, modify, and distribute this software and its
X# documentation for any purpose and without fee is hereby granted, provided
X# that the above copyright notice appear in all copies and that both that
X# copyright notice and this permission notice appear in supporting
X# documentation.  This software is provided "as is" without express or
X# implied warranty.
Xif [ $# -eq 0 ] ; then
X    echo "usage:  $0 depth [keyid...]" >&2
X    exit 1
Xrm -f ${ids} ${todo} ${out}
Xumask 077
X    if [ $# -eq 0 ] ; then
X	cat
X    else
X	while [ $# -ne 0 ] ; do
X	    echo $1
X	    shift
X	done
X    fi
X) | sort -u > ${ids}
Xcat ${ids} > ${todo}
Xecho "Starting with `cat ${ids} | wc -l` keyids." >&2
Xwhile [ ${n} -lt ${depth} ] ; do
X    cat ${todo} | (
X	while read id ; do
X	    pgp -kvv ${id} 2>&1 | egrep '^sig ' | awk '{printf "0x%s\n", $2}'
X	done
X    ) | sort -u > ${out}
X    comm -13 ${ids} ${out} > ${todo}
X    cat ${ids} >> ${out}
X    sort -u ${out} > ${ids}
X    n=`echo ${n}+1 | bc`
X    echo "At depth ${n},   `cat ${ids} | wc -l` keyids." >&2
Xcat ${ids}
Xrm -f ${ids} ${todo} ${out}
if test 1338 -ne "`wc -c < 'pgpgetweb'`"
chmod +x 'pgpgetweb'
fi # end of overwriting check
#	End of shell archive
exit 0

@_date: 1994-09-17 20:59:31
@_author: Jef Poskanzer 
@_subject: "FREE MONEY" spam via remailer 
Is this the first spam to go via an anonymous remailer?  I bet
penet is swamped right now, trying to process the tens of thousands
of flames.  Seems like Julf might want to implement a spam
detector inside the remailer, preventing the stuff from getting
posted from there in the first place.

@_date: 1994-09-22 21:07:21
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
Anyone have any fun diffs for kerberized telnet/telnetd that I could
play with?  An IDEA encryption module?  A Diffie-Hellman module?
Standards not necessary, we're just experimenting here.

@_date: 1994-09-23 17:49:29
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
"That turns out not to be the case."  The version of CNS that we have
doesn't have any encryption beyond DES.  4.4BSD telnet is basically
identical to kerberosV telnet, and the only encryption it has is DES.
You may have misunderstood my message, assuming I was looking for
patches to some random unspecified version of telnet to make it
kerberized and give it IDEA and DH capabilities.  That would have
been a stupid request to make.  Thanks for the compliment.
Let me be crystal clear this time.  We have kerberosV telnet.
It has DES encryption, and a few authentication options that
do not include Diffie-Hellman.  I am curious whether anyone has
already started playing with adding new encryption and authentication
modules, for example IDEA and DH.

@_date: 1994-09-24 13:02:40
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
Perry Metzger:
I just did a diff -r between the Kerberos V telnet/telnetd/libtelnet
and the 4.4BSD version.  From 1.5 MB of source code I get 40KB of diffs.
In my book a 2% difference qualifies as basically identical.  Plus 90%
of the diffs were memcpy/bcopy changes.
I know there are nice hooks in the code for adding new encryption
and authentication modules.  I know it would be relatively easy to
add IDEA and DH.  That's why I'm asking whether anyone has already
done it.  Do you get it this time, or should I go for four?
Perry, why don't you let someone else reply this time?

@_date: 1994-09-24 14:32:32
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
Not at all, Perry.  It's only when a loudmouth gives *incorrect*
answers multiple times that I start getting pissed.
And I thank you for sparing the list any more of your "information",
if it's of similar quality to what you've posted so far.

@_date: 1994-09-24 16:13:10
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
No, of course you didn't mention it.  I mentioned it, in the subject
of the first message of this ridiculous thread.  Apparently you
STILL DON'T GET IT.
And I still fail to see how my pointing out that you are confused can
reasonably be called an "insult".

@_date: 1994-09-25 09:53:39
@_author: Jef Poskanzer 
@_subject: kerberosV telnet 
Gosh gee gee whillikers Perry, what did you expect me to do after
you started quoting from private email, hmmmmmmm?

@_date: 1995-01-10 11:58:51
@_author: Jef Poskanzer 
@_subject: Why is WELL down? 
Is that sarcasm?
"Never attribute to malice what can be explained by simple stupidity."
