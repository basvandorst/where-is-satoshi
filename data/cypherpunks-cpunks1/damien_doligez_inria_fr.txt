
@_date: 1995-08-16 01:42:51
@_author: Damien Doligez 
@_subject: SSL challenge -- broken ! 
SSL challenge -- broken
This is to announce the solution of the SSL challenge posted by Hal
Finney on July 17, 1995 (message-ID: <3u6kmg$pm4 at jobe.shell.portal.com>),
also found at: The 40-bit secret part of the key is 7e f0 96 1f a6.  I found it by a brute
force search on a network of about 120 workstations and a few parallel
computers at INRIA, Ecole Polytechnique, and ENS.  The key was found after
scanning a little more than half the key space in 8 days.
The cleartext of the encrypted data is as follows:
The SERVER-VERIFY message is:
9C B1 C7 83 D9 BB B7 75 01 6F 19 19 03 58 EC 05     MAC-DATA
05                                                  MSG-SERVER-VERIFY
AF 84 A7 79 F8 13 69 20 25 9B 53 A0 60 AE 75 51     CHALLENGE
The CHALLENGE part is a copy of the challenge sent by the client in its
first message.
The answer is the CLIENT-FINISHED message:
22 BB 23 39 55 B0 7F B6 1A B0 35 85 F7 DB C1 E5     MAC-DATA
03                                                  MSG-CLIENT-FINISHED
BF EB 90 F8 2C 0C E1 EA 18 AC 11 4C 83 14 21 B6     CONNECTION-ID
The next message is SERVER-FINISHED:
D4 CD F3 4E 38 F1 2B 1E DC FD 72 C8 34 02 CD FF     MAC-DATA
06                                                  SERVER-FINISHED-BYTE
23 1C 05 40 60 72 49 6E 83 BA D1 28 CC 9B 5F 63     SESSION-ID-DATA
Then comes the data message sent by the client.  This is the juicy one.
I have broken the contents into its fields (the body was just one long
72 23 B5 98 0D D0 07 1A DA F1 C7 A4 40 41 5A 10     MAC-DATA
POST /order2.cgi HTTP/1.0
Referer: User-Agent: Mozilla/1.1N (Macintosh; I; PPC)
Accept: */*
Accept: image/gif
Accept: image/x-xbitmap
Accept: image/jpeg
Content-length: 472
This order came from Mr Cosmic Kumquat, SSL Trusters Inc.,
1234 Squeamish Ossifrage Road, Anywhere, NY 12345 (USA).
Unfortunately, Mr Kumquat forgot to give his phone number, and the
server's reply (in two packets) is:
09 12 AD FE A5 A9 BF D1 8C 8C E2 6A A3 48 B9 75    MAC-DATA
HTTP/1.0 200 OK
Server: Netscape-Commerce/1.1
1C CD C4 3D 80 F1 7B 94 11 AC E8 72 B1 99 BC FA    MAC-DATA
The shipping address you supplied is not complete.  The street address,
city, state, zip code, country and phone number are mandatory fields.
Please go back and specify the full shipping address.  Thank you.
This result was found with a quick-and-dirty distributed search program,
which I wrote when I realized that the cypherpunks were going to be a few
weeks late with their collective effort.  When the program was running,
it took little more than one week to find the key (it would have taken about
15 days to sweep the entire key space).  I ran it on almost all the machines
I have access to, summarized in the following table:
type                  speed (keys/s)    number     notes

@_date: 1995-08-17 06:52:59
@_author: Damien Doligez 
@_subject: Phone call for Mr. Doligez, was Re: SSL challenge -- broken ! 
Well, that was the whole point of the challenge, wasn't it ?
Why didn't the journalists didn't write their articles one month ago
when Hal posted his challenge ?
What I find surprising is that it took as long as one month.  I was
even surprised when it wasn't done after two weeks, and that's when I
started working on it.

@_date: 1995-08-17 07:04:41
@_author: Damien Doligez 
@_subject: SSL challenge -- broken ! 
You're right, of course, if you discount the hassle of getting the
transactions cancelled whenever your credit card number is used
I have much a better example (and a real one, too):
I have an account at Wells Fargo Bank near San Fransisco.  They
recently started offering web access to their customers.  That would
be great for me because banking by phone is pretty expensive when I'm
in France, and it's not always easy for me to understand American
So they would give me a password that I can use for some set of
operations.  I don't know which one exactly, but I would expect it to
include electronic transfers from my account to anywhere else.  The
password is protected by the SSL connection.  That would be fine if I
had the full SSL security, but in France I can only get the exportable
version of Netscape.  As a result, I won't be using this service.
There's the beginning of a market for full-SSL clients and servers
outside the US.  Maybe Netscape should go multinational right now.

@_date: 1995-08-17 08:35:45
@_author: Damien Doligez 
@_subject: Another SSL breakage... 
Then David beat me by about two hours.  My program found the result at
12:23 +0200 on the same day.  I was not at work (aug 15 is a holiday
in France), so I saw it a few hours later, and I wrote my announcement
I will happily redirect all the journalists to David...

@_date: 1995-08-17 11:02:01
@_author: Damien Doligez 
@_subject: Idle compute cycles [Re: Netscape's Offical Response] 
As usual, I agree with all Jim has to say, but there's another problem
with Netscape's response: they UNDERestimate the cost of breaking
RC4-128 (by brute force) by a factor of about 300 trillion.
If someone know of an URL for Netscape's response, I'll be glad to
include a pointer in my virtual press conference.  I would have to ask
for permission before I put a copy on my disks.  Copyrights, you

@_date: 1995-08-18 07:07:30
@_author: Damien Doligez 
@_subject: Cost to Crack Keys 
This is how you can crack SSL RC4-40 sessions for $1000 each:
Go to your bank and get a $250,000 loan over 10 years.  Assuming a 10%
interest rate, you will have to pay about $40,000 per year.  Use the
$250,000 to buy 50 low-cost high-speed pentium PCs.  Don't bother with
a screen, keyboard or mouse.  Get the minimum of memory.  Get a huge
discount (you're a really good client).
Pay $10,000 for the electricity bill, the real-estate rent, etc.
The machines will crack 50 keys per year on average.  They cost you
$50,000 per year.
That's $1,000 per key.
Does anyone see any hole in the above plan ?  It seems to me that
Netscape's estimate is one order of magnitude too high.

@_date: 1995-08-21 12:02:37
@_author: Damien Doligez 
@_subject: Netscape security 
Actually, INRIA's PR people are quite pleased with the publicity.
They asked me to prepare an official press release to counteract the
Wall Street Journal's "evil hacker" story, which was unfortunately
reprinted by some papers.  The Herald Tribune is particularly bad in
this respect.
If some media insist on this "evil hacker" thing, they will look
more ridiculous than anything else (I hope).
The press release will be out as soon as it gets through the red tape
(the official opinion of a French administration is not something to
be taken lightly, even though it's mostly facts :-)  I'll put it on my
web page when it's official (which is likely to be too late).

@_date: 1995-08-21 12:14:34
@_author: Damien Doligez 
@_subject: Liability for Key Cracking in Idle Hours? 
Well, I asked for permission before I used the machines, so I don't
expect any problem.  (Actually, I asked for the permission, then
launched the processes, then got the permission, but it doesn't make
any difference, does it ?  I should have also asked permission for
putting their name in my announce, though.)
It seems that the Herald Tribune called them about a cracker, and they
refused to comment.  They must have gone in paranoid mode, because
they've had lots of trouble with student crackers in the past, and
there is currently not even one student on the campus.  But now, the
situation seems to be in control, although I had no official contact
from Ecole Polytechnique.
Ecole Normale Superieure did not react at all.  They're all on
vacation anyway.
By the way, "cypherpunks" keep getting mentioned in interviews with
the press.  I hope that's OK with you all.

@_date: 1995-08-23 12:05:39
@_author: Damien Doligez 
@_subject: The sorry state of non-US crypto 
Don't forget Australia: It's especially relevant because there is a version of Mosaic
that uses 128-bit SSL (i.e. truly secure).  I have most of these
pointers in my SSL crack Web page (which has evolved quite a bit
in one week).

@_date: 1995-08-26 03:34:18
@_author: Damien Doligez 
@_subject: SSL trouble 
Let us call "sequential search" an algorithm that remembers which keys were
tried and avoids trying them again, and "random search" an algorithm that
just tries keys at random without bothering to check.
The sequential search has the following problems:
1. The server is badly overloaded.
It is vulnerable to a variety of active attacks:
2. "result hoarding" attacks: finding the result and reporting it "not found".
3. "dilution" attack: allocating some search space and not sweeping it.
4. plain old "denial of service" attack: deliberately overloading the server
   with bogus communications.
5. And of course all of the above in their "buggy software or hardware"
   versions.
The random search has none of them:
attacks 1 and 4: there is no server to overload
attacks 2 and 3 are no worse than simply refusing to participate in the search,
because the rest of the computation is independent of what any one party is
The main drawback of the random search is that the expected running "time" is
the size of the key space instead of half the size for the sequential search
("time" here is the number of keys to try before finding the right one).
In practice, because of server overload, our machines don't seem to be working
more than half the time, so the random search could be actually faster than
the sequential search.  Even if it isn't, I think doing twice as much work
is a good trade-off for protection against all attacks, and no more network
or server problems, and no more allocation hassles for off-line users.
Four more remarks:
* I get the factor of two by assuming that the algorithm is "pick a segment at
  random, look for the key in it, pick a new segment at random, and so on".
  I suspect that sequential searching from a random starting point would be
  much worse in the case of many independent searchers.
* I hope there's no bug in my math.
* Another drawback is that the worst-case running time is infinite (but it is
  infinitely unlikely).
* Of course, we need a good PRNG, but that's essentially what RC4 is.
In conclusion, I think random searching is the way to go.  It's even better
than Monty's pre-allocation with quad-coverage.

@_date: 1995-08-28 06:11:46
@_author: Damien Doligez 
@_subject: SSL trouble 
I didn't realise that.
A message in a newsgroup, a mailing list, or a web page.  Even if you
can mount a denial-of-service against this, it will only make people
continue the search uselessly.  It won't prevent you from finding the
Nope.  It's what I get when I do the math (basic probability theory)
to find the expected running time.  But I could be wrong.  I'll try to
write it in TeX and put it on my web page.
That would be hard because I've been thinking about it, and I'm less
and less convinced myself.
No, but I had few machines and fast connections (and even then, I did
have some network problems).  But if you think sequential searching
can work, let's do it.  I don't think we have to worry about
deliberate attacks for the moment, and the factor of two is
significant.  My previous message was based on the assumption that it
would be hard to get rid of the server overload.
Maybe we should use random searching as a fallback mode in case of
network problems.  It cannot hurt, except that it makes the programs
more complex.

@_date: 1995-08-28 11:45:07
@_author: Damien Doligez 
@_subject: SSL trouble 
I never meant to say that the protocol was flawed in any way.
I'm sorry if I gave this impression. (I used pretty much the same
protocol on Hal1)
Since I'm not the one who's writing the code, I will not try to tell
you how it should be written, of course.
My point was only that the central server approach does not scale.
When we reach its limit (and it seems we have not reached it yet), we
can use a hierarchical approach, and it is faster than the random one.
But the random algorithm does have its strong points and we should not
dismiss it out of hand.  Maybe I got a little carried away in my
advocating of the random algorithm.
(another topic:)
As for the updates to the client software, let me point out that I did
10 different versions of my own client when working on Hal1.  Some
machines worked for one week with version 1, while others needed many
updates, due to different network and OS conditions.  This is the main
advantage of a well-defined (and stateless) protocol: it allows the
server and clients to be all updated independently while the
computation is running.

@_date: 1995-08-29 10:38:03
@_author: Damien Doligez 
@_subject: Probability calculations 
But you fail to take into account the probability that the search will
have to go that far.
This is how I compute the expected cost of the random search.
The probability of finding the key upon searching the k-th segment is:
                  k-1
  p(k) = (1 - 1/n)    . 1/n
The expected cost is the sum of all possible costs, weighted by their
    ___                 ___
    \                   \              i-1
e =  >  i p(i)    = 1/n  >  i (1 - 1/n)
    /__                 /__
    i = 1..oo           i = 1..oo
        ___        ___
        \          \             i-1
  = 1/n  >          >   (1 - 1/n)
        /__        /__
        i = 1..oo  j = 1..i
        ___
        \            i-1
  = 1/n  >  (1 - 1/n)
        /__
        {(i,j) | 1 <= j <= i}
        ___        ___
        \          \            i-1
  = 1/n  >          >  (1 - 1/n)
        /__        /__
        j = 1..oo  i = j..oo
        ___                 ___
        \             j-1   \             i
  = 1/n  >   (1 - 1/n)   .   >   (1 - 1/n)
        /__                 /__
        j = 1..oo           i = 0..oo
       \_______________/   \_______________/
               n                   n
e = n
This means that if you do many random searches (with a good RNG), the
average cost of one search must be n.
Any errors in the above ?
