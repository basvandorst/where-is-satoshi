
@_date: 2015-12-22 13:28:28
@_author: Matthias Apitz 
@_subject: pubring.kbx, no secring? 
I was using GnuPG v1.x mostly to cipher some private files, i.e. not for
mail and information exchange with other. I will now create a new key to use
this for mail and move to GnuPG v2.x. I have a short question. I created
(until now for test) the key like this:
$ gpg2 --version
gpg (GnuPG) 2.1.6
libgcrypt 1.6.3
$ gpg2 --full-gen-key
$ gpg2 --armor --output revoke.asc --gen-revoke guru
the list keys show:
$ gpg2 --list-secret-keys
                  ^^^^^^^---------------
pub   dsa2048/FFEE762B922A6CBB 2015-12-22
uid               [ultimate] Matthias Apitz (GnuPGv2) sub   elg2048/6C7E963A56E2D675 2015-12-22
and I have the following files:
$ find .gnupg
Question: Why I do not have a file .gnupg/secring.kbx (as I have had
with v1.x)? And, why are the keys stored in .gnupg/private-keys-v1.d?

@_date: 2015-12-22 14:45:59
@_author: Matthias Apitz 
@_subject: pubring.kbx, no secring? 
El d?a Tuesday, December 22, 2015 a las 02:41:24PM +0100, Neal H. Walfield escribi?:
Hi Neal,
Just to make sure: there have been no v1.x keys (I move away the old
.gnupg dir), why are the new v2 keys in a dir named .gnupg/private-keys-v1.d?

@_date: 2015-12-22 15:08:46
@_author: Matthias Apitz 
@_subject: pubring.kbx, no secring? 
El d?a Tuesday, December 22, 2015 a las 03:03:39PM +0100, Neal H. Walfield escribi?:
I understand the migration of the old v1 keys to a new form/directory; but
why the new keys of v2 are stored in a dir private-keys-v1.d and not in
a dir for example private-keys-v2.d; don't you think that such name *v1.d* confuses
people (like me)?

@_date: 2015-12-23 09:23:12
@_author: Matthias Apitz 
@_subject: keysearch fails 
I can not manage to get a keysearch via dirmngr to work; when I use:
$ gpg2 --keyserver pool.sks-keyservers.net --debug 1024 --search xxxx at FreeBSD.org
gpg: reading options from '/home/guru/.gnupg/gpg.conf'
gpg: enabled debug flags: ipc
gpg: DBG: chan_3 <- # Home: /home/guru/.gnupg
gpg: DBG: chan_3 <- # Config: /home/guru/.gnupg/dirmngr.conf
gpg: DBG: chan_3 <- OK Dirmngr 2.1.6 at your service
gpg: DBG: connection to the dirmngr established
gpg: DBG: chan_3 -> KEYSERVER --clear hkp://pool.sks-keyservers.net
gpg: DBG: chan_3 <- OK
gpg: DBG: chan_3 -> KS_SEARCH -- xxxx at FreeBSD.org
gpg: DBG: chan_3 <- [eof]
gpg: error searching keyserver: End of file
gpg: b?squeda del servidor de claves fallida: End of file
gpg: DBG: chan_3 -> BYE
gpg: secmem usage: 0/32768 bytes in 0 blocks
In /var/log/message I see:
Dec 23 09:15:09 c720-r285885-amd64 kernel: pid 2809 (dirmngr), uid 1001: exited on signal 6
which perhaps is normal (soemhow the spawned proc must be killed); but a
TCPDUMP only shows a lot of PTR requests, see below. No real traffic is
to be seen to no server.
What I do miss here?
09:15:57.465887 IP 10.42.0.152.26961 > 10.42.0.1.53: 57200+ A? pool.sks-keyservers.net. (41)
09:15:57.698231 IP 10.42.0.1.53 > 10.42.0.152.26961: 57200 10/0/0 A 176.9.51.79, A 193.224.163.43, A 207.237.164.231, A 193.17.17.6, A 85.93.13.183, A 104.236.44.212, A 46.229.47.139, A 223.252.21.101, A 192.71.151.126, A 144.76.120.109 (201)
09:15:57.698443 IP 10.42.0.152.15292 > 10.42.0.1.53: 44337+ AAAA? pool.sks-keyservers.net. (41)
09:15:58.136982 IP 10.42.0.1.53 > 10.42.0.152.15292: 44337 10/0/0 AAAA 2604:a880:800:10::60d:b001, AAAA 2a03:4000:6:202e::1, AAAA 2a01:7a0:1::6, AAAA 2001:470:1f09:1d75::80, AAAA 2a01:4f8:a0:4024::2:0, AAAA 2a01:4f8:150:7142::2, AAAA 2001:41d0:2:a8b4::10, AAAA 2a02:168:4a01::37, AAAA 2604:a880:800:10::688:e001, AAAA 2001:6f8:124e::1 (321)
09:15:58.138270 IP 10.42.0.152.57903 > 10.42.0.1.53: 3651+ PTR? 212.44.236.104.in-addr.arpa. (45)
09:15:58.139749 IP 10.42.0.1.53 > 10.42.0.152.57903: 3651 1/0/0 PTR openpgp.us. (69)
09:15:58.140405 IP 10.42.0.152.49791 > 10.42.0.1.53: 29976+ PTR? 126.151.71.192.in-addr.arpa. (45)
09:15:58.142479 IP 10.42.0.1.53 > 10.42.0.152.49791: 29976 1/0/0 PTR mimir.alderwick.co.uk. (80)
09:15:58.142854 IP 10.42.0.152.20861 > 10.42.0.1.53: 61059+ PTR? 101.21.252.223.in-addr.arpa. (45)
09:15:58.144671 IP 10.42.0.1.53 > 10.42.0.152.20861: 61059 1/0/0 PTR svcs4.riverwillow.net.au. (83)
09:15:58.145031 IP 10.42.0.152.51574 > 10.42.0.1.53: 21456+ PTR? 139.47.229.46.in-addr.arpa. (44)
09:15:58.146670 IP 10.42.0.1.53 > 10.42.0.152.51574: 21456 1/0/0 PTR jarvis.alpha-labs.net. (79)
09:15:58.147016 IP 10.42.0.152.24483 > 10.42.0.1.53: 11392+ PTR? 79.51.9.176.in-addr.arpa. (42)
09:15:58.149302 IP 10.42.0.1.53 > 10.42.0.152.24483: 11392 1/0/0 PTR alita.karotte.org. (73)
09:15:58.149639 IP 10.42.0.152.45716 > 10.42.0.1.53: 51515+ PTR? 183.13.93.85.in-addr.arpa. (43)
09:15:58.150581 IP 10.42.0.1.53 > 10.42.0.152.45716: 51515 1/0/0 PTR host10.slyinvestment.com. (81)
09:15:58.151058 IP 10.42.0.152.31608 > 10.42.0.1.53: 34134+ PTR? 6.17.17.193.in-addr.arpa. (42)
09:15:58.153963 IP 10.42.0.1.53 > 10.42.0.152.31608: 34134 1/0/0 PTR key.ip6.li. (66)
09:15:58.154314 IP 10.42.0.152.37867 > 10.42.0.1.53: 56496+ PTR? 231.164.237.207.in-addr.arpa. (46)
09:15:58.156621 IP 10.42.0.1.53 > 10.42.0.152.37867: 56496 1/0/0 PTR keys.sflc.info. (74)
09:15:58.156959 IP 10.42.0.152.20412 > 10.42.0.1.53: 34648+ PTR? 43.163.224.193.in-addr.arpa. (45)
09:15:58.158943 IP 10.42.0.1.53 > 10.42.0.152.20412: 34648 1/0/0 PTR hufu.ki.iif.hu. (73)
09:15:58.159277 IP 10.42.0.152.46457 > 10.42.0.1.53: 32569+ PTR? 109.120.76.144.in-addr.arpa. (45)
09:15:58.161678 IP 10.42.0.1.53 > 10.42.0.152.46457: 32569 1/0/0 PTR encrypt.to. (69)
09:15:58.162290 IP 10.42.0.152.58716 > 10.42.0.1.53: 61479+ PTR? 0.0.0.0.2.0.0.0.0.0.0.0.0.0.0.0.4.2.0.4.0.a.0.0.8.f.4.0.1.0.a.2.ip6.arpa. (90)
09:15:58.163688 IP 10.42.0.1.53 > 10.42.0.152.58716: 61479 1/0/0 PTR a.keyserver.pki.scientia.net. (132)
09:15:58.164128 IP 10.42.0.152.32231 > 10.42.0.1.53: 26254+ PTR? 1.0.0.e.8.8.6.0.0.0.0.0.0.0.0.0.0.1.0.0.0.0.8.0.0.8.8.a.4.0.6.2.ip6.arpa. (90)
09:15:58.166679 IP 10.42.0.1.53 > 10.42.0.152.32231: 26254 0/0/0 (90)
09:15:58.167037 IP 10.42.0.152.15342 > 10.42.0.1.53: 14504+ PTR? 7.3.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.a.4.8.6.1.0.2.0.a.2.ip6.arpa. (90)
09:15:58.168514 IP 10.42.0.1.53 > 10.42.0.152.15342: 14504 1/0/0 PTR pgpkeys.urown.net. (121)
09:15:58.168872 IP 10.42.0.152.49875 > 10.42.0.1.53: 39926+ PTR? 0.1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.4.b.8.a.2.0.0.0.0.d.1.4.1.0.0.2.ip6.arpa. (90)
09:15:58.170820 IP 10.42.0.1.53 > 10.42.0.152.49875: 39926 NXDomain 0/0/0 (90)
09:15:58.171163 IP 10.42.0.152.32030 > 10.42.0.1.53: 45608+ PTR? 2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.2.4.1.7.0.5.1.0.8.f.4.0.1.0.a.2.ip6.arpa. (90)
09:15:58.173415 IP 10.42.0.1.53 > 10.42.0.152.32030: 45608 1/0/0 PTR alita.karotte.org. (121)
09:15:58.173779 IP 10.42.0.152.48813 > 10.42.0.1.53: 38867+ PTR? 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.e.4.2.1.8.f.6.0.1.0.0.2.ip6.arpa. (90)
09:15:59.037424 IP 10.42.0.1.53 > 10.42.0.152.48813: 38867 FormErr 0/0/0 (90)
09:15:59.037986 IP 10.42.0.152.57139 > 10.42.0.1.53: 19220+ PTR? 0.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.5.7.d.1.9.0.f.1.0.7.4.0.1.0.0.2.ip6.arpa. (90)
09:15:59.043902 IP 10.42.0.1.53 > 10.42.0.152.57139: 19220 NXDomain 0/0/0 (90)
09:15:59.044301 IP 10.42.0.152.52403 > 10.42.0.1.53: 1040+ PTR? 6.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.0.a.7.0.1.0.a.2.ip6.arpa. (90)
09:15:59.053424 IP 10.42.0.1.53 > 10.42.0.152.52403: 1040 1/0/0 PTR key.ip6.li. (114)
09:15:59.053950 IP 10.42.0.152.25246 > 10.42.0.1.53: 33858+ PTR? 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.e.2.0.2.6.0.0.0.0.0.0.4.3.0.a.2.ip6.arpa. (90)
09:15:59.056508 IP 10.42.0.1.53 > 10.42.0.152.25246: 33858 1/0/0 PTR metalgamer.eu. (117)
09:15:59.057051 IP 10.42.0.152.28425 > 10.42.0.1.53: 31847+ PTR? 1.0.0.b.d.0.6.0.0.0.0.0.0.0.0.0.0.1.0.0.0.0.8.0.0.8.8.a.4.0.6.2.ip6.arpa. (90)
09:15:59.058008 IP 10.42.0.1.53 > 10.42.0.152.28425: 31847 1/0/0 PTR openpgp.us. (114)

@_date: 2015-12-23 11:12:30
@_author: Matthias Apitz 
@_subject: keysearch fails 
El d?a Wednesday, December 23, 2015 a las 09:23:12AM +0100, Matthias Apitz escribi?:
Seems to be a known bug:
$ dirmngr
# Home: ~/.gnupg
# Config: /home/guru/.gnupg/dirmngr.conf
OK Dirmngr 2.1.6 at your service
KEYSERVER hkps://hkps.pool.sks-keyservers.net
KS_SEARCH matthew at FreeBSD.org
Assertion failed: (a >= 0 && a < hosttable_size), function
sort_hostpool, file ks-engine-hkp.c, line 179.
Abort trap (core dumped)

@_date: 2015-12-23 18:54:07
@_author: Matthias Apitz 
@_subject: signing mails with MUA mutt fails 
To sign mails one configure in the MUA the command in the following
gpg2 --batch --output - --passphrase-fd 0 --armor --sign --detach-sign --textmode -u %a %f
where %a is the actual user and %f the mail attachment to be signed; it
does not work and I digged into this;
this works as it should:
$ gpg2  --output - --armor --sign --detach-sign -u guru msg.asc
Please enter the passphrase to unlock the OpenPGP secret key:
"Matthias Apitz (GnuPGv2) "
2048-bit DSA key, ID FFEE762B922A6CBB,
created 2015-12-22.
 Passphrase: while this gives an error:
$ killall gpg-agent
$ echo xxxxxxxx | gpg2 --batch --output - --passphrase-fd 0 --armor --sign --detach-sign --textmode -u guru msg.asc gpg: signing failed:
gpg: signing failed: Invalid IPC response
gpg: signing failed: Invalid IPC response
running with --debug gives some kind of error in the communication with
the agent: $ killall gpg-agent
$ echo xxxxxxxx | gpg2 --debug 1024 --batch --output - --passphrase-fd 0 --armor --sign --detach-sign --textmode -u guru msg.asc
gpg: reading options from '/home/guru/.gnupg/gpg.conf'
gpg: enabled debug flags: ipc
gpg: DBG: chan_7 <- OK Pleased to meet you
gpg: DBG: connection to agent established
gpg: DBG: chan_7 -> RESET
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION ttytype=rxvt
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION display=:0
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION xauthority=/tmp/kde-guru/xauth-1001-_0
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION putenv=DBUS_SESSION_BUS_ADDRESS=unix:path=/tmp/dbus-O4oooGN9t0,guid=4cf4542b4bf772f2892b2ac3567aaf2d
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION allow-pinentry-notify
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> OPTION agent-awareness=2.1.0
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> AGENT_ID
gpg: DBG: chan_7 <- ERR 67109139 Unknown IPC command gpg: DBG: chan_7 -> HAVEKEY EF8AE0E0D3D7EBBFA6A0230CD105E0DFC04D9DE1 8FB0DD8249EC4A24E2A73B4721098FCDE815FEBB
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> RESET
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> SIGKEY EF8AE0E0D3D7EBBFA6A0230CD105E0DFC04D9DE1
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> SETKEYDESC Please+enter+the+passphrase+to+unlock+the+OpenPGP+secret+key:%0A%22Matthias+Apitz+(GnuPGv2)+%22%0A2048-bit+DSA+key,+ID+FFEE762B922A6CBB,%0Acreated+2015-12-22.%0A
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> SETHASH 8 B0E553EDE7C732CA26D96C45C32E6143AB642BF28E03217400C893CCB0F14B62
gpg: DBG: chan_7 <- OK
gpg: DBG: chan_7 -> PKSIGN
gpg: DBG: chan_7 <- INQUIRE PINENTRY_LAUNCHED 4886
gpg: DBG: chan_7 -> END
gpg: DBG: chan_7 <- ERR 83886340 Invalid IPC response gpg: signing failed: Invalid IPC response
gpg: signing failed: Invalid IPC response
gpg: secmem usage: 1568/32768 bytes in 3 blocks
What do I miss or do wrong?

@_date: 2015-12-23 21:41:50
@_author: Matthias Apitz 
@_subject: signing mails with MUA mutt fails 
El d?a Wednesday, December 23, 2015 a las 08:40:24PM +0100, Werner Koch escribi?:
Thanks for that hint! I have had to re-compile the mutt port (on
FreeBSD) to get this option to work, but it now works nicely.

@_date: 2015-12-24 09:15:46
@_author: Matthias Apitz 
@_subject: signing mails with MUA mutt fails 
El d?a Wednesday, December 23, 2015 a las 08:40:24PM +0100, Werner Koch escribi?:
As I said, it works very well; only pinentry is not popping up as an X
application (which I do not want either); a ps shows:
$ ps ax | egrep 'gnu|pin|mutt'
2374  -  Ss    0:00,01 gpg-agent --homedir /home/guru/.gnupg --use-standard-socket --daemon
2392  -  S     0:00,03 pinentry --display :0 (pinentry-tty)
2394  1  S+    0:00,00 egrep gnu|pin|mutt
2354  3  S+    0:00,23 mutt
and of course, I have DISPLAY=:0 in my env;
I only wanted to mention this for the records; for me it is fine;

@_date: 2015-12-24 17:02:54
@_author: Matthias Apitz 
@_subject: about cartoon in FAQ 10.1.  'Correct, horse! Battery staple!' 
I do not fully understand why some 4 random words like is a better passphrase like, for example i.e. some phrasing which could be memorized better?

@_date: 2015-12-25 18:41:30
@_author: Matthias Apitz 
@_subject: self signing the pub key 
I read that I should self-sign my pub key, but when I do this after
creation, it says:
$ LANG=C gpg2 --sign-key Matthias
pub  rsa2048/AA1EF4741F9046D4
     created: 2015-12-25  expires: never       usage: SC       trust: ultimate      validity: ultimate
sub  rsa2048/D6AD2EFF41863FE4
     created: 2015-12-25  expires: never       usage: E   [ultimate] (1). Matthias Apitz (GnuPG v2) "Matthias Apitz (GnuPG v2) " was already signed by key AA1EF4741F9046D4
Nothing to sign with key AA1EF4741F9046D4
Key not changed so no update needed.
What I do wrong?

@_date: 2015-12-25 20:11:03
@_author: Matthias Apitz 
@_subject: about cartoon in FAQ 10.1.  'Correct, horse! Battery staple!' 
El d?a Friday, December 25, 2015 a las 06:50:07PM +0100, Ingo Kl?cker escribi?:
Ofc, I would not have used this phrase, which is part of my signature :-)
This was only an example. I'd have used something from a book or
poem which was written before Internet-times and perhaps never published
Thanks for all hints in this thread.

@_date: 2016-04-28 11:26:52
@_author: Matthias Apitz 
@_subject: Top-posting 
El d?a Thursday, April 28, 2016 a las 11:02:30AM +0200, Paolo Bolzoni escribi?:
I have the feeling (and even could proof this with examples) that top
posters do not even read about what they are posting on top of. They just
want to say something, sometimes useless, because it is already
said/answered a few lines down).
Speaking more technically, the problem is that 'modern' MUA, like
OutLook crap, thunderbird or other browser-like MUA do not invite to
post and quote correctly. They put the cursor above the first line
(sometimes you can not even configure this, and also not the correct
citation with '> ') and they do not provide the required tools/commands to trim
the old text, i.e. for example delete 150 lines with just saying '150dd'
or '.,$-20d' or others. In these 'modern' MUA you must carefully place
the cursor with the mouse, highlight even more carefully the text you
want to delete, and doing this with the limitation of a smartphone is
really a PITA.
That's why I do prefer 'mutt' and 'vim'.

@_date: 2016-04-28 19:38:50
@_author: Matthias Apitz 
@_subject: Top-posting 
El d?a Thursday, April 28, 2016 a las 02:28:56PM +0200, Guan Xin escribi?:
Here comes the proofing example you asked for:
Someone put on top of some mails a question which has nothing todo with
the problems the other posters have faced.

@_date: 2016-04-29 07:37:58
@_author: Matthias Apitz 
@_subject: Top-posting 
El d?a Friday, April 29, 2016 a las 03:25:10PM +1000, Ben McGinnes escribi?:
I have mutt+vim on my Ubuntu mobile phone

@_date: 2016-04-29 17:09:52
@_author: Matthias Apitz 
@_subject: Top-posting 
El d?a Friday, April 29, 2016 a las 04:35:40PM +0200, Guan Xin escribi?:
You may look for more examples yourself, just open your eyes and you
will find them any day.

@_date: 2016-04-30 11:16:13
@_author: Matthias Apitz 
@_subject: Top-posting 
El d?a Saturday, April 30, 2016 a las 01:24:23AM +0200, Guan Xin escribi?:
Fine, that we agree in something. If you sign some contract, you do it
below the text after reading it, and your signature *below* is expression
of "yes I have read it". If you sign (post above) someone could think,
he/she has not read it. To avoid such thinking, it's better to not top
Mine too.

@_date: 2016-02-06 15:01:34
@_author: Matthias Apitz 
@_subject: Documentation format 
What about Markdown and gitbook? Here you have a living example:

@_date: 2016-03-30 20:43:28
@_author: Matthias Apitz 
@_subject: What am I missing? 
El d?a Wednesday, March 30, 2016 a las 01:26:23PM -0400, Mauricio Tavares escribi?:
The thread in general has less or nothing todo with GnuPG, but I
understand the interest in the technical background, used tools etc.
But we should not discuss here opinions about the politics of the "bad",
whoever could be named with this word. This would be really off-topic
and should be discussed elsewhere.
Just my 0.02 pesos cubanos

@_date: 2017-08-04 15:39:18
@_author: Matthias Apitz 
@_subject: Extraction of decryption session key without copying complete 
El d?a viernes, agosto 04, 2017 a las 01:59:57p. m. +0200, Werner Koch escribi?:
But this implies that everyone with priv access on the remote host could
abuse your secret key on your localhost, especially when a GnuPG-card is
used and you entered the PIN to unlock the secret key. I'm wrong?

@_date: 2017-07-02 20:49:03
@_author: Matthias Apitz 
@_subject: about CCID USB readers (Re: setting GnuPG card to 'not forces' 
El d?a jueves, junio 22, 2017 a las 08:28:57a. m. +0200, Matthias Apitz escribi?:
At the end of the day it turned out that this was an issue in the
FreeBSD' drivers and/or some raise conditions or electrical problem. I
removed some of the drivers which were searching the USB bus for devices
and now have only the XHCI driver in the kernel (disabled UHCI, OHCI and EHCI)
and with this, the detection of both cards (uTrust and Omnikey) is fine.

@_date: 2017-07-02 20:51:32
@_author: Matthias Apitz 
@_subject: using GnuPG card for Firefox master password 
I have a bunch of saved logins in Firefox, protected by some so called
master password. Is there a way for using the GnuPG card as the master
password, maybe some plug-in for FF?

@_date: 2017-07-04 12:07:33
@_author: Matthias Apitz 
@_subject: scdaemon does not "see" card insertion 
I have now the GnuPG card working fine for signing mails, SSH access and
even for using GnuPG crypted credentials in Firefox. The last issue I'm
struggling with is the use of card removal and card insert via the
'scd-event' to lock and unlock the KDE desktop.
The script 'scd-event' is only invoked on card removal (I do just en
echo of the args):
scd-event --reader-port 0 --old-code 0x0007 --new-code 0x0000 --status NOCARD
A card insert is only seen *after* some agent requires something, for
example the SSH client needs access to the secret key on the card; than
it says:
scd-event --reader-port 0 --old-code 0xFFFFFFFF --new-code 0x0007 --status USABLE
On the UNIX system level the card insert triggers via devd(8) the start
of /usr/local/sbin/pcscd and the card removal triggers a 'killall pcscd'.
This is working fine, i.e. an inserted card is useable immediately, requesting the PIN entry.
I created a file scdaemon.conf to get debug information, here is the
resulting log:
2017-07-04 11:33:51 scdaemon[4945.802016000] DBG: enter: apdu_get_status: slot=0 hang=0
2017-07-04 11:33:51 scdaemon[4945.802016000] DBG: leave: apdu_get_status => sw=0x0 status=7
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: enter: apdu_get_status: slot=0 hang=0
now the card is removed and /usr/local/sbin/pcscd is killed
2017-07-04 11:33:52 scdaemon[4945.802016000] pcsc_get_status_change failed: no service (0x8010001d)
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: leave: apdu_get_status => sw=0x1000c status=0
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: Removal of a card: 0
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: enter: apdu_close_reader: slot=0
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: enter: apdu_disconnect: slot=0
2017-07-04 11:33:52 scdaemon[4945.802016000] pcsc_disconnect failed: no service (0x8010001d)
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: leave: apdu_disconnect => sw=0x1000a
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: apdu_close_reader => 0x1000a (apdu_disconnect)
2017-07-04 11:33:52 scdaemon[4945.802016000] DBG: leave: apdu_close_reader => 0x0 (close_reader)
now scdaemon sits there, the card was already inserted again, nothing
now SSH needs the key, this awakes scdaemon again and it sees the card:
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: chan_7 <- SERIALNO
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: enter: apdu_open_reader: portstr=(null)
2017-07-04 11:34:28 scdaemon[4945.802017900] detected reader 'Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00'
2017-07-04 11:34:28 scdaemon[4945.802017900] detected reader ''
2017-07-04 11:34:28 scdaemon[4945.802017900] reader slot 0: not connected
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: leave: apdu_open_reader => slot=0 [pc/sc]
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: enter: apdu_connect: slot=0
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: feature: code=12, len=4, v=42330012
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: TLV properties: tag=01, len=2, v=00000000
2017-07-04 11:34:28 scdaemon[4945.802017900] DBG: TLV properties: tag=03, len=1, v=00000000
What should be changed too let scdaemon see the card insertion?

@_date: 2017-07-05 08:08:23
@_author: Matthias Apitz 
@_subject: scdaemon does not "see" card insertion 
El d?a mi?rcoles, julio 05, 2017 a las 09:23:06a. m. +0900, NIIBE Yutaka escribi?:
Thanks for all explanations. For now I implemented the scd-event script
DISPLAY=:0 export DISPLAY
if [ x$status = xNOCARD ]; then
    nohup /usr/local/lib/kde4/libexec/kscreenlocker_greet --immediateLock &
    while true; do
      # Signature key ....: 5E69 FBAC ...
      gpg2 --card-status | grep '5E69 FBAC' >> /tmp/scd-event.log  && {
      killall kscreenlocker_greet
      break
      }
      sleep 1      done
which works nice: on card removal it locks the screen and on card insert
it unlocks it fine.
No, you are correct, I was inprecise.

@_date: 2017-07-10 09:09:58
@_author: Matthias Apitz 
@_subject: storing PINs of credit / EC cards with GnuPG 
This question is perhaps only for German users of GnuPG. In the past
German banks and credit institutes prohibited the storing of PIN numbers
etc. on personal computer systems, even claiming that in the case of storing
they would not have been responsible anymore for the abuse of stolen
credit cards.
What is the current situation about this issue in the German law if such
PIN numbers are stored ciphered with GnuPG?

@_date: 2017-07-10 19:52:03
@_author: Matthias Apitz 
@_subject: Changing PINs of German bank card 
El d?a lunes, julio 10, 2017 a las 11:42:12p. m. +0800, Guan Xin escribi?:
Nowadays some German banks allow changing the PIN in the Teller
Machines. I saw it today in an ATM of the Sparkasse. Amex allows (or allowed) requesting a new personal PIN by fax.

@_date: 2017-07-11 21:09:15
@_author: Matthias Apitz 
@_subject: Changing PINs of German bank card 
El d?a martes, julio 11, 2017 a las 07:38:08p. m. +0100, MFPA escribi?:
Why 1234 is an idiotic PIN? What are idiotic PINs? Of course, idiotic is
any PIN which has in your pocket hints about this (like a sticker attached
or your birthday). But remember, you normally have 3 tries only to test
all "idiotic" PINs. 1234 is same idiotic as 2345 or as 3456 or .... or as
6666, or 7777, or ...

@_date: 2017-07-13 12:49:42
@_author: Matthias Apitz 
@_subject: use policy of the GnuPG-card 
I'm using the GnuPG card for signing, SSH, password-store (Firefox web passwords)
and locking un-locking the KDE desktop on card-insert or withdraw.
After resolving some technical (FreeBSD) issues, I now have it on daily
usage on my netbook and my workstation in the office.
One problem comes obviously in mind: Someone with priv access to your workstation,
for example IT personal, could relatively easy steal your passwords, just setting your
environment and waiting for the moment that you have unlocked the card with the PIN;
than he/she could run as root:
# GNUPGHOME=/home/guru/.gnupg-ccid export GNUPGHOME
# PASSWORD_STORE_DIR=/home/guru/.password-store export PASSWORD_STORE_DIR
# pass Business/cheese-whiz-factory
gpg: WARNING: unsafe ownership on homedir '/home/guru/.gnupg-ccid'
It would also not help to just withdraw the card after any short usage, for example to
fire up a SSH session. The attacker could just sit in background waiting for this short moment,
which is long enough to copy all your passwords in to clear mode and send them away.
How is this supposed to be managed?
         matthias

@_date: 2017-07-15 13:51:36
@_author: Matthias Apitz 
@_subject: Changing PINs of German bank card 
One of every 10.000 will get this number, you need only luck to get ro know someone, as you had.

@_date: 2017-07-16 21:25:28
@_author: Matthias Apitz 
@_subject: use policy of the GnuPG-card 
El d?a jueves, julio 13, 2017 a las 03:57:47p. m. +0200, Werner Koch escribi?:
Why we only have a counter for the signing key?

@_date: 2017-06-01 08:48:34
@_author: Matthias Apitz 
@_subject: about how the MUA mutt signs mails 
When I send signed mails to me with the MUA mutt (just for test) the
received mail is verified fine in mutt, i.e. it says in mutt:
    [-- Begin signature information --]
    Good signature From: guru at unixarea.de (Matthias Apitz (GnuPG CCID))
            created: Wed May 31 21:40:19 2017
    [-- End signature information --]
    [-- The following data is signed --]
    hello
    [-- End of signed data --]
but when I save the signature part into a file 'signature.asc' and the
ASCII content of the mail as a file 'data' from the menu in mutt:
q:Exit  s:Save  |:Pipe  p:Print  ?:Help
  I     1                                           [text/plain, 7bit, utf-8, 0.1K]
  I     2 signature.asc                                            [applica/pgp-signat, 7bit, 0.8K]
and run:
$ gpg2 --verify signature.asc data
gpg: Signature made Wed May 31 21:40:19 2017 CEST
gpg:                using RSA key 5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11
gpg: BAD signature from "Matthias Apitz (GnuPG CCID) " [ultimate]
it says 'BAD signature'.
Why the file 'data' has BAD signature? The file 'data' after saving from
mutt from the above menu just contains:
$ cat data
$ od -c data
0000000    h   e   l   l   o  \n  \n
I digged into this trussing the mutt-gpg2 process chain and it turned out that
the netto data which verifies mutt is:
$ od -c data.asc
0000000    C   o   n   t   e   n   t   -   T   y   p   e   :       t   e
0000020    x   t   /   p   l   a   i   n   ;       c   h   a   r   s   e
0000040    t   =   u   t   f   -   8  \r  \n   C   o   n   t   e   n   t
0000060    -   D   i   s   p   o   s   i   t   i   o   n   :       i   n
0000100    l   i   n   e  \r  \n  \r  \n   h   e   l   l   o  \r  \n  \r
0000120   \n
i.e. containes as well some mail header line about the content and charset and esp.
as well \r\n line terminators. If I modify the file to this it is fine:
$ gpg2 --verify signature.asc data.asc
gpg: Signature made Wed May 31 21:40:19 2017 CEST
gpg:                using RSA key 5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11
gpg: Good signature from "Matthias Apitz (GnuPG CCID) " [ultimate]
Is this correct how mutt signs such mail bodies?

@_date: 2017-06-01 11:27:37
@_author: Matthias Apitz 
@_subject: about how the MUA mutt signs mails 
El d?a Thursday, June 01, 2017 a las 10:00:12AM +0100, Darac Marjal escribi?:
Thank you very much for your enlightened explanation and ...
... and for your nice signature.

@_date: 2017-06-08 12:29:56
@_author: Matthias Apitz 
@_subject: setting GnuPG card to 'not forces' does not let sign 
I was tired of having always enter the PIN when sending mails to sign them
and switched the card to 'not forces':
Signature PIN ....: not forced
After this (without withdrawing the card, i.e. the PIN was already
entered around 10 times and the card unlocked), the signing says:
$ echo bla > test.doc
$ LANG=C
$ gpg2 --armor --output test.doc.signed --sign test.doc
gpg: signing failed: Bad PIN
gpg: signing failed: Bad PIN
The bad PIN counter in the card is not decremented. Switching the card
back to 'forced' makes signing with PIN working again.
What do I wrong?

@_date: 2017-06-08 12:48:55
@_author: Matthias Apitz 
@_subject: Fwd: RE: setting GnuPG card to 'not forces' does not let sign 
Every time I write to gnupg-users at gnupg.org I get this crap from a robot
or from Sarah about dating. Can someone do anything that he/she/it is not
Sarah, I have no intention to click on the URL and much less to click on
you. Crap.

@_date: 2017-06-08 14:08:56
@_author: Matthias Apitz 
@_subject: Fwd: RE: setting GnuPG card to 'not forces' does not let sign 
El d?a jueves, junio 08, 2017 a las 01:18:35p. m. +0200, Peter Lebbing escribi?:
Perhaps, when the spambot sees part of his 1st message in the incoming
mail, it reacts on this.
I have it blacklisted now in my spamassassin config.

@_date: 2017-06-09 08:23:42
@_author: Matthias Apitz 
@_subject: Fwd: RE: setting GnuPG card to 'not forces' does not let sign 
El d?a viernes, junio 09, 2017 a las 08:06:50a. m. +0200, Werner Koch escribi?:
Thanks for this.
Re/ the issue itself, it seems that a complete restart of the chain
gpg-agent -- scdaemon -- /usr/local/sbin/pcscd
fixed the issue. It asks now once for the PIN for signing and then not
again until reboot.
Thanks as well for the nice hint about X-message-flag: header line.
The warning looks really nice in the crappy MS OutLook.

@_date: 2017-06-09 08:39:11
@_author: Matthias Apitz 
@_subject: setting GnuPG card to 'not forces' does not let sign 
El d?a viernes, junio 09, 2017 a las 08:09:12a. m. +0200, Werner Koch escribi?:
As I wrote in the last mail, it works now like it should and for signing
as for SSH I only have to enter the PIN once.
I have one last remaining issue with this GnuPG card and/or my USB
device HID Global OMNIKEY 6121 Smart Card Reader and/or FreeBSD, i.e.
its totally unclear at the moment what is causing it:
Sometimes (let's say in 50% of the cases) the USB device is not seen by
the FreeBSD kernel on power-on boot, even if the OMNIKEY is already inserted before
power-on. When it is not seen on boot, it is not seen on withdraw and
re-insert. When it is seen, it is always seen, i.e. one can re-insert as
much as you want, it always works. Sometimes not even a re-boot helps, it
takes 2-3 re-boots to get the OMNIKEY seen.
I know, this is not a GnuPG issue, but I wanted to mention it here to
ask if others has similar experiences, even on Linux or other OS, or if
it worth to get a new OMNIKEY device or even another device.

@_date: 2017-06-11 20:07:12
@_author: Matthias Apitz 
@_subject: changing the passphrase of the secret key stored in the GnuPG card 
How could I change the passphrase I have entered while generating the
keys on the GnuPG card? I tried with no success:
$ LANG=C gpg2 --edit-key Matthias passwd
gpg (GnuPG) 2.1.19; Copyright (C) 2017 Free Software Foundation, Inc.
Secret key is available.
sec  rsa4096/47CCF7E476FE9D11
     created: 2017-05-14  expires: never       usage: SC       card-no: 0005 0000532B
     trust: ultimate      validity: ultimate
ssb  rsa4096/6AA5C5C451A1CD1C
     created: 2017-05-14  expires: never       usage: A        card-no: 0005 0000532B
ssb  rsa4096/61F1ECB625C9A6C3
     created: 2017-05-14  expires: never       usage: E        card-no: 0005 0000532B
[ultimate] (1). Matthias Apitz (GnuPG CCID) Key has only stub or on-card key items - no passphrase to change.
gpg>

@_date: 2017-06-11 21:05:54
@_author: Matthias Apitz 
@_subject: changing the passphrase of the secret key stored in the GnuPG card 
El d?a domingo, junio 11, 2017 a las 08:51:58p. m. +0200, Werner Koch escribi?:
I know, but I want to change the passphrase, not the PIN.

@_date: 2017-06-11 21:48:47
@_author: Matthias Apitz 
@_subject: changing the passphrase of the secret key stored in the GnuPG card 
El d?a domingo, junio 11, 2017 a las 09:37:51p. m. +0200, Peter Lebbing escribi?:
I have the feeling, we talk about different things. When I generated the
keys on the card, the following part of the dialog appeared in my
This key (or subkey) is not protected with a passphrase.  Please enter a new passphrase to export it.
Passphrase: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
gpg: Note: backup of card key saved to '/home/guru/.gnupg/sk_61F1ECB625C9A6C3.gpg'
gpg: /home/guru/.gnupg/trustdb.gpg: trustdb created
gpg: key 47CCF7E476FE9D11 marked as ultimately trusted
gpg: directory '/home/guru/.gnupg/openpgp-revocs.d' created
gpg: revocation certificate stored as '/home/guru/.gnupg/openpgp-revocs.d/5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11.rev'
public and secret key created and signed.
My question remains: How can I change (or verify) the above Passphrase I
have used?

@_date: 2017-06-12 07:31:58
@_author: Matthias Apitz 
@_subject: changing the passphrase of the secret key stored in the GnuPG card 
El d?a domingo, junio 11, 2017 a las 10:00:00p. m. +0200, Peter Lebbing escribi?:
Now we are on track with my question. The background is/was: what
exactly I have todo with this backup key, for example in case the GnuPG
card gets lost or stolen? How can I simulate this and check if the
passphrase works correctly.

@_date: 2017-06-12 12:38:25
@_author: Matthias Apitz 
@_subject: setting GnuPG card to 'not forces' does not let sign 
El d?a domingo, junio 11, 2017 a las 08:59:37p. m. +0200, Werner Koch escribi?:
Do you know of any other CCID reader for ID-000 size cards?

@_date: 2017-06-12 14:15:01
@_author: Matthias Apitz 
@_subject: changing the passphrase of the secret key stored in the GnuPG card 
El d?a lunes, junio 12, 2017 a las 01:28:28p. m. +0200, Damien Goutte-Gattat escribi?:
I did what you suggested, but:
$ pwd
$ rm -f private-keys-v1.d/*.key
$ GNUPGHOME=/home/guru/.gnupg-test export GNUPGHOME
gpg2 --import sk_61F1ECB625C9A6C3.gpg
gpg: key 61F1ECB625C9A6C3: no user ID
gpg: Total number processed: 1
gpg:       secret keys read: 1
$ ls -l sk_61F1ECB625C9A6C3.gpg
-r--------  1 guru  wheel  1865 May 14 20:29 sk_61F1ECB625C9A6C3.gpg
the file is what was swritte as backup on May 14.
Any idea what I do wrong?

@_date: 2017-06-12 20:12:57
@_author: Matthias Apitz 
@_subject: GnuPG card && using the backup secret key 
Please note: I have changed the Subject: of the thread to match better
the real problem. During generating the keys on the GnuPG card, one can (and should)
create some backup of the secret key into a file. It is totally unclear
to me how to make something usefull out of this file, for example import
it into a "normal" secret keyring to use it in case of the GnuPG acrd
gots lost.
I followed some hints of  Damien Goutte-Gattat (thanks) and did:
With Don Google I found this older thread in this mailing list here:
where Werner said after some (today outdated) hints:
?... Put a "disable-scdaemon" into gpg-agent.conf, give gpg-agent a HUP and
check that no scdaemon is running anymore (you may just kill it). Then
use "gpg --no-use-agent --edit-key". The command "bkuptocard" may then
be used to store a backup key on a card.
Yes, we really need a howto on recovering smartcard keys. ...?
Was such a howto ever written?

@_date: 2017-06-13 12:20:25
@_author: Matthias Apitz 
@_subject: GnuPG card && using the backup secret key 
El d?a martes, junio 13, 2017 a las 11:52:46a. m. +0200, Thomas Jarosch escribi?:
Hi Thomas,
Thanks for your posting, but now I'm really confused. The howto about
the card in 3.3.2. Generating keys
To generate a key on the card enter generate. You will be asked if you would like to make an off-card copy of the encryption key. It is useful to say yes here.
Without a backup you will not be able to access any data you encrypted
with the card if it gets lost or damaged.
and as well in the dialog of the key creation on the card it said:
Please enter a new passphrase to export it.
Frase contrase?a: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
gpg: Note: backup of card key saved to '/home/guru/.gnupg/sk_61F1ECB625C9A6C3.gpg'
gpg: /home/guru/.gnupg/trustdb.gpg: trustdb created
gpg: key 47CCF7E476FE9D11 marked as ultimately trusted
gpg: directory '/home/guru/.gnupg/openpgp-revocs.d' created
gnupg-card.txtgpg: revocation certificate stored as '/home/guru/.gnupg/openpgp-revocs.d/5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11.rev'
public and secret key created and signed.
gpg/card> quit
I will have a look into the paper backup tool; sounds handy.

@_date: 2017-06-13 12:51:01
@_author: Matthias Apitz 
@_subject: GnuPG card && using the backup secret key 
El d?a martes, junio 13, 2017 a las 11:58:51a. m. +0200, Werner Koch escribi?:
I tried (~/.gnupg-test is a copy of my normal GNUPGHOME):
$ cd .gnupg-test/
$ GNUPGHOME=`pwd`
$ env | grep GNU
$ ls -l sk_61F1ECB625C9A6C3.gpg
-r--------  1 guru  wheel  1865 May 14 20:29 sk_61F1ECB625C9A6C3.gpg
$ gpg2 --edit-key sk_61F1ECB625C9A6C3.gpg
gpg (GnuPG) 2.1.19; Copyright (C) 2017 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
gpg: key "sk_61F1ECB625C9A6C3.gpg" not found: No public key
$ gpg2 --import ../GnuPG/ccid--export-key-guru.pub
gpg: key 47CCF7E476FE9D11: "Matthias Apitz (GnuPG CCID) " not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
The file "ccid--export-key-guru.pub" was created from the card with:
$ gpg2 --export --armor > ccid--export-key-guru.pub

@_date: 2017-06-13 13:35:52
@_author: Matthias Apitz 
@_subject: GnuPG card && using the backup secret key 
El d?a martes, junio 13, 2017 a las 02:30:05p. m. +0300, Teemu Likonen escribi?:
I did 1:1 what Werner suggested;
This is not working as I said yesterday:
$ gpg2 --import sk_61F1ECB625C9A6C3.gpg
gpg: key 61F1ECB625C9A6C3: no user ID
gpg: Total number processed: 1
gpg:       secret keys read: 1
Btw: the publickey is there:
gpg2 --list-keys
pub   rsa4096 2017-05-14 [SC]
      5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11
uid           [ultimate] Matthias Apitz (GnuPG CCID) sub   rsa4096 2017-05-14 [A]
sub   rsa4096 2017-05-14 [E]

@_date: 2017-06-16 20:46:24
@_author: Matthias Apitz 
@_subject: setting GnuPG card to 'not forces' does not let sign 
El d?a lunes, junio 12, 2017 a las 12:58:23p. m. +0200, Werner Koch escribi?:
I bought the uTrust token in the above mentioned FLOSS-shop and it arrived today.
It shows in my netbook the same problem as the other one from Omnikey:
it is not always detected at power-on boot:
In the boot at 14:17:02 it is seen, while later it takes three boot to be
seen by the kernel:
Jun 16 14:17:02 c720-r314251 syslogd: kernel boot file is /boot/kernel/kernel
Jun 16 14:17:02 c720-r314251 kernel: ugen0.2:  at usbus0
Jun 16 20:20:48 c720-r314251 syslogd: kernel boot file is /boot/kernel/kernel
Jun 16 20:23:28 c720-r314251 syslogd: kernel boot file is /boot/kernel/kernel
Jun 16 20:25:49 c720-r314251 syslogd: kernel boot file is /boot/kernel/kernel
Jun 16 20:25:49 c720-r314251 kernel: ugen0.4:  at usbus0
Perhaps, it is more a netbook's (Acer C720) or FreeBSD issue.

@_date: 2017-06-22 08:28:57
@_author: Matthias Apitz 
@_subject: about CCID USB readers (Re: setting GnuPG card to 'not forces' does 
El d?a lunes, junio 12, 2017 a las 12:58:23p. m. +0200, Werner Koch escribi?:
Some days ago I acquired this uTrust token. And surprise, surprise, it
showed the same symptoms as the other one, the HID Global OMNIKEY 6121
Smart Card Reader: My operating system does not always recognises the
USB device, not even when plug'ed in before power-on. This smells
somehow as a hardware issue in the Acer C720 or in the kernel of the
FreeBSD (and I do run CURRENT on it, i.e. compiled directly from SVN).
Here is the bug issue I filed against our beloved FreeBSD:
Only if someone has similar experiences.
I tested a lot with this issue and now have some trick which seems to
make it at least less often fail: I insert the uTrust token before
power-on, start the laptop but hold the boot in the moment when you can
modify certain boot options, i.e. the device is powered on but awaiting
a keyboard input to continue loading the kernel. Only a few seconds.
Then the booting kernel sees the device as:
ugen0.2:  at usbus0
Is there something in the cards firmware which needs some time to come

@_date: 2017-05-15 19:25:12
@_author: Matthias Apitz 
@_subject: Using a GnuPG CCID card in another computer 
I have a GnuPG smart card OMNIKEY 6121 Mobile USB and configured its
use in my FreeBSD 12-CURRENT netbook, generated keys and I'm able to use
it to login with SSH into other servers (after moving the pub key to
the server into ~/.ssh/authorized_keys); the only tricky part was to figure
out how to enter the PIN behind 'ssh' --> 'gpg-agent' --> /usr/local/bin/pinentry
So far so good.
Now I wanted the same SIM in another FreeBSD workstation (at work), but when
I do use it there, for example with 'gpg2 --card-status', there is no key in the
card and as well 'gpg2 --export-ssh-key guru' does not know how to
export the key due to missing pub key. Should I move the full content of ~/.gnupg as well to the 2nd computer?
And if so, why? I was thinking that all the key material (apart of the
backup) is on the SIM and I only need its PIN...

@_date: 2017-05-16 07:55:54
@_author: Matthias Apitz 
@_subject: Using a GnuPG CCID card in another computer (follow-up) 
El d?a lunes, mayo 15, 2017 a las 07:25:12p. m. +0200, Matthias Apitz escribi?:
I have now copied all the files below to the other workstation and now all is
fine there too, i.e. I can export the pub key with 'gpg2 --export-ssh-key guru'
and use it for SSH being asked for the PIN of the card. The files are:
$ ls -lR .gnupg
total 52
-rw-------  1 guru  wheel  2649 12 may.  22:41 dirmngr.conf
-rw-r--r--  1 guru  wheel    19 15 may.  11:41 gpg-agent.conf
-rw-------  1 guru  wheel  5191 12 may.  22:41 gpg.conf
drwx------  2 guru  wheel   512 14 may.  20:30 openpgp-revocs.d
drwx------  2 guru  wheel   512 14 may.  20:29 private-keys-v1.d
-rw-r--r--  1 guru  wheel  3573 14 may.  20:30 pubring.kbx
-rw-------  1 guru  wheel    32 12 may.  22:41 pubring.kbx~
-rw-------  1 guru  wheel   600 15 may.  09:58 random_seed
-rw-r--r--  1 guru  wheel     7 15 may.  15:21 reader_0.status
-rw-------  1 guru  wheel  1865 14 may.  20:29 sk_61F1ECB625C9A6C3.gpg
-rw-r-----  1 guru  wheel   676 15 may.  11:45 sshcontrol
-rw-------  1 guru  wheel  1280 15 may.  09:23 trustdb.gpg
total 4
-rw-------  1 guru  wheel  1799 14 may.  20:30 5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11.rev
total 24
-rw-------  1 guru  wheel  1873 14 may.  20:17 147F71A678B411855B4BCCC48FAEC8689B5E1C23.key
-rw-------  1 guru  wheel   615 14 may.  20:29 314DE72F03D41683E06A504769970A1643825B38.key
-rw-------  1 guru  wheel   617 14 may.  20:09 45BDBABA30A3511D507B8A08A28D425F7CD417C6.key
-rw-------  1 guru  wheel   615 14 may.  20:29 7E22A904DB3BE5A98F98AFDEED61DF1364DD949B.key
-rw-------  1 guru  wheel   615 14 may.  20:29 937BA1F6A95F68222EC2C6F9573100E17EE9522E.key
-rw-------  1 guru  wheel   617 14 may.  20:17 B0E0BFC22F116B541848DF6593B418BBB63C0CC0.key
When I generated the keys on the card (gpg2 --cardedit --> admin --> generate)
on May 14, I have had to do this twice because I was logged out from the card due to
to long thinking about the passphrase for the backup of the key to the file
sk_61F1ECB625C9A6C3.gpg; one can see this on the time of the files below
.gnupg/private-keys-v1.d; the 2nd run started around 20:20 and was
successful at 20:29.
The question remains: Why I do have to move the files below .gnupg/ to
the other workstation? And, what are the files below .gnupg/private-keys-v1.d
are exactly?

@_date: 2017-05-16 11:56:59
@_author: Matthias Apitz 
@_subject: Using a GnuPG CCID card in another computer (follow-up) 
El d?a martes, mayo 16, 2017 a las 11:12:18a. m. +0200, Peter Lebbing escribi?:
Thanks for the two tips re/ the pub key; I did so and now it works:
I exported the pub key with:
$ gpg2 --export --armor > ccid--export-key-guru.pub
placed it on my webserver and configured its URL with the card's url-command
URL of public key : On the 2nd workstation I moved away the GNUPGHOME:
$ env | grep GNU
$ mv .gnupg-ccid .gnupg-ccid-saved
gpg2 is unwilling to start due to missing dir and I have had
to create it with mkdir:
$ gpg2 --card-status
gpg: keyblock resource '/home/guru/.gnupg-ccid/pubring.kbx': No such file or directory
gpg: failed to create temporary file '/home/guru/.gnupg-ccid/. No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: OpenPGP card not available: No agent running
$ mkdir /home/guru/.gnupg-ccid
$ chmod 0700 /home/guru/.gnupg-ccid
As you can see the keys are completely missing in the card's status:
$ gpg2 --card-status
gpg: keybox '/home/guru/.gnupg-ccid/pubring.kbx' created
Reader ...........: HID Global OMNIKEY 6121 Smart Card Reader 00 00
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
Language prefs ...: en
Sex ..............: unspecified
URL of public key : Login data .......: [not set]
Signature PIN ....: forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 4
Signature key ....: 5E69 FBAC 1618 562C B3CB  FBC1 47CC F7E4 76FE 9D11
      created ....: 2017-05-14 18:20:07
Encryption key....: EB62 00DA 13A1 9E80 679B  1A13 61F1 ECB6 25C9 A6C3
      created ....: 2017-05-14 18:20:07
Authentication key: E51D D2D6 C727 35D6 651D  EA4B 6AA5 C5C4 51A1 CD1C
      created ....: 2017-05-14 18:20:07
General key info..: [none]
but after fetching the pub key, all is fine:
[guru at r314251-amd64 ~]$ gpg2 --card-edit  Reader ...........: HID Global OMNIKEY 6121 Smart Card Reader 00 00
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
Language prefs ...: en
Sex ..............: unspecified
URL of public key : Login data .......: [not set]
Signature PIN ....: forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 4
Signature key ....: 5E69 FBAC 1618 562C B3CB  FBC1 47CC F7E4 76FE 9D11
      created ....: 2017-05-14 18:20:07
Encryption key....: EB62 00DA 13A1 9E80 679B  1A13 61F1 ECB6 25C9 A6C3
      created ....: 2017-05-14 18:20:07
Authentication key: E51D D2D6 C727 35D6 651D  EA4B 6AA5 C5C4 51A1 CD1C
      created ....: 2017-05-14 18:20:07
General key info..: [none]
gpg/card> fetch
gpg: requesting key from '
gpg: /home/guru/.gnupg-ccid/trustdb.gpg: trustdb created
gpg: key 47CCF7E476FE9D11: public key "Matthias Apitz (GnuPG CCID) " imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg/card> list
Reader ...........: HID Global OMNIKEY 6121 Smart Card Reader 00 00
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
Language prefs ...: en
Sex ..............: unspecified
URL of public key : Login data .......: [not set]
Signature PIN ....: forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 4
Signature key ....: 5E69 FBAC 1618 562C B3CB  FBC1 47CC F7E4 76FE 9D11
      created ....: 2017-05-14 18:20:07
Encryption key....: EB62 00DA 13A1 9E80 679B  1A13 61F1 ECB6 25C9 A6C3
      created ....: 2017-05-14 18:20:07
Authentication key: E51D D2D6 C727 35D6 651D  EA4B 6AA5 C5C4 51A1 CD1C
      created ....: 2017-05-14 18:20:07
General key info..: pub  rsa4096/47CCF7E476FE9D11 2017-05-14 Matthias Apitz (GnuPG CCID) sec>  rsa4096/47CCF7E476FE9D11  created: 2017-05-14  expires: never
                                card-no: 0005 0000532B
ssb>  rsa4096/6AA5C5C451A1CD1C  created: 2017-05-14  expires: never
                                card-no: 0005 0000532B
ssb>  rsa4096/61F1ECB625C9A6C3  created: 2017-05-14  expires: never
                                card-no: 0005 0000532B
I run strings for these files and it shows for example:
$ strings -n8 314DE72F03D41683E06A504769970A1643825B38.key
I did so and it seems that the keys are on the card:
$ gpg2 --with-keygrip -K
sec>  rsa4096 2017-05-14 [SC]
      5E69FBAC1618562CB3CBFBC147CCF7E476FE9D11
      Keygrip = 937BA1F6A95F68222EC2C6F9573100E17EE9522E
      Card serial no. = 0005 0000532B
uid           [ultimate] Matthias Apitz (GnuPG CCID) ssb>  rsa4096 2017-05-14 [A]
      Keygrip = 7E22A904DB3BE5A98F98AFDEED61DF1364DD949B
ssb>  rsa4096 2017-05-14 [E]
      Keygrip = 314DE72F03D41683E06A504769970A1643825B38
Thanks for your explanations and help. Maybe the FAQ should be expanded
with this.

@_date: 2017-05-22 21:28:27
@_author: Matthias Apitz 
@_subject: Unknown key type 
El d?a lunes, mayo 22, 2017 a las 02:06:56p. m. -0400, Brian Minton escribi?:
piping the above mail to gpg2 (2.1.19) gives:
If I had to guess, Id say the sender of those messages is using ECC keys.
 They are only supported in GnuPG 2.1.  In fact, Im using such a key to
sign this message (but my key also has a DSA subkey, so gpg 2.0 should
still verify the signature). So, you may see the warning on this message.
gpg: Signature made Mon May 22 20:06:33 2017 CEST
gpg:                using EDDSA key EED0158013DC2E6D6E001EA437B9507ACFF2016E
gpg: Can't check signature: No public key
gpg: Signature made Mon May 22 20:06:33 2017 CEST
gpg:                using DSA key F9C4BB760E783F0DEC10A68A6B8EB3A065CFBAA9
gpg: Can't check signature: No public key

@_date: 2017-11-15 09:06:32
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
I'm using the OpenPGP Card on Unix (FreeBSD) and on my Ubuntu mobile
phone (see mostly for storing credentials with the password manager 'pass' and using them
from the browser, and as well for signing mails.
At work I have to use a Win7 desktop and OutLook for the company mails
and FreeBSD with GnuPG must run in a Vbox, which works fine with the OpenPGP
Card too.
I'd like to use the same Card with OutLook (please don't blame me :-))
and have already installed gpg4win-3.0.0.exe which seems to work
together with OutLook.
Before digging into all the details by my own and esp. because in Windows I'm only a
DAU(*), is there some step by step guide to configure the OpenPGP Card in
Windows and using the files from the GNUPGHOME on FreeBSD in Windows?
DAU(*): This is German spelled for "D?mmster Anzunehmender User" (the most
stupid imaginable user)

@_date: 2017-11-16 13:56:34
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a mi?rcoles, noviembre 15, 2017 a las 12:19:30p. m. +0100, Werner Koch escribi?:
I copied over GNUPGHOME and gpa and OutLook can see/use the pub key. To
get access to the Card, I need some driver in Win7. Do you know any
reliable place to fetch from.

@_date: 2017-11-18 10:47:27
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a jueves, noviembre 16, 2017 a las 07:23:03p. m. +0100, Werner Koch escribi?:
It seems that the USB token is fine, but the Card is not (see
 )
I installed some driver and after this the the problem symbol (!) is away,
but neither GPA nor Kleopatra can use the Card.

@_date: 2017-11-17 16:09:25
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a jueves, noviembre 16, 2017 a las 07:23:03p. m. +0100, Werner Koch escribi?:
It seems that the USB token is fine, but the Card is not (see
I installed some driver and after this the the problem symbol is away,
but neither GPA nor Kleopatra can use the Card.

@_date: 2017-11-20 08:56:12
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a domingo, noviembre 19, 2017 a las 03:20:16p. m. +0100, Peter Lebbing escribi?:
Thanks for your feedback, Peter.
I killed a running SmartCard Service on Win7 and tested GnuPG on a
Cygwin command line. It says:
$ uname -a
CYGWIN_NT-6.1 APITZM-LTOH 2.7.0(0.306/5/3) 2017-02-12 13:18 x86_64 Cygwin
$ gpg --version
gpg (GnuPG) 2.2.1
libgcrypt 1.8.1
Copyright (C) 2017 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Home: C:/Users/apitzm/AppData/Roaming/gnupg
Supported algorithms:
Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2
$ gpg --card-status --debug-all --debug-level guru gpg: reading options from 'C:/Users/apitzm/AppData/Roaming/gnupg/gpg.conf'
gpg: enabled debug flags: packet mpi crypto filter iobuf memory cache memstat trust hashing ipc clock lookup extprog
gpg: DBG: [not enabled in the source] start
gpg: DBG: chan_0x000000d8 <- OK Pleased to meet you
gpg: DBG: connection to agent established
gpg: DBG: chan_0x000000d8 -> RESET
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> OPTION ttytype=xterm
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> GETINFO version
gpg: DBG: chan_0x000000d8 <- D 2.2.1
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> OPTION allow-pinentry-notify
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> OPTION agent-awareness=2.1.0
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> SCD GETINFO version
gpg: DBG: chan_0x000000d8 <- D 2.2.1
gpg: DBG: chan_0x000000d8 <- OK
gpg: DBG: chan_0x000000d8 -> SCD SERIALNO openpgp
gpg: DBG: chan_0x000000d8 <- ERR 100696144 No such device gpg: selecting openpgp failed: No such device
gpg: OpenPGP card not available: No such device
gpg: DBG: [not enabled in the source] stop
gpg: keydb: handles=0 locks=0 parse=0 get=0
gpg:        build=0 update=0 insert=0 delete=0
gpg:        reset=0 found=0 not=0 cache=0 not=0
gpg: kid_not_found_cache: count=0 peak=0 flushes=0
gpg: sig_cache: total=0 cached=0 good=0 bad=0
gpg: random usage: poolsize=600 mixed=0 polls=0/0 added=0/0
              outmix=0 getlvl1=0/0 getlvl2=0/0
gpg: rndjent stat: collector=0x00000000 calls=0 bytes=0
gpg: secmem usage: 0/32768 bytes in 0 blocks
It does not make any difference, if I also start the scdaemon with
$ scdaemon --daemon &
or not.

@_date: 2017-11-20 20:09:29
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a lunes, noviembre 20, 2017 a las 03:07:44p. m. +0100, Peter Lebbing escribi?:
This gives the same output as from Cygwin:
C:\Users\apitzm\vb\GnuPG\bin>gpg.exe --card-status --debug-all --debug-level guru
gpg: Optionen werden aus
'C:/Users/apitzm/AppData/Roaming/gnupg/gpg.conf' gelesen
gpg: enabled debug flags: packet mpi crypto filter iobuf memory cache
memstat trust hashing ipc clock lookup extprog
gpg: DBG: [not enabled in the source] start
gpg: DBG: chan_0x000000d0 <- OK Pleased to meet you
gpg: DBG: connection to agent established
gpg: DBG: chan_0x000000d0 -> RESET
gpg: DBG: chan_0x000000d0 <- OK
gpg: DBG: chan_0x000000d0 -> GETINFO version
gpg: DBG: chan_0x000000d0 <- D 2.2.1
gpg: DBG: chan_0x000000d0 <- OK
gpg: DBG: chan_0x000000d0 -> OPTION allow-pinentry-notify
gpg: DBG: chan_0x000000d0 <- OK
gpg: DBG: chan_0x000000d0 -> OPTION agent-awareness=2.1.0
gpg: DBG: chan_0x000000d0 <- OK
gpg: DBG: chan_0x000000d0 -> SCD GETINFO version
gpg: DBG: chan_0x000000d0 <- D 2.2.1
gpg: DBG: chan_0x000000d0 <- OK
gpg: DBG: chan_0x000000d0 -> SCD SERIALNO openpgp
gpg: DBG: chan_0x000000d0 <- ERR 100696144 No such device gpg: selecting openpgp failed: No such device
gpg: OpenPGP Karte ist nicht vorhanden: No such device
gpg: DBG: [not enabled in the source] stop
gpg: keydb: handles=0 locks=0 parse=0 get=0
gpg:        build=0 update=0 insert=0 delete=0
gpg:        reset=0 found=0 not=0 cache=0 not=0
gpg: kid_not_found_cache: count=0 peak=0 flushes=0
gpg: sig_cache: total=0 cached=0 good=0 bad=0
gpg: random usage: poolsize=600 mixed=0 polls=0/0 added=0/0
              outmix=0 getlvl1=0/0 getlvl2=0/0
gpg: rndjent stat: collector=0x00000000 calls=0 bytes=0
gpg: secmem usage: 0/32768 bytes in 0 blocks
I saw the next mail from Werner, and will try to follow this.

@_date: 2017-11-21 09:15:07
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
Thanks, Werner, for the helping hand. I did so to capture the log of the scdaemon.
But did not used the nice trick of TCP, because I did not wanted to have the VM
up and running and blocking the OpenPGP Card on USB. I run all the GnuPG commands
from the DOS cmd shell, only the tail of the scdaemon.log was done in Cygwin.
The scdaemon.conf used was:
$ cat /cygdrive/c/Users/apitzm/AppData/Roaming/gnupg/scdaemon.conf
log-file scdaemon.log
debug-level guru
card-timeout 30
The produced log is:
$ cat ../AppData/Local/VirtualStore/Windows/SysWOW64/scdaemon.log
2017-11-21 08:24:04 scdaemon[3868.1] Es wird auf Socket `C:\Users\apitzm\AppData\Roaming\gnupg\S.scdaemon' geh?rt
2017-11-21 08:24:04 scdaemon[3868.2] Handhabungsroutine f?r fd -1 gestartet
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK GNU Privacy Guard's Smartcard server ready
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 <- GETINFO socket_name
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 -> D C:\Users\apitzm\AppData\Roaming\gnupg\S.scdaemon
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 <- OPTION event-signal=f0
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 <- serialno
2017-11-21 08:24:04 scdaemon[3868.2] DBG: enter: apdu_open_reader: portstr=(null)
2017-11-21 08:24:04 scdaemon[3868.2] detected reader 'Broadcom Corp Contacted SmartCard 0'
2017-11-21 08:24:04 scdaemon[3868.2] detected reader 'Broadcom Corp Contactless SmartCard 0'
2017-11-21 08:24:04 scdaemon[3868.2] detected reader 'BROADCOM NFC Smartcard Reader 1'
2017-11-21 08:24:04 scdaemon[3868.2] detected reader 'Identiv uTrust 3512 SAM slot Token 0'
2017-11-21 08:24:04 scdaemon[3868.2] detected reader ''
2017-11-21 08:24:04 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:24:04 scdaemon[3868.2] DBG: leave: apdu_open_reader => slot=0 [pc/sc]
2017-11-21 08:24:04 scdaemon[3868.2] DBG: enter: apdu_connect: slot=0
2017-11-21 08:24:04 scdaemon[3868.2] pcsc_connect failed: removed card (0x80100069)
2017-11-21 08:24:04 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:24:04 scdaemon[3868.2] DBG: leave: apdu_connect => sw=0x10008
2017-11-21 08:24:04 scdaemon[3868.2] DBG: enter: apdu_close_reader: slot=0
2017-11-21 08:24:04 scdaemon[3868.2] DBG: enter: apdu_disconnect: slot=0
2017-11-21 08:24:04 scdaemon[3868.2] DBG: leave: apdu_disconnect => sw=0x0
2017-11-21 08:24:04 scdaemon[3868.2] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2017-11-21 08:24:04 scdaemon[3868.2] DBG: chan_0x000000b0 -> ERR 100696144 No such device 2017-11-21 08:24:23 scdaemon[3868.2] DBG: chan_0x000000b0 <- RESTART
2017-11-21 08:24:23 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:26:07 scdaemon[3868.2] DBG: chan_0x000000b0 <- serialno
2017-11-21 08:26:07 scdaemon[3868.2] DBG: enter: apdu_open_reader: portstr=(null)
2017-11-21 08:26:07 scdaemon[3868.2] detected reader 'Broadcom Corp Contacted SmartCard 0'
2017-11-21 08:26:07 scdaemon[3868.2] detected reader 'Broadcom Corp Contactless SmartCard 0'
2017-11-21 08:26:07 scdaemon[3868.2] detected reader 'BROADCOM NFC Smartcard Reader 1'
2017-11-21 08:26:07 scdaemon[3868.2] detected reader 'Identiv uTrust 3512 SAM slot Token 0'
2017-11-21 08:26:07 scdaemon[3868.2] detected reader ''
2017-11-21 08:26:07 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:26:07 scdaemon[3868.2] DBG: leave: apdu_open_reader => slot=0 [pc/sc]
2017-11-21 08:26:07 scdaemon[3868.2] DBG: enter: apdu_connect: slot=0
2017-11-21 08:26:07 scdaemon[3868.2] pcsc_connect failed: removed card (0x80100069)
2017-11-21 08:26:07 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:26:07 scdaemon[3868.2] DBG: leave: apdu_connect => sw=0x10008
2017-11-21 08:26:07 scdaemon[3868.2] DBG: enter: apdu_close_reader: slot=0
2017-11-21 08:26:07 scdaemon[3868.2] DBG: enter: apdu_disconnect: slot=0
2017-11-21 08:26:07 scdaemon[3868.2] DBG: leave: apdu_disconnect => sw=0x0
2017-11-21 08:26:07 scdaemon[3868.2] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2017-11-21 08:26:07 scdaemon[3868.2] DBG: chan_0x000000b0 -> ERR 100696144 No such device 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 <- help
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # NOP
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # CANCEL
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # OPTION
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # BYE
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # AUTH
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # RESET
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # END
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # HELP
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # SERIALNO [--demand=] []
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # LEARN [--force] [--keypairinfo]
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # READCERT |
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # READKEY [--advanced] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # SETDATA [--append] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # PKSIGN [--hash=[rmd160|sha{1,224,256,384,512}|md5]] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # PKAUTH 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # PKDECRYPT 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # INPUT
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # OUTPUT
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # GETATTR 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # SETATTR  2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # WRITECERT 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # WRITEKEY [--force] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # GENKEY [--force] [--timestamp=] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # RANDOM 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # PASSWD [--reset] [--nullpin] 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # CHECKPIN 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # LOCK [--wait]
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # UNLOCK
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # GETINFO 2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # RESTART
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # DISCONNECT
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # APDU [--[dump-]atr] [--more] [--exlen[=N]] [hexstring]
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> # KILLSCD
2017-11-21 08:26:46 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:27:09 scdaemon[3868.2] DBG: chan_0x000000b0 <- restart
2017-11-21 08:27:09 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:28:18 scdaemon[3868.2] DBG: chan_0x000000b0 <- RESTART
2017-11-21 08:28:18 scdaemon[3868.2] DBG: chan_0x000000b0 -> OK
2017-11-21 08:29:15 scdaemon[3868.2] DBG: chan_0x000000b0 <- serialno
2017-11-21 08:29:15 scdaemon[3868.2] DBG: enter: apdu_open_reader: portstr=(null)
2017-11-21 08:29:15 scdaemon[3868.2] detected reader 'Broadcom Corp Contacted SmartCard 0'
2017-11-21 08:29:15 scdaemon[3868.2] detected reader 'Broadcom Corp Contactless SmartCard 0'
2017-11-21 08:29:15 scdaemon[3868.2] detected reader 'BROADCOM NFC Smartcard Reader 1'
2017-11-21 08:29:15 scdaemon[3868.2] detected reader 'Identiv uTrust 3512 SAM slot Token 0'
2017-11-21 08:29:15 scdaemon[3868.2] detected reader ''
2017-11-21 08:29:15 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:29:15 scdaemon[3868.2] DBG: leave: apdu_open_reader => slot=0 [pc/sc]
2017-11-21 08:29:15 scdaemon[3868.2] DBG: enter: apdu_connect: slot=0
2017-11-21 08:29:15 scdaemon[3868.2] pcsc_connect failed: removed card (0x80100069)
2017-11-21 08:29:15 scdaemon[3868.2] reader slot 0: not connected
2017-11-21 08:29:15 scdaemon[3868.2] DBG: leave: apdu_connect => sw=0x10008
2017-11-21 08:29:15 scdaemon[3868.2] DBG: enter: apdu_close_reader: slot=0
2017-11-21 08:29:15 scdaemon[3868.2] DBG: enter: apdu_disconnect: slot=0
2017-11-21 08:29:15 scdaemon[3868.2] DBG: leave: apdu_disconnect => sw=0x0
2017-11-21 08:29:15 scdaemon[3868.2] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2017-11-21 08:29:15 scdaemon[3868.2] DBG: chan_0x000000b0 -> ERR 100696144 No such device

@_date: 2017-11-21 15:59:21
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
El d?a martes, noviembre 21, 2017 a las 06:50:18p. m. +0900, NIIBE Yutaka escribi?:
Thanks! Adding the above line to GNUPGHOME/scdaemon.conf makes it all work,
even the GPA and other GUI tools.

@_date: 2017-11-24 10:55:13
@_author: Matthias Apitz 
@_subject: Using the OpenPGP Card on Unix && Win7 
One last question on this. The gpg4win-3.0.0.exe installs among others an
OutLook plugin (GpgOl DLL) which let you encrypt and sign mails in
OutLook. Ofc, my keypair I'm using with the OpenPGP Card was built for 'Matthias Apitz  ' and not for my company mail addr Matthias.Apitz at oclc.org; this brings always on signing up a Window like this
 of Kleopatra because it can not choose
by its own the correct certificate. Is there a way to configure this
within Kleopatra or GpgOl?

@_date: 2017-10-01 20:33:28
@_author: Matthias Apitz 
@_subject: Smartcard not seen when reinserted 
El d?a domingo, octubre 01, 2017 a las 06:37:46p. m. +0200, Franck Routier escribi?:
I'm using a GnuPG-card for SSH and signing. I do not think, that it
would be a good idea, that the secre on the card remain unlocked after
withdraw (power reset) of the card, and mine does not cash it. It works
like this:
card insert
ssh server              --> PIN requested
ssh server              --> no PIN requested
gpg2 ... --sign ...     --> no PIN requested
gpg2 ... --decrypt .... --> no PIN requested
card remove
card insert
gpg2 ... --sign ...     --> PIN requested
ssh server              --> PIN requested
ssh server              --> no PIN requested
i.e. it seems that unlocking the SSH key unlocks the signing key as
well, but not the other way around.
Imagine you pull-out the card in your office/restaurant, loose the card,
someone finds it before you note the lost and insert the card in your
system... No, that a card "survives" unlocked a withdraw is not a good

@_date: 2017-10-02 16:37:58
@_author: Matthias Apitz 
@_subject: Smartcard not seen when reinserted 
El d?a lunes, octubre 02, 2017 a las 01:35:16p. m. +0200, Franck Routier escribi?:
I'm using the attach 'scd-event' script to lock my display on card
removal and to unlock it on card-insert. The real work in the script is
at line 107++
Maybe it can serve you a bit.

@_date: 2017-10-10 14:38:06
@_author: Matthias Apitz 
@_subject: Is there some writeable memory on the OpenPGP-card 
I often switch at work with my OpenPGP-card among the workstations I'm
using. Some of them do not have (for security reasons) any network connection
between and it would be nice transfer some small files together with the
USB OpenPGP-card. Is there some memory for read/write on them, maybe
with some commands of the card daemon?

@_date: 2017-10-13 16:14:23
@_author: Matthias Apitz 
@_subject: OT: FAQ and GNU 
El d?a viernes, octubre 13, 2017 a las 09:05:52a. m. -0500, Mario Castel?n Castro escribi?:
Could you please discuss this off-list. Thanks.

@_date: 2017-10-13 20:17:16
@_author: Matthias Apitz 
@_subject: 20171005-gnupg-ccid-card-daemon-UbuntuPhone 
El d?a viernes, octubre 13, 2017 a las 12:44:01p. m. -0400, Daniel Villarreal escribi?:
Thanks for your comments and the suggested changes. I can't change the
blog page due to missing write access there. The suggested changes are
fine with me if someone is in the position to do them.
Re/ your question:
The '$' sign there is not a prompt. 'pass.sh' is a small shell script and
in this the expression '$*' passes all arguments given to 'pass.sh' to
the called command.

@_date: 2017-09-18 20:04:10
@_author: Matthias Apitz 
@_subject: OT: Which smartphone would you use 
I'm using for more than two years an Ubuntu phone BQ E4.5. The project was driven by Canonical and BQ as the hardware OEM. The project died in March of this year, but is now moved to a community of OpenSource entusiast. The software novadays is mostly Ubuntu 15.04, with some Android blobs in the kernel for the hardware access.
Check

@_date: 2017-09-21 19:48:34
@_author: Matthias Apitz 
@_subject: OT: Which smartphone would you use 
El d?a jueves, septiembre 21, 2017 a las 07:09:01p. m. +0200, Thomas Hejze escribi?:
Look for second hand devices of the BQ "Ubuntu Edition" (BQ does not
produce nor sell them anymore). Such devices you could reflash to the
software available at ubports.com

@_date: 2017-09-21 20:20:59
@_author: Matthias Apitz 
@_subject: OT: Which smartphone would you use 
El d?a jueves, septiembre 21, 2017 a las 06:54:43p. m. +0200, Thomas Hejze escribi?:
I have ported gpg2 and the password storage manger 'pass' to my Ubuntu
phone BQ E4.5. I'm still working on the pcscd daemon to get the
GnuPG-card working in the phone. The tricky part is that you normally can
not install or compile additional software in the root file system of
the device (because it's mounted for good reasons read-only). You must
setup an additional complete system and chroot to it. If you later want
to run such compiled/installed software from outside the chroot, you
must set LD_IBRARY_PATH (...) so the software can find its stuff, for
example in a small shell wrapper script:
cat gpg2.sh
export LD_LIBRARY_PATH
           --use-standard-socket --daemon \
           --pinentry-program /home/phablet/myRoot/usr/bin/pinentry-curses
PATH=$PATH:myRoot/usr/bin export PATH
This way I have gpg2 and pass working. I can SSH into the phone (or do
the same on the terminal-app) and run: $ ssh phablet at ubphone
Welcome to Ubuntu 15.04 (GNU/Linux 3.4.67 armv7l)
phablet at ubuntu-phablet-bq:~$
phablet at ubuntu-phablet-bq:~$ ls -l .password-store/web/bla.gpg
-rw------- 1 phablet phablet 356 Sep 20 12:58 .password-store/web/bla.gpg
phablet at ubuntu-phablet-bq:~$
phablet at ubuntu-phablet-bq:~$ ./pass.sh web/bla
       ??????????????????????????????????????????????????????????????????????????????????????
       ? Please enter the passphrase to unlock the secret key for the OpenPGP certificate:  ?
       ? "Matthias Apitz "                                                ?
       ? 2048-bit RSA key, ID 76254069,                                                     ?
       ? created 2017-09-20 (main key ID CBE83911).                                         ?
       ?                                                                                    ?
       ?                                                                                    ?
       ? Passphrase _______________________________________________________________________ ?
       ?                                                                                    ?
       ?                       ?
       ??????????????????????????????????????????????????????????????????????????????????????
Username: guru at unixarea.de

@_date: 2017-09-22 17:24:01
@_author: Matthias Apitz 
@_subject: gpg 2.1.19 fails to generate key pair 
I've compile gpg 2.1.19 and all the required shared libs from source.
The cmd sequence:
LD_LIBRARY_PATH=/home/phablet/myRoot/usr/local/lib export LD_LIBRARY_PATH
PATH=/home/phablet/myRoot/usr/local/bin:$PATH export PATH
GNUPGHOME=/home/phablet/.gnupg export GNUPGHOME
            --daemon \
            --pinentry-program /home/phablet/myRoot/usr/bin/pinentry-curses
fails at the end (after the dialog and asking the passphrase) with:
gpg: signing failed: End of file
gpg: make_keysig_packet failed: End of file
Key generation failed: End of file
I instructed via gpg-agent.conf the gpg-agent to do a debug log which
follows. The proc gpg-agent crashes with SIG_BUS.
Any help?
2017-09-22 16:46:49 gpg-agent[15163] listening on socket '/run/user/32011/gnupg/S.gpg-agent'
2017-09-22 16:46:49 gpg-agent[15163] listening on socket '/run/user/32011/gnupg/S.gpg-agent.extra'
2017-09-22 16:46:49 gpg-agent[15163] listening on socket '/run/user/32011/gnupg/S.gpg-agent.browser'
2017-09-22 16:46:49 gpg-agent[15163] listening on socket '/run/user/32011/gnupg/S.gpg-agent.ssh'
2017-09-22 16:46:49 gpg-agent[15166] gpg-agent (GnuPG) 2.1.19 started
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK Pleased to meet you, process 15167
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- RESET
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION ttyname=/dev/pts/58
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION ttytype=linux
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION putenv=DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-Y5hTZhXCoe
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION putenv=QT_IM_MODULE=maliitphablet
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION lc-ctype=en_GB.UTF-8
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- OPTION lc-messages=en_GB.UTF-8
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:49 gpg-agent[15166] DBG: chan_9 <- [eof]
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK Pleased to meet you, process 15169
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- RESET
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION ttyname=/dev/pts/58
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION ttytype=linux
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION putenv=DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-Y5hTZhXCoe
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION putenv=QT_IM_MODULE=maliitphablet
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION lc-ctype=en_GB.UTF-8
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION lc-messages=en_GB.UTF-8
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- GETINFO version
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> D 2.1.19
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION allow-pinentry-notify
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- OPTION agent-awareness=2.1.0
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- RESET
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- GENKEY
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> S INQUIRE_MAXLEN 1024
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> INQUIRE KEYPARAM
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- D (genkey(rsa(nbits 4:2048)))
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- END
2017-09-22 16:46:59 gpg-agent[15166] starting a new PIN Entry
2017-09-22 16:46:59 gpg-agent[15166] DBG: connection to PIN entry established
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 -> INQUIRE PINENTRY_LAUNCHED 15347 unknown 0.8.3 ? ? ?
2017-09-22 16:46:59 gpg-agent[15166] DBG: chan_9 <- END
2017-09-22 16:47:30 gpg-agent[15166] starting a new PIN Entry
2017-09-22 16:47:30 gpg-agent[15166] DBG: connection to PIN entry established
2017-09-22 16:47:30 gpg-agent[15166] DBG: chan_9 -> INQUIRE PINENTRY_LAUNCHED 15474 unknown 0.8.3 ? ? ?
2017-09-22 16:47:30 gpg-agent[15166] DBG: chan_9 <- END
2017-09-22 16:47:34 gpg-agent[15166] starting a new PIN Entry
2017-09-22 16:47:34 gpg-agent[15166] DBG: connection to PIN entry established
2017-09-22 16:47:34 gpg-agent[15166] DBG: chan_9 -> INQUIRE PINENTRY_LAUNCHED 15482 unknown 0.8.3 ? ? ?
2017-09-22 16:47:34 gpg-agent[15166] DBG: chan_9 <- END
2017-09-22 16:47:38 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 30 128
2017-09-22 16:47:38 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 30 128
2017-09-22 16:48:38 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 30 128
2017-09-22 16:48:38 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 38 128
2017-09-22 16:48:59 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 38 128
2017-09-22 16:49:00 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 46 128
2017-09-22 16:49:03 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 46 128
2017-09-22 16:49:05 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 54 128
2017-09-22 16:49:08 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 54 128
2017-09-22 16:49:11 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 54 128
2017-09-22 16:49:14 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 54 128
2017-09-22 16:49:16 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:49:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:49:22 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:49:25 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:49:28 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:49:29 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 70 128
2017-09-22 16:49:32 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 70 128
2017-09-22 16:49:35 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 70 128
2017-09-22 16:49:38 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 70 128
2017-09-22 16:49:41 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:44 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:47 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:50 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:53 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:56 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:49:58 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 86 128
2017-09-22 16:50:01 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 86 128
2017-09-22 16:50:02 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 94 128
2017-09-22 16:50:06 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 94 128
2017-09-22 16:50:06 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 102 128
2017-09-22 16:50:09 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 110 128
2017-09-22 16:50:11 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 118 128
2017-09-22 16:50:15 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 118 128
2017-09-22 16:50:15 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 126 128
2017-09-22 16:50:18 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 128 128
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen X 100 100
2017-09-22 16:50:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 0 128
2017-09-22 16:50:25 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 14 128
2017-09-22 16:50:29 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 14 128
2017-09-22 16:50:30 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 22 128
2017-09-22 16:50:33 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 22 128
2017-09-22 16:50:33 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 30 128
2017-09-22 16:50:36 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 30 128
2017-09-22 16:50:37 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 38 128
2017-09-22 16:50:40 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 38 128
2017-09-22 16:50:40 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 46 128
2017-09-22 16:50:44 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 46 128
2017-09-22 16:50:44 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 54 128
2017-09-22 16:50:47 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:50:51 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 62 128
2017-09-22 16:50:52 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 70 128
2017-09-22 16:50:56 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 78 128
2017-09-22 16:50:59 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 86 128
2017-09-22 16:51:02 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 86 128
2017-09-22 16:51:02 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 94 128
2017-09-22 16:51:05 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 102 128
2017-09-22 16:51:08 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 110 128
2017-09-22 16:51:10 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 118 128
2017-09-22 16:51:13 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 118 128
2017-09-22 16:51:16 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 126 128
2017-09-22 16:51:19 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 126 128
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS need_entropy X 128 128
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen + 0 0
2017-09-22 16:51:21 gpg-agent[15166] DBG: chan_9 -> S PROGRESS primegen X 100 100
2017-09-22 16:51:21 gpg-agent[15166] DBG:   p= :+c6280f1a49907c0d81b305f9a0240775c6e24710574a076036f4d70db1cfe02e \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        8ab4cfa5c0e6da76c587c4f9045e3a6389fe7c0c57ae36f00cb95cce05179141 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        c86928929c90b95ef2d623a0ead52da6cf8908de960e688314bcb49150f007c0 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        f12ff2126e659aa536ce198e8bbcbdac90fbf359e6e5c1fa3bed3790bfcd7d25
2017-09-22 16:51:21 gpg-agent[15166] DBG:   q= :+ffc1f0e1038df2bba07f2be661d34fa93dc65c8e5295eecd98cbe2f9e23a1ae1 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        5afee816e97b87e507abad6424294c18ea7b9d7032f2d65659f7523b9f25f8ab \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        429ceb98e07d4363630f4a0a251b29c5eeedb2ed7b667d6ff05fef74150d5083 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        c465c01e415fd04f276edcd05563547c91d9bf80e0f00f8243242198bc94b5ed
2017-09-22 16:51:21 gpg-agent[15166] DBG: phi= :+c5f805b24c36a4b1d0c65d73c3b156dac637c5d7e97b65a623e25d81d46418b8 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        3f10dff24eee59bea7e73f176de3a189912935edde7b37abd44bdfa4a1e91444 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        91a79cc263b02aa2e602e1a41db4709d7226b9bece6cb6e70429b1a151de371b \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        b27ed9eb762cb88890a9bf29bc3b75a3168f84b38b29c918c25bd12a269a9d54 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        3f2b6f36e86dad0ff73c2c14c544aec8f9f841d3cc1720596b435f7fdcd1861f \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        0c8ac8cd37ec73eec868ed85b2d45a73da275e883ba33776e3c4189f02133c5a \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        b5a01818b4d12d9d6e1ed767e05e1d62ab575f1cbde02c65ad78c1c1877544c5 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        ac85550f64238fe228c58ce4335d7bc1bf08ce8054a0a899c7b64d1fe3b9d130
2017-09-22 16:51:21 gpg-agent[15166] DBG:   g= :+04
2017-09-22 16:51:21 gpg-agent[15166] DBG:   f= :+317e016c930da92c7431975cf0ec55b6b18df175fa5ed96988f897607519062e \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        0fc437fc93bb966fa9f9cfc5db78e862644a4d7b779ecdeaf512f7e9287a4511 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        2469e73098ec0aa8b980b869076d1c275c89ae6fb39b2db9c10a6c6854778dc6 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        ec9fb67add8b2e22242a6fca6f0edd68c5a3e12ce2ca72463096f44a89a6a755 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        0fcadbcdba1b6b43fdcf0b0531512bb23e7e1074f305c8165ad0d7dff7346187 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        c322b2334dfb1cfbb21a3b616cb5169cf689d7a20ee8cdddb8f10627c084cf16 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        ad6806062d344b675b87b5d9f8178758aad5d7c72f780b196b5e307061dd5131 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        6b215543d908e3f88a3163390cd75ef06fc233a015282a2671ed9347f8ee744c
2017-09-22 16:51:21 gpg-agent[15166] DBG:   n= :+c5f805b24c36a4b1d0c65d73c3b156dac637c5d7e97b65a623e25d81d46418b8 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        3f10dff24eee59bea7e73f176de3a189912935edde7b37abd44bdfa4a1e91444 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        91a79cc263b02aa2e602e1a41db4709d7226b9bece6cb6e70429b1a151de371b \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        b27ed9eb762cb88890a9bf29bc3b75a3168f84b38b29c918c25bd12a269a9d56 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        05156f32358c1bd9196e5df4c73c05e7fea0e57275f716873b04198770db812e \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        f23e8089e24ed64a959c5fe2db5be0f04ea17804c64444bd4a74c7a8a650c647 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        c0a62c4431df2a5fc4044512f04e74cf69ce1ae8cf551258b29565c6ed729d0a \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        621b074013e8fad687028343147d8deae1de815b1c767a1646c7a649601c0441
2017-09-22 16:51:21 gpg-agent[15166] DBG:   e= :+010001
2017-09-22 16:51:21 gpg-agent[15166] DBG:   d= :+266b12bdee74e742bbbb972cad5437c1069911bbac2b9e871ead220cdd391ca3 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        fad72d42a2873662ddc62e73ff471ed4e9d707c874f5d010b8470e2c6ea06326 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        c86670f13773db5e5809449d3b078698436c18fd5aa575dc40ae4fb2b906c906 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        86bdffcfe653d8eee5b60f6b4bc47538945aff3b719d0711d73c06cc29883552 \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        815cce3d275f8b678f08fe1bfcc96eab0179a85ab01f67cf7a95ad4d8cbe9b8a \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        e07df9687bfb16e786bc7825cb55d304eb17db4c5058851dbd2753c8ddd7fa4d \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        37348da093cc894fe52c368cc9d9b1d5b15f280dd59a50bb5dae12d9da0e0bad \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        d9e45924bebff8ff007f0fefc43916d87b587beca31fb7807a659a337f57d2ed
2017-09-22 16:51:21 gpg-agent[15166] DBG:   u= :+0338a9db6d7bd87e4293cec0b4c2e73b842a6df53d8279417fc97036f8bd7e4d \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        a3b68dd0daa2bac2ee1a656dc1a2c528e2bdb9cefc43b181495e302c3cf6c2df \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        73afc1853abcc24d21db6335b636cc973a9da8face1780ff2bb55abc8e2deb8e \
2017-09-22 16:51:21 gpg-agent[15166] DBG:        b4004a3d7ee48aab59b5a22f15702fed255b4c8bb97ff22c95a9ac2c1b6c4b4c
2017-09-22 16:51:22 gpg-agent[15166] DBG: storing private key
2017-09-22 16:51:25 gpg-agent[15166] S2K calibration: 2466816 -> 100ms
2017-09-22 16:51:25 gpg-agent[15166] DBG: agent_put_cache '72C072DF8E8A7E956E83631D' (mode 5) requested ttl=900
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> S CACHE_NONCE 72C072DF8E8A7E956E83631D
2017-09-22 16:51:25 gpg-agent[15166] DBG: returning public key
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> [ 44 20 28 31 30 3a 70 75 62 6c 69 63 2d 6b 65 79 ...(286 byte(s) skipped) ]
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 <- RESET
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 <- SIGKEY 7A4385DA9EB9353BB10B23B473A005546A5DAE36
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 <- SETKEYDESC Please+enter+the+passphrase+to+unlock+the+OpenPGP+secret+key:%0A%22[User+ID+not+found]%22%0A2048-bit+RSA+key,+ID+E63AE41B03128A87,%0Acreated+2017-09-22.%0A
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 <- SETHASH 8 C32083165BB1A88A814A1BB2F62984D2B521AEAB1210B9B32648E0FAEC28F206
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 -> OK
2017-09-22 16:51:25 gpg-agent[15166] DBG: chan_9 <- PKSIGN -- 72C072DF8E8A7E956E83631D
2017-09-22 16:51:25 gpg-agent[15166] DBG: agent_get_cache '72C072DF8E8A7E956E83631D' (mode 5) ...
2017-09-22 16:51:25 gpg-agent[15166] DBG: ... hit

@_date: 2017-09-22 20:48:43
@_author: Matthias Apitz 
@_subject: gpg 2.1.19 fails to generate key pair 
El d?a viernes, septiembre 22, 2017 a las 08:19:14p. m. +0200, Werner Koch escribi?:
I can imagine. That's why I attached the log of the gpg-agent.
Ok. I will update to the most recent version. Btw: libcrypt is 1.7.0.
No, wrong guess in this case. It is:
phablet at ubuntu-phablet-bq:~$ uname -a
Linux ubuntu-phablet 3.4.67  SMP PREEMPT Mon Jun 6 12:04:40 UTC 2016 b75400e armv7l armv7l armv7l GNU/Linux
an Ubuntu based smartphone.

@_date: 2017-09-22 22:19:36
@_author: Matthias Apitz 
@_subject: gpg 2.1.19 fails to generate key pair 
it works with:
phablet at ubuntu-phablet-bq:~$ ./gpg2.sh --version
gpg-agent[28499]: enabled debug flags: mpi crypto memory cache memstat hashing ipc
gpg-agent: a gpg-agent is already running - not starting a new one
gpg-agent: random usage: poolsize=600 mixed=0 polls=0/0 added=0/0
              outmix=0 getlvl1=0/0 getlvl2=0/0
gpg-agent: secmem usage: 0/32768 bytes in 0 blocks
gpg (GnuPG) 2.2.1
libgcrypt 1.8.1
phablet at ubuntu-phablet-bq:~$ ~/gpg2.sh --full-generate-key
                      ????????????????????????????????????????????????????????
                      ? Please re-enter this passphrase                      ?
                      ?                                                      ?
                      ? Passphrase: ***_____________________________________ ?
                      ?                                                      ?
                      ?             ?
                      ????????????????????????????????????????????????????????
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /home/phablet/.gnupg/trustdb.gpg: trustdb created
gpg: key 3FECB79DDDA409E4 marked as ultimately trusted
gpg: directory '/home/phablet/.gnupg/openpgp-revocs.d' created
gpg: revocation certificate stored as '/home/phablet/.gnupg/openpgp-revocs.d/41E0B3688FDD76C9337ECD873FECB79DDDA409E4.rev'
public and secret key created and signed.
pub   rsa2048 2017-09-22 [SC]
      41E0B3688FDD76C9337ECD873FECB79DDDA409E4
uid                      Matthias Apitz (test) sub   rsa2048 2017-09-22 [E]

@_date: 2017-09-23 10:47:45
@_author: Matthias Apitz 
@_subject: GnuPG-card works in the Ubuntu smartphone 
I have the GnuPG-card working in the Ubuntu smartphone BQ E4.5, details
here: I could post a small how-to to some place because due to the nature of
the phone (read-only mounted root file system) the installation needs
some tricks.

@_date: 2017-09-24 10:59:35
@_author: Matthias Apitz 
@_subject: GnuPG-card works in the Ubuntu smartphone 
El d?a domingo, septiembre 24, 2017 a las 08:56:56a. m. +0200, Werner Koch escribi?:
I would be happy to write something in this blog, but I never wrote
something in 'org-mode' format, any pointer to some guide? I'm attaching
below a text version of the write-up. A photo is here:
If it should be og better quality, I have to look for some equipment.
For the connection between the USB token and the phone, I used some OTG
(USB On-The-Go) cable. I own as well a small connector receiving on one
end the token and to be plugged in into the phones port, but this
connection is very unstable, with the cable it's fine.
Using GnuPG-card in the UbuntuPhone BQ E4.5:
phablet at ubuntu-phablet-bq:~$ phablet at ubuntu-phablet-bq:~$ sudo chroot myRoot/
root at ubuntu-phablet:/# apt-get install pinentry-curses
root at ubuntu-phablet:/# apt-get install pass
root at ubuntu-phablet:/# apt-get install libudev-dev
Installing GnuPG 2.2.1 into the 'myRoot' system compile in ~phablet (in myRoot) the following pieces:
always with ./configure && make && sudo make install; the software ends
up below /usr/local (i.e. /home/phablet/myRoot/usr/local when one looks
from outside the chroot'ed phone system);
note: 'gpg2' is /usr/local/bin/gpg
Now from the phone system configure:
$ mkdir ~/.gnupg
$ cat .gnupg/gpg.conf
agent-program  /home/phablet/myRoot/usr/local/bin/gpg-agent
$ cat .gnupg/gpg-agent.conf pinentry-program /home/phablet/myRoot/usr/bin/pinentry-curses
scdaemon-program /home/phablet/myRoot/usr/local/libexec/scdaemon
log-file /home/phablet/gpg-agent.log
log-file /dev/null
debug-level guru
Due to the nature of the installation in the chrooted system we
need small wrapper scripts to set PATH, LD_LIBRARY_PATH, ... and
other stuff;
$ cat ~/gpg.sh
LD_LIBRARY_PATH=/home/phablet/myRoot/usr/local/lib export LD_LIBRARY_PATH
PATH=/home/phablet/myRoot/usr/local/bin:$PATH      export PATH
GNUPGHOME=/home/phablet/.gnupg    export GNUPGHOME
GPG_TTY=$(tty)                    export GPG_TTY
            --homedir /home/phablet/.gnupg      \
            --daemon                            \
            --pinentry-program /home/phablet/myRoot/usr/bin/pinentry-curses
run and create for test a keypair (later we want to use the GnuPG-card
for this)
$ ~/gpg.sh --full-generate-key
gpg-agent[2973]: enabled debug flags: mpi crypto memory cache memstat hashing ipc
gpg (GnuPG) 2.2.1; Copyright (C) 2017 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? This starts the gpg-agent as:
$ ps ax | grep gpg-a
 2974 ?        Ss     0:00 /home/phablet/myRoot/usr/local/bin/gpg-agent --homedir /home/phablet/.gnupg --daemon --pinentry-program /home/phablet/myRoot/usr/bin/pinentry-curses
Now we can use the the 'pass' command we installed in the chroot'es system
$ cat pass.sh
LD_LIBRARY_PATH=/home/phablet/myRoot/usr/local/lib export LD_LIBRARY_PATH
PATH=/home/phablet/myRoot/usr/local/bin:$PATH      export PATH
GNUPGHOME=/home/phablet/.gnupg    export GNUPGHOME
GPG_TTY=$(tty)                    export GPG_TTY
unset GPG_AGENT_INFO
Init the pass storage as:
$ ./pass.sh init Matthias
                 ??????????????????????????????????????????????????????????????????
                 ? Please enter the passphrase to unlock the OpenPGP secret key:  ?
                 ? "Matthias Apitz (test) "                        ?
                 ? 2048-bit RSA key, ID 93A6FBF52FA76DB0,                         ?
                 ? created 2017-09-22 (main key ID 3FECB79DDDA409E4).             ?
                 ?                                                                ?
                 ?                                                                ?
                 ? Passphrase: ***_______________________________________________ ?
                 ?                                                                ?
                 ?                 ?
                 ??????????????????????????????????????????????????????????????????
$ find .password-store/
Insert some password for test:
$ ./pass.sh insert -m web/bla
Enter contents of web/bla and press Ctrl+D when finished:
Username: guru
$ ./pass.sh web/bla
Username: guru
Final step is getting support for the GnuPG-card. We need the 'pcscd' daemon.
Its build is a bit tricky because it must later, on start from outside the
chrooted system, find the ccid driver.
We compile the following pieces inside the chroot'ed system:
with the following options set on ./configure ...
phablet at ubuntu-phablet-bq:~$ cd pcsc-lite-1.8.20
phablet at ubuntu-phablet-bq:~/ccid-1.4.25$ ./configure --enable-usbdropdir=/home/phablet/myRoot/usr/local/lib/pcsc/drivers --enable-confdir=/home/phablet/myRoot/etc/reader.conf.d
PC/SC lite has been configured with following options:
Version:             1.8.20
System binaries:     /usr/local/sbin
Configuration dir:   /usr/local/etc/reader.conf.d
Host:                armv7l-unknown-linux-gnueabihf
Compiler:            gcc
Preprocessor flags:  -I${top_srcdir}/src
Compiler flags:      -Wall -fno-common -g -O2
Preprocessor flags:  -I${top_srcdir}/src
Linker flags:
Libraries:           -ldl  -lrt
PTHREAD_CFLAGS:      -pthread
PCSC_ARCH:           Linux
pcscd binary            /usr/local/sbin/pcscd
polkit support:         no
polkit policy dir:
libudev support:        yes
libusb support:         no
USB drop directory:     /home/phablet/myRoot/usr/local/lib/pcsc/drivers
ATR parsing messages:   false
ipcdir:                 /var/run/pcscd
use serial:             yes
use usb:                yes
systemd unit directory: /lib/systemd/system
serial config dir.:     /home/phablet/myRoot/etc/reader.conf.d
filter:                 no
PCSCLITE_FEATURES:       Linux armv7l-unknown-linux-gnueabihf serial usb libudev usbdropdir=/home/phablet/myRoot/usr/local/lib/pcsc/drivers ipcdir=/var/run/pcscd configdir=/home/phablet/myRoot/etc/reader.conf.d
checking that generated files are newer than configure... done
phablet at ubuntu-phablet-bq:~/ccid-1.4.25$ make
phablet at ubuntu-phablet-bq:~/ccid-1.4.25$ sudo make install
ok, now the 'ccid' driver, installed (copied) to be seen by the daemon:
phablet at ubuntu-phablet-bq:~$ sudo apt-get install libusb-dev
phablet at ubuntu-phablet-bq:~$ sudo apt-get install libusb-1.0-0-dev
phablet at ubuntu-phablet-bq:~$ cd ccid-1.4.25
phablet at ubuntu-phablet:~/ccid-1.4.25$ ./configure -enable-usbdropdir=/home/phablet/myRoot/usr/local/lib/pcsc/drivers
libccid has been configured with following options:
Version:             1.4.25
User binaries:       /usr/local/bin
Configuration files: /usr/local/etc
Host:                armv7l-unknown-linux-gnueabihf
Compiler:            gcc
Preprocessor flags:
Compiler flags:      -g -O2
Preprocessor flags:
Linker flags:
PCSC_CFLAGS:         -pthread -I/usr/local/include/PCSC
PCSC_LIBS:           -L/usr/local/lib -lpcsclite
PTHREAD_CFLAGS:      -pthread
BUNDLE_HOST:         Linux
DYN_LIB_EXT:         so
LIBUSB_CFLAGS:       -I/usr/include/libusb-1.0
LIBUSB_LIBS:         -lusb-1.0
SYMBOL_VISIBILITY:   -fvisibility=hidden
libusb support:          yes
composite as multislot:  no
multi threading:         yes
bundle directory name:   ifd-ccid.bundle
USB drop directory:      /home/phablet/myRoot/usr/local/lib/pcsc/drivers
serial Twin support:     no
serial twin install dir: /home/phablet/myRoot/usr/local/lib/pcsc/drivers/serial
serial config directory: /home/phablet/myRoot/etc/reader.conf.d
compiled for pcsc-lite:  yes
syslog debug:            no
class driver:            yes
phablet at ubuntu-phablet:~/ccid-1.4.25$ make
phablet at ubuntu-phablet:~/ccid-1.4.25$ sudo make install
the driver libccid.so and its control file Info.plist ended up as configured:
phablet at ubuntu-phablet:~$ find /home/phablet/myRoot/usr/local/lib/pcsc/drivers/ifd-ccid.bundle/Contents/
but if we run the daemon from outside the chrooted system, must be in
some other place because '/home/phablet/myRoot' is added in front; so
we copy them over to the correct place:
phablet at ubuntu-phablet:~$ sudo mkdir -p /usr/local/lib/pcsc/drivers/ifd-ccid.bundle
phablet at ubuntu-phablet:~$ sudo cp -rp /home/phablet/myRoot/usr/local/lib/pcsc/drivers/ifd-ccid.bundle/Contents /usr/local/lib/pcsc/drivers/ifd-ccid.bundle
phablet at ubuntu-phablet:~$ find /usr/local/lib/pcsc/drivers/ifd-ccid.bundle
from outside the chrooted system we can now start the daemon as:
$ sudo /home/phablet/myRoot/usr/local/sbin/pcscd --foreground --debug | tee pcscd.log
and check the log file pcscd.log to see if it sees the card attaching (see at the very
end of the write-up);
Now we start in the phone the pcscd daemon as:
$ sudo /home/phablet/myRoot/usr/local/sbin/pcscd
$ ps ax | grep pcscd
31669 pts/53   Sl     0:00 /home/phablet/myRoot/usr/local/sbin/pcscd
and run the gpg --card-status to see if it finds the card after
attaching it:
$ ./gpg.sh --card-status
gpg-agent[20254]: enabled debug flags: mpi crypto memory cache memstat hashing ipc
gpg-agent: a gpg-agent is already running - not starting a new one
gpg-agent: random usage: poolsize=600 mixed=0 polls=0/0 added=0/0
              outmix=0 getlvl1=0/0 getlvl2=0/0
gpg-agent: secmem usage: 0/32768 bytes in 0 blocks
Reader ...........: Identiv uTrust 3512 SAM slot Token [CCID Interface] (55511514602745) 00 00
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
Language prefs ...: en
Sex ..............: unspecified
URL of public key : Login data .......: [not set]
Signature PIN ....: not forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 457
Signature key ....: 5E69 FBAC 1618 562C B3CB  FBC1 47CC F7E4 76FE 9D11
      created ....: 2017-05-14 18:20:07
Encryption key....: EB62 00DA 13A1 9E80 679B  1A13 61F1 ECB6 25C9 A6C3
      created ....: 2017-05-14 18:20:07
Authentication key: E51D D2D6 C727 35D6 651D  EA4B 6AA5 C5C4 51A1 CD1C
      created ....: 2017-05-14 18:20:07
General key info..: [none]
Now we removed ~/.gnupg (saving the *.conf files) and copied over from my
real netbook the ~/.password-store and the key material for the GnuPG-card;
let's see if 'pass' can unlock the card (via the gpg-agent) and decipher the
encrypted information (unencrypted shown here as 'XXXXXXXX-XXXXXX'): $ ./pass.sh askubuntu.com/guru at unixarea.de
                          ???????????????????????????????????????????????
                          ? Please insert the card with serial number:  ?
                          ?                                             ?
                          ? 0005 0000532B                               ?
                          ?                                             ?
                          ?           ?
                          ???????????????????????????????????????????????
                          ????????????????????????????????????????????????
                          ? Please unlock the card                       ?
                          ?                                              ?
                          ? Number: 0005 0000532B                        ?
                          ? Holder: Matthias Apitz                       ?
                          ?                                              ?
                          ? PIN ________________________________________ ?
                          ?                                              ?
                          ?           ?
                          ????????????????????????????????????????????????
on the 2nd run it does not need anymore the PIN:
$ ./pass.sh askubuntu.com/guru at unixarea.de
i.e. all is fine!
This is only the debug log of the pcscd daemon for reference.
00000000 debuglog.c:289:DebugLogSetLevel() debug level=debug
00001760 configfile.l:282:DBGetReaderListDir() Parsing conf directory: /home/phablet/myRoot/etc/reader.conf.d
00000840 configfile.l:319:DBGetReaderListDir() Skipping non regular file: .
00000349 configfile.l:319:DBGetReaderListDir() Skipping non regular file: ..
00000364 configfile.l:358:DBGetReaderList() Parsing conf file: /home/phablet/myRoot/etc/reader.conf.d/libccidtwin
00000568 pcscdaemon.c:655:main() pcsc-lite 1.8.20 daemon ready.
00007279 hotplug_libudev.c:294:get_driver() Looking for a driver for VID: 0x1D6B, PID: 0x0002, path: /dev/bus/usb/001/001
07475463 hotplug_libudev.c:648:HPEstablishUSBNotifications() USB Device add
00005501 hotplug_libudev.c:294:get_driver() Looking for a driver for VID: 0x04E6, PID: 0x5816, path: /dev/bus/usb/001/009
00000555 hotplug_libudev.c:433:HPAddDevice() Adding USB device: Identiv uTrust 3512 SAM slot Token
00000673 readerfactory.c:1079:RFInitializeReader() Attempting startup of Identiv uTrust 3512 SAM slot Token [CCID Interface] (55511514602745) 00 00 using /home/phablet/myRoot/usr/local/lib/pcsc/drivers/ifd-ccid.bundle/Contents/Linux/libccid.so
00001129 readerfactory.c:954:RFBindFunctions() Loading IFD Handler 3.0
00013183 ifdhandler.c:1953:init_driver() Driver version: 1.4.25
00004027 ifdhandler.c:1970:init_driver() LogLevel: 0x0003
00004427 ifdhandler.c:1981:init_driver() DriverOptions: 0x0000
00001127 ifdhandler.c:110:CreateChannelByNameOrChannel() Lun: 0, device: usb:04e6/5816:libudev:0:/dev/bus/usb/001/009
00001212 ccid_usb.c:287:OpenUSBByName() Using: /home/phablet/myRoot/usr/local/lib/pcsc/drivers/ifd-ccid.bundle/Contents/Info.plist
00005565 ccid_usb.c:305:OpenUSBByName() ifdManufacturerString: Ludovic Rousseau (ludovic.rousseau at free.fr)
00001479 ccid_usb.c:306:OpenUSBByName() ifdProductString: Generic CCID driver
00000362 ccid_usb.c:307:OpenUSBByName() Copyright: This driver is protected by terms of the GNU Lesser General Public License version 2.1, or (at your option) any later version.
00003937 ccid_usb.c:621:OpenUSBByName() Found Vendor/Product: 04E6/5816 (Identiv uTrust 3512 SAM slot Token)
00000667 ccid_usb.c:623:OpenUSBByName() Using USB bus/device: 1/9
00000337 ccid_usb.c:680:OpenUSBByName() bNumDataRatesSupported is 0
00010195 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB3, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00000626 readerfactory.c:395:RFAddReader() Using the reader polling thread
00000838 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFAE, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00000470 ifdhandler.c:470:IFDHGetCapabilities() Reader supports 1 slot(s)
00001264 ifdhandler.c:1146:IFDHPowerICC() action: PowerUp, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00032378 eventhandler.c:286:EHStatusHandlerThread() powerState: POWER_STATE_POWERED
00000596 Card ATR: 3B DA 18 FF 81 B1 FE 75 1F 03 00 31 C5 73 C0 01 40 00 90 00 0C 05001478 ifdhandler.c:1146:IFDHPowerICC() action: PowerDown, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00003148 eventhandler.c:479:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED
14774363 hotplug_libudev.c:642:HPEstablishUSBNotifications() USB Device removed
00000796 hotplug_libudev.c:360:HPRemoveDevice() Removing USB device[0]: Identiv uTrust 3512 SAM slot Token [CCID Interface] (55511514602745) at /dev/bus/usb/001/009
00000053 readerfactory.c:608:RFRemoveReader() UnrefReader() count was: 1
00000024 eventhandler.c:176:EHDestroyEventHandler() Stomping thread.
00000026 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB1, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00000024 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB2, usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00000018 eventhandler.c:201:EHDestroyEventHandler() Request stopping of polling thread
00000020 ifdhandler.c:344:IFDHStopPolling() usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00397726 eventhandler.c:502:EHStatusHandlerThread() Die
00001909 eventhandler.c:216:EHDestroyEventHandler() Thread stomped.
00000049 readerfactory.c:1130:RFUnInitializeReader() Attempting shutdown of Identiv uTrust 3512 SAM slot Token [CCID Interface] (55511514602745) 00 00.
00000039 ifdhandler.c:282:IFDHCloseChannel() usb:04e6/5816:libudev:0:/dev/bus/usb/001/009 (lun: 0)
00000101 ccid_usb.c:797:WriteUSB() write failed (1/9): -4 LIBUSB_ERROR_NO_DEVICE
00000147 ccid_usb.c:189:close_libusb_if_needed() libusb_exit
00001864 readerfactory.c:991:RFUnloadReader() Unloading reader driver.

@_date: 2017-09-24 19:55:28
@_author: Matthias Apitz 
@_subject: GnuPG-card works in the Ubuntu smartphone 
El d?a domingo, septiembre 24, 2017 a las 05:31:56p. m. +0200, Werner Koch escribi?:
I'm not on Emacs, but vim. But, with the example you gave and looking on
some sources in the blog at gnupg.org I think I can do it. Groff was
more challenging in the past :-)
I will look for some slot next week. I will have to send it to you as I
don't see a way to create an account in the blog...

@_date: 2018-02-06 06:47:23
@_author: Matthias Apitz 
@_subject: OpenPGP card && exporting secret keys 
I'm using an OpenPGP card and gnupg 2.1.19 on my FreeBSD workstations
and my Ubuntu mobile device to store crypted passwords (tool: password-store),
to lock/unlock desktop sessions and to sign emails. This is all working
fine and without any hick-ups.
What makes me worry, is that single point of failure: the OpenPGP card.
While I do backups of alls the encrypted password files, they would be
all useless in case of lost/teft of the token or hardware fault of the SIM
What I do at the moment is something like:
$ find ~/.password-store -name '*.gpg' -exec printf "%s:\n" {} \;
  -and -exec gpg2 -d {} 2> /dev/null \;   -and -exec echo \; > /tmp/clear-password-store.txt
$ GNUPGHOME=...
$ gpg -ea /tmp/clear-password-store.txt
$ mv /tmp/clear-password-store.txt.asc $GNUPGHOME
$ rm -P /tmp/clear-password-store.txt
where the other GNUPGHOME contains secret and pub-keys created for this
special purpose and living outside (i.e. without) the OpenPGP card.
ANd in case of lost/teft of the token I could recover at least all
passwords again...
Is there any way to export the secret keys from the OpenPGP card to use
them directly (with a passphrase) and without the OpenPGP card?

@_date: 2018-02-11 09:29:58
@_author: Matthias Apitz 
@_subject: problems sending to the list 
Sometimes I do SSH into my server of my ISP and send email to the list
from there. This always failes with the message below.
Can some list admin please check, why? Thanks

@_date: 2018-02-11 18:31:02
@_author: Matthias Apitz 
@_subject: problems sending to the list 
El d?a domingo, febrero 11, 2018 a las 12:56:40p. m. +0100, Peter Lebbing escribi?:
Yes. This was the issue. The MUA in question is mutt which uses sendmail to send the
mail. There was (I don't know why) the -f ... missing.

@_date: 2018-01-25 09:39:24
@_author: Matthias Apitz 
@_subject: pinentry fails with gpg-agent for ssh, but works for gpg 
A bit triggered by the last thread "Why exactly does pinentry fails with
gpg-agent and ssh support?" I want to report a similar issue which I do not
I have the 'pinentry' in /usr/local/bin/pinentry as a sym-link to the qt5
$ ls -l /usr/local/bin/pinentry
lrwxr-xr-x  1 root  wheel  27 15 may.   2017 /usr/local/bin/pinentry -> /usr/local/bin/pinentry-qt5
Most of the time I work within the KDE desktop and when the PIN is required to
unlock the keys on the OpenPGP card, it pops up a small Qt5 window asking for it.
Sometimes I work in the alpha console where `tty` gives /dev/ttyv0 (and
GPG_TTY env var is set to this). What I do not get to understand is:
$ gpg2 -d file
pops up some curses window asking for the PIN, i.e.  /usr/local/bin/pinentry-qt5
falls back to this at the end because has no DISPLAY to connect to.
$ ssh some-host
fails to ask for the PIN.
Why, or what could I do?

@_date: 2018-01-29 20:17:13
@_author: Matthias Apitz 
@_subject: Etoken pro windows 10 
El d?a lunes, enero 29, 2018 a las 01:45:24p. m. +0000, kip papa via Gnupg-users escribi?:
Check this thread 'Using the OpenPGP Card on Unix && Win7' in the list's
archives. I have had a similar issue and have had to configure which of
the devices should be used.

@_date: 2018-07-14 15:15:36
@_author: Matthias Apitz 
@_subject: Using gnupg to crypt credentials used by application to access a 
We have large application servers (written in C and C++), but also Perl
and Java applications which all contact a Sybase database server over
the network to do its work. They have to present a USER and a PASSWORD
information to connect to the Sybase ASE listening on some port. As the USER
and the PASSWORD are not entered by humans, at least not in the moment
when the access of the application is made, they are stored in clear
text in files in the UNIX (Linux, SunOS) file system. They are entered
once, when the software is installed, or get modified with a text editor,
when the credentials for whatever reason should be changed. Ofc, storing
them in clear text was always a bad idea. Any person with access to the
server and a bit of knowledge could read and misuse them, even for
dropping the complete database or manipulating accountancy data.
We are looking for a way to change this situation and one of the options
or ideas I have, is crypt the credentials with GnuPG in some file. Any
application have to decrypt this file on the flight (perhaps with a shell
command) to get the USER and PASSWORD into its environment variables or
internal variables to make use of them to connect to the database
server, and will forget the credentials again asap.
Decrypting with GnuPG needs a passphrase, normally read from /dev/tty
which can not be done here in this case. My idea here is to write a
special 'pinentry' program which provides the passphrase, which is crypted itself
with blowfish internally in the 'pinentry' program, and the 'pinentry' will
only work, if the proc which is calling GnuPG send over a socket or a
file some information to authorize the access to this special 'pinentry'.
Any other and better ideas for this?
Thanks in advance.

@_date: 2018-07-16 09:29:29
@_author: Matthias Apitz 
@_subject: Using gnupg to crypt credentials used by application to access a 
El d?a Monday, July 16, 2018 a las 09:06:58AM +0200, Michael Kesper escribi?:
Michael, I do use pass too for all my firefox credentials for access of
webpages and services, i.e. I know how this works. I use for this GnuPG
together with an OpenPGP card and to unlock the password storage I have
to provide the 6 digit PIN of the card. The storage remains unlocked
until card removal. This works all fine.
But, I do not see how this could fit into the scene I described. When an
application server starts on the UNIX host, it needs the database access
credentials and there is no human to key in any PIN, for example when
the server start at boot time ...
How do you think, that pass could fit? Maybe I do overlook something...

@_date: 2018-03-01 09:05:32
@_author: Matthias Apitz 
@_subject: Fwd: gnupg SmartCard V3.3 
El d?a Thursday, March 01, 2018 a las 09:14:15AM +0900, NIIBE Yutaka escribi?:
I do yous the following USB token ond FreeBSD-12 CURRENT and the 'pcscd'
is configured to be started by devd on device attach:
Mar  1 08:00:56 r314251-amd64 kernel: ugen0.2:  at usbus0
Mar  1 08:00:56 r314251-amd64 root: CCID uTrust, type: ATTACH, system: USB, subsystem: INTERFACE
Mar  1 08:00:56 r314251-amd64 root: /usr/local/sbin/pcscd
Mar  1 08:00:56 r314251-amd64 root: Unknown USB device: vendor 0x04e6 product 0x5816 bus uhub0
The OpenPGP card works fine as:
$ gpg2 --card-status
Reader ...........: Identiv uTrust 3512 SAM slot Token (55511514602745)
00 00
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
Do I have any chance to use the USB token and the card directly without

@_date: 2018-03-05 11:19:12
@_author: Matthias Apitz 
@_subject: using the SSH secret key fails sometimes 
This is on FreeBSD with:
$ gpg2 --version
gpg (GnuPG) 2.1.19
libgcrypt 1.7.6
$ ps ax | egrep 'gnu|pcs'
1034  -  Ss     0:00,59 gpg-agent --homedir /home/guru/.gnupg-ccid --use-standard-socket 1036  -  S      0:02,24 scdaemon --multi-server --homedir /home/guru/.gnupg-ccid
3844  -  S      0:01,04 /usr/local/sbin/pcscd
the OpenPGP card fails. The card is already unlocked in this moment
because the unlocking the KDE desktop has asked for the PIN.
Initializing a SSH session produces the attached error in the scdaemon's
log file.
It helps to withdraw the card and insert it again (which starts a new
proc /usr/local/sbin/pcscd).
Any idea where to look? Thanks
2018-03-05 10:53:40 scdaemon[1036.802017e00] manejador del descriptor 13 iniciado
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK GNU Privacy Guard's Smartcard server ready
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- SERIALNO
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S SERIALNO D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- GETINFO card_list
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S SERIALNO D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- SERIALNO --demand=D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S SERIALNO D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- GETATTR $AUTHKEYID
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S $AUTHKEYID OPENPGP.3
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- GETATTR SERIALNO
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S SERIALNO D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- READKEY OPENPGP.3
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> [ 44 20 28 31 30 3a 70 75 62 6c 69 63 2d 6b 65 79 ...(548 byte(s) skipped) ]
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- GETATTR $DISPSERIALNO
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S $DISPSERIALNO 00050000532B
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- SERIALNO --demand=D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> S SERIALNO D27600012401020100050000532B0000
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- SETDATA 3021300906052B0E03021A05000414579704ECB5FC67E700FAD99C8080277E86DCAD94
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> OK
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 <- PKAUTH OPENPGP.3
2018-03-05 10:53:40 scdaemon[1036.802017e00] pcsc_transmit failed: not transacted (0x80100016)
2018-03-05 10:53:40 scdaemon[1036.802017e00] apdu_send_simple(0) failed: general error
2018-03-05 10:53:40 scdaemon[1036.802017e00] operation auth result: General error
2018-03-05 10:53:40 scdaemon[1036.802017e00] app_auth failed: General error
2018-03-05 10:53:40 scdaemon[1036.802017e00] DBG: chan_13 -> ERR 100663297 General error 2018-03-05 10:54:04 scdaemon[1036.802017e00] DBG: chan_13 <- BYE
2018-03-05 10:54:04 scdaemon[1036.802017e00] DBG: chan_13 -> OK closing connection
2018-03-05 10:54:04 scdaemon[1036.802017e00] manejador del descriptor 13 terminado

@_date: 2018-03-10 11:10:20
@_author: Matthias Apitz 
@_subject: OpenPGP card bricked 
After a power-off reset of my laptop the OpenPGP Card seems to be
damaged. The pcscd can't read the card anymore. It gives up with:
00006225 commands.c:244:CmdPowerOn Card absent or mute
00000052 ifdhandler.c:1213:IFDHPowerICC() PowerUp failed
00000017 eventhandler.c:301:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED
(the full log is attached).
I already tried a different reader USB token (an HID Global OMNIKEY 6121)
and a different laptop. So, it seems to be the SIM card itself.
What can I do?
00000000 debuglog.c:289:DebugLogSetLevel() debug level=debug
00000731 configfile.l:358:DBGetReaderList() Parsing conf file: /usr/local/etc/reader.conf.d
00000059 pcscdaemon.c:655:main() pcsc-lite 1.8.20 daemon ready.
00013066 hotplug_libusb.c:536:HPAddHotPluggable() Adding USB device: 0:2:0
00002551 readerfactory.c:1079:RFInitializeReader() Attempting startup of Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00 using /usr/local/lib/pcsc/drivers//ifd-ccid.bundle/Contents/FreeBSD/libccid.so
00000308 readerfactory.c:954:RFBindFunctions() Loading IFD Handler 3.0
00000063 ifdhandler.c:1953:init_driver() Driver version: 1.4.25
00003982 ifdhandler.c:1970:init_driver() LogLevel: 0x0003
00000024 ifdhandler.c:1981:init_driver() DriverOptions: 0x0000
00002569 ifdhandler.c:110:CreateChannelByNameOrChannel() Lun: 0, device: usb:04e6/5816:libusb-1.0:0:2:0
00000067 ccid_usb.c:287:OpenUSBByName() Using: /usr/local/lib/pcsc/drivers/ifd-ccid.bundle/Contents/Info.plist
00003506 ccid_usb.c:305:OpenUSBByName() ifdManufacturerString: Ludovic Rousseau (ludovic.rousseau at free.fr)
00000019 ccid_usb.c:306:OpenUSBByName() ifdProductString: Generic CCID driver
00000015 ccid_usb.c:307:OpenUSBByName() Copyright: This driver is protected by terms of the GNU Lesser General Public License version 2.1, or (at your option) any later version.
00000803 ccid_usb.c:621:OpenUSBByName() Found Vendor/Product: 04E6/5816 (Identiv uTrust 3512 SAM slot Token)
00000021 ccid_usb.c:623:OpenUSBByName() Using USB bus/device: 0/2
00000012 ccid_usb.c:680:OpenUSBByName() bNumDataRatesSupported is 0
03074616 ccid_usb.c:836:ReadUSB() read failed (0/2): -7 LIBUSB_ERROR_TIMEOUT
01934240 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB3, usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00000054 readerfactory.c:395:RFAddReader() Using the reader polling thread
00000591 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFAE, usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00000031 ifdhandler.c:470:IFDHGetCapabilities() Reader supports 1 slot(s)
00000072 hotplug_libusb.c:440:HPEstablishUSBNotifications() Driver ifd-ccid.bundle does not support IFD_GENERATE_HOTPLUG. Using active polling instead.
00000015 hotplug_libusb.c:449:HPEstablishUSBNotifications() Polling forced every 1 second(s)
00000071 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00001093 ifdhandler.c:1146:IFDHPowerICC() action: PowerUp, usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00008985 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010735 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010756 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010201 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010779 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010778 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010779 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00010848 readerfactory.c:1420:RFWaitForReaderInit() Waiting init for reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00006225 commands.c:244:CmdPowerOn Card absent or mute
00000052 ifdhandler.c:1213:IFDHPowerICC() PowerUp failed
00000017 eventhandler.c:301:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED
00000013 eventhandler.c:302:EHStatusHandlerThread() Error powering up card: 2148532246 0x80100016
59123860 pcscdaemon.c:192:signal_thread() Received signal: 2
00000047 pcscdaemon.c:225:signal_thread() Preparing for suicide
00361939 hotplug_libusb.c:403:HPRescanUsbBus() Hotplug stopped
00640696 readerfactory.c:1363:RFCleanupReaders() entering cleaning function
00000117 readerfactory.c:1372:RFCleanupReaders() Stopping reader: Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00
00000018 readerfactory.c:608:RFRemoveReader() UnrefReader() count was: 1
00000012 eventhandler.c:176:EHDestroyEventHandler() Stomping thread.
00000015 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB1, usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00000012 ifdhandler.c:379:IFDHGetCapabilities() tag: 0xFB2, usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00000011 eventhandler.c:201:EHDestroyEventHandler() Request stopping of polling thread
00000011 ifdhandler.c:344:IFDHStopPolling() usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00401709 eventhandler.c:502:EHStatusHandlerThread() Die
00000177 eventhandler.c:216:EHDestroyEventHandler() Thread stomped.
00000019 readerfactory.c:1130:RFUnInitializeReader() Attempting shutdown of Identiv uTrust 3512 SAM slot Token (55511514602745) 00 00.
00000025 ifdhandler.c:282:IFDHCloseChannel() usb:04e6/5816:libusb-1.0:0:2:0 (lun: 0)
00009467 ccid_usb.c:189:close_libusb_if_needed() libusb_exit
00000089 readerfactory.c:991:RFUnloadReader() Unloading reader driver.
00000133 winscard_svc.c:152:ContextsDeinitialize() remaining threads: 0
00000059 pcscdaemon.c:781:at_exit() cleaning /var/run/pcscd

@_date: 2018-03-13 15:34:21
@_author: Matthias Apitz 
@_subject: OpenPGP card bricked 
El d?a martes, marzo 13, 2018 a las 06:54:25p. m. +0900, NIIBE Yutaka escribi?:
I moved the /usr/local/sbin/pcscd out of the way. The scdaemon writes
the following log:
2018-03-13 15:28:10 scdaemon[2508.802016000] listening on socket '/home/guru/.gnupg-ccid/S.scdaemon'
2018-03-13 15:28:10 scdaemon[2508.802017900] manejador del descriptor -1 iniciado
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> OK GNU Privacy Guard's Smartcard server ready
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 <- GETINFO socket_name
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> D /home/guru/.gnupg-ccid/S.scdaemon
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> OK
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 <- OPTION event-signal=31
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> OK
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 <- SERIALNO
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: enter: apdu_open_reader: portstr=(null)
2018-03-13 15:28:10 scdaemon[2508.802017900] pcsc_establish_context failed: no service (0x8010001d)
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: leave: apdu_open_reader => slot=-1 [pc/sc]
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> ERR 100696144 Operation not supported by device 2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 <- RESTART
2018-03-13 15:28:10 scdaemon[2508.802017900] DBG: chan_7 -> OK
Is there some config missing so that scdaemon opens directly the reader?
What does 'pcsc_establish_context failed' mean?
Thanks for your help

@_date: 2018-03-13 16:30:24
@_author: Matthias Apitz 
@_subject: OpenPGP card bricked 
El d?a martes, marzo 13, 2018 a las 04:00:04p. m. +0100, Peter Lebbing escribi?:
Please note, this is not Linux but FreeBSD. But you pointed in the
correct direction: missing rw perms in /dev/usb/* device files; I'm in
the group operator, but they have had only 0600 perms; I fixed this to:
# ls -l /dev/usb
total 0
crw-rw----  1 root  operator  0x2c 13 mar.  15:17 0.1.0
crw-rw----  1 root  operator  0x3d 13 mar.  15:17 0.1.1
crw-rw----  1 root  operator  0x40 13 mar.  15:17 0.2.0
crw-rw----  1 root  operator  0x42 13 mar.  15:17 0.2.1
crw-rw----  1 root  operator  0x43 13 mar.  15:17 0.2.7
crw-rw----  1 root  operator  0x44 13 mar.  15:17 0.3.0
crw-rw----  1 root  operator  0x46 13 mar.  15:17 0.3.1
crw-rw----  1 root  operator  0x47 13 mar.  15:17 0.3.2
crw-rw----  1 root  operator  0x48 13 mar.  15:17 0.3.3
crw-rw----  1 root  operator  0x7e 13 mar.  15:26 0.4.0
crw-rw----  1 root  operator  0x80 13 mar.  15:26 0.4.1
crw-rw----  1 root  operator  0x81 13 mar.  15:26 0.4.2
crw-rw----  1 root  operator  0x82 13 mar.  15:26 0.4.3
and this gives more log; see below;
Thanks for this hint too.
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 <- GETINFO version
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 -> D 2.1.19
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 -> OK
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 <- SERIALNO openpgp
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: apdu_open_reader: BAI=400
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: apdu_open_reader: new device=400
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: using CCID reader 0 (ID=04E6:5816:55511514602745:0)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: idVendor: 04E6  idProduct: 5816  bcdDevice: 0202
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: ChipCard Interface Descriptor:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bLength                54
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bDescriptorType        33
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bcdCCID              1.10  (Warning: Only accurate for version 1.0)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   nMaxSlotIndex           0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bVoltageSupport         7  ?
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwProtocols             3  T=0 T=1
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwDefaultClock       4800
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwMaxiumumClock     16000
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bNumClockSupported      0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwDataRate          12903 bps
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwMaxDataRate      600000 bps
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bNumDataRatesSupp.      0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwMaxIFSD             252
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwSyncProtocols  00000000 2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwMechanical     00000000 2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwFeatures       000100BA
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     Auto configuration based on ATR (assumes auto voltage)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     Auto voltage selection
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     Auto clock change
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     Auto baud rate change
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     Auto PPS made by CCID
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:     TPDU level exchange
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwMaxCCIDMsgLen       271
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bClassGetResponse    echo
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bClassEnvelope       echo
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   wlcdLayout           none
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bPINSupport             0 2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bMaxCCIDBusySlots       1
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: CCID submit transfer (83): 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: CCID: interrupt callback 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: CCID submit transfer again 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-13 16:23:16 scdaemon[2508.802017900] reader slot 0: using ccid driver
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: enter: apdu_connect: slot=0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: enter: apdu_reset: slot=0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: leave: apdu_reset => sw=0x10009
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: leave: apdu_connect => sw=0x10009
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: enter: apdu_close_reader: slot=0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: enter: apdu_disconnect: slot=0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: leave: apdu_disconnect => sw=0x0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOff:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   [0007]  00 00 00
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: RDR_to_PC_SlotStatus:
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bStatus ...........: 1
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver:   bClockStatus ......: 0x01 (stopped-L)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: libusb_cancel_transfer
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: ccid-driver: libusb_handle_events_completed
2018-03-13 16:23:16 scdaemon[2508.802280500] DBG: ccid-driver: CCID: interrupt callback 3
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: enter: apdu_open_reader: portstr=(null)
2018-03-13 16:23:16 scdaemon[2508.802017900] pcsc_establish_context failed: no service (0x8010001d)
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: leave: apdu_open_reader => slot=-1 [pc/sc]
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 -> ERR 100696144 Operation not supported by device 2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 <- RESTART
2018-03-13 16:23:16 scdaemon[2508.802017900] DBG: chan_7 -> OK

@_date: 2018-03-14 16:48:05
@_author: Matthias Apitz 
@_subject: OpenPGP card bricked 
Floss-shop.de sent me a new OpenPGP Card V3.3. It shows the same
problem, see the log below. What should I do now? Send the USB-reader
and the card back to them? I'm clueless....
Mar 14 16:21:34 c720-r314251 kernel: ugen0.4:  at usbus0
Mar 14 16:21:34 c720-r314251 root: CCID uTrust, type: ATTACH, system: USB, subsystem: INTERFACE
Mar 14 16:21:34 c720-r314251 root: Unknown USB device: vendor 0x04e6 product 0x5816 bus uhub0
2018-03-14 16:32:57 scdaemon[2735.802016000] listening on socket '/home/guru/.gnupg-ccid/S.scdaemon'
2018-03-14 16:32:57 scdaemon[2735.802017900] manejador del descriptor -1 iniciado
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> OK GNU Privacy Guard's Smartcard server ready
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 <- GETINFO socket_name
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> D /home/guru/.gnupg-ccid/S.scdaemon
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> OK
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 <- OPTION event-signal=31
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> OK
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 <- SERIALNO
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: apdu_open_reader: BAI=400
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: apdu_open_reader: new device=400
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: using CCID reader 0 (ID=04E6:5816:55511514602745:0)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: idVendor: 04E6  idProduct: 5816  bcdDevice: 0202
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: ChipCard Interface Descriptor:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bLength                54
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bDescriptorType        33
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bcdCCID              1.10  (Warning: Only accurate for version 1.0)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   nMaxSlotIndex           0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bVoltageSupport         7  ?
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwProtocols             3  T=0 T=1
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwDefaultClock       4800
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxiumumClock     16000
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bNumClockSupported      0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwDataRate          12903 bps
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxDataRate      600000 bps
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bNumDataRatesSupp.      0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxIFSD             252
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwSyncProtocols  00000000 2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwMechanical     00000000 2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwFeatures       000100BA
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     Auto configuration based on ATR (assumes auto voltage)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     Auto voltage selection
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     Auto clock change
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     Auto baud rate change
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     Auto PPS made by CCID
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:     TPDU level exchange
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxCCIDMsgLen       271
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bClassGetResponse    echo
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bClassEnvelope       echo
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   wlcdLayout           none
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bPINSupport             0 2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bMaxCCIDBusySlots       1
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: CCID submit transfer (83): 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-14 16:32:57 scdaemon[2735.802017900] reader slot 0: using ccid driver
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: enter: apdu_connect: slot=0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: enter: apdu_reset: slot=0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: leave: apdu_reset => sw=0x10009
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: leave: apdu_connect => sw=0x10009
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: enter: apdu_close_reader: slot=0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: enter: apdu_disconnect: slot=0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: leave: apdu_disconnect => sw=0x0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOff:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   [0007]  00 00 00
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_SlotStatus:
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 1
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver:   bClockStatus ......: 0x01 (stopped-L)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: libusb_cancel_transfer
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: ccid-driver: libusb_handle_events_completed
2018-03-14 16:32:57 scdaemon[2735.802280500] DBG: ccid-driver: CCID: interrupt callback 3
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: enter: apdu_open_reader: portstr=(null)
2018-03-14 16:32:57 scdaemon[2735.802017900] pcsc_establish_context failed: no service (0x8010001d)
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: leave: apdu_open_reader => slot=-1 [pc/sc]
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> ERR 100696144 Operation not supported by device 2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 <- RESTART
2018-03-14 16:32:57 scdaemon[2735.802017900] DBG: chan_7 -> OK
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 <- GETINFO version
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 -> D 2.1.19
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 -> OK
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 <- SERIALNO openpgp
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: apdu_open_reader: BAI=400
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: apdu_open_reader: new device=400
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: using CCID reader 0 (ID=04E6:5816:55511514602745:0)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: idVendor: 04E6  idProduct: 5816  bcdDevice: 0202
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: ChipCard Interface Descriptor:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bLength                54
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bDescriptorType        33
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bcdCCID              1.10  (Warning: Only accurate for version 1.0)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   nMaxSlotIndex           0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bVoltageSupport         7  ?
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwProtocols             3  T=0 T=1
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwDefaultClock       4800
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxiumumClock     16000
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bNumClockSupported      0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwDataRate          12903 bps
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxDataRate      600000 bps
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bNumDataRatesSupp.      0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxIFSD             252
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwSyncProtocols  00000000 2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwMechanical     00000000 2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwFeatures       000100BA
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     Auto configuration based on ATR (assumes auto voltage)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     Auto voltage selection
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     Auto clock change
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     Auto baud rate change
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     Auto PPS made by CCID
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:     TPDU level exchange
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwMaxCCIDMsgLen       271
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bClassGetResponse    echo
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bClassEnvelope       echo
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   wlcdLayout           none
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bPINSupport             0 2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bMaxCCIDBusySlots       1
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: CCID submit transfer (83): 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 1
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-14 16:33:10 scdaemon[2735.802017900] reader slot 0: using ccid driver
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: enter: apdu_connect: slot=0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: enter: apdu_reset: slot=0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOn:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bPowerSelect ......: 0x00 (auto)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   [0008]  00 00
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_DataBlock:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 4
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 65
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bError ............: 254
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: CCID command failed: CCID timed out while talking to the ICC
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: leave: apdu_reset => sw=0x10009
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: leave: apdu_connect => sw=0x10009
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: enter: apdu_close_reader: slot=0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: enter: apdu_disconnect: slot=0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: leave: apdu_disconnect => sw=0x0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: PC_to_RDR_IccPowerOff:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   [0007]  00 00 00
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: RDR_to_PC_SlotStatus:
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   dwLength ..........: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSlot .............: 0
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bSeq ..............: 5
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bStatus ...........: 1
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver:   bClockStatus ......: 0x01 (stopped-L)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: libusb_cancel_transfer
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: ccid-driver: libusb_handle_events_completed
2018-03-14 16:33:10 scdaemon[2735.802280a00] DBG: ccid-driver: CCID: interrupt callback 3
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: leave: apdu_close_reader => 0x0 (close_reader)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: enter: apdu_open_reader: portstr=(null)
2018-03-14 16:33:10 scdaemon[2735.802017900] pcsc_establish_context failed: no service (0x8010001d)
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: leave: apdu_open_reader => slot=-1 [pc/sc]
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 -> ERR 100696144 Operation not supported by device 2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 <- RESTART
2018-03-14 16:33:10 scdaemon[2735.802017900] DBG: chan_7 -> OK

@_date: 2018-03-15 10:53:30
@_author: Matthias Apitz 
@_subject: WKD planned for Purism's laptops and Librem 5 phone 
El d?a Thursday, March 15, 2018 a las 10:27:04AM +0100, Bernhard Reiter escribi?:
I have ordered in the crowd funding on October 7, 2017 one of these
Librem 5 phones (~600 Euro) and I'm keen to get hands on it next year in

@_date: 2018-05-16 10:02:21
@_author: Matthias Apitz 
@_subject: Vulnerable clients (was: US-CERT now issuing a warning for 
El d?a Tuesday, May 15, 2018 a las 10:44:16AM +0200, Werner Koch escribi?:
Werner, my conclusion in addition is that the table is incorrect.
Most (if not even all) of the MUA which are noted for Linux do run on
nearly any other UNIX flavor, FreeBSD, OpenBSD, ... and mutt in addition
runs  on Canonical Ubuntu for smartphones/tablets and UBports devices.

@_date: 2019-01-01 08:36:58
@_author: Matthias Apitz 
@_subject: OpenPGP card: how to lock the card again so that PIN is required 
This is with gnupg-2.2.12 and pcsc-lite-1.8.23. After an update of the
System (FreeBSD CURRENT) the /usr/local/sbin/pcscd does no work anymore
with the OpenPGP card (HID Global OMNIKEY 6121 Smart Card Reader) after
withdraw and re-insert. It works fine after boot, I have to enter
the PIN to unlock the card and all tested functions are working.
I have to investigate this further or change the 'scdaemon' to let it
directly access the OpenPGP bypassing the 'pcscd' (comments on this are
How can I meanwhile 'reset' the OpenPGP card so that on next request for
the secrets (decrypt, signing, ssh) the PIN is requested?

@_date: 2019-01-02 07:02:09
@_author: Matthias Apitz 
@_subject: OpenPGP card: how to lock the card again so that PIN is required 
El d?a martes, enero 01, 2019 a las 06:40:56p. m. +0100, Dirk Gottschalk escribi?:
There is no config file for pcscd, only for serial devices.
Interestingly the pcscd started via devd at boot time works fine:
$ ps ax | grep pc
 536 v0- S     0:00,98 /usr/local/sbin/pcscd --debug --foreground
When I disable this start at boot time and start the same command as
root from the shell (to investigate/debug), this just hangs. Also system
USB commands, like 'ucbconfig list', show the same problem. It looks
like something in the boot process after start of the above PID damages
the USB stack.
I did so, it shows (as started after boot) the same problem.
Yes, this was what I did before the update :-)
Thanks for your replay anyway.

@_date: 2019-01-02 11:58:50
@_author: Matthias Apitz 
@_subject: OpenPGP card: how to lock the card again so that PIN is required 
El d?a mi?rcoles, enero 02, 2019 a las 11:36:54a. m. +0100, Werner Koch escribi?:
Thanks. But I'm using this card and reader for a long time. And the same problem is
with the uTrust reader.
THANKS!!! This works and I now at least can disable the card when I go a
way from the laptop.
BTW: The CCID and the readers have no manuals how, i.e. in which
directions, one has to insert the CCID. Yesterday I took pictures to
have this clear now :-)

@_date: 2019-01-05 09:17:19
@_author: Matthias Apitz 
@_subject: OpenPGP card: how to lock the card again so that PIN is required 
El d?a martes, enero 01, 2019 a las 06:40:56p. m. +0100, Dirk Gottschalk escribi?:
To close this thread: It turned out being an issue in the USB chips in
my laptop which was not correctly handeled by the USB driver in the
kernel. It is fixed since yesterday with this commit:

@_date: 2019-01-07 13:53:26
@_author: Matthias Apitz 
@_subject: GnuPG: Bad Passphrase (try 2 of 3) 
I've GnuPG 2.1.12 on my mobile device (without any OpenPGP card) and
generated there a new secret key to encrypt credentials I'm using on
this device. I was a bit surprised reading (after entering a bas
passphrase for testing):
                 ??????????????????????????????????????????????????????????????????
                 ? Please enter the passphrase to unlock the OpenPGP secret key:  ?
                 ? "Matthias Apitz (BQ E4.5 key) "              ?
                 ? 4096-bit RSA key, ID FA46903FD2B8E5E9,                         ?
                 ? created 2019-01-07 (main key ID 8F3E3E3C247AB779).             ?
                 ?                                                                ?
                 ?                                                                ?
     **********> ? Bad Passphrase (try 2 of 3)                                    ?
                 ?                                                                ?
                 ? Passphrase: __________________________________________________ ?
                 ?                                                                ?
                 ?                 ?
                 ??????????????????????????????????????????????????????????????????
Note: This is not with the PIN of an OpenPGP-card. What would happen
exactly after the 3rd bad value? Destroy of the key or my device? :-)

@_date: 2019-01-13 12:57:59
@_author: Matthias Apitz 
@_subject: OpenPGP card: reader with 2 USB connectors 
I'm using an OpenPGP card in my FreeBSD laptop and my Ubuntu mobile
phone (see photo  )
The read is an Identiv uTrust 3512 SAM slot Token which works just fine
(after solving an issue in the FreeBSD USB driver). To connect it to the
mobile device one needs an small adapter or a cable. See the photo. All
this is not very stable, esp. the connector in the mobile device. Are there any
readers with two USB connectors like some USB memory sticks have?

@_date: 2019-07-31 21:39:36
@_author: Matthias Apitz 
@_subject: Forbes article: The Encryption Debate Is Over - Dead At The 
============================== START ==============================
Can you please move this discussion elsewhere. The purpose of this list
About Gnupg-users
GnuPG user help mailing list.
The topic of this is list is help and discussion among users of GnuPG.
This includes questions on how to script GnuPG, how to create or sign keys and
general discussion on encryption and digital signatures
as long as it somehow pertains to GnuPG.

@_date: 2019-06-21 11:20:17
@_author: Matthias Apitz 
@_subject: GnuPG and SSH_AUTH_SOCK value 
I'm using GnuPG together with an OpenPGP card among other things for ssh
access. The SSH_AUTH_SOCK value is to be set like this
# set SSH_AUTH_SOCK
unset SSH_AGENT_PID
unset SSH_AUTH_SOCK
SSH_AUTH_SOCK="$(gpgconf --list-dirs agent-ssh-socket)";
export SSH_AUTH_SOCK
What I do not understand is, why this value without the KDE5 environment
$ gpgconf --list-dirs agent-ssh-socket
and after start of Xorg and KDE5 it is:
$ gpgconf --list-dirs agent-ssh-socket
Why is this change/difference?

@_date: 2019-06-21 16:39:38
@_author: Matthias Apitz 
@_subject: GnuPG and SSH_AUTH_SOCK value 
El d?a viernes, junio 21, 2019 a las 03:13:45p. m. +0200, Werner Koch via Gnupg-users escribi?:
Thanks for the explanation. But why GNUPGHOME is not also used for the
place where the sockets should be created when X11/KDE is up?

@_date: 2019-06-23 10:21:34
@_author: Matthias Apitz 
@_subject: GnuPG and SSH_AUTH_SOCK value 
El d?a s?bado, junio 22, 2019 a las 09:47:12a. m. +0200, Werner Koch via Gnupg-users escribi?:
I'm used to use 'startx' and ~/.xinitrc to bring up Xorg+KDE:
$ cat ~/.xinitrc
# set SSH_AUTH_SOCK
unset SSH_AGENT_PID
unset SSH_AUTH_SOCK
SSH_AUTH_SOCK="$(gpgconf --list-dirs agent-ssh-socket)";
export SSH_AUTH_SOCK
echo SSH_AUTH_SOCK: $SSH_AUTH_SOCK  >> /tmp/xinit setxkbmap de,us -option terminate:ctrl_alt_bksp
xrandr --output default --mode 1366x768
exec ck-launch-session startkde
The idea is to set env var SSH_AUTH_SOCK correctly for all the xterm/urxvt
processes "below" KDE. But, before the start of KDE (last line) the
SSH_AUTH_SOCK is still and later when KDE is up the 'gpgconf --list-dirs agent-ssh-socket'
returns /var/run/user/1001/gnupg/d.m4rfaasqebhjmgto9ddm6m7y/S.gpg-agent.ssh
i.e. the env var SSH_AUTH_SOCK is set wrong and I have to reset it
in any terminal.

@_date: 2019-06-26 07:47:11
@_author: Matthias Apitz 
@_subject: gpg-agent systemd user service [was: Re: GnuPG and SSH_AUTH_SOCK 
El d?a martes, junio 25, 2019 a las 11:12:43a. m. -0400, Daniel Kahn Gillmor escribi?:
Thanks for all the helping hands and hints about systemd(8), but FreeBSD
normally does not run/use this. AFAIK, there is not even an official
port of it in the FreeBSD's ports collection.

@_date: 2019-03-26 13:55:07
@_author: Matthias Apitz 
@_subject: Please start a new thread 
El d?a Tuesday, March 26, 2019 a las 05:00:33PM +0530, Shweta Tyagi escribi?:
This depends on your Mail User Agent. It means "start a new mail with a
new Subject" to the addr gnupg-users at gnupg.org. DO NOT reply to another
thread when you have a new issue/problem/question.
And, DO NOT top post, btw.

@_date: 2019-05-06 07:26:50
@_author: Matthias Apitz 
@_subject: ProtonMail and Anonymity 
El d?a lunes, mayo 06, 2019 a las 07:15:06a. m. +0200, Stefan Claas escribi?:
Well, I'm asking myself: What has all this thread to do with GnuPG?

@_date: 2019-05-18 10:32:37
@_author: Matthias Apitz 
@_subject: GnuPG signature of mails && web.de 
I'm signing my mails with GnuPG (like this one), but a colleague is
claiming that she can't open the mails with some "App WebDe" (I don't
know this and do not have more information). She sent me two screens,
the list view of all mails in her INBOX says (in German) "ciphered mail"
about my mails and when she tries to open them it pops up a screen (in German)
"You still didn't have activated crypt on this device! What do you want todo?
For the activation you need some QR code or the restore code you got when
activating Web."
Any hints I could give her?

@_date: 2019-05-19 09:17:02
@_author: Matthias Apitz 
@_subject: GnuPG signature of mails && web.de 
Am Samstag, 18. Mai 2019 17:36:07 CEST schrieb Stefan Claas I do have for tests a mail account in web.de (and any 3 months they want it close due to inactivity), but I don't have that app and no iOs or Android

@_date: 2019-10-21 19:32:48
@_author: Matthias Apitz 
@_subject: gpg: There is no assurance this key belongs to the named user 
I wanted to insert a new password into my password store, but I can't do
so anymore. It says:
$ pass insert -m web/test3
Enter contents of web/test3 and press Ctrl+D when finished:
gpg: 61F1ECB625C9A6C3: There is no assurance this key belongs to the named user
gpg: [stdin]: encryption failed: Unusable public key
Password encryption aborted.
I can decrypt fine anything in the password store:
$ gpg2 -d ~/.password-store/web/test2.gpg
gpg: encrypted with 4096-bit RSA key, ID 61F1ECB625C9A6C3, created 2017-05-14
      "Matthias Apitz (GnuPG CCID) "
but encryption seems to be the problem:
$ gpg2 -ea -r "Matthias Apitz (GnuPG CCID) " file
gpg: 61F1ECB625C9A6C3: There is no assurance this key belongs to the named user
sub  rsa4096/61F1ECB625C9A6C3 2017-05-14 Matthias Apitz (GnuPG CCID)  Primary key fingerprint: 5E69 FBAC 1618 562C B3CB  FBC1 47CC F7E4 76FE 9D11
      Subkey fingerprint: EB62 00DA 13A1 9E80 679B  1A13 61F1 ECB6 25C9 A6C3
It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.
Use this key anyway? (y/N)
What might be the problem in my $GNUPGHOME:
$ ls -l $GNUPGHOME
total 456
srwx------  1 guru  wheel       0 Oct 21 18:16 S.gpg-agent
srwx------  1 guru  wheel       0 Oct 21 18:16 S.gpg-agent.browser
srwx------  1 guru  wheel       0 Oct 21 18:16 S.gpg-agent.extra
srwx------  1 guru  wheel       0 Oct 21 18:16 S.gpg-agent.ssh
srwx------  1 guru  wheel       0 Oct 21 18:16 S.scdaemon
drwx------  2 guru  wheel    1024 Sep 21 10:08 crls.d
-rw-------  1 guru  wheel    2649 May 12  2017 dirmngr.conf
-rw-r--r--  1 guru  wheel      95 Jan  1  2019 gpg-agent.conf
-rw-------  1 guru  wheel    5191 May 12  2017 gpg.conf
drwx------  2 guru  wheel     512 May 14  2017 openpgp-revocs.d
drwx------  2 guru  wheel     512 May 14  2017 private-keys-v1.d
-rw-------  1 guru  wheel   38835 Oct 11 14:02 pubring.gpg
-rw-------  1 guru  wheel   38835 Oct 11 14:02 pubring.gpg~
-rw-------  1 guru  wheel  159155 Sep 30 16:46 pubring.kbx
-rw-------  1 guru  wheel  157316 Sep 21 10:07 pubring.kbx~
-rw-------  1 guru  wheel     600 Oct  5 16:57 random_seed
-rw-r--r--  1 guru  wheel       7 Oct 21 19:01 reader_0.status
-rwxr-xr-x  1 guru  wheel    3386 Mar 15  2018 scd-event
-rw-r--r--  1 guru  wheel     123 Jan  5  2019 scdaemon.conf
-rw-r--r--  1 guru  wheel     141 Mar 13  2018 scdaemon.conf.away
-rw-------  1 guru  wheel       0 Dec 28  2017 secring.gpg
-r--------  1 guru  wheel    1865 May 14  2017 sk_61F1ECB625C9A6C3.gpg
-rw-r-----  1 guru  wheel     676 May 15  2017 sshcontrol
-rw-------  1 guru  wheel    1280 Oct 11 14:02 trustdb.gpg
-rw-r-----  1 guru  wheel    1900 Jul 22 21:52 trustlist.txt
I have enough older backups of this part of my $HOME, but would like to
understand what is missing or damaged, and how it happened, and how to
fix it.

@_date: 2019-10-21 20:38:04
@_author: Matthias Apitz 
@_subject: gpg: There is no assurance this key belongs to the named user 
El d?a lunes, octubre 21, 2019 a las 07:32:48p. m. +0200, Matthias Apitz escribi?:
The culprit was this file:
$ ls -l ~/.gnupg-ccid/trustdb*
-rw-------  1 guru  wheel  1280 23 may.   2017 /home/guru/.gnupg-ccid/trustdb.gpg
-rw-------  1 guru  wheel  1280 11 oct.  14:02 /home/guru/.gnupg-ccid/trustdb.gpg.20191011
after renaming it and restoring the previous version (not modified for
ages) of trustdb.gpg all is fine again. What caused the change on
October 11 remains unclear so far.

@_date: 2019-10-22 20:18:36
@_author: Matthias Apitz 
@_subject: gpg: There is no assurance this key belongs to the named user 
El d?a lunes, octubre 21, 2019 a las 08:38:04p. m. +0200, Matthias Apitz escribi?:
I exported both files which gives the same export:
$ ls -l trustdb.gp*
-rw-------  1 guru  wheel  1280 23 may.   2017 trustdb.gpg
-rw-------  1 guru  wheel  1280 11 oct.  14:02 trustdb.gpg.20191011
$ diff trustdb.gp*
Binary files trustdb.gpg and trustdb.gpg.20191011 differ
$ gpg2 --trustdb-name trustdb.gpg.20191011 --export-ownertrust
# List of assigned trustvalues, created Tue Oct 22 20:14:22 2019 CEST
# (Use "gpg --import-ownertrust" to restore them)
$ gpg2 --export-ownertrust
# List of assigned trustvalues, created Tue Oct 22 20:14:27 2019 CEST
# (Use "gpg --import-ownertrust" to restore them)
What does this mean? Why gpg2 was unwilling to use the file

@_date: 2019-10-25 20:17:22
@_author: Matthias Apitz 
@_subject: gpg: There is no assurance this key belongs to the named user 
El d?a martes, octubre 22, 2019 a las 08:18:36p. m. +0200, Matthias Apitz escribi?:
Is this a FAQ or otherwise stupid question, or what's the reason that
nobody wants to give me some hint about this? Thanks

@_date: 2019-09-29 10:27:20
@_author: Matthias Apitz 
@_subject: unknown modified files in GNUPGHOME 
While doing a backup of my $HOME it turned out (what I never saw
before), that some file were changed in GNUPGHOME:
-rw-------  1 guru  wheel    157316 21 sept. 10:07 .gnupg-ccid/pubring.kbx
-rw-------  1 guru  wheel    155467 21 sept. 10:07 .gnupg-ccid/pubring.kbx~
drwx------  2 guru  wheel      1024 21 sept. 10:08 .gnupg-ccid/crls.d/
-rw-------  1 guru  wheel      3997 21 sept. 10:08 .gnupg-ccid/crls.d/DIR.txt
-rw-------  1 guru  wheel  17715895 21 sept. 10:08 .gnupg-ccid/crls.d/crl-CDECFDC58640B7262B39CCB59B61E8EEFF2ED4D0.db
All more or less at the same moment. Any ideas what could have caused

@_date: 2020-04-01 17:30:29
@_author: Matthias Apitz 
@_subject: can not encrypt (but decrypt) dues to missing pub key 
I encounter in my server the following situation: I can decrypt files
but not encrypting any file:
$ gpg2 --version
gpg (GnuPG) 2.1.19
libgcrypt 1.7.6
Copyright (C) 2017 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Home: /home/guru/.gnupg-v2.1.19
Supported algorithms:
Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2
$ gpg -d sybase.gpg gpg: encrypted with 2048-bit RSA key, ID 2802AB9D46B97090, created 2018-03-11
      "guru at unixarea.de"
... (clear text deleted) ....
$ gpg2 -r guru at unixarea.de -ea test gpg: guru at unixarea.de: skipped: No public key
gpg: test: encryption failed: No public key
It seems that there is the file pubring.gpg missing:
$ ls -ltr /home/guru/.gnupg-v2.1.19
total 36
-rw-------  1 guru  wheel    32 11 mar.   2018 pubring.kbx~
-rw-r--r--  1 guru  wheel  1396 11 mar.   2018 pubring.kbx
drwx------  2 guru  wheel   512 11 mar.   2018 private-keys-v1.d
drwx------  2 guru  wheel   512 11 mar.   2018 openpgp-revocs.d
-rw-r-----  1 guru  wheel   676 28 mar.   2018 sshcontrol
srwx------  1 guru  wheel     0 11 abr.   2018 S.scdaemon
-rw-r--r--  1 guru  wheel     7 11 abr.   2018 reader_0.status
-rw-r--r--  1 guru  wheel    37  1 ene.   2019 gpg-agent.conf
-rw-------  1 guru  wheel   600  6 sept.  2019 random_seed
srwx------  1 guru  wheel     0  1 abr.  15:40 S.gpg-agent
srwx------  1 guru  wheel     0  1 abr.  15:40 S.gpg-agent.extra
srwx------  1 guru  wheel     0  1 abr.  15:40 S.gpg-agent.browser
srwx------  1 guru  wheel     0  1 abr.  15:40 S.gpg-agent.ssh
-rw-------  1 guru  wheel  1280  1 abr.  16:17 trustdb.gpg
Can I re-create the missing information/file somehow?

@_date: 2020-04-01 19:39:24
@_author: Matthias Apitz 
@_subject: can not encrypt (but decrypt) dues to missing pub key 
El d?a Mittwoch, April 01, 2020 a las 06:59:17 +0200, Ingo Kl?cker escribi?:
Sorry for this confusion. gpg is just a symlink to gpg2:
$ which gpg
$ which gpg2
$ ls -l /usr/local/bin/gpg /usr/local/bin/gpg2
lrwxr-xr-x  1 root  wheel       4 27 mar.   2017 /usr/local/bin/gpg -> gpg2
-r-xr-xr-x  1 root  wheel  903648  5 mar.   2017 /usr/local/bin/gpg2
Ok, this explains its absence.
Ok, but why encryption does not work? As you see the file pubring.kbx is
not changed since it was created.

@_date: 2020-04-01 20:16:30
@_author: Matthias Apitz 
@_subject: can not encrypt (but decrypt) dues to missing pub key 
El d?a Mittwoch, April 01, 2020 a las 08:06:01 +0200, Ingo Kl?cker escribi?:
$ gpg --list-public-keys --with-colons guru at unixarea.de
uid:e::::1520759851::DD2F57BCBE052BF39F1E41416DB8DF884B56DB02::guru at unixarea.de:

@_date: 2020-04-01 22:10:44
@_author: Matthias Apitz 
@_subject: can not encrypt (but decrypt) dues to missing pub key 
El d?a Mittwoch, April 01, 2020 a las 09:42:48 +0200, Ingo Kl?cker escribi?:
Yes, the key expired some days ago:
$ gpg --list-public-keys  guru at unixarea.de
pub   rsa2048 2018-03-11 [SC] [expired: 2020-03-10]
      8BCE0232807D4CCB4F8800D17BA6AC955EAA2665
uid           [ expired] guru at unixarea.de
I don't know how this happened when I generated the keys.
I assume that there's no way to shift the expiration date?
If not, I will decrypt all files, generate new keys and crypt the files

@_date: 2020-04-01 22:38:33
@_author: Matthias Apitz 
@_subject: can not encrypt (but decrypt) dues to missing pub key 
El d?a Mittwoch, April 01, 2020 a las 10:19:09 +0200, Erich Eckner escribi?:
Hello Ingo and Erich,
You both saved my day. Thank you!
Bleibt gesund!

@_date: 2020-08-10 01:38:57
@_author: Matthias Apitz 
@_subject: In case you use OpenPGP on a smartphone ... 
El d?a domingo, agosto 09, 2020 a las 10:06:13p. m. +0200, Stefan Claas escribi?:
One can use a Linux mobile phone running UBports.com (as I and all my family do)
or the upcoming Puri.sm L5 (as I pre-ordered in October 2017).
Stop whining, stand up and fight and protect yourself.

@_date: 2020-08-11 09:15:33
@_author: Matthias Apitz 
@_subject: In case you use OpenPGP on a smartphone ... 
El d?a Montag, August 10, 2020 a las 09:07:51 +0200, Stefan Claas escribi?:
The kernel and all apps are OpenSource i.e. people can (and do) read the
sources. It's impossible to build in backdoors. The attack could come
through the firmware in the chips (which are not OpenSource). For this
the Puri.sm L5 (and the laptops they make also) have 3 hardware keys to
poweroff WiFi, Cellular, Microphone/Cameras (all 3 will turn off GPS).
The authorities can not track you. See:

@_date: 2020-02-22 07:49:37
@_author: Matthias Apitz 
@_subject: command "SCD SERIALNO openpgp" not answered correctly 
I'm preparing the move to a new FreeBSD version (bleeding edge CURRENT with all
ports from beginning of February).
My OpenPGP card works in the "Identiv uTrust 3512 SAM slot Token" fine on
the new setup for decrypting my passwordstore and SSH.
On the old system where GnuPG is 2.2.12, the 'gpg2 --card-status' says:
$ gpg2 --card-status
Reader ...........: 04E6:5816:55511725600891:0
Application ID ...: D27600012401020100050000532B0000
Version ..........: 2.1
Manufacturer .....: ZeitControl
Serial number ....: 0000532B
Name of cardholder: Matthias Apitz
But on the new system it does work correctly. Here are the details:
$ uname -a
FreeBSD c720-r357756 13.0-CURRENT FreeBSD 13.0-CURRENT  r357756: Tue Feb 11 18:52:09 CET 2020     guru at jet:/usr/obj/usr/src/amd64.amd64/sys/GENERIC  amd64
$ gpg2 --version
gpg (GnuPG) 2.2.19
libgcrypt 1.8.5
Copyright (C) 2019 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Home: /home/guru/.gnupg-ccid
Supported algorithms:
Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2
$ gpg2 --card-status
gpg: selecting card failed: Operation not supported by device
gpg: OpenPGP card not available: Operation not supported by device
$ gpg2 --card-edit
gpg: selecting card failed: Operation not supported by device
gpg: OpenPGP card not available: Operation not supported by device
A trussing (it's like Linux strace) shows the offending dialog with the
$ truss -o tr gpg2 --card-status
connect(3,{ AF_UNIX "/var/run/user/1001/gnupg/d.m4rfaasqebhjmgto9ddm6m7y/S.gpg-agent" },65) = 0 (0x0)
read(3,"OK Pleased to meet you",1002)		 = 22 (0x16)
read(3,"\n",980)				 = 1 (0x1)
write(3,"RESET",5)				 = 5 (0x5)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
mmap(0x0,4096,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANON|MAP_ALIGNED(12),-1,0x0) = 34379100160 (0x801277000)
mmap(0x0,4096,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANON|MAP_ALIGNED(12),-1,0x0) = 34379104256 (0x801278000)
write(3,"OPTION ttyname=/dev/pts/1",25)		 = 25 (0x19)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
write(3,"OPTION ttytype=rxvt-unicode-256c"...,36) = 36 (0x24)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
write(3,"OPTION display=:0",17)			 = 17 (0x11)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK\n",1002)				 = 3 (0x3)
write(3,"OPTION xauthority=/home/guru/.Xa"...,40) = 40 (0x28)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK\n",1002)				 = 3 (0x3)
write(3,"OPTION lc-ctype=es_ES.UTF-8",27)	 = 27 (0x1b)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
write(3,"OPTION lc-messages=es_ES.UTF-8",30)	 = 30 (0x1e)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
write(3,"GETINFO version",15)			 = 15 (0xf)
write(3,"\n",1)					 = 1 (0x1)
read(3,"D 2.2.19\n",1002)			 = 9 (0x9)
read(3,"OK\n",1002)				 = 3 (0x3)
write(3,"OPTION allow-pinentry-notify",28)	 = 28 (0x1c)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK\n",1002)				 = 3 (0x3)
write(3,"OPTION agent-awareness=2.1.0",28)	 = 28 (0x1c)
write(3,"\n",1)					 = 1 (0x1)
read(3,"OK",1002)				 = 2 (0x2)
read(3,"\n",1000)				 = 1 (0x1)
write(3,"SCD GETINFO version",19)		 = 19 (0x13)
write(3,"\n",1)					 = 1 (0x1)
read(3,"D 2.2.19\n",1002)			 = 9 (0x9)
read(3,"OK\n",1002)				 = 3 (0x3)
write(3,"SCD SERIALNO",12)			 = 12 (0xc)
write(3,"\n",1)					 = 1 (0x1)
read(3,"ERR 100696144 Operation not supp"...,1002) = 54 (0x36)
fstatat(AT_FDCWD,"/usr/share/nls/es_ES.UTF-8/libc.cat",0x7fffffffd570,0x0) ERR 'No such file or directory'
fstatat(AT_FDCWD,"/usr/share/nls/libc/es_ES.UTF-8",0x7fffffffd570,0x0) ERR 'No such file or directory'
fstatat(AT_FDCWD,"/usr/local/share/nls/es_ES.UTF-8/libc.cat",0x7fffffffd570,0x0) ERR 'No such file or directory'
fstatat(AT_FDCWD,"/usr/local/share/nls/libc/es_ES.UTF-8",0x7fffffffd570,0x0) ERR 'No such file or directory'
write(2,"gpg: selecting card failed: Oper"...,61) = 61 (0x3d)
write(2,"\n",1)					 = 1 (0x1)
On the old system the agent answers:
write(3,"SCD SERIALNO openpgp",20)               = 20 (0x14)
write(3,"\n",1)                                  = 1 (0x1)
read(3,"S SERIALNO D27600012401020100050"...,1002) = 44 (0x2c)
read(3,"OK\n",1002)                              = 3 (0x3)
write(3,"LEARN --sendinfo",16)                   = 16 (0x10)
write(3,"\n",1)                                  = 1 (0x1)
What could be causing this?

@_date: 2020-03-08 10:03:28
@_author: Matthias Apitz 
@_subject: Broken / lost smartcard 
El d?a domingo, marzo 08, 2020 a las 09:11:49a. m. +0100, Andreas K. Huettel via Gnupg-users escribi?:
For me the bigger problem would be the stored crypted data in the
password-store where I have nearly 300 credentials:
$ find .password-store -type f | wc -l
     282
I wrote a script which decrypts all these files to STDOUT in a form which
could be fed again into the pass(1) command and stores this
in some secure place from time to time.

@_date: 2020-11-23 07:08:12
@_author: Matthias Apitz 
@_subject: Thunderbird / Enigmail / Autocrypt 
El d?a lunes, noviembre 23, 2020 a las 03:03:54a. m. +0100, Johan Wevers escribi?:
Since ages human read mails in ASCII or UTF-8 text. Why you think this
is not a "human readable format"?
HTML as e-mail (read carefully: as email, not as attachment) should be
forbidden because most MUA automatically fetch additional remote content
which violates privacy and can fetch bad content into your system.
You're warned.

@_date: 2020-11-23 09:01:15
@_author: Matthias Apitz 
@_subject: Thunderbird / Enigmail / Autocrypt 
El d?a lunes, noviembre 23, 2020 a las 07:22:19a. m. +0000, cqcallaw escribi?:
Below you find a good example of such HTML SPAM going directly to an
external web server to fetch an "IMG" which could contain malisious code.
Is this what you really want to send to your boss or colleagues?
Unbenanntes Dokument
FFP2 Maske 1,89 bzw. 1,99 Euro. Die beliebteste und
meist getragene Atemmaske der Welt.
Sehr geehrte Damen und Herren,
Folgende Angebote sind sofort lieferbar, einzeln verschweisst:
CE-Zertifiziert durch Institut der europischen
Union. Schutzklasse FFP2! (KN95) Guter Schutz vor
SARSCoV2 - Covid19CoronaViren.
Lieferung an Firmen, Behrden, Arztpraxen, Apotheken, Kliniken
Abnahmemengen: 10er weise oder 100er weise.
FFP2 Atemschutzmasken: (Auch nach AT, CH, NL, LU) 10
St. 19,90 Euro zzgl. 16 Proz. MwSt.
Angebot fr Firmen, Kliniken, Arztpraxen: 100 St.
189,- Euro zzgl. 16 Proz. MwSt.
(Grere Mengen auch sofort lieferbar.)
Bestellen Sie ganz einfach und zeitsparend, in dem Sie uns auf dieses
Schreiben einfach antworten.
(Lieferung auf Rechnung. Keine Vorkasse oder hnliches.)
ceschutz at gmx.de
Versandkostenfreie Lieferung!
6 Wochen Rckgaberecht bei Nichtgefallen! Ihnen enstehen keine
Mit freundlichen Gren,
Michaela Kress CE-Schutz Vertrieb Hannover
Bitte antworten Sie uns direkt per Email.
EU-Kunden knnen gern die Umsatzsteuernummer (VAT) angeben.

@_date: 2020-11-24 06:31:46
@_author: Matthias Apitz 
@_subject: Ban HTML mails? Really?(was: Re: Thunderbird / Enigmail / 
El d?a martes, noviembre 24, 2020 a las 12:16:12a. m. +0000, Philihp Busby via Gnupg-users escribi?:
There are some other two battles to win: Don't top post and, second,
break your text lines around coulmn 72 :-)

@_date: 2020-11-28 09:44:32
@_author: Matthias Apitz 
@_subject: Mobile mini computers for GnuPG/OpenPGP usage instead of 
El d?a s?bado, noviembre 28, 2020 a las 07:59:40a. m. +0000, Stefan Claas via Gnupg-users escribi?:
Hi Stefan,
Could you please share with me the contact to the German reseller?
Thanks in advance.
Have you seen this alternative: I funded the campaign in October 2017 (USD 599) and now, after three years
they start delivery to the backers.

@_date: 2020-10-07 08:53:26
@_author: Matthias Apitz 
@_subject: Five volunteers needed (EU only please) 
El d?a lunes, octubre 05, 2020 a las 05:37:57p. m. +0200, Stefan Claas escribi?:
I think, even 3rd parties inside the EU will (and should) have it
difficult to intercept messages in order to protect communication in the
EU (and not only businesses). Why do you underlined outside only?

@_date: 2020-10-10 19:40:57
@_author: Matthias Apitz 
@_subject: Five volunteers needed (EU .... Are you sure that this is really 
El d?a s?bado, octubre 10, 2020 a las 03:57:39p. m. +0200, Stefan Claas escribi?:
As one of the testers: Using an iOS system is not a real world option for me
because the iOS can execute commands stored on the NFC tag and getting a
plain file out of the tag over to some UNIX laptop is tricky. A real
world option for me would only be a Linux based mobile, like the UBports.com
ones or a Purism L5, both have no NFC hardware at the moment and would
need an additional reader gadget.

@_date: 2020-10-11 15:08:21
@_author: Matthias Apitz 
@_subject: Five volunteers needed (EU .... Are you sure that this is really 
El d?a s?bado, octubre 10, 2020 a las 09:04:18p. m. +0200, Stefan Claas escribi?:
I haven't tested it, but it is wiely known, for example:

@_date: 2020-10-11 17:34:30
@_author: Matthias Apitz 
@_subject: Five volunteers needed (EU .... Are you sure that this is really 
El d?a domingo, octubre 11, 2020 a las 03:55:25p. m. +0200, Stefan Claas escribi?:
Hmm, nice that others can rewrite your NFC tag (the UID matters) with
bad shortcut commands, only having loosely access to a NFC tag you
tabbed, for example, in your car. Maybe we have different opinions about

@_date: 2020-10-13 15:11:04
@_author: Matthias Apitz 
@_subject: binary distribution of GnuPG for SuSE Linux SLES 15 
Is there any provider for a binary RPM for this OS:
# cat /etc/os-release
PRETTY_NAME="SUSE Linux Enterprise Server 15 SP1"
Or do we have to compile it from source?
