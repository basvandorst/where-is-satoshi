
@_date: 2005-09-05 10:50:21
@_author: Ryley Breiddal 
@_subject: [outlgpg] Outlook 2002 Crash 
Hi there,
I'm running Outlook 2002 SP2 on Windows 2000, and whenever I try to sign
a message, Outlook crashes.  There was a report recently, archived at
whose symptoms match mine exactly.
I have GPGExch.dll version 0.6.1 and libgpgmedlgs.dll version 0.99.4.
My GPG version is 1.4.2 (I installed WinPT 0.10.0).
I've noticed a couple things.  The GnuPG prefs dialog seems to lose my
settings on a fairly regular basis, seemingly on the crashes.  I also
get a mix of crashes that pop up the "send a report to MS" dialog and
ones that just silently close Outlook.  The loss of settings always
comes with the first group of crashes.  The settings that keep getting
lost are specifically "Also encrypt with default key" and the logging
location.  The stuff in advanced always stays the same.
Path to key-manager binary question - I saw somewhere that I should set
it to "PATH/WinPT.exe --keymanager" but I can't get it to accept
anything but "PATH/WinPT.exe".  Any suggestions?
Similarly to Richard, I haven't figured out how to get a stack trace out
of Outlook yet, but I'm working on it.  In the meantime, I'm happy to
provide any other information that might be of interest.
Please CC any replies to me, as I'm not on the mailing list.
Ryley Breiddal
PresiNET Systems

@_date: 2005-09-13 11:13:23
@_author: Ryley Breiddal 
@_subject: [outlgpg] Outlook 2002 Crash 
Excellent.  I have updated to this version, which now leaves me with the
Outlook 2002 SP2
GPGol 0.9.0
GPG 1.4.2
WinPT 0.10.1 (updated this too)
Everything is still the same in terms of crashes on signing, and I
logged the following from the Debug log:
2636/olflange.cpp:ExchEntryPoint: creating new CGPGExchExt object
2636/olflange.cpp:Install: context=0x6 (SendNoteMessage) flags=0x0
2636/olflange.cpp:InstallCommands: context=0x6 (SendNoteMessage)
2636/olflange.cpp:find_outlook_property: looking for `ConversationIndex'
2636/olflange.cpp:find_outlook_property:    got IDispatch=05F1860C
2636/olflange.cpp:InstallCommands: ConversationIndex is `'
2636/olflange.cpp:OnCheckNames: received
2636/olflange.cpp:OnCheckNamesComplete: received
2636/olflange.cpp:OnSubmit: received
2636/olflange.cpp:OnWrite: received
2636/olflange.cpp:OnWriteComplete: received
2636/gpgmsg.cpp:sign: enter message=02F165A0
2636/gpgmsg.cpp:loadBody: loaded body `Test Message ' at 02BFD9B8
2636/decrypt_key_dlg_proc: WM_INITDIALOG
I'm not sure if it's of interest, but there was other bits like this in
the log:
2264/gpgme can't find a suitable OpenPGP backend: Invalid crypto engine
2264/olflange.cpp:CGPGExchExt: first time initialization done
2264/olflange.cpp:Install: context=0x1 (Session) flags=0x0
2264/olflange.cpp:Install: can't handle this context
2264/olflange.cpp:~CGPGExchExt: cleaning up CGPGExchExt object
2264/olflange.cpp:~CGPGExchExt: DLL closed down
2264/olflange.cpp:ExchEntryPoint: creating new CGPGExchExt object
2264/gpgme can't find a suitable OpenPGP backend: Invalid crypto engine
2264/olflange.cpp:CGPGExchExt: first time initialization done
2264/olflange.cpp:Install: context=0x2 (Viewer) flags=0x0
2264/olflange.cpp:InstallCommands: context=0x2 (Viewer) flags=0x0
2264/olflange.cpp:ExchEntryPoint: creating new CGPGExchExt object
2264/olflange.cpp:Install: context=0x7 (ReadNoteMessage) flags=0x0
2264/olflange.cpp:InstallCommands: context=0x7 (ReadNoteMessage)
2264/olflange.cpp:OnRead: received
Which seemed interesting - gpgme seems to be complaining that it can't
find gpg.exe, but it is properly specified in Tools->Options->Advanced
(in Outlook, if that's even relevant).
For quicker response, CC me on replies.
Ryley Breiddal
