
@_date: 2016-08-24 16:24:49
@_author: martin 
@_subject: Attacks on encrypted communicxatiopn rising in Europe 
For my ?0.02 I think the above is mostly valid bar 2 small details:
1. Seldom we do find the FBI breaking security of anonymity tools. Only
if a high profile case shows up or someone leaks it. I think it is even
more rare for the FBI to outright disclose the vulnerability they used
so it can be patched. I don't even know if the other 3 letter agencies
do it.
2. Crypto arms race also implies stock piling vulnerabilities -
something Bruce Schneier is very vocal about [1][2]. I think the answer
here is to find a balance of some sort - i.e. keep vulnerabilities in
rare cases for short periods of time and then disclose and patch them.
However for that to work we need to trust the govt. to do the right
thing. Which I think is pretty much the core issue that started this
[1] Hacking Team, Computer Vulnerabilities, and the NSA -
[2] Disclosing vs. Hoarding Vulnerabilities -

@_date: 2016-02-25 14:42:32
@_author: Martin Ilchev 
@_subject: cipher used when both --encrypt and --symmetric is specified 
I am looking for some help to figure out what cipher is used for symmetric
encryption when both pass phrase and public keys are used. I have
configured my gpg.conf with my preferred cipher algorithms as follows:
personal-cipher-preferences AES256 TWOFISH CAMELLIA256 AES192 CAMELLIA192
AES CAST5 CAMELLIA128 BLOWFISH IDEA 3DES
I have ran the following tests:
1. Symmetrically encrypt a file:
$gpg2 --symmetric somefile
decrypting that file shows the correct cipher being used (I am looking at
symkey enc packet field cipher 9 - aes256):
$ gpg2 -vvv --decrypt somefile.gpg
gpg: using character set `utf-8'
:symkey enc packet: version 4, cipher 9, s2k 3, hash 10
        salt 7ff4f273bd71e14e, count 24117248 (231)
gpg: AES256 encrypted data
:encrypted data packet:
        length: 360
        mdc_method: 2
gpg: encrypted with 1 passphrase
:compressed packet: algo=1
:literal data packet:
        mode b (62), created 1456410134, name="somefile",
        raw data: 1551 bytes
gpg: original file name='somefile'
2. Symmetrically encrypt and also encrypt for my own public key:
gpg2 -vvv --symmetric --encrypt --sign -r 0x1234567890ABCDEF somefile
decrypting the file shows that the cipher used is CAST5 (again looking at
the same symkey enc packet field cipher 3 - CAST5):
$ gpg2 -vvv --decrypt somefile.gpg
gpg: using character set `utf-8'
:pubkey enc packet: version 3, algo 1, keyid 1234567890ABCDEF
        data: [4096 bits]
gpg: public key is 0x1234567890ABCDEF
gpg: using subkey 0x1234567890ABCDEF instead of primary key
gpg: selecting openpgp failed: Card not present
:symkey enc packet: version 4, cipher 3, s2k 3, hash 10, seskey 256 bits
        salt 7fa903ae28975d77, count 24117248 (231)
gpg: CAST5 encrypted session key
:encrypted data packet:
        length: unknown
        mdc_method: 2
gpg: encrypted with 1 passphrase
gpg: using subkey 1234567890ABCDEF instead of primary key 1234567890ABCDEF
gpg: encrypted with 4096-bit RSA key, ID 1234567890ABCDEF, created
      "Martin"
gpg: public key decryption failed: Operation cancelled
gpg: AES256 encrypted data
:compressed packet: algo=2
:onepass_sig packet: keyid 1234567890ABCDEF
        version 3, sigclass 0x00, digest 10, pubkey 1, last=1
:literal data packet:
        mode b (62), created 1456410193, name="somefile",
        raw data: 1551 bytes
gpg: original file name='somefile'
To get the cipher name from the cipher numbers I check RFC4880 (
My expectation is that symmetric encryption should use the same cipher
(AES256) in both cases.
Can someone please explain if the above is the expected behaviour or if my
expectations are wrong?
I am running Debin 8.3 with gnupg2 2.0.26-6. I use gpg2 because my 4096b
public/private keys are on a smart card.
I also apologies for the really long e-mail.
Kind Regards,

@_date: 2016-02-26 10:44:27
@_author: Martin Ilchev 
@_subject: cipher used when both --encrypt and --symmetric is specified 
Hi Peter,
Thanks for the reply.
I did browse the man pages quite a bit (I am a bit afraid I browsed too
much and touched stuff I should leave well alone :))
I did set my key preferences a few months ago and made sure the key had
them as well. Here is the output of showperf:
     Cipher: AES256, AES192, AES, CAST5, 3DES
     Digest: SHA512, SHA384, SHA256, SHA224, SHA1
     Compression: ZLIB, BZIP2, ZIP, Uncompressed
     Features: MDC, Keyserver no-modify
Also here is all the stuff I have in my gpg.conf:
    personal-cipher-preferences AES256 TWOFISH CAMELLIA256 AES192
CAMELLIA192 AES CAST5 CAMELLIA128 BLOWFISH IDEA 3DES
    personal-digest-preferences SHA512 SHA384 SHA256 SHA224 AES256 AES192
AES CAST5 ZLIB BZIP2 ZIP Uncompressed
    s2k-digest-algo SHA512
    keyserver hkps://hkps.pool.sks-keyservers.net
    keyserver-options
    keyserver-options no-honor-keyserver-url
    keyid-format 0xlong
    with-fingerprint
    cert-digest-algo SHA512
    default-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES
CAST5 ZLIB BZIP2 ZIP Uncompressed
    use-agent
Let me know if you need more info.

@_date: 2016-02-29 10:51:39
@_author: Martin Ilchev 
@_subject: cipher used when both --encrypt and --symmetric is specified 
Hi Vedaal,
You are correct that is not my real key ID.
Funny enough the key was generated in Nov-2015. However you are absolutely
correct about the --s2k-cipher-algo option. I added that to my gpg.conf and
after that symmetric + public works exactly as I expected. I get AES256
every time.
There is one thing I would like to understand - the man page says:
       --s2k-cipher-algo name
              Use  name as the cipher algorithm used to protect secret
keys.  The default cipher is CAST5. This cipher is also used for
conventional encryption if --personal-cipher-pref?
              erences and --cipher-algo is not given.
So CAST5 is the preferred cipher for secret keys and is also the default
for symmetric. On the other hand using --personal-cipher-preferences does
not seem to apply to symmetric + public encryption. Is this by design?

@_date: 2016-02-29 14:26:49
@_author: Martin Ilchev 
@_subject: cipher used when both --encrypt and --symmetric is specified 
Hi Peter,
Thanks for the advice. I will have a look at the mailing list. For now I am
happy that I have a working solution.
Thank you and Vedaal for the help.

@_date: 2016-02-29 15:31:52
@_author: Martin Ilchev 
@_subject: Question about getting started with PGP and smart cards 
Hi Josh,
I am using a smart card and reader for about 6 months now. The set up I
went with is:
Smart-card "OpenPGP Smartcard V2.1" from kernel concepts (
 The card supports keys up to 4096 length
with gpg2.
Card-reader - Gemalto GemPC Twin/TR (IDBridge CT30) - works out of the box
on linux and windows (tested it on windows 7 SP1 and windows 8.1). I got
mine here
To get the card reader working in Linux I used this guide to get me started
(was able to set everything up with no hassle) -
 I only needed to
install pcsc-tools and pcscd.
For Windows I installed gpg4win and migrated my linux gpg.conf and keys
over and it just worked. Also in windows if you want to use putty with a
smart card you will need a patched putty agent. You can get one from here
 It is free to use with OpenPGP
Smartcards from kernel concepts so a win-win :).
Last but not least - make sure to back up your private keys! Once a key is
on the card it is impossible to get it back.
I only got the above for test use but now I am using it every day at work,
at home and on my laptop without any issues. I can sign, encrypt/decrypt as
well as authenticate for SSH with a single smart card.
Let me know if you need any additional information.
On Sat, 27 Feb 2016 at 17:44 Antoine Michard

@_date: 2017-10-25 17:25:14
@_author: martin 
@_subject: gpg-agent 2.1 persistent socket between sessions 
Hash: SHA512
Alternatively you can look into `KillUserProcesses` and
`KillExcludeUsers` options for systemd-logind[1].
For some distributions `KillUserProcesses` defaults to yes which will
clean up all background running processes.Changing that to no will leave
processes lingering but can potentially cause other problems.
[1] -

@_date: 2017-09-15 12:13:00
@_author: martin 
@_subject: Unable to sign or decrypt with card 
Hash: SHA512
Hi Philip,
A few weeks ago I experienced a very similar problem to what you
describe. I was not able to sign any of my mail with my smart card and I
was unable to decrypt files.
Output of my gpg --card-status showed the same:
Key attributes ...: 0R 0R 0R
sec   rsa4096/0x7BDDCD7C31F200DC  created: 2015-11-24  expires:..
I have the exact same card reader at home and when running the status
command I would get:
Key attributes ...: rsa4096 rsa4096 rsa4096
sec>  rsa4096/0x7BDDCD7C31F200DC  created: 2015-11-24  expires: 2017-11-23
                                  card-no: 0005 0000426B
So I just re-checked my card reader at work. As I use the Gemalto PC
Twin Reader it turned out that the connection between the USB cable and
the card reader was slightly loose. Afterwards I was able to use my card
as before.
I would suggest (if you haven't tried that already). To try a different
machine and/or a different reader combos and see if the problem is not a
trivial faulty reader.
