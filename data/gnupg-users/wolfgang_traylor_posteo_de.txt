
@_date: 2019-02-09 11:20:39
@_author: Wolfgang Traylor 
@_subject: Upload key to WKD from command line? 
Hello GnuPG community,
Is there a way to upload my public key to the Web Key Directory (WKD) of my email provider using command-line tools?
I am looking for a simple solution just like `gpg --send-keys`, but for WKD.
My providers are Posteo, mailbox.org, and Protonmail.
(Enigmail shows the ?Upload to Web Key Directory? only in gray. I don?t know why.)
Best regards,
W. Traylor

@_date: 2019-02-14 09:53:07
@_author: Wolfgang Traylor 
@_subject: Upload key to WKD from command line? 
Thank you very much for pointing to gpg-wks-client.
Werner Koch  schrieb am 14.02 19 08:01:
I receive the following error (with or without `--send`):
$ /lib/gnupg/gpg-wks-client --create  A8FC7FEC9A68B5E0EFA25E474521F618BBEA93C8 wolfgang.traylor at posteo.de
gpg-wks-client: submitting request to 'keys at posteo.de'
gpg-wks-client: no confirmation required for 'wolfgang.traylor at posteo.de'
gpg-wks-client: Warning: policy requires 'mailbox-only' - adding user id 'wolfgang.traylor at posteo.de'
gpg-wks-client: gpg: key "A8FC7FEC9A68B5E0EFA25E474521F618BBEA93C8" not found: No secret key
gpg-wks-client: error running '/usr/bin/gpg': exit status 2
gpg-wks-client: adding user id failed: General error
gpg-wks-client: creating request failed: General error
I have my secret subkeys on a smartcard (unlocked when issuing the command). Could that be the issue?
Or do I even need my secret primary key?
My GnuPG version: 2.2.13

@_date: 2019-02-14 21:32:05
@_author: Wolfgang Traylor 
@_subject: Upload key to WKD from command line? 
Thank you very much. That answered all my questions.
Werner Koch  schrieb am 14.02 19 21:05:

@_date: 2019-06-01 10:28:06
@_author: Wolfgang Traylor 
@_subject: missing root certificate, SMIME spanish government 
Hello Uwe Brauer,
I usually put the fingerprint of the root certificate in ~/.gnupg/trustlist.txt like this:
# CN=COMODO RSA Certification Authority
# O=COMODO CA Limited
# L=Salford
# ST=Greater Manchester
# C=GB
# Checked fingerprint here: AF:E5:D2:44:A8:D1:19:42:30:FF:47:9F:E2:F8:97:BB:CD:7A:8C:B4 S relax

@_date: 2019-06-01 12:55:54
@_author: Wolfgang Traylor 
@_subject: missing root certificate, SMIME spanish government 
This command will show you the details of the certificates from the website[1]
you mentioned including its fingerprint:
openssl x509 -noout -text -fingerprint -inform DER -in downloaded_key_file.cer
Or you import the key with `gpgsm --import file.cer` and look in the list of
`gpgsm --list-keys`.
[1]

@_date: 2019-06-22 09:41:46
@_author: Wolfgang Traylor 
@_subject: GPG/YubiKey/CentOS7 
Hello Jen,
After moving your secret subkeys to a smartcard, the secret subkeys are not on your hard drive anymore. The secret parts are only on the smartcard then. And for security reasons you cannot export secret keys from your smartcard. The files of your secret keys you find in `~/.gnupg/private-keys-v1.d/` on your hard drive are only ?stubs?.
The smartcard only stores the secret parts of your subkeys, not the public parts.
In order to use your GPG subkey (which has authentication function) for SSH, you can use `gpg --export-ssh-key ` command. This will give you the public part your authentication key in SSH format. For this command you only need the public key in your keyring. The export has nothing to do with your smartcard.
I attached a little tutorial I once wrote for using GnuPG for SSH authentication. It worked for me on Arch Linux, Manjaro, and Linux Mint, but should apply to CentOS, too.
Best regards,
W. Traylor

@_date: 2019-03-16 10:11:34
@_author: Wolfgang Traylor 
@_subject: Identifying one of multiple authentication subkeys 
You can export your GPG subkey for SSH and compare with the `ssh-add -L` output:
$ gpg2 --export-ssh-key This gives you the SSH-formatted subkey which will match one of your lines from `ssh-add -L`.
Note that the comments (anything after the first whitespace in each line) might be different. So compare only up to the first whitespace.
Best regards,
W. Traylor
