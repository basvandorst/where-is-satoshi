
@_date: 2017-08-05 13:23:01
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Backup-Option of 'card-edit->generate' not working as intended? 
I really tried allot now and after fully reading this discussion
 and after getting a
confirmation and a suggestion what is probably going wrong of a user, I
hope you may can help me and maybe fix the problem.
*What I want to do*
Create a key for a gnupg smartcard and having a backup of the whole
keypair for the case that the stick got broken or just to copy the keys
to another stick. To keep it simple, I tried the generation option of
gpg, that intends to create the keypair and inserting it to the card or
respectively create the keys on card. This have also a backup-option.
*What I tried*
- inserting new/reseted keycard
- 'gpg --card-edit' -> 'admin' -> 'generate'
- I will be asked, if I would like to have an backup generated. Oh yes,
that would be great!
- After completion I am told that the backup is in .gnupg/sk_xxxxx.gpg
- This backup can be imported to a keyring, but neither asked for a
passphrase nor contains a valid private key.
- The very same seems to be done by Enigmails function to generate keys
on smartcards
- It is basically what is shown here
*What seems to happen*
- The 'backup' probably only contains one of the three key generated in
the process and therefore cannot fully restore the keys of the card
- Furthermore the secret key seems to be not included or cannot be imported
*What I would wish/expect from the creation with backup*
I would have thought that the backup file contains everything needed to
restore the key otherwise secured in the card, even the passphrase
protected privkey. So either the term "backup" is misleading or
something goes wrong in the process.
Do you have any idea what I may doing wrong or what we can do about it?
I am fully aware, that I can first create a keypair with subkey and then
import them into the card. It would just be great if there would be an
easier option for users as this option is far more complex.
I am using gpg 2.1.21.
Thank you in advance for your help! Please tell me if I anything of my
explanation is unclear.
Kind regards

@_date: 2017-08-11 18:51:29
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Cache Timeout not working correctly 
I try to get the max-cache-ttl-ssh in the gpg-agent.conf working, but
the cache is still saved until physically disconnecting the gnupg smartcard.
I have a working ~/.gnupg/gpg-agent.conf with following content:
default-cache-ttl 1
max-cache-ttl 1
default-cache-ttl-ssh 1
max-cache-ttl-ssh 1
I know that configuration file is loaded correctly as I can for example
change the used pinentry program with 'pinentry-program
Furthermore I tried to disable the card after some time over
~/.gnupg/scdaemon.conf as a workaround with 'card-timeout 5', but no
luck either.
Do you have any idea what could produce this symptons? Is there some
other service/program which is caching?
This is gpg (GnuPG) 2.1.22.
Kind regards

@_date: 2017-08-21 17:12:53
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Powering down smartcard does not work 
I try to power down my gnupg smartcard after some time by adding
'card-timeout 15' to ~/.gnupg/scdaemon.conf but the card seems to stay
powered as the PIN stays cached.
Do you have any idea why the config is not working correctly?
Kind regards

@_date: 2017-12-14 14:36:38
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Conditions for changing admin PIN not clarified (GNUK) 
Hello everyone,
we realized (because of the question of a user), that there are
conditions in which GnuPG is not questioning to short PIN for admin.
This seems to be specific for Gnuk devices, as I could not reproduce on
OpenPGP Card 2.1
This is what happened:
* factory-reset of device (NK Start with Gnuk 1.2.6, maybe other
versions are affected as well)
* 'gpg --card-edit' -> admin -> passwd -> 3 -> '12345678' to 'newpin'
* "PIN changed." message stated that everything is fine, although admin
needs 8 character
* neither '12345678' nor 'newpin' is accepted afterwards
This is on GnuPG 2.2.3 on Arch Linux (which should not matter).
What shall I do, file a bug? Is this a bug in GnuPG or Gnuk? This seems
to be related to the admin-less mode, although changing admin PIN first
shouldn't trigger this, does it?
Kind regards

@_date: 2017-10-09 09:07:52
@_author: Alexander Paetzelt | Nitrokey 
@_subject: libpampoldi 
as far as I know poldi did not get updates for a long time. It is either
abandoned or considered "finished". Well, there probably isn't changing
a lot in this topic anyway.
Which OS do you use? It is available for Debian-like Distros and Arch
Linux for sure. I did not looked for other Distros yet.
Kind regards

@_date: 2017-10-09 15:04:48
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Available Key Attributes Options 
I already asked a similar question but wasn't so clear what I really
need, so I give it a new try.
With these kind of commands
$ gpg-connect-agent "SCD SETATTR KEY-ATTR --force 1 22 ed25519" /bye
$ gpg-connect-agent "SCD SETATTR KEY-ATTR --force 2 18 cv25519" /bye
$ gpg-connect-agent "SCD SETATTR KEY-ATTR --force 2 18 nistp256" /bye
I can manipulate the key attributes. But I am wondering where I can find
out what options I have for the last to paramters.
So when do I have to use the '22' and in which case a '18'? Does it say
something about the used key-method? And what different options are
there for ECC-keys? Is there an extensive list? How is for example
brainpool called and which number do I have to use?
I hope you can help me to make an more or less extensive list. Maybe one
can even extent this  afterwards?
Kind regards

@_date: 2017-09-04 19:02:13
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Do not cache smart card PIN 
Hello Justin,
this is not possible right now.
I did a similar feature request here Maybe you have something to add.
Kind regards

@_date: 2017-09-29 15:29:16
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Information on scdaemon protocol commands 
I was happy to see, that there is a documentation for the SETATTR
command for invoking commands to scdaemon directly by using
gpg-connect-agent on
but realized that it is to be written :)
Is there any other way to find out the options other than reading source
code? I didn't find anything yet...
Kind regards

@_date: 2017-09-29 16:04:31
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Information on scdaemon protocol commands 
============================== START ==============================
Thanks a lot!
But what if I want to know more about 'key-attr' for example?
I tried
scd help setattr key-attr
help key-attr
scd help key-attr
and alike...

@_date: 2018-07-16 14:22:50
@_author: Alexander Paetzelt | Nitrokey 
@_subject: Forwarding both gpg and ssh agents 
as far as I know this is independently of GnuPG and just depends on the
configuration of the SSH client. Maybe have a search for "Stepping
Stone" configuration or alike. This should use your local keys.
For Example (based on something I used in the past):
Host thirdMachine-alias
or alike... As I said, this is not GnuPG specific, but a SSH thing.
Kind regards

@_date: 2018-05-03 11:42:27
@_author: Alexander Paetzelt | Nitrokey 
@_subject: use gpg-agent for ssh login 
did you install gnupg2 as well? OpenPGP Card 3.3 is not supported by
oldoldold version 1.4 ... I don't know if gnupg2 is installed by default
on Kubuntu and I don't know if gnupg2 is recent enough on 16.04 either.
You may install the stable debian ones if needed. They should be able to
work with the card.
Kind regards

@_date: 2019-01-02 11:32:11
@_author: Alexander Paetzelt | Nitrokey 
@_subject: OpenPGP card: how to lock the card again so that PIN is required 
for key slots 1 and 2 there probably is no way to do this other than
unplugging und replugging the device. See also the discussion here [1].
Kind regards
