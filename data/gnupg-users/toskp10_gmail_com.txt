
@_date: 2011-12-01 13:02:22
@_author: Thomas Martin 
@_subject: Gnupg file formats 
Hello all,
I'm interested in learning more about how cryptography is applied, and
I'm trying to understand the file formats used by Gnupg. The RFC4880
has been a great help. In looking at an private key I can find the
MPI's for the public and private parameters. In looking at a
ciphertext, I can find the Key ID and the RSA encrypted symmetric key.
What I'm struggling with is the first few characters of the files. Why
does a 1024 RSA private key start with the three bytes \x9501D8? Why
does a 2048 bit key start with the four bytes \x99010D04? Why does a
ciphertext encrypted with a 1024 bit RSA key start \x848C03? Why is it
\x85010C03 for 2048 bit RSA? Is this explained in the RFC somewhere
I've missed or is it documented elsewhere?
Any help would be appreciated.

@_date: 2012-02-09 22:55:18
@_author: Thomas Martin 
@_subject: Gnupg compression 
Hello all,
I've been playing around with encrypted files, trying to decrypt them
independently. I've used Maple to decrypt the RSA, and openssl to
decrypt the AES, sha1sum to verify the hashes, but I'm having problems
with the compressed files. I (perhaps naively) thought that once I'd
undone the encryption, it would be possible to extract just the
compressed data and use a decompression command to retrieve the
original file. I know Gnupg uses zlib by default, but I used
"--personal-compress-preferences zip" to use zip instead, and tried 7z
to decompress. Not only did it not work, but trying to compress the
original file with 7z came up with a very different file (different
size as well as content). Even when I used no compression and
encrypted a 1k all-zero file, the decrypted file only had 990 zero
bytes. With the redundant 16 bits in the CFB mode, and the hash
digests, I know I'm doing most things right. Can anyone help with
these final steps? Do there exist commands (Windows or Linux) that
will compress/decompress a file in the exact same manner as Gnupg, for
any or all three compression algorithms?
