
@_date: 2005-04-18 17:46:03
@_author: Joerg Schmitz-Linneweber 
@_subject: OpenPGP smartcard and crpyto fs 
Hash: SHA1
Hi all!
I would like to use my O.card to securely hold an encryption key to be used by the Linux "crypto filesystem". This fs uses an utiulity "losetup" at startup which asks for a passphrase/keyword to be used as encryption/decryption key.
losetup can be configured to use a file descriptor to read this info from a OK. Next thing is: I don't want to let the card do all the encryption ;-)
(I think it would be a little bit slow... although the key would stay savely inside the card...)
Next thing (which works here), was to use a gpg encrypted file containing the passphrase(es) and doing something like
"cat ~/.crypto-fs-key.gpg|gpg -q --decrypt -r 0xdeadbeef 2>/dev/null"
but one problem was gpg spitting out these "Please insert...." and "PIN" info on stdout, and I'm not very comfortable with my passwords lying around on the disks... (altough they *are* encrypted).
What I would like would be to pull out some secret key (or plain data) and handle it over to losetup directly. I know that then the key can no longer be viewed as secure as it leaves the card, but that would be ok for me.
Anyone who thought about a scenario like this?
TIA. Salut, J?rg

@_date: 2005-08-25 16:19:29
@_author: Joerg Schmitz-Linneweber 
@_subject: Pinpad on SPR532 isn't used 
Am Mittwoch, 24. August 2005 15:17 schrieb Felix E. Klee:
If you browse through the archives of this group you'll find that there *is* no keypad support for _any_ card reader (until now).
The documentation also always states that it *would be possible* to integrate support for pinpads...
Salut, J?rg

@_date: 2005-10-05 20:10:32
@_author: Joerg Schmitz-Linneweber 
@_subject: gpg-agent PIN cache 
Hi Werner, hi all!
I've a problem with "PIN keeping" in gpg-agent (version numbers below).
Everythings works fine: I start up gpg-agent:
# eval `gpg-agent -v --enable-ssh-support --daemon \ --log-file /home/jsl/ga.log --debug-level expert --default-cache-ttl-ssh\ and I can see my "new" key on the card:
# ssh-add -l
1024 e5:f9:3c:fc:04:0e:b4:b4:75:98:72:cf:d5:df:96:cb cardno:000mynumber (RSA)
Now I can "ssh" to any where my pkey is registered. Good.
The first time i try to use the key, the pinentry(-qt) comes up and asks for the PIN.
But the problem is: The second time and ever on, pinentry comes up and asks for my PIN! Although I said "cache ttl for ssh should be some hours..."
Does anyone know why gpg-agent/pinentry does so?
Here is a log of two "ssh sessions":
--- snip ------------------------------------------
2005-10-05 19:51:59 gpg-agent[8885] Es wird auf Socket `/tmp/gpg-kvPjWi/S.gpg-agent' geh?rt
2005-10-05 19:51:59 gpg-agent[8885] Es wird auf Socket `/tmp/gpg-RXfxR6/S.gpg-agent.ssh' geh?rt
2005-10-05 19:52:04 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 2005-10-05 19:52:04 gpg-agent[8886] ssh request handler for request_identities (11) started
2005-10-05 19:52:04 gpg-agent[8886] no running SCdaemon - starting it
2005-10-05 19:52:04 gpg-agent[8886] DBG: first connection to SCdaemon 2005-10-05 19:52:04 gpg-agent[8886] DBG: additional connections at 2005-10-05 19:52:05 gpg-agent[8886] ssh request handler for request_identities (11) ready
2005-10-05 19:52:05 gpg-agent[8886] ssh request handler for sign_request (13) 2005-10-05 19:52:05 gpg-agent[8886] DBG: detected card with S/N
"my number" :-)
2005-10-05 19:52:05 gpg-agent[8886] starting a new PIN Entry
2005-10-05 19:52:05 gpg-agent[8886] DBG: connection to PIN entry established
2005-10-05 19:52:06 gpg-agent[8886] SIGUSR2 received - checking smartcard 2005-10-05 19:52:09 gpg-agent[8886] ssh request handler for sign_request (13) 2005-10-05 19:52:09 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 2005-10-05 19:52:45 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 2005-10-05 19:52:45 gpg-agent[8886] ssh request handler for request_identities (11) started
2005-10-05 19:52:45 gpg-agent[8886] new connection to SCdaemon established 2005-10-05 19:52:46 gpg-agent[8886] ssh request handler for request_identities (11) ready
2005-10-05 19:52:46 gpg-agent[8886] ssh request handler for sign_request (13) 2005-10-05 19:52:46 gpg-agent[8886] DBG: detected card with S/N "again my number" :-)
2005-10-05 19:52:46 gpg-agent[8886] starting a new PIN Entry
2005-10-05 19:52:47 gpg-agent[8886] DBG: connection to PIN entry established
2005-10-05 19:52:50 gpg-agent[8886] ssh request handler for sign_request (13) 2005-10-05 19:52:51 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 2005-10-05 20:02:15 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 2005-10-05 20:02:15 gpg-agent[8886] ssh request 1 is not supported
2005-10-05 20:02:15 gpg-agent[8886] ssh request handler for request_identities (11) started
2005-10-05 20:02:15 gpg-agent[8886] new connection to SCdaemon established 2005-10-05 20:02:16 gpg-agent[8886] ssh request handler for request_identities (11) ready
2005-10-05 20:02:16 gpg-agent[8886] SSH Handhabungsroutine 0x8083b88 f?r fd 0 --- snip ------------------------------------------
Here are the versions used...
# gpg2 --version
gpg (GnuPG) 1.9.19
# scdaemon --version
scdaemon (GnuPG) 1.9.19
# gpg-agent --version
gpg-agent (GnuPG) 1.9.19
# pinentry --version
pinentry-qt (pinentry) 0.7.3-cvs
# libgcrypt-config --version
# libassuan-config --version
# pth-config --version
GNU Pth 2.0.5 (05-Oct-2005)
# ksba-config --version
# gpg-error-config --version
Did I miss something? ;-)
Thank you very much in advance! Salut, J?rg

@_date: 2005-09-02 16:14:01
@_author: Joerg Schmitz-Linneweber 
@_subject: OpenPGP Card 
Hi Alon!
I would like to see support for PKCS too but...
(won't elaborate on this now ;-)
Regarding the "open-ness" of OpenGPG: Why do you (and Benjamin) think its not open (enough)?
The specs are there and you are free to implement "both sides" of the (smart) For me the specs allow(ed) it to try implementing OpenGPG on a IBM JavaCard (and it *would* be possible to have a JavaCard implement OpenGPG in parallel to PKCS
Just my 2cts... Salut, J?rg

@_date: 2006-12-05 11:55:25
@_author: Joerg Schmitz-Linneweber 
@_subject: sshd authentication problem with gpg-agent and OpenPGP card 
Hash: SHA1
Hi all!
I recently found a problem when using OpenPGP cards with gpg-agent in
combination with ssh/sshd.
Technical details follows:

@_date: 2006-12-29 13:29:10
@_author: Joerg Schmitz-Linneweber 
@_subject: USB vs Smart Card? 
Hash: SHA1
Moritz Schulte schrieb:
Perhaps the OP meant some USB crypto token... (eg. "Aladin eToken Pro")
There are such crypto tokens but most of them use something X.509
compatible (certificate based, PKCS
If I remember correctly there exists a very small USB smartcard reader
which can be "paired" with a small form factor smartcard (like the "GSM"
ones) into one enclosure. If you take a cutter and reduce the size of a
OpenPGP card to the mentioned size and find this particular reader *and*
this reader is supported by Gnupg... then you're done! :-)
Interessting link:
Salut, J?rg

@_date: 2006-02-17 15:18:07
@_author: Joerg Schmitz-Linneweber 
@_subject: new version of gnupg signed with different key? 
Am Donnerstag, 16. Februar 2006 22:11 schrieb privacy.at Anonymous Remailer:
Werner? What happend? I saw it's tagged as a "(dist sig) " but why did you changed your policy? [Are you on ham radio btw. :-) ?]
I did a short review on the diff from 1.4.2 and it seems there are only the changes regarding the mentioned vuln. and I think Werner (et.al) switched from CVS to Subversion.... :-) Right?
Salut, Joerg

@_date: 2006-03-13 09:25:44
@_author: Joerg Schmitz-Linneweber 
@_subject: gpg-agent cache 
Hi Remco!
Am Mittwoch, 8. M?rz 2006 19:47 schrieb Remco Post:
From your mail it's not quite clear if you used the output from gpg-agent (the environment vars)...
I would have guessed something like:
eval "$(gpg-agent --gpg-agent-options)"
And then start your gpg-agent-using-applications in the same shell afterwards.
HTH. Salut, J?rg

@_date: 2006-05-12 09:13:36
@_author: Joerg Schmitz-Linneweber 
@_subject: smart card usage on multiple workstations 
Hi Kai!
Am Dienstag, 9. Mai 2006 07:54 schrieb Kai Kretschmann:
According to Werner the missing "stubs" for the private keys (which are on the card), should be generated by gpg "on-the-fly" if you issue a command like --card-status or the like...
(Please have a look in the mail-archive with keywords "opengpg card")
But here this _never_ happend with all of our cards and all version of gpg! :-( The stubs were only generated in the "key issuing" gpg installation.
Our only chance to move the stubs to other/new workstations was to manually export the (priv.) keys/stubs or move the keyrings.
HTH. Salut, J?rg

@_date: 2006-09-12 10:25:34
@_author: Joerg Schmitz-Linneweber 
@_subject: Beginner's smartcard questions 
Am Mittwoch, 6. September 2006 19:11 schrieb Sven Radde:
Probably not. :-(
Sure not! Esp. the "CyberJack" is known to be problematic (at least) with OpenGPG cards...
I think most of them will work under Win, You'll have to look for drivers for your special application...
With GnuPG nothing. (But I think the difference between class 2 and 3 is not only the display but here in Germany the "clearance" to do "binay cashing" via e.g. GeldKarte and the like...)
Not with GnuPG. With *some* HomeBanking applications, your PIN will never reach "the system" (Win) and thus will be save.
Salut, J?rg

@_date: 2008-01-17 11:01:07
@_author: =?utf-8?q?J=C3=B6rg_Schmitz-Linneweber?= 
@_subject: Problem getting smartcard reader working !!! 
Hello Allan,
Am Sonntag, 13. Januar 2008 12:46 schrieb A C:
Your card reader and your config are fine.
This error message says it all! :-)
Your Gemalto card is lacking the OpenPGP (card) application.
The only known card which supports the OpenPGP card application is the OpenPGP card and the FSEcard...
[  ]
[  ]
You'll need such a card if you intend to use gpg whith smartcards.
HTH. Salut, J?rg

@_date: 2016-05-02 17:13:16
@_author: =?UTF-8?Q?J=C3=B6rg_Schmitz-Linneweber?= 
@_subject: gpg and smartcard on ubuntu 16.04 
Am 2016-04-27 23:02, schrieb Richard Ulrich:
A colleague had the same problems (at the same day... :) and after some time we found that in the process of the update to 16.04, Ubuntu/apt-get decided to de-install the package "scdaemon"!
So as the scdaemon is mandatory for gnupg card usage and ssh auth access, he re-installed it and afterwards he was back to business.
But keep in mind: He had a working ssh/gpg/smart card setup *before* starting the update to 16.04
and this setup was also not quite intuitive either. :-)
Salut, Joerg

@_date: 2018-10-29 14:25:57
@_author: =?UTF-8?Q?J=c3=b6rg_Schmitz-Linneweber?= 
@_subject: PGP Authentication with gpg4win+ssh 
Hi Chris!
Am 2018-10-27 06:03, schrieb Chris Horry:
I don't know exactly about getting the original gpg-agent to run on Windows.
But I know for sure that it works with a GnuPG card under Windows if you
use the
SmartCard-Auth [  ]
But beware that you need to register (and pay a small amount) with the
Salut, Joerg
