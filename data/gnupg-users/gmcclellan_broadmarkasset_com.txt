
@_date: 2011-02-02 15:29:49
@_author: griffmcc 
@_subject: =?UTF-8?Q?Crontab_running_gpg_script_can=E2=80=99t_find_secret_key?= 
Although I can encrypt a file using a script, when crontab runs the same
script, it returns the error message ?no default secret key: No secret key?.
I have one secret key:
sananselmo backupscripts.d # gpg --list-secret-keys
sec   2048R/AC1E8E28 2011-01-11
uid                  Griff McClellan (Broadmark Asset Management) ssb   2048R/81E9591C 2011-01-11
Here is my script:
gpg -vvv --batch --output /usr/share/tararchive/file.gpg --encrypt ?sign
When I run it I am prompted for a password, even though I have the batch
flag.  However the file.gpg encrypted file is created.
When I run the same script as root using crontab, I get:
gpg: no default secret key: No secret key
Does anyone have any suggestions about how to fix this problem?  I tried
setting the default-flag in gpg.conf but that didn?t change the outcome.

@_date: 2011-02-03 11:08:34
@_author: griffmcc 
@_subject: =?UTF-8?Q?Re:_Crontab_running_gpg_script_can=E2=80=99t_find_secret_key?= 
The user running the cron job is root and the owner of the key is root.
I know this because I added
whoami > whoami.txt
to the script and the contents of the file were "root".

@_date: 2011-02-03 12:45:47
@_author: griffmcc 
@_subject: =?UTF-8?Q?Solution:_Crontab_running_gpg?= 
Here's what works for me:
echo 'password' | gpg -vvv --homedir /root/.gnupg --batch --passphrase-fd 0
--output /usr/share/file.gpg --encrypt --sign /usr/share/file.tar.bz2
