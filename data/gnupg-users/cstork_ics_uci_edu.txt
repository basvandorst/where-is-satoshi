
@_date: 2005-09-26 10:34:23
@_author: Christian Stork 
@_subject: Incompatibility between GnuPG 1.2 and 1.4? 
A friend of mine uses Enigmail to encrypt his mail on a SuSE 9.x box
with gpg 1.2.1 installed.
Since I upgraded my Debian box to use gpg 1.4.1 I can't decrypt his
mails anymore:
    $gpg-1.4.1 mal1.asc
    You need a passphrase to unlock the secret key for
    user: "Christian H. Stork (University) "
    3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02 (main key ID 50F9CA2F)
    gpg: encrypted with 2048-bit ELG-E key, ID 4A12AF6D, created 2001-12-14
          "Marc-Andre Lemburg "
    gpg: encrypted with 3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02
          "Christian H. Stork (University) "
    gpg: uncompressing failed: unknown compress algorithm
    gpg: WARNING: message was not integrity protected
But it works with gpg 1.2:
    $gpg-1.2.4 mal1.asc     You need a passphrase to unlock the secret key for
    user: "Christian H. Stork (University) "
    3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02 (main key ID 50F9CA2F)
    gpg: encrypted with 2048-bit ELG-E key, ID 4A12AF6D, created 2001-12-14
          "Marc-Andre Lemburg "
    gpg: encrypted with 3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02
          "Christian H. Stork (University) "
    gpg: old style (PGP 2.x) signature
    gpg: Signature made Mon Sep 19 12:28:25 2005 PDT using DSA key ID 6A6DDB60
    gpg: Good signature from "Marc-Andre Lemburg "
    gpg:                 aka "Marc-Andre Lemburg "
    gpg: WARNING: message was not integrity protected
Here's part of his gpg.conf:
Do I need to invoke gpg 1.4 with special options (I tried several
combinations without success)?
I'd be happy to provide more details if that is needed.
Thanks for your time,

@_date: 2005-09-30 10:56:52
@_author: Christian Stork 
@_subject: Incompatibility between GnuPG 1.2 and 1.4? 
The --version output of the encrypting GnuPG (my oringinal 1.2.1 claim was
    gpg (GnuPG) 1.2.5
    Copyright (C) 2004 Free Software Foundation, Inc.
    This program comes with ABSOLUTELY NO WARRANTY.
    This is free software, and you are welcome to redistribute it
    under certain conditions. See the file COPYING for details.
    Home: ~/.gnupg
    Supported algorithms:
    Pubkey: RSA, RSA-E, RSA-S, ELG-E, DSA, ELG
    Cipher: 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH
    Hash: MD5, SHA1, RIPEMD160, SHA256
    Compression: Uncompressed, ZIP, ZLIB, BZIP2
And I updated my decrypting gpg to 1.4.2 in the meantime:
    gpg (GnuPG) 1.4.2
    Copyright (C) 2005 Free Software Foundation, Inc.
    This program comes with ABSOLUTELY NO WARRANTY.
    This is free software, and you are welcome to redistribute it
    under certain conditions. See the file COPYING for details.
    Home: ~/.gnupg
    Supported algorithms:
    Pubkey: RSA, RSA-E, RSA-S, ELG-E, DSA
    Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH
    Hash: MD5, SHA1, RIPEMD160, SHA256, SHA384, SHA512
    Compression: Uncompressed, ZIP, ZLIB, BZIP2
Unfortunately the problems persist.

@_date: 2005-09-30 10:56:58
@_author: Christian Stork 
@_subject: Incompatibility between GnuPG 1.2 and 1.4? 
As requested:
$ gpg-1.4.2 -vv mail.asc
gpg: armor: BEGIN PGP MESSAGE
gpg: armor header: Version: GnuPG v1.2.5 (GNU/Linux)
:pubkey enc packet: version 3, algo 16, keyid 4AA7E00CB0BE33B2
        data: [3070 bits]
        data: [3071 bits]
gpg: public key is B0BE33B2
gpg: using subkey B0BE33B2 instead of primary key 50F9CA2F
You need a passphrase to unlock the secret key for
user: "Christian H. Stork (University) "
gpg: using subkey B0BE33B2 instead of primary key 50F9CA2F
3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02 (main key ID 50F9CA2F)
gpg: public key encrypted data: good DEK
:pubkey enc packet: version 3, algo 16, keyid 110C58544A12AF6D
        data: [2048 bits]
        data: [2046 bits]
gpg: public key is 4A12AF6D
:encrypted data packet:
        length: unknown
gpg: using subkey 4A12AF6D instead of primary key 6A6DDB60
gpg: encrypted with 2048-bit ELG-E key, ID 4A12AF6D, created 2001-12-14
      "Marc-Andre Lemburg "
gpg: encrypted with 3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02
      "Christian H. Stork (University) "
gpg: CAST5 encrypted data
:compressed packet: algo=121
gpg: uncompressing failed: unknown compress algorithm
gpg: decryption okay
gpg: WARNING: message was not integrity protected
So, what's algo 121 ?

@_date: 2005-09-30 16:39:27
@_author: Christian Stork 
@_subject: Incompatibility between GnuPG 1.2 and 1.4? 
But it this happens to all the messages I get from him (by now 6 or so)
and why then does gpg 1.2 decrypt the same message without problems.  I
have gpg 1.2.4 installed on my Mac and it produces the following output
on the _identical_ message:
$ gpg-1.2.4 mal1.asc
gpg: armor: BEGIN PGP MESSAGE
gpg: armor header: Version: GnuPG v1.2.5 (GNU/Linux)
:pubkey enc packet: version 3, algo 16, keyid 4AA7E00CB0BE33B2
        data: [3070 bits]
        data: [3071 bits]
gpg: public key is B0BE33B2
gpg: using secondary key B0BE33B2 instead of primary key 50F9CA2F
You need a passphrase to unlock the secret key for
user: "Christian H. Stork (University) "
gpg: using secondary key B0BE33B2 instead of primary key 50F9CA2F
3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02 (main key ID 50F9CA2F)
gpg: public key encrypted data: good DEK
:pubkey enc packet: version 3, algo 16, keyid 110C58544A12AF6D
        data: [2048 bits]
        data: [2046 bits]
gpg: public key is 4A12AF6D
:encrypted data packet:
        length: unknown
gpg: using secondary key 4A12AF6D instead of primary key 6A6DDB60
gpg: encrypted with 2048-bit ELG-E key, ID 4A12AF6D, created 2001-12-14
      "Marc-Andre Lemburg "
gpg: encrypted with 3072-bit ELG-E key, ID B0BE33B2, created 1999-10-02
      "Christian H. Stork (University) "
gpg: CAST5 encrypted data
:compressed packet: algo=1
:literal data packet:
        mode b, created 1127158105, name="",
        raw data: 0 bytes
gpg: original file name=''
:signature packet: algo 17, keyid F37A79CD6A6DDB60
        version 3, created 1127158105, md5len 5, sigclass 00
        digest algo 2, begin of digest 4f 9d
        data: [158 bits]
        data: [160 bits]
gpg: old style (PGP 2.x) signature
gpg: Signature made Mon Sep 19 12:28:25 2005 PDT using DSA key ID 6A6DDB60
gpg: Good signature from "Marc-Andre Lemburg "
gpg:                 aka "Marc-Andre Lemburg "
gpg: key 50F9CA2F: accepted as trusted key
gpg: key C3D4D9D4: accepted as trusted key
gpg: key DC8492FA: accepted as trusted key
gpg: key 61F2C6B1: accepted as trusted key
gpg: key EAB24878: accepted as trusted key
gpg: key C9A2607F: accepted as trusted key
gpg: key 6D2033CA: accepted as trusted key
gpg: key 65EB1001: accepted as trusted key
gpg: binary signature, digest algorithm SHA1
gpg: decryption okay
gpg: WARNING: message was not integrity protected
So in contrast to gpg 1.4 this gpg 1.2.4 identifies the compression algo
as 1 and decrypts just fine.  Could there still be an integrity problem
as the warning at the end suggests?
