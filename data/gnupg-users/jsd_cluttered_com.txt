
@_date: 2007-02-26 16:36:37
@_author: Jon Drukman 
@_subject: Newbie Q: decryption 
A company I'm getting a data feed from sent me a public key and an encrypted file.  I want to decrypt it, but I don't know I'm doing.  My naive approach is not working:
$ gpg --homedir=/var/httpd/keyring --decrypt upc.xml.pgp
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: mpi too large for this implementation (40856 bits)
the public key is in the file "nf_key".  i thought i imported it but i don't how to tell if i did it right, or if it's even the right key for the file.

@_date: 2011-05-04 23:01:44
@_author: Jon Drukman 
@_subject: scripting gpg 
I need to do the following:
- when a new machine is created, automatically import a public key and give it
full trust
- be able to encrypt files with that public key without any interactive
prompting (from a shell script/cron job)
in other words, a machine has to go from virgin state (OS + software only) to
being able to encrypt and transmit encrypted files without any prompting or
other user interaction.
I know about the 'trust' command but I don't see any non-interactive way to
achieve that.  Alternatively, if the gpg binary would stop giving me the "It is
NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes." prompt that would be fine too.
Are there some hidden command line options/environment variables I am missing?

@_date: 2011-05-05 00:19:00
@_author: Jon Drukman 
@_subject: scripting gpg 
options, and the trust model
sure that only keys that are fully
Awesome, thanks.  This works (php):
system("/usr/bin/gpg --batch --yes --import /sites/config/public_key.asc");
system("/usr/bin/gpg --batch --yes --no-ask-cert-level --trust-model always
--output $filename.gpg --encrypt --recipient $recipient $filename > /tmp/gpg.log

@_date: 2011-05-05 10:21:44
@_author: Jon Drukman 
@_subject: scripting gpg 
There are no other users on this box, it has a default-deny firewall, and
password logins are disabled.  You need to be coming from my office with the
correct ssh key.
In my testing it seems like if you import the same key over and over again,
nothing bad happens.  gpg just ignores it:
% gpg --import /sites/config/public_key.asc
gpg: key 43B4963D: "[redacted]" not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
% gpg --import /sites/config/public_key.asc
gpg: key 43B4963D: "[redacted]" not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
% gpg --list-keys
pub   1024D/43B4963D 2002-04-10
uid                  [redacted]
sub   1024g/861E4AE2 2002-04-10
Thanks for double checking my work!  Always good to get an extra pair of
eyes on things.
