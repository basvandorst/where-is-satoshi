
@_date: 2003-06-03 23:30:02
@_author: Ping Kam 
@_subject: Problem with passphrase 
I am trying to write a cmd file to automate the process.  What I try to do
is create a window interface which creates a cmd file in the background and
execute the cmd with ShellExecute.
I run the cmd file in the command prompt, I got the following message:
Reading passphrase from file descriptor 0 ...
You need a passphrase to unlock the secret key for
user: "QSI2NSCS (QSI to NSCS user account)"
1024-bit DSA key, ID CB031107, created 2002-05-14
gpg: skipped `QSI2NSCS': bad passphrase
gpg: C:\TEST\test1.txt: sign+encrypt failed: bad passphrase
It does not matter whether the passphrase is valid or not.
So I take out the passphrase out from the cmd file.  Now GPG prompt me for
the passphrase.  The following screen capture show the whole process:
You need a passphrase to unlock the secret key for
user: "QSI2NSCS (QSI to NSCS user account)"
1024-bit DSA key, ID CB031107, created 2002-05-14
Could not find a valid trust path to the key.  Let's see whether we
can assign some missing owner trust values.
No path leading to one of our keys found.
1024g/87BED04F 2002-05-07 "nscsuser (nscsuser key) "
             Fingerprint: E416 C940 0FB7 CC06 2F8F  44FE 055F AFED 87BE D04F
It is NOT certain that the key belongs to its owner.
If you *really* know what you are doing, you may answer
the next question with yes
Use this key anyway? y
Now the output file is created.  What can I do to use suppress these
messages and put the passphrase into the cmd file.
Another question, how can we save the message into a log file so we can
troubleshoot it when there is an error?
Ping Kam

@_date: 2003-06-04 02:49:02
@_author: Ping Kam 
@_subject: Problem with passphrase 
Sorry, I am new to GPG so bear with me if this is a very simple task.
How to do them?  Any link to any reference so I can learn?
Ping Kam
----- Original Message -----
Sent: Tuesday, June 03, 2003 5:45 PM
put the passphrase into a script you might as well not have one

@_date: 2003-06-05 01:24:02
@_author: Ping Kam 
@_subject: Newbie question - how to include the passphrase in the command 
I use the gen-key command to create a key, and then I import a key that is
export by our client.
This is the command I use to encrypt a file to our client :
gpg -o OutputFilename -a -r MyUserID --encrypt-to
RecipientUserID --passphrase MyPassword -es SourceFile
But I always got the following message
Reading passphrase from file descriptor 0 ...
when I entered the passphrase, then it creates the file and display the
following message
You need a passphrase to unlock the secret key for
user: "QSI2NSCS (QSI to NSCS user account)"
1024-bit DSA key, ID CB031107, created 2002-05-14
If I leave out the passphrase, gpg will display the same message and prompt
me for the passphrase.
You need a passphrase to unlock the secret key for
user: "QSI2NSCS (QSI to NSCS user account)"
1024-bit DSA key, ID CB031107, created 2002-05-14
Enter passphrase:
After I enter the passphrase, then the file is created.  But this time the
passphrase I entered is not echo back to the screen.
How can I use the passphrase in the command line so it will not prompt me
for the passphrase?  I want to put this into a cmd or batch file then I can
call it from a windows application and passing the values throught the
Ping Kam

@_date: 2003-06-05 07:08:03
@_author: Ping Kam 
@_subject: Newbie question - how to include the passphrase in the command 
Hash: SHA1
I am not hard coding them into the cmd file.  They will be parameters in the
cmd file.
I am creating a Windows GUI  interface which the operator enters the userid
and password to logon, choose the files, the program then uses ShellExecute
to execute the command file and pass the parameters.
The user may choose more than one file.  I don't want the user to re-enter
the passphrase again for every file.  Does this make sense?
Can you answser now?
Ping Kam

@_date: 2003-06-05 17:32:01
@_author: Ping Kam 
@_subject: Newbie question - how to include the passphrase in the command 
I thought you meant you can't help me to do stupid thing.
Ping Kam

@_date: 2003-06-05 17:48:01
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Sent: Thursday, June 05, 2003 8:50 AM
I have two question though.
First, how to remove the pass phrase?
Can I still sign the encyption?  I don't want to remove the pass phrase and
then find out that I can't sign the file without the pass phrase and now I
can't restore the pass phrase.
I have got a script sample from a friend like this for windows
echo %1|gpg  --encrypt --output %2.asc --armour --recipient
our_own_userid --encrypt-to the_recipient_userid --passphrase-fd 0 %2
Then I can execute the cmd file like this
MyCmdFile MyPassphrase SourceFileName
What I find out that it will encrypt the file even without the pass phrase.
What I mean is the following will work
  echo |gpg  --encrypt --output %2.asc --armour --recipient
our_own_userid --encrypt-to the_recipient_userid --passphrase-fd 0 %2
then execute the cmd file without the passphrase parameter
But if I add the --sign option, in both case, then GPG will prompt me to
enter the passphrase.  If I call execute cmd file from a window apps, then
no file will be created.  Since GPG just run in the background, the user
can't see the command window to complete the encryption, and the process
will not terminated.  I can see one more instance added to the task manager
everytime I execute the cmd from a window app.
So how can I sign a file using the command line without any interaction with
I hope I make it clear.
Ping Kam

@_date: 2003-06-06 01:19:03
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Thanks to all those helping me.  Now I get some idea about how GPG works.
But I am quite confused.  I always thought that it will require the userid
and password pair to encrypt and decrypt files.  It seems like GPG only
needs the userids.  So any one knows how to use GPG, knows your userid and
the recipient's userid, and have access to your computer can encrypt and
decrypt on your computer.  It seems to me that the userid is even more
important than the pass phrase.  Right?
Ping Kam
----- Original Message -----
Sent: Thursday, June 05, 2003 12:24 PM
<> --sign --output
is for the sole use of the intended recipient(s) and may contain
confidential and privileged information.  Any unauthorized review, use,
disclosure or distribution is prohibited.  If you are not the intended
recipient, please contact the sender by reply e-mail and destroy all copies
of the original message.

@_date: 2003-06-06 01:59:01
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Sent: Thursday, June 05, 2003 12:24 PM
I change the cmd file following your suggestion and it stops working.
Before the change, I got the following message but it creates the file.:
Reading passphrase from file descriptor 0
You need a passphrase to unlock the secret key for
user: ...........
After the change:
Reading passphrase from file descriptor 0
You need a passphrase to unlock the secret key for
user: ..........
Could not find a valid trust path to the key.  Let's see whether we
can assign some missing owner trust values.
No path leading to one of our keys found.
It is NOT certain that the key belongs to its owner.
If you *really* know what you are doing, you may answer
the next question with yes
Use this key anyway?
What is the difference and why one works and the other does not?
Ping Kam

@_date: 2003-06-06 19:22:02
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Sent: Thursday, June 05, 2003 7:52 PM
This is confusing.  I want to encrypt the file for the recipient so I
encrypt-to the recipient.  I want to ensure that I can also decrypt the file
so I add myself to the list of recipients.  Why would I want to encrypt the
file to myself?
Don't know anything about this feature.  But since I am not using it now, I
don't really care.
I have tried to trust a key using the trusted-key option but I don't know
what to enter for the keyid.  I tried the 8 digit hex number from
the --list-key, the 5 digit number before it, and the two together with the
slash.  I always get the error 'xxxx is not a valid long keyID'.  And I
couldn't find any documentation or help on how to do this.  Can you tell me
how to do this, or direct me to some links that will?
I have tried them all, none of them works for me.  I get the prompt anyway.
Ping Kam

@_date: 2003-06-06 22:27:02
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Sent: Friday, June 06, 2003 12:38 PM
The problem is if I do not encrypt-to my recipient, then GPG will prompt for
the passphrase.  If I encrypt-to my recipient and add my key as recipient,
then it encrypts the file.  I haven't tested with our recipient if he can
decrypt the file.
I have yet to find out the correct syntax for the command file so it will
encrypt the file without prompting for the passphrase.  So far I am out of
I have also try to trust the keys but I am getting the 'Invalid long keyID'
error.  Any idea how to do this?  Where can I find the long KeyID?
Not until I get this working.
Ping Kam

@_date: 2003-06-09 23:14:02
@_author: Ping Kam 
@_subject: How to pipe the feedback to a file 
I am trying to automate the encrypt and decrypt process by calling a command
file from a Windows app.  I have get everything almost working.
Here is the command file:
echo %2|gpg.exe -o %5 -a --passphrase-fd 0 -r %3 --encrypt-to %1 -e -s %4
So I call it like
MyCommand My_Passphrase MyID, RecipientID, SourceFile, EncryptedFile
The first problem is that GPG will encrypt the file even if the recipient or
encrypt-to is entered wrong.  What I mean is there is no key in the keyring
for these ID.  I tested it by typing them wrong.  The file is created and
there is no error in the feedback.  Is there an option that can force a
check on the recipient or the encrypt-to?
It works fine if a wrong passphrase is entered.  The file is not created, an
error message is in the feedback in the command mode.  But I can't save the
error to a log file so when I call the command file from my windows app, all
I know is that the file is not created.  But I have no idea what went wrong.
Is there an option or command to save the error or the feedback to a file?
Ping Kam

@_date: 2003-06-10 20:46:03
@_author: Ping Kam 
@_subject: Newbie question - how to include the pass phrase in the command 
Thanks for your reply.  With help from Steve Butler via private email, I got
the recipient's key trusted and solved most of the problem.
The dump option is very interesting.  Unfortunately, there is no explanation
and example so I can't figure out how to use those options.
Ping Kam
----- Original Message -----
Sent: Monday, June 09, 2003 5:48 PM
