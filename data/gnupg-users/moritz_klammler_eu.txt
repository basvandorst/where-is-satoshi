
@_date: 2016-10-03 22:44:16
@_author: Moritz Klammler 
@_subject: What to do at failed integrity check? 
GnuPG didn't tell you that if found out that the file doesn't match the
signature.  It told you that it wasn't able to check whether it is valid
in the first place because your key-ring doesn't contain the key which
the signature says was used to create it.  Without the public key
(certificate) of the signer, you cannot verify the signature.  You can
import the certificate from a public key-server using this command.
    $ gpg --recv-key 4F25E3B6
Where "4F25E3B6" is the ID reported by the error message (and happens to
belong to Werner Koch).
Of course, when you download the certificate like so, an attacker that
has previously tampered with your internet connection, tricking you into
downloading a compromised version of GnuPG (together with a fake
signature) can potentially trick you again and you cannot be sure that
you've actually downloaded Werner Koch's certificate.  In order to
defend against this, you should check the fingerprint by running
    $ gpg --fingerprint 4F25E3B6
    pub   rsa2048 2011-01-12 [SC] [expires: 2019-12-31]
          D869 2123 C406 5DEA 5E0F  3AB5 249B 39D2 4F25 E3B6
    uid           [ unknown] Werner Koch (dist sig)
    sub   rsa2048 2011-01-12 [A] [expires: 2019-12-31]
and checking the output against a trusted source of the fingerprint.
Where you obtain this from, I don't know.  As a minimum, it should match
the fingerprint shown above but of course, that could be tampered with,
too.  (The fingerprint is the hex sequence "D869 2123 C406 5DEA 5E0F
3AB5 249B 39D2 4F25 E3B6".  The other output might differ for legitimate
Alternatively, if you're lucky, you might have participated in enough
key-signings such that GnuPG finds a chain of trust to the key.  As you
can see from the "unknown" in the output shown above, I've not been that
lucky so far.

@_date: 2016-09-11 21:17:31
@_author: Moritz Klammler 
@_subject: What happened to this signature? 
Today, I've posted a signed message (OpenPGP MIME) to a public mailing
list I'm subscribed to.  When it was delivered back to me, the signature
was broken.  I investigated the case and found out that some silly MTA
had un-escaped a minus-character in the message body (quoted-printable)
and added a blank line at the top.  This is annoying but is adequately
explained by stupidity so it didn't alarm me.  Similar things have
happened to me many times in the past.  What *did* alarm me is that a
further investigation reveled that the signature itself was changed,
This is the original, good, signature as it was created by myself.
    -----BEGIN PGP SIGNATURE-----
    iQEcBAEBCAAGBQJX1XnOAAoJEM9sUWbzk6nA7JsH/1axM1lcgsDmLUvZM51yQGmg
    4B+P9p/iFLszGY7vXh/RY+Nfs6fEtlqUPaJf4iHWtM5AewzoAItNPeK7kRJqdTs7
    7DADoMdeAE63n8trTqDeAqU1gOq+YAvIhvs1b9ocalAwcPEQllKKUsmjS3NYFbRH
    LM1nhHdwQXlIWXGWOhqJI6HxcGBO1+ebMY66MndfNQIiT9hWQtAkRT4gg/qJHT1z
    1jsSff6RCj9QKA4ohKnIxeoe7uJFdpoOlueqnpSFCYPKwp86e4f8dRvxVxhSuDU1
    EPYILSMDkt0YKwXZGCF8LWlR6PG3wiHrmPQbmNfVdAf+7ygTmdLo59OIJ6778dc=
    =KUSY
    -----END PGP SIGNATURE-----
And this is the signature as it came back to me.
    -----BEGIN PGP SIGNATURE-----
    iQEcBAEBCAAGBQJX1XnJAAoJEM9sUWbzk6nAVQ4H/110oZwIor4UFJh2+41ydfJL
    8gRG95rDxSAhydHjqS0vdFcl+eG0uQfhvc7rndkmV4fLpM1GMiNqlDZhCWsTGyXy
    d/UAS9G4whs1bwJZcRHswDmuveH3EB3V7vu77zOzC1V+dsmXjlw63AMwKRoPojwU
    Zle9CSTx4yyPO5UIGbWkbAcYybpKuQ3uv/pe/jq6V659H1fZnq9iaQXDTnPhRr8w
    /F+n0NI1a4pFGWkY1wjuzuvzcedtb2bnn4pSbbkegli8Gnw7ILk0pzDi8r4rPjDo
    a9qoHv6DXczeHq9h8R5iJ3/OKSR90l7aydckZiyZ5Syd0TJR8LCsobDaMvDDmhg=
    =bTBV
    -----END PGP SIGNATURE-----
I have run `gpg --list-packets --verbose` on both signatures and found
that the "created", the "begin of digest" and the "data" field had
changed.  I've checked out RFC 4880 and concluded that "digest algo 8"
must mean that SHA256 has been used.  I *thought* that the "begin of
digest" field should then hold the two leftmost octets of the SHA256
hash of the signed message but this wasn't true for either message.  The
hashes are
    1e382398177e8cf1a7e5c7ae470ff8f756369d1531fcbe3c15c3825e15bfa726
    ce4f76719e0fb01f344c5dae9aad83daf00bf014f4884d33cf51e797ef3d0be2
for the original and modified messages respectively.  I'm confident that
I've hashed the correct parts of the MIME message because GnuPG verifies
the signature for the original message.
I'm not panicked because the changed signature file is invalid anyway
but I'm somewhat alerted whether the modified signature can still be
explained without assuming malice.  First of all, I would like to better
understand in what ways the signature was modified and appreciate any
help in analyzing the fields.  Secondly, I would like to know whether
this is something that happens on a regular basis to other people as
well.  I cannot see any signs of a real attack here because the message
was not altered in a way that an attacker could possibly benefit from.
The only conspiracy I can come up with is that somebody might have
wanted to challenge my awareness and test my response to such incidents.
Or simply annoy OpenPGP users such that they'll eventually stop using
Thanks in advance for any insights.

@_date: 2016-09-12 17:06:23
@_author: Moritz Klammler 
@_subject: What happened to this signature? 
Thank you, I think you are right.  The "bad" signature happens to be a
valid signature of the (this time really) good message, too.  Isn't it
nice to learn new things about your MUA every day?  Quite embarrassing
though, that I didn't realize this behavior earlier.
I would still be interested to understand the meaning of the "begin of
digest" packet in a signature.  Apparently, it is not the two leftmost
bytes of the signed hash.  But what else is it then?
