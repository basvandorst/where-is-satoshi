
@_date: 2010-01-27 04:10:07
@_author: Kuifje 
@_subject: How to use password from the parameter 
I have a function from FoxPro. If you type Gpg( 'test.pgp',
'SecretPassword'), how can you make sure ShellExecute decrypt the pgp-file
with the password?
cParameters = [-d -o &sUitvoer &sInvoer ] works well but you have to give
the password in a DOS-window and it seems some users doesn't know how
because you cannot see the password.
I tried everything something like cParameters = [--&sPassWord-fd 0 -d -o
&sUitvoer &sInvoer ] but it doesn't work.
Do you know how to use the password into ShellExecute?
PROCEDURE Gpg( sInvoer, sPassWord)
IF EMPTY(sInvoer)
sUitvoer = SUBSTR(sInvoer, 1, LenTR(sInvoer) - 3) + 'zip'
DECLARE INTEGER ShellExecute ;
nHwnd = 0
cOperation = 'open'
cFileToExecute = 'gpg.exe'
*cParameters = [-d -o &sUitvoer &sInvoer ]
cParameters = [--&sPassWord-fd 0 -d -o &sUitvoer &sInvoer ]
cDirectory = 'C:\Program Files\GNU\GnuPG\'
nShowWindow = 3
nError = ShellExecute( nHwnd, ;
WAIT "Druk op ENTER nadat je het wachtwoord hebt ingevoerd"
RUN /N c:\program files\7-zip\7z.exe e &sUitvoer -o&sAangeleverdMap
