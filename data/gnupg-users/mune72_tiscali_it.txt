
@_date: 2005-07-19 15:01:43
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
I received the fsfe felloship card and I'm trying to use it.
I Installed gnupg-1.4.1, ccid-0.9.3 and pcsc-lite-1.2.9-beta7. For all them I did (as root) 'make install'. As root I launch # /usr/local/sbin/pcscd # ./gpg --card-status works but still as *root*. My user is the group scard but as long as only the root user can have
access to the smart card it remains useless. I think it is a trivial
permission issue: any help?
A workaround would be telling evolution to use sudo gpg instead of gpg,
but there isn't a way to do that.

@_date: 2005-07-19 15:30:46
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
I received the fsfe felloship card and I'm trying to use it.
I Installed gnupg-1.4.1, ccid-0.9.3 and pcsc-lite-1.2.9-beta7. For all them I did (as root) 'make install'. As root I launch # /usr/local/sbin/pcscd # ./gpg --card-status works but still as *root*. My user is the group scard but as long as only the root user can have
access to the smart card it remains useless. I think it is a trivial
permission issue: any help?
A workaround would be telling evolution to use sudo gpg instead of gpg,
but there isn't a way to do that.

@_date: 2005-07-20 13:08:42
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
Il mer, 2005-07-20 alle 10:59, Werner Koch ha scritto:
as mune user
[mune mune]$ /usr/local/bin/gpg --debug-ccid-driver --card-status
gpg: ATTENZIONE: si sta usando memoria insicura!
gpg: visitare  per ulteriori informazioni
gpg: DBG: ccid-driver: using CCID reader 0 (ID=058F:9520:X:0)
gpg: DBG: ccid-driver: idVendor: 058F  idProduct: 9520  bcdDevice: F033
gpg: DBG: ccid-driver: ChipCard Interface Descriptor:
gpg: DBG: ccid-driver:   bLength                54
gpg: DBG: ccid-driver:   bDescriptorType        33
gpg: DBG: ccid-driver:   bcdCCID              1.00
gpg: DBG: ccid-driver:   nMaxSlotIndex           0
gpg: DBG: ccid-driver:   bVoltageSupport         3  1.8V
gpg: DBG: ccid-driver:   dwProtocols             3  T=0 T=1
gpg: DBG: ccid-driver:   dwDefaultClock       3700
gpg: DBG: ccid-driver:   dwMaxiumumClock      3700
gpg: DBG: ccid-driver:   bNumClockSupported      1
gpg: DBG: ccid-driver:   dwDataRate           9946 bps
gpg: DBG: ccid-driver:   dwMaxDataRate      318280 bps
gpg: DBG: ccid-driver:   bNumDataRatesSupp.     53
gpg: DBG: ccid-driver:   dwMaxIFSD             254
gpg: DBG: ccid-driver:   dwSyncProtocols  00000007  2-wire 3-wire I2C
gpg: DBG: ccid-driver:   dwMechanical     00000000
gpg: DBG: ccid-driver:   dwFeatures       000204BE
gpg: DBG: ccid-driver:     Auto configuration based on ATR
gpg: DBG: ccid-driver:     Auto activation on insert
gpg: DBG: ccid-driver:     Auto voltage selection
gpg: DBG: ccid-driver:     Auto clock change
gpg: DBG: ccid-driver:     Auto baud rate change
gpg: DBG: ccid-driver:     Auto PPS made by CCID
gpg: DBG: ccid-driver:     Auto IFSD exchange
gpg: DBG: ccid-driver:     Short APDU level exchange
gpg: DBG: ccid-driver:   dwMaxCCIDMsgLen       271
gpg: DBG: ccid-driver:   bClassGetResponse    echo
gpg: DBG: ccid-driver:   bClassEnvelope       echo
gpg: DBG: ccid-driver:   wlcdLayout           none
gpg: DBG: ccid-driver:   bPINSupport             0
gpg: DBG: ccid-driver:   bMaxCCIDBusySlots       1
gpg: DBG: ccid-driver: usb_claim_interface failed: -1
gpg: pcsc_establish_context failed: no service (0x8010001d)
gpg: card reader not available
gpg: OpenPGP card not available: errore generale
as root user
[root gnupg-1.4.1]# /usr/local/bin/gpg --card-status --debug-ccid-driver gpg: DBG: ccid-driver: using CCID reader 0
gpg: DBG: ccid-driver: idVendor: 058F  idProduct: 9520  bcdDevice: F033
gpg: DBG: ccid-driver: ChipCard Interface Descriptor:
gpg: DBG: ccid-driver:   bLength                54
gpg: DBG: ccid-driver:   bDescriptorType        33
gpg: DBG: ccid-driver:   bcdCCID              1.00
gpg: DBG: ccid-driver:   nMaxSlotIndex           0
gpg: DBG: ccid-driver:   bVoltageSupport         3  1.8V
gpg: DBG: ccid-driver:   dwProtocols             3  T=0 T=1
gpg: DBG: ccid-driver:   dwDefaultClock       3700
gpg: DBG: ccid-driver:   dwMaxiumumClock      3700
gpg: DBG: ccid-driver:   bNumClockSupported      1
gpg: DBG: ccid-driver:   dwDataRate           9946 bps
gpg: DBG: ccid-driver:   dwMaxDataRate      318280 bps
gpg: DBG: ccid-driver:   bNumDataRatesSupp.     53
gpg: DBG: ccid-driver:   dwMaxIFSD             254
gpg: DBG: ccid-driver:   dwSyncProtocols  00000007  2-wire 3-wire I2C
gpg: DBG: ccid-driver:   dwMechanical     00000000
gpg: DBG: ccid-driver:   dwFeatures       000204BE
gpg: DBG: ccid-driver:     Auto configuration based on ATR
gpg: DBG: ccid-driver:     Auto activation on insert
gpg: DBG: ccid-driver:     Auto voltage selection
gpg: DBG: ccid-driver:     Auto clock change
gpg: DBG: ccid-driver:     Auto baud rate change
gpg: DBG: ccid-driver:     Auto PPS made by CCID
gpg: DBG: ccid-driver:     Auto IFSD exchange
gpg: DBG: ccid-driver:     Short APDU level exchange
gpg: DBG: ccid-driver:   dwMaxCCIDMsgLen       271
gpg: DBG: ccid-driver:   bClassGetResponse    echo
gpg: DBG: ccid-driver:   bClassEnvelope       echo
gpg: DBG: ccid-driver:   wlcdLayout           none
gpg: DBG: ccid-driver:   bPINSupport             0
gpg: DBG: ccid-driver:   bMaxCCIDBusySlots       1
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data:
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 3B FA 13 00 FF 81 31 80 45 00 31 C1 73 C0 01 00 00
90 00 B1gpg: DBG: ccid-driver: sending 61 07 00 00 00 00 02 01 00 00 01
10 00 41 00 FE 00
gpg: DBG: ccid-driver: status: 40  error: 0C  octet[9]: 01
               data: 13 10 FF 45 00 80 00
gpg: DBG: ccid-driver: sending 6F 0B 00 00 00 00 03 04 00 00 00 A4 04 00
06 D2 76 00 01 24 01
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 6F 12 84 10 D2 76 00 01 24 01 01 01 00 01 00 00 03
17 00 00 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 04 04 00 00 00 CA 00 4F
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: D2 76 00 01 24 01 01 01 00 01 00 00 03 17 00 00 90
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 05 04 00 00 00 CA 00 C4
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 00 FE FE FE 03 03 03 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 06 04 00 00 00 CA 00 6E
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 4F 10 D2 76 00 01 24 01 01 01 00 01 00 00 03 17 00
00 73 81 9D C0 01 78 C1 05 01 04 00 00 20 C2 05 01 04 00 00 20 C3 05 01
04 00 00 20 C4 07 00 FE FE FE 03 03 03 C5 3C 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 C6 3C C4 85 A6 CD 7E C6 6E 9E EC 33 65 F2 70 F2 75 E4 C3 2F 6C
A5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 00 00 00 00 00
00 00 00 00 00 00 00 5E 04 6D 75 6E 65 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 07 04 00 00 00 CA 00 5E
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 6D 75 6E 65 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 08 04 00 00 00 CA 00 65
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 5B 13 4D 75 6E 65 72 6F 74 74 6F 3C 3C 46 65 64 65
72 69 63 6F 5F 2D 02 64 65 5F 35 01 31 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 09 04 00 00 00 CA 5F 50
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 0A 04 00 00 00 CA 00 C4
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 00 FE FE FE 03 03 03 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 0B 04 00 00 00 CA 00 7A
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 93 03 00 00 00 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 0C 04 00 00 00 CA 01 01
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 90 00
gpg: DBG: ccid-driver: sending 6F 05 00 00 00 00 0D 04 00 00 00 CA 01 02
gpg: DBG: ccid-driver: status: 00  error: 00  octet[9]: 00
               data: 5B 32 38 39 5D 20 46 65 64 65 72 69 63 6F 20 4D 75
6E 65 72 6F 74 74 6F 20 3C 6D 75 6E 65 40 66 73 66 65 2E 6F 72 67 3E 90
Application ID ...: D2760001240101010001000003170000
Version ..........: 1.1
Manufacturer .....: PPC Card Systems
Serial number ....: 00000317
Name of cardholder: Federico Munerotto
Language prefs ...: de
Sex ..............: male
URL of public key : [not set]
Login data .......: mune
Private DO 1 .....: [not set]
Private DO 2 .....: [289] Federico Munerotto CA fingerprint 1 .: C485 A6CD 7EC6 6E9E EC33  65F2 70F2 75E4 C32F 6CA5
Signature PIN ....: forced
Max. PIN lengths .: 254 254 254
PIN retry counter : 3 3 3
Signature counter : 0
Signature key ....: [none]
Encryption key....: [none]
Authentication key: [none]
General key info..: [none]
gpg: DBG: ccid-driver: status: 01  error: 00  octet[9]: 01
               data:
I don't find any help I hope you can see something useful.

@_date: 2005-07-20 16:22:44
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
Il mer, 2005-07-20 alle 15:03, Werner Koch ha scritto:
Ok. Works
if the device is unplugged and then plugged again, belongs again to the
root group and isn't writable again (change its location). I need to set
up hotplug to 1. chgrp to the proper group
2. chmod +rw scard
the file that is created.
After replugging the USB of the raeder:
[root gnupg-1.4.1]# /sbin/lsusb
Bus 003 Device 006: ID 058f:9520 Alcor Micro Corp.
Bus 003 Device 001: ID 0000:0000
Bus 002 Device 003: ID 046d:c501 Logitech, Inc. Cordless Mouse Receiver
Bus 002 Device 002: ID 046d:c309 Logitech, Inc.
Bus 002 Device 001: ID 0000:0000
Bus 001 Device 001: ID 0000:0000
[root gnupg-1.4.1]# ll /proc/bus/usb/003/006
-rw-r--r--  1 root root 111 20 lug 15:52 /proc/bus/usb/003/006

@_date: 2005-07-20 17:45:31
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
Il mer, 2005-07-20 alle 16:55, Werner Koch ha scritto:
Finally it worked, many thanks!
I copied your gnupg-ccid.usermap in /etc/hotplug/usb .
My reader is HUSBSCR by Hamlet:
Thay declare it is win comp but two months ago, when I bought it, there
was a penguin logo, too.
Now, I'll move my key from $HOME/.gnupg to the card and I'll tell to
Evolution to read there the key to sign my e-mails.

@_date: 2005-07-20 22:52:26
@_author: Federico Munerotto 
@_subject: smart card + gpg only root 
Il mer, 2005-07-20 alle 21:31, Federico Munerotto ha scritto:

@_date: 2005-06-03 14:18:51
@_author: Federico Munerotto 
@_subject: SmartCard + Evolution 
Il sab, 2005-05-28 alle 10:47, Matthias Kirschner ha scritto:
Just wait for a little bit more. In the past days I have been busy in
syncronizing palm device/PC/mobile (I lost all my mobile contacts!).
I still haven't tryed with evolution, yet.
I think that the files in /etc/hotplug/usb/ (to see the USB smartcard
reader) fight with my USB bluetooth dongle, but it a first impression I
will dig on it more (in the worst case i'll avoid to plug the two things
in the same time).
