
@_date: 2012-07-28 14:18:19
@_author: Brad Tilley 
@_subject: Possible bug in gpg? 
I have a symmetrically encrypted pgp file here:
gpg will accept the three characters !=X as the password and exit with a
return status of 0 (although it does not actually decrypt the file):
$ gpg -d pgp-easy.tgz.pgp
gpg: CAST5 encrypted data
gpg: encrypted with 1 passphrase
gpg: WARNING: message was not integrity protected
$ echo $?
!=X is not the plaintext password that was used to encrypt the file. I was
hoping someone on the list might be able to help me understand why this
might happen. Could it be a bug in gpg, or OpenPGP itself? Here is my gpg
$ gpg --version
gpg (GnuPG) 1.4.12
Here is --list-packets:
$ gpg --list-packets pgp-easy.tgz.pgp
:symkey enc packet: version 4, cipher 3, s2k 3, hash 2
gpg: CAST5 encrypted data
:encrypted data packet:
gpg: encrypted with 1 passphrase
gpg: WARNING: message was not integrity protected
I don't yet know the actual plaintext password or the exact
commands/program used to encrypt the file, but I should know in a few
days. This is a file that's apart of the defcon password cracking contest
and I came across this and wanted to mention it here.
I'm not subscribed to this list, so please cc me if you want to reach me.

@_date: 2012-07-28 23:26:59
@_author: Brad Tilley 
@_subject: Possible bug in gpg? 
a return status of 0 (although it does not actually decrypt the file):
1 passphrase gpg: WARNING: message was not integrity
understand why this might happen. Could it be a bug in gpg, or
as you) and tried the same trick.  The !=X string did not produce the
the same message.  Instead I received the expected "decryption failed:
bad key" message.
days. This is a file that's apart of the defcon password
whatever software was used to encrypt the file or someone has found a
way to be sneaky with it.  Either way, when all is revealed please post
a follow-up.
was CC'd to you, but it didn't shed any light either.
Thanks for the reply Ben, I've encountered several other plaintext strings
that cause the same behavior. Here's another one:
It seems to work (gpg -d accepts the string and exits with status 0) but
again the data are not decrypted. Someone cracked this, so we should know
what the actual plaintext is soon.
Thanks again,

@_date: 2012-07-29 08:47:48
@_author: Brad Tilley 
@_subject: Possible bug in gpg? 
Thanks for the reply David. The file was actually cracked so we'll know
the plaintext sometime soon, although that may likely matter not.
That seems like a reasonable check to make in most cases. I know that
symmetric-key algorithms will happily output garbage when the wrong
password is used and that may confuse some people, but then again, some
others may actually prefer that. If I was expecting a pdf file (upon
successful decryption) and there was no pdf header up front (only
randomish looking bytes all through the file), then that would be a decent
indication, to me, that the bytes I saw were not actually decrypted.
I wrote a small shell script to loop sending password attempts to gpg. I
found three words that caused this behavior in about two hours of trying.
Two of the words worked on the file I initially posted and the other one
on a different file in the contest. So, it seems rather common. Within a
day or so, I could probably generate dozens of words that cause this
Thanks again,

@_date: 2012-07-30 09:45:29
@_author: Brad Tilley 
@_subject: Possible bug in gpg? 
Thanks for the reply David. The file was actually cracked so we'll know
the plaintext sometime soon, although that may likely matter not.
That seems like a reasonable check to make in most cases. I know that
symmetric-key algorithms will happily output garbage when the wrong
password is used and that may confuse some people, but then again, some
others may actually prefer that. If I was expecting a pdf file (upon
successful decryption) and there was no pdf header up front (only
randomish looking bytes all through the file), then that would be a decent
indication, to me, that the bytes I saw were not actually decrypted.
I wrote a small shell script to loop sending password attempts to gpg. I
found three words that caused this behavior in about two hours of trying.
Two of the words worked on the file I initially posted and the other one
on a different file in the contest. So, it seems rather common. Within a
day or so, I could probably generate dozens of words that cause this
Thanks again,
