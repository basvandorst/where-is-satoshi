
@_date: 2014-03-11 10:44:05
@_author: Chris Boot 
@_subject: Resetting an OpenPGP smart card "bricks" it 
I've reset two OpenPGP smart cards using the instructions at
 and
both have been rendered unusable. Both are OpenPGP V2 cards.
I notice the instructions at
reverse the last two APDUs (e6 then 44 rather than 44 then e6). I
believe that E6 is 'TERMINATE DF' and 44 is 'ACTIVATE FILE', so the 2009
instructions are probably correct while the 2013 ones are not.
Is there a way to recover cards that have had the erroneous procedure
run on them, please? I can't even get gpg-connect-agent to talk to the
cards now ("gpg: OpenPGP card not available: Not supported"), nor even
tools like opensc-explorer.
Please CC me as I'm not subscribed.

@_date: 2014-03-11 17:20:59
@_author: Chris Boot 
@_subject: Resetting an OpenPGP smart card "bricks" it 
Hi Werner,
Hmm. I did my two cards by:
1. Plugging in reader with embedded card (I'm using Gemalto IDBridge K30
and K50 readers).
2. gpg2 --card-status
3. gpg-connect-agent, then run commands as per your email
4. Unplug reader with card.
5. Plug in again and find that gpg2 --card-status fails.
If it's any use, the two cards in question have serial numbers:
- 000500001BDE
- 0005000020D5
Hi Werner,
Unfortunately, neither "bricked" card appears to want to respond to the
serialno command:
$ gpg-connect-agent
ERR 100663356 Not supported ERR 100663351 Invalid value ERR 100663351 Invalid value This is running GnuPG 2.0.22.

@_date: 2014-03-12 15:40:07
@_author: Chris Boot 
@_subject: Resetting an OpenPGP smart card "bricks" it 
Hi Werner,
I tried using 'scriptor' to send "00 44 00 00" to the card, but the card
refused that too. Not being a Smart Card expert, I really don't know
what else I should try to send to the card to get meaningful replies
from it.
  $ scriptor
  No reader given: using Gemalto USB Shell Token V2 (2BAA4AC2) 00 00
  Using T=1 protocol
  Reading commands from STDIN
  00 44 00 00
  > 00 44 00 00
  < 6A 88 : Wrong parameter(s) P1-P2. Referenced data not found.

@_date: 2014-03-12 16:15:57
@_author: Chris Boot 
@_subject: Resetting an OpenPGP smart card "bricks" it 
THANK YOU! Your pointers helped me recover both cards.
I didn't use the Python script at [2], but I sent the two APDUs that it
sends to the cards using 'scriptor', which recovered them. Unfortunately
I closed the window shortly after celebrating so I don't have the exact
transcript of the session, but it looked something like:
  $ scriptor
  No reader given: using Gemalto USB Shell Token V2 (D4182110) 00 00
  Using T=1 protocol
  Reading commands from STDIN
  00 a4 04 00 06 d2 76 00 01 24 01
  > 00 a4 04 00 06 d2 76 00 01 24 01
  < XX YY : {{ NVRAM not changed }}
  00 44 00 00
  > 00 44 00 00
  < 90 00 : Normal processing.
Note the line that says XX YY and NVRAM not changed is from memory; I
remember it saying about the NVRAM having _not_ being changed, but it
worked anyway. I really wish I hadn't fat-fingered my terminal and
closed it.
For others following this thread, 'scriptor' is in the pcsc-tools
package in Debian, and seems to be a pretty neat if scary tool for
sending raw ADPUs to smart cards.
Thanks again Peter for pointing me at that Python script.
