
@_date: 2006-07-14 08:53:06
@_author: Tristan Williams 
@_subject: Moving computers with an OpenPGP card 
Is it possible to arrive at a new computer which has a known working
card reader and installation of gpg with only your OpenPGP card and be
able to sign/encrypt?
i.e arrive at computer, download and import your public key, insert
smart card and then be able to sign/encrypt? I have not been able to
do this (though by copying my secring.gpg which has the key stub I
can) and wondered whether it was possible?
Kind regards
Tristan Williams

@_date: 2006-06-13 17:56:18
@_author: Tristan Williams 
@_subject: OpenPGP smartcard restore 
I am experimenting with the OpenPGP smartcard. I have two OpenPGP smart
cards (smartA and smartB) and I want to verify that I can restore my
on-card generated private key should I loose the master card
(smartA). I only want to verify that I can do it - not discuss the
merits of on-card vs. off-card key generation.
I start with an empty ~/.gnupg
For smartA I have
(1) an on-card generated key
(2) the backup file created ~/.gnupg/sk_X.gpg at key generation
(3) a backup of ~/.gnupg/secring.gpg when the (4) a file with the exported associated public key (5) a test file encrypted with above public key which decrypts with smartA
(6) the pass phrase used at key generation
(7) second OpenPGP smartcard (smartB)
I then I imagine that I have lost my card (smartA), my computer hard disk has
died and I have to restore to a fresh new gpg environment (i.e. no
~/.gnupg) and smartB
I then issues these commands gpg --list-keys which creates ~/.gnupg and various files within it.
gpg --import public_key.asc using (4) from my backups
gpg --list-keys shows that the public key has been imported
I then copy my backup secring.gpg to ~/.gnugpg
gpg --edit-key KEYID shows that the secret key is present
gpg --list-secret-keys shows that the secret key is linked to card-no smartA
gpg --edit-key KEYID
bkuptocard sk_X.gpg
choose the (1) the signature replace existing key yes
enter pass phrase save changes yes
Now gpg --list-keys shows the key still linked to card-no smartA and not smartB
any action needing the private key using smartB results in gpg
requesting that you put in smartA (which is lost...)
Has anyone actually managed a functional OpenPGP card restore with on-card key
generation? And if so how please!
Tristan Williams

@_date: 2006-06-13 19:51:48
@_author: Tristan Williams 
@_subject: OpenPGP smartcard restore 
Then it makes me wonder what is the purpose of the off card backup
file sk_X.gpg created when the original private key was created via
the on-card method? I can appreciate there might be reasons for not
permitting export of the private key from the card but I did expect
that restoring a private key using the backup file made at key
creation time would be possible. It looks like I was wrong in that

@_date: 2006-06-13 22:17:52
@_author: Tristan Williams 
@_subject: OpenPGP smartcard restore 
It works as you suggested.
gpg is now happy with smartB (and longer asks  for smartA). The file  I encrypted with the public key is decrypted correctly.
gpg now references smartB not smartA when listing keys.
So what is in sk_X.gpg if it is not a standalone importable secret key?
Thanks and regards,
Tristan Williams

@_date: 2006-06-14 11:12:26
@_author: Tristan Williams 
@_subject: OpenPGP smartcard restore 
On closer inspection it appears that only the encryption key gets
transfered to the new card (smartB) using the above.  So I can decrypt
but not sign.

@_date: 2006-06-18 14:23:52
@_author: Tristan Williams 
@_subject: OpenPGP smartcard and Private DO 1 
Is there any available software to write/read to the Private DO
on the OpenPGPcard?
Grateful for any pointers.
Kind regards
Tristan Williams
