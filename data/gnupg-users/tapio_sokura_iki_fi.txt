
@_date: 2013-11-05 13:26:05
@_author: Tapio Sokura 
@_subject: Sharing a card reader between pkcs11 and gnupg card? 
I'm having some troubles using both a PKCS  accessed card (national electronic ID card) and an OpenPGP card in the same computer. I haven't really looked deep into this yet, but it looks like the smart card reader is claimed by the driver that is first started (scdaemon or the national ID card driver) and the other one doesn't see any readers.
Is this the expected beahvior, i.e. I can't share one card reader between different card types without stopping/starting services when changing from one card to another?
I have several card readers, so I could use two readers at the same time and I understand I should be able to dedicate one reader for one card type by configuration. But for laptop use that gets clumsy, especially when you have (one) integrated reader already in the laptop.
I'm running 12.04 LTS Ubuntu with the packaged gnupg    Tapio

@_date: 2013-11-08 19:07:21
@_author: Tapio Sokura 
@_subject: Signing keys on a low-entropy system 
Key generation definitely needs good random data. But generating an RSA
signature is completely deterministic; the RSA operations themselves do
not use or need random data.
Another thing is that some signature schemes that use RSA also add
random padding data into the data that is being signed, but I don't
think signatures in PGP do that. I may be wrong though, haven't combed
through the PGP specs thoroughly.
  Tapio

@_date: 2013-10-24 00:41:53
@_author: Tapio Sokura 
@_subject: gpg4win pinentry ignores PIN-pad 
I'm having the exact same problem in gpg4win 2.2.1 with SPR 532 (firmware 5.10), Windows 7 64-bit. In Linux the pinpad worked by default just fine, no separate configuration needed. I have not done any special configuration of gpg4win related to pinpad usage, but I have installed the regular drivers provided by SCM. When I plug my openpgp v2 card into the reader slot, Windows pops up a notification "Device driver software was not successfully installed", but I'm assuming it's normal and due to Windows itself not understanding openpgp cards?
Here are a few excerpts from my scdaemon log that might or might not be relevant. This is from logging into an ssh server using putty and a key stored in the authentication slot, pin input via pinentry/keyboard. If you need something more verbose, let me know. (BTW it would be nice to be able to export the ssh-compatible authorized_keys pubkey line directly via some more integrated way, gpgkey2ssh isn't supplied in gpg4win. Is there something similar?)
2013-10-23 23:43:05 scdaemon[792] listening on socket 2013-10-23 23:43:05 scdaemon[792] handler for fd -1 started
2013-10-23 23:43:05 scdaemon[792] detected reader `SCM Microsystems Inc. SPRx32 USB Smart Card Reader 0'
2013-10-23 23:43:05 scdaemon[792] pcsc_control failed: invalid PC/SC error code (0x6)
2013-10-23 23:43:05 scdaemon[792] pcsc_vendor_specific_init: GET_FEATURE_REQUEST failed: 65547
2013-10-23 23:43:05 scdaemon[792] reader slot 0: not connected
2013-10-23 23:43:06 scdaemon[792] reader slot 0: active protocol: T1
2013-10-23 23:43:06 scdaemon[792] slot 0: ATR=3B DA 18 FF 81 B1 FE 75 1F 03 00 31 C5 73 C0 01 40 00 90 00 0C
2013-10-23 23:43:06 scdaemon[792] Historical Bytes: 00 31 C5 73 C0 01 40 05 90 00
2013-10-23 23:43:06 scdaemon[792] Version-2 ......: yes
2013-10-23 23:43:06 scdaemon[792] Get-Challenge ..: yes (2048 bytes max)
2013-10-23 23:43:06 scdaemon[792] Key-Import .....: yes
2013-10-23 23:43:06 scdaemon[792] Change-Force-PW1: yes
2013-10-23 23:43:06 scdaemon[792] Private-DOs ....: yes
2013-10-23 23:43:06 scdaemon[792] Algo-Attr-Change: yes
2013-10-23 23:43:06 scdaemon[792] SM-Support .....: no
2013-10-23 23:43:06 scdaemon[792] Max-Cert3-Len ..: 2048
2013-10-23 23:43:06 scdaemon[792] Max-Cmd-Data ...: 2048
2013-10-23 23:43:06 scdaemon[792] Max-Rsp-Data ...: 2048
2013-10-23 23:43:06 scdaemon[792] Cmd-Chaining ...: no
2013-10-23 23:43:06 scdaemon[792] Ext-Lc-Le ......: yes
2013-10-23 23:43:06 scdaemon[792] Status Indicator: 05
2013-10-23 23:43:06 scdaemon[792] GnuPG-No-Sync ..: no
2013-10-23 23:43:06 scdaemon[792] GnuPG-Def-PW2 ..: no
2013-10-23 23:43:06 scdaemon[792] Key-Attr-sign ..: RSA, n=4096, e=32, 2013-10-23 23:43:06 scdaemon[792] Key-Attr-encr ..: RSA, n=4096, e=32, 2013-10-23 23:43:06 scdaemon[792] Key-Attr-auth ..: RSA, n=4096, e=32, 2013-10-23 23:43:06 scdaemon[792] updating slot 0 status: 0x0000->0x0007 2013-10-23 23:43:06 scdaemon[792] triggering event 100 (00000100) for client -1
2013-10-23 23:43:10 scdaemon[792] DBG: check_pcsc_pinpad: command=20, 2013-10-23 23:43:10 scdaemon[792] DBG: asking for PIN '||Please enter the PIN'
2013-10-23 23:43:21 scdaemon[792] operation auth result: Success
   Tapio

@_date: 2013-10-27 08:12:52
@_author: Tapio Sokura 
@_subject: 2048 or 4096 for new keys? aka defaults vs. Debian 
Often there is also value in breaking crypto so that the targeted crypto
users don't know it has been broken and thus continue to use it (the
algorithm and/or the specific key). If a big government organization
(take your pick) had broken algorithm/keysize xyz, would they tell anybody?
  Tapio

@_date: 2018-02-03 17:05:13
@_author: Tapio Sokura 
@_subject: draft-ietf-openpgp-rfc4880bis-04 
I haven't read the context of the draft, so I don't know whether the sample 'm' is formed correctly, but this is what I get with the 'm' listed above being in file testvec:
$ od -t x1 testvec
0000000 4f 70 65 6e 50 47 50 04 00 16 08 00 06 05 02 55
0000020 f9 5f 95 04 ff 00 00 00 0c
$ sha256sum testvec
f6220a3f757814f4c2176ffbb68b00249cd4ccdc059c4b34ad871f30b1740280  testvec
So it matches with the document. Are you sure the 'm' you end up is exactly the same as in the draft?
   Tapio
