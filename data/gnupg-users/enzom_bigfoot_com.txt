
@_date: 2000-01-08 12:07:00
@_author: Enzo Michelangeli 
@_subject: Incompatibility between gnupg 0.9.7 and >0.9.10 in conv. 3des encryption 
I'm not sure whether it's a known problem, but if one encrypts with:
 ./gpg097 -a -c --cipher-algo 3des q
and then tries to decrypt with gpg version 0.9.10 or later:
 gpg q.asc
the result is an error message:
 gpg: decryption failed: bad key
The incompatibility is mutual: files encrypted with 0.9.10 can't be
decrypted by the 0.9.7 either. If the --cipher-algo is not specified,
everything works fine.
Listing the packets does indeed show a difference. A q.asc produced by the
version 0.9.7 lists as:
 $ gpg --list packets q.asc
 gpg: Option "--list" is ambiguous
 bash-2.03$ gpg --list-packets q.asc
 :symkey enc packet: version 4, cipher 2, s2k 1, hash 3
         salt b742d414bb37d32f
...whereas one produced with the version 0.9.10 or later shows:
 $ gpg --list-packets q.asc
 :symkey enc packet: version 4, cipher 2, s2k 3, hash 3
         salt 08cbb4030fd47883, count 96
However, I would expect that backward compatibility with older s2k values be
preserved in decryption.
Cheers --

@_date: 2000-01-08 12:07:00
@_author: Enzo Michelangeli 
@_subject: Incompatibility between gnupg 0.9.7 and >0.9.10 in conv. 3des encryption 
I'm not sure whether it's a known problem, but if one encrypts with:
 ./gpg097 -a -c --cipher-algo 3des q
and then tries to decrypt with gpg version 0.9.10 or later:
 gpg q.asc
the result is an error message:
 gpg: decryption failed: bad key
The incompatibility is mutual: files encrypted with 0.9.10 can't be
decrypted by the 0.9.7 either. If the --cipher-algo is not specified,
everything works fine.
Listing the packets does indeed show a difference. A q.asc produced by the
version 0.9.7 lists as:
 $ gpg --list packets q.asc
 gpg: Option "--list" is ambiguous
 bash-2.03$ gpg --list-packets q.asc
 :symkey enc packet: version 4, cipher 2, s2k 1, hash 3
         salt b742d414bb37d32f
...whereas one produced with the version 0.9.10 or later shows:
 $ gpg --list-packets q.asc
 :symkey enc packet: version 4, cipher 2, s2k 3, hash 3
         salt 08cbb4030fd47883, count 96
However, I would expect that backward compatibility with older s2k values be
preserved in decryption.
Cheers --

@_date: 2000-03-08 18:04:33
@_author: Enzo Michelangeli 
@_subject: Oh, no: inter-version 3DES incompatibility strikes again :-( 
on Sat, Jan 08, 2000 at 12:07:00PM +0800
Mail-Followup-To: gnupg-users
Sender: Werner Koch User-Agent: Mutt/1.1.1i
There are more problems with that.  The reason is that I changed the
internal API form the hash algorithms somewhere between these versions
with the result that all ciphers needing a key lasrger than the hash
size didn't work anymore or better the string-to-key algorithm was not
This is a problem with 3DES and Twofish.
The only solution to reencypt these messages - I am yery soory about
GnuPG 1.0.1 now works like required by the standard and produces valid
3DES, Twofish symmetric only encryptions which interoperate with PGP.
1.0.1 has an option to emulate the bug: --emulate-3des-s2k-bug .
Please note that this option will be removed in gpg 1.1, so either
re-encrypt all these messages or keep a copy of gpg 1.0.0 which has
this bug.
It is not possible because the bug reduces the keylength to 160 bit
which is effective then less than 112 bits for 3DES.
Werner Koch at guug.de                      keyid 621CC013
     Boycott Amazon!  -

@_date: 2000-03-08 19:29:30
@_author: Enzo Michelangeli 
@_subject: Oh, no: inter-version 3DES incompatibility strikes again :-( 
The problem occurs trying to decrypt with PGP data encrypted with GnuPG, not
the other way round. GnuPG 1.0.1 creates this sort of packets:
:symkey enc packet: version 4, cipher 2, s2k 3, hash 3
        salt 1c45ce8b23689629, count 96
:encrypted data packet:
        length: 39
:compressed packet: algo=2
:literal data packet:
        mode b, created 952514550, name="",
        raw data: 14 bytes
...whereas PGP 6.5.1 creates these others (with another plaintext):
:marker packet:
 50 47 50
:symkey enc packet: version 4, cipher 2, s2k 3, hash 2
        salt 5b13d419ff5d9447, count 96
:encrypted data packet:
        length: 42
:compressed packet: algo=1
:literal data packet:
        mode b, created 0, name="test3DES.txt",
        raw data: 10 bytes
Cheers --

@_date: 2000-03-11 12:58:55
@_author: Enzo Michelangeli 
@_subject: Non-interoperability with PGP: case solved 
No, the hash was a red herring. I have found how to make GnuPG 1.0.1 and
0.97 interoperate with PGP: specify "--compress-algo 1". By default, gnupg
uses 2, and PGP 6.5.1 chokes on it.
Packets produced by GnuPG 1.0.0 are still not decoded by PGP, who detects a
"bad key".

@_date: 2000-03-08 18:04:33
@_author: Enzo Michelangeli 
@_subject: Oh, no: inter-version 3DES incompatibility strikes again :-( 
on Sat, Jan 08, 2000 at 12:07:00PM +0800
Mail-Followup-To: gnupg-users
Sender: Werner Koch User-Agent: Mutt/1.1.1i
There are more problems with that.  The reason is that I changed the
internal API form the hash algorithms somewhere between these versions
with the result that all ciphers needing a key lasrger than the hash
size didn't work anymore or better the string-to-key algorithm was not
This is a problem with 3DES and Twofish.
The only solution to reencypt these messages - I am yery soory about
GnuPG 1.0.1 now works like required by the standard and produces valid
3DES, Twofish symmetric only encryptions which interoperate with PGP.
1.0.1 has an option to emulate the bug: --emulate-3des-s2k-bug .
Please note that this option will be removed in gpg 1.1, so either
re-encrypt all these messages or keep a copy of gpg 1.0.0 which has
this bug.
It is not possible because the bug reduces the keylength to 160 bit
which is effective then less than 112 bits for 3DES.
Werner Koch at guug.de                      keyid 621CC013
     Boycott Amazon!  -

@_date: 2000-03-08 19:29:30
@_author: Enzo Michelangeli 
@_subject: Oh, no: inter-version 3DES incompatibility strikes again :-( 
The problem occurs trying to decrypt with PGP data encrypted with GnuPG, not
the other way round. GnuPG 1.0.1 creates this sort of packets:
:symkey enc packet: version 4, cipher 2, s2k 3, hash 3
        salt 1c45ce8b23689629, count 96
:encrypted data packet:
        length: 39
:compressed packet: algo=2
:literal data packet:
        mode b, created 952514550, name="",
        raw data: 14 bytes
...whereas PGP 6.5.1 creates these others (with another plaintext):
:marker packet:
 50 47 50
:symkey enc packet: version 4, cipher 2, s2k 3, hash 2
        salt 5b13d419ff5d9447, count 96
:encrypted data packet:
        length: 42
:compressed packet: algo=1
:literal data packet:
        mode b, created 0, name="test3DES.txt",
        raw data: 10 bytes
Cheers --

@_date: 2000-03-11 12:58:55
@_author: Enzo Michelangeli 
@_subject: Non-interoperability with PGP: case solved 
No, the hash was a red herring. I have found how to make GnuPG 1.0.1 and
0.97 interoperate with PGP: specify "--compress-algo 1". By default, gnupg
uses 2, and PGP 6.5.1 chokes on it.
Packets produced by GnuPG 1.0.0 are still not decoded by PGP, who detects a
"bad key".
