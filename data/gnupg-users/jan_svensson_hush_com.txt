
@_date: 2015-04-07 20:15:13
@_author: jan.svensson@hush.com 
@_subject: Blind signatures for simple election 
I have been looking around a bit, but couldn't find the answer. I
would like to do the following with GPG if possible, thanks in
Assume we would like to hold a small election where no one should be
able to know which political party anyone have voted for.
User A, user B, and user C each have a small text file named
"ballot.txt" which contains his/her favorite political party written
in clear text, e.g. just the text "D" (for the Democratic Party) or
the text "R" (for the Republican Party).
Then all of them generates some kind of blinding factor "b" to be used
to blind their ballot. Then they blind "ballot.txt" with the blinding
factor b:
    blind(ballot.txt,b)
All of them sends their "ballot.txt.blind" to the signer user X who
can not see the contents of the file since it is blinded.
User X signs all of the files "ballot.txt.blind" with the same
signature used only for this election:
    sign(blind(ballot,b),d)
User X now sends "ballot.txt.blind.sign" back to user A, user B, and
user C. Each of them now unblinds their file "ballot.txt.blind.sign":
    unblind(sign(blind(ballot,b),d),b)
which can be reduced to
    sign(ballot,d)
Finally, at the day of election, user A, user B, and user C vists an
election room and delivers their file "ballot.txt.sign" on a USB
memory stick and watches while the trustee stores their ballots
"ballot.txt.sign" in some way. This file "ballot.txt.sign" contains
their political party written in clear text and also contains a
signature made by user X to indicate that the ballot is valid for the
How can I do all above in some simple way with GPG commands like
--gen-key, --sign, --verify etc? Or do I need to apply e.g. some
patches to GPG to be able to do this?
Thanks alot in advance!

@_date: 2015-04-08 18:43:34
@_author: Jan Svensson 
@_subject: Blind signatures for simple election 
Thank you very much for your answer!
I'm sorry that I wasn't clear about it, but I am more interested if it
is possible to use GPG to do the basic things here (not necessary for
an election), i.e. to have a user blind a small text file with some
GPG-command, then if it is possible for the signer to sign the blinded
text file with some GPG-command, and finally if the user would be able
to unblind this signed text file now also containing a signature from
the signer.
I guess this is not possible to do with GPG, right?
avoid RSA timing attacks, but I guess it is not possible for a user of
GPG to use those functions in a similar way as I describe above.
I've looked a bit at CryptoBallot and all the crypto stuff seems to be
done in the Go language. I've also looked at PseudoID which seems to
be coded in Python and JavaScript, i.e. none of CryptoBallot or
PseudoID seems to use GPG in any way. Maybe I should try see if I can
borrow some code from CryptoBallot or PseudoID to do this, or in best
case if someone knows some other project that fits better so I can set
up a simple prototype of the system myself?
Best regards,
-----BEGIN PGP SIGNED
Hash: SHA512
On Tuesday 7 April 2015 at 7:15:13 PM, in
What you went on to describe sounds quite a bit like CryptoBallot [0],
[0] .
[1] .

@_date: 2015-04-08 20:57:54
@_author: Jan Svensson 
@_subject: Blind signatures for simple election 
What do you think about me trying to use Libgcrypt instead? The manual ( says
"By default Libgcrypt uses a blinding technique for RSA decryption to mitigate real world timing attacks over a network: Instead of using the RSA decryption directly, a blinded value y = x r^{e} \bmod n is decrypted and the unblinded value x' = y' r^{-1} \bmod n returned. The blinding value r is a random value with the size of the modulus n and generated with GCRY_WEAK_RANDOM random level."
Would it be possible to create three small programs in e.g. C (or some other language if it is more suitable) that uses Libgcrypt:
1. a program "generate_blinding_factor" that generates a blinding factor "b".
2. a program "blind" that takes a message and a blinding factor "b" as input parameters and gives as output the message in blinded format.
3. a program "unblind" that takes a blinded message and a blinding factor as input parameters and gives as output the message in unblinded format.
The user would first use "generate_blinding_factor" to generate a blinding factor and then use "blind" to blind a message.
The, the user would then send the message to the signer who uses the usual GPG-command "gpg --output blinded_message.sig --sign blinded_message" and then sends it back to the user.
Finally, the user would use "unblind" to unblind the signed blinded message to get a file with the message signed by the signer.
We can assume that the signer keeps the blinded message so when that signer later gets to see the unblinded message with the signers signature, then the signer cannot link those two messages to each other, i.e. sign(blind(message,b),d) and sign(message,d) cannot be linked.
Thanks for any advice here,
