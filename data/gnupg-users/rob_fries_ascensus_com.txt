
@_date: 2015-02-25 17:14:15
@_author: Rob Fries 
@_subject: 7. RE: how to disable pinentry (Smith, Cathy) 
Hi Cathy,
We use /usr/libexec/gpg-preset-passphrase to set our passphrase.  /usr/libexec/gpg-preset-passphrase  -cP "$passphrase" $keygrip
  You would need to add this to your .gpg-agent.conf:
you will need to get the KEYGRIP. The easiest way I found is:
gpg2 --fingerprint --fingerprint --list-secret-keys | grep "fingerprint" | cut -d= -f2 | tr -d ' '
make sure you get the correct one for the correct key( note the above command shows double the number of keygrips for what you need.. ).
and you may want to adjust your max-cache-ttl gpg-agent.conf too.  If you want to forget a passphrase before the ttl is up, you can use gpg-preset-passphrase to forget it.
Rel6 does provide a pinentry-curses program:
Hope that helps!
Message: 7
Adding this line didn't work:
The message was invalid option
The CentOS6 and RHEL6 distributions don't  provide a /usr/bin/pinentry-tty.   One of my goals of this is to be able to set a passphrase on a key in batch processing.  Perhaps, there is another way to accomplish that?
Thank you
Cathy L. Smith
IT Engineer
Pacific Northwest National Laboratory
Operated by Battelle for the
U.S. Department of Energy
Phone:????? 509.375.2687
Fax:??? ????509.375.2330
Email:????? cathy.smith at pnnl.gov
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.

@_date: 2015-02-25 20:26:37
@_author: Rob Fries 
@_subject: 7. RE: how to disable pinentry (Smith, Cathy) 
Hey Cathy,
You need gpg-agent running with this setup.
Per the error message, it can not connect to a running gpg-agent to enter the passphrase.
Your gpg-agent.conf also needs to be with your other gpg configs under .gnupg.
Sent: Wednesday, February 25, 2015 9:14 AM
Hi Cathy,
We use /usr/libexec/gpg-preset-passphrase to set our passphrase.  /usr/libexec/gpg-preset-passphrase  -cP "$passphrase" $keygrip
  You would need to add this to your .gpg-agent.conf:
you will need to get the KEYGRIP. The easiest way I found is:
gpg2 --fingerprint --fingerprint --list-secret-keys | grep "fingerprint" | cut -d= -f2 | tr -d ' '
make sure you get the correct one for the correct key( note the above command shows double the number of keygrips for what you need.. ).
and you may want to adjust your max-cache-ttl gpg-agent.conf too.  If you want to forget a passphrase before the ttl is up, you can use gpg-preset-passphrase to forget it.
Rel6 does provide a pinentry-curses program:
Hope that helps!
Message: 7
Adding this line didn't work:
The message was invalid option
The CentOS6 and RHEL6 distributions don't  provide a /usr/bin/pinentry-tty.   One of my goals of this is to be able to set a passphrase on a key in batch processing.  Perhaps, there is another way to accomplish that?
Thank you
Cathy L. Smith
IT Engineer
Pacific Northwest National Laboratory
Operated by Battelle for the
U.S. Department of Energy
Phone:????? 509.375.2687
Fax:??? ????509.375.2330
Email:????? cathy.smith at pnnl.gov
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.
Gnupg-users mailing list
Gnupg-users at gnupg.org
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.

@_date: 2015-01-09 20:24:39
@_author: Rob Fries 
@_subject: gpg-connect-agent querying max-cache-ttl 
I have done a lot of searching and have not found much to cover my use case. Please direct me to any previous discussions if there are any!
Basically, I have stand alone system where files are automatically encrypted and decrypted for processing. This is currently setup using quintuple-agent, but we want to use something which is maintained.
I am looking to use gpg-agent to store the passphrase, which is entered using gpg-preset-passphrase. This all works perfectly other than max-cache-ttl removing the passphrase.
I am looking for a way to query the max-cache-ttl  time for gpg-agent so I can have an alert as this time approaches.
This will give me a heads up before I need to enter a passphrase with gpg-preset-passphrase so it can be planned for an optimal time.
I know there are ways to query some information from gpg-agent with gpg-connect-agent, but I have not found any central documentation on how to query this.
Let me know if there are any questions and thanks!
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.

@_date: 2015-01-12 17:45:30
@_author: Rob Fries 
@_subject: gpg-connect-agent querying max-cache-ttl 
After some off list communication, I wanted to circle back here with my findings.
To recap, and perhaps more clearly:
I am attempting to query from gpg-agent the time remaining before a passphrase expires for a key due to the max-cache-ttl setting.  I believe the proper way to do this would be through gpg-connect-agent.
I found the gpg-agent Assuan protocol here:
There appears to be no way to get the remaining time for before a passphrase expires at this time.
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.

@_date: 2015-01-12 20:48:59
@_author: Rob Fries 
@_subject: gpg-connect-agent querying max-cache-ttl 
Thanks for the reply, but this is what Patrick and I discussed of ticket.
But I am not looking for the value in the "configuration", I am looking for the "time remaining" until a passphrase expires.
If I set my max-cache-ttl to 5 days:
$ echo $((60*60*24*5))
I can retrieve that value here:
$ gpgconf --list-options gpg-agent|grep ^max-cache-ttl: |cut -d: -f 8,10
Then I set my passphrase:
$ gpg-preset-passphrase -cP  $key
I am looking for the "time remaining" until I am required to re-enter that passphrase. Gpgconf will only give me what is configured as the max:
$ gpgconf --list-options gpg-agent|grep ^max-cache-ttl: |cut -d: -f 8,10
$ gpgconf --list-options gpg-agent|grep ^max-cache-ttl: |cut -d: -f 8,10
$ gpgconf --list-options gpg-agent|grep ^max-cache-ttl: |cut -d: -f 8,10
In 5 days, I am looking for that value to be 1 day or 86400 seconds so that I can trigger an alert.
I hope that clarifies everything.
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.

@_date: 2015-01-12 21:26:56
@_author: Rob Fries 
@_subject: gpg-connect-agent querying max-cache-ttl 
You are correct, ttl is not a current issue, and a high setting is something we are considering . ( thanks for the max value! :) ) Hmm... I hadn't considered my own time stamp file exactly, but that is another solution we could certainly use. We already have a wrapper, so it would be simple to add.
CONFIDENTIALITY NOTICE: This message, including attachments, is intended to be viewed only by the addressee. It may contain information that is privileged, confidential and/or exempt from disclosure under applicable law. No confidentiality or privilege is lost by any transmission error. This message may contain nonpublic personal information about consumers subject to the restrictions of the Gramm-Leach-Bliley Act and the Sarbanes-Oxley Act. You may not directly or indirectly reuse or disclose such information for any purpose except as permitted by law. Any dissemination, distribution or copying of this message is strictly prohibited without our prior written permission. If you are not an intended recipient, or if you have received this message in error, please notify us immediately by return e-mail and permanently remove the original message and any copies from your computer and all back-up systems.
