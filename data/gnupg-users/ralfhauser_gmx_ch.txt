
@_date: 2004-01-05 17:57:53
@_author: Ralf Hauser 
@_subject: filenames of encrypted attachments visible ? How hard would it be 
To my understanding,
If I send a message with attachments, the attachment filename is visible
without cryptanalysis.
Would it be hard to give the encrypted file a random name and only upon
decryption, give it back its real name?
 doesn't appear state anything on this
Isn't that kind of giving away information that could be easily protected -
or did I miss something?
Sample use case: Some investment banker uses PGP and sends around an
attachment with the name "UnfriendlyTakeoverOfListedCorpXYZ.doc.asc" - isn't
that kind of an invitation to insiders?
Sure, it wouldn't be hard to rename the file before sending, but this kind
of negligence is happening all over... and I hope applications like gpg/pgp
could eventually become fool-proof/fail-safe to this level?

@_date: 2004-01-08 23:17:59
@_author: Ralf Hauser 
@_subject: "--armor" ignored when using the "--set-filename" option? 
Thanks to Brian,
( I
figured that the attachment name can be hidden with GPG.
However, I have troubles now getting "set-filename" to work together "armor"
(input and output are piped):
1) <> the armor command gets ignored and binary output is produced (I
am running this out of Java and get java.io.IOException: Broken pipe)
Changing to "--armor" has no effect.
2) I tried all kinds of other variants breaking the sequence of "gpg
[--homedir name]  [options]  command " (as per the man page) that all
 <>
e.g. put the set-filename to the end
(because on the command line "gpg --armor --encrypt --recipient
me --set-filename foo.txt encryptedFile.asc") works,
Any hints would be highly appreciated!
   Rgds Ralf
P.S.: setting "--debug-all" didn't appear to provide further insights either
(no output in case 1), the below in case 2) ):
gpg: NOTE: no default option file `/tmp/gpg-jw-d9hmzoxay6qs/options'
usage: gpg [options] [filename]
random usage: poolsize=600 mixed=0 polls=0/0 added=0/0
              outmix=0 getlvl1=0/0 getlvl2=0/0
secmem usage: 0/0 bytes in 0/0 blocks of pool 0/16384

@_date: 2006-06-15 09:26:30
@_author: Ralf Hauser 
@_subject: how to authenticate an ldaps keyserver lookup 
Thanks - your hint on v1.4.3 solved the bind problem.
Since I didn't find a 1.4.3 version for Linux or windows with TLS support enabled, I am doing my other experiments with cygwin 1.4.2 version (without the bind).
The "unknown_ca" error (reported in the above issue tracker 185) I saw on the server (directory.apache.org) side apparently was issued by the gpg client.
For other ldapclients such as EQ or command-line ldapsearch, we solved that by creating a ~/.ldaprc file and either adding the server key with
   TLS_CACERT /path/to/cacert.pem
or reducing the protection by adding
   TLS_REQCERT never
Unfortunately, with gpg, this did not help. Putting the same into /etc/ldap/ldap.conf as per  didn't do it either.
So my log now is:
Ralf Hauser gpg.1.4.2.1 --keyserver ldaps://localhost:2636 --keyserver-options 'binddn="dn=micky"' --keyserver-options "debug=5" --keyserver-options bindpw=mouse --search-keys Tes
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: searching for "Test" from ldaps server localhost
gpgkeys: debug level 5
put_filter: "(objectClass=*)"
put_filter: simple
put_simple_filter: "objectClass=*"
ldap_connect_to_host: TCP localhost:2636
ldap_new_socket: 4
ldap_prepare_socket: 4
ldap_connect_to_host: Trying 127.0.0.1:2636
ldap_connect_timeout: fd: 4 tm: -1 async: 0
ldap_ndelay_on: 4
ldap_is_sock_ready: 4
ldap_ndelay_off: 4
TLS trace: SSL_connect:before/connect initialization
TLS trace: SSL_connect:SSLv2/v3 write client hello A
TLS trace: SSL_connect:SSLv3 read server hello A
TLS certificate verification: depth: 0, err: 18, subject: /DC=com/DC=netcetera/emailAddress=vlatkogj issuer: /DC=com/DC=netcetera/emailAddress=vlatkogj
TLS certificate verification: Error, self signed certificate
TLS trace: SSL3 alert write:fatal:unknown CA
TLS trace: SSL_connect:error in SSLv3 read server certificate B
TLS trace: SSL_connect:error in SSLv3 read server certificate B
TLS: can't connect.
put_filter: "(objectClass=*)"
put_filter: simple
put_simple_filter: "objectClass=*"
gpgkeys: unable to retrieve LDAP base: Can't contact LDAP server
gpg: key "Test" not found on keyserver
gpg: keyserver internal error
gpg: keyserver search failed: keyserver error
Any hints would still be highly appreciated
    Ralf

@_date: 2006-06-15 12:13:53
@_author: Ralf Hauser 
@_subject: searching for a key with gpg ldap 
Leaving the TLS/SSL problem from the previous mail aside, with
gpg.1.4.3 --keyserver ldap://localhost:2389 --keyserver-options 'binddn="dn=micky"' --keyserver-options "debug=5" --keyserver-options bindpw=mouse --search-keys Test
on windows, a nice "bind" succeeds and the serverInfo is queried with success.
But then gpg presents:
   filter : '(pgpdisabled=0)
all others (e.g.  however ask for
   filter: (pgpUserID=*test*)
Looking at the below 1.4.2. debug output, it appears that the first half of the query    "(&(pgpuserid=*Test*)(pgpdisabled=0))"
Never reaches my ldap server (directory.apache.org).
So, the questions are:
1) why doesn't gpg ask for the REAL SEARCH STRING ("pgpuserid=*Test*")?
2) what response might my ldap server give to "pgpdisabled=0" to satisfy gpg such that it might ask me also about "*Test*" in a following query.
Unsuccessful attempts are:
  - en empty result causes the gpg client to terminate the search
  - returning an arbitrary keys causes it to present that one and then stop search too
  - listing all keys irrespective of whether they contain "Test" or not is against the policy of our server
Somehow "pgpdisabled=0" to me looks like "dear server, give me all keys you don't consider as disabled"?
On the gpg side, the output of v1.4.3. is:
gpg: searching for "Test" from ldap server localhost
gpgkeys: not built with debugging support
search type is 0, and key is "Test"
gpg: key "Test" not found on keyserver
Any hints are highly appreciated!
   Ralf
P.S.: Version 1.4.2 (cygwin) output is probably more helpful:
Gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: searching for "Test" from ldap server localhost
gpgkeys: debug level 5
put_filter: "(objectClass=*)"
put_filter: simple
put_simple_filter: "objectClass=*"
ldap_connect_to_host: TCP localhost:2389
ldap_new_socket: 4
ldap_prepare_socket: 4
ldap_connect_to_host: Trying 127.0.0.1:2389
ldap_connect_timeout: fd: 4 tm: -1 async: 0
ldap_ndelay_on: 4
ldap_is_sock_ready: 4
ldap_ndelay_off: 4
ldap_open_defconn: successful
ldap_result msgid 1
ldap_chkResponseList for msgid=1, all=1
ldap_chkResponseList returns NULL
wait4msg (infinite timeout), msgid 1
wait4msg continue, msgid 1, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:13 2006
** Outstanding Requests:
 * msgid 1,  origid 1, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
   Empty
ldap_chkResponseList for msgid=1, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 1, all 1
ldap_read: message type search-entry msgid 1, original id 1 wait4msg continue, msgid 1, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:13 2006
** Outstanding Requests:
 * msgid 1,  origid 1, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
 * msgid 1,  type 100
ldap_chkResponseList for msgid=1, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 1, all 1
ldap_read: message type search-result msgid 1, original id 1 new result:  res_errno: 0, res_error: <>, res_matched: <>
read1msg:  0 new referrals
read1msg:  mark request completed, id = 1 request 1 done
res_errno: 0, res_error: <>, res_matched: <> ldap_free_request (origid 1, msgid 1) ldap_free_connection
ldap_free_connection: refcnt 1
adding response id 1 type 101:
put_filter: "(objectClass=*)"
put_filter: simple
put_simple_filter: "objectClass=*"
ldap_result msgid 2
ldap_chkResponseList for msgid=2, all=1
ldap_chkResponseList returns NULL
wait4msg (infinite timeout), msgid 2
wait4msg continue, msgid 2, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:14 2006
** Outstanding Requests:
 * msgid 2,  origid 2, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
   Empty
ldap_chkResponseList for msgid=2, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 2, all 1
ldap_read: message type search-result msgid 2, original id 2 ldap_chase_referrals
read1msg:  V2 referral chased, mark request completed, id = 2 new result:  res_errno: 32, res_error: , res_matched: read1msg:  0 new referrals
read1msg:  mark request completed, id = 2 request 2 done
res_errno: 32, res_error: , res_matched:  ldap_free_request (origid 2, msgid 2) ldap_free_connection
ldap_free_connection: refcnt 1
put_filter: "(objectClass=*)"
put_filter: simple
put_simple_filter: "objectClass=*"
ldap_result msgid 3
ldap_chkResponseList for msgid=3, all=1
ldap_chkResponseList returns NULL
wait4msg (infinite timeout), msgid 3
wait4msg continue, msgid 3, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:14 2006
** Outstanding Requests:
 * msgid 3,  origid 3, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
   Empty
ldap_chkResponseList for msgid=3, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 3, all 1
ldap_read: message type search-entry msgid 3, original id 3 wait4msg continue, msgid 3, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:14 2006
** Outstanding Requests:
 * msgid 3,  origid 3, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
 * msgid 3,  type 100
ldap_chkResponseList for msgid=3, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 3, all 1
ldap_read: message type search-result msgid 3, original id 3 new result:  res_errno: 0, res_error: <>, res_matched: <>
read1msg:  0 new referrals
read1msg:  mark request completed, id = 3 request 3 done
res_errno: 0, res_error: <>, res_matched: <> ldap_free_request (origid 3, msgid 3) ldap_free_connection
ldap_free_connection: refcnt 1
adding response id 3 type 101:
put_filter: "(&(pgpuserid=*Test*)(pgpdisabled=0))"
put_filter: AND
put_filter_list "(pgpuserid=*Test*)(pgpdisabled=0)"
put_filter: "(pgpuserid=*Test*)"
put_filter: simple
put_simple_filter: "pgpuserid=*Test*"
put_substring_filter "pgpuserid=*Test*"
put_filter: "(pgpdisabled=0)"
put_filter: simple
put_simple_filter: "pgpdisabled=0"
ldap_result msgid 4
ldap_chkResponseList for msgid=4, all=1
ldap_chkResponseList returns NULL
wait4msg (infinite timeout), msgid 4
wait4msg continue, msgid 4, all 1
** Connections:
* host: localhost  port: 2389  (default)
  refcnt: 2  status: Connected
  last used: Thu Jun 15 07:41:14 2006
** Outstanding Requests:
 * msgid 4,  origid 4, status InProgress
   outstanding referrals 0, parent count 0
** Response Queue:
   Empty
ldap_chkResponseList for msgid=4, all=1
ldap_chkResponseList returns NULL
read1msg: msgid 4, all 1
ldap_read: message type search-result msgid 4, original id 4 new result:  res_errno: 0, res_error: <>, res_matched: <>
read1msg:  0 new referrals
read1msg:  mark request completed, id = 4 request 4 done
res_errno: 0, res_error: <>, res_matched: <> ldap_free_request (origid 4, msgid 4) ldap_free_connection
ldap_free_connection: refcnt 1
gpg: key "Test" not found on keyserver
