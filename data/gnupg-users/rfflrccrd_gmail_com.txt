
@_date: 2012-02-07 01:09:37
@_author: Raffaele Ricciardi 
@_subject: GPG2 hangs the system if I activate another window 
I've downloaded and compiled GPG2 on Debian Linux (Gnome).
When GPG2 opens a popup to ask for a password, I can't switch to another window without locking up the desktop.  Neither the mouse nor any key works anymore, not even the power button, and I have to keep it pressed for 6 seconds to force power-off.
Is there any way around this? I need to switch to another window because I keep my passwords in a password database application I may need to open, and on a laptop with a touchpad, a click can be fired off inadvertently anyway.
- gpg (GnuPG) 2.0.17
- libgcrypt 1.4.5
- Debian GNU/Linux version: 6.0.3
- Kernel version: Linux debian 2.6.32-5-686  SMP Wed Jan 11 12:29:30 UTC 2012 i686 GNU/Linux

@_date: 2012-02-08 22:15:51
@_author: Raffaele Ricciardi 
@_subject: GPG2 hangs the system if I activate another window 
> Date: Tue, 07 Feb 2012 10:11:33 +0000
 > From: gnupg at lists.grepular.com
 > To: gnupg-users at gnupg.org
 > Subject: Re: GPG2 hangs the system if I activate another window
 > Message-ID: <4F30F8D5.8070107 at lists.grepular.com>
 > Content-Type: text/plain; charset=ISO-8859-1
 >
 > -----BEGIN PGP SIGNED MESSAGE-----
 > Hash: SHA1
 >
 >
 > > I've downloaded and compiled GPG2 on Debian Linux (Gnome).
 > >
 > > When GPG2 opens a popup to ask for a password, I can't switch to
 > > another window without locking up the desktop.  Neither the mouse
 > > nor any key works anymore, not even the power button, and I have to
 > > keep it pressed for 6 seconds to force power-off.
 > >
 > > Is there any way around this? I need to switch to another window
 > > because I keep my passwords in a password database application I
 > > may need to open, and on a laptop with a touchpad, a click can be
 > > fired off inadvertently anyway.
 > I think this is by design. See the following option in the man page
 > for gpg-agent and make sure you understand the security implications
 > before using it:
 >
 > - --no-grab: Tell the pinentry not to grab the keyboard and mouse.  This
 > option should in general not be used to avoid X-sniffing attacks.
Thank you for the tip about looking into the help for gpg-agent (I was into that for gpg2).
It seems GPG2 on my system is running Seahorse, a Gnome front end for GnuPG:
That's the reason this other user, who is running XFCE instead of Gnome, is not
experiencing my same issue:
 > Date: Tue, 07 Feb 2012 15:31:58 +0100
 > From: peter at digitalbrains.com (Peter Lebbing)
 > To: gnupg-users at gnupg.org
 > Subject: Re: GPG2 hangs the system if I activate another window
 > Message-ID: <4F3135DE.8020007 at digitalbrains.com>
 > Content-Type: text/plain; charset=UTF-8
 >
 > >> When GPG2 opens a popup to ask for a password, I can't switch to
 > >> another window without locking up the desktop.  Neither the mouse
 > >> nor any key works anymore, not even the power button, and I have to
 > >> keep it pressed for 6 seconds to force power-off.
 > > I think this is by design.
 > Locking up seems a bit harsh . Here, on XFCE with Debian testing, my  > definitely does not lock up. I can press some buttons with the mouse, but I
 > can't type any text in any other window than the password input dialog. But at
 > no point do I lose control, and once I dismiss the password dialog, I can
 > continue using my computer. This would be the "design" I expected .
 >
 > That said, if you want to pass the password from a password database
 > application, you probably indeed need --no-grab, and that might solve the
 > locking problem as a byproduct.
I'll investigate the issue further.  Since in my case GPG2 is being invoked by another
application (Emacs), this is not straightforward.
Thank you guys for your support.

@_date: 2012-02-09 19:23:06
@_author: Raffaele Ricciardi 
@_subject: GPG2 hangs the system if I activate another window 
> On Wed,  8 Feb 2012 23:15, rfflrccrd at gmail.com said:
 >
 >> It seems GPG2 on my system is running Seahorse, a Gnome front end for GnuPG:
 >>
 >> GPG_AGENT_INFO=/tmp/seahorse-PDdgFx/S.gpg-agent:2402:1
 >>
 >
 > Seahorse and gnome-keyring are hijacking the gpg-agent connection.  It
 > is a source of constant frustration.  You can configure gnome-keyring
 > not to badly emulate some gpg-agent functions.
Thanks for your suggestion.
I'd like to do without both Seahorse and gnome-keyring.  I don't need them because
in my case passwords are managed by another application anyway.
I've tried replacing Seahorse with pinentry-gtk-2, which I've found on my system, but currently I've managed to have just a pinentry-gtk-2 popup window flashing for
an instant and then GPG failing.  Here is what I've done:
- cleared the GPG_AGENT_INFO environment variable, which avoids my running GPG2 with the --use-agent option;
- created ~/.gnupg/gpg.conf with this content:
- following directions given here:
I've created a ~/bin/gpg-agent.sh (instead of a ran it, and checked that gpg-agent was running.  Then I've created a
~/.gnupg/gpg-agent.conf with this content:
pinentry-program /usr/bin/pinentry-gtk-2
That's it.
Any suggestion?  Thanks.
