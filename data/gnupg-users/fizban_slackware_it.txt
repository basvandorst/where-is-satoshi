
@_date: 2005-09-03 02:35:45
@_author: Andreas Liebschner 
@_subject: OpenPGP card and gpg-agent --enable-ssh-support 
I own a OpenPGP Card, I run gnupg-1.4.2 + gnupg-1.9.18 (so I have gpg1,
gpg-agent, scdaemon, gpgkey2ssh). I started playing with the card today,
but I had no problems at all, beside when trying to use the "A" key
stored on the card in addition to 'gpg-agent --enable-ssh-support'.
This is what I tried:
$ gpgkey2ssh $ID_OF_THE_A_KEY > key
$ scp key user
[login to box]
$ mv key .ssh/authorized_keys
Also, since I thought ssh-add was of no use in my case, I touch'd
.gnupg/sshcontrol (on the box gpg-agent is running from), and added the
fingerprint of the A key stored on my card.
Then I tried:
$ ssh box
But it still asks me the actual password for the user, not the pin or
the passphrase of my gpg key. So I thought I should have added some
other fingerprint to sshcontrol, and added the 2 remaining fingerprints.
Still, it will always ask me the actual password.
So I thought gpg-agent wasn't running properly, and I created
(ssh-keygen) a keypair on the fly, added with "ssh-add", scp'd the
public key to "box". ssh to box went as it was supposed to go; so
gpg-agent is going working just fine, I guess.
Well, then I'm doing something wrong when trying to use the "A" key
stored on my card? If so, what's the right way to do it, any hint?
Also, I noticed gpgkey2ssh will always produce a ssh-rsa key, even if I
pass it the CS or the E key, is this normal?

@_date: 2005-09-03 12:04:02
@_author: Andreas Liebschner 
@_subject: OpenPGP card and gpg-agent --enable-ssh-support 
Oh that's true, it works.. I used gpgkey2ssh because I saw a post from
may where you were talking about creating such a tool
Well thank you, it's working just fine!

@_date: 2005-09-09 12:48:14
@_author: Andreas Liebschner 
@_subject: Open PGP cards and backup 
I'm still playing with my card ;-)
Just in case my fellowship card breaks up, I wanted to test the
bkuptocard process. So I stick another openpgp card in the reader and
--edit my key, run bkuptocard /path/to/sk_*.gpg
Apparently it successfully imports it, but however I still see the old
card' s/n under "General key info..:". In fact, I can't sign anything
because I'm asked for the other card. (I obviousy save before quitting gpg)
I the tried to "addcardkey", and it creates the new subkey on the new
card, however I'm always asked for the old one, to sign the new key I
guess. The newly created key gets properly marked as "being on" the new
So, am I doing something wrong? For what I could understand from the man
pages, it should update that kind of information, so that I could use
this new card with the old backed up key. I also tried keytocard, but it
fails stating that a secret key is already on the card (which is true,
but shouldn't I be able to change the secret key like that, if I enter
my pins and all?)
And, is there any way for someone to "empty" the card from all the keys
stored, after entering the admin pin or something? If it isn't possible,
is it a "missing feature", or an actual feature?
