
@_date: 2004-07-16 11:07:52
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
I just used kgpg to create a key pair on Suse 9.1, which uses UTF8 encoding, and it works fine.
I imported a key pair I made last year on Suse 8.2, which used an 8859 encoding, and I can't enter a valid passphrase.  Or rather the key pair was already present, I think.
The same applies to two sets of keys on a floppy key ring made by PGP 5.0 back in 1998,  One was made by 5.0, and the other was imported from 2.6 way back when.  That was on a Windows machine.
Can anyone explain what is going on?  I think it is a UTF8 issue.  I'm just getting started on gpg and kgpg after a long absense.

@_date: 2004-07-22 17:24:39
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
I just used kgpg to create a key pair on Suse 9.1, which uses UTF8 encoding, and it works fine.
I imported a key pair I made last year on Suse 8.2, which used an 8859 encoding, and I can't enter a valid passphrase.  Or rather the key pair was already present, I think.
The same applies to two sets of keys on a floppy key ring made by PGP 5.0 back in 1998,  One was made by 5.0, and the other was imported from 2.6 way back when.  That was on a Windows machine.
Can anyone explain what is going on?  I think it is a UTF8 issue.  I'm just getting started on gpg and kgpg after a long absense.

@_date: 2004-07-22 19:51:46
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
It should all be in the ASCII range.  It doesn't appear that UTF-8 should be the problem, but it was the only thing I could think of, and I don't believe I clearly understand everything the gpg man page has to say about character sets.  When did gpg make the switch to UTF internal encoding?  Would it be a problem if gpg inherited keyrings from before the switch?  The two Windows keys were imported by directly reading *.pgp, *.pkr. and *.skr files.  The key from last year resided in a *.gpg file that the current gpg simply inherited during the latest system upgrade.
I currently have one home computer.  Two of the keys were created under kgpg; only the last one under the the UTF8 environment, and that's the one that works.  The two old ones were created under Windows in about 1998.  They fail the same way as the kgpg one from last year, passphrase not accepted.  As I quickly ran into limits using kgpg and/or wasn't sure it wasn't interfering, I tried gpg --edit-key with adduid to produce the failures as well as the success.
I've checked it as carefully as I know how.  It is a quote from a book, the same for all keys.
I used the one from pgp 5.0 quite regularly in 1998; the one from 2.6 and
last year's gpg one were just experiments.
Just tried that.  :-)
Just tried that (^M and ^J), too.  It appears they are treated just like enter, terminating the sequence.  I don't know the significance of ^V; in any case I didn't use it, and I have only printable ASCII characters in the passphrase.
I'll try turning off UTF-8 systemwide once I figure out how.  There is supposed to be a script to do it which I just have to find and read about.
The old ones are on public servers as 0xD2E6A4B8, and 0xBC0E8015.  The new ones are privately held for now.

@_date: 2004-07-23 03:07:41
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
I had to get and install pgpdump.  I don't have IDEA but it appears that
should only affect the 2.6 key (and see note below).
E4042B72 Created 2004-07-09 with UTF system DSA Sym alg - CAST5(sym 3)
o  This works for signing and for adduid.
07cf11c6 Created 2003-09-16 under Linux/8859 DSA Sym alg - CAST5(sym 3)
o   Passphrase no good for signing or adduid.  I think I should
concentrate on this one and figure out why the passphrase isn't
d2e6a4b8 Created 1998-06-23 with Windows/PGP5 DSA Sym alg - CAST5(sym 3)
o   Passphrase no good.  If I can get 07cf11c6 to work, this one should
bc0e8015 Created 1998-07-04 with Windows/2.6 RSA Sym alg - IDEA(sym 1)
o   This is the only one that uses IDEA.  If I understand correctly, I
will need the IDEA module to revoke it, presuming I can get the
passphrase working even so.  Revoking would be sufficient.  Actually, I
still have 2.6.2, Linux version instead of Windows version, but I
suppose I would have to export/import to get a working key ring?
More reading....

@_date: 2004-07-23 22:06:56
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
Passwd fails the same way as adduid.  Jumping ahead a bit by showing the
edit attempt on the exported version:
tom gpg --home ~/gpg-junk/ --edit-key 07cf11c6
gpg: WARNING: unsafe permissions on homedir "/home/tom/gpg-junk/"
gpg (GnuPG) 1.2.4; Copyright (C) 2003 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
Secret key is available.
gpg: checking the trustdb
gpg: no ultimately trusted keys found
pub  1024D/07CF11C6  created: 2003-09-16 expires: never      trust: -/-
sub  1024g/4EA3E9C5  created: 2003-09-16 expires: never
(1). Tom Hardy Command> passwd
Key is protected.
You need a passphrase to unlock the secret key for
user: "Tom Hardy "
1024-bit DSA key, ID 07CF11C6, created 2003-09-16
gpg: Invalid passphrase; please try again ...
You need a passphrase to unlock the secret key for
user: "Tom Hardy "
1024-bit DSA key, ID 07CF11C6, created 2003-09-16
gpg: Invalid passphrase; please try again ...
You need a passphrase to unlock the secret key for
user: "Tom Hardy "
1024-bit DSA key, ID 07CF11C6, created 2003-09-16
Can't edit this key: bad passphrase
Command> q
~/gpg-junk, as shown above.
Interesting thing here, when I tried pasting and editing your example I
got stuff like this:
tom gpg?--export?{07cf11c6}?|?gpg?--home?~/gpg-junk?--import
bash: gpg?--export?{07cf11c6}?: command not found
bash: ?gpg?--home?~/gpg-junk?--import: No such file or directory
But when I typed it all directly, it worked.  Shows, I guess, that
character encoding can be non-obvious.  I have your mail available on a
news spool.  I opened it in a hex editor and the relevant part is all
ASCII; spaces are 0x20.  I copied my pasted version into the hex
editor; spaces are 0xa0.  I copied my typed version in and spaces are
0x20.  I'm not sure of the significance, but I do suspect I am having
problems with the encoding, after all.
As shown above.  I tried both before and after exporting; same result.
No.  I used mostly lowercase, some uppercase, some punctuation, all
ASCII.  I don't think I've forgotten the passphrase.  Or do you mean
gpg could have lost the passphrase?  If so, I still have the original
PGP 5 keyrings on a DOS formatted floppy, and I've never used the GPG
one from last year, so I could just get rid of it, but it could be
helpful in working out what is going on.  I'll keep it for now.
I also found a script, /bin/unicode_stop.  Tried it and it made no
difference, but here it is anyway:
# stop unicode
case $TTY in
        /dev/console|/dev/tty[0-9]*)
                ;;
        *)
                echo "unicode_stop skipped on $TTY"
                exit 0
                ;;
kbd_mode -a
echo -n -e '\033%
# "dumpkeys | loadkeys --unicode" which is called in "unicode_start"
# cannot be reverted, therefore we have to load the keyboard mapping
# if it could be sucessfully saved in "unicode_start":
test -r $HOME/.kbd/.keymap_sv && loadkeys $HOME/.kbd/.keymap_sv

@_date: 2004-07-24 00:46:33
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
Ulp!  Well it was non-obvious when I sent it off, and when it came back
to me too.  0xA0, or no-break space in 8859-1 on my news spool, and
which ain't even supposed be possible under UTF-8--it indicates a
continuation byte.
Mutt shows it as "??", two bytes.  I can't wait to see what Mutt says
you said.  (I get the digest.)
You quoted me with 0xFFFF, another impossible UTF encoding, or a pair of
"y"'s with diaeresis under 8859-1, on my news spool.
Yup.  The matter is still not explained, but the next step is obvious...
Well, I can still boot into Win98--I guess I need to dig up a copy of
PGP or GPG for it.  And then to send some feedback to Suse, depending
on how things go.

@_date: 2004-07-24 03:42:47
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
I just downloaded PGP 5.0 source and binary RPM's from somewhere on the
net.  :-)  Haven't done anything with them--don't know I can trust 'em.
Do you have anything like an official source for PGP for linux?
On the other hand, I'm pretty sure I have PGP 5.0 for Windows around
here somewhere, I'll just have to rummage around for it.

@_date: 2004-08-02 16:18:26
@_author: Tom Hardy 
@_subject: UTF8 passphrase problem (I think) 
Just a note--I have a Windows copy of PGP 5 and intend to try resetting
passphrases next time I reboot, and also to learn a bit more about
UTF-8 and the current situation, but due to a suddenly hectic schedule
I'll delay it for at least a week.  Besides, I hate rebooting.  :-)
I'll be sure to report back the results.
