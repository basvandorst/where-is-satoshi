
@_date: 2011-04-13 13:13:14
@_author: Todd A. Jacobs 
@_subject: GitHub project for adding udev rules 
A month or so ago, I bumped into the fact that the howto on gnupg.org was a
bit outdated, and didn't really cover proper use of udev or libccid on
Debian and Ubuntu. So, I threw together a little howto of my own, and
bundled it with a new udev rules file and a helper script for generating new
udev rules for PC/SC readers.
If you have some known-good PC/SC device IDs that don't respond with the
generic bInterfaceClass, please feel free to submit a pull request and I'll
add the rules. Hopefully, this will make it easier for people to use crypto
cards on Debian-derived distributions in the future.

@_date: 2011-04-15 23:47:34
@_author: Todd A. Jacobs 
@_subject: Allowing paste into pinentry-gtk-2? 
Currently, it looks like pinentry-gtk-2 (I'm using 0.8.0) doesn't allow
pasting from the clipboard. This is annoying, because a truly long,
randomized password is not practical to type into a hidden dialog box. It
really seems like pinentry forces one to use short, insecure passwords. One
supposes there is a trade-off in security here, but I'm more concerned about
brute-force attacks on the passphrase than I am about someone sniffing the
clipboard--it seems that if they have access to my clipboard, they can
probably log my keystrokes, anyway, right? So offline attacks against the
key's passphrase seem more likely.
So, I really have two questions. First, is it possible to force pinentry
dialogs to allow pasting from the clipboard? Secondly, is it possible to
force the CLI to use an alternate pinentry (say, pinentry-curses) or some
other method to populate an existing gpg-agent with a cached passphrase?

@_date: 2011-04-16 19:56:59
@_author: Todd A. Jacobs 
@_subject: [OT] passphrases Was: Re: Allowing paste into pinentry-gtk-2? 
So, no common prefixes, suffixes, or parts of words? No syntactical
regularities, such as punctuation at the end of a sentence? No
language-specific dipthongs, digraphs, etc? No regular substitutions
(e.g. 3 for E)? So on and so forth. :)
While I'm not disputing that you've created a reasonably strong
passphrase, my original point was that any passphrase that isn't fully
random has a reduced keyspace. I'm not enough of a mathemagician to
say how much it's reduced, but it's certainly reduced by a non-zero
    Th qk brwn fx jmpd vr th lz dg.
None of the words are in an English language dictionary, but I can't
imagine anyone saying this would be resistant to a dictionary attack,
since any good cryptographic dictionary would probably take such
regular transformations into account. At 32 characters, it's certainly
random enough to stump a human's brute force attempts, but I wouldn't
hold it up as the gold standard for protecting cryptographic keys.

@_date: 2011-04-17 08:11:17
@_author: Todd A. Jacobs 
@_subject: GPG not retrieving keys when verifying 
I'm not sure how I'm supposed to get GPG to automatically retrieve
keys for signatures when validating a key. I'm currently running:
    gpg --keyserver-options auto-key-retrieve -kvv FBB75451
which doesn't do what I expect. I get a whole bunch of [User ID not
found] messages, when what I expected was that keys matching those
signatures would be retrieved from the keyserver.
What am I doing wrong here?

@_date: 2011-04-18 14:32:56
@_author: Todd A. Jacobs 
@_subject: [OT] passphrases Was: Re: Allowing paste into pinentry-gtk-2? 
Yes, well, that would mean that a 32-character English passphrase will
average about 64 bits of randomness. Is that really enough to protect
a key from an offline brute force attack? I think not, but am open to
being persuaded. :)

@_date: 2011-04-19 01:38:20
@_author: Todd A. Jacobs 
@_subject: [OT] passphrases Was: Re: Allowing paste into pinentry-gtk-2? 
There's still a big difference between trying to brute-force a
cryptographically-strong 64-bit key, and applying dictionary attacks
against against an English-based passphrase. If I recall correctly,
none of the attacks you mentioned attacked the passphrase protecting a
secret key (which is what we're talking about); rather, they were
attempts to recover plaintext in the *absence* of the secret key by
trying all possible decryption keys within the keyspace.
In short, I believe the context is different, and that passphrase
attacks against the secret key are vulnerable in a way that attacks on
ciphertext are not.

@_date: 2012-02-25 08:43:38
@_author: Todd A. Jacobs 
@_subject: Problems loading an authentication key from a USB Crypto-Stick 
I'm using GnuPG 1.4.11 on Ubuntu 11.10, and have a Crypto-Stick v1.2 with
an authentication key. My desktop is LXDE, but I'm starting gpg-agent using
keychain from my ~/.bashrc. My configuration files look like this:
# ~/.bashrc
eval `keychain --eval --agents gpg,ssh id_rsa BCB6C8D4`
# ~/.gnupg/gpg-agent.conf
pinentry-program /usr/bin/pinentry-curses
However, while the ssh key gets loaded properly into the agent, I am
prompted for the password for the GPG key every time I start a new
shell--the agent isn't storing the key. In addition, "ssh-add -L" isn't
showing the GPG authentication key as being loaded. So, the pinentry dialog
thinks I've unlocked the key, but gpg-agent and ssh-agent aren't happy.
The agent itself seems to be running:
$ gpg-connect-agent 'GETINFO pid' /bye
D 2579
and I can see the card status just fine with the "gpg --card-status"
So, what could be going wrong here?

@_date: 2012-02-25 08:57:29
@_author: Todd A. Jacobs 
@_subject: Encrypted large files cant decrypt 
I'd suggest re-writing your script so that you can validate that the
archive is valid and decryptable *locally* before doing anything over the
network. The problem could be anywhere in the pipeline, the network, or the
remote server, so you really need to break this into pieces for testing.
At a minimum, I'd suggest setting your shell options as follows:
set -e
set -o pipefail
to make sure that you aren't having problems somewhere in the process
pipeline. If that doesn't work for you, then you just need to go back to
basics and test each stage of your archiving and transfer independently.

@_date: 2012-02-26 11:50:15
@_author: Todd A. Jacobs 
@_subject: Problems loading an authentication key from a USB Crypto-Stick 
With keychain 2.6.8 (and possibly others) the agents won't start properly
if actually specified, so taking out the agents option actually allows
gpg-agent to start, while also handling the ssh-agent keys. One also needs
to add the --quick option to avoid being prompted for the gpg key's
passwords each time. So:
eval `keychain --quick --ignore-missing --eval id_rsa BCB6C8D4`
*mostly* works, but the gpg-agent is still not being consulted for signing.
Even if one kills all agents and the scdaemon, and uses "eval $(gpg-agent
--daemon)" instead, the agent refuses to consult the cache when signing.
$ gpg-agent --version
gpg-agent (GnuPG) 2.0.17
libgcrypt 1.5.0
$ echo $GPG_AGENT_INFO
# Prompts twice for password to clearsign.
echo foo | gpg --clearsign; echo foo | gpg --clearsign
So, the keychain problem seems to be resolved, in that gpg-agent is now
reading the SSH authentication key off the CryptoStick and handing it off
to ssh-agent, but gpg-agent is still not caching passphrases for signing
activities, which seems rather critical to its usefulness. :)
What else can I do to help debug this?

@_date: 2012-03-03 16:16:14
@_author: Todd A. Jacobs 
@_subject: Problems loading an authentication key from a USB Crypto-Stick 
This problem was actually being caused by settings on the smartcard itself.
The "Signature PIN" of a new CryptoStick (and the OpenPGP smartcards in
general) seems to default to a forced PIN entry on signing, which prevents
the gpg-agent from cached authentication of signature tasks.
So, to fix this:
gpg2 --card-edit -> admin -> forcesig
and then make sure that:
gpg2 --card-status | egrep '^Signature PIN.*not forced$'
is true. Hope that helps someone else out, too!

@_date: 2012-03-03 18:20:11
@_author: Todd A. Jacobs 
@_subject: Using Smartcards without it's public key 
On Sat, Mar 3, 2012 at 4:23 PM, Hauke Laging
I *think* this is either because the key lookup is happening on the public
key first, before checking for the matching secret key, or because the
stubs aren't being created right in the keyrings. I am having a similar
problem with signing, even though I've explicitly imported my public key
into the public keyring (using --import, rather than --edit-card), and have
the secret key on a cryptostick.
If you figure out what's going on, it will probably help me, too. :)

@_date: 2012-03-03 18:15:54
@_author: Todd A. Jacobs 
@_subject: Using Smartcards without it's public key 
Should it be necessary to use the card-edit menu? I tried something
similar, realized I needed the public key, but didn't get any success
importing the public key from the command-line and then trying to use the
card: I still get a kind of key not found error (I don't have the exact
error in front of me at the moment).
So, it seems like the key needs to be fetched from card-edit in order to
create the right smartcard stubs. Is that right?
