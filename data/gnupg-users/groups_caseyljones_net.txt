
@_date: 2007-05-14 01:44:51
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
Does anyone know of software available to make an old PC into something like a hardware security module. OpenHSM.org looks like what I want, but the site says they're still in the design phase, and the last update was in 2004.
I can't stand the thought of storing my private key on my main computer. I use my main computer for things like web browsing and email, which I think puts its security in serious jeopardy. I think a separate computer which has only a single function, would be a valuable increase in security.
I've been considering getting an OpenPGP Card, but there are three reasons I'm reluctant to. The main one is that I want something that will only do one signature or decryption at a time. That way if my machine is compromised, I'll only suffer one hit before I'll notice something's wrong. Can the OpenPGP Card be set to do one operation per pin entry when used with a card reader that has a keypad? This seems like such a useful feature to me that I'm surprised smart card manufacturers don't embed little buttons near the edge of the smart card. The second reason is that I generally prefer open source security software. It seems the OpenPGP Card relies on the proprietary BasicCard operating system. Finally, it looks like the OpenPGP Card costs about 26.4 Euros (about $36) shipped from Europe. That's a little high for me right now.
There are two other minor issues. I'd prefer my keys be encrypted when not in use, so that if my device falls into the wrong hands, I won't have to worry too much. Does the OpenPGP Card encrypt the keys while stored on the card?
Also, the OpenPGP Card appears to be from a german organization, like the one that developed the Java Anonymous Proxy, and was forced by the german government to back door the software. Does the german government still consider it legal to force programmers to back door their software? I heard they were appealing it, but I never heard how that all turned out. With governments accusing each other of stealing proprietary info and such, I think I'd like to just keep my private key private. Does anyone know if any other democratic governments consider it legal to force programmers to incorporate back doors?

@_date: 2007-05-14 05:14:22
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
Basically I'm looking for something that does what the OpenPGP Card does, but with a button to limit signatures and decryptions. It could be implemented as just an application on a regular operating system running on a dedicated computer. I'm not willing to pay for something with intricate physical anti-tampering protection like the typical professional HSMs. I might try making a variation of the open-openpgp-card. My version might be USB or it might be like one of those homemade smart cards that are longer than a regular smart card so they can use a regular thickness microcontroller sticking out on the end. One like that would have room for a button. It would also save me having to boot a separate computer when I wanted to use it.
It seems to me that there is a very significant chance that my system could get owned some time. I don't think it takes much more than a zero day exploit in Firefox combined with a visit to the wrong site to get rooted. An exploit for Thunderbird in an email could also do it. Or worse, a buffer overflow in the tcp/ip stack like the one in OpenBSD recently. I don't know, but I'd think it would be common practice for a root kit to install a keylogger and to send off copies of the private keys. Does that threat model make me paranoid? I don't think it does, but then paranoids often can't tell.
The OpenPGP Card is a valuable addition to security. But even with the OpenPGP Card, everything encrypted to your key on your computer could be exposed, even by an automated rootkit. And if you get targeted personally, signatures could be made from your key without your Yes, smart cards have pretty decent tamper protection for a low security application like mine. Although when I read Kommerling and Kuhn's 1999 I was a little surprised how easily lightly-protected dies can be I suspected by his name that he was German. I thought he might be well informed on the issue, and would comment. I'm not too worried about GnuPG because it's open source. But apparently the OpenPGP Card isn't.
What makes you think the German government won't order the OpenPGP Card to be compromised? Either by FSFE or by ZeitControl. Hopefully they've got a law, or at least court precedent against that now.
I heard the EU accused the US of using Echelon to steal designs for windmills. I wouldn't be surprised if lots of countries do such things.

@_date: 2007-05-14 05:28:40
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
Yes, I'll probably do something like that for a while. It's less convenient because I'll have to be transferring files back and forth manually. But if used with a removeable drive, it would probably be more secure than having it plugged into my main computer by ethernet or serial cable. Especially if I compose and read encrypted messages on it as well.

@_date: 2007-05-14 07:15:10
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
That sounds great. If I understand correctly, you rarely need to use the admin PIN, so it would be unlikely to be compromised. For example you could use the admin pin only after booting from a CD.
  >> not in use, so that if my device falls into the wrong hands, I won't
Why doesn't it make sense? The chip's security features make it fairly secure. But having the keys encrypted on the card would make it highly secure. As long as the passphrase hadn't been captured, like after being lost, stolen, or confiscated.
Can the person who loads the software onto the cards be given orders by the German court?
OK, not backdoored, just compromised.
According to this article
it was mandated by the courts.
     ...the JAP team replied to the thread, admitting
      that there is now a "crime detection function" in
      the system mandated by the courts. But they
      defended their decision:
     "What was the alternative? Shutting down the
      service? The security apparatchiks would have
      appreciated that - anonymity in the Internet
      and especially AN.ON are a thorn in their
      side anyway."
Are the authors of the Java Anonymous Proxy not sane? If they would do it, why not ZeitControl?
What will you do if the court orders you to turn on logging, hand over the logs, and keep it secret?

@_date: 2007-05-14 18:48:20
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
The attack that I'm referring to here which the PIN pad is meant to prevent, is only the unlimited use of the smart card. An attacker can still make a signature or decrypt something, but only one for each time you enter a PIN on the PIN pad(or press the authorize button if something like that exists). Soon you would notice that what you wanted signed or decrypted wasn't getting signed or decrypted, or was done wrong.
I just thought of another feature. The card could require that you enter what operation you wanted performed on the PIN pad. For example if you want a signature, you enter a one before you enter the PIN. The card could check that in fact gpg has requested a signature and not a decryption. Before a decryption enter a two. This would limit the attacker not only in the number of unauthorized uses but in the type as

@_date: 2007-05-14 23:01:54
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
I thought most people kept their private keys encrypted with a long passphrase on their hard drives anyway. Since memorizing a 128bit decimal passphrase would be impractical, I envision entering the passphrase on your keyboard, which would be sent to the card to decrypt the key, then entering a short PIN on the PIN pad as well. If someone had already rooted your computer before physically stealing your card, then you would be defeated.
But it seems to me there are a small but significant possibility of situations where someone hostile might get possession of your card but not have rooted your computer. Your card might be confiscated at a border crossing for example. Or you might get arrested by mistake or for something minor, and loose possession of your card for a while. A lot of governments might be able to trivially crack smart card security. The local police might overnight it to the feds for a quick key extraction. Organized criminals might have no problem cracking it either. A pickpocket might sell it to some mobsters for industrial espionage or to ransom back to you.
Encrypting the key on card seems to me like a minor inconvenience for a significant security enhancement. I'd say it's worthwhile even for a low security situation.
Apparently every copy of the JAP was modified. Why not every BasicCard or every OpenPGP Card, in order to target a single individual?
At    "the ICPP received a judicial instruction
    by the Local Court (Amtsgericht) Frankfurt
    / Main, Germany, by which the collaborators
    of the research project AN.ON were bound
    to record all access to a particular IP address"
Were they forced, or did they lie, or what? How did their appeal go?
I don't think that qualifies as insane. You may have a misunderstanding of the definition of the word insane or perhaps you're just exaggerating. But even if it is insane, if the JAP developers are that insane, why not ZeitControl also?
The only advantage of the smart card is that it makes extraction of the private key impractical (hopefully). Therefore an embedded exploit would probably be just an alternative master PIN and a way to dump the memory.
The developers of open source privacy software are probably generally highly resistant to the compromise of their work. And if the exploit is revealed, they probably won't loose their job or company. But a company would probably be much more motivated to keep such a court order secret, for fear of having their business ruined if they should be found out. If the software is closed source, there's a good chance they could keep it That's a serious concern. Especially for machines made in china and some other places. The only small comfort I used to have was that I thought governments wouldn't risk ruining their software and electronics industry by forcing them to implant such things. But amazingly Germany seems willing to do this. It's one thing for the government itself to put bugs in only the items used by their targets, but to force others to   install secret compromises in every item released, casts doubt on all the products of the entire nation. I would think that the software manufacturers would insist on a law being made to say that the government couldn't force developers to participate in such secret exploits. A strong and clear ruling by the courts might be sufficient.
I was wondering what you would do if the government required you to secretly log passphrases in gpg, or implant some other compromise. You say that you would go to jail before complying with the court order? I have no reason to doubt your integrity personally, I expect that you are an honorable person. But how can we be confident? Luckily gpg is open source, so we can verify for ourselves. Unfortunately the OpenPGP Card

@_date: 2007-05-15 01:24:47
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
But how do you know they didn't use quantum mechanics to compromise the silicon atoms?
Seriously though, that's a classic paper but what are you saying? If you're using gpg then you're not trusting nothing. It would be pointless to use gpg if you haven't decided that it is worthy of at least some significant level of trust. Is it not legitimate then to discuss what level of trust it deserves and what level of trust is sufficient for what purpose?
Often times it is worth it to put trust in something even if it isn't as trustworthy as you would like. The people that were using the Java Anonymous Proxy may have decided that the benefits outweighed the risks. If JAP users had known that the German government could legally compel the JAP developers to secretly compromise the system, would that be a significant factor in deciding whether to use it or use something else?
If the German government can legally compel the distributors of the OpenPGP Card to secretly compromise it, would that be a significant consideration in deciding whether to use it or switch to something open source? Is it really unreasonable of me to ask such questions?

@_date: 2007-05-15 04:39:33
@_author: Casey Jones 
@_subject: Printing Keys and using OCR. 
The wiki page on barcodes
has a list of 2d barcodes including one proprietary one that can store 1MB of data per page. One funny application they suggested for it on their website was to print a sound file of how to pronounce your name on your business card.
There appears to be an open source project going for PDF417

@_date: 2007-05-15 22:18:45
@_author: Casey Jones 
@_subject: [Confusion] distinction between the 2 versions 1.4.6 & 2.0.3 
Werner posted that the keys should be identical between the versions, so I guess my suggestion shouldn't be necessary. Therefore I withdraw my suggestion. It still might be worth a try though. Just make sure your backups are good before you mess with your key.
Before you do that though, try signing and encrypting a file with gpg from the command line and checking to see that it will validate. That way you'll know if the problem is gpg or firepg.
First, to verify that you have your keys in an accessible place and to remind you what your key ID is:
gpg --list-keys
Then sign and encrypt to an ascii file using your own key ID when it asks for recipient:
gpg -a -se yourloveletter.txt
Then see if it works:
gpg --decrypt yourloveletter.txt.asc
I like to use the -a when testing like this just so it will come out in an ascii format that I can enjoy looking at instead of the default binary format.

@_date: 2007-05-17 04:36:01
@_author: Casey Jones 
@_subject: [Confusion] distinction between the 2 versions 1.4.6 & 2.0.3 
This is the gnupg-users mailing list and we are discussing the basics of how to "use" gnupg so I think this is appropriate for the list.
So you've got firepg working with GnuPG v2.0.3 under Linux?
There's no need to keep your key ID secret, your key ID is embedded at the end of the fingerprint above that you've made public so you cant keep it secret now anyway. Also, your public key has already been uploaded to a keyserver, so it's public now too. That's good.
It looks like on the firepg forum you posted that you are using a nightly build. Nightly builds are generally not for beginners and frequently have many bugs. You're apparently still learning the basics of command line switches, so you should definitely be using only a "release" version.
If it says your secret key is not available, check that your keys are available with the following command:
gpg --list-secret-keys
I think it should list your key with the ID 729A8B17
If it doesn't then what error does it give? Are you doing this on Windows or Ubuntu? Did you say you were trying to copy your private key from Linux to Windows? I don't know where you should put your secring.gpg file in windows. Try searching your hard drive for trustdb.gpg or pubring.gpg or gpg.conf. You should probably put your secring.gpg file in the same folder as the trustdb.gpg file. Or look in the documentation for where the files are supposed to go. If for some reason there is already a secring.gpg file on your Windows box that's different than the one on your Linux box, then don't overwrite it, just rename it to something like secring.gpg.win before putting the secring.gpg file from your Linux box into the folder on your Windows box.

@_date: 2007-05-18 10:29:59
@_author: Casey Jones 
@_subject: Printing Keys and using OCR. 
I got the the OCRA.ttf font from this link but it doesn't have the + - / and = characters used it the ascii ouptput of gpg. Do the fonts from CTAN have those chars. OCRA.ttf has a few other symbols. We could replace the + - / and = chars with the symbols in the OCRA.ttf font before printing. Perhaps also replace the lowercase L and the one and the zero and the uppercase O.
At first I was thinking that printing the keys in an ascii format would be superior to a barcode because it would be human readable(at least readable enough to retype), but then I realized that it wouldn't take much damage to the paper to render it unrecoverable. Barcodes are more resilient. But they're not human readable. Maybe the way to go is to use both. Or maybe we should create something like base64 but with error correction chars in both the horizontal and vertical direction. Or maybe we should just print multiple copies. Or maybe print in base16, though we'd still need/want error correction.

@_date: 2007-05-20 17:10:24
@_author: Casey Jones 
@_subject: Printing Keys and using OCR. 
That should be interesting.
I'm now leaning even more towards hex (base16) rather than base64. There would be less opportunity for confusion for the OCR. I was thinking it would be too inefficient but then I realized that hex gets four bits per char and base64 only gets six, so hex is only 50% bigger. If the error rate was sufficiently low, you might be able to get away with a much smaller font as well. A font half the size would store four times as much per page.
I'm thinking about writing a small simple script to print the hex with parity or checksum or a simple error correction value at the side of each row and the bottom of each column. The script that checks the parity could mark the rows and columns with errors, thereby allowing you to do human OCR to correct the errors if the characters hadn't been obliterated and if there weren't too many errors.
As long as one is doing such a script one might as well pick 16 chars that are more distinct than the usual 0-9A-F. A short sentence could be put at the bottom of the page to tell how to decode it, or the script itself might be included on another page.

@_date: 2007-05-22 12:21:20
@_author: Casey Jones 
@_subject: Old PC as Hardware Security Module? 
All I can say is that I'm probably not the only one who would be
greatful if you would grant freedom to that program.
All I meant was that if for example, you signed an email, you could look
at the email and see if it had a signature before you sent it. Of course
if you do this simple inspection on a compromised computer you are
vulnerable to the following attack.
Good point. I guess you would have to keep in mind that an error could
be an indication of compromise. A counter on your HSM could tell you if
the operation was completed, and if so, more careful investigation might
be warranted. Maybe the HSM should have a light that blinks in a distinctive manner to indicate that the signature had been successfully transmitted back to the computer. Maybe the HSM should store the last few hashes that it signed so you could boot to a live CD and verify that the hash that the HSM signed was the right one for the document you wanted signed. If the HSM signed the wrong document, which presumably the attacker wouldn't let you find, then that would be a strong indication of compromise. You could also pull your network cable before doing any decryptions so you would have time to investigate errors before the data leaked out.
Having limited signatures or decryptions in your HSM doesn't make you
invulnerable, it's just significantly better than unlimited.
I'd say it's worth it even for low security situations. It may not be
worth it if you have to boot a separate computer. I would prefer the
device to be small and quick to activate like a smart card is.
  >> Are there some other major weaknesses in the one operation limit that I
How does secret-key leakage by DSS relate to limiting your HSM to one signature or decryption per button press?
The HSM doesn't know what it's signing. For high security applications I
would suggest taking whatever measures are necessary to secure the
workstation sufficiently to be trustworthy so you know what you're signing. It's home computers which are used for high risk activities like web browsing and reading email that would benefit most from an HSM, because they don't have expensive security arrangements.

@_date: 2007-05-29 04:01:55
@_author: Casey Jones 
@_subject: Proofreadable base64 (was Re: Printing Keys and using OCR.) 
> After this, the first part of the
 > line is repeated, except it is as if it were filtered
 > through the command:
 >
 > tr 'A-Za-z0-9+/=' '0-9A-Z+/=a-z'
 >
 > That is, for every "REGNADKCIN" that appears
 > on the left side, there is
 > a "H46D03A28D" on the right side.
That's a clever way of dramatically increasing the "uniqueness" of each character to reduce the ambiguity of the OCR. It would be useful for both error detection and error correction. If it could be integrated into the OCR engine itself, it would be even more effective. Although Gallager or Turbo Codes would give much better error correction for a given storage space, your method would be way easier to implement.
I'm leaning strongly against base64. There are just too many characters that can be easily confused. Base32 would be nearly as dense (5 bits instead of 6, per char) and would allow many tough characters to be left out. A simple conversion chart for base32 chars could take up just one line at the bottom of the page. The conversion to base32 and back would be very easy. Selecting the unambiguous 32 characters to use as the symbol set would require some care. Maybe some testing to find out which symbols the OCR programs get wrong most often.
The only thing I've found similar is the Centinel Data Archiving Project.
The pdf file is a much clearer explanation than the other two.
Centinel seems to be just an error  detecting code at the beginning of each line. This might be good enough, but I'm starting to think that some error correction would be highly desirable. Even a little error correction could be a huge advantage over just error detection.
I think most error correction codes mix the code bits with the data bits. I'd like to keep the data in separate blocks to make it easy for humans to separate and decode it. Unfortunately separating the error correction bits probably makes the code less robust. If we want to intermix the error correction code maybe we could include a note at the bottom that says "the third,sixth,ninth,etc columns and rows are error correction data".  We also don't need the feature of hard drives and some signaling methods that make sure there are a good mixture of ones and zeros in order to keep the signal oscillating. We can have all zeros or all ones on paper if we want, with no signal detection problems.
I was thinking about just using a normal typewriter size font. But then I realized that if we use a font half the size, it would not only improve data density, but we could include extra error correction. A small font with more error correction would probably be more reliable than a large font with less error correction.

@_date: 2011-05-26 15:04:30
@_author: Casey Jones 
@_subject: GPG Problem - invalid radix64 character 
In the future, instead of GPG or OpenSSL I would suggest an encrypted filesystem such as an encrypted folder or partition or Truecrypt volume. The advantage of those is that a single bit error is likely to only affect one file. If you archive the files before transferring them to your encrypted volume, you should archive each 4GB file individually, again so that one bit error will only effect one file.
Another kind of archive software to look into is the kind often used on binary newsgroups where the archive is split into parts and the parts contain error CORRECTING code.
When working with such large amounts of data (or even small amounts) you should keep in mind that computer RAM is surprisingly error prone. About one in three good quality computers has several memory errors per year (the other two out of three tend to have no detected errors). You may want to invest in error correcting memory.
Hard drive error rates and speeds can degrade dramatically in the presence of excessive sound and vibrations. Other nearby hard drives and CD drives can be a problem. Many hard drive enclosures are poorly designed in this respect. For best reliability, your drives need to at least have rubber mount isolation and sometimes blocking of sound from nearby hard drives. CD drives can produce vibrations so bad that basic shock mounts can not dampen them sufficiently, so don't run the CD drive if error free transfers are critical. But if you rubber mount your hard drives, keep in mind that they will loose the metal heat sink effect, and so you need to pay extra attention to ventilation and watch out for
