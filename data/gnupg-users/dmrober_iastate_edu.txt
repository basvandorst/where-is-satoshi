
@_date: 2012-03-28 18:09:20
@_author: Roberts, David M [ITSYS] 
@_subject: sign and encrypt from batch script 
I've got a batch script that signs and encrypts files using GnuPG1.2.6 running on a REHL4 system.  We are upgrading the system to RHEL6 which comes with Gnupg2.0.14 and the scripts no longer run correctly.
gpg -u "signing-key" -r "receiving_pub-key" -sea -o /output.pgp --batch --passphrase-fd 0 < /phrase.txt /plaintext.txt
When I run this command on the new system I get a message like this
You need a passphrase to unlock the secret key for
user: "signing-key"
2048-bit RSA key, ID EAA21D37, created 2012-03-26
can't connect to `/root/.gnupg/S.gpg-agent': No such file or directory
I've tried to invoke the gpg-agent
gpg-agent -daemon -batch gpg -u "signing-key" -r "receiving_pub-key" -sea -o /output.pgp --batch --passphrase-fd 0 < /phrase.txt /plaintext.txt
You need a passphrase to unlock the secret key for
user: "signing-key"
2048-bit RSA key, ID EAA21D37, created 2012-03-26
gpg: problem with the agent: Bad passphrase
gpg: skipped "signing-key": General error
We don't need S/MIME or Mail on this system, just GPG in batch mode.
Any help or insight is appreciated.
David M. Roberts
Iowa State University
Information Technology Services
dmrober at iastate.edu

@_date: 2012-03-28 16:00:37
@_author: Roberts, David M [ITSYS] 
@_subject: sign and encrypt file from batch script 
I've got a batch script that signs and encrypts files using GnuPG1.2.6 running on a REHL4 system.  We are upgrading the system to RHEL6 which comes with Gnupg2.0.14 and the scripts no longer run correctly.
gpg -u "signing-key" -r "receiving_pub-key" -sea -o /output.pgp --batch --passphrase-fd 0 < /phrase.txt /plaintext.txt
When I run this command on the new system I get a message like this
You need a passphrase to unlock the secret key for
user: "signing-key"
2048-bit RSA key, ID EAA21D37, created 2012-03-26
can't connect to `/root/.gnupg/S.gpg-agent': No such file or directory
I've tried to invoke the gpg-agent
gpg-agent -daemon -batch gpg -u "signing-key" -r "receiving_pub-key" -sea -o /output.pgp --batch --passphrase-fd 0 < /phrase.txt /plaintext.txt
You need a passphrase to unlock the secret key for
user: "signing-key"
2048-bit RSA key, ID EAA21D37, created 2012-03-26
gpg: problem with the agent: Bad passphrase
gpg: skipped "signing-key": General error
We don't need S/MIME or Mail on this system, just GPG in batch mode.
Any help or insight is appreciated.
David M. Roberts
Iowa State University
Information Technology Services
dmrober at iastate.edu

@_date: 2012-03-29 13:45:21
@_author: Roberts, David M [ITSYS] 
@_subject: sign and encrypt from batch script 
Thanks. I've installed version 1.4.12, deleted and recreated the sym-link /usr/bin/gpg to point to the new executable instead of gpg2.  I also had to set the trust level on all the public keys in our key-ring, version 1.2.6 apparently didn't care if the trust level wasn't set.  Now the scripts are working on the new system.  And gpg2 is still installed for all the dependencies linked to it under RHEL6.
David M. Roberts
Iowa State University
Information Technology Services
dmrober at iastate.edu
-----Original Message-----
Sent: Wednesday, March 28, 2012 1:14 PM
Switch to GnuPG 1.4.12.  This is not a downgrade; both GnuPG 1.4 and GnuPG 2 are fully-supported, stable code.  Your script will (likely!) work just fine with GnuPG 1.4.12.
Gnupg-users mailing list
Gnupg-users at gnupg.org
