
@_date: 2006-03-21 13:56:17
@_author: Daniel Carrera 
@_subject: /dev/tty error 
I'm trying to use gpg on a remote server (the server has a copy of my public key, a file is encrypted there and my client downloads it by HTTP). I'm getting the following error:
gpg: cannot open /dev/tty: No such device or address
This is a Linux box (Red Hat I think). Do you know what this error means? What can I do to fix it?
Thank you for your help.

@_date: 2006-03-21 13:56:37
@_author: Daniel Carrera 
@_subject: Help: /dev/tty error 
I'm trying to use gpg on a remote server (the server has a copy of my
public key, a file is encrypted there and my client downloads it by
HTTP). I'm getting the following error:
gpg: cannot open /dev/tty: No such device or address
This is a Linux box (Red Hat I think). Do you know what this error
means? What can I do to fix it?
Thank you for your help.

@_date: 2006-03-21 16:33:26
@_author: Daniel Carrera 
@_subject: /dev/tty error 
Yes, but I didn't know what else I should say.
I'm running it from a PHP script:
exec("gpg ...")
I guess that means I don't have a TTY. In any event, --batch helped. Thanks!

@_date: 2006-03-21 16:54:22
@_author: Daniel Carrera 
@_subject: Error: "unusable public key" 
I'm having another problem, again not in the FAQ:
sql.gz: encryption failed: unusable public key	
This happens when I try to encrypt a file with my public key.
This is what I'm trying to do: I want to backup a remote database regularly but I'd like to transmit it encrypted. So I want to run this sqldump ... | gzip -c | gpg ... -o backup.gpg
And then send the file backup.gpg to the client. This should be more than enogh for my needs.
So, I have gpg installed in the server. I imported my public key and I didn't see any errors. I went to the .gnupg directory and pubring.gpg is there and has a non-zero size. When I do a --list-keys on the server I see my public key there:
pub  1024D/42713DE9 2006-03-21 Daniel Carrera sub  2048g/F2EB9C97 2006-03-21
I am trying to encrypt with the following command:
$ gpg -a --homedir /path/to/.gnupg -r daniel --batch -o sql.asc -e sql.gz
Note: The '-e sql.gz' is for testing. I'll replace this by a pipe later.
When I run this command from a PHP script I get this error:
gpg: F2EB9C97: There is no indication that this key really belongs to the owner
gpg: sql.gz: encryption failed: unusable public key
I don't care about the first line. I don't plan to have a secret key on the server. But that first line does show that it located the correct public key. I don't understand how the public key can be unusable if it can identify the key ID correctly. What are the chances of that?
Could it be that I don't have a secret key? Why would a secret key be required if I just want to encrypt?
Could it be because I'm running this from a PHP script? Why would that make the key unusable?
I'm sure I'm not the first person who has thought of putting gpg on a server and using only a public key for encryption.
Any suggestions would be most appreciated.

@_date: 2006-03-22 10:22:36
@_author: Daniel Carrera 
@_subject: Error: "unusable public key" 
Thanks! That did it. For some reason my gpg on the server didn't like the --trust-model option ("invalid option") either on the command line or in gpg.conf. But I updated the trustdb and that worked.

@_date: 2006-03-22 10:49:51
@_author: Daniel Carrera 
@_subject: Force GPG to write a file? 
Hi all,
Last question :)
By default, gpg will refuse to write to a file (myfile.gpg) that already exists. Is there a way to change this behaviour?
I am running gpg on batch mode on a server to encrypt a database before downloading. So I need to temporarily store the encrypted file on the server. There are two ways to accomplish this:
1) Give Apache write permission to an entire directory, so it can add and delete files in that directory.
2) Give Apache write permission to just one file (myfile.gpg) and keep overwriting every time I download a new encrypted backup.
Right now I'm doing (1) but I guess that (2) would be better. But I can only do (2) if I can confince gpg to overwrite an existing file.
I looked at the man page and FAQs and I couldn't find this information.
Thank you for your help.

@_date: 2006-03-22 11:24:19
@_author: Daniel Carrera 
@_subject: Passphrase on the command line 
This should be a simple question. What is the recommended way to decrypt a file from a script that runs on a cron job? This is what I have so far:
cat passphrase | gpg -o MyData --passphrase-fd 0 -d MyData.asc
Where 'passphrase' has the chmod permission 400.
Is this the best option?
Background:  I want to setup a cron job to regularly download an encrypted backup of a database, decrypt it, and store it here (this computer then gets backed up onto tape drives).
Thank you for your advice.
