
@_date: 2005-08-10 16:53:48
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Hash: SHA1
Before I installed the June 16th version
I was running an older version of the GPGExch.dll (Oct. 19, 2004)
(labeled as 1.1.0.0) that had a GDGPG.dll (1.3.0.0) file as well.
Outlook's Add-in Manager doesn't seem to know how to UNINSTALL an
add-in. You can disable it, but that doesn't get rid of the entry.  :-(
I waded through the registry with regedt32 getting rid of things
with GPG or g10 in them.
I then copied the libgpgmedlgs.dll to the system directory and
ran the regsvr32 command as per the README.
Any attempt to sign a message crashes Outlook.
[Outlook 2003, SP1]
[This is on Windows XP Pro, SP2. GPG 1.4.1]
The error report that wants to go to Microsoft says:
Error signature
  AppName: outlook.exe   AppVer: 11.0.6353.0  AppStamp: 408f2937
  ModName: libgpgmedlgs.dll ModVer: 0.5.3.0   ModStamp: 42b1e2da
  fDebug: 0         )ffset: 00004367
It also appears that the preferences set on the GnuPG tab are
not saved. I set the 'Sign new messages by default', unset the
'Also encrypt message with the default key' and change the
logfile and if I stop Outlook and restart these are gone.
Can anyone help?

@_date: 2005-08-10 17:46:01
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Hash: SHA1
Some more information. If I send a signed message to outlook and try
to verify it, I get an error dialog:
   GPG Verify
        Invalid crypto engine
My WinPT installation verifies the signature without a problem
(from the clipboard).

@_date: 2005-08-10 20:25:46
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Hash: SHA1
The 1.2.6 is on the Linux box where I'm running Thunderbird (1.0.6)
and Enigmail (0.92.0.0). I signed the email there, but sent it
to the Windows XP Pro box where I'm running Outlook 2003.
On the Windows box I'm running GPG 1.41.

@_date: 2005-08-10 20:32:31
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
I looked at the page you mentioned and was curious about:
   Please note that if you are connected to a Corperate Network
   or Exchange server, you MUST contact your IT or ADMIN before
   installing!
Is this a licensing issue?
My Outlook 2003 is connected to my employer's Exchange server.
That's the only reason I even use Outlook.  :-)

@_date: 2005-08-10 20:40:14
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Hash: SHA1
Where can I get the 0.99.4 version? I downloaded from
 last week and that is
the 0.99.2 version I'm having problems with. The link on that
page still seems to be for 0.99.2.
How do I enable this?

@_date: 2005-08-11 00:02:30
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Patrick Dickey helped me with this a bit.
I downloaded:
and installed it. Now, in the explorer windows the dll does
show up a 0.99.4, but the tab in Outlook says 0.99.3.
It still doesn't work. Both the crash on signing and the
Invalid Crypto Engine on verification occur. And the preferences
are not saved. But now I'm getting a dialog about
"Save options in the registry". When I start Outlook, I
get one that initially says "Access is denied" and then
five more that I have to click on that say:
"Operation completed successfully".
Similarly, if I go to the tab and change options, I have
to click on five dialog boxes when I close the tab.
Patrick also tried to help me with this.
I enabled Dr. Watson, but it does not come up and no log is created
when Outlook crashes. When I try to sign a message, I get a dialog
"Microsoft Office Outlook has encountered a problem and needs to close."
I have the option to send an error report to Microsoft or not.
If I go into regedt32, and go to:
I see the following values:
Auto     1
Debugger drstsn32 -p %ld -e %ld -g
(and a PreVisualStudio7Debugger with the same value)
So, it looks like Dr. Watson is enabled, but isn't getting invoked?

@_date: 2005-08-11 19:24:56
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
When I connect to ftp.g10code.com, there is no pub directory.
[I'm doing anonymous FTP with WS_FTP].
There is a g10code directory and in there is an outlgpg directory.
I got the zip of the 0.99.4 version dated July 27, 2005.
As to permissions, I checked and I'm in the administrators group
on my machine--I can't think what other permissions I'd need. :-)
I upgraded to 1.4.2 from 1.4.1 and the behavior is the same.
As to copying the data that shows up as part of Microsoft's error
reporting. The text is not selectable.
So, I don't see any path going forward that will help resolve the
problem on my system:
  Dr. Watson doesn't seem to get invoked, just Microsoft's
     Error reporting.
  I can't copy Microsoft's report content.
Just to summarize:
Hardware: Dell OPTIPLEX GX270: Dual Pentium 4 (2.8G Hz)
                               2 GB RAM
OS: Windows XP Professional, Service Pack 2
    (Build 2600.xpsp_sp2_gdr.050301-1519 : Service Pack 2)
Outlook: Microsoft Office Outlook 2003 (11.6359.6408) SP1
         [Installed from Microsoft Office Standard Edition 2003]
GPG Location: C:\Program Files\Gnu\GnuPG\gpg.exe
Vrsion: 1.4.2
Home: C:/Documents and Settings/rjensen.AMERICAS/Application Data/GnuPG
(from gpg --version)
GPGExch info:
   libgpgmedlgs.dll: 0.6.1.0 copied to C:\WINDOWS\SYSTEM32
   GPGExch.dll:      0.99.4.0 installed in C:\gnupg\GPGExch
  [I ran regsvr32 on GPGExch.dll from a command prompt in
   C:\gnupg\GPGExch]
Summary of behavior problems:
   When Outlook is started, I get several dialog boxes relating
   to storing values in the registry. The first one says access
   denied. The other 5 indicate the operation completed successfully.
   Preferences changed on the GnuPG tab do not survive a program
   restart. Changing the preferences also causes the 5 dialog
   boxes to appear.
   When changing preferences,
    the "Also encrypt message with the default key" starts off
    with the value:
    C:\Documents and Settings\rjensen.AMERICAS\Application Data\gnupg
    If I attempt to save changes I get an error dialog:
        "The default key cannot contain any spaces".
    I have to clear out the box and uncheck to save other changes.
    Attempting to verify a signature results in a dialog:
        "Invalid crypto engine"
    Attempting to sign a message causes Outlook to 'close'.
    After composing a plain text message I click on 'Send'.
    I do not get a prompt for my passphrase.
    I just get the dialog about:
      "Microsoft Office Outlook has encountered a problem
       and needs to close"
Error 'signature':
  AppName:  outlook.exe   AppVer: 11.0.6353.0  AppStamp: 408f2937
  ModName: libgpgmedlgs.dll  ModVer: 0.6.1.0   ModStamp: 42e0c70e
  fDebug: 0   Offset: 00005f77
If I look at the error report contents, I can't copy and paste,
but here are some more details:
Exception Information
  Code: 0xc0000005     Flags: 0x00000000
Record: 0x0000000000000000  Address: 0x00000000002235f77
Then there are a large number of 'Modules' listed.
GPGExch.dll is module 63 and libgpgmedlgs.dll is module 64.
Image Base: 0x02080000   Image Size: 0x00000000
Checksum:   0x00000000   Time Stamp: 0x42dfcf77
Version Information:
 Signature:  feef04bd
 StrucVer:   00010000
 FileVer:    (0.99:4.0)
 ProdVer:    (0.99:4.0)
 FlagMask:   0000003f
 Flags:      00000000
 OS:         00000004
 FileType:   00000002
 SubType:    00000000
 FileDate:   00000000:00000000
Image Base: 0x02230000   Image Size: 0x00000000
Checksum:   0x00000000   Time Stamp: 0x42e0c70e
Version Information:
 Signature:  feef04bd
 StrucVer:   00010000
 FileVer:    (0.6:1.0)
 ProdVer:    (0.6:1.0)
 FlagMask:   0000003f
 Flags:      00000020
 OS:         00040004
 FileType:   00000001
 SubType:    00000000
 FileDate:   00000000:00000000
After all the modules, there is information about different threads,
but without being able to copy the contents, I don't know what
information would be helpful.
I'll be glad to try the next version, but I don't see there
is anything more I can do with this one.

@_date: 2005-08-12 17:01:44
@_author: R. Jensen 
@_subject: [outlgpg] Outlook 2003 problems 
Hash: SHA1
The 'Error Report Contents' window cannot be resized. It shows about
16 lines of information at a time. I scrolled down through 1 thread's
worth of information and that was ~50 pages of 16 lines.
The dump shows 21 threads (most of which are 2-3 pages).
There is a lot to weed through, and I don't know which part is
