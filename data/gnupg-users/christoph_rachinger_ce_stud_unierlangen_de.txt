
@_date: 2011-03-07 13:23:27
@_author: Christoph Rachinger 
@_subject: Byteformat of a RSA signature 
Hi everyone,
this question is probably rather simply to those involved in developing
GPG, maybe some of the user users know the answer as well:
I'm trying to write a program for reading signatures of binary files. For
this, I make use of GPG's SHA1 and RSA implementations (and the MPI
implementation to be able to calculate them). But my problem is the
following: To check whether a file's signature is valid or nor I have to
read the current detached signature into an MPI. But I do not know when
the actual MPI starts, i.e. where I have to start reading with
mpi_data_from_buffer. So I hope anyone can tell me the format of the RSA
signature or just tell me the offset, where I need to start reading the
I'm currently using GPG 1.4.11
Thank you

@_date: 2011-03-08 14:53:05
@_author: Christoph Rachinger 
@_subject: Signature Verification using GPG 
Hello everyone,
I hope that this is the right place for my question - if not please
forgive me. Anyway, any form of help will is appreciated.
I'm currently trying to write a kernel module that checks digital
signatures of binaries. For the cryptographic part I'm using the
sourcecode of GPG 1.4.11 (the SHA1 computation, the RSA verifcation and
the MPI part) - I think I made everything correctly, but that it would
Some Infos:
For the sake of simplicity we can assume that the keys are correctly
initalized and both the hash that was signed as well as the signature
itself (i.e. the whole packet as specified by RFC 4880) was read
Now I compute the new hash over the old hash plus the trailer (parts of
the packet body plus some 6-byte information), convert this new hash as
well as the original signature to an MPI and call rsa_verify().
But it just won't work.
And finally my code, I left out all error handling to keep it compact - so
it should be pretty self-explanatory, but I'll answer every question if
somethings unclear ofcouse:
Again, it would be great if someone could help me.
If this was the wrong place to ask, please tell me also (maybe with a hint
where to ask instead :))
