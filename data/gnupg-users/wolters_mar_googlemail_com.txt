
@_date: 2013-10-22 23:37:39
@_author: Martin Wolters 
@_subject: gpg4win pinentry ignores PIN-pad 
I am using gpg4win 2.2.1, which according to the change log supports
the SPR332 PIN-pad, but pinentry requests the PIN from the keyboard.
Is there anything I need to configure to enforce the entry from the
card reader?
In GNU/Linux, pinentry only opens a window telling me to enter the PIN
on the card reader and I don't even get the opportunity to enter it
from my keyboard by mistake. This is the way I want it.
Since I don't know where to start, I attached a log from scdaemon. If
you need any additional information, I will be happy to provide it.
Have a good time,
scdaemon[15820]: chan_00000138 -> OK GNU Privacy Guard's Smartcard
server ready
scdaemon[15820]: chan_00000138 <- GETINFO socket_name
scdaemon[15820]: chan_00000138 -> D
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- OPTION event-signal=f8
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- SERIALNO openpgp
2013-10-22 19:53:07 scdaemon[15820] reader slot 0: active protocol: T1
2013-10-22 19:53:07 scdaemon[15820] slot 0: ATR=3B DA 18 FF 81 B1 FE 75
1F 03 00 31 C5 73 C0 01 40 00 90 00 0C
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=A4 p1=00
p2=0C lc=2 le=-1 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 A4 00 0C 02 3F 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=6B00  datalen=0
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=A4 p1=04
p2=00 lc=6 le=-1 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 A4 04 00 06 D2
76 00 01 24 01
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=0
2013-10-22 19:53:07 scdaemon[15820] DBG:    dump:
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=4F lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 4F 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=16
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  D2 76 00 01 24 01
02 00 00 05 00 00 04 89 00 00
2013-10-22 19:53:07 scdaemon[15820] AID: D2 76 00 01 24 01 02 00 00 05
00 00 04 89 00 00
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=5F
p2=52 lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 5F 52 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=10
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  00 31 C5 73 C0 01
40 05 90 00
2013-10-22 19:53:07 scdaemon[15820] Historical Bytes: 00 31 C5 73 C0 01
40 05 90 00
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=C4 lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 C4 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=7
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  00 20 20 20 03 00 03
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=6E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 6E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=217
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  4F 10 D2 76 00 01
24 01 02 00 00 05 00 00 04 89 00 00 5F 52 0A 00 31 C5 73 C0 01 40 05 90
00 73 81 B7 C0 0A 7C 00 08 00 08 00 08 00 08 00 C1 06 01 10 00 00 20 00
C2 06 01 10 00 00 20 00 C3 06 01 10 00 00 20 00 C4 07 00 20 20 20 03 00
03 C5 3C CC 19 5D 23 92 34 85 8F E0 25 31 DB A9 F0 CC F3 EA 7E F1 4F 79
C0 D2 34 6E 04 09 AB 89 B5 ED 10 8D 1F 92 D2 4A E6 0B AF 7A F7 D8 1C 32
87 D5 E3 D5 A0 F1 BA 75 29 9B 20 95 6A 3C EC C6 3C 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 CD 0C 52 5D 88 A3 52 5D 88 A3 52 5D 88 A3
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=5E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 5E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=0
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:
2013-10-22 19:53:07 scdaemon[15820] Version-2 ......: yes
2013-10-22 19:53:07 scdaemon[15820] Get-Challenge ..: yes (2048 bytes max)
2013-10-22 19:53:07 scdaemon[15820] Key-Import .....: yes
2013-10-22 19:53:07 scdaemon[15820] Change-Force-PW1: yes
2013-10-22 19:53:07 scdaemon[15820] Private-DOs ....: yes
2013-10-22 19:53:07 scdaemon[15820] Algo-Attr-Change: yes
2013-10-22 19:53:07 scdaemon[15820] SM-Support .....: no
2013-10-22 19:53:07 scdaemon[15820] Max-Cert3-Len ..: 2048
2013-10-22 19:53:07 scdaemon[15820] Max-Cmd-Data ...: 2048
2013-10-22 19:53:07 scdaemon[15820] Max-Rsp-Data ...: 2048
2013-10-22 19:53:07 scdaemon[15820] Cmd-Chaining ...: no
2013-10-22 19:53:07 scdaemon[15820] Ext-Lc-Le ......: yes
2013-10-22 19:53:07 scdaemon[15820] Status Indicator: 05
2013-10-22 19:53:07 scdaemon[15820] GnuPG-No-Sync ..: no
2013-10-22 19:53:07 scdaemon[15820] GnuPG-Def-PW2 ..: no
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=6E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 6E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=217
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  4F 10 D2 76 00 01
24 01 02 00 00 05 00 00 04 89 00 00 5F 52 0A 00 31 C5 73 C0 01 40 05 90
00 73 81 B7 C0 0A 7C 00 08 00 08 00 08 00 08 00 C1 06 01 10 00 00 20 00
C2 06 01 10 00 00 20 00 C3 06 01 10 00 00 20 00 C4 07 00 20 20 20 03 00
03 C5 3C CC 19 5D 23 92 34 85 8F E0 25 31 DB A9 F0 CC F3 EA 7E F1 4F 79
C0 D2 34 6E 04 09 AB 89 B5 ED 10 8D 1F 92 D2 4A E6 0B AF 7A F7 D8 1C 32
87 D5 E3 D5 A0 F1 BA 75 29 9B 20 95 6A 3C EC C6 3C 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 CD 0C 52 5D 88 A3 52 5D 88 A3 52 5D 88 A3
2013-10-22 19:53:07 scdaemon[15820] Key-Attr-sign ..: RSA, n=4096, e=32,
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=6E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 6E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=217
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  4F 10 D2 76 00 01
24 01 02 00 00 05 00 00 04 89 00 00 5F 52 0A 00 31 C5 73 C0 01 40 05 90
00 73 81 B7 C0 0A 7C 00 08 00 08 00 08 00 08 00 C1 06 01 10 00 00 20 00
C2 06 01 10 00 00 20 00 C3 06 01 10 00 00 20 00 C4 07 00 20 20 20 03 00
03 C5 3C CC 19 5D 23 92 34 85 8F E0 25 31 DB A9 F0 CC F3 EA 7E F1 4F 79
C0 D2 34 6E 04 09 AB 89 B5 ED 10 8D 1F 92 D2 4A E6 0B AF 7A F7 D8 1C 32
87 D5 E3 D5 A0 F1 BA 75 29 9B 20 95 6A 3C EC C6 3C 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 CD 0C 52 5D 88 A3 52 5D 88 A3 52 5D 88 A3
2013-10-22 19:53:07 scdaemon[15820] Key-Attr-encr ..: RSA, n=4096, e=32,
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=6E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 6E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=217
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  4F 10 D2 76 00 01
24 01 02 00 00 05 00 00 04 89 00 00 5F 52 0A 00 31 C5 73 C0 01 40 05 90
00 73 81 B7 C0 0A 7C 00 08 00 08 00 08 00 08 00 C1 06 01 10 00 00 20 00
C2 06 01 10 00 00 20 00 C3 06 01 10 00 00 20 00 C4 07 00 20 20 20 03 00
03 C5 3C CC 19 5D 23 92 34 85 8F E0 25 31 DB A9 F0 CC F3 EA 7E F1 4F 79
C0 D2 34 6E 04 09 AB 89 B5 ED 10 8D 1F 92 D2 4A E6 0B AF 7A F7 D8 1C 32
87 D5 E3 D5 A0 F1 BA 75 29 9B 20 95 6A 3C EC C6 3C 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 CD 0C 52 5D 88 A3 52 5D 88 A3 52 5D 88 A3
2013-10-22 19:53:07 scdaemon[15820] Key-Attr-auth ..: RSA, n=4096, e=32,
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=5E lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 5E 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=0
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:
2013-10-22 19:53:07 scdaemon[15820] DO `Login Data':
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=5F
p2=50 lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 5F 50 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=0
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:
2013-10-22 19:53:07 scdaemon[15820] DO `URL': `'
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=5F
p2=52 lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 5F 52 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=10
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  00 31 C5 73 C0 01
40 05 90 00
2013-10-22 19:53:07 scdaemon[15820] DO `Historical Bytes': 00 31 C5 73
C0 01 40 05 90 00
2013-10-22 19:53:07 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=65 lc=-1 le=256 em=0
2013-10-22 19:53:07 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 65 00
2013-10-22 19:53:07 scdaemon[15820] DBG:  response: sw=9000  datalen=26
2013-10-22 19:53:07 scdaemon[15820] DBG:      dump:  5B 0F 57 6F 6C 74
65 72 73 3C 3C 4D 61 72 74 69 6E 5F 2D 02 64 65 5F 35 01 31
2013-10-22 19:53:07 scdaemon[15820] DO `Cardholder Related Data': 5B 0F
57 6F 6C 74 65 72 73 3C 3C 4D 61 72 74 69 6E 5F 2D 02 64 65 5F 35 01 31
2013-10-22 19:53:07 scdaemon[15820] DO `Name': `Wolters< S SERIALNO
D2760001240102000005000004890000 0
scdaemon[15820]: chan_00000138 -> OK
2013-10-22 19:53:08 scdaemon[15820] updating slot 0 status:
0x0000->0x0007 (0->1)
2013-10-22 19:53:08 scdaemon[15820] triggering event f8 (000000F8) for
client -1
scdaemon[15820]: chan_00000138 <- SERIALNO openpgp
scdaemon[15820]: chan_00000138 -> S SERIALNO
D2760001240102000005000004890000 0
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- SETDATA
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- SETDATA --append
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- PKDECRYPT
2013-10-22 19:53:08 scdaemon[15820] DBG: send apdu: c=00 i=CA p1=00
p2=6E lc=-1 le=256 em=0
2013-10-22 19:53:08 scdaemon[15820] DBG:  PCSC_data: 00 CA 00 6E 00
2013-10-22 19:53:08 scdaemon[15820] DBG:  response: sw=9000  datalen=217
2013-10-22 19:53:08 scdaemon[15820] DBG:      dump:  4F 10 D2 76 00 01
24 01 02 00 00 05 00 00 04 89 00 00 5F 52 0A 00 31 C5 73 C0 01 40 05 90
00 73 81 B7 C0 0A 7C 00 08 00 08 00 08 00 08 00 C1 06 01 10 00 00 20 00
C2 06 01 10 00 00 20 00 C3 06 01 10 00 00 20 00 C4 07 00 20 20 20 03 00
03 C5 3C CC 19 5D 23 92 34 85 8F E0 25 31 DB A9 F0 CC F3 EA 7E F1 4F 79
C0 D2 34 6E 04 09 AB 89 B5 ED 10 8D 1F 92 D2 4A E6 0B AF 7A F7 D8 1C 32
87 D5 E3 D5 A0 F1 BA 75 29 9B 20 95 6A 3C EC C6 3C 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 CD 0C 52 5D 88 A3 52 5D 88 A3 52 5D 88 A3
2013-10-22 19:53:08 scdaemon[15820] DBG: check_pcsc_pinpad: command=20,
2013-10-22 19:53:08 scdaemon[15820] DBG: asking for PIN '||Bitte die PIN
scdaemon[15820]: chan_00000138 -> INQUIRE NEEDPIN ||Bitte die PIN eingeben
scdaemon[15820]: chan_00000138 <- [ 44 20 PI NP IN PI NP IN 00 00 00 00
00 00 00 00 ...(76 byte(s) skipped) ]
scdaemon[15820]: chan_00000138 <- END
2013-10-22 19:53:12 scdaemon[15820] DBG: send apdu: c=00 i=20 p1=00
p2=82 lc=6 le=-1 em=0
2013-10-22 19:53:12 scdaemon[15820] DBG:  PCSC_data: 00 20 00 82 06 PI
NP IN PI NP IN
2013-10-22 19:53:12 scdaemon[15820] DBG:  response: sw=9000  datalen=0
2013-10-22 19:53:12 scdaemon[15820] DBG:    dump:
2013-10-22 19:53:12 scdaemon[15820] DBG: send apdu: c=00 i=2A p1=80
p2=86 lc=513 le=2048 em=1
2013-10-22 19:53:12 scdaemon[15820] DBG:  PCSC_data: 00 2A 80 86 00 02
01 00 0D 9E 9F 4B AB F6 EB 57 26 CF 90 1C 60 19 C8 66 91 22 90 C9 16 2F
6B 95 69 A3 BF 35 4A 01 DB 88 50 CA 74 E9 FC E8 54 1F 79 9F 5E 4B 74 4C
69 C7 BE 67 34 77 82 BE 5B A3 F6 FD 83 AF 7F F9 AF 88 BA 2D C0 E1 A1 C9
1B FF 5D 68 A1 C7 72 FF 95 5B C6 35 9F EB E2 C3 7E E9 97 81 11 C3 9E 78
A9 C2 4F CA 43 47 D5 20 8F 64 BF 2B E5 CC D7 1B F4 BC DA A0 05 7F A0 6D
37 40 5D 23 8C F3 C9 BC 08 52 54 D6 ED 53 4D C0 40 7B 30 35 C1 0F 89 7F
75 E8 09 6C 3C D0 E2 FB DC F5 D7 10 6C 9D EB 56 26 C8 2B 40 68 9C 3E 6C
17 CE 4E AE 8F 49 BA 47 9A E9 F6 10 34 48 DA D4 52 BC 8A 6D A8 49 E6 FC
17 2A 52 22 62 DE 3E 94 21 11 2B CA 60 C9 24 06 3E 19 94 EA 9B 6D 80 8C
11 8C B4 23 54 8F 84 30 42 11 63 16 60 52 ED 3E D4 DB F5 F1 04 F9 4D 9C
6D 3A 48 6B 6B 30 F1 14 F7 45 CF AB AA FB AE B0 9D 85 7E 71 36 F0 38 16
5D 9F F8 29 B2 97 B6 26 F7 91 42 11 19 AD 31 1B 5B 5E 74 F2 20 66 D8 01
29 BF E3 BB 4A 07 EC E7 51 75 FB 63 B0 73 24 0F E0 D3 BA 10 43 AD 84 59
97 61 DD 96 00 D0 E5 AB A6 67 E5 1D D3 2B 83 B9 08 84 6B 01 C2 8A 10 B5
CD 97 40 D7 51 4D 83 F6 57 C3 C9 54 BF E7 C2 D5 3C 83 29 40 E4 49 0A 65
09 E4 C1 59 23 33 87 2B C7 1E D6 D2 C6 81 4D F6 ED 4E 2C 7A 56 C9 3D F1
59 80 7D 18 29 DA 53 1D EE 5A B3 5D 6F 53 69 19 58 4F 09 9C 6D 32 E1 6B
CD 97 40 F8 E9 1C 46 12 F6 0D E0 50 A6 A4 BF 95 CE C9 A0 D2 77 BA CE CE
45 11 11 8A BD 20 59 F1 56 95 A2 3B 71 24 84 6A 68 31 D4 9E C5 7F A3 DF
A9 07 40 6F 60 B6 BD 37 07 8E 81 7E 10 80 69 C8 82 64 A1 8C 22 AF B9 EE
67 BE 9D 48 AF 9E 28 5B B2 5C 39 1C 83 E4 E9 62 51 D9 D4 1A B3 72 D6 14
98 B7 5A 90 7E 6C 00 59 25 0B 08 00
2013-10-22 19:53:15 scdaemon[15820] DBG:  response: sw=9000  datalen=35
2013-10-22 19:53:15 scdaemon[15820] DBG:      dump:  09 2A F3 4A 7E 82
3B 0E E9 80 2A 11 69 1F CF 2D 27 85 AF FA 4C 31 A3 0E 5D 72 58 B3 85 38
2F FF 5A 0D 7A
2013-10-22 19:53:15 scdaemon[15820] operation decipher result: Erfolg
scdaemon[15820]: chan_00000138 -> [ 44 20 09 2a f3 4a 7e 82 3b 0e e9 80
2a 11 69 1f ...(23 byte(s) skipped) ]
scdaemon[15820]: chan_00000138 -> OK
scdaemon[15820]: chan_00000138 <- RESTART
scdaemon[15820]: chan_00000138 -> OK
