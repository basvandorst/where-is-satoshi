
@_date: 2018-07-26 21:50:59
@_author: felix@crowfix.com 
@_subject: Empty keyring after upgrade to Ubuntu 18.04 :/ 
I ran into a similar problem a few months ago, upgrading from a much older gentoo system with 1.something.  I don't know what specific action fixed it, but after a couple of cycles of restoring the original and trying different commands, it suuddenly migrated correctly.  Memory says the first couple of attempts, I tried to do something which would have to do the migration first, and it worked when I restored the original and did just the migration by itself.  But I didn't take enough notes to figure it out after it started working.

@_date: 2018-06-17 15:20:23
@_author: felix@crowfix.com 
@_subject: Upgrading 2.0.20 to 2.2.24 
I have a seldom-used need to encrypt a few files, and the last time I did was on a gentoo system running 2.0.20.
    gpg -e dest -r felix at crowfix.com
I have migrated the .gnupg dir to an Ubuntu 18.04 system running 2.2.24, and the gpg command seems to have mutated.  The gentoo 2.0.20 command can decrypt what the Ubuntu 2.2.24 command encrypts.  But the Ubuntu 2.2.24 command will not decrypt either what it just encrypted or what the gentoo 2.0.20 command encrypted:
    gpg: encrypted with 2048-bit ELG key, ID 18DCDD20A3362105, created yyyy-mm-dd
          "Felix Finch (Scarecrow Repairman) "
    gpg: decryption failed: No secret key
The enceyption command also seems pickier:
    gpg: 18DCDD20A3362105: There is no assurance this key belongs to the named user
    sub  elg2048/18DCDD20A3362105 1999-12-06 Felix Finch (Scarecrow Repairman)      Primary key fingerprint: E987 4493 C860 246C 3B1E  6477 7838 76E9 182E 8151
           Subkey fingerprint: 1A59 C8A1 81FB 6780 641C  D17E 18DC DD20 A336 2105
    It is NOT certain that the key belongs to the person named
    in the user ID.  If you *really* know what you are doing,
    you may answer the next question with yes.
    Use this key anyway? (y/N)
Can someone offer an explanation so I don't have to dredge through a zillion changelogs to see why 2.2.24 is pickier?  What does it mean to say there is no secret key?

@_date: 2018-06-18 06:06:22
@_author: felix@crowfix.com 
@_subject: Upgrading 2.0.20 to 2.2.24 
Thanks -- but that didn't do the trick.
  $ gpg --list-secret-keys
  gpg: starting migration from earlier GnuPG versions
  gpg: porting secret keys from '/home/felix/.gnupg/secring.gpg' to gpg-agent
  gpg: key 783876E9182E8151: secret key imported
  gpg: key 44752F7C4D3D351A: secret key imported
  gpg: migration succeeded
  $ gpg --list-secret-keys
  $ Says it imported the secret keys, but doesn't show them.  Don't think it's
permissions; the only read-only files are options, gpg-agent.conf, and
.gpg-agent-info.  Killed gpg-agent; it restarted fine, but gpg still doesn't
show the secret keys.
I'll have to try the export-import angle later; the old machine is old enough
that physically copying files requires some legwork.

@_date: 2018-06-18 06:49:02
@_author: felix@crowfix.com 
@_subject: Upgrading 2.0.20 to 2.2.24 
$ gpg --list-secret-keys
  /home/felix/.gnupg/secring.gpg
  ------------------------------
  sec   1024D/182E8151 1999-12-06
  uid                  Felix Finch (Scarecrow Repairman)   ssb   2048g/A3362105 1999-12-06
  sec   1024D/4D3D351A 1999-12-06
  uid                  Felix Finch (Remote Access)   ssb   1024g/C2422DAD 1999-12-06
  $ gpg --list-keys
  /home/felix/.gnupg/pubring.gpg
  ------------------------------
  pub   1024D/182E8151 1999-12-06
  uid                  Felix Finch (Scarecrow Repairman)   sub   2048g/A3362105 1999-12-06
  pub   1024D/4D3D351A 1999-12-06
  uid                  Felix Finch (Remote Access)   sub   1024g/C2422DAD 1999-12-06
  $ ls -al .gnupg
  total 38
  drwx------  4 felix users  360 Jun 18 05:48 .
  drwx------ 68 felix users 5744 Jun 18 00:00 ..
  -r--------  1 felix users   42 Sep  3  2008 gpg-agent.conf
  -r--------  1 felix users   51 Sep  3  2008 .gpg-agent-info
  -r--------  1 felix users 2844 Nov 26  2004 options
  drwx------  2 felix users   48 Jun  7  2007 private-keys-v1.d
  -rw-------  1 felix users 2088 Jun  7  2012 pubring.gpg
  -rw-------  1 felix users 2072 Dec  5  1999 pubring.gpg~
  -rw-------  1 felix users  600 Jun 17 15:08 random_seed
  drwx------  2 felix users  152 Sep  3  2008 RCS
  -rw-------  1 felix users 2836 Dec  5  1999 secring.gpg
  -rw-------  1 felix users 1280 Jun  7  2012 trustdb.gpg
  $
  $ gpg --list-secret-keys
  $ gpg --list-keys
  /home/felix/.gnupg/pubring.kbx
  ------------------------------
  pub   dsa1024 1999-12-06 [SCA]
        E9874493C860246C3B1E6477783876E9182E8151
        uid           [ unknown] Felix Finch (Scarecrow Repairman)         sub   elg2048 1999-12-06 [E]
  pub   dsa1024 1999-12-06 [SCA]
        7689998F39D1EA2F37AECF5844752F7C4D3D351A
        uid           [ unknown] Felix Finch (Remote Access)         sub   elg1024 1999-12-06 [E]
  $ ls -al .gnupg
  total 192
  drwx------  4 felix felix  4096 Jun 18 05:52 .
  drwx------ 75 felix felix 32768 Jun 17 12:37 ..
  -r--------  1 felix felix    42 Sep  3  2008 gpg-agent.conf
  -r--------  1 felix felix    51 Sep  3  2008 .gpg-agent-info
  -rw-------  1 felix felix     0 Jun 18 05:52 .gpg-v21-migrated
  -r--------  1 felix felix  2844 Nov 26  2004 options
  drwx------  2 felix felix  4096 Oct 22  2017 private-keys-v1.d
  -rw-------  1 root  root  12226 Oct 22  2017 pubring.gpg
  -rw-------  1 root  root  12226 Oct 22  2017 pubring.gpg~
  -rw-------  1 felix felix  2484 Jun 17 13:44 pubring.kbx
  -rw-------  1 felix felix  1385 Jun 17 13:44 pubring.kbx~
  -rw-------  1 felix felix   600 Jun 17 15:17 random_seed
  drwx------  2 felix felix  4096 Sep  3  2008 RCS
  -rw-------  1 felix felix  2836 Dec  5  1999 secring.gpg
  -rw-------  1 felix felix  1280 Jun 17 14:54 trustdb.gpg
  $

@_date: 2018-06-19 13:31:58
@_author: felix@crowfix.com 
@_subject: Upgrading 2.0.20 to 2.2.24 
I tried both these steps, and neither changed anything.  Import said it
imported, but I have a saved copy of .gnupg, and there was no difference after
the import.  The re-migration recreated the .gpg-v21-migrated file, but also
made no difference.  Still can't see the secret keys or decrypt anything.

@_date: 2018-06-21 08:49:21
@_author: felix@crowfix.com 
@_subject: Upgrading 2.0.20 to 2.2.24 -- WORKING NOW 
Well I'll be that crazy monkey's crazy uncle!
I started from scratch -- copied the 2.0.20 .gnupg dir to the 2.2.24 machine,
and imported the secret key as the very first operation:
    $ gpg --import <182E8151.exported
    gpg: starting migration from earlier GnuPG versions
    gpg: porting secret keys from '/home/felix/.gnupg/secring.gpg' to gpg-agent
    gpg: key 783876E9182E8151: secret key imported
    gpg: key 44752F7C4D3D351A: secret key imported
    gpg: migration succeeded
    gpg: key 783876E9182E8151: "Felix Finch (Scarecrow Repairman)
    " not changed
    gpg: key 783876E9182E8151: secret key imported
    gpg: Total number processed: 1
    gpg:              unchanged: 1
    gpg:       secret keys read: 1
    gpg:  secret keys unchanged: 1
    $ gpg --list-secret-keys
    /home/felix/.gnupg/pubring.gpg
    ------------------------------
    sec   dsa1024 1999-12-06 [SCA]
          E9874493C860246C3B1E6477783876E9182E8151
    uid           [ultimate] Felix Finch (Scarecrow Repairman)     ssb   elg2048 1999-12-06 [E]
    sec   dsa1024 1999-12-06 [SCA]
          7689998F39D1EA2F37AECF5844752F7C4D3D351A
    uid           [ unknown] Felix Finch (Remote Access)     ssb   elg1024 1999-12-06 [E]
Of course this confused me, why would it matter that I imported and migrated
together?  So I started from scratch again with just --list-secret-keys, no
import, and it worked too.
I can only guess that the original copy of .gnupg was not copied correctly, or
got corrupted somehow.
And thanks to everyone who had the patience to deal with my problem.

@_date: 2018-09-17 14:03:24
@_author: Felix Finch 
@_subject: Washington State Electronic Notary Public endorsements 
Well done!  Any idea how applicable your experience will be in other states?

@_date: 2018-09-20 08:55:56
@_author: Felix Finch 
@_subject: Decryption timing calibration 
That is fascinating -- I did not know that decryption was calibrated
to take a certain amount of time.  Very interesting.  I hope I haven't
How much variation is there for a given calibration -- how do you
create generic canned packages for wide distribution?  Gentoo compiles
everything and could easily calibrate itself; RedHat, Debian, and most
others distribute binaries and can't.  I'd think that could lead to a
pretty wide range of decrypt times.

@_date: 2020-04-26 18:44:06
@_author: Felix Finch 
@_subject: Passphrase window freezes my DE's panel - is this a bug? 
FWIW, when I plug in a USB encrypted backup drive, it has a popup passphrase window which also locks out all other windows.  I show my passphrase and use CTRL-SHIFT-C to copy it before plugging in the drive, then use CTRL-SHIFT-V to paste it into the popup window.  I suppose this is not as secure as it should be, but it's good enough for me.

@_date: 2020-05-24 07:05:39
@_author: Felix Finch 
@_subject: Backup of Keys 
Out of curiosity ... how safe are these files as is, assuming the private key file has a good strong passphrase?  If they are backed up on a USB stick which gets lost and found by someone else, or stolen, how much damage can be done?  How hard is it to crack a good passphrase?  I realize that's kind of a loose question, and "strong passphrase" doesn't help.

@_date: 2020-05-24 10:38:25
@_author: Felix Finch 
@_subject: Backup of Keys 
Yes, it does.  My passphrase is about ten words which only make sense to me, not even to people who know me, are not grammatically correct, etc.

@_date: 2020-05-24 10:44:02
@_author: Felix Finch 
@_subject: Backup of Keys 
Yes, but then that needs a passphrase, and so on.  I'm trying to cut back on how many I have to remember.
