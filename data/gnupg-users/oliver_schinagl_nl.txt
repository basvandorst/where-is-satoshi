
@_date: 2019-02-25 07:54:33
@_author: Olliver Schinagl 
@_subject: gpg vs gpgv and trustedkeys 
While working on a little project, I found that there seems to be some discrepancy on how gpg and gpgv are to be used.
What I am trying to accomplish, is to generate an OS image, which contains a public gpg key. The public is added using gpg --import and kets added to the newly created pubkey.gpg.
However, the OS image has no need for the full blown gpg and happily uses gpgv. However gpgv fails with the (now) well known error that it cannot find the trustedkeys.gpg/kbx keyring/box.
The internet has some suggestions that it is needed for gpg to generate a special keyring and import the keys into there. However the options (no-default-keyring and/or --keyring) are not existant with the gpg tools (on alpine and debian) (anymore, I believe gpg1 did have them in the past?).
While gpgv still has the options, I don't think the intention was to always having to supply a custom keyring to gpgv.
And so it appears that the default used keyring between the generator and the validator are miss-matching.
Is this intended? If so, why? And what would be the reason for having the two separate keyrings anyway.
For now, I have simply added a hack in that the two files are symlinked, this atleast makes gpgv to work as a user would intend. I suppose the
alternative would be to rename the key after installation, but if that was the intention, I don't seem to see why the option to use a different keyring was removed from gpg to begin with.
Both my Alpine based gpg and gpgv are the same version, gpg (GnuPG) 2.1.18
P.S. Please keep me CC-ed as I am not subsribed.

@_date: 2019-02-27 21:10:36
@_author: Olliver Schinagl 
@_subject: gpg vs gpgv and trustedkeys 
Hey Daniel,
Well it is an embedded system, so the OS image is for the embedded
system. During development, engineers also login to the system and may
need to use the gpgv tool to check things. Having to point to the exact
file is just common cause of imstakes 'where was that file again' or 'oh
forgot'. But sure it is manageable, but.
Passing it via the argument is 'ok' wouldn't it be for that fact that
option was removed a while ago from gpg. So we where reluctant to use it
with gpgv as it too, could just dissapear.
Sure, but sometimes you don't care about the precise control; just that
it works as expected, which was my question was about. So I do thank you
a lot for taking the time to answer.
However, now that I have the solution (which I kinda guessed) it still
does not explain the discrepancy (and especially any text about it).
Simple example; I have my keys in my keychain generated/created via gpg.
Now I want to use gpgv to validate something, with my key, but now i
explicitly have to point it to the pubkey, because the default of gpgv
is trustedkey. So why the differences? Why are these not in sync, what
is the purpose? If the reason is to force the user to use the parameter,
why set a default, why set a default that does not match the generator.
Thanks :)

@_date: 2019-03-02 11:31:44
@_author: Olliver Schinagl 
@_subject: gpg vs gpgv and trustedkeys 
Well the actualy firmware image validation will be done via a script
there, so no worries on that regard. But if an engineer is tasked with
modifying any of these scripts, they may struggle to know what's going
on when invoking the tools themselves.
Oh I do agree here :)
I whole-heartedly agree now that I understand this more. As such
however, gpgv should really remove this feature all together. E.g.
always point to a keyring. The trustedkeys file is just confusing (and
the internet is only filled with confusion surounding this filename).
Many suggest to even just symlink the trustedkeys file to the pubkey files.
As there is no 'natural' way (or a suggestion in the documenation) to
create the trustedkeys file; It really probably is best to just remove
it al together.
Having said that, I'll didn't check/try; but what IS the best way to get
a key into a system. I can do gpg --import and move + package the file
of course; but is there a cleaner solution to get the file, into say
that paramater has come and gone in certain versions, so not sure how
reliable that one is). Or is it really the only and recommended way.
