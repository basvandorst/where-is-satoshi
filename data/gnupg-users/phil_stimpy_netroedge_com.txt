
@_date: 1999-08-30 17:05:10
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
OK, I've been tearing my hair out over a simple implementation of a Perl
CGI which uses GPG.  I've got this test CGI:
print "Content-type: text/html\n\n";
print "";
print `env`;
$temp=`echo "blah" | /usr/local/bin/gpg -a -e --yes --batch -r $myemail`;
print $temp;
If I run it on the command line (as the user which the web server runs
under), I get the expected out (i.e., the environment followed by my
encrypted 'blah'). If I run it as a CGI through Apache, I only get the environment and not
any encrypted message!  For some reason, GPG doesn't run when it is in a
CGI for me. :'( I've made sure that my key is available for the user which
the web server is running as, and have done everything else I can think
of. Somebody posted a Perl implementation a GPG form-mail thing which is close
to what I am doing, but I don't understand why my simple attempt above
doesn't work (or even report an error..).
Ideally, it would be cool if there was a Perl module which allowed Perl
access to GPG routines.  Does this exist?  Using back-ticks to get to the
shell is a drag (and not all that secure). :'p
Thanks in advance for any ideas/help.  In the mean-time, I'll try some
more things.... Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-08-31 12:02:21
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
OK, thanks to all the great suggestions and polite advice!  I managed to
get it partially working, but it wasn't very easy.  In the end, I used the
CPAN module for GPG mentioned by Frank (actually, it looks like he wrote
it! :'), but it had the same problems that I had in my own code. It worked
eventually, but I did have to modify the environment first:
As Alan suggested, the user which Apache was running under was indeed
'nobody' (as I expected).  I made a 'home directory' for this user to keep
things like GPG keys.  But, GPG still wasn't finding them.  Using the
"--homedir" parameter from within the script didn't work for some strange
reason (it worked from the command line...)!  I also noticed that it
wasn't mentioned on a 'gpg -h', so I thought it might have been
depricated or something?! In any event, using the environment setting above (and making sure
permissions were OK) fixed things.  But, I can not have the CGI
encrypt+sign successfully.  It automatically 'pops' back to interactive
mode prompting for the password for the secret key eventhough I supplied
it as CPAN specifies.  I know having the password in a script isn't very
secure, but it seems better than having the secret key w/o any password
protection. Thanks again for the help, and hopefully I can get encrypt+sign working
after some more fudging.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-08-31 13:44:19
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
Hey!  It works.  With a little help from Frank, I got everything working
great.  For those interested in doing some automated encypt+signing for
things like commerce servers, check out my simple CGI below:
use PGP::GPG::MessageProcessor;
print "Content-type: text/html\n\n";
$message[0]="This is just my bogus test message\n";
$message[1]="This is just my bogus test message line 2\n";
$messageProcessor = new PGP::GPG::MessageProcessor;
$messageProcessor->{extraArgs}   = [ '--homedir', '/home/nobody/.gnupg' ];
$messageProcessor->{encrypt} = 1;
$messageProcessor->{sign} = 1;   $messageProcessor->{recipients} = [$recipient];
$messageProcessor->{interactive} = 0;
$messageProcessor->{armor}       = 1;
$messageProcessor->{passphrase} = $passphrase;
$success    = $messageProcessor->cipher( \ );
print "";
print `env`;
print "testing-->\n\n";
print Thanks again!
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-08-30 17:05:10
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
OK, I've been tearing my hair out over a simple implementation of a Perl
CGI which uses GPG.  I've got this test CGI:
print "Content-type: text/html\n\n";
print "";
print `env`;
$temp=`echo "blah" | /usr/local/bin/gpg -a -e --yes --batch -r $myemail`;
print $temp;
If I run it on the command line (as the user which the web server runs
under), I get the expected out (i.e., the environment followed by my
encrypted 'blah'). If I run it as a CGI through Apache, I only get the environment and not
any encrypted message!  For some reason, GPG doesn't run when it is in a
CGI for me. :'( I've made sure that my key is available for the user which
the web server is running as, and have done everything else I can think
of. Somebody posted a Perl implementation a GPG form-mail thing which is close
to what I am doing, but I don't understand why my simple attempt above
doesn't work (or even report an error..).
Ideally, it would be cool if there was a Perl module which allowed Perl
access to GPG routines.  Does this exist?  Using back-ticks to get to the
shell is a drag (and not all that secure). :'p
Thanks in advance for any ideas/help.  In the mean-time, I'll try some
more things.... Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-08-31 12:02:21
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
OK, thanks to all the great suggestions and polite advice!  I managed to
get it partially working, but it wasn't very easy.  In the end, I used the
CPAN module for GPG mentioned by Frank (actually, it looks like he wrote
it! :'), but it had the same problems that I had in my own code. It worked
eventually, but I did have to modify the environment first:
As Alan suggested, the user which Apache was running under was indeed
'nobody' (as I expected).  I made a 'home directory' for this user to keep
things like GPG keys.  But, GPG still wasn't finding them.  Using the
"--homedir" parameter from within the script didn't work for some strange
reason (it worked from the command line...)!  I also noticed that it
wasn't mentioned on a 'gpg -h', so I thought it might have been
depricated or something?! In any event, using the environment setting above (and making sure
permissions were OK) fixed things.  But, I can not have the CGI
encrypt+sign successfully.  It automatically 'pops' back to interactive
mode prompting for the password for the secret key eventhough I supplied
it as CPAN specifies.  I know having the password in a script isn't very
secure, but it seems better than having the secret key w/o any password
protection. Thanks again for the help, and hopefully I can get encrypt+sign working
after some more fudging.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-08-31 13:44:19
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
============================== START ==============================
Hey!  It works.  With a little help from Frank, I got everything working
great.  For those interested in doing some automated encypt+signing for
things like commerce servers, check out my simple CGI below:
use PGP::GPG::MessageProcessor;
print "Content-type: text/html\n\n";
$message[0]="This is just my bogus test message\n";
$message[1]="This is just my bogus test message line 2\n";
$messageProcessor = new PGP::GPG::MessageProcessor;
$messageProcessor->{extraArgs}   = [ '--homedir', '/home/nobody/.gnupg' ];
$messageProcessor->{encrypt} = 1;
$messageProcessor->{sign} = 1;   $messageProcessor->{recipients} = [$recipient];
$messageProcessor->{interactive} = 0;
$messageProcessor->{armor}       = 1;
$messageProcessor->{passphrase} = $passphrase;
$success    = $messageProcessor->cipher( \ );
print "";
print `env`;
print "testing-->\n\n";
print Thanks again!
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-01 09:51:26
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
$messageProcessor->{extraArgs}   = [ '--homedir /home/nobody/.gnupg' ];
$messageProcessor->{extraArgs}   = [ '--homedir', '/home/nobody/.gnupg' ];
I had on my RedHat6.0 machine (which Frank couldn't reproduce on his
FreeBSD box) was a problem which produces repetitive output if a print
ending in a '\n' wasn't before calling:
$success = $messageProcessor->cipher( \
print "hi there\n";
$success = $messageProcessor->cipher( \
print "hi there";
$success = $messageProcessor->cipher( \
[...]hi therehi there[...]
from what I can tell.  It isn't hard to avoid once it is known, though.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-08 09:14:04
@_author: phil@Stimpy.netroedge.com 
@_subject: gnupg on AIX 
I think that's a bug in 2.8.1... I had 2.8.1 for a few months and found
out that it has problems with it (the issue you are seeing below, problems
with the iostreams lib, etc.). Use egcs instead, it's actually the new
home of gcc anyway, so if you want the newer version of gcc then you want
egcs:   Hopefully you can get it working under AIX
w/o too many problems.
Good luck!
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-09 15:07:36
@_author: phil@Stimpy.netroedge.com 
@_subject: CNN 
Wow.  Very cool.  Congrats, guys! :')
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-13 14:10:18
@_author: phil@Stimpy.netroedge.com 
@_subject: rsaref library - where? 
reading a 'read-me' file first to get the path to download it (to force
you to read the license).  It's around somewhere, I know that there is
some info on how to get it in some SSL libraries for Apache.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-16 19:02:42
@_author: phil@Stimpy.netroedge.com 
@_subject: iButton Crypto (Slightly off topic) 
Has anybody played with the iButton products?
They seem like coin shaped devices (sealed and waterproof) which can
transfer information (temperature, crypto, etc.) wirelessly by placing it
near a 'recepter' which is connected to either the parallel or serial port
of a machine.  A Linux SDK is supposed to be available, as are all the
data sheets (Dallas Semi makes a majority of the products).
Uses include recording history data (like temperatures) and holding other
data, or using them for doing authentication for accessing sensitive
servers and such.  Their 'Java' iButton can do some crypto stuff which
sounds interesting.
I ordered an evaluation kit for $25 (USD) for kicks.  Since the obvious
use was for authentication, I though some poeple on the GPG list might be
interested in hearing about this, too.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-20 13:23:57
@_author: phil@Stimpy.netroedge.com 
@_subject: Changing passphrase and associated IDs 
Read the man page.  Specificly the '--edit-key name' option.  This does
everything you asked..... RTFM! :')
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-23 20:03:22
@_author: phil@Stimpy.netroedge.com 
@_subject: PGP compatibility 
To my understanding, there isn't much you can do if you really want to
stick with GPG but still use RSA keys.
If you are using this stuff for non-profit purposes, you can use RSA's pgp
for Linux (  Or, you could try to buy it from McAfee or
Network Associates.  The odd thing is that I had a tough time trying to
find a commercial version of PGP for Linux.  I needed it for work a while
ago, but never found a place which sold it for Linux.... so, I just went
w/ GPG instead (no RSA keys was OK for my use). ....which leads me to the suggestion: Why not use the freeware version of
PGP for commercial use?  The license says to buy the commercial version
for profit uses, but it doesn't seem to exist!  Who's around to press
charges (hasn't RSA been bought out a couple times [McAfee and Network
Associates?]), and what could they do (i.e., what motivation would they
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-01 09:51:26
@_author: phil@Stimpy.netroedge.com 
@_subject: Scripting and CGI use of GPG 
$messageProcessor->{extraArgs}   = [ '--homedir /home/nobody/.gnupg' ];
$messageProcessor->{extraArgs}   = [ '--homedir', '/home/nobody/.gnupg' ];
I had on my RedHat6.0 machine (which Frank couldn't reproduce on his
FreeBSD box) was a problem which produces repetitive output if a print
ending in a '\n' wasn't before calling:
$success = $messageProcessor->cipher( \
print "hi there\n";
$success = $messageProcessor->cipher( \
print "hi there";
$success = $messageProcessor->cipher( \
[...]hi therehi there[...]
from what I can tell.  It isn't hard to avoid once it is known, though.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-08 09:14:04
@_author: phil@Stimpy.netroedge.com 
@_subject: gnupg on AIX 
I think that's a bug in 2.8.1... I had 2.8.1 for a few months and found
out that it has problems with it (the issue you are seeing below, problems
with the iostreams lib, etc.). Use egcs instead, it's actually the new
home of gcc anyway, so if you want the newer version of gcc then you want
egcs:   Hopefully you can get it working under AIX
w/o too many problems.
Good luck!
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-09 15:07:36
@_author: phil@Stimpy.netroedge.com 
@_subject: CNN 
Wow.  Very cool.  Congrats, guys! :')
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-13 14:10:18
@_author: phil@Stimpy.netroedge.com 
@_subject: rsaref library - where? 
reading a 'read-me' file first to get the path to download it (to force
you to read the license).  It's around somewhere, I know that there is
some info on how to get it in some SSL libraries for Apache.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-16 19:02:42
@_author: phil@Stimpy.netroedge.com 
@_subject: iButton Crypto (Slightly off topic) 
Has anybody played with the iButton products?
They seem like coin shaped devices (sealed and waterproof) which can
transfer information (temperature, crypto, etc.) wirelessly by placing it
near a 'recepter' which is connected to either the parallel or serial port
of a machine.  A Linux SDK is supposed to be available, as are all the
data sheets (Dallas Semi makes a majority of the products).
Uses include recording history data (like temperatures) and holding other
data, or using them for doing authentication for accessing sensitive
servers and such.  Their 'Java' iButton can do some crypto stuff which
sounds interesting.
I ordered an evaluation kit for $25 (USD) for kicks.  Since the obvious
use was for authentication, I though some poeple on the GPG list might be
interested in hearing about this, too.
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-20 13:23:57
@_author: phil@Stimpy.netroedge.com 
@_subject: Changing passphrase and associated IDs 
Read the man page.  Specificly the '--edit-key name' option.  This does
everything you asked..... RTFM! :')
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 1999-09-23 20:03:22
@_author: phil@Stimpy.netroedge.com 
@_subject: PGP compatibility 
To my understanding, there isn't much you can do if you really want to
stick with GPG but still use RSA keys.
If you are using this stuff for non-profit purposes, you can use RSA's pgp
for Linux (  Or, you could try to buy it from McAfee or
Network Associates.  The odd thing is that I had a tough time trying to
find a commercial version of PGP for Linux.  I needed it for work a while
ago, but never found a place which sold it for Linux.... so, I just went
w/ GPG instead (no RSA keys was OK for my use). ....which leads me to the suggestion: Why not use the freeware version of
PGP for commercial use?  The license says to buy the commercial version
for profit uses, but it doesn't seem to exist!  Who's around to press
charges (hasn't RSA been bought out a couple times [McAfee and Network
Associates?]), and what could they do (i.e., what motivation would they
Philip Edelbrock -- IS Manager -- Edge Design, Corvallis, OR
   phil --  PGP F16: 01 D2 FD 01 B5 46 F4 F0  3A 8B 9D 7E 14 7F FB 7A

@_date: 2000-04-20 13:00:25
@_author: phil@Stimpy.netroedge.com 
@_subject: RES: Secure connections 
Almost related: For machines which do a lot of encrypting based on
random numbers (VPN routers, SSL web servers, etc.), are there
hardware products which can produce lots of high-quality random
numbers?  The kernel /dev/random works well, but sometimes it can run
out of data, and the server will lag. I'm interested in what you people think.

@_date: 2000-04-26 10:01:48
@_author: phil@Stimpy.netroedge.com 
@_subject: mailing list 
Sorry to add to the non-relavent thread, but I've been stuck here for
some time.  Accept your fate.  You can't escape.  (But, if you do,
please let me know how.)
I think Majordomo isn't set up correctly.  I manage my own lists, so I
know how it *should* work.  Some of the info requests I've made from
majordomo bounce, and it claims I'm not on any of it's lists
eventhough I get mail from gnupg-users (as I signed up for a while

@_date: 2000-04-20 13:00:25
@_author: phil@Stimpy.netroedge.com 
@_subject: RES: Secure connections 
Almost related: For machines which do a lot of encrypting based on
random numbers (VPN routers, SSL web servers, etc.), are there
hardware products which can produce lots of high-quality random
numbers?  The kernel /dev/random works well, but sometimes it can run
out of data, and the server will lag. I'm interested in what you people think.

@_date: 2000-04-26 10:01:48
@_author: phil@Stimpy.netroedge.com 
@_subject: mailing list 
Sorry to add to the non-relavent thread, but I've been stuck here for
some time.  Accept your fate.  You can't escape.  (But, if you do,
please let me know how.)
I think Majordomo isn't set up correctly.  I manage my own lists, so I
know how it *should* work.  Some of the info requests I've made from
majordomo bounce, and it claims I'm not on any of it's lists
eventhough I get mail from gnupg-users (as I signed up for a while

@_date: 2000-01-27 14:07:08
@_author: phil@Stimpy.netroedge.com 
@_subject: sdk library available 
There is some information here on the new US crypto exports law(s):
I'm not really sure what the details are (I haven't read heavily into
it yet).  Could somebody post a general summary?

@_date: 2000-01-27 14:07:08
@_author: phil@Stimpy.netroedge.com 
@_subject: sdk library available 
There is some information here on the new US crypto exports law(s):
I'm not really sure what the details are (I haven't read heavily into
it yet).  Could somebody post a general summary?

@_date: 2000-03-02 14:09:08
@_author: phil@Stimpy.netroedge.com 
@_subject: Mailing List Removal Instructions Request 
Hello, sorry to take this off-topic, but there have been some users
(including myself) which have had trouble getting removed from this
mailing list.  I'm familiar with Majordomo (I admin my own Majordomo
lists), but this one seems to be set up incorrectly.  The unsubscribe
command (even 'unsubscribe *') fails to work, and the admin addresses
Are there some sure-fire instructions for being removed from the list?

@_date: 2000-03-30 21:57:15
@_author: phil@Stimpy.netroedge.com 
@_subject: Collecting entropy? 
Speaking of which: Has anyone got experience using some hardware based
entropy sources?  I.e., I've heard of ISA/PCI cards which use
variations in wind currents/radio traffic/etc. to produce a plethera
of random data.  This could be useful to a server which depends on
lots of random data (like a box which encrypts a lot of web pages,
provides VPN, etc.).  Any Linux supported devices?  Would anyone like
to help me design/make one to market and sell? =')

@_date: 2000-03-02 14:09:08
@_author: phil@Stimpy.netroedge.com 
@_subject: Mailing List Removal Instructions Request 
Hello, sorry to take this off-topic, but there have been some users
(including myself) which have had trouble getting removed from this
mailing list.  I'm familiar with Majordomo (I admin my own Majordomo
lists), but this one seems to be set up incorrectly.  The unsubscribe
command (even 'unsubscribe *') fails to work, and the admin addresses
Are there some sure-fire instructions for being removed from the list?

@_date: 2000-03-30 21:57:15
@_author: phil@Stimpy.netroedge.com 
@_subject: Collecting entropy? 
Speaking of which: Has anyone got experience using some hardware based
entropy sources?  I.e., I've heard of ISA/PCI cards which use
variations in wind currents/radio traffic/etc. to produce a plethera
of random data.  This could be useful to a server which depends on
lots of random data (like a box which encrypts a lot of web pages,
provides VPN, etc.).  Any Linux supported devices?  Would anyone like
to help me design/make one to market and sell? =')
