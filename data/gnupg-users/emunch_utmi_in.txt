
@_date: 2014-09-12 18:33:53
@_author: Sam M 
@_subject: Automated Batch Subkey Creation 
I'm new to the list. I have some familiarity with GPG and have a particular
requirement. I really hope someone can point me to where I can get more
information on this or let me know if this is not possible.
I have to automate the following task. The result I am looking to get is a
master key pair with four sub-keys, one for encryption, two for signing and
one for authentication. Each sub-key also has to have a revocation key. I
have to do this in an automatic manner. In addition to this, I need to
separate out one signing key and the authentication key into separate files.
I have to do this in batch mode since human intervention is not possible.
At this point, I have understood how to make a master key with one sub-key
in batch mode. The GPG command and the batch file are fromhttps://
How can I automate the creation of a sub-key?
Thanks in advance.
cat >foo <

@_date: 2014-09-13 11:54:43
@_author: Sam M 
@_subject: Automated Batch Subkey Creation 
Hello Werner.
Thanks for your help.
Where can I find the GPA code? Examples would be very helpful.

@_date: 2014-09-13 16:53:09
@_author: Sam M 
@_subject: Automated Batch Subkey Creation 
I'm not a programmer, so I don't know much about source code. But I had
downloaded the code for GPA. And to try and find an example, I did a grep
on the option command-fd. I didn''t find anything.
I would be grateful if you could point out the example you're referring to,
or just give me one.

@_date: 2014-09-16 17:38:56
@_author: Sam M 
@_subject: Multiple Subkeys for different Uses 
After generating a master key, I generated 3 subkeys, one for encryption,
one for signing and one for authentication. Now, when I import the three
subkeys into the same (non-default) keyring, only one is showing up in the
key listing or when I try and edit the keys.
Is this normal behaviour?

@_date: 2014-09-16 17:53:19
@_author: Sam M 
@_subject: Automated Batch Subkey Creation 
Security and encryption is difficult, and users are not usually up to
trying to figure out the details. As long as an external audit tells them
their information is safe, they are happy. They don't want to go into the
I have a particular use case that I have been working on for a B2B site.
Thus the interest.
But even in my case, once the keys have been generated and distributed, I
will not need the scripting.
Thanks all for your help here. I have been able to get Hauke's script
working for me.
Another item I wished to automate was the generation of a revocation key,
both for the master key as well as subkeys. But this does not seem to be
possible. I'm always asked for a passphrase. I'll post this in a separate
Thanks all.

@_date: 2014-09-16 17:58:51
@_author: Sam M 
@_subject: Automated Revocation Key Generation 
Am trying to generate revocation keys for master/sub keys. But I'm always
asked for a password.
I'm using the following -
touch "revf"
echo "y" >> "revf"
echo "0" >> "revf"
echo "No reason specified" >> "revf"
echo "" >> "revf"
echo "y" >> "revf"
echo >> "revf"
gpg2 --expert --no-default-keyring --secret-keyring $seckey --keyring
$pubkey --command-fd 0 --output ${a}.gpg-revocation-certificate --armor
--gen-revoke "${a}" < $revf
This works, but can I automatically provide GPG with a passphrase which it
asks for at the end?

@_date: 2014-09-16 18:38:42
@_author: Sam M 
@_subject: Multiple Subkeys for different Uses 
I'll try, with the example.
Commands are in Courier bold, output in Courier. My notes are in normal
*gpg2 --expert --no-default-keyring --secret-keyring $seckey --keyring
$pubkey --display-charset utf-8 --command-fd 0 --status-fd 2 --edit
Secret key is available.
pub  4096R/A6213A0EC2D5F16F  created: 2014-09-15  expires: never
usage: SCEA
                             trust: unknown       validity: unknown
sub  2048R/8740BCECEE51D37A  created: 2014-09-15  expires: never
usage: SEA
sub  2048R/94A665734DBA1287  created: 2014-09-15  expires: 2016-09-14
 usage: E
sub  2048R/BE16484BDA38CCA1  created: 2014-09-15  expires: 2016-09-14
 usage: E
sub  2048R/2DBE6F0BEDA58669  created: 2014-09-15  expires: 2016-09-14
 usage: S
sub  2048R/64335E67B5441EC7  created: 2014-09-15  expires: 2016-09-14
 usage: S
sub  2048R/CAD36405FD140940  created: 2014-09-15  expires: 2016-09-14
 usage: A
sub  2048R/1A6033CAA3C19BE3  created: 2014-09-15  expires: 2016-09-14
 usage: A
[ unknown] (1). Test Key (with stupid password) gpg> toggle
sec  4096R/A6213A0EC2D5F16F  created: 2014-09-15  expires: never
ssb  2048R/8740BCECEE51D37A  created: 2014-09-15  expires: never
ssb  2048R/94A665734DBA1287  created: 2014-09-15  expires: never
ssb  2048R/BE16484BDA38CCA1  created: 2014-09-15  expires: never
ssb  2048R/2DBE6F0BEDA58669  created: 2014-09-15  expires: never
ssb  2048R/64335E67B5441EC7  created: 2014-09-15  expires: never
ssb  2048R/CAD36405FD140940  created: 2014-09-15  expires: never
ssb  2048R/1A6033CAA3C19BE3  created: 2014-09-15  expires: never
(1)  Test Key (with stupid password) For each of the subkeys of interest, I did the following ("a" being the
looping variable) -
*echo "$passphrase" | gpg2 --expert --batch --no-default-keyring
--secret-keyring $seckey --keyring $pubkey --display-charset utf-8
--passphrase-fd 0 --export-secret-subkeys --no-tty --armor --export-options
export-reset-subkey-passwd ${a}! > ${master_key}.${a}.private.subkeys ; *
This gives me 3 files that I want in a separate keyring (listed below with
MD5) -
 A6213A0EC2D5F16F.94A665734DBA1287.private.subkeys
 A6213A0EC2D5F16F.2DBE6F0BEDA58669.private.subkeys
 A6213A0EC2D5F16F.CAD36405FD140940.private.subkeys
I then import these subkeys -
*$ gpg2 --expert --no-default-keyring --secret-keyring ${seckey}.1
--keyring ${pubkey}.1 --import
gpg: keyring `_keyring.sec.1' created
gpg: keyring `_keyring.pub.1' created
gpg: key A6213A0EC2D5F16F: secret key imported
gpg: key A6213A0EC2D5F16F: public key "Test Key (with stupid password) <
test02.testco at tradeboox.net>" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
*$ gpg2 --expert --no-default-keyring --secret-keyring ${seckey}.1
--keyring ${pubkey}.1 --import
gpg: key A6213A0EC2D5F16F: already in secret keyring
gpg: Total number processed: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
*$ gpg2 --expert --no-default-keyring --secret-keyring ${seckey}.1
--keyring ${pubkey}.1 --import
gpg: key A6213A0EC2D5F16F: already in secret keyring
gpg: Total number processed: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
For the listing, I am expecting to see 3 subkeys, but I'm only seeing one,
the very first imported -
*$ gpg2 --expert --no-default-keyring --secret-keyring $seckey.1 --keyring
$pubkey.1 --list-keys*

@_date: 2014-09-16 20:36:03
@_author: Sam M 
@_subject: Automated Revocation Key Generation 
and --password-fd are only usable with --batch.
On 16 September 2014 20:01, Daniel Kahn Gillmor

@_date: 2014-09-16 22:17:12
@_author: Sam M 
@_subject: Automated Revocation Key Generation 
I'm sorry, but that went WAY above my head. :)
OK let me try generating keys w/o passphrase and see if it works.
On 16 September 2014 22:07, Hauke Laging

@_date: 2014-09-27 18:48:34
@_author: Sam M 
@_subject: Symmetric & Encrypt in One 
I'd like to encrypt a file with a password as well as multiple public keys.
Is this possible? Will this command below work?
echo "$PW" | gpg2 --batch --passphrase-fd 0 --symmetric --encrypt
--recipient 432E170D279095 --recipient 07EAE49ADBCBE671 --always-trust
--output file.gpg file

@_date: 2014-09-30 14:01:39
@_author: Sam M 
@_subject: Keyserver on FreeIPA 
============================== START ==============================
Not strictly a GPG question, but posting anyway.
I need to test setting up of a private GPG keyserver integrated with a
FreeIPA server. Has anyone done this and had success? I'm trying to figure
out how to integrate the PGP keyserver schema into the server and am not
sure if I'm on the right track.
I also need to integrate the GPG public keys with the user data in the
