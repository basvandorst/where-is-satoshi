
@_date: 2011-01-13 18:59:18
@_author: Ole Rixmann 
@_subject: parsing gpg-key block 
Hi list,
this is my first post ;)
I need to check gpg-rsa-signatures in JavaScript and for this to happen
i have
to parse key blocks produced with
"gpg --armor --export-options export-minimal --export 0xid".
To do the checking i need the rsa-parameters (like n and g) but i have
no clue how to extract them.
With "gpg --debug-all --list-packets keyfile" i get a whole lot of stuff
and i think the parameters are in there ;)
but it doesn't look good.
So maybe someone can give me a hint?
I would also be interested in information about exactly how gpg does
signing wit rsa/sha-1.
Thanks a lot,

@_date: 2011-01-22 16:39:10
@_author: Ole Rixmann 
@_subject: parsing gpg-key block 
Hi Group,
i am very thankfull for the information i got about the rfc from dkg.
But now i have a problem which i can't solve with the rfc, so maybe
someone can help me again ;)
I am parsing a clear-signed signature of a text document (signature-type
0x01), the data to be signed is a json-string without newlines.... so
nothing to replace with .
and the first 16 bits of my hash never match the first 16 bits provided
from the signature.... and as it is with hashs its hard to debug what is
wrong with my input...
a piece of example-data that i want to check:
{"2011-01-13 13:00":"cno","2011-01-13
14:00":"cno","2011-01-14":"cno","2011-01-15 13:00":"cno"}
this is prepended to the part of the signature-packet which is described
in section 5.2.4, although i'm not sure about my byte-array to string
conversion, but i first want to make sure that i'm not missing some
newlines or other data from the signed text....
maybe i should prepend this ?
(without the lines starting with -----) ?
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
{"2011-01-13 13:00":"cno","2011-01-13
14:00":"cno","2011-01-14":"cno","2011-01-15 13:00":"cno"}
-----BEGIN PGP SIGNATURE-----
or the json-string with a newline at the end?
Thanks in advance,
Ole Rixmann
Am 14.01.11 00:19, schrieb Daniel Kahn Gillmor:

@_date: 2011-01-24 14:05:10
@_author: Ole Rixmann 
@_subject: checking gpg-signatures in JavaScript 
Hi List,
i wrote already 2 Mails and got some help but i don't get any further by
I want to check gpg-clearsigned-signatures in JS,  and with the rfc
 i had some success.
The problem that i have right now is to produce the Hash-value which is
to be signed (to be checked).
I have an example to state my problem:
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
{"2011-01-13 13:00":"cno","2011-01-13
14:00":"cno","2011-01-14":"cno","2011-01-15 13:00":"cno"}
The content-part is this (as i understand the rfc):
{"2011-01-13 13:00":"cno","2011-01-13
14:00":"cno","2011-01-14":"cno","2011-01-15 13:00":"cno"}
This has to be concatenated with some data from the header of the
clearsigned Packet, i have:
4,1,1,2,0,6,5,2,77,60,187,63 (as byte-array) which looks sound
The Hash (SHA1) i get for the concatenation is:
but the first 16 bits from the hash (included in the header) are:
The whole value from which the hash is calculated (as byte-array because
some chars may change due to encoding):
This can be inserted on a site like
 to check the SHA1 value and from
what i see my SHA1 is correct.
I would be really happy if someone with knowledge of the implementation
could reproduce my values and tell me where i went wrong :)
I could give anyone with interest in it the code and would be willing to
opensource it when i have my work finished...
The system i'm working on is like  except that userdata is
encrypted and signed in the browser, i'm a student of computer science
so its more a proof of concept.
Thanks in advance,
Ole Rixmann
