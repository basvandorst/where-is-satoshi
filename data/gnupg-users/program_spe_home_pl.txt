
@_date: 2008-02-01 09:58:12
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Dear friends:
I have a file that I encrypted for myself and I want to read some information from it.  The file is a text file and I need to read several lines of it.
The following requirements must be met:
1. The decrypted information must not make it to any persistent medium (I understand gpg '-d' already guarantees it as long as it manages the decrypted text,
 but what happens after it leaves gpg?)
2. The decrypted text must not be stored in volatile memory any longer than it is needed.  In particular, it should be converted to a human-viewable bitmap and the computer-readable representation must be immediately erased.
3. Only the information I need should be displayed.
4. The bitmap must not be updated automatically (the containing window must not display it when it is in the background, whatever it means).
(It would be best to forget the bitmap altogether and regenerate it upon request, but it seems to be a hard thing to do
because the gpg output stream is not scrollable backwards).
The bitmap itself should not make it to any persistent medium
and it should be scrambled, if possible, in the volatile memory.
6. It should not be possible to make a snapshot of the graphic in the window with any programmatic means (you can of course make a picture of the screen with a camera).
7. If more information is requested, it should be displayed in small chunks.  The program should be fully unaware of the content of the chunks that are not being displayed.
(That probably means a garbage-collected language cannot be used).
8. The application should be as lightweight as possible (for source code audit).
Can you direct me to some implementation meeting these requirements?
Best regards,

@_date: 2008-02-05 19:10:35
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Dnia 05-02-2008, Wt o godzinie 11:36 -0600, Robert J. Hansen pisze:
GnuPG claims it locks memory pages so that they are never dumped.
I just thought the answer would be quick, straightforward and positive, and that there should exist such highly confidential software on top of GnuPG.  Since nothing of this sort was mention on the Web page, I dared ask.
Well, it seems it is impossible to prohibit taking a screen shot;
hopefully a user mode application cannot do this without a kernel driver.
Thanks a lot, mine is going to be the first :-) (although I am quite surprised
because the requirements are quite obvious to me; for what is the benefit of encryption when a bad robot can read over your shoulder?)
For the time being, I am inclined to implement the following scheme:
1. Open a new console session.
2. Run gpg '-d' | fgrep
3. Read the result.
4. Close the session.
This obviously does not meet the requirements because the text mode console driver stores the content of the console in a character buffer and does not do all the funny things with scrambling and all.
The mitigating factor is, as always, that the session is short-lived.

@_date: 2008-02-06 09:14:58
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Thanks a lot for the keywords, the hints and the missing parts.  Indeed, I hoped that such an application did not need a custom implementation because IMHO encrypting information is useless if you cannot view the information without exposure to eavesdropping or tracing.
I have to review what is available and what is needed before I can come up with a budget.
Specific comments below.
Thx, Chris
Dnia 06-02-2008, ?r o godzinie 02:22 +0100, Philipp G?hring pisze:
That is overkill if it only can be avoided.
In this particular case, Do-What-I-Mean means displaying only matching information ? la fgrep.  The keywords are not secret.
I shall consider that but I do not like this idea at the first glance; I am afraid there would be some maintenance overhead.
I thought GnuPG-encrypted files are immutable, aren't they?

@_date: 2008-02-06 16:48:17
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Dnia 06-02-2008, ?r o godzinie 10:03 -0500, Steve Revilak pisze:
Yep, that is my current workaround, sort of, in a dedicated xterm.
That is basically what I had in mind.
That requires a specialised hardware device; I am more interested in a software solution for the time being because I think it is more convenient and versatile.
Of course, if I would have to guard something really dangerous, like ICBM launcher codes, I would choose a hardware solution (and I would not ask the members of this mailing list).
Certainly, but it is not always possible temporarily, and it is almost always impossible once and for all.
And unplugging everything for a short time does not really help.
I did not intend to address this problem at all.
Good point, it can even be a Free DOS floppy disk with a RAM disk driver.  I have not thought of that.

@_date: 2008-02-13 11:41:53
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Dnia 12-02-2008, Wt o godzinie 11:59 +0100, Anders Breindahl pisze:
Full disk encryption makes the system unnecessarily slow, especially if applied to swap space.  I am seeking an intermediate solution for desktop computers
where the amount of confidential data is small.  The system as a whole should not be affected (unless, of course, it is a dedicated device, but that is another story).
That is right.
Certainly.  But unless the intruder is a root-kit, it cannot run a continuous memory scan unnoticed.  On the other hand, immediate disposal of intermediate data can make casual inspection harder.
Admittedly the protection will never be perfect but I would like it to be as good as can be.
If you are so kind, or just the idea if you do not want it to be adapted and published.
It is not because it keeps encrypted data in memory.
As you wish.

@_date: 2008-02-15 14:31:01
@_author: Krzysztof =?UTF-8?Q?=C5=BBelechowski?= 
@_subject: Safe decryption with GnuPG? 
Dnia 14-02-2008, Cz o godzinie 22:02 +0100, Anders Breindahl pisze:
Good guess, the idea of purging sensitive data from memory as soon as possible comes from our favourite bug provider indeed.
I never intended to make impression I want security by obscurity.  I am sorry you have perceived my question this way; it seems I should have formulated it better.
Quite interesting, although make_hard_to_read really should drop the ASCII encoding, as far as I am concerned.  I like Steve's idea of using banner for that purpose
where no better tool is available.
Alternatively, we could convert it on the fly to image/png and send it to Firefox as a data URL (that is, without saving).
Note: no "backupping" (backing up, if you please :-)
Thx a 107, Chris.
