
@_date: 2020-09-09 15:22:18
@_author: =?UTF-8?Q?Martin_P=c3=a4tzold?= 
@_subject: private-keys-v1.d and preserve-permissions 
I am working with Debian Stretch (9.13) and GPG 2.1.18.
The "private-keys-v1.d" directory has per default the permissions 700 (drwx------), but I need them to be 770 (drwxrwx---). I can change the permissions ($ chmod 770 private-keys-v1.d) but after some time they are be back to 700.
According to the documentation ( there is an option "--preserve-permissions" with the description "Don't change the permissions of a secret keyring back to user read/write only." I assumed that is what I need and added this option as "preserve-permissions\n" to the "gpg.conf" file.
But it is not working as expected. When I stop the gpg-agent ($ gpgconf --kill gpg-agent) and trigger its restart ($ gpg -K), the permissions are back to 700. (I also checked, that the gpg.conf file is in fact used.)
Where am I wrong here? Is the setting not what I need, or do I set it incorrectly, or do I test it incorrectly?
And if the setting is not what I need, how can I prevent the permissions for "private-keys-v1.d" from changing?

@_date: 2020-09-10 10:34:37
@_author: =?UTF-8?Q?Martin_P=c3=a4tzold?= 
@_subject: private-keys-v1.d and preserve-permissions 
Thanks for the clarification and the patch.
 > Is there a special reason that you need to give group access to those
 > files?
Yes, we have some period tasks that are handled by Celery. Celery has its own user on the system and this user needs at least read access to the keys, therefore we had to extend the permissions for the "private-keys-v1.d" directory to group access.

@_date: 2020-09-10 11:13:34
@_author: =?UTF-8?Q?Martin_P=c3=a4tzold?= 
@_subject: private-keys-v1.d and preserve-permissions 
>> Yes, we have some period tasks that are handled by Celery. Celery has
 >> its own user on the system and this user needs at least read access to
 >> the keys, therefore we had to extend the permissions for the
 >> "private-keys-v1.d" directory to group access.
 >
 > Long shot: does your system support ACLs?
Using ACL would be possible, but we are reluctant to do so, since it adds a second permissions layer that is only visible if you actively look for it.

@_date: 2020-09-10 13:46:12
@_author: =?UTF-8?Q?Martin_P=c3=a4tzold?= 
@_subject: private-keys-v1.d and preserve-permissions 
>>> Long shot: does your system support ACLs?
 >>
 >> Using ACL would be possible, but we are reluctant to do so, since it
 >> adds a second permissions layer that is only visible if you actively
 >> look for it.
 >
 > Perhaps I am not understanding this correctly, but wouldn't that be a
 > good thing?
Not from a maintenance perspective. This would be the only exception in permission handling across all of our platforms and it is not immediately visible. Six or twelf months from now we may not remember this exception and may lose a lot of time debugging if we don't look into the documentation early enough.
