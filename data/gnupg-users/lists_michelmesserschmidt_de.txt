
@_date: 2008-04-02 23:58:06
@_author: Michel Messerschmidt 
@_subject: Using CCID and PCSC 
Hello, is there a possibility to force gnupg 2 to use the internal CCID
smartcard driver even if pcscd is running (something like the --disable-ccid option but for pcsc) ?
I have a SCM SPR532 reader and like to use the pinpad. But it's deactivated if pcscd is running.

@_date: 2008-04-21 10:23:14
@_author: Michel Messerschmidt 
@_subject: changing the default keyring location in windows 
Hash: SHA1
You can either set
or add/change the entry "HomeDir" in the registry under the key

@_date: 2008-04-24 07:56:02
@_author: Michel Messerschmidt 
@_subject: Miscellaneous questions 
What about second/third ... names, name changes (e.g. marriage),
offical pseudonyms (e.g. artist names in Germany), ... ?
I think you're confusing the "completeness" of the identity with the
complete name. Although commonly used, a name is not a good measure for identity.
For example, I have different spellings of my name on different official ID cards :)
If you require a mathematical completeness, use the key ID.
If used for mail encryption/signatures it makes no sense to be more
strict than for the email address itself.

@_date: 2008-04-24 08:26:48
@_author: Michel Messerschmidt 
@_subject: OpenPGP card stopped working 
Just updated my Debian Lenny system this morning, but the cardman 4040
is still working with gpg and gpg2.
But I noticed, that mail signing fails with a similar error, if I just start the mail client. After executing "gpg --card-status" in another
terminal, everything works fine.
Can you post some configuration details ?
$ pccardctl info
PRODID_2="CardMan 4040"
$ pccardctl status
Socket 0:
  5.0V 16-bit PC Card
  Subdevice 0 (function 0) bound to driver "cm4040_cs"
$ cat /etc/udev/gnupg-ccid.rules # CardMan 4040 (PCMCIA device)
ACTION=="add", SUBSYSTEM=="cardman_4040", GROUP="scard", MODE="0660"
Package version should be the same in sid and lenny at the moment:
ii  gnupg               1.4.6-2.1           GNU privacy guard - a free PGP replacement
ii  gnupg2              2.0.9-1             GNU privacy guard - a free PGP replacement
ii  gpgv                1.4.6-2.1           GNU privacy guard - signature verification tool
ii  hal                 0.5.11~rc2-1        Hardware Abstraction Layer
ii  libccid             1.3.5-1             PC/SC driver for USB CCID smart card readers
ii  libgcrypt11         1.4.0-3             LGPL Crypto library - runtime library
ii  libgpg-error0       1.4-2               library for common error values and messages in GnuPG ii  libpcsclite1        1.4.100-3           Middleware to access a smart card using PC/SC (library
ii  udev                0.114-2             /dev/ and hotplug management daemon

@_date: 2008-08-20 22:51:10
@_author: Michel Messerschmidt 
@_subject: Securely delete files... 
There is also the possibility to use encryption for *all* data on a
harddisk. If the key is stored somewhere else (e.g. in your mind or on another disk), this may prevent data recovery on a similar level.

@_date: 2008-07-24 01:40:00
@_author: Michel Messerschmidt 
@_subject: export key: access denied 
Are you sure that your user has write permissions in the current directory?

@_date: 2008-05-15 15:26:26
@_author: Michel Messerschmidt 
@_subject: Linux crypto killer apllication 
Hash: SHA1
Sven Radde said:
Actually the legal requirements changed this year.
1024 bit RSA and SHA-1 are not sufficient anymore. 2048 bit is
recommended and at least 1280 bit is required (see
 for details).
Still I haven't seen any legal requirement beyond 2048 bit RSA/DSA yet.
But the retirement of SHA-1 may become an issue for OpenPGP.

@_date: 2008-11-05 22:22:04
@_author: Michel Messerschmidt 
@_subject: Signature semantics 
The most common signature invalidation I've seen is the addition of corporate disclaimers to every outgoing and incoming message on the server :(

@_date: 2009-08-22 21:04:50
@_author: Michel Messerschmidt 
@_subject: how to validate keys on smartcard (only) on an other PC or on 
AFAIK the smartcard contains only your secret keys not the public keys. That's what the URL entry on the smartcard is for.
If you set the URL to a location where your public key is stored, you can import your public key on other systems using "gpg2 --card-edit" -> "fetch"
If you don't set an URL on the smartcard, gpg will search your default keyservers instead.

@_date: 2009-02-10 16:19:42
@_author: Michel Messerschmidt 
@_subject: gpg: failed to create temporary file 
Or try to debug your oracle environment with env_audit

@_date: 2009-02-23 23:24:46
@_author: Michel Messerschmidt 
@_subject: How secure asymmetric encryption to yourself? 
Although I think this one of the most secure but usable places, what if a real life phisher gets your wallet?
No problem to cancel credit cards. But are you able to reset all those
login passwords? Probably by using answers that either anybody knows or that you can't remember? Will you even remember all your logins? Before they are abused?
But don't forget the backup.

@_date: 2009-02-28 02:14:18
@_author: Michel Messerschmidt 
@_subject: future proof file encryption 
Unless your photos are made for your grandchildren only, I don't believe in a personal "dead" long-term storage. Most people I know just want to keep files that they use at least occasionally.
While I like your proposal for long-term storage, I rather stick with harddisks or flash drives for personal data. That way the files remain usable while being archived.
But I wouldn't recommend more than two harddrives. With current hardrives
I regard it as sufficient to use just one dedicated backup disk or even two copies on different computers. As long as the backups are verified, the probability of two simultaneous drive failures is low enough to make the risk acceptable. And if the house burns down ...the shoebox wasn't fireproof either.
Back to encryption, I see no problem to simply use crypto filesystems with this scenario.

@_date: 2009-01-22 15:57:32
@_author: Michel Messerschmidt 
@_subject: OT: virus on the wild? 
Agreed, but does it really matter?. I suppose you really wanted to know whether your computer is at risk because of this AV warning? And the only definitve answer is obvious: Ask your AV vendor. There exist AV products that issue a warning even whenever they encounter a zip file :)
Therefore any speculation here won't give you the level of assurance you probably want.
Assumption: Your AV adheres to common virus naming conventions here.
1. Your AV stated that it detected a Trj = trojan but not a virus. So it won't replicate itself (no spreading in the usual sense) but waits for users/browsers to execute it.
2. The malware class JS means JavaScript. Your AV detected some malicious javascript maybe on the google search page or on one of the result pages.
Some AV products prefetch linked pages to scan them before the user clicks on a link. Also some browsers prefetch web pages and an AV may detect the javascript in the browser cache. Conclusion: It is absolutely possible that your AV warned you without anything malicious happening on your computer. OTOH if something happened it won't be easy to track down the origin of the attack.
Whatever your AV vendor will tell you, these apply in general:
 - disable javascript / browser scripting as much as possible
 - don't use outdated browser versions
 - know the behaviour of your browser

@_date: 2009-07-03 09:57:22
@_author: Michel Messerschmidt 
@_subject: verifying rpms - public key not found 
rpm provides its own verification command:
rpm -v --checksig It won't succeed though if your key is only available in the gnupg keyring
but was not imported into the rpm database - that's what the "rpm --import"
command is used for).

@_date: 2009-07-19 15:08:12
@_author: Michel Messerschmidt 
@_subject: How to verify lot of .sig files in lot of subdirectories with 
One solution is to execute this bash one-liner in the top level directory of your source code archives:
for i in `find . -name '*tar.gz'`; do if [ -e ${i}.sig ]; then echo "Signature verification for $i:"; gpg --verify ${i}.sig $i; fi; done
Note that archives without detached signature file (.sig) won't be

@_date: 2009-06-04 22:55:40
@_author: Michel Messerschmidt 
@_subject: Is it possible to force decryption with the wrong key type 
I received some files encrypted by a not really OpenPGP compliant product. Instead of using the encryption sub key, the files are encrypted with the primary key.
Is there any chance to force decryption of the files? My secret keys are located on a OpenPGP smartcard.
$ gpg2 -vv --decrypt file1.pgp :pubkey enc packet: version 3, algo 1, keyid XX_NOT_MY_KEY_XX
gpg: public key is XXXXXXXX
:pubkey enc packet: version 3, algo 1, keyid FD377E2D96C5988D
gpg: public key is 96C5988D
:encrypted data packet:
gpg: encrypted with 1024-bit RSA key, ID 96C5988D, created 2006-12-03
      "Michel Messerschmidt "
gpg: public key decryption failed: Wrong secret key used
gpg: encrypted with RSA key, ID XXXXXXXX
gpg: decryption failed: No secret key
$ gpg2 --edit-key 96C5988D
Secret key is available.
pub  1024R/96C5988D  created: 2006-12-03  expires: never       usage: SC                       trust: ultimate      validity: ultimate
sub  1024R/5C86D9BF  created: 2006-12-03  expires: never       usage: E   sub  1024R/B8668AD2  created: 2006-12-03  expires: never       usage: A

@_date: 2009-06-05 14:41:48
@_author: Michel Messerschmidt 
@_subject: Is it possible to force decryption with the wrong key type 
Thanks for the answer, but no success with this either:
$ gpg2 -vv --try-all-secrets file1.pgp :pubkey enc packet: version 3, algo 1, keyid xxxxxxxxxxxxxxxx
gpg: public key is xxxxxxxx
gpg: anonymous recipient; trying secret key 96C5988D ...
gpg: anonymous recipient; trying secret key xxxxxxxx ...
gpg: anonymous recipient; trying secret key xxxxxxxx ...
:pubkey enc packet: version 3, algo 1, keyid FD377E2D96C5988D
gpg: public key is 96C5988D
gpg: anonymous recipient; trying secret key 96C5988D ...
gpg: anonymous recipient; trying secret key xxxxxxxx ...
gpg: anonymous recipient; trying secret key xxxxxxxx ...
:encrypted data packet:
gpg: encrypted with 1024-bit RSA key, ID 96C5988D, created 2006-12-03
      "Michel Messerschmidt "
gpg: encrypted with RSA key, ID xxxxxxxx
gpg: decryption failed: No secret key
I don't think gpg has problem identifying and finding the secret key, but it refuses to decrypt a message with a key that had no encryption capability set during key creation.
I'm looking for a way to change or override the key type (Sign / Encrypt / Certify / Authenticate).
And what might happen if I try to delete or disable my encryption subkey ? Will the primary key be used for de-/encryption?

@_date: 2009-06-15 01:19:35
@_author: Michel Messerschmidt 
@_subject: Is it possible to force decryption with the wrong key type 
Several experiments later, I still found no solution. Even if I patch scdaemon to skip the fp check and force verification of CHV1 and CHV2, the card refuses to decrypt the data:
scdaemon[22828.0] DBG: <- PKDECRYPT D276000124010101000100000A510000/D37D19881B8093EFC6C5C89EFD377E2D96C5988D
2009-06-15 00:54:06 scdaemon[22828] DBG: send apdu: c=00 i=2A p0=80 p1=86 lc=129 le=256 em=0
2009-06-15 00:54:06 scdaemon[22828] DBG:   APDU_data: [...]
2009-06-15 00:54:07 scdaemon[22828] DBG:  response: sw=6985  datalen=0
2009-06-15 00:54:07 scdaemon[22828] operation decipher result: Conditions of use not satisfied
2009-06-15 00:54:07 scdaemon[22828] card_create_signature failed: Conditions of use not satisfied
scdaemon[22828.0] DBG: -> ERR 100663427 Conditions of use not satisfied If I understand the OpenPGP card specification correctly, there is no way to select the key to use but this is up to the card OS.
Therefore I will give up on this.
BTW: The error message "card_create_signature failed" in scd/command.c is a bit misleading IMHO. I had expected something like "decryption Thanks for your help,

@_date: 2009-06-21 13:56:31
@_author: Michel Messerschmidt 
@_subject: "Signature verification failed" 
Hm, I get a good signature here:
[-- Attachment  --]
[-- Type: multipart/signed, Encoding: 7bit, Size: 1,0K --]
        micalg=pgp-sha256; boundary="Apple-Mail-1-874815823"

@_date: 2009-06-21 14:13:42
@_author: Michel Messerschmidt 
@_subject: "Active Directory", "My documents" and Temporary Files 
This is not related to gnupg, but anyway:
It also depends on the version of Office and Windows where temp files are stored (e.g. the user's %TEMP% directory). Beside temp files there are also swap files, hibernation files and maybe more to take into If you want to ensure that confidential files are not stored unencrypted, you should look for full drive encryption on all used

@_date: 2009-06-21 22:01:08
@_author: Michel Messerschmidt 
@_subject: "Signature verification failed" 
At least the version in the signature header changed from 2.0.11 to 2.0.12.

@_date: 2009-11-02 12:09:34
@_author: Michel Messerschmidt 
@_subject: gpg.conf 
Within this manual you'll find:
    This is the standard configuration file read by gpg2 on startup. It may contain any valid long option; the leading two dashes may not be entered and the option may not be abbreviated. This default name may be changed on the command line (see option ?options). You should backup this file.
Valid options are listed in Use the "keyring" option:
--keyring file
    Add file to the current list of keyrings. If file begins with a tilde and a slash, these are replaced by the $HOME directory. If the filename does not contain a slash, it is assumed to be in the GnuPG home directory ("~/.gnupg" if --homedir or $GNUPGHOME is not used).
    Note that this adds a keyring to the current list. If the intent is to use the specified keyring alone, use --keyring along with --no-default-keyring.

@_date: 2010-07-20 22:24:00
@_author: Michel Messerschmidt 
@_subject: verifying hashes with GnuPG 
Why would you want to use gnupg for this if md5sum, sha1sum, sha256sum, etc. are available for most systems?

@_date: 2010-03-14 22:16:00
@_author: Michel Messerschmidt 
@_subject: Restarting gpg-agent 
This works for me (in .bashrc):
export GNUPGHOME="${HOME}/.gnupg"
# check that gpg-agent is executable and enabled in the gpg config
if grep -qs '^[[:space:]]*use-agent' "${GNUPGHOME}/gpg.conf" &&
   test -x ${GPGAGENT}; then
    # always re-read the gpg-agent info file to find the running instance
    if [ -r "${GA_INFO_FILE}" ]; then
        . "${GA_INFO_FILE}"
    fi
    # start gpg-agent if no running instance is found
    if test -z "${GPG_AGENT_INFO}" ||
       ! kill -0 `grep GPG_AGENT_INFO ${GA_INFO_FILE} | cut -d: -f 2 -` 2>/dev/null; then
        # enable ssh support by default if set in global Xsession options
        if grep -qs '^[[:space:]]*use-ssh-agent' /etc/X11/Xsession.options; then
            GA_SSH=--enable-ssh-support
        fi
        # execute gpg-agent and export environment variables
        eval $(${GPGAGENT} --daemon ${GA_SSH} --sh --write-env-file=${GA_INFO_FILE})
    fi
    export GPG_AGENT_INFO
    export SSH_AUTH_SOCK
    export SSH_AGENT_PID

@_date: 2011-04-28 17:05:06
@_author: Michel Messerschmidt 
@_subject: Is the OpenPGP model still useful? 
Sounds very much like Off-the-Record messaging for every kind of communication. Or is there a difference I have missed?

@_date: 2011-01-03 11:25:31
@_author: Michel Messerschmidt 
@_subject: Having trouble getting GPG to accept input from a pinpad 
Have you tried it with gnupg 2.0.x ?
IIRC you need at least 2.0.12 for the SPR-532 pinpad and gnupg-agent
should be running. If not, please post more details about your environment and how you
execute gnupg. The pinpad works for me, so I guess you will find a way.

@_date: 2011-07-22 21:37:09
@_author: Michel Messerschmidt 
@_subject: secring and dropbox 
mutt handled the message without error here.
In addition to the settings from gpg.rc my .muttrc contains:
set pgp_use_gpg_agent = yes
set pgp_auto_decode = yes
(I use gpg version 2.0.14)

@_date: 2011-11-29 22:30:18
@_author: Michel Messerschmidt 
@_subject: Card only available to root user 
I haven't used this reader for years. But back then this udev rule worked for me:
ACTION=="add", SUBSYSTEM=="cardman_4040", GROUP="scard", MODE="0660"
IIRC the cs4040 created its own device entry /dev/cmx (or something similar)

@_date: 2011-10-13 23:36:25
@_author: Michel Messerschmidt 
@_subject: Useful factoid 
Depends on what you regard as damage.
Do you need root privileges to use your private gpg keys ???
If you run your web browser under the same account that you use for
gpg, vulnerabilities in your browser *potentially* allow an attacker to access your private keys.
Same is true for your mail program, PDF reader, messaging client, ...

@_date: 2012-06-17 13:36:00
@_author: Michel Messerschmidt 
@_subject: RFE: --update-before-use 
Even that addresses not all issues. The target keyserver still receives a connection whenever the public key is used by someone. A keyholder may set the keyserver URL to a server under his control to monitor the usa of its public key.
If that is a good or bad idea certainly depends on your point of view.
But is does not seem to be a wise default configuration in my mind.
If such an "automatic update" is added, I'd like to have an additional option to define the maximum update interval. This allows everybody to define his own tradeoff. With a default value of for example 24 hours, public keys are still kept fairly up to date while frequent key usage  will not trigger a keyserver request for most crypto operations.

@_date: 2012-05-30 10:08:35
@_author: Michel Messerschmidt 
@_subject: changing the default for --keyid-format 
You may wnat to lookup up all certificates that signed a certificate. Or just get all your certificates displayed.
Or all certificates that have been signed with your keys.
But this is not to say that a tabular representation helps for these use cases :)

@_date: 2012-11-21 20:42:38
@_author: Michel Messerschmidt 
@_subject: making (future) OpenPGP cards without PIN pad safer 
If you want to reduce the dependency on unknown systems, I would rather have a look at cards with integrated keypad. A future OpenPGP card might take advantage of this feature.
It will not remove the trust dependency on a potentially insecure system, but will reduce the exposure of your credentials (private key and PIN/passphrase).

@_date: 2013-02-07 23:40:54
@_author: Michel Messerschmidt 
@_subject: More secure than smartcard or cryptostick against remote attacks? 
If designed right, your machine won't be compromised. But this is obviously a very hard problem.
If your signing device interprets mail, doesn't it become part of this "major attack surface"?
And if it only interprets ASCII, how does it differentiate between signing ASCII and signing Unicode, possibly including RLO chars?
I'm not sure that such a signing device can be designed simple enough to be immune to advanced attacks and still be useful.

@_date: 2013-02-22 20:59:16
@_author: Michel Messerschmidt 
@_subject: Piping tar into gpg 
Are you sure that gpg overwrote the files? Piping into "tar cfzv" would write *to* the first file found due to the "f" option.
Another thing is that you don't need find if you just want to put everything below a directory in a tar file. You could use:
cd /mnt/raid/Dokumente/
tar --create . | gpg --symmetric --output $DESTINATION/1.tar.gpg
But if you really want to exclude other filetypes, you better stick to find.

@_date: 2013-01-30 20:40:25
@_author: Michel Messerschmidt 
@_subject: RSA // OAEP // SHA-1 
Although it is the default, RFC 3447 is not restricted to SHA-1.
Appendix B actually states:
"For the RSAES-OAEP encryption scheme and EMSA-PSS encoding method, only SHA-1 and SHA-256/384/512 are recommended."

@_date: 2014-01-06 15:47:06
@_author: Michel Messerschmidt 
@_subject: "no valid subkey" 
As an additional hint how to find your encryption key (as opposed to signature or authentication keys), you need to look for keys with "usage: E".
In your case it is 0971954D:
$ gpg2 --edit-key 0xB240C11D
pub  4096R/B240C11D  created: 2010-12-10  expires: 2014-11-11  usage: SC                       trust: unknown       validity: unknown
sub  2048R/0320F4A4  created: 2014-01-06  expires: 2014-11-11  usage: S   sub  4096R/0971954D  created: 2010-12-10  expires: 2014-11-11  usage: E   [ unknown] (1). Erik Josefsson [ unknown] (2)  Erik Josefsson (ehj)

@_date: 2014-01-06 16:10:06
@_author: Michel Messerschmidt 
@_subject: USB key form-factor smart-card readers with pinpads? 
Although these are important attacks to consider, PIN entry on the reader itself still provides additional protection if you want to protect your own signatures.
There is the obvious possibility to remove and re-insert the card after every use to reduce this attack surface somewhat. But for such a tradeoff other things should be considerd first (is your PIN really your biggest concern if you don't trust your computer/keyboard, is your reader really more trustworthy than your computer, ...).

@_date: 2016-10-20 17:46:32
@_author: lists@michel-messerschmidt.de 
@_subject: smartcard reader 
Hash: SHA512
Although I had very good experience with the SPR 532 (and a lot of trouble with another Cyberjack reader, the Comfort IIRC), the yubikey token has a better trade-off between usability and security for me.
Mainly because its usable on mobile devices through openkeychain, but good support of 4k RSA keys is also welcome. Lack of a pin-pad is the main drawback. Tamper resistance and firmware source may be other discussion topics.
