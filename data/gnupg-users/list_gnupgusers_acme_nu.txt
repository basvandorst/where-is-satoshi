
@_date: 2016-01-25 10:46:32
@_author: Jorgen Ottosson 
@_subject: Problems with 4096 keys on 2.1 card 
I've been having some problems using a GPG card 2.1 with Ubuntu repo GPG,
think it was 2.0.22.
I noticed some discussions in Sept-15 about this and got the impression
that it should work.
Can someone just make a short comment on this, should a 2.0.22 be able to
generate 4096 keys and/or import 4096 subkeys from keyring?
The card and reader work ok and imports of shorter keys (like 3072) work
without issues. This particular system is an Ubuntu 14.04 and the card is
an OpenPGP Smartcard V2.1.

@_date: 2016-01-26 00:18:26
@_author: Jorgen Ottosson 
@_subject: Problems with 4096 keys on 2.1 card 
Can't really confirm that here, generating seem not to work either.
gpg --card-status
Version ..........: 2.1
Manufacturer .....: ZeitControl
Name of cardholder: [not set]
Language prefs ...: de
Sex ..............: unspecified
URL of public key : [not set]
Login data .......: [not set]
Private DO 1 .....: [not set]
Private DO 2 .....: [not set]
Signature PIN ....: not forced
Key attributes ...: 2048R 2048R 2048R
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 0
Signature key ....: [none]
Encryption key....: [none]
Authentication key: [none]
General key info..: [none]
gpg --card-edit
gpg/card> admin
gpg/card> generate
Make off-card backup of encryption key? (Y/n) n
Please enter the PIN
What keysize do you want for the Signature key? (2048) 4096
RSA keysizes must be in the range 1024-3072
What keysize do you want for the Signature key? (2048)
gpg: Interrupt caught ... exiting
SO: it seems the card will not generate larger keys then.
I have several readers but am testing here with SCR335.
Any way to pin-point my issue in more detail? Is my reader known to not
support 4096? Info on readers who will? I also have a scr3500 somewhere
but think I'll have to install drivers for that one to work, the SCR335
work with internal gpg drivers if I'm not mistaken whereas the 3500 don't
work when attached as is.
I also find it somewhat hard to get info on support for "Extended length"
in several card reader's product-info pdfs I've looked at.

@_date: 2016-01-26 23:59:22
@_author: Jorgen Ottosson 
@_subject: Problems with 4096 keys on 2.1 card 
Thanks to you both for commenting on this, I do remember the 335 being one
of the most original readers to work without much hazzle.
Ok, well I thought it kinda used the 2 branch anyway when doing stuff with
cards, I may have misunderstood that - see commands further down though,
switching to "gpg2" does not work.
I know, that was just for showing generate command bailing.
Nice link.
That's weird. Dead here without additional drivers, used it on another
installation, also Ubuntu but installed some kind of driver so guess I
didn't use the internal then either.
Then I should be able to do some things differently..
Some misc. commands:
$ gpg --version
gpg (GnuPG) 1.4.16
$ gpg2 --version
gpg (GnuPG) 2.0.22
$ gpg --list-keys
-> works
$ gpg2 --list-keys
also works
$ gpg --card-status
-> works
whereas gpg2 does NOT. (should it really? - but it is listed in help
output though)
$ gpg2 --card-status
gpg: selecting openpgp failed: Unsupported certificate
gpg: OpenPGP card not available: Unsupported certificate
NOTE: v2.1 card inserted in attached SCR335 reader all the time above.
Not sure if there's something here confusing me or I need to buy (yet)
another reader or what..
Maybe I can turn on debugging somewhere to solve this, really need to use
a couple of 4096 subkeys so this is kinda bugging me.

@_date: 2016-01-27 23:39:03
@_author: Jorgen Ottosson 
@_subject: Problems with 4096 keys on 2.1 card 
$ gpg-connect-agent -v
gpg-connect-agent: connection to agent established
ERR 103 unknown command
I'll try to do some testing with gnome keyrings etc too and get back later.

@_date: 2017-01-08 16:26:06
@_author: Jorgen Ottosson 
@_subject: fetch yields "rejected by import filter" 
I'm having problems importing and thereafter using keys on another pc.
This is kinda annoying since it interfers with using cards smoothly on
different computers.
I have the privkey on a card, use the admin/fetch command to get the
pubkey down and therafter use the card-status to generate the stubs,
The thing is that when I enter 'fetch' I get error messages:
gpg: key xxxx: rejected by import filter
The URL on key, 'URL of public key' is indeed korrekt and I can easily put
it in a browser and see the pubkey.
So what is the problem? I noticed there are quite a few hits of "rejected
by import filter" when googling.
I have seen this issue several times before trying to use/test different
cards on both Win and Linux.
There seem to exist options relating to this:
--import-filter name=expr
--export-filter name=expr
but should I need to use these in config file to make these card commands
to work?
Right now I'm on: gpg (GnuPG) 2.0.30 (Gpg4win 2.3.3)
Card (in this particular case) 2.0 and keys 3072 bits.
Reader SCR335 seem not to have any issues.
What am I missing?

@_date: 2017-01-09 00:19:56
@_author: Jorgen Ottosson 
@_subject: fetch yields "rejected by import filter" 
Well, that does work, after I put URL in quotes ("URL"), otherwise it does
not. Maybe the 'fetch' command in card-edit/admin is more picky about what
URLs actually work then.
I'll try to keep that in mind.
If not other local issues played in, I got a card daemon error when
generating keys earlier too, but then the same procedure worked right
