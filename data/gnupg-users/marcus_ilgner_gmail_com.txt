
@_date: 2015-09-22 06:51:17
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
Hello all,
I've been using GnuPG for some time now and recently became the proud owner
of a NitroKey hardware dongle which includes a SmartCard for key storage.
This was straightforward to set up and I created separate subkeys (4096
bit) for encryption, signing and authentication and moved them to the card.
And while encrypting and signing works fine, I just received a mail that
has been encrypted for the new key and found that I cannot decrypt it.
My GnuPG version is gpg (GnuPG) 2.1.8, libgcrypt 1.6.4 (i.e. current
versions in Arch Linux) and the output is:
gpg: public key decryption failed: Missing item in object
gpg: decryption failed: No secret key
I found a very old discussion here
 which seems to
discuss the same problem but as it's already a couple of years old I assume
that it has been solved in the meantime. Otherwise I find it very odd that
GPG would let me even move the key to the card without saying something
like "If you do that, you won't be able to decrypt messages...".
If there's anything I can do, including debugging and other
development-related things, let me know, I really want to get this to work
All the best

@_date: 2015-09-22 09:30:31
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
Hi Werner,
thank you for the quick reply, it's much appreciated!
You're right, there is a response 0x6A88 there - not that I know what that
means :D
Here you can find the full log:
Thanks for mentioning the PIN, I might have overlooked it in the hex dump :)
Good to know :)
Let me know if there's anything else I can do to assist in solving the
All the best

@_date: 2015-09-22 13:26:11
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
Thank you for the hint. I updated the gist at
 to include both the
output of `gpg --card-status` (which works fine) as well as the log for
trying to decrypt with CCID disabled in scdaemon.conf (which unfortunately
it yields the same error as before).
I don't know enough about the workings on the chip to make any guess about
possible origins of the error but I would have thought that all data stems
from the secret key? I.e. the key is moved to the card in full and the
blinded/public key as well as the fingerprints are derived from it there?
Also I did not receive any errors before, all other operations seem to work
So, again, thanks for helping to investigate! I hope we can find a solution
to this :)
All the best

@_date: 2015-09-22 14:34:13
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
You're right, of course, but I checked that first. The output of `gpg
--decrypt` is
gpg: encrypted with 4096-bit RSA key, ID E3AE1976, created 2015-09-18
which is one of the key ids also reported by `gpg --card-status`.
All the best

@_date: 2015-09-25 05:55:05
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
Thanks for the explanation! It always helps to know what is (or should be)
going on.
Not sure whether that is significant but there were a few zero bytes more:
raw apdu: 00 47 81 00 00 00 02 B8 00 08 00
This is to read public key (of decryption) from the card.
Also some slight differences: it says
7F 49 82 *02* *0A* 81 82 *02* 00
That part looks ok again. Although my public exponent is different, too but
I guess that's expected :) Yet 527 bytes total sounds plausible for a
4096bit key.
You can find the full output at
I would assume that the key was indeed transferred successfully then.
Thanks for the help, I have a feeling we're making some headway towards a
All the best

@_date: 2015-09-28 19:53:22
@_author: Marcus Ilgner 
@_subject: Decryption fails with 4096bit key on SmartCard 
Ok, I'm not sure whether someone from the Nitrokey team is following this
list, so I'll contact them and ask them to reproduce this. The card claims
to support 4096bit and since the key is on the card it should be possible
to use it, too... Fingers crossed... ;)
All the best and thanks again for the assistance so far
