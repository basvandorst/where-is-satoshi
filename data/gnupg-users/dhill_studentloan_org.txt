
@_date: 2004-04-21 08:25:10
@_author: David Hill 
@_subject: RSA Encryption / exchange with PGP  
We are trying to exchange files with a company using PGP Command Line - Freeware version 6.5 with RSA keys generated with version 2.6.2, file exchange remains compatible with the old 2.6.2 version. We cannot decrypt their files and they cannot decrypt ours. We could easily generate a new key, but our trading partner is very established and will not want to regenerate.
We are using GnuPG 1.2.4 to generate keys with the following options
Type: DSA & ElGamal (the only option that allowed encryption, RSA was only for signatures)
key length: 1024 bit
key does not expire
Real Name: Iowa Student Loan Liquidity Corp.
Email: dhill
Comment: iLink Dev
I am sending the trading partner a new text file encrypted with the following options:
gpg --rfc1991
--compress-algo 1
--recipient "THEM"
--recipient "US"
--output "readme.gpg"
-es "readme.txt"
In previous attempts I didn't use the first three commands, I am hoping these will help our trading partner decrypt, but I don't have high hopes of success. Even if by some miracle that worked, we still can't decrypt their files. Do we need to use different keys or protocols in order to interoperate? This is a sample decryption session:
C:\gnupg>gpg --verbose --decrypt "install.log.pgp"
gpg: public key is F58C3B48
gpg: using secondary key F58C3B48 instead of primary key 4D1D68AC
You need a passphrase to unlock the secret key for
user: "Iowa Student Loan Liquidity Corp. (iLink Dev) "
gpg: using secondary key F58C3B48 instead of primary key 4D1D68AC
1024-bit ELG-E key, ID F58C3B48, created 2004-04-19 (main key ID 4D1D68AC)
gpg: encrypted with 1024-bit ELG-E key, ID F58C3B48, created 2004-04-19
      "Iowa Student Loan Liquidity Corp. (iLink Dev) "
gpg: CAST5 encrypted data
gpg: block_filter 024BCB68: read error (size=7302,a->size=536874118)
gpg: WARNING: message was not integrity protected
gpg: block_filter: pending bytes!

@_date: 2004-04-27 16:32:47
@_author: David Hill 
@_subject: RSA Encryption / exchange with PGP 
Actually we got the two to interoperate nicely, they are using PGP version 6.5 freeware, RSA legacy keys, and encrypting with IDEA. We used the PGP product to generate the newer RSA 2048 keys and imported those keys into GnuPG. That worked a lot better for allowing them to decrypt our traffic, the DSA/ElGamel gave them trouble decrypting our files. The real problem was that they were unwilling to change their preferred encryption method from IDEA to TripleDES, so we downloaded and tested the IDEA dll from ftp://ftp.gnupg.dk/pub/contrib-dk/ and that worked perfectly. Then I went to the  site and found I could license the IDEA algorithm for 15 euros per seat, and presto, the rouge IDEA dll was legal.
Hash: SHA1
Unfortunately, PGP 6 does not follow the PGP specification very
closely.  GnuPG has code to work around this.  Try setting the
"--pgp6" option:
  gpg -r THEM -r US --pgp6 --output readme.gpg -es readme.txt
How did you get the encrypted file (install.log.pgp)?  More than
anything else this looks like the encrypted file was transferred to
you via text mode instead of binary FTP and so the file was corrupted
before you got it.

@_date: 2004-07-27 17:37:47
@_author: David Hill 
@_subject: folder security problem with random_seed 
We have installed GnuPG and our keys on the network. Unfortunately random_seed requires excessive permissions, since it seems to be destroyed and recreated during each command, we need to grant read/write/update/delete permissions to that folder for all GnuPG users. If the random_seed file could be relocated to the users local temp folder or to a common writeable location on the network then we would be able to lock the security of the GnuPG installation down to just read access.
Dave Hill
Iowa Student Loan Liquidity Corp.
Fax 515-243-0714

@_date: 2004-07-27 17:41:17
@_author: David Hill 
@_subject: folder security problem with random_seed 
We have installed GnuPG and our keys on the network. Unfortunately random_seed
requires excessive permissions, since it seems to be destroyed and recreated
during each command, we need to grant read/write/update/delete permissions to
that folder for all GnuPG users. If the random_seed file could be relocated to
the users local temp folder or to a common writeable location on the network
then we would be able to lock the security of the GnuPG installation down to
just read access.
Dave Hill
Iowa Student Loan Liquidity Corp.
Fax 515-243-0714

@_date: 2004-06-09 20:29:22
@_author: David Hill 
@_subject: --logger-fd n in Windows Visual Basic 
Alright, I've beaten myself bloody trying to figure this out, I haven't found anything in the archives, time to give up and ask for help.
I am working in Windows, programming in Visual Basic and I need to use GnuPG to encrypt and sign files, decrypt files, and verify signatures. Encryption and decryption is cake, but getting access to stderr to get key information is killing me. So THEN I thought I'd just do the key check in a separate step from the decryption command, I piped output from --list-packets to an --output file. As you might guess, no output file is created even though the only output of --list-packets is the packet information, probably went to stderr instead of my file.
I've put together a simple ActiveX dll that creates and shells batch files to interface with GnuPG. Apparently I can redirect the non-file output by using --logger-fd and giving it a file descriptor number. An interesting method of naming an output file, personally I might have recommended a command line file name much like --output uses, but let's get past that for now. Can anyone tell me how to create a file descriptor in Windows that this thing will accept? Is there an API that I should use to allocate/deallocate a file descriptor?
GPGME looked like an interesting alternative to rolling my own interface, unfortunately it doesn't come compiled, only as a big pile of source code. Also couldn't find any compatibility statement that indicated it would even work if I tried to compile and use it in Windows. Rolling my own for the few functions I needed probably took less time than getting a GPGME compile to run, if only there were a rational way to access the stderr information.
Dave Hill
Iowa Student Loan Liquidity Corp.
Fax 515-243-0714
