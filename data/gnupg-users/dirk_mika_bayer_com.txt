
@_date: 2015-10-15 12:11:40
@_author: Dirk Mika 
@_subject: Pinentry pops up allthough --passphrase-fd is used 
I'm completly new to gpg but have read many helpful webpages and docs. The primary reason for using gpg is to decrypt a downloaded file right after download in a batchjob (I have to use a windows server and the job is configured as a scheduled task, so the environment is a WIN 2008 Server).
Almost eveything works as expected but I stumbled across one issue. If the following command is given for the first time and the gpg-agent is not yet running the pinentry-windows pops up asking for the passphrase. (I'm still testing in a cmd-window)
echo "-censorship-" | gpg --homedir="C:\Program Files (x86)\HR-Interface\gnupg" --batch --passphrase-fd 0 --decrypt --output M:\data.csv M:\data.csv.gpg
When I enter the correct passphrase the command finishes correctly. Each subsequent call of the very same command succeeds without any prompt.
Is this intended behavior? Do I need to start the agent in advance (how)?
I'm afraid (although not tested yet) having pinentry popping up in a scheduled task without being logged in won't work.

@_date: 2015-10-20 09:13:01
@_author: Dirk Mika 
@_subject: Pinentry pops up allthough --passphrase-fd is used 
I'm using version 2.1.9. And that's the reason why --no-use-agent won't work. :-) And although mentioned in the docs that gpg2 always requires the agent I tried it anyway. :-) I've used the flag and got a huge amount of information but nothing that gave me a hint what's causing this issue.
I did some more tests and figured out that all passphrase options (--passphrase-fd, --passphrase-file and --passphrase) are ignored. And it doesn't matter if I add one of these to the command line or not. When the agent is not running it is started and pinentry pops up. If the agent is running the passphrase is cached (or the key, I don't know) and pinentry does not appear.
I then tried version 2.0 instead of 2.1 and with this version I successfully managed to decrypt a file without having to enter the passphrase. Best regards,
Dirk Mika
