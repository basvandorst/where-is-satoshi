
@_date: 2013-06-25 13:02:34
@_author: Daniel Pocock 
@_subject: using OpenPGP card as an X.509 CA? 
I understand the OpenPGP card can hold one X.509 certificate
Can this be used in practice to run an in-house CA to sign other X.509
certificates, e.g. for small VPN setups?
Also, can the X.509 cert on the OpenPGP card be used with StrongSwan (as
a client or server cert for VPN)?

@_date: 2013-06-25 12:43:37
@_author: Daniel Pocock 
@_subject: using OpenPGP card as an X.509 CA? 
I understand the OpenPGP card can hold one X.509 certificate
Can this be used in practice to run an in-house CA to sign other X.509
certificates, e.g. for small VPN setups?
Also, can the X.509 cert on the OpenPGP card be used with StrongSwan (as
a client or server cert for VPN)?

@_date: 2013-06-25 17:32:22
@_author: Daniel Pocock 
@_subject: using OpenPGP card as an X.509 CA? 
Should this option work without a smart card, e.g. creating a key in the
local home directory?
When I run it, it takes me through the questions, asks me to confirm the
cert details and then fails with
gpgsm: line 1: key generation failed: Unsupported certificate
I found the command "--sign" in the man page, but there is no example. Should "--sign" take a CSR as input and generate a cert as output and
could you provide an example?  Or is some intermediate processing needed
to convert the CSR into something the gpgsm can sign?
strongSwan reportedly works with PKCS / OpenSC, it's hard for me to
understand if Scute will work but I don't mind trying it.
I notice the Scute "Features and Limitations" page says it only works
with 36 byte signatures for MD5 and SHA1 hashes.  Many people have now
moved to SHA2 or stronger hashes

@_date: 2013-06-26 15:10:19
@_author: Daniel Pocock 
@_subject: subkeys on smartcard? 
I understand this is a bit old, but I believe the concept is still current:
Essentially, can anyone confirm why it is recommended to only store
subkeys on a smart card?
a) is it because of the risk that the card might be lost or damaged?
b) or is it because of the risk that a smartcard may fall into the wrong
If the primary key was generated on a PC and stored onto two smart cards
and they were both kept in secure locations and only used in a secure
location, is it therefore quite acceptable to use the primary key on a
smart card and potentially more secure than keeping it on a disk?

@_date: 2013-06-26 15:42:03
@_author: Daniel Pocock 
@_subject: subkeys on smartcard? 
Hash: SHA1
accessed by
My own feeling is that a smart card used in a secure location is the
best place for the main/primary key, especially if combined with other
security measures (e.g. offline PC, reader with PIN pad).
The only other issue that arises then is longevity: is a smartcard
considered more or less stable than any other type of device for long
term key storage?
There are other practical issues too: is a smartcard likely to survive a
fire if stored in one of those fire-proof packets in a safe?  A
fire-proof box for a HDD or laptop tends to be much more expensive than
one that just holds a small documents/smartcards/DVD media

@_date: 2013-06-27 11:24:52
@_author: Daniel Pocock 
@_subject: Debian crypto strength 
Some of the discussion in this bug seems relevant to the GnuPG and
GnuPG2 packages in Debian, but the bug is against the archive
Can anybody else make any comments:
a) should there be more effort to phase out SHA1?
b) how is it being approached upstream?  Is backwards-compatibility
still emphasized to the same extent?
c) should this become a general system-wide goal to audit and increase
crypto-strength in all parts of jessie / future Debian versions?

@_date: 2013-06-29 21:06:20
@_author: Daniel Pocock 
@_subject: Smartcard Linux stack diagram? 
I came across this diagram of the stack including OpenSC and GnuPG:
Is this still accurate?
I notice a couple of small things missing:
Scute: it should be a link between gpg-agent and NSS?
StrongSWAN: it depends on PKCS directly (not using NSS)
The PKCS interface could be labeled "Cryptoki / PKCS
I'm thinking about making a slightly more up to date diagram with a
slightly different style - but if something else already exists, please
feel free to point it out.

@_date: 2014-06-13 09:25:50
@_author: Daniel Pocock 
@_subject: problems after changing primary UID 
I recently changed my primary UID from daniel at pocock.com.au to
daniel at pocock.pro
I've been able to sign from one machine but not from another.  The
second machine only has subkeys.
On the second machine, I would always get "secret key not available"
errors from git tag, signing packages, etc.
In fact, the secret key was never changed, I just added more UIDs, so
this error appeared inaccurate.
Programs like "git tag" and dpkg-genchanges could be coerced to sign
things on the second computer if I manually specified the numeric key ID
on the command line.
Adding "default-key" in ~/.gnupg/gpg.conf didn't help either - it always
seems necessary to specify the key ID on every occasion.
Looking at it again today, "gpg --list-secret-keys" shows me that two of
my UIDs, including the new one, were not listed on the second computer. However, looking at it with "gpg --edit-key" the uids are listed in the
public view but not the secret key view.  It seems that running "adduid"
doesn't fully update the list of uids for secret key usage.
I came across this rather detailed blog from somebody else who had this
and I couldn't help wondering, isn't it feasible to just copy the
~/.gnupg/secring.gpg from one computer to the other?
I made a backup and tried doing so and it appears to solve the problem. The only gotcha I can think of is that if the second computer is only
meant to contain subkeys, then the secret master key needs to be removed
as described in Is copying the file like this a valid solution?
Is there an easier way to deal with this situation?
