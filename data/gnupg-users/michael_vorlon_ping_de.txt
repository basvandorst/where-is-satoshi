
@_date: 2006-04-11 13:54:29
@_author: Michael Bienia 
@_subject: scdaemon forgets sometimes some data from an OpenPGP card 
I've a problem that sometimes gpg --card-status doesn't display all data
from the OpenPGP card (I've use-agent in my gpg.conf).
If I plug in the card the first time after booting, the output of
gpg --card-status is as expected. But I call gpg --card-status again the
field for PIN length and the counters display zeros:
If the card is in this state it can't be used. After killing scdaemon or
reinserting the card it works again.

@_date: 2006-04-11 14:00:07
@_author: Michael Bienia 
@_subject: setting the url field of a OpenPGP fails when using gpg-agent 
if I try to set the url field of an OpenPGP card using gpg with
gpg-agent it fails with the following error:
But I can set an url if I use gpg without gpg-agent.

@_date: 2006-04-11 21:13:52
@_author: Michael Bienia 
@_subject: scdaemon forgets sometimes some data from an OpenPGP card 
This is a recent svn version of scdaemon (svn version 4096).

@_date: 2006-04-11 23:43:31
@_author: Michael Bienia 
@_subject: setting the url field of a OpenPGP fails when using gpg-agent 
Here is the debug output:
Looking at the available options for scdaemon, is adding allow-admin
into scdaemon.conf the correct solution for my problem? It is safe to
use allow-admin?

@_date: 2006-12-08 11:49:18
@_author: Michael Bienia 
@_subject: Problem building 2.0.1 
This only patches Makefile.am. You need to have this changes also in
Makefile.in so either regenerate Makefile.in with automake or patch
Makefile.in manually and add the same changes there.

@_date: 2006-06-05 18:49:08
@_author: Michael Bienia 
@_subject: Problem with decrypting a mail with an openpgp card 
I've once again a problem with decrypting a mail with my openpgp card.
The used subkey is my encryption key so it should work theoretically.
The out of gnupg (with gnupg-agent) is:
I can succesfully decrypt an other mail (from someone else) which is
also encrypted to the same subkey (he also used gnupg 1.4.1).
gnupg and gnupg-agent are current versions from the svn (revision 4151).
Has someone an explanation?

@_date: 2006-03-14 02:47:59
@_author: Michael Bienia 
@_subject: OpenPGP card and signing 
does signing with the OpenPGP card only work with SHA1 as digest-algo?
With SHA1 and RIPEMD160 gpg asks for the PIN but only SHA1 generates a
working signature. Trying RIPEMD160 I get:

@_date: 2006-03-14 23:51:20
@_author: Michael Bienia 
@_subject: OpenPGP card and signing 
A friend who uses his OpenPGP card with enigmail under windows can
successfully create a RIPEMD160 signature.
I could also create one if I use gpg with pcscd.
Can someone explain me, why it works if I use gpg with pcscd and not if
I use gpg alone?

@_date: 2006-05-17 15:44:43
@_author: Michael Bienia 
@_subject: smart card + gpg only root 
I'm successfully using my smart card reader (a SPR 532) under Ubuntu
dapper as a user.
I've created the group "scard" and added my user to it (don't forget to
re-login). Then I created a udev rules file suitable for the udev
version in dapper:
,----[ gnupg-ccid.rules ]-
You have to change the idVendor and idProduct as suited for your card
reader. It is placed in /etc/udev/rules.d. To test if it works restart

@_date: 2006-05-17 16:09:04
@_author: Michael Bienia 
@_subject: Problems decrypting a mail with my openpgp card 
I've received an encrypted mail which I now have problems to decrypt it
with my key on a openpgp card. The mail was encrypted for two recipients
but I assume this has nothing to do with my problem.
The output is (stripped the output about the second recipient):
Doit the same without gnupg-agent (again without the output for the
second recipient):
gpg --card-status lists the subkey 02CC2588 as my authentication key. I
created the keys in the order recommended by the subkey_howto on
 auth, sign, encrypt.
How get I this mail decrypted?

@_date: 2006-05-19 23:15:19
@_author: Michael Bienia 
@_subject: Fedora Core 5 and SCR335 
I don't know if this also applies to FC5 but in Debian (and Ubuntu)
libusb (recent versions) checks /dev/bus/usb before /proc/bus/usb. To
get my card reader usable as an user I had to change the permissions in

@_date: 2006-05-20 21:09:14
@_author: Michael Bienia 
@_subject: Fedora Core 5 and SCR335 
Hi Andreas,
Here is my rules file for udev (version 079):
,----[ gnupg-ccid.rules ]-
It is placed in /etc/udev/rules.d and don't forget to replace idVendor
and idProduct with the values for your card reader.

@_date: 2006-10-09 13:51:29
@_author: Michael Bienia 
@_subject: Howto add ssh keys to .gnupg/sshcontrol? 
I'm having trouble to add my ssh key to a running gpg-agent (started
with --enable-ssh-support).
The comments in .gnupg/sshcontrol suggests you can do it with ssh-add or
manually. When I try it with ssh-add I'm asked about my passphrase but
afterwards ssh-add -l doesn't list it and it also doesn't show up in
The comment also mentions that one can add it manually by adding a
keygrip of 40 hex digits. How do I get this keygrip from my ssh key to
add it manually?

@_date: 2006-10-09 15:35:25
@_author: Michael Bienia 
@_subject: Howto add ssh keys to .gnupg/sshcontrol? 
No, from .gnupg/sshcontrol:
# [...] A
# non-comment line starts with optional white spaces, followed by the
# keygrip of the key given as 40 hex digits, [...]
The fingerprint returned by ssh-keygen -l is only 32 hex digits long.

@_date: 2006-10-09 21:35:48
@_author: Michael Bienia 
@_subject: Howto add ssh keys to .gnupg/sshcontrol? 
It's an existing ssh key.
I tried it but it didn't work as expected:
$ ssh-add .ssh/id_dsa
Enter passphrase for .ssh/id_dsa: Identity added: .ssh/id_dsa (.ssh/id_dsa)
But ssh-add -l didn't list it. Through further testing I found out it
was a problem with my ssh key:
$ ssh-keygen -l -f .ssh/id_dsa.pub 2048 [fingerprint] .ssh/id_dsa.pub
Don't ask me how I generated this key. As I can use this key with ssh I
didn't suspect it as the problem. I now generated a new 2048 bit RSA key
and it works now.
Thanks for your help,

@_date: 2006-10-14 13:05:25
@_author: Michael Bienia 
@_subject: Howto add ssh keys to .gnupg/sshcontrol? 
I assume gpg-agent shipped in Ubuntu edgy isn't recent enough to
support it. I've switched to a 2k RSA ssh key for now.

@_date: 2007-06-04 19:00:05
@_author: Michael Bienia 
@_subject: Problem decrypting a mail with an OpenPGP card 
I've got three mails (from the same person) with my signed key (one for
each uid). I can decrypt two of the three mails but not the third:
$ gpg broken-gpg.mail gpg: sending command `SCD PKDECRYPT' to agent failed: ec=6.131
gpg: encrypted with 1024-bit RSA key, ID AF58F2B4, created 2006-03-13
      "Michael Bienia "
gpg: public key decryption failed: general error
gpg: decryption failed: secret key not available
$ gpg2 broken-gpg.mail gpg: encrypted with 1024-bit RSA key, ID AF58F2B4, created 2006-03-13
      "Michael Bienia "
gpg: public key decryption failed: Conditions of use not satisfied
gpg: decryption failed: No secret key
gpg is version 1.4.6, gpg2 is version 2.0.4 and I'm running Ubuntu
feisty. I'm using the gpg-agent but I've also tried without the agent
but it failed also.
What could be the problem?
Here is the output for one of the working mails:
$ gpg2 -vv good-gpg.mail gpg: armor: BEGIN PGP MESSAGE
Version: GnuPG v1.4.6 (GNU/Linux)
:pubkey enc packet: version 3, algo 1, keyid FB50DDA4AF58F2B4
        data: [1024 bits]
gpg: armor header: gpg: public key is AF58F2B4
gpg: using subkey AF58F2B4 instead of primary key 968BD587
gpg: public key encrypted data: good DEK
:encrypted data packet:
        length: unknown
        mdc_method: 2
gpg: using subkey AF58F2B4 instead of primary key 968BD587
gpg: encrypted with 1024-bit RSA key, ID AF58F2B4, created 2006-03-13
      "Michael Bienia "
gpg: AES256 encrypted data
:compressed packet: algo=3
:literal data packet:
        mode b (62), created 1180971809, name="",
        raw data: unknown length
gpg: original file name=''
gpg: good-gpg.mail: unknown suffix
and here for the non-working mail:
$ gpg2 -vv broken-gpg.mail gpg: armor: BEGIN PGP MESSAGE
Version: GnuPG v1.4.6 (GNU/Linux)
:pubkey enc packet: version 3, algo 1, keyid FB50DDA4AF58F2B4
        data: [1013 bits]
gpg: armor header: gpg: public key is AF58F2B4
gpg: using subkey AF58F2B4 instead of primary key 968BD587
:encrypted data packet:
        length: unknown
        mdc_method: 2
gpg: using subkey AF58F2B4 instead of primary key 968BD587
gpg: encrypted with 1024-bit RSA key, ID AF58F2B4, created 2006-03-13
      "Michael Bienia "
gpg: public key decryption failed: Conditions of use not satisfied
gpg: decryption failed: No secret key

@_date: 2008-02-25 23:35:55
@_author: Michael Bienia 
@_subject: "Bad signature" when calling "check" in the edit-key menu: what 
I see a strange situation when I try to edit my key:
1.) When I call "gpg2 --edit-key 0x968BD587" I see several lines of   "gpg: moving a key signature to the correct place"
2.) When I call then "check" in the edit-key menu, I get a line saying
  "218 signatures not checked due to errors" and many duplicate lines
  with a "[Bad signature]" at the end, e.g.:
sig%3        AAE3C5A0 2006-05-28  [Bad signature] sig%3        AAE3C5A0 2006-05-28  [Bad signature] sig%3        3E60B7DA 2007-03-11  [Bad signature] sig%3        3E60B7DA 2007-03-11  [Bad signature] sig%         C5D34D05 2007-02-25  [Bad signature] sig%         C5D34D05 2007-02-25  [Bad signature]
3.) After calling "clean" everything seems to be fine till the next key
  refresh when the errors comes back (and over 200 new signatures).
So it looks like the "error" already propagated to the key servers, but
doesn't seem to cause any harm (yet and as far as I can tell). But I
would like to know what happened to my key. Any ideas?
gpg2 is gpg (GnuPG) 2.0.8, the Debian package from unstable compiled on
Ubuntu hardy. But I see the same behaviour with gpg 1.4.6.

@_date: 2008-06-24 23:29:20
@_author: Michael Bienia 
@_subject: SCM SPR532 & Ubuntu 8.04 & GnuPG 1.4.6 versus GnuPG 2.0.7 
I've a SCM SPR532 too, and it works without problems on Ubuntu 8.04. But
I don't use pscd, just plain gpg/gpg2 with gpg-agent to access it.
Have you tried to use the card reader with gpg only (no pcscd)? You need
to get udev to create the device nodes with the correct permission to
use the card reader as a user. I attached my udev rules. Put that file
into /etc/udev/rules.d, create the "scard" group, add your user to it
(don't forget to re-login) and restart udev. Don't forget to stop pcscd.
(Note to self: I should get this bug finally fixed for Ubuntu intrepid).
You should be able to access the card reader through gpg with and
without gpg-agent.
I use pinentry-gtk2 to get told when I should enter the pin. As I don't
use Evolution or Seahorse, I don't know how to best integrate with it. I
know that Seahorse has it's own gpg-agent, but I don't know how well
Seahorse works with the original gpg-agent or if the seahorse-agent can
access the card reader.
When you test with gpg-agent make sure that you use the one provided
from gpg2.
