
@_date: 2001-03-13 18:45:06
@_author: Rejo Zenger 
@_subject: Problem with PGP linebreaks 
I'm using Mutt 1.2.5i and GPG 1.0.4 on a Linux 2.2.16.
I have been told the encrypted email I'm sending does not have the
correct linebreaks.
This is a hexdump of a part of a message I have sent to him. Linebreaks
are platform-specific ("0A"; Unix style) instead of the platform-
independent ("0D0A", Internet-style).
  [...]
  0030: 2C 20 61 61 6E 67 65 28 70 7C 74 29 61 73 74 2E   , aange(p|t)ast.
  0040: 20 41 6C 73 20 68 65 74 0A 67 6F 65 64 20 69 73    Als het多goed is
  0050: 20 7A 6F 75 64 65 6E 20 6D 69 6A 6E 20 65 6D 61    zouden mijn ema
  0060: 69 6C 73 20 6E 75 20 61 6C 6C 65 65 6E 20 6E 6F   ils nu alleen no
  0070: 67 20 6D 61 61 72 20 6F 6C 64 2D 73 74 79 6C 65   g maar old-style
  0080: 20 73 69 67 6E 65 64 20 65 6E 0A 65 6E 63 72 79    signed en多encry
  0090: 70 74 65 64 20 6D 6F 65 74 65 6E 20 7A 69 6A 6E   pted moeten zijn
  00A0: 2E 0A 0A 5A 6F 75 64 65 6E 20 6A 75 6C 6C 69 65   .多多Zouden jullie
  [...]
This is what i have been told.
As I'm lacking knowledge at this point:
- Is this an issue at all?
- If it is, is it one caused by Mutt, GPG or something else?
- If it is, what is the best thing i can do solve this?
Relevant detail maybe, the command mutt uses when I sign and encrypt
email is (all on one line):
  set pgp_encrypt_sign_command="pgpewrap gpg --passphrase-fd 0 -v --batch
  --output - --encrypt --sign %?a?-u %a? --armor --always-trust -- -r %r
  -- %f"
So, what is the next thing I can do best?

@_date: 2002-05-02 09:51:02
@_author: Rejo Zenger 
@_subject: error: can't mmap pool 
Whatever I do with GnuPG i get the following error:
  gpg: can't mmap pool of 16384 bytes: Invalid argument - using malloc
I have just upgraded from 1.0.6 to 1.0.7. Because of this "Invalid
argument" I guess there must be something in my options file that
bothers gpg:
  no-greeting
  default-key 0x75FC50F3
  encrypt-to 0x75FC50F3
  force-v3-sigs
  escape-from-lines
  lock-once
  armor
  no-secmem-warning
Someone know's what is wrong?

@_date: 2002-05-02 13:35:02
@_author: Rejo Zenger 
@_subject: error: can't mmap pool 
++ 02/05/02 10:48 +0200 - Werner Koch:
It (old P/MMX) runs Linux 2.2.18. The distribution that was used is SuSE
7.1. The error started to appear after upgrading from SuSE 6.3. I seem
to run glibc version 2.2 release 7. Just before upgrading Linux, I have
upgraded GnuPG from 1.0.6 to 1.0.7. I didn't have the time to check that
No. It's not mentioned in that file at all.
I have noticed that configures is checking for mmap, it says it has
found it. I don't have any knowledge when it comes to this kind of
stuff, but maybe this is what you are looking for:
  configure:4991: checking for working mmap
  configure:5127: gcc -o conftest -g -O2   conftest.c  >&5
  configure:5130: $? = 0
  configure:5132: ./conftest
  configure:5135: $? = 0
  configure:5147: result: yes
  configure:9212: checking for mmap
  configure:9249: gcc -o conftest -g -O2   conftest.c -ldl  >&5
  configure:9252: $? = 0
  configure:9255: test -s conftest
  configure:9258: $? = 0
  configure:9268: result: yes
I hope this helps,
        -Rejo.

@_date: 2002-05-17 13:15:21
@_author: Rejo Zenger 
@_subject: error: can't mmap pool 
++ 15/05/02 20:32 +0200 - Werner Koch:
I would happily provide you with an strace output, you would need to
direct me a bit as I do not have the slightest experiences with those
In my case: yes. No problems in that version. Upgrading to 1.0.7 (and at
the same time upgrading my Linux distribution from SuSE 6.3 to 7.1) was
the point where this problem started to appear.

@_date: 2002-05-17 13:15:28
@_author: Rejo Zenger 
@_subject: error: can't mmap pool 
++ 16/05/02 09:14 +0200 - Werner Koch:
Here's the strace output when executing gpg without any options. Hope
this helps. If you need other information, please tell me.
Thanks, 	-Rejo.
execve("/usr/local/bin/gpg", ["gpg"], [/* 43 vars */]) = 0
uname({sys="Linux", node="eroticon-six", ...}) = 0
brk(0)                                  = 0x80e1dc0
open("/etc/ld.so.preload", O_RDONLY)    = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY)      = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=35606, ...}) = 0
old_mmap(NULL, 35606, PROT_READ, MAP_PRIVATE, 4, 0) = 0x40017000
close(4)                                = 0
open("/lib/libdl.so.2", O_RDONLY)       = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000\33\0"..., 1024) = 1024
fstat64(4, {st_mode=S_IFREG|0755, st_size=14330, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40020000
old_mmap(NULL, 11932, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40021000
mprotect(0x40023000, 3740, PROT_NONE)   = 0
old_mmap(0x40023000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4, 0x1000) = 0x40023000
close(4)                                = 0
open("/lib/libz.so.1", O_RDONLY)        = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\20\31\0"..., 1024) = 1024
fstat64(4, {st_mode=S_IFREG|0755, st_size=63381, ...}) = 0
old_mmap(NULL, 59032, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40024000
mprotect(0x40031000, 5784, PROT_NONE)   = 0
old_mmap(0x40031000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4, 0xc000) = 0x40031000
close(4)                                = 0
open("/lib/libc.so.6", O_RDONLY)        = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\200\314"..., 1024) = 1024
fstat64(4, {st_mode=S_IFREG|0755, st_size=1382179, ...}) = 0
old_mmap(NULL, 1123876, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40033000
mprotect(0x4013c000, 38436, PROT_NONE)  = 0
old_mmap(0x4013c000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4, 0x108000) = 0x4013c000
old_mmap(0x40142000, 13860, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40142000
close(4)                                = 0
open("/lib/libc.so.6", O_RDONLY)        = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\200\314"..., 1024) = 1024
fstat64(4, {st_mode=S_IFREG|0755, st_size=1382179, ...}) = 0
close(4)                                = 0
open("/lib/libc.so.6", O_RDONLY)        = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\200\314"..., 1024) = 1024
fstat64(4, {st_mode=S_IFREG|0755, st_size=1382179, ...}) = 0
close(4)                                = 0
munmap(0x40017000, 35606)               = 0
getpid()                                = 6137
brk(0)                                  = 0x80e1dc0
brk(0x80e1de0)                          = 0x80e1de0
brk(0x80e2000)                          = 0x80e2000
getrlimit(0x4, 0xbffff6e8, 0, 0x40016a44, 0x4) = -1 ENOSYS (Function not implemented)
setrlimit(RLIMIT_CORE, {rlim_cur=0, rlim_max=0}) = 0
rt_sigaction(SIGINT, NULL, {SIG_DFL}, 8) = 0
rt_sigaction(SIGINT, {0x8073af0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGHUP, NULL, {SIG_DFL}, 8) = 0
rt_sigaction(SIGHUP, {0x8073af0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGTERM, NULL, {SIG_DFL}, 8) = 0
rt_sigaction(SIGTERM, {0x8073af0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGQUIT, NULL, {SIG_DFL}, 8) = 0
rt_sigaction(SIGQUIT, {0x8073af0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGSEGV, NULL, {SIG_DFL}, 8) = 0
rt_sigaction(SIGSEGV, {0x8073af0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGUSR1, {0x8073bc0, [], 0x4000000}, NULL, 8) = 0
rt_sigaction(SIGPIPE, {SIG_IGN}, NULL, 8) = 0
open("/usr/share/locale/locale.alias", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=2576, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40017000
read(4, "# Locale name alias data base.\n 4096) = 2576
brk(0x80e3000)                          = 0x80e3000
read(4, "", 4096)                       = 0
close(4)                                = 0
munmap(0x40017000, 4096)                = 0
open("/usr/lib/locale/en_US/LC_IDENTIFICATION", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=244, ...}) = 0
old_mmap(NULL, 244, PROT_READ, MAP_PRIVATE, 4, 0) = 0x40017000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_MEASUREMENT", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=13, ...}) = 0
old_mmap(NULL, 13, PROT_READ, MAP_PRIVATE, 4, 0) = 0x40018000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_TELEPHONE", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=49, ...}) = 0
old_mmap(NULL, 49, PROT_READ, MAP_PRIVATE, 4, 0) = 0x40019000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_ADDRESS", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=145, ...}) = 0
old_mmap(NULL, 145, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001a000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_NAME", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=67, ...}) = 0
old_mmap(NULL, 67, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001b000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_PAPER", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=24, ...}) = 0
old_mmap(NULL, 24, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001c000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_MESSAGES", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFDIR|0755, st_size=1024, ...}) = 0
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_MESSAGES/SYS_LC_MESSAGES", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=42, ...}) = 0
old_mmap(NULL, 42, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001d000
close(4)                                = 0
brk(0x80e4000)                          = 0x80e4000
open("/usr/lib/locale/en_US/LC_MONETARY", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=276, ...}) = 0
old_mmap(NULL, 276, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001e000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_COLLATE", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=21484, ...}) = 0
old_mmap(NULL, 21484, PROT_READ, MAP_PRIVATE, 4, 0) = 0x40146000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_TIME", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=2441, ...}) = 0
old_mmap(NULL, 2441, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4001f000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_NUMERIC", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=44, ...}) = 0
old_mmap(NULL, 44, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4014c000
close(4)                                = 0
open("/usr/lib/locale/en_US/LC_CTYPE", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=104804, ...}) = 0
old_mmap(NULL, 104804, PROT_READ, MAP_PRIVATE, 4, 0) = 0x4014d000
close(4)                                = 0
open("/usr/share/locale/en_US/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/share/locale/en/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
write(2, "gpg: ", 5)                    = 5
write(2, "can\'t mmap pool of 16384 bytes: "..., 64) = 64
brk(0x80e9000)                          = 0x80e9000
SYS_199(0x40140ad8, 0x16, 0x40141760, 0x4013f210, 0x8051c70) = -1 ENOSYS (Function not implemented)
getuid()                                = 500
mlock(0x80e3948)                        = -1 EPERM (Operation not permitted)
geteuid()                               = 500
stat64("/home/rejo/.gnupg/options", {st_mode=S_IFREG|0600, st_size=2979, ...}) = 0
getuid()                                = 500
open("/home/rejo/.gnupg/options", O_RDONLY|O_LARGEFILE) = 4
fstat64(4, {st_mode=S_IFREG|0600, st_size=2979, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40167000
read(4, "# Options for GnuPG\n Unless y"..., 4096) = 2979
read(4, "", 4096)                       = 0
close(4)                                = 0
munmap(0x40167000, 4096)                = 0
stat64("~/.gnupg", 0xbffff6dc)          = -1 ENOENT (No such file or directory)
stat64("/home/rejo/.gnupg/random_seed", {st_mode=S_IFREG|0600, st_size=600, ...}) = 0
getuid()                                = 500
stat64("/home/rejo/.gnupg/secring.gpg", {st_mode=S_IFREG|0600, st_size=7899, ...}) = 0
getuid()                                = 500
open("/home/rejo/.gnupg/secring.gpg", O_RDONLY|O_LARGEFILE) = 4
fstat64(4, {st_mode=S_IFREG|0600, st_size=7899, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40167000
read(4, "\225\3\240\0034\2114\4\0\0\1\10\0\277\213Phj\240\24p3_"..., 4096) = 4096
close(4)                                = 0
munmap(0x40167000, 4096)                = 0
access("/home/rejo/.gnupg/secring.gpg", F_OK) = 0
brk(0x80ec000)                          = 0x80ec000
stat64("/home/rejo/.gnupg/pubring.gpg", {st_mode=S_IFREG|0600, st_size=147543, ...}) = 0
getuid()                                = 500
open("/home/rejo/.gnupg/pubring.gpg", O_RDONLY|O_LARGEFILE) = 4
fstat64(4, {st_mode=S_IFREG|0600, st_size=147543, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40167000
read(4, "\231\1\242\0046\251\272\251\21\4\0\314\34\276\355r\370"..., 4096) = 4096
close(4)                                = 0
munmap(0x40167000, 4096)                = 0
access("/home/rejo/.gnupg/pubring.gpg", F_OK) = 0
ioctl(0, TCGETS, {B38400 opost isig icanon echo ...}) = 0
ioctl(1, TCGETS, {B38400 opost isig icanon echo ...}) = 0
ioctl(2, TCGETS, {B38400 opost isig icanon echo ...}) = 0
open("/usr/local/share/locale/en_US/LC_MESSAGES/gnupg.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/local/share/locale/en/LC_MESSAGES/gnupg.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
write(2, "gpg: ", 5)                    = 5
write(2, "Go ahead and type your message ."..., 35) = 35
read(0, 0x80e9bb0, 8192)                = ? ERESTARTSYS (To be restarted)
--- SIGINT (Interrupt) ---
write(2, "\n", 1)                       = 1
write(2, "gpg", 3)                      = 3
write(2, ": ", 2)                       = 2
write(2, "Interrupt", 9)                = 9
write(2, " caught ... exiting\n\0", 21) = 21
rt_sigaction(SIGINT, {SIG_DFL}, NULL, 8) = 0
getpid()                                = 6137
kill(6137, SIGINT)                      = 0
sigreturn()                             = ? (mask now [])
--- SIGINT (Interrupt) ---
+++ killed by SIGINT +++
