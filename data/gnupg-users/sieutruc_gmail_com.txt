
@_date: 2014-08-06 16:57:26
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the pubring.gpg,  
Currently, iam doing a project that uses gpg.
I set the working directory for gpg with the permission like :
securgpg 775  Test1 groupTest2
   -rw-r--r--.    1 Test1  groupTest2    42  6 ao?t  16:29 gpg-agent.conf
   -rw-r--r--.    1 Test1  groupTest2  7960  6 ao?t  16:29 gpg.conf
   -rw-rw-r--.   1 Test1  groupTest2  9269  6 ao?t  16:38 pubring.gpg
   -rw-rw-r--.   1 Test1  groupTest2  9269  6 ao?t  16:38 pubring.gpg~
   -rw-rw-rw-.    1 Test1  groupTest2   600  6 ao?t  16:35 random_seed
   -rw-r--r--.    1 Test1  groupTest2  2851  6 ao?t  16:35 secring.gpg
   -rw-rw-rw-. 1 Test1  groupTest2  1600  6 ao?t  16:38 trustdb.gpg
But when Test1 imports a new key to key store, he changes all the file like
   -rw-rw-r--.   1 Test1  groupTest1  9269  6 ao?t  16:38 pubring.gpg
   -rw-rw-r--.   1 Test1  groupTest1  9269  6 ao?t  16:38 pubring.gpg~
   -rw-------.    1 Test1  groupTest1   600  6 ao?t  16:35 random_seed
   -rw-------.    1 Test1  groupTest1  2851  6 ao?t  16:35 secring.gpg
and similarly in the case of Test2
   -rw-rw-r--.   1 Test2  groupTest2  9269  6 ao?t  16:38 pubring.gpg
   -rw-rw-r--.   1 Test2  groupTest2  9269  6 ao?t  16:38 pubring.gpg~
   -rw-------.    1 Test2  groupTest2   600  6 ao?t  16:35 random_seed
   -rw-------.    1 Test2  groupTest2  2851  6 ao?t  16:35 secring.gpg
So that i cannot access to key store on using two accounts.
Can you suggest to me any solution that will preserve the
permission/user/group like as it was set originally.

@_date: 2014-08-07 00:52:48
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
I know well your advices , but actually i need to assign 3 users to handle
the keyring.
One like admin , he can modify and add the secret key
Another like test1 , he cannot add secret key but he can add public keys
And the third callled test2 , he cannot add any key but can use that
keyring for do a securisation or desecurisation.
And on my file system, i cannot activate acl so i desgin to give
to trustdb and worldreadable to pubring and secring. If not, the test2
cannot do securisation.
   -rw-r--r--.    1 admin  groupTest1    42  6 ao?t  16:29 gpg-agent.conf
   -rw-r--r--.    1 admin  groupTest1  7960  6 ao?t  16:29 gpg.conf
   -rw-rw-r--.   1 admin  groupTest1  9269  6 ao?t  16:38 pubring.gpg
   -rw-rw-r--.   1 admin  groupTest1  9269  6 ao?t  16:38 pubring.gpg~
   -rw-rw-rw-.    1 admin  groupTest1   600  6 ao?t  16:35 random_seed
   -rw-r--r--.    1 admin groupTest1  2851  6 ao?t  16:35 secring.gpg
   -rw-rw-rw-. 1 admin  groupTest1  1600  6 ao?t  16:38 trustdb.gpg
make the gpghome directory set-gid. Forgot to mention that in my mail :).
So i have already set the group id to the gpg folder, so all the
pubring.gpg, pubring.gpg~,secring.gpg created by gpg have the group of gpg
And the permission can be restored to the origin with chmod after itst
But the problem still persist because the normal user cannot user chown so
the user of 2 files pubring and secring are set to the person that launched
the command.
Therefor, i need only to fix the ownership (user) of those 2 files.
Any idea ? i dont know what you mean
On Wed, Aug 6, 2014 at 9:24 PM, Peter Lebbing

@_date: 2014-08-07 09:03:30
@_author: Sieu Truc 
@_subject: GnuPG 2.0.21 install - AIX 
Actually, i did a compilation of gnupg 2.0.22 successfully as showed in
this site (AIX 6.1):
But i couldn't run it because the gpg-agent failed to start (libassuan
failed), specified here
And look at carefully at the output of configure command,  gcc no , cc no.,
you don't have gcc or cc in your system.
Please following the site above to set all environment variables ( of
course you have to install gcc or xlc if you have  ).
Tell me if you can run gpg in your machine.

@_date: 2014-08-07 13:44:23
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
Thank alot for your advices and your solution, so that i understand more
about gpg.
But actually, it's not me to decide whether i should use a shared secring
but the client wants to have 3 users using the shared keyring.
Each users belong to one specific group as described above (admin:control
all, test1 (groupTest1): can add public key (no operation with secret key),
test2 (groupTest2): can use only gpg --encrypt/sign/decrypt)
On WIndows, i did that without any problem because the owner of created
file can position the access rights like adding more permissions/more
user/group on those files.
That means after an operation, i have a subfunction that allow restoring
its original permissions as well as its ownership.
In Linux, it seems impossible to use traditional permission, because one
file can have only one user, one group (other -all the others) , and the
owner of the file cannot transfer his right to the other. that's reason why
i let "others " owner acts like the test2 ( can read pubring and secring)
Maybe i will discuss with them to get something that can be feasable.
On Thu, Aug 7, 2014 at 11:55 AM, Peter Lebbing

@_date: 2014-08-07 14:34:58
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
sorry about that. I'm trying to be too fast about it, I suppose.
No need to say sorry, iam really appreciated your help.
I understood what you suggested. But in the specification of my project ,
one user can belong to only one groups. It's hard to implement so that why
i need your help.
I set gid on the gpg folder, so it forces all created files by gpg to have
groupTest1 as group owner. It's ok
But test1 lauche the gpg command, then change the user owner of file to
his, like test1:groupTest1. The result is the admin cannot import a new key
to the keyring.... So your solution doesn't resolve that problem.
And i have a question to you and Werner, how can gpg change the user owner
ship of the file ? normally only root can change the ownership.
On Thu, Aug 7, 2014 at 2:11 PM, Peter Lebbing

@_date: 2014-08-07 16:18:47
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
Especially thank to the idea of Peter, i finally got a solution :
I describe the full problem and my goal again:
 I have 3 types of users and each users belong to one specific group as
  "admin" can do anything(add/remove secret or public keys)
  "test1 (groupTest1)" can only manipulate public key (no operation with
secret key)
   test2 (groupTest2): can use only gpg --encrypt/sign/decrypt so he
doesn't touch any key management action.
And i have only root so set the access permission only one time when
setting up the product, typically gpg folder and its components.
And my design  (maybe not so good) for those purposes is like:
gpgshare drwxrwxsr-x admin groupTest1
   -rw-r--r--    admin:groupTest1    42  6 ao?t  16:29 gpg-agent.conf
   -rw-r--r--    admin:groupTest1  7960  6 ao?t  16:29 gpg.conf
   -rw-rw-r--   admin:groupTest1/test1:groupAdmin  9269  6 ao?t  16:38
   -rw-rw----   admin:groupTest1   600  6 ao?t  16:35 random_seed
   -rw-rw-r--   admin:groupTest1  1600  6 ao?t  16:38 trustdb.gpg
   drwxr-sr-x   admin:groupTest1  1600  6 ao?t  16:38 secfolder  (set gid)
           -rw-r--r--    admin:groupTest1  2851  6 ao?t  16:35 secfolder\
   drwxr-s---   admin:groupTest1  1600  6 ao?t  16:38 admin_pubring_temp  (set
   drwxrws---   admin:groupAdmin  1600  6 ao?t  16:38 test1_pubring_temp  (set
So everytime, test1 imports a public key ,he copies pubring to
folder and and overwrite the result to the original pubring.gpg. At that
time, this new pubring has the access permissions like
"test1:groupAdmin" (groupAdmin
is inherited from test1_pubring_temp folder with setgid). So admin and test
can manipulate pubring at the sametime.
And similarly if admin importes a public key, the final pubring.gpg has
"admin:groupTest1"(groupTest1 is set from admin_pubring_temp folder with
(here i use cp -p )
Of course, the permission numeric mode can be set via chmod ( they can do
because they are owners of the files).
Thank you.
On Thu, Aug 7, 2014 at 3:01 PM, Kristian Fiskerstrand <

@_date: 2014-08-07 16:21:44
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
drwxrws---   admin:groupAdmin  1600  6 ao?t  16:38 test1_pubring_temp  (set
 drwxrws---   test1:groupAdmin  1600  6 ao?t  16:38 test1_pubring_temp  (set

@_date: 2014-08-08 14:11:40
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
Peter, yeah i see your idea.
It's good.
So maybe i will ask my client which one he prefers using.
On Fri, Aug 8, 2014 at 11:06 AM, Peter Lebbing But why doesn't gpg have primary secring option ?
Thank you very much.
On Fri, Aug 8, 2014 at 11:06 AM, Peter Lebbing

@_date: 2014-08-08 17:03:44
@_author: Sieu Truc 
@_subject: How to preserve the permission/owner/group owner on the 
Thank for your suggestion.
Actually, my scripts have to work in 2 platforms AIX et Linux, and those
users don't have any special access rights.

@_date: 2014-12-03 16:31:26
@_author: Sieu Truc 
@_subject: GPG cannot evaluate the length of text file. 
I have a problem when i wanted to sign and encrypt a text file ( attached
gpg--y --batch --passphrase "B6rDhgMDEqv0DscSdxe" -o 4481110.txt.pgp
--textmode  -r test1 --sign --encrypt 4481110.txt
gpg2 --verbose --no-mdc-warning --verbose --y --batch --passphrase
"B6rDhgMDEqv0DscSdxe"  --list-packets 4481110.txt.pgp
:pubkey enc packet: version 3, algo 1, keyid EA0DF160773268B0
    data: [2041 bits]
gpg: la cl? publique est 773268B0
gpg: utilisation de la sous-cl? 773268B0 ? la place de la cl?
principale 7FD35007
gpg: donn?es chiffr?es par cl? publique: bonne cl? de chiffrement (DEK)
:encrypted data packet:
    length: 491
    mdc_method: 2
gpg: utilisation de la sous-cl? 773268B0 ? la place de la cl?
principale 7FD35007
gpg: chiffr? avec une cl? de 2048 bits RSA, ID 773268B0, cr??e le 2014-07-02
      ? T.A.FICP.30001 ?
gpg: donn?es chiffr?es avec AES
:compressed packet: algo=1
:onepass_sig packet: keyid EA0DF160773268B0
    version 3, sigclass 0x01, digest 2, pubkey 1, last=1
:literal data packet:
    mode t (74), created 1417110768, name="4481110.txt",
    raw data: unknown length  ( THE PROBLEM HERE )
As i know, if the file length is more than 5Gb, that problem appears.
But this file has only 499b. Its weird.
Can someone show me the problem ?
Thanks in advance,

@_date: 2014-12-03 22:59:14
@_author: Sieu Truc 
@_subject: GPG cannot evaluate the length of text file. 
I read some articles about partial length encoding.
But i don't really understand how gpg can determine when to use partial
length encoding or other methods (one octet, 2 octets, 4 octets)
To be clear, in the file attached above, if i remove one line or reduce the
length of data just a bit, i get the section ":signature packet: algo
1, keyed F1B3EC4859B360A7' and gpg is able to detect data length.
So how can i deactivate  "partial length encoding" because i want to get
the information in "signature packet" for my application.

@_date: 2014-12-03 23:04:59
@_author: Sieu Truc 
@_subject: GPG cannot evaluate the length of text file. 
I read some articles about partial length encoding.
But i don't really understand how gpg can determine when to use partial
length encoding or other methods (one octet, 2 octets, 4 octets)
To be clear, in the file attached above, if i remove one line or reduce the
length of data just a bit, i get the section ":signature packet: algo
1, keyed F1B3EC4859B360A7' and gpg is able to detect data length.
So how can i deactivate  "partial length encoding" because i want to get
the information in "signature packet" for my application.
