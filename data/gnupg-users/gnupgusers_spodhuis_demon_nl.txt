
@_date: 2006-02-27 11:47:59
@_author: Phil Pennock 
@_subject: Ohhhh jeeee: ... this is a bug (getkey.c:2079:merge_selfsigs) 
Is this a known issue, fixed in 1.4.3?
There's nothing obviously dealing with it in
% gpg --version
gpg (GnuPG) 1.4.2.1-ecc0.1.6
% gpg --list-sigs 0xC9541FB2
gpg: Ohhhh jeeee: ... this is a bug (getkey.c:2079:merge_selfsigs)
secmem usage: 1408/1408 bytes in 2/2 blocks of pool 1408/32768
sig          0x2927A28A 2003-01-12  zsh: abort      gpg --list-sigs 0xC9541FB2
A selection of other complaints listing signatures on that key:
gpg: packet(7) with unknown version 0
gpg: keyring_get_keyblock: read error: invalid packet
gpg: keydb_get_keyblock failed: invalid keyring
gpg: keydb_search failed: invalid keyring
gpg: skipped compressed packet in keyring
gpg: keydb_get_keyblock failed: eof
gpg: [don't know]: indeterminate length for invalid packet type 6
gpg: keyring_get_keyblock: read error: invalid packet
gpg: keydb_get_keyblock failed: invalid keyring
gpg: keydb_search failed: invalid keyring
gpg: [don't know]: invalid packet (ctb=03)
gpg: keyring_get_keyblock: read error: invalid packet
gpg: keydb_get_keyblock failed: invalid keyring
gpg: keydb_search failed: invalid keyring
 (also with a few other values of ctb)
gpg: packet(14) with unknown version 115
gpg: keyring_get_keyblock: read error: invalid packet
gpg: keydb_get_keyblock failed: invalid keyring
gpg: keydb_search failed: invalid keyring

@_date: 2006-02-28 11:12:58
@_author: Phil Pennock 
@_subject: Ohhhh jeeee: ... this is a bug (getkey.c:2079:merge_selfsigs) 
I hadn't, since the official version has the mpicoder bug which causes
it to abort whilst processing some keys on my keyring; Gentoo pulls in
your patch, after I noted this and pointed to it;
Taking the official 1.4.2.1 code and applying that patch, things worked;
but I then used the Gentoo gpg and things still worked.  So I'm now
confused.  I don't see what's different between the set-up yesterday and
today, except that baseline code has run over the keyring; I ran "gpg
--update-trustdb" with the Gentoo version and the problem is still
Okay, thanks.

@_date: 2006-03-01 14:12:03
@_author: Phil Pennock 
@_subject: Ohhhh jeeee: ... this is a bug (getkey.c:2079:merge_selfsigs) 
It's a public key for someone else, imported with --recv-key, because
it's in a trust path I need.
I do have a rather large public key ring (69MB); at times when the trust
path tools have been broken, I wrote a gpg_fetchsigners wrapper which
imports the signers on a key; it's not very good for finding the keys
signed _by_ a key, but there is a degree of correlation and so it's been
adequate to let me get a decent population of trust paths to things I
need (signers of security notices, packages, etc).  I'm tempted to dump
out my public keyring and only re-import those which are on my current
ownertrust list.
So yes, I've seen various broken signatures and hit the mpi bug.

@_date: 2006-03-02 16:20:37
@_author: Phil Pennock 
@_subject: Ohhhh jeeee: ... this is a bug (getkey.c:2079:merge_selfsigs) 
Makes sense, although I'm curious as to what, and how it might have been
Everything appears to, yes.
Thanks.  In this case, because there had been recent-ish core MPI
changes which David had provided one patch for, I assumed that this was
core gnupg and not anything touched by the Gentoo patches.  Silly me,
Gentoo patches touch _everything_.  ;^)
I thought that the ECC patch just provided eliptic-curve crypto, so for
keys using normal sigs, it wouldn't have any effect; I'm rather
surprised that a keyring problem could be caused by it.
