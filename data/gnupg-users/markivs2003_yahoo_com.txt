
@_date: 2005-01-14 16:10:51
@_author: Mark Ivs 
@_subject: signing and encrypting newbie question 
I am a very new to PGP. So please bare with my
question if it is really simple.
I am working on a project where I need to put some
signed encrypted files on an ftp site and our customer
will ftp it from there.
Here is what they want me to do. Please let me know if
it is do-able.
We have already  exchanged our public keys. Their
public key is added to our key ring. Before placing
the files on our ftp site for their retrieval,
customer wants me to SIGN the files with our public
key and ENCRYPT it using their public key. Please let me know if this is doable and if it makes
sense.  If so can some one how it can be done? I know
how to encrypt the files but I don't understand how to
encrypt and sign the files. Thanks a lot in advance.
For just encryption this is what I tried(it works):
gpg --recipient "XXX" --output $rootpath\\$filepgp
--encrypt $rootpath\\encrypted\\$file`;
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-14 22:20:45
@_author: Mark Ivs 
@_subject: Signing files 
Can you llease clarify this...
Lets say, I have GnuPG installed in machine A. I
created a public key from machine A and I sent it to
my customer. I received their Public key also. I need to encrypt and sign the files and put it in my
ftp site and my customer will ftp it from there.
I am going to encrypt the files using their public key
and sign it using my private key.
The problem is, this encryption program will run on
Machine B. I have installed GnuPG in Machine B also. I
am thinking I can add the public key created from
Machine A to my key ring in Machine B. I know the
passphrase for the key I generated from Machine A. For
me to sign the files, do I need anything else from
Machine A? private key or other files??  Please let me know. Thanks in advance. Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-15 18:22:41
@_author: Mark Ivs 
@_subject: 2 ways of signing files 
I would like to know if there are 2 ways of signing.
Please take a look at the following scenarios.
Scenario 1:
I add Blake's public key to my key ring. I can do the
following 2 steps to edit and sign Blake's public key.
1. gpg --edit-key blake
2. Command> sign
This will sign the key. So, now I can encrypt the file
by doing the following...
'gpg --recipient "blake --output
$rootpath\\$filepgp --encrypt
When Blake gets the encrypted file, does it mean that
the file is also signed?
Scenario 2:
I can encrypt and sign by doing the following.
'gpg --recipient "XXX" --output $rootpath\\$filepgp
--sign --encrypt $rootpath\\encrypted\\$datafile`
Can someone please tell me if scenario 1 and 2 are
basically doing the same thing?
Thanks in advance.
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-16 06:08:03
@_author: Mark Ivs 
@_subject: auto sign files 
I have the following line in my perl script that signs
and encrypt files.
'gpg --recipient "XXX" --output $rootpath\\$filepgp
--sign --encrypt $rootpath\\encrypted\\$datafile`
When I run the perl script from command prompt it asks
me to enter the passphrase. When I enter the
passphrase it signs and finally encrypts the files.
That's all good.
The problem is I need to run my perl script as a batch
file through Windows NT scheduled task, which is
scheduled to run few times a day. That means I cannot
manually type the passphrase everytime. So, I was
wondering if there is a way to enter the passphrase in
the above gpg command itself. Or is there any other
solution to this problem? I believe others must have
ran into this issue before, since it looks like a
common problem.
As always thank you soo much in advance. I am new to
this group and this is one of the BEST group!
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-16 19:03:32
@_author: Mark Ivs 
@_subject: auto sign files 
Thank you for your detailed explanation of why it's
very bad idea to sign it using a script.
I am going to present the concerns to people involved
and let them be fully aware of the risks. My guess is
they are going to tell our customer that since this is
an automated process, we can only encrypt it but not
encrypt & sign.
Earlier, I was thinking auto signing files was
possible in a secure way after reading the
documentation in the link below.
Is that FAQ question about auto-signing keys or
auto-signing files? Can you please clarify?
What does that mean?
Now that I understand the risks involved, I wouldn't
use a script to auto sign files.
But still I am curious to know how you would do it.
Btw, I don't have my passphrase on a post-it note :)
Thanks again.
__________________________________ Do you Yahoo!? Yahoo! Mail - 250MB free storage. Do more. Manage less.

@_date: 2005-01-17 19:25:14
@_author: Mark Ivs 
@_subject: auto sign files 
David and Jim, Thank you very much for the response.
For automated signing to work, I followed the
instruction in I followed the steps in the instructions and when I
try the following command,
gpg --recipient "XXX" --output $rootpath\\$filepgp
--batch --encrypt --sign $rootpath\\encrypted\\$file
I get the following error:
gpg: secret key parts are not available
gpg: no default secret key: general error
gpg: MYFILE-2004.pdf: sign+encrypt failed: general
Here's what I did to configure...
1. Let's say my pub key id is AAA. To Create sub key,
I typed:
gpg --edit-key AAA
addkey > DSA type
3. Let's say the sub-key I created has keyid 999
2. Listed keys: gpg --list-keys. It shows 1 pub and 2
subs keys
gpg --export-secret-subkeys --no-comment 999
3. Exported the sub-key by using the command:
gpg --export-secret-subkeys --no-comment 999
3. Copied secring.auto, pubring.gpg and pgp.exe to a
C:\TEMP dir.
4. Renamed secring.auto it to secring.gpg
5. gpg --homedir . --edit 999
6. command> passwd. It prompted for passpharase and I
entered it. Then it propmted for new passphrase. I
simply hit enter key without typing anything. Did it
again when asked for confirmation.
7. I didn't delete the other sub-key. 8. Install secring.gpg as the secret keyring by typing
gpg --allow-secret-key-import -import
Can anyone please tell me where I am going wrong.
Thank you sooo much in advance!
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-18 14:59:59
@_author: Mark Ivs 
@_subject: capture gpg return value 
Is there a way to know if the encryption was
successful? I tried the following...
$errorval = 'gpg --recipient "XXX" --output
$rootpath\\output\\$filepgp --encrypt
if($errorval) {
errorval doesn't seem to have any value, so it never
goes into the if statement.
The problem I am facing is, when the output folder
already has the encrypted files(from previous run), I
get the following error on the console.
"gpg: myfile.csv: encrypt failed: file exists"
I want to capture that error inside my if statement
and log it.
Thanks in advance.
__________________________________ Do you Yahoo!? Yahoo! Mail - 250MB free storage. Do more. Manage less.

@_date: 2005-01-27 20:52:42
@_author: Mark Ivs 
@_subject: gpg return value problem 
I am trying to capture the return value from the gpg
command. Documentation says, gpg will return 0 if
successful or return 1 if there's an error.
$errorval = 0;
$errorval = 'gpg --recipient "XXX" --output
$rootpath\\output\\$filepgp --encrypt
The value of $errorval is always blank(even if there
is an error in the encryption). When I try to print
$errorval, it is blank.
Any help will be very much appreciated.
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around

@_date: 2005-01-31 00:32:27
@_author: Mark Ivs 
@_subject: gpg return value problem 
Thanks a lot for the response. Since I am using perl I tried the following...
gpg --recipient "XXX" --output bla-bla-bla
print $errorval;
When there is an error, it prints 512. When the
encryption is successful it prints 0. That's great. I
was trying to find out more documentation about error
codes. But couldn't find anything.
I intentionally mis-spelled receipient or output or
recipient name but always got 512 error code. I was
assuming I will get different error codes. Is this the
correct behaviour or am I missing something?
Can someone please explain? Thanks a lot in advance.
--- Ivan Boldyrev
__________________________________ Do you Yahoo!? Take Yahoo! Mail with you! Get it on your mobile phone.
