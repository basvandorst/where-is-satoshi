
@_date: 2015-10-29 18:48:43
@_author: Johannes Zarl-Zierl 
@_subject: TOFU for GnuPG 
Hi Neal,
Thanks for the heads-up on this. TOFU seems like a really big feature for everyday use!
Out of curiosity: Does the TOFU implementation for gpg already allow for key transition statements / is this planned for some point in the future?
  Johannes

@_date: 2016-04-28 00:54:05
@_author: Johannes Zarl-Zierl 
@_subject: Is there a foolproof tutorial to start with gpgme? 
The usual way is for a library to provide a PackageConfig.cmake file. The old-
style FindPackage.cmake "plugins" are very much deprecated and it's hard to convince cmake maintainers to accept a new one...
That being said, it shouldn't be too hard to create a working gpgme-
config.cmake file using autotools....
  Johannes

@_date: 2018-03-22 22:37:22
@_author: Johannes Zarl-Zierl 
@_subject: Missing feedback when changing a card pin fails 
I've just spent half an hour scratching my head over an issue that should have been simple:
I initialized a new OpenPGP card (v2.1 from Zeitcontrol) and changed the (user) pin.
After this, I used the verify command to check whether the pin was working: I put my pin into the pinentry dialog, and verified that the retry count afterwards was still "3 0 3".
Still, when I was prompted the pin afterwards I got the error "wrong pin". Strangely enough, the retry counter did not decrease when entering the pin. Entering a different random pin resulted in the retry counter decreasing as it [Fast-forward through lots of head-scratching, mild swearing and asking myself whether the card was broken.]
In the end the simple truth was that my pin code only had 5 digits, but the minimum length is higher. Yes, I know that I *should* know the minimum pin-
code length for my card, and that I *should* use longer pins anyways.
Is it possible to issue some kind of diagnostic for this? I.e. either a warning/error message when changing the pin, or at least the "verify" command issuing a warning on an incorrect pin?
Btw. my gpg version is 2.2.5.
  Johannes

@_date: 2019-07-07 22:37:00
@_author: Johannes Zarl-Zierl 
@_subject: Testing WKD setup? 
Thank you! This is so much easier to comprehend than the official   Johannes

@_date: 2019-07-09 23:33:19
@_author: Johannes Zarl-Zierl 
@_subject: WKD documentation (Re: Testing WKD setup?) 
I think the problem with that page is that it is handed out as a starting point to users asking "how can I enable WKD for my key?". To give credit, the page does give a decent explanation of the concepts of WKD:
    What is a Web Key Directory?
    How does it work?
These two sections are a good start.
    What does it mean for users?
Here I got sidelined a little: Basically, everything's nice for users and we don't need to do anything, I guess? I think the example video shows that you can just write an email and the mail client encrypted it to the recipient. Having subtitles (or a narrator) would probably make the intent of the video For me as a user, it would also be nice to know if WKD "just happens" automatically, or if I need to enable it, or give it precedence over my configured default keyserver...
    How to set it up?
This section is "lots" of text with the important info hidden behind a link. I say "lots" even though it's hardly a paragraph, because it's roughly a whole line with boilerplate text and the link is a single word. Just putting "See: WKDHosting" without the paragraph would be better.
Maybe a bullet-list could do the job:
 - Simple deployment (just a webserver): WKDHosting
 - Deployment with automated updates (recommended for organizations): WKS
    Web Key Directory (WKD) / Web Key Service (WKS) what is the difference?
This is literally a list of differences - why not make it a list?
    Technical Details
    Implementations
(Nothing wrong with those two sections).
Wiktor's page gave me enough of a starting point so that I could figure out the missing details. Actually, just entering my email into the form and then working to fix every complaint until it works wasn't too bad a user experience That's definitely an improvement - previously, I only took passing note of the page, noting that there has to be an easier way than "download some code from mercurial somewhere, install python prerequisites, create specially crafted keyring, and then it's just a one-liner to create the WKD.
Now that I have done it once, I think the setup without /usr/lib/gnupg/gpg-
wks-client isn't that complicated either:
Basic steps:
1. Create directory structure: mkdir -p .well-known/openpgp/hu
2. Create policy file: touch .well-known/openpgp/policy
   (explaining valid policies and why one would want one)
3. Identify your key hash: gpg --list-secret-keys --with-wkd $KEYID
   -> Make sure to omit the domain part starting with "
4. Export your key to the right place:
   gpg --export-options export-clean --export $KEYID > .well-known/openpgp/hu/
   (I'm not sure about the export-clean - it just seemed like a reasonable Webserver configuration:
1. Turn off directory listing for .well-known/openpgp unless you really want 2. Enable those header things that are mentioned in the wkd checker
   (explain the rationale behind this)
a. using Wiktors web wkd-checker, which also checks best-practice
b. Manually, using gpg: gpg --homedir "$(mktemp -d)" --locate-keys $KEYID
I hope this helps a little,
  Johannes
P.S.: Now that I've read up on the other mails it seems that it is also possible to host the WKD on a subdomain - I guess this could also need some documentation (describe the lookup-procedure on the WKD page under "How it works"; describe the differences in setup on WKDHosting)

@_date: 2019-07-10 21:47:54
@_author: Johannes Zarl-Zierl 
@_subject: WKD documentation (Re: Testing WKD setup?) 
Am Mittwoch, 10. Juli 2019, 19:34:41 CEST schrieb Werner Koch:
...except it isn't installed by default. Will this be part of gpg-wks-client? But in the future when it is installed by default, I 100% agree with you.
Btw, and because we are on the topic of documentation: there is no mention of gpg-wks-tool anywhere in the WKD or WKDHosting pages.
Anyways: whether you promote gpg-wks-client or gpg-wks-tool (which, hopefully, won't be installed to libexec), it would still be beneficial to describe the actual file system layout.
That seems nice - I will take note for the time this enters Debian...
  Johannes

@_date: 2019-07-12 15:11:28
@_author: Johannes Zarl-Zierl 
@_subject: WKD documentation (Re: Testing WKD setup?) 
Am Freitag, 12. Juli 2019, 10:30:30 CEST schrieb Werner Koch via Gnupg-users:
Thanks for the clarification.
Sorry, I should have separated this better from the previous sentence. What I meant are two things:
1. If a user is ever to execute gpg-wks-client directly or through a script, libexec should not be used: [1]
Right now I have the bizarre situation on Debian unstable that gpg-wks-server is in /usr/bin even though it is meant to be executed by a service and not by a user, but gpg-wks-client is located in /usr/lib/gnupg (Debian has no libexec, I think).
[1] 2. It would still be beneficial to describe the actual file system layout of the WKD.
This can either be done implicitly in the step-by-step guide ("After the call to gpg-wks-client, 'find .well-known/openpgp' should list a directory structure similar to this one: ..."). Or it can be documented separately on the WKD page, also explaining different options (e.g. is there a different WKD layout when WKD is deployed on a sub-domain, what are possible values for the policy file) with links to the canonical reference documentation.
  Johannes
