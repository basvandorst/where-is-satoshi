
@_date: 2017-10-10 10:51:16
@_author: Fourhundred Thecat 
@_subject: gnupg on read-only filesystem 
I am using gnupg 2.1.18-6 on Debian Stretch.
My root partition (/) is mounted read-only and I cannot use gpg as root,
because gpg wants to start gpg-agent and write to /root/.gnupg/
  gpg -d file.gpg
  gpg: error creating keybox '/root/.gnupg/pubring.kbx': Read-only file
  gpg: keyblock resource '/root/.gnupg/pubring.kbx': Read-only file system
  gpg: can't connect to the agent: IPC connect call failed
  gpg: problem with the agent: No agent running
  gpg: decryption failed: No secret key
With gpg version 1, I could use --lock-never and --no-use-agent and it
worked on read-only filesystem.
How can I use gpg version 2 on read-only filesystem and without agent ?

@_date: 2017-10-11 08:53:59
@_author: Fourhundred Thecat 
@_subject: gnupg on read-only filesystem 
thank you, that works.
But it still starts the gpg-agent.
How can I use gpg without the agent ?

@_date: 2019-11-02 15:35:06
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
how can I simply encrypt a file in "batch mode", ie in a script, without
user interaction, without need for the user to type password, without
gpg agent?
Below are the errors that I get when running:
$ gpg --lock-never -e -s -r user at domain.com --output zz zz.gpg
What is the reason why simple operations should not be possible without
gpg-agent ?
gpg: starting migration from earlier GnuPG versions
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: error: GnuPG agent unusable. Please check that a GnuPG agent can be
gpg: migration aborted
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: keydb_search failed: No agent running
gpg: no default secret key: No agent running
gpg: gpg.conf.gpg: sign+encrypt failed: No agent running
my version: gpg (GnuPG) 2.2.12

@_date: 2019-11-02 18:14:53
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
Unfortunately, this does not work. I get same error as before (pasted
Also, what is the purpose of --passphrase="pw", when I want to encrypt
using public key ?
$ gpg --batch --yes --passphrase="pw" --pinentry-mode loopback -o zz.gpg
-esr user at domain.com zz
gpg: starting migration from earlier GnuPG versions
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: error: GnuPG agent unusable. Please check that a GnuPG agent can be
gpg: migration aborted
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: keydb_search failed: No agent running
gpg: no default secret key: No agent running
gpg: zz: sign+encrypt failed: No agent running

@_date: 2019-11-03 07:24:13
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
You are right. It works when I remove "-s".
But it makes no sense. This particular private key has no passphrase. So
shouldn't signing work in batch mode as well ?
Also, I still get an error when trustdb.gpg is not writable.
I am specifically using "--no-auto-check-trustdb" and "--lock-never",
but these options do not seem to have any effect.
Here is full syntax I am using now:
gpg --no-auto-check-trustdb --lock-never --no-verbose --batch --yes
--pinentry-mode loopback -e -r user at domain.com -o zz.gpg zz
The above works, if trustdb.gpg is writable. It fails if it is not:
gpg: Fatal: can't open '/var/lib/asterisk/.gnupg/trustdb.gpg': Operation
not permitted
Why does gpg need trustdb.gpg to be writable? I am not asking to change
any trust settings. I just need simply to encrypt file.

@_date: 2019-11-03 08:31:10
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
I am sure the private key has no passphrase. Everything worked fine with
same private key on gpg 1.4.12
But now, I cannot even list keys from secring.gpg
$ gpg --list-secret-keys
gpg: can't connect to the agent: No such file or directory
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
Same error when I try "--edit-key"
  failed to start agent '/usr/bin/gpg-agent': No such file or directory
The only thing that works is "gpg --list-packets secring.gpg"
$ gpg --list-packets secring.gpg | grep protect
I believe this shows that secret key is not password protected
If it was, it would have:
  protect count:
  protect IV:
well, if trustdb.gpg is not writable, how could it lead to corruption.
That's the whole point. I want read-only access to trustdb.gpg, because
I don't want to make any changes.

@_date: 2019-11-04 16:49:01
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
Yes, that is exactly the problem. Why should simple operations require
gpg agent ?
Imagine the authors of "cat" or "ls" decided that these utilities no
longer work without cat-agent or ls-agent.
What will be next? gpg will not work without gnome desktop ?

@_date: 2019-11-04 18:16:32
@_author: Fourhundred Thecat 
@_subject: encrypt file in batch mode 
Excuse me, but taking a core system utility and making it dependent on a
daemon running at all times is not Unix philosophy.

@_date: 2019-11-09 07:01:28
@_author: Fourhundred Thecat 
@_subject: decrypt file in batch mode 
I have a file which has been encrypted with a symmetric cipher (using a
How can I decrypt this file in batch mode, without gpg-agent ?
$ gpg --lock-never --no-verbose --batch --yes -d zz.gpg
gpg: AES256 encrypted data
gpg: failed to start agent '/usr/bin/gpg-agent': No such file or directory
gpg: can't connect to the agent: No such file or directory
gpg: problem with the agent: No agent running
gpg: encrypted with 1 passphrase
gpg: decryption failed: No secret key
Why does gpg look for secret key ?
This is symmetric encryption. What does it need secret key for ?
Any way to circumvent this ?

@_date: 2019-10-20 07:22:46
@_author: Fourhundred Thecat 
@_subject: gpg on read-only filesystem 
how can I use gpg without agent ?
Also, how can I use gpg as root, when / is mounted read-only?
I understand the advantages of gpg agent, and I am happily using it as
user on my desktop.
But, on my remote server , I don't want to use any agent. I don't need
any program remembering my passwords, and I don't need any fancy
password prompts.
I just need basic function (decrypt .gpg file)
Also, I consider it good practice to have / mounted read-only, and I
don't understand why gpg would need to open trustdb.gpg in rw mode, when
using  simple operations such as gpg --verify.
gpg: Fatal: can't open '/root/.gnupg/trustdb.gpg': Operation not permitted
In older versions of gpg, it complained abut missing agent and readonly
filesystem, but it still worked.
Now on gpg 2.2.12 I am unable to use it even for the simplest operations.
In short, it seems to me very bad design decisions have been made, which
have rendered gpg basically unusable.
Has this been done intentionally? gpg is part of core infrastructure. It
should be simple and functional. Any fancy "features" should be
implemented as option, not forced.
How am I supposed to use gpg now ?
I would appreciate any feedback from this community.
Below are the errors I am getting.
# gpg --batch -d zz.gpg
gpg: failed to create temporary file
'/root/.gnupg/. Read-only file
gpg: keyblock resource '/root/.gnupg/pubring.kbx': Read-only file system
gpg: AES256 encrypted data
gpg: failed to create temporary file
'/root/.gnupg/. Read-only file
gpg: can't connect to the agent: Read-only file system
gpg: problem with the agent: No agent running
gpg: encrypted with 1 passphrase
gpg: decryption failed: No secret key

@_date: 2019-10-27 17:55:50
@_author: Fourhundred Thecat 
@_subject: gpg on read-only filesystem 
thanks, but using the "--no-auto-check-trustdb" does not help. I still
get the error:
$ gpg --verify --no-auto-check-trustdb file.sig
gpg: assuming signed data in 'file'
gpg: Signature made 2019-10-24T21:33:21 CEST
gpg:                using RSA key 88B5AAEE121345AA
gpg: Fatal: can't open '/home/testuser/.gnupg/trustdb.gpg': Operation
not permitted

@_date: 2020-07-01 06:39:06
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
We are moving in circles. Looks like you have no real arguments, and
keep repeating same stuff all over again.
I see no benefit for anybody in continuing this discussion.
But thanks to everybody who participated. It helped me to get an idea
about this community.

@_date: 2020-06-26 09:33:15
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
I have file encrypted with symmetric cipher (aes256) and not signed.
How can I decrypt it without using gpg agent ?
I get these errors:
$ gpg -d file.gpg
gpg: failed to start gpg agent
gpg: decryption failed: no secret key
as I said above, there is no secret key involved here. It is symmetric
and not signed.

@_date: 2020-06-28 21:23:56
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
I thought the agent is for manipulating the private key.
But why do I need the agent, when no secret key is involved? I simply
want to decrypt a password-encrypted file. What possible useful role
would agent play?
Seems to me that this is a terrible design, that gpg is basically
unusable without agent. Why should I need some monstrosity running as
daemon, when I just want to decrypt file?
I remember a time, when gpg was a simple, cleanly design utility that
Imagine the maintainers of ls decided, that ls will no longer work,
unless ls-daemon is running.
What happened to this project?

@_date: 2020-06-29 07:56:46
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
excuse me, gpg-agent might have been introduced in 2003, but it was
optional. Until not long ago, it was still possible to decrypt file with
password, without having the agent.
Also, I would like to add, I am not protesting the existence of the
agent. I actually use it on my desktop/gui. I am protesting the fact,
that gpg can no longer be used without the agent.

@_date: 2020-06-29 08:11:40
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
how can I use openssl, to decrypt a file that has been encrypted with
gpg (symmetrically, aes256).
Can openssl read the gpg format/header ?
Can openssl decrypt gpg file ?

@_date: 2020-06-29 18:38:03
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
I don't have gpg-agent installed, on this particular server, where I
need to decrypt one file.

@_date: 2020-06-30 06:58:14
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
There are more examples of bad design.
In fact, gpg epitomizes a perfect anti-UNIX design. (See Eric S. Raymond
for details, what UNIX philosophy means)
For instance, even for basic operations (encrypt, decrypt), where no
modifications to my key pair are necessary, gpg still requires my
~/.gnupg/ to be writable (cannot me on read-only filesystem)
That is another example of hard-requiring something, that it does not
need (same as agent for symmetric decryption)
gpg is considered a core component of linux and other systems. This is
not some solitaire gui app, that I can choose to ignore.
That is why I a m giving here my honest feedback.
I believe this project is going in the wrong direction, and bad design
decisions are being made.

@_date: 2020-06-30 11:56:15
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
I am basing my judgment on universal principles, that apply not only to
gpg or other software, but design of any systems in general.
One such principle is a having distinct modes of operation for:
1) maintenance (read/write operations)
2) general use (read-only operations)
In case of gpg, there is one mode where you generate your key pair,
change configuration files, or any other read-write operation.
But for general usage, there is no reason for the key pair to need to be
Take a car, as an analogy:
Imagine what a mess it would be, if you tried to design a car where the
engine can be replaced while you are driving. I have no experience
designing cars, but that does not prevent me from seeing this would be
bad design specification. Maintenance and usage are two different modes,
and should not be mixed.

@_date: 2020-06-30 12:47:46
@_author: Fourhundred Thecat 
@_subject: decrypt aes256 encrypted file without gpg-agent 
An idea should be considered on its own merit. You should counter my
criticism with facts, instead of attacking me personally.
I stand behind my statement, that it is a sign of bad design, when gpg
does not work on a read-only filesystem.
You can either reply with counterargument, or ignore my messages in this
