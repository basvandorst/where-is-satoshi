
@_date: 2012-02-29 07:33:43
@_author: Post Carter 
@_subject: small security glitches 
I too had seen and been perturbed by this unexplained statement on "There is a small security glitch in the OpenPGP (and therefore GnuPG) system; to avoid this you should always sign and encrypt a message instead of only encrypting it."
I use PGP for local file encryption and was concerned this applied to that as well, but I now think it seems to only apply to *messages*.  I would appreciate anyone else's analysis of that.
I believe I have found the actual information behind the "glitch," and it *absolutely* has to do with encryption/security and not just integrity/trust.
Tom McCune's summary from link above:
Chosen-Ciphertext Attack?
The report Implementation of Chosen-Ciphertext Attacks against PGP and GnuPG discusses a potential PGP vulnerability.? This is my understanding of the attack: An individual intercepts an encrypted email.? He places a plaintext addition within the package, in such a manner that when the originally intended recipient decrypts the message, the symmetric session key also "decrypts" the addition.? But since the plaintext addition was not encrypted (but probably looked encrypted), it is now encrypted to the symmetric session key.? If the originally intended recipient then sends this "gibberish" back to the original sender (to inquire about it), the interceptor again intercepts this, and now has both his original plaintext addition, and the symmetric session key encryption of that plaintext.? From this, he is able to reverse the XOR processing of the original encryption to produce the plaintext of the originally intercepted encrypted message. Although the Open PGP standard needed to be updated to prevent such an attack, this attack was unlikely to actually succeed against a PGP user ? PGP compresses before encrypting, in such a manner that this alteration would normally result in a corrupt package. If the original encrypted message was signed, this alteration will result in the intended recipient receiving a Bad signature verification. The attack would fail under any of the following conditions:
- The recipient takes no action in regards to the received ?gibberish.?
- The recipient does not include the ?gibberish? in any outgoing response.
- The recipient encrypts his outgoing response to the original sender (as long as the recipient is not fooled into encrypting the "gibberish" to the interceptor's key).
- The interceptor fails to intercept the plaintext response to the original sender. PGP Corp states that as of PGP 8.0.2 "special MDC support" includes additional protection against this kind of attack.

@_date: 2012-03-01 16:44:00
@_author: Post Carter 
@_subject: small security glitches 
If Tom McCune simplified explanation isn't detailed enough, check out?Bruce Schneier's original paper describing the attack:
The idea is that the decrypted?"gibberish" is the encrypted form of the?plaintext the attacker inserted.? If the naive user re-sends it to the original sender to ask, "Is this what you meant to?send me?" then the eavesdropping attacker?has a known ciphertext and plaintext.? (NOTE: The recipient need not send the sender the decrypted plaintext!? That would be no attack at all, just stupidity.)? From the known ciphertext and plaintext, the attacker can deduce the session key and then decrypt the original eavesdropped ciphertext.
Based on this attack, the OpenPGP standard was apperently modified, I believe to add?a message integrity component.
This attack?can also?be prevented by always signing messages, since then the tampering is detected in the signature validation.? Anyway, my motivation for posting is that there was a question on this in November 2011 and people responded that the reason you had to sign was to authenticate the message sender.? Although that is also true, it is not the point of the warning.? This attack and the "glitch" mentioned in the?FAQ are specifically an attack against the ENCRYPTION that results in potential full compromise of the message secrecy.? The defect in the?specification, per Schneier,?was the lack of any message integrity check when the message is not cryptographically signed, allowing even the most rudimentary tampering to be undetected.
The above two steps are clear so far.
i'm assuming that the intended recipient sends the "gibberish" back to
the original sender encrypted, right?? if they send it in the clear,
it's hardly the fault of the cryptosystem that the cleartext was exposed.
eh?? how does it follow that the attacker has both of these?? afaict,
the attacker has:
A) the original ciphertext
B) the modified ciphertext (which they supplied arbitrary data for)
C) a re-encrypted version of the modified cleartext (reencrypted
? ? against a different session key, presumably).
I don't understand how this follows either.? where does XOR come in?
Which part of OpenPGP is using XOR here?
At any rate, this is indeed about message integrity; if you want
encrypted integrity, you need your peer to supply an MDC (gpg does this
by default).  If you want verifiable message provenance with message
integrity, you need your peer to sign their messages.
If Alice does something like take an un-verified message, decrypt it,
and then post the plaintext somewhere anyone can look at it, then the
cryptosystem hasn't failed; but alice has stopped using the cryptosystem.
Aaron Toponce aaron.toponce at gmail.com Tue Nov 1 13:35:11 CET 2011 :
The "glitch" is exactly as described: you should always sign and encrypt a
message instead of only encrypting it. I could send you malicious encrypted
content, and masquerade as someone else behind a different email address-
maybe someone with a good reputation for security in the OpenPGP community.
Without signing the message, and only encrypting it to your public key, you
have no way to verify who really sent you the message.
Now switch sides. Suppose you're sending an encrypted mail to a collegue.
You're encrypting it for his eyes only. If you don't sign the message, he
may or may not choose to decrypt it. If you sign the encrypted mail, then
he can verify the signature, see if he trusts that key, and make a more
meaningful decision.
The "glitch" is that for security AND trust, messages must be both
encrypted and signed.

@_date: 2012-03-02 03:44:40
@_author: Post Carter 
@_subject: small security glitches 
Thanks for replying again.  Yes, I read Schneier's paper, which is why I am confident that even the original attack scenario on a vulnerable implementation
would not apply to the use case I was originally concerned about after seeing mention of a "security glitch," namely encrypted local file storage.
After your message, it would seem to me we are in agreement on the state of
the problem.  However, regarding the disputed post below, we seem to be talking
past each other somehow.
The original post and response I was referring to are here:
The respondent says: "Without signing the message, and only encrypting it to
your public key, you have no way to verify who really sent you the message."
This is true of course, but it is not the security vulnerability ("glitch") referred to
in the FAQ and that the original poster was inquiring about.  Choosing not to
use available functionality cannot be used as a basis to find a fault with that
functionality.  (If I don't brush my teeth, it can hardly be called the fault of
Crest that I get cavities.)
The originally mentioned "glitch," which we agree prompted changes in the
the OpenPGP spec to create the MDC, was not a vulnerability related to
authentication.  Indeed, it is nonsensical to say that authentication could be
compromised on an unsigned message since no authentication is even
proffered or purported to exist?in that case! Instead, the "glitch" allowed a potential (and also feasible, per Schneier,
since in practice not all crypto users are so well-versed as?to be as
"responsible" as might be hoped) mechanism for an attacker to *modify the
ciphertext message* and *manipulate the recipient* in such a way that *some
or all of the encrypted message can be decrypted* *by the attacker.* To me that is clearly an encryption vulnerability and not an authentication
vulnerability.  No?

@_date: 2012-03-02 04:55:23
@_author: Post Carter 
@_subject: small security glitches 
I know we've both read and understand the paper, so I think we just have
a terminology discrepancy here.? What is a bit confusing is using the words
encrypted vs. decrypted and ciphertext vs. cleartext when we're talking
about an attacker inserting contents into the message.
What I was trying to say was like this... 1) Let's say the original sender encryptes a message.? It then looks like
this where "C" represents some bits of encrypted ciphertext:
? CCCCC
? 2) Then, the attacker inserts some material of their own into the message,
denoted here with "P" for plaintext since it has not been subjected to
encryption.? The message now looks like this:
? CCCPPCC
3) Next, the recipient "decrypts" the message.? Since at its lowest level
the encryption amounts to XOR'ing the message text against the secret
key, it essentially results in the flipping of each class of text. "C"
becomes "P" and "P" becomes "C":
? PPPCCPP
? 4) In the attack scenario, when the recipient sends the "gibberish" to
the sender, they are sending the now "encrypted" part of the message
above denoted by "CC":? PPP -->CC<-- PP
5) The attacker intercepts and XOR's the gibberish "CC" against their original insertion "PP" from  to deduce the key.? Then they can decrypt
the original "CCCCC" contents from I'm sure this is all subject to terminology debates, and I'm most likely
not using the optimal words to describe the process, but my point was
just that the recipient actually never themselves reveals to the attacker
any of the decrypted contents of the original message that were sent by
the original sender.
