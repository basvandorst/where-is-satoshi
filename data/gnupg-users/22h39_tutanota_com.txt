
@_date: 2020-11-13 20:22:21
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
I have been for the life of me unable to get gpg working with the contactless interface in my reader.
How to reproduce:
I'm using a REINERSCT Cyberjack standard RFID dual interface class 3 reader
Simply take a Openpgp card and try to sign anything using the contactless interface.
The drivers for the reader are here:
 This is the card's list command that works on both interfaces:
Reader ...........: REINER SCT cyberJack RFID standard (9934036502) 00 00Application ID ...: D276000124010304BEEF000000000007Application type .: OpenPGPVersion ..........: 3.4Manufacturer .....: unknownSerial number ....: 00000000Name of cardholder: bac  Language prefs ...: enSalutation .......: URL of public key : [not set]Login data .......: [not set]Signature PIN ....: not forcedKey attributes ...: rsa4096 rsa4096 rsa3072Max. PIN lengths .: 127 127 127PIN retry counter : 3 0 3Signature counter : 4KDF setting ......: offSignature key ....: 0353 CB0B 67EA AADE 39A5  B54F E8D6 EC89 1A92 2CE4      created ....: 2020-11-13 18:32:45Encryption key....: 03FC FCB0 49FF E397 337B  4B3F F9BE BBC9 CCB3 DEA9      created ....: 2020-11-13 18:32:45Authentication key: 526C E0A2 9AC4 F6B3 F6D1  2B67 BADC ADFD C2AC 5D9F      created ....: 2020-11-13 18:32:45General key info..: pub  rsa4096/E8D6EC891A922CE4 2020-11-13 Test keysec>  rsa4096/E8D6EC891A922CE4  created: 2020-11-13  expires: never                                     card-no: BEEF 00000000ssb>  rsa3072/BADCADFDC2AC5D9F  created: 2020-11-13  expires: never                                     card-no: BEEF 00000000ssb>  rsa4096/F9BEBBC9CCB3DEA9  created: 2020-11-13  expires: never                                     card-no: BEEF 00000000```
This is pcsc_scan's output when I take out the card and insert it into the other slot
0: REINER SCT cyberJack RFID standard (9934036502) 00 00 Fri Nov 13 19:43:53 2020 Reader 0: REINER SCT cyberJack RFID standard (9934036502) 00 00  Event number: 2  Card state: Card removed,    Fri Nov 13 19:43:57 2020 Reader 0: REINER SCT cyberJack RFID standard (9934036502) 00 00  Event number: 3  Card state: Card inserted,   ATR: 3B 94 95 81 01 46 54 56 01 C4ATR: 3B 94 95 81 01 46 54 56 01 C4+ TS = 3B --> Direct Convention+ T0 = 94, Y(1): 1001, K: 4 (historical bytes)  TA(1) = 95 --> Fi=512, Di=16, 32 cycles/ETU    125000 bits/s at 4 MHz, fMax for Fi = 5 MHz => 156250 bits/s  TD(1) = 81 --> Y(i+1) = 1000, Protocol T = 1 -----  TD(2) = 01 --> Y(i+1) = 0000, Protocol T = 1 -----+ Historical bytes: 46 54 56 01  Category indicator byte: 46 (proprietary format)+ TCK = C4 (correct checksum)Possibly identified card (using /usr/share/pcsc/smartcard_list.txt):3B 94 95 81 01 46 54 56 01 C4	blank J3H145 card (Other)   Fri Nov 13 19:43:59 2020 Reader 0: REINER SCT cyberJack RFID standard (9934036502) 00 00  Event number: 4  Card state: Card removed,    Fri Nov 13 19:44:02 2020 Reader 0: REINER SCT cyberJack RFID standard (9934036502) 00 00  Event number: 5  Card state: Card inserted,   ATR: 3B 80 80 01 01ATR: 3B 80 80 01 01+ TS = 3B --> Direct Convention+ T0 = 80, Y(1): 1000, K: 0 (historical bytes)  TD(1) = 80 --> Y(i+1) = 1000, Protocol T = 0 -----  TD(2) = 01 --> Y(i+1) = 0000, Protocol T = 1 -----+ Historical bytes: + TCK = 01 (correct checksum)Possibly identified card (using /usr/share/pcsc/smartcard_list.txt):3B 80 80 01 01	ISO 14443 Type B without historical bytes	Electronic Passport	Spanish passport (2012)	Canadian Passport	Venez_Prox
This is an attempt to sign on both of the interfaces.
 On contact it asks for the PIN using the reader's pinentry
h39 at Auriel ~/Downloads > gpg -vvv -s testfilegpg: using character set 'utf-8'gpg: writing to 'testfile.gpg'gpg: pinentry launched (51412 gnome3 1.1.0 /dev/pts/0 xterm-256color :1)gpg: RSA/SHA512 signature from: "E8D6EC891A922CE4 Test key"
h39 at Auriel ~/Downloads> gpg -vvv -s testfilegpg: using character set 'utf-8'File 'testfile.gpg' exists. Overwrite? (y/N) ygpg: writing to 'testfile.gpg'gpg: pinentry launched (51454 gnome3 1.1.0 /dev/pts/0 xterm-256color :1)gpg: signing failed: Conditions of use not satisfiedgpg: signing failed: Conditions of use not satisfied
And finally here are pcscd's logs using --debug and first trying to sign on contacts then on contactless, the card PIN is 123456
03900506 [140366865852160] hotplug_libudev.c:655:HPEstablishUSBNotifications() USB Device add00000234 [140366865852160] hotplug_libudev.c:299:get_driver() Looking for a driver for VID: 0x0C4B, PID: 0x0500, path: /dev/bus/usb/001/01400000016 [140366865852160] hotplug_libudev.c:440:HPAddDevice() Adding USB device: REINER SCT cyberJack RFID standard00000054 [140366865852160] readerfactory.c:1074:RFInitializeReader() Attempting startup of REINER SCT cyberJack RFID standard (9934036502) 00 00 using /usr/lib/pcsc/drivers/libifd-cyberjack.bundle/Contents/Linux/libifd-cyberjack.so CYBERJACK: Started00001790 [140366865852160] readerfactory.c:950:RFBindFunctions() Loading IFD Handler 3.002092822 [140366865852160] readerfactory.c:391:RFAddReader() Using the pcscd polling thread07477005 [140366770595584] eventhandler.c:406:EHStatusHandlerThread() powerState: POWER_STATE_POWERED00000032 [140366770595584] eventhandler.c:423:EHStatusHandlerThread() Card inserted into REINER SCT cyberJack RFID standard (9934036502) 00 0000000026 [140366770595584] Card ATR: 3B 80 80 01 01 00400366 [140366770595584] eventhandler.c:482:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED02424729 [140366770595584] eventhandler.c:358:EHStatusHandlerThread() Card Removed From REINER SCT cyberJack RFID standard (9934036502) 00 0001587089 [140366770595584] eventhandler.c:406:EHStatusHandlerThread() powerState: POWER_STATE_POWERED00000022 [140366770595584] eventhandler.c:423:EHStatusHandlerThread() Card inserted into REINER SCT cyberJack RFID standard (9934036502) 00 0000000010 [140366770595584] Card ATR: 3B 94 95 81 01 46 54 56 01 C4 00400575 [140366770595584] eventhandler.c:482:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED03735577 [140366874249152] winscard_msg_srv.c:256:ProcessEventsServer() Common channel packet arrival00000031 [140366874249152] winscard_msg_srv.c:267:ProcessEventsServer() ProcessCommonChannelRequest detects: 1400000012 [140366874249152] pcscdaemon.c:133:SVCServiceRunLoop() A new context thread creation is requested: 1400000176 [140366762202880] winscard_svc.c:340:ContextThread() Authorized PC/SC client00000013 [140366762202880] winscard_svc.c:343:ContextThread() Thread is started: dwClientID=14, threadContext  [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_VERSION from client 1400000007 [140366762202880] winscard_svc.c:373:ContextThread() Client is protocol version 4:400000004 [140366762202880] winscard_svc.c:396:ContextThread() CMD_VERSION rv=0x0 for client 1400000086 [140366762202880] winscard_svc.c:361:ContextThread() Received command: ESTABLISH_CONTEXT from client 1400000114 [140366762202880] winscard.c:215:SCardEstablishContext() Establishing Context: 0xA6D81FD00000006 [140366762202880] winscard_svc.c:461:ContextThread() ESTABLISH_CONTEXT rv=0x0 for client 1400000085 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000071 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000140 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONNECT from client 1400000023 [140366762202880] winscard_svc.c:499:ContextThread() Authorized client for 'REINER SCT cyberJack RFID standard (9934036502) 00 00'00000009 [140366762202880] winscard.c:258:SCardConnect() Attempting Connect to REINER SCT cyberJack RFID standard (9934036502) 00 00 using protocol: 300000012 [140366762202880] readerfactory.c:821:RFReaderInfo() RefReader() count was: 100044154 [140366762202880] winscard.c:332:SCardConnect() power up complete.00000026 [140366762202880] Card ATR: 3B 94 95 81 01 46 54 56 01 C4 00000008 [140366762202880] winscard.c:352:SCardConnect() powerState: POWER_STATE_IN_USE00000007 [140366762202880] prothandler.c:107:PHSetProtocol() Attempting PTS to T=100011078 [140366762202880] winscard.c:430:SCardConnect() Active Protocol: T=100000023 [140366762202880] winscard.c:456:SCardConnect() hCard Identity: 5ed3ae4700000009 [140366762202880] winscard.c:518:SCardConnect() UnrefReader() count was: 200000010 [140366762202880] winscard_svc.c:513:ContextThread() CONNECT rv=0x0 for client 1400000135 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONTROL from client 1400000018 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000025 [140366762202880] winscard.c:1359:SCardControl() UnrefReader() count was: 200000005 [140366762202880] winscard_svc.c:735:ContextThread() CONTROL rv=0x0 for client 1400000102 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000108 [140366762202880] winscard_svc.c:361:ContextThread() Received command: STATUS from client 1400000012 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000004 [140366762202880] winscard.c:1300:SCardStatus() UnrefReader() count was: 200000004 [140366762202880] winscard_svc.c:632:ContextThread() STATUS rv=0x0 for client 1400000073 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000008 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000077 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000009 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000076 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000011 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000007 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000007 [140366762202880] APDU: 00 A4 00 0C 02 3F 00 00184823 [140366762202880] SW: 6A 86 00000020 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000135 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000021 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 A4 04 00 06 D2 76 00 01 24 01 00015298 [140366762202880] SW: 90 00 00000020 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000136 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000021 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 CA 00 4F 00 00016731 [140366762202880] SW: D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 90 00 00000022 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000013 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000113 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000023 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000008 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000008 [140366762202880] APDU: 00 CA 5F 52 00 00015652 [140366762202880] SW: 00 C1 C5 73 C0 01 80 05 90 00 90 00 00000019 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000011 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000147 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000025 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000010 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000010 [140366762202880] APDU: 00 CA 00 C4 00 00017123 [140366762202880] SW: 01 7F 7F 7F 03 00 03 90 00 00000019 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000114 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000021 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 CA 00 6E 00 00047584 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000022 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000009 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000115 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000014 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000004 [140366762202880] APDU: 00 CA 7F 74 00 00012896 [140366762202880] SW: 6A 88 00000018 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000097 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000021 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 5E 00 00011747 [140366762202880] SW: 90 00 00000021 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000008 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000086 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000018 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000008 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000008 [140366762202880] APDU: 00 CA 00 6E 00 00047658 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000039 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000019 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000196 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000037 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000013 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000013 [140366762202880] APDU: 00 CA 00 6E 00 00047564 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000028 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000008 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000101 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000016 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 CA 00 6E 00 00047566 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000025 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000208 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000020 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001122 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000052 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000011 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000085 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000618 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000024 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000009 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000009 [140366762202880] APDU: 00 CA 00 6E 00 00047574 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000029 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000010 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400002711 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000022 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000008 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000008 [140366762202880] APDU: 00 CA 00 7A 00 00015633 [140366762202880] SW: 93 03 00 00 05 90 00 00000021 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000178 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000023 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000009 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000008 [140366762202880] APDU: 00 CA 00 C4 00 00017131 [140366762202880] SW: 01 7F 7F 7F 03 00 03 90 00 00000021 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000097 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000015 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 65 00 00018460 [140366762202880] SW: 5B 10 74 65 73 74 3C 3C 63 61 72 64 68 6F 6C 64 65 72 5F 2D 02 65 6E 5F 35 01 30 90 00 00000021 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400054002 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONTROL from client 1400000060 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 103264154 [140366762202880] winscard.c:1359:SCardControl() UnrefReader() count was: 200000010 [140366762202880] winscard_svc.c:735:ContextThread() CONTROL rv=0x0 for client 1400000625 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000009 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000002 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000007 [140366762202880] APDU: 00 2A 9E 9A 53 30 51 30 0D 06 09 60 86 48 01 65 03 04 02 03 05 00 04 40 D7 32 A1 3D FB 5D 89 B4 50 AD E8 59 02 54 FF D0 D6 B9 EE F6 AF 53 E7 9A A9 1E 6A CC 2B D4 A0 2E EB 7F 7A 9C EA 90 2E 0D 0D B3 8D 71 C4 A9 3B BB F0 53 4A 8F 58 D4 0E 2F 5B 12 23 8C A4 55 AF 63 00 01108360 [140366762202880] SW: 0A 09 22 41 94 1A C4 5C AC 26 D2 E7 60 83 5B A1 C4 4D 0C 5A 57 FD 3D EC E8 73 30 44 89 11 09 CE A6 0C 95 A7 6C 80 EC 7C 3A 9B 5F B6 70 C5 D1 01 F4 D6 2E D1 AB 84 58 F3 48 3D D2 9A 75 C7 F2 15 D3 B6 28 43 63 0F 7B 7F 8D 4F D6 6C 5A 83 69 80 8B 0C 98 66 8A 9D 08 BE 91 98 3A 65 BF FE 64 9B 4C 23 83 C4 26 C1 F7 8E F5 9A 46 10 FE 05 05 FD 97 C1 8C A3 80 A1 97 F5 C3 82 AA 80 CA D9 DE FB DE 4A 9F 0A 87 49 6B A7 CE E6 74 3B 53 8D 0A FC C9 64 72 FC FB 01 06 97 39 1B A3 8B CE A8 43 6C DD E6 F1 B4 C3 C8 99 FC AC 89 22 CB 2C E4 58 00 4F C4 9F 19 45 35 D9 47 98 07 F1 13 6F E9 86 1E B2 42 25 D3 EE C9 01 53 89 FC BD FE B6 96 8B 07 42 BE 1E 68 84 B4 E7 39 CA CA E2 62 AF DC 0A 2B 85 D5 99 CE 44 33 6A 93 AF D4 32 10 F2 F4 DB 57 46 C4 57 76 57 9F F2 7F D6 E4 F8 03 01 64 61 22 61 FF 00000026 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000012 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000150 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000025 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000007 [140366762202880] APDU: 00 C0 00 00 FF 00032566 [140366762202880] SW: 31 52 FF 43 66 DF 62 16 2E D1 50 91 18 4F B9 99 36 90 67 CC 9F A1 85 54 11 D4 4E 1A E5 F0 2E 88 E0 D1 CB 4F 45 9E 77 5D 1A 2C 8B 91 65 2D BB DA 97 92 F1 C3 17 87 43 52 06 EE FE FC B1 8B AC 48 C8 79 19 C0 C5 E6 3F C5 31 94 76 33 63 1D 1E B1 F5 8F CE 81 BA 49 3E 60 54 16 20 5E 9C 19 6F 6E 37 5E 96 81 9C 69 A2 E7 EF 5D E6 09 5D 42 C1 29 FC B6 90 7A 9D EA 91 89 16 4F 8E 1A F4 CB 3F 3D CE 9F 6B 72 6B A4 9A E9 25 DE AC AB 01 F7 82 F7 69 B3 B7 37 E9 2C 82 11 A1 51 03 22 FF 2A 12 B4 2D 54 E8 41 A8 63 F6 52 A4 AE 78 C3 26 A2 7F 50 0F 99 F7 A5 36 BD 44 94 0B 36 5C 9D DE CD 04 63 85 22 6E 8F 9A CB 98 18 3D 39 29 EC C6 4C 0C 7E AD 69 25 1E 1B 32 94 20 5F CA EE 1A C8 35 A6 2D C7 5D 6B 8A 46 FA C5 24 21 69 90 D5 64 4C 74 79 F2 C0 4E 12 5C EF 16 3E 9D 1F 65 E7 2C AF E2 61 01 00000033 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000020 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000174 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000036 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000010 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000009 [140366762202880] APDU: 00 C0 00 00 01 00010334 [140366762202880] SW: F6 90 00 00000019 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000191 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000019 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001105 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000019 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000107 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000021 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000114 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000020 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500705 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000036 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001120 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000028 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000135 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000030 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000124 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000021 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500611 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000026 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001131 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000021 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000129 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000128 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000019 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500680 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000026 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001103 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000020 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000058 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000013 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000089 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000019 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500656 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000023 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001129 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000123 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000017 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000124 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500619 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000012 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001021 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000005 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000080 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000014 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000003 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500696 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000039 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001204 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000027 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000177 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000026 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000155 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000026 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400500638 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000027 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001121 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000026 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000062 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000017 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000145 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000029 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400044124 [140366770595584] eventhandler.c:358:EHStatusHandlerThread() Card Removed From REINER SCT cyberJack RFID standard (9934036502) 00 0000456534 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000027 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000106 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000022 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000328 [140366762202880] winscard_svc.c:361:ContextThread() Received command: DISCONNECT from client 1400000024 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000007 [140366762202880] winscard.c:881:SCardDisconnect() Active Contexts: -100000005 [140366762202880] winscard.c:882:SCardDisconnect() dwDisposition: 000000005 [140366762202880] winscard.c:1017:SCardDisconnect() powerState: POWER_STATE_GRACE_PERIOD00000011 [140366762202880] winscard.c:1043:SCardDisconnect() UnrefReader() count was: 200000010 [140366762202880] winscard_svc.c:550:ContextThread() DISCONNECT rv=0x0 for client 1400000064 [140366762202880] winscard_svc.c:361:ContextThread() Received command: RELEASE_CONTEXT from client 1400000012 [140366762202880] winscard.c:229:SCardReleaseContext() Releasing Context: 0xA6D81FD00000005 [140366762202880] winscard_svc.c:476:ContextThread() RELEASE_CONTEXT rv=0x0 for client 1400000036 [140366762202880] winscard_svc.c:354:ContextThread() Client die: 1400000025 [140366762202880] winscard_svc.c:1055:MSGCleanupClient() Thread is stopping: dwClientID=14, threadContext  [140366762202880] winscard_svc.c:1063:MSGCleanupClient() Freeing SCONTEXT  [140366770595584] eventhandler.c:494:EHStatusHandlerThread() powerState: POWER_STATE_POWERED00400571 [140366770595584] eventhandler.c:482:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED00170077 [140366770595584] eventhandler.c:406:EHStatusHandlerThread() powerState: POWER_STATE_POWERED00000017 [140366770595584] eventhandler.c:423:EHStatusHandlerThread() Card inserted into REINER SCT cyberJack RFID standard (9934036502) 00 0000000008 [140366770595584] Card ATR: 3B 80 80 01 01 00400587 [140366770595584] eventhandler.c:482:EHStatusHandlerThread() powerState: POWER_STATE_UNPOWERED01123888 [140366874249152] winscard_msg_srv.c:256:ProcessEventsServer() Common channel packet arrival00000021 [140366874249152] winscard_msg_srv.c:267:ProcessEventsServer() ProcessCommonChannelRequest detects: 1400000006 [140366874249152] pcscdaemon.c:133:SVCServiceRunLoop() A new context thread creation is requested: 1400000143 [140366762202880] winscard_svc.c:340:ContextThread() Authorized PC/SC client00000015 [140366762202880] winscard_svc.c:343:ContextThread() Thread is started: dwClientID=14, threadContext  [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_VERSION from client 1400000006 [140366762202880] winscard_svc.c:373:ContextThread() Client is protocol version 4:400000004 [140366762202880] winscard_svc.c:396:ContextThread() CMD_VERSION rv=0x0 for client 1400000038 [140366762202880] winscard_svc.c:361:ContextThread() Received command: ESTABLISH_CONTEXT from client 1400000013 [140366762202880] winscard.c:215:SCardEstablishContext() Establishing Context: 0xF640E7B00000004 [140366762202880] winscard_svc.c:461:ContextThread() ESTABLISH_CONTEXT rv=0x0 for client 1400000031 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000037 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000066 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONNECT from client 1400000011 [140366762202880] winscard_svc.c:499:ContextThread() Authorized client for 'REINER SCT cyberJack RFID standard (9934036502) 00 00'00000004 [140366762202880] winscard.c:258:SCardConnect() Attempting Connect to REINER SCT cyberJack RFID standard (9934036502) 00 00 using protocol: 300000004 [140366762202880] readerfactory.c:821:RFReaderInfo() RefReader() count was: 100170139 [140366762202880] winscard.c:332:SCardConnect() power up complete.00000016 [140366762202880] Card ATR: 3B 80 80 01 01 00000003 [140366762202880] winscard.c:352:SCardConnect() powerState: POWER_STATE_IN_USE00000007 [140366762202880] prothandler.c:107:PHSetProtocol() Attempting PTS to T=100000010 [140366762202880] winscard.c:430:SCardConnect() Active Protocol: T=100000005 [140366762202880] winscard.c:456:SCardConnect() hCard Identity: 6cc0d62600000007 [140366762202880] winscard.c:518:SCardConnect() UnrefReader() count was: 200000008 [140366762202880] winscard_svc.c:513:ContextThread() CONNECT rv=0x0 for client 1400000044 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONTROL from client 1400000008 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000173 [140366762202880] winscard.c:1359:SCardControl() UnrefReader() count was: 200000010 [140366762202880] winscard_svc.c:735:ContextThread() CONTROL rv=0x0 for client 1400000031 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_GET_READERS_STATE from client 1400000036 [140366762202880] winscard_svc.c:361:ContextThread() Received command: STATUS from client 1400000008 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000003 [140366762202880] winscard.c:1300:SCardStatus() UnrefReader() count was: 200000002 [140366762202880] winscard_svc.c:632:ContextThread() STATUS rv=0x0 for client 1400000021 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000005 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000019 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000006 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000024 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000008 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000004 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 A4 00 0C 02 3F 00 00024905 [140366762202880] SW: 6A 86 00000032 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000018 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000169 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000044 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000014 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000015 [140366762202880] APDU: 00 A4 04 00 06 D2 76 00 01 24 01 00015151 [140366762202880] SW: 90 00 00000034 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000015 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000178 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000040 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000019 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000017 [140366762202880] APDU: 00 CA 00 4F 00 00015945 [140366762202880] SW: D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 90 00 00000017 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000009 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000143 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000018 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 5F 52 00 00015242 [140366762202880] SW: 00 C1 C5 73 C0 01 80 05 90 00 90 00 00000019 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000011 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000110 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000018 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000007 [140366762202880] APDU: 00 CA 00 C4 00 00016816 [140366762202880] SW: 01 7F 7F 7F 03 00 03 90 00 00000017 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000007 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000104 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000015 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 6E 00 00032907 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000025 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000008 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000098 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000017 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000006 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 CA 7F 74 00 00013046 [140366762202880] SW: 6A 88 00000015 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000127 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000019 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 5E 00 00011872 [140366762202880] SW: 90 00 00000015 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000117 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000018 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 6E 00 00032903 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000026 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000008 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000103 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000016 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000007 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000006 [140366762202880] APDU: 00 CA 00 6E 00 00032934 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000019 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000129 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000019 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000004 [140366762202880] APDU: 00 CA 00 6E 00 00032916 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000022 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000104 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000018 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001089 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000015 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000040 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000009 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000109 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000014 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000567 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000019 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000005 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000005 [140366762202880] APDU: 00 CA 00 6E 00 00033060 [140366762202880] SW: 6E 81 D9 4F 10 D2 76 00 01 24 01 03 04 BE EF 00 00 00 00 00 07 5F 52 0A 00 C1 C5 73 C0 01 80 05 90 00 73 81 B7 C0 0A FF 03 00 20 04 80 00 FF 00 00 C1 06 01 10 00 00 11 03 C2 06 01 10 00 00 11 03 C3 06 01 0C 00 00 11 03 C4 07 01 7F 7F 7F 03 00 03 C5 3C 03 53 CB 0B 67 EA AA DE 39 A5 B5 4F E8 D6 EC 89 1A 92 2C E4 03 FC FC B0 49 FF E3 97 33 7B 4B 3F F9 BE BB C9 CC B3 DE A9 52 6C E0 A2 9A C4 F6 B3 F6 D1 2B 67 BA DC AD FD C2 AC 5D 9F C6 3C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CD 0C 5F AE D1 4D 5F AE D1 4D 5F AE D1 4D 90 00 00000024 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000006 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400466806 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000032 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001150 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000028 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000146 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000027 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400000145 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000027 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400400686 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000045 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000018 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000017 [140366762202880] APDU: 00 CA 00 7A 00 00015576 [140366762202880] SW: 93 03 00 00 06 90 00 00000030 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000019 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000217 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000038 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000014 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000015 [140366762202880] APDU: 00 CA 00 C4 00 00016894 [140366762202880] SW: 01 7F 7F 7F 03 00 03 90 00 00000027 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000015 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400000141 [140366762202880] winscard_svc.c:361:ContextThread() Received command: TRANSMIT from client 1400000021 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000012 [140366762202880] winscard.c:1595:SCardTransmit() Send Protocol: T=100000014 [140366762202880] APDU: 00 CA 00 65 00 00017052 [140366762202880] SW: 5B 10 74 65 73 74 3C 3C 63 61 72 64 68 6F 6C 64 65 72 5F 2D 02 65 6E 5F 35 01 30 90 00 00000015 [140366762202880] winscard.c:1640:SCardTransmit() UnrefReader() count was: 200000005 [140366762202880] winscard_svc.c:685:ContextThread() TRANSMIT rv=0x0 for client 1400048211 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CONTROL from client 1400000016 [140366762202880] readerfactory.c:848:RFReaderInfoById() RefReader() count was: 100000849 [140366762202880] winscard.c:1359:SCardControl() UnrefReader() count was: 200000013 [140366762202880] winscard_svc.c:735:ContextThread() CONTROL rv=0x0 for client 1400000718 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 1400000016 [140366762202880] winscard_svc.c:834:MSGSendReaderStates() Send reader states: 1400001065 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_STOP_WAITING_READER_STATE_CHANGE from client 1400000012 [140366762202880] winscard_svc.c:442:ContextThread() CMD_STOP_WAITING_READER_STATE_CHANGE rv=0x0 for client 1400000026 [140366762202880] winscard_svc.c:361:ContextThread() Received command: CMD_WAIT_READER_STATE_CHANGE from client 14```
Also there exists another issue, for example when my admin PIN is made up of characters I have no way of inputing it from the reader's pinentry and I know of no wha to switch to the on-screen pinentry
Thank You for your help,
 22h49

@_date: 2020-11-14 19:45:54
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
I don't understand, then how is OpenKeychain able to use OpenPGP cards via RFID?
I can sucessfully sign using this card via my phone but It won't work with the reader connected to the computer.
Looking at the logs, the card exchanges exactly the same apdus when using the contact and contactless interface so all points to some weird bug in gpg.
Thanks for help,

@_date: 2020-11-14 20:08:27
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
Sorry Jorgen for the mail I missclicked.
As can be seen in the logs I'm using a NXP J3H145 card with this applet:  which is compliant with OpenPGP spec V3.4.
I can assure that this card __works__ via RFID since I can easily sign files using it and OpenKeychain on my phone, the problem here is created by GPG in conjunction with the reader.
Thanks for help,
Nov 14, 2020, 19:58 by gnupg-users at gnupg.org:

@_date: 2020-11-14 21:28:58
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
The problem lies in Pinentry which for some reason can't hande ccid pin requests on the contactless interface, after this fix the interface works as expceted no problem with any feautures.
Thank you,
Nov 14, 2020, 20:39 by gnupg-users at gnupg.org:

@_date: 2020-11-14 21:32:59
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
Problem resolved! look at my last reply to Juergen to find the solution.
Thanks to everyone,

@_date: 2020-11-16 18:18:02
@_author: 22h39 
@_subject: Major problems with gpg and scdaemon, help highly appriciated 
The readers as I've shown is a REINERST Cyberjack RFID Standard, and the driver pcsc_lite.
Indeed I am running pcsc, in my first message I've even posted it's debug log.
Nov 16, 2020, 16:06 by wk at gnupg.org:
