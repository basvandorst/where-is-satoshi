
@_date: 2004-10-09 00:17:48
@_author: Sjokotof 
@_subject: invalid packet (ctb=2d) 
- production system Win32 running PGP 6.5.8, daily decrypting a series of incoming files.
- trial setup Win 32 running GnuPG 1.2.5, decrypting the same series of - Trial ran OK for months, with the exception of a few days ago, when one of the files choked GnuPG, but ran fine through GPG.
Below the output.
What can be done to get this decrypted by GnuPG?
gpg --list-packets gives:
gpg: armor header: Version: PGP 6.5.8
:marker packet:
 50 47 50
:pubkey enc packet: version 3, algo 16, keyid (ID1)
        data: [2047 bits]
        data: [2048 bits]
gpg: public key is (SECONDARYKEY)
gpg: using secondary key (SECONDARYKEY) instead of primary key
:encrypted data packet:
        length: unknown
gpg: using secondary key (SECONDARYKEY) instead of primary key
gpg: encrypted with 2048-bit ELG-E key, ID (SECONDARYKEY), created
      "(RECIP)"
gpg: CAST5 encrypted data
:compressed packet: algo=1
:onepass_sig packet: keyid (ID2)
        version 3, sigclass 00, digest 2, pubkey 17, last=1 :literal data         mode b (62), created 0, name="rh370r01.rpt",
        raw data: 0 bytes
gpg: [don't know]: invalid packet (ctb=2d)
gpg: [don't know]: invalid packet (ctb=2d)
gpg: WARNING: message was not integrity protected
gpg: [don't know]: invalid packet (ctb=2d)
gpg 1.2.5 gives:
gpg: armor header: Version: PGP 6.5.8
gpg: public key is (SECONDARYKEY)
gpg: using secondary key (SECONDARYKEY) instead of primary key
gpg: using secondary key (SECONDARYKEY) instead of primary key
gpg: encrypted with 2048-bit ELG-E key, ID (SECONDARYKEY), created
      "(RECIP)"
gpg: CAST5 encrypted data
gpg: original file name='rh370r01.rpt'
gpg: Signature made 10/01/04 08:50:29  using DSA key ID (DSAKEYID)
gpg: Good signature from "Merrill Lynch CLEAR system DH "
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the
Primary key fingerprint: (FINGERPRINT)
gpg: binary signature, digest algorithm SHA1
gpg: WARNING: message was not integrity protected
gpg: [don't know]: invalid packet (ctb=2d) ================================ pgp gives:
Pretty Good Privacy(tm) Version 6.5.8
(c) 1999 Network Associates Inc.
Uses the RSAREF(tm) Toolkit, which is copyright RSA Data Security, Inc.
Export of this software may be restricted by the U.S. government.
event 1: initial
event 13: BeginLex
event 8: Analyze
File is encrypted.  event 9: Recipients
Secret key is required to read it.
Key for user ID: (RECIP)
1024-bit DSS key, Key ID (KEY), created 2001/04/09 Key can sign.
event 6: Passphrase
event 23: Decryption
symmetric cipher used: CAST5
event 11: Output options
typecode: 0062
suggested name: rh370r01.rpt
tempfile: created 'Copy of ba.$00'
event 12: Signature
Good signature from user "(SENDER)".
Signature made 2004/10/01 06:50 GMT
event 14: EndLex
event 2: final
savetemp: renaming 'Copy of ba.$00' to 'Copy of bad 0 memory frags found
exitPGP: exitcode = 0

@_date: 2004-10-11 11:57:59
@_author: Sjokotof 
@_subject: invalid packet (ctb=2d) 
Some additional info I got by issuing [y:\progra~1\gnupg\gpg.exe --verbose --
home y:\progra~1\gnupg --list-sigs]:
pub  1024D/ 2002-01-11 sig         2002-01-11   sub  2048g/ 2002-01-11
sig         2002-01-11   pub  1024D/ 2002-01-03 sig         2002-01-03   sub  2048g/ 2002-01-03
sig         2002-01-03   pub  1024D/ 2001-04-09 sig         2001-04-09   sub  2048g/ 2001-04-09
sig         2001-04-09   pub  1024D/ 1998-07-01 sig         1998-07-01   sig   L     2001-04-09   sub  2048g/ 1998-07-01
sig         1998-07-01   Don't know if this is normal, but the last part shows a line starting  with 'sig L' (no idea what this means) which contains a repeat of .
Does this need cleaning up, and if so, how? Or is this unrelated to the original I would be grateful for any ideas here, thanks!

@_date: 2004-10-12 12:55:33
@_author: Sjokotof 
@_subject: invalid packet (ctb=2d) 
Thanks, Werner.
Any idea whether this is normal, to have a sig that seems to belong to
another key (third group in my posted listing) turning up in this one?
(I have no idea how the original PGP rings were built, just imported them
into GnuPG).

@_date: 2004-10-13 10:49:32
@_author: Sjokotof 
@_subject: invalid packet (ctb=2d) 
I use wget over FTP, which defaults to Binary mode.
The files begin with -----BEGIN PGP MESSAGE-----, end with -----END PGP MESSAGE-
Would ASCII mode be better in this case?
You're right, I used the file's copy which is not the right thing to do when troubleshooting. However, GnuPG rejects the copy, too. To make sure, I've retested, by having PGP decrypt the file that's on the GnuPG box, working  directly from the PGP box, reading the fil on the GnuPG box. Again, PGP works I was hoping I only had to use some special switch on the commandline to get GPG to work...
