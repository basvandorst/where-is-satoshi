
@_date: 2001-12-15 02:44:01
@_author: Martin Blais 
@_subject: Question: revocating a key without pollution 
My current secret key has been compromised (literally: my home computer was stolen this weekend).  I will soon regenerate another keypair.
When I publish my new public key, I would like to publish the revocation certificate for the old key as well, so that my friends not use it anymore to send me data, but I would like to avoid publishing the old public key with it. Even though it will be marked revoked, it would pollute the key rings of new friends with my old revoked key.
In other words, I want to publish a chunk that contains ONLY:
 - my new public key
 - a revocation certificate for my old public key
I can only seem to generate a chunk with the following:
 - my new public key
 - my old public key, along with the revocation certificate.
Is it doable?  How do I do it?
I have tried importing the revoked key with a blank db, and gpg DOES add that revoked key to the ring, which is exactly what I'd like to avoid.
The way I'd expect it to work would be to ignore revoked keys when importing.  When I try to import a simple revocation certificate (without the associated key), gpg correctly ignores the certificate because it doesn't have the corresponding key, which is exactly what I want:
lima:~/tmp$ gpg --import D1775F1D.revoke gpg: Warning: using insecure memory!
gpg: key D1775F1D: no public key - can't apply revocation certificate
gpg: Total number processed: 1
I mean, I could publish the simple revocation certificate itself separately and ask my friends to import that, but that seems like a pain in the bleep.  I'd rather include it in my new published key chunk.
I've been grinding in the GPG documentation for a while, and I cannot seem to find an answer to this question.  My head spins now.
Thanks for your answers.
Please Cc to blais I'm not a member of this list.

@_date: 2001-12-15 03:14:01
@_author: Martin Blais 
@_subject: deleting secret key without public key 
Hi again.
Ok, so now I think I've really messed up...
Computer was stolen, and there I am, trying all sorts of different experiments with GPG.  I copied my "options" file by accident, which specifes the alternate location for the very last copy of my secret ring, without a backup copy (I should ask someone to kick myself in the butt really hard for doing that).  Of course I forgot to change the options file... so...
While diddling, I added another secret key to my secret ring.  I deleted the experimental rings, so now I end up with the secret key I don't want in my ring, but no public key.
So I read the FAQ, where this is explicitly addressed, but I still cannot remove it.  The FAQ says:
4.6) I can't delete the secret key because my public key disappeared?  To select a key a search is always done on the public keyring, therefore it is not possible to select an secret key without having the public key. Normally it shoud never happen that the public key got lost but the secret key is still available. The reality is different, so we GnuPG implements a special way to do deal with it: Simply use the long keyid which you can figure out by using the --with-colons options (it is the fifth field in the lines beginning with "sec"). I've tried the following, to no avail, with the long id mentioned above:
lima:[blais_1]~/tmp$ gpg --delete-secret-key F6764E6A1DA3AD17
gpg (GnuPG) 1.0.6; Copyright (C) 2001 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
gpg: Warning: using insecure memory!
gpg: key 1DA3AD17: secret key without public key - skipped
gpg: F6764E6A1DA3AD17: user not found
gpg: F6764E6A1DA3AD17: delete key failed: secret key not available
and then
lima:[blais_1]~/tmp$ gpg --delete-key F6764E6A1DA3AD17
gpg (GnuPG) 1.0.6; Copyright (C) 2001 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
gpg: Warning: using insecure memory!
gpg: F6764E6A1DA3AD17: user not found
gpg: F6764E6A1DA3AD17: delete key failed: public key not found
I also tried reimporting my secret ring with the --allow-secret-key-import option, ebut I cannot seem to select which keys gt imported, so I still end up with both secret keys (one of which I don't want).
Any idea how I could get out of this mess?
Please Cc to blais

@_date: 2002-03-09 21:06:02
@_author: Martin Blais 
@_subject: missing documentation / rant 
here's a bug report / rant? for GPG 1.0.6
documentation is missing for      --check-trustdb [NAMES]      check the trust database
     --fix-trustdb                fix a corrupted trust database
these options don't know show up in the man page. someone really ought to do the grunt work of cross-checking the man page documentation with the actual options that gpg can accept.
these are not in the handbook nor in the FAQ either. the only thing i could find was stuff in the mailing-lists. in particular, i cannot help but wonder, why would my trustdb become corrupted, and how is it possible that it can be fixed (and if so, why doesn't it do that by itself?).  besides, i cannot figure out how to use check-trustdb, all i get is output like this:
tadora:~$ gpg --check-trustdb blais
gpg: given user IDs ignored in check_trustdb
gpg: 15 keys processed
gpg:    15 keys skipped
tadora:~$ also of interest:
    --allow-secret-key-import
is not mentioned on the output of "gpg --help". i'm sure there are many i know it is not fun to do, but documentation improvement for this otherwise excellent piece of software is sorely needed. encryption attracts people who will have attention for detail and will read up on how it works, will experiment with it before using it, and it would be nice if the documentation was very, very, very consistent (it is off to a very good start, but the mising stuff is frustrating).
another big one (for me and other friends): the default behaviour for "gpg file.gpg" is to decrypt to a file "file", and apart from asking for the passphrase it doesn't say it has output the PLAINTEXT to a FILE. the user that is not careful might forget or not know that is unencrypted document lies in the filesystem!  that is a big problem!  IMHO that should not be the default behaviour, the default, just as for input, should be that it outputs to stdout, just like --decrypt does, and that using --decrypt should output to a file (plus we should get a message that says so, every functionality that write unencrypted data to the filesystem should warn the user).
thanks for making gpg, i really enjoy using it otherwise.
p.s. please Cc i'm not on this list.

@_date: 2002-03-09 22:43:01
@_author: Martin Blais 
@_subject: missing documentation / rant 
there is no real problem, one of the users (me) is confused, and is making comments to the developers in order to allow them to improve the documentation of their software.
i'd like to know what they are? it would be nice if there was a clear separation between options that are shown by --help and those that aren't and that are explained in the man page and manual (perhaps dub them "extended" or "private" options?).  in any case, either the manual or documentation should reflect all options, right?
i understand that documentation is difficult to keep up-to-date by a distributed team (and the handbook is actually quite impressive), but this is indeed a 1.0 release and for such an important release documentation should be polished... i wouldn't have bothered making comments for a development release, because i understand that. my own system is that i make it a requirement to releasing, i.e. i don't allow myself to release until i've updated the docs. if i want to release something i have to bite the bullet and slave at the docs.
(and besides, sorry, but looking at the source doesn't qualify as documentation, which is what my comments are about. the beauty of oss is that i can if i want to (especially to make modifications), but that doesn't mean that all users of gpg SHOULD have to become acquainted with the source to find out what an option listed in --help is meant to do. i'm sure you'll agree with this.)
well, it IS indeed listed in "gpg --help".  i didn't mean to use it, i meant to understand what it does because it was listed, and is not documented, and that is why i was trying it. if i'm not meant to use it, then the problem is that it was listed.
that's exactly my point!  is at least the man page complete? options that are listed in --help should at least also be in the man page. the opposite is not necessarily true, and some kind of grouping to acknowledge that is a nice way to let the user understand this (something like "basic options" and "extended those maintainer-only options should then not be visible to the user if he's not to use them. all i'm arguing for, is that the maintainer/for-debug options be somehow marked as such or not visible.
agreed, read on...
i know i can use --decrypt and i do now (actually, you make me think, i'll try putting it in my options file).
well, please consider that a default behaviour of writing plaintext files out to the filesystem is behaviour that does not foster trust in a program that is meant to provide data security for its user. i mean, there is a reason for that file to be encrypted in the first place. if i considered my filesystem permissions to be secure i probably wouldn't use encryption to store files on i have often forgotten to delete unencrypted files because of that (and even sometimes on my cd backups, which were recently robbed with the rest of the computing equipment. not a cool feeling. i agree that it is my fault because i misused gpg, but food for thought anyway. IMHO plaintext should only be written to files on request. consider it a security feature, and not a minor one---the user is less likely to make the mistake of decrypting to disk.)
thanks for your quick answer.

@_date: 2002-03-09 22:57:01
@_author: Martin Blais 
@_subject: missing documentation / rant 
Hash: SHA1
good point, so i guess it cannot be changed.
perhaps an option to alter that behaviour would be cool. that option could be put in the user's options file to get that behaviour.
just my 2cents.
thx again,

@_date: 2002-03-18 04:12:02
@_author: Martin Blais 
@_subject: problem with unix user id and default key 
hi all
i have a funny problem: when my unix username matches one of the keys
in the public keyring, which is not the key for which i have a private
key, i seem to have problems with the trust path. it's as if gpg
always thinks that that key is the owner's key and barks everytime i
need to encrypt, e.g.
my username is "blais".
when i create a db with a secret key for user your_name, e.g.
then i import and sign the public key for user blais:
when i try to encrypt, i get this warning:
i tried fiddling with more signing, and setting the trust, to no
avail. then i discovered that if i did the same under user "root", i
did not have the warning.
so i tried setting the --local-user, the --default-key and fiddling
with all the other options and the options file, and i cannot seem to
get rid of that warning.
any idea?
please Cc, i'm not on this list.
