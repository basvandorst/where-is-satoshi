
@_date: 2009-04-30 14:02:59
@_author: rookie01@arcor.de 
@_subject: gpgsm data structure 
I?m not good in C and algorithms, so I have a question.
A recipient cannot decrypt my gpgsm signed and encrypted data. He sent me some data he can decrypt. It looks like this:
  121:d=5  hl=2 l=  13 cons: SEQUENCE            123:d=6  hl=2 l=   9 prim: OBJECT            :rsaEncryption
  134:d=6  hl=2 l=   0 prim: NULL                136:d=5  hl=4 l= 256 prim: OCTET STRING      [HEX DUMP]:47E37BFB771546DC3A8732EDE391E2F5241F1CA30
  396:d=3  hl=5 l=412998 cons: SEQUENCE            401:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
  412:d=4  hl=2 l=  20 cons: SEQUENCE            414:d=5  hl=2 l=   8 prim: OBJECT            :des-ede3-cbc
  424:d=5  hl=2 l=   8 prim: OCTET STRING      [HEX DUMP]:A5A8A903C2569A48
  434:d=4  hl=5 l=412960 prim: cont [ 0 ]    A3 76 AD C6 7C FF 55 2A 51 B0 EF 3F 66 32 26 F7 ........................   My gpgsm data looks like this:
  114:d=6  hl=2 l=   9 prim: OBJECT            :rsaEncryption
  125:d=5  hl=4 l= 256 prim: OCTET STRING      [HEX DUMP]:4EF9C8BAF21E4C11CD867D30D68C67DB465   385:d=3  hl=2 l=inf  cons: SEQUENCE            387:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
  398:d=4  hl=2 l=  20 cons: SEQUENCE            400:d=5  hl=2 l=   8 prim: OBJECT            :des-ede3-cbc
  410:d=5  hl=2 l=   8 prim: OCTET STRING      [HEX DUMP]:B5169BAC652FBBDC
  420:d=4  hl=2 l=inf  cons: cont [ 0 ]          422:d=5  hl=4 l=4000 prim: OCTET STRING      [HEX DUMP]:622551D24221160CFB04821BE62FD681
4426:d=5  hl=4 l=4000 prim: OCTET STRING      [HEX DUMP]:B7C8DCCF89
. The differences I see here:
1.	There is an extra NULL Object below ?OBJECT:rsaEncryption?
2.	The ?encryptedcontent? looks like one big block  ?412960? while there are 4kB blocks ?4000? in the gpgsm-Data. He also told me he can decrypt data that has 1kB blocks (haven't seen such stuff), so I checked the gnupg and libgcrypt source-packages to find out where and why. But as I said I?m not fit in C So here?s my question: Why is the gpgsm data in 4kB blocks and is there a ?easy? way to change this blocksize.
Thanks -- Siegfried
Arcor.de Gaming Area - kostenfrei daddeln bis der Arzt kommt!
Jetzt checken und aus ?ber 80 Spielen w?hlen!
