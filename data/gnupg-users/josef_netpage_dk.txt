
@_date: 2012-12-26 08:42:19
@_author: Josef Schneider 
@_subject: OpenPGP card decryption with 4096bit keys bugfix?? 
first thing: I am not subscribed to this list, so please CC me in replies.
I recently bought a OpenPGP smart card and want to use 4096bit keys and
This doesn't work for decrypting with any released gpg version!
There seems to be a patch to make it work at
Is this one line change the only thing that has to be changed to make it
Compiling gpg2 for Windows is really hard it seems. I haven't got the
Gpg4win compilation to work because it needs some packages not available
on my debian sid based machine.
I am using the Gpg4win 2.1.1 Beta installer and want to change as little
as possible. I compiled libgpg-error and libassuan and switched out the
If this one line is the only change, this should be enough?! (except if
libassuan is also statically linked somewhere)
But the problem is still the same after the switch. The only commands
getting sent to the card when starting gpg --decrypt are:
D27600012401020000050000XXXXXXXX 0
Even if I have to compile gpg2 as a whole I don't want to use the git
working copy, but the 2.0.19 source with only the patch to make
decryption with 4096bit Keys work.
So can someone tell me if this is the only change (then I probably am
doing something wrong) or if something else, and what, has to be changed.

@_date: 2013-04-14 03:22:04
@_author: Josef Schneider 
@_subject: Using smartcard as RNG 
Are you sure you actually read the mail you are replying to?
He does NOT want to use this device, his question was if it is possible to
use a smartcard (the OpenPGP card  but as far
as I know almost every smartcard has a TRNG that can be read from with the
same command) as entropy source.
This is, in fact, possible and there is a small tool that does exactly that
available at  Best regards,
Josef Schneider

@_date: 2013-08-25 15:24:29
@_author: Josef Schneider 
@_subject: Why trust gpg4win? 
I would suggest OpenBSD for that. If BSD is to exotic, then Debian Stable.
Flas is known to have more security holes than one can count, so I
would stay very far away from it!

@_date: 2013-12-01 18:01:43
@_author: Josef Schneider 
@_subject: Any future for the Crypto Stick? 
Einar Ryeng schrieb:
I just use a OpenPGP Card in a small gemalto stick reader. AFAIK in the
Crypto stick they just soldered a OpenPGP card in, so it is basically
the same!

@_date: 2013-02-08 03:12:47
@_author: Josef Schneider 
@_subject: More secure than smartcard or cryptostick against remote attacks? 
Of course you can trust a hardware created for the sole purpose of
signing clear text after displaying it more than a general purpose PC
that has a lot of software that has absolutely nothing to do with
security on it and regularly connects to a very insecure network (the
You argue that there is only one level of trust for all hardware
someone owns and either you trust all of it or none, and that is just
not true!
Why do you think do Banks use Smart Card readers with own
display/keyboard and serial connection or TAN-generators using flicker
They do this because on the average PC there is a lot of software, a
lot of it closed source which the bank can not control and neither can
the owner.
I can write some "virus" a user has to install himself (and we all
know a lot will!) which sends signed mails to someone using GnuPG
installed on the PC, even if using a smart card, in probably less than
a day!
Writing a modified firmware that shows wrong amounts/account ids for
my Class 3 card reader and finding a way to install it (updates are
cryptographically checked) is much much harder. I have no idea how
long that would take or if I would ever succeed.
I assume for TAN generators which get the transaction data using
flicker codes it will be even harder!
So even if I get someone to install my malware on his PC, his online
banking will stay relatively safe.
I have a smart card that has digital certificates on it which can be
used to sign documents legally binding in my country. I use that card
with a reader with own pin pad. Of course someone can highjack my PC
and fake the data I want to sign. There are just a few problems:
? He can only sign something whenever I want to sign something, else I
won't input my PIN
? I expect something to have a valid signature after that, so either
he hopes I don't check this signature, or he fakes all the ways I can
check that, which is very hard.
With GnuPG on the other hand someone who has access to my PC can sign
whatever he likes and sign as much as he likes, as long as my card
reader is attached (which is, to be honest, quite long some times). If
I wouldn't have a smart card he could even copy my key and then sign
and decrypt whatever he likes, where- and whenever he likes!
So given the fact that I maybe sign an average of three documents a
day, in case one an attacker could sign up to three documents a day,
but I would notice that very quickly because someone of the recipients
would call me telling me the signature is invalid or I sent him some
things he didn't expect (except if the attacker waits for exactly THE
one document he wants to forge, has the right programming logic to
detect and change it accordingly, etc..). With GnuPG in its current
state he could sign millions of documents without me even noticing.
I see a difference there!
There is a risk to die when bungee jumping. There is a risk to die
when jumping naked from a bridge without bungee rope. This doesn't
mean I tell every bungee jumper to jump naked from bridges, because he
could die with bungee rope too! I I don't do this because the odds to
die are very different!

@_date: 2013-02-27 12:03:22
@_author: Josef Schneider 
@_subject: key length for smart card key generation 
with the current version of GPG 2 you can import 4096bit keys to a
OpenPGP smartcard version 2.0.
There is a bug in GPG2 that prevents it from decrypting data with a
key longer than 3072bit on a OpenPGP smartcard. This should be fixed
in the GIT repository.
AFAIK a version 1 card doesn't support keys longer than 1024bit! "gpg
--card-status" should tell you which version you have.
Best regards,
Josef Schneider
On Tue, Feb 26, 2013 at 7:04 PM, Anonymous Remailer (austria)

@_date: 2013-01-07 21:49:05
@_author: Josef Schneider 
@_subject: Paperkey 1.3 
Still you can't be sure that the controller or flash cells won't just
stop working.
Yesterday, a new MicroSD card of mine just stopped working.
At first one folder was unreadable and fsck didn't work, then after
unplugging and re-plugging it all file names where gibberish, the card
got hot and I unplugged it.
Since then it's detected as unformated and no write access is possible.
This is the second MicroSD card where this happens for me. While
yesterday this was after less than a day, the other one broke after
about a month of heavy usage in my smart phone.
And while with a CD or DVD you probably still can read parts of the
data (especially if you have e.g. PAR2 files to recover it) if a flash
storage of any kind stops working, realistically you can't do anything
to rescue even parts of the data.
And while most hard disks that broke showed some signs of that (via
SMART or increased sound level) all flash memory devices more or less
stopped working from one moment to the other. (but then, I don't have
very much data)
So I wouldn't trust any flash memory for long time storage.

@_date: 2013-07-15 19:51:20
@_author: Josef Schneider 
@_subject: Aw: Re: GpgEX for 64 bit Windows test version 
I have the same problem on my german 64bit Windows 8 with Version 2.2.0-beta31
Mit freundlichen Gr??en,
Josef Schneider

@_date: 2013-07-16 10:28:38
@_author: Josef Schneider 
@_subject: Aw: Re: GpgEX for 64 bit Windows test version 
Yes I am sure. I even uninstalled it completely right now, rebooted
and then reinstalled!
I have attached a screenshod (if it works).
Strangely, the gibberish now changed somehow (it is shorter now), but
it is still there.
Best wishes,

@_date: 2013-06-24 16:01:33
@_author: Josef Schneider 
@_subject: How do I make the private key on a OpenPGP smartcard non 
Not any less secure than a Smartcard that allows key export!
Then you need a secure way to store the CA key. That is essentially
exactly the same problem!
I mean you can put it on a card and allow export of the CA key only if
the request is signed by a SuperSecureCA key...
But how do you control the export of the SuperSecureCA key?
If you want a key backup, why not just create the key on a secure
offline machine, copy it to a secure location (I print mine out using
PaperBak) and then move it to the card on that secure offline machine?
Works great!
Best regards,

@_date: 2013-06-24 16:09:39
@_author: Josef Schneider 
@_subject: [Gpg4win-devel] GpgEX for 64 bit Windows test version 
Hi, I tried all of the possible functions work.
The only problem I found is, that help asks for Admin rights. And if
the rights are granted, it starts Internet Explorer, not the default
All of this on Windows 8 Pro 64bit German
Best regards,

@_date: 2013-06-25 09:38:18
@_author: Josef Schneider 
@_subject: [Gpg4win-devel] GpgEX for 64 bit Windows test version 
Usually just with ShellExecute and Windows figures out the details!
Best regards,
Josef Schneider

@_date: 2013-06-25 10:40:31
@_author: Josef Schneider 
@_subject: GpgEX for 64 bit Windows test version 
But if you do this, the extension won't be available in 32bit
processes! (32bit explorer.exe, file selection dialogues in 32bit
programs, 32bit file managers...)
Best regards,
Josef Schneider

@_date: 2013-03-01 02:08:28
@_author: Josef Schneider 
@_subject: key length for smart card key generation 
Using an 4096 bit RSA key _should_ work if you compile the current
source from the git repository and then _should_ work with 2.0.20 once
that is out!
I didn't have the time to test that yet because I use Windows and
compiling GnuPG 2 for Windows seems to be quite a difficult task!

@_date: 2013-03-04 05:37:28
@_author: Josef Schneider 
@_subject: "gpg: Signature made <date time>" tamper resistant? 
On Mon, Mar 4, 2013 at 4:59 AM, Daniel Kahn Gillmor
Not related to GPG, you might also be interested in
 which is AFAIK the only free
"trustworthy" (meaning it is run by a organisation, not a test server
and has some sort of usage terms) RFC 3161 timestamp server.
I use it with PDF signatures (using a certificate issued to me by the
government  because it is a lot easier to
show average people how Acrobat Reader says everything is OK than
explaining GPG.

@_date: 2013-09-01 13:12:20
@_author: Josef Schneider 
@_subject: Recommended key size for life long key 
I just use 4096 bit because that is the biggest size my OpenPGP Cards can
handle.  In my opinion using a smart card instead of online keys increase
security far more than strange large key sizes!
I also see no point using less than 4096 because modern hardware is fast
enough. Maybe my keys last longer that way.
Am 01.09.2013 02:43 schrieb "Robert J. Hansen" :

@_date: 2013-09-10 17:10:15
@_author: Josef Schneider 
@_subject: The symmetric ciphers 
Why? Assuming the Keys are not related (e.g. by creating random keys and
then encrypting them both with RSA) this is safer, assuming the attacker
can crack one of the two symmetric ciphers but not RSA.
If you use the same/related Keys for both encryptions and/or the ciphers
don't interact somehow (like when using ROT-13 two times) it is indeed less

@_date: 2013-09-18 10:33:21
@_author: Josef Schneider 
@_subject: Where is ECC in gpg2 (specifically gnupg-2.0.21 
Is there a way to say someone should under no circumstances send a
message to me that is encrypted with a NIST curve?
Even if that means, that he can't find a encryption for the message?

@_date: 2013-09-19 20:59:50
@_author: Josef Schneider 
@_subject: Where is ECC in gpg2 (specifically gnupg-2.0.21 
Yes, but it isn't only HIS stuff!
I want to know if the information I send out is secure enough or not.
If, for example, my doctor asks me to send him all my medical
information on a postcard, I won't do it!
So why shouldn't I decide myself what I consider secure enough to send
him that information on the Internet?
Best regards,

@_date: 2013-09-23 08:35:16
@_author: Josef Schneider 
@_subject: Question about a perfect private Key store for today's environment 
The cheapest phones you can get here have at least 800Mhz ARMv6 CPUs!
My current one has a Quad-Core 4x1,5Ghz ARMv7.
I don't think that will be any problem!
On slow phones maybe you have to wait a few seconds, but you probably
won't send that many mails on your phone that it matters.
Best regards,

@_date: 2014-05-09 10:34:54
@_author: Josef Schneider 
@_subject: a bit OT: pgpdump binaries? 
something strange happened in my mail client so the signature of the
last message was invalid!
Here is the same message correctly signed:
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
compilation is straightforward, if msys and mingw is installed!
pgpdump.c is missing a " ", after adding that
just  a
./configure and make to compile it!
I compiled a 64 and a 32 bit version for you! The files are
signed using the Microsoft Authenticode stuff.
The SHA-512 hashes of the files are:
You can get them here:  The files are statically linked to winpthreads, so make sure to
read the
included license.
Best regards,

@_date: 2014-05-09 10:31:21
@_author: Josef Schneider 
@_subject: a bit OT: pgpdump binaries? 
Hash: SHA1
compilation is straightforward, if msys and mingw is installed!
pgpdump.c is missing a " ", after adding that just  a
./configure and make to compile it!
I compiled a 64 and a 32 bit version for you! The files are digitally
signed using the Microsoft Authenticode stuff.
The SHA-512 hashes of the files are:
You can get them here:  The files are statically linked to winpthreads, so make sure to read the
included license.
Best regards,

@_date: 2014-11-24 16:22:47
@_author: Josef Schneider 
@_subject: Beta for 2.1.1 available 
Hash: SHA512
I cannot get it to work with my OpenPGP card.
The card works fine with GPG 2.0
If I try anything needing a secret key, it just outputs "No
secret key"
D:\>gpg --detach-sign barstick.rar
gpg: NOTE: THIS IS A DEVELOPMENT VERSION!
gpg: It is only intended for test purposes and should NOT be
gpg: used in a production environment or with production keys!
gpg: signing failed: No secret key
gpg: signing failed: No secret key
The card status looks correct:
D:\>gpg --card-status
gpg: NOTE: THIS IS A DEVELOPMENT VERSION!
gpg: It is only intended for test purposes and should NOT be
gpg: used in a production environment or with production keys!
Application ID ...: D2760001240102000005000010650000
Version ..........: 2.0
Manufacturer .....: ZeitControl
Serial number ....: 00001065
Name of cardholder: Schneider Josef
Language prefs ...: de
Sex ..............: male
URL of public key : Login data .......: -
Signature PIN ....: forced
Key attributes ...: 4096R 4096R 4096R
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 893
Signature key ....: CA77 342B 856C 9D5B B0B6  C23C 3140 E873
9BE4 5ED0
      c
reated ....: 2012-12-10 00:01:57
Encryption key....: DE61 0EF1 5124 2A64 400B  9968 4CBB 978B
B641 DD11
      created ....: 2012-12-10 00:01:57
Authentication key: 3E9E 5480 F676 B9D6 6632  49A2 E1D8 2ECC
CA02 F8EA
      created ....: 2012-12-10 00:03:06
General key info..: pub  rsa4096/9BE45ED0 2012-12-10 Josef
Schneider sec#  rsa4096/9BE45ED0  created: 2012-12-10  expires: 2017-04-13
ssb#  rsa4096/B641DD11  created: 2012-12-10  expires: never
ssb   rsa4096/CA02F8EA  created: 2012-12-10  expires: never
I also tried deleting the key and adding it again with gpg --
card-edit, fetch
The only thing that even asks for a pin is gpg --card-edit,
But it seems like this also doesn't work right.
It asks me for my PIN and then shows the same info as --card-
But it shows the same info, no matter what PIN I enter and the
PIN retry counter  is not decremented on a wrong PIN
If I enter a wrong PIN, another verify asks for the PIN again.
With a right PIN, it doesn't ask!
I am confused.
Best regards,

@_date: 2015-07-27 21:09:19
@_author: Josef Schneider 
@_subject: One Key, multiple Smartcards not working anymore 
I have a problem with my Key. I have a 4096bit RSA key since 2012 and it
is stored on a OpenPGP smartcard.
Recently I added three new 2048bit subkeys, because I bought a Yubikey
NEO device and want to use PGP on my phone/tablet with Android and NFC.
This worked as expected. I created the new subkeys on my PC, saved a
backup and then moved them to the card.
PGP showed me correctly that the first three keys are on card 1 and the
second three are on card 2. If the wrong card was inserted, it asked me
to insert the correct one.
I then wanted to create one key backup with all six private keys to
print using PaperBack and store in a safe place. I was able to merge all
the private keys with gpgsplit and moving/renaming files and created
that backup.
After that, I deleted the whole key, got my public key from the
keyservers and tried to use it with the card (after gpg2 --card-status).
Here is now my problem:
GPG adds the key stub for the smartcard keys only for the first card! If
I delete the key, import, use card-status, then I can usse the three
keys from that smartcard. If I insert the second smartcard and do a
card-status, nothing changes!
If I import the full key with all private keys, I can then replace the
keys on the card and move all keys to smartcards. Then I get a key
working with both smartcards again. But of course I don't want to touch
the key backup. It's printed on paper and stored in a safe location for
a reason.
Am I doing something wrong, or is that a bug?
Here are some gpg outputs:
At the moment, I have it here on my notebook working with the 4096bit keys:
sec>  4096R/9BE45ED0 2012-12-10 [verf?llt: 2017-04-13]
      Kartenseriennr. = 0005 XXXXXXXX
uid                  Josef Schneider uid                  Josef Schneider ssb>  4096R/B641DD11 2012-12-10
ssb>  4096R/CA02F8EA 2012-12-10
ssb#  2048R/988E7DDD 2015-07-07
ssb#  2048R/03E021FE 2015-07-07
ssb#  2048R/8B406748 2015-07-07
I insert the other card and do a card-status:
C:\Users\Josef Schneider>gpg --card-status
Application ID ...: DXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Version ..........: 2.0
Manufacturer .....: Yubico
Serial number ....: XXXXXXXX
Name of cardholder: Josef Schneider
Language prefs ...: de
Sex ..............: m?nnlich
URL of public key : Login data .......: [nicht gesetzt]
Signature PIN ....: zwingend
Key attributes ...: 2048R 2048R 2048R
Max. PIN lengths .: 127 127 127
PIN retry counter : 3 3 3
Signature counter : 39
Signature key ....: 50FD 3663 AB67 A8FD 64BD  C208 1272 58BE 988E 7DDD
      created ....: 2015-07-07 11:34:08
Encryption key....: 88FA 7314 795F 5F19 F258  3B70 E18B C1D9 03E0 21FE
      created ....: 2015-07-07 11:38:08
Authentication key: E0E5 13F9 AA97 8C8E 1BF5  27FB B6BF D0F7 8B40 6748
      created ....: 2015-07-07 20:15:08
General key info..: pub  2048R/988E7DDD 2015-07-07 Josef Schneider
sec>  4096R/9BE45ED0  erzeugt: 2012-12-10  verf?llt: 2017-04-13
                      Kartennummer:0005 XXXXXXXX
ssb>  4096R/B641DD11  erzeugt: 2012-12-10  verf?llt: niemals
                      Kartennummer:0005 XXXXXXXX
ssb>  4096R/CA02F8EA  erzeugt: 2012-12-10  verf?llt: niemals
                      Kartennummer:0005 XXXXXXXX
ssb#  2048R/988E7DDD  erzeugt: 2015-07-07  verf?llt: 2017-07-06
ssb#  2048R/03E021FE  erzeugt: 2015-07-07  verf?llt: 2017-07-06
ssb#  2048R/8B406748  erzeugt: 2015-07-07  verf?llt: 2017-10-24
I can't use this key.
After deleting it and import  :
C:\Users\Josef Schneider>gpg --card-status
Application ID ...: DXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Version ..........: 2.0
Manufacturer .....: Yubico
Serial number ....: XXXXXXXX
Name of cardholder: Josef Schneider
Language prefs ...: de
Sex ..............: m?nnlich
URL of public key : Login data .......: [nicht gesetzt]
Signature PIN ....: zwingend
Key attributes ...: 2048R 2048R 2048R
Max. PIN lengths .: 127 127 127
PIN retry counter : 3 3 3
Signature counter : 40
Signature key ....: 50FD 3663 AB67 A8FD 64BD  C208 1272 58BE 988E 7DDD
      created ....: 2015-07-07 11:34:08
Encryption key....: 88FA 7314 795F 5F19 F258  3B70 E18B C1D9 03E0 21FE
      created ....: 2015-07-07 11:38:08
Authentication key: E0E5 13F9 AA97 8C8E 1BF5  27FB B6BF D0F7 8B40 6748
      created ....: 2015-07-07 20:15:08
General key info..: pub  2048R/988E7DDD 2015-07-07 Josef Schneider
sec#  4096R/9BE45ED0  erzeugt: 2012-12-10  verf?llt: 2017-04-13
ssb#  4096R/B641DD11  erzeugt: 2012-12-10  verf?llt: niemals
ssb#  4096R/CA02F8EA  erzeugt: 2012-12-10  verf?llt: niemals
ssb>  2048R/988E7DDD  erzeugt: 2015-07-07  verf?llt: 2017-07-06
                      Kartennummer:0006 XXXXXXXX
ssb>  2048R/03E021FE  erzeugt: 2015-07-07  verf?llt: 2017-07-06
                      Kartennummer:0006 XXXXXXXX
ssb>  2048R/8B406748  erzeugt: 2015-07-07  verf?llt: 2017-10-24
                      Kartennummer:0006 XXXXXXXX
I can use the 2048bit keys, but not the 4096
After inserting the first card again:
C:\Users\Josef Schneider>gpg --card-status
Application ID ...: DXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Version ..........: 2.0
Manufacturer .....: ZeitControl
Serial number ....: XXXXXXXX
Name of cardholder: Schneider Josef
Language prefs ...: de
Sex ..............: m?nnlich
URL of public key : Login data .......: -
Signature PIN ....: zwingend
Key attributes ...: 4096R 4096R 4096R
Max. PIN lengths .: 32 32 32
PIN retry counter : 3 0 3
Signature counter : 250
Signature key ....: CA77 342B 856C 9D5B B0B6  C23C 3140 E873 9BE4 5ED0
      created ....: 2012-12-10 00:01:57
Encryption key....: DE61 0EF1 5124 2A64 400B  9968 4CBB 978B B641 DD11
      created ....: 2012-12-10 00:01:57
Authentication key: 3E9E 5480 F676 B9D6 6632  49A2 E1D8 2ECC CA02 F8EA
      created ....: 2012-12-10 00:03:06
General key info..: pub  4096R/9BE45ED0 2012-12-10 Josef Schneider
sec#  4096R/9BE45ED0  erzeugt: 2012-12-10  verf?llt: 2017-04-13
ssb#  4096R/B641DD11  erzeugt: 2012-12-10  verf?llt: niemals
ssb#  4096R/CA02F8EA  erzeugt: 2012-12-10  verf?llt: niemals
ssb>  2048R/988E7DDD  erzeugt: 2015-07-07  verf?llt: 2017-07-06
                      Kartennummer:0006 XXXXXXXX
ssb>  2048R/03E021FE  erzeugt: 2015-07-07  verf?llt: 2017-07-06
                      Kartennummer:0006 XXXXXXXX
ssb>  2048R/8B406748  erzeugt: 2015-07-07  verf?llt: 2017-10-24
                      Kartennummer:0006 XXXXXXXX
Still can't use the 4096bit keys. If I want to use the 2048bit keys, GPG
asks me correctly to inert the other card and then it works.
All with gpg (GnuPG) 2.0.28 (Gpg4win 2.2.5)
I hope someone can help me figure that out.
Best regards,

@_date: 2015-07-30 14:45:29
@_author: Josef Schneider 
@_subject: One Key, multiple Smartcards not working anymore 
Thank you for the fast reply and the solution.
I can confirm, that this works. Also I switched to GPG 2.1 on my
notebook (also Windows) and the bug doesn't exist in that version.
Best regards,
