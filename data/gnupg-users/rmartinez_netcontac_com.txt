
@_date: 2012-12-20 13:32:50
@_author: Roberto 
@_subject: Unable to run GPG from PHP gpg: WARNING: unsafe ownership on homedir 
I made and script in PHP to encrypt information with GPG. It works fine  until I move it from a Plesk server to a cPanel server. I adjusted paths,  permissions and users but I get this errors:
gpg: keyblock resource `/home/USER/.gnupg/pubring.gpg': General error
gpg: failed to create temporary file  `/home/USER/.gnupg/. Permission denied
gpg: keyblock resource `/home/USER/.gnupg/secring.gpg': General error
gpg: failed to create temporary file  `/home/USER/.gnupg/. Permission denied
gpg: WARNING: unsafe ownership on homedir `/home/USER/.gnupg'
USER is the same user in Plesk (Where it works) than in cPanel.
HOST is the name of the host server.
Here is the PHP script:
$message = "Message";
$gnupg = "/usr/bin/gpg";
$gnupghome = "/home/USER/.gnupg";
$uid = "UID";
$command = "echo ". $message ." | ". $gnupg ." -a -t --batch  --no-secmem-warning --homedir ". $gnupghome ." -e -r ". $uid ."  --compress-algo 1 --cipher-algo cast5";
$messageCodified = shell_exec($command);
I am missing something obvious, but I can not tell. I tried a lot of  configurations without success.
Please help.
Kind Regards,

@_date: 2012-12-20 15:56:51
@_author: Roberto Martinez 
@_subject: Unable to run GPG from PHP gpg: WARNING: unsafe ownership on 
However, certainly I am missing something. If you suggest a check list, it  would make me very happie.
   often, on shared servers, the web server runs as www-data or
You are right, I simplify the command for testing purposes, but again, any  security advice is welcome.
