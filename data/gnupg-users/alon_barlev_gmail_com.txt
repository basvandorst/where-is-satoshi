
@_date: 2005-08-16 14:40:28
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
I know it is an old issue... But I think it is very important issue,
so I want to raise it again.
PKCS is a standard specifying how to access cryptographic token.
Must smartcard vendors provide PKCS library that allow simple smartcard integration with applications.
PKCS implementation is not platform specific and is implemented for Windows, Linux etc...
I couldn't see any plans to support this standard, and could find some answers that suggest it will not be supported.
Mozilla, Firefox, Thunderbird and now Java support PKCS standard in order to access cryptographic tokens, gives these software an edge in smartcard integration.
openssl have a gateway through open-sc to PKCS tokens, but it is very
basic gateway that can only use private key objects on the token.
When I saw that in the new version gpg has gpg-agent I was very glad! I thought that finally a standard implementation to access cryptographic tokens will be implemented.
But then I've seen that only proprietary smartcard tokens are supported (directly) and ssh-agent... No standard way to access external cryptographic devices.
I will be glad to discuses the need of implementing PKCS support for gpg-agent, and helping in the implementation process...
I think it is very important to have such support for any software that deals with cryptographic and secrets. gnupg falls into this category...
Best Regards,
Alon Bar-Lev

@_date: 2005-08-20 17:05:05
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
Thank you for your reply!
I don't see any conflict between GPL and using PKCS standard.
The disclaimer at  states
that you only need to specify the following in documentation: "RSA
Security Inc. PKCS  Cryptographic Token Interface (Cryptoki)"
Even if you would have written PKCS implementation "RSA Laboratories
also makes no representations regarding intellectual property
coverage or ownership of the reference implementations."
RSA Laboratories does not provide precompiled libs... PKCS
is 3-4 include files and a PDF... (NO SOURCES)
gpg already uses S/MIME standard that is based on PKCS
standard... and this is based on PKCS etc... etc..
Can you please tell me where the conflict is?
Since if there is none, I don't see any reason why every project
should implement its own standard of smartcard structure.
If there will be (In the future) GPLed smartcard, it should also
support PKCS standard... So standard application will work...
I am glad... But I still think it should be supported in the core
agent... As primary
cryptographic device access.
But your card specification which is entirely open is  specific to gpg...
I am calling this proprietary... You cannot use keys and certificates
that were enrolled for other application. This makes the use of gpg
and smartcard very difficult to manage.
I think gpg like other cryptographic software should allow the use
of pre-existing objects on the smartcard. As far as I know PKCS
is the most common, implemented, cross-platform, application API
specification exists.
And no... I don't say PKCS since it too has the same limitations
as your implementation... It forces a format for the whole smartcard,
PKCS is an API allowing the vendor to manage the smartcard format
independently of the software implementation.
Yes, I figured this out...
But... I don't think that maintaining a separate branch for
it is a good idea...
Most of the code will be the same as gpg-agent... So it will
be very difficult to synchronize the two.
Had gpg-agent been extended so that modules
can be plugged into it, it would have been a good idea.
Had such extension been implemented... I suggest it would
have been implemented using PKCS :-) So that you can
use software token to store the keys, PKCS bridge,
Smartcard access, etc...
Can you please reconsider the PKCS support, without
a new agent branch?
Best Regards,
Alon Bar-Lev.

@_date: 2005-08-31 08:45:42
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
I still don't get it...
between Mozilla and GPL applications. together - that is the whole reason
I still don't understand where is the licensing problem of using PKCS in
a GPLed application.
You FAILED to answer this issue, and this is the key issue why you invent
your own card structure!!!
This makes gpg UNUSABLE with smartcards, and I regret this fact.
Opensc uses PKCS and is release under LGPL 2.1, although it LGPL I don't
see any reason
why the "L" is PKCS depended
Again, you are using a lot of PKCS standards in your application, and I
don't understand why
you have a problem only with PKCS
I am only trying to help!
I don't think you understand how people use smartcards...
The situation where you have a dedicated smartcard for every application is
Every application that is written is such approach will be replaced, and I
regret to see gpg be replaced.
When user buys it's email signature/encryption certificate he expects to be
able to use it in
all smartcard enable applications... PKCS provides this ability, and is
free to use, and most commonly
Yes, I know that I can write my own agent... But I still think it will be a
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-01 13:09:42
@_author: Alon Bar-Lev 
@_subject: OpenPGG Card 
I am sorry to intrude...
But I had a discussion with Werner Koch about a similar issue.
I think that gpg should support PKCS interface for smartcards, so that it
can be used with all smartcards that support this standard.
PKCS is the most used and most implemented standard.
I don't understand why gpg developers choose to implement their own standard... The most reasonable claim I've got was the licensing issue... But nobody
succeeded in proving that there is a licensing problem.
You can look for messages with "PKCS support for gpg-agent" subject for future
information at gnupg-users.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 13:40:27
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
But it does not say that GPLed software cannot use PKCS interface in order to access none GPLed tokens!
Yes... despite this fact...
I am sorry to read that... I think it is a good standard... Just like any RSA Security
PKCS standard... at least it is a standard that most programmers agree I don't understand why you guys did not rewritten the PKCS PKCS PKCS PKCS
standards... And maybe to stay with PGP standard and not migrating to The whole new work of gpg 1.9 was to migrate to S/MIME... Why!?!?!?!
You could have been very happy in your close PGP format world.
Even if the standards are ugly, they at least work!
I am afraid you are totally wrong here... I hope you will wake up I am responsible of replacing software/suggest correct software for using smartcards.
Currently gpg is on my black list... And because of this I tried to talk with  you first to make
you understand what you do wrong...
It seems that I've failed!
You don't understand or don't want to understand what the user expects, so you fail to
provide it.
This is the WRONG WRONG WRONG approach!!!!!!!
I won't bother you any more,
Alon Bar-Lev.

@_date: 2005-09-02 14:23:39
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Finally someone who understand... I had no such luck with Werner Koch, who
argues that OpenPGP card is standard...
I've promised him to not bother any more with this issue...
Yes... I don't think there is a problem with licensing... All problems are in result of
an approach that each application may define how its smartcard should be This approach like any other proprietary approach will disappear along with its software,
as it was with other software that did not support generic devices like printers, modems etc...
I don't think it is wise... There are some suitable cards that provide PKCS in Linux,
forcing your card to use gpg will not allow you to use it with your browser or with your
standard mail client.
Just a thought... why do you use gpg? which feature you require?
Maybe there are some alternatives without using proprietary hardware.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 15:46:08
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
So why don't you use standard mail client such as mozilla It support S/MIME and PKCS so that you can encrypt/sign messages and using smartcard!!!
You don't have to use gpg for this.
But you need to focus... What level? Programmer? Administrator?
1. Most popular for linux starting point is 2. Be sure your smartcard support PKCS interface 3. Be sure your smartcard support pcsc-lite 4. Be sure your USB reader supports CCID driver 5. There is PAM PKCS at 6. If you need one smartcard to be used on Windows machine and Linux machine - talk to me...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 16:31:00
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
Yes... But why? What was the reason to work so hard in adding The answer for my opinion is that IT IS A STANDARD!!!
Likewise PKCS is a standard to access cryptographic tokens.
When PGP was invented there WAS NO standard to send and receive signed and encrypted messages, so PGP have implemented a proprietary method.
Then, PGP tried to propose it as a standard... OpenPGP... But they have failed... It was not widely adopted...
S/MIME was the standard adopted by the world, and PGP and gpg had to catch up.
I thing one should learn from history and not invent any new standard, especially when such already exists, implemented and No... the purpose of gpg-agent is to allow gpg to access private (secret) keys that are located in different physical location such as smartcards...
 From my point of view this is THE MAJOR feature of gpg-agent...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 16:55:58
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
I will be glad if you will...
It seems that I am the only one that don't understand gpg This is EXACTLY the problem.
If you have a RSA private key and X.509v3 certificate that refers to the public key, you expect this key to be shared among all applications that you use.
If you had to write an separate applet and provider for each application you make the cost of smartcard integration EXTREMELY high!
On the other hand, if you implement a software API for accessing a generic smartcard, then you don't need to implement any special software in order to use smartcard type A or smartcard type B.
This is all PKCS is about (Or Microsoft CSP in Windows environment...) It provides a generic API to access cryptographic tokens. Most smartcard vendors, including IBM, provide PKCS library that communicates with their card.
PKCS application can benefit from it as well as the user... No proprietary code should be written in order to make your software work with your hardware.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 17:52:51
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
I won't argue with that...
But the trend is not in favor of PGP.
You are wrong!
You can use self-signed certificates in a trust model similar to PGP.
True... I know... But S/MIME standard is the one which is implemented in every mail client program... not PGP...
You don't understand what PKCS is!!!!
Maybe that is the reason for all of these arguments...
PKCS is an API needed to access cryptographic token. PKCS is NOT OCSP or PKI or X.509. It just specify how application should access a cryptographic token that can perform hashing, symmetric and asymmetric key operation, key handling etc...
A typical application need to use PKCS __ONLY__ for the following purposes:
1. Perform operation with private key located on token.
2. Fetch X.509v3 Digital Certificates from the token (User I am sorry, but I don't agree.
I don't find any advantage to keep OpenPGP formats. There is PKCS for signed/enveloped data and S/MIME that uses PKCS for email.
Using self-signed certificates and PKCS and S/MIME you get a full replacement for PGP... It will take several years, but eventually it will happen.
Even pgp corp ( understood that its future is in S/MIME and PKI, so they adjusting their product toward it.
My initial request was to consider supporting PKCS standard in order to access keys that are located cryptographic tokens, in stead of using a proprietary card format... This should be done regardless of our small debate regarding S/MIME and PGP.
I hope you read more regarding PKCS  and understand its role in cryptographic application and that gpg can benefit from it.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 18:18:43
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
I have... and did not find the place.
Can you please refer me to the exact item where you find the Well... so what is the problem of using PKCS why can you use all the other PKCS and cannot use PKCS
Well, PKCS works for everyone... except for you guys...
I don't have a commercial interest, I just want to help... Lately I've tried to use gpg to encrypt some of my stuff, and found the proprietary requirements... So I searched and searched... and read the gpg-agent source, I could not believe that you invent the wheel!
And here we are...
When I understood that I've promised not to bother you again... :)
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 18:56:29
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
1. Athena smartcard  provides Linux and Windows PKCS
2. Algorithmic Research smartcard  provides Linux and Windows PKCS
3. Aladdin smartcard  using opensc.
4. nCipher HSM 5. SafeNet HSM I can find more...
You can refer to opensc and see some more (I didn't tried them)...
Then you can use the opensc PKCS library
I don't understand why you keep insisting of writing a library... You need to use a library not implement one.
All you need to do is to use several PKCS methods:
1. login, find correct object, perform decryption (RSA), logout.
2. login, extract X509 certificates, logout.
May I understand that you agree that gpg-agent should support PKCS as a mean to interact with cryptographic tokens?
This was my original request... The when and how can be determine... But I will be glad if we can agree that it should be done...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-02 21:57:05
@_author: Alon Bar-Lev 
@_subject: PKCS#11 support for gpg-agent 
Thank you Olaf,
I see your point regarding PKI, I am familiar with it.
I want to focus the discussion for the smartcard support, this was my original issue and we then moved to a different discussion... I have a lot to say in that matter... but first I will study you documents to understand your position more I want to come back to the issue of using a standard API to access the cryptographic token.
 > You might think twice before saying such things
 > again...
First I am regret if I offended you.
But having written this document how could you state your previous statement? "This framework does far more than any I am confused...
If you know that all what PKCS is - access objects on cryptographic tokens... why did you raise the OCSP and revocation stuff?
I think otherwise... In current gpg-agent design the smartcard access should be perform by it.
I think current design is correct one...
But I don't care... As long as a standard PKCS API is used to access the smartcard... I will be happy.
Again... I am sorry if I offended you.
But I think there are two separate issues here that are some-how merge together.
Decoding and verifying the PKIX/PGP/PKCS data, and accessing the cryptographic tokens.
These are two separate issues...
One the one hand I have your position that PKCS is not enough... but you don't provide any replacement... for standard access to cryptographic  token.
On the other hand I have Werner position that states that only low level APDU access should be defined as low-level card interface, and every card should be tailored in order to work with gpg.
This demonstrate the need of adopting a software standard for gpg for accessing smartcards... and PKCS is the most suitable standard...
I just want us to agree on that.
Whether it is implemented or not is not an issue... I just wanted to understand why people are developing their own Best Regards,
Alon Bar-Lev.

@_date: 2005-09-03 11:15:58
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Hello Werner,
I now completely understand your position, and know that I have no other arguments left to try and defend my position...
I am sorry if I was too harsh during this discussion, it hurts to see people inventing standards of their own thus limiting the usage of their own great software.
I want to thank you for this discussion.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 13:16:21
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
GPG use some time ago.  This
the bugs in various PKCS The conclusion of my discussion with people here is that the need of using
PKCS for accessing various smartcards is not clear. I've tried to
highlight the advantages of using standard software API to access external
devices, but I've failed.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 17:26:56
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
(who don't mind hacking their
users (who really need
found, something of a lack
I agree... But I was still amazed... If you read the PKCS corresponding
you will notice that there is a remote possibility to agree the usage of
PKCS in a way that gpg will be the provider... So that other applications
can use gpg keys... This was really strange. The whole idea is to separate
between application logic (gpg) and device access (Smartcards, HSM)...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 17:38:03
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Linux, I couldn't find a smart-card + PKCS
I use Athena smartcard  which works perfectly in term of
Linux and PKCS I enjoy using it with Java JCE, Mozilla, Tunderbird,
PAM_PKCS11, I've encrypted my disk using aes-loop and then required gpg to
support PKCS And here we are...
of cards with pregenerated keys and uses an auxiliray file to
maintaining it because of Werner's attitude towards PKCS
help if neccessary.
This is great work!
But the work needs to be moved into gpg-agent... :(
I would have help merging it if I knew that there is a chance to merge it
into to gpg source.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 19:19:08
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
were that bad, not Aladdin.
work just fine.  Just to
I am glad you corrected your-self...
ActivCard did not implement a good CSP/PKCS on Windows too... :(
Athena and Aladdin produce good support software... I am using their cards
and I am very happy... Athena support Linux well... And even share the same
cards between Windows CSP/PKCS and Linux PKCS
Best Regards,
Alon Bar-Lev

@_date: 2005-09-05 19:19:25
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
for that :(
threads started by me. I was quickly discouraged by Werner and
of PKCS
Yes... I agree... I gave up... Tried to help... And failed.
many of which aren't ISO7816-compliant above level 3 - they even don't
and undocumented command set.
I agree!
CAPI will become extinct much before than non-compliant ISO7816 cards.
teller, so time will prove me right or wrong :)
This is exactly my claim... I've tried to introduce this argument to
Werner... But without any success...
I was out of new arguments when I gave up... I think that an open source
project that does not support software interaction standards will be
replaced by a different solution when the time comes.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 19:19:56
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
drive significant
cards/PKCS  want
the 'X' and some
I think that many enterprises are looking first for open source solutions...
If they find one that is suitable, they don't buy commercial product.
The problem is that the open source community does not always understand
which standard to support, and many, like gpg, inventing their own...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 20:31:59
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
enough and you'll find almost
cards on sale by someone.
support, your choice is
which one I'd want...
I agree... So if we all understand the need of PKCS in order to access
cryptographic tokens, what I don't understand is how come people choose to
develop low-level applications in order to work with specific devices?
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 21:14:09
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
specific devices?
argument except possibly of license incompatibility. But in my
understanding, incompatibility. It would happen at run-time if the user chooses to Right... This argument was given to me also...
But I could not find any justification for it...
Let's say you use GPLed licensed program on windows... It loads
kernel32.dll, right?
Since your GPLed program does not contain any other licensed code it is
still GPLed...
The same goes with GPLed licensed program that loads PKCS module...
I think it is the same as gpg works with vendor's X card... The card runs an
operating system that is not GPLed... And yet... gpg is GPL...
Moreover, I've found that opensc and PAM PKCS11 are LGPL and that
openCryptoki ( is GPL.
So... I think licensing should not be an issue...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 21:42:51
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
always keeps mentioning *shared* libraries? :)
Why hate?
Can you please elaborate? I don' t understand what you mean...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-05 23:59:04
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Lionel Elie Mamane Wrote: components of the operating system".
be dlopen.)
So how come GPGed application can use display driver that is vendor
provided? I use ATI drivers... And I have a lot of GPLed programs on my
And how come GPGed application can print on a printer using a proprietary
driver from HP (for example)? I can show you that it GPLed program loads
these drivers...
The same goes to PKCS it is a driver to access the smart card... It is
just like any other peripheral component you use, it is part of the run-time
environment, so that the user may choose which device should be used,
without the software author forcing him to use a specific device.
Open source if about freedom... Right? So there is also the freedom of the
user to choose his peripheral devices, including smartcards.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 00:15:22
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
propretary card drivers export a PKCS  interface
PKCS and Microsoft cryptographic providers are the two APIs available for
accessing cryptographic tokens.
Every application that wishes to use services of vendor in depended
cryptographic tokens uses one of these APIs.
So vendors that developing smartcard provide these interfaces so their card
will be usable.
Enterprises (which are the larger clients) will not but a smartcard that
does not support PKCS
does not interface well with OpenPGP. It makes beteter sense to
OpenPGP. For example, your CA can revoke your key leaving you
I think you got revocation wrong... Revocation is letting OTHERS know that a
key should not be trusted... There is nothing wrong in leaving the private
key in the smartcard.
Regardless this point PKCS token can be organized that the same X.509 and
PGP certificates will refer to the same private key, so if that private key
is deleted both certificate will be unusable.
OpenPGP. OpenPGP cards are intended to be used for
SSL, SSH, TLS, S/MIME , or any other cryptographic purpose.
but implementing PKCS in gpg may blur things too much.
But each user should have one smartcard... It is not logical to force user
to keep several cards in his wallet in order to use several applications.
One smartcard can be used to have tree types of identities: Authentication,
Signature (Email and data), Decryption (Email and data). There is no reason
to divide these into several physical containers.
Users will simply select a different software which can access the same card
as other software...
Application that forces users to use a specific exclusive card will slowly
that could arise if people started using cards with broken PKCS
But this is exactly the point!
You should not develop low-level code to access each card's processor in
order to add the ability to work with smartcards, resulting in N separate
You can benefit from the PKCS high-level API in order to access
cryptographic tokens (Smartcards, HSM, software).
PKCS is a standard that most vendors support, I can agree that if vendor
did not implement the standard correctly, its token will not work with
applications. For example, Mozilla Firefox will not work with some of the
smartcards out there... And I have no claims to Mozilla, they have done a
great job!
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 09:09:06
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
well-known, standard ABI, then linking to it is not a GPL violation.
from the program or not.
But PKCS is not a library you link against!
It is an API specification.
There is no proprietary code you link into your program in order to
implement this standard.
"running linked together in a shared address space".
as to be "GPL-safe" (as long as the coupling between them isn't
 .
I think you should read PKCS specification... You cannot call it
"combining two parts into a program" PKCS is a specification, you don't
provide the implementation along with your program, the specification is
EXACTLY the same as protocol or command line specification. Like you can use
HTTP protocol, since you have RFC that state how, you use cryptographic
token since you have PKCS that tells you how.
Since you don't provide the PKCS provider implementation along with your
GPLed distribution and that there is a complete API specification of the
interface,  it does not fall into the "combined program".
library implements a "standard" ABI, then one can link GPL software
holder's interpretation.
I don't understand this statement...
opensc from  - LGPL uses PKCS
pkcs11_login from  - LGPL uses PKCS
openCryptoki from  - GPL uses
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 13:03:32
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
that you had to link this driver into your program (dynamically
PKCS is a standard it is not vendor specific, please refer to
 so that your answers
will be correct.
So if PKCS is an API specification that every smartcard/HSM/Software who
manages cryptographic keys supports, by means of developing a shared
library/DLL that implement the standard, is it OK for GPLed program to load
and interact with this library.
NOTICE: Since the application does not know which cryptographic token is
used by the user, the usage of the library MUST be done at runtime. There is
stick interface for these libraries which is described in PKCS standard.
We need a definite answer here... So the licensing argument will be out of
the way...
Some of my thoughts... And comments for your position.
A standard is a standard... And it is not matter if it describers an API, a
protocol, a command-line, a format or any other interface.
As long as there is no intellectual rights claims for the implementation of
the standard, it can be used by GPL.
Hence... HTTP is a standard (RFCXXX, protocol), PKCS is a standard (RSA,
API), S/MIME is a standard (RFC, format) etc... There is not difference
between them in term of implementing a compliance software.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 17:25:39
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Copyright holder, I assume?) considers the combined result
the LGPL, to have a licence that allows linking libraries into
always be on free terms and so on.
But this is the opposite the GPL program uses a none GPLed library with out
linkage to it!!! I don't understand why we always turn the facts around.
propose. If a work links to a shared library and invokes its functions
another book into your own book. This process creates a derived work of
or an open, non-patent-encumbered standard is for the purposes
No... You are wrong.
Let's say my Api is as follows:
int do_work (int argc, void *argv[]);
Now I load a shared library, get the do_work address and call it by:
int (*do_work)(int argc, void *argv[]) = get_do_work_address ();
char *args[] = {
do_work (2, argv);
What is the difference between calling this shared library or executing a
none GPLed "ls"?!?!?!?
There is an exception in the FAQ page... "If modules are designed to run
linked together in a shared address space, that almost surely means
combining them into one program."
Please note the word _ALMOST_, you tend to forget that every rule has an
The above implementation and PKCS do not fall this category.
server I do not copy its code onto my memory segment, I am making use
HTTP does not lead to a derived work being created. Whereas when I link
functions in a manner equivalent to writing those functions onto my own
Again... I am sorry but I must disagree... WHERE THE CODE RUN  IS NOT AN
The issue is how tightly your code is with another code.
A protocol and API specification are the same, since they can replace one
In your view I can write a PKCS daemon that exposes SOAP as protocol...
And this way to use PKCS in GPLed application.
But I cannot use the PKCS directly...
This is CRAZY!!! You are fooling your-self if you think there is a
difference between the two...
If the usage of PKCS caused your application to violate the GPL license,
then the usage of the same API through SOAP will cause the same affect!
I cannot imagine that the lower who wrote the GPL meant that the open source
community's programmers should work so hard in order to implement their
software... I think this is your interpretation... I've written FSF and I
hope they will address this issue.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 19:12:11
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
implementing PKCS and nobody has stepped up to pay me to do it.
When I started this discussion, I wanted to ask whether implementing a
feature of gpg-agent to access PKCS token is in the roadmap... I will
gladly get the answer, yes... If someone will pay for the implementation...
When you raise this issue... It seems that PKCS is not implemented not
because of licensing problems... But because if PKCS will be implemented
then there will be no work to be done for each specific card...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 21:33:59
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
may put as many other applications on a card as you like and the
pretty small application.
Werner, you fail to understand the user requirements... The low level
specifications of the cards is not important, programmers (except of you
guys...) do not program low-level code in order to access devices.
There is PKCS which is high-level SOFTWARE API that is cross-platform,
cross-device, and easy to use.
This is the only specification to which I can write software and make sure
that the user will be free to choose his hardware.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-06 23:21:23
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
I dropped all stuff regarding the differences using API and communication... I think you are wrong, there is exception for the rules... I try now to contact FSF for a formal position.
Here is what you imply... And it is so sad that I want to cry :-(
On Microsoft platform, there is an API called CryptoAPI which is provided as part of the operating system.
This API uses CSPs (Cryptographic Service Providers) that is provided by the smart card vendors.
So GPLed program can execute on Windows platform which is TOTALLY NOT A FREE software and use vendor provided smart card On the other hand, in Linux environment, the flag ship of the free software, a GPLed software cannot use vendor provided smart card interface since (As you claim) every shared library that is used must be also GPLed.
Microsoft environment turns to be the best environment for GPLed software, since it provides all features as part of the operating system... This is how they use their monopoly... And you and all people who think like you fall into their trap.
Your arguments should not be if the code is run here or run there or how technically you use a piece of code, your argument should be around the ability to spread free software, and this ability is provided if the free software uses as many standards as it can, PKCS is one of them.
There is no sense in turning Linux environment to be less attractive for free software development, since smart card are hardware based, they will never be free and as such every program that need to use hardware will have to use proprietary  From your position there are three options:
1. Linux will not be able to use many hardware devices available in the market. So there will be less application for Linux, more application for  Windows.
2. Vendors will develop NONE FREE software and sell it to people who insist to use these hardware devices and Linux. For example, I will write a PKCS gpg-agent and sale it for enterprises... If they insist of using gpg... But I don't believe they will...
3. Application in Linux environment will invent standards like the OpenPGP card, and be left out with some early adapters When I read the GPL and the GPL FAQ I don't understand that this was the wish of the authors. Exactly because of that they allowed exceptions. People should understand when a situation occurs that satisfied an exception.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-07 08:43:08
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
and people use non-free drivers) and not implementing
Again, you are wrong.
There is not point in writing a low level code in each application to
support each card it is NxN situation, not wise.
Had you written that if vendors would have published their low-level
interface, which is expected to be different since every one offers a
different set of features, and someone would have written a GPLed PKCS
provider for each card, I could almost agree with you that this is the right
way to go...
Why almost?
Since the software you are communicating with, which runs on the smartcard
device, is proprietary... And I am completely not agree with you that there
is a difference between sending proprietary APDUs or using an API.
I think you reach the same state no matter how you look on it.
I am still waiting for FSF response, does anyone knows someone there how can
help in resolving this issue?
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-07 12:42:56
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
No! this is not the issue of cryptography.
It was an argument for the GPL position that some of the people here took.
I am saying that if you take that stand, GPL application can enjoy the
Microsoft environment more than the open source environment, and that it
does not make sense to me...
Please read the whole corresponding.
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-07 13:33:22
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
the LGPL. Using the Microsoft CryptoAPI doesn't appear to be legal; of being able to interface with PGP on Windows systems.
So you say that it is illeagal to run GPL software on windows or on AIX...
It also make no sense... Since it is...
Best Regards,
Alon Bar-Lev.

@_date: 2005-09-07 19:10:32
@_author: Alon Bar-Lev 
@_subject: OpenPGP Card 
Great! Super! Amazing!
If you can do it with a little effort I will glad to check and use it.
But after looking at the source... it does not looked like a very simple interface...
Best Regards,
Alon Bar-Lev.

@_date: 2006-02-13 14:17:58
@_author: Alon Bar-Lev 
@_subject: Finally: Login via SSH authentication with OpenPGP smart card 
Are you aware of the PKCS for OpenSSH solution
PKCS is a standard interface to access cryptographic
tokens, the OpenSSH patch support the use of any PKCS
provider with OpenSSH.
I just hope that someday OpenPGP card will also have PKCS
provider, so it can be used by other applications, and the
other way around... gpg will use PKCS providers in order
to support many card types.
Best Regards,
Alon Bar-Lev.

@_date: 2006-02-13 19:35:22
@_author: Alon Bar-Lev 
@_subject: Finally: Login via SSH authentication with OpenPGP smart card 
Hello Werner,
Well... We discussed that in the past... I don't think so...
Let's say it is too complex... But if you look at this from
the user point of view, there is no logic to reinvent the
wheel for each application. But we discussed this in the past.
No proprietary... Only a standard interface. The user may
select the proper implementation, let's say OpenPGP PKCS
Provider, which is a complete open-source GPLed implementation.
This should be your interest... If you do that, user will be
able to use your card with may PKCS aware applications. I
don't use/recommend  OpenPGP card since it has too many
I know you have a licensing problem... I've been in touch
with FSF in order to provide you with the tools needed for
implementation. I get one reply every two months... So the
process is not over yet.
But it seems like we reach into the following conclusion: If
GPLed application is written in a way that it work with a
standard free interface plug-in (like PKCS and it is not
depended on a specific implementation (Compile time,
features), then there is no GPL violation if the user
chooses to use none GPLed plug-ins.
I've written the PKCS support for OpenVPN and OpenSSH, I
will gladly add this support to gpg as well... This of
course depends on your decision.

@_date: 2006-02-17 23:31:58
@_author: Alon Bar-Lev 
@_subject: Finally: Login via SSH authentication with OpenPGP smart card 
This is not what I understood from our last thread... So I
bothered FSF for nothing.
Well... I wish you good-luck in convincing all that you own
the enlightenment, you are the only one who know how to
integrate crypto tokens and applications...
I still don't understand why you use PKCS PKCS X.509,
CMC, S/MIME and more... Why don't you invent some
replacements for these too?
All people need to adjust their software to your proprietary
solutions... Well, I won't.
I believe the free software world is about providing user
with a choices, and not eliminate them. I do as much as I
can in order to provide these choices. Standards are at the
base of this belief, without standards, there can be no choice.
Now, when understanding your attitude, I will stop bothering
you with this issue.
Best Regards,
Alon Bar-Lev.

@_date: 2006-11-29 23:57:01
@_author: Alon Bar-Lev 
@_subject: Smart Card Use with GnuPG 
The gnupg-pkcs11 is a standalone scdaemon and not patch, but it works only with gpgsm, so it won't solve the problem.
I've tried to make it work with gpg, but I had no success... It seems that it looks for specific card type? I didn't invest a lot of time in this, and we did not want to patch gpg code.
Best Regards,
Alon Bar-Lev.

@_date: 2007-08-01 18:41:57
@_author: Alon Bar-Lev 
@_subject: OpenPGP card on Javacard 
I just wounder...
Why do you wish to do this?
You already have MUSCLE which provides java applet.
You already have coolkey
( provides java
You already have standard PKCS interface to MUSCLE (also using
OpenSC) and coolkey.
And you have  which allows gnupg
to use standard PKCS tokens.
Implementing a card structure for a specific software is incorrect solution.
There should be a standard interface for cards that allows application
to access them, without dependency of specific
There are two standards: PKCS (cross platform, vendor independent)
and CAPI (Microsoft).
The fact that GnuPG developer choose to reinvent the wheel is not for
the benefit of their users.
If you like smarcard development, you can try to provide a generic
card (That can hold more than 3 keys), secured (2048) and usable (More
than one application)... This involves in providing a PKCS provider
that communicate with your generic applet.
Best Regards,
Alon Bar-Lev.

@_date: 2007-02-02 23:54:52
@_author: Alon Bar-Lev 
@_subject: smartcard and ssh 
Or if your smartcard supports PKCS interface you can use the
gnupg-pkcs11-scd from  and OpenSSH
PKCS from  this
way you can use your smartcard with many application at the same time
without stopping any interface or making the card locked by one of
Best Regards,
Alon Bar-Lev.

@_date: 2007-02-11 18:42:53
@_author: Alon Bar-Lev 
@_subject: external pinpad, gnupg, SPR532 PinPad SmartCard Reader 
If you use opensc enabled card, is the PKCS provider works with the
external PIN pad?
You can test it using firefox or pkcs11-tool.
If yes, you can use the gnupg-pkcs11-scd.
Best Regards,
Alon Bar-Lev.

@_date: 2007-02-11 20:34:20
@_author: Alon Bar-Lev 
@_subject: external pinpad, gnupg, SPR532 PinPad SmartCard Reader 
Strange... It seems like the pcscd is not up...
Can you check it out?
So you will be able to reach at least the same state... :)
But you said ubuntu does not use the external PIN PAD...
Alon Bar-Lev.

@_date: 2007-02-11 21:13:31
@_author: Alon Bar-Lev 
@_subject: external pinpad, gnupg, SPR532 PinPad SmartCard Reader 
Oh... I thought you wish to use the external PIN PAD...
You can work with MUSCLE mailing list in order to make pcscd work...
Sorry I cannot help you further...
Alon Bar-Lev.

@_date: 2007-01-21 22:40:40
@_author: Alon Bar-Lev 
@_subject: [HELP NEEDED] GnuPG-1.4 IDEA migration to GnuPG-2.0 
Can anyone help some of our (Gentoo) users solving a migration issue they have?
The users used IDEA algorithm in GnuPG-1.4, and are unable to use
their keys in GnuPG-2.0.
The libgcrypt was patched to enable IDEA algorithm.
Any help will be appreciated.
Best Regards,
Alon Bar-Lev.

@_date: 2007-01-28 19:22:48
@_author: Alon Bar-Lev 
@_subject: [HELP NEEDED] GnuPG-1.4 IDEA migration to GnuPG-2.0 
This is the easy way out :)
gpg2 should be backward compatible... I would like to make it work too... :)
Best Regards,
Alon Bar-Lev.

@_date: 2007-07-06 19:32:20
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG 2.0.5 released 
Hello Werner,
It will be nice if you publish dependency like libassuan and libskba
version requirements (if changed).
Also, you have parallel make issue.
common/Makefile.am you include $(top_srcdir)/am/cmacros.am which defines:
libcommon = ../common/libcommon.a
libcommonpth = ../common/libcommonpth.a
This causes dependency of t-convert to be out of subdir thus fail parallel make.
The following temporary solves the issue:
sed -i 's common/Makefile.in
Best Regards,
Alon Bar-Lev.

@_date: 2007-07-06 21:40:29
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG 2.0.5 released 
Any more surprises?
BTW: You ignored all patches from:

@_date: 2007-07-13 09:06:29
@_author: Alon Bar-Lev 
@_subject: Pin fails with svn & ssh & gnupg-agent & smartcard. 
Hmm... maybe if you switch to one all your problems will be gone :)
Selecting the right card to use is a key factor in peace of mine.

@_date: 2007-07-13 12:08:24
@_author: Alon Bar-Lev 
@_subject: Pin fails with svn & ssh & gnupg-agent & smartcard. 
There is no such thing as free hardware!
There are many types of card supported by MUSCLE, OpenSC and CoolKey
all with free opened source licenses.

@_date: 2007-06-28 17:52:59
@_author: Alon Bar-Lev 
@_subject: Broken pipe? [was: Problems svn+ssh+gpg(-agent)+smartcard] 
Are you using a card that is capable of PKCS interface?

@_date: 2007-05-10 07:55:38
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG 2.0.4 released 
Hello Werner,
What about some issues regarding the environment:
And issues regarding gpgme?
Alon Bar-Lev.

@_date: 2007-05-10 11:10:30
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG 2.0.4 released 
I tried to... but could not find anyway I can open issue in your bug tracker.
Now I see I can... Strange...
It is not Gentoo problem, you have the same report at other distors:
I wish developers will stop saying this one...
When, in which component gpg or gpgme?
Very difficult to understand something from the description.
It is in testing status for a long time.

@_date: 2007-05-10 13:46:31
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG 2.0.4 released 
I cannot replicate it too...
It seem like a race condition...

@_date: 2007-11-17 00:38:24
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG release candidate 1.4.8 
Can you please verify that you solve/address the following issues:
There was also an issue with PIC:
    sed -i -e 's:PIC:__PIC__:' mpi/i386/mpih-{add,sub}1.S intl/relocatable.c
    sed -i -e 's:if PIC:ifdef __PIC__:' mpi/sparc32v8/mpih-mul{1,2}.S
You can see some other issues we had with previous release, maybe some
are not needed.
Best Regards,
Alon Bar-Lev.

@_date: 2007-11-19 21:28:13
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG release candidate 1.4.8 
You are correct... I started maintaining since 1.9...
So these are older...
I will try my best to determine what happened back then.
Will test again...
But as it seems there was a problem in using the homedir of package
management user...
Will try.
As far as I tested, gcc defines __PIC__ when you use -fPIC not PIC.
Does it different at your side?
Best Regards,
Alon Bar-Lev.

@_date: 2007-11-21 19:08:50
@_author: Alon Bar-Lev 
@_subject: [Announce] GnuPG release candidate 1.4.8 
Without --homedir won't it try to access the running user home directory?
In some cases it cause sandbox violation.
The touch stuff are not needed I guess.
You should put the ru man page at:
Best Regards,
Alon Bar-Lev.

@_date: 2008-01-03 08:24:37
@_author: Alon Bar-Lev 
@_subject: Where can I buy OpenPGP smartcards? 
You can use almost any PKCS enabled smartcard if you use:
Using PKCS will enable you to use the same card for other
applications as well.
Best Regards,
Alon Bar-Lev.

@_date: 2008-01-07 20:38:49
@_author: Alon Bar-Lev 
@_subject: Where can I buy OpenPGP smartcards? 
The chances are slim... Because of this we forked the scdaemon...

@_date: 2008-01-23 21:08:54
@_author: Alon Bar-Lev 
@_subject: IDEA 
You can use Gentoo patches...
For libgcrypt:
For gnupg-2:

@_date: 2008-01-25 21:59:42
@_author: Alon Bar-Lev 
@_subject: IDEA 
Gentoo is providing this only if a user specify build from source and
ask idea explicitly.
Also Gentoo enforces dropping idea when binary redistribution is made.
Please refer to:
I will appreciate any way to improve this.
I hope this helps,

@_date: 2008-01-29 21:33:59
@_author: Alon Bar-Lev 
@_subject: IDEA 
Gentoo does not distribute gnupg or IDEA.
Gentoo provides the instructions of how to build these components from source.
Gentoo is not distribution in the usual sense, but meta-distribution...
If one distribute a pre-built packages he set the bindist USE flag,
and IDEA is disabled.
As far as people checked (for this and other packages) this is valid
and confirms to GPL.
There are people with IDEA keys, they would like to continue using these keys.
As long as they are leagalley entitled to, I don't see why this should
not be allowed.
The information is correct. Whoever want to use IDEA should be exposed
to this information.
However... I cannot access this URL anymore.
Alon Bar-Lev.

@_date: 2008-05-04 08:00:18
@_author: Alon Bar-Lev 
@_subject: Question about GnuPG Smartcard 
You can check out gnupg-pkcs11-scd [1], it does allow more keys
(1024/2048) for gpgsm and 2048 key for gpg.
[1]
