
@_date: 2015-02-17 15:12:22
@_author: Errol Casey 
@_subject: Compiled binaries execute but exit with "Abort" 
I have successfully compile gnupg 2.0.26 on Solaris 10 using gcc (GCC)
3.4.3 (csl-sol210-3_4-branch+sol_rpath)
But it fails openpgp tests, and all executable exit with an "Abort" message.
I cannot determine what is causing this abort, but it I can
successfullyexecute programs to generate keys. Decrypt and encrypt.
Making all in po
Making all in doc
make  all-am
Making all in tests
Making all in openpgp
./gpg_dearmor > ./plain-1 < ./plain-1o.asc
gpg: WARNING: unsafe ownership on homedir `.'
*** Error code 134
make: Fatal error: Command failed for target `plain-1'
Current working directory /syshome/gecasey/gpg/gnupg-2.0.26/tests/openpgp
 ./gpg2 --version
gpg (GnuPG) 2.0.26
libgcrypt 1.6.2
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Home: ~/.gnupg
Supported algorithms:
Pubkey: RSA, RSA, RSA, ELG, DSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: MD5, SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2

@_date: 2015-02-18 08:18:11
@_author: Errol Casey 
@_subject: Compiled binaries execute but exit with "Abort" 
gdb gpg2
GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.10"...
(gdb) break abort
Breakpoint 1 at 0x1278fc
(gdb) run
Starting program: /syshome/gecasey/gpg/gnupg-2.0.26/g10/gpg2
warning: Temporarily disabling breakpoints for unloaded shared library
Breakpoint 1 at 0xfedc28a4
gpg: Go ahead and type your message ...
this is a test
gpg: no valid OpenPGP data found.
gpg: processing message failed: Unknown system error
Breakpoint 1, 0xfedc28a4 in abort () from /lib/libc.so.1
(gdb) bt
  0xfedc28a4 in abort () from /lib/libc.so.1
  0xff15367c in get_lock_object (lockhd=0xff16e3b0) at posix-lock.c:111
  0xff1536f8 in _gpgrt_lock_lock (lockhd=0xff16e3b0) at posix-lock.c:155
  0xff156a74 in _gpgrt_fflush (stream=0x0) at estream.c:3590
  0xff156b0c in do_deinit () at estream.c:490
  0xfedc3180 in _exithandle () from /lib/libc.so.1
  0xfedb1140 in exit () from /lib/libc.so.1
  0x0002717c in g10_exit ()
  0x00025de0 in main ()

@_date: 2015-02-19 06:01:14
@_author: Errol Casey 
@_subject: Compiled binaries execute but exit with "Abort" 
Thanks. Now to figure out why make check fails but make works without
error. Are there dependencies besides pth for libgpg-error?
make  check-TESTS
bash: line 5: 11699 Abort                   (core dumped) ${dir}$tst
FAIL: t-version
Unspecified source: Success
gcrypt: Invalid length specifier in S-expression
GnuPG: Unknown packet
GpgSM: Certificate too young
GPG Agent: Bad CA certificate
Pinentry: Operation cancelled
SCD: Card removed
GPGME: Bad secret key
Keybox: Unknown error code
bash: line 5: 11708 Abort                   (core dumped) ${dir}$tst
FAIL: t-strerror
bash: line 5: 11714 Abort                   (core dumped) ${dir}$tst
FAIL: t-syserror
bash: line 5: 11719 Abort                   (core dumped) ${dir}$tst
FAIL: t-lock
bash: line 5: 11724 Abort                   (core dumped) ${dir}$tst
FAIL: t-printf
5 of 5 tests failed
Please report to *** Error code 1

@_date: 2015-02-24 11:23:36
@_author: Errol Casey 
@_subject: Compiled binaries execute but exit with "Abort" 
i will try going back to the older version of libgpg-error
This is the order of the build I did; if there are versions of packages
that don't require pth.
Let me know and I will try to rebuild with different versions
1. Build and install pth 2.07
2. Build and install libgpg-error 1.18 (due to another package saying it
needed a newer version that what I had. I think I had older than 1.12)
3. Build and install libgcrypt 1.6.2
4. Build and install libassuan 2.2.0
5. Build and install libksba 1.3.2
6. Build gnupg 2.0.26

@_date: 2015-02-24 14:07:26
@_author: Errol Casey 
@_subject: Compiled binaries execute but exit with "Abort" 
got a working gpg2! Thanks. Now to figure out automation. Will post a
separate thread regarding my
issues with removing passphrase,.

@_date: 2015-02-24 14:12:32
@_author: Errol Casey 
@_subject: Cannot remove passphrase (gnupg 2.0.26/solaris 10) 
When I use gpg2 --edit-key , and then use passwd to
passphrase by entering a blank passphrase. I get hung in an input loop
           lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
            x Please re-enter this passphrase                     x
            x                                                     x
            x Passphrase ________________________________________ x
            x                                                     x
            x             x
            mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj
You don't want a passphrase - this is probably a *bad* idea!
                                                            Do you really
want to do this? (y/N)
I truss the process (this is on Solaris 10), and I see it receiving the
"y\r" but it doesn't continue.
I can type N enter, and see 'N\r" also.
So not sure if it is a local issue with tty, compile issue with pinentry,
or gnupg?
But it accepts my original passphrase, and hitting enter twice and
selecting yes I want to do it, gets me to this last prompt and it will go
no further.
Thinking the compile/linking of pinentry is the cause. I've seen this
before, but just ran
pinentry --version
ld.so.1: pinentry-curses: fatal: libiconv.so.2: open failed: No such file
or directory
seems I have to modify LD_LIBRARY_PATH to get pinentry to work; but this
change was made en enviornment when I tried changing passphrase above. Not
sure where the input problem is being generated.
$ pinentry --version
pinentry-curses (pinentry) 0.9.0
$ gpg2 --version
gpg (GnuPG) 2.0.26
libgcrypt 1.6.2
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Home: ~/.gnupg
Supported algorithms:
Pubkey: RSA, RSA, RSA, ELG, DSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: MD5, SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2

@_date: 2015-02-26 15:48:36
@_author: Errol Casey 
@_subject: Cannot remove passphrase (gnupg 2.0.26/solaris 10) 
I've tried recompiling things, and was able to initially set a key with a
empty passphrase (pressing return twice).
But if I use --edit-key to change passwd, and then try to set it back to
blank...I get the warning, and infinite loop asking for
"y/N" but never accepts either answer...

@_date: 2015-03-31 10:19:56
@_author: Errol Casey 
@_subject: tty permission issues 
I've run into an issue with tty permissions when using GNUpg.
We have accounts that users cannot login to directly for security reasons.
They must use sudo su -  to access the account, after logging in
their own personal account.
This leaves the pseudo tty owned by the login users. The permission issue
causes pinentry to fail, and not prompt for passphrases.
I'm looking into possible changes to sudo config, setuid binaries, and
individual script to change permission before and after sudo as possible
Wanted to see if other gnupg users had worked around this issue.
