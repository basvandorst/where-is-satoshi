
@_date: 2002-07-21 15:54:01
@_author: Rafi Avital 
@_subject: Gnupg-users digest, Vol 1 #770 - 10 msgs 
Carissa, If you want to be able to use GPG.EXE and pass parameters to it from a VB application, take a look at a windows DLL that has been created specifically for that purpose.  It is available at   and you want to download the "Cryptotw.dll."  In it, there is a readme file that will show you how to make the declarations to the dll (all in the zip archive).  This DLL does not have a .tlb file, so you have to make the declarations in VB.  This is the final release candidate (v 0.9.7.2) and the release should happen very soon.
It has been tested with GPG version 1.0.6-2, and will be tested with upcoming versions as soon as their windows versions are certified and available.
Hope this helps
Rafi Avital

@_date: 2002-07-21 15:58:01
@_author: Rafi Avital 
@_subject: Decryption Automation Question 
Carissa, If you want to be able to use GPG.EXE and pass parameters to it from a VB application, take a look at a windows DLL that has been created specifically for that purpose.  It is available at   and you want to download the "Cryptotw.dll."  In it, there is a readme file that will show you how to make the declarations to the dll (all in the zip archive).  This DLL does not have a .tlb file, so you have to make the declarations in VB.  This is the final release candidate (v 0.9.7.2) and the release should happen very soon.
It has been tested with GPG version 1.0.6-2, and will be tested with upcoming versions as soon as their windows versions are certified and available.
Hope this helps
Rafi Avital

@_date: 2003-07-25 02:05:01
@_author: Rafi Avital 
@_subject: Can you help me understand Signature? 
Hello all,
I have implemented an open-source DLL into a Windows app that communicates with
GnuPG (gpg.exe) and one of the requiremens was to verify signatures before
decrypting a file. Reading the source I found out the authors handled this in
the following way:
Capture the output of gpg --list-packets filename.gpg
Find the signature block in it
Capture the output of gpg --list-keys --with-colons
Find the string from the previous step in this output
If found go ahead with decryption, if not, log an error.
Bear in mind that the file is a single unit, it doesn't have  a "Begin
signature" line or anyhting of the sort, just a GPG-encrypted AND signed file.
When I issue a gpg --verify, passing the encrypted file, I get an error -
"Unexpected data."  I have read the manual and I realize it requires a signature
file.  Forgive my ignorance, I have no idea what that is.
Is this a file containing signatures that I would have cut and pasted from other
files?  from detached signatures?
I'm sorry but the gpg.man is not very clear on this, nor is the howto file.
Could you please explain to me the various kinds of signatures, and how
signature verification is supposed to work?  What is a detached signature, what
is clear-signing etc?
Using GPG Shell, when I verify, it does tell me "Good signature from ..."  and
that's the result I'm looking for.  Is the procedure I outlined above (listing
the packets) the only reliable way to verify a signature on an encrypted+signed
I am evaluating a new MUA (The Bat!) which produces exactly the same result as
--verify when I ask it to verify a signature before decrypting.  I am told by
their mailing list that this works fine for them, but I realize I need more info
on exactly what everybody means when they say "verify signature."
Many thanks and best regards

@_date: 2003-07-25 03:44:01
@_author: Rafi Avital 
@_subject: Can you help me understand Signature? 
Hello all,
I have implemented an open-source DLL into a Windows app that communicates with
GnuPG (gpg.exe) and one of the requiremens was to verify signatures before
decrypting a file. Reading the source I found out the authors handled this in
the following way:
Capture the output of gpg --list-packets filename.gpg
Find the signature block in it
Capture the output of gpg --list-keys --with-colons
Find the string from the previous step in this output
If found go ahead with decryption, if not, log an error.
Bear in mind that the file is a single unit, it doesn't have  a "Begin
signature" line or anyhting of the sort, just a GPG-encrypted AND signed file.
When I issue a gpg --verify, passing the encrypted file, I get an error -
"Unexpected data."  I have read the manual and I realize it requires a signature
file.  Forgive my ignorance, I have no idea what that is.
Is this a file containing signatures that I would have cut and pasted from other
files?  from detached signatures?
I'm sorry but the gpg.man is not very clear on this, nor is the howto file.
Could you please explain to me the various kinds of signatures, and how
signature verification is supposed to work?  What is a detached signature, what
is clear-signing etc?
Using GPG Shell, when I verify, it does tell me "Good signature from ..."  and
that's the result I'm looking for.  Is the procedure I outlined above (listing
the packets) the only reliable way to verify a signature on an encrypted+signed
I am evaluating a new MUA (The Bat!) which produces exactly the same result as
--verify when I ask it to verify a signature before decrypting.  I am told by
their mailing list that this works fine for them, but I realize I need more info
on exactly what everybody means when they say "verify signature."
Many thanks and best regards

@_date: 2004-06-09 21:16:53
@_author: ravital@netbox.com 
@_subject: --logger-fd n in Windows Visual Basic 
Forgive a silly question:
As long as you're going to write key information to a file, couldn't you
just use ".....--list-packets >> filename.txt" instead of "--output" ?
Also, you might want to look at this:
This is an open-source Windows DLL (don't try to register it as an
Active-X, it's not that sophisticated and it won't show up in VB's wizards
either), which as part of a function designed to check signatures, does
collect the output of --list-packets into a file.
[There was a bug in a previous version where it stored the packet output in
"fileA.txt" and was trying to read it back from "fileB.txt" - I'm told
that's been fixed, but I haven't tested it.  Get the source code and see
the bug log  accessible from the project's main page, I remember logging
the exact module and line-number where the problem happened.  I got around
the problem by creating a copy of the original file under the second name
and write-protecting both files.  My application may be different from
yours, I actually check the validity of signatures against my keyring
before decrypting, but given that it does produce a file with the output
you're looking for, it may be what you need.]
Hope this helps.
Original Message:
mail2web - Check your email from the web at
 .
