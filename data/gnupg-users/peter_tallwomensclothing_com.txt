
@_date: 2002-08-02 03:35:02
@_author: Peter Gillett 
@_subject: gnupg problems 
I had similar problems when I was getting a cgi
script on a web site to encrypt a text file to be
emailed, and found (using gpg 1.0.6 or 1.0.7 for
1) gpg.exe wants to be able to write to
trustdb.gpg (in the default directory or the one
specified in --homedir a_good_directory), even
though you specify "--always-trust -r
your_emailaddress". If trustdb.gpg does not exist,
gpg.exe will create one and insert the fact that
you always trust key 12345678.xy into trustdb.gpg.
If trustdb.gpg is read only, I got a secmem usage
error. Maybe there is an option to tell gpg.exe
not to write to the trustdb.gpg file? But I
couldn't find one.
2) gpg.exe will also create a file random_seed
(again in the default directory or the one
specified in --homedir a_good_directory), unless I
specify the --no-random-seed option. However, when
I do specify the --no-random-seed option, I get a
warning message "gpg: NOTE: you should run
'diskperf -y' to enable the disk statistics". I
tried giving the --batch --no-tty --quiet options,
but still got the warning message.
3) if secring.gpg does not exist in the default
directory or the one specified in --homedir
a_good_directory, gpg.exe creates one with a
length of zero bytes. I found that this
secring.gpg can be set to read only, and
everything still worked. This secring.gpg does not
have to be your real one, and it can also be 0
bytes long. I guess putting a real secring.gpg on
a webserver for everyone to possibly see would be
a bad thing!
4) To make it all work, I...
a) put gpg.exe in an execute only directory on the
b) created a homedir called xxxxxxx/gpg where I
put pubring.gpg (read only) and a zero byte length
secring.gpg (read only), as well as a trustdb.gpg
(read/write) and a file called random_seed
c) used the command....
--homedir a_good_directory
--always-trust -ear my_emailaddress
where fred.txt is the file to be encrypted into a
file called fred.asc. The -ear is for e=encrypt,
a=armor and r specifies the recipient.
And it all worked fine.
Hope this helps

@_date: 2002-08-08 13:24:01
@_author: Peter Gillett 
@_subject: GnuPG in PHP failing with error code 2 
here is a perl script I use that may be of
$gpg_path = "good_path/gpg.exe";
$gpg_options = "--homedir
good_path/gpg --batch --no-version --no-tty --alwa
ys-trust -ear";
$gpg_public_key_user_id = "blah\
sub make_gpg_file {
  local($output_text, $output_file) =   local($gpg_output);
  $gpg_command =  "$gpg_path $gpg_options ";
  $gpg_command .= "$gpg_public_key_user_id ";
  $gpg_command .= ">$output_file";
  open (gpgCOMMAND, "|$gpg_command");
  print gpgCOMMAND $output_text;
  close (gpgCOMMAND);
  open(gpgOUTPUT, $output_file);
  while () {
    $gpg_output .= $_;
  }
  close (gpgOUTPUT);
  unlink($output_file);
  return($gpg_output);
It takes $output_text, encrypts it to
then returns $output_file into $gpg_output,
then deletes $output_file. It is called from
a perl shopping cart script.
The only thing that it needs to work is for
and random_seed to be read/write in homedir, while
pubring.gpg and secring.gpg can be read only in
Pubring.gpg can be read only in homedir, and gpg
will create a zero byte length secring.gpg the
time it is run. This can also be set to read only.
hope this is of some use,

@_date: 2002-07-25 02:32:02
@_author: Peter Gillett 
@_subject: encrypt to self. 
--status-fd 2
can let the code
I use the command (with V1.0.6 for windows) within
a perl script on a webserver...
gpg.exe --homedir
e:\inetpub\vs12345\gpg\ --batch --no-version --alw
ays-trust --no-tty --comment my_comment -ear
my_email_address file.txt
to encrypt the orders from a perl shopping cart,
then have the encrypted file emailed to me.
I hope this helps...
Peter Gillett

@_date: 2003-05-10 02:04:02
@_author: Peter Gillett 
@_subject: Automated Encryption 
to set up gpg to work on a W2K server, Copy gpg.exe (the w32 one) to an
executable directory on your webserver, and pubring.gpg, secring.gpg,
trustdb.gpg and random_seed to a directory on your webserver that has read
and write and delete permissions. This will be your gpg home directory, so
have the permissions of pubring.gpg and secring.gpg set to read only, but
not write, delete or execute, and set the permissions of trustdb.gpg and
random_seed to read and write, but not execute or delete.
To encrypt a file called c:\test\homedir\fred.txt with the key
bill run the dos command...
c:\test\exe\gpg.exe --homedir
c:\test\homedir --batch --no-version --always-trust --no-tty --comment
"" --ear bill
This will produce afile fred.asc, encrypted with bill key,
with no version or comment.
We use this method (but using perl scripts) to automatically encrypt orders
for our website that runs on a shared server running IIS 5.0 under W2K
hope this helps
Peter Gillett
The Long Tall Clothing Company
-----Original Message-----
Behalf Of Charles Kronschnable
Sent: Saturday, 10 May 2003 00:48
My task is to send encrypted emails via an asp page.  I have two options I
believe.  The first is to have my asp page execute a dos shell and use
commands to encrypt a file on the server and then attach that file to the
email using cdonts, but I can't find a resource for dos commands anywhere,
I realize that gnupg is opensource and there are all kinds of unix/linux
references but nothing for a win os.
