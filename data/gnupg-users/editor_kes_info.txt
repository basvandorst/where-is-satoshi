
@_date: 2002-12-16 22:06:01
@_author: Norbert Luckhardt 
@_subject: disabled keys: bug or misunderstanding (GPG 1.2.1) 
Hello gnupg-users,
when having multiple keys for the same e-mail GPG seems to take the
one which is "oldest" in the key ring, which is not always the one
you'd like it to use (example below)... in PGP I just disabled such
keys which should only be kept for signature verification (or whatever
purpose), so the program had just the one key enabled which should be
used for encryption
while trying this in GPG, the following happens: when you disable the
key which is found first from GPG, it stops on error and does NOT look
further if there is another feasible key for encryption for the given
e-mail address - I consider this a bug
(of course on a command line one could give the key ID instead of the
e-mail address - but frontends and mailer plug-ins usually only hand
over the mail address to GPG to select the enryption target)
any enlightnig comments are welcome!
kind regards, Shalom dann,
REAL-WORLD EXAMPLE:
the German magazine c't acts as a CA for PGP/GPG keys - and uses a
yearly changing communication key - the CERTIFICATE keys MUST NOT be
used for encrypting messages (by policy decision)
pub  1024D/B3B2A12C 1999-05-11 ct magazine CERTIFICATE pub  1024R/BB1D9F6D 1997-03-04 ct magazine CERTIFICATE pub  1024D/125FDE3D 2001-12-28
     ct magazine pgpCA CommunicationKey 2002 < now disable the key it finds first for pgpca >
    =20
gpg: pgpca =FCbersprungen: =F6ffentlicher Schl=FCssel ist ab=
gpg: start.bat: encryption failed: unbrauchbarer =F6ffentlicher Sch=FCsse=
(the text says that the corresponding key is disabled and thus
encryption fails - note: this example works only in GPG installations
where the old RSA key is a feasible encryption target - however the
general problem occurs whenever there are more than one valid keys for
a given mail address and GPG chooses the "wrong" one)
Norbert Luckhardt, Editor in Chief           KES - IT-Security Journal (AT/CH/DE)
      SecuMedia Verlags-GmbH    Gaulsheimer Stra=DFe 17
      55218 Ingelheim           GERMANY
fon  +49-511/5 63 62 93    *    +49-67 25/93 04-11 (ed. assist.)
fax  +49-511/5 63 62 99    *    +49-67 25/59 94

@_date: 2002-12-17 11:20:02
@_author: Norbert Luckhardt 
@_subject: disabled keys: bug or misunderstanding (GPG 1.2.1) 
Hello gnupg-users,
when having multiple keys for the same e-mail GPG seems to take the
one which is "oldest" in the key ring, which is not always the one
you'd like it to use (example below)... in PGP I just disabled such
keys which should only be kept for signature verification (or whatever
purpose), so the program had just the one key enabled which should be
used for encryption
while trying this in GPG, the following happens: when you disable the
key which is found first from GPG, it stops on error and does NOT look
further if there is another feasible key for encryption for the given
e-mail address - I consider this a bug
(of course on a command line one could give the key ID instead of the
e-mail address - but frontends and mailer plug-ins usually only hand
over the mail address to GPG to select the enryption target)
any enlightnig comments are welcome!
kind regards, Shalom dann,
REAL-WORLD EXAMPLE:
the German magazine c't acts as a CA for PGP/GPG keys - and uses a
yearly changing communication key - the CERTIFICATE keys MUST NOT be
used for encrypting messages (by policy decision)
pub  1024D/B3B2A12C 1999-05-11 ct magazine CERTIFICATE pub  1024R/BB1D9F6D 1997-03-04 ct magazine CERTIFICATE pub  1024D/125FDE3D 2001-12-28
     ct magazine pgpCA CommunicationKey 2002 < now disable the key it finds first for pgpca >
    =20
gpg: pgpca =FCbersprungen: =F6ffentlicher Schl=FCssel ist ab=
gpg: start.bat: encryption failed: unbrauchbarer =F6ffentlicher Sch=FCsse=
(the text says that the corresponding key is disabled and thus
encryption fails - note: this example works only in GPG installations
where the old RSA key is a feasible encryption target - however the
general problem occurs whenever there are more than one valid keys for
a given mail address and GPG chooses the "wrong" one)
Norbert Luckhardt, Editor in Chief           KES - IT-Security Journal (AT/CH/DE)
      SecuMedia Verlags-GmbH    Gaulsheimer Stra=DFe 17
      55218 Ingelheim           GERMANY
fon  +49-511/5 63 62 93    *    +49-67 25/93 04-11 (ed. assist.)
fax  +49-511/5 63 62 99    *    +49-67 25/59 94

@_date: 2002-12-18 09:09:02
@_author: Norbert Luckhardt 
@_subject: disabled keys: bug or misunderstanding (GPG 1.2.1) 
hi Tenui,
Tenui  suggested using GPGshell:
that exactly is the problem: GPG does NOT use the first _enabled_ key
(I also think it should do that), but tries to use the first key it
finds and stops with an error, when this one is disabled...
to proove clearly, I just generated two test keys:
C:\Prog\GPG>gpg -k test
pub  1024D/4FB019C0 2002-12-18 testkey 1 sub   768g/A635574E 2002-12-18 [verf=E4llt: 2003-03-18]
pub  1024D/21A2B039 2002-12-18 testkey 2 sub   768g/8DE211C0 2002-12-18 [verf=E4llt: 2003-03-18]
C:\Prog\GPG>gpg --edit-key donotuse
gpg (GnuPG) 1.2.1; Copyright (C) 2002 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
Geheimer Schl=FCssel ist vorhanden. [[secret key is available]]
pub  1024D/4FB019C0  erstellt: 2002-12-18 verf=E4llt: 2003-03-18 Vertraue=
n: u/u
sub   768g/A635574E  erstellt: 2002-12-18 verf=E4llt: 2003-03-18
(1). testkey 1 Befehl> disable
Befehl> save
C:\Prog\GPG>gpg -r donotuse -e start.bat
gpg: donotuse: =FCbersprungen: =F6ffentlicher Schl=FCssel ist abgeschalte=
gpg: start.bat: encryption failed: unbrauchbarer =F6ffentlicher Sch=FCsse=
C:\Programme\GPG>gpg -k --with-colon donotuse
pub:d:1024:17:643C190F4FB019C0:2002-12-18:2003-03-18::u:testkey 1 ::scESC:
pub:u:1024:17:59C3229621A2B039:2002-12-18:2003-03-18::u:testkey 2 ::scESC:
so You see: even though there is a valid key, GPG does NOT use it :-(
kind regards, Shalom dann,
Norbert Luckhardt, Editor in Chief           KES - IT-Security Journal (AT/CH/DE)
      SecuMedia Verlags-GmbH    Gaulsheimer Stra=DFe 17
      55218 Ingelheim           GERMANY
fon  +49-511/5 63 62 93    *    +49-67 25/93 04-11 (ed. assist.)
fax  +49-511/5 63 62 99    *    +49-67 25/59 94

@_date: 2002-12-18 09:09:16
@_author: Norbert Luckhardt 
@_subject: disabled keys: bug or misunderstanding (GPG 1.2.1) 
hi Tenui,
Tenui  suggested using GPGshell:
that exactly is the problem: GPG does NOT use the first _enabled_ key
(I also think it should do that), but tries to use the first key it
finds and stops with an error, when this one is disabled...
to proove clearly, I just generated two test keys:
C:\Prog\GPG>gpg -k test
pub  1024D/4FB019C0 2002-12-18 testkey 1 sub   768g/A635574E 2002-12-18 [verf=E4llt: 2003-03-18]
pub  1024D/21A2B039 2002-12-18 testkey 2 sub   768g/8DE211C0 2002-12-18 [verf=E4llt: 2003-03-18]
C:\Prog\GPG>gpg --edit-key donotuse
gpg (GnuPG) 1.2.1; Copyright (C) 2002 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
Geheimer Schl=FCssel ist vorhanden. [[secret key is available]]
pub  1024D/4FB019C0  erstellt: 2002-12-18 verf=E4llt: 2003-03-18 Vertraue=
n: u/u
sub   768g/A635574E  erstellt: 2002-12-18 verf=E4llt: 2003-03-18
(1). testkey 1 Befehl> disable
Befehl> save
C:\Prog\GPG>gpg -r donotuse -e start.bat
gpg: donotuse: =FCbersprungen: =F6ffentlicher Schl=FCssel ist abgeschalte=
gpg: start.bat: encryption failed: unbrauchbarer =F6ffentlicher Sch=FCsse=
C:\Programme\GPG>gpg -k --with-colon donotuse
pub:d:1024:17:643C190F4FB019C0:2002-12-18:2003-03-18::u:testkey 1 ::scESC:
pub:u:1024:17:59C3229621A2B039:2002-12-18:2003-03-18::u:testkey 2 ::scESC:
so You see: even though there is a valid key, GPG does NOT use it :-(
kind regards, Shalom dann,
Norbert Luckhardt, Editor in Chief           KES - IT-Security Journal (AT/CH/DE)
      SecuMedia Verlags-GmbH    Gaulsheimer Stra=DFe 17
      55218 Ingelheim           GERMANY
fon  +49-511/5 63 62 93    *    +49-67 25/93 04-11 (ed. assist.)
fax  +49-511/5 63 62 99    *    +49-67 25/59 94
