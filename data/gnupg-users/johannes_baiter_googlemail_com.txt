
@_date: 2012-02-08 20:57:14
@_author: Johannes Baiter 
@_subject: Problem "Kobil Kaan Advanced" keypad [gnupg 2.0.18] 
Okay, I managed to resolve that problem by specifying the
`pinpad-program` option in gpg-agent.conf. I can enter the PIN now and
it is recognized ("Good PIN"-beep and the pin retry counter is not
decremented afterwards). However, the file is not decrypted and
scdaemon throws this (debug log):
2012-02-08 20:49:11 scdaemon[28024] DBG: prompting for keypad entry
'||Please enter the PIN'
scdaemon[28024]: chan_7 -> INQUIRE POPUPKEYPADPROMPT ||Please enter the PIN
scdaemon[28024]: chan_7 <- END
2012-02-08 20:49:12 scdaemon[28024] DBG: send apdu: c=00 i=20 p1=00
p2=82 lc=0 le=-1 em=0
2012-02-08 20:49:12 scdaemon[28024] DBG:  raw apdu: 00 20 00 82 00
2012-02-08 20:49:26 scdaemon[28024] DBG:  response: sw=9000  datalen=0
2012-02-08 20:49:26 scdaemon[28024] DBG:     dump:
2012-02-08 20:49:26 scdaemon[28024] DBG: dismiss keypad entry prompt
scdaemon[28024]: chan_7 -> INQUIRE DISMISSKEYPADPROMPT
scdaemon[28024]: chan_7 <- END
2012-02-08 20:49:26 scdaemon[28024] DBG: send apdu: c=00 i=2A p1=80
p2=86 lc=257 le=2048 em=1
2012-02-08 20:49:26 scdaemon[28024] DBG:  raw apdu: 2012-02-08 20:49:26 scdaemon[28024] ccid_transceive failed: (0x10002)
2012-02-08 20:49:26 scdaemon[28024] apdu_send_simple(0) failed: invalid value
2012-02-08 20:49:26 scdaemon[28024] operation decipher result: Invalid value
2012-02-08 20:49:26 scdaemon[28024] app_decipher failed: Invalid value
Google-Fu did not yield anything for that specifiy error code :-/
2012/2/8 Johannes Baiter :

@_date: 2012-02-08 20:16:44
@_author: Johannes Baiter 
@_subject: Problem "Kobil Kaan Advanced" keypad [gnupg 2.0.18] 
I recently acquired a "Kobil Kaan Advanced" reader and am trying to
use it under Debian (unstable).
I have it working now up to the point where I can query the card
status, i.e. the reader works and the card is recognized correctly.
However, it seems that the built-in keypad of my reader does not work,
although according to the howto [1] it should do so:
$ gpg2 -d foo.txt.gpg
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: updating slot 0 status: 0x0000->0x0007 (0->1)
scdaemon[21350]: fingerprint on card does not match requested one
scdaemon[21350]: app_decipher failed: Wrong secret key used
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: DBG: prompting for keypad entry '||Please enter the PIN'
gpg-agent[21349]: can't connect to the PIN entry module: IPC connect call failed
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: PIN callback returned error: Unexpected IPC command
scdaemon[21350]: app_decipher failed: Unexpected IPC command
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: fingerprint on card does not match requested one
scdaemon[21350]: app_decipher failed: Wrong secret key used
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: DBG: prompting for keypad entry '||Please enter the PIN'
gpg-agent[21349]: can't connect to the PIN entry module: IPC connect call failed
gpg: anonymous recipient; trying secret key  ...
scdaemon[21350]: PIN callback returned error: Unexpected IPC command
scdaemon[21350]: app_decipher failed: Unexpected IPC command
gpg: encrypted with RSA key, ID 00000000
gpg: encrypted with RSA key, ID 00000000
gpg: decryption failed: No secret key
[1]
