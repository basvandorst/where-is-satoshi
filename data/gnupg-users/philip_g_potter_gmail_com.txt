
@_date: 2013-04-01 10:53:02
@_author: Philip Potter 
@_subject: Why does gpg use so much entropy from /dev/random? 
Thanks very much, I didn't know about the --gen-random command and the
quality level option. I'll have a look at the source code and see if I can
understand further.
Can you set the quality level for other generation commands, or just for

@_date: 2013-04-01 11:16:28
@_author: Philip Potter 
@_subject: Why does gpg use so much entropy from /dev/random? 
Having done a little digging, I think I can shed a little light on
this. From libgcrypt/src/gcrypt.h.in:
   to use STRONG for session keys and VERY_STRONG for key material.
   WEAK is usually an alias for STRONG and should not be used anymore
   (except with gcry_mpi_randomize); use gcry_create_nonce instead. */
typedef enum gcry_random_level
  {
    GCRY_WEAK_RANDOM = 0,
    GCRY_STRONG_RANDOM = 1,
    GCRY_VERY_STRONG_RANDOM = 2
  }
The levels provided to --gen-random correspond to the values of this
enum.  As the comment indicates, for most purposes level 0 and 1 do
the same thing.

@_date: 2013-04-05 17:25:02
@_author: Philip Potter 
@_subject: Why does gpg use so much entropy from /dev/random? 
Hi Werner,
Thanks very much for your response. I think I'll take some time to digest it :)

@_date: 2013-03-31 10:45:54
@_author: Philip Potter 
@_subject: Why does gpg use so much entropy from /dev/random? 
This is related to another current thread, but I think this deserves its
GPG uses /dev/random as its entropy source. It pulls a lot of entropy from
this source. More entropy, in fact, than the linux /dev/random manpage
suggests it should. Quoting from the manpage:
"While some safety margin above that minimum is reasonable, as a guard
against flaws in the CPRNG algorithm, no cryptographic primitive available
today can hope to promise more than 256 bits of security, so if any program
reads more than 256 bits (32 bytes) from the kernel random pool per
invocation, or per reasonable reseed interval (not less than one minute),
that should be taken as a sign that its cryptography is not skilfully
Recently when generating a 2048-bit key, I got a message that GPG needed
280 *bytes* more entropy. This is far more than 256 bits.
I am not an expert in cryptography, so I am in no position to pass
judgement on GPG or on /dev/random; however, it seems to me that GPG's
implementation disagrees with /dev/random's manpage.
Can anyone shed any light on this? Why does GPG use more entropy than
(I've written down these thoughts in more detail at
 -- sadly,
this link will expire in a month when posterous shuts down)
