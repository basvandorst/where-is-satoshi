
@_date: 2002-08-27 16:14:02
@_author: Eberhard Burkard 
@_subject: GPGME - Solaris 7 - Segmentation Fault :-( 
Today i have updated to GPG 1.07 and GPGME 0.39 and i got a problem. GPG is working but when i compile GPGME an do "make check" 13 of 14 test
fail with a segmentation fault.
... /bin/ksh: 1344 Segmentation Fault
FAIL: t-encrypt-sign
FAIL: t-sign
FAIL: t-signers
FAIL: t-decrypt
checking a valid message:
My system is a SPARCstation 10 with Solaris 7 and i use gcc 2.95.2.
Is somebody out who can help me?

@_date: 2002-08-28 11:22:02
@_author: Eberhard Burkard 
@_subject: GPGME - Solaris 7 - Segmentation Fault :-( 
Sorry, but i found no logs in .../gpgme-0.3.9/tests and in the subdirs :-/
Wehn i do a "srcdir=. show_cmds=. ./t-sign" i get this:
ikffws8 srcdir=. show_cmds=. ./t-sign
Segmentation Fault
When i start .../gpgme-0.3.9/tests/gpg/.libs/t-sign inside the gdb i get
(gdb) run
Starting program:
Program received signal SIGSEGV, Segmentation fault.
0xef6b6f54 in strlen () from /usr/lib/libc.so.1
(gdb) bt
  0xef6b6f54 in strlen () from /usr/lib/libc.so.1
  0xef701900 in _doprnt () from /usr/lib/libc.so.1
  0xef7039d0 in vsprintf () from /usr/lib/libc.so.1
  0xef7859bc in int_vasprintf (result=0xefffe790, format=0xef787a10
     args=0xefffe70c) at vasprintf.c:121
  0xef785ab0 in vasprintf (result=0xefffe790, format=0xef787a10 "%s%s",     args=0xefffe77c) at vasprintf.c:136
  0xef785adc in asprintf (buf=0xefffe790, fmt=0xef787a10 "%s%s") at
 6  0xef784908 in _gpgme_debug_add (line=0xefffe81c,
 "%s%s")
    at debug.c:189
  0xef78428c in _gpgme_io_select (fds=0x23ab8, nfds=10, nonblock=1488)
    at posix-io.c:325
  0xef778088 in do_select (fdt=0x21840) at wait.c:155
  0xef7784c8 in _gpgme_wait_on_condition (ctx=0x217b8, cond=0x0) at
 10 0xef778468 in _gpgme_wait_one (ctx=0x217b8) at wait.c:279
 0xef77ac4c in gpgme_op_sign (ctx=0x217b8, in=0x21870, out=0x218a8,     mode=GPGME_SIG_MODE_NORMAL) at sign.c:259
 0x10fbc in main (argc=1, argv=0xefffebdc) at t-sign.c:109
I have tried to use GPGME with the sylpeehd mail program and when i try to
sign a mail sylpheed crashs with a Segmentation Fault. I started sylpheed
inside gdb and here is the bt from the crash:
(gdb) run
Starting program: /local/scratch/burkard/sylpheed-0.8.2/src/sylpheed Program received signal SIGSEGV, Segmentation fault.
0xef1f6f54 in strlen () from /usr/lib/libc.so.1
(gdb) bt
  0xef1f6f54 in strlen () from /usr/lib/libc.so.1
  0xef241900 in _doprnt () from /usr/lib/libc.so.1
  0xef2439d0 in vsprintf () from /usr/lib/libc.so.1
  0xef2a59bc in int_vasprintf (result=0xefffac98, format=0xef2a7a10
     args=0xefffac14) at vasprintf.c:121
  0xef2a5ab0 in vasprintf (result=0xefffac98, format=0xef2a7a10 "%s%s",     args=0xefffac84) at vasprintf.c:136
  0xef2a5adc in asprintf (buf=0xefffac98, fmt=0xef2a7a10 "%s%s")
    at vasprintf.c:147
  0xef2a4908 in _gpgme_debug_add (line=0xefffad24, format=0xef2a7a10
    at debug.c:189
  0xef2a428c in _gpgme_io_select (fds=0x2a06d8, nfds=10, nonblock=1488)
    at posix-io.c:325
  0xef298088 in do_select (fdt=0x29d598) at wait.c:155
  0xef2984c8 in _gpgme_wait_on_condition (ctx=0x29d510, cond=0x0) at
 10 0xef298468 in _gpgme_wait_one (ctx=0x29d510) at wait.c:279
 0xef29ac4c in gpgme_op_sign (ctx=0x29d510, in=0x29ae80, out=0x29d5c8,     mode=GPGME_SIG_MODE_DETACH) at sign.c:259
 0xdff08 in pgp_sign (plain=0x29ae80, key_list=0x0, clearsign=0,     r_siginfo=0xefffb0ec) at rfc2015.c:975
 0xe0488 in rfc2015_sign (
    file=0xefffd248 "/home/ikff2/burkard/.sylpheed/tmp/tmpmsg.0027adf0",     key_list=0x0) at rfc2015.c:1145
I hope this infos ar helpful
Greetings from Stuttgart

@_date: 2002-09-10 15:23:02
@_author: Eberhard Burkard 
@_subject: GPGME - Solaris 7 - Segmentation Fault :-( 
References: <20020827161523.4f7844e1.burkard
On Tue, 27 Aug 2002 16:15:23 +0200
Today i found this on the sylpheed mailinglist:
With this hint GPGME 0.3.9 works with only one failed check. The t-keylist check fails. Here is the output from gdb:
ikffws8 81% !!
gdb ./t-keylist
GNU gdb 4.18
(gdb) run
Starting program:
** pattern=`
Program received signal SIGSEGV, Segmentation fault.
0xef6b6f54 in strlen () from /usr/lib/libc.so.1
(gdb) bt
  0xef6b6f54 in strlen () from /usr/lib/libc.so.1
  0xef701900 in _doprnt () from /usr/lib/libc.so.1
  0xef70334c in fprintf () from /usr/lib/libc.so.1
  0x111d0 in main (argc=0, argv=0xefffebd0) at t-keylist.c:150
(gdb) next
Single stepping until exit from function strlen, which has no line number information.
Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) quit
The hint from Frederik does not work with GPGME 0.3.10. make check sleeps
after the line "PASS: t-encrypt".
