
@_date: 2017-12-11 02:13:39
@_author: Marcin Krzyzanowski 
@_subject: onepass_sig without corresponding signagure packet 
The Enigmail is able to produce encrypted and signed message that is of this format:
# off=0 ctb=85 tag=1 hlen=3 plen=268
:pubkey enc packet: version 3, algo 1, keyid 99DC3902ACFB3F2D
data: [2048 bits]
# off=271 ctb=85 tag=1 hlen=3 plen=268
:pubkey enc packet: version 3, algo 1, keyid A93E9DF0C89796BC
data: [2046 bits]
# off=542 ctb=d2 tag=18 hlen=2 plen=0 partial new-ctb
:encrypted data packet:
length: unknown
mdc_method: 2
# off=563 ctb=a3 tag=8 hlen=1 plen=0 indeterminate
:compressed packet: algo=2
# off=565 ctb=90 tag=4 hlen=2 plen=13
:onepass_sig packet: keyid 4CAB945543809C83
version 3, sigclass 0x01, digest 8, pubkey 1, last=1
# off=580 ctb=cb tag=11 hlen=2 plen=0 partial new-ctb
:literal data packet:
mode t (74), created 1512950823, name="",
raw data: unknown length
I?m not able to create this format by hand. What I?m curious about is missing signature packet after the literal packet. Whenever I try to encrypt and sign, there is onepass_sig and and signature packet at the end (as expected)
gpg validate this message as valid. gpg ?decrypt
gpg: Signature made Mon Dec 11 01:07:03 2017 CET
gpg: using RSA key ADFB5525AC0262620BBED93C4CAB945543809C83
gpg: Good signature from "BobEnzevalos " [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg: There is no indication that the signature belongs to the owner.
Primary key fingerprint: ADFB 5525 AC02 6262 0BBE D93C 4CAB 9455 4380 9C83
my question is? where is this signature from? why this is a valid message?
Thank you in advance.
