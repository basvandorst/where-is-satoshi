
@_date: 2007-04-18 18:21:25
@_author: Jules Colding 
@_subject: gpgme_set_passphrase_cb() not working 
I've written a small keyring utility(*) to store passwords and such. It
is using gpgme to interface with gnupg and works wonderfully on Gentoo
and Fedora. However, on OpenSUSE 10.2 it doesn't. The problem is that
gpgme_set_passphrase_cb() doesn't have any effect on that platform.
I'm seeing pinentry-gtk-2 prompting me for a passphrase no matter what I
do. This naturally leads to my keyring not working as the gpgme
framework can't get the correct passphrase.
Is there anything I can do to force gpgme to use the callback that I
provides in gpgme_set_passphrase_cb() or is this something that has been
hard coded into gnupg on OpenSUSE?
Thanks a lot in advance,
  jules
(*) Full source is here:
Look in  for the
keyring source. A small test program is in <../keyring-test/>.

@_date: 2007-04-20 14:22:58
@_author: Jules Colding 
@_subject: pinentry - Impossible to disable/ignore if present? 
I find that pinentry unconditionally is being launched whenever I
attempt to encrypt or decrypt something using gpgme. I've checked that the callback function is being set correctly using a
combination of gpgme_set_passphrase_cb() and gpgme_get_passphrase_cb().
Unfortunately this is totally ignored by the underlying GnuPG framework
and pinentry is unconditionally launched to query for a passphrase. My
private passphrase callback function is never invoked.
Any ideas?
  jules

@_date: 2007-04-20 15:34:48
@_author: Jules Colding 
@_subject: pinentry - Impossible to disable/ignore if present? 
So even if I prevent pinentry to show up it will eventually be
impossible for me to provide my own callback function?
Will this also hold true if I use libgcrypt instead?
  jules

@_date: 2007-04-20 18:25:56
@_author: Jules Colding 
@_subject: pinentry - Impossible to disable/ignore if present? 
OK, a little background information is in order here I think :-)
I've created a little utility daemon(*) implementing a small and very
simple keyring. The idea is that the keyring is given a master
passphrase to unlock it's content and to encrypt new content. The
content of the keyring is generally passwords.
I'm using gpgme for the encryption and decryption of those passwords.
I've therefore implemented a daemon that holds the master passphrase and
hands it over to the gpgme framework by the use of the passphrase
callback function gpgme_set_passphrase_cb().
Having pinentry pop up whenever my callback function should be invoked
will therefore prevent the correct passphrase from being handed over to
gpgme. I'm using my own little gtk+ dialog to query the master
passphrase and content passwords from the user. Maybe I could do this differently but I really want the passphrase
dialog to look exactly like the one being used by Evolution so using
pinentry-gtk-2 is sub-optimal.
Any ideas on how I can:
1) make gpgme use my own callback passphrase function or,
2) make gpgme always use pinentry but using a custom dialog title and
question text
?? Looks like I need to use it if I can't prevent gpgme from launching
pinentry. The drawback is a lack of sample code using libgcrypt. Any
samples out there doing encryption from a small memory buffer to a file
and decrypting the other way?
Thanks a lot in advance,
  jules
(*) Full source is here:
Look in  for the
keyring source. A small test program is in <../keyring-test/>.

@_date: 2007-04-23 15:49:48
@_author: Jules Colding 
@_subject: libgcrypt: Length of IV 
Should the IV be of the same length as the key for a given symmetric
cipher or can it have any length?
  jules

@_date: 2007-04-24 12:14:09
@_author: Jules Colding 
@_subject: Another trivial question: gcry_cipher_encrypt() (plaintext length) 
Once more I'm demonstrating my utter lack of knowledge in all matters
related to cryptography. Please forgive these trivial questions.
I'm trying to use gcry_cipher_encrypt(). I've set the cipher mode to
GCRY_CIPHER_MODE_CFB(*) and the algorithm is GCRY_CIPHER_AES256.
My problem is that the size of the plaintext data is unknown to me as I
have to use gcry_cipher_encrypt() for arbitrary plaintext data.
The manual for libgcrypt says that the size of the input data has to be
a multiple of the block size of the cipher algorithm. So what I'm really asking about is whether there is a standard way of
padding the input data to achieve the required size? How do I
remove/recognize the padding when decrypting?
Thanks a lot in advance,
  jules
(*) Is that mode a wise choice?
