
@_date: 2003-12-01 04:32:21
@_author: Peter Palfrader 
@_subject: subkeys and key flags 
This was only recently added to GnuPG?  I added subkeys to 94C09C7F in
July (1.2.2 was in unstable at the time I think) but pgpdump does not
show key flags.
Will GnuPG recoginze and handle the second signature correctly?  Do you
know whether PGP, Hushmail, etc will do so?

@_date: 2003-12-01 18:21:58
@_author: Peter Palfrader 
@_subject: How to use a revocation certificate? 
Import it into your keyring using "gpg --import rev.cert" and then send
your (now revoked) key to the keyservers
"gpg --keyserver subkeys.pgp.net --send "

@_date: 2003-12-13 02:29:30
@_author: Peter Palfrader 
@_subject: feature request: allowing display of session key used for 
JFTR, AIUI --throw-keyid still does not clean the message of all traces.
At least the size of the asymmetric encrypted data would still be
visible to everybody having access to the ciphertext, which enables them
to possibly draw conclusions on the size of the modulus.  Even if the
key is not made public by sending it to keyservers, it would still allow
some kind of linkability.
In short:  don't rely on --throw-keyid to protect your anonymity.

@_date: 2003-11-30 18:33:52
@_author: Peter Palfrader 
@_subject: subkeys and key flags 
I noticed that GnuPG used to sign other keys using subkeys, at least
with ElGamal sign and encrypt subkeys[1].
What semantics does a lack of key flags[2] have?  Does it mean that the
(sub)key is good for all purposes, including certifying other keys?
If yes, how do I create a signing subkey that only may be used to sign
data/communications?  Is it possible to ammend the keyflags by adding a
new self signature to a subkey?  (I suppose so, if yes, how do I do it?)
Am I correct when thinking that a subkey that may be used to certify
other keys may not be used to sign subkeys?  iow: is the primary key the
only one that can bind subkeys to the primary key?
Looking forward to your answers,
 1: for instance 2F6DD073 signed 94C09C7F.
 2: RFC2440: 5.2.3.20

@_date: 2004-03-06 14:46:35
@_author: Peter Palfrader 
@_subject: subkeys.pgp.net (and keyserver.bu.edu) 
Roman Pavlik said on Feb 29 on keyserver-folk that he upgraded his
keyserver and now all three supported fetching keys by subkeyids.
David asked about the criteria for inclusion in subkeys.pgp.net in
the message which had started that thread on keyserver-folk.
Roman suggested to simply ask the whois contact to add a keyserver to
the rotation.  Thomas Sj?gren apparently asked for keys.se.linux.org to
be included, and I did the same for keyserver.noreply.org.
Yaron said in private email yesterday, that keyserver.bu.edu is not
under his direct administrative control and that he suspects it got
rebooted.  He promised to take a look at it.

@_date: 2005-12-01 15:55:40
@_author: Peter Palfrader 
@_subject: --openpgp, MDC and similar flags 
GnuPG is staying up to date with the changes that have been proposed
after RFC2440 was released.  The IETF OpenPGP working group is now in
its last steps to release a new internet draft, the current snapshot of
their work is 2440bis-15.
MDC and back signatures (0x19) are specified there.

@_date: 2005-07-20 17:04:13
@_author: Peter Palfrader 
@_subject: no-ask-cert-expire during sign-key 
gpg (1.4.1) always asks whether UID certifications should expire on the
same day as the primary key:
I always answer no to this question.
Is it possible to change the behaviour of --no-ask-cert-expire to also
apply to this case?  At least the manpage suggests that it already should do
just that:

@_date: 2005-07-21 19:59:20
@_author: Peter Palfrader 
@_subject: same key: pgp 2.6 version and gpg version: keyserver 
It's still the same public key.
[Tho really you should create a new version 4 key.  Version 3 (old pgp
2.6 keys) are obsolete and support for them may eventually go away (the
sooner the better)]

@_date: 2005-09-27 18:25:59
@_author: Peter Palfrader 
@_subject: UbuntuLinux GPG Still Doesn't Work With Remailers 
That's what I meant.  Must have happened while copying various snippets
from various lines of the code :)

@_date: 2006-04-05 10:02:34
@_author: Peter Palfrader 
@_subject: dns cert support 
It seems it considers whitespace part of the fpr when creating IPGP
For instance:
                                     ^^
                                     ^^
It should just ignore whitespace when counting fingerprint length.
This should fix it:
Index: make-dns-cert.c
--- make-dns-cert.c	(revision 4091)
+++ make-dns-cert.c	(working copy)
 -24,6 +24,7   HAVE_GETOPT_H
   +        -97,7 +98,20    if(fpr)
     {
-      fprlen=strlen(fpr);
+      const char *tmp = fpr;
+      while (*tmp)
+	{
+	  if (isxdigit(*tmp))
+	    {
+	      fprlen++;
+	    }
+	  else if (!isspace(*tmp))
+	    {
+	      printf("Fingerprint must consist of only hex digits (and whitespace)\n");
+	      return 1;
+	    }
+	  tmp++;
+	}
       if(fprlen%2)
 	{
 	  printf("Fingerprint must be an even number of characters\n");
And a second patch that uses stderr for errors on top of this one:
--- make-dns-cert.c.orig	2006-04-05 09:57:48.725050937 +0200
+++ make-dns-cert.c	2006-04-05 10:00:23.675749478 +0200
 -45,20 +45,20    fd=open(keyfile,O_RDONLY);
   if(fd==-1)
     {
-      printf("Cannot open key file %s: %s\n",keyfile,strerror(errno));
+      fprintf(stderr, "Cannot open key file %s: %s\n",keyfile,strerror(errno));
       return 1;
     }
   err=fstat(fd,&statbuf);
   if(err==-1)
     {
-      printf("Unable to stat key file %s: %s\n",keyfile,strerror(errno));
+      fprintf(stderr, "Unable to stat key file %s: %s\n",keyfile,strerror(errno));
       goto fail;
     }
   if(statbuf.st_size>32768)
     {
-      printf("Key %s too large for CERT encoding\n",keyfile);
+      fprintf(stderr, "Key %s too large for CERT encoding\n",keyfile);
       goto fail;
     }
 -73,7 +73,7        err=read(fd,buffer,1024);
       if(err==-1)
 	{
-	  printf("Unable to read key file %s: %s\n",keyfile,strerror(errno));
+	  fprintf(stderr, "Unable to read key file %s: %s\n",keyfile,strerror(errno));
 	  goto fail;
 	}
 -107,14 +107,14  	    }
 	  else if (!isspace(*tmp))
 	    {
-	      printf("Fingerprint must consist of only hex digits (and whitespace)\n");
+	      fprintf(stderr, "Fingerprint must consist of only hex digits (and whitespace)\n");
 	      return 1;
 	    }
 	  tmp++;
 	}
       if(fprlen%2)
 	{
-	  printf("Fingerprint must be an even number of characters\n");
+	  fprintf(stderr, "Fingerprint must be an even number of characters\n");
 	  return 1;
 	}
 -127,7 +127,7    if(!fpr && !url)
     {
-      printf("Cannot generate a CERT without either a fingerprint or URL\n");
+      fprintf(stderr, "Cannot generate a CERT without either a fingerprint or URL\n");
       return 1;
     }
 -150,13 +150,13  }
 static void
+usage(FILE *f)
 {
-  printf("make-dns-cert\n");
-  printf("\t-f\tfingerprint\n");
-  printf("\t-u\tURL\n");
-  printf("\t-k\tkey file\n");
-  printf("\t-n\tDNS name\n");
+  fprintf(f, "make-dns-cert\n");
+  fprintf(f, "\t-f\tfingerprint\n");
+  fprintf(f, "\t-u\tURL\n");
+  fprintf(f, "\t-k\tkey file\n");
+  fprintf(f, "\t-n\tDNS name\n");
 }
 int
 -167,7 +167,7    if(argc==1)
     {
-      usage();
+      usage(stderr);
       return 0;
     }
   else if(argc>1 && strcmp(argv[1],"--version")==0)
 -177,7 +177,7      }
   else if(argc>1 && strcmp(argv[1],"--help")==0)
     {
-      usage();
+      usage(stdout);
       return 0;
     }
 -186,7 +186,7        {
       default:
       case 'h':
-	usage();
+	usage(stdout);
 	exit(0);
       case 'f':
 -208,14 +208,14    if(!name)
     {
-      printf("No name provided\n");
+      fprintf(stderr, "No name provided\n");
       return 1;
     }
   if(keyfile && (fpr || url))
     {
-      printf("Cannot generate a CERT record with both a keyfile and"
-	     " a fingerprint or URL\n");
+      fprintf(stderr, "Cannot generate a CERT record with both a"
+	              " keyfile and a fingerprint or URL\n");
       return 1;
     }

@_date: 2006-04-05 12:05:08
@_author: Peter Palfrader 
@_subject: dns cert support 
Index: make-dns-cert.c
--- make-dns-cert.c	(revision 4091)
+++ make-dns-cert.c	(working copy)
 -97,7 +97,22    if(fpr)
     {
-      fprlen=strlen(fpr);
+      const char *tmp = fpr;
+      while (*tmp)
+	{
+	  if ((*tmp >= 'A' && *tmp <= 'F') ||
+	      (*tmp >= 'a' && *tmp <= 'f') ||
+	      (*tmp >= '0' && *tmp <= '9'))
+	    {
+	      fprlen++;
+	    }
+	  else if (*tmp != ' ' && *tmp != '\t')
+	    {
+	      printf("Fingerprint must consist of only hex digits (and whitespace)\n");
+	      return 1;
+	    }
+	  tmp++;
+	}
       if(fprlen%2)
 	{
 	  printf("Fingerprint must be an even number of characters\n");

@_date: 2006-04-05 12:30:05
@_author: Peter Palfrader 
@_subject: dns cert support 
I notice that if I have both, a IPGP and a PGP CERT RR that GnuPG fails
to import the key some of the time:
} ;; ANSWER SECTION:
} peter.palfrader.org.    43200   IN      CERT    6 0 0 FFsAyW1dVK7hIGuvhN56r26UwJx/
} peter.palfrader.org.    43200   IN      CERT    PGP 0 0 mQGiBDgp0YcRBACN9s8EycXRsu9ym3Sjou1N.....
Is having them both not supported or is there a bug somewhere?

@_date: 2006-04-05 15:17:44
@_author: Peter Palfrader 
@_subject: dns cert support 
On the other hand the key that is fetched via DNS has serious size
constraints - DNS limits the RDATA to 64k and I think GnuPG further
limits this to 16k.  In my case I have significantly stripped down my
key in order to store it in DNS, so maybe going to the keyserver or the
location specified in IPGP might be a good idea.
Ah, now that I do it works nicely.  Thanks!  Maybe gpg should say that
it wants to have a keyserver in this case?

@_date: 2006-04-07 17:52:50
@_author: Peter Palfrader 
@_subject: fetching DE415B0E from sks ([don't know]: invalid packet 
I don't believe it's a feature - yet :)
I think a --refresh should always try to refresh all keys.  As it is in
this case - with a key with "evil" packets on the keyserver - I'm stuck
in a situation where "gpg --refresh-keys" only updates half of my
I can see a point in aborting in the case of gpg --recv, but it's
confusing that it starts fetching keys starting with the last.  Maybe
that could be turned around.

@_date: 2006-03-08 01:18:16
@_author: Peter Palfrader 
@_subject: add notation to self sig 
I wanted to add a notation to my self sig on my key by giving
--cert-notation on the command line and then updating the cipher
preferences (as a nice way to generate a new self sig):
However, the resulting new self sig does not have the cert notation set.
Can anybody tell me what the procedure is to issue a new self sig with
cert notations?
[Running svn head of gnupg14 as of now.]

@_date: 2006-03-08 20:32:07
@_author: Peter Palfrader 
@_subject: add notation to self sig 
Thanks, that seems to work (as does --expert and sign).
Something related.  Is --with-colons supposed to show me notation informations?
weasel gpg --no-options --list-options show-notation --list-sigs
pub   1024D/94C09C7F 1999-11-10
uid                  Peter Palfrader
sig 3        94C09C7F 2000-02-29  Peter Palfrader
sig 3    N   94C09C7F 2006-03-08  Peter Palfrader
   Signature notation: preferred-email-encoding
weasel gpg --no-options --list-options show-notation --with-colons --list-sigs
pub:-:1024:17:DE7AAF6E94C09C7F:1999-11-10:::-:Peter Palfrader::scaSCA:
sig:::17:DE7AAF6E94C09C7F:2000-02-29::::Peter Palfrader:13x:
sig:::17:DE7AAF6E94C09C7F:2006-03-08::::Peter Palfrader:13x:

@_date: 2006-03-09 14:40:04
@_author: Peter Palfrader 
@_subject: add notation to self sig 
Great, thanks.  Adding notations and removing all of them works just
According to the manual page, setting an empty value should remove a
[just doing 'notation foo is not allowed.]
it seems that this part doesn't work.
Also, is issuing a notation again with the same key supposed to replace
an existing notation, or should it - as it does now - add a second
notation with the same key?

@_date: 2006-03-09 22:52:09
@_author: Peter Palfrader 
@_subject: add notation to self sig 
Thanks, this looks very good now.  I don't think the fact that one
cannot add notation keys that start with a dash will be very relevant
in practice.
