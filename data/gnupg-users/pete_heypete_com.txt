
@_date: 2013-04-13 13:04:31
@_author: Pete Stephenson 
@_subject: Using smartcard as RNG 
Hi all,
I did some searching in the archives but wasn't able to see if someone
else asked this question before. If it's been discussed before and I
missed it then I apologize in advance for the weakness of my search-fu
and would appreciate it if someone might point me in the right direction.
That said, I was curious if it is possible for GPG to use the hardware
RNG in an OpenPGP smartcard (either the GnuPG-branded one sold by Kernel
Concepts or ones like the GPF Crypto Stick) as an entropy source for
non-card-based operations.
For example, if I were to generate a long-term OpenPGP key (not
generated on the card) I'd like to ensure that the system has a high
degree of entropy. I currently use a Simtec Entropy Key[1] for creating
entropy for otherwise entropy-starved systems (mostly low-activity VMs)
and this works well[2], but it'd be nice to also add in entropy from the
smartcard hardware RNG as well.
While it might be nice to use the smartcard's HRNG to feed /dev/random,
I'm mostly interested in using it as an entropy source for key
generation or other entropy-dependent functions if the card is inserted
and available.
Is this possible?
[1]  [3]
[2] It generates entropy using two hardware generators, does a series of
tests on them, and assuming they pass the tests, feeds them to a daemon
that feeds into a *nix system's entropy pool. One can then access the
entropy through normal methods, such as by accessing /dev/random.
[3] ObDisclaimer: I have no connection or relationship with the company.
I'm merely a customer who owns the device they sell.

@_date: 2013-04-15 18:08:53
@_author: Pete Stephenson 
@_subject: Backing up Private Keys 
You're the one who defines "acceptable practice" for you. :)
Although I use a smartcard for my day-to-day signing I have backups of
the secret key and subkeys on CD-R and paper in separate
physically-secured locations.
I have copies of both the Paperkey version of my private key and the
ASCII-armored private key block itself.
I realize that typing errors are inevitable, particularly when manually
entering in long strings of seemingly-random text (the Paperkey output
for my 4096-bit private key is 124 lines long while the ASCII-armored
version is 108 lines long). I ran into a few errors using OCR and it was
a hassle to find out which characters it mis-read, so I just ended up
generating a QR code for each line of the Paperkey output and,
separately, a QR code for each line of the ASCII-armored key block.
As a test, I then imported the keyblock using my computer's webcam to
read the QR codes. While somewhat tedious, it was far easier than typing
everything in. Both the Paperkey and ASCII keyblock were reconstructed
without errors.
I'm sure there's a more efficient way of doing things, like creating a
series of linear barcodes that can be read line-by-line with a laser
barcode scanner or by simply scanning it using a flatbed scanner, but
the QR codes work reasonably well for me.

@_date: 2013-04-17 19:09:51
@_author: Pete Stephenson 
@_subject: Privacy concerns 
I've had keys on the keyservers for years. Any spam related to
harvesting key data is negligible compared to spam from other sources.
Regardless of source, it gets filtered out so it's no worries to me.
While I don't use OpenPGP at my work, it seems reasonable to me to
create separate primary keys for work and personal use.
In the US at least, companies have various regulatory requirements
relating to communications and message storage. It may be compulsory for
a company to have the ability to decrypt, read, and archive your
work-related mail. Since you cannot -- as far as I know -- bind
encryption subkeys to a specific UID, having a separate primary key for
your work seems like a good idea.

@_date: 2013-04-21 21:52:28
@_author: Pete Stephenson 
@_subject: GnuPG with ECC support (on windows) 
On a related note, Sascha's message reminded me of something: is there
any word on when the OpenPGP+ECC standard (RFC 6637) is going to be
I, for one, am really interested in ECC as it'd allow for stronger
security without outrageously-large RSA keys. I'd hate to go through all
the trouble of getting a new 4096-bit RSA key signed and in the WoT only
to have ECC support come out immediately after so I'd have to start
over. :-D

@_date: 2013-04-22 10:01:09
@_author: Pete Stephenson 
@_subject: GnuPG with ECC support (on windows) 
My apologies: I guess I don't know the terminology as well as I'd like. :)
My understanding is that the RFC is on the "standards track" but is not
yet officially approved as a standard. Any idea when that might happen?

@_date: 2013-04-26 12:51:35
@_author: Pete Stephenson 
@_subject: Confusion with signature digest type. 
Indeed. SHA-1 is used pretty much everywhere. If preimage attacks for
SHA-1 become practical a *lot* of stuff will be affected.
That said, it certainly isn't a bad idea to being gracefully
transitioning away from SHA-1.
For existing keys it's probably not a major issue (there's still a *ton*
of 1024-bit DSA keys with SHA-1 in the wild), but it'd probably make
sense for new keys to be generated with stronger defaults (e.g. SHA-256
or higher and, once implemented, SHA-3) and to also use those stronger
hash algorithms for things like certifying keys.

@_date: 2013-08-25 10:28:47
@_author: Pete Stephenson 
@_subject: Why trust gpg4win? 
It depends. For the average user not under any specific attack?
Probably not so serious. Even using PGP/GPG in the normal,
private-key-on-online-computer mode is almost certainly better than
not using it at all though one would need to be careful, just as one
would need to be careful with any sensitive communication.
For larger organizations or governments who may be under attack by
various adversaries? Probably more serious: look at Iran and Stuxnet
for an example of air-gap hopping malware that caused bad things to
happen (though not PGP-related).
The easiest and least-expensive solution to this situation is using
smartcards:  -- the private key is kept
securely on the smartcard. Any private-key operations (i.e. signing or
decrypting) are handled on-card and the private key is not accessible
to the computer. You could, of course, generate the key on an offline
computer and then transfer it to the smartcard and keep an offline
backup (that's what I do) rather than having the key generated
entirely on-card with no backup (which is an option).

@_date: 2013-08-25 14:23:20
@_author: Pete Stephenson 
@_subject: Why trust gpg4win? 
Hi Laurent,
Yes, that's true. In my case, I use smartcards to prevent my private
keys from being compromised during my normal, day-to-day use of my
online computer.
In my case, the private keys were generated offline and then
transferred to the card and to offline backups. If someone is going to
physically break into my apartment to compromise my private keys then
I have some pretty major problems. In such a situation, I could easily
revoke the keys. Personally, I'm more concerned about the smartcard
breaking in some way over the years and thus leaving me unable to
decrypt or sign messages, so I prefer to have backups. Your mileage
may vary. :)
If you or your organization have a requirement that there be a strict
one-key-per-person policy with no backups, then you can of course
generate the keys on the card.

@_date: 2013-08-31 21:52:30
@_author: Pete Stephenson 
@_subject: Recommended key size for life long key 
According to the keylength.com site that Ole linked to, discrete
logarithm keys (i.e. those using DSA) are essentially equivalent to
RSA keys in terms of strength. That is, a 2048-bit DSA key is
essentially the same as a 2048-bit RSA key.
That said, the FAQ does appear to be out of date: the default these
days is 2048-bit RSA keys. If one were to generate a new key today,
1024-bit DSA or RSA is a bit short. For most purposes, it probably
wouldn't hurt to generate >= 2048-bit keys as this would likely be
secure for the reasonable future. 3072-bit DSA/4096-bit RSA would be
good for a bit longer, barring any major advances in cryptanalysis --
it's unlikely that an adversary is going to try breaking the crypto
when there's so many other, more feasible means of eavesdropping (e.g.
putting malware on one's computer).
Hopefully GPG supports ECC keys in the near future: 521-bit ECC keys
would offer 256 bits of security while being considerably more
manageable than massive 10k+ RSA keys.

@_date: 2013-07-14 12:08:27
@_author: Pete Stephenson 
@_subject: searching for keys 
Did you follow the referral and query whois.publicdomainregistry.com
to get the more detailed information about the domain? For example,
 will follow the
referral and yields the registrant's contact information (which I will
not include here).
I searched for the registrant of sks-keyservers.net on the keyservers
and found two current, valid public keys for them: a 4096-bit RSA key
signed by lots of people (0x6B0B9508) and a 15,360-bit(!) RSA key with
only a self-sig (0x43E67CF7).
My understanding is that the pool and the SKS keyserver software it
runs is well-maintained.  shows
53 active servers in the pool.
Interesting. According to
 (see the very
bottom), the pool uses its own CA to sign server certs for HKPS
servers it lists. Server certificates for pool servers are signed by
the pool CA. If the certificate in
one specific HKPS server in the pool, you will get certificate errors
when you query other servers in the pool (as they each have their own
unique certificate).
They pool CA certificate is available at
Do you have GnuPG configured to use the CA certificate for the pool?
It looks like you're telling GnuPG to use one particular server
certificate as the CA, which won't work.
When I downloaded the pool CA and performed a key search over HKPS as follows,
$ gpg2 --search --keyserver hkps://hkps.pool.sks-keyservers.net
--keyserver-options ca-cert-file=./sks-keyservers.netCA.pem 0xDA122186
everything works as expected. (0xDA122186 is the KeyID for one of my own keys.)
You can also specify the ca-cert-file in your config file:
  keyserver hkps://hkps.pool.sks-keyservers.net
  keyserver-options ca-cert-file=/path/to/CA/sks-keyservers.netCA.pem
The PEM certificate you mentioned,
Appears to have been issued by StartSSL, a well-known CA, and has not
been signed by the pool CA. The key is issued with a
CN= There is a pool key server running
under that domain, keyserver.secretresearchfacility.com, but it's
running on a server that uses SNI to use multiple SSL certificates on
a single server.
GnuPG appears to support SNI and so works correctly (gpg2 --search
--keyserver hkps://keyserver.secretresearchfacility.com
--keyserver-options ca-cert-file=./sks-keyservers.netCA.pem 0xDA122186
 works properly) but does curl? If not, curl would not specify the
correct hostname it's looking for and the server (which doesn't know
what hostname the client wants) would present its default CA, which is
the StartSSL-issued one.

@_date: 2013-06-03 09:08:28
@_author: Pete Stephenson 
@_subject: Separate OpenPGP cards for master key and sub-keys 
Using separate smartcards for master and subkeys works perfectly fine
for RSA keys in my experience. I do precisely this with one of my
recent keys.
Here's a general overview of how I did it:
1. Generate primary key on the computer (not directly on the
smartcard), then make appropriate offline backups (e.g. on CD-R) so if
the card is damaged I can still use the key.
2. Transfer the primary key to the smartcard, then delete the primary
key from the computer. I then ran "gpg2 --card-status" to generate the
private key stub that tells GnuGP that the private key for that KeyID
is on the smartcard.
3. Generate subkeys (encryption and signing) on the computer, signing
them with the smartcard-based primary key.
4. Transfer the subkeys to a new smartcard, then deleting the subkeys
from the computer. "gpg2 --card-status" generates the stubs for the
subkeys, as above.
I keep the backups in a physically secure location, including a locked
box in my house and in a safe deposit box at my bank. I'm not really
worried about physical compromise of my keys (I figure if someone's
breaking into my house to steal my keys, I have more important issues
at hand). My use of smartcards is to help reduce the risk of key
compromise due to malware or some other computer-based attack, so
they're kept in my immediate control but not as physically secure
(e.g. in desk drawer, rather than in a locked box).
Your exact strategy might differ slightly: for example, you might want
to generate the keys on the card and never have private key material
on the computer (this also prevents you from making backups), but the
overall process should be similar.
Since the smartcards don't support DSA or ElGamal keys, you can't use
the cards to protect these types of keys (though you can use RSA
subkeys with a DSA primary key). One of my keys is a DSA primary key,
which I keep offline but have the RSA subkeys on a smartcard (I have
three in total). I only use the DSA key for signing/certifying new
subkeys or other people's public keys, then delete it from the

@_date: 2013-06-03 17:03:51
@_author: Pete Stephenson 
@_subject: Separate OpenPGP cards for master key and sub-keys 
What version of the Crypto Stick are you using? I've successfully
moved 4096-bit RSA primary keys to the OpenPGP smartcard and 2048-bit
RSA subkeys to a Crypto Stick v1.2, but I would expect the Crypto
Stick would also support 4096-bit keys. I don't know if early versions
wouldn't support keys of that length.

@_date: 2013-06-26 15:22:49
@_author: Pete Stephenson 
@_subject: subkeys on smartcard? 
[original reply was sent only to Daniel, I'm re-sending the reply to
the mailing list]
I think it's mostly the latter (i.e., that the primary key could fall
into the wrong hands). That, and many people have DSA primary keys
that are not supported by the RSA-only smartcards.
Using subkeys helps insulate the primary key from potential badness:
subkeys can be revoked and replaced without any major issues.
Revocation of the primary key would require that one re-acquire
signatures from other people to regain their position in the Web of
Trust. This can often be a hassle. The same thing applies if there's
no backup of a smartcard-based primary key.
Personally, I keep encryption/signing subkeys on one smartcard and the
primary key on a different smartcard (both with offline, secure

@_date: 2013-06-29 17:09:51
@_author: Pete Stephenson 
@_subject: Smart card works with GPG v1 but not with GPG v2 on Ubuntu 
Did you install the libccid and pcscd packages, as described at
 ?
If that doesn't work, also try installing the gpgsm package -- for
whatever reason, my Crypto Stick didn't work until I installed that
package. If the package is removed, the Crypto Stick stops working. This
was the case for several Ubuntu and Mint systems, even fresh-from-the-CD
systems I created in VMs for testing, though your mileage may vary.

@_date: 2013-06-29 17:24:04
@_author: Pete Stephenson 
@_subject: Smart card works with GPG v1 but not with GPG v2 on Ubuntu 
Alas, I'm out of ideas -- it's always worked for me (though it's
basically been cargo-cult troubleshooting in my case, as I don't really
see why gpgsm would magically make things work as it doesn't seem really
related to the Crypto Stick).
Hopefully others on the list can be more helpful.

@_date: 2013-06-29 20:13:45
@_author: Pete Stephenson 
@_subject: Smart card works with GPG v1 but not with GPG v2 on Ubuntu 
Ok, but isn't pcscd the scdaemon? On Ubuntu 12.10 and before I'd install
the libccid and pcscd packages and the Crypto Stick still wouldn't work
even though scdaemon was installed and configured. The Crypto Stick
wouldn't work at all until I installed gpgsm.
I admit to being a bit out of date in regards to testing the 13.04
release because I've been a bit too preoccupied with outside stuff to
tinker much, but hopefully things have improved. :)

@_date: 2013-05-02 20:21:07
@_author: Pete Stephenson 
@_subject: 2.0.20 beta available 
Do existing versions not support --delete-secret-keys?
I've been using 2.0.17 and 2.0.19 on both Linux and Windows and have had
no issues with --delete-secret-keys. It seems to have worked for me: I
moved several secret keys over to smartcards (after making offline,
secure backups, of course), deleted the secret keys from the keyring,
and gnupg created the appropriate stubs pointing to the smartcard
without any issues.

@_date: 2013-05-21 12:22:40
@_author: Pete Stephenson 
@_subject: Total Newbie Can't Unpack Tar Ball on AIX 
Hi Bettina,
I'm not familiar with the details of AIX, but it may have some sort of
package manager or other centralized way to install software. I would
hope they'd have a packaged version of GnuPG that would allow for you
to easily install it. Once installed, it should be fairly
straightforward to use.
In your particular case, it looks like tar for AIX doesn't support
bzip2 and so it displays the "I don't understand what you want, so
here's the how-to-use-this-program" help message instead.
You'd need to unbzip2 it first.
Running "bunzip2 gnupg-2.0.20.tar-1.bz2" should unbzip2 the compressed
file, while "tar -xvf gnupg-2.0.20.tar-1" (why is there a -1 at the
end of the file? That's odd.) will then untar the tarball.
The way you're doing things is decidedly non-trivial: it looks like
you've downloaded the raw source code for GnuPG. To use it you would
need to compile it and then install it. This is almost certainly not
the preferred way of doing this and is usually something done by
developers/programmers rather than average users.
You should check to see if there's a packaged version of GnuPG for
AIX. A quick Google search yields
 for GnuPG 1.4.x and
 for GnuPG 2.0.x,
which looks promising, though I have no idea how reliable that
particular site may be. Either version should be suitable for your

@_date: 2013-05-22 12:49:31
@_author: Pete Stephenson 
@_subject: Keyring on external encrypted drive 
Depending on your exact needs, you may find an OpenPGP smartcard to be
a better choice -- once the private key or keys are loaded onto the
card you can do all the normal operations (e.g. signing, decrypting,
etc.), but the keys cannot be extracted from the card (barring bad
guys with advanced means of disassembling microchips and reading out
their contents). All the private key operations are conducted on-card
and the keys never leave the card. If you need to, you can delete the
keys from the card but you can't access or copy them from the card.
See  for a description of the card. You
can buy it and the appropriate reader from
. I've had good luck with the SCR-335 reader on both Windows and
several Linux distributions.

@_date: 2013-05-22 22:14:53
@_author: Pete Stephenson 
@_subject: Rewinding signature counter 
I presume you're referring to the signature counter on the OpenPGP
As far as I understand it the counter is purely for informational
purposes -- it might be useful for a person or organization who needs to
keep track of signatures for audit purposes, for example.

@_date: 2013-05-23 18:22:13
@_author: Pete Stephenson 
@_subject: Keyring on external encrypted drive 
The card reader + pinpad sold at
claims to be supported with GnuPG >1.4.0 so it should work fine.
The standard OpenPGP smartcard has an option that, when enabled,
prompts for a PIN for every signature. It's probably a useful thing to
enable. It does not have an option (as far as I know, please correct
me if I'm wrong) to prompt for a PIN for every decryption operation.

@_date: 2013-05-26 01:29:32
@_author: Pete Stephenson 
@_subject: [OT] Why are you using the GPG / PGP keys? 
I'd also like the ability to transfer keys between cards, much like one
can transfer x.509 keys between HSMs.
That said, I don't really see using a PC-generated key on a card as
nonsensical. I do just that: I generated the key using a
freshly-installed Linux distribution on an offline PC with an added
hardware RNG for extra entropy. I burned a backup of the private key to
a few CD-Rs (one for an offsite, secure location like a safe deposit
box, the other kept locally in case of card failure), printed out a
paper backup, transferred the key to the card, and replaced the private
key on the PC with the stub pointing at the card.
I understand the "one person, one key, one card" position, but my usage
scenario is mainly "avoid the possibility where a remote attacker could
gain access to my private key" (e.g. with malware, keyloggers, etc.). If
someone has physically broken into my house or safe deposit box to get
my offline backups, I'll (a) know about it and (b) have bigger problems.
To answer Zece's original question as to why I use OpenPGP keys, I use
OpenPGP (specifically GnuPG) to send potentially sensitive information
over the internet. In my particular case, I'm an American living in
Switzerland for grad school and some family members living back in the
US act as my proxy for certain things that need to be taken care of back
in the US like taxes. We use GnuPG to send this information back and
forth as needed. Having it leak wouldn't be catastrophic, but I'd prefer
to keep it private if possible.
Additionally, the use of signatures is useful when corresponding with
people over the internet. I place a strong amount of confidence that
keys I've personally certified belong the to the person I met, but
untrusted signatures are still useful to me as they can be used to show
consistency over time.
For example, I've never met Werner Koch in person, haven't signed his
key, or have any idea if he is, in fact, named Werner Koch in real
life...but he's been going by that identity for years and using the same
key for signatures that whole time (as far as I can remember). Even
though I can't confidently map his key to a real-life identity, I can be
reasonably confident that the person posting as him today is the same
person who was posting as him a few years ago as the key used to make
the signatures is the same.
As always, your mileage may vary, but those are some of the main reasons
I use OpenPGP.

@_date: 2013-05-29 19:43:31
@_author: Pete Stephenson 
@_subject: [OT] Why are you using the GPG / PGP keys? 
That's odd. What phone do you have? They're certainly not in every
device, but their root is in iOS and Android devices, as well as pretty
much all the major desktop browsers.
Their free keys are only valid for one year, but paid users can get keys
that are valid for two years. That's not uncommon for many CAs.
They're based in Israel, not the US.
Additionally, it's an option to have them generate the private key for
customers who are too lazy to generate their own private key and CSR,
but it is not required: the certificate-creation procedure also allows
for customers to provide them with a CSR produced from a
customer-generated private key.
ObDisclaimer: I'm a paid customer of StartSSL, but otherwise have no
connection or relationship with them.

@_date: 2013-05-29 20:29:34
@_author: Pete Stephenson 
@_subject: [OT] Why are you using the GPG / PGP keys? 
Do they? My understanding is that it's just a VoIP number that connects
to their Israeli offices. International calls to US numbers are often
considerably less expensive than those to, say, Israel, so that makes
some sense.
See I'm not a lawyer, but I don't see how having a phone number in the US
means that the whole organization is subject to the Patriot Act.
Even if it was, I'm not really seeing the major issue here: they claim
that there are no copies made of server-generated private keys at any
stage, so they wouldn't have any secret material to turn over. Since you
can submit CSRs for locally-generated keys then there's nothing private
at all for them to reveal other than the information in the certificate,
which is already public.
If they were subject to the Patriot Act, they might be compelled to
produce a new cert for a specific hostname (though I suspect they'd just
cancel the US VoIP line if that issue came up), but how is this
different from the many other US-based CAs?
See : "The wizard doesn't force
subscribers to use private keys generated by the CA, instead clicking on
Skip at the step for private key generation allows to submit a
certificate request (CSR) prepared by the subscriber. Some server
software even requires this, most notable Java based software. The
creation of the private key by the wizard is completely optional and at
the sole risk of the subscriber."
Anyway, the overall point was "WebTrust-audited and widely-trusted
certificates are available for free from StartSSL, just as inexpensive
ones are available from other CAs in various countries, so cost should
not be a factor if one wishes to have secure, public-facing systems".
Using self-signed certs is perfectly suitable for internal systems or
those used by an individual or a small number of users, but for things
requiring access by the public (who might otherwise be suspicious or
technically unwilling or unable to configure their browser/mail
client/etc. to trust a self-signed cert) it makes a lot of sense to use
a cert signed by a CA.

@_date: 2013-11-10 13:02:33
@_author: Pete Stephenson 
@_subject: Duplicating smartcard 
Did you generate the keys on the smartcard, or did you generate them
on the computer and then later transfer them to the smartcard?
If you generated them on the card itself, you cannot backup the keys.
If you generated them on the computer, you can back up the keys to
other media prior to transferring the keys to the smartcard. Once
they're on the card the private keys cannot be exported.
It exports the "stub" private keys that, in essence, say "The actual
private keys exist on the smartcard with $SERIAL_NUMBER". These stubs
are not private at all, and contain no actual key material.

@_date: 2013-11-18 20:45:46
@_author: Pete Stephenson 
@_subject: article about Air Gapped OpenPGP Key 
Excellent work!
Here's some minor suggestions and personal opinions.
1. If you set the keyprefs in your gpg.conf configuration file before
you generate a new key it will generate new keys with these stronger
defaults rather than having you need to edit them later. See
 for details
and examples.
I'd like to call your attention to the "cert-digest-algo SHA256" line --
this means that your primary key will make stronger signatures on other
keys (e.g. your subkeys and other people's public keys). This is
probably a Good Thing.
2. Have you considered adding TWOFISH and BLOWFISH to the list of
ciphers? I put TWOFISH after AES256 and before AES192, and I put
BLOWFISH after AES but before CAST5. I like having diverse, strong
ciphers available to those who might elect to use them. Since the
versions of GnuPG I use support those ciphers and they're generally
well-regarded I see no reason to exclude them, but your mileage may vary.
I've been tempted to add prefs showing I can use the CAMELLIA cipher --
does anyone know of a good reason not to?
3. When generating the key and you're prompted to pick a key type, I
recommend selecting  ("RSA (sign only)"). This generates only the
primary signing/certification key but does not generate an encryption
subkey at the same time. Later you can add the encryption and signing
subkeys. This can be useful if you want to mix-and-match algorithms and
expiration dates.
For example, I have a 3072-bit DSA sign/cert primary key, a 2048-bit RSA
encryption subkey, and a 2048-bit RSA signing subkey. The two subkeys
have a 5-year expiration time while the primary key has no expiration time.
Of course, selecting option  and creating an RSA sign/cert primary key
with an RSA subkey of equal strength with the same (if any) expiration
date, followed by adding a new signing subkey also works. It's simply a
matter of personal preference -- I like generating each key individually
so I have control over that specific key.
4. Are there any known issues with your "air gapped" system being the
same physical hardware as your everyday system even if you use a LiveCD?
I don't know if there'd be the potential for hardware compromises.
Depending on one's security needs, it might be useful to get a separate,
isolated, never-connected-to-the-internet computer specifically for
high-security needs. (See
 for some
5. Smartcards are also useful, as you can generate keys on your isolated
computer, back them up safely, then copy the keys to the smartcard. You
can then use the smartcard on your everyday system without risk of
exposing the private keys. I have an RSA primary key on one smartcard
and RSA signing/encryption subkeys on another smartcard. (I also have a
third card which has the RSA subkeys for the key I mentioned in point above. I rather like smartcards.)

@_date: 2013-10-11 14:03:44
@_author: Pete Stephenson 
@_subject: OpenPGP Smartcard + signing email = two signatures? 
Indeed. I assumed it was merely a bug rather than something with
malicious intent, as it occurred even with fresh-from-the-CD VMs that I
was testing. I assume the bug also occurs without the "force signature
PIN" bit enabled on the smartcard and with non-smartcard based keys.
I've been in touch with Olav at Engimail and provided him with debugging
information that might help.
And yes, if one's computer was compromised  then this is a good way for
a bad guy to get signatures. In my case, I take reasonable precautions
to prevent compromise and, while I can't prove it, I am reasonably
certain that my systems are clean. (Let's hop!)
In this particular case, I'm using card readers without built-in PINpads
(one is USB and connected to a desktop system, the other is integrated
into a laptop) -- I'm being prompted for the pin by PINentry, which
comes with GnuPG2.
That's my thought too. I'll post any updates to this thread.

@_date: 2013-10-13 15:32:20
@_author: Pete Stephenson 
@_subject: OpenPGP Smartcard + signing email = two signatures? 
Aha, that explains it! Many thanks.
I never really made the connection between that section in RFC 3156 and
this behavior.
Oddly, this doesn't always happen, even with the "force signature PIN"
bit set on the smartcard.
That is, in-line signing only requires one PIN entry. PGP/MIME
often requires the PIN to be entered twice, but not always.
Some informal testing over the last few minutes seems to suggest that
I'll be prompted for the signature PIN twice when sending the first
PGP/MIME message of a particular Thunderbird session. If I don't exit
Thunderbird and send other PGP/MIME messages then I will only be
prompted once for each signed message. Exiting Thunderbird and
re-opening it resets stuff, so I'm again prompted for two signature PINs
on the first PGP/MIME message but only one on following messages.
Does Enigmail cache the hash type used for the signature for a length of
time (say, the duration that Thunderbird remains open) so it doesn't
need to prompt for two signature PINs?
It does indeed. Thank you.

@_date: 2013-10-15 11:41:28
@_author: Pete Stephenson 
@_subject: New GPLv3 OpenPGP card implementation (on a java card). 
Is this a hardware limitation, or could it be increased in the future?
Also, are there any smartcards out there that would support DSA/ELG
keys? All the cards I've seen and used support RSA only.

@_date: 2013-10-16 12:01:56
@_author: Pete Stephenson 
@_subject: New GPLv3 OpenPGP card implementation (on a java card). 
I knew that DSA fails catastrophically with low entropy (where
"catastrophically" = "leaking the private key"), but I would hope that
any DSA-capable smartcard would have a decent hardware RNG built in.
I'm not familiar with RFC 6979. Thanks for the link. It's good to see
people taking that issue into account.

@_date: 2013-10-16 15:28:47
@_author: Pete Stephenson 
@_subject: trust your corporation for keyowner identification? 
In general, I'd be fine with that. Corporations generally need a
fairly large amount of information about their employees (e.g. for tax
purposes) and so should be able to verify the identity of employees
with a high degree of confidence.
In my specific case, I only publicly sign (as opposed to locally sign)
keys when I have (a) personally met a person and verified their ID and
key fingerprint/details or (b) a person is well-known to me (e.g. a
family member, long time friend, etc.) and they provide me their key
fingerprint and communicate in a way that I can verify who they are
(e.g. I call them on the phone, recognize their voice, and they read
me their key fingerprint).
I would be reasonably sure that a key signed by an HR department
actually belongs to the named person, but I wouldn't publicly assert
that by signing their key.
Your mileage may vary. :)

@_date: 2013-10-16 16:36:33
@_author: Pete Stephenson 
@_subject: trust your corporation for keyowner identification? 
Good point. That would definitely throw a wrench in the system.

@_date: 2013-10-25 23:33:14
@_author: Pete Stephenson 
@_subject: 2048 or 4096 for new keys? aka defaults vs. Debian 
In my particular case, I mainly use GnuPG with emails and RSA
signatures tend to be quite large and unwieldy for non-GnuPG-using
users, mailing lists, etc. when one uses 4096-bit keys. As a
compromise, I use a 4096-bit primary key (used only for certifying
keys) and 2048-bit subkeys for encryption and signing, thus keeping
signature sizes a bit more manageable. This also lets me periodically
rotate subkeys as needed.
For Debian devs, the signatures are (mostly?) used for package signing
and so an extra few hundred bytes isn't really a big deal as it's rare
for anyone to actually see the signature itself as it's processed
automatically by the package manager. In their case, there's no
specific reason to *not* use 4096-bit keys.
It all depends on your use case, I suppose.

@_date: 2013-10-27 10:23:28
@_author: Pete Stephenson 
@_subject: gpgsm and expired certificates 
Mostly correct.
All that is needed to encrypt/decrypt/sign/verify messages is the
public/private keys themselves. The certificate is a signed,
structured format that binds a particular public key to an identity
(be it an email address, a name, a website, etc.). The certificate is
for public consumption: Comodo is asserting to the world that this
particular public key (and it's corresponding private key, which only
you know) belongs to you (or your website, email, etc.).
On your end, all you need is the private key to decrypt messages
encrypted to your public key. You don't need a certificate to decrypt
messages that had already been encrypted to that public key -- a
certificate may expire at a certain time, but the private key has no
baked-in expiration date.
Correct, though it is possible (but usually recommend against) to
create a new certificate using the same private keypair as before. In
general, you should create a new keypair when applying for a new
I interpreted Werner's comment to mean "In order to decrypt messages
encrypted to you, you only need a private key. You don't need a valid
certificate to decrypt old messages that were encrypted to a
now-expired certificate."
If you generate a new keypair for the new certificate (which is
probably a good idea) then gpgsm (and presumably any other
certificate-using software) will figure out what private key will be
needed to decrypt a particular message and, so long as you still have
the private key on your system, will use it as needed even if the
corresponding certificate has expired.

@_date: 2013-10-27 11:13:22
@_author: Pete Stephenson 
@_subject: gpgsm and expired certificates 
I can't speak specifically for gpgsm, as I only use GPG with OpenPGP
keys and not x.509 certs, but I would venture that the answer to your
question is "yes, gpgsm will select the correct private key for
signing" as that's standard behavior for such software.
Werner or others could answer authoritatively.

@_date: 2013-10-31 22:17:42
@_author: Pete Stephenson 
@_subject: 2048 or 4096 for new keys? aka defaults vs. Debian 
That attack is only valid if different messages have related keys. If
the keys are chosen randomly, the attack does not apply. I'm not aware
of any crypto system that implements AES with related keys (though if
anyone knows of some, I'd like to know so I can avoid it).
See  and
for details .
According to the Wiki, the best attack on full-round AES-256 not using
related keys requires 254.4 operations (see

@_date: 2013-09-01 23:15:35
@_author: Pete Stephenson 
@_subject: Can I revitalise an old key-pair? 
While it can be tempting to use particularly old keys (such as those
made in 1999), the maximum length at the time (1024-bit DSA keys)
makes them borderline too-short for modern usage. Even if you regain
access to your 1999-era secret key, you should probably consider
transitioning to a new, stronger keypair. See
 for some
useful information on the subject.
The keyservers only store the public part of your key. This is not
sufficient to derive the secret key (if it was, that'd be a Bad
Thing). If you do not have your secret key that corresponds to the
public key you wish to, as you say, revitalize, then there's nothing
you can do except create a new keypair. That, or develop some major
advancements in the field of mathematics that would allow you to
derive the secret key from the public key (which would break the whole
system, rendering the exercise moot).
Unfortunately not.
If you go through your old systems and are able to find the relevant
secret key files or the GPG/PGP keyring files, then you can continue
using that keypair. If you cannot find the secret key, you'll need to
create a new keypair. :/
I suppose the only step that'd come before that would be "find your
secret key". If you can't do that, you're sort of hosed. :)

@_date: 2013-09-03 11:07:24
@_author: Pete Stephenson 
@_subject: AES256 & AES192. (Was: Can I revitalise an old key-pair?) 
Even more importantly, were they ever an issue with GnuPG in the first place?
That is, does GnuPG generate related keys?
I was always under the impression that GnuPG randomly generated
session keys rather than creating related session keys; if true,
wouldn't this mean that the related-key attack doesn't apply?
In regards to fixing the cipher, I'm not really sure that one can just
issue a patch that would update the cipher itself (as opposed to a
specific implementation of it): the cipher is standardized and is
implemented in both hardware and software in zillions of devices and
programs around the world. Adding more rounds or changing its
functionality in some way to counter this attack would cause that
changed version to diverge from the standard and it presumably not
interoperate with standard AES.

@_date: 2013-09-05 20:35:21
@_author: Pete Stephenson 
@_subject: Issues with primary key & subkeys on different smartcards 
Hi everyone,
I'm writing in regards to an issue I've run into using GnuPG 2.0.21 on
Windows (the same issue occurs with 2.0.19 in Debian 7 and Ubuntu
Linux 13.04, and I performed the same steps on all three systems to
verify that this wasn't an OS-specific issue). I apologize in advance
for the length of this message, but I thought it better to be more
detailed than less.
Brief background:
I have loaded a primary RSA signing key onto a smartcard ("smartcard
 I have created two RSA subkeys, one for signing and the other
for encrypting, and loaded them onto a second smartcard ("smartcard
 The primary key and its subkeys were generated on the computer
and were later loaded onto the card; they were not generated
internally on the card (I keep a secure, offline backup of the private
keys in case the cards are damaged or lost.).
I wish to have a single private key file in my GnuPG keyring that
includes stubs to the primary key on smartcard  and the subkeys on
smartcard  This way, if I need to certify a public key belonging to
someone else I will be prompted to insert smartcard  If I wish to
sign a message or decrypt an encrypted message sent to me I will be
prompted to insert smartcard First attempt:
Initial conditions:
1. The public key that contains details about my primary and subkeys
is present in my GnuPG keyring. The private keys are not present in
the GnuPG keyring; they exist only in the offline backup and on the
2. Primary key is on smartcard  both subkeys (encryption and
signing) are on smartcard Expected behavior:
1. I insert smartcard  then run "gpg2 --card-status".
2. The details of smartcard  is displayed.
3. GnuPG adds a private key stub pointing to smartcard 4. I remove smartcard  and insert smartcard  then run "gpg2 --card-status".
5. The details of smartcard  is displayed.
6. GnuPG adds private key stubs pointing to smartcard 7. Certifying ("signing") someone else's public key requires that I
insert smartcard  Signing a message or decrypting an encrypted
message requires that I insert smartcard Observed behavior:
1. Same as above.
2. Same as above.
3. Same as above.
4. Same as above.
5. Same as above.
6. GnuPG does *not* add private key stubs pointing to smartcard 7. Certifying someone else's public key requires that I insert
smartcard  as expected. Signing a message or decrypting an
encrypted message does not prompt for smartcard  but instead
results in the following error message:
gpg: secret key parts are not available
gpg: skipped "KEYID": Unusable secret key
gpg: [stdin]: clearsign failed: Unusable secret key
If I start over from the initial conditions and reverse the order of
the cards (i.e. insert smartcard  first and run "gpg2
--card-status"), then the stubs for the subkeys get generated but when
I later insert smartcard  and run "gpg2 --card-status" then the stub
for the primary key is not created.
Second attempt:
Expected behavior:
1. Add the primary key stub (steps 1-3 from above). This successfully
adds the primary key stub.
2. Run "gpg2 --export-secret-keys KEYID > primary-stub.key"
3. Run "gpg2 --delete-secret-keys KEYID" to delete the private key
component (that is, the stub) from the keyring.
4. Add the subkey stubs (steps 4-6 as above). This successfully adds
the subkey stubs.
5. Run "gpg2 --import primary-stub.key".
6. GnuPG imports the primary key stub, resulting in a private key
containing stubs to the primary and subkeys on their respective cards.
Observed behavior.
1. Same as above.
2. Same as above.
3. Same as above.
4. Same as above.
5. Same as above.
6. GnuPG does *not* import the primary key stub. Rather it says:
gpg: key KEYID: already in secret keyring
gpg: Total number processed: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
Starting over and reversing the order (creating the subkey stubs,
exporting them to a file, deleting the subkey stubs from the keyring,
adding the primary key stub, and trying to import the subkey stubs)
produces the same, unsuccessful result.
Is this intentional or a bug?
If it is intentional, how can one easily add stubs pointing to
different smartcards for different private key components?
I was able to successfully create a private key with stubs pointing to
both cards as follows (since Gpg4Win does not include the gpgsplit
utility but Debian's gnupg2 package does, I performed these steps in
Debian. I presume they'd also work in Debian derivatives like
1. Insert smartcard  run "gpg2 --card-status". This creates a stub
for the primary key.
2. Run "gpg2 --export-secret-keys KEYID > primary-stub.key" to export
a private key file containing the stub of the primary key.
3. Run "gpg2 --delete-secret-keys KEYID" to delete the private key
stub from the keyring. Only the public key remains in the keyring.
4. Insert smartcard  run "gpg2 --card-status". This creates a stub
for the subkeys.
5. Run "gpg2 --export-secret-keys KEYID > subkeys-stub.key" to export
a private key file containing the stubs of the subkey.
6. Run "gpg2 --delete-secret-keys KEYID" to delete the subkey stubs
from the keyring. Only the public key remains in the keyring.
7. Put each exported key file into a separate directory, then run "cat
primary-stub.key | gpgsplit" and "cat subkeys-stub.key | gpgsplit" in
the respective directories to separate the keys into packets.
8. Move the subkey stub packets from their directory into the primary
key directory, overwriting the subkey packets in the primary key
9. Run "cat * > complete.key" in the primary key directory to
reassemble the key file.
10. Run "gpg2 --import complete.key" to import the reassembled key file.
11. Success! Everything works as expected: running "gpg2 --edit-key
KEYID", then "toggle" shows that the primary key and the subkey stubs
exist and point at their respective cards. Certifying a key requires
smartcard  and signing/decrypting messages requires smartcard Although this was successful, I think that it's something that should
be doable within GnuPG itself rather than by splitting keys and
working manually on packets.

@_date: 2013-09-07 00:08:43
@_author: Pete Stephenson 
@_subject: Issues with primary key & subkeys on different smartcards 
Hi all,
Quick followup: I was also able to create the correct private key with
stubs pointing at both smartcards by loading the actual private keys
onto the smartcard using "keytocard", as expected.
However, I'm unable to re-create this file starting only with the
public key and running "gpg2 --card-status" for each card. It seems
like running "gpg2 --card-status" for each card should be able to
create the stubs, but if there's already a stub associated with a
particular smartcard, then running "gpg2 --card-status" doesn't seem
to have any effect other than to display the card info.
Put simply: running "gpg2 --card-status" will create one stub pointing
at the card, but running that command again with a different card only
displays the card info and doesn't add any additional stubs. This
seems inconsistent and not what I would expect.
Sorry again for the really long previous message.

@_date: 2013-09-07 12:36:18
@_author: Pete Stephenson 
@_subject: Issues with primary key & subkeys on different smartcards 
Hi Paul,
Indeed, the keytocard command is the correct way to load the keys onto
the cards and to generate the stubs initially. As you mention, that
works as expected and generates the correct stubs pointing at both
The issue I'm running into is not the initial loading of the private
keys onto the cards, but rather if I'm trying to use the cards on a
computer that does not already have the private keys.
If I start on that new computer with only my public key, insert one of
the two cards (e.g. the card containing my primary key) and run "gpg2
--card-status", GnuPG will generate a private key stub that points at
that card. That's fine and works as expected. However, if I try doing
the same thing with the second card (the one with my subkeys), the
stub is not added. Only the details of the second card are displayed,
but the stub pointing to that card is not added.
This is not what I expected: I expect that GnuPG will add a stub for
each of the cards after I run "--card-status" for each card, but this
doesn't happen and only the stub for the first card (i.e. whichever
one I use with "--card-status" first) is added.
In short, I expect to be able to get the same result using
"--card-status" and both cards as I do when I use "keytocard" to
initially move the keys to the cards, but this does not occur.
Right, I definitely have backups, but it's always a good thing to
remind people. :)
You're welcome.
If it is designed to work that way, I respectfully ask that the
developers consider changing how it works so that "keytocard" and
"--card-status" both produce the same key with stubs pointing to each
respective card. The way it currently works, where --card-status will
only add one stub to a key, is not what I would expect to happen.
As my programming abilities are not sufficient to make a patch to
change this behavior, I'd be happy to offer a financial contribution
if someone with more skill were to give it a shot.

@_date: 2013-09-07 22:30:07
@_author: Pete Stephenson 
@_subject: NSA backdoors and Set Preferred Cipher 
Hi Mike,
Interesting. Would you care to explain your logic as to why you set
the preferences in that particular order?
In particular, why did you prioritize 3DES over the three AES
variants? I can understand being skeptical of CAMELLIA, as it was
developed commercially, though it has been approved for use by both
the Japanese CRYPTREC project and the European NESSIE project and is
widely available to researchers and cryptographers. That is, it's not
a black box.
Similarly, AES is an open standard and went through rigorous review by
both government and the public cryptographic community.
As far as I'm aware, all the ciphers used in GnuPG have no major,
publicly-known cryptographic weaknesses so the choice as to which ones
to use comes down more to a matter of personal preference and
compatibility reasons.

@_date: 2013-09-08 10:57:49
@_author: Pete Stephenson 
@_subject: How can I send a public key exported with --armour option? 
Hi Francesco,
Welcome! No need to apologize! We're all pretty friendly here. :)
You can add "--armor" (or "--armour", I had no idea that GnuPG
supported the British spelling of the word. Interesting!) to
essentially any command that involves data being output. For
consistency I will use the spelling without the "u", but both are
For example, if you created a key with the KeyID of "KEYID", you could
export the public key for it to the terminal using "gpg --export
--armor KEYID".
If you wish to export the public key to a text file which you can then
include in an email, post on the web, etc., you could use "gpg
--export --armor KEYID > filename.txt" where 'filename' is whatever
you wish the file to be called.
The armor feature is indeed quite useful, but it comes at a slight
cost: armored files/messages are slightly larger than their unarmored,
binary counterparts.

@_date: 2013-09-09 12:03:04
@_author: Pete Stephenson 
@_subject: Some doubts about signature procedure 
Hi Francesco,
That's a good question! The short answer to the question is "there's
more to a PGP signature than just the hash of the file".
In the situation you propose where a file and a hash (for example, the
sha512sum) are publish on a server, an adversary with access to that
system could modify the file and simply add a new, correct sha512sum
for the modified file. There's no way to bind the hash of the file to
the identity of the person who produced the hash. Put another way,
there's no way to tell if the hash was produced by the proper person
or a bad guy.
However, PGP signatures have more than merely the hash of the file --
when PGP (or GnuPG or any other program that implements the OpenPGP
standard) produces a signature, it produces a hash of the file and
encrypts the hash with the signer's private key. The signature is then
included with the file. (Of course, this is a very simple, general
description of what happens. There's a lot more details but this
simple explanation should suffice for now.) This binds someone's
identity to the signature.
Let's say that Alice wants to sign a file. She calculates a hash of
the file, then encrypts the hash with her private key.
Bob downloads the file and wants to verify the signature. He
calculates the hash of the file. Next, he uses Alice's public key
(which is widely available) to decrypt the hash. If the decrypted hash
from Alice and the hash he calculated himself match, then he knows
that the file has not been modified since Alice signed it.
Additionally, since only Alice's public key can decrypt a message
signed with Alice's private key, he knows that only Alice (or, more
generally, someone with Alice's private key) could have produced the
signature. Unless he has Alice's private key a bad guy cannot forge
signatures to appear to come from Alice.
Put very simply, a hash can show that a file has not been altered
since the hash was generated but it provides no assurance as to *who*
produced the hash. A signature provides assurance of both integrity
and authentication: someone verifying the signature can check that the
file has not been altered but also that the signature was produced by
a specific person.
Of course, this assumes that Bob has the public key that actually
belongs to Alice. This can be accomplished by meeting in person,
exchanging public key details over the phone (if they recognize each
other's voices), etc. It's not uncommon for people to meet up at a
"keysigning party" (see
 ), verify each other's
identity and public key details, and then digitally sign each other's
keys. In such a way, people establish a "Web of Trust" where different
people vouch for the identity of each other.
You might find more details about digital signatures at
 . There may also be a
Wikipedia article that describes signatures in your own language.
Your English is quite good.

@_date: 2013-09-09 15:58:14
@_author: Pete Stephenson 
@_subject: SSL on gnupg.org 
According to that's because the CAcert Class 3 intermediate cert was signed using
MD5, which is indeed insecure for such purposes. See
They have a newer Class 3 intermediate cert at
 that is signed by the CAcert root
using SHA256. Simply swapping out the intermediates should solve the
Personally, I prefer the free certs issued by StartSSL as their root
is installed by default in most systems/browsers. The CAcert root
isn't (yet -- there's a bunch of work needed to be done to get the
CAcert root to pass an audit and be included). Your mileage, of
course, may vary.

@_date: 2013-09-09 21:41:42
@_author: Pete Stephenson 
@_subject: Problems using 10kbit keys in GnuPG instead of 4kbit keys 
While it certainly seems that 10kbit keys offer reasonable performance
even for slow systems (thanks for doing the benchmarks on those
systems), there's also some practical concerns:
1. Most smartcards these days support 2048-bit keys, while OpenPGP
smartcards support 4096-bit keys. I'm not aware of any smartcard that
supports >4096-bits. It'd be nice to see hardware vendors offer cards
that can handle larger keys. I'm not sure what the demand for larger
keys is, but I imagine that smartcard support for larger keys would be
a long time coming.
2. How compatible are >4096-bit keys with various OpenPGP
implementations? It's nice to have a (presumably) secure key, but if
other people's software only support 4096-bit keys as a maximum then
you can't really communicate with them. New features are slow to add
to both the standard and to various implementations: even though RFC
4880 says that OpenPGP implementations MAY implement hashes other than
SHA1, I've read some concern about compatibility with SHA256 and
SHA512 signatures and key certifications (I've not observed any such
issues, but I rarely interact with people using older software
versions that are unlikely to support it). I'm not sure what other
programs implement the standard or how well-supported extra large keys
would be.
3. Generating large keys with GnuPG requires that one patch the source
and recompile. This limits the creation of extra-large keys to those
who feel comfortable with doing this. It'd be interesting to see if
Werner would change the hard-coded maximum keysize from the current
4096 to, say 8192 (or 15,360 or 16,384) bits so that users who desired
such keys could create them easily. (It'd probably be best to require
an "--expert" flag to expose such options, at least for a while.)
Thanks again for the interesting benchmarks and measurements.

@_date: 2013-09-10 00:29:43
@_author: Pete Stephenson 
@_subject: Why trust gpg4win? 
I'm sure we've all seen serial-to-USB adapters. Now I wonder if it'd
be possible to do something in reverse: USB-to-serial.
Serial connections are pretty well-understood, well-documented, and
(hopefully) less likely/able to be an attack vector. It'd be
interesting to see if one could have a USB hub or something to which
one could connect a USB flash drive or other device, have the hub
negotiate the connection with the device, and then send serial data to
the computer where a relatively simple (and presumably
easier-to-secure) program could interpret it. Sure, speeds wouldn't be
anywhere near the same as with USB and one would have to do some
hackery to mount volumes (perhaps a USB-to-serial-to-FUSE interface
for common file systems?) but it might work for relatively small file
transfers (or for those willing to wait).
Is such a thing even possible?

@_date: 2013-09-10 15:42:53
@_author: Pete Stephenson 
@_subject: Problems using 10kbit keys in GnuPG instead of 4kbit keys 
Yes. The certification key is used when signing (more properly,
"certifying") other people's public keys.
A signing key can be used for signing files or messages but the
certification key is used for signing other people's keys.
In short, it's the "primary" key.
Unfortunately not. It is the primary key and its properties (e.g. key
length) cannot be changed.

@_date: 2013-09-11 11:48:08
@_author: Pete Stephenson 
@_subject: Why trust gpg4win? 
Actually, I was thinking of something that was the exact opposite:
some device (which I don't think exists) that would allow one to
connect a USB flash drive to the device, and have the device convert
that into RS232 serial data for the computer, thus avoiding any USB
interaction with the computer itself. The computer would then need to
process the serial data to read or write files on the drive. As far as
I know, nothing like that exists and I'm not sure if it'd be possible
to do. Even if it was possible, it'd be immensely slower than normal
USB connections.
My thought was that since serial is older and simpler than USB that it
would be possible to better audit and secure the connection between
the flash drive and the computer using such a method. My idea was
derived from one of the ways CAcert keeps their root certificate
secure: the signing system is kept offline, but is connected via a
serial cable to an online computer (e.g. the web server). The simple
daemon that listens on the serial port of the signing system will only
respond to requests for signing things but they did not implement any
file-transfer-over-serial functionality so it would (presumably) be
impossible to compromise the root certificate remotely. My idea would
be for something similar, but with file-transfer capability over
The device you linked to, which is quite common, is the opposite: one
can connect a serial device (say a microcontroller, a UPS, etc.) to
the device, which converts it to USB and transmits that data to the
computer. The device appears as a serial port on the computer.
In brief, the device you linked to tunnels serial-over-USB. My thought
was to do filesystem-access-over-serial.
Mine is probably a very silly idea and I was basically throwing the
idea at the wall to see if it'd stick. :)

@_date: 2013-09-13 17:57:08
@_author: Pete Stephenson 
@_subject: newbie and smartcard, I'm lost. 
Indeed. Sounds like a good plan.
GPG creates a pseudo-secret key that includes "stubs" that tell GPG
that your private key is located on a card number with serial number
000013B1. This pseudo-secret key (there's not actually anything secret
about it, as it's just the stubs) is stored in the secring.gpg.
The private key was generated entirely on the card and cannot be exported.
If I remember correctly, you need to import the public key (whether
from the keyserver, a flash drive, or some other storage medium) to
that computer, insert the card, run "gpg --card-status", the General
Key Info will be correctly populated, and new pseudo-secret stubs will
be created, and you'll be able to use the smartcard on that system.
If you put your public key online somewhere (say on your website, by
itself, in a text file) you can program that URL into your smartcard
in the "URL of public key" section (gpg --card-edit, admin, url). When
you get to a new computer, you can insert the card, run "gpg
--card-edit", then run "fetch" and GPG will fetch the public key from
that URL. If there's no URL entered then I think it will attempt to
retrieve the public key from the keyserver but you might want to

@_date: 2013-09-15 21:37:35
@_author: Pete Stephenson 
@_subject: Pgp key 
Hi Jack,
Do you have GnuPG (or some other OpenPGP-compatible software) installed?
If so, do you already have your own PGP key?

@_date: 2013-09-16 22:20:45
@_author: Pete Stephenson 
@_subject: Sign key and export for each UID 
I can't speak for Doug, but I consider UIDs corresponding to
no-longer-functioning email addresses to be invalid and won't sign
them as I have no idea if the keyholder is the actual owner of that

@_date: 2013-09-22 10:28:58
@_author: Pete Stephenson 
@_subject: Question about a perfect private Key store for today's environment 
Probably a smartcard -- this keeps your key entirely on the card and
it is not accessible to the computer (that is, a bad guy with control
of your computer cannot extract the key from the card).
It's almost certainly possible that a well-equipped adversary with
chip-disassembly equipment (read: a major government) could physically
take apart the chip and read the data off the internal parts directly,
but that's a different story altogether. Personally, I use a smartcard
to prevent my private keys from being revealed if my computer is
compromised by malware or some other sneaky stuff. If someone is
willing to go through with seizing my smartcard and taking it apart, I
have bigger problems. :)
Well,  is probably the most secure: it's your own device and your
own mail client (e.g. Thunderbird).
 is probably the least secure, as the company has access to your private key.
Easy: many mail clients have OpenPGP support built-in, or available
through an add-on like Enigmail for Thunderbird. Many can read the
smartcard and handle the encryption/decryption/signing operations
through the normal interface. Even without a smartcard, they can
access one's keyring and perform the various operations.
I'm not sure how much I'd trust a web service, even one operated by
myself or a company, with my private keys. I'd much rather keep them
on a smartcard, accessible only to myself.
Gmail permits access with mail clients (e.g. Thunderbird), so one
could use such a client in conjunction their OpenPGP software to send
and receive encrypted mails.
For webmail-only providers, you'd need to compose your message offline
(say in a text editor like Notepad or something similar), then perform
the encrypt/sign operations, then copy-paste the encrypted/signed
output into the webmail compose window.
Usability is a big concern, and it's difficult with webmail-only
services that people use these days. It becomes much more
straightforward if one uses a mail client program.

@_date: 2013-09-30 23:10:23
@_author: Pete Stephenson 
@_subject: OpenPGP Smartcard + signing email = two signatures? 
============================== START ==============================
Hi all,
I use Thunderbird, Enigmail, and GnuPG on Windows 7 (among others).
I have my primary cert/sign key on one smartcard and two subkeys
(signature + encryption) on another. I have the "force signature PIN"
option enabled for both cards.
Tonight I was using the card with the subkeys to sign an email message
that I was sending. As expected I was prompted by pinentry to enter the
card PIN and that the card had made N signatures before. I entered the
PIN and immediately pinentry popped up again asking for me to re-enter
the PIN and indicated that N+1 signatures had been made before,
suggesting that it had made the previous signature. Again, I entered the
PIN and the message was correctly signed and everything seems to work
normally. There is only one signature on the message -- it seems that
one of the signatures goes missing.
I've noticed this happening intermittently over the past few months, but
only when using Enigmail and Thunderbird -- if my memory serves me right
it also happens intermittently when I use Ubuntu Linux on a different
computer, Thunderbird, and Enigmail so it doesn't seem to be a
Windows-specific problem.
Although this has happened for a while, it's only happened
intermittently and I can't reproduce it on demand (e.g. it happened to
the first signed message I sent today, but not the second. It occurred
when I tried signing this message.) Has anyone else observed this
behavior? If so, is there an explanation?

@_date: 2014-04-05 22:09:58
@_author: Pete Stephenson 
@_subject: Chipdrive SPR 532 and OpenPGP Card with 4096Bit RSA Keys 
When you run "keytocard" the private key is moved to the card and then
the private key on the computer is then replaced with a "stub" that
says "The private key is located on the smartcard with a serial number
of $SERIAL_NUMBER" so GnuPG knows where to look and, if the card is
not present, prompt you for the right card. (Be sure you have a backup
of your actual private key before running "keytocard", if that's
something you'd like to do.)
As far as I know, there are two options for setting up a second system
to have the stub without actually needing to import your actual
private key:
1. You can export the stub "private" key (I use quotes because unlike
a real private key, the stub is not sensitive information) from your
first computer and then import it into the second just as you would do
if you were importing any other private key.
2. Import only the your public key to the second computer, then insert
the smartcard and run "gpg --card-status". This will detect the card
and generate the appropriate stub. This is the method I usually do.

@_date: 2014-04-10 00:45:55
@_author: Pete Stephenson 
@_subject: Heartbleed attack on Openssl 
disagreement on its importance:
Any service using a vulnerable version of OpenSSL in the last two years
could have been silently attacked, with the attackers being able to gain
access to information stored in the servers memory.
The attacker might get memory containing empty sections, boring system
files, secret cryptographic keys (the compromise of which could, in some
cases, lead to user data being decrypted or a MITM being possible with no
warnings), user data, etc.
Its not clear of any bad guys knew about the bug prior to the announcement.
If they didn't and one patched any affected servers as soon as possible,
then the effects would be quite minimal. If they did know and exploited
things, or if one has not yet patched vulnerable systems, things could be
very bad.
In short: the consequences could be dire but there is no way of knowing for
certain what, if any, things have been compromised. Its probably best to
assume the worst.
compromised was Yahoo.
Yahoo fixed the issue shortly after the public announcement of the bug. It
is not clear of bad guys were able to compromise their systems before it
was fixed, but researchers were able to successfully probe various systems
at Yahoo prior to the fix, so one should assume bad guys could do the same.
also found out that Mozilla/Firefox browser were also imune. If I would
persuade someone of this bug's importance, which other examples could I
No service using an affected version of OpenSSL is immune. Some (like
Cloudflare) received advanced notice and patched their systems before the
public announcement, while others may have used other SSL libraries or
versions of OpenSSL that were not vulnerable.
servers while browsing?
No. Firefox is immune because it uses the NSS Crypto library.
The issue typically exists on and affects servers. A server using an
affected version of OpenSSL is vulnerable regardless of what browser
clients use.
themselves? (as in "apt-get update && apt-get upgrade").
Ubuntu and Debian use GnuPG to sign packages but updates typically take
place over unencrypted connections. The update mechanism is not affected by
this bug.

@_date: 2014-04-24 22:59:27
@_author: Pete Stephenson 
@_subject: OpenPGP Smartcard: How to generated (non-exportable) keys on the 
stored on the smartcard and *never* touches the disk and therefore should
not be able to be stolen without stealing the physical smartcard.
--export-secret-key should not be possible).
smartcard, but to my surprise it was possible and I got the private PGP key
You have done everything correctly: the "private" key block you're seeing
is a "stub" that tells GnuPG that the actual private key resides on a
smartcard with a specific serial number (to distinguish it from other
smartcards you might use for other keys).
It does not contain any private data.
If you were to go to a different system, import your public key (say, from
a keyserver), insert your smartcard, and run "gpg --card-status" then GnuPG
will automatically generate a new private key stub on that system so you
could use the card.

@_date: 2014-04-30 22:28:15
@_author: Pete Stephenson 
@_subject: Access to www.gnupg.org only via TLS 
at this time (that I'm aware of, and I've been paying attention) that any
actual secret keys have been compromised by Heartbleed. It was listed as a
potential risk when the vulnerability was first announced, but several
groups have done research on that specific point and have found that it
would be sufficiently difficult, if not actually impossible; to render this
particular risk as negligible at best.
Cloudflare did a challenge where a Heartbleed-vulnerable system was exposed
to the internet with a challenge to recover the private key. They thought,
based on internal testing, it would be quite difficult if not impossible.
The key was found within hours:
Interestingly, Heartbleed is being used by security researchers to access
online forums used by bad guys who, for whatever reason, have not patched
their servers:
 -- it is not clear if the
researchers are getting private keys, but it certainly appears to be
In regards to certs, I like the principles behind CAcert, but using their
certs on public-facing systems can be problematic due to their root not
being included in browsers. For practical reasons, using a CA included in
browsers is often a better choice.
I use and usually recommend StartSSL but if that's not an option for
whatever reason, several CAs offer free-of-charge certs for FOSS projects.
Two examples that spring to mind are GoDaddy [1] and GlobalSign [2].
For paid certs, it can often be (considerably) cheaper to buy through a
reseller: for example, a PositiveSSL cert from Comodo costs $49/year, but
the same cert purchased via NameCheap is only $9/year.
Gandi.net, a French registrar, also offers certs chained to Comodo at a
reasonable price, though they're slightly more expensive than US-based
[1] [2]

@_date: 2014-08-08 23:34:30
@_author: Pete Stephenson 
@_subject: [Announce] [security fix] Libgcrypt and GnuPG 
Does this vulnerability apply to gpg4win users?
There's been no gpg4win updates since October of 2013 and there have
been several updates of GnuPG since then. I am somewhat concerned.
Is there any information about when an update for Windows users might
be released?

@_date: 2014-08-09 01:24:09
@_author: Pete Stephenson 
@_subject: [Announce] [security fix] Libgcrypt and GnuPG 
I assumed as such, but it's good to be certain. I'm not sure if
there'd be some OS-specific details that would affect the issue.
Excellent. I look forward to it.

@_date: 2014-08-09 21:01:32
@_author: Pete Stephenson 
@_subject: [Announce] [security fix] Libgcrypt and GnuPG 
I'll bet. Fortunately, there are decent Windows front-ends for
mail-related tasks like Enigmail. Not much for file-related tasks,
I would definitely be happy if the GPG binary was packaged separately:
I almost never use GPA or other GUI tools that come with the package.
Thanks for the reminder regarding donations: I really should chip in a
bit more this year.

@_date: 2014-12-08 11:37:56
@_author: Pete Stephenson 
@_subject: Mainkey with many subkeys?? 
My understanding is that if you have multiple signing subkeys on one
computer, GnuPG will use the most-recently-created signing subkey for
signing messages by default.
However, nothing stops you have from creating multiple signing subkeys
and distributing these to your different devices (e.g. SubkeyA for
your desktop, SubkeyB for your laptop, etc.).
Since all these signing subkeys are bound to your main key, signatures
generated by any of them are valid. Recipients who verify the
signatures do not need to be aware of the existence of other subkeys,
so long as the binding between the main key and the subkey used to
sign the message exists.
Encryption subkeys are handled a bit differently. Typically GnuPG will
encrypt messages to the recipient's most-recently-created encryption
subkey. This makes per-device encryption subkeys a bit less practical.
You can specify a particular keyID by appending an exclamation point (
! ) after the key ID, fingerprint, etc.
See for details.
As an example, I have a DSA main key with the ID 0xDA122186. When I
generated it I also generated an ElGamal encryption subkey. Later, I
generated RSA encryption and signing subkeys. If I sign a message,
GnuPG will use the RSA signing subkey by default. If someone encrypts
a message to me, they will encrypt a message to the RSA encryption
subkey (as it is newer than the ElGamal one).
If I wanted to force GnuPG to sign a message with my DSA main key
instead of the RSA subkey, I could use the command "gpg --clearsign
--armor -u DA122186!". Similarly, if someone wanted to force a message
to be encrypted to my ElGamal subkey they could use "gpg --encrypt
--armor -r 19DF6C14!"

@_date: 2014-12-19 10:29:23
@_author: Pete Stephenson 
@_subject: Unable to encrypt file with private/public key 
I assume that you mean that you encrypted the file using your own public
If so, it's normal for GnuPG to prompt you for your passphrase when you
decrypt the file: the private key is needed to decrypt the file, and the
passphrase is used to unlock the private key so it can be used.
When you're using symmetric encryption mode, the passphrase is used to
encrypt and decrypt the file.
When used with public/private keys, the passphrase is not used at all to
encrypt the file. The file is encrypted using the recipient's *public*
key[1] and sent to the recipient. The recipient uses their passphrase to
unlock their *private* key, which is used to decrypt the file.
Public-key crypto is somewhat of a black art, and there's many aspects
that can be quite confusing. You might find the "Art of the Problem"
video series on cryptography[3] to be interesting.
Mozilla also has an introduction to cryptography[4] which might also
help clarify things. While it focuses on the use of cryptography in a
general web browser-server system, many of the concepts apply to GnuPG.
[1] This is a somewhat simplified explanation. In actuality, the file is
encrypted using a randomly-generated session key and a symmetric cipher
like AES, and the session key is encrypted using the recipient's public
key. This "hybrid cryptosystem"[2] has several advantages over
encrypting the whole file using the recipient's public key.
[2] [3]

@_date: 2014-12-19 09:41:19
@_author: Pete Stephenson 
@_subject: Unable to encrypt file with private/public key 
I think you mean that your partner is unable to decrypt the file with
your *public* (rather than your private) key, right?
If so, that's expected behavior: if you have encrypted a message to your
partner's public key, your partner needs to use their private key to
decrypt the message.
They can use your public key for verifying your signature on the
encrypted file.

@_date: 2014-12-23 00:54:15
@_author: Pete Stephenson 
@_subject: Unable to encrypt file with private/public key 
On Dec 22, 2014 7:30 AM, "Haritwal, Dhiraj" command which is still showing warning message (gpg: 89709B71: There is no
assurance this key belongs to the named user) whereas if I am checking
partner_pubkey, it's showing full trust. How can I remove this message.
Even I have added partner's public key as trusted.
I'm glad things are working better.
To resolve the issue with the assurance message, manually verify that the
key belongs to the recipient (e.g. meet in person or call them and verify
the fingerprint of their key) and then sign the key using GnuPG. (gpg
--sign-key 0xKEYID)
In GnuPG you vouch that a particular public key belongs to a person (or
organization) by signing their public key. This signature can be local or
published publicly.
"Trust" in GnuPG is different, and reflects how much you trust the other
key to correctly vouch for the identity of others. If you set their key as
fully trusted, keys that are signed by that key are treated by your copy of
GnuPG with the same level of assurance as if you signed them yourself.
Typically this should only be reserved for people you know to always check
the identity of other people thoroughly and correctly before signing their
keys. The default is for trust to be set to "marginal".
By combining signatures and trust, one forms a "web of trust":

@_date: 2014-12-29 18:44:29
@_author: Pete Stephenson 
@_subject: Unable to encrypt file with private/public key 
On Dec 29, 2014 6:57 AM, "Haritwal, Dhiraj" public key & partner is using my private key & their public key to decrypt
it but it?s getting fail. M I using anything wrong here.
That looks reasonable. When you say you're getting a fail, what error
message are you seeing?
Also, it seems that you're still mixing up the terms for private and public
keys: this makes it a bit confusing to follow what you're doing. You should
be encrypting the message to your partner's public key (you can
additionally encrypt it to other public keys, such as your own. This is
useful if you want to be able to read the message after you sent it.) and
your partner should use their private key to decrypt it.
Can we sign without passphrase & only with public/private key.
Signing a message requires the sender's (i.e., your) private key to
generate the signature. In order to unlock the private key so that it can
be used to sign the message, you need to provide the passphrase for your
private key.
Short answer: no. You need to use your passphrase (and private key) to sign
a message.
below command which is still showing warning message (gpg: 89709B71: There
is no assurance this key belongs to the named user) whereas if I am
checking partner_pubkey, it's showing full trust. How can I remove this
message. Even I have added partner's public key as trusted.
key belongs to the recipient (e.g. meet in person or call them and verify
the fingerprint of their key) and then sign the key using GnuPG. (gpg
--sign-key 0xKEYID)
organization) by signing their public key. This signature can be local or
published publicly.
key to correctly vouch for the identity of others. If you set their key as
fully trusted, keys that are signed by that key are treated by your copy of
GnuPG with the same level of assurance as if you signed them yourself.
Typically this should only be reserved for people you know to always check
the identity of other people thoroughly and correctly before signing their
keys. The default is for trust to be set to "marginal".
individual or entity named above and may contain information that is
privileged. If you are not the intended recipient, you are notified that
any dissemination, distribution or copying of this email is strictly
prohibited. If you have received this email in error, please notify us
immediately by return email or telephone and destroy the original message.
- This mail is sent via Sony Asia Pacific Mail Gateway..

@_date: 2014-02-09 16:30:46
@_author: Pete Stephenson 
@_subject: Difference between setpref and options in the configuration 
That's because the personal-*-preferences don't change the preferences
in the key itself. They merely change the order of ciphers, hashes,
and compression methods that you prefer when communicating with others
(so long as you both support those algorithms).
According to you'll want to use "default-preference-list" followed by the list of
preferences for your key. For example, putting
"default-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES
CAST5 ZLIB BZIP2 ZIP Uncompressed" in your gpg.conf file and then
generating a new key (or running "edit-key KEYID", "setpref" with an
empty string for the preferences, and "save" on an existing key) will
set the key preferences to that string.

@_date: 2014-02-12 11:46:53
@_author: Pete Stephenson 
@_subject: Trying to understand the bond between master and subordinate key 
Right, this is a reasonable thing to do. It's not mandatory, of
course, but it has various advantages.
You should upload the public key of your primary ("master") key to the
key servers. If you do this in GnuPG, it will automatically upload the
public keys for your primary key and all the subkeys. If you use the
"--export" command to export your public key, it will export the
public key of your primary key and subkeys in one file.
Similarly, when people search for your public key on the key servers
they should search for the KeyID of your primary key. When they
download it, they will also get the public keys for the subkeys.
Subkeys are bound to their respective primary key by signatures made
by the primary key.
When you sign someone else's key, you sign the public key of that
person's primary key. Similarly, when they sign your key, they sign
your primary key. Since the subkeys are bound to their respective
primary keys, the trust in the primary key is automatically applied to
any subkeys without any additional signatures being required. For
example, see my key 0x85EB9F44 (which can be found on the keyservers
at )

@_date: 2014-01-15 14:31:16
@_author: Pete Stephenson 
@_subject: Windows editor destroys gpg.conf 
I like using Notepad++ . It understands
Unix and Windows end-of-line conventions and can switch between them
as needed. I've had no problems editing my gpg.conf file with it.

@_date: 2014-01-21 17:39:13
@_author: Pete Stephenson 
@_subject: Any way for two correspondents to set up gnupg within a few 
On Jan 21, 2014 5:32 PM, "Hauke Laging" I've found  to be a
reasonably sensible guide for setting stronger preferences. I also added
Twofish and Blowfish after AES256 and AES, respectively.
I've not heard of any issues with that setup, but your mileage may vary.

@_date: 2014-01-22 11:17:28
@_author: Pete Stephenson 
@_subject: Usage of --symmetric 
When you symmetrically encrypt something you need to specify the
passphrase that is used as a key to encrypt and decrypt that file.

@_date: 2014-01-22 13:52:09
@_author: Pete Stephenson 
@_subject: Spam sent in response to GnuPG-users messages? 
Hi folks,
It appears that there's a spammer who has subscribed to the mailing
list and is sending out "cute girl wants to chat" spam in response to
messages sent to the list.
They're not sending mail to the list itself, but rather to the
individual sender addresses that have sent messages to the list.
Has anyone else received similar messages? Is there some way of
identifying the "trigger" address that's subscribed to the list and
results in these messages being generated? I'd be happy to supply the
spammy messages in question (off-list, of course) if that would help
identify the offending spammer.

@_date: 2014-01-23 21:59:30
@_author: Pete Stephenson 
@_subject: Revocation certificates [was: time delay unlock private key.] 
It's a sensible thing to do both, of course.
The most damage that a misused revocation certificate can do is
revoking one's certificate. This is a bit of a pain, in that one would
need to create a new keypair, get it signed, etc., but it wouldn't
result in the compromise of sensitive information, messages, etc.
Misuse of a revocation certificate is a minor denial-of-service, but
not a complete break of security.
For example, one could easily give a trusted friend or family member a
copy of a revocation certificate (perhaps printed on paper) to keep in
a physically distant location. They would need to be trustworthy
enough to not abuse the revocation certificate by revoking your
certificate, but otherwise would not need to be given absolute trust
that comes with having a copy of the private key. Same thing with
keeping revocation certificates in a bank safe deposit box or some
other location protected by a third-party -- if the box were
compromised (say by the authorities with a court order), your private
key would not be compromised.
Actually, that's a fairly reasonable scenario. Someone may have
forgotten their passphrase for whatever reason (ranging from
forgetfulness to head trauma) and would like to inform others that
their key is no longer usable. Replying to people saying that their
key is lost is essentially indistinguishable from a man-in-the-middle
attack -- some people might simply resend the encrypted message in
plaintext, defeating the purpose of encryption in the first place.
A revocation certificate allows one to revoke the certificate even
without access to the private key, so one could reply with their
now-revoked public key (or direct someone to the revoked key on the
keyserver) and say "Sorry, I lost the private key and had to revoke
it." -- while this doesn't resolve the issue of people resending
things in plaintext, it does permit someone to actually show that
their key is, in fact, revoked.
Also, not all keys have expiration dates. I, for one, tend not to set
expiration dates on my primary keys, but instead rotate encryption and
signing subkeys (which do have expiration dates) for day-to-day use.
While I could put an expiration date on the primary and extend the
date as needed, it's easier for me to just make revocation
certificates and keep them stored off-site.
Your mileage may vary, of course.

@_date: 2014-01-24 14:42:30
@_author: Pete Stephenson 
@_subject: his public key is 5 monitors high, and her same key is 1 ? 
As far as I can tell, the two major factors that affect the size of
public keys are:
1. Key length. (That is, a 4096-bit key will be larger than a 2048-bit
or 1024-bit key.)
2. Number of signatures on the key. A brand-new key will be
considerably shorter than one that has accumulated numerous signatures
from other people.
Key length does have an effect on security: 2048-bit keys are larger
and harder to brute-force than 1024-bit keys. The same applies to 3072
and 4096-bit keys compared to 2048-bit ones, though there is a point
of diminishing returns.

@_date: 2014-01-25 22:31:28
@_author: Pete Stephenson 
@_subject: trying to find a folder 
The folder containing the keyrings and configuration files is
typically in ~/.gnupg/ on Linux and in %appdata%/gnupg on Windows,
though it may be different on your specific system.

@_date: 2014-07-03 13:13:31
@_author: Pete Stephenson 
@_subject: =?UTF-8?Q?Re=3A_Analogien_um_das_Prinzip_von_PGP_zu_erkl=C3=A4ren?= 
I seem to recall someone on this list using a mailbox like the one at [1]
as an analogy for public-key encryption: anyone can walk up to the mailbox
and place a letter in the slot ("encrypting a message to the recipient's
public key"), but they cannot retrieve any other letters in the box [2].
That type of mailbox is essentially a "one-way" device, and messages placed
in the mailbox can only be retrieved by someone who has the key to unlock
it (the "private key" belonging to the recipient).
I'm not really sure of a similar analogy for signing.
[2] Obviously mailboxes can be broken into with relative ease, but it's
merely an example.
2014-07-03 12:50 GMT+02:00 Daniel Krebs :

@_date: 2014-07-11 14:50:48
@_author: Pete Stephenson 
@_subject: GPG4Win question 
In Windows 7 at least, it's in %appdata%\Roaming\gnupg

@_date: 2014-07-28 20:04:23
@_author: Pete Stephenson 
@_subject: CRC error 
The CRC checksum can't tell the difference between intentional modification
of the type you describe and data corruption; it simply knows that the
checksum doesn't match what it thinks it should be, so it presents the
mean that only
When would this be useful? The public key is public, and anyone with it
could decode the message. To secure a message such that only the desired
recipient can read it, you should encrypt a message to the recipient's
public key so that only their private key can decrypt it.
Simply put, I don't understand a situation where using your system would be
an improvement over the current system, but perhaps I misunderstand
only the person
check for that.)
Because the key was modified in a way that GPG did not expect.
The public key can be (and is) regenerated as needed from the private key.
If you import a private key and there is no corresponding public key in the
keyring, GPG automatically recreates the public key and puts it in the
keyring. As far as I know there is no way to import only a private key
without the corresponding public key.

@_date: 2014-06-05 12:06:10
@_author: Pete Stephenson 
@_subject: list packets output & other misc 
To clarify, it's the exclamation point ("!") that forces GPG to use a
specific key. Normally GPG will pick what it thinks is the appropriate
key, but the exclamation point will override that automatic choice and
use only the key ID specified by the user.
I'm not aware of any email clients that allow such an override -- it's
typically only used in the command line.
has some more details.
Specifically, that information is available at
, in sections 9.1 through
9.4, inclusive.

@_date: 2014-06-08 18:16:48
@_author: Pete Stephenson 
@_subject: Alice, Blake, Chloe and Dharma. 
True, but there is a Carol, Charles, Dave, etc. Typically (but not
always) the names aren't just a placeholder for a participant, but the
first letter of the name means something (e.g. "Eve" is an
"eavesdropper" who can see but not modify the data between Alice and
Bob, "Mallory" is a malicious attacker who can perform active attacks,
See  for details.
Bruce Schneier's book "Applied Cryptography" was published in 1996 and
contains reference to several of those names. I'm not sure if that's
the origin of their use in this context, though. Anyone else?

@_date: 2014-06-24 11:42:33
@_author: Pete Stephenson 
@_subject: riseup.net OpenPGP Best Practices article 
I also generally agree that the default key size is a sensible choice
for most users.
I would think that adversaries will not try breaking the crypto at all:
there's plenty of alternatives, from keyloggers to compelling the sender
or recipient (through legal means or otherwise) to decrypt the message,
that require considerably less resources. ObXKCD: That said, is there any particular reason for avoiding SHA-2?
There's been discussion in the past regarding some other OpenPGP
software not playing nicely with SHA-512, with recommendations to not
use SHA-512. Is that still an issue? I've not run into any issues, but
that's merely an anecdote.
Would SHA-256 be a better (in the context of being more compatible)
choice if one preferred using a non-SHA-1 hash?
Absolutely. Obviously, using a too-weak key (e.g. 512-bit RSA) is a
problem, but key size is not an issue with the defaults.

@_date: 2014-03-10 17:18:58
@_author: Pete Stephenson 
@_subject: Size of client key jumped from 2KB to 25KB 
Adding "--export-options export-minimal" should do the trick.
That is, "gpg --output client-key.gpg --export --export-options
export-minimal  -a ID49C207DF".
See for details.

@_date: 2014-05-25 21:33:30
@_author: Pete Stephenson 
@_subject: what hardware entropy usb key equivalent Simtec entropy key take ? 
seems to be the closest I've seen in regards to a "USB stick" form
factor and price. It doesn't use the ekeyd daemon for adding entropy
to the pool, but rather shows up as a virtual serial port and one can
use rngd to feed that data into the kernel pool. I have no personal
experience with that product, but it would seem that even if the
entropy source was compromised in some way, that would not be a major
issue -- rngd does tests to detect biasing (which admittedly won't
catch more subtle manipulation) and /dev/random would stir the pool
with entropy from various sources, so it can only help.
While not a direct, drop-in replacement for the Entropy Key, I found
that a Raspberry Pi and it's internal hardware random number generator
makes a good source. The internal HWRNG in the Pi is extremely fast
(>700kbps). I've not personally setup a Pi to share entropy over the
network, but I'd imagine this is something that could be reasonably
done. I only have the HWRNG generating entropy for local use. Anyone
have experience with a network setup?
In regards to getting the Pi's HWRNG setup,
 has all the details.
It's basically three steps:
1. Add "bcm2708_rng" to /etc/modules, then run "modprobe bcm2708_rng"
to activate the module.
2. Install the rng-tools package.
3. Edit /etc/defaults/rng-tools to access the HWRNG and feed the kernel pool.
My /etc/defaults/rng-tools file looks a bit different than that of the
previously-mentioned website. Here's the relevant lines from my file:
 the HWRNG device
# Check the kernel entropy pool once per second, and add HW-generated
entropy if it drops below 90%.
# You can change these values to whatever you feel would work best for you.
RNGDOPTIONS="--fill-watermark=90% --feed-interval=1"
Please note this assumes that the HWRNG has not been subverted,
broken, or doing something unexpected.
I hope this helps.

@_date: 2014-11-10 18:01:00
@_author: Pete Stephenson 
@_subject: ECDSA vs EDDSA 
As Kristian mentioned, deterministic DSA [RFC 6979] solves this
problem for both regular DSA and ECDSA.
I've been under the (possibly erroneous) impression that GnuPG has
used deterministic DSA for some time now. I'd hope that it does the
same for ECDSA.
If so, a quality source of randomness is needed only for key
generation, not for each signature.
While the NIST curves are suspicious in that they utilize an
unexplained "random" seed[1], I don't see how the Brainpool curves
were chosen for nefarious purposes.
Indeed, pages 6 and 7 of
 shows the
exact process to derive both the seed and the pseudo-random primes
used in those curves.
At  djb says the Brainpool
curves are "mostly rigid" and has only a limited number of criticisms:
"Why SHA-1 instead of, e.g., RIPEMD-160 or SHA-256? Why use 160 bits
of hash input independently of the curve size? Why pi and e instead
of, e.g., sqrt(2) and sqrt(3)? Why handle separate key sizes by more
digits of pi and e instead of hash derivation? Why counter mode
instead of, e.g., OFB? Why use overlapping counters for A and B
(producing the repeated 26DC5C6CE94A4B44F330B5D9)? Why not derive
separate seeds for A and B?"
There's several other standards (such as RCF 3526) that generate
primes, in part, using large powers of pi. It seems to me to be a
reasonable "nothing up my sleeve" number. As for the other concerns,
would the use of (for example) SHA1 vs. SHA256 or the use of counter
mode as part of the generation algorithm give the malicious
standards-writer some advantage?
Maybe, but it seems much less likely to be manipulated than, say, the
NIST curves or ANSSI FRP256v1, and more likely to be the result of
some ordinary technical decision-making.
[1] It's certainly possible that NIST/NSA just used /dev/random or
some other quality source of randomness for the seed, but there's no
way to *prove* that, so the seeds for the NIST curves are not above
suspicion. Still, it would require a *lot* of effort to get a
particular output of SHA1 that had certain useful properties. Would
the NSA expend that effort? Who knows?

@_date: 2014-11-14 10:36:22
@_author: Pete Stephenson 
@_subject: Fermi estimates 
Minor nitpick: the difference between the "long" and "short" scales
are a bit more involved than just "imperial" vs. "SI".
More details are at But yes, avoiding ambiguous words like "billion" is a good idea. Using
notation like 10^9, 10^12, etc. would make things more clear to
readers regardless of what words they use to describe those numbers.

@_date: 2014-11-17 20:15:09
@_author: Pete Stephenson 
@_subject: card is permanently locked! 
I have, and it works fine (if "fine" is defined as "completely erasing
the card and starting from factory-fresh settings") on version 2
cards. Version 1 cards will be bricked according to [1].
I use the strategy outlined at [1]:
1. Add the following lines to a text file called "reset.txt", omitting
the equals signs:
scd serialno
scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 81 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
scd apdu 00 20 00 83 08 40 40 40 40 40 40 40 40
scd apdu 00 e6 00 00
scd apdu 00 44 00 00
2. Insert the smartcard to be reset.
3. Run "gpg-connect-agent < reset.txt"
4. Remove the smartcard.
5. Wait a few seconds, then reinsert the smartcard.
6. Run "gpg --card-status": the card should show as factory fresh[2].
[1] [2] Fresh scent of pine is optional.

@_date: 2014-10-02 11:15:42
@_author: Pete Stephenson 
@_subject: NSA, PGP and RSA 
Excellent! Welcome!
There were some reports of RSA (the company) accepting funds from the
NSA to make Dual_EC_DRBG (a poor-quality and possibly backdoored
pseudorandom number generator) the default in their BSAFE toolkit.
RSA (the algorithm) is, as far as publicly-available knowledge goes,
still secure with appropriate key lengths and the non-existence of
suitably-powerful quantum computers.
Version 2.1 of GnuPG will support elliptic curve crypto, which will be
nice. However, ECDSA and ECDH (the signing and encryption algorithms
used in GnuPG 2.1) are also vulnerable to quantum computers.
Of course, it's certainly possible that the NSA or other adversaries
have compromised RSA or other algorithms, but there's no
publicly-available proof of this.

@_date: 2014-10-03 17:40:38
@_author: Pete Stephenson 
@_subject: [Announce] The maybe final Beta for GnuPG 2.1 
When I run
make -f build-aux/speedo.mk native
it does quite a bit, but always seems to spit out the following errors
and fails to complete. The bit about gnutls is non-critical for me,
but it'd be nice to resolve it. The "required libraries not found"
error seems to be a showstopper, though.
I'm doing the build on a stock Ubuntu Server 14.04 32-bit system. I've
installed the "build-essential" package from the repo, so I have gcc,
make, etc.
configure: WARNING:
*** Building without NTBTLS and GNUTLS - no TLS access to keyservers.
*** No package 'gnutls' found
configure: error:
*** Required libraries not found. Please consult the above messages
*** and install them before running configure again.
make[1]: *** [/home/pete/gpg/gnupg-2.1.0-beta864/PLAY/stamps/stamp-gnupg-01-configure]
Error 1
make[1]: Leaving directory `/home/pete/gpg/gnupg-2.1.0-beta864'
make: *** [native] Error 2
Any ideas?
Thanks for the reminder.

@_date: 2014-10-04 00:28:15
@_author: Pete Stephenson 
@_subject: [Announce] The maybe final Beta for GnuPG 2.1 
Now I get "Requested 'gnutls >= 3.0' but version of GnuTLS is 2.12.23"

@_date: 2014-10-15 14:54:46
@_author: Pete Stephenson 
@_subject: [Announce] The maybe final Beta for GnuPG 2.1 
Success! Installing the libldap2-dev package resolves the issue and
the build process completes with no other errors.
When I add PLAY/inst/bin/ to my path and PLAY/inst/lib/ to the list of
shared libraries, everything works as expected.
Many thanks for your help and patience.

@_date: 2014-10-21 09:25:44
@_author: Pete Stephenson 
@_subject: smart card under linux 
What is the result of running the command:
echo $GPG_AGENT_INFO

@_date: 2014-10-21 14:58:24
@_author: Pete Stephenson 
@_subject: smart card under linux 
Interesting, thanks.
In the past when I've had issues similar to yours it turns out to be
the Gnome Keyring's GPG agent causing trouble[1] since it doesn't
support smartcards. However, that doesn't seem to be the case with
your issue (if it was, the command would mention "keyring" rather than
Perhaps others have a better idea what's going on?
[1]

@_date: 2014-10-26 22:08:23
@_author: Pete Stephenson 
@_subject: [Announce] The maybe final Beta for GnuPG 2.1 
My apologies for not responding earlier.
I used the same method, only I used "sudo ldconfig

@_date: 2014-10-31 14:14:41
@_author: Pete Stephenson 
@_subject: [Announce] The maybe final Beta for GnuPG 2.1 
Hi all,
I had a few minor issues/questions with GnuPG 2.1 beta895 that I
thought would be good to report/ask here:
1. Default key prefs[1] don't seem to permit encrypting+signing a
message to a brainpoolP512r1 key. Evidently that curve requires SHA512
only for signatures, and all other algorithms will fail. Since SHA256
and SHA384 are prioritized over SHA512 by default in the key prefs, an
error occurs.
Here's an excerpt of the terminal output, where AF25682B is a primary
test key using brainpoolP512r1 while D74B165F is a test encryption
subkey using the same curve:
pete at kaylee:~/gpg/gnupg-2.1.0-beta895/PLAY/inst/bin$ ./gpg2 --homedir
~/gnupg/ --encrypt --armor --sign -r AF25682B
gpg: NOTE: THIS IS A DEVELOPMENT VERSION!
gpg: It is only intended for test purposes and should NOT be
gpg: used in a production environment or with production keys!
Hello world!
gpg: ECDSA key D74B165F requires a 512 bit or larger hash (hash is SHA256)
gpg: checking created signature failed: General error
gpg: signing failed: General error
Hash: SHA512
2. While Curve25519-based keys can be used for signing using Ed25519,
there doesn't seem to be any way to use Curve25519 for encryption.
While one could use non-Curve25519 subkeys for encryption, that seems
a little sub-optimal. I assume this is known already and will be
resolved prior to the production release.
3. Curve25519 has a security level of 128-bits. In addition to the
Brainpool curves, are there any plans to add other curves with higher
security levels like Curve41417 (>200-bits)? I ask simply because
having various components (e.g. the symmetric, asymmetric, and hash
algorithms) at similar security levels is logical: it wouldn't make
sense to, for example, use 1024-bit RSA with SHA512 due to the wide
difference in security levels, but using a 3072-bit RSA key with
SHA256 would be logical.
4. Are there any plans to add user-specified arbitrary curves in
addition to "baked-in" curves like the NIST, Brainpool, and Curve25519
curves? I realize that using arbitrary curves is something that is not
for the faint of heart, but having options is nice.
5. Why are so many key-generating options hidden behind the
"--full-gen-key" flag? The regular "--gen-key" flag makes a 2048-bit
RSA key, which is fine. I understand hiding the ECC options, as
support is not widespread, but why hide "traditional" algorithms like
[1] Cipher: AES256, AES192, AES, 3DES
     Digest: SHA256, SHA384, SHA512, SHA224, SHA1
     Compression: ZLIB, ZIP, Uncompressed
     Features: MDC, Keyserver no-modify

@_date: 2014-09-06 23:40:03
@_author: Pete Stephenson 
@_subject: Is it possible to sign a message with multiple digest algorithms? 
Hi all,
Is it possible to sign a message (or certify a key) with multiple digest
For example, one might wish to sign a message with both SHA256 and
If so, how would one go about doing this?
I would imagine that, if possible, the command would be similar to "gpg
--armor --digest-algo SHA256 RIPEMD160 --clearsign" but this fails.
If it is possible, how does GPG handle multiple signatures? That is, is
it required that all signatures must be valid for the message to be
considered valid, or is the message considered valid so long as one (out
of many) signatures is valid?
The former behavior would be useful to ensure message long-term message
integrity, in case one of the digest algorithms were found to be weak.
The latter behavior would be useful when using digest algorithms without
wide support (e.g. one might use SHA1 and SHA512, so as to support older
clients while providing greater security for modern ones).

@_date: 2014-09-15 11:32:59
@_author: Pete Stephenson 
@_subject: Help about GnuPG 1.4.9 
Welcome! Hopefully we can get you straightened out!
GnuPG 1.4.9 is a bit out of date.  should have a
more recent version, but it seems that it will only work back to Mac OS
X 10.6, not 10.5.
Can you upgrade to a newer version of Mac OS X? 10.5 is quite old and
reached end-of-life in 2011.
You might find
to be of some interest.
It's possible that Mac OS X 10.5 does not have gpg, openssl, or sha1sum
installed. I'm not familiar with systems that old.
However, it appears that the system does have a means of calculating MD5
checksums. You should be able to run the following command from a terminal:
Alternatively, if the Mac has GPG installed already (I know that newer
versions of Mac OS X do, but I'm not sure about 10.5), you can run the
following from the terminal:
gpg --print-md MD5 /Users/alain1/Desktop/GnuPG1.4.9.dmg
What happens if you run the command without the square brackets ([]) or
the single quotes (')?
For example,
openssl md5 /Users/alain1/Desktop/GnuPG1.4.9.dmg
OpenSSL is installed in newer Mac OS X systems, but might not be
installed on 10.5. If it's not installed, you could install it but
that's typically not a trivial thing to do.
Check if it's installed by running:
openssl version
from the terminal.
As for your other questions, I'm not sure. Hopefully someone else can

@_date: 2014-09-18 12:35:13
@_author: Pete Stephenson 
@_subject: Keeping .gnupg folder in cloud 
In general, I'd recommend against it, but in your specific situation I
don't really see a problem.
Some people have gone so far as to publicly publish (is that redundant?)
their encrypted private keys[1] to the internet. Assuming that the
crypto is sound and the passphrase protecting the key is strong, and
your system has not been compromised (e.g. there's no keylogger),
there's very little to worry about. Still, probably not a good idea.

@_date: 2014-09-18 23:10:05
@_author: Pete Stephenson 
@_subject: gmail list replies [Re: Keeping .gnupg folder in cloud] 
I use Google Apps (in essence, Gmail for one's domain). "Reply"
composes a response to the sender (but not the list). "Reply All"
composes a response to the sender and CCs the list.
I have not observed the behavior that Sudhir reports. Perhaps things
behave differently between Gmail and Google Apps? There's some other
minor differences, but for everything else the compose/reply options
have always seemed to be quite similar.

@_date: 2015-04-19 12:08:43
@_author: Pete Stephenson 
@_subject: failed decryption 
In such cases it might be worthwhile to use some sort of
error-detection/correction system. Detecting errors is relatively
straightforward (you can sign a message and if the signature fails,
it's been modified) but correction is slightly more complex.
I generate PAR2 error-correction files[1] for important files or
archives. It allows one to detect errors and repair/recover any
damaged or lost sections up to a user-defined threshold. It uses more
disk space, but it can be a life-saver when dealing with critical
files on unreliable storage (and all storage is unreliable).
Alas, it's not retroactive and can't repair already-damaged data: you
need to generate the PAR2 files when the original file is still
undamaged and can then use it to recover damaged data later. In the
case of sensitive data, one should encrypt the data first and then
generate the PAR2 files -- that way no information about the encrypted
content can leak.
[1]

@_date: 2015-12-23 15:34:51
@_author: Pete Stephenson 
@_subject: gpg: BAD signature from 
Hi Steve,
The error means that the data you downloaded doesn't match the data
that was originally signed by the author. It's possible this could be
due to an error by the signer, a transmission error over the internet,
or intentional tampering.

@_date: 2015-02-07 21:16:03
@_author: Pete Stephenson 
@_subject: How to reset the PIN counter 
the PIN
 should
have the info you need.
I save the reset code block to a text file ("reset.txt") and then run "
gpg-connect-agent < reset.txt". Remove and reinsert the card and it should
be back to factory defaults.
It is worth pointing out that this completely nukes any keys on the card.

@_date: 2015-02-08 07:35:44
@_author: Pete Stephenson 
@_subject: How to reset the PIN counter 
On Feb 7, 2015 10:36 PM, "Duplicity Mailing List" <
In retrospect I should have, but the output of gpg --card-edit Rainer
posted showed he was using a version 2 card so it should be ok. My
apologies for any confusion.

@_date: 2015-02-19 09:16:29
@_author: Pete Stephenson 
@_subject: Help need to use truecryt + openpgp applet. 
Considering the way it was abandoned by its developers, TrueCrypt is
probably not the best choice going forward.
That said, TrueCrypt only supports smartcards that use PKCS libraries. Does the JavaCard you're using support PKCS  Does the
OpenPGP applet?

@_date: 2015-02-20 09:32:43
@_author: Pete Stephenson 
@_subject: Help need to use truecryt + openpgp applet. 
No malice implied. My apologies if I was unclear.
I just feel that using publicly-abandoned security software,
particularly when it hadn't been updated in the two years leading up
to its abandonment and used old, crufty build dependencies[1] that
hadn't been updated in decades, is probably unwise if one desires a
high degree of security.
Don't get me wrong: I really like TrueCrypt and think it was a great
cross-platform disk encryption program that was remarkably easy to
use, but using it as a part of new projects probably isn't a good
[1]

@_date: 2015-01-02 19:59:21
@_author: Pete Stephenson 
@_subject: Thoughts on Keybase 
At present, I have 10 invites and would be happy to share them with
those who are interested. Please contact me off-list as well.

@_date: 2015-01-22 19:24:40
@_author: Pete Stephenson 
@_subject: Crypto device where I need to confirm every operation? 
You can always enable the "forcesig" option, which requires that the
PIN be entered for every signature operation (you can enable by
inserting the card and then running'gpg --card-edit', then entering
'toggle', 'admin', 'forcesig').
I'm not aware of any similar option in regards to decryption.

@_date: 2015-03-10 15:36:36
@_author: Pete Stephenson 
@_subject: AES-NI, symmetric key generation 
Yes, but the security is only as strong as the weakest link: if one uses
a weak passphrase to encrypt a message, an adversary could guess the
If one used a long random string as a passphrase, this is functionally
equivalent to a strong key, so why bother with using the key itself to
decrypt instead of the passphrase?
You can show the symmetric session key for a message using the
"--show-session-key" option.
Here's an example of text I encrypted with "gpg --symmetric":
The passphrase is "test" (no quotes).
pete at kaylee:~$ gpg --show-session-key < example.txt
[prompt for password]
gpg: CAST5 encrypted data
gpg: gpg-agent is not available in this session
gpg: encrypted with 1 passphrase
gpg: session key: `3:62A2421F805F6CB1767A9DF07983ADDF'
gpg: example.txt: unknown suffix
Later, I can use gpg with the "--override-session-key" option to supply
the decryption key directly. Use "gpg --override-session-key [session
key]", using the format given above:
pete at kaylee:~$ gpg --override-session-key
3:62A2421F805F6CB1767A9DF07983ADDF < example.txt
gpg: CAST5 encrypted data
gpg: encrypted with 1 passphrase
Hello world!
gpg: WARNING: message was not integrity protected
See the manpage or  for
more details.
One interesting note about show/override-session-key: if one is
compelled to decrypt a message (or else...), one can use those options
on messages encrypted using GnuPG's symmetric or the more usual
asymmetric (i.e., public key) encryption methods. The manpage says,
"This option is normally not used but comes handy in case someone forces
you to reveal the content of an encrypted message; using this option you
can do this without handing out the secret key."
In other words, if you're compelled to decrypt a message that was
encrypted to your public key, you don't need to hand over your private
key (which would allow someone to decrypt all your messages, sign new
messages, etc.). Instead, you would just hand over the encrypted message
and the session key used to encrypt it. Since each message uses a new,
random session key, only that single message can be decrypted and your
private key is not compromised.

@_date: 2015-03-10 22:32:11
@_author: Pete Stephenson 
@_subject: AES-NI, symmetric key generation 
No worries.
No. It was a nearly "out of the box" setup with only some minor changes
to my gpg.conf file in regards to accessing keyservers. Nothing that
would affect the modes of encryption.
Works fine for me. Try copy-pasting the text into the command prompt
rather than reading from a file. Use Ctrl-Z then Enter to tell GnuPG
you're done entering a message and it should start processing things.
Here's an encrypted message I generated with "gpg --symmetric --armor"
on GPG4Win 2.2.3:
(password is "test" with no quotes)
gpg --show-session-key yields a session key of
The same message encrypted a few seconds later with the same password
and a session key of "3:A81A96428D44DEAD3A6079CC22145B51
It appears that GnuPG uses the iterated-and-salted secret-to-key method
(see  ) to generate
the session key.
You're right: the key is derived from a passphrase and so is not truly
random, but the salt is random which helps a bit. Of course, the salt is
not encrypted, so the message protection depends only on the strength of
your passphrase.
The attacker would be able determine quite a bit of information about
how the message was encrypted (as this same information would be needed
by a legitimate user to decrypt the message):
Here's an excerpt from the double-verbose (-vv) output from the second
encrypted message above (all this is available without entering the
:symkey enc packet: version 4, cipher 3, s2k 3, hash 2
        salt 8272250a9f3a68ba, count 2752512 (181)
The attacker would know the cipher being used (cipher 3 = CAST5), the
fact that the key is derived from a user-provided string (the fact that
s2k is used), which string-to-key algorithm is used (s2k 3 =
iterated-and-salted), the hash used (hash 2 = SHA-1), the salt, and the
number of times to iterate the S2K algorithm.
The attacker won't know the strength of your passphrase -- it could be
"cat" or a long string of random characters -- but it tells them that
the key was generated using user-provided input.
GnuPG follows the OpenPGP standard (RFC 4880). The standard defines
certain key derivation algorithms and provides the ability to add new
ones if needed. Adding new key derivation algorithms in the future
should not have any affect on existing encrypted messages.
Since each message clearly identifies the algorithm used to encrypt it,
future versions of GnuPG should have no problem decrypting it. Indeed,
the current version of GnuPG is able to decrypt messages generated from
old (even ancient!) versions of PGP and GnuPG with few, if any, issues.

@_date: 2015-03-11 20:39:58
@_author: Pete Stephenson 
@_subject: AES-NI, symmetric key generation 
Indeed. The folks who created the OpenPGP standard were quite
forward-thinking in regards to such things.
Ah, that was my mistake: I forgot to specify that --show-session-key
only works when decrypting a message. Considering the intended purpose
of that option (being compelled to turn over a key), I suppose that's a
reasonable limitation in when it can be used.
You'd have to ask Werner, the head developer, about that.
RFC 4880 completely specifies how the algorithms are implemented. In
theory, it should be possible to split a message into it's various
packets (gpgsplit is designed to do this), then decrypt the
symmetrically-encrypted packet using the method specified in the RFC,
but I have not attempted to do this.

@_date: 2015-03-12 11:08:50
@_author: Pete Stephenson 
@_subject: AES-NI, symmetric key generation 
I (perhaps incorrectly) interpreted the question as "If GnuPG makes
backwards-incompatible changes in the future, would it be possible for
one who knows the encryption algorithm used, key, etc. of a message to
decrypt that message with other, non-GnuPG tools?"
For example, if one knows that CAST5-CFB, ZIP, and salted-and-iterated
S2K was used (as well as the value of the salt and number of
iterations), might one be able to decrypt the message using OpenSSL
and other common utilities? I suspect yes, as the encryption and
compression methods are standards, but doing so would probably be
I could be wrong with both the interpretation of the question and the
answer, though.

@_date: 2015-03-13 00:32:00
@_author: Pete Stephenson 
@_subject: bugs.gnupg.org TLS certificate 
StartSSL's a great choice, as one can issue as many certificates as
one wishes for validated domain names.
Alternatively, several CAs[1][2] offer free certificates to
open-source projects. Resellers[3][4] also offer quite
reasonably-priced ($9 USD/year) certs as a standard price.
Full disclosure: I'm a paying customer of StartSSL, Gandi, and
NameCheap, and have several certificates from each for different
purposes. Other than being a customer, I have no other interest in
those organizations.
[1] [2] [3] [4]

@_date: 2015-03-17 22:58:47
@_author: Pete Stephenson 
@_subject: Defaults 
I mostly agree. However, I have a few minor points:
- Above RSA-2048, keys and signatures become quite large. DSA signatures
increase slightly, but are considerably smaller than RSA signatures.
As long as we're considering "legacy" algorithms like RSA and DSA, is
there any particular reason for preferring RSA over DSA at such key
lengths? I know that DSA is only defined up to DSA-3072, so those who
wish to use larger keys would need to use RSA or ECC, but why not use
DSA as the default?
Is Deterministic DSA only available in 2.1, or do 1.x and 2.0.x also
have that feature?
- The Brainpool curves are similar in structure to the NIST curves,
though their curve parameters are chosen in a clear, open manner. While
that leads to increased trust that the parameters aren't chosen for
nefarious purposes, if one is already making a major change to ECC, why
not use some other, more modern curve that's designed at a high-security
Curve M-511 comes to mind, as it's similar to Curve25519 (which GnuPG
already implements).
See  -- djb and Lange clearly lay out their
criteria for different curves and why they're categorized they way they
are. I'm nothing more than an interested amateur in this subject, but
why not benefit from their efforts?
Do you have a link to this discussion on the IETF list? I suspect the
community here would be very interested.
Is there something particular about IDEA that concerns you?
Alas, a lot of Linux distributions are quite slow-moving: it's unlikely
that distributions like Debian and Ubuntu will have GnuPG 2.1.x
available (let alone installed by default) for several years.
Yes, the changes should be made, but ECC support won't be widely
available to most users for some time.

@_date: 2015-03-17 23:46:36
@_author: Pete Stephenson 
@_subject: Defaults 
Agreed. It's always a bit tedious to see large in-line signatures with
short messages. PGP/MIME, as you say, alleviates this issue somewhat by
hiding the signature, but it also tends to be somewhat fragile when
mailing lists are involved...but that's a different story altogether.
Yeah. I'm skeptical of non-RFC6979 DSA simply because it can fail
catastrophically if insufficient entropy is not available when making a
signature. RSA only requires entropy when generating a new key, while
DSA needs it for key and signature generation.
If DSA uses RFC6979 I have no issues with it.
*laughs* Indeed!
I hope that everyone understood my point to be "Since GnuPG is already
making a major change by implementing ECC, it'd probably be a good idea
to Do Things Right The First Time(tm), implement strong curves, and make
them the default."
Of course, it'd be a good thing to work with developers of other
OpenPGP-compatible software to ensure that such algorithms would be
widely supported even though the standards don't yet include such
True, but that's not uncommon: OpenVPN in TLS mode renegotiates a new
session key ever hour by default. GnuPG generates new session keys with
each message. Are there any common cryptographic implementations that
would use the same symmetric key for long periods of time?
Interesting, thanks.

@_date: 2015-03-26 10:29:09
@_author: Pete Stephenson 
@_subject: upgrading v1 to v2 
Any particular reason you want GnuPG 2.0.x instead of 2.1? There's very
little difference for most users between 1.x and 2.0.x.
2.1.x adds ECC support, which is nice, but there aren't any packages yet
for it in Ubuntu.
Since you're on Ubuntu you could just run "sudo apt-get install gnupg2" and
GnuPG 2.0.x would be installed alongside 1.x. Although it wouldn't show the
latest version number it'd still have all the security updates backported.
Compiling from source is not for the faint of heart. Fortunately, the
gnupg2 package exists on Ubuntu and makes the installation easy.

@_date: 2015-03-26 18:40:15
@_author: Pete Stephenson 
@_subject: Enabling and using ECC keys (any reason not to?) 
Although Dual_EC_DRBG uses elliptic curves, the weakness in that
algorithm lies with the alleged backdoor in Dual_EC_DRBG itself and
not in the mathematics behind elliptic curve crypto in general.
GnuPG 2.1 implements the following curves:
   (1) Curve 25519
   (2) NIST P-256
   (3) NIST P-384
   (4) NIST P-521
   (5) Brainpool P-256
   (6) Brainpool P-384
   (7) Brainpool P-512
People have raised concerns about the NIST curves, but they are part
of the RFC 6637 standard so compliant programs must implement P-256,
may implement P-384, and should implement P-521.
To address potential concerns with the NIST curves, GnuPG also
supports the Brainpool curves which are similar in structure to the
NIST curves but use parameters chosen from nothing-up-my-sleeve
numbers and so should be reasonably trustworthy. Still, the structure
of such curves leaves a bit to be desired (see
 for details, I'm hardly an expert).
Additionally, GnuPG implements the non-standard Curve25519 (but only
for signing at the moment -- encryption will come later after things
have been standardized) which should be safe.

@_date: 2015-11-17 16:16:56
@_author: Pete Stephenson 
@_subject: backing up keys 
No need to apologize: that's how we all learn.
In addition to the security of your backups, one of your concerns should
be "How easily can I recover the key?"
If the procedure is complex, error-prone, and/or relies on the
availability of certain software that might not be available, it may be
less likely to work in the future.
Also, as Andrew says, what's your use case? Protecting your backed-up
private keys from you being forgetful or a destructive event like a
house fire or flood is different from protecting your keys from active
adversaries backed by force of law (e.g. feds with search warrants).
Using myself as an example, my two primary keys are each backed up to a
set containing:
1. Two CD-Rs from different manufacturers (for reliability).
2. Two USB flash drives from different manufacturers.
3. A Paperkey-produced printout.
4. A printout that consists of the ASCII-armored private key printed in
an OCR-friendly font. Additionally, each printout contains a QR code of
each line of the ASCII-armored private key so I can easily scan each
line without having to manually type everything in.
Obviously, recovering the key from  or  is the easiest, while  and
 are for last-resort recovery.
For my RSA primary key, I also keep a copy of the primary key on an
OpenPGP Smartcard which is kept with the set.
For each key, I make two such sets: one set stays at home in a locked
box, while the other is in a safe deposit box in a bank thousands of
miles away near my in-laws.
Additionally, I store printouts of revocation certs for those keys.
Since I have the private keys backed up, they shouldn't be necessary,
but you never know.
Overkill? Perhaps, but I've lost private keys in the past and it's a
pain. My main concerns are loss/destruction of the keys and electronic
compromise: thieves are more likely to care about my TV and shiny
computer rather than my PGP keys, and the authorities are unlikely to
care enough about me to seize the keys from my home or the bank vault
(even if they did get them, they'd need to crack the passphrase). Your
mileage may vary.
What if you can't recall the passphrase? You may have the encrypted
private key available from your backups, but if you don't have the
passphrase it won't do you much good.
Here's a few ideas for what you could do:
1. Split your passphrase up using something like Shamir's Secret Sharing
(a handy tool for accomplishing this is
 -- you can keep some shares for
yourself and give others to friends for safekeeping.
Shamir's Secret Sharing allows you to set a threshold for the number of
shares needed to recover the secret. For example, you could generate ten
shares and require three to recover the passphrase. You keep three
shares for yourself (so you can recover the passphrase any time you
want) and give seven to friends. If your house burns down and you lose
your shares, you'd just need to ask any three of those friends to give
you their share and you're good to go.
Any adversary that has fewer shares than the threshold (e.g. if they
only have two shares) gains no insight into your passphrase, which is
useful for security.
2. Print out your passphrase and store it with the backup set. While
handy, this has the disadvantage of also revealing your passphrase to
anyone who has access to the backup set (e.g. a thief), though at that
point you probably have bigger problems like bad guys breaking into a
bank vault or your home.
3. Backup the private key with no passphrase. This is the easiest, but
also the most risky: anyone who gets your key is able to use it without
needing the passphrase.
For clarity, the private key is *never* sent to a keyserver, only the
public key.
The private key and public key are mathematically related: if you have
the private key, GnuPG can automatically generate the public key. The
reverse, of course, is not true.
Put a different way, it can be handy to backup the public key, but it's
by no means necessary.
In theory, you could certainly upload the file to a semi-private service
like Dropbox, or even publicly post your encrypted private key on the
web and it would be secure, assuming you had a strong passphrase.
I wouldn't, since I prefer to have layers of defenses. Guessing my
passphrase is only useful if an adversary has my key.
Short of ninjas stealthily breaking into my home or the bank vault,
there shouldn't be any way of obtaining my private keys in a way that is
not easily detectable.
Sure, you can. I do ( on my list above), but only as a last resort.
However, OCR isn't perfect. Is that "0" the number zero or the letter
"O"? Is that "1" the number one, a lowercase "ell" or an uppercase
"eye"? What if there's a smudge? Do you want to go
character-by-character checking that each character is correct? That's a
pain, especially with large keys: DSA and ECC private keys are
relatively small and can be manually entered and verified without too
much trouble, but RSA keys can get positively massive.
Paperkey adds some checksums that help identify errors.
QR codes have redundancy and error correction and can be (relatively)
quickly scanned with a common webcam. This helps reduce the possibility
of error and speeds up recovery.

@_date: 2015-11-17 15:31:23
@_author: Pete Stephenson 
@_subject: best practices for creating keys 
At the risk of being vague, "best practices" depend on your situation.
The recommendations for someone wishing to exchange private love letters
with their spouse is far different than someone who would be subject to
physical harm, torture, etc. if the content of their messages were
revealed, or if an adversary were able to spoof messages appearing to
come from that person.
That said, using encryption and signing subkeys for day-to-day
operations and keeping your primary key safely stored and backed-up
offline is a reasonable and sensible thing to do in nearly all
Yes, this is a reasonable thing to do.
The two files consist of, respectively, the (a) private and (b) public
components of that keypair.
In the directions provided at the link you mentioned, one creates the
primary key (which consists of the primary signing key and an encryption
subkey) and later creates a second signing subkey.
This bundle of three (sub)keys is exported for offline storage and
backup. There are separate exported files for the private components and
public components.
Later, the primary signing key is removed from the online system and
only the subkeys remain. If one later wished to backup this subkey-only
set of keys, they would be able to export the public components of all
three keys but only the private component to the subkeys. The private
component of the primary key would not be available for export since it
only exists in offline storage.
Yes, your private keys are encrypted and protected with your password.
However, this does little good if an adversary is able to compromise
your computer, copy the encrypted keyfile, and install a keylogger so
they know what password to use to decrypt it.
For typical users, this may not be an issue, but you never know.
In the case where a subkey is compromised, it can be easily revoked and
a new one generated.
In the case where one's primary key is compromised, it would also need
to be revoked and a new one generated, but it also means that one would
need to start from scratch to verify their identity to correspondents
and gain signatures from others -- the primary key represents one's
identity and reputation, so to speak, and rebuilding that can be
time-consuming and tedious.
Far better to take a few extra minutes generating a signing subkey and
moving the primary key to offline storage than dealing with the headache
of re-bootstrapping a new primary key.
Assuming one has a strong password, brute force should be infeasible.
Keyloggers are a definite risk.
Correct on both counts.
Additionally, if the signing subkey in the "laptop keypair" is
compromised, the adversary can sign messages claiming to be from you, at
least until your correspondents check to see if your key is updated and
are able to get the revocation notice.
In some cases, this is a greater risk than the adversary being able to
read private messages.
A revoked encryption subkey can always decrypt messages that were
encrypted to it. However, other users cannot encrypt new messages to a
revoked encryption subkey (assuming the sender knows its revoked, which
is not always the case).
I hope this helps a bit. If I can clarify things more, please let me know.
Again, welcome to the world of GnuPG.

@_date: 2016-08-24 19:07:41
@_author: Pete Stephenson 
@_subject: Unsubscribe me please 
Hi Lynda,
Unfortunately, that's not how it works. Essentially all of us are just
users and can't unsubscribe you. Instead, your message was sent to the
entire mailing list.
Thankfully, the self-service process is straightforward: if you wish to
unsubscribe, just click the link at the bottom of every message sent to the
list and follow the directions to unsubscribe.
On Aug 24, 2016 18:51, "lynda.harlos at sympatico.ca" <

@_date: 2016-02-23 12:55:12
@_author: Pete Stephenson 
@_subject: Can the NSA Crack GnuPG 
That post is a joke. It even says so.
If that happened, yes. So far, there's no credible, publicly available
evidence that this has occurred.
GnuPG is based on an open standard (RFC 4880) that is available for your
perusal at Both the RFC and the GnuPG source code is publicly available. It's
unlikely (though not impossible) that an intentional backdoor exists,
particularly a backdoor that has been inserted undetected not only into
the PGP/GnuPG code, but also into the code of every compiler (including
new ones like LLVM) made in the last 24 years.
If one were particularly concerned, it's possible (albeit costly and
time-consuming) to write one's own disassembler and then disassemble the
compiled code and examine the assembly language for backdoors.
People come in all shapes and sizes, can enter or leave public venues as
they please, move at whatever speeds they wish, and can say whatever
they want. That doesn't make this big guy's statement true, nor does it
imply membership in particular organizations, shadowy or otherwise.
If the NSA (or some other shadowy organization) could, in fact, break
PGP, why would they send someone to an EFF meeting in San Francisco,
have this person reveal this information to strangers, and then run
away? What purpose would that serve? If anything, I'd expect them to
keep such capabilities heavily guarded so they could use such a method
for intelligence-gathering.
The Prime Number Theorem states that the number of prime numbers between
0 and x is:
x / ln(x)
The number of primes less than 2^4096 are thus:
(2^4096) / ln(2^4096)
which is about 1.84*10^1229.
That's a lot of numbers.
You say that one can "reverse factor" (which I interpret as "factor", as
"reverse factoring" is multiplication) as if it's something trivial.
It's not: as far as we know and barring any mathematical breakthrough,
factoring is hard (at least on classical computers).
If you can factor such enormous semiprimes in a reasonably efficient
way, there's a lot of people who would be interested.
Short answer: Not in this universe.
Recall above how I mentioned that there's ~1.84*10^1229 prime numbers
less than 2^4096.
Even if we limit our search for numbers between 2^4096 and 2^4095, that
only reduces the search space by a factor of two. It's still enormous.
Considering there's only about 10^80 (~2^265.75) atoms in the visible
universe, you'd need to fit 2^(4096-265.75) = 1.05*10^1153 prime numbers
per atom in order to store a "chart" of all prime numbers less than 2^4096.
If you could do that you'd likely win multiple Nobel Prizes in different
disciplines. They'd probably have to invent new categories of Nobel
Prizes to award you.
Such a database would be unimaginably vaster than the universe.
Searching it would be all-surpassingly impractical. Leaving aside the
speed of light limitations of searching a database far (I've run out of
superlatives) larger than our universe, if you could get each atom in
the universe to output one of the 1.05*10^1153 prime numbers its storing
every Planck time (5.39*10^-44 seconds), it would still take 1.3*10^1092
times longer than the known age of our universe.
Current cosmological models suggest that the universe will reach its
heat death in about 10^100 years, so searching this database would take
~10^992 times longer than the heat death of the universe. How this would
take place is left as an exercise to the reader.
This doesn't consider the time needed to actually do any useful
computation using that data.
I suspect by the time that such a search was completed, any information
encrypted by PGP would be of little use.
That is unlikely.
Typically primes are chosen by picking random numbers in the desired
range (e.g. around 2^2048, 2^4096, etc.) and performing primality tests
on them. These tests are probabilistic, but if enough tests are
performed the confidence that a number is prime can be made to any
arbitrary level. See As mentioned earlier, factoring is thought (but not proved) to be hard.
Various mathematical improvements in factoring have been made over the
millennia, but short of a major breakthrough in mathematics, it's likely
that factoring-based cryptosystems will be secure until the development
of quantum computers (see
Quantum-resistant cryptographic algorithms are something that interests
the NSA. See
for details.
...assuming that Apple or the Feds can't load modified software onto the
phone that disables the auto-erase, delay, and lockout functionality. It
is, after all, just software.
Even if the functionality is baked into hardware, hardware can be taken
apart, examined, and modified. It's expensive, risks losing the data one
seeks to recover, and is time-consuming, but it's at least somewhat
feasible to do in our universe.
(Any math errors are my own.

@_date: 2016-06-09 09:24:52
@_author: Pete Stephenson 
@_subject: Installing gnupg 
tarball and signature from the website. I have OSX El Capitan. I have
terminal open but it is not clear as to what I need to do, what I need to
type in to Terminal.
Hi Alex,
The tarball is for if you want to compile GnuPG from source. This is
probably not what you want to do.
The GPGtools project has a nice, easy-to-use installer for GPG on OS X.
Their site is at

@_date: 2016-06-09 09:24:54
@_author: Pete Stephenson 
@_subject: Installing gnupg 
tarball and signature from the website. I have OSX El Capitan. I have
terminal open but it is not clear as to what I need to do, what I need to
type in to Terminal.
Hi Alex,
The tarball is for if you want to compile GnuPG from source. This is
probably not what you want to do.
The GPGtools project has a nice, easy-to-use installer for GPG on OS X.
Their site is at

@_date: 2016-03-25 13:47:06
@_author: Pete Stephenson 
@_subject: All mails identified as spams by Google 
yesterday. Google says that the mailing list "is in violation of Google's
recommended email sender guidelines".
of the gmail spam filter.
I've observed the sane thing here on a Google Apps-hosted mail service

@_date: 2016-05-05 01:17:34
@_author: Pete Stephenson 
@_subject: managing OpenPGP cards in batch mode? 
Out of curiosity, where are these rules defined?
The list information page
 doesn't make
any mention of such a rule.
Certainly, there are basic rules of netiquette that should ideally be
universally known and followed (don't send spam, don't flame people,
etc.), but "don't advocate non-libre software or products" isn't one
of them. I understand wanting to keep discussions related to GnuPG and
related subjects, so advocating or discussing third-party services may
be considered off-topic, but you seem to be referring to a more
specific rule.

@_date: 2017-02-04 08:40:46
@_author: Pete Stephenson 
@_subject: Paper backup of all keys 
Sure, but it would likely be a pain to type the whole thing in.
You might be interested in the "paperkey" tool, written by David Shaw,
which does a good job at minimizing the typing you'll need to do
(assuming that all of the public parts of the certificate itself can be
recovered from the keyservers or your correspondents).
If you use debian or a debian derivative, just use "apt install
Maybe I'm doing something wrong, but paperkey only seems to produce
reasonably small output for DSA keys. RSA keys are still enormous.
I've had pretty good luck with something like Paperback:
 -- it backs up arbitrary data to
printable 2D barcodes with error correction. Simply scan the paperback
it'll reconstruct the original file.
Thus one can direct backup and restore the exported private key file
without too much trouble.
I thought there was a *nix version, but I may be in error.
Alternatively, one could have a shell script generate a QR code for each
line of the exported private key file, then print the resulting files 10 to
a page. I did this and, while annoying, it's not hideously inconvenient to
restore the QR codes using nothing more than a webcam.

@_date: 2017-06-28 22:47:54
@_author: Pete Stephenson 
@_subject: Creating Unique Fingerprint 
It's not as hard as you might think, at least in terms of 32-bit
fingerprints: Pete Stephenson

@_date: 2017-06-29 00:50:49
@_author: Pete Stephenson 
@_subject: Technical contact for mailing list? 
Hi all,
Who is the appropriate person to contact regarding technical issues with
the mailing list?
Specifically, it appears that the list doesn't play nice with anti-spam
measures like DMARC, SPF, and DKIM and so messages sent from domains
with restrictive DMARC and SPF rules get flagged as spam as mail servers
think the mailing list server is forging messages for those domains.
I'd be happy to provide more information but don't want to needlessly
add noise to the list.

@_date: 2017-10-10 09:26:54
@_author: Pete Stephenson 
@_subject: Working with an Online and Offline Computer when using GnuPG - 
If you must use USB devices for some reason, take a look at the
flash drive.
It's designed specifically to protect against "badUSB", where the
controller and firmware can be compromised. The controller has the
developer's public key baked in during manufacture. The firmware is
signed and can only be loaded once (no provision is made for
in-the-field firmware updates). The controller verifies the firmware and
its signature at every power-on. If a malicious actor had physical
access and re-flashed the firmware, the controller would notice and fail
to load.
It also has a physical write-protect switch that can prevent unwanted
It's a plain flash drive and doesn't have built-in encryption (though
the company sells those too) but it should have a higher assurance of
not being compromised or compromisable at the hardware level than a
typical off-the-shelf USB device.
I use it with my offline Raspberry Pi 2 that I use for private key
operations for my primary keys (as opposed to subkeys, which are on
smartcards). The Pi 2 uses LUKS for encrypting the microSD card it uses
for storage and is never connected to the network. It's more than
adequate in terms of performance and is cheap enough that I have a bunch
lying around the house anyway. ;)

@_date: 2017-10-11 15:36:20
@_author: Pete Stephenson 
@_subject: Working with an Online and Offline Computer when using GnuPG - 
Vague answer: that depends on your threat model.
When interacting with an untrusted system, you may not want the
untrusted system to be able to write data to the USB drive that might
also be used on the trusted system. In my use case, I was more
interested in the novelty and principle of having a signed, verified
firmware running on the device that is not vulnerable to the badUSB
attack. The write protect switch is actually a bit of a hassle for me,
as the screen printing indicating which position is read-only has worn
off with use, so I always accidentally set it to read-only when I want
it in read/write mode (in much the same way that all USB plugs exist in
a superposition of multiple states, all aligned the wrong way). :)

@_date: 2018-02-06 09:18:44
@_author: Pete Stephenson 
@_subject: OpenPGP card && exporting secret keys 
Short answer: No.
Longer answer: The OpenPGP card does not permit the export of keys it
stores. That's the whole point of using the card.
If you generate new keys on the card itself, there's never any way of
exporting them. If the card is lost or damaged, so are the keys.
However, if you generate new keys on a computer, you can make a backup
of the keys before you import them onto the card. If you haven't already
done this before importing them onto the card, you're out of luck.

@_date: 2020-12-04 10:26:57
@_author: Pete Stephenson 
@_subject: Add key to card without substituting stubs for actual private key? 
Hi all,
I have an offline system I use for holding my private keys on-disk. I use smartcards for my day-to-day use on ordinary systems. I use the offline system to generate new primary keys when needed, as well as encryption subkeys (so I can always go back and decrypt things even if the smartcards are lost), and then transfer keys to smartcards using the "keytocard" command under gpg --edit-key . Signing subkeys are generated directly on the smartcards.
Whenever I use keytocard, the selected private key is transferred to the smartcard as expected. The selected private key on the offline system is replaced with a stub pointing to that card (also as expected). In my use case, this is undesirable since I wish for the offline system to retain the actual private key after copying the private key to the card.
As a workaround, I've taken to making a backup of the .gnupg directory, performing the keytocard operation, then deleting the .gnupg directory that now contains the stubs and restoring the backup from before the operation. While functional, this is potentially error-prone.
Is it possible to transfer an existing private key from a computer to a smartcard without replacing the private key on the computer with a stub pointing to the card?
If it is not currently possible to do this, I request that such a feature (e.g. "copykeytocard" rather than "keytocard") be added when convenient.

@_date: 2020-05-11 18:46:24
@_author: Pete Stephenson 
@_subject: Comparison of RSA vs elliptical keys 
Good question! Broadly, and with several assumptions, elliptic curves have the same security level as symmetric (e.g., AES) keys that are half the elliptic key's length. See  and the references therein as a starting point. For example, a 256 bit elliptic curve key has a similar strength to a symmetric key of 128 bits.
Due to various reasons, not all ECC keys are powers of 2 in length. For example, NIST P-521 is 521 bits long rather than 512 bits, and has equivalent security to a 256 bit symmetric key. Cheers!
