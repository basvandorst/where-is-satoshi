
@_date: 2016-05-13 11:38:28
@_author: Daniel Ranft 
@_subject: Having issues with dirmngr in gpg 2.1 
Since a few weeks I cannot search keys anymore. When I use gpg --keyserver  --search-keys , the commandline freezes and the process explorer does not show me a dirmngr.exe instance.
I then tried to investigate this further by trying to start the dirmngr manually with following result:
C:\Program Files (x86)\GNU\GnuPG\2.1.12\bin>dirmngr.exe --daemon
dirmngr[5020]: Error while opening `C:\ProgramData\GNU\etc\gnupg\ldapservers.conf': No such file or directory
dirmngr[5020]: The socket cannot be bound to `C:\Windows\S.dirmngr': Unknown error
I localized some parts of the string by myself as they were german.
What worked for me was to start the dirmngr manually with explicit --homedir %appdata%\gnupg, but I do not use an alternative homedirectory by environment variable or registry key. Therefore I think, gpg should try to create the socket file under %appdata%\gnupg instead of under C:\Windows.
Any suggestions where I should look for a mistake in my configuration?

@_date: 2016-05-17 14:58:41
@_author: Daniel Ranft 
@_subject: Go gpg, guess, what I want 
Today I want to discuss about a situation, where gpg seems to guess, what I want to do (which is IMHO not a good idea).
If I export a keypair (gpg -a -o C:\some\where.asc --export-secret-keys abcd1234), the pinentry will pop up for each primary-/subkey to prompt for the passphrase. So far, so good. When I cancel the first prompt, gpg still tries to export the other subkeys to generate a somehow usefull output. That is, what I think is guessing.
Result when I only cancel the first prompt, but not the second:
I get a file which contains only the secret subkey and its binding sig:
# off=0 ctb=9d tag=7 hlen=3 plen=966
:secret sub key packet:
        version 4, algo 1, created 1283427770, expires 0
        pkey[0]: [2048 bits]
        pkey[1]: [17 bits]
        iter+salt S2K, algo: 7, SHA1 protection, hash: 2, salt: =LONGKEY=
        protect count: 4980736 (195)
        protect IV:  2f 89 b9 0a 22 c5 6d 50 4d 8b a2 53 1f 53 50 bf
        skey[2]: [v4 protected]
        keyid: 82AE4F2683F549E5
# off=969 ctb=89 tag=2 hlen=3 plen=293
:signature packet: algo 1, keyid =LONGKEY=
        version 4, created 1427802947, md5len 0, sigclass 0x18
        digest algo 2, begin of digest 13 ab
        hashed subpkt 27 len 1 (key flags: 0C)
        hashed subpkt 2 len 4 (sig created 2015-03-31)
        hashed subpkt 9 len 4 (key expires after 6y211d0h12m)
        subpkt 16 len 8 (issuer key ID =LONGKEY=)
        data: [2044 bits]
FWIW: When I cancel the first prompt, gpg should stop the export of the complete key. If there are several keys to export, gpg should still process the other keys.
If I would have wanted to export the subkey only, I would have used the exclamation mark syntax.
Best regards,
Daniel Ranft

@_date: 2016-10-28 10:50:47
@_author: Daniel Ranft 
@_subject: Decrypting a non-mdc encrypted message results in Exitcode 0 but 
we have a customer that receives emails from totemomail. These messages are not MDC protected and therefore will cause a warning. Sadly this will (since GnuPG modern) also result in a DECRYPTION_FAILED status message, which we are parsing.
Is this intended like that? What should we parse instead?
Daniel Ranft
gpg4o developer
