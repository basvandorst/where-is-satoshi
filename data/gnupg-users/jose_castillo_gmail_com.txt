
@_date: 2015-04-08 11:50:55
@_author: Jose Castillo 
@_subject: Email-only UIDs 
This has been a very illuminating conversation, and I just want to share something that led me to this confusion initially. When I was considering an email-only UID, I ran up against the issue that in gnupg's default mode of operation, a name is required for a UID, whereas an email address is not. If I try to enter a blank name while generating a key, gnupg issues an error: "Name must be at least 5 characters long". My instinct was thus to specify the email address in the name field. I got it backwards because gnupg treats the name field as mandatory and the email field as optional, which interestingly is the opposite of RFC 5322: I realize now that an email-only UID should include angle brackets ("implementations SHOULD use the full name-addr form of the mailbox"), but I wanted to share the thought process that led me to this mistake in the first place.

@_date: 2015-04-21 13:48:14
@_author: Jose Castillo 
@_subject: Yubikey NEO OpenPGP advisory 
I haven?t seen this posted to the list yet, and thought it would be important for people who use the Yubikey NEO's OpenPGP functionality with GnuPG. It regards a vulnerability in the Yubikey NEO implementation of the OpenPGP smart card application: Yubikeys running the vulnerable software will generate signatures and decrypt session keys unconditionally, i.e. without verifying the user?s PIN. I reported this vulnerability to Yubico on 4/11, and to their credit it was quickly fixed. Still, if you are using a Yubikey that you obtained prior to the fix being issued, you should be aware that this vulnerability could affect your security. This issue also affected the upstream javacardopenpgp project [1], which has been updated with a fix as well. [1]:

@_date: 2015-04-22 18:22:02
@_author: Jose Castillo 
@_subject: Yubikey NEO OpenPGP advisory 
The smart card offers protection against copying of the key, but it includes the PIN to protect against unauthorized use. While not as absolute as the protection against copying, the PIN is an effective second factor; in the case of NFC, which is a big use case for the Yubikey, an attacker would need to shoulder-surf the PIN, capture it with malware, or get near enough with an NFC sniffer [1] to capture the PIN while the legitimate user is entering it. Removing the PIN from the equation removes the protection from unauthorized use. Obtaining a fraudulent signature is as simple as hovering an NFC smartphone within range of a defective token; it will sign any data transmitted to it. And since the Yubikey is designed to live on a user?s (physical) keychain, it is not at all difficult to imagine a scenario where an attacker could gain this level of proximity without attracting attention. This is before we address the issue of lost or seized devices. Personally, I think that it?s unsafe to have a PGP key on an old Yubikey that exhibits this vulnerability, which is why I submitted it to the list. [1]:

@_date: 2015-01-14 15:59:51
@_author: Joey Castillo 
@_subject: Specifying passphrase for batch key generation 
Reading the manual for batch GPG key generation in GnuPG 2.1, I see
the following note:
I'm running into an issue now with a module I was using to generate
keys in a python script (python-gnupg). Its method was to generate a
set of parameters, including the passphrase parameter, and pass that
via stdin to gpg --batch --gen-key.
Now that we cannot specify a passphrase in the batch parameters, what
is the preferred method for batch key generation with a specified

@_date: 2015-03-12 14:36:53
@_author: Joey Castillo 
@_subject: Whishlist for next-gen card 
At the very least, adding expired ENC keys to the card spec is a really
great suggestion. I'm trying to pitch people on using smart cards to secure
their email, and one common question I get is "What happens if I lose my
card?" Telling them they have to generate a new key is a bitter pill if it
means they can't decrypt their old emails.
This feature is not without precedent; the NIST standard for CAC/PIV cards
includes fields for 20 retired "key management" keys, which are used to
decrypt old messages. [1] I think this one feature would go a long way to
making smart cards a more accessible solution for everyday use.
in item 2.4.7, "Key History Object".

@_date: 2015-03-13 16:13:38
@_author: Joey Castillo 
@_subject: Making the case for smart cards for the average user 
Hi there,
I'm working on a Kickstarter right now that aims to popularize smart
cards as an easier way for the average user to adopt GnuPG.
Putting aside any security benefits, smart cards seem simpler to use
for the average person. Unlocking a card with a PIN is a metaphor that
people already know and use with bank cards. Choosing and memorizing a
strong passphrase, by comparison, is something the average user is
likely to have trouble with.
Moreover, we're a multi-screen environment now; people expect to have
access to their stuff across devices. With a smart card they can keep
their secret keys in one place, as opposed to creating multiple points
of potential compromise. Plus by integrating NFC technology, we open
up the potential for use on smartphones and tablets, which is where
most people's computing is moving anyway.
Of course smart cards aren't some kind of magic bullet, but if the
goal is to drive wider adoption of GnuPG and OpenPGP based
cryptography, I can't shake the feeling that smart cards are a huge
part of the answer. Thoughts?

@_date: 2015-03-14 17:00:08
@_author: Joey Castillo 
@_subject: Making the case for smart cards for the average user 
I'll concede the first point: some minority of people won't get it
even if we make it simpler. As to the second one: even with a password
manager, the security of that still depends on choosing and guarding a
complex password to secure the password store. It's passwords all the
way down.
Certainly; if your system is compromised by malware it could
substitute the message, store session keys, or keylog your PIN for
that matter. If your system is compromised, all bets are off. The
difference is that with your keys on a smart card, at least such a
breach won't compromise your secret key material. And you can prevent
further unauthorized use by simply removing the card; this is not
possible if the attacker has stolen your keyring and passphrase.
Without smart cards, if I want to use GnuPG on my laptop, my iPhone
and my Nexus 7, I have to put my secret key on each of those devices
and enter my passphrase into each of those devices. This dramatically
increases the surface area available for an attack on my secret keys.
In practice, you have to more or less touch the card to the device
you're using it with; an attacker would have to generate an RF field
that overpowers the one generated by the device. But yes: with
specialized equipment and close proximity, an attacker could
theoretically modify data or eavesdrop. [1] It's a tradeoff: in
exchange for better security for my secret key material, I'm exposing
myself to a threat from a determined, active attacker that's able to
get specialized gear into the same room as me while I'm using my card.
For some minority of people, that may be a reasonable concern; for
most people, it really isn't.
Also, there's nothing preventing us from better securing the NFC
channel in a future card specification; in particular, NFC's
resistance to man in the middle attacks makes it easy to establish a
shared secret to secure the channel, as proposed in a 2010 standard.
[1]: [2]:

@_date: 2015-03-14 17:23:45
@_author: Joey Castillo 
@_subject: Making the case for smart cards for the average user 
I desperately wanted to make it worldwide, but feared running afoul of
U.S. cryptographic export laws. Since both GnuPG and the smart card
application are open source, my sense was that it would be exempt from
export controls, but I didn't want to check the box without speaking
to a lawyer.
To quote the OpenSSL foundation [1], "U.S. exports controls are
complex and quite nonsensical from the perspective of the uninitiated
professional software developer."
[1]: Joey Castillo

@_date: 2015-03-14 18:37:18
@_author: Joey Castillo 
@_subject: Making the case for smart cards for the average user 
Thanks for your thoughtful response. I think it's absolutely true that
different people have different security needs, but I wonder if we
can't make progress for an average person's use case.
I'm recalling a message you wrote some months ago making the point
that GnuPG is a cryptographic toolbox, but that it does not provide
policy. That's one of the things I've been trying to get at with this
project, writing guidelines for the people who participate on how they
should use the tools. The goal is to simplify not just everyday things
like how to make a key or encrypt an email, but also more complex
things like "what is my identity and how do I verify it?" [1]
I'm certain that this is not "the answer" for everyone's use case, and
I also know that even if this Kickstarter project gets funded, the end
result will be a small community, not a world-changing critical mass
of people. But it might provide a collaborative place where we can
test out a policy framework and see how well it performs for people
who aren't as intimately familiar with the tools.
That's the thing that excites me, and the thing that I think might
make a difference. Because if the human rights worker in Syria wants
to communicate securely with, say, an academic in the U.S., we have to
figure out a simple way to introduce that person to the tools as well.
[1]:

@_date: 2015-03-15 18:24:29
@_author: Jose Castillo 
@_subject: Making the case for smart cards for the average user 
Sorry about the improper threading; I?ve switched off digest mode, hopefully this will help. I may have phrased my point inartfully. I think the goal here is to minimize the harm done in the case of compromise. An attacker substituting a message and convincing your smart card to sign it is bad, but it?s not as bad as leaking secret key material that the attacker can use at will. The smart card runs code based on a specification. [1] The specification does not allow exporting a secret key, and we write code that adheres to that specification. We know that much to be true. You do have to trust the firmware and the operating system on the smart card, but that?s made easier by the fact that chips in these cards [2] and the operating system [3] are certified to be secure based on international standards, and are widely deployed in sensitive areas like access control, payments and telephone SIM cards. I think it?s encouraging, in a perverse way, to hear that when GCHQ sought to compromise SIM card encryption keys [4], they had to resort to spying on the employees generating them. If the smart card firmware or operating system were backdoored, they would not have had to go to such lengths. Yes, this is a concern. It requires physical proximity of a few meters and some kind of specialized equipment, but it?s theoretically possible. With NFC the main mitigation is physical rather than cryptographic in nature. Since the card has no battery, the attacker would have to supply an RF field sufficient for powering up the chip to perform the math and transmit a response. In theory, that maxes out at 10 centimeters; in practice, it?s about half that. You can negate this attack with an RF blocking sleeve, which I?ll almost certainly be adding to the kit after this conversation. I admit that this may not be sufficient for some people?s security needs, but my sense is that more people are vulnerable to passphrase-sniffing malware than they are to someone sneaking very close to them with an evil device. The former attack scales quite easily; the latter attack does not ? and again, the evil device attack still won't expose secret key material. Thank you for your critical responses, by the way; I appreciate the chance to be transparent about the challenges involved. [1]: [2]: [3]: [4]:

@_date: 2015-03-18 14:18:57
@_author: Jose Castillo 
@_subject: Email-only UIDs and verification (was: Making the case for smart 
Good point, I?ll make that change. As a sidenote, I notice that when I?m generating a key interactively, I get an error message of 'Name must be at least 5 characters long? when I try to make an email-only UID. It works in batch mode, and obviously with the allow-freeform-uid option, but just thought it was interesting to point out. Someone attempting to make such a UID in the interactive mode might be forgiven for putting their email address in the ?name? field as a workaround. This is a very good point, and I can see making this change. This was in reference to the PGP global directory?s verification check. Having never used it I?m curious why the validity period is only two weeks. Does the user have to re-verify their email address every two weeks? That seems excessive. Moving to an annual validity period (or through the expiration of the domain name if it?s expiring sooner) allows for disused keys to expire, while still giving you the option to revoke a UID or key sooner if necessary. In the case of establishing communication with someone you haven?t yet met, it gives you an assurance that a third party has verified that they were in control of the address on a given date within the last year. If I query your email address and find four keys, I don?t know what to do; but if one of them is trusted by the email verification service, which I trust, then there?s only one valid key.

@_date: 2015-03-21 12:55:40
@_author: Jose Castillo 
@_subject: Email-only UIDs and verification (was: Making the case for smart 
I think MFPA had a good idea earlier in the thread: the first message, the request for a signature on the UID, is signed; whether the from address is spoofed or not, the automated service can?t be sure. What if the automated service went ahead and made the certification anyway, but encrypted it before sending it? At that point only the recipient in the UID field will receive the email, and they?ll only have access to the certification if they?re also in control of the key to decrypt it. There?s no followup required. The thought process here is that when someone generates their identity, it?s not trusted by anyone, and they don?t trust anyone by default. It?s up to them to build the trust landscape themselves, which isn?t a great user experience for the layperson. This proposal is about establishing a minimal viable trust scheme based around persona-level certification of verified email addresses. The user can augment that with their own web of trust as needed. Ideally, I?d like to be able to present UI that shows a signature from an untrusted key as an error condition, in much the same way your browser warns you about an untrusted SSL certificate. That?s difficult if you have to establish yourself in a web of trust first.
