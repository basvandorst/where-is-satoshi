
@_date: 2004-04-02 15:54:42
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
<> Dear Group,
I've been using gpg to do file encryption with partners of ours, but we
just ran into two odd issues:
1. a GPG "don't know: invalid packet (ctb-1f) & (ctb-40)
2. a GPG "problem reading source"
I've done the google thing on this, but I'm not making much progress.
Does the list have any pointers for me to look at? We've not run into
this before. The source file is being encrypted, and compressed and signed by an NAI
7.11 Business PGP system, and we are opening on a Solaris 8 box with gpg
1.2.3.  I've sanitized some of the data to protect the innocent..
Sample one:
gpg --output ce331 --decrypt CE_Con_1040326.dat
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: encrypted with 3072-bit ELG-E key, ID xxxxxxxx, created 2001-08-23
      "KEYNAME "
gpg: encrypted with 1024-bit ELG-E key, ID xxxxxxxx, created 2004-03-25
      "key (COMPANY decription key) "
gpg: Signature made Fri Mar 26 14:20:29 2004 EST using DSA key ID
gpg: Good signature from "COMPANY "
gpg:                 aka "COMPANY "
gpg: [don't know]: invalid packet (ctb=1f)
gpg: WARNING: message was not integrity protected
gpg: [don't know]: invalid packet (ctb=40)
Then it just ends, but we end up with a plain text file. Accuracy of the
file is unkown.  What is the CTB=1f and CTB=40
Sample two:
->> gpg --output au331 --decrypt  AU_Con_1040331.dat
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: encrypted with 3072-bit ELG-E key, ID xxxxxxxx, created 2001-08-23
      "COMPANY "
gpg: encrypted with 1024-bit ELG-E key, ID xxxxxxxx, created 2004-03-25
      "key (COMPANY decription key) "
gpg: Signature made Fri Mar 26 14:20:46 2004 EST using DSA key ID
gpg: Good signature from "COMPANY "
gpg:                 aka "COMPANY "
File `au331' exists. Overwrite (y/N)? yes
gpg: Problem reading source (2386467048 bytes remaining)
gpg: handle plaintext failed: file read error
gpg: WARNING: message was not integrity protected
Thanks for any and all assistance.

@_date: 2004-04-02 16:30:46
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
No ascii-armor was used. The encryption command that was used on the NAI
system was:
pgp --encrypt --user mypublickey --encrypt-to-self datafile.dat  -----Original Message-----
Sent: Friday, April 02, 2004 9:20 AM
do you know if it was encrypted with ascii-armor?
I have seen problems with non-ascii systems sending files with wierd

@_date: 2004-04-02 16:54:50
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
Here is the list-packets on the file that made up the first sample:
gpg --list-packets CE_Con_1040326.dat
gpg: WARNING: using insecure memory!
gpg: please see  for more information
:marker packet:
 50 47 50
:pubkey enc packet: version 3, algo 16, keyid xxxxxxxxxxxxxxxxx
        data: [3072 bits]
        data: [3071 bits]
:pubkey enc packet: version 3, algo 16, keyid xxxxxxxxxxxxxxxxx
        data: [1019 bits]
        data: [1023 bits]
:encrypted data packet:
        length: 1549
gpg: encrypted with 3072-bit ELG-E key, ID xxxxxxxxx, created 2001-08-23
      "Company "
gpg: encrypted with 1024-bit ELG-E key, ID xxxxxxxx, created 2004-03-25
      "Company2 (Company2 decription key) "
:compressed packet: algo=1
:onepass_sig packet: keyid xxxxxxxxxxxxxxxxxxx
        version 3, sigclass 00, digest 2, pubkey 17, last=1
:literal data packet:
        mode b, created 0, name="datadump20040109.dat",
        raw data: 0 bytes
gpg: WARNING: message was not integrity protected
The input files, prior to encyrption, are textual dumps of data.  The CE
file here, when we get it is 27kb.
-----Original Message-----
[mailto:gnupg-users-bounces On Behalf Of David Shaw
Sent: Friday, April 02, 2004 9:29 AM
On Fri, Apr 02, 2004 at 08:56:10AM -0500, Harper, Jason (GE Consumer
Could you run 'gpg --list-packets' on those files?  It might shed some
How large are the files (both input, and expected output sizes) ?
Are the input files ASCII armor ("---BEGIN PGP MESSAGE---", etc) or
Gnupg-users mailing list

@_date: 2004-04-02 17:46:36
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
We get the file via a program called "Connect Direct" from Sterling Software, which I 'believe' to be a binary transfer program (will have to check).  Also the file itself does not have the neat "----BEGIN PGP MESSAGE----".  When I look at it in VIM it is total gibberish, but there is a noticeable "pgp" within the first 6 characters (e.g. "? PGP??N ????e?l? )
-----Original Message-----
Sent: Friday, April 02, 2004 10:27 AM
How was the file transferred to you?  It it was FTP, make sure you didn't transfer it in text mode.  That'll mangle the file in a way similar to what you posted.

@_date: 2004-04-02 20:26:40
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
We're going to attempt the ascii-armor now. We're also going to ask the sender to retrieve the file and see if he can decrypt it. -----Original Message-----
Sent: Friday, April 02, 2004 11:48 AM
That's normal for a binary message.
So, it could be binary being treated as text somewhere.  This is a really common problem.  An easy check is to send the file you received back to the sender.  If it doesn't match, then it got mangled by the transfer.
Another thing to try is to get the sender to turn on ASCII armor.  If your transfer program wants text, give it text :)

@_date: 2004-04-02 21:33:44
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
There were a total of three files, and the two we just tested with ASCII-Armor turned on have decrypted perfectly.
Thank you all very much for your assistance.
jason Sent: Friday, April 02, 2004 11:48 AM
That's normal for a binary message.
So, it could be binary being treated as text somewhere.  This is a really common problem.  An easy check is to send the file you received back to the sender.  If it doesn't match, then it got mangled by the transfer.
Another thing to try is to get the sender to turn on ASCII armor.  If your transfer program wants text, give it text :)

@_date: 2004-04-09 11:19:12
@_author: Harper, Jason (GE Consumer Finance 
@_subject: GPG - Invalid packet 
Dear Group,
I've been using gpg to do file encryption with partners of ours, but we
just ran into two odd issues. I've done the google thing on this, but
I'm not making much progress. Does the list have any pointers for me to
look at? We've not run into this before. The source file is being encrypted, and compressed and signed by an NAI
7.11 Business PGP system, and we are opening on a Solaris 8 box with gpg
1.2.3.  I've sanitized some of the data to protect the innocent..
Sample one:
gpg --output ce331 --decrypt CE_Con_1040326.dat
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: encrypted with 3072-bit ELG-E key, ID xxxxxxxx, created 2001-08-23
      "KEYNAME "
gpg: encrypted with 1024-bit ELG-E key, ID xxxxxxxx, created 2004-03-25
      "key (COMPANY decription key) "
gpg: Signature made Fri Mar 26 14:20:29 2004 EST using DSA key ID
gpg: Good signature from "COMPANY "
gpg:                 aka "COMPANY "
gpg: [don't know]: invalid packet (ctb=1f)
gpg: WARNING: message was not integrity protected
gpg: [don't know]: invalid packet (ctb=40)
Then it just ends, but we end up with a plain text file. Accuracy of the
file is unkown.  What is the CTB=1f and CTB=40
Sample two:
->> gpg --output au331 --decrypt  AU_Con_1040331.dat
gpg: WARNING: using insecure memory!
gpg: please see  for more information
gpg: encrypted with 3072-bit ELG-E key, ID xxxxxxxx, created 2001-08-23
      "COMPANY "
gpg: encrypted with 1024-bit ELG-E key, ID xxxxxxxx, created 2004-03-25
      "key (COMPANY decription key) "
gpg: Signature made Fri Mar 26 14:20:46 2004 EST using DSA key ID
gpg: Good signature from "COMPANY "
gpg:                 aka "COMPANY "
File `au331' exists. Overwrite (y/N)? yes
gpg: Problem reading source (2386467048 bytes remaining)
gpg: handle plaintext failed: file read error
gpg: WARNING: message was not integrity protected
Thanks for any and all assistance.
