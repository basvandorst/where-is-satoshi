
@_date: 2007-03-14 02:26:52
@_author: Lukas Fittl 
@_subject: Pinpad problem with SCM SPR532 
I recently bought an SCM SPR532 for testing purposes, and "gpg
--card-status" works (without pcscd running), but when pinentry asks me
to enter the PIN on the pinpad (tested with decryption, signing, and
verify pin) it gives the following error in the log file of scdaemon, in
the case of signing:
2007-03-14 02:20:11 scdaemon[4455] DBG: send apdu: c=00 i=CA p0=00 p1=7A
lc=-1 le=256
2007-03-14 02:20:11 scdaemon[4455] DBG:   APDU_data: 00 CA 00 7A 00
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: sending 6F 09 00 00
00 00 11 04 00 00 00 40 05 00 CA 00 7A 00 F5
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: status: 00  error:
00  octet[9]: 04
               data: 00 40 07 93 03 00 04 69 90 00 2A
2007-03-14 02:20:11 scdaemon[4455] DBG:  response: sw=9000  datalen=5
2007-03-14 02:20:11 scdaemon[4455] DBG:       dump:  93 03 00 04 69
2007-03-14 02:20:11 scdaemon[4455] signatures created so far: 1129
2007-03-14 02:20:11 scdaemon[4455] DBG: prompting for keypad entry '||
Please enter your PIN at the reader's keypad%0A[sigs done: 1129]'
2007-03-14 02:20:11 scdaemon[4455] DBG: send apdu: c=00 i=20 p0=00 p1=81
lc=0 le=-1
2007-03-14 02:20:11 scdaemon[4455] DBG:   APDU_data: 00 20 00 81 00
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: sending escape
sequence to switch to a case 1 APDU
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: sending 6B 03 00 00
00 00 12 00 00 00 80 02 00
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: status: 00  error:
00  octet[9]: 00
               data:
2007-03-14 02:20:11 scdaemon[4455] DBG: ccid-driver: sending 69 13 00 00
00 00 13 00 00 00 00 00 82 00 00 19 06 02 FF 04 09 00 00 00 00 00 20 00
2007-03-14 02:20:16 scdaemon[4455] DBG: ccid-driver: status: 40  error:
EF  octet[9]: 00
               data:
2007-03-14 02:20:16 scdaemon[4455] DBG: ccid-driver: CCID command
failed: PIN cancelled
2007-03-14 02:20:16 scdaemon[4455] ccid_transceive failed: (0x1000d)
2007-03-14 02:20:16 scdaemon[4455] apdu_send_simple(0) failed: aborted
2007-03-14 02:20:16 scdaemon[4455] DBG: dismiss keypad entry prompt
2007-03-14 02:20:16 scdaemon[4455] verify CHV1 failed: Operation
2007-03-14 02:20:16 scdaemon[4455] operation sign result: Operation
2007-03-14 02:20:16 scdaemon[4455] card_sign failed: Operation cancelled
gpg output:
gpg: sending command `SCD PKSIGN' to agent failed: ec=6.99
gpg: signing failed: general error
gpg: file.txt: clearsign failed: general error
gpg version is 1.4.6, gpg2 version is 2.0.3, OS is Debian on i386.
Full scdaemon.log can be found at
