
@_date: 2017-12-10 17:02:58
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Downloading the same key results in different files 
Did they have the same signers?
Maybe in one case the key had extra signatures. That is the most common
reason for differences on a single key that I have seen.
Although if for instance the bigger one had an extra photo, that would
explain the difference, too.
Also note that although you can request it from "the same keyserver" (as
in the same hostname), you may actually be accessing a different server.
A host like pool.sks-keyservers.net may point to dozens of different
servers. And even if there is apparently a single one, there may be
several host balanced behind (although in that case it would be more
strange that their dbs differed significantly).

@_date: 2017-10-10 01:51:23
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Safe transfer via USB devices 
What is generally used in these cases (eg. handling a Snowden leak) is
to encrypt the files before storing them into the "drive" that moves
between computers (be that a usb key, a floppy...).
Thus, the secret data is an opaque blob even to an evil storage. You may
use whatever encryption, from a gpg-transfer-key to simply simmetric
encryption with a random one-use password (you only need to enter it
once, or at most twice).
PS: If you are going to such length for having a secure computer,
Windows 10 may not be the most trustable OS.
PS2: Rather than transfer executable files from the online to the
offline computers, I would recommend doing it the opposite way: move the
source code to the offline computer if needed, review it, compile there,
and move the compiled code from the offline to the online computer. So
that the compiled programs flow from higher security level to lower
Best regards

@_date: 2017-09-22 02:37:40
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Houston, we have a problem 
Nope. This would solve the case of ?Key of legitimate user signed by
fake user?? but not ?Fake user signed by another fake user?, which is
the problem.
? Assuming the legitimate one would notice and not allow his key to be
signed by the evil one, which is no problem, actually.
The proposal would be technically feasible (invalidating all existing
signatures, and probably conflicting with local sigs, but feasible).
However, it wouldn't solve the underlying problem.

@_date: 2018-12-04 23:12:39
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: How to start gnupg? 
When you say that you are installing a software from source, it usually
means that you downloaded the source code (usually a tgz) and compiled
it yourself.
As you then mention that what you did was a sudo apt install gnupg, you
were installing gnupg from Ubuntu 16.04 package manager.
Yes. That means that you (already) have installed the latest version of
gnupg package that is packaged in Ubuntu 16.04
If you want a visual program to use for this, I would recommend you to
install kleopatra
If you are fine using the command line, run in a terminal
 gpg --decrypt-files Note that if it was encrypted to your public key, you would need to
first import it with gpg --import, otherwise the above command will
complain it doesn't have the needed key (the error message should point
you in the right direction, though).
The requirement to have is Graphical frontends like kleopatra will also allow you to decrypt files
(File -> Decrypt/Verify files), but nevertheless you will need to have
your key imported in order to do that (it allows you to do that
graphically, though).
Best regards

@_date: 2018-12-07 17:05:43
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: a minimal version of PGP/GPG for the Win32/64 bits for command 
Point them to I think you could extract the command line binaries and run them as
portable apps, but actually, I think it would be easier for them to run
the installer and have a nice GUI app rather than a cli app.
Not to mention that, if you expected to send them gpg.exe by email so
that they could reply with an encrypted mail, (a) you are setting a very
bad precedent expecting them to run an arbitrary executable they
received from an untrusted medium and (b) the mail server would most
likely block your message anyway.
Best regards

@_date: 2018-12-14 00:22:02
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Importing keys into GnuPG 2.2 series 
Looks like a pinentry issue.
I guess you are using some non-alphanumerical characters in the
passphrase? My guess would be that they are getting "lost".
I would start questioning the encoding of your input on that terminal,
but as you mention that you are using pinentry-curses over ssh, can you
even type the through ssh? I have seen ssh connections where characters
like ? got dropped when some package/env variable wasn't set in the
remote server.
Best regards

@_date: 2018-10-20 00:26:41
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Decrypting file - Private key issue 
The file was encrypted to the key 4A83B612, but you don't have the
corresponding secret key. You only have the secret key for
Is it possible that there are two different key pairs for that user?
(it was encrypted to one of them, but you only hold the private key for
the other)
Best regards

@_date: 2019-04-11 02:37:19
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Generating revocation certificate 
Why should I need to remember to manually add that .'2' every time?
I use an even simpler approach:
 echo alias gpg=gpg2 >> ~/.bashrc
Best regards

@_date: 2019-04-12 01:32:34
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Generating revocation certificate 
Nope. ?
Kindly note that it is being added as a shell alias.
The alias will only be expanded on an interactive shell? This causes
that every program which calls a gpg binary need to be explicitly
configured to use gpg2 instead, but it is safer.
? "Aliases are not expanded when the shell is not interactive, unless
the expand_aliases shell option is set using shopt" -- bash(1)
And, even if you were using a shell script that enabled expand_aliases
(I don't think I have ever come across one), .bashrc should not have
been loaded anyway.
This is in contrast of an exported function (which would replace the
command *sometimes*, depending on how gpg was called) or a
wrapper /symlink called gpg earlier in the path.
Best regards

@_date: 2019-04-16 23:23:52
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: How to prevent passphrase-caching from within a gpgme-based 
Yes. gpg will use a gpg-agent, launching it if needed, and that agent is
caching the passphrase:
There doesn't seem to be any command to set a passphrase with just a ttl
in the agent protocol. Which is not that strange, given the gpg client
passing the passphrase to the agent is the weird case. It could of
course issue a CLEAR_PASSPHRASE before each operation, but that would be
I think you should launch your own gpg-agent for your script, with the
configuration you wish. For example, I expect that running this wrapper
instead of demo.py would fix it: eval $(gpg-agent --daemon --sh --max-cache-ttl 0)
exec python ./demo.py "$
Of course, you could instead run gpg-agent from python and set
GPG_AGENT_INFO there. The gpg python package is calling gpg under the
hood, so it should pick the GPG_AGENT_INFO variable from the
In the script above, after running the script you could do
since nobody would use that agent again, anyway.
A more optimized version would use a dedicated agent just for demo.py,
but reuse it amongst several invocations of demo.py.
Best regards

@_date: 2019-02-25 23:32:06
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Ok this is a stupid questions 
Not that it couldn't happen, but I find strange gpg would do that.
Erroring out would make more sense. Note that GnuPG can work in filter
mode, so you can do
 cat incomplete_file | gpg -d > output_file   (*)
in which case it really can't start over.
I don't think it would process things differently, but worth trying. How
are you invoking gpg? Which version are you running?
(*) Yes, this is an useless use of cat? In fact, it's quite likely cat
will be faster than whatever is transferring the file, piping eg. wget -O - would make more sense.
(**) Remember that even though you are getting an incomplete output,
unless the gpg terminates with no error after verifying the data,
**there's no guarantee about the contents** Don't pipe that output to
bash or otherwise treat as trusted data! Wait to the next command for
that (after verifying that gpg is ok with what was provided).

@_date: 2019-02-27 00:14:34
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Question about the security of the GnuPG Agent with regard to 
I would say this is the right expectation.
However note that even with a perfect agent implementation, you might
find eg. that the kernel swapped to disk the page where the password was
read (before providing it to the program, which would hopefully be using
mlock(2) to avoid being swapped itself).
Intrigued by this I did a quick glance at the relevant code:
The cache purging seems to be done at housekeeping() [1], which simply calls release_data over the entry to free.
In turn, release_data() [2] is just a xfree() call, which would be
converted to gcry_free(), which is a libgcrypt function that will call
_gcry_private_free() [3].
_gcry_private_free() checks[4] whether this allocation was from a secure
pool (ie. allocated with gcry_xmalloc_secure), in which case it will
call _gcry_secmem_free[5], which does attempt to wipe the memory by
overwriting it with 0xff, 0xaa, 0x55 and 0x00 [6] using the macro
wipememory2,[7] which may do so inline (using volatile to avoid compiler
optimization) or end up calling _gcry_fast_wipememory, which would end
up calling the normal memset() through a function pointer.[8]
(I would expect either an attempt to use memset_s if available, similar
to the  check for explicit_bzero, or a note that like SecureZeroMemory
it provides no benefit, instead of a plain memset, though)
Best regards
[1] [2] [3] [4] [5] [6] [7] [8]

@_date: 2019-01-21 23:09:10
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: showphoto 
showphoto launches an external program to view the photo. Since you are
using Windows, the path has backslashes, that the receiving program
seems to be treating as escape characters rather than a path (plus, the
default of xloadimage is unlikely to be available there) Changing to a different viewer would probably fix it. And it will likely
work flawless if you tried the same steps from a *nix machine.
Best regards

@_date: 2019-01-21 23:33:43
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: NIST 800-57 compatible unattended encryption? 
You are missing another point, which is that -in addition to the
gpg.conf client preferences- the keys you are encrypting to have
preferences, too.
In fact, it is noted in the SE answer you linked:
The default of Cast5/AES-128 is for the case where you know nothing (in
fact, the recipient might not even be able to decrypt it if you used an
algorithm it doesn't support, so it can go to eg. 3DES. All keys you are
using today should have been generated by non-ancient software and, as
such, have this preference set, though)
Kind regards

@_date: 2019-07-02 20:41:12
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Some thoughts on the future of OpenPGP and GnuPG 
Note: that's a problem with the keyservers and key distribution, not
with PGP itself.
That won't solve *email* encryption.
In fact, you will again some old problems (that may not have been fixed
completely even after all these years, though).
A new shiny system could be made in a couple of days that worked in a
different way and required you to use a separate program.
Encrypted messages could be exchanged through email in the form of
attachments that you need to extract, then open with a special program
to decrypt.
(In fact, many people _currently_ use OpenPGP in that stony age way)
But none of those is really *email* encryption.
You could maybe even make that new program able to connect to your
existing email via IMAP (assuming it's supported!).
But then, it needs to work in Microsoft Outlook. Or in Lotus.
Or have it sent thorough a certain Exchange server which blocks the
encrypted mails sent using this PGP plugin but not this other one.
While the first one does a much better job for reading than the second
one. And you end up with the bizarre case of having one plugin that
works for reading and another for writing.
Let's not get started with being able to read it on the company
smartphone where only a single email client is allowed.
Or the Webmail you were provided.
Here we face the adoption problem. If everyone used OpenPGP, all email
clients would be expected to support it. And those creating the email
clients would dedicate resources so that their MUA works properly with
encrypted messages, rather than leaving that to third parties that often
need to loop through holes to support things.
(Also, many mail providers actually benefit from having access to users'
data, from virus/spam filters, to learning your preferences in order to
eg. show you more suited ads. Combined with little customer interest of
such feature, it's not that strange there hasn't been much interest on
going the route for OpenPGP adoption)
MUA support is the big problem IMHO. First of all for supporting
seamless reading and writing of encrypted emails, and then having the
right user interfaces.
A new system could improve some minor things in the wire format and
encryption options, but it's working pretty well there, and can be fixed
relatively painlessly on rfc4880 successor.
The big deal are email clients. And there you would have all the issues
that existing implementations have. Plus those they have fixed.
Unless you somehow get to have everyone moving to encrypted mails almost
at once, so it creates such pressure.
That would be much more harder than you expect. But the big problem is
the above one. And rewriting everything won't solve that.

@_date: 2019-07-03 02:45:40
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: keyserver-options: self-sigs-only, import-clean, import-minimal 
I don't think so. You can have the signing key in the keyring, even if
that one was imported with only its own self-sigs.
Ultimately, I think the signatures should only be imported when they are
cross-signed by the key owner.
This would require a migration step were people signed the signatures
they already have on their key, but would otherwise allow them to keep
their 'precious signatures' they already have.
Then there should probably be a new command that would have to be used
to import the new signatures to your key that you are sent.
It won't fix the problem of a malicious keys being made with thousands
of fake signatures, but it pretty much solves the spamming problem by
only putting the owner in charge of accepting the signatures that can go
on his key.

@_date: 2019-07-04 04:23:22
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: SKS Keyserver Network Under Attack 
A point I don't like about the design of hagrid is that verification is
performed by the server itself.
Thus, it seems that if there were a reconciliation protocol between
them, either entering into one of them would lead to all of them blindly
trusting it, or the owner would need to validate a challenge for each
keyserver to which it gets replicated.
My expectation would be that the verification added a (non-dropped)
signature by the entity which performed the verification.
The keyservers themselves would be configured with a set of introducing
keys whose signatures they accepted for non-stripping.
This way, multiple servers, managed by different individuals, could rely
on a common verification entity (which may not run a keyserver itself).
The current reconciliation protocol (ie. the one used by SKS) would
probably work if all keyservers in a network trusted the same
verification keys, as they would share the same view.
(I admit my utter ignorance of the gossip protocol, though)
It would be desirable that it worked even with separate ones, so eg.
gentoo could use a single server that allowed its own CA and
keys.openpgp.org, even if the later only trusted its own verifier.
Unpublishing of uids would simply be triggered by the publication of the
revocation signature.
This is akin to other systems, like the old "PGP Global Directory Verification
Key" signatures.
I see on  that a machine-readable vouch was not added since "we don?t think that the verification is strong enough to even warrant a positive certification". However, I do think
that will be needed in order to have a successful keyserver network, and it would
be helpful to separate both roles.
They could be made at the persona cert level (1), to make gpg ignore them (by default), though, as a way to disincentive treating them as a CA. Kind regards

@_date: 2019-07-10 09:50:22
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Third-Party Confirmation signature? 
We are currently in a catch-22 situation, where neither clients nor
keyservers support such confirmation signatures.
However, clients will eventually update, while we will be stuck  forever
supporting whatever format is devised. I think it's more important to
define the right packets, based on packet semantics and also for
performing on-the-fly validation.
The users will need an updated software for making a confirmation
signature anyway (even if it's just an extra shell script over gpg1), I
see little hassle in requiring gpg >= 2.2.18 instead. Specially taking
into account that receiving new (legitimate) sigs is an uncommon event.
It wouldn't be that bad if someone had to use a LiveCD in order to
incorporate a new signature, just as you may need to use a certification
key which you usually keep offline.
(It would be good if this prompted them to update their day-to-day
client, though)
Please go for the best solution in the longterm, not just the one which
is easiest to support with ancient clients for the sake of it.
Kind regards
PS: This is not an endorsement of one type over the other, I haven't
evaluated the merits of either option (yet).

@_date: 2019-07-20 00:06:24
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Essay on PGP as it is used today 
Encrypted zip files have several factors that make it a beautiful
solution for sending encrypted messages to occasional users that don't
care much about it:
a) zip is a file format supported out-of-the-box by pretty much every
system, and that users are comfortable with. Whereas you would be seen
as a weirdo if you sent them a .gpg or other new file that needed a
special program, you would likely be asked to just sent it
"normally" (ie. unencrypted).
b) The format itself supports secure encryption (aes128/256).
c) If their client doesn't support AES-Encryption, their client will
show that *their program* can't cope with it. This places the onus on
the receiver (their zip decompresser isn't "new enough"), rather than
the sender (see a).
Nevertheless, it has a number of potential problems:
* As pointed out by Stefan Claas, you need to exchange the encryption
keys. The zip file is just an encryption primitive, so key distribution
may become a problem.
(raf, may I ask how you are dealing with it? As they are clients, are
you providing a set of keys in advance when personally visiting them?
Are you providing the key for the new message?)
* 7-Zip before 19.00 use a bad PRNG to fill a half-size IV * A naive user trying to reply would easily end up using PKWARE
encryption (and reusing the password)
Kind regards

@_date: 2019-07-22 00:44:08
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Fresh certificate marked as expired / messed-up certificate 
Well, it seems that ?T-TeleSec GlobalRoot Class 2? was cross-signed by
?Deutsche Telekom Root CA 2?.
This is typically done with new roots so that people with an older set
of roots can trust it through an older one.
Now, your problem is that the old Root CA expired and your client is not
able to find the new trust path.
I would probably try deleting the T-TeleSec GlobalRoot Class 2 and
reimporting it from the root, to see if that helps.

@_date: 2019-07-27 00:16:50
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: tool to encrypt millions of files in unsupervised mode (was: Need 
A single-purpose tool that only did AES265-encryption would be finished,
needing little to no mainteinance and thus looking like an ephemeral
AES specification itself is fixed and unlikely to go away (even though
in 15 years maybe we will all be using a completely different encryption
I think the main risk you would bear using a little-test tool would be
that it was somehow flawed in a subtle way so that other tools failed to
decrypt a tiny fraction of the files.
I recommend you to also keep hashes of the original files (maybe in a
different encrypted file) in addition to whatever authentication system
you plan to be using. Plus, obviously, keeping a copy of the encryption
tool (both compiled and in source form) along the backups.
As for the actual format to use, I would suggest using zip files with
AES encryption. There are many programs supporting it, and it is
nowadays an ubiquitousformat (albeit AES encryption support is lower,
that is still much bigger than for eg. an openssl enc format). It seems
likely that there will still be programs able to decrypt them, even if
the original program no longer works.
Nevertheless, with a goal like this, you should include a plan wherein
there are periodic tests of the data, in which a goal can be to detect
that it is no longer possible to decrypt them with commonplace hardware,
and perform a migration to a more modern (and supported) encryption
schema if actually needed.
Best regards

@_date: 2019-06-02 23:46:57
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Is limit-card-insert-tries a working option? 
I would say, why are you encrypting to the three subkeys?
In your original mail this stood up:
as it should be asking just for the needed key.
However, since for encryption you are using:
and you do have those three keys, it is asking for all of them.
So I would recommend you to use just one of them.
Or, if you really want to encrypt to the three subkeys (for backup?),
not to use the three of them on the same computer. So that you would
only have imported one of the secret keys (imported as in known by the
secret keyring that it it there on a smartcard)
Having three sets of subkeys on your key is weird
and it is likely to confusing when people write you (per Murphy's law
they will probably use for encryption the one you don't have with you).
You know you could have the same subkeys on three different yubikeys, do
Kind regards

@_date: 2019-11-28 01:29:39
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: multiple recipients encryption and decryption in gpgsm 
Sorry for the obvious but, does the receiving part have the private part
of the certificate that the sender thinks belong to them?
What you report seems like a perfect message with the receiver not
having their own keys imported.

@_date: 2019-09-06 00:33:50
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Generating bitwise identical keyrings with GnuPG 1 + 2 
I'm baffled by this.
Could you run gpg2 --list-packets on both keyrings and compare their
That should hint which packets are being included by 1.4 that are not by
Best regards

@_date: 2019-09-09 23:39:01
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Forward entire gnupg $HOME 
Using mutt locally seems much simpler than forcing gnupg to work that
You mention that you can no longer access your mailbox via nfs, but
since you can ssh to the email server, maybe you could mount it with

@_date: 2020-04-16 03:45:38
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: File permissions issue while doing GPG encypt and decrypt 
Did you somehow end up with the gpg program being setuid?
(as a 'solution' to gpg keyring files owned by root if he was directly
accesing nithin keyring, perhaps, whereas you should have changed the
owner there to nithin)

@_date: 2020-04-24 03:57:40
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Restoring keyring from backup fails 
GnuPG 2.2 is able to work with an old keyring. I think the problem is
that the step
meant keeping everything in .gnupg, overwriting files that were present
in the system. Thus, I presume:
* Before moving over the keys he ran gpg on the new system. This will
have created a ~/.gnupg/pubring.kbx file.
* He added (overwriting) to ~/.gnupg the contents of the old ~/.gnupg
* There was no pubring.kbx in the old system, so it happily used
* The new system sees that there is a pubring.kbx, and uses it, not
pubring.gpg as their contents would have been migrated,
Thus, he has two completely different behaviors with the same gnupg
version and (apparently) the same keyring.
It would be possible to import the old keys into the new format, but as
we don't need to merge different keyrings, I recommend to just remove
(move somewhere else) the ~/.gnupg folder in the new system and extract
there the contents of the old one.
Additionally, there may be a gpg-agent instance running. Kill that to
ensure that a new one is spawned.
Kind regards

@_date: 2020-04-28 03:31:07
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Passphrase window freezes my DE's panel - is this a bug? 
============================== START ==============================
First of all, you have created three threads about it. When you reply to
an email, you need to actually reply that mail. Just using the same
subject does not make the email get into the thread (could you imagine
the threads for emails title "Bug"?).
I am replying to the original thread, and glossing over points pentioned
over several threads.
QtPass is a frontend for pass, which itself is a password manager based
on gpg. So it's normal that a prompt for the underlying gpg key ends up
You may play with the agent ttl options on ~/.gnupg/gpg.conf so that it
doesn't request it so often
It is a (somewhat annoying) feature.
By grabbing the keyboard:
 a) it ensures that i don't accidentally type into another window when i
    think i'm typing in the prompter
 b) it keeps other X11 clients from sniffing the keyboard input

@_date: 2020-08-08 02:05:44
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Subkeys export to Security Token fails: Secret key available. 
You had some "full" keys (public+private part). Then "moved" them to the
Yubikey, so the private part was now in the yubikey, and locally you
left just a stub saying "go look at yubikey  for this key".
Do you have a backup of the full, original key?

@_date: 2020-08-08 23:23:43
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Subkeys export to Security Token fails: Secret key available. 
Then just restore the full key (either on your normal keyring or on a
temporary one, GNUPGHOME is your friend) and start again from that. It
should work that time.
Best regards

@_date: 2020-08-31 02:48:54
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: gnupg --fetch-key problems 
I don't think it's a good idea to block HTTP/1.0 requests. Your system,
your choice, of course.
HTTP/1.1 would require support for things that currently may not be
present, such as chunked transfer encodings, whereas HTTP/1.0 is
perfectly fine for the expected use.
I agree it should provide an User-Agent, though.

@_date: 2020-12-18 01:52:45
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: GPG Decrypt Error based on a timeout function? 
Probably a mistake in pasting the same as before. This command wouldn't
need the password for the private key. See gpg-agent settings. The few minutes it works, that's because gpg-
agent has the decrypted gpg key cached. You would need to increase that
timeout, or let the script provide the password directly to gpg / use a
passwordless key. When the sending fails, it should perhaps be asking
you to provide the gpg passphrase, my guess is that the way it runs (
--no-tty --batch maybe), it isn't able to launch a pinentry to ask the
password to the user.
If you really want the password decryption to be unattended, you could
configure the gpg password in the script, but then that would be
roughly equivalent to the email account password. It's turtles all way

@_date: 2020-12-18 01:43:09
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Does GPG Ever Store RSA Secret Keys On The Disk In Plain? 
It is encrypted with your passphrase. You (or an attacker) will need
the passphrase in order to use that exported secret key.
Except if the secret key wasn't protected with a passphrase, in which
case the exported key isn't, either.
You can verify yourself if the key is protected or not by feeding it to
gpg --list-packets.
A key protected with a passphrase will have a packet similar to this:
:secret sub key packet:
whereas if it didn't have a passphrase, you would see a simpler packet
with the data directly available:
:secret sub key packet:
The confusion probably comes because it requests the passphrase before
exporting. This didn't use to be the case (it just copied the protected
key file), but the way gpg-agent is dealing with the private key, it
now needs the passphrase to decrypt it, and then it is encrypted again
with the same passphrase before being output.

@_date: 2020-12-19 00:50:20
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: GPG Decrypt Error based on a timeout function? 
You cannot make a machine which needs a secret run fully unattended
without having such secret *somewhere*. You can move pieces around,
separate roles amongst different parts, protect a secret in a way that
a _different_ secret is needed instead, etc. But in the end, as the
machine needs that secret, you need to store it there. Or,
alternatively, have a human input it and have it stored in memory, with
the caveat that the machine won't be able to boot to a fully functional
state until that is provided.

@_date: 2020-02-20 23:28:33
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Encrypted GPG files 
See The files starting with 0xCx are using the "new packet" format
A file starting with 0x85 0x01 mean:
0x80 ? The bit 7 is always set
A file starting with 0xC1 0xC0 would mean
0xC1 ? The bit 7 is always set
The length is provided by the next bytes, 0xC0 would be the start of a
two-byte length header (from 192 to 8383
If you are not able to decode new format files, maybe it's a problem
with your client? What do you mean by smoothly decoding them?
Are you able to successfully  decode them from the command line?
I suspect that the problem may not actually be the packet format, but
something else presented by the same client that is choosing new format
(e.g. it could be choosing IDEA as cipher).
Issuing a  gpg --list-packets  over the file will probably give you
valuable information.
Kind regards

@_date: 2020-01-24 04:02:13
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Batch generate keys without revocation cert? 
Hello Jonathan
See if this helps
Anyway, you could always generate a revocation certificate and then
discard it.
Kind regards

@_date: 2020-01-27 01:56:22
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Passphrase and Key Structure 
Only if you want the backup to have the new passphrase.
The old files will still work perfectly fine as a backup. As long as you
remember the old passphrase.
Kind regards

@_date: 2020-07-09 04:23:52
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Traveling without a secret key 
You only use the dices suggested by Ryan for creating a new password. A local program is probably perfectly fine for creating "random"
passwords, though.
If you are traveling, you would do as in home: you bring with you your
password manager. You should probably prepare in advance a list of all
credentials you might need, and then only bring a reduced "travel-size"
version of your stored passwords (you could also take with you a
"simple" one you expect to use and a bigger -not necessarily complete-
one that you expect not to need to unlock).
Note that "bringing" could involve a physical entity, such as a file in
your laptop or a usb key, but also simply the ability to download it
from the internet (after logging into , probably).
You may obviously rotate all those passwords after you are back (as well
as before you depart, if you wish).
You still need to properly protect the master password of that manager,
which should probably involve memorizing it.
If you are only concerned about part of your travel itinerary, such as a
layover at a foreign location with few privacy guarantees, or just until
the time you cross the border (as is the case when crossing the British
or US border, where otherwise constitutional rights are
suspended),[1][2] you could actually deprive yourself from the required
knowledge to decrypt the content.
Let's suppose that you arrive Friday night, and will meet with the
foreign client on Monday, showcasing some company confidential
information to them stored in an encrypted laptop.
You could memorize half of the password, then get told the other half by
phone on Monday morning by your corporate lawyer. You would then a of
being unable to decrypt it while crossing the border, which means you
can't be coerced to provide it. This would make quite sense from the
point of view of the company. The border agents may not be happy with
that, though. And maybe result as well in a not-so-nice experience for
the employee.
On the other hand, if you were targeted by e.g. the MI5, you would
probably be returned a bugged hardware, and you better didn't travel
with a laptop there to begin with.
Kind regards
1- 2-

@_date: 2020-07-09 04:29:35
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Decryption stalling after SIGINT 
My guess is that when you opened gpg on the second terminal, there was
still a pinentry active on the first one, and so gpg asked gpg-agent for
decryption, which was awaiting for input on the first terminal, and was
thus "frozen".
I don't see how your Ctrl-C would have ended in such situation, though.
It would have been interesting to see a process list of what was going
Best regards

@_date: 2020-07-11 01:47:18
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Accidentally deleted ~/.gnupg/pubring.gpg 
I have some toll that could do that. It's a matter of bruteforcing 4
bytes. The user probably has some idea of *when* it was created, highly
simplifying it. In fact, assuming this is the same computer on which the
key was created (quite likely, since there is no backup), the filesystem
timestamp of the file holding the secret key shouild be at most a few
seconds off, thus making such search immediate.
i should note however, that if someone loses its public key, and it
wasn't published anywhere he can simply reach it (such as the
keyservers), yet he wants to keep using the same key, that probably
means that *someone* else has that public key, and thus it might be
problematic to create a new key. In which case, the public key could be
retrieved from one of the third parties having it.

@_date: 2020-07-31 03:50:18
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Yubikey : ed25519 signing failed 
You probably meant "~/.ssh/id_ed25519", not authorized_keys.
I don't think it will end up being a Yubikey problem. Is signing a
message with a ed25519 key stored in the yubikey working?
Signing a message or an authentication attempt should make no difference
for the Yubikey.
Can the agent/scdaemon open the device in order to communicate with the
Yubikey? Some permission issues end up as the generic "agent refused
operation" errors from the client pov, but they end up being silly
things like lack of rights to open a /dev/ file, such as the pinentry
unable to open the tty.
Best regards

@_date: 2020-07-31 04:25:14
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Protecting encryption server 
Please do not take offense at this, but I think you are way off-track
with how you are exploring solutions. I suspect a good solution should
go through a different venue.
This includes the diode proposal in the thread. It works for limited use
cases such as the voting system, but I don't think it could serve well
for ?Client programs access server(s) for real-time encryption or
However, at this point I think the real problem has not been specified
properly, and so we lack enough information to properly think what you
might need.
And I think you are way earlier than a prototype phase. In fact, it can
be detrimental in that it can be leading the proposing solutions on one
way, while there could be a better one (plus the cost of preparing a
useless prototype). You should have at least a rough idea on what the
design will involve before preparing a prototype.*
* Actually, on a system you will find *several* designs. It's fine to
code a prototype of the UI with little knowledge on how the backend will
be designed, it might be enough to know the basic that there will be a
username and password, and code from that to start exploring how to
integrate it with the rest of $ENVIRONMENT.
OTOH, if that small premise happens to be wrong (let's say there are no
user and password fields, it's all passwordless authentication based on
SAML single-sign-on at a different portal, to whom the users
authenticate using FIDO keys) that prototype would be of no use.

@_date: 2020-06-21 04:02:14
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: As a fan of GnuPG ... 
Each base64 character encodes 6 bits. So on average you can expect to
get those 5 characters there once in 2^(5*6) inputs, thus requiring
about 2?? operations.
Note you can do the same with gpg keys, getting such vanity keyids.
Best regards

@_date: 2020-05-10 00:18:47
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Maximum keypair length... 
Sorry, but your scenario is really weird, to the point I suspect you are
not understanding/taking things into account properly.
What do you try to achieve? What's your threat model?
If everyone involved will have both the public and secret daily keys, I
don't see the need for using public cryptography. Just generate all
those daily keys? as a random 128 bit passphrase each and use a
symmetric cipher such as AES.?
In fact, if everyone receives all the keys at once, someone that got
hold of one daily client by compromised a client, would get hold of all
of them. So your daily keys add about nothing here, and you can use a
single keypair or a single symmetric key.
A neat way to still change keys daily, rather than using that symmetric
directly, would be to use a HMAC of that key with the given day.
But really, an attacker won't recover your key through cryptanalysis,?
malware, wrenches and people's stupidity are more important threats.
A part when key rotation would help would be when people joins and parts
such group. A new member only needs to receive the keys from now on, so
if everyone used a different key each day, even if the new member
somehow had the ciphertext for the day previous to joining the private
group, he wouldn't be able to read it.
However, if in the above process we changed:
  Daily_key[today] = HMAC(, Today)
  Encryption_key = Daily_key[today]
with something like
  Daily_key[today] = HMAC(first 128 bits of Daily_key[yesterday], Today)
  Encryption_key = last 128 bits of Daily_key[today]
then we also get that property of protecting old messages from an
attacker with the key for the current day.
This allows the app to daily forget the keys of the day before
yesterday, so it cannot be obtained by an attacker that compromised the
device. In both cases, when people leaves the group you will need to rekey,
distributing new key(s) to everyone.
As for your usage of an ics file to store gpg keys, they have not-before
and not-after dates, so just distributing keys (or subkeys) with those
values properly set would have any implementation do the right thing of
picking the correct key.
However, there is little reason to create such keypairs, per above.
A more usual approach if you were using public key cryptography would be
to use a key per user and simply interchange pgp messages. Have a look
at how deltachat implements that.
Also review the Signal protocol,? which is much more complete (and
complex) than everything layered out here.
? Initially you mentioned 427 keys, but later mentioned they were "less
than 33 keys"
? You still need to properly use a block cipher mode such as GCM, don't
reuse iv, etc. You may use pgp for the encryption, but you would not be
using gpg keys.
? if everything is implemented properly
?

@_date: 2020-05-17 04:33:14
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Comparison of RSA vs elliptical keys 
It is quite large, indeed. This Radix 64 block of 12375 bytes contains
two signatures, of 3857 and 5225 bytes respectively. The first one EdDSA
(22) and the second a normal RSA one.
In both cases, most of the signature space is taken by a hashed
subpacket of type 38. This value is not assigned, but looking at
it is used to store the whole key used.

@_date: 2020-05-22 03:18:40
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: FW: gpg-agent connection errors 
Is the program installed on a remote server?
I would place the gpg-agent socket on a local filesystem. I don't know
how this AF_UNIX socket is actually implemented on Gpg4win (as a named
pipe, perhaps?), but your issues might be related to having it on a
network filesystem (I'm surprised it works, actually).

@_date: 2020-05-22 04:07:37
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: "just invent something..." 
Given the number of people that still manage to create (and distribute)
their keys with glaring mistakes, such as misspelling their own domain
name/tld, or providing a key which doesn't match their email address.
Too many people is sending and receiving openpgp emails by actually
encrypting the content on a separate application, then pasting it on
their MUA (often resulting in the openpgp armor contained in a html/text
block! ?). Which then leads to the occasional mistake of the wrong key
being manually chosen.
People should *really* use a MUA supporting OpenPGP if they are going to
send or receive OpenPGP emails. It's a big mistake that end users think
it's normal to process that separately.
I don't think relaxing the current uid validation would help with that.
Quite the opposite.
The stated issue could be solved, while keeping rfc4880 conformance, by
adding a skip path on the key creation:
I still wonder if it's worth adding that code for this limited use case,
Note you may need to set your alias for "",
not "president at whitehouse.gov". It will depend on how is gnupg called by
the MUA.
Best regards

@_date: 2020-05-24 04:56:02
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: "just invent something..." 
Handy link to the FAQ:
I see a big hole in the validation part. The steps providex are
validating the offline identity but not matching it to the certificate
I meet Rob, face-to-face
He shows me two ids that I consider acceptable
He gives me his email address , its
certificate fingerprint and place to download (WKD).
I download the certificate, I verify that it has the provided
fingerprint and that the provided email address does appear on the
certificate: ?Donald Trump ?
I sign the certificate, and send it to donaldtrump at sixdemonbag.org, so
he can share my signature attesting his identity.
And yet, I find something unsettling about that key with a Donald Trump
name just by meeting Rob Hansen face-to-face ;)
I would _probably_ keep some records somewhere that I had signed that
key based on meeting a certain Robert Hansen, but that actually means
keeping your own out-of-keyring identity map.
There might be an unwritten assumption that the name must match, too.
But in that case it should be explicit
It's also not clear what should be there. Consensus seem to be that
there must be _some_ kind of loose matching. Maybe, but for Robert
Hansen vouching for that certificate, the identity might be
* Robert J. Hansen
* Robert Hansen
* Rob Hansen
* Rob J. Hansen
* rjh
And he's far from being the only Robert Hansen, anyway:
Nonetheless, a name of ?Donald Trump? should probably not be accepted,
unless he is the name he goes by in certain circles.
(In fact, on [some] common law jurisdictions, it is possible to change
your name just by asking to be called that way)
Another scenario would be an identity where only an email was provided,
although in that case, it's not clear why you would want a
government-issued identification. You only need an attestation that the
key is owned by the mailbox owner.
It is already quite long, but I think this part should be expanded to
explain about how to treat the names in the certificates.
I'd also clarify that 7 is optional, and you don't *need* to send your
signature to the other party. This is actually much easily fixed.
Best regards

@_date: 2020-05-24 20:15:44
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: MacOSX help - beginner installation, first time 
What's your threat model?
What are the capabilities of an attacker? Are they able to modify the
files you are being showed? (maybe by compromising the sourceforge page,
or tampering with your connection)
Let's suppose you verified the dmg file GnuPG-2.2.20.dmg has SHA-256
You downloaded Enigmail_public_key.asc and checked it has fingerprint
4F9F 89F5 505A C1D1 A260  631C DB11 87B9 DD5F 693B
You performed this checks with programs known to be honest (a
hard-to-prove problem on its own, we probably take that as an axiom).
The values above are those I am being shown there. If they match those
you view, that suggest either:
* your connection is not tampered with (you are shown the same as me)
* those values are tampered on its source. It's hard that both your and
my connection are tampered by the same actor, but perhaps they modified
the web server.
* I sent you the correct values I was seeing, but that malicious actor
changed them before/after they arrived into your inbox. * I am part of the cabal that is trying to foil you into accepting those
malicious files
Even if those you got are the 'real' files, that only means those are
the ones produced by Patrick Brunschwig. Do you trust him? Do you trust
all the code he used to produce that package? Do you trust the build
machine or his key wasn't compromised?
Best regards

@_date: 2020-05-25 04:56:01
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: "just invent something..." 
I tried to cover that with
The point is, if I met you as Raubritter, a government-issued id showing
a different name is unlikely to help.
Similarly, I remember a blog post written by Skud during the Nym wars,
where it was mentioned that being presented in conferences under the
legal name ?Kirrily Robert? tended to cause confusion. [1]
Of course, this leads to question if it would ever help to see such id.
I do think it can be helpful. There are cases where the other party is
known to use their legal name. Seeing an official id, and assuming it is
a legit one (would you correctly detect a fake id? even from a foreign
country?), doesn't stop that an impostor could appear with a valid id on
that name  (just like dealing with stripe doesn't mean it's the company
you really mean to [2], or you could live on many Bostons), but it
should restrict the odds somehow, by filtering the possibilities.
Remember, if we know the legal name beforehand (e.g. when verifying a
university email address, a tenured professor is unlikely _not_ to be
using their legal name, although publishing means that naming in
academia isn't straightforward either [3])
For online identities, a TOFU approach would probably work better. You
would want to link the identity with its good or bad interactions to the
cryptographic identity, regardless if who makes them is named Rob or
For people you personally know -whatever the name-, you are probably
comfortable signing whatever name they used on their key, that's likely
how you know them and you may remember them.
However, that doesn't help much if you wanted t benefit from the WoT, as
the naming gets messy adding intermediate nodes between people.
Also, there are too many meanings given to a key signature. I would like
to have a standard set of notations with common meanings, so (in some
subset) we could all agree on what was meant.
Now, this is all quite complex to properly explain in a small FAQ entry,
focused to new users, and still be understood, I'm afraid.
Best regards
PS: I am no German speaker, so I have no idea what Raubritters are. Or
what would that term be used for 30 years ago, fwiw.
1- That site has fallen out of the internet and took a while to dig it
out, but I finally found it at
for the background on the why for that page see 2- 3-

@_date: 2020-05-26 01:54:02
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: "just invent something..." 
I do think the FAQ could benefit from an update. However, I do not claim
to know which would the right words to put there.
There are some ideas on my previous mails. I hoped that could spark some discussion, but they are not near a proposal. That's a tougher task :)
Maybe by giving it enough time I might come up with something to work
with, far from perfect, but some draft to built upon.
Thanks for the insight!

@_date: 2020-10-09 01:04:44
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Five volunteers needed (EU .... Are you sure that this is 
First of all, postcards are fine for a proof of concept. They are more
'fun' to send and receive. However, for a serious encrypted
conversation Alice and Bob should use enveloped mail.
Using a postcard you have pretty much weakened the letter
confidentiality, imho.
And if rather than writing text you are sending some electronics, a QR,
etc. you will be attracting even more attention ("Hey, John, see this
weird postcard that is being sent").
The real contents themselves are encrypted, but they would typically
want to blend with other messages, not to stand out. The NFC tags are
out of the way, since they can easily be found amidst all the mail.
A more subtle approach would be to have their armored pgp message with
spaces inserted, then sent inside an envelope, so that even if looked
against the light it seemed like filled with "normal word".
To consider postmen harder to bribe seems naive. Plus, there are many
hardworking sysadmins that would be offended by your words.
If you want to compare postal mail and electronic mail, you should
focus on the benefits of each medium.
For example, a letter sent to its final destination but not yet
received could be read by the admin of the email mailbox. A postman
could not "recall" the letter from your mailbox to read it after it has
been delivered (or, if it is possible to extract a delivered letter
from your mailbox, that's possible not only for your postman but also
for your neighbours).
Once you pick your physical mail, it's no longer in the mailbox.
Nowadays, most people keep a copy of their emails stored on their
providers' mailbox.
Most postmen will never open your mail to read it, nor will they
maliciously hand it over to a third party. However, if you were framed.
Maybe you were considered a person of interest by a Government, or a
competitor wanted to spy your mail (even though it'd be illegal), that
would not be complex.
If they managed to bribe the postman that delivers your mail would
simply keep mail directed to you on their bag. Then they would hand it
out to to their spymaster (or process it themselves on reaching home),
and actually deliver it the next day.?
That would require them some effort. But whoever is paying the bribe
should offer one that compensates for that.
Remember that while you may encrypt and sign the message to ensure
confidentiality and integrity, the postmen control the medium, and thus
You might want to send a canary token encoded ina QR and see if anyone
triggers that. Postmen is not expected and should not scan or read it,
just as the NSA is full of professional people that should not peek
into content unrelated to their assigned work, yet might end up sharing
your nude photos with their colleagues.?
(using a QR would have the interesting issue that I think some postal
systems do use a QR internally to encode the addressing, so could a
user-level message QR be confused -and thus scanned- with a transport-
level QR?)
As a coded letter is likely to bring attention to it (few people if any
send encrypted messages that way), they would ideally hide it into
something less conspicuous. They could use invisible ink over a normal-
looking text or, a pretty clever way to sneak your QR would be to
provide an ad of he products from a company, with the real data hidden
on different QR attached to the magazine.
? A postcard would be even simpler, just the time of taking a
smartphone picture and send to their contact.
?

@_date: 2020-10-14 00:22:33
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Five volunteers needed (EU .... Are you sure that this is 
Bob may be expecting to receive the safe, read-only NFC tag from Alice,
but Eve might have replaced it with a malicious one.

@_date: 2020-09-30 23:25:13
@_author: =?ISO-8859-1?Q?=C1ngel?= 
@_subject: Recovering private keys in a friend's GPG installation 
============================== START ==============================
Hello Andrew
gpg --list-keys --with-keygrip will give you the keygrip of the public
keys  you have. The filename of the private keys are the keygrip.
If they are associated with public keys nobody has then, while it would
be possible to recreate an equivalent gpg key if you had the key
creation time, it would probably be simpler to create new keys.
Best regards
