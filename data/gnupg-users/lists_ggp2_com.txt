
@_date: 2016-01-24 09:37:01
@_author: lists@ggp2.com 
@_subject: gpg: signing failed: Invalid IPC response 
After upgrading my packages (now on gnupg 2.1.9), I am getting an error
when trying to sign:
$ echo "test"|gpg2 -sa
gpg: signing failed: Invalid IPC response
-----BEGIN PGP MESSAGE-----
gpg: signing failed: Invalid IPC response
gpg-agent.conf contains:
pinentry-program /usr/local/bin/pinentry-gtk-2
and pinentry-gtk2 is asking for the passphrase properly.
This is all on OpenBSD, and everything has been working fine prior to updating to 2.1.9.
Here is some debug info from gpg-agent:
2016-01-24 09:26:33 gpg-agent[9415] listening on socket '/home/XX/.gnupg/S.gpg-agent'
2016-01-24 09:26:33 gpg-agent[13435] gpg-agent (GnuPG) 2.1.9 started
2016-01-24 09:26:34 gpg-agent[13435] handler 0x1817b661300 for fd 5 started
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK Pleased to meet you, process 12746
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- RESET
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- OPTION ttytype=xterm
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- OPTION display=:0
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- OPTION xauthority=/home/XX/.Xauthority
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- OPTION allow-pinentry-notify
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- OPTION agent-awareness=2.1.0
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- AGENT_ID
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> ERR 67109139 Unknown IPC command 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- HAVEKEY XXXXX
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- RESET
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- SIGKEY XXXXX
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- SETKEYDESC Please+enter+the+passphrase+to+unlock+the+OpenPGP+secret+key:%0A%22XXXX%22%0A256-bit+EDDSA+key,+ID+XXXX,%0Acreated+XXX+(main+key+ID+XXXX).%0A
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- SETHASH 10 XXXX
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- PKSIGN
2016-01-24 09:26:34 gpg-agent[13435] starting a new PIN Entry
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK Pleased to meet you, process 13435
2016-01-24 09:26:34 gpg-agent[13435] DBG: connection to PIN entry established
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION grab
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION ttytype=xterm
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION allow-external-password-cache
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-ok=_OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-cancel=_Cancel
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-yes=_Yes
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- ERR 83886254 Unknown option 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-no=_No
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- ERR 83886254 Unknown option 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-prompt=PIN:
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-pwmngr=_Save in password manager
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-cf-visi=Do you really want to make your passphrase visible on the screen?
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- ERR 83886254 Unknown option 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-tt-visi=Make passphrase visible
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- ERR 83886254 Unknown option 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION default-tt-hide=Hide passphrase
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- ERR 83886254 Unknown option 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> OPTION touch-file=/home/XX/.gnupg/S.gpg-agent
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> GETINFO pid
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- D 14005
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 -> INQUIRE PINENTRY_LAUNCHED 14005
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_5 <- END
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> SETKEYINFO n/XXX
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> SETDESC Please enter the passphrase to unlock the OpenPGP secret key:%0A%22XXXX%22%0A256-bit EDDSA key, ID XXX,%0Acreated XXX (main key ID XXX).%0A
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> SETPROMPT Passphrase:
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- OK
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> [[Confidential data not shown]]
2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 <- [[Confidential data not shown]]
2016-01-24 09:26:34 gpg-agent[13435] DBG: error calling pinentry: Invalid IPC response 2016-01-24 09:26:34 gpg-agent[13435] DBG: chan_6 -> BYE
2016-01-24 09:26:40 gpg-agent[13435] failed to unprotect the secret key: Invalid IPC response
2016-01-24 09:26:40 gpg-agent[13435] failed to read the secret key
2016-01-24 09:26:40 gpg-agent[13435] command 'PKSIGN' failed: Invalid IPC response 2016-01-24 09:26:40 gpg-agent[13435] DBG: chan_5 -> ERR 83886340 Invalid IPC response 2016-01-24 09:26:40 gpg-agent[13435] DBG: chan_5 <- [eof]
