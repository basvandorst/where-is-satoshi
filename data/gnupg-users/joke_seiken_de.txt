
@_date: 2010-04-16 14:37:30
@_author: Joke de Buhr 
@_subject: gpg-agent and ssh-keys not working anymore 
Usually I use the gpg-agent to manage my ssh keys. But now it doesn't work anymore. A few days ago I lost homedir and everything got lost. I rebuild the gnupg configuration to use the agent and the has ssh support enabled. I generated a new ssh key and added it to the agent via ssh-add.
Now every time I try to connect via ssh the pinentry window pops up and asks for a password to unlock the key. But pinentry always says the password is wrong and I keep getting the error message "Agent admitted failure to sign using the key.". The passwords are enter correctly and the ssh public key was added to authorized_keys. I tried generating new ssh keys but the problem is always the Anyone any ideas?

@_date: 2010-04-19 09:20:06
@_author: Joke de Buhr 
@_subject: gpg-agent and ssh-keys not working anymore 
I didn't have a host with gnupg version 2.0.15 ready so I regenerated the key on a host with gnupg version 2.0.12 transfered my gnupg configuration back and everything is working now with gnupg version 2.0.14.
Thank for a hint how to solve the problem.
The new ubuntu lucid which will be released in a few days and has a gpg-agent version of 2.0.14. Though gpg-agent is not the default ssh-agent this problem might cause trouble more in the next few months.

@_date: 2010-04-19 10:23:37
@_author: Joke de Buhr 
@_subject: gpg-agent and ssh-keys not working anymore 
I'm running the latest lucid version. Unless the patch was submitted only a few hours ago and the package hasn't been built yet the problem still exists in lucid.
I just updated and ran a test. Still the same error.

@_date: 2010-04-19 10:26:28
@_author: Joke de Buhr 
@_subject: gpg-agent and ssh-keys not working anymore 
It would be pretty bad if ubuntu releases gnupg with this bug since lucid is a long term support release and gnupg might receive up to 5 years of reports of regarding this bug on their mailing lists.

@_date: 2010-04-20 10:31:27
@_author: Joke de Buhr 
@_subject: gpg-agent and ssh-keys not working anymore 
I filled a launchpad bug report for this problem and attached the patch. The report refers to the new ubuntu lucid release version of the gnupg.
I don't know if the maintainer of the package is going to react and integrate the patch any time soon.

@_date: 2010-04-24 21:51:22
@_author: Joke de Buhr 
@_subject: Passphrase problem in gpgsm 2.0.14 
It's fixed in gpg-agent 2.0.15 and an ubuntu bug report is filled.
Please mark you are being affected by this bug so maybe the ubuntu maintainer will build a new package and include the patch.

@_date: 2010-04-27 12:21:19
@_author: Joke de Buhr 
@_subject: Moving from PGP to GPG 
You can access the files with gpg if you imported your private keys correctly. If you haven't been able to export you public keys from pgp and import them in gpg you can use the keyserver to refetch your the public keys this way.
Als long as you are able to access your windows partition were should be no problem working with pgp encrypted files.
If you are asking for a gui program for managing your gpg files just stick to the program of your desktop environment. For example if you are using KDE you can use kgpg to manage your keyring. You can access gpg encrypted files via

@_date: 2010-04-27 22:50:14
@_author: Joke de Buhr 
@_subject: Time output format 
The format of the time stamp can be change according to your locale. Just specify an individual setting for LC_TIME.

@_date: 2010-04-28 19:37:49
@_author: Joke de Buhr 
@_subject: smart card with 4096 bit keys 
I recently purchased this usb gnupg smart card Within an email developers stated the usb stick itself could handle keys with a length of 4096 but gnupg doesn't support these key lengths.
Is there any way of transferring my existing 4096 bit keys to the card. Generating new 3072 bit keys worked fine but it would be a lot better if I could stick to my 4096 keys.

@_date: 2010-08-17 11:31:23
@_author: Joke de Buhr 
@_subject: Importing subkeys from smartcard 
if I transfer my smartcard to an new host I can run   gpg2 --card-edit
    fetch
to import my public key from a keyserver. But if done so gnupg doesn't recognize the private subkeys stored on the smartcard. How do I tell gnupg where it should look for the private subkeys?

@_date: 2010-07-01 10:21:29
@_author: Joke de Buhr 
@_subject: How to sign a remote repository, i.e. forward agent 
Here is some kind of suggestion which might be helpful in your case.
If I need to do signing or encrypting on remote hosts I use ssh to execute the signing command on a other remote machine in this case my local machine.  It doesn't work in any case but in some cases like git tag signing, email signing or signing of files.
On the machine you want to do the signing/encrypting job create a wrapper shell-script called gpg. Put it somewhere first in path so the application which wants to call gpg calls the wrapper script instead. If you can specify which command to use point directly to the wrapper script.
The wrapper script should execute the gpg command on your local machine using ssh like this.
        ssh username at address.to.your.local.host /path/to/gpg_executable $*
The wrapper script will use ssh to run gpg "at home" where you keep your secret keys.
This kind of wrapping script is very limited. The application which wants to sign/encrypt something needs to pass the input data via stdin to gpg. Ssh will transfer the data back home run the gpg command there and send it back.
If your application wants to call gpg in a way like this it doesn't work:
   gpg --sign input.temp --output output.temp
But you could obviously rewrite the wrapper script like this.
        cat $2 | ssh username at address.to.your.local.host /path/to/gpg_executable \
        $* >  $4
You need to do some testing how your application calls gpg.

@_date: 2010-07-06 17:47:49
@_author: Joke de Buhr 
@_subject: GPG clarification 
The wikipedia has a very could article with lots of information on public-key cryptography. It covers a lot of your questions regarding public keys and private keys.

@_date: 2010-07-12 10:37:56
@_author: Joke de Buhr 
@_subject: Decrypting file encrypted for multiple recipients using a given 
Gnupg tries to decrypt with possible keys the order they appear in the keyring. You could rebuild your keyring and reorder the keys.
But as an alternative just hit the ESC button or press cancel until the password dialog shows the right key id. Enter that password.

@_date: 2010-07-21 17:42:12
@_author: Joke de Buhr 
@_subject: decryption failed: secret key not available 
Obviously you don't have the secret key to key 424E35F0. Are you sure it's your key. Your secret keys are listed by running
    gpg -K
Check if the IDs match.

@_date: 2010-06-03 17:13:12
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
Each key can be 3072 bit.
ssb>  3072R/0x96525A09870156C6  created: 2010-04-29  expires: never                           card-no: 0005 00000569
ssb>  3072R/0x5354A50986C9F1CC  created: 2010-04-29  expires: never                           card-no: 0005 00000569
ssb>  3072R/0x22EDBA56D3E557E9  created: 2010-04-29  expires: never                           card-no: 0005 00000569

@_date: 2010-06-03 17:13:30
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
Same with me. It seems to be a gnupg problem. If you don't use the scdaemon the stick can do sha512 signatures.
I added I bug report a couple of days ago.

@_date: 2010-06-08 11:12:02
@_author: Joke de Buhr 
@_subject: What is the "list keyring content" command? 
If I run the command on my primary keyring I get this output
 $ gpg2 ~/.gnupg/secring.gpg
    gpg: error reading key: No public key
It doesn't look like the "reasonable action" is deterministic.

@_date: 2010-06-10 16:35:34
@_author: Joke de Buhr 
@_subject: Keyserver spam example 
I've never gotten any keyserver related spam so far and my public keys with a valid mail address were published year ago.
I think it's more likely you will get spam because you are posting to a mailing list which does have a html archive (liks this one).
If you want to get rid of most spam, just filter everything sent from dynamic ip addresses and you're fine.

@_date: 2010-06-10 17:22:16
@_author: Joke de Buhr 
@_subject: Keyserver spam example 
I never said this particular spam message was not caused by someone scanning the keyserver. I only stated it isn't that common and never happened to me.
The chance someone harvesting your email address through keyserver scanning is less common than harvesting archives of mailing lists.
Keyservers have a large number of abandoned public keys with inactive email addresses. Whereas scanning trough a recent mailing list history will provide fresh addresses which are very likely to be working.

@_date: 2010-06-10 17:57:50
@_author: Joke de Buhr 
@_subject: Keyserver spam example 
One of the addresses of my key is totally unprotected against spam. Nothing is blocked or scanned there. And it doesn't get any spam at all.
As far as I know you cannot do a search like "2010" on keyserver webinterfaces to get recently created keys.
You do not sacrifice legitimate incoming mail because there is an RFC that clearly states mailservers do not operate from dynamic IP addresses. Therefore they can not be considered valid.

@_date: 2010-06-17 18:45:19
@_author: Joke de Buhr 
@_subject: Can we use GNUPG with PGP for commercial use 
Unlike PGP GnuPG is a non-commercial tool. There is no warranty. You can't sue anyone if GnuPG does not do what it's supposed to do.
If you need commercial support and liability stick to PGP and pay for it.

@_date: 2010-06-17 19:51:38
@_author: Joke de Buhr 
@_subject: Can we use GNUPG with PGP for commercial use 
As far as I remember the software needs to do mostly what it's supposed to do. It should do at least some kind of encryption and start without segfaulting. And advertised features need to be included and working.
In Germany some court ruled what certain parts of EULAs do not even apply.
And if you're legal region is the USA there might be a possibility you can sue PGP if the color of their icons is to bright and you get blinded.
Nevertheless legal departments of companies like to work with over companies just to pretend there is someone who can be sued. And project managers like know what support hotline to phone if something went wrong.

@_date: 2010-05-01 01:54:56
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
They seem to be trustworthy. I ordered a crypto stick last sunday. It arrived on friday (inner german transport).
The stick works fine with ubuntu 10.04 but you have to install a patched driver for libccid but it's quite possible the patch will be included upstream.
The stick works only with gnupg as far as I can talk now. The gnupg support is flawless. But the stick doesn't seem to work with opensc because the stick uses an openpgp card version 2.0 which isn't supported by opensc yet. So you can't use opensc's firefox integration unless opensc releases an updated openpgp card driver. The Firefox extension FireGPG works since it uses gpg.
I only tested the stick on linux and I haven't test things like pam authentication up till now.

@_date: 2010-05-01 02:31:09
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
I think it is. But isn't all packed within an usb dongle. There isn't a sim slot. You can't simply change the openpgp card. At least without opening (breaking) the casing.
The SCR3320 seems to be a little more universal.

@_date: 2010-05-03 12:22:12
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
I tried scute but it didn't work. I tried the versions 1.0, 1.1, 1.2, 1.4 and the svn sources.
Scute compiled without problem. I followed the documentation on how to setup gpgsm. Firefox lists crypto device and the private key on the key shows up underneath the crypto device.
As soon as I visit a protected page firefox asks which key to choose and after selecting my key I always get this firefox error message It doesn't matter which scute version I'm using it's always the same error. It's not specify to a website. I tried several.

@_date: 2010-05-03 17:17:35
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
I'm using Ubuntu lucid (amd64) with firefox 3.6.3.

@_date: 2010-05-06 23:49:04
@_author: Joke de Buhr 
@_subject: Signature algorithms 
I was wondering how gnupg chooses a digest algorithm.
I used setpref to configure my gpg key to accept sha512,sha384,... digest algorithms and set gnupg's option "personal-digest-preferences" to prefer sha512,sha384,... hashes. If I sign something and specify myself as recipient gpg2 in verbose mode reports it uses the ripemd160 algorithm.
As far as I understand the manpage gpg2 should choose sha512 not ripemd160. Does a smartcard affect the choosen algorithm. I recently started using the "crypto stick" smartcard which should be a openpgp card v2.

@_date: 2010-05-11 00:52:23
@_author: Joke de Buhr 
@_subject: Crypto Stick released! 
The developers said they are going to translate the shop soon.
As stated within the first email of this thread:
  "The Online Shop is currently in German only. Please mail me if you want
   to purchase a Crypto Stick and have trouble placing the order."
So mail him and ask for help: cryptostick at privacyfoundation.de

@_date: 2010-05-11 20:47:19
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
I've got more than one encryption subkey attached to my primary certification key. If someone encrypts a message using my primary key id as recipient gnupg always chooses the most recently created encryption subkey. Both subkeys are valid, neither one of them is revoked.
I'm not quiet sure but shouldn't gnupg encrypt to both (all not-revoked) encryption keys in this case? This way the user could decrypt the encrypted message (email) regardless what encryption keys secrets are available at the current location.
Joke de Buhr

@_date: 2010-05-12 01:34:10
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
Gnupg always choosing the last created encryption subkey doesn't prevent any kind of mix-up if a key has a private UID and a business UID. There is no connection between UID and the chosen subkey.
There isn't a way of specifing UID_0 (business) use encryption subkey_1 and UID_1 (private) use encryption subkey_0. At least no way I know about.
A user with two encryption keys will always get messages encrypted to the latest subkey regardless of specifying the business UID or private UID as recipient unless the sender explicitly selected a particular subkey for Telling people which key to use doesn't solve the problem. Think about me switching places between two computers. Each computer got only one of the two encryption secret keys. So if one computer gets compromised I only loose that specific encryption secret key which can then be revoked from the primary key.
PC_0 has the secret key to encryption subkey_0 and PC_1 has the secret key to encryption subkey_1. If I tell people to use subkey_0 I won't be able to decrypt the message if I'm working on PC_1. If I'm working on PC_0 I can't decrypt the message if the users used subkey_1 for encryption.
Since people don't know where I might receive mails I most certainly will get messages which are intended to be read by the owner of the primary key in over words me but since I don't have the correct public key the sender specified I can't read the message until I switch computers again.
On the other hand if a user doesn't specify particular subkey which is certain if he uses a default mailing program gnupg will always pick the last subkey so if I'm currently working on PC_0 (subkey_0) I can't decrypt the message at

@_date: 2010-05-12 01:42:05
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
The encrypt-to-all-encryption-capable-subkeys ensures that the owner of the primary key will always be able to decrypt the message no matter what (not-
revoke) encryption key secrets he can access at the moment.
And since it's his primary key the message is intended to read by him.

@_date: 2010-05-12 02:59:44
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
One possible argument against it could be the increased size of the encrypted message. But the size of an email isn't that important nowadays and if size matters the user should set a compression (bzip2) algorithm within the key The current implementation (always choose last) will use a RSA subkey if it's the last even if the user has a better NEW-subkey capable algorithm.
A gnupg commandline option like --realy-use-insecure-rsa could be added to new gnupg versions which support the NEW-subkey algorithm. Old gnupg versions would always use the old RSA subkey because they don't recognize NEW-subkeys.
New gnupg versions would always consider RSA keys as insecure and never choose them if there is a NEW-subkey present or the user forces gnupg by specifying
Again the current implementation will use a smaller encryption subkeys if it's the last one.
If a user has 2048 encryption subkeys and newer 4096 encryption subkeys he can always revoke the 2048 encryption keys. This way a encrypt-to-all-capable-not-
revoked-encryption-subkeys setting wouldn't consider encrypting to these keys anymore. But someone could always encrypt to a revoked 2048 subkey by specifying that particular one.
If a user has low sized keys which are not revoked he knows someone could use them since they are not revoked. If it wasn't his attention gnupg will output that the message was encrypted to multiple subkeys if he's using the command line interface and gnupg starts to do encrypt-to-all-... .

@_date: 2010-05-12 12:02:08
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
Currently if someone captures the last key and Bobs never refreshes his keyring he will always continue to send to the last key since he doesn't know it's been revoked and a new last key has been added.
The attacker could still read Bobs messages.
New behavior encrypt-to-all-not-revoked-encryption-subkeys:
Alice gets a warning because Bobs encrypts to both subkeys but one has been revoked at Alice. Alice could still inform Bob to refresh his keyring.
Gnupg states that a message is encrypted to multiple keys.

@_date: 2010-05-12 13:20:09
@_author: Joke de Buhr 
@_subject: Encryption to key with multiple subkeys 
Here are some tests how gnupg currently handles revoked subkeys. As you can see programs like Enigmail would notice if someone is still sending to a revoked subkey. If programs now recognize mails are being encrypted to revoked subkeys they would notice with a encrypt-to-all-not-revoked-encryption-subkeys Alice has a primary key with two encryption subkeys:
  pub  4096R/637AD7FA  created: 2010-05-12  expires: never       usage: C
                       trust: ultimate      validity: ultimate
  sub  4096R/97E46ACF  created: 2010-05-12  revoked: 2010-05-12  usage: E
  sub  4096R/5855A984  created: 2010-05-12  revoked: 2010-05-12  usage: E
  [ultimate] (1). Goo Gle Three messages were send to Alice (last would be encrypt-to-all):
  10.asc encrypted to subkey 97E46ACF
  01.asc encrypted to subkey 5855A984
  11.asc encrypted to subkeys 97E46ACF 5855A984
Alice decrypts the message if no key is revoked:
  gpg2 --decrypt -o /dev/null < 10.asc
    gpg: encrypted with 4096-bit RSA key, ID 97E46ACF, created 2010-05-12
        "Goo Gle "
  gpg2 --decrypt -o /dev/null < 01.asc
    gpg: encrypted with 4096-bit RSA key, ID 5855A984, created 2010-05-12
        "Goo Gle "
  gpg2 --decrypt -o /dev/null < 11.asc
    gpg: encrypted with 4096-bit RSA key, ID 5855A984, created 2010-05-12
        "Goo Gle "
    gpg: encrypted with 4096-bit RSA key, ID 97E46ACF, created 2010-05-12
        "Goo Gle "
Alice revokes a subkey (first or last) (example: 97E46ACF):
  gpg2 --decrypt -o /dev/null < 11.asc
    gpg: NOTE: key has been revoked
    gpg: encrypted with 4096-bit RSA key, ID 5855A984, created 2010-05-12
        "Goo Gle "
    gpg: encrypted with 4096-bit RSA key, ID 97E46ACF, created 2010-05-12
        "Goo Gle "
Gnupg informs Alice the message has been encrypted with a revoked key if Bob didn't refresh his keyring and his gnupg continues to do a encrypt-to-all. She could inform Bob to refresh his keyring. The same goes for other combinations of key revocation. If Alice revoked her last key (5855A984) and Bob's (unrefreshed) gnupg would encrypt a message to the last key as it currently does it would look like   gpg2 --decrypt -o /dev/null < 01.asc
    gpg: NOTE: key has been revoked
    gpg: encrypted with 4096-bit RSA key, ID 5855A984, created 2010-05-12
        "Goo Gle "
There is no different on Alice side if gnupg would do a encrypt-to-all-not-

@_date: 2010-05-22 12:54:59
@_author: Joke de Buhr 
@_subject: SHA2 digest, V2 smartcard and gpg-agent problem 
I've detected the same problem.
If I disable the gpg-agent and use gnupg v1 instead gnupg is able to connect to the pcsc daemon and use sha256 (and above) digests. If gnupg uses the agent every attempt to do sha256 signing (--digest-algo sha256) fails.
So this is most likely an issue of gpg-agent.

@_date: 2010-05-27 12:34:34
@_author: Joke de Buhr 
@_subject: Encrypted Directory 
Why would you prefer public key encryption? Are you planning on letting other people add files to that directory?
