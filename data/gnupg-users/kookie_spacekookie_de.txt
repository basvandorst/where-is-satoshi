
@_date: 2018-06-01 00:04:25
@_author: kookie@spacekookie.de 
@_subject: Problem signing git commits with smartcard key 
Hmmm...this is the output of gpg2 --card-status
Reader ...........: 1050:0407:X:0
--- snip ---
Signature key ....: 555F 2E4B 6F87 F91A 4110  669E 9073 4A9E 619C 8A6C
      created ....: 2018-05-30 14:51:48
Encryption key....: 61C3 62BB 16DD E6D4 12CF  D886 02B4 A3CD CBFF 6776
      created ....: 2018-05-30 15:06:41
Authentication key: 0451 14E6 0E98 AF5A 977B  3550 EA31 A1BF 4D0C 4706
      created ....: 2018-05-30 15:07:10
General key info..: pub  rsa4096/90734A9E619C8A6C 2018-05-30 Katharina Fey sec>  rsa4096/90734A9E619C8A6C  created: 2018-05-30  expires: never                                     card-no: 0006 07319482
ssb>  rsa4096/02B4A3CDCBFF6776  created: 2018-05-30  expires: never                                     card-no: 0006 07319482
ssb>  rsa4096/EA31A1BF4D0C4706  created: 2018-05-30  expires: never                                     card-no: 0006 07319482
Cross-referencing that with the output of gpg2 --list-secret-keys
sec>  rsa4096 2018-05-30 [SC]
      555F2E4B6F87F91A4110669E90734A9E619C8A6C
--- snip ---
uid           [ultimate] Katharina Fey ssb>  rsa4096 2018-05-30 [SEA]
ssb>  rsa4096 2018-05-30 [A]
So the first sub-key should be able to do signature, encryption and auth. But then again I'm also new to the whole yubikey thing so I don't know how exactly this is supposed to work ;)
~ Katharina

@_date: 2018-06-01 22:10:15
@_author: kookie@spacekookie.de 
@_subject: Problem signing git commits with smartcard key 
Aaah! Perfect, thanks :) I changed the capabilities of the first sub-key and now it works perfectly. Thanks for the quick replies and help <3
Have a wonderful weekend,

@_date: 2018-05-31 16:12:56
@_author: kookie@spacekookie.de 
@_subject: Problem signing git commits with smartcard key 
Hey there,
I have a yubikey 4 that contains my GPG key. I can use the `gpg2` tool to sign messages without problems. But when I try to do the same with git, it fails. The command that git runs internally is equivalent to this:
echo "This is a stream from git..." | gpg2 --status-fd=2 -bsau 555F2E4B6F87F91A4110669E90734A9E619C8A6C
Which outputs the following error:
[GNUPG:] KEY_CONSIDERED 555F2E4B6F87F91A4110669E90734A9E619C8A6C 0
[GNUPG:] BEGIN_SIGNING H8
gpg: signing failed: Invalid ID
[GNUPG:] FAILURE sign 100663414
gpg: signing failed: Invalid ID
I can sign commits correctly with a new key I made on my computer instead of on the yubikey and I'm trying to understand why this is. Generally these error messages are very cryptic and I've had a hard time finding out things about them.
Any help would be appreciated, thank you!
Katharina 'spacekookie' Fey

@_date: 2018-05-31 20:46:29
@_author: kookie@spacekookie.de 
@_subject: Problem signing git commits with smartcard key 
Hey there, thanks for the reply :)
So I did that, tried the whole thing again and this was spat out into the log:
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 <- SERIALNO --demand=D2760001240102010006073194820000
2018-05-31 20:27:42 scdaemon[17755] ccid open error: skip
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 -> S SERIALNO D2760001240102010006073194820000
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 -> OK
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 <- SETDATA 3031300D060960864801650304020105000420549B2B42DD5A5ED9F091E8614C838BA32CF21D67C8D83115B89A2738797BFCA0
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 -> OK
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 <- PKSIGN --hash=sha256 OPENPGP.2
2018-05-31 20:27:42 scdaemon[17755] operation sign result: Invalid ID
2018-05-31 20:27:42 scdaemon[17755] app_sign failed: Invalid ID
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 -> ERR 100663414 Invalid ID 2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 <- RESTART
2018-05-31 20:27:42 scdaemon[17755] DBG: chan_7 -> OK
tbh...I'm very much not sure what that means. Anything in there that gives you a clue what might be going wrong?
~ Katharina
