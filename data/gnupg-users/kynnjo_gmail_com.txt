
@_date: 2018-12-04 07:55:56
@_author: Kynn Jones 
@_subject: Book on gnupg? 
Hi everyone,
I need to write a program that uses gnupg (possibly through gpgme), but I'm
having a hard time understanding the documentation for this software.
I took something like "cryptography 101" in college, way back when, but the
stuff I read on gnupg/gpgme is filled with concepts that either I've never
heard of before (e.g. "armor"), or I'm fuzzy on (e.g. "signature").
A further impediment I'm finding is that most of the information I find on
gnupg is aimed for end-users.  I have found relatively little aimed at
software developers who want to use gnupg in their programs.
Where can I find a high-level description of gnupg, if possible addressed
to developers?
(Also, if possible, I would prefer a book, or a chapter in a book.)
Thanks in advance!

@_date: 2018-12-28 09:57:07
@_author: Kynn Jones 
@_subject: How to use *.pub/*.sec files to encrypt/decrypt another file? 
I created a pair of *.pub and *.sec files using the instructions and code
given here:
(I am using this documentation because the ultimate application I have in
mind is an automated encryption/decryption pipeline.)
How can use gpg2 and the *.pub file to encrypt another file?  And how can I
use gpg2 and the companion *.sec to decrypt the result of that last
Any pointers to relevant documentation would greatly appreciated.  I've
never been so lost when learning about a piece of software as I am with
Thanks in advance!

@_date: 2019-04-12 07:12:18
@_author: Kynn Jones 
@_subject: How to prevent passphrase-caching from within a gpgme-based Python 
Hi everyone!
The following short Python script takes three command-line arguments: a
passphrase, an input path, and an output path.  Then it uses the passphrase
to decrypt the contents of the input path, and puts the decrypted content
in the output path.
    from gpg import Context
    import sys
    pp = sys.argv[1]    # passphrase
    enc = sys.argv[2]   # input file (assumed to be encrypted)
    dec = sys.argv[3]   # output file
    with open(enc, 'rb') as reader, open(dec, 'wb') as writer, Context() as
        try:
            ctx.decrypt(reader, sink=writer, passphrase=pp)
        except Exception as e:
            print(str(e), file=sys.stderr)
This decryption works fine, as long as the correct passphrase is provided,
but it apparently results in the caching of such correct passphrase, so
that any subsequent decryption attempts succeed irrespective of the
passphrase one provides.  (I give a fuller illustration of what I mean at
the end of this post, together with version details.)
Clearly, there's some passphrase caching going on, but I don't really
understand the details.
What I want to know is: how can I modify the Python script so that it
disables the caching of passphrases?  Note that I am not interested in how
to disable passphrase caching outside of the script!  I want the script to
disable passphrase caching autonomously.  Is that possible?
Thank you in advance!
P.S. Here's a detailed example of what I alluded to in my post.  The script
./demo.py is the one whose source I listed above.  IMPORTANT: the code
given below behaved as shown only when I executed it from the command
line.  If I put in a file and execute it (or source it) as a script, then
all decryptions with the wrong passphrase fail, irrespective of any prior
successful decryptions with the correct passphrase.
    # Prologue: preparation
    # First, define some variables
    % ORIGINAL=/tmp/original.txt
    % ENCRYPTED=/tmp/encrypted.gpg
    % DECRYPTED=/tmp/decrypted.txt
    % PASSPHRASE=yowzayowzayowza
    # Next, create a cleartext original:
    % echo 'Cool story, bro!' > "$ORIGINAL"
    # Next, encrypt the original using /usr/bin/gpg
    % rm -f "$ENCRYPTED"
    % /usr/bin/gpg --batch --symmetric --cipher-algo=AES256
--compress-algo=zlib --passphrase="$PASSPHRASE" --output="$ENCRYPTED"
    # Confirm encryption
    % od -c "$ENCRYPTED"
    0000000 214  \r 004  \t 003 002 306 366   ^ 236   5 250   a   b 361 322
    0000020   X 001 263 332 302 250 027 300 222 271 345 235 027   E   K 302
    0000040 306   - 346 372 324   o   6 304  \a   "   9 270   ~ 307 361 302
    0000060 227 267  \f   ` 003   & 203 317 212   ^   1 240 267 234 321   '
    0000100 361 363 277  \v   :  \f   6 366 036 224   R 370   E 033  \r 261
    0000120   9 026 337   2 363 206 017 251 027   U   A 377 336 023 217 025
    0000140   p 333   ; 257   b 223 223   G   <
    0000151
    # Now, the demonstration proper.
    # Initially, decryption with the wrong passphrase fails:
    % rm -f "$DECRYPTED"
    % python ./demo.py "certainly the wrong $PASSPHRASE" "$ENCRYPTED"
    gpgme_op_decrypt_verify: GPGME: Decryption failed
    # Decryption with the right passphrase succeeds:
    % rm -f "$DECRYPTED"
    % python ./demo.py "$PASSPHRASE" "$ENCRYPTED" "$DECRYPTED"
    % od -c "$DECRYPTED"
    0000000   C   o   o   l       s   t   o   r   y   ,       b   r   o   !
    0000020  \n
    0000021
    # After the first successful decryption with the right
    # passphrase, decryption with the wrong passphrase always
    # succeeds:
    % rm -f "$DECRYPTED"
    % python ./demo.py "certainly the wrong $PASSPHRASE" "$ENCRYPTED"
    % od -c "$DECRYPTED"
    0000000   C   o   o   l       s   t   o   r   y   ,       b   r   o   !
    0000020  \n
    0000021
    # Some relevant version info
    % python -c 'import gpg; print((gpg.version.versionstr,
    ('1.10.0', '1.8.0')
    % gpg --version
    gpg (GnuPG) 2.1.18
    libgcrypt 1.7.6-beta
    Copyright (C) 2017 Free Software Foundation, Inc.
    License GPLv3+: GNU GPL version 3 or later <
    This is free software: you are free to change and redistribute it.
    There is NO WARRANTY, to the extent permitted by law.
    Home: /home/kj146/.gnupg
    Supported algorithms:
    Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA
    Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
            CAMELLIA128, CAMELLIA192, CAMELLIA256
    Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
    Compression: Uncompressed, ZIP, ZLIB, BZIP2
    % python --version
    Python 3.5.3
    % uname -ar
    Linux parakeet 3.16.0-4-amd64  SMP Debian 3.16.43-2 (2017-04-30)
x86_64 GNU/Linux

@_date: 2019-07-25 09:46:44
@_author: Kynn Jones 
@_subject: Need to implement a gpg/gpg2-compatible tool to encrypt millions of 
Hi everyone,
First, please allow me to define a bit of ad-hoc
nomenclature.  I will use the uppercase tems "ENCRYPT",
"ENCRYPTION", etc. as shorthands for "compress and
AES256-encrypt", "compression and AES256 encryption", etc.
Likewise, I will use "DECRYPT", etc. as shorthands for
"[AES256] decrypt and decompress", etc.
I need to ENCRYPT ~20 million files (~150TB) for long-term
(>15y) storage.  This ENCRYPTION will be done in several
batches, and will take place over many months (due to CPU and
bandwidth limitations).
The ideal solution would produce ENCRYPTED files that can be
decrypted using standard off-the-shelf gpg/gpg2. [1]
In my search for a library I could use to do this, I found
gpgme and libgcrypt.  I tried the former, and found it not
suitable, due to frequent gpg-agent-related failures.
libgcrypt, on the other hand, is a bit too low-level for
someone who is not acquainted with the fine details of gpg's
ENCRYPTION to replicate it.  (AFAICT, using straight-up
gcry_cipher_encrypt would not necessarily produce an
encrypted file (let alone an ENCRYPTED file) that could be
decrypted/DECRYPTED with standard gpg/gpg2.)
Is there something in-between gpgme and libgcrypt that would
allow me implement the required tool?
*Alternatively*, can someone tell me of a more efficient way
than reading the gpg2 source code for me to learn how to
implement gpg-compatible ENCRYPTION/DECRYPTION using
Thank you all in advance!
[1] This gpg/gpg2 compatibility requirement is important, as
an insurance that the files will be DECRYPTABLE in the
"distant" future (10-15y), even the my tool is not properly
enough maintained to be operational then.  This, of course,
assumes that gpg will have greater longevity than a privately
implemented, single-user tool like mine.

@_date: 2019-07-25 14:00:08
@_author: Kynn Jones 
@_subject: Where is the "INTEROPERABILITY WITH OTHER OPENPGP PROGRAMS section"? 
The GnuPG documentation refers to an "INTEROPERABILITY WITH
OTHER OPENPGP PROGRAMS section", but when I search for this
title, I find only references to it, not the actual section.
Does any one know where that section is?
Thank you in advance,

@_date: 2019-07-25 16:28:08
@_author: Kynn Jones 
@_subject: Where is the "INTEROPERABILITY WITH OTHER OPENPGP PROGRAMS 
: thanks!!!
On Thu, Jul 25, 2019 at 4:11 PM Daniel Kahn Gillmor

@_date: 2019-07-25 16:59:51
@_author: Kynn Jones 
@_subject: Need to implement a gpg/gpg2-compatible tool to encrypt millions 
Pardon my ignorance, but I gather from this example that I would have
to manage not only passphrases but also iv's as well?  (That would add
to my work's complexity.)
Don't get me wrong: GnuPG can definitely do the job you want.  But
Thank you.  This is a valuable perspective.  I'm all for simplicity!
In fact, if I could have it my way, I would use a library that does
nothing more than AES256-encrypt/decrypt (as long as I had any
confidence that it would still be maintained 5 years from now).
In other words, I would love to use a single-purpose tool that is to
AES256-encryption/decryption what, for example, gzip is to
Unfortunately, I have not been able to hit upon such a tool, which I
find a bit mystifying.  Instead, all the tools I have found fall into
two distinct categories: (1) ephemeral projects; (2) large systems
(like GnuPG or OpenSSL) in which the AES256-encryption/decryption
capability is such tiny subcomponent that it is very difficult for me
to find out what I need to do for my purposes.
(Who knows, maybe in the cryptography domain, complex
multifunctionality is what give systems their longevity.)
I assume that by this you mean that OpenSSL will still be around 10-15
years from now, and *not* that one can use gpg to decrypt an
openssl-encrypted file.  (Please correct me if I'm wrong!)
Thank you again!

@_date: 2019-07-26 21:08:30
@_author: Kynn Jones 
@_subject: tool to encrypt millions of files in unsupervised mode (was: Need 
I see, good point.
Thank you for the heads-up.  I had not considered this risk at all
until now.  I wonder if I can find a good set of test cases, maybe by
cannibalizing the test suites of other programs.
All very sensible advice.  Thank you!

@_date: 2019-07-27 13:06:36
@_author: Kynn Jones 
@_subject: Need to implement a gpg/gpg2-compatible tool to encrypt millions 
No I hadn't.  Thank you, it looks amazing.   (Still need to wrap my head
around it.)
