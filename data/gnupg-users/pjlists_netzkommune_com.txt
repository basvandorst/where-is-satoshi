
@_date: 2017-05-18 09:10:59
@_author: Philip Jocks 
@_subject: Did exit codes change in 2.1.21? 
we're using duply/duplicity with gnupg on FreeBSD and upgraded a few machines to gnupg 2.1.21 yesterday. That made the backups stop working, as some selftest doesn't work.
Running this:
echo "passphrase" | gpg --sign --default-key AAAAAAAA --passphrase-fd 0 --batch -r AAAAAAAA -r BBBBBBBB -r CCCCCCCC -r DDDDDDDD --status-fd 1 --pinentry-mode=loopback --compress-algo=bzip2 --bzip2-compress-level=9 -o /tmp/duply.2979.1495090227_ENC -e /usr/local/bin/duply ; echo $?
on 2.1.20 returns 0 and on 2.1.21, it now returns 2
I posted this message on the duply/duplicty mailing list, but given that gpg's exit code changed, it's probably not a problem in duply:
What seems to be "new" in the 2.1.21 output is
gpg: error getting version from 'scdaemon': Not supported
[GNUPG:] CARDCTRL 6
We don't build the FreeBSD port with SCDAEMON support. To verify, we built it for one box with SCDAEMON support, but the error is still the same.
Is there anything else we can try?

@_date: 2017-05-19 11:26:05
@_author: Philip Jocks 
@_subject: Did exit codes change in 2.1.21? 
seems to work. Now the exit code is 0 again, as expected. When building without SCDAEMON support, I get gpg: WARNING: server 'scdaemon' is older than us ((null) < 2.1.21)
[GNUPG:] WARNING server_version_mismatch 0 server 'scdaemon' is older than us ((null) < 2.1.21)
When building with SCDAEMON support, this warning disappears as expected.
With or without SCDAEMON support, gpg now properly exits 0 again.
Will there be a 2.1.22 soon to fix this?
