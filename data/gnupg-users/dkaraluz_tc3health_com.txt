
@_date: 2010-11-23 07:06:11
@_author: Dieter Karaluz 
@_subject: Help with the --batch option... 
Hi Werner,
Sorry to bother you with this but we upgraded to 1.4.11 and now have a
serious problem...
Let me give you some background information... we have three scripts
that run during the day:
1 - Scripts to decrypt files...
2 - Script to encrypt archive files with our key (American rules about
personal information in claims)
3 - Script to encrypt and FTP outbound client files.
These scripts are started by events and with 1.2 we never saw any
problems (other than that one file that would not decrypt and made us
Since the upgrade we get a few failures a day where the encryption
process produces a zero byte output file. When I look at my logs I see:
gpg: fatal: can't read `C:/GnuPG\random_seed': No such file or directory
secmem usage: 1696/1696 bytes in 5/5 blocks of pool 1696/32768
We then try the encryption script again and it runs fine.
Now, we have tight deadlines and the manual process of rerunning files
can potentially cause us to incur in financial penalties. So, before we
roll back to 1.2 I was hoping you could shed some light into this
First of all, is the encryption process multithread able? All three
scripts could potentially be started at the same time, and I could have
two scripts encrypting different files at the same time. Any other thoughts?
Here is the command line I executed:
c:\gnupg\gpg -r ehs  --batch --yes --output
--encrypt D:\TC3Utilities\Data\ftp\Outb\EHSTC3201011221808004010PROF.TXT
Any option I could use that would prevent this failure?
Vielen Dank!
-----Original Message-----
Sent: Wednesday, October 27, 2010 4:26 AM
On Tue, 26 Oct 2010 22:30, DKaraluz at TC3HEALTH.com said:
That one is an 8 years old version and this 1.2 series entered end of
life status 5 years ago.
It might be that we chnaged something related to batch processing but
that was a bug fix then. Either no passpharse was set for the key or the option --passphrase-fd
was used.  What you can do is to remove the passphrase from the key or
use one of the options: --passphrase-fd, --passphrase-file or
Too many changes over the years too quickly answer this.  Likey
candidates are:   2010-06-18
  2009-05-05
   Werner
Die Gedanken sind frei.  Ausnahmen regelt ein Bundesgesetz.

@_date: 2010-10-26 13:30:57
@_author: Dieter Karaluz 
@_subject: Help with the --batch option... 
This inquiry has two questions. Please include dkaraluz at tc3health.com in
your replies. Thanks.
We are running GPG 1.2.0 in production. We use it to decrypt all the
files we get from our clients through a batch script executed from a
Windows service. The command execute is:
c:\gnupg\gpg.1.2.0.exe -r tc3health --batch --yes -o
D:\PaidClaims\Data\Incoming\NGS\HST_Header_201010_1.zip -d
gpg: encrypted with 2048-bit ELG-E key, ID 5FC0F85B, created 2002-08-27
      "TC3Health "
And the decrypt generates a zip file. No manual intervention. But I am
having an issue with the zip file generated: WinZip reports "Error:
Invalid compressed data to expand file". And that prompted me to install
GNUPG 1.4.11 to see if that version corrects the problem. Now I am
c:\gnupg\gpg.1.4.11.exe -r tc3health --batch --yes -o
D:\PaidClaims\Data\Incoming\NGS\HST_Header_201010_2.zip -d
gpg: can't query passphrase in batch mode
gpg: encrypted with 2048-bit ELG-E key, ID 5FC0F85B, created 2002-08-27
      "TC3Health "
gpg: public key decryption failed: bad passphrase
gpg: decryption failed: secret key not available
I ran a test where I removed the --batch, and entered the passphrase
manually. The file decrypted fine, and WinZip had no problems opening
the content of the zip file. So 1.4.11 fixes whatever issue I am having
with 1.2.0. I did verify that the two zip files do not match when
compared in binary mode, so there is a change in the way the file gets
So here are the two questions:
1 - What do I need to do with gpg 1.4.11 so that it will decrypt pgp
files in batch mode. With hundreds of files coming in daily it is just
not practical to have someone entering the passphrase for each file.
GNUPG 1.2.0 does it fine. I did not do the original 1.2.0 installation
so I don't know what was done with 1.2.0 to make it work fine with the
--batch option.
2 - What fix was applied to 1.4.11 that solved the issue I am having in
1.2.0, and is there an option I could pass to GNUPG 1.2.0 that would
correct or work around the issue? Dieter Karaluz
