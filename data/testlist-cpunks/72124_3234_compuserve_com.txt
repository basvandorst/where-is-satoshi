
@_date: 1995-12-09 12:48:00
@_author: Kent Briggs 
@_subject: Diffie-Hellman with Blowfish 
I am working on a program that will use Diffie-Hellman with Blowfish to create a
public-key encryption system similar to the way PGP uses RSA and IDEA.  This
system would not have the digital signature feature that
PGP has, however.  I invite comments on any security problems that I might have
overlooked.  Bruce Schneier briefly mentions this idea on p. 515 of Applied
Cryptography (2nd ed): Key Exchange Without Exchanging Keys.
Key Generation
First, users select a private key passphrase.  The passphrase is case sensitive
and from 8 to 50 characters in length.  A random 32-bit salt is generated from
timed keystrokes.  The salt is appended to the passphrase and run through an
SHA-1 hash.  The output is a 160-bit value, x.
The 1024-bit public key "y" is calculated:
y = g^x mod p     (^ denotes exponentiation)
p is a 1024-bit strong prime constant that does not change. g is the generator
for that prime and is always 2.
The KeyID for the public key is the 32-bit salt.  The user publishes the public
key and KeyID values.  The key should be certified to prevent a man in the
middle attack.  The user imports public keys from others and places them on
their public key ring.
Note that there is no private key ring.  I could have used the PGP method and
made the private key a random number and then encrypted that number with a
passphrase.  This would be more secure but I was worried about users deleting
their private key file.  The 32-bit salt will discourage a pre-computed
dictionary attack.  An attacker would have to run over 4 billion SHA's and D-H's
and store the result for every passphrase in their dictionary.  To discourage a
dictionary attack on a specific public key, I will include a tutorial on how to
choose a secure passphrase.
The program will generate a 160-bit random private session key "r" based on
timed keystrokes by the user.  A 1024-bit public session key "z" is calculated:
z=g^r mod p
z is stored in the file header.
For each recipient, a "k" value is calculated using the recipient's public key:
k=y^r mod p
The session key r is now encrypted for each recipient by running each k through
an SHA-1 hash and xoring the output with r: k'=SHA(k) xor r
For each recipient the 160-bit k' value is stored with the recipient's 32-bit
KeyID value in the file header.  Each additional recipient adds 24 bytes to the
file header.
The plaintext is then encrypted with Blowfish in CBC mode using the 160-bit r
value as the key.  r is then discarded.
Note that I use the same r key for the Blowfish session key and
the Diffie-Hellman private key.  I could have generated a
separate r1 for Blowfish and an r2 for D-H but I don't think
this is necessary.
The public session key z is retrieved from the file header.  Each recipient
matches their KeyID with one of the KeyIDs stored in the file header.  From this
match they get their particular k' value.  They enter their private key
passphrase, append the KeyID salt and run it through an SHA-1 hash to get x.  k
is then calculated: k=z^x mod p
The original private session key r is decrypted: r=SHA(k) xor k'
The ciphertext is decrypted using Blowfish with key r.
Does anyone see any obvious security problems that I might have overlooked?
Kent Briggs
kbriggs at execpc.com
CIS: 72124,3234

@_date: 1996-08-24 19:36:58
@_author: Kent Briggs 
@_subject: Announce: Puffer 2.0 for Win 95 
I have released a 32-bit version of Puffer 2.0 for Windows 95 and NT
It has the same features as the 16-bit version except it now supports
file names.  The exportable shareware version is available from my web
site at:
An upgrade patch for registered users is also available there.  A brief
description of Puffer is provided below.
Kent Briggs
Puffer is a general purpose encryption tool for Windows that protects
personal and business data as well as your e-mail correspondence.  Use
Puffer to securely exchange data over insecure channels.  Puffer uses
state-of-the-art encryption algorithms for maximum security.  The
version has been approved for export from the U.S. by the State
through a commodity jurisdiction determination.
* 40-bit PC1 (RC4 clone) stream cipher
* 160-bit Blowfish block cipher (U.S./Canada registered version)
* Secure, multi-pass file wiping
* LZ77 compression
* Binary and ASCII archives
* Self-extracting executables
* Built-in editor
* Available in 16-bit and 32-bit editions

@_date: 1996-12-05 10:26:29
@_author: Kent Briggs 
@_subject: Codebreakers on the shelves! 
1181 actually, not including the table of contents and preface.

@_date: 1996-02-02 08:59:28
@_author: Kent Briggs 
@_subject: Beta Testers Wanted 
I'm looking for volunteers interested in testing the latest beta
version of Puffer 2.0.  Puffer is my shareware data file & e-mail encryption utility for Windows and has been significantly improved since version 1.0.  It is now a full-fledged public key encryption program utilizing Diffie-Hellman technology.  The exportable shareware version will support 512-bit public keys and 40-bit PC1 (RC4 clone) encryption.  The U.S./Canada registered version will also support 1024-bit public keys and 160-bit Blowfish encryption.  All versions support digital signatures, multi-pass data wiping (files, slack, & unused space), LZ77 compression, a built-in editor, and Windows clipboard encryption.
I am currently negotiating a patent license for the D-H algorithm with Cylink and an export license with the State Dept.  Testers must be residents of the U.S. or Canada.  I am looking for cryptography novices through experts using a wide range of PC hardware running Win 3.1, Win 95, or OS/2.  I also have detailed text files describing the security protocols and file formats used.  I would like experts to take a look at these to make sure I didn't do something stupid.  Those that can help will get a free copy of the final registered version.
The software will be a 417 K zip file available via http.  I will e-mail the protocol and file format specifications to anyone Please respond by private e-mail.  Thanks.
Kent Briggs
72124.3234 at compuserve.com

@_date: 1996-02-23 11:13:42
@_author: Kent Briggs 
@_subject: Puffer 2.0 Released 
FOR IMMEDIATE RELEASE                          Information Contact:
                                               Kent Briggs
February 22, 1996                              (817) 666-7737
                                               kbriggs at execpc.com
                                               CIS: 72124,3234
           NEW RELEASE OF WINDOWS ENCRYPTION UTILITY
Hewitt, Texas - Kent Briggs, author of Puffer, has announced the
release of version 2.0 of the popular shareware encryption utility.
Puffer is a password-based data file and e-mail encryption program
for Windows.  Encryption software allows users to keep their
personal, business, and electronic transmitted data private.
New for version 2.0 is the addition of a very fast stream cipher,
PC1.  PC1 operates with a 40-bit encryption key and produces the
same stream output as RC4, the most secure encryption technology
allowed for export from the United States.  Puffer retains the
160-bit Blowfish block cipher in the registered version provided
to customers in the U.S. and Canada.
Puffer's revamped interface features a tabbed-notebook layout and
a new built-in text editor.  Users can now encrypt and decrypt data
and e-mail directly from disk files, the editor, or the Windows
clipboard.  An LZ77 data compression option is also available.  The
ability to produce ASCII, binary, and self-extracting archives is
also retained in version 2.0.
New data wiping features have been added to Puffer to prevent
sensitive data from being unerased on your disk drive.  In addition
to wiping data files, Puffer now has options to wipe file slack and
unused disk space.  The user can select from one to seven random
stream passes for each wipe operation.  A separate DOS utility is
provided to securely wipe the contents of the Windows permanent swap
The shareware version (PUFF20.ZIP, 368K) can be downloaded directly
from the author's web site at

@_date: 1996-02-25 03:26:33
@_author: Kent Briggs 
@_subject: Puffer 2.0 Released 
Is PC1 a stream cipher implemented in a "clean room", by reference to an
abstract specification of the algorithm implied by the Alleged-RC4 source
code, that interoperates with RC4-40 ?
Yes, I wrote it in Pascal (Delphi) using only the English pseudo-code provided by Bruce Schneier in the 2nd edition of Applied Cryptography.  I call my implementation PC1 to avoid any possible trademark hassles.  The sample RC4 vector that the State Dept. sent me for my Commodity Jurisdiction request showed that my implementation is correct.  And
of course, there are no patents to worry about and I'm not under any
non-disclosure agreements.
RSADSI's government-sponsored monopoly on 40-bit exportable encryption
is over. I generate a key by combining a 40-bit pseudo-random salt with 40-bits
of secret key material.  The secret key material is the lower 40-bits of
a salted pass-phrase after running through a SHA-1 hash.
All the specs and file formats are included with the documentation.
Puffer is available at

@_date: 1996-01-13 08:43:48
@_author: Kent Briggs 
@_subject: p-NEW digital signatures 
I've been experimenting with discrete logarithm digital signatures.  Schneier
describes a scheme call p-NEW on page 498 of "AP" (2nd ed).
It has the advantage of not requiring an inverse calculation via the extended
Euclid algorithm.  The signature is shown as:
r=mg^(-k) mod p
s=k-r'x mod q
The verification equation is
m=(g^s)(y^r')r mod p
r'=r mod q.  If p is a strong prime then q=p-1 and r'=r.  The public key is
y=g^x mod p.  x is the private key.  k is a random number less than q.  m is the
message being signed.
I'm confused about the negative k value in the r equation.  This would lead to
1/g^k which is a fractional number.  It seems the equation should be:
r=mg^(q-k) mod p
Or, I can rearrange both equations like this:
r=mg^k mod p
s=-k-rx mod p
To avoid using negative numbers in the mod function, I can calc s as:
s=q-((k+rx) mod q)
I tried this with some small integers and the numbers work out.  The s
calculation will be quick since there is no exponentiation.  Most of the time
spent in signing a message will be the r calculation.  However, the the
verification equation [m=(g^s)(y^r)r mod p] has two exponentiation calculations
and will take more time.
Since a message is only signed once but could be verified many times, I could
precompute rg^s during the signing:
r=mg^k mod p
s=q-((k+rx) mod q)
z=rg^s mod p
s is discarded and the signature is r and z.  The verification is:
m=zy^r mod p
This slows down the signing but speeds up the verification.  Here's the $64K
question:  Does this compromise the signature's security?
Kent Briggs
kbriggs at execpc.com
CIS: 72124,3234

@_date: 1996-03-16 00:30:48
@_author: Kent Briggs 
@_subject: recent ( 3 months ) software developements? 
I released version 2.0 of Puffer, my symmetric encryption program for Windows last month.  The exportable shareware version (40-bit RC4, uh, I mean PC1) is available from my web site (  The registered version uses 160-bit Blowfish.  Both versions have a secure wipe feature and a built-in editor for on-the-fly e-mail encryption.

@_date: 1996-05-10 14:51:44
@_author: Kent Briggs 
@_subject: hks newsgroup 
hks.lists.cypherpunks has shown no new articles in the past three weeks.  I've
resubscribed to the mailing list but have seen no mention of the newsgroup's
status.  What happened to hks and is it ever coming back up?

@_date: 1996-11-01 10:38:21
@_author: Kent Briggs 
@_subject: Stanford Patents 
Has anyone heard anything from the Schlafly vs PKP case?  There
were supposed to be patent validity hearings on Wednesday.  I
don't know if they are still going on, Roger hasn't updated his web
page yet.
Kent Briggs

@_date: 1996-09-05 03:52:11
@_author: Kent Briggs 
@_subject: rc2 export limits.. 
Can you list a source for the 1024-bit signature restriction?  I know
about the 40-bit RC2/RC4 and 512-bit public encryption keys because they
are specifically addressed in the State Dept's "Procedure for Submitting
a Commodity Jurisdiction Request for a Mass Market Software Product that
Contains Encryption".  However, digital signatures are not mentioned in
this procedure.  I can't image what justificication could be used to
restrict the strength of digital signatures.

@_date: 1996-09-06 19:29:26
@_author: Kent Briggs 
@_subject: rc2 export limits.. 
I'm still skeptical that such a restriction (1024-bit signatures)
If I recall, I originally found the State Dept. doc on the EFF site
under a heading of CJ Export kit or something similar.  I don't know if it is still there but it was out of date anyway as the contact in it had retired.
You can probably contact the DoS and have them mail you one (as I did):
Attn: Sam Capino
U.S. Department of State
Office of Defense Trade Controls
PM/DTC Room 200
1700 N. Lynn Street
Arlington, VA  22209-3113
Voice: 703-875-7396
Fax: 703-875-6647
The procedure is 5 pages and titled "Procedure for Submitting a
Commodity Jurisdiction Request for a Mass Market Software Product that contains Encryption"
When using RC2 and/or RC4, you have to request a separate test vector
sheet titled "Supplemental Form for Mass Market Software Expedited Review" for each CJ request.
P.S.  Does anyone know how to turn off this Gratis auto-signing
service?  I keep getting double posts when replying directly
to the list via Netscape to hks.lists.cypherpunks.
