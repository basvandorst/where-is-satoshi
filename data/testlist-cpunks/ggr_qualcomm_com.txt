
@_date: 1997-02-03 07:25:52
@_author: Greg Rose 
@_subject: PCS Encryption? 
It doesn't sound quite right to me either.
I'm not Phil, but maybe I'll do.
The three different digital standards in North
America are TDMA, CDMA, and GSM (in NY and DC
only AFAIK).  Newer analog phones use at least
some of this, but I don't know much about them.
I'll ignore GSM. There is a fair bit of
commonality in the security of TDMA and CDMA
because of their use of the "Common Cryptographic
Algorithms". I like to think I'm only telling you
things which are in the "Interface Specification
for Common Cryptographic Algorithms Rev B.1".
CAVE is used as a hashing algorithm for a number
of purposes. Starting at the beginning (that's a
very good place to start... shut up Julie) it is
used to verify that the A-key programmed into the
phone is correct; the dealer or whoever puts in
26 digits, 20 of which are the A-key, and the
other 6 are a checksum calculated with CAVE, and
the Equipment Serial Number. (The ESN is always
used by CAVE -- I won't mention it again.) If
they agree, the phone buries the A-key very deep,
never to be seen again. (A_Key_Checksum,
and the phone create "Shared Secret Data"; they
start with a 56-bit random number and run CAVE on it and
the A-key. The resulting 128 bits is split into two 64-bit chunks called SSD_A and SSD_B. SSD_A is
used for authentication purposes only, while SSD_B
is used for the generation of keys for other
cryptographic stuff. (SSD_Generation, SSD_Update)
At various times, the base station authenticates
the phone by sending down a random challenge (32
bits); this is hashed by CAVE with some other
use-dependent data (not secret, but intended to
defeat replays) and SSD_A (either current or new,
depending on context) to form an 18-bit
signature. Since you only get one go to get it
right, 18 bits was deemed enough. Again depending
on context, the state of CAVE at the end of this
process may be saved for use later. (Auth_Signature)
The original intent seems to be that
Auth_Signature would happen at the beginning of
every call, but I don't think that is actually the
case. I'm not certain about the telephony end of
this stuff.
Now comes the encryption stuff. At the beginning
of each call, Key_VPM_Generation is called. (VPM
is Voice Privacy Mask.) This uses CAVE,
initialised to the saved state it had at the last
Auth_Signature, and SSD_B, to achieve two things;
it generates the CMEA key (64 bits), and it generates the
Voice Privacy Mask.
CMEA (Cellular Message Encryption Algorithm) is
used to encrypt bits of the signalling stuff over
the air, but never any end-user data. It is used
in different ways by the three standards, as they
have different message formats, but they all
(AMPS, TDMA, CDMA) use it.
The VPM is ignored by analog (I think). It is
constant for the entire call, and is XORed with
every frame for TDMA (cryptographically weak, as
you can XOR any two frames to cancel it out, but
since the frames are heavily compressed actually
getting anything from this is not trivial). CDMA
ignores all but the last 40 bits, which becomes
the initial "long code" for the PN (Psuedo-random
Noise) generator. This is a straightforward LFSR,
which again, is not cryptographically strong in
the face of known plaintext, but again, the input
is heavily compressed. More importantly, though,
for CDMA you need to have the long code before you
can easily sort out the signal from the noise
around it (it was originally developed from
anti-jamming technology), and since it has a
period of days before it repeats, the call will
probably be over...
The conclusion is that neither way of doing it is
truly cryptographically strong, but both are a lot
better than listening to Princess Di call Newt
"Squidgy" on a Radio Shack scanner.
Note, at this point, that neither the phone
industry or the NSA particularly cares about
end-user stuff being strong. The signalling
messages have a 64-bit key used much more
appropriately, and so cell-phone fraud is harder
to achieve.
Or you can take the bits out of existing phones.
Greg Rose               INTERNET: ggr at Qualcomm.com
Qualcomm Australia      VOICE:  +61-2-9743 4646   FAX: +61-2-9736 3262
6 Kingston Avenue       homepage.
Mortlake NSW 2137       35 0A 79 7D 5E 21 8D 47  E3 53 75 66 AC FB D9 45

@_date: 1997-02-03 12:11:30
@_author: Greg Rose 
@_subject: PCS Encryption? 
Technologically, GSM *is* a kind of time division
multiple access, but the term "TDMA" as I used it
is meant to apply to North American IS-128(?)
compliant things. They are definitely not
Greg Rose               INTERNET: ggr at Qualcomm.com
Qualcomm Australia      VOICE:  +61-2-9743 4646   FAX: +61-2-9736 3262
6 Kingston Avenue       homepage.
Mortlake NSW 2137       35 0A 79 7D 5E 21 8D 47  E3 53 75 66 AC FB D9 45

@_date: 1997-11-19 05:51:35
@_author: Greg Rose 
@_subject: export restictions and investments 
There are also special rules about "weapons of
mass destruction" in the Wassenaar Arrangement
rules, and also I think in other US regulations.
These make interesting reading -- any form of aid
to someone developing nuclear weapons, chemical
weapons, or biological weapons is forbidden. That
aid can be giving them money, expertise, or even
technical documentation. Has anyone at Sun ever
sent a Java manual to a pharmaceutical company
outside the US? Hmmm.
Of course crypto is not currently classed as a
weapon of mass destruction, but if there was an
electronic terrorist attack on the entire US
telephone system it could easily make people
think about changing that. And in the meantime the
list of chemicals mentioned above is sufficiently
broad that almost anyone could be technically
guilty of something.
(not normally very paranoid)
Greg Rose               INTERNET: ggr at qualcomm.com
QUALCOMM Australia      VOICE:  +61-2-9743 4646   FAX: +61-2-9736 3262
6 Kingston Avenue        Mortlake NSW 2137       B5 DF 66 95 89 68 1F C8  EF 29 FA 27 F2 2A 94 8F

@_date: 1998-09-19 22:16:49
@_author: Greg Rose 
@_subject: Repost in text: IDEA(tm) weakness 
I think this is wrong. It claims that the problem
in IDEA comes from the bias of the multiplication
operation... but the multiply in IDEA is over the
integers modulo 65537, with the 0 value
representing 65536, not 0...  this is in fact an
unbiased operation. However I have not attempted
to verify the rest of the logic.
Greg Rose                                     INTERNET: ggr at qualcomm.com
QUALCOMM Australia        VOICE:  +61-2-9181 4851   FAX: +61-2-9181 5470
Suite 410, Birkenhead Point               Drummoyne NSW 2047      B5 DF 66 95 89 68 1F C8  EF 29 FA 27 F2 2A 94 8F

@_date: 2001-07-29 08:09:32
@_author: Greg Rose 
@_subject: Fix for RC4 (was: Re: Attention CipherSaber Users!!) 
References: The fix that's been suggested for some time in the common wisdom about RC4, namely discarding the first 256 bytes of output, would seem to be entirely adequate to address the problems discovered. If this is considered to be part of the key setup, it slightly less than doubles the time, and it's extremely simple.
I have always felt that folding in the key with only a single pass was a bit "close to the edge". Note that the RC5 *key schedule* does at least three passes! (Not strictly comparable, of course.)
Another alternative suggests itself, which would be to continue the key-based randomisation for a second pass over the state array. I'd worry about weak keys that somehow undid their own actions, though, so I think I still prefer just letting the randomisation-through-generation continue.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-07-30 11:09:52
@_author: Greg Rose 
@_subject: A pattern emerges... 
Well, Australia is also looking at (and probably soon to pass) similarly draconian legislation.
The EFA is Electronic Frontiers Australia -- see Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-17 09:20:34
@_author: Greg Rose 
@_subject: SHA-1 rumors 
No, it was on the compression function, but not in any sense "reduced". But
you had to start with particular values of the chaining variables, and in
practice no-one knows how to do that, so MD5 (as a whole) isn't broken by
this, at least until tomorrow evening. The rumour here is that MD5, HAVAL,
and RIPE-MD are all goners. We know SHA-0 is toast too. There might also be
results against SHA-1. Hash functions are hard.
And the reason you haven't heard any progress from Dobbertin is because his
employers told him to either stop working on it, or stop talking about it,
depending which version of the story you've heard. Since he works for the
German NSA-equivalent, I guess he would take this seriously.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-18 13:11:22
@_author: Greg Rose 
@_subject: MD5 collisions? 
Eli Biham -- has collisions on 34 (out of 80) rounds of SHA-1, but can
extend that to probably 46. Still nowhere near a break.
Antoine Joux -- his team announced the collision on SHA-0 earlier this
week. There is concentration on the so-called "IF" function in the first 20
rounds... f(a,b,c) = (a & b) ^ (~a & c). That is, the bits of a choose
whether to pass the bits from b, or c, to the result. The technique (and
Eli's) depends on getting a "near collision" in the first block hashed,
then using more near collisions to move the different bits around, finally
using another near collision to converge after the fourth block hashed.
This took 20 days on 160 Itanium processors. It was about 2^50 hash
Xiaoyun Wang was almost unintelligible. But the attack works with "any
initial values", which means that they can take any prefix, and produce
collisions between two different suffixes. The can produce the first
collision for a given initial value in less than an hour, and then can
crank them out at about one every 5 minutes. It seems to be a
straightforward differential cryptanalysis attack, so one wonders why
no-one else came up with it. The attack on Haval takes about 64 tries. On
MD4, about 4 tries. RIPE-MD, about 2 hours (but can improve it).  SHA-0
about 2^40 (1000 times better than Joux).
Xuejia Lai clarified that the paper on E-print has been updated with
correct initial values. They were initially byte-reversed, which they
blamed on Bruce Schneier.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2005-10-04 10:13:32
@_author: Greg Rose 
@_subject: Venona not all decrypted? 
References: Here's my understanding of how Venona worked, and why budget would be a problem. I could be completely off base, though.
The OTPs were only very occasionally misused, by being used more than once. So the breaks occurred when two separate messages, or possibly fragments of messages, were combined in such a way as to cancel out the OTP, then the resulting running-key cipher was solved to yield the two messages. I don't think that the NSA had access to the pads themselves, except after having recovered the messages (and hence the pad for those messages). So there really isn't likelihood that that pad would be reused even more times.
To detect that a pad has been reused, you basically have to line up two ciphertexts at the right places, combine them appropriately, and run a statistical test on the result to see if it shows significant bias. This is an O(n^2.m) problem, where n is the number of units to be tested (maybe whole messages, maybe pages of OTP, maybe at the character level? Who knows?) and m represents enough text to reliably detect a collision. There was a very large amount of intercepted data, and it's presumably all stored on tapes somewhere, so that n^2 factor probably involves actually mounting tapes and stuff.
But in a way, you're right; it should, with today's technology, be possible to just read all the tapes once onto a big RAID, and set the cluster to work for a year or two.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C
