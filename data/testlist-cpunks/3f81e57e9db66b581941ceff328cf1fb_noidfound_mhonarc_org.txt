
@_date: 1996-02-10 18:09:57
@_author: Anonymous 
@_subject: new zip cracking code 
Does anyone have any pointers to cryptanalysis papers on the Zip
encryption scheme (presented below)? I've seen a few MSDOS executeables
which used some sort of brute force attack, which didn't seem
particularly intelligent or effective for long passwords. If anyone has
some pointers, or source I'd be glad to hear of it. From what I can see
of Schlafly's algorithm a bute force attack could be speed up a great
deal by pre-compution and expansaion of elements of the first 3 or so
rounds at the very least.
Ideas anyone?
The encryption used in PKZIP was generously supplied by Roger
Schlafly.  PKWARE is grateful to Mr. Schlafly for his expert
help and advice in the field of data encryption.
PKZIP encrypts the compressed data stream.  Encrypted files must
be decrypted before they can be extracted.
Each encrypted file has an extra 12 bytes stored at the start of
the data area defining the encryption header for that file.  The
encryption header is originally set to random values, and then
itself encrypted, using 3, 32-bit keys.  The key values are initialized using the supplied encryption password.  After each byte
is encrypted, the keys are then updated using psuedo-random number
generation techniques in combination with the same CRC-32 algorithm used in PKZIP and described elsewhere in this document.
The following is the basic steps required to decrypt a file:
1) Initialize the three 32-bit keys with the password.
2) Read and decrypt the 12-byte encryption header, further
   initializing the encryption keys.
3) Read and decrypt the compressed data stream using the
   encryption keys.
Step 1 - Initializing the encryption keys
The compressed data stream can be decrypted as follows:
loop until done
    read a charcter into C
    Temp <- C ^ decrypt_byte()
    update_keys(temp)
    output Temp
end loop
