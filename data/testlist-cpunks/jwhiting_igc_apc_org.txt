
@_date: 1995-12-08 10:46:55
@_author: Jerry Whiting 
@_subject: The Elevator Problem 
A group of us have been wrestling with a problem and I'd like to ask for some outside help.  We've come to call it the Elevator Problem.
Alice and Bob want to establish a secret in from of Eve.  In other words, they want to agree on a secret key in an elevator full of Eve's.
We don't want the protocol to step on any existing patents (DH, HM, etc.).  If the protocol takes numerous steps, that's OK because ultimately we'd like Alice's machine to contact Bob's, who could respond, and back and forth as often as needed.
We have also talked about a less than perfect solution IF we can establish mathmatically what the confidence level and risk factor are.  Alice and Bob might agree that the value of the secret is such that they can live with a 1 in n probability that Eve too has the secret.
Shamir's 3 step seems close but I'm afraid we've been doing the blackboard talks so long that we're missing the solution.  IF THERE EVEN IS ONE.
thanks in advance,
Jerry Whiting
jwhiting at azalea.com

@_date: 1995-12-09 00:22:55
@_author: Jerry Whiting 
@_subject: More elveator problem 
More on The Elevator Problem:
I'll confess that we're working on a new private key encryption product. Free and clear of existing claims on intellectual property, I'd like a protocol that answers the elevator problem: how can Alice and Bob agree on a private key via a compromised channel? I don't want them to meet under a street lamp and whisper in each other's ears _before_ trying to establish a secret on a crowded elevator.
I'm willing to accept that the basic question is undoable without stepping on DH et al., I just don't want to give up until all parties are convinced it can't be done.
As I stated in my original post, we're willing to consider less-than-perfect implimentations if we can quantify mathematically the risk involved. In some scenarios, Alice and Bob might not expect any Eve's in the crowded elevator or value the content at such a price that they're willing to live with less than 100%. As long as we can document the risk, the end user can make the decision as to whether the risk is worth it.
Something that I neglected to mention before is that Alice and Bob do have a unique ID within this system, not that they necessarily know each others. If one assumes that they do, they then share a secret: the knowledge of each other's unique ID.
Another segment of our attention is being spent daydreaming about the potential applications of a secondary channel in the cleartext portion of a crypto "package" or "bundle".  The comment about secondary channels that I believe Tim made regarding the inmates and the warden is something we discuss in our spare time.
Then again the wheels of justice doth turn and patents ain't forever...
Jerry Whiting
jwhiting at azalea.com

@_date: 1996-04-05 16:51:26
@_author: Jerry Whiting 
@_subject: time/date hash 
Interesting note in current issue of PC Magazine about how DOS 4 and later generates volume ID numbers. Neil Rubenking describes a time/date hash of the form:
  month plus seconds
  day plus hundredths of seconds
  high byte of the year plus hours
  low byte of the year plus minutes
I've actually been thinking about such a time/date hash during idle brain cycles.  Any thoughts on how secure such a hash is, as in how collision proof if the input date is from today forward 50 years?
Jerry Whiting
72627.746 at compuserve.com  <- til our server is back up...

@_date: 1996-04-13 14:54:19
@_author: Jerry Whiting 
@_subject: Lotus Notes 24-bit sellout 
When Ray Ozzie announced the work reduction sellout at the RSA conference, both he and Ms Denning (whom I spoke with about it later) mentioned that there was something else in Lotus Notes 4 besides the 40+24 bit compromise.
My thought is that the NSA gave them something else in exchange for the mandatory escrow scheme they're all talking about publicly.  Perhaps some other crypto code the NSA had lying around unused.
So looking for a common 24-bit subkey may reduce Notes' key to a 40-bit brute force exercise but the 40+24 is probably not ALL that's in Notes 4.
Definitely a deal with the Devil.  Given that we're talking about IBM, not Lotus none of this surprises me given IBM's Lucifer/DES history with spook input years ago.  Then again to be fair, I don't know if the 40+24 deal was cooked up before or after the IBM/Lotus merger.
Jerry Whiting
Azalea Software, Inc.
P.S.  Yes, I'm the one doing carrick "Encryption software so good, the Feds won't let us export it."  In fact, we schedule for a visit from the NSA next month regarding our desire to export carrick to Australia.  The mere mention of a Blowfish-based crypto product left my assigned spook momentarly speechless.  Something tells me they ain't gonna let carrick out of the country with a key length worth using.  AND I DEFINITELY AIN'T INTERSTED IN MAKING A DEAL WITH THE DEVIL.

@_date: 1996-04-14 14:32:39
@_author: Jerry Whiting 
@_subject: Lucifer & DES 
My apologies for any misunderstanding in my original post.  I was merely trying to point out IBM's historical compliance with govt suggestions for the design of the S-boxes.  Please excuse me if my facts are adrift.
My point was that this may shed light on IBM/Lotus' acceptance of the 40+24 work force reduction scheme.  IBM may be receptive to working with the government yet again.
Jerry Whiting
jwhiting at azalea.com

@_date: 1996-04-14 15:33:58
@_author: Jerry Whiting 
@_subject: carrick, Blowfish & the NSA 
One reason we chose to use Blowfish as the basis for carrick is that it _is_ a new algorithm.  One has to assume that the NSA et al. has tools optimized to crack DES and possibly IDEA/RSA.  At least let's give them something else to sweat over.  In the short term there's a high probability that a cross-platform Blowfish-based encryption toolkit will muddy the waters and make life interesting for us and a bit more challenging for them.
We're shooting for a May 1 release for Windows with the Mac and DOS 6 weeks behind and VAX/Sun a month after that.  We're aiming for the stars: encryption, time/date stamps, signatures, message digests, etc. all based on Blowfish.  We're doing a core engine with APIs, a standardized file format, and extensability for other developers.  We're very committed to making the spec including the API and file format VERY PUBLIC.  Like I said, we're aiming high.
So yes, if we're successful Blowfish should be taken more seriously.  And yes, when I outlined the above to the NSA while asking for an export permit, I was met with silence on the phone.  I can't wait to meet with them mid-May when they come out to visit.  My sense is that some junior level person(s) looked at Blowfish when Bruce originally published it in Dr. Dobb's and that their report was filed away waiting for the day when someone actually used it in the real world.
Our marketing tag ("Encryption software so good, the Feds won't let us export it.") may well become a self-fulfilling prophecy.  But that's OK because having others adopt carrick is our real goal.  Building up a strong U.S. user base is OK while we wrestle with the NSA over how big a key length we can export.  Their initial response was that 40-bit keys were specific to RC2 and RC4 and that Blowfish was another kettle of fish (bad pun intended).
Either way we're going to publish an extensive FAQ on carrick that should allow someone to not only work with carick but perhaps clone our efforts.  IANAL but my understanding is that publishing such a document, with or without source code, and making it publicly available to non-U.S. citizens is perfectly legal.
So NSA if you're reading this: This may be yet another example of locking the barn door after the genie is out of the bottle.  Prohibiting us from exporting carrick the product is pointless if we're allowed to fully document carrick the API and file spec.
    Jerry Whiting         jwhiting at azalea.com         1 800 ENCRYPT

@_date: 1996-04-15 03:12:07
@_author: Jerry Whiting 
@_subject: Blowfish ain't broken 
My understanding is that Blowfish using only 3 rounds, not the full 16, has been
broken.  And yes, duplicate entries in an S-box are weak keys.
carrick uses the full 16 rounds and we check for weak keys.
I'll sleep at night.
Jerry Whiting

@_date: 1996-02-20 21:12:34
@_author: Jerry Whiting 
@_subject: Credit card numbers 
Credit card check sums are based on the Luhn code.
Double the odd digits (1, 3, 5, etc.).  Use the sum of any 2-digit results.
Add all these numbers together to end up with one single digit.
Add this single digit to the sums of all the even digits.
The Luhn check digit is the mod 10 of that final subtotal.
For example 641205002340106 yields 4.

@_date: 1996-02-20 22:06:29
@_author: Jerry Whiting 
@_subject: PRNG in VB 
I am answering the courteous inquiry from Thomas Womack about my request for help with a Visual Basic-only PRNG.  The premise is that those who will not or
can not afford hardware-based RNG's need something relatively secure in the
face of nothing at all or at best a lesser implementation.
I was reluctant to post code at first but rather asked for an interpretation of 10 runs of 9999 characters each.  I want peer review of source code but the threads in CypherPunks have been of a shall we say "low signal to noise" ratio of late.  Even more so than usual.  I just didn't want to feed the beast at this time.
That said, here's the outline of what I'm doing.  A splash screen loads first
displaying a random tip'o'the day about good key management.  I make use of the getcurrenttime() Win API a lot.  Said to have 50 millicent increments.
' Load splash screen first
Sub Form_Load ()
  ' first randomize using number of milliseconds since Windows was launched
  Randomize getcurrenttime()
  ' then rotate the tip'o'the day (30 currently, adding unknown some delay)
  For j = 1 To Int(n * Rnd + 1)
    Select Case j
      Case 1
        hint.Caption = "You passphrase is SUPPOSED to look like gibberish."
      ...
      Case n
        hint.Caption = "Change your passphrases often."
       End Select
  Next j
End Sub
' user clicks an OK button and up comes 2nd screen
Sub Form_Load ()
 ' mix things up
  Randomize getcurrenttime()
End Sub
' main screen's OK button
Sub Command1_Click ()
  Screen.MousePointer = 11
  scramble = ""
  keyLen = Val(keyLength.Text)
  ' repeat for the number of characters in the desired key
  For i = 1 To keyLen
    ' character set is ASCII 33 to ASCII 127
    scramble = scramble & Chr$(Int(94 * Rnd + 33))
    ' reseed
    Randomize getcurrenttime()
    ' now make it wobble to throw off any regularity in the loop
    ' this loop works because as the 7 increases, so does execution time
    For j = 1 To Int(7 * Rnd + 1)
      'idle
    Next j
  Next
  Screen.MousePointer = 0
  secondaryForm.keyLabel.Caption = scramble
End Sub
I'd be happy with an analysis of just how random this is.  My working assumption is that over a >8 character key, it beats trying to dream one up in one's head.  Besides the getcurrenttime API, I don't know what else to sample without an external DLL or hardware.
I started out attempting a keyboard timing routine but had second thoughts.
My software company has been doing bar code printing tools for years. Now we're moving from simple encoding to encryption.
After playing with RSA Secure briefly, I realized that one way to spoof a request to type willy nilly to initialize anything is to use a bar code scanner.  The common type is sometimes called a wedge because you plug your keyboard into it, and it into the keyboard port.  It's wedged between the keyboard and the CPU.
So when asked to type (obstensibly to input randomly timed events) I scan a very large block of bar coded material.  I fill the keyboard buffer at a fixed rate; the throughput of my scanner and PC.  If I scan a large bar code, yes, I'll fill the keyboard buffer as fast as possible.  Little entropy in my eyes.
Oh yeah, with common symbologies like Code 39 and Code 128, I can recreate the whole lower ASCII 128 including tabs, LF/CR, etc.  So I can tab to activate buttons in some UI scenarios. Or do macros any any combination that may include control characters.
So gang, what about bar code scanners being used to thwart random typing Jerry Whiting
jwhiting at azalea.com

@_date: 1996-01-07 13:49:50
@_author: Jerry Whiting 
@_subject: carrick demo revisited 
Please note that the carrick demo that is available on  is just that; a DEMO.
As the documentation states, the file format is NOT what is in the full retail product.  The files that the demo generates are NOT compatible with the full retail version.
The demo is a marketing-driven effort.  The shipping version will have a different UI, a different file structure, a different file header, etc.
Azalea Software will make full source code available to those who wish to review carrick under nondisclosure agreement.  We have written an FAQ that details carrick's API's and file header.  It will answer many questions that some cryptographically sophisticated users may have.
We apologize for any misunderstanding or inconvenience the demo may have caused.  Again, the demo is a marketing piece to accompany the press release that we are distributing.  Ver 1.0 should be going out the door any day now and we invite all cypherpunks and other encryption fans to look it over.
Azalea Software, Inc.   1 800 ENCRYPT      carrick at azalea.com
