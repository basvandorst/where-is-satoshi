
@_date: 2005-12-15 08:02:33
@_author: Matej Kovacic 
@_subject: Data retention in Europe 
Since I live in Europe, just a short explanation of this.
Yes, it is about traffic data and not content. So Tor is a good solution
to this.
But there are some other problems as well.
In US there was a case Smith v. Maryland (Smith v. Maryland, 242 U.S.
735 (1979).), which diferentiates between content of communication and
traffic data. However, there is State v. Hunt decision (State v. Hunt,
91 N.J. 338, 450 A.2d 952 (1982).), which says individual can expect
privacy in traffic data also.
But European Court of Human Rights in 1984 (interesting date :-D) in
their Malone v. Great Britain decision clearly stated that traffic data
are integral part of communication.
There are some legal opinions that data retention won't go through so
called triple principle test. This test requires that regulation must be
a) legal (prescribed by law, law must be accesible to the public) b)
necessary in democratic society for the pursuit of a legitimate aim and
c) proportionate to the aim pursued.
It is also important to know, that European Court of Human Rights
critisized so called blanket measures in other decisions as well. So -
if there is no suspicion, individual should not be put under
surveillance. But data retention is that - surveillance and secret
tracking without prior suspicion.
The other interesting thing is that this directive was prepared and
adopted in very short time. How that?
It is likely that some strong lobby was behind direkctive. However, this
idea of extended surveilalnce is not new and is NOT the consequence of
antiterrorism measures. There are some documents from 1993 which show
that extension of surveillance and harmonisation of this area is not new
in Europe (see Interception of communications, report to COREPER,
ENFOPOL 40, 10090/93, Confidential, Brussels, 16.11.93, published on
Statewatch website in 1997). Terrorism is not the reason for this.
BTW: one of the latest proposals (I thik this version was also adopted)
said retention of data applies to ISP's only. No cybercaffes and public
places included.
The question is what are you doing in cybercaffe and wha in your home.
In cybercaffe you are surfing, posting on forums and checking your mail.
But you are not using P2P applications. P2P applications you are using
at your home.
So which lobby is behind directive?
Actually, there is only one lobby strong enough. This is the lobby of
anti-piracy groups and industry.
It is important to know, that first directive proposals stated that
retention is necessariy for fight against terrorism. But then they
started to talk about "serious criminal offences". What are they?
They are offences, which fall under European arrest warant. The warrant
applies in the following cases: a) where a final sentence of
imprisonment or a detention order has been imposed for a period of at
least four months or b) for offences punishable by imprisonment or a
detention order for a maximum period of at least one year.
Piracy and filesharing fall under European arrest warrant in some
european legislations. OK, it is true, that European arrest warrant is
in "crisis" since German constitutional court rejected it, but note
this: "no limitation to certain types of crimes for which access is
Slovenian Ministry of justice (I live in Slovenia) declared they support
data retention for all crimes which should be prosecuted officially.
So next step will be fighting this directive in constitutional courts
and finally on the ECHR.
Meantime we should propagate using Tor.
bye, Matej
Eugen* Leitl leitl ICBM: 48.07100, 11.36820            8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE
[demime 1.01d removed an attachment of type application/pgp-signature which had a name of signature.asc]

@_date: 2006-06-14 08:42:24
@_author: Matej Kovacic 
@_subject: Iran exit point 
access  are  hardly monitored and filtered, where clients have to show their
ID  to  enter an internet cafe and where all their data will be recorded, I
would like to understand how a TOR node can be run, unless it receives the
clearance of the administration!
I was living in former Socialistic Republic of Yugoslavia. We had a rule
that every user of a modem (for dial-up) should be registered by the
national telecom. The official reason was that there are some technical
issues which require registration. But it was a question of totalitarian
control, of course.
I have never registered and never had any problems - and the same was
with anybody I knew. I have heard similar stories with users using
strong encryption in France (which was prohibited).
So my explanation is that the control is probalby not so strict. And
sometimes it is possible to get a clearance routinely - officials
usually do not understand technical details and you just say something
that seems reasonably and get clearance.
But on the other side Iran could be sniffing Tor exit traffic to steal
some valuable information (industrial espionage for instance), or to
just annoy west governments (ok, less likely, but you never know).
However, I would say that internet communications in Iran are much more
monitored by the NSA than by Iranian government... :-))
bye, Matej
Eugen* Leitl leitl ICBM: 48.07100, 11.36820            8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE
[demime 1.01d removed an attachment of type application/pgp-signature which had a name of signature.asc]

@_date: 2011-05-26 00:31:16
@_author: Matej Kovacic 
@_subject: [tor-talk] OneSwarm 
sorry for just posting URL.
OneSwarm is a P2P file sharing service which uses anonimisation.
It is great because:
- it promotes anonimisation,
- it is open source and multi platform,
- it is user friendly,
- it is likely it will attract a lot of new users (promotion of
- is is faster than P2P over Tor, which means people will stop using Tor
for P2P (and Tor will be more useful for web browsing).
bye, Matej
tor-talk mailing list
tor-talk at lists.torproject.org

@_date: 2013-08-02 23:23:44
@_author: Matej Kovacic 
@_subject: XKeyscore: NSA tool collects 'nearly everything a user does, 
References: <51FA461B.6030809
OpenVPN for instance wraps its packets into some kind of container
(that's why you can run OpenVPN and web server on the same port - this
is called port sharing).
So it is possible to detect OpenVPN traffic with packet analysis. Some
network appliances can already do that.
BTW, I think there should be the next step in development of privacy
enhaching technologies.
First step was development of encryption techniques for the masses
(credits to cyphepunks movement in 1990's).
Second step was development of anonimisation (Tor).
Third step should be development of techniques for hiding encrypted
traffic. Obfuproxy, which is a part of Tor package, does that, but we
need general purpose standalone tools.

@_date: 2013-08-21 09:49:13
@_author: Matej Kovacic 
@_subject: Encrypted mailing lists? 
I would like to share some of my thoughts about encrypting mesages on
mailing lists.
I think that it would be really great if Mailman (and other mailing list
applications) would support encryption. When user will register to
mailing list he or she should send his/her public GPG key to the Mailman
server. He/she would then receive public GPG key of mailing list.
All mail sent to the list should then be encrypted (recipient is mailing
list address and user has it's public GPG key). Mailing list would then
decrypt it, and deliver that message to it's users encrypted and signed.
That approach would resolve several problems:
- user would know that messages are really coming from mailing list (no
impersonation here);
- no spam anymore (or at least much less spam) - registered users would
need to send encrypted e-mails to mailing list, all other messages will
be dropped;
- messages are sent to user in encrypted form (regardless mail archive
is public or not) - prevents eavesdropping on public places for instance;
- messages stored in user's mailbox are encrypted (this could be
important in some countries (don't forget bordercrossing!). Even if
mailing list archive is public, this prevents automatic forensic tools
to get useful information from the seized disks;
- if mailing list is not public messages in an archive are really safe
(remember quintessenz and NSA mailing list archive story? :-> );
- if mailing list is public messages in archive are still signed and
their itegrity could be checked;
- this would promote encryption in several ways: users would be "forced"
to use encryption and users would get familiar with encryption;
- and this is also important: more e-mail traffic would be encrypted by
default - that makes all us who use encryption more safe. Remember: NSA
thinks that everybody using encryption should automatically become a
target od broader surveillance - let's overload them).
I believe we should ask Mailman developers to include that functionality
in the future releases.
What do you think?

@_date: 2013-08-23 10:42:11
@_author: Matej Kovacic 
@_subject: Encrypted mailing lists? 
References: <521470F9.4040303 <20130821083950.6458.14953
 <2831997.rqjLtGiVRi
 <9CA32CC8-FFF9-410A-9AB5-F1F9E91BFD0F
 <2BF2095C-1D27-4AE9-8350-4AF1653CA718
 <8738q3t1a4.fsf
 <5F46B2AC-AF0F-4BA9-9848-89DC71109E67
 <20130823020559.GK7361
just a remark to a notice from someone, that the problem is trusting the
mailing list software - that it is properly encrypting/decrypting
messages, etc.
Yes, this is a problem of endpoint security, but the same problem we
have right now.
Encryption of e-mail in mailing lists would mostly:
- assure transport security from/to particular user only (remember -
mailing list passwords are send to users unencrypted!)
- promote use of encryption technology
This are by my opinion the most important goals of this idea.
BTW, if someone does not want to use encryption (because he or she has a
lot of emails), there should always be an option (for public mailing
lists) to decide whether he or she want to receive plaintext only,
encrypted or signed mesages. (The point is in choice. :-) )

@_date: 2013-12-09 21:59:17
@_author: Matej Kovacic 
@_subject: Android IMSI Catcher detection 
References: <52A5CA60.2050403	 Unfortunaltely I have no idea how to implement detection of A5/x
ciphering used or detection of silent SMS'es on Android. However, it is
very simple on Osmocom platform.
Anyway, IMSI Catcher detection project needs developers.
P. S. A little more info about GSM hacking is here:
We also have some nice videos showing identity theft in GSM network... :-))
I have also found out how to completely fake traffic data (data
retention anyone :-)) ) and even how to insert arbitrary voice recording
into eavesdropping database (in case police is eavesdropping to some
mobile phone). Nice to know how "strong" could be computer generated

@_date: 2013-12-10 11:56:39
@_author: Matej Kovacic 
@_subject: Android IMSI Catcher detection 
References: <52A5CA60.2050403
 <52A62F25.3030205
 <2ff1d371-5c2e-4dda-b6af-3a0e84fe77d2
No, the problem is, that mobile phone authenticates to mobile network,
but the opposite is not true. Since mobile network does not authenticate
itself to mobile phone, IMSI Catcher attacks are possible.
There has been also demonstration of "home-made" IMSI Catcher based on
Osmocom platform last year at the CCC conference.
The video of the presentation "Further hacks on the Calypso platform" by
Sylvain Munaut is here:
So, it is very easy to set up fake cell with any cell ID.
This would not work, because cells are not static (new cell emerge,
covered area changes, etc.) and opencellid database is not regularly
updated. There could also be femtocells used, etc...

@_date: 2013-12-12 09:20:03
@_author: Matej Kovacic 
@_subject: IndependenceKey? 
just a quick question - anyone familiar with this:
or with the Swiss company Quantec, whis developed this product?

@_date: 2013-12-26 16:05:01
@_author: Matej Kovacic 
@_subject: P2P VPN 
this might be of interest to you:
Peer-to-peer VPN
The VPN part of this project implements a Layer 2 (Ethernet) network
between the peers (VPN nodes). The peers connect to a central server
which acts as a chat server for them to establish direct connections
between each other (data connections). These connections are used for
transferring network data (Ethernet frames), and can be secured with a
multitude of mechanisms. Notable features are:
    * UDP and TCP transport
    * Converges very quickly after a new peer joins
    * IGMP snooping to deliver multicasts efficiently (e.g. for IPTV)
    * Double SSL: if SSL is enabled, not only do peers connect to the
server with SSL, but they use an additional layer of SSL when exchanging
messages through the server
    * Features related to the NAT problem:
         1. Can work with multiple layers of NAT (needs configuration)
         2. Local peers inside a NAT can communicate directly
         3. Relaying as a fallback (needs configuration)
More info here:
P. S. It would be nice to see this with easy to use GUI and prepacked
binaries for all "main" systems...

@_date: 2014-02-13 09:19:13
@_author: Matej Kovacic 
@_subject: Snowden and Compilers 
References: Below is a text of interview with Triulzi, from 2009. Website where this
was published has some technical problems (only slovenian version is
published, but english will be recovered in a day or two).
Menawhile, web.archive version is available:
Slovenian version ( has a
screenschoot of NIC SSH in action.
“All your firmware are belong to us”
by Matej Kovačič :: 26. september 2009
Interview with independent security and networking consultant Arrigo Triulzi
Arrigo Triulzi is an independent security and networking consultant,
working out of Geneva in Switzerland. He is a mathematician by training
but has been a consultant for over 20 years. His hobby is firmware
research. In November 2008 he had a presentation about project Maux –
his research about firmware rootkits.
Since firmware rootkits and exploits are interesting area of research,
we decided to make a short interview with him to present this topic to
our readers.
Matej Kovačič: First question – could you describe rootkits for our
readers in a few words?
Arrigo Triulzi: A rootkit is normally defined as a collection of tools
which allow the remote control of a system. They generally consist of at
least a sniffer, a password cracker and a backdoor.
Matej Kovačič: What is the difference between software and hardware
Arrigo Triulzi: A software rootkit is tailored to an operating system,
often a specific version of an operating system, a hardware rootkit is
tailored to the hardware of a specific system and is therefore operating
system independent. A reinstall of software on a system infected with a
hardware rootkit has no effect on the rootkit’s operation.
Matej Kovačič: Last year you had the presentation about malicious code,
stored on a network card. Could you describe what is the general idea of
hardware rootkits and what exactly have you done?
Arrigo Triulzi: The idea behind hardware rootkits (see John Heasman's
ACPI work, Jason Larson’s work on in-memory rootkits, earlier work by
the Austrian TESO group and Rutkowska's recent work on AMT) is simply to
have rootkits which are operating system independent and, in some cases,
hardware independent.
Hardware independence is given by the fact that a rootkit running in a
network card works independently of where that network card is used: if
it is in an IBM Power workstation, a Dell PC, a high-end switch or a
MIPS-based SOHO router. As long as the NIC chip is the same then it will
What I have done is to modify the NIC firmware in such a way that it can
react to external commands and, in association with other equipment on
the motherboard (the video card, specifically), provide a remote shell.
This remote shell is capable of viewing the system memory from which you
can extract whatever is of interest (passwords stored in clear, keyboard
buffers, graphics buffers, etc.).
An extension of this work is to provide a direct communications channel
between two NICs thereby providing a bypass in a firewall which is
totally invisible to the firewall's operating system.
Matej Kovačič: How were you able to load your firmware into the card?
You need some special hardware device or you can do it simply from the
computer? Is there any protection, like digital signatures of new firmware?
Arrigo Triulzi: Well, as all research projects it evolved from using the
flash update program which came with the NIC and simply feeding it my
modified firmware to using more sophisticated techniques like
discovering a remote update capability. The current version simply sends
the appropriate packets to vulnerable cards and updates them.
Different manufacturers use different layers of protection and it is a
general observation that the cheaper the NIC the worse the protection
is. Quite a few high-end cards make use of digital signatures to verify
that the new firmware is indeed from the manufacturer.
Matej Kovačič: How hard was to develop such a code, what kind of a
knowledge and equipment do you need?
Arrigo Triulzi: It all started out of curiosity and took about two years
of working when I had time to spare. The knowledge I built as I went
along and, for the hardware, by asking my father who used to design
Matej Kovačič: Approximate, about how many man-hours? By your opinion,
how much would need some well funded criminal organization?
Arrigo Triulzi: Well, I would say that it took me approximately 500
man-hours to get to the stage of having a working “shell” (it cannot
really be called a real shell as the commands are very limited). I doubt
that a well-funded organization would need much more time than I needed
but it should be noted that the ROI does not make the endeavour
worthwhile: while the current mechanisms work (phishing, viruses, etc.)
there is no point in spending time and money to go down the hardware route.
Matej Kovačič: There are several producers of network cards. How many
chipsets are in use? Rootkits for every branch should probably differ.
How much? Would it be possible to develop generic ethernet card rootkit?
Arrigo Triulzi: As I describe in my paper the marketing department is
your worst enemy: there are literally thousands of variants, many of
which are only ever documented in the OEM datasheets, and often little
changes (deltas) in the NIC production line cause my modified firmware
to fail.
A perfect example: I bought two 10-pack of allegedly identical NICs
(identical model numbers) and the production batches differed enough
that I needed to have two separate versions. The changes were minor but
it was only when I looked carefully at the main chip on the NIC that I
realized that they were different revisions of the same chip.
Now, can a generic NIC rootkit be developed? I don’t know, it might be
possible to write a NIC rootkit which works across families in the same
way that a kernel can run (at times suboptimally) on CPUs from Pentium
through Core i7 but I have not really looked at it.
Matej Kovačič: If you can run a custom code on a network card firmware,
you have direct memory access to RAM...
Arrigo Triulzi: Yes, you do, via DMA.
Matej Kovačič: Which means you can easily read and write memory without
CPU knowing anything about it... What are the other security impacts of
this and of your research?
Arrigo Triulzi: Well, the first problem is that it is invisible except
for the traffic on the network side - if you want to take data out then
you must pass it over the network and this means that it could be
detected. On the other hand the operating system has no hope unless it
has some way of comparing the current firmware with the original one.
The security impacts are a simple extrapolation of the above: you can
read (and write) data into any system in a way which is currently
totally undetectable.
Matej Kovačič: How to detect such attack? It seems software techniques
are long time not enough to keep us secure...
Arrigo Triulzi: The only way would be trusted computing if implemented
properly and without the DRM halo which it normally carries: it would
mean that the firmware on the NIC is trusted by the system and therefore
any modification would be detected and prevented.
There is probably no easy way to detect it in software - a simply
firmware comparison could be tricked by keeping a copy of the parts
which were modified on the firmware and returning those to anyone trying
to download the firmware for verification.
Matej Kovačič: How exactly would be possible to detect if firmare is
correct? TPM chip on every device?
Arrigo Triulzi: Well, if we were to implement TPM in such a way that
every component of a system is verified for both security and integrity
(it would be nice to know if your NIC is about to fail, independently of
the security of the device). This makes the boot process complicated
because you start having issues with chicken & eggs: what part of the
hardware needs to be powered up and in what order? How do you execute
correctly and, more importantly, securely, a WOL (wake-on-LAN) packet?
If you start thinking about it you realize that it is not a trivial
issue at all: if you need to process a WOL packet it means that you have
to have the NIC wake up first, but then how does the TPM verify that the
WOL packet has not tampered the NIC? Do you do it later in the process?
But then how do you know that the NIC has not tampered with other parts
of the system or, worse, is replying pretending to be other devices on
the PCI bus to the TPM queries? The paranoid can head for the hills now.
Matej Kovačič: What if someone installs malicious code in the factory?
Arrigo Triulzi: This is obviously a nightmare – you get a pre-installed
botnet with your Christmas PC purchase. It is one of the examples I
always use: someone installing modified NIC firmware at Dell just before
the Christmas rush, Dell ships loads of PCs and mid-January we have a
gigantic botnet distributed around the planet by DHL. No chance of
seeing the infection vector because it never touches the Internet until
the botnet is unleashed. See it as an out-of-band infection mechanism.
Matej Kovačič: How much memory does have network card? How big can be
malicious firmware?
Arrigo Triulzi: Very very little. This is why I had to branch out to the
GPU (video card) to find memory to put my shell in. I only really use
the smallest amount of RAM and firmware space on the NIC device,
everything else is done via DMA on the video card. In my first paper on
NIC firmware modification (presented at a closed conference) I gave the
figure of approximately 5s of sniffer data being held on the device
before the RAM filled up.
Matej Kovačič: Have you heard of Phenoelit research of security of IOS
operating system? Last year they demonstrated an interesting attack on
Cisco routers – they sent one special packet through router and were
able - for instance - to change firewall rules.
It seems it would be possible to bypass the network filters by smuggling
network card into the company, penetrate network routers from inside,
get internet access to compromised ethernet card and... the sky is the
Arrigo Triulzi: Indeed I have read Phenoelit’s research and rather than
smuggling a NIC into the company a better trick would be to take over
the firewall directly: if the firewall has NICs which are vulnerable you
can use something I call the “Jedi Packet Trick” to take over the
external NIC, then via the PCI bus infect the internal NIC and pass
packets directly between the two NICs. The name obviously comes from the
Jedi Mind Trick used to bypass the Imperial Stormtroopers…
Matej Kovačič: Last month we saw a malicious code could be also runned
on a Mac keyboard. Joanna Rutkowska and her team had shown how
vulnerable are hypervisors. Which hardware could also be exploited?
Arrigo Triulzi: Well, anything with a CPU: from the service processors
(IPMI, AMT, HP iLO) to SATA disks, to SCSI controllers, to video cards
(these I've already done some work on), network cards, etc.
Matej Kovačič: Yes, in your presentation you mentioned, you are able to
connect to video cards through network card (via PCI-to-PCI transport)
and run a malicious code there. This is much more powerful, because
video cards have much more memory and GPU has much more computing
power... Could you explain this in more detail?
Arrigo Triulzi: Quite simply the NIC is not powerful enough to do much
more than take packets off the wire and route them to a different
location over the PCI bus. You therefore need somewhere to run more
complex code and the obvious answer is (avoiding software, of course)
the GPU: the current crop from both ATI and nVidia are extremely
powerful and nVidia comes with a good open-source development kit.
So the packets come into the NIC, they are checked to see if they are to
be forwarded to the video card or are legitimate packets, they get to
the video card which processes the command and sends the reply back
through the same route.
Matej Kovačič: We haven't seen much security research about hardware
based attacks (comparative to software based attacks). Is there any
security testing of a new hadrware?
Arrigo Triulzi: Not really, no. At the moment hardware security rests
with manufacturers. I suspect that governments will test hardware
security for their more sensitive applications.
Matej Kovačič: Maybe some advice what to do if you are really paranoid
about security?
Arrigo Triulzi: As things stand I would recommend using pen and paper...
More seriously now: hardware rootkits are very sexy but hardly what is
needed these days. What is the point of a sophisticated hardware rootkit
when you can gain control of a user's machine by simply sending a
malicious image as part of a website or a malicious attachment with an
e-mail? At the moment the return on investment for hardware rootkits do
not make them viable so they are simply not going to be used except
where they are really needed which, in my opinion, is at the level of
serious industrial espionage. So the answer is that you had better
concern yourself with securing what you already use and make sure that
your online behaviour is not reckless, mail programs should come with
three to five layers of big red dialog boxes before they let you open an
attachment of any kind...
Matej Kovačič: I agree. But if you are a big company or government
organization, this things can become important. And then it is only a
question of trust. I mean, at the end of the day, you have to trust
someone – your software, your OS, your hardware. Who do you trust?
Arrigo Triulzi: As I mentioned earlier the more expensive cards do come
with signed firmware. If you decide to purchase the very cheapest
equipment then chances are that one of the areas the company didn’t
invest in is security. If you are a government organization you often
already have a source license for Windows, for example, and it is just
routine for approved vendors to provide hardware specifications
including the firmware update mechanism. You simply need to check that
it uses signed firmware and then verify the claim.
In many ways it is the usual story: “you get what you pay for”.
Matej Kovačič: Thank you very much.

@_date: 2014-02-20 13:29:33
@_author: Matej Kovacic 
@_subject: SSLv2 
does anyone know which tool could be used for cracking SSLv2?

@_date: 2014-02-26 09:38:27
@_author: Matej Kovacic 
@_subject: Telegram vs. Unhandled Expression 
References: <2004853.kmbRfK3vsB <1714654.Be1CP781r2
 <10324222.IxXungcVdZ
Founders of Telegram are also founders of VK, VKontakte, russian
alternative to Facebook.
The question here is, how close ties has VK with FSB, and how close ties
have their founders with FSB?
I have no idea, but below are some articles about this issue:
This is also very interesting:
Unfortunately, I do not know a situation in Russia at all, I am just
thinking what *could* be a problem.

@_date: 2014-01-06 17:08:02
@_author: Matej Kovacic 
@_subject: Jacob Appelbaum in Germany 
References: <52CAA24E.5060809
 <52CAA2A0.9070507 <52CAD18B.9080800
You are talking about NSA?

@_date: 2014-01-31 09:52:29
@_author: Matej Kovacic 
@_subject: Fw: Jim Bell's Email crash 
References: <1391068981.93832.YahooMailNeo
 <1391072079.73173.YahooMailNeo
 <1391103891.57065.YahooMailNeo
 <1391110481.3784.77371437.0FEEB11E
 <1391117081.22762.YahooMailNeo
That is why you should use local mail client for reading e-mail and not
webmail. You can also set that your local client stores a copy of your
mail locally (for instance with POP3).
With IMAP you can move e-mails from one provider to anothe easily. So in
that case it is very easy to move from one mail provider to another.
Then you can use a cloud and send your *encrypted copy* of local mail
there. Ubuntu for instance offers 2Gb for free. And they also have a
tool called Duplicity, which is able so make an encrypted backup - you
just set it up and it works automatically.

@_date: 2014-05-06 09:13:13
@_author: Matej Kovacic 
@_subject: OpenSSH memory leak 
(NOT OpenSSL!)
in case you didn't came aroud this:
Unfortunately, there is no patch yet...
