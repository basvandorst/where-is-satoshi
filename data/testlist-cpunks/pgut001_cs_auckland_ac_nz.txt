
@_date: 1996-04-01 17:24:20
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: New release of SFS available 
I have just uploaded version 1.19 of SFS to the grumbo.uwasa.fi FTP site as:
 551004 Apr 01 01:19 grumbo.uwasa.fi:/pc/crypt/sfs119.zip
This release contains a number of major improvements over previous versions.
The most important is that it follows recommendations on the use of encryption
software to be released later today in a joint announcement by the Committee of
Ministers of the Council of Europe and the US State Department.  To this end the
new version of SFS will abandon the use of MDC/SHS in favour of a classified
algorithm which the both NSA and GCHQ are confident will protect non-
confidential data.  Although the exact algorithm details cannot be published
due to its classified nature, it can be revealed that it uses prime number
cycle wheels, a system still employed today at the highest levels.
This algorithm improves on MDC/SHS by using a massive 2048-bit key, which would
take billions of years to exhaust via a brute-force search.  However in order
to satisfy the requirements of various organizations such as the Chinese
government (who need to ensure that no nasty outside influences pollute the
minds of their citizens) and to allow the originators of the 83.5% of all
Usenet traffic which contains porn to be prosecuted (a recent example being the
widely publicised move by the Office of the Bavarian Illuminati to force
Compuserve to drop all sex-related newsgroups), SFS 1.19 will store 2032 bits
of the key in the clear along with the encrypted data.
The head of the FBI Louis Freeh has been quoted as saying that "this will
provide adequate protection against your little sister or your mother, while
allowing law enforcement agencies to investigate people using encryption for
illegal purposes".  The head of the French DSSI agrees: "There have been too
many cases of industrial espionage by foreign government intelligence agencies.
For example in 1993 one such agency acquired over $1 billion worth of business
for their own countries' companies in this manner.  SFS 1.19 will protect
against this problem, while allowing us to maintain control over French
national security interests".
The German government has tentatively approved SFS 1.19 for public use provided
that it undergo a few small changes to comply with an updated form of the the
Fernmeldeanlagen Ueberwachungs-Verordung (FUeV), which will require that all
German users of SFS be connected to a central system to which copies of all
keys used, times of encryption and decryption, identities of users, and copies
of all encrypted data, be automatically forwarded.  The Minister of the
Interior Manfred Kanther stated that "this should fulfil the requirements of
the German government for monitoring possible criminal use, although I might
change my mind about this in a minute or two".

@_date: 1996-04-14 06:16:22
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: New paper on crypto regulation and the right to privacy available 
A paper exploring various aspects of cryptography and cryptography regulation
has just been published in the Journal of Universal Computer Science (J.UCS).
J.UCS is a Springer-Verlag electronic publication available at
J.UCS.  It's coming off a non-HTTP server so I can't give a direct URL, you
need to follow the links to Volume 2, No.3 to find:
  Government, Cryptography, and the Right to Privacy
  J.Shearer, P.Gutmann
  The notion of a right to privacy of citizens in their communications is
  discussed in the context of an international movement by governments towards
  regulation of cryptography, and consideration of key forfeiture systems in
  national cryptography use.  The authors argue that the right to privacy in
  communications networks is an issue of major importance, assuring freedom of
  the individual in national and global communications.  Regulation and control
  of cryptography use on the Internet by national governments may lead to an
  imbalance in the citizen/government power relationship, with sequelae
  including unprecedented surveillance of citizens, disruption of international
  commerce due to lack of powerful cryptography (and lack of standardisation),
  human rights abuses by less democratic or non-democratic governments, and
  limiting of the political potential of an Internet global political system.

@_date: 1996-08-03 15:24:51
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: crypto CD source 
I have about 100MB (compressed) of crypto archives, papers, source code, etc
etc, reasonably well organised with descriptions of each file.  I've got a
friend to put it on CD, but only for my own use.  If there's someone who can
get them done in bulk outside the US you could probably use this as a crypto CD
(I don't think there's anyone in NZ who could do it, and I don't really want
the hassle of organising the whole thing).

@_date: 1996-08-09 06:19:08
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: An SSL implementation weakness? 
The following weakness seems very obvious, I've got a partial writeup of this but before I turn it into a paper or something and arrange a demonstration of how it would work I thought I'd check to make sure (a) someone else hasn't mentioned it before, and (b) it is actually possible (it seems too simple to be true):
1. Using DNS spoofing, stage a hostile takeover of an address (for example    using bogus referrals set yourself up as the delegated server for a DNS    subtree).
2. Get a Verisign certificate for an arbitrary company and set up a bogus site    at the stolen address.
Lets say you steal   People connect to this site (which is actually your bogus site), Netscape (for example) displays the blue line and non-broken key (which is actually for your J.Random certificate rather than the real megafoobarcorp one) to show the connection is secure, and you've just subverted their site.  The problem is that unless the user on the client side checks their certificates (which noone does), all they're told is "A secure link is established", not who the secure link is established to.  Even if browsers did pop up a dialog to tell them who the secured connection was to, after about the third time people would click on the "Never show this incredibly annoying dialog again" option and never look at it again.     This effectively reduces an attack on an SSL-enabled server to an attack on the DNS.  Is this as simple as it seems, and is it worth doing a writeup on?

@_date: 1996-08-22 17:16:37
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: SSL: The early days 
I've been trying to find information about the early days of SSL for a paper I'm writing, but I'm finding that someone's comment about the net having a collective memory of about 12 months seems to be true - there doesn't seem to be anything available going back more than a year or so.  In particular I'm interested in:
- Why/how/when did Netscape decide on SSL?
- How long did it take to design the first version?
- I've heard a rumour that when it was first presented at a conference, two   people independantly broke it before the speaker sat down.  Is this true,   and what conference was it?
The later work on SSL (an open design process, contributions from cryptographers and security experts, IETF standards-track work, etc etc) is well documented, but information on earlier work is hard to find.  Does anyone have any pointers to information I could work from?

@_date: 1996-12-01 16:53:57
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Strong-crypto smart cards in Singapore and Germany 
Actually the German system contains some fairly elaborate safeguards to make
it pretty challenging to automatically track transactions (Germans have historical reasons for being uneasy about government monitoring).  However
given other German laws like the Fernmeldeanlagenueberwachungsverordnung
(yes, that's one word), which make the CALEA look like a picnic, I'm not sure
how long these safeguards will remain in place.  Given that the standard has
been created by a collaboration of all German banks, who are big enough to tell the government to take a hike if they demand access to the data, it may
be safe (certainly the people involved in the project that I've spoken to are
confident that they can keep the data private, however I'm not so sure how
it'll work out in the long run).
As for the Singapore solution, the Singpore government knows whats best for
you, so it isn't any of your business to question their judgement.  Anyone
thinking otherwise gets 25 strokes of the rattan.

@_date: 1996-12-20 14:08:09
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Van Eck articles 
I have a copy of the original German version of this, I can snail mail a copy
if anyone wants to translate it.  It has lots of graphs and diagrams which
probably won't scan very well, and it will need translation before most of the
people on the list can make any use of it.  I know there are English versions
floating around, but I've never seen one.
BTW the work was done in the early '80's, not 1990.

@_date: 1996-12-21 06:36:07
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: New Australian export regulations 
Australia's new export control regulations have just been posted to the net, you can get them from  (they're all Word 6.0 documents, I've been reading them with a binary file browser - blech).  What makes them interesting is that most of the text is word for word identical to the Canadian regulations (which is sensible, since the Canadian ones are clear and easy to follow, unlike the US "We'll let you know when you've broken the law" FUD regulations).  The only thing which is different is the section numbering, the mapping from Canadian to Australian section numbers appears to be:
  10xy.y.z -> xY00?.Y.Z where y -> Y == 1 -> A, 2 -> B, etc and z -> Z == A -> 1, 2 -> B, etc, so that Canadian 1151.1.c becomes Australian 5A002.a.3 (this doesn't work in all cases, if there's no .n suffix on the Australian number then the .n part from the Canadian number becomes part of the main Australian number, eg 1071.5 -> The text may not be taken straight from the Canadian one because some of the spelling mistakes in the Canadian one aren't present in the Austrlian one, or maybe it was prepared from a later version which had been spelling checked.
For crypto software, you want cat_5.doc, equivalent to section 1150 of the Canadian regulations.
Anyway, here's the good bit, in sou.doc, "GENERAL TECHNOLOGY NOTE (PART 1 - MUNITIONS LIST)"
Again, this is identical to the Canadian regulations.  Since the Canadian government has already ruled that a whole variety of crypto software is exportable under this exception, it means that the same stuff (and equivalent software from Australia) should also be exportable, or at least that you've got a very good case for arguing with the Australian government if they decide it's not exportable.
Then in definits.doc we again have the Canadian text:
It's nice to have this stuff laid out at last, because it finally takes the Australian crypto controls out of a gray area and defines them so that stuff like SSLeay and my own cryptlib aren't restricted.
Incidentally, there's also the cute:
This covers virtually any software development tool, and any kind of computer hardware, as well as natural neural networks and personal digital extensions (of the kind designed for keyboard data entry).
I wonder if we'll see the regulations retroactively changed when someone in Canberra realizes what they've copied from the Canadian regs :-).

@_date: 1996-02-09 11:08:34
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Encryption and Backups 
Death rays from Mars made jpp at software.net (John Pettitt) write:
It's slightly more secure than the widespread double rot-13 encryption.  PC
Tools uses 2-round DES (or at least it did the last time I looked).  There's some criticism of this in the SFS docs somewhere.

@_date: 1996-01-26 16:17:02
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: "Concryption" Prior Art 
Death rays from Mars made pcw at access.digex.net (Peter Wayner) write:
There's a much earlier paper by Frank Rubin in a 1979 Cryptologia which
covers encryption+compression with Huffman and arithmetic coding.
However the Con-cryption patent covers first compressing, then
encrypting.  Unless they've got very good lawyers, you can probably
ignore it.

@_date: 1996-07-07 00:39:49
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Transforming variable- to fixed-length keys 
In preparing the next version of cryptlib (which is going to have some cool
features when it's ready, which should be before the end of the millenium),
I've run into a problem in writing a general-purpose n-byte input to m-byte
output transformation function.  What this does is take an arbitrary-length
user key and transform it to a fixed-length encryption key (for example an
entered passphrase into a 112-bit triple-DES key).  The constraints on memory
usage are:
- The input (user) key can't be altered (you can't change data passed in by the
  caller)
- The user key can't be copied to an internal buffer (it can be of arbitrary
  length, and is sensitive material so shouldn't be copied elsewhere)
In other words there's no temporary storage available apart from what's
provided in the output key.  This is almost always a different length from the
input key.
Some other constraints are:
- The transformation must be algorithm-independant (it shouldn't, for example,
  rely on SHA1 to transform an input string into a fixed output of 160 bits and
  assume you'll never need a key longer than 160 bits).
This means you can't just use a single pass of a hash function to generate the
output key, since the output can be smaller or larger than the hash function
- The transformation must be able to be iterated to make a password-guessing
  attack harder to perform.
This one is tricky, since the lack of temporary buffer space means you can't
just feed the output back to the input and iterate.
Here's my initial approach, if anyone has any comments to make on this or knows
of a better way to do it, please let me know.

@_date: 1996-07-10 00:06:17
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Transforming variable- to fixed-length keys 
This doesn't work because the input and output buffer will almost always be of
different lengths.
No.  Each chunk is a new hash with , where  defaults to
SHA1.  Since (for SHA1) 64 bytes of input affect each 20 bytes of output, I
don't think there's much need for chaining.  I'm trying to keep the
specification as simple and easy to check as possible (one of the problems with
the PGP data management was that it was rather complex and hard to follow.  I
suspect it would be difficult to implement a compatible version going only from
a written specification).
The input wraps, just like the output, so for example the letter "a" would be
hashed as:
 aaaaaa[...]
That's another possibility.  The only thing here is that you're only changing
one byte for each pass, and I'm not sure if this is healthy.  I'll see what the
sci.crypt crowd (those who've survived the spamming) has to say about this - it
may actually be stronger than my increment-by-one method if you're worried
about related-key cryptanalysis.

@_date: 1996-07-20 18:00:29
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Making encoding out of an authentication cipher 
Green alien space slime made ogren at cris.com ("David F. Ogren") write:
It depends.  On a PC (the most common type of computer hardware) you're limited by the bus speed.  Most encryption cards are still ISA (so far I've managed to find a single PCI DES card, everyone is still shipping ISA cards because they're the lowest common denominator).  This means that even with a 15 MB/sec DES chip you can't get more than 1 MB/sec throughput.  I think the breakeven point for MDC/SHA vs the ISA bus is either a P5/90 or a P5/100 (I don't have access to either of them to check this right now).  This isn't just for MDC, virtually anything on any recent PC is faster than the ISA bus (in fact from Eric Youngs libdes figures there are CPU's which will do software 3DES faster than hardware 3DES on an ISA bus).

@_date: 1996-07-31 14:24:31
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: RPK Public Key Cryptography 
Tall men in dark suits made Stephen Cobb  write:
It's just Yet Another PKC.  Look at the history of LUC for a similar example:
An amazing new breakthrough in PKC is announced, after a couple of years of
analysis by cryptographers it's found to be no better or worse than existing
PKC's, but in any case noone uses it because the existing patent covers only
the US and expires in a few years whereas the LUC ones cover much of the world
and will be around for ages.  RPK is a similar case (actually it's in a
somewhat worse position, by the time it's been subjected to enough analysis for
people to trust it, the RSA patent will have expired, making RPK unmarketable). Other comments on the system:
 - The inventor apparently has no plans to publish details on the system in a
   journal or present it at a conference for peer review.
 - Someone who used to work with him rates him as a fairly competent
   programmer.  His crypto skills are unknown.
Given what happened with LUC I predict more of the same for RPK.

@_date: 1996-03-25 11:48:01
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: protection on IoMega ZIP drives 
Death rays from Mars made alano at teleport.com (Alan Olsen) write:
The Zip drives have a firmware bug in that they don't do anything if the
(appropriately-named) FUA bit is set in SCSI requests, and then return a
command complete status.  SFS 1.20 has a workaround for this problem.  It
works with both SCSI and parallel-port versions.  Before anyone asks
when it's due out, its the end of February, probably about the 60th of the

@_date: 1996-03-27 15:06:22
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Test case for RSA t-shirts 
[I posted this to comp.org.eff.talk but got virtually no response, maybe
 someone here can make use of it]
In July I'll be going to the US for a conference.  I have one of Adam Backs
RSA-in-perl t-shirts and am prepared to wear it into (and possibly back out of)
the country if anyone feels it would do any good (for example to act as a test
case for exportability).  If anyone thinks this would be useful or wants to
offer a legal opinion, let me know.
For something less trivial, I can also carry in a disk of crypto code or
something similar (say, 20 pages of DES bar codes) and see if I'm allowed to
take it back with me.

@_date: 1996-03-30 19:11:04
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: trouble with idea.c from cryptl99.zip 
Tall men in dark suits made Jack Mott  write:
Arrgghh!!! That defeats the whole purpose of the library, which is to provide a
standard interface to many different algorithms.  If you use the routine the
way it's meant to be used (via initCryptContext(), etc) it'll work fine.
BTW the reason it isn't encrypting is that by the looks of it you're not
calling the IDEA key schedule code.

@_date: 1996-05-18 08:21:12
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Any DLL's that handle Public Key Encryption or Key Exchange? 
Tall men in dark suits made draven at infi.net (Greg Morgan) write:
The next release of my encryption library (currently available as
ftp://garbo.uwasa.fi/pc/security/crypl110.zip) will contain a nice fast RSA
implementation.  It includes 16 and 32-bit DLL's.  Actually the current version
has support for it, but I took out the code because the key management routines
weren't ready yet.
There are two things worth noting, the first is that RSA itself isn't much use
without a *lot* of key management code (which is what's holding up the
RSA-enabled version).  The second is that if you're in the US you're probably
going to run into legal hassles using this code unless someone wants to do an
alternative RSAREF implementation which you can plug in in place of the
existing RSA code.

@_date: 1996-05-18 16:06:07
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Any DLL's that handle Public Key Encryption or Key Exchange? 
Death rays from Mars made Bill Stewart  write:
I've already got a nice fast RSA implementation, so I think I'll stick with
that.  Besides, I'm not terribly keen on using a library which has stolen code
in it.
If anyone wants to create an RSAREF version, all you need to do is replace one
module (lib_rsa.c) with an RSAREF-compatible version (that's why I mentioned
plug-in encryption modules in the docs - you just unplug the existing code and
plug in RSAREF instead).  What you need to do is use RSAPublicBlock() and
RSAPrivateBlock(), the rest is just wrapper code which you can base on the
existing lib_rsa.c.  My estimate is that it's about an afternoons work.
I got permission from RSADSI to bypass the official interface to RSAREF for
HPACK, my archiver which has PGP-compatible encryption, in 1993.  However I
suspect getting permission for the same thing in a general-purpose library,
especially one which has RC2, RC4, and DESX[1] in it, may be difficult since
parts of the library are essentially a free version of BSAFE (not by design,
they just ended up that way).
[1] Well, it will have DESX once I can get some test vectors to make sure I've
    got it right.  Does anyone have some I can use?

@_date: 1996-05-27 13:45:13
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: cryptlib debugging for Win95, WinNT 
In order for the RSA encryption functions in cryptlib
(ftp://garbo.uwasa.fi/pc/security/crypl110.zip, but that one's without
the RSA stuff for reasons which will become apparent) to work, I need to
find someone to test the Win95 and WinNT random-number generation code,
which calls various Win32 statistics-monitoring functions to seed its
internal random number pool.  I've written most of the code, but since some of the documentation for the API's is pretty dodgy, it'll need a bit of
debugging and testing to get going.  Is there anyone here who can help
with this?  I estimate that it's an hour or so of work for the Win95 side
(which has Toolhelp32), and maybe half a day for NT (which has the incredibly
complex registry-walking system and semi-documented network statistics
gathering).  There are two files to compile, with a total size of about 20K.
I can't do it myself since I don't have easy access to any sort of Win32 Oh yes, this part of the code has nothing to do with crypto, so there are no
problems with US people doing it.

@_date: 1996-11-07 16:59:59
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Group order for "Secret Power" ... (San Francisco Bay Area only) 
If anyone is going to the Usenix e-commerce conference I can bring over
some copies for them.  I'm already taking over a whole bunch of copies,
I can bring over a few more if I can get them (I've pretty much cleaned
out the bookshops around here).  I can bring them to the conference but
what you do with them from there is up to you (ie I won't have time to
find post offices to mail people copies or whatever).  Cost is US$25
(the NZ retail price is $35 = US$25), delivery is in just over a week.

@_date: 1996-11-30 05:22:11
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Strong-crypto smart cards in Singapore and Germany 
Wednesday's "Straits Times" contains two front-page articles on the introduction of a CashCard which acts as an electronic wallet capable of storing from $10-$200 ("Dr Hu launches cash-in-a-card payment system"), and an identity card capable of Internet electronic transactions with (presumably RSA) 1024-bit encryption ("50,000 to take part in electronic ID trials").  The ID card can also be implemented as software on disk.  It appears to be purely a form of storing an ID which is then transmitted in encrypted form.  The CashCard, on the other hard, is an electronic wallet developed by a group of Singapore banks.  There are no details on how it works, except that it doesn't have any sort of protection - it's up to you to make sure the card isn't The standardisation committee of the German banks have also produced an electronic wallet which should have 25 million (yes, 25M) users by January of next year.  Again, this is a pure electronic wallet, with 2-key triple DES and 768-bit (to become 1024-bit) RSA encryption.  The relevant standards are still in the process of being translated, but should be available Real Soon Now (the complete specification will be made public).  This looks like a very nice system, and unlike Mondex doesn't rely entirely on the hope that criminals can't get at the data on the card.

@_date: 1996-10-08 00:41:34
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: NSA/GCSB spying shown on NZ television 
20/20 today had a segment on the operation of the GCSB (Government Communications Security Bureau), the trading name of the NSA in New Zealand.
This was motivated by the recent publication of Nicky Hagers book "Secret Power" which goes into great detail about the operation of the GCSB (it has floor plans of the monitoring stations, details of operations, staff, names and contact numbers, etc etc - it's a very well researched book covering the day-to-day running of an intelligence agency).
In the 20/20 segment, Nicky and a reporter managed to get through the security perimeter at the Waihopai base with a camera and ladder, climbed up to the windows, and shot footage of the interior of the base through improperly-closed curtains.  The main operations room had racks of equipment which is hard to identify (it's not a very good shot), along with tables containing PClone monitors and HP II's[1].  Unfortunately the resolution isn't good enough to show what's being displayed on the monitors.  Another shot of an office showed a desk with Intelsat operations manuals, providing, for the first time, direct proof of whose traffic is being monitored - not the Russians, not the Chinese, but NZ's pacific neighbours and trading partners.  The intercepted traffic is then passed straight back to the NSA for analysis.
AFAIK there's never been any direct, documented proof of what these bases are intercepting - the dishes are pointed in the right direction for intercepting Intelsat transmissions, but the various agencies have been able to deny the nature of the interception.  The footage of operations manuals on a desk would seem to prove beyond a doubt that the agencies are engaged in large-scale interception and monitoring of civilian communications.
It was rather unfortunate that the program was shown at the same time as the political leaders debate on another channel (we have an election in four days time), because virtually noone will have watched 20/20.
[1] Given that the windows looked like plain glass and that these things have a control zone that reaches halfway to Antarctica, I'd love to park outside the base with certain pieces of receiving equipment...

@_date: 1996-10-14 23:09:59
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: cryptlib 2.00 free encryption library released 
Version 2.00 of cryptlib is now available from
ftp://garbo.uwasa.fi/pc/crypt/crypl200.zip and also from
The library provides an easy-to-use interface which allows even inexperienced
crypto programmers to easily add strong encryption and authentication services
to their software.  The library contains DES, triple DES, IDEA, MDC/SHS, RC2,
RC4, RC5, SAFER, SAFER-SK, Blowfish, and Blowfish-SK conventional encryption,
MD2, MD4, MD5, RIPEMD-160 and SHA hash algorithms, and Diffie-Hellman, DSA, and
RSA public-key encryption, as well as a comprehensive high-level interface with
functions such as cryptCreateSignature() and cryptExportKey().  The library is
supplied as source code for Unix (shared or static libraries), DOS, Windows
(16- and 32-bit DLL's), and the Amiga.
The library provides a standardised interface to a number of popular encryption
algorithms, as well as providing a high-level interface which hides most of the
implementation details and provides an operating-system-independant encoding
method which makes it easy to transfer encrypted data from one system to
another.  Although use of the the high-level interface is recommended,
experienced programmers can directly access the lower-level encryption routines
for implementing custom encryption protocols or methods not provided by the
The library API serves as an interface to a range of plug-in encryption modules
which allow encryption algorithms to be added in a fairly transparent manner.
The standardised API allows any of the algorithms and modes supported by the
library to be used with a minimum of coding effort.  As such the main function
of the library is to provide a standard, portable, easy-to-use interface
between the underlying encryption routines and the user software.  In addition
the easy-to-use high-level routines allow for the exchange of encrypted session
keys and the creation and checking of digital signatures with a minimum of
programming overhead.
The library has been written to be as idiot-proof as possible.  On
initialization it performs extensive self-testing against test data from
encryption standards documents, and the API's check each parameter and function
call for errors before any actions are performed, with error reporting down to
the level of individual parameters.
The library implements a security perimeter around the encryption functions,
with encryption contexts consisting of an arbitrary handle referring to
(hidden) data held within the library.  No outside access to state variables or
keying information is possible, provided the underlying OS provides some form
of memory protection.  If the OS supports it, all sensitive information used by
the library will be page-locked to ensure it is never swapped to disk.
There is one small bug I found about an hour after it was released (sigh), you
can't use CRYPT_USE_DEFAULT as a parameter to cryptCreateContext() due to
missing parentheses in crypt.c.
Incidentally, if someone in Europe with a high-bandwidth link to the rest of
the world could provide a permanent site for cryptlib betas that'd be useful,
since the current beta distribution system is rather ad hoc.

@_date: 1996-10-27 23:19:19
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Secure Internet-based Electronic Commerce: The View from Outside the US 
I've just made a draft copy of this paper available for comment as  a copy of the introduction is given below.  The whole thing is around 170K long (40 A4 pages when printed).
If anyone has any comments to make on it, please let me know.
The creation of a global electronic commerce system will provide an extremely powerful magnet for hackers, criminals, disgruntled employees, and hostile (but also "friendly") governments intelligence agencies.  This problem is magnified by the nature of the Internet, which allows attackers to quickly disseminate technical details on performing attacks and software to exploit vulnerabilities.  A single skilled attacker willing to share their knowledge can enable hordes of dilletantes around the world to exploit a security hole in an operating system or application software within a matter of hours.  The Internet also enables an attacker to perform an attack over long distances with little chance of detection and even less chance of apprehension. The ability to carry this out more or less anonymously, at low cost, and with little chance of being caught, encourages attackers.
Because of well-publicized break-ins there has been a steadily increasing demand for encryption and related security measures to be included in software products.  Unfortunately these measures often consist either of "voodoo security" techniques where security is treated as a marketing checkbox only, or are rendered ineffective by the US governments refusal to allow non-americans access to the same security measures which it allows its own citizens. Organisations employing such (in)security systems may make themselves liable for damages or losses incurred when they are compromised.  This paper covers the issues of using weak, US government-approved security as well as problems with flawed security measures, examines some of the measures necessary to provide an adequate level of security, and then suggests several possible solutions.

@_date: 1996-10-28 12:44:21
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Secure Internet-based Electronic Commerce: The View from Outside the US 
Oops - when I posted the previous announcement I gave the file the .html extension out of force of habit, the URL should in fact be  (you can also get to it using
the previous URL, but your browser will wrap the text.  To fix this, either
load it as text or use the .txt URL).

@_date: 1996-09-07 16:08:06
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: What the NSA is patenting 
That isn't NSA research, it was merely sponsored by the NSA.  Those are all
university people who have published their work on MFSTM in journals, papers,
and theses (I used some of it in my paper at the Usenix Security Symposium, and
two of the images in my talk were provided by one of Mel Gomez' students). What the NSA is doing in this area is still classified (although I suspect the
techology isn't much different from what's publicly available), in this case
all they were doing was protecting their investment (just like the various PKC
patents originally assigned to universities).

@_date: 1996-09-08 13:37:57
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: What the NSA is patenting 
No, the market for the more mainstream MFM's is small (a few K devices), for MFSTM's it's even smaller (a few dozen?).  MFSTM's are usually built by universities for research purposes, which means the patent won't affect them.  As I said before, it's purely a "we paid for the research, we want some paper to wave around to justify the cost" thing.
You can see the results, just read the Journal of Applied Physics or IEEE Transactions on Magnetics.
I know people like to come up with conspiracy theories about the NSA, but this patent won't work as the basis for one.

@_date: 1996-09-12 05:40:35
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: [Long] A history of Netscape/MSIE problems 
I've been putting together a writeup on problems in web browsers, mainly the history of the Netscape RC4/40 break, random number bugs, and problems with Java, as part of a longer paper I'm doing on crypto from a non-US perspective. A lot of the information in this section of the paper has come from this list, so I thought I'd post it for comment and in case anyone found it interesting (please don't post it to web sites or anything until the paper is actually published).  If anyone has anything to add, corrections to make, etc, please let me know.
The Netscape SSL Break and its Implications
After the RC4 attacks, researchers looked for other weaknesses in Netscape.  In
September 1995 it was discovered that Netscape didn't check the amount of input
it was fed, leading to internal buffers being overrun [Green 1995] [Neumann
1995].  This bug also existed in other browsers such as Mosaic and IBM's
WebExplorer.  By carefully adjusting the data fed to the browser, it was
possible to force a victims PC to execute arbitrary code simply by selecting a
URL.  This problem has occurred in the past in a number of other programs such
as fingerd (where it was exploited by the Internet worm [Spafford 1988]), the
CERN and NCSA httpd's (as explained below in the section [!!!!]), and recently
splitvt, syslog, and mount/umount, leading one exasperated mailing-list
moderator to wonder how many more times he'd see this problem [Bloodmask 1996].
The flaw in question can be exploited by ensuring that the code to be executed
is located in the URL at a point where it overflows the end of the buffer.  A
URL can contain almost any data value except for a few characters which have
special significance and a binary zero, a restriction which can easily be
bypassed by selecting alternative encodings for any instructions which cause
problems.  The browser stack looks as follows:
[Diagram: URL buffer, other data, callers saved program counter]
It is therefore possible, by making the URL long enough to overwrite the other
data and saved program counter, to force a jump to an attackers code rather
than returning to the calling routine, allowing an attacker to force the
execution of arbitrary code on the victims machine.  Although this exploit is
machine and browser-specific, by targetting the most common architecture
(Windows on an Intel processor) and browser (Netscape), a reasonable chance of
success can be obtained.
At about the same time the stack overwrite problem was discovered, a basic flaw
was found in Netscape's SSL implementation which reduced the time to break the
encryption from hours to minutes.  Despite an existing body of literature
covering the need for carefully selected random-number generation routines for
cryptographic applications [Eastlake 1994] [IEEE 1995] [Robertson 1995], one of
which even included ready-to-use code [Plumb 1994], Netscape used fairly simple
methods which resulted in easy-to-guess encryption keys [Goldberg 1995]
[Goldberg 1996].  It was found that, under Unix, Netscape used a combination of
the current time in seconds and microseconds and the process ID of the current
and parent process to initialise the random number generator which produced
master encryption keys. The time can be determined to a reasonable degree of
accuracy from the message being sent, the process ID's can be determined using
standard Unix utilities (by people using the same machine that Netscape is
running on), or by using other tricks such as the fact the an approximate
process ID can often be obtained by observing the output of other
network-related programs on the machine, and the parent process ID is often 1
(for example when Netscape is started from an X-windows menu) or close to the
process ID.  Under Windows the implementation was similarly flawed.
The resulting number of values to search are smaller than the number of
combinations in a 40-bit key, and much smaller than the number of combinations
in the 128-bit key in the export-restricted version. Since Netscape never
reseeds its internal random number generator, subsequent connections are
relatively easy to break once the first one is broken.  The researchers who
discovered this problem released a program, unssl [unssl 1995] which would
break Netscape's encryption (both the weak exportable version and the strong
export-restricted version) in about a minute on an average workstation.
Although one of the researchers classed it as "a silly bug", it received large
amounts of media attention, including front-page coverage in the New York Times
[Markoff 1995] and coverage in the Wall Street Journal [Sandberg 1995] and
Daily Telegraph [Uhlig 1995].
Attempts to fix this problem introduced yet more problems.  Under Windows the
browser and server code, which appear to share the same random number code,
don't close some of the file handles they use.  While this has no serious
effect on the client software (which doesn't run over extended periods of
time), it does effect the server, which after a period of time runs out of file
handles so that a number of calls related to gathering random data (some of
them not apparently file-related) quietly fail, significantly weakening the
random-number generation process [RingZero 1995].  The problem of insecure
random number generation was not unique to Netscape, and has in the past beset
XDM (which generates weak xauth keys), Netrek (a network game which generates
guessable RSA private keys), an earlier version of the SecuDE security toolkit
(which again generated guessable RSA keys), and Sesame (a european Kerberos
clone) which uses it to generate DES keys.
Significant security holes are also opened up through the use of Java, which
allows arbitrary programs downloaded from the net to run in a (supposedly)
controlled environment on a host PC.  By breaking out of this controlled
environment, Java applets can act as trojan horse programs on the PC, bypassing
normal security measures.  The consequences of these security problems have
been widely reported and include the destruction of data [Clark 1996], the
ability to access arbitrary files on the system [Felten 1996b], the ability to
forward sensitive information to arbitrary machines on the net (bypassing
firewalls and similar measures, since the "attack" comes from a trusted machine
inside the security perimeter) [Williams 1996] [Markoff 1996], or even run
arbitrary native code on the machine [Felten 1996a] [Hopwood 1996] [Kennedy
1996].  This last class of flaws are the most serious, since they allow any
code to be executed on a victims machine.  The problem was in the class loading
code for the browser and affected all then available browsers rather than just
Netscape, and could be carried out simply by a victim viewing a web page
containing the hostile Java applet.
Java problems can be combined with other attacks such as DNS spoofing (in which
a fake address for a target machine is advertised), allowing a Java applet to
connect to a normally disallowed target machine since the Java security manager
thinks it is connecting to a safe system [Mueller 1996].  Other problems are
less subtle, and can crash the browser (and, under some versions of Windows,
the operating system as well) simply by connecting to a web page [Ref:
Browser-crashing pages].  One report comes to the conclusion that "because of
the wonderful power of the Java language, security problems are likely to
continue" [Neumann 1996].
These problems are not unique to Java.  Microsoft's ActiveX has experienced
similar troubles, exemplified by a sample application which shuts down the
machine, and even turns off the power on systems which support this
functionality [McLain 1996].  The problems extend beyond Java and ActiveX to
other kinds of embedded executable content as well.  For example the ability to
embed macros in documents viewed and downloaded by a browser, in combination
with security holes in the browser, allows an attacker to execute arbitrary
code on a victims system whenever they view the attackers web page [Felten
1996c].  Although this was subsequently fixed, the solution was to issue
warnings for all local files as well as remote downloads, so that after the
first dozen or so messages the user was likely to simply automatically click
"OK" whenever another warning popped up [Walsh 1996].  In addition a hostile
application could access the Windows registry (the system-wide database of
configuration options) to quietly disable the warnings.  This creates a nice
niche for "espionage-enabling" viruses which disable or patch various security
features in operating systems or application software to allow later attacks.
At least one security organisation already uses such a program, a modified
stealth virus, for this purpose.
-> Mention that these are all seperate problems, not the same ref over and
   over.
[Clark 1996] Don Clark, "Researchers Find Big Security Flaw In Java Language"
The Wall Street Journal, 26 March 1996, p.B4.
[Bloodmask 1996] `Bloodmask', "Vulnerability in ALL linux distributions",
posting to linux-alert mailing list, 30 July 1996.
[Eastlake 1994] Donald Eastlake, Stephen Crocker, Jeffrey Schiller, "Randomness
Recommendations for Security", RFC 1750, December 1994.
[Felten 1996a] Ed Felten, "Security Flaw in Netscape 2.02", Risks-Forum Digest
Vol.18, Issue 13, 17 May 1996.
[Felten 1996b] Ed Felten, "Java security update", Risks-Forum Digest, Vol.18,
Issue 32, 13 August 1996.
[Felten 1996c] Ed Felten "Internet Explorer Security Problem", Risks-Forum
Digest, Vol.18, Issue 36, 21 August 1996.
[Goldberg 1995] Ian Goldberg, "Netscape SSL implementation cracked!", posting
to cypherpunks mailing list, message-ID:
<199509180441.VAA16683 at lagos.CS.Berkeley.EDU>, 18 September 1995.
[Goldberg 1996] Ian Goldberg and David Wagner, "Randomness and the Netscape
Browser", Dr.Dobbs Journal, January 1996, p.66.
[Green 1995] Heather Green, "Netscape Says Hackers Uncover 3rd Flaw in Its
Internet Software", The New York Times, 25 Sep 1995.
[Hopwood 1996] David Hopwood, "Another Java security bug", posting to
comp.lang.java newsgroup, message-ID <4orf1q$t6f at news.ox.ac.uk>, 2 June 1996.
[IEEE 1995] IEEE P1363 Appendix E, "Cryptographic Random Numbers", Draft
version 1.0, 11 November 1995.
[Kennedy 1996] David Kennedy, "Another Netscape Bug US$1K", Risks-Forum Digest,
Vol.18, Issue 1422, May 1996.
[Markoff 1995] John Markoff, "Security Flaw Is Discovered In Software Used in
Shopping", The New York Times, 19 September 1995, p.A1.
[Markoff 1996] John Markoff, "New Netscape Software Flaw Is Discovered", The
New York Times, 18 May 1996, p.31.
[McLain 1996] Fred McLain, "ActiveX, or how to put nuclear bombs in web pages",
[Mueller 1996] Marianne Mueller, "Java security", Risks-Forum Digest,  Vol.17,
Issue 79 23 February 1996.
[Neumann 1995] Peter Neumann, "Third Netscape weakness found", Risks-Forum
Digest, Vol.17, Issue 36, 27 September 1995.
[Neumann 1996] Peter Neumann, "More Java, JavaScript, and Netscape problems",
in "Security Risks in Computer-Communication Systems", ACM SIGSAC Review,
Vol.14, No.3 (July 1996), p.22.
[Plumb 1994] Colin Plumb, "Truly Random Numbers", Dr.Dobbs Journal, November
1994, p.113.
[RingZero 1995] `RingZero', "NEW Netscape RNG hole", posting to cypherpunks
mailing list, message-ID <9510080732.AA14015 at anon.penet.fi>, 8 October 1995.
[Robertson 1995] Richard Robertson, "Random Number Generators Draft", IEEE
P1363 Random Number Generators Review Group, May 1995.
[Sandberg 1995] Jared Sandberg, "Netscape's Internet Software Contains Flaw
That Jeopardizes Security of Data", The Wall Street Journal, 19 September 1995.
[Spafford 1988] Gene Spafford, "The Internet Worm: Crisis and Aftermath",
Communications of the ACM, Vol.32, No.6 (June 1989), p.678.
[Uhlig 1995] Robert Uhlig, "Security threat to Internet shopping", Daily
Telegraph, Daily Telegraph (paper edition), 3 October 1995, p.12.
[unssl 1995] ftp://ftp.csua.berkeley.edu/pub/cypherpunks/cryptanalysis/unssl.c.
[Walsh 1996] Mike Walsh, "Microsoft's warning", Risks-Forum Digest, Vol.18,
Issue 38, 26 August 1996
[Williams 1996] Eric Williams, "New Netscape 2.0/2.01 Security Issue (Java
Sockets)", posting to comp.lang.java newsgroup, message-ID
<4jppdt$ake at sky.net>, 1 April 1996.
[WSJ 1996] The Wall Street Journal, "Princeton Team Finds Bug In Part Of
Netscape Program", 20 May 1996.

@_date: 1996-09-16 00:13:59
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: [Long] A history of Netscape/MSIE problems 
It's in AC II, p.319 (I was getting worried for a minute, I missed it the first
time I looked and then couldn't figure out where I'd got the info from).
It's mentioned in the list of minor RC4 weaknesses.  I didn't include refs for
all of these because I've already probably got as many references in there as
text (the term "reference terrorism" has been used to describe some of my
papers in the past).
Interesting... does anyone want to comment on this?  This kind of damages one
of my assumptions in the paper that publicity attacks can hurt a company
providing poor security.  Could it be that at the time people would buy
Netscape stock no matter what happened?  If MSIE had been widespread at the
time, would it have caused people to jump ship en masse?
It's a pretty obscure attack and one which most implementations (ones running
on home PC's) won't ever need to worry about, given that it's many times easier
to get a victim to download some whiz-bang ActiveX applet which quietly patches
their browser to use a fixed key for all SSL sessions.  Has anyone thought of
doing this?  If I had a system (and compiler) capable of building ActiveX
apps I'd love to do this - create an espionage-enabling screen saver or

@_date: 1996-09-18 00:21:00
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: [Long] A history of Netscape/MSIE problems 
In case anyone's interested, I've finally found the source I used for the claim that RC2/RC4 were exportable if the details were kept quiet:
  "Details about them [RC2 and RC4] have not been published (including by    patenting) in order to maintain their special export status".
       -- RSA FAQ, version 1.0, draft 1e, 14 September 1992, p.40.
This makes sense - the NSA wouldn't want the details published to stop non-US non-crippled versions appearing, and I can't really imagine RSADSI volutarily not patenting a new algorithm.

@_date: 1996-09-23 14:37:24
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Transforming variable-length to fixed keys 
I posted this to sci.crypt recently but the response to it was rather
underwhelming, so I thought I'd repost it here to see if anyone has any
comments on it.  What it is is a scheme for transforming arbitrary user keys
(typically a long passphrase) into a fixed-length key for a particular
algorithm.  This has the following properties:
1. The user key 'userKey' is transformed into an algorithm-specific key 'key'
   using a number of 'iterations' of a hash algorithm 'hash()'.
2. The transformation is strongly serialized so that any form of attack
   involving parallelization or precomputation isn't possible.
3. The transformation is non-reversible, so that recovering the transformed key
   won't recover the original key.
4. The result of the transformation is algorithm-dependant, so that if an
   attacker recovers a transformed key for one algorithm they can't recover the
   transformed key (from the same user key) for another algorithm.
5. The transformation can be iterated as often as required to make
   password-guessing attacks difficult.
6. The transformation process is algorithm-independant and can use any type of
   hash algorithm and original and transformed key size.
The transformation algorithm (which was designed with the help of John Kelsey)
is as follows:
   key[] = { 0 };
   state = hash( algorithm, mode, parameters, userKey );
   for count = 1 to iterations
     for length = 1 to keyLength (in hash_output_size blocks)
       state = hash( state );
       key[ length ] = hash( state, userKey );
The state acts as an RNG which ensures that the key hashing is serialized.
The initial state depends on all encryption parameters, not just the user key.
If we hashed the user key directly and then used it for a number of algorithms
then someone who could recover the transformed key for one algorithm could
compromise it if used for other algorithms (for example recovering a DES key
would also recover half an IDEA key).  Hashing all algorithm-related parameters
means that a successful attack one an algorithm, mode, or configuration won't
allow the key for any other algorithm, mode, or configuration to be recovered.
The code which implements the iterated hashing is:
  /* Hash the variable-length input to a fixed-length output */
  memset( key, 0, keyLength );
  for( count = 0; count < iterations; count++ )
    {
    for( keyIndex = 0; keyIndex < keyLength; keyIndex += hashOutputSize )
      {
      /* state = hash( state ); key[ n ] = hash( state, userKey ) */
      hash( state, state,   hashOutputSize, HASH_ALL );
      hash( NULL,  state,   hashOutputSize, HASH_START );
      hash( temp,  userKey, userKeyLength,  HASH_END );
         |          |
           output    input   input size
      /* Copy as much of the hashed data as required to the output */
      length = ( keyLength - keyIndex ) % hashOutputSize;
      for( i = 0; i < length; i++ )
        key[ i ] ^= temp[ i ];
      }
    }

@_date: 1996-09-24 03:57:44
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: (Fwd) Australian "ITAR" regulations 
If the DSD is anything like our GCSB then what they'll have told you is what they'd like to be the case, not what's really the case.  They will tell you what it pleases them to tell you, which doesn't necessarily have anything to do with the facts.  The easiest way to check the real situation is to look at your customs act, the NZ Customs Act of 1995 (which in the relevant area is almost identical to the 1966 one) covers forms of export in excruciating detail.  Doesn't mention anything about computer networks in there.  In practice it'd have to be decided in the courts, but I don't think the DSD will take action because there's a very good chance they'd get a ruling against them, which is also why the NSA is so reluctant to enforce the ITAR in court.

@_date: 1996-09-26 05:42:23
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: [Long] How to break Netscape's server key encryption 
The Netscape server key format is very susceptible to both a dictionary attack
and to keystream recovery.  It uses the PKCS  format for private keys, which
provides a large amount of known plaintext at the start of the data, in
combination with RC4 without any form of IV or other preprocessing (even though
PKCS  recommends that PKCS  password-based encryption be used), which means
you can recover the first 100-odd bytes of key stream with a simple XOR (the
same stupid mistake Microsoft made with their .PWL files).  This means two
1. It's very simple to write a program to perform a dictionary attack on the
   server key (it took me about half an hour using cryptlib, and another half
   hour to rip the appropriate code out of cryptlib to create a standalone
   program).
2. The recovered key stream from the encrypted server key can be used to
   decrypt any other resource encrypted with the server password, *without
   knowing the password*.  This is because there's enough known plaintext
   (ASN.1 objects, object identifiers, and public key components) at the start
   of the encrypted data to recover large quantities of key stream.
To demonstrate the problem, I have written a program which performs a
dictionary attack on the server key, and if successful prints the password used
to encrypt it and the server's RSA private key.  Originally I used my
encryption library ( to do
the encryption, to turn it into a standalone program I ripped the necessary
parts out of the library, which means it's a bit messy and not as portable as
the original was.  The code could probably be made to run about twice as fast
if it's properly optimised, but I don't know if it's worth the bother and
besides, it's just gone 4am I could use some sleep.
To run it, use:
  breaksk  Here's the output from a server key someone sent me, tested against my 100MB+
word list collection (some people collect stamps, I collect word lists :-):
  The password used to encrypt this Netscape server key is 'unguessable'.
  Modulus = 00D50626580C2543378FD249994A543FBF5FF1333E70684E942EC7034E5FA [...]
  Public exponent = 03
  Private exponent = 008E0419900818D77A5FE18666318D7FD4EAA0CCD44AF03462C9 [...]
  Prime 1 = 00FBD3FC2CE1F50B31323F2D3FA27F6708D4373CC0487DB7199A712124380 [...]
  Prime 2 = 00D88D984BA6A7CD07F6608D95D3AC2682769DA904D061E593CF86A21B4A9 [...]
  Exponent 1 = 00A7E2A81DEBF8B220CC2A1E2A6C54EF5B3824D32ADAFE7A1111A0C0C2 [...]
  Exponent 2 = 00905E6587C46FDE054EEB090E8D1D6F01A4691B588AEBEE628A59C167 [...]
  Coefficient = 2DEBC012356B96D2206346141371D999288F55DD07AEF6D1972383E97 [...]
(I've trimmed some of the lines a bit).
The problem here is caused by a combination of the PKCS  format (which is
rather nonoptimal for protecting private keys) and the use of RC4 to encryt
fixed, known plaintext.  Since everything is constant, you don't even need to
run the password-transformation process more than once - just store a
dictionary of the resulting key stream for each password in a database, and you
can break the encryption with a single lookup (this would be avoided by the use
of PKCS  password-based encryption, which iterates the key setup and uses a
salt to make a precomputed dictionary attack impossible.  PKCS  states that
its primary intended application is for protecting private keys, but Netscape
chose not to use this and went with straight RC4 instead).
A quick (but not necessarily optimal) solution to the problem involves two
1. Only encrypt the unknown, private fields in the key (which is what PGP
   does).  Instead of wrapping everything up in several layers of encapsulation
   with object identifiers and public-key components, change the portion which
   is encrypted to:
      EncryptedRSAPrivateKey ::= SEQUENCE {
        privateExponent INTEGER,
        prime1          INTEGER,
        prime2          INTEGER,
        exponent1       INTEGER,
        exponent2       INTEGER,
        coefficient     INTEGER
        }
   with everything else outside this object.
2. Don't use a simple stream cipher to encrypt fixed data like this.  Use an IV
   on the encrypted data.  Iterate the password setup to slow down a dictionary
   attack (I posted a scheme for transforming variable to fixed-length keys to
   the cypherpunks list a few days ago which provides the necessary
   functionality).
The consequences of this attack are pretty scary.  It involves vastly less
effort than breaking a 40-bit session key or factoring a 512-bit public key,
yet once you've recovered the private key you can also recover every session
key it's ever protected in the past and will ever protect in the future (which
is why I'm a fan of signed DH for session key exchange).  The ease with which a
dictionary attack can be carried out represents a critical weakness which
compromises all other encryption components on the server - spending a few days
with a Markov-model based phrase generator on a PC is still a lot easier than
spending a few months with GNFS and a workstation farm.
It seems strange that there are no real standards defined for secure storage of
such a critical component as a private key.  Although a lot of work has gone
into X.509 and the multitude of related public-key certificate standards, the
only generally-used private-key formats are PKCS  (which has problems, as
demonstrated above), and Microsofts recently-proposed PFX (Personal Information
Exchange) data format and protocol (PFX is designed to allow users to move
their keys, certificates and other personal information securely from one
platform to another, you can get more info on it from
 which is too new to
comment on.  It would be useful if a portable, secure private-key format at the
same level as the X.509 effort were developed to solve this problem.
For the curious (and ASN.1-aware), here's what the data formats look like.
First there's the outer encapsulation which Netscape use to wrap up the
encrypted key:
  NetscapeServerKey ::= SEQUENCE {
    identifier          OCTET STRING ('private-key'),
    encryptedPrivateKeyInfo
                        EncryptedPrivateKeyInfo
    }
Inside this is a PKCS  private key:
  EncryptedPrivateKeyInfo ::= SEQUENCE {
    encryptionAlgorithm EncryptionAlgorithmIdentifier,
    encryptedData       EncryptedData
    }
  EncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
  EncryptedData = OCTET STRING
Now the EncryptionAlgorithmIdentifier is supposed to be something like
pbeWithMD5AndDES, with an associated 64-bit salt and iteration count, but
Netscape ignored this and used straight rc4 with no salt or iteration count.
The EncryptedData decrypts to:
  PrivateKeyInfo ::= SEQUENCE {
    version             Version
    privateKeyAlgorithm PrivateKeyAlgorithmIdentifier
    privateKey          PrivateKey
    attributes    [ 0 ] IMPLICIT Attributes OPTIONAL
    }
  Version ::= INTEGER
  PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier
  PrivateKey ::= OCTET STRING
  Attributes ::= SET OF Attribute
The algorithm information is encoded as:
  AlgorithmIdentifier ::= SEQUENCE {
    algorithm           ALGORITHM.&id( { SupportedAlgorithms } ),
    parameters          ALGORITHM.&Type( { SupportedAlgorithms }{  } )
                            OPTIONAL
    }
  SupportedAlgorithms ALGORITHM ::= { ... }
  ALGORITHM ::= TYPE-IDENTIFIER
(and so on and so on, I haven't bothered going down any further).  The
EncryptionAlgorithmIdentifier is '1 2 840 113549 3 4' or { iso(1)
member-body(2) US(840) rsadsi(113549) algorithm(3) rc4(4) }.  The
PrivateKeyAlgorithmIdentifier is '1 2 840 113549 1 1 1' or { iso(1)
member-body(2) US(840) rsadsi(113549) pkcs(1) pkcs1-1(1) rsaEncryption(1) }.
Included below is the code to perform the attack (set tabs to 4, phasers to
Do I get a t-shirt for this? :-)

@_date: 1996-09-26 20:28:24
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: How to break Netscape's server key encryption - Followup 
There has been a successful hostile attack on a Netscape server key using the
code I posted yesterday.  I was contacted earlier today by someone who told me
he had in the past obtained Netscape server keys and PGP private keys from
Windows NT machines running Microsofts insecure FTP server which allows access
to the entire drive (he found some of the PGP keys using archie searches -
ouch!).  He lives somewhere with nasty anti-hacking laws and definitely doesn't
want his identity known, but after some pleading said I could reveal the
  - He used the cracklib dictionary to get the password
  - The password was found "very quickly"
  - The password was a female name
  - He deleted the server key after he'd found the password
  - He did it merely out of idle curiosity and has no intention of misusing the
    information.
  - He definitely doesn't want to be contacted

@_date: 1996-09-28 14:26:49
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Mitsubishi MISTY LSI 
It was developed by a team lead by Mitsuru Matsui and has been subject to
fairly intense analysis, although not by non-Mitsubishi people AFAIK.  In any
case it's not the usual snake oil.  When I last talked to someone from
Mitsubishi who was working on Misty I tried to convince them to make details
available online, you could try something like  to see if
there's anything available.

@_date: 1996-09-29 21:57:39
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Transforming variable-length to fixed keys 
Yeah, that's a particularly evil way of making things harder for people with
keysearch engines.  That's why in cryptlib when I'm doing something like key
exchange I encrypt all the parameters (algorithm, mode, etc etc) along with the
session key, so an attacker can't even tell what algorithm you're using[1]. I'd
thought of adding some sort of "choose a random algorithm and mode" capability
to cryptlib, but the user interface was too difficult to handle (finding a way
to let the user specify "We want a choice of DES-CFB, IDEA-OFB, DES-EDE-CBC, or
Blowfish-PCBC" is a bit of a pain).  In the end I took the easy way out by
adding an extended initialisation mode which allows the user to specify the
algorithm if they want, but left the possibility of one-algorithm-per-round
hashing alone.  A problem with using one of a fixed selection of algorithms is
that as you add new modes the selection changes, so you need to add more state
information to the key which specifies the choice of algorithms, which starts
to get messy.
I'd still love to add this in some form to keep the NSA amused... perhaps a
bit vector of allowable algorithms and modes passed to the setup function.
[1] There's a story from IBM when they were testing a new IBM-internal     encryption system for long-haul telecoms applications.  They were     playing around with bouncing encrypted transmissions off an IBM-owned     satellite when they were contacted by the NSA who said "You're not using     DES.  Stop it".

@_date: 1997-08-04 19:28:15
@_author: Peter Gutmann 
@_subject: News: Spy Base Expanded 
CLEAR Net - News
  Spy Base Expanded
  The Government has announced a planned expansion at Blenheim's Waihopai
  spybase to boost New Zealand's ability to monitor satellite communications.
  And the Prime Minister, Jim Bolger, says a change to the Crimes Act will
  allow the base to monitor phone calls by foreigners, which was formerly
  illegal.
Full story at

@_date: 1997-08-25 04:41:57
@_author: Peter Gutmann 
@_subject: CAST key size 
"CAST" isn't a particular algorithm, but a design process for creating algorithms.  The particular CAST instantiation used in PGP 5 is either CAST-128 or CAST5, depending on who you ask.  Other versions of CAST abound, including an earlier one used by MS for unknown purposes which had a 64-bit key, probably the one Bruce is referring to.

@_date: 1997-12-16 18:27:08
@_author: Peter Gutmann 
@_subject: UK spooks invent RSA, DH in 1973 
There's an interesting paper at  which claims that UK spooks invented both RSA and DH in 1973 and 1974 respectively.
The summary info is:
(The paper was mentioned on a UK crypto list, but I've lost the original  reference).

@_date: 1997-02-01 09:05:18
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Crypto in New Zealand - an update 
This is a continuation of the article I posted here a few weeks ago.  You can
find the whole thing at

@_date: 1997-02-01 09:40:51
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Crypto in New Zealand - an update 
This is a continuation of the article I posted here a few weeks ago.  You can
find the whole thing at

@_date: 1997-02-04 06:56:36
@_author: Peter Gutmann 
@_subject: Secure Phones 
This thing is snake oil.  What it does is move the data through an FIR filter
with the taps being controlled by a secret key.  The data itself isn't
encrypted, but is spread out over a wide spectrum in a (they hope)
difficult-to-analyse manner.  However with only 1K possible taps and
(presumably) something as high-security as an LFSR driving it, I think the
strength of the system has been overestimated somewhat.  It wasn't designed for
security at all, it was designed by an ex-Canterbury uni engineer to provide
add-on noise-immunity to fax machines, and they only decided to market it as an
encryption device later on - the designer apparently knows very little about
encryption.  I've got a photo of it, it's in a box the size of a small modem
and consists of a circuit board with an ASIC on it and a bit of interface
The company has a patent on it, but a search for the patent has so far been
unsuccessful (mind you I didn't search very hard).  If anyone wants to check it
themselves, the patent will probably be assigned to Ken Stokes of Cardinal
Encryption Services - they claim to have worldwide coverage.
This is rather cool, it was designed by a couple of students at the University
of Saarbruecken.  It uses the Lintel RSA chips which are fast enough to do
real-time RSA voice encryption, either singly for 512 bits or chained for 1033
bits.  I've got a brochure somewhere which shows one of the inventors using it,
it's a small motherboard containing the RSA chip, some other unidentifiable
circuitry (presumably a modem chipset), an EPROM, etc etc.  It was done as a
research project by students who are unlikely to have put backdoors in it.  The
BSI (German NSA) were not at all happy about it.
It's a pretty neat product, but unfortunately due to its origins it's having
difficulty getting any market penetration.  In addition the Lintel chips are
f-ing expensive and there are many other components that go in on top of that,
I doubt the whole thing sells for less than DM 1000-1500.

@_date: 1997-02-04 13:59:22
@_author: Peter Gutmann 
@_subject: CAST 
I've just had mail from Carlisle Adams in response to my question about the status of CAST-128:
The algorithm is well worth looking at (see the URL above) - it's a nice royalty-free drop-in replacement for IDEA for example.  I've had a version half-finished for inclusion in cryptlib for a few months now, but something else always seems to crop up...

@_date: 1997-02-14 14:05:39
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic at pijnenburg.nl.  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-14 15:58:08
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic at pijnenburg.nl.  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-15 09:42:51
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic at pijnenburg.nl.  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-15 22:29:23
@_author: Peter Gutmann 
@_subject: Crypto code published in magazines 
I'm trying to find instances of crypto code published in computer magazines in the last few years.  I know of Blowfish in DDJ, are there cases of more mainstream computer mags like Byte publishing crypto code (I know Byte did DES in 1977, I'm hoping for something a bit more recent)?.  Please mail or cc replies directly to me, nntp.hks.net seems to have died :-(.

@_date: 1997-02-15 22:58:04
@_author: Peter Gutmann 
@_subject: Crypto code published in magazines 
I'm trying to find instances of crypto code published in computer magazines in the last few years.  I know of Blowfish in DDJ, are there cases of more mainstream computer mags like Byte publishing crypto code (I know Byte did DES in 1977, I'm hoping for something a bit more recent)?.  Please mail or cc replies directly to me, nntp.hks.net seems to have died :-(.

@_date: 1997-02-21 19:57:17
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
Those are one-off prices.  You'll have to contact Pijnenburg (see the address in the original message) for more details.

@_date: 1997-02-27 05:43:26
@_author: Peter Gutmann 
@_subject: Presidential decrees and emergency powers 
The letter/executive order from Bill Clinton which transfers control of
encryption and related items to the EAR contains a mention of:
  ... the national emergency described and declared in Executive Order 12924 of
  August 19, 1994, and continued on August 15, 1995, and August 14, 1996,
  necessitated by the expiration of the Export Administration Act (EAA) on
  August 20, 1994, I hereby report to the Congress that pursuant to section
  204(b) of the International Emergency Economic Powers Act, 50 U.S.C. 1703(b)
  (the "Act"), I have today exercised the authority granted by the Act to issue
  an Executive order (a copy of which is attached)...
Does anyone know what national emergency this refers to, and what the section
of the emergency economic powers act covers?  I seem to remember a post by
someone who had traced it back through endless levels of indirection to a
police action in Korea or something, but haven't been able to find any more

@_date: 1997-02-27 13:57:38
@_author: Peter Gutmann 
@_subject: Presidential decrees and emergency powers 
Thanks.  This contains (among other things) the interesting Executive Order:
So the fact that Congress won't continue a law is justification for declaring
an emergency which is justification for continuing it by presidential decree
instead.  Scary.
Unfortunately it doesn't list all the earlier, expired decrees which would show
what was originally used to start this thing off ("... the unusual and
extraordinary threat to the national security, foreign policy, and economy of
the United States in light of the British army currently marching on
Washington" perhaps?)

@_date: 1997-01-07 01:49:16
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: The Upcoming DES Challenge 
Orbital mind control lasers made mpd at netcom.com (Mike Duvos) write:
I'm still a bit nervous about what the reaction will be though - won't the US government (and anyone else pushing DES) be able to say "It took 10,000 Pentiums several weeks, noone would bother doing that, so it's safe" (with a possible side order of "Safer-SK64 is 256 times as secure, anyone we really like can use that provided they hand over the keys in advance").

@_date: 1997-01-12 23:38:35
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Menwith Hill / NSA 
I talked to the guy who made the documentary (Duncan Campbell) an hour or two
ago, he's sending me the transcripts when he gets back to the UK.  I'll see if I can get his permission to post them to the web.  He's been doing this
sort of thing for about 25 years, and has some really neat stories to tell about his run-ins with the UK government.

@_date: 1997-01-18 06:34:58
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Keyword scanning/speech recognition 
I was talking to someone recently about the feasibilty of keyword-scanning
phone conversations.  He thought it was probably still beyond the reach of
current technology, I thought it wasn't (I gave a couple of references in a
recent paper on government attitudes to crypto which indicate that it's being
used right now by a number of governments).  Anyway, I've got bits and pieces
of one or two papers here which people might find interesting.  The first one
  "Digital Circuit Techniques for Speech Analysis" by G.L.Clapper, presented at
   the AIEE Winter General Meeting in January 1962.
I've only got the first two pages of the paper here, I think the full thing
might have been published in the IEEE Trans.Communications in about 1963.  This
paper mentions a "digit recognizer" built at Bell Labs in 1952, and a Japanese
voice-operated typewriter using 3,000 transistors and 6,000 diodes.  The paper
goes on to describe a means of producing a "compact digital code expressing
significant qualities of speech in a form suitable for machine utilization".
This was in 1962!
A more recent paper is:
  "Discrete Utterance Speech Recognition without Time Alignment", John Shore
   and David Burton, IEEE Trans.Information Theory, Vol.29, No.4 (July 1983),
   p.473.
This generates a feature vector every 10-30ms from input speech which is
compared to pre-generated reference sequences.  It also has references to many
other papers covering the same area.
Certainly it appears that by the early 1980's it was possible to scan speech
for keywords and/or speakers and use this to target the surrounding
conversation, and that early work on this had been done since about 1960.  This
is all from public sources, since certain organisations have a *far* greater
interest in this particular area than anyone performing public research it's
likely that equivalent classified research was some way ahead of this.

@_date: 1997-01-19 15:10:25
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: The NSA's influence on New Zealand crypto policy 
For nearly a year I've been involved in an ongoing battle with several
government departments and the odd intelligence agency in an attempt to clarify
NZ's position on the export of crypto software.  The whole story has now got
about as far as it can go, so I thought I'd share it with others.  I've been
trying to get the media to take an interest in this, but noone really seems to
care... if anyone knows any journalists who might be interested in it, feel
free to pass it on.  I've got more details including names of contact people
and phone numbers in case anyone needs to verify parts of the story.
The main players are:
The Government Communications Security Bureau (GCSB), a New Zealand
    intelligence agency (for US readers, the GCSB is the NZ subsidiary of the
    NSA).  The foremost authority on the GCSB is Nicky Hager, who recently
    published the book "Secret Power" which documents their activities.
The Defence Signals Directorate (DSD), an Australian intelligence agency (the
    Australian version of the NSA).
The Ministry of Foreign Affairs and Trade (MFAT), a New Zealand government
    department.
New Zealand Customs.
Cyphercom Solutions, a New York company which produces financial/online
    commerce systems.
Kiss Audio Video, an Australian video production company.
Orion Systems, a New Zealand company which produces medical information and
    communication systems for transmitting medical information.
Myself (Peter Gutmann) and cryptlib, my free encryption library
    In April 1996 I got a call from someone who worked for Cyphercom Solutions, a
New York company who wanted to use my cryptlib encryption library in a project
they were working on.  Their lawyers wanted them to obtain an official,
physically exported copy so that there wouldn't be any complications later on
if the source of the software were ever called into question.  The application
involved financial transaction processing, and they had received indications
from the NSA that it would be looked on favourably in terms of getting export
permission.  Somewhat strangely though, they were given the distinct impression
that to get anywhere, they'd need to play ball with the NSA, even though it was
NZ software being exported from NZ, where the NSA should have no jurisdiction.
At this point a brief explanation of the export law situation in NZ is in
order.  The Customs Act of 1996, Section 54, "Prohibited Exports", states that
"The Governor-General may from time to time, by Order in Council, prohibit the
exportation from New Zealand of any specified goods or goods of a specified
class or classes" (followed by a list of specific conditions on prohibitions).
There's no further information in the Customs Act, but NZ Customs have a short
publication "New Zealand Customs Fact Sheet: Export Prohibitions and
Restrictions" which contains, among such curious items as cat skins and a large
list of agricultural products which can't be exported without going via the
appropriate government department, the item "Strategic goods such as computers,
navigation and marine equipment, firearms, ammunition, explosives, military
aircraft and vessels".  The responsible government department is the Ministry
of Foreign Affairs and Trade (MFAT, pronounced "em-fat").  Apparently computer
software comes under the same classification as computers (MFAT extends the
Customs definition of "Strategic goods" to cover "Computer technology,
information security systems, and telecommunications equipment").  The entity
within MFAT which handles this is the International Security and Arms Control
Division, who are advised by the Government Communications Security Bureau
(GCSB), the New Zealand NSA subsidiary.
Once you get past the part where NZ Customs are involved, the whole setup is
run like the mafia.  Nothing is ever written down, everything is done verbally.
Although it took only a paragraph to describe how this works, it took more than
two months of work to find out in practice.  Unless you know exactly who to ask
for information, noone has ever heard of these restrictions.  A search of NZ
legal databases found nothing.  Several IP lawyers had never heard of these
restrictions.  Noone seemed to know anything about any restrictions.  (In an
October newsletter, MFAT retroactively gave themselves jurisdiction over this
area, this is covered further down).
An initial discussion with MFAT revealed that NZ Customs tend to apply
restrictions based on the old COCOM rules, which have been superseded by the
Wassenaar agreement.  For this reason export permits are required for shipments
to certain eastern european countries, certain middle eastern countries, and
the current UN politically-incorrect-country club.  Export to countries other
than that would be unlikely to require a permit.
In May, Cyphercom therefore decided to try to export the software to the US and
Singapore.  Initially MFAT said this was OK.  Then at the last minute they
changed their minds and imposed the following restrictions:
 - No encryption algorithms except single DES.
 - Keysize limited to 64 bits (this is peculiar, I assume it's to stop me from
   using tricks like key-dependant S-boxes and DESX, which I'd discussed in
   email with people in the US some time ago).
 - Definitely no triple DES (this was specifically mentioned).
 - Export limited to object code only (so the key size couldn't be changed).
The text of the message (with a few names removed) is:
  "The Secretary of Foreign Affairs and Trade has no objection to the export of
   the XXX financial package, as detailed in the following application from
   YYY, *provided that* the library of encryption algorithms is limited to DES
   (but not triple DES) and any required hash algorithms, dated 15 May 1996".
In the accompanying description of the library, every single algorithm except
DES and the hash algorithms have been crossed out.  Note that this is for
export to the US, which has its own export restrictions anyway (the same thing
was done for the Singapore export).
Inquiries by lawyers in the US indicated that there had been a flurry of
communication between the NSA and the GCSB over this (as one person - not one
of the lawyers BTW - I talked to put it, "When the NSA says 'Bend over', the
GCSB says 'How far?'").  The NSA might as well have signed the export
(non-)permit themselves.  The story from the US lawyers was that there was
"repeated intervention of the NSA" and that "NZ is out of its depth, it was
terrified of offending the US".
been initiated by the GCSB rather than the NSA, who were afraid to do anything
without NSA approval.  The GCSB went to the NSA and asked them what they should
do, the result was the (non-)permit.  A DSD person also later told a reporter
that the GCSB had gone to the DSD and asked them "Would you allow the export
under these conditions?".  The DSD said "No".
Shortly before this, the Canadian government, which follows the same export
guidelines as New Zealand (dual-use technology under the Wassenaar agreement),
had ruled that cryptlib was exportable to anywhere except the previously
mentioned restricted countries, with no permit necessary, and no need to apply
for a permit:
  "Application No.278466 covering cryptographic software proposed for export to
   England, this software is not controlled according to Canada's ECL.
   Therefore, provided the product noted in this application is not of US
   origin within the meaning of the ECL item 5400, these goods may be exported
   to any country, except Libya and Angola, without an export permit.  Please
   note that most goods to Iraq are still prohibited at this time, as well".
The interesting thing about the Canadian decision was that I was contacted
twice by Canadian export controls people who asked me a number of very detailed
questions about the software, whereas MFAT managed to come to their decision
without ever examining the encryption software or talking to its author.  As
far as I've been able to tell MFAT had very little to do with the decision:
They have to follow the GCSB's advice, and the GCSB won't do anything without
the NSA's permission.
The opinion from lawyers in NZ was that they were acting far outside their
authority.  In any case in late May two copies of the software on 3.5" disks
were sent out by a large accounting firm acting for Cyphercom, one to the US
and one to Singapore as provided for in the export permit.
At about the time the original export appeal was lodged, the GCSB had told
another NZ company, Orion Systems, that they couldn't export a product with the
encryption necessary to protect patient medical data, lab results, patient
referrals, and so on, without obtaining an end user certitificate for each
user.  To sell a copy to just the one overseas site which the inquiry was about
would have required otaining two thousand certifications from all the end
users.  Larger sites with ten thousand users are not unknown.  This meant that
Orion would have had to somehow obtain 2000 signed declarations from users just
to allow the exchange of medical records (this tactic has also been
successfully used by the US government to effectively block certain software
exports by US firms).  Orion didn't even bother going to MFAT, because if the
GCSB required these impossible-to-meet conditions then going to the next level
down in the chain of command would make no difference.
After chasing my way around a number of government departments I talked to some
people in the Ministry of Commerce who advised that the best way to resolve
this craziness was to write to MFAT and inform them that the Canadian
government had ruled that the library was freely exportable and that there was
no reason for them blocking the export, and ask under what authority the export
was being blocked.  This letter was sent to MFAT in mid-September
(incidentally, the way government departments refer to the GCSB is wierd. Noone
ever says "the GCSB", it's always "another government department" or "an
organisation which I won't name", as if there was some belief that using The
Dreaded Name will cause evil to descend upon the person who utters it, much
like the use of the work J*h*v* or Lovecraft's "He Who Is Not To Be Named").
Anyway, at this point, things started to get weird.  At about the time I wrote
the letter, I was FedEx'd an NDA sent from lawyers representing PGP Inc (a US
encryption software vendor) to Orion Systems, sent in a standard FedEx letter
envelope.  It was intercepted by NZ Customs and opened, and the contents
examined, before I got it.  This wasn't the usual random (and quite rare)
"Examined by Customs" spot check, the letter had a large red "Customs - Hold"
sticker on it with an LAX flight number, so I assume they knew in advance what
they were looking for.  NZ Customs couldn't tell me why it was intercepted, but
seemed a bit surprised that the letter had been opened.  They said that they
may have been "acting on information".
In early October, about a fortnight after I sent the letter to MFAT questioning
the export refusal and asking for clarification on what law they were using to
block the export (and many months after the export itself), the Australian
parent of the US company who wanted the export got a call from the Australian
Ministry of Defence (it was actually the DSD, but they generally identify
themselves as Ministry of Defence just like NSA employess are always identified
as Department of Defence rather than NSA).  This company, Kiss Audio Visual,
are a video production house who have nothing at all to do with encryption
software (or, in fact, anything but video production and graphics design, which
they are very good at).  They were called by Alan Owen of the DSD who said that
they had been informed that NZ Customs had intercepted a shipment containing a
high-security encryption product which was being illegally exported from New
Zealand.  According to the story, when NZ Customs went back to the party who
exported the software, they claimed it was on behalf of Kiss.  The Managing
Director of Kiss called the Ministry of Defence to make sure this was actually
for real, and they confirmed that it was.
This story has several very large holes in it:
- NZ Customs never intercepted anything.  The package containing the disks
  arrived in the US unopened, there was no "high-security encryption product"
  on the disks, and a Customs person has verified that NZ Customs have never
  intercepted any crypto software shipped overseas.
- There was no illegal export of any kind.  All the necessary permissions had
  been obtained from MFAT before the disks were shipped.
- The export was performed by Cyphercom, not Kiss.  Kiss happens to be the
  parent company, but (apart from a few business discussions carried out over
  international phone links), there was no other connection between Kiss and
  Cyphercom.
Alan said that this export had very serious consequences, and that they would
be coming to Melbourne to talk to Kiss at 2pm the next day.  The Kiss Director
immediately called Cyphercom in the US, and they discussed having serious
quantities of lawyers present at the meeting, and taking the whole story to the
The visit was cancelled without any explanation.  Who says governments never
listen to their citizens?
(The DSD side of the story is that they were rather busy that day and didn't
have time to carry out their investigation).
The implications of this are interesting.  Despite the fact that MFAT had
already (in effect) denied permission for the export, someone with the ability
to listen in to international phone conversations had used discussions about
the export to fabricate a story about NZ Customs with which the Australian
government could harass Kiss, who had done nothing wrong and in fact had
nothing to do with the whole affair (unfortunately I don't have any proof of
the phone-conversation monitoring, but I can't see how anyone could possibly
have connected Kiss with Cyphercom except for the phone conversations - they
simply have nothing else in common).  Apparently whoever was pulling the
strings saw it necessary to bypass MFAT entirely in an attempt to suppress the
encryption software (this does not inspire confidence in the working
relationship between MFAT and the unnamed agency.  The identity of the unnamed
agency was later revealed by the DSD - see below).
Also in October, an article "Trade in Strategic Goods - An Update" in MFAT's
"Business File" publication, Vol.3, No.7 made specific mention that MFAT were
in charge of controlling the export of encryption hardware and software.  It's
pretty certain that this special mention was motivated entirely by attempts to
export cryptlib, because MFAT stated in a letter to me that they'd never
encountered anything like this before, so the claim that:
  "..the most commonly affected exports from New Zealand are of encryption
   hardware and software..."
is distinctly peculiar.  The last time anyone checked (a KPMG report from
mid-1994) NZ had no restrictions on the export of crypto.  Some time between
mid-94 and October 1996, export controls (or at least some vague mention of
controls) appeared, with MFAT having jurisdiction.  I suspect this was in
October 1996, *after* the whole export/non-export fiasco took place.
In any event the article contains some rather curious comments.  "Run-of-the
mill exports have usually been processed within 48 hours".  MFAT have now taken
9 months without showing any results, causing considerable financial hardship
for Cyphercom who are unable to ship a product or even obtain a sample copy for
demonstration to customers.  "New Zealand... is helping to limit the spread of
increasingly sophisticated military technology and weapons of mass
destruction".  Whether software to protect financial transactions and medical
records counts as "sophisticated military technology" or "weapons of mass
destruction" is unclear.
In late October I called MFAT to see what the delay was in replying to my
earlier letter, and received a reply the following week.  In their reply, MFAT
stated that the export (non-)permit was in fact not final, and was still under
consideration, which was at odds with what they had told Cyphercom and with the
wording of the permit itself (see above).  The letter also states:
  "We made it clear that it would take some time, as the application dealt with
   a relatively new area in terms of our export controls, and was in a rapidly
   changing and advancing field.  We... are currently discussing it and other
   issues it raises with relevant government departments".
(the "relevant government department" is the GCSB, this has been confirmed by
the DSD).  I interpret this paragraph to mean "We're making up the rules as we
go along".  The Canadian government certainly didn't seem to have any of these
problems when they covered the same issue.
MFAT declined to answer my question as to whether this portion of NZ's foreign
trade policy was being controlled by US intelligence agencies.
In early January 1997, Kiss were informed by the same Ministry of Defence/DSD
person (Alan Owen) that he and an associate would again be flying in from
Canberra to talk to them, using as justification the same fictitious story
about NZ Customs that they had used before.  They spent about two hours at
Kiss, saw that they were indeed a video production house (and nothing but a
video production house), and left.  Before they left, they told the Kiss people
that the source of the story about NZ Customs was "their counterparts in NZ"
(the GCSB).  Kiss had a lawyer present to witness this.
The implications of this are pretty scary.  The GCSB first used their position
to impose impossible-to-meet conditions on Orion and influence MFAT to
indefinitely delay export of software which isn't export-restricted anyway (or
at least not by any known NZ law) and which the Canadian government had already
ruled wasn't export restricted.  However, not content with this, they then fed
a fictitious story to the Australian government to convince them to begin an
investigation into a company which had done nothing wrong, and had very little
to do with the whole issue.
Foreign competitors of NZ companies will ship their encryption products within
15 minutes of a credit card order being received.  The GCSB, by employing all
sorts of devious measures, has managed to suppress distribution of the same
software by NZ individuals and companies.  Under their influence, MFAT have now
spent nine solid months brooding over the export of one single copy of
equivalent encryption software without showing any results.  This has had the
effect of protecting overseas markets for exploitation by foreign
competitors... by a ministry supposed to be in charge of promoting NZ trade.
To summarise, the situation is as follows:
1.There is absolutely no way that anyone could reasonably be expected to find
  out about what to do with crypto software in New Zealand.  NZ Customs have
  been extremely helpful throughout this affair, but had to keep deferring to
  MFAT, where everything stops.  Even the people charged with enforcing export
  conditions don't know what it is they're supposed to be enforcing.  If it
  wasn't for a number of lucky coincidences and occasionally knowing or running
  into the right people, I still wouldn't know any more about the situation.
2.Anyone trying to follow the vaguely-defined, possibly nonexistant rules, at
  least in New Zealand, is opening themselves up to government harassment, no
  matter how hard they try to follow whatever rules and regulations someone in
  the government comes up with.  The only safe way to distribute crypto
  software seems to be to either distribute it over the Internet, or to make
  sure you have enough media and political contacts to raise hell over any
  ensuing mail interception, possible phone tapping, government investigations,
  bogus stories about crimes being committed, and other niceties which may crop
  up.

@_date: 1997-01-20 19:30:36
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Menwith Hill / NSA 
I've just heard from Duncan Campbell (who made the documentary), he'll send me
a copy of the script which can be put on the web.  I'll let people know when
it's available.  Copies of the tape can be ordered from his company:
  IPTV Ltd
  1 Meadowbank
  Edinburgh EH8 8JE
  Scotland, UK
  E-mail : duncan at gn.apc.org           Tel : +44 131 659 6566
Cost is \pounds 14.50 stg + any postage costs for outside UK - \pounds 5 will
cover it.
They have no NTSC versions in stock but can make them from the master. Provided
they get orders for at least 10, the cost will be the same.  They accept
payment in US$ cheques as well as \pounds stg cheques; no credit cards, sorry.
He is, in theory, on holiday for another month or so and only has intermittent
net connectivity, so please don't flood him with email just yet.

@_date: 1997-01-20 20:25:35
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Menwith Hill / NSA 
I've just heard from Duncan Campbell (who made the documentary), he'll send me
a copy of the script which can be put on the web.  I'll let people know when
it's available.  Copies of the tape can be ordered from his company:
  IPTV Ltd
  1 Meadowbank
  Edinburgh EH8 8JE
  Scotland, UK
  E-mail : duncan at gn.apc.org           Tel : +44 131 659 6566
Cost is \pounds 14.50 stg + any postage costs for outside UK - \pounds 5 will
cover it.
They have no NTSC versions in stock but can make them from the master. Provided
they get orders for at least 10, the cost will be the same.  They accept
payment in US$ cheques as well as \pounds stg cheques; no credit cards, sorry.
He is, in theory, on holiday for another month or so and only has intermittent
net connectivity, so please don't flood him with email just yet.

@_date: 1997-01-21 23:25:56
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Keyword scanning/speech recognition 
I've found another collection of references on speech scanning/recognition, the
February 1989 CACM, p.193, contains 38 references going back to 1980.  It'd be
an interesting exercise for anyone with access to a large library to trace back
through these (some of them look promising, like a 1980 book "Trends in Speech
Recognition" from which a number of references are taken) to see how far back
you can go and at what point certain things became feasible.  The CACM
references would be a good starting point for a search.

@_date: 1997-01-22 04:27:13
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: Keyword scanning/speech recognition 
I've found another collection of references on speech scanning/recognition, the
February 1989 CACM, p.193, contains 38 references going back to 1980.  It'd be
an interesting exercise for anyone with access to a large library to trace back
through these (some of them look promising, like a 1980 book "Trends in Speech
Recognition" from which a number of references are taken) to see how far back
you can go and at what point certain things became feasible.  The CACM
references would be a good starting point for a search.

@_date: 1997-01-29 19:40:43
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: New export controls to include code signing applications 
The Men in Black made Lucky Green  write:
These aren't new regulations, they're old regulations which have resurfaced.
I've managed to obtain a copy of part of the old pre-Wassenaar COCOM
regulations, which contain the magic lines:
  5.D.2.c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5.A.2 or 5.B.2.
    2. "Software" to certify "software" embargoed by 5.D.2.c.1.
    3. "Software" designed or modified to protect against malicious computer
        damage, e.g. viruses.
This is from the October 1991 version.
By October 1996 this had changed to:
  5D002 c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5A002 or 5B002.
    2. "Software" to certify "software" specified in 5D002.c.1.
It looks like someone used the old COCOM regs as the basis for the EAR rather than the newer Wassenaar ones.  The two are almost identical anyway except for a few minor points.  It's likely that the anti-virus clause is due to bureaucratic bungling rather than malicious intent.

@_date: 1997-01-29 20:42:13
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: New export controls to include code signing applications 
The Men in Black made Lucky Green  write:
These aren't new regulations, they're old regulations which have resurfaced.
I've managed to obtain a copy of part of the old pre-Wassenaar COCOM
regulations, which contain the magic lines:
  5.D.2.c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5.A.2 or 5.B.2.
    2. "Software" to certify "software" embargoed by 5.D.2.c.1.
    3. "Software" designed or modified to protect against malicious computer
        damage, e.g. viruses.
This is from the October 1991 version.
By October 1996 this had changed to:
  5D002 c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5A002 or 5B002.
    2. "Software" to certify "software" specified in 5D002.c.1.
It looks like someone used the old COCOM regs as the basis for the EAR rather than the newer Wassenaar ones.  The two are almost identical anyway except for a few minor points.  It's likely that the anti-virus clause is due to bureaucratic bungling rather than malicious intent.

@_date: 1997-06-02 15:58:38
@_author: Peter Gutmann 
@_subject: Creating a unique ID number for a dollar 
Death rays from Mars made Tim May  write:
It's not guaranteed unique.  First, the dollar you use may be a forgery (why forge a dollar?  I don't know, maybe they're practicing on low-denomination notes which noone ever looks at closely so they can get the twenties and hundreds perfect.  I have a vague memory of someone doing this with either US dollars or UK pound notes some time ago, motivated by the "noone would ever bother forging a dollar/pound, so it has to be genuine" mentality).  In addition you'd have to specify "US dollar" rather than just "dollar" because, apart from the different serial number formats, some countries will reissue banknotes if the originals are damaged in printing, which leads to the possibility of two (legitimate) notes with the same serial number being in circulation if the original isn't destroyed as required (I have some of these replacement notes for now-defunct NZ dollar and two-dollar notes stashed away somewhere).  Does the US Treasury issue replacement notes if the originals are damaged in printing, or does it just destroy the notes and leave it at that?

@_date: 1997-06-25 04:22:28
@_author: Peter Gutmann 
@_subject: spook pressure on crypto exports (was Re: cypherpunks coding challenge) 
Death rays from Mars made Adam Back  write:
Nothing was intercepted.  They (the GCSB, NZ subsidiary of the NSA) came up with some phony story about NZ customs intercepting a shipment of military-grade encryption (or something similar) which they fed to the Australian spooks (DSD).  NZ Customs knew nothing of this, and the DSD were apparently also considerably surprised by it.  As far as I can tell it was a very amateurish attempt to intimidate one of the companies involved (frighteningly amateurish in fact - a single phonecall was enough to confirm that they'd invented the whole incident themselves, the only real effect it had was to get them a front-page story in the National Business Review and (presumably) piss off the DSD for sending them on a wild goose chase and risking media exposure).
It can be legally exported.  Although the people pulling the strings are the GCSB, the group enforcing it is the Ministry of Foreign Affairs and Trade (MFAT)'s export control group, who are idiots (I can elaborate on this in great detail at some point, preferably over a beer).  I have several written statements from them that I can freely export it electronically (along with all sorts of bogosities such as a letter signed by the minister in which the first sentence of the second paragraph says exactly the opposite of the last sentence in the paragraph, and other, similar gems).  At one point I was firing off one letter after another to them just to see how silly they would get, but it got boring after awhile.  I'll put these letters online at some point for people to have a laugh at.
I should also clarify a point about the online writeup of my experiences, which imply that the NSA was active in directing the GCSB over export controls.  I'd had some feedback from a high-level US spook source that this wasn't quite the case, but the source has some rather unusual opinions on spooks and their activities (something along the lines of "Civilization would collapse tomorrow if it wasn't for the fine efforts of the CIA and NSA") which made me somewhat suspicious about the accuracy of the information.  Anyway, what this source said (and this bit I can believe) was that NZ was completely out of its depth with this (which was obvious from the way it was handled) and was terrified of offending the US.  According to the source, the NSA was exerting a *moderating* influence on the whole thing, and that any progress made was because the NSA told the GCSB to back off.  This would indicate an interesting case of the NSA exerting very strong indirect influence on determining crypto policy.  The GCSB knew the NSA didn't want crypto being distributed, and when they heard of the export they went into overdrive to show the NSA what good boys they could be and how keen they were to help the US by enforcing US policy for NZ crypto.
This interpretation is believable, NZ is very much a junior member of the UKUSA alliance and really doesn't want to do anything which might offend the other partners.  They knew the US didn't want crypto being made available, so they went out of their way to try to show the NSA that they could be trusted to do their bit in restricting crypto (I'm certain that something as amateurish as the NZ Customs story didn't come from the NSA, even the DSD seemed unaware of it).
This means that it doesn't actually require any direct intervention from the USG to control crypto policy, the mere knowledge that the NSA doesn't like something is enough to make the local spooks (who, in NZ's case, rely on the NSA for much of their hardware and training) do whatever they think will keep
the NSA happy.  It's perfect for the NSA I guess, because they get complete deniability (Just yell "Will noone rid me of this troublesome crypto" and sit back and wait).
BTW, what's happened to taz.nceye.net?  The cypherpunks mail->news doesn't seem to have been updated for more than a week.

@_date: 1997-07-01 12:24:49
@_author: Peter Gutmann 
@_subject: Dr. Dobbs Cryptography and Security CD-ROM 
What makes this case especially awkward is the fact that the CDROM can't legally be sold outside the US, which means the only way the rest of the world can get it is through illegal copies.  Given the immense usefulness of something like this, I'd say it's only a matter of time before bootleg copies start appearing outside the US, but because of the USG's position we can't pay for it even if we want to (DDJ wouldn't look too good if they accepted payment for what they knew was illegally exported crypto).  Perhaps a donation of the same amount to charity would serve as some equivalent to payment...

@_date: 1997-03-16 14:30:28
@_author: Peter Gutmann 
@_subject: Wassenaar Arrangement and "sensitive dual-use items" 
There are two separate documents here which people are getting confused.  The
first is the text of the Wassenaar arrangement, which is quite short and (as
described by one person who's seen it) "consists of a lot of weasel words".
The second is the one which sets down what is controlled.  This is rather
lengthy, around 100 pages.  The EAR changes which were made in the US contains
some of the text of this document, which predates Wassenaar and is just the
older COCOM text under a new title.  The COCOM text originates from the US, and some of the countries still have versions with US spellings even though the countries use proper :-) Englishm which indicates its origins.

@_date: 1997-03-22 07:44:17
@_author: Peter Gutmann 
@_subject: Security of SSL proxies 
A number of vendors are now selling SSL proxies which implement secure tunnelling for web browsers using a non-crippled SSL implementation running on the client machine.  Has anyone considered the total security level provided by one of these systems?  I can see three problems with this approach:
1. The security stops a few feet short of the browser, making a MITM attack    possible (see below).
2. Security and authentication is handled by the proxy and not the browser.     This means that the browser (and browser user) never get to see the usual    indicators that their connection is secure (or "secure" for non-US users).
3. If you use a proxy like this to protect traffic for an entire company, the    proxy provides the same type of target as a GAK key center: An attack which    compromises this compromises security for the entire company.
The first one is a practical problem, the second one is more perceptual.  Consider the following possible attack: A nice authenticoded ActiveX control ("the tee proxy") installs itself on your machine and hooks itself into the chain of proxies by either moving the SSL proxy to a different port or changing the browser config entry so it's the first proxy in the chain.  It then scans all data being forwarded for credit card numbers/PINs/whatever and forwards them to God knows where.
There are various simple defences (eg the SSL proxy checks to make sure the browser still goes to it first), but in the end it's just a cat and mouse game - the tee proxy could spoof the registry calls (there was an article in DDJ which explains how to do this), or disable the check, or hook directly into the proxy service by patching the DLL (this was explained in MSJ I think).  In short, because the security stops a few feet short, it's possible to attack the system.
A related problem is that fact that the browser isn't aware that a layer of security is being applied to the connection, and so will act as if the connection was insecure (ie it won't display the usual signs that the link is secured, and will give annoying warnings when navigating secure web sites).
Finally, pulling personal certs into/through the proxy is rather complex, requiring the cooperation of the CA in issuing specific types of certs (one browser-specific one for the browser and an identical-content but proxy-specific one for the proxy), and all sorts of complex juggling by the user to install them.  This probably makes the use of certs in this environment fairly luser-proof, which more or less means no certs.
Are there any other problems which people are aware of?  There was a bit of a fuss made about these proxies being the end of ITAR when they were first announced, but since then things seem to have gone quiet.

@_date: 1997-05-20 21:48:01
@_author: Peter Gutmann 
@_subject: Public Key Break Paper 
There was also a response/rebuttal to this paper in RSA's Ciphertext
newsletter, Vol.2, No.1 (Summer 1994), p.9, "Public Key Cryptography is Not
Easy to Break" which shows that it's not nearly as easy as the author of the
original paper thinks.
(I had another look at the unbalanced RSA proposal in the Autumn 1995
 CryptoBytes as I was trying to find the above article, did anyone ever do
 anything with unbalanced RSA or was it just left as a curiosity?).

@_date: 1997-05-20 21:59:29
@_author: Peter Gutmann 
@_subject: Question: RC5 assembly code? 
Not if it's x86 assembler.  On the Pentium each rotate uses 4-5 non-pairable
cycles, so rotates are very slow (each rotate is the equivalent of (in the best
case) 8-10 normal instructions, so the two rotates in an RC5 round are the
equivalent of 16-20 other instructions).  According to Intel shifts and rotates
have been optimised on the PPro so they're slight faster than on the P5, but I
haven't looked at the details yet.  I haven't tried to formulate the RC5 core
in asm yet (because of the patent - what good is it writing code which noone
can use?) but on Intel hardware it's certainly going to be a lot slower than it
looks (the much more complex CAST core is faster than just the rotates from the
RC5 core).  This is kind of unfortunate, because it's a nice algorithm.

@_date: 1997-10-15 10:46:06
@_author: Peter Gutmann 
@_subject: the case for separate comms keys 
Death rays from Mars made Adam Back  write:
There are also a few other reasons for doing this, and I've extended the idea
used in SFS for use with my cryptlib encryption toolkit.  Instead of encrypting
just the key, you also encrypt the algorithm details, ie:
    E          ( algorithm, algorithmInfo, key )
     passphrase
    E                             ( data )                    algorithm, algorithmInfo, key
This makes the job of an attacker somewhat harder because even if they have
some means of performing a reasonable attack on the second encryption step,
they won't know exactly what it is, so even if it only has a 40-bit key they
might need to search half a dozen algorithms before finding the right one.
This makes it a lot harder to just brute-force everything going past in the
hope of finding something useful.  This is especially entertaining for
algorithms like RC5 and Safer, where you can produce dozens of variations by
playing with algorithm parameters, in effect adding extra bits to the key
As Adam mentions, you can also escrow[0] the second key (which SFS does using a
threshold scheme with the parameters controlled by the user).  In this way the
user can change their password without destroying the ability of the escrow to
access the data.
Finally, using the session-key mechanism means you never encrypt two lots of
data using the same key, and means you can encrypt a single message for
multiple recipients just like the public-key equivalent.
[0] This is "escrow" used in the true sense, not the GAK euphemism.  It's
    completely under the control of the user, it's optional, and it's intended
    for recovery of stored data when you forget the passphrase.

@_date: 1997-10-21 20:23:51
@_author: Peter Gutmann 
@_subject: EC refutes GAK 
[I originally posted this to the c2.net crypto list but apparently it never
 appeared, I've reposted it here in case anyone finds it useful]
There's another way to foil GAK which I don't think has been mentioned before,
using what is often referred to as "malicious obedience" in the military (or
"you asked for it, you got it" elsewhere):
Since I don't trust any cryptosystem based on mathematical principles, I
encrypt all my communications using a one-time pad communicated on CDROM
(700+MB if you push it).  To limit the exposure of each pad, I change it once a
month at a cost of ~$1 per CDR blank.  If I communicate with around 100 people
that's 100 x 12 x 700+MB or (rounding things up a bit) a terabyte of keying
material a year.  Since they use their own pads to communicate back to me,
anyone wanting to intercept a years worth of traffic to/from me would need to
archive 100 terabytes of keying material (I'd make sure I spread out the bits
of pad I used so they couldn't just keep the useful bits and discard the rest).
In any case since this will only be used for court-authorised intercepts (just
keep repeating that until you believe it), everything would have to be archived
without any changes so it could be used as evidence.
At a cost of $100/month in CDR's this should comply with any GAK law (instant
access to keys, etc), but will also do a reasonable job of overwhelming any
centralised repository charged with storing the data.  Of course since I don't
trust the government any more than I trust those nasty cryptosystems based on
mathematical principles, I'd use triple DES underneath the OTP just to be sure.

@_date: 1997-10-22 02:45:42
@_author: Peter Gutmann 
@_subject: GAK "service" charges (Re: EC refutes GAK) 
Yes, but how will they phrase the requirements?  A CD is a single key (in fact 1,000 CD's are all part of a single key)... this leads to the same problem I heard of here a few years ago w.r.t. outlawing gangs: "It would be impossible to word any comprehensive anti-gang legislation in a manner which didn't also outlaw the police".  The same goes for certain aspects of escrowing, any escrow rules which are in any way practical and useable will also be open to all sorts of creative interpretation ("You must deposit a copy of your encryption key with the government" -> "Here's the key.  Where can I park the forklift that moves the container of CD's?").

@_date: 1997-10-23 21:32:48
@_author: Peter Gutmann 
@_subject: Use crypto, face a death squad 
There have been various rumours and comments over the past few years that the use of crypto in certain countries (Syria, Iraq, possibly China) is very dangerous for the end user, but very little actual evidence to substantiate this.  About a week ago I got some evidence (well, something better than the usual rumours) on the situation with using crypto in Iraq which people might find interesting.
I was talking to someone who worked for a large multinational corporation which maintains a comprehensive directory of who to contact in each country they operate in (basically every country on earth, this was before the gulf war so Iraq was included) for any kind of emergency.  This consists of a huge file of data intended to cover every imaginable type of situation.  Included in the information on Iraq was a comment to the effect that you should never, ever use any form of encryption when sending messages to the contact people there.  He can't remember the exact details any more, but the implication was that any encrypted messages sent to them would result in them quietly disappearing.  Since this was a very big company with a lot of sensitive information which it would go to great lengths to protect, I would assume they had very good reasons for advising against the use of crypto in this instance.

@_date: 1997-09-08 20:58:43
@_author: Peter Gutmann 
@_subject: Infoworld and Denning's study 
Due to the late hour I got that wrong, it's Computerworld NZ, not Infoworld (slight difference in naming).  Even later last night I wrote a letter to the editor which, I gather, will appear in the next issue.  I've included it below in case anyone finds it useful, it's written for a general audience who probably aren't aware of the deeper issues apart from the fact that the USG has a peculiar attitude towards crypto, due to length constraints I couldn't go into too much detail.  If you feel the need to circulate this, please don't do so until after next Monday when it's officially published.

@_date: 1998-12-03 22:01:30
@_author: Peter Gutmann 
@_subject: open-pgp / s/mime interoperability 
I'm trying to get this adopted for CMS, the underlying data format for S/MIME.  The silly thing about this is that alternative key identifiers (like PGP keys) were going to be included in RSADSI's PKCS7v2, but aren't included in the IETF version of the same thing.  The result is that you have a private company going out of its way to accomodate open standards, and the IETF going out of its way to lock them out.  Weird.
You don't need this conversion, with key identifiers you can use both SPKI and PGP keys directly within S/MIME.  There's no need to convert them into an X.509-like format first.

@_date: 1998-12-07 16:36:45
@_author: Peter Gutmann 
@_subject: What was the quid pro quo for Wassenaar countries? 
One thing which came to me recently when I was trying to figure out what sort of gun the US held to the rest of the world's head to get them to agree to this: Could the Wassenaar outcome have been a sign of Echelon in action?
Consider this: Delegates from each country have been travelling to Vienna for some months now to negotiate their countries position.  During the negotiations, they'll be contacting their governments via phonecalls carried over microwave trunks, satellite links, or undersea cables to discuss the progress of the negotiations and what position they should take.  Just like the negotiations which lead to the Five-Power Treaty in 1921, if one country had the ability to intercept all the other countries communications it would know how far they could be pushed, and where the most resistance was likely to come from, allowing greater amounts of "persuasion" to be concentrated on them.
I can't think of a more appropriate application of Echelon (use worldwide surveillance technology to perpetuate the usefulness of worldwide surveillance technology), and it would go some way towards explaining the very peculiar agreement which was reached.

@_date: 1998-12-15 20:26:25
@_author: Peter Gutmann 
@_subject: Forced DNA Collection 
The Commissioner messed up the quote, it's actually:
  "I am returning to punish the guilty; the innocent have nothing to fear"
   - Lucius Cornelius Sulla, 90BC, just before he massacred the innocent en      masse.

@_date: 1998-12-16 05:58:51
@_author: Peter Gutmann 
@_subject: NZ government to legalise black bag jobs 
15 December 1998
GOVERNMENT TO INTRODUCE AMENDMENT TO NZSIS LEGISLATION
The Government will introduce an amendment to legislation this week covering the operations of the New Zealand Security Intelligence Service, and will also seek to appeal part of the Choudry decision of the Court of Appeal, Prime Minister Jenny Shipley said today.
"In Mr Choudry's case, the Court of Appeal pointed out the need for Parliament to provide express authority for the NZSIS to enter private premises, without permission, to intercept communications."
"It is vital that the NZSIS is able to carry out its functions properly in gathering intelligence on security threats to New Zealand. In some rare instances, this may require covert entry to private property, which the amendment to the legislation will allow.  The existing law had been presumed to allow this to occur.  The Court has said if this is the intention, it should be made explicit as is the case in Canada, the United Kingdom and Mrs Shipley said the Government would also seek leave to appeal against one aspect of the Court of Appeal's decision in Mr Choudry's case.  The issue concerns the procedure the Court should follow when the Government asserts it is necessary, in the course of litigation against the Crown, to withhold from the Court, and other parties, access to information, in order to protect national security interests.
Choudry was a protestor against the 1994 APEC meeting held in Auckland (a bunch of foreign politicians turned up to talk for a week, shutting down the city centre in a way that wasn't equalled until Mercury Energy earlier this year).  At the time the SIS's mandate had been widened to include "economic security", bringing the APEC meeting into its sphere of interest.  As part of the APEC brouhaha, they carried out a black bag job on Choudry and got caught, causing the government some embarassment.  The current bill, rushed through under urgency just before parliament shuts down (which means it gets rubberstamped with no scrutiny or debate), would legalise these things in the future, just in time for the next big politicians powwow next year (which has already lead to the army invading the university as part of some training exercise which involved a simulated search for dissidents).
The second part is more worrying, what it'll do is remove any provision for judicial review of dubious actions by the government by allowing them to claim national security concerns as a blanket excuse for whatever they do.  Certainly in the Choudry case the real concern was job security, not national

@_date: 1998-12-23 22:31:41
@_author: Peter Gutmann 
@_subject: New synonym for GAK 
Another one to add to the list:
Their PR which was sent to several crypto mailing lists earlier today was conveniently cut off just before the GAK paragraph (and in any case they weren't lying, just being economical with the truth).

@_date: 1998-02-03 20:56:30
@_author: Peter Gutmann 
@_subject: An update on MS private key (in)security issues 
A fortnight ago I posted a message exposing a number of weaknesses in the way
various Microsoft security products handle users private keys.  A few days
before I was due to vanish for a security conference (where it was very
difficult to contact me), the article started getting a bit of attention.  This
is a general response which clarifies several issues relating to the original
First, Russ Cooper (moderator of the NT Bugtraq mailing list) made some wildly
inaccurate claims about the article.  I've had a bit of feedback which
indicated that it wasn't even worth dignifying this stuff with a response but
I've written one anyway, at least for the original NT Bugtraq messages he
posted (the stuff he put on a web page is just more of the same).  You can find
it at  (even if you
don't want to plough through the whole thing, you might want to read the last
two paragraphs for a giggle).
After this, Microsofts spin doctors leaped into action and posted a response to
the article.  I've replied to this one in a bit more detail, since it raises
several important issues.
Comments on Microsofts Response
One or two respondents have tried to play down the seriousness of a private key
compromise, saying that I exaggerated the dangers in my original message.  What
I wanted to point out was how extremely valuable a users private key is, and
how disappointingly little concern Microsoft seem to have for protecting this
valuable resource.  For example Garfinkel and Spaffords "Web Security and
Commerce" (O'Reilly, 1997) contains the warning:
  "Today's PC's are no better at storing private keys once they have been
  generated.  Even though both Navigator and Internet Explorer can store keys
  encrypted, they have to be decrypted to be used.  All an attacker has to do
  is write a program that manages to get itself run on the users computer (for
  example by using [...] Microsoft's ActiveX technology), waits for the key to
  be decrypted, and then sends the key out over the network" (p.120).
Including a function like CryptExportKey() (which hands over a users private
key) makes this very attack possible.  The potential damage which can be caused
with a misappropriated private key is enormous.  Consider the relative risks in
the compromise of a logon password and a private key.  With a logon password,
the worst an attacker can do (apart from stealing possibly valuable data) is to
trash the victims hard drive, which involves reinstalling the operating system
(an action which many users are intimately familiar with).  In contrast an
attacker who obtains a private key can potentially drain the victims credit
card, clean out their bank account (if the victim uses one of the emerging
online banking services), sign documents in their name, and so on.
The implications of that last point can be quite serious.  Take for example the
Utah digital signature act, which was used as a model by a number of other
states who implemented or are implementing digital signature legislation.
Under the Utah act, digitally signed documents are given the same evidentiary
weight as notarised documents, and someone trying to overcome this has to
provide "clear and convincing evidence" that the document is fraudulent, which
is difficult since it bears a valid signature from the users key (this fact has
been used in the past to criticise digital signature laws based on this act).
In addition, under the Utah act and derived acts, anyone who loses their
private key bears unlimited liability for the loss (in contrast, consumer
liability for credit card loss is limited to $50).  This leads to the spectre
of a malicious attacker who has the ability to issue notarised documents in
your name for which you carry unlimited liability.  This is a lot more
important than someone reformatting your hard drive, or stealing last months
sales figures.

@_date: 1998-01-20 23:37:38
@_author: Peter Gutmann 
@_subject: [Long] How to recover private keys for various Microsoft products 
How to recover private keys for Microsoft Internet Explorer, Internet
            Information Server, Outlook Express, and many others
                                      - or -
                 Where do your encryption keys want to go today?
                    Peter Gutmann, Microsoft uses two different file formats to protect users private keys, the
original (unnamed) format which was used in older versions of MSIE, IIS, and
other software and which is still supported for backwards-compatibility reasons
in newer versions, and the newer PFX/PKCS  format.  Due to a number of
design and implementation flaws in Microsofts software, it is possible to break
the security of both of these formats and recover users private keys, often in
a matter of seconds.  In addition, a major security hole in Microsofts
CryptoAPI means that many keys can be recovered without even needing to break
the encryption.  These attacks do not rely for their success on the presence of
weak, US-exportable encryption, they also affect US versions.
As a result of these flaws, no Microsoft internet product is capable of
protecting a users keys from hostile attack.  By combining the attacks
described below with widely-publicised bugs in MSIE which allow hostile sites
to read the contents of users hard drives or with an ActiveX control, a victim
can have their private key sucked off their machine and the encryption which
"protects" it broken at a remote site without their knowledge.
Once an attacker has obtained a users private key in this manner, they have
effectively stolen their (digitial) identity, and can use it to digitally sign
contracts and agreements, to recover every encryption session key it's ever
protected in the past and will ever protect in the future, to access private
and confidential email, and so on and so on.  The ease with which this attack
can be carried out represents a critical weakness which compromises all other
encryption components on web servers and browsers - once the private key is
compromised, all security services which depend on it are also compromised.
A really clever attacker might even do the following:
- Use (say) an MSIE bug to steal someones ActiveX code signing key.
- Decrypt it using one of the attacks described below.
- Use it to sign an ActiveX control which steals other peoples keys.
- Put it on a web page and wait.
On the remote chance that the ActiveX control is discovered (which is extremely
unlikely, since it runs and deletes itself almost instantly, and can't be
stopped even with the highest "security" setting in MSIE), the attack will be
blamed on the person the key was stolen from rather than the real attacker.
This demonstrates major problems in both Microsoft's private key security
(an attacker can decrypt, and therefore misuse, your private key), and ActiveX
security (an attacker can create an effectively unstoppable malicious ActiveX
control and, on the remote chance that it's ever discovered, ensure that
someone else takes the blame).
About a year ago I posted an article on how to break Netscape's (then) server
key encryption to the cypherpunks list (Netscape corrected this problem at
about the same time as I posted the article).  However more than a year after
the code was published, and 2 1/2 years after a similar problem with Windows
.PWL file encryption was publicised, Microsoft are still using exactly the
same weak, easily-broken data format to "protect" users private keys.  To
break this format I simply dusted off my year-old software, changed the
"Netscape" strings to "Microsoft", and had an encryption-breaker which would
recover most private keys "protected" with this format in a matter of seconds.
In addition to the older format, newer Microsoft products also support the
PKCS  format (which they originally called PFX), which Microsoft render as
useless as the older format by employing the RC2 cipher with a 40-bit key.  In
a truly egalitarian manner, this same level of "security" is used worldwide,
ensuring that even US users get no security whatsoever when storing their
private keys.  However even RC2/40 can take awhile to break (the exact
definition of "a while" depends on how much computing power you have available,
for most non-funded attackers it ranges from a few hours to a few days).
Fortunately, there are enough design flaws in PKCS  and bugs in Microsofts
implementation to ensure that we can ignore the encryption key size.  This has
the useful - to an attacker - side-effect that even if Microsoft switch to
using RC2/128 or triple DES for the encryption, it doesn't make the attackers
task any more difficult.  By combining the code to break the PKCS  format
with the code mentioned above which breaks the older format, we obtain a single
program which, when run on either type of key file, should be able to recover
the users private keys from most files in a matter of seconds.
A (somewhat limited) example of this type of program is available in source
code form from   Because
it's meant as a proof-of-concept program it's somewhat crude, and restricted to
recovering passwords which are single dictionary words.  Note: This does not
mean that using (say) two words as a password instead of one will protect your
private key.  All it means is that I haven't bothered to write anything more
sophisticated - no doubt anyone who was serious about this could adapt
something like cracklib's password-generation rules and routines to provide a
more comprehensive and powerful type of attack.  Similarly, by making trivial
changes to the key file data format it's possible to fool the program until
someone makes an equally trivial change to the program to track the format
change - this is meant as a demonstrator only, not a do-everything encryption
To use the program, compile and invoke it with:
  breakms  Here's what the output should look like (some of the lines have been trimmed a
  File is a PFX/PKCS  key file.
  Encrypted data is 1048 bytes long.
  The password which was used to encrypt this Microsoft PFX/PKCS  file is
    'orthogonality'.
  Modulus = 00BB6FE79432CC6EA2D8F970675A5A87BFBE1AFF0BE63E879F2AFFB93644D [...]
  Public exponent = 010001
  Private exponent = 6F05EAD2F27FFAEC84BEC360C4B928FD5F3A9865D0FCAAD291E2 [...]
  Prime 1 = 00F3929B9435608F8A22C208D86795271D54EBDFB09DDEF539AB083DA912D [...]
  Prime 2 = 00C50016F89DFF2561347ED1186A46E150E28BF2D0F539A1594BBD7FE4674 [...]
  Exponent 1 = 009E7D4326C924AFC1DEA40B45650134966D6F9DFA3A7F9D698CD4ABEA [...]
  Exponent 2 = 00BA84003BB95355AFB7C50DF140C60513D0BA51D637272E355E397779 [...]
  Coefficient = 30B9E4F2AFA5AC679F920FC83F1F2DF1BAF1779CF989447FABC2F5628 [...]
Someone sent me a test Microsoft key they had created with MSIE 3.0 and the
program took just a few seconds to recover the password used to encrypt the
One excuse offered by Microsoft is that Windows NT has access control lists
(ACL's) for files which can be used to protect against this attacks and the one
described below.  However this isn't notably useful: Most users will be running
Windows '95 which doesn't have ACL's, of the small remainder using NT most
won't bother setting the ACL's, and in any case since the attack is coming from
software running as the current user (who has full access to the file), the
ACL's have no effect.  The ACL issue is merely a red herring, and offers no
further protection.
Further Attacks (information provided by Steve Henson )
The PFX/PKCS  format is vastly more complex (and braindamaged) than the
older format.  You can find an overview of some of the bletcherousness in this
format at   After Microsoft
originally designed the format (calling it PFX) and presented it to the world
as a fait accompli, cleanup crews from other companies rushed in and fixed some
of the worst problems and security flaws.  However by this time Microsoft had
already shipped implementations which were based on the earlier version with
all its flaws and holes, and didn't want to change their code any more.  A
side-effect of this was that to be compatible, other vendors had to copy
Microsofts bugs rather than produce an implementation in accordance with the
standard.  Newer versions of the standard have now been amended to define the
implementation bugs as a part of the standard.
Anyway, as a result of this it's possible to mount three independant types of
attack on Microsoft's PFX/PKCS  keys:
1. Attack the RC2/40 encryption used in all versions, even the US-only one.
2. Attack the MAC used to protect the entire file.  Since the same password is
   used for the MAC and the encrypted key, recovering the MAC password also
   recovers the password used to encrypt the private key.  The cleanup crews
   added a MAC iteration count to make this attack harder, but Microsoft
   ignored it.
3. Attack the private key encryption key directly.  Like the MAC's, this also
   has an interation count.  Microsoft don't use it.
Even if one of these flaws is fixed, an attacker can simply switch over and
concentrate on a different flaw.
I decided to see which one could be implemented the most efficiently.
Obviously (1) was out (you need to perform 2^39 RC2 key schedules on average
to find the key), which left (2) and (3).  With the refinements I'm about to
describe, it turns out that an attack on the private key encryption is
significantly more efficient than an attack on the MAC.
To understand how the attack works, you need to look at how PKCS  does its
key processing.  The original PFX spec included only some very vague thoughts
on how to do this.  In later PKCS  versions this evolved into a somewhat
garbled offshoot of the PKCS  and TLS key processing methods.  To decrypt
data which is "protected" using the PKCS  key processing, you need to do the
  construct a 64-byte "diversifier" (which differs depending on whether you
        want to set up a key or an IV) and hash it;
  stretch the salt out to 64 bytes and hash it after the diversifier hash;
  stretch the password out to 64 bytes (using incorrect processing of the
        text string, this is one of Microsofts implementation bugs which has
        now become enshrined in the standard) and hash it after the salt hash;
  complete the hash and return the resulting value as either the key or the
        IV, depending on the diversifier setting;
(it's actually rather more complex than that, this is a stripped-down version
which is equivalent to what Microsoft use).
This process is carried out twice, once for the key and once for the IV.  The
hashing is performed using SHA-1, and each of the two invocations of the
process require 4 passes through the SHA-1 compression function, for a total
of 8 passes through the function.  Because the PKCS  spec conveniently
requires that all data be stretched out to 64 bytes, which happens to be the
data block size for SHA-1, there's no need for the input processing which is
usually required for SHA-1 so we can strip this code out and feed the data
directly into the compression function.  Thus the compression function (along
with the RC2 key setup) is the limiting factor for the speed of an attack.
Obviously we want to reduce the effort required as much as possible.
As it turns out, we can eliminate 6 of the 8 passes, cutting our workload by
75%.  First, we observe that the the diversifier is a constant value, so
instead of setting it up and hashing it, we precompute the hash and store the
hash value.  This eliminates the diversifier, and one pass through SHA-1.
Next, we observe that the salt never changes for the file being attacked, so
again instead of setting it up and hashing it, we precompute the hash and
store the hash value.  This eliminates the diversifier, and another pass
through SHA-1.
Finally, all that's left is the password.  This requires two passes through
the compression function, one for the password (again conveniently stretched
to 64 bytes) and a second one to wrap up the hashing.
In theory we'd need to repeat this process twice, once to generate the
decryption key and a second time to generate the decryption IV which is used
to encrypt the data in CBC mode.  However the start of the decrypted plaintext
  SEQUENCE {
    SEQUENCE {
      OBJECT IDENTIFIER,
          ...
and the SEQUENCE is encoded as 30 82 xx xx (where xx xx are the length
bytes).  This means the first 8 bytes will be 30 82 xx xx 30 82 xx xx, and
will be followed by the object identifier.  We can therefore skip the first 8
bytes and, using them as the IV, decrypt the second 8 bytes and check for the
object identifier.  This eliminates the second PKCS  key initialisation
call which is normally required to generate the IV.
As this analysis (and the program) shows, Microsoft managed to design a
"security" format in which you can eliminate 75% of the encryption processing
work while still allowing an attack on the encrypted data.  To make it even
easier for an attacker, they then dumbed the key down to only 40 bits, even in
the US-only version of the software.  In fact this doesn't really have any
effect on security, even if they used 128-bit RC2 or triple DES or whatever,
it would provide no extra security thanks to the broken key processing.

@_date: 1998-01-24 19:23:02
@_author: Peter Gutmann 
@_subject: Update on New Zealand crypto policy 
As part of my recent effort to prepare a useful home page after 2 years of having instead a mini text adventure, I've finally got around to finishing off the web page containing the recent history of, and current state of, New Zealands crypto export policy as decided by several intelligence agencies and a supporting cast of bungling bureaucrats.  This policy has resulted in New Zealand enjoying the dubious distinction of having the strictest export controls on earth, with everything ranging from crypto hardware down to software, library books, computer magazines, and journals being restricted from export.  It's not even possible for a university to publish academic research without prior permission from a government agency, and the requirements for obtaining this permission are structured to ensure that they can never be fulfilled.  You can find the information on:
  The page also contains links to a sizeable collection of never-before- published documents including correspondence with relevant government agencies, and media reports on the situation.
If you're going to send me mail about this, please note that I'll be at Usenix in San Antonio for the next week, so it'll take awhile for me to reply.  My PGP key's at the bottom of my home page if you need it.

@_date: 1998-11-06 04:45:47
@_author: Peter Gutmann 
@_subject: TriSnakeoil questions 
I had a talk to them, it turns out that of the two different Atalla's, Atalla the company and John Atalla the person, the snake oil is being pushed by Atalla the person rather than Atalla the company.  The Atalla people knew as little about it as everyone else, and although they were careful with their replies I got the impression that they were about as impressed with TriStrata as others on this list are.  OTOH perhaps they were just depressed that I asked them about TriStrata instead of their RSA/3DES card :-).
[I have half a dozen brochures for this one, in every single brochure it's  called something different (SET accelerator, SSL accelerator, e-commerce  accelerator,  accelerator) but once you get past the first few  application-specific paragraphs the rest is identical.  Covers all the bases  I guess.  Their white paper on why hardware crypto is better than software  crypto is a hoot too - "Hardware is cheaper" (obviously some new definition  of the word with which I wasn't previously familiar), "software crypto can't  be shared" (as opposed to hardware, which can be shared with a simple copy  command), etc.  Their products look pretty good, but everyone I talked to  complained about the price and was ready to jump on software alternatives]

@_date: 1998-11-08 11:01:13
@_author: Peter Gutmann 
@_subject: Blind signal demodulation 
The October 1993 Proceedings of the IEEE contain a number of rather interesting articles on blind signal identification and demodulation, which may be described roughly as "demodulation without the cooperation of the transmitter (or intended receiver where this might be necessary)".  The first article in particular goes into some detail on how to acquire QAM signals used in modems, including a neat diagram on p.1919 of a 64-QAM constellation through the various stages of acquisition by a blind demodulator.  The blind demodulation comletely bypasses the need for an initial training stage, acquiring the necessary signal-processing details on the fly.
The article finishes with overviews of typical hardware used for blind demodulation of QAM signals, including a multi-protocol DSP card with with 8 320C50's capable of blind demodulation of anything from 24 2400bps signals up through 8 V.34 ones, as well as an ASIC for blind demodulation of digital cable TV signals.  They also comment that blind decoders for typical voiceband signals can be implemented on Pentium MMX/UltraSparc-grade hardware.  This is interesting reading, and should lay to rest the UL that high-speed modems have some sort of magic immunity to interception which the lower-speed ones don't.
Oh yes, the introduction makes the observation that this sort of stuff is "rarely mentioned in the open literature".  It's not hard to see why.
Peter.

@_date: 1998-11-08 19:16:42
@_author: Peter Gutmann 
@_subject: verisign digital id's for outlook <shudder> 
It's protected by Microsoft asserting that it's protected.  There's also some
sort of attempt at encryption (easily broken, see
 but in any case there are
enough security holes there that anything which manages to run on your system
(ActiveX, as you've mentioned) can grab your keys without a lot of trouble.

@_date: 1998-11-09 05:02:06
@_author: Peter Gutmann 
@_subject: Blind signal demodulation 
Oops, that should be October 1998, not 1993 (ie last months issue).  Sorry
about that.

@_date: 1998-11-11 12:10:48
@_author: Peter Gutmann 
@_subject: More on blind signal demodulation 
There's at least one firm which makes this stuff commercially, their products
are available via   This looks like a
one-stop ECHELON shop: you take one or more of their products (pick your type,
intended target, and budget), plug as many E1's or E3's or whatever into one side as you can handle (the most impressive one does 16 E3's or 7680 voice/
data channels) and all modem, fax, and voice comms going through the circuit are available on the other side.  They have products to do automatic channel/
signal scanning, demuxing, decoding of various data formats, processing of satellite and radio signals ("combines tuning, demodulation, descrambling, decoding, demultiplexing, and output formatting in one chassis"), every kind of mobile phone signal you've ever heard of, digital microwave links, decoding of higher-level protocols like V.42/V.42bis, X.25, HDLC, PPP, every Internet protocol worth doing, etc etc (their terminology is pretty neat, they have for example a 1.5-44.7Mbps "modem for on-the-move applications" :-).  Much of the hardware claims to be built to TEMPEST specs.  One interesting point is that most of their stuff is for E1's and E3's even though they're a US company.

@_date: 1998-11-28 12:09:52
@_author: Peter Gutmann 
@_subject: open-pgp / s/mime interoperability 
Actually S/MIME *could* support the use of PGP keys, but there's a field
(the SubjectKeyIdentifier) missing from the CMS SignerInfo which prevents
this.  This is rather inconsistent, because the same field is present in
the RecipientInfo.  I'm currently arguing in favour of adding it to SignerInfo on the basis that any argument against it would also apply to
RecipientInfo.  Not sure whether it'll work though - a couple of list
members seem convinced that exactly the same thing which is currently in
RecipientInfo won't work if used in SignerInfo.

@_date: 1998-10-06 08:33:29
@_author: Peter Gutmann 
@_subject: Echelon's Origin 
Located nearby at  are documents related to the Kennedy assassination.  Check out the COMINT reports, they were getting information from an awful lot of interesting sources, many of which appear to be telegrams or telexes or similar
communications.  The Truman memo may show the background behind Echelon,
but these things show it (or at least its ancestor) in action.  Wow.

@_date: 1998-10-11 22:55:19
@_author: Peter Gutmann 
@_subject: Hidden WebTV signatures 
For those of you who don't read sci.crypt, Robert Ames  has posted an article in which he observes that all WebTV posts contain an X-WebTV-Signature: line containing base64-encoded data.  For samples of WebTV-generated posts, try the alt.weemba newsgroup, which is filled with WebTV-user drool (caution: remember to employ protection when exposting your mind to the content of the messages).  Some samples:
X-WebTV-Signature: 1
        ETAsAhQDqtur/jfleJ2CDOnNrVoeyALEQAIUOQyCBbzjx5HHfxeMERDgCjztXOU= X-WebTV-Signature: 1
        ETAtAhUAmCCzQt+Tqt6fNX+L9+gDCECaqQkCFA0YCPz5tk85mUgq7iX/u4vWvOgG These decode into ASN.1-encoded DSA signatures, eg:
   1 30   45: SEQUENCE {
   3 02   21:   INTEGER
            :     00 98 20 B3 42 DF 93 AA DE 9F 35 7F 8B F7 E8 03
            :     08 40 9A A9 09
  26 02   20:   INTEGER
            :     0D 18 08 FC F9 B6 4F 39 99 48 2A EE 25 FF BB 8B
            :     D6 BC E8 06
            :   }
for the second one.  The key isn't included in the header, presumably the  address can be tied to the hardware which contains some hardcoded DSA key.  I wonder if WebTV users know they're signing each message they send?

@_date: 1998-10-23 22:02:56
@_author: Peter Gutmann 
@_subject: Break DES Fast! 
Dear Friend,                                  My name is Dave Rhodes.  In 1997 my cipher designs had all been broken, my patents declared without merit, and NIST had rejected my preliminary AES submission.  Then in early 1998 I received a letter in the mail telling me how I could earn fame as a cryptographer whenever I wanted.  I was naturally very skeptical and threw the letter on the desk next to my computer.  It's funny though, when you are desperate, backed into a corner, your mind does crazy things.  I spent a frustating day looking through the DES S-boxes for better differentials, but the pickings were sparse at best.  That night I tried to unwind by reading a few security newsgroups.  I read several of the posts and then glanced at the letter next to the computer.  All at once it came to me, I now had the key to my dreams.
This year I presented a paper at Crypto'98 and have one accepted for Eurocrypt'99.  Cryptographers from all over the world come to me for advice, and NIST has asked me to be on the AES evaluation board.  I will have my own crypto conference within 4 or 5 months.  Anyone can do the same.  This crypto method works perfectly every time, 100% of the time.  Best of all you never have to leave home except to go to your mailbox or post office.          I realized that with the power of the computer I could expand and enhance this method into the most unbelievable system that has ever been created.  I substituted email in place of the post office and electronically did by computer what others were doing 100% by mail.  Most of the hard work is speedily handled by computers throughout the world.  If you believe that someday you deserve that lucky break that you have waited for all your life, simply follow the easy instructions below.  Your dreams will come true.
Sincerely yours,                                                Dave Rhodes                                                          Follow these instructions EXACTLY, and in 20 to 60 days you will have searched well over 50 trillion DES keys.  This program has remained successful because of the honesty and integrity of the participants.  Please continue its success by carefully adhering to the instructions.  1. Immediately send the following ciphertext/plaintext pair below to ten friends: 12F7E88920:0A2DE3172B
2. Remove the searched keyspace that appears at number 1 on the list below.  Move the other 9 sets of searched keyspaces up one position.  Number 2 will become number 1 and number 3 will become number 2, etc.  Place the keyspace you've searched in the number 10 position.
3. Post the message with the keyspace you've tried in the number 10 position into 10 separate newsgroups or mailing lists, call the file BREAK.DES.FAST.
4. Within 60 days you will receive over 50 trillion further DES keys which people have tried.
This is not a scam.  This is perfectly legal.  If you have any doubts, refer to 22 USC Sec 2778.
[Keyspace list snipped]

@_date: 1998-10-26 10:20:40
@_author: Peter Gutmann 
@_subject: TriSnakeoil questions 
I'm currently sitting in a booth at a Tandem user show directly
opposite the Atalla one.  If there's anything in particular which
someone wants to ask them, let me know and I'll see how knowledgeable their salesdroids are.  Dunno how reliable my access to mail will be in the next day or two, if you're local
you could try calling me at the hotel I'm staying, which is the
Fairmont in San Jose (although you've got a whelks chance in a
supernova of actually catching me in my room, so you'll probably
have to leave a message).

@_date: 1998-09-22 21:31:22
@_author: Peter Gutmann 
@_subject: German court: DES is no good 
German Court Ruling Another Blow To U.S. Encryption Standard
By Mary Lisbeth D'Amico
MUNICH - A German district court has ordered a bank in Frankfurt to repay a customer 4,543 marks (US$2,699) for money withdrawn from her bank account after her bank card was stolen.
The decision, made public Monday, again points to the holes in the 56-bit encryption technology used in Eurocheque cards, called EC Cards, according to the Chaos Computer Club, a German hackers group.
Calling the encryption technology for the EC bank cards "out-of-date and not safe enough," a Frankfurt District Court held the bank responsible for the amount stolen from the 72-year old plaintiff in February 1997. Neither the bank's name or that of the plaintiff were revealed.
An EC card is like a bank card which can be used at bank automats and point-of-sale terminals throughout Europe. The cards feature the U.S. government's data encryption standard, which uses 56-bit encrypted code to scramble the security information.
[Rest snipped]

@_date: 2000-11-28 14:13:14
@_author: Peter Gutmann 
@_subject: Excerpts from "The Design and Verification of a Cryptographic Security Architecture" available 
In August I finally submitted my PhD thesis, coming close to wrapping up my
long career as a tenured graduate student.  Although the work hasn't been
accepted yet, there has been some interest expressed in portions of it so I've
put a few chapters online.  Note that these chapters represent a draft only and
are not the completed work.
The main part of the thesis, Chapters 1-5, is available from
  These chapters look at
an alternative way of building what people have been trying to do with Orange
Book B3/A1-type systems, but in a way which is feasible and practical for an
open source system where you don't have tens of millions of dollars and 5-10
years available to produce a product.
The chapters are (from the web page, where they're links to the docs):
  The software architecture, wherein the cryptlib software architecture is
  presented
  The security architecture, wherein the cryptlib security architecture is
  presented
  The kernel implementation, wherein the implementation details of the cryptlib
  security kernel are examined
  Verification techniques, wherein existing methods for building secure systems
  are examined and found wanting
  Verification of the cryptlib kernel, wherein a new method for building a
  secure system is presented.

@_date: 2002-08-19 17:28:39
@_author: Peter Gutmann 
@_subject: Good survey article on crypto hardware 
There's a good article on software and hardware for reconfigurable computer
systems (e.g. FPGA's) in the June 2002 ACM Computing Surveys for people who are
interested in that sort of thing.  This is the sort of hardware which is often
used for crypto when a full ASIC isn't economically viable (one of those
combined PPC+FPGA cores would be quite interesting for crypto use).

@_date: 2002-08-28 15:26:47
@_author: Peter Gutmann 
@_subject: right MTA for crypto support 
Actually it's better than any other mail security out there.  See the slides
for my talk at Usenix Security ( for more
details (the StartTLS stuff is about halfway through).

@_date: 2002-08-30 15:37:25
@_author: Peter Gutmann 
@_subject: right MTA for crypto support 
Oops, sorry, trimmed the wrong text.
Currently the amount of my mail protected by traditional means is essentially
nonexistant.  I get one piece of PGP-encrypted mail every month or two (and I
was one of the peope who helped write the thing!) and I don't recall ever
having received or sent any S/MIME-encrypted mail.  OTOH something like 10-15%
of all my mail is protected by STARTTLS, and the figure is rising continuously
and will continue to do so (particularly if MS make some minor changes in
Exchange which I've asked some people there about).
It doesn't matter how many types of mail encryption software I have sitting
unused on my hard drive, 10% (and growing) coverage with reasonable protection
is better than 0% coverage with good protection.

@_date: 2002-08-30 17:35:07
@_author: Peter Gutmann 
@_subject: Cryptographic privacy protection in TCPA 
I designed something along these lines some years ago as a way of building a
fault-tolerant key management system.  The idea is that you create a pile of
keys, and these vote on key updates.  If a key is compromised, you sign its
replacement with a quorum of non-compromised keys, and replace the bad key.
You also periodically roll over keys as a preventive measure, limiting
exposure due to compromises.  No need for a PKI or anything else complex like
that, it's all automatic and transparent.
There can be slight problems if a device stays offline long enough that enough
keys have been rolled over to make reaching a quorum impossible, which was an
issue when I designed the thing but rather unlikely now.  I can dig up the
exact details in case anyone's interested.

@_date: 2002-07-11 15:17:52
@_author: Peter Gutmann 
@_subject: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
Both Netscape 6 and MSIE 5 contain ~100 built-in, automatically-trusted CA
 * Certs with 512-bit keys.
 * Certs with 40-year lifetimes.
 * Certs from organisations you've never heard of before ("Honest Joe's Used
   Cars and Certificates").
 * Certs from CAs with unmaintained/moribund websites ("404.notfound.com").
These certs are what controls access to your machine (ActiveX, Java, install-
on-demand, etc etc).
  * It takes 600-700 mouse clicks to disable these certs to leave only CAs you
    really trust.
(The above information was taken from "A rant about SSL, oder: die grosse
 Sicherheitsillusion" by Matthias Bruestle, presented at the KNF-Kongress
 2002).
How many more do you need?

@_date: 2002-07-12 03:18:09
@_author: Peter Gutmann 
@_subject: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
I'd heard stories of collapsed dot-coms' keys being auctioned off, that being
the only thing of value the company had left.  It makes the title of Matthias'
paper even more appropriate.
(However, I do think that anyone wanting to compromise your security will use
 this morning's MSIE hole to do it rather than buying a CA key.  OTOH it'd be a
 great universal skeleton key for government agencies charged with protecting
 the world from equestrians).

@_date: 2002-07-13 18:15:59
@_author: Peter Gutmann 
@_subject: DNA databases to be classified 
"Lucky Green"  quoted:
I saw this on BBC news.  It took a very sophisticated lab two years work to
produce polio.  They thought they might be able to do smallpox given about 20
years work.  They even managed to slip in an Internet reference in the story. I guess "We synthesised polio from RNA" just isn't newsworthy enough on its

@_date: 2002-07-13 18:34:36
@_author: Peter Gutmann 
@_subject: Ross's TCPA paper 
Hmm, I can just see it now, Windows 2005 ships as three CDs, a 400-page EULA, a
fine-tip soldering iron, a magnifying glass, an EMBASSY chip, and a copy of
"SMD Soldering for Dummies".

@_date: 2002-07-21 19:47:39
@_author: Peter Gutmann 
@_subject: Photos of Bad Aibling RSOC posted 
I've finally got around to posting the photos of Bad Aibling RSOC which I took
two years ago.  From the web page:
  There are very few photos of the Bad Aibling RSOC around, only one or two
  rather old, grainy illustrations which presumably came from newspaper
  articles.  When I was in the area in the summer of 2000 I took the
  opportunity to wander round and take a few photos, which I've posted below
  as scanned.  These were taken with a borrowed camera and a fixed 50mm lens,
  so don't expect too much (I'm a cryptographer, not a photographer).  Note
  that this page can take awhile to load because of the number and size of the
  images.
Available at

@_date: 2002-06-01 20:18:20
@_author: Peter Gutmann 
@_subject: PKI: Only Mostly Dead 
Thankyou Nobody.  You should have found the e-gold in your acount by now :-).
  "Opinion is divided on the subject" -- Captain Rum, Blackadder, "Potato".
The use with SSL is what Anne|Lynn Wheeler refer to as "certificate
manufacturing" (marvellous term).  You send the CA (and lets face it, that's
going to be Verisign) your name and credit card number, and get back a cert.
It's just an expensive way of doing authenticated DNS lookups with a ttl of one
year.  Plenty of PK, precious little I.
You can play with semantics here and claim the exact opposite.  All of the
cases you've cited are actually examples of global distinguisher + locally
unique name.  For example the value 1234567890 taken in isolation could be
anything from my ICQ number to my shoe size in kilo-angstroms, but if you view
it as the pair { ,  } then it makes sense
(disclaimer: I have no idea whether that's either a valid ICQ number or my shoe
size in kilo-angstroms).
(This is very much a philosophical issue.  Someone on ietf-pkix a year or two
 back tried to claim that X.500 DNs must be a Good Thing because RFC 822 email
 address and DNS names and whatnot are hierarchical like DNs and therefore
 can't be bad.  I would suspect that most people view them as just dumb text
 strings rather than a hierarchically structured set of attributes like a DN.
 The debate sort of fizzled out when no-one could agree on a particular view).
I think the unified view is that what you need for a cert is a global
distinguisher and a locally meaningful name, rather than some complex
hierarchical thing which tries to be universally meaningful.  Frequently the
distinguisher is implied (eg with DNS names, email addresses, "for use within
XYZ Copy only", etc), and the definition of "local" really means "local to the
domain specified in the global distinguisher".  I'm not sure whether I can
easily fit all that into the paper without getting too philosophical - it was
really meant as a guide for users of PKI technology.

@_date: 2002-06-13 15:13:15
@_author: Peter Gutmann 
@_subject: Sci Journals, authors, internet 
Usenix is really good with this.  You agree not to re-publish anything for a
period of one year (to cover their print distribution), although you're allowed
to put a copy on your home page.  After that, you're free to do what you like.
They also make all their stuff available online at no charge after a year. This
is why I preferentially submit papers to Usenix rather than ACM or IEEE, I want
to get the information out there where it does some good, not have it locked up
in a copyright prison for all eternity.  I can't imagine that the ACM is going
to make much (if anything) from the reprint rights of a ten-year-old article on
distributed search algorithms, but by locking it up, very few people ever have
access to it.
(Hmm, I wonder if it can be argued that making stuff intended for public
 distribution inaccessible violates the creator's moral rights?  I know that
 doesn't apply in the US, but in other countries it might work.  Moral rights
 can't be assigned, so no publisher can take that away from you.  Any lawyers
 out there?).
That's more traditional for publishers like IEEE and ACM.  OTOH they seem to
turn a blind eye to people making papers available on their home pages, even if
the publishing agreement says you shouldn't do that.  I suspect the backlash
would be too strong if they tried to clamp down on this, although I wish it'd
be formalised in some way rather than leaving it as a grey area.

@_date: 2002-06-20 21:12:12
@_author: Peter Gutmann 
@_subject: Good quote on biometric ID 
I was reading a late-70's paper on computer security recently when I saw that
it contains a nice quote about the futility of trying to use biometrics to
prevent Sept.11-type attacks, I thought I'd share it with people:
  When a highway patrolman is sent to his duty, he has to be given the
  authority to cite traffic violators.  This cannot be done explicitly for each
  violator because at the time that the patrolman is sent to his duty, the
  traffic violator does not exist, and the identity of the future violators is
  not known, so that it is impossible to construct individual access rights for
  the violators at that time.  The point is that the patrolman's authority has
  to do with the behaviour of motorists, not their identity.
  - Naftaly Minsky, "An Operation-Control Scheme for Authorisation in Computer
    Systems", International Journal of Computer and Information Sciences,
    Vol.2, No.2, June 1978, p.157.

@_date: 2002-06-28 02:15:57
@_author: Peter Gutmann 
@_subject: Revenge of the WAVEoids: Palladium Clues May Lie In AMD Motherboard Design 
Think of it as DIVX for PCs, with a similar chance of success (see my earlier
post about TCPA being a dumping ground for failed crypto hardware initiatives
from various vendors).  Its only real contribution is that the WAVEoid board on
Ragingbull (alongside the Rambus one) is occasionally amusing to read, mostly
because it shows that the dot-com sharemarket situation would be better
investigated by the DEA than the FTC.

@_date: 2002-05-24 17:04:18
@_author: Peter Gutmann 
@_subject: NAI pulls out the DMCA stick 
It never had much in the way of compatibility problems (see e.g. RSA's S/MIME
interop page, if it still exists - even Microsoft's implementation would
interoperate without any real trouble).  It *did* have a problem that the
compatibility was typically at the level of RC2/40.  This hasn't been an issue
since the export controls were lifted.
Well, there's  for
starters, which has been around for some years.

@_date: 2002-05-24 17:13:18
@_author: Peter Gutmann 
@_subject: NAI pulls out the DMCA stick 
The only CA-issued certs I've ever used were free, and under a bogus name.
Usually I just issue my own.  You really need to find a better strawman than
this if you want to criticise S/MIME.

@_date: 2002-05-24 18:55:09
@_author: Peter Gutmann 
@_subject: Joe Sixpack doesn't run Linux 
Those who care about security [0] use PGP, the rest use S/MIME.  To steal a
line from Hexed:
  "S/MIME: For people who could care less".
Actually it's not even that, it's closer to:
  "Plaintext: For people who could care less".
I have yet to exchange an encrypted S/MIME message of any significance with
anyone, ever.  Even if the other side is using an S/MIME-enabled mailer, we
usually end up using PGP even if it means having to try half a dozen different
versions to find one which will process the other side's messages.  While I'm
in a quoting mood, there's also Marshall Rose's comment about X.400 to steal:
  Two people meet at a conference and exchange email addresses.  They get back
  to their offices and want to communicate securely.  If both sides are using
  PGP x.y.z, they communicate securely.  If one side is using PGP x.y.z and the
  other isn't, they wait for a message and then keep trying different PGP
  versions until they find one which will process the message.  If they aren't
  using PGP, they communicate in plaintext and hope no-one's listening.
  (In case that's forwarded or quoted out of context, this is a comment on a
   social issue, not a software issue).
[0] With the corollary: "and aren't government users", S/MIME is used a fair
    bit in certain areas, it just doesn't get much public exposure.

@_date: 2002-05-27 19:56:48
@_author: Peter Gutmann 
@_subject: NAI pulls out the DMCA stick 
I'll say this one more time, slowly for those at the back: What you're
criticising is PEM circa 1991, not S/MIME.  Things have moved on a bit since

@_date: 2002-05-27 20:06:21
@_author: Peter Gutmann 
@_subject: NAI pulls out the DMCA stick 
Grab whatever crypto software you feel most comfortable with that does X.509
and start cranking out certs.
Certs are for public-key algorithms, so Twofish would never appear in there
(well, I guess you could certify a Twofish key, but I'm not sure what the point
would be).
You have to distinguish between the X.509 format and tools to use X.509.  I
assume you're after a manual for the tools, rather than RFC 3280, for the same
reason that most PGP users don't start by reading RFC 2440.  In that case,
refer to the docs for your crypto toolkit.

@_date: 2002-05-27 20:11:18
@_author: Peter Gutmann 
@_subject: S/MIME and web of trust (was Re: NAI pulls out the DMCA 
I proposed some very simple additions to X.509 which would allow you to use the
certs in the same way as PGP keys a year or two back.  Unfortunately the PKIX
WG chair is about as open to PGP-style additions to X.509 as some PGP people
are towards S/MIME.
(You can also do PGP using X.509 certs, I've been doing that for awhile just
 out of sheer bloody-mindedness :-).

@_date: 2002-05-27 22:54:22
@_author: Peter Gutmann 
@_subject: Government subsidies: our last, best hope for 
"Lucky Green"  writes, and I add my $0.02:
It's also become increasingly difficult for crypto-enthusiasts within a company
to convince mgt. that a new project should use PGP.  A year or two back you
could still, with a bit of persuasion, convince a company to go with PGP rather
than S/MIME or SSL or whatever (and "whatever" is, with frightening frequency,
IPsec, of which more below).  This is now almost impossible to do, because PGP
is seen as having very little industry support, which terrifies management.
The major reason for this is the incessant need of the PGP standards
contributors to keep tweaking the spec for every little issue which comes down
the track, constantly breaking compatibility with the current code base.
Unfortunately given that someone is going to come up with some novel problem
which PGP doesn't quite address at the moment but which can be fixed with a
minor update, every six months or so, it's quite possible that the standard
will never settle down until someone gets around to shooting the engineers and
backing out the last dozen or so compatibility-breaking tweaks and updates.
Only if it's broken, and that's the "problem" with PGP: It ain't broken.  I can
take my 10-year-old copy of PGP 2.6.x and be no less secure with it than with
the very latest NAI release.  The only reason most people ever dumped ssh 1.x
was because of very widely-publicised exploits, and even then for many users it
took the widespread use of ssh rootkits to get them to go to 2.x.  PGP hasn't
had that problem.  Like the Energizer bunny, it just keeps on going.  Look at
the Disastry PGP releases with source code going back 10 years, it's like
taking a trip back in time.  Except for the gratuitous changes in packet
formats and whatnot and a few new algorithms, you could use it to process
current messages (it's one of the first of my standard suite of PGP versions to
try).  In fact since good ol' 2.x will interoperate with any other 2.x-vintage
version out there but post-2.x stuff is nothing but interop trouble, there's a
strong incentive *not* to upgrade.
It's not PGP specific.  It's because it ain't broken, and going to a newer
version is frequently more painful (due to interop problems) than staying with
what works.
As a matter of fact I keep an old DOS box stashed away for emergencies.  No
matter how bad things get, you can always bring up DOS on whatever random
hardware you can scrape together from various corners, fire up a terminal
emulator, and get online.
That's always been the problem with crypto software.  Crypto is cool and fun to
do.  It is (compared to the UI) relatively easy to implement given a decent
toolkit with a good selection of algorithms and whatnot (just to show I'm not
blowing smoke, it took me around two weeks to add OpenPGP as a target format
for cryptlib enveloping).  OTOH UI work is painful and boring and not even
remotely sexy.  It'd take me forever to put a UI at the level of Outlook (which
is what the masses would expect) onto cryptlib, and even if I knew anything
about Windows GUIs you couldn't pay me enough to do it.  There are however a
few products which have managed this, eg The Bat,
 so it's not impossible.  Sure,
it's not Outlook, but it's an impressive piece of work for one person.
Frequently because of management misunderstanding... no, let's be honest, total
cluelessness, though.  "You got a security problem?  No worries, just install a
VPN.  Sign here please".  VPNs are being sold as the solution to everything
from viruses to premature baldness, and occasionally even because of concerns
about outsiders grabbing sensitive data off external networks, although the
latter seems to be the exception rather than the rule.  Either the complete
lack of addressing (or even considering) the threat model before deployment, or
the fact that everyone including the tea lady are regarded as requiring access
once it's deployed, mean it's just an expensive collection of electronic worry
beads once installed.
These things are great, for $29.95 and a little isopropyl alcohol (or acrylic
spray paint) you get a nice GemPC430 card reader and drivers (they're normally
$60-70).  The card is just a dumb memory card though, so you still need to get
a GPK8K alongside the reader.

@_date: 2002-05-28 17:06:18
@_author: Peter Gutmann 
@_subject: Edinburgh Financial Cryptography Engineering 2002 - CFP 
Unfortunately they've become either just another Crypto clone (FC in the last
year or two) or a collection of XML/J2EE/buzzword-du-jour be-ins (all the
rest).  The world still needs a good, technical e-commerce security conference
which isn't one of the above.
I'd love to see it resurrected.  While I can't really organise it because of
where I am, I'd be happy to referee papes or whatever.  Having served on PCs
for several other security conferences, I've seen enough papers of the
appropriate kind submitted elsewhere to indicate that there'd be enough for an
e-commerce security conference (in other words there's no shortage of material
there).  The Usenix one, during its short lifetime, attracted some really good

@_date: 2002-05-28 17:37:54
@_author: Peter Gutmann 
@_subject: NAI pulls out the DMCA stick 
No, as I said before, what you're describing is PEM circa 1991, not S/MIME.  In
the S/MIME model, anyone can issue certs (just like PGP), including yourself.
In addition, many large CAs will issue certs in any name to anyone, so even if
you don't want to do your own keys a la PGP you can still get a Verisign cert
which behaves like a PGP key.
Rather than wasting all this bandwidth in a lets-bash-S/MIME-by-pretending-
it's-still-PEM debate (what is it with this irrational fear of S/MIME?), I'd be
more interested in a serious discussion on which key-handling model is less
ineffective, WoT or X.509-free-for-all.  At the moment both of them seem to
work by using personal/direct contact to exchange keys, with one side
pretending to be WoT-based (although no-one ever relies on this) and the other
pretending to be CA-based (although no-one ever relies on this [0]).  The end
result is that they're more or less the same thing, the only major
differentiating factor being that most X.509-using products don't allow you to
distribute your own certs the way PGP does.
[0] With my earlier caveat about exceptions for government orgs who have been
    instructed to rely on it, or else.

@_date: 2002-11-07 15:07:21
@_author: Peter Gutmann 
@_subject: Did you *really* zeroize that key? 
No it isn't.  This was done to death on vuln-dev, see the list archives for
the discussion.
[Moderator's note: I'd be curious to hear a summary -- it appears to
work fine on the compilers I've tested. --Perry]

@_date: 2002-11-08 17:40:02
@_author: Peter Gutmann 
@_subject: Did you *really* zeroize that key? 
You can't, in general, assume the compiler won't optimise this away
(it's just been zeroised, there's no need to check for zero).  You could make it volatile *and* do the check, which should be safe from being optimised.
It's worth reading the full thread on vuln-dev, which starts at
This discusses lots of fool-the-compiler tricks, along with rebuttals
on why they could fail.

@_date: 2002-11-21 20:34:10
@_author: Peter Gutmann 
@_subject: Digital signature legislation tutorial posted 
I've recently revamped part 2 of my Godzilla security tutorial, splitting off
the coverage of digital signature legislation and related issues into its own
section.  Part2a, consisting of a total of 79 slides, covers the question of
why we need digital signature legislation, what is a signature, paper
vs.electronic signatures, non-repudiation, trust, and liability, existing
approaches, examples of existing legislation of various types including
advantages and drawbacks, and the Digital Signature Law litmus test (and it
also explains why having a techie comment on legal issues isn't as silly as it
sounds :-).  It's available as part 2a of the Godzilla tutorial at
  Comments welcome

@_date: 2002-10-02 14:13:39
@_author: Peter Gutmann 
@_subject: What email encryption is actually in use? 
As opposed to more conventional encryption, where you're protecting nothing at
any point along the chain, because 99.99% of the user base can't/won't use it.
In any case most email is point-to-point, which means you are protecting the
entire chain (that is, if I send you mail it may go through a few internal
machines here or there, but once it hits the WAN it's straight from my gateway
to yours).

@_date: 2002-10-06 17:33:39
@_author: Peter Gutmann 
@_subject: Interesting KPMG report on DRM 
KPMG have a report "The Digital Challenge: Are You Prepared?" available at
 in which they surveyed execs at
media companies and conclude that they're focusing too much on (trying to)
lock up content using encryption rather than how to do something useful with
  Digital content is getting a lot of attention - but not at the board level,
  where it is urgently needed. As a recent KPMG survey of top executives
  shows, media companies are focusing too much on encryption and other
  defensive technologies while failing to develop proactive strategies that
  recognize and leverage their online intellectual property assets.
  But the industry.s efforts to grapple with losses on this scale by locking
  away content behind multiple layers of protection - whether encryption,
  copyright protection, or authentication - have tended to detract from the
  user experience while failing to deliver the hoped-for revenue streams.
  Indeed, for all the publicity, expert attention, and corporate ingenuity
  devoted to digital piracy, it is striking that global content companies have
  not yet been able to find a working solution.
  This white paper, organized around a survey conducted for KPMG by The
  Economist Intelligence Unit, takes the industry.s pulse on The bottom line
  is that media companies need to shift their focus from a circle-the-wagons
  defense of digital intellectual property to innovative strategies for
  managing online content as a core revenue source. To achieve this shift,
  digital intellectual property needs to be valued properly, just like other
  assets on the balance sheet. Also, its protection needs to be treated as a
  key issue of corporate governance and given sustained and dedicated board-
  level attention.
  It is clear from the survey that media executives are trying to remain
  optimistic about the potential of digital content - but securing
  intellectual property rights is an uphill battle. In the quest for the right
  mix of measures to fight piracy, executives are relying heavily on
  encryption as well as reactive steps to police and punish violators. At the
  same time, however, many companies fail to conduct systematic accounting for
  their digital assets, or to pursue more proactive strategies to build new
  revenue streams from their online content.
  Media companies have so far failed to pioneer new business models that would
  rob piracy of its appeal. Preoccupied with defending the barricades against
  pirates, the industry has shown a deficit of creativity and innovation in
  rolling out products and services that can compete with the pirates. This
  was clear in KPMG.s survey, where only a handful of respondents saw offering
  potential abusers the chance to distribute content legally as a way of
  protecting digital intellectual property.
  In addition, the content industry remains hostage to its own strict
  interpretations of copyright laws and definitions of intellectual property.
  Most leading media organizations have their roots in traditional media
  formats - they still consider every bit of content they produce to be
  subject to copyright and they defend it - tooth and nail. However, today.s
  Internet world conflicts with this business model, as consumers expect more
  fluid boundaries and demand a free flow of information.
Good stuff, read the whole thing at

@_date: 2002-09-04 17:14:16
@_author: Peter Gutmann 
@_subject: S/MIME in Outlook -- fucked. 
One of the eternal problems of X.509 software:
Implementation Problem Redux
Certified for use with Windows
- Microsoft owns the trademark
- Submit software to Microsoft, who perform extensive testing
- Passing software can use the certification mark
- Reasonable (given the size of the deployed base) interoperability among   tested products
- RSADSI owns (owned) the trademark
- Simple interoperability test for signing and encryption

@_date: 2002-09-05 15:12:15
@_author: Peter Gutmann 
@_subject: no ICs in nukes... 
There are no ICs in *safety-critical* areas (they use discrete components and
mechanical interlocks).  An earlier slide is quite clear that there are ICs
in there.

@_date: 2002-09-24 19:12:47
@_author: Peter Gutmann 
@_subject: What good are smartcard readers for PCs 
Companies buy a few readers for their developers who write software to work
with the cards.  They may even roll out a few in pilots, and put out a stack of
press releases and print brochures advertising how hip they are for using smart
cards.  Eventually the clients discover how much of a bitch they are to work
with (installation problems/buggy drivers/incompatibilities/not having your
card when you need it/etc, not helped by the fact that smart card vendor after-
sales support is the most client-hostile of any PC hardware type I know of)
that users decide to live with software-only crypto until the smart card scene
is a bit more mature.
Given that n_users >> n_card_vendors, this situation can keep going for quite
some time.

@_date: 2002-09-25 18:56:04
@_author: Peter Gutmann 
@_subject: FIB workstation photos 
As part of its tour of Nvidia, Anandtech got to look at an FIB workstation of
the kind used for (among other things) reverse-engineering and modifying
semiconductors.  For those who have never seen one of these things, there are
photos at

@_date: 2002-10-01 13:54:30
@_author: Peter Gutmann 
@_subject: Real-world steganography 
I recently came across a real-world use of steganography which hides extra
data in the LSB of CD audio tracks to allow (according to the vendor) the
equivalent of 20-bit samples instead of 16-bit and assorted other features.
According to the vendors, "HDCD has been used in the recording of more than
5,000 CD titles, which include more than 250 Billboard Top 200 recordings and
more than 175 GRAMMY nominations", so it's already fairly widely deployed.
Hidden Code Addition/Output Dither/Quantization
The final step in the reduction to 16 bits is to add high-frequency weighted
dither and round the signal to 16-bit precision. The dither increases in
amplitude in the frequency range of 16 to 22.05 kHz, leaving the noise floor
flat below 16 kHz where the critical bands of hearing associated with tonality
occur. As part of the final quantization, a pseudo-random noise hidden code is
inserted as needed into the least significant bit (LSB) of the audio data. The
hidden code carries the decimation filter selection and Peak Extend and Low
Level Range Extend parameters. Inserted only 2?5 percent of the time, the
hidden code is completely inaudible-effectively producing full 16-bit
undecoded playback resolution. The result is an industry-standard 44.1-kHz,
16-bit recording compatible with all CD replication equipment and consumer CD
The paper describing the process is available under the somewhat misleading
name   The description of
the stego en/decoding process is on p.15 (it's a rather long excerpt, but it's
interesting stuff):
As part of the final quantization, a hidden code side channel is inserted into
the LSB when it is necessary for the encoder to inform the decoder of any
change in the encoding algorithm. It takes the form of a pseudo-random noise
encoded bit stream which occupies the least significant bit temporarily,
leaving the full 16 bits for the program material most of the time. Normally,
the LSB is used for the command function less than five percent of the time,
typically only one to two percent for most music. Because the hidden code is
present for a small fraction of the time and because it is used as dither for
the remaining 15 bits when it is inserted, it is inaudible. This was confirmed
experimentally with insertion at several times the normal fraction of time.
The mechanism which allows insertion of commands only when needed consists of
encapsulating the command word and parameter data in a "packet". A
synchronizing pattern is prepended to the data and a checksum is appended. The
resulting packet is then scrambled using a feedback shift register with a
maximal length sequence and inserted serially, one bit per sample, into the
LSB of the audio data. The decoder sends the LSB's of the audio data to a
complementary shift register to unscramble the command data. A pattern
matching circuit looks for the synchronizing pattern in the output of the
descrambler, and when it finds it, it attempts to recover a command. If the
command has a legal format and the checksum matches, it is registered as a
valid packet for that channel. The arrival of a valid packet for a channel
resets a code detect timer for that channel. If both channels have active
timers, then code is deemed to be present and the filter select data is
considered valid immediately. However, any command data which would effect the
level of the signal must match between the two channels in order to take
effect. The primary reason for this is to handle the case where an error on
one channel destroys the code. In such a case, the decoder will mistrack for a
short time until the next command comes along, which is much less audible than
a change in gain on only one channel, causing a shift in balance and lateral
image movement. If either of the code detect timers times out, then code is
deemed not to be present, and all commands are canceled, returning the decode
system to its default state. If the conditions on the encoder side are not
changing, then command packets are inserted on a regular basis to keep the
code detect timers in the decoder active and to update the decoder if one
starts playing a selection in the middle of a continuous recording.
Since the decoder is constantly scanning the output of the de-scrambler shift
register for valid command packets even when none are present, the possibility
exists that there may be a false trigger. For audio generated by the encoder,
this possibility is eliminated in the absence of storage and transmission
errors by having the encoder scan the LSB of the audio data looking for a
match. If a match to the synchronizing pattern is found, the encoder inverts
one LSB to destroy it.
Modern digital storage and transmission media incorporate fairly sophisticated
error detection and correction systems. Therefore, we felt that only moderate
precautions were necessary in this system. The most likely result of an error
in the signal is a missed command, which can result in a temporary mis-
tracking of the decoding, as mentioned above. Given the low density of command
data, and the small changes to the signal which the process uses, these errors
are seldom more audible than the error would be in the absence of the process.
The chances of a storage error being falsely interpreted as a command are
extremely small.
For material not recorded using the encoder, a small probability for a false
trigger does exist. Given a moderate length for the scrambling shift register
so that its mapping behaves in a noise-like fashion and a choice of
synchronizing pattern which avoids patterns likely to appear in audio data
with a higher than average probability, susceptibility to false triggers can
be made arbitrarily small by increasing the length of the part of the packet
requiring a match. In the case of the current system, the combination of the
synchronizing pattern with the bit equivalence for all valid commands plus
check sum results in a required match equivalent to 39 sequential bits. For a
stereo signal, in which a match must occur in both channels within a one
second interval and the commands in both channels must specify the same gains,
this amounts to an expectation of one event in approximately 150 million years
of audio.
The scrambling operation uses a feedback shift register designed for a maximal
length sequence in which data taken from taps in the register are added using
modulo two arithmetic, equivalent to an 'exclusive or' operation, and fed back
to the input of the register. For a given register length there are certain
configurations of taps which will produce a sequence of one and zero values at
the output that does not repeat until 2N-1 values have emerged, where N is the
length of the shift register. This corresponds to the number of possible
states of the shift register minus one illegal state, and is called a maximal
length sequence. Such an output sequence has very noise-like properties and,
in fact, is the basis of some noise generators. We use the noise-like behavior
of the generator to scramble the command signals by adding them modulo two to
the input of the shift register, as for example in Figure 7a. This has the
advantage that a second similar shift register with taps in the same places
but with only feed forward addition modulo two (Figure 7b) will reproduce the
original input sequence when fed with the output of the first one. The fact
that the decode side has no feedback means that the initialization
requirements are limited to having N input samples prior to the beginning of
decoding, which means that the decoder will "lock up" very quickly. In this
scheme, the presence of a bit error anywhere in the length of a packet plus
initialization sequence will completely scramble the data, preventing
recovery. However, in practice, this has not been a problem for reasons
described above.

@_date: 2003-12-25 14:15:12
@_author: Peter Gutmann 
@_subject: U.S. in violation of Geneva convention? 
Unfortunately after GulfWarII the "winners" hadn't learned their lessons from
WWII very well.  At the end of the war, despite the bombing campaigns, Germany
had a vaguely functional administration and (heavily rationed) food, coal,
electricity, etc were available.  The Allies systematically dismantled all of
that, both through apathy (no real planning beyond "Move in and occupy the
place") and their zeal to rebuild the country in their own image.  For
example, they prevented anyone who'd ever been a Nazi party member from doing
their job.  Well the problem was that to do almost anything, you had to be a
party member, so they instantly stopped all civil administration,
engineering/maintenance work, teachers, the judicial system, the police, you
couldn't even deliver the mail without being a party member (since they were
government employees).
Virtually every male over the age of about 16 had been in the military and had
experience with weapons.  So you now had a mass of unemployed ex-military who
desperately wanted food and clothing, and had access to an almost infinite
supply of weaponry.  In addition Germany after the war attracted what one of
the allied leaders (Eisenhower?) described as "the scum of Europe", eager to
make a quick buck (in Iraq it's folks eager to beat up the infidels).  This
lead to sizeable pitched battles between the armed gangs and the occupying
military, with the military frequently being outgunned by the gangs.
Substitute Germany -> Iraq and profit / food -> religion /nationalism and the
same situation exists today.

@_date: 2003-02-05 17:08:17
@_author: Peter Gutmann 
@_subject: The Crypto Gardening Guide and Planting Tips 
After much procrastination I recently put the Crypto Gardening Guide and
Planting Tips online at
 this may be of
interest to readers.  From the introduction:
  There has been a great deal of difficulty experienced in getting research
  performed by cryptographers in the last decade or so (beyond basic
  algorithms such as SHA and AES) applied in practice.  The reason for this is
  that cryptographers don't work on things that implementors need because it's
  not cool, and implementors don't use what cryptographers design because it's
  not useful or sufficiently aligned with real-world considerations to be
  practical. As a result, security standards are being created with mechanisms
  that have had little or no security analysis, often homebrew mechanisms or
  the standards editor's pet scheme.  The problem is a lack of communication:
  Cryptographers often don't seem aware of the real-world constraints that
  their design will need to work within in order to be successfully deployed.
  The intent of this document is to cover some of those real-world constraints
  for cryptographers, to point out problems that their designs will run into
  when attempts are made to deploy them.  Also included is a motivational list
  of extremely uncool problems that implementors have been building ad-hoc
  solutions for since no formal ones exist.

@_date: 2003-02-05 17:46:20
@_author: Peter Gutmann 
@_subject: Putting the "NSA Data Overwrite Standard" Legend to 
sacred to a certain tribe in Borneo (see "The Elements of Networking Style",
by Mike Padlipsky).

@_date: 2003-01-27 17:39:30
@_author: Peter Gutmann 
@_subject: Big Brotherish Laws 
That's because non-US licenses constitute automatic permission for minor
traffic law violations.  The scenario is something like the following:
[Driver gets pulled over].
Driver: "Gidday mate, hows it going?"
[Cop asks for license, looks at it]
Cop: "Ahhhh, screw it, too much paperwork.  Don't do it again.  HAND".

@_date: 2003-01-31 15:18:44
@_author: Peter Gutmann 
@_subject: Sovereignty issues and Palladium/TCPA 
It looks like Palladium (or whatever it's called this week) is of concern not
just to individuals but to governments as well (the following text forwarded
from elsewhere):

@_date: 2003-07-01 21:01:40
@_author: Peter Gutmann 
@_subject: Attacking networks using DHCP, DNS - probably kills DNSSEC 
Given that their goal is zero-configuration networking, I can see that being
required to provide a shared secret would mess things up a bit for them.  It'd
be a bit like PKIX being asked to make ease-of-use a consideration in their
work, or OpenPGP to take X.509 compatibility into account.

@_date: 2003-07-31 01:01:08
@_author: Peter Gutmann 
@_subject: AP by any other name ... 
It's been used in other areas as well, and for rather longer than ten years.
For example, one of the most accurate estimates of the entropy of natural
language involved people placing bets on the value of the next letter seen (as
opposed to the more traditional "I guess it'll be an 'e'" estimation

@_date: 2003-07-31 16:06:00
@_author: Peter Gutmann 
@_subject: Secure IDE? 
DES/ECB, originally with a 40-bit key, more recently with 56-bit and 3DES.
Keys generated by the manufacturer onto a USB dongle.  No easy way to make
backups of the dongle.  It's a messy tradeoff: If you want something like
laptop/data-theft-protection (which will suit the majority of the market),
then DES-40/ECB is fine, but you want to be able to back up the dongle because
if that goes (and after multiple insertions and removals it will) you've lost
all your data.  OTOH if you want protection from the MIB the fragile nature of
the key storage is probably a benefit, but then you want 3DES/CBC to go with
it.  At the moment you have laptop-theft-protection crypto and MIB-protection
key storage.
You can buy truckloads of these things on ebay for about $20 a pop if you want
to play with one.

@_date: 2003-08-01 03:23:39
@_author: Peter Gutmann 
@_subject: Secure IDE? 
I get the feeling they use ECB for speed (heavy pipelining) rather than
Where would you store them?  The feature of this is that it's fully
transparent, so you can't store IVs anywhere.
That one's the only thing I can't find a good technical reason for... perhaps
it's just commercial, since they see the dongles as a revenue source and will
sell you software to set up n dongles yourself, where price is proportional to
How would you do this without a custom BIOS (remember that their general
product is for dropping into any PC)?
I'm more worried about key backup - it's bad enough having cheapest-possible-
components IDE drives without complicating it further with a second point of
failure.  In the meantime a better option is still the triumvirate of:
- Sensitive data saved only to RAM disk.
- 3DES-encrypted volume mounted as a filesystem, which I can back up in
  encrypted form if necessary, and with all crypto done in software with per-
  sector random IVs, user-generated keys, and all the other stuff you asked
  for.
- Encrypted swap.
(Oh yeah, and a UPS so you're not tempted to temporarily save stuff to disk
 elsewhere in case the RAM drive goes away suddenly).
If you're worried about Joe Burglar grabbing your laptop (for the value of the
laptop) and your business data being leaked as collateral damage, or someone
stumbling across your warez or pr0n, then it's probably adequate.  Since this
is what general users would be worried about, I'd agree with the statement.
Anyone worried about more than that (probably about 0.01% of the market) isn't
a general user any more.

@_date: 2003-08-01 05:05:48
@_author: Peter Gutmann 
@_subject: Secure IDE? 
But the IV is repeated, every time you encrypt new data for that sector.  You
need to either store a random IV for each sector (usually infeasible) or make
two passes over the data (details vary), using the output from pass 1 to
affect pass 2 (slow).
Customised, not custom.  Think of it as a Chinese-menu type setup, it's a one-
size-fits-all BIOS with appropriate modules compiled in for handling the CPU
and chipset features.  Now motherboard vendors can plug in their own feature
modules, but it's a somewhat nontrivial option usually used only for highly
marketable features (overclocking options, ability to re-flash from Windows,
etc etc).

@_date: 2003-06-03 03:54:53
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
Actually SSHv2 is just SSL with a different packet format (when I did my SSHv2
implementation I recycled the code from the SSL engine, it was that close
[0]).  That's probably a good indication that SSL/SSHv2 is a fairly optimal
(security/functionality/implementability/etc) design for an application-level
security protocol if two groups independently came up with the same design,
which brings us back the original question of why on earth Nullsoft tried to
roll their own.
[0] Note that my SSL implementation follows the standard SSL ladder diagram
    rather than the state-machine that SSL implementations are usually
    described as, which made it trivial to switch over for SSHv2 use.  I've
    never understood why every explanation of the SSL protocol I've ever seen
    uses ladder diagrams but once they talk about implementation details they
    assume you're doing it as a state machine, which makes it vastly harder to
    implement.  For example all the stuff about pending cipher suites and
    whatnot follows automatically (and transparently) from the ladder diagram,
    but is a real pain to sort out in a state machine.

@_date: 2003-06-04 01:04:39
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
That's a red herring.  It happens to use X.509 as its preferred bit-bagging
format for public keys, but that's about it.  People use self-signed certs,
certs from unknown CAs [0], etc etc, and you don't need certs at all if you
don't need them, I've just done an RFC draft that uses
shared secret keys for mutual authentication of client and server, with no
need for certificates of any kind, so the use of
certs, and in particular a hierarchical PKI, is merely an optional extra.
It's no more required in SSL than it is in SSHv2.
They spend a nontrivial portion of the book reinventing SSL/SSHv2.  I guess
they lean towards the roll-your-own side of the argument :-).  I'm firmly in
the opposite camp (see "Lessons Learned in Implementing and Deploying Crypto
Software", links off my home page at I think that providing an abstract description of a fairly complex security
protocol *in a book targeted at security novices* and then hoping that they
manage to implement it correctly is asking for trouble.  OTOH it's fun going
through the thought processes involved in designing the protocol.  I just wish
they'd applied the process to SSL or SSHv2 instead, so that at the end of it
they could tell the reader to go out and grab an implementation that someone
else has got right for them.
[0] The vendor of one widely-used MTA once told me that 90% of the certs they
    saw used in STARTTLS applications were non-big name CA-issued ones (self-
    signed, etc etc).

@_date: 2003-06-04 01:11:51
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
Naah, that third sentence is wrong.  It's:
  The overwhelming majority of [SSL users] wouldn't know SSL from HTTP with a
  padlock GIF in the corner.
I think the assertion was that SSH is used in places where it matters, while
SSL is used where no-one really cares (or even knows) about it.  Joe Sixpack
will trust any site with a padlock GIF on the page.  Most techies won't access
a Unix box without SSH.  Quantity != quality.
If you could wave a magic wand and make one of the two protocols vanish, I'd
notice the loss of SSH immediately (I couldn't send this message for
starters), but it would take days or weeks before I noticed the loss of SSL.

@_date: 2003-06-04 16:32:23
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
There's a two-level answer to this problem.  At an abstract level, doing
client certs isn't hard, there are various HOWTOs around for Apache, Microsoft
have Technet/MSDN papers on it for IIS, etc etc.  At a practical level, it's
almost never used because it's just Too Hard.  That's not the SSL client-cert
part, it's the using-X.509 part.  To save having to type in a long
explanation, I'll lift a representative paragraph from a (not-yet-published,
don't ask :-) paper on PKI usability:
  There is considerable evidence from mailing lists, Usenet newsgroups and web
  forums, and directly from the users themselves, that acquiring a certificate
  is the single biggest hurdle faced by users [1].  For example various user
  comments indicate that it takes a skilled technical user between 30 minutes
  and 4 hours work to obtain a certificate from a public CA that performs
  little to no verification, depending on the CA and the procedure being
  followed.  Obtaining one from non-public CAs that carry out various levels
  of verification before issuing the certificate can take as long as a month.
  A representative non-technical user who tried to obtain an (unverified)
  certificate from a public CA took well over an hour for the process, which
  involved [...] eventually the user gave up.
and that doesn't even get into the mess of managing private keys, handling
revocation, etc etc etc ad nauseum:
  The problems that this creates are demonstrated by what happens when
  technically skilled users are required to work with certificates.  The
  OpenSSL toolkit [2][3] includes a Perl script CA.pl that allows users to
  quickly generate so-called clown suit certificates (ones that 'have all the
  validity of a clown suit' when used for identification purposes [4]), which
  is widely-used in practice.  The cryptlib toolkit [5][6] contains a similar
  feature in the form of Xyzzy certificates (added with some resistance and
  only after the author grew tired of endless requests for it), ones with
  dummy X.500 names, an effectively infinite lifetime, and no restrictions on
  usage.  Most commercial toolkits include similar capabilities, usually
  disguised as 'test certificates' for development purposes only, which end up
  being deployed in live environments because it.s too difficult to do it the
  way X.509 says it should be done.  Certificates used with mailers that
  support the STARTTLS option consist of ones that are 'self-signed, signed-by
  the default Snake Oil CA, signed by an unknown test CA, expired, or have the
  wrong DN' [7].  The producer of one widely-used Windows MUA reports that in
  their experience 90% of the STARTTLS-enabled servers that they encounter use
  self-signed certificates [8].  This reduces the overall security of the
  system to that of unauthenticated Diffie-Hellman key exchange, circa 1976.
  In all of these cases, the entire purpose of certificates has been
  completely short-circuited by users because it.s just too difficult to do
  the job properly.  The problematic nature of X.509 is echoed in publications
  both technical and non-technical, with conference papers and product
  descriptions making a feature of the fact that their design or product works
  without requiring a PKI.  For example, one recent review of email security
  gateways made a requirement for consideration in the review that the product
  'have no reliance on PKI' [9].  As an extreme example of this, the inaugural
  PKI Research Workshop, attended by expert PKI users, required that
  submitters authenticate themselves with plaintext passwords because of the
  lack of a PKI to handle the task [10][11].
The assumption of the protocol's creators was that someone would figure out
how to make X.509 PKI work by the time SSL took off, and everyone would have
their own certificates and whatnot.
At least they got *most* of the design right :-).

@_date: 2003-06-05 03:24:44
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
A debate topic I've thought of occasionally in the last year or two: If
digital signatures had never been invented, would we now be happily using
passwords, SecurIDs, challenge-response tokens, etc etc to do whatever we need
rather than having spent the last 20-odd years fruitlessly chasing the PKI
dream?  There was some interesting work being done on non-PKI solutions to
problems in the 1970s before it all got drowned out by PKI, but most of it
seems to have stagnated since then outside a few niche areas like wholesale
banking, where it seems to work reasonably well.
(Hmm, now *that* would make an interesting panel session for the next RSA
 conference).

@_date: 2003-06-05 22:11:45
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
Is there some specific advantage here, or is it an academic exercise?  Some
quirk of supporting certain types of hardware like nCipher boxes that do async
crypto/scatter-gather?  I have a vague idea from discussions with some
OpenSSL-engine developers that they had some requirement for supporting async
hardware in non-threaded environments, but from hearing the complaints about
how hard this ended up being I had the impression that this was a major
rewrite rather than something the state-machine implementation had been
specifically designed for (sorry, I don't have that much technical info, the
discussions tended to devolve into griping sessions about how hard async
crypto hardware was to work with, not helped by comments like "That's because
you're taking the path of most resistance, just use threads" :-).
I also don't know if that explains why, years before this was an issue,
everyone was already treating SSL as a state machine problem.

@_date: 2003-06-07 18:42:06
@_author: Peter Gutmann 
@_subject: Maybe It's Snake Oil All the Way Down 
That doesn't really have anything to do with ASN.1 though.  You can make just
as big a mess with XML (actually even bigger, in my experience), or EDIFACT,
or whatever.  The problem isn't the bit-bagging format, it's that it's
accumulated such a mass of cruft that no two people can agree on what to put
in there.  Whether the resulting mess is wrapped in ASN.1 or XML or EDIFACT or
plastic pooper scooper bags doesn't really make any difference.

@_date: 2003-06-10 14:21:57
@_author: Peter Gutmann 
@_subject: An attack on paypal --> secure UI for browsers 
Ka-Ping Yee has a web page at  and a lot of interesting
things to say about secure HCI (and HCI in general), e.g. a characterisation
of safe systems vs. general-purpose systems:
  In order for Alice to use her computer usefully, she has to be able to
  instruct programs to do things for her.  In order for those programs to
  carry out tasks, she has to trust those programs with some authority.  So
  every useful operation involves making the system a little bit less safe.
  In order to keep the system from becoming unboundedly unsafe, Alice must
  also be able to make her system more safe.
  A system in an ultimately safe state is one that can't do anything other
  than what was planned ahead of time.  General-purpose computing is useful to
  Alice only because she can make unpredictable inputs into the system, asking
  it to do new things.

@_date: 2003-06-11 01:16:06
@_author: Peter Gutmann 
@_subject: An attack on paypal --> secure UI for browsers 
Maybe MS will implement something like the secure attention key in the old VAX
A1 VMM (Ctrl-Alt-Del already serves this purpose for logins) which gives you a
guaranteed non-spoofed interface to the kernel (see for example "A
Retrospective on the VAX VMM Security Kernel" by Karger et al for more
information on this).  They certainly have the VMS knowhow :-).

@_date: 2003-06-12 16:35:11
@_author: Peter Gutmann 
@_subject: An attack on paypal 
Just to clarify this, so you need a multivalued CN, with one containing the
expression "(a|b|c)" and the remaining containing each of "a", "b", and "c"?
Is it multiple AVAs in an RDN, or multiple RDNs?   (Either of these could be
hard to generate with a lot of software, which can't handle multiple AVAs in
an RDN or multiple same-type RDNs).  Which hack is for MSIE and which is for

@_date: 2003-06-27 16:16:17
@_author: Peter Gutmann 
@_subject: Senators from Utah being Southern 
Great film, source of one of my favourite movie quotes:
  Have you ever noticed that in the Bible whenever God needed to punish
  someone, when God needed a killing, he sent an angel?  Can you imagine what
  a creature like that must be like?  Your entire existence spent praising
  God, but always with one wing dipped in blood.  Would you ever really want
  to *meet* an angel?"
(so much deeper than "I'll be back").

@_date: 2003-06-29 15:55:14
@_author: Peter Gutmann 
@_subject: Low cost cruise missile 
Good grief, what a load of drivel!  I'm sure Bruce will be amused to hear that
the toys he plays with in his spare time are now a threat to world security...
I wonder what his pulsejet-powered go-kart would be classed as?  The
journalist obviously went to a lot of trouble phoning various agencies and
people for comment, but didn't spend 10 seconds with google to see that these
things are commonly available all over the world.
(I think Bruce may have, to some extent, shot himself in the foot a bit by
 presenting it the way he has, although given his talent for self-promotion
 I'm sure it wasn't accidental :-).  Maybe he'll get his funding now.  In any
 case anyone can buy a standard commercially-built jet engine or build their
 own from one of the zillion web pages devoted to this topic and have as much
 of a "cruise missile" as he has.  The guidance system is left as an exercise
 for the reader).
Must have been a really slow news day...

@_date: 2003-03-18 01:09:44
@_author: Peter Gutmann 
@_subject: Brumley & Boneh timing attack on OpenSSL 
I had blinding code included in my crypto code for about 3 years,
when not a single person used it in all that time I removed it
again (actually I think it's probably still there, but disconnected).
I'm leaning strongly towards "general ignorance" here...

@_date: 2003-05-24 16:24:15
@_author: Peter Gutmann 
@_subject: Followup -- encrypted hard drive enclosure for $139 
The suspicion when this was discussed after the RSA conference was that, based
on performance figures, they were doing something like using 3 DES engines and
pushing 3 different blocks through them at once (or a single DES engine with
per-round pipelining), this restricting them to the insecure ECB mode.  Using
one of the parallelisable modes would have been a better move.  The fact that
they were using ECB lead to the inevitable suspicions that there'd be other
security problems present as well - I think Lucky's condemnation may have been
a bit strong (it's not totally insecure), but the use of ECB mode doesn't
exactly inspire confidence in the design of the rest of the system, even if it
was done for pragmatic reasons.

@_date: 2003-11-02 16:05:37
@_author: Peter Gutmann 
@_subject: Spelling corrections are now export-controlled 
Looks like the USG is going to outdo its ITAR silliness of a few years ago
with something even more ridiculous: Grammar and spelling corrections now
require an export license.  The following was forwarded to me by Clark

@_date: 2003-11-05 01:06:55
@_author: Peter Gutmann 
@_subject: Chaumian blinding & public voting? 
A friend of mine likes to say that lotteries are a tax on stupidity: The
dumber you are, the more tax you have to pay.

@_date: 2003-11-18 00:51:52
@_author: Peter Gutmann 
@_subject: Partition Encryptor 
ScramDisk (Win9x) or E4M (Win2K) will do it if she can handle a container-
volume encryptor rather than a partition encryptor, both are open source.  E4M
needs some minor updates for XP by someone who knows about NT device drivers,
otherwise you'll occasionally get problems unmounting volumes.

@_date: 2003-11-27 21:56:25
@_author: Peter Gutmann 
@_subject: C3 Nehemia C5P with better hardware RNG and AES support 
coderman I've got code to use it under Windows in the latest cryptlib snapshots (soon
to be the 3.1 release), which you can grab via the download link at
  The RNG code is in
misc/rndwin32.c, and is available under a dual license (BSD or GPL, your
choice).  Note though that I don't actually have a C5XL to play with, so at
the moment I've only been able to verify that it won't crash when run on AMD
and Intel CPUs.  If anyone has a C5XL with Windows installed, I'd be
interested in hearing about any problems.

@_date: 2003-11-28 02:24:20
@_author: Peter Gutmann 
@_subject: [Asrg] Re: [Politech] Congress finally poised to vote on 
Do you have any more details on this for those who don't normally follow

@_date: 2003-10-16 16:18:18
@_author: Peter Gutmann 
@_subject: C3 Nehemia C5P with better hardware RNG and AES support 
The security app note is also entertaining reading.  For example it lists one
of the motivations for getting security right as "your husband may find out
...".  On why they didn't save a copy of the test data for the NIST suite:
"(Hey, do you have 10TB of disk drives lying around? We can fill a 30 GB drive
with raw bits in a little more than 30 minutes - if the drive controller can
keep up with us.)".  And a little further on it refers readers to "Marketing
quote from CRI" (which was a slip-up this time).  The app note was actually
written by humans.  Cool.

@_date: 2003-10-18 23:11:17
@_author: Peter Gutmann 
@_subject: C3 Nehemia C5P with better hardware RNG and AES support 
In case anyone's interested, there's a cpu die photo at
 showing the
amount of real estate consumed by the crypto functions (it's the bottom
centre, a bit hard to read the label).

@_date: 2003-10-24 16:25:41
@_author: Peter Gutmann 
@_subject: RSA performance on Athlon64 vs. Itanium 
The reply, sent off-list, was something like "You're running x86-32 code on an
x86-64 CPU in emulation mode, what do you expect?" :-).  In addition the
Itanium RSA demo code works by turning the CPU into a $1000 ASIC, so you'd
need to test it for SSL handshakes per second or something similar where the
CPU has to do some other work besides RSA crypto ops.

@_date: 2003-10-24 16:33:33
@_author: Peter Gutmann 
@_subject: RSA performance on Athlon64 vs. Itanium 
Taking some guesses here at the code being used:
x86-32 hand-tuned asm optimised for Pentium Pro.
x86-64 code, gcc optimised for Athlon64.
x86-64 hand-tuned asm optimised for Athlon64.  I'm guessing this one has the
same catch as the Itanium speed test.
My PoS hardware test PC and a $25 Broadcom chip beats your Athlon 64 :-).

@_date: 2003-10-24 17:23:14
@_author: Peter Gutmann 
@_subject: C3 Nehemia C5P with better hardware RNG and AES support 
Apart from the obvious "what cool thing can we fit in -> <- this much spare
die space?", the obvious target is SOHO routers/firewall boxes.  My spies tell
me that it's already being used in a number of products like this, and the
addition of AES will help the process.  Hardware SHA-1 in the next rev makes
it even better, since you can now do IPsec and SSL tunneling purely in
hardware (and then you lose it all again in the crappy Rhine II NIC, but
that's another story).
Not for SOHO use it isn't, the initial handshake overhead is negligible
compared to the constant link encryption overhead.  The alternative is to do
the crypto externally, for which you're paying for an expensive and power-
hungry crypto core capable of doing a zillion DH/RSA ops/sec that gets used
once every few hours.  The alternative is to load or load your standard
firewall firmware into a Nehemiah and offload all the crypto and RNG stuff.

@_date: 2003-10-29 18:59:54
@_author: Peter Gutmann 
@_subject: NSA Turns To Commercial Software For Encryption (fwd from 
Yup, and that's all they did.  I've seen some downright bizarre
interpretations of this particular portent on the web (
slashdot), but the simple fact is that the NSA, in its role as the
agency responsible for overseeing crypto use by the USG, got a blanket
Certicom patent license for cases where ECC (of the Certicom-patented variety)
is used, just as they got a blanket DSA license for DSA, and would have had to
get a blanket RSA license before that if it hadn't been USG-funded work and a
blanket DES license if IBM hadn't made the patent freely usable.  Certicom's
PR folks, seeing an opportunity, put out a press release saying that the NSA
had licensed their patent(s).  This does not mean that the NSA is about the
drop their own crypto for ECC (definitely the silliest interpretation of
Certicom's press release I've seen), nor is it a sign that they believe RSA is
dead or that the end of the world is nigh, etc etc etc.

@_date: 2003-09-12 18:10:24
@_author: Peter Gutmann 
@_subject: Fatherland Security agents above the law? 
I thought it was "The news media will do anything for a story, even if they
have to manufacture it themselves".  Given that the US is currently obsessed
with terrorism, creating a sensationalist story related to it is a sure-fire
winner, even if the more accurate wording of "ABC ships expensive yacht
ballast to US" would get less attention.
(Come to think of it, I'm sure I could raise at least a moderate stink over
 here by letting it slip that some of the America's Cup yachts that were here
 earlier in the year may have had (shock, horror!) dangerous radioactive
 uranium in their keels, in violation of the government's anti-nuclear
 stance).

@_date: 2003-09-22 12:45:37
@_author: Peter Gutmann 
@_subject: Walker: NAT means you are a consumer, not a peer 
Isn't that synonymous with "Speak Freely maintenance is ending"?
Peter :-).

@_date: 2003-09-25 09:58:33
@_author: Peter Gutmann 
@_subject: End of the line for Ireland's dotcom star 
No-one ever got fired for buying Verisign.  Unfortunately in order to
understand that buying your certs from anything but the cheapest CA present is
a waste of money, you need a certain amount of understanding of how PKI (or at
least certificate manufacturing, as currently practiced) works.  Verisign have
invested an enormous amount of time and money into communicating the message
that it ain't secure if it doesn't say Verisign, and that's been very
effective.  I have, very occasionally, run into people who've told me how they
managed to locate a CA that sold them their certs for $29.95/year instead of
$495/year, but this is very much the exception to the rule.

@_date: 2004-04-18 09:42:36
@_author: Peter Gutmann 
@_subject: Fortress America mans the ramparts 
Details are available from sources like
(in general the docs are at where MRTD = machine-readable travel documents) although you have to be
careful what you reference since they're still frantically updating the
designs as they go, so any document will be out of date in a few months.  It's
also being (as far as I can tell) designed by people with little or no
security experience, under intense pressure from the US to Do Something About
Security.  Early technical drafts I saw (not the generic whitepapers on the
site, which are pretty vague) were an appalling pile of kludgery.  From what
I've heard since then it hasn't gotten any better.  I dunno whether this is
because the work is being contracted out to the Usual Suspects, who don't know
much about the area, or whether they did try and get experienced people in and
were told that what they were trying to do wouldn't work and/or couldn't be
done in less than 5-10 years.

@_date: 2004-08-03 03:36:45
@_author: Peter Gutmann 
@_subject: Giesecke & Devrient 
G&D produce (or help produce) things like banknotes and passports (and have
been doing so for more than a century), the secrecy comes with the territory.

@_date: 2004-08-03 03:57:02
@_author: Peter Gutmann 
@_subject: Giesecke & Devrient 
Yup.  It's standard banking-industry stuff, unless you're a large
bank/government/whatever and are prepared to sign over your firstborn and
swear eternal secrecy, they won't talk to you.
They're associated with good buzzword-compliance.  Since it's impossible to
get any technical details out of them, it's rather hard to say.  If you've got
something like a PKCS  driver off them then you should be OK, but if you
want to do any low-level work with the card yourself, find another vendor.
Nothing you can't get from a pile of other vendors who will actually talk to
you.  Unless you've got some business reason to deal with them, I wouldn't
bother (I have nothing against them per se, they just do business in a way
that isn't useful to me... and I'm sure they think the same of me).

@_date: 2004-08-03 17:11:23
@_author: Peter Gutmann 
@_subject: TERRORISTS ARE AMONG US! (Was: A close look at John Kerry's 
He went on to remind citizens to stay alert, trust no-one, and keep their
lasers handy.

@_date: 2004-08-27 23:04:37
@_author: Peter Gutmann 
@_subject: Cheesecloth security for hard drives 
Globalwin has just introduced an external hard drive enclosure ( with built-in 40-bit DES
encryption (and if it's the HW I think it is, that's 40-bit DES in ECB mode,
and the vendor generates the key for you).

@_date: 2004-12-03 22:21:35
@_author: Peter Gutmann 
@_subject: Anti-RFID outfit deflates Mexican VeriChip hype 
"R.A. Hettinga"  forwarded:
Since kidnapping is sort of an unofficial national sport in Mexico (or at
least Mexico City), this is particularly apropos.  An implanted RFID seems to
be just asking for an "express kidnap", something more traditionally used to
get money from ATMs.

@_date: 2004-12-05 22:00:44
@_author: Peter Gutmann 
@_subject: Unintended Consequences 
One of the characters in Hercules Returns is called Labia, and lives in the
town of Chlamydia.  There are a number of other characters with similar names.

@_date: 2004-02-14 12:34:01
@_author: Peter Gutmann 
@_subject: FCC vs decentralization 
The RIAA/MPAA and US govt.are working on that.  Stand by.

@_date: 2004-02-14 12:40:11
@_author: Peter Gutmann 
@_subject: Call to the Usual Suspects 
Do these things actually get organised?  I thought you just bump into other
Cpunks via the usual Brownian motion and at some point someone suggests a
place to go, half the participants slope off to an alternative establishment
on the way there, and that's how dinner gets arranged.

@_date: 2004-07-06 13:50:35
@_author: Peter Gutmann 
@_subject: UBL is George Washington 
It's been extraordinarily successful.  The US is driving itself (and a lot of
the rest of the world) nuts with terrorists-under-the-beds paranoia.  I
recently saw a replay of some speech that Bush made shortly after 9/11 where
he said something about "the terrorists wanted to demoralise? frighten? us.
This has failed", and my reaction was "Who are you kidding?".  The terrorists
have achieved their goals, and then some.  The correct response would have
been what the UK did in WWII, which was "business as usual" to let the
opposition know that they couldn't be intimidated.  In contrast, all Bush is
doing is telling them which buttons to push.

@_date: 2004-07-07 14:42:03
@_author: Peter Gutmann 
@_subject: UBL is George Washington 
It depends on what your goal is.  As someone else on this list pointed out,
terrorism is just another form of PR.  If OBL took out (say) that huge AT&T CO
in the center of Manhattan (the skyscraper that looks like something out of a
SF film), every cellphone user in the country who's had any dealings with AT&T
would help him pack the explosives.  Sure, there'd be some economic damage,
but Joe Sixpack would barely notice, and certainly wouldn't care.  OTOH the
WTC had enough significance and enough lives involved that everyone had to sit
up and take notice.  He knew exactly what target to hit to create the biggest
mess (I offer the results in the last two years as proof).

@_date: 2004-07-18 00:03:50
@_author: Peter Gutmann 
@_subject: vacuum-safe laptops ? 
When I investigated this a while back, gumstix were about the best deal.  They
also have pretty good support, it's a small company and the techies directly
answer queries on mailing lists.

@_date: 2004-07-25 12:47:06
@_author: Peter Gutmann 
@_subject: Texas oil refineries, a White Van, and Al Qaeda 
At Usenix Security a few years back, we [a bunch of random security people,
most of whom were foreign nationals] drove around Buckley AFB taking photos of
the radomes, SCIF, etc etc.  As we were doing this, we noticed a Chinese
national doing the same thing.  We wondered what the etiquette for this was,
do we exchange business cards, offer to trade photos, etc etc?  This was
before 9/11, no-one took any notice of us at the time.

@_date: 2004-07-25 12:55:21
@_author: Peter Gutmann 
@_subject: Texas oil refineries, a White Van, and Al Qaeda 
After several earlier events (the biggest being Oppau in Germany in 1921,
which left a crater the size of a city block), fire safety folk were given an
incentive to discover the true chemistry of ammonium nitrate.  Google for
"Texas city" + Grandcamp (the ship carrying the ammonium nitrate) for the full

@_date: 2004-06-16 03:37:54
@_author: Peter Gutmann 
@_subject: Breaking Iranian Codes (Re: CRYPTO-GRAM, June 15, 2003) 
"R. A. Hettinga"  forwarded:
Someone (half-)remembered reading the Crypto AG story in the Baltimore Sun
several years ago, bragged to Chalabi that the US had compromised Iranian
crypto, and the story snowballed from there.  The story could have started out
with a loquacious (Sun-reading) cab driver for all we know.  Some reports have
suggested the source was drunk, so maybe it was a drunk in a bar.  Maybe
Chalabi read the story himself and invented the snitch to make it seem more
important than it was, or to drive the US security community nuts with an orgy
of internal witch-hunting.  Given the lack of further information, it could
have been just about anything.

@_date: 2004-06-17 01:19:30
@_author: Peter Gutmann 
@_subject: crypto on *really* cheap hardware 
You forgot to mention "sometimes it'll stay up for as long as several hours
before crashing/locking up".  I guess this is a security feature, if someone
breaks in they'll only be able to use it for a short time before it locks up
or crashes.
Peter (who doesn't own one, but has heard horror stories from owners).

@_date: 2004-06-27 17:19:29
@_author: Peter Gutmann 
@_subject: [IP] When police ask your name, 
In his house at R'lyeh, dead Cthulhu waits knitting?  I think a few typos may
have crept into that one.
No, you're thinking of Hast(&%
Error: No route to host.

@_date: 2004-03-06 20:24:09
@_author: Peter Gutmann 
@_subject: Earthlink to Test Caller ID for E-Mail 
I think you mean:
  If we really do get cryptographic signatures on email in a way that works,
  expect 80% of all spam to contain legit signatures from hacked PCs.
This is just another variation of the "To secure the Internet, build a big
wall around it and only let the good guys in" idea.

@_date: 2004-03-07 01:26:47
@_author: Peter Gutmann 
@_subject: Earthlink to Test Caller ID for E-Mail 
"A way that works *in theory* would involve ...".  The chances of any vendor
of mass-market software shipping an MUA where the user has to enter a password
just to send mail are approximately... zero.
In that case you can just filter by sender IP address or something (anything)
that's simpler than requiring a PKI.  Again though, that's just another
variant of the "Build a big wall" dream.  In order to have perimeter security
you first need a perimeter.  If the spammer you're trying to defend against is
your own mother (because she clicked on an attachment you sent her, it says so
in the From: address, that's actually a spam-bot), you don't have a perimeter.
All you have is a big pile of Manchurian candidates waiting to bite you.

@_date: 2004-05-22 21:17:39
@_author: Peter Gutmann 
@_subject: The life of a Kiwi contractor in Iraq 
There's an interesting look at the situation in Iraq from the point of view of
a third-party contractor, in an article in the Sunday Star Times,
Most quotable quote:
  The thing that pisses us off is the Yanks had no idea what to do after
  they'd taken out the Iraqi army. They rocked on in, took them out and then
  thought: OOh shit, what do we do now?

@_date: 2004-11-02 23:30:36
@_author: Peter Gutmann 
@_subject: "Scan design called portal for hackers" 
A link ( would
have been useful...
The JTAG interface is your (that is, the reverse engineer's) friend.  This is
why some security devices let you disconnect it using a security-fuse type
mechanism before you ship your product.  Of course that only works if (a) the
device allows it, (b) you remember to activate it, and (c) your attacker isn't
sufficiently motivated/funded to use something like microprobing or a FIB
workstation to bypass the disconnect.

@_date: 2004-11-03 03:32:42
@_author: Peter Gutmann 
@_subject: This Memorable Day 
And it's not even original, they've mostly just translated it into English,
updated it a bit (e.g. League of Nations -> UN), and changed the Russian names
and references to Middle Eastern ones.

@_date: 2004-11-03 17:21:19
@_author: Peter Gutmann 
@_subject: This Memorable Day 
Well it wasn't the point I was trying to make, which was comparing it to
predictions made by (the propaganda division of) another super-power in the
mid 1940s about winning an unwinnable war because God/righteousness/whatever
was on their side, and all they had to do was hold out a bit longer.  Compare
the general tone of the WSJ article to the one in e.g. the first half of

@_date: 2004-11-03 18:29:45
@_author: Peter Gutmann 
@_subject: This Memorable Day 
Fighting an unwinnable war always seems to produce the same type of rhetoric,
whether it's the war on some drugs, the war on anyone Bush doesn't like, or
the war on anything non-German.  The only thing that changes over time are the
identities of the bogeymen that are used to justify it.
(Do you seriously think the war on bogey^H^H^Hterrorism can ever be won?
 Leaving aside the obvious debate that you can't even tell who you're at war
 with, how do you know when you've won?.
 We have always been at war with Terroristia)

@_date: 2004-11-04 22:31:31
@_author: Peter Gutmann 
@_subject: This Memorable Day 
We're talking about different things, the War on Bogeymen vs. the War for Oil.
In its war on bogeymen, the most notable thing the USG has achieved to date is
to create vastly more of them.  Its strategy is about as effective as the
paras were on Bloody Sunday, i.e. its actions serve mostly as a recruitment
drive for the opposition:
  I swear by Almighty God [...] to fight until we die in the field of red gore
  of the infidel tyrants and murderers.  Of our glorious faith, if spared to
  fight until not a single trace is left to tell that the Holy soil of our
  country was trodden by these infidels.  Also these robbers and brutes, these
  unbelievers of our faith, will be driven into the sea, by fire, the knife or
  by poison cup until we of the true faith clear these infidels from our
  lands.
(Whoever wrote the original was definitely no English lit major).

@_date: 2004-11-06 20:10:49
@_author: Peter Gutmann 
@_subject: This Memorable Day 
The figure that's usually quoted is that 80% of German's military force was
directed against Russia.  Of the remaining 20%, a lot had already been engaged
by France, the UK (via the BEF, the RAF, North Africa), Greece, etc etc before
the US got involved in Europe.  So the Russians should get most of the credit.

@_date: 2004-11-06 20:20:05
@_author: Peter Gutmann 
@_subject: In a Sky Dark With Arrows, Death Rained Down 
That's the traditional Agincourt interpretation.  More modern ones (backed up
by actual tests with arrows of the time against armour, in which the
relatively soft metal of the arrows was rather ineffective against the armour)
tend to favour the muddy ground trapping men and horses, lack of room to
manoeuver/compression effects, and arrows killing horses out from under the
knights, at which point see the muddy ground section.  Obviously the machine-
gun effect of the arrows was going to cause a number of minor injuries, and
would be lethal to unarmoured troops, but they weren't quite the wonder-weapon
they're made out to be.
(There were other problems as well, e.g. the unusually high death toll and
 removal of "ancient aristocratic lineages" was caused by English commoners
 who weren't aware of the tradition of capturing opposing nobles and having
 them ransomed back, rather than hacking them to pieces on the spot.  Again,
 arrows didn't have much to do with the loss of so many nobles).

@_date: 2004-11-08 16:12:53
@_author: Peter Gutmann 
@_subject: In a Sky Dark With Arrows, Death Rained Down 
Normally I'd dig up various refs, but since this topic has been beaten to
death repeatedly in places like soc.history.medieval, and the debate could
well go on endlessly in the manner of the standard "What would have happened
if the North/South had done X?", I'll just handwave and invite you to dig up
whatever sources you feel like yourself.
Nobles expected to surrender to other nobles and be ransomed.  Commoners
didn't respect this, and almost never took prisoners.  Henry's orders didn't
make that much difference, at best they were a "we'll turn a blind eye"
notification to his troops.  When you have English commoner men-at-arms (front
row) meeting French nobles (front row, hoping to nab Henry and other for-
ransom nobles, and to some extent because it was unseemly to let the commoners
do the fighting, although they should have learned their lesson for that at
Courtrai) there's going to be a bloodbath no matter what your leader orders.
For the peasants it's "get him before he gets me", not a chivalric jousting
match for the landed gentry.  In addition the enemy nobles had weapons and
armour that was worth something, while a ransom was useless to a non-noble (if
Bob the Archer did manage to captured Sir Fromage, his lord would grab him,
collect the ransom, and perhaps throw Bob a penny for his troubles).
(There's a lot more to it than that, but I really don't want to get into an
 endless debate over this.  Take it to soc.history if you must, and if
 anyone's still interested in debating this there).

@_date: 2004-11-08 18:47:55
@_author: Peter Gutmann 
@_subject: In a Sky Dark With Arrows, Death Rained Down 
As I said in my previous message, this is the topic of endless debate, and in
particular the high death toll among the nobles could arisen from any number
of causes.  For example at Crecy the French king (Philip the something'th) had
the oriflamme (French war banner indicating that no prisoners could be taken)
displayed because he was worried that the gold-rush for enemy nobles to ransom
would screw up the French battle order, resulting in huge losses when the
French ended up at the losing end.  There's speculation that they did the same
thing at Agincourt, because no French chronicler of the time raised even a
murmur about the killings.  So something like that could have been just as
much the cause as any order given by Henry V to dispatch leftovers after the
battle (for example the mass slaughter of the first and second lines
("battles") of French, bogged down in mud (the battle was fought in a rain-
soaked freshly-ploughed field), by English commoners occurred very early in
the battle, while the killing of stragglers under Henry's orders didn't happen
until the following day, or the very end of the battle for prisoners).  If you
really want to continue this, please do it in soc.history medieval, there are
already thousand-odd-message threads going over every nuance of this.

@_date: 2004-11-11 16:24:22
@_author: Peter Gutmann 
@_subject: This Memorable Day 
You also had to look at what they were up against.  Witness the complete
massacre at Isandlwana (the classic Zulu bull-and-horns overran the
British camp because the troops were too far away from their ammunition
to resupply, no doubt copying Elphinstone's tactic in Afghanistan) vs.
post-Isandlwana use of Gatling batteries and massed field artillery (some of which was converted Naval artillery), e.g. Ulundi, where post-battle reports were of piles of Zulu dead mown down by Gatlings.
The British only thought that the Zulus were just semi-naked savages until Isandlwana.

@_date: 2004-11-12 21:08:18
@_author: Peter Gutmann 
@_subject: Cell Phone Jammer? 
Try the SH066PL, a nice portable that looks exactly like a cellphone, it's one
of the few portables I know of.
Google is your friend, there are tons of these around, with varying degrees of
sophistication.  These are definitely not portable, taking several amps at
6-12V to power them.
None of them are exactly cheap.

@_date: 2004-10-03 22:18:24
@_author: Peter Gutmann 
@_subject: Foreign Travelers Face Fingerprints and Jet Lag 
The US now has the dubious distinction of being more obnoxious to get through
the borders than the former East Germany (actually even without this measure,
the checks had become at least as obnoxious as the East German ones).  I
wonder whether the next step will be building a wall...
Peter (who'll be thinking really hard about any future conference trips to the
       US).

@_date: 2004-10-04 03:59:57
@_author: Peter Gutmann 
@_subject: Foreign Travelers Face Fingerprints and Jet Lag 
I never made any comment about who's keeping what in or out (the wall was
officially an anti-fascist protection barrier, also meant to keep out a
demonstrated threat).  What I was pointing out was that having been through
both East German and US border controls, the US ones were more obnoxious.

@_date: 2004-10-15 19:59:53
@_author: Peter Gutmann 
@_subject: Cash, Credit -- or Prints? 
I've seen a number of smart card/PCMCIA combo devices that to this, they have
a discrete fingerprint sensor device connected to a discrete crypto device.
You can fake out the fingerprint check portion by tying one of the connecting
lines to Vcc or GND.

@_date: 2004-10-15 21:13:46
@_author: Peter Gutmann 
@_subject: At least there's some (attempt at) common sense in airline 
Ease off says air security boss
Security on domestic flights is too strict and should be downgraded, says the
head of the Aviation Security Service.
General manager Mark Everitt, a former police detective with 21 years'
experience, said if he had his way passengers would be able to take Swiss Army
knives and other small, sharp objects on board domestic flights.
"I'm actually an advocate for letting these things back on the aircraft. It's
time to back up a little," he told delegates at the Police Association's
annual conference yesterday.
But New Zealand had to meet international security standards and his personal
view was not enough to instigate a review of security standards.
Knowing levels of risk was the key to ensuring flights were safe, said Mr
Everitt. The banning of small knives did not stop attacks in the air.

@_date: 2004-10-15 21:21:56
@_author: Peter Gutmann 
@_subject: Vote-counting glitch in NZ local elections 
Looks like you can mess up voting even if there is a paper trail.  These are
paper votes that are electronically counted, so the problem was in the
electronic processing, not the actual voting procedure.
Let me count the ways ...
An electronic processing and counting botch-up has left the results for seven
city and district councils and 18 district health boards up in the air. Final
results, due yesterday, have been delayed indefinitely.
Mr Carter blamed the company Datamail, which was contracted by Electionz.com -
the company hired by many councils to manage their elections - to count the
votes from electronically scanned voting papers.

@_date: 2004-10-28 16:08:57
@_author: Peter Gutmann 
@_subject: Cyclotrimethylene trinitramine 
It's not all too hard to make from hexamine (although quite inefficient,
the bulk manufacture isn't done that way) for someone with access to a bit of chemical equipment.  I couldn't believe the fuss they're making over this, it's just another HE, although more brisant than most.  The story is about as interesting as "Stick of dynamite discovered in Baghdad parking lot", the media is making it sound like someone's absconded with a live nuke.  I guess they couldn't spend the necessary
30 seconds or so it'd take to look it up somewhere and see what was

@_date: 2004-09-14 06:59:28
@_author: Peter Gutmann 
@_subject: "Forest Fire" responsible for a 2.5mi *mushroom cloud*? 
4,500 tons, of which only 10% detonated.
(The nitrate was desensitised with ammonium sulfate and stored outside,
whenever anyone needed any they'd drill holes and blast off chunks with
dynamite.  Ammonium nitrate has a complex chemical reaction that wasn't really
understood until after the Texas City disaster in 1947, there had previously
been fires in several bulk ammonium nitrate stores without any explosions.  At
Oppau it was assumed that amatol (a standard military explosive, ammonium
nitrate + TNT) had somehow got into the piles and that was what caused the

@_date: 2004-09-14 07:29:15
@_author: Peter Gutmann 
@_subject: "Forest Fire" responsible for a 2.5mi *mushroom cloud*? 
The largest man-made explosion is usually claimed to be Halifax (about 3000
tons of assorted HE's), but there are a pile of others that also count: Oppau,
Texas City, Port Chicago, Lake Denmark, Silvertown, Fauld (more explosives
involved than Halifax, but less loss of life, so Halifax seems to get all the
publicity), etc etc etc.

@_date: 2004-09-14 10:10:25
@_author: Peter Gutmann 
@_subject: "Forest Fire" responsible for a 2.5mi *mushroom cloud*? 
No, it was specifically required as a desensitiser by the European nitrogen
cartel, since they felt the pure nitrate was too dangerous for processing into
As I said, at the time its explosive properties weren't known so this wasn't
unreasonable.  There are numerous stories of multi-thousand-ton ammonium
nitrate piles burning for hours without exploding (Oppau was the first time
there was any significant explosion involving it).  Even after Texas City,
there were cases of (embarrassed) firefighters watching warehouses full of
ammonium nitrate quietly burn to the ground without incident.

@_date: 2005-02-03 17:53:22
@_author: Peter Gutmann 
@_subject: Dell to Add Security Chip to PCs 
Neither.  Currently they've typically been smart-card cores glued to the MB and accessed via I2C/SMB.

@_date: 2005-02-05 00:47:58
@_author: Peter Gutmann 
@_subject: Dell to Add Security Chip to PCs 
A simple crypto device controlled by the same software is only slightly less
nonsensical.  That is, the difference between software-controlled keys and a
device controlling the keys that does anything the software tells it to is
negligible.  To get any real security you need to add a trusted display, I/O
system, clock, and complete crypto message-processing capability (not just
"generate a signature" like the current generation of smart cards do), and
that's a long way removed from what TCPA gives you.
Yes he will.  That is, he may not really need to do it, but he really, really
wants to do it.  Look at the almost-universal use of PKCS  to allow people
to spread their keys around all over the place - any product aimed at a mass-
market audience that prevents key moving is pretty much dead in the water.
The only effective thing a TCPA chip gives you is a built-in dongle on every
PC.  Whether having a ready-made dongle hardwired into every PC is a good or
bad thing depends on the user (that is, the software vendor using the TCPA
device, not the PC user).

@_date: 2005-02-16 18:38:20
@_author: Peter Gutmann 
@_subject: How to Stop Junk E-Mail: Charge for the Stamp 
And the spammers will be using everyone else's PC's to send out their spam, so
the spam problem will still be as bad as ever but now Joe Sixpack will be
paying to send it.
Hmmm, and maybe *that* will finally motivate software companies, end users,
ISPs, etc etc, to fix up software, systems, and usage habits to prevent this.

@_date: 2005-02-23 20:53:25
@_author: Peter Gutmann 
@_subject: On the road to truth and madness 
The following was my variant on this from a few years ago, representing the
56th IETF PKIX meeting minutes.  Note that this is from the book form, not the
film version of the text:

@_date: 2005-02-24 02:29:46
@_author: Peter Gutmann 
@_subject: I'll show you mine if you show me, er, mine 
"R.A. Hettinga"  forwarded:
Isn't this a Crypto 101 mutual authentication mechanism (or at least a
somewhat broken reinvention of such)?  If the exchange to prove knowledge of
the PW has already been performed, why does A need to send the PW to B in the
last step?  You either use timestamps to prove freshness or add an extra
message to exchange a nonce and then there's no need to send the PW.  Also in
the above B is acting as an oracle for password-guessing attacks, so you don't
send back the decrypted text but a recognisable-by-A encrypted response, or
garbage if you can't decrypt it, taking care to take the same time whether you
get a valid or invalid message to avoid timing attacks.  Blah blah Kerberos
blah blah done twenty years ago blah blah a'om bomb blah blah.
(Either this is a really bad idea or the details have been mangled by the

@_date: 2005-01-12 05:00:29
@_author: Peter Gutmann 
@_subject: Simson Garfinkel analyses Skype - Open Society Institute 
There have been other posts about this in the past, even though they use
algorithms the way they use them is completely homebrew and horribly
Raw, unpadded RSA, no message authentication, no key verification, no replay
protection, etc etc etc.  It's pretty much a textbook example of the problems
covered in the writeup I did on security issues in homebrew VPNs last year.
(Having said that, the P2P portion of Skype is quite nice, it's just the
 security area that's lacking.  Since the developers are P2P people, that's
 somewhat understandable).

@_date: 2005-07-12 00:56:35
@_author: Peter Gutmann 
@_subject: Looking for crypto iButton specs 
During a recent discussion about secure crypto device bootstrap and
attestation capabilities, I realised that of the three devices for which this
was implemented and for which documentation was available (Fortezza, IBM 4758,
and Dallas Crypto iButton), I either don't have any documentation for the
Crypto iButton or I've filed it under something sufficiently misleading that I
can't find it any more.  So:
Does anyone still have the documentation for the DS1954 Crypto iButton?  Note
that I specifically mean the DS1954 Crypto iButton before its Javafuxation,
which removed the very nice crypto security model and crypto transaction
processing/scripting capability.  Dallas systematically excised any traces of
the pre-Javafuxated version from databooks and web pages, so it'd be a case of
someone having a copy archived somewhere.  It was a very nice design and I'd
like to have some record of it outside the summary I put in my Godzilla
security tutorial.
(If whoever did the design is reading this, I'd be interested in hearing from
them as well).

@_date: 2005-06-03 20:25:32
@_author: Peter Gutmann 
@_subject: SPKI Certs Usage 
They were never really used.  The great feature of SPKI is that it's not X.509
(so it's a design fit for a purpose rather than being digital ancestor-
worship of failed OSI standards from the 1980s).  The great failing of SPKI is
that it's not X.509 (it's impossible to get any cert mechanism accepted unless
it's called X.509).

@_date: 2005-06-09 21:37:13
@_author: Peter Gutmann 
@_subject: Intel Adds DRM to New Chips part 2 
No, it's very careful to say that there is no *unannounced* DRM in their
chips, in the same way that we have had no undetected penetrations of our

@_date: 2005-06-09 22:13:10
@_author: Peter Gutmann 
@_subject: Checkbox security 
Man With Chain Saw Allowed to Enter U.S.
  On April 25, Gregory Despres arrived at the U.S.-Canadian border crossing at
  Calais, Maine, carrying a homemade sword, a hatchet, a knife, brass knuckles
  and a chain saw stained with what appeared to be blood. U.S. customs agents
  confiscated the weapons and fingerprinted Despres. Then they let him into
  the United States.
I guess he wasn't on the (possibly-a-)terrorist watchlist so they waved him

@_date: 2005-06-12 13:26:16
@_author: Peter Gutmann 
@_subject: Neat security quote 
US is describing going through the US immigation procedure.  His comment on
the fingerprinting process:
  I waited at that moment for messages like "freedom is slavery"
The response:
  "Ignorance is strength" already seems to have been adopted...
Peter :-).

@_date: 2005-11-14 21:13:33
@_author: Peter Gutmann 
@_subject: How broad is the SPEKE patent. 
My computers have no undetected spyware and Trojan horses.

@_date: 2005-10-15 19:39:02
@_author: Peter Gutmann 
@_subject: TEMPEST PC for sale on ebay 
May possibly run a very cut-down version of Linux, otherwise you'd be stuck
with DOS.

@_date: 2005-10-28 21:11:36
@_author: Peter Gutmann 
@_subject: Any comments on BlueGem's LocalSSL? 
claims that they can encrypt data from the
keyboard to the web browser, bypassing trojans and sniffers, however the web
pages are completely lacking in any detail on what they're actually doing.
solution that consists of some sort of (Win9x/Win2K/XP only) low-level
keyboard driver interface that bypasses the standard Windows user-level
interface and sends keystrokes directly to the application, in the same way
that a number of OTFE packages directly access the keyboard driver to try and
evade sniffers.
The West Coast Labs tests report that they successfully evade all known
sniffers, which doesn't actually mean much since all it proves is that
LocalSSL is sufficiently 0-day that none of the sniffers target it yet.  The
use of SSL to get the keystrokes from the driver to the target app seems
somewhat silly, if sniffers don't know about LocalSSL then there's no need to
encrypt the data, and once they do know about it then the encryption won't
help, they'll just dive in before the encryption happens.
Anyone else have any additional information/comments about this?

@_date: 2005-10-31 20:17:40
@_author: Peter Gutmann 
@_subject: Multiple passports? 
Ahh, but if you get one of the first passports issued then there are likely to
still be some teething problems present, leading to sporadic failures of the
first batch of RFID devices.  I have a funny feeling that this is going to
happen to my new passport when it arrives.

@_date: 2006-04-17 03:22:21
@_author: Peter Gutmann 
@_subject: [Clips] Letting the IRS Do Your Taxes for You 
"R.A. Hettinga"  forwarded:
Some countries have been doing it this way for years.  For most wage-earners
all you get is a year-end statement from the tax department telling you how
much you owe or will get back, and that's it.  Saves both the tax people and
the masses a lot of unnecessary work (and since the US 1040 form is the most
horrific tax form of any country I've ever seen, it'd save even more work
there).  The only people who then still need to manually submit paperwork are
ones with irregular incomes, if you've made a tax-free donation, or there's
some other irregularity not handled by the automated system.

@_date: 2006-08-12 07:11:06
@_author: Peter Gutmann 
@_subject: Collecting entropy in headless systems 
I've had a quick look, it just reads something like the Pentium TSC in
a loop and, if the delta is more than a certain value, decides that an
interrupt has occurred and takes the result as a new entropy value.
There's a lot of handwaving, and some more stuff involving (hopefully)
the nondeterminism resulting from a CPU cache-thrashing algorithm.  It's
just another in a long series of cool-but-unverifiable ideas for
gathering info from a CPU, the first being the clock-skew mechanism from
the early 1990s (time a fast clock using a slow clock, this predates
the Pentium so the original version used a fast loop sampled from the
18.2 Hz PC clock).  If you really want do go down this path, use Matt
Blaze's TrueRand, circa 1995 (and unpatented).

@_date: 2006-08-29 16:10:03
@_author: Peter Gutmann 
@_subject: Making sausage 
I was just reading Richard Clarke's book and the following quote (from Bill
Clinton) sort of stood out:
  "I want to announce new airline security measures while I'm at Kennedy.  So
  develop some" (p.123).
OK, I assume this way of developing airline security measures comes as no
surprise to anyone on this list, but it's interesting to hear it confirmed
from the highest levels.

@_date: 2006-12-21 20:52:25
@_author: Peter Gutmann 
@_subject: A Cost Analysis of Windows Vista Content Protection 
A Cost Analysis of Windows Vista Content Protection
           ===================================================
                Peter Gutmann, pgut001 at cs.auckland.ac.nz
                              Last updated 21 December 2006
Executive Summary
The Vista Content Protection specification could very well constitute the
longest suicide note in history.
This document looks purely at the cost of the technical portions of Vista's
content protection.  The political issues (under the heading of DRM) have been
examined in exhaustive detail elsewhere and won't be commented on further,
unless it's relevant to the cost analysis.  However, one important point that
must be kept in mind when reading this document is that in order to work,
Vista's content protection must be able to violate the laws of physics,
something that's unlikely to happen no matter how much the content industry
wishes it were possible.  This conundrum is displayed over and over again in
the Windows content-protection specs, with manufacturers being given no hard-
and-fast guidelines but instead being instructed that they need to display as
much dedication as possible to the party line.  The documentation is peppered
with sentences like:
  "It is recommended that a graphics manufacturer go beyond the strict letter
  of the specification and provide additional content-protection features,
  because this demonstrates their strong intent to protect premium content".
This is an exceedingly strange way to write technical specifications, but is
dictated by the fact that what the spec is trying to achieve is fundamentally
impossible.  Readers should keep this requirement to display appropriate
levels of dedication in mind when reading the following analysis [Note A].
Disabling of Functionality
Alongside the all-or-nothing approach of disabling output, Vista requires that
any interface that provides high-quality output degrade the signal quality
that passes through it.  This is done through a "constrictor" that downgrades
the signal to a much lower-quality one, then up-scales it again back to the
original spec, but with a significant loss in quality.  So if you're using an
expensive new LCD display fed from a high-quality DVI signal on your video
card and there's protected content present, the picture you're going to see
will be, as the spec puts it, "slightly fuzzy", a bit like a 10-year-old CRT
monitor that you picked up for $2 at a yard sale.  In fact the spec
specifically still allows for old VGA analog outputs, but even that's only
because disallowing them would upset too many existing owners of analog
monitors.  In the future even analog VGA output will probably have to be
disabled.  The only thing that seems to be explicitly allowed is the extremely
low-quality TV-out, provided that Macrovision is applied to it.
The same deliberate degrading of playback quality applies to audio, with the
audio being downgraded to sound (from the spec) "fuzzy with less detail".
Amusingly, the Vista content protection docs say that it'll be left to
graphics chip manufacturers to differentiate their product based on
(deliberately degraded) video quality.  This seems a bit like breaking the
legs of Olympic athletes and then rating them based on how fast they can
hobble on crutches.
Elimination of Open-source Hardware Support
Vista includes various requirements for "robustness" in which the content
industry, through "hardware robustness rules", dictates design requirements to
hardware manufacturers.  For example, only certain layouts of a board are
allowed in order to make it harder for outsiders to access parts of the board.
Possibly for the first time ever, computer design is being dictated not by
electronic design rules, physical layout requirements, and thermal issues, but
by the wishes of the content industry. Apart from the massive headache that
this poses to device manufacturers, it also imposes additional increased costs
beyond the ones incurred simply by having to lay out board designs in a
suboptimal manner.  Video card manufacturers typically produce a one-size-
fits-all design (often a minimally-altered copy of the chipset vendor's
reference design), and then populate different classes and price levels of
cards in different ways.  For example a low-end card will have low-cost,
minimal or absent TV-out encoders, DVI circuitry, RAMDACs, and various other
add-ons used to differentiate budget from premium video cards. You can see
this on the cheaper cards by observing the unpopulated bond pads on circuit
boards, and gamers and the like will be familiar with cut-a-trace/resolder-a-
resistor sidegrades of video cards. Vista's content-protection requirements
eliminate this one-size-fits-all design, banning the use of separate TV-out
encoders, DVI circuitry, RAMDACs, and other discretionary add-ons.  Everything
has to be custom-designed and laid out so that there are no unnecessary
accessible signal links on the board.  This means that a low-cost card isn't
just a high-cost card with components omitted, and conversely a high-cost card
isn't just a low-cost card with additional discretionary components added,
each one has to be a completely custom design created to ensure that no signal
on the board is accessible.
This extends beyond simple board design all the way down to chip design.
Instead of adding an external DVI chip, it now has to be integrated into the
graphics chip, along with any other functionality normally supplied by an
external chip.  So instead of varying video card cost based on optional
components, the chipset vendor now has to integrate everything into a one-
size-fits-all premium-featured graphics chip, even if all the user wants is a
budget card for their kids' PC.
Increased Cost due to Requirement to License Unnecessary Third-party IP

@_date: 2006-02-28 06:01:11
@_author: Peter Gutmann 
@_subject: A New Class of Unsafe Primes 
The IACR ePrint archive contains a paper from 2002 titled "A New Class of
Unsafe Primes",  which proposes a fast way to
find a prime factor p of an integer n when 4p - 1 has the form db^2, where d =
{ 3, 11, 19, 43, 67, 163 }.  I haven't been able to find any references to
this anywhere, is this something like the p +/- 1 factoring methods where the
values they're effective against are so unlikely that they can be safely
ignored, or is it just that no-one's ever noticed this paper?

@_date: 2006-01-02 03:12:31
@_author: Peter Gutmann 
@_subject: Detect Spying on YOU 
And remember that if you don't succeed at this, you run the risk of failure.

@_date: 2006-01-15 19:04:46
@_author: Peter Gutmann 
@_subject: Echelon papers leaked 
In 1996, New Zealander Nicky Hager wrote a book "Secret Power" containing a
great deal of information on Echelon, with a particular NZ perspective.  A
days ago, papers held by the Prime Minister of the time were accidentally
released and appeared in the Sunday Star Times.  Some quotes from the story
  The top-secret intelligence report found among David Lange's papers shows
  New Zealand had been spying on friendly countries throughout the region.
  Targets included Japanese and Philippines diplomatic cables and the
  government communications of Fiji, the Solomons, Tonga and "international
  organisations operating in the Pacific".
  The Government Communications Security Bureau's 1985/86 annual report also
  reveals that one of New Zealand's main targets was "UN diplomatic" cables,
  but which agencies of the United Nations were targeted is not stated.
  [...]
  "A total of 171 reports were published, covering the Solomons, Fiji, Tonga
  and international organisations operating in the Pacific. The raw traffic
  for this reporting provided by NSA the US National Security Agency)."
  The GCSB also produced 238 intelligence reports on Japanese diplomatic
  cables, using "raw traffic from GCHQ/NSA sources". This was down from the
  previous year: "The Japanese government implementation of a new high grade
  cypher system seriously reduced the bureau's output." For French government
  communications, the GCSB "relied heavily on (British) GCHQ acquisition and
  forwarding of French Pacific satellite intercept".
  [...]
  Each page of the 31-page report that mentioned eavesdropping operations was
  headed "TOP SECRET UMBRA HANDLE VIA COMINT CHANNELS ONLY". COMINT stands
  "communications intelligence".
There's also a second story at
covering US pressure on NZ over its anti-nuclear policy.

@_date: 2006-01-28 20:24:49
@_author: Peter Gutmann 
@_subject: thoughts on one time pads 
For no adequately explored reason I've tried various ways of physically
destroying CDs:
- Hammer on hard surface: Leaves lots of little fragments, generally still
  together by the protective coating.
- Roasting over an open fire: Produces a Salvador Dali effect until they
  fire, then huge amounts of toxic smoke ("fulfilling our carbon tax quota"
  was one comment) and equally toxic-looking residue.
- Propane torch: Melts them without producing combustion products.
- Skilsaw: Melts them together at the cutting point, rest undamaged.
- Axe: Like skilsaw but without the melting effect.
- Using the propane torch and hammer to try and drop-forge a crude double-
  density CD: Messy.

@_date: 2006-03-15 15:04:59
@_author: Peter Gutmann 
@_subject: Please DO NOT refer to our High Gain Omni Directional as 
Since BATON is a Type I algorithm, it'd hardly be unclassified.

@_date: 2006-03-16 14:41:44
@_author: Peter Gutmann 
@_subject: speaking of weak primes, weak exponents? 
I've also posted this to sci.crypt to see if anyone there had any comments,
both Tom St.Denis (a regular contributor and author of libtomcrypt) and David
Wagner (needs no introduction :-) comment that the chance of a random 512-bit
prime having this form is about 1/2^250, so it's not worth checking for.  See
the sci.crypt thread for more info.

@_date: 2006-05-07 21:21:04
@_author: Peter Gutmann 
@_subject: Free and Open Source Software-Choices and responsibilities. 
Does anyone know more about what Coverity does?  Their web site basically says
"Give is bucketloads of money and we'll talk to you under NDA", but their
"Products" link is broken, and even then it's hard to tell whether they just
run ITS4 and filter the results (OK, it's a spinoff from the MC Checker work
so it's more sophisticated than that, but having to sign an NDA just to find
out what it is they do seems rather counter to the academic origins of the

@_date: 2006-09-09 16:10:54
@_author: Peter Gutmann 
@_subject: Trusted Computing in Vista BitLocker 
I'm sorry, you seem to have confused cypherpunks with Slashdot.  Bailiff,
please remove the gentleman from the room.  Objection overruled.

@_date: 2007-01-09 21:20:37
@_author: Peter Gutmann 
@_subject: Looking for AACS CRL files 
Is there anyone who can send me zipped copies of (at least) two different
CONTENT_REVOCATION_LIST.AACS files from HD-DVDs?  Please send me a separate
notification message first in case the AACS files get eaten by spam filters.
Peter ("I ask merely for information").

@_date: 2007-07-12 00:03:36
@_author: Peter Gutmann 
@_subject: Want to be a computer scientist? Forget maths 
Now name someone who isn't a maths geek at a University who proves algorithmic
correctness as part of their work.

@_date: 2007-06-22 17:05:55
@_author: Peter Gutmann 
@_subject: U.S. Eyes Antiterror Rules for Small Jets and Boats 
That's where the light is at the moment, so they're looking there.  DHS
insiders have told me that the next target is going to be pancakes.  And after
that, people who own dogs whose names begin with 'B'.  After that, who knows.

@_date: 2007-10-25 03:35:30
@_author: pgut001 at cs.auckland.ac.nz 
@_subject: World-first technology combines payment card and  
References: "R.A. Hettinga"  forwards:
Wow, someone's reinvented the Super Smart Card, circa 1989.

@_date: 2008-04-02 02:22:48
@_author: Peter Gutmann 
@_subject: Fwd: [gsc] eBay Sick of Whole "Internet" Thing 
"R.A. Hettinga"  forwarded:
It makes some sense, they're trying to prevent reputation capital markets,
specifically scammers buying themselves positive feedback.  Of course the
measure they've chosen seems a bit heavy-handed...

@_date: 2008-04-04 00:02:07
@_author: Peter Gutmann 
@_subject: Recent results with reduced-round SHA-256 
Analysis of Step-Reduced SHA-256, Collisions and other Non-Random Properties for Step-Reduced SHA-256,
  Attacking Reduced Round SHA-256, Very brief summary: Attacks are feasible against just over 1/3 of the 64
rounds (meaning if you reduce SHA-256 to 23 or 24 rounds, it's vulnerable).
That number is slowly creeping upwards.

@_date: 2008-08-18 15:58:25
@_author: Peter Gutmann 
@_subject: Kiwi expert cracks chip passport 
The original story was actually the coverage in the UK Times last week,
  It was a
three-person effort, Adam Laurie did the RFID part (via RFIDIOt), Jeroen van
Beek did the passport software implementation and tying the whole thing
together, all I did was the signing.  We never touched the passport chip, what
we showed was that it's possible to create your own fictitious e-passport
that's accepted as valid by the reference Golden Reader Tool.  In other words
we showed that what security researchers had been warning about ever since e-
passports were first proposed was actually possible, following the l0pht's
motto "Making the theoretical practical".  Jeroen presented the work at Black
Ugh, no, make it go away.
(Alert readers may notice the anomaly with the carefully-placed monitor right
behind my head, which is displaying something slightly different from the
surrounding sea of Vista desktops :-).  It's actually a file photo from a news
story from the start of last year about Vista).

@_date: 2008-01-12 23:38:06
@_author: Peter Gutmann 
@_subject: Storm, Nugache lead dangerous new botnet barrage 
Enterprise DRM for the botnet.
(Alternatively, "because they can".  They're not paying for the overhead, it
doesn't really make much sense not to encrypt everything).

@_date: 2008-01-13 16:54:56
@_author: Peter Gutmann 
@_subject: Storm, Nugache lead dangerous new botnet barrage 
If you ever find users who do this, could you send them my way? :-).
There may be some reference user somewhere in a display case who does this,
but in practice unless the computer explodes in front of them no-one ever
reacts to infection.  I've seen users whose laptop fans are running
continuously because the CPU is pegged at 100% by malware not have any idea
that this isn't a normal state of affairs.  I've seen users who patiently wait
something like 30 seconds for an Explorer window to open because that's just
how long Windows takes.  I've seen users whose PCs page themselves to death
every time they start an app, and that's quite normal.  I've seen attack ships
on fire off the shoulder of Orion...
More importantly, the sort of people who are likely to have machines riddled
with malware are the same ones who aren't likely to have any idea that
anything's wrong.  Bill Cheswick has a neat talk "Windows OK" in which he
describes his dad patiently using his malware-infested PC that nicely
illustrates this.
So you reduce it from 1M nodes to 900,000 nodes, that's not much of a loss.
The benefit you get from making it hard(er) to intercept and disrupt more than
covers it.

@_date: 2008-01-14 01:28:27
@_author: Peter Gutmann 
@_subject: Storm, Nugache lead dangerous new botnet barrage 
It doesn't have much effect on passive blocking, but what it stops (or at
least makes lot harder) is two things: Active attacks (penetration of botnet
servers by security people is a serious problem for the botherders, and I
assume competing botherders find this an easy target as well), and leeching of
botnet-collected data by others.  It's mostly back to enterprise DRM again.

@_date: 2008-10-21 20:16:41
@_author: Peter Gutmann 
@_subject: hard to top this bullshit 
Wow, this really is the myth that never dies, only the names of the
participants change.  This first cropped up in the mid-90s when it was being
used by unknown foreign agents (today these would automatically be "the
Chinese") to smuggle secrets out of US national labs, and every few years it
crops up again with a few names changed to keep it topical.  I'm surprised it
took this long for it to be Al Qaeda's turn.
Prediction for the future: At some point it'll be the turn of copyright
infringers/file sharers to be the subjects of this myth (if they haven't
already, and I missed it).

@_date: 2008-09-28 00:33:10
@_author: Peter Gutmann 
@_subject: [silk] Blackberry in India 
It could be almost anything.  Here's another scenario: government MIB's break into the targets house and illegally plant listening devices.  In order to explain where they got the information in court, they say they got it by decrypting Blackberry traffic via a process that's secret for notional security purposes.

@_date: 2009-04-21 21:55:41
@_author: Peter Gutmann 
@_subject: Brazilians hijack US military satellites 
The whole story's at:
it appears that Brazilians wanting to communicate on the cheap are using US
FLTSATCOM links to talk to each other.  This works because "the communication
channel was open, not encrypted, lots of people used it to talk to each other"
(later they talk about hearing encrypted military voice comms, so I assume
they mean that there's no access control, not necessarily encryption).
Truckers use it because you get better quality voice than with CB. Drug
dealers use it to coordinate operations, rogue loggers use it to warn of raids
by the authorities.  As the story says "Until [they get upgraded to use
crypto], the military is still using aging FLTSAT and UFO satellites - and so
are a lot of Brazilians".

@_date: 2009-10-17 17:57:44
@_author: Peter Gutmann 
@_subject: Why aren't known-plaintext attacks against digital media 
Which after compression turns into a handful of bytes, encoding (initially)
"big block of nothing" and then "same as before".
See above.

@_date: 2010-04-10 11:44:45
@_author: Peter Gutmann 
@_subject: Fwd: [ PRIVACY Forum ] Surveillance via bogus SSL 
Yes.  When your CA goes bankrupt its only significant asset is often the root CA cert(s) it owns, which get onsold to the highest bidder by the receivers. This has occurred numerous times in the past, and some roots have been onsold multiple times, since it's both a means of monetising the CA's remaining assets and (usually) the cheapest way for a new CA to get their own cert.
(I'm not sure whether the browser vendor will even know if it's been on-sold, or how the vendor is supposed to know unless the new owner volunteers the information.  Also you can't really "revoke" a root, and the browser vendors certainly can't do it, the best they can do is disable/remove it in the next

@_date: 2010-01-07 17:12:29
@_author: Peter Gutmann 
@_subject: [Fwd] NIST-certified USB Flash drives with hardware encryption 
Encrypting USB Flash memory from Kingston, SanDisk and Verbatim Vergrv_ern
Kingston, SanDisk and Verbatim all sell quite similar USB Flash drives with
AES 256-bit hardware encryption that supposedly meet the highest security
standards. This is emphasised by the FIPS 140-2 Level 2 certificate issued by
the US National Institute of Standards and Technology (NIST), which validates
the USB drives for use with sensitive government data. Security firm SySS,
however, has found that despite this it is relatively easy to access the
unencrypted data, even without the required password.
The real question, however, remains unanswered . how could USB Flash drives
that exhibit such a serious security hole be given one of the highest
certificates for crypto devices? Even more importantly, perhaps . what is the
value of a certification that fails to detect such holes?

@_date: 2010-01-08 12:48:55
@_author: Peter Gutmann 
@_subject: [Fwd] NIST-certified USB Flash drives with hardware 
It's not "have bugs", it's "failed to meet the silly-walk requirements set by
that lab".  The labs will always find at least one thing to nitpick (and
preferably several, even if it's just the punctuation in your paperwork [0]),
no matter how perfect your code, because to not do so would imply that they're
not doing their job.  In addition since the silly-walk changes arbitrarily
from one lab to another, the "bugs" found will be different for each lab.  If
you really don't want to make some required change (for example because it'd
mean re- architecting your entire product) then the easiest solution is to
jury-shop labs until you find one that waves you through.
As was recently pointed out on another list, it's very worthwhile from a
marketing perspective.  Doesn't guarantee much about security, but provides a
guarantee of sales to government agencies.  This is why the certification
costs for a company's product will often be taken from the marketing budget
rather than the engineering budget.
[0] This actually happened in one eval when they were really struggling to
    find anything to complain about.

@_date: 2010-07-13 03:58:51
@_author: Peter Gutmann 
@_subject: Intel to also add RNG 
You mean rampant paranoia from a small group of people... if you are genuinely
worried about this, just use it as another input to mix into your entropy pool
(which you should be doing anyway, never trust a single source of entropy).
I'd be quite happy to use the RNG on a Loongson CPU (if there was one) in this
manner, let alone an Intel CPU.
What killed it wasn't paranoia about Intel but their almost total lack of
interest in supporting it once the initial media attention waned.  This
doesn't look any different, note that it's not saying "This will be in Core2's
starting August" but "We've done this in the lab".

@_date: 2010-07-13 17:46:36
@_author: Peter Gutmann 
@_subject: Intel to also add RNG 
Do you have any more details on this?  Was it a hardware problem, software
problem, ...?  How was it caught?

@_date: 2010-07-14 17:04:31
@_author: Peter Gutmann 
@_subject: Intel to also add RNG 
A very small entity that (in its analog form) requires custom manufacturing
steps, is affected by every minor change to the material, the process, die
shrinks, you name it, and that most customers don't even know exists.  So you
need to rework, re-evaluate, and re-test it every time anything changes, and
your customer won't pay extra for it.
If you're Intel mgt I can't see this as being a very hard decision...

@_date: 2011-12-02 23:02:14
@_author: Peter Gutmann 
@_subject: [cryptography] really sub-CAs for MitM deep packet inspectors? 
It's not just a claim, I've seen them too.  For example I have a cert issued
for google.com from such a MITM proxy.  I was asked by the contributor not to
reveal any details on it because it contains the name and other info on the
intermediate CA that issued it, but it's a cert for google.com used for deep
packet inspection on a MITM proxy.  I also have a bunch of certs from private-
label CAs that chain directly up to big-name public CAs, there's no technical
measure I can see in them anywhere that would prevent them from issuing certs
under any name.
(An unfortunate effect of the private-label CAs is that they contain
identifying information on the organisation that uses them, something I hadn't
considered in my "post them to the list" request, and publishing them would
publicly out your employer or organisation as doing this.  So I'll modify my
"post to the list" to "email them to me in private" :-).
Given that some of the biggest CAs around sell private-label CA certs, you'd
end up shutting down half the Internet if you did so.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-03 01:00:14
@_author: Peter Gutmann 
@_subject: [cryptography] if MitM via sub-CA is going on, 
Private organisation.
I was asked not to reveal details and I won't, but in any case I don't know
whether it would achieve much.  For the case of a public CA doing it, you'd
see that CA X is involved, but since it's quite likely that CAs A...W and
Y...Z are also at the party, all it'd do is focus people's ire on one entity.
Also, if this is being done by a private organisation for DPI to secure their
corporate LAN then they're probably quite within their rights to do it.
I guess if you're running into this sort of thing for the first time then
you'd be out for blood, but if you've been aware of this it going on for more
than a decade then it's just business as usual for commercial PKI.  I'm
completely unfazed by it, it's pretty much what you'd expect.
Not on a corporate LAN.  IANAL but AFAIK your employer's allowed to run that
in whatever way they want.
For the cases where I've been involved I wasn't aware of there being anything
like this in the agreements (actually there probably was something somewhere,
I didn't look through all the paperwork).  I still have at least some of the
documentation stored somewhere (NB: Not under NDA and with the agreement of
the parties involved, it was an interesting case study on how these things
work), if I ever manage to dig it up I'll see what the conditions were.  In
any case though it was honour-system security, if you really wanted to do bad
things there weren't any controls that I could see to stop you.
I think this is where we differ in our outlook.  This (and yeah, I'd still
like to see the certs for one of these from a public location :-) is business
as usual for commercial PKI.  Remember the link to the SonicWall docs I posted
a few days ago,
 It's an advertised feature of the hardware (not just from SonicWall, other
vendors do it too), d'you think people are going to buy that and then not make
use of it?  So you just build your defences around the fact that it's broken
and then you won't run into problems.
Oh, another place where this happens is WAP gateways, where they MITM
everything so they can rewrite the content to save bandwidth and make things
work on mobile devices.  So, is that bad, or good, or both, or neither?
I think employees just need to be aware that a corporate LAN is owned by your
employer, and run for their benefit, not yours.  If you want to do
$non_work_related_whatever, do it from your home system.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-05 01:08:17
@_author: Peter Gutmann 
@_subject: [cryptography] really sub-CAs for MitM deep packet inspectors? 
For one example, see
and In general it looks like it's a mixture of "it's configurable" and "it depends
on the vendor" (the above only tells you what Bluecoat do).  Interesting to
note that the Bluecoat hardware has problems MITM-ing Windows Update, because
Microsoft apply the quite sensible measure of only allowing something signed
by a known Windows Update cert (or at least on a Microsoft-supplied trust
list), rather than any old cert that turns up as long as it's signed by some
CA somewhere.  I've heard of a similar approach proposed for smartphone mobile
banking apps, you hardcode in a cert that's used to verify a whitelist of
known-good certs for banks (more or less like Microsoft's CTLs), and then it
doesn't matter what certs the CAs sign because if it's not on the CTL then it
doesn't get trusted.
You're joking, right?
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-05 17:33:23
@_author: Peter Gutmann 
@_subject: From Facebook's Hackathon, TCP re-implemented over chat in 
I've implemented SMTP over TCP/IP over postcards.  Latency was a bit of a
pain, and packet loss was also an issue.
The fact that I'm terrible at dealing with snail mail didn't help either.

@_date: 2011-12-06 22:45:26
@_author: Peter Gutmann 
@_subject: [cryptography] really sub-CAs for MitM deep packet inspectors? 
Earlier in the discussion there were questions about why a service provider
would want to MITM their customers.  This has now been answered by a service
provider: It's to protect the chiiiiildren.  From
  Three's policy with regards to filtering is intended to ensure that children
  are protected from inappropriate content when using the internet on their
  phones [...] This is not about intercepting customer communications but is
  about the safety of children who use our network.
Note that while they're using Bluecoat hardware to do it, there's no mention
of SSL MITM'ing.
Another interesting point in the post:
  In addition I asked Three why they were wasting money on Bluecoat's services
  when any webmaster worth his salt knows how to tailor the webpage provided
  based on the IP address of the PC making the request. They could produce a
  page full of innocent images for Bluecoat when they come calling, but save
  all the unsavoury material for the .real. visitor.
This is already standard practice for malware-laden sites, to the extent that
it's severely affecting things like Google Safe Browsing and Facebook's link
scanner, because Google and Facebook always get to see benign content and only
the end user gets the malware.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-08 01:30:44
@_author: Peter Gutmann 
@_subject: [cryptography] Malware-signing certs with 512-bit keys 
[NB: Crossposted to two lists where this issue has been discussed in the past]
So it seems like pretty much everyone (at least on these lists) has heard
about the Malaysian CA that issued 512-bit certs for which the keys were
factored and used to sign malware, and that had their CA cert pulled because
of this.
What's had much less (in fact apparently zero) attention is the fact that
Digicert Sdn. Bhd. only issued three of the nine certificates that were used
for malware signing.  Three more were issued by Cybertrust, and one each by
GlobalSign, Taiwan-CA, and Anthem.  The first three are root CAs, Anthem is
one of the vast number of you'll-only-find-out-they-exist-when-they're-used-
to-attack-you sub-CAs that are out there.
Given that the Malaysian CA had its cert pulled for this, can we get a
statment from browser vendors on whether Cybertrust, GlobalSign, and the
others will also similarly have their certs pulled for exactly the same
A rather interesting feature of the malware signatures is that although the
issuers look like random unconnected CAs, if you look at the signatures that
the nine certs were used with, each of them ends up at the GTE Cybertrust (= Verizon, the last time I checked) root.  Using data from the mid-2010 dates
in question:
gives them a 0.11% market share, but they represent 100% of the roots used for
the malware signatures.  That just doesn't seem right.
Finally, there are even further 512-bit certs out there, some issued as
recently as a few months ago.  The A-Data one in the collection below was
reported to the CA but they haven't taken any action (do they get their cert
pulled as well for that?).  As the person who provided them commented, "so
knock yourself out, have the modulus factorized and sign some crazy code :-)".
Acknowledgements: Michael Sandee and Ondrej Mikle provided information for
this report.  Any inadvertent mangling of details was my fault.
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-09 17:27:32
@_author: Peter Gutmann 
@_subject: [cryptography] How are expired code-signing certs revoked? 
My post was based on data gathered by a well-known anti-malware company, I'm just reporting what they found in real-world use.
In any case getting signing certs really isn't hard at all.  I once managed it in under a minute (knowing which Google search term to enter to find caches of Zeus stolen keys helps :-).  That's as an outsider, if you're working inside the malware ecosystem you'd probably get them in bulk from whoever's dealing in them (single botnets have been reported with thousands of stolen keys and certs in their data stores, so it's not like the bad guys are going to run out of them in a hurry).
Unlike credit cards and bank accounts and whatnot we don't have price figures for stolen certs, but I suspect it's not that much.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-12-23 14:37:31
@_author: Peter Gutmann 
@_subject: Iran GPS Spoofing and the RSA Cipher 
Since when does GPS use RSA?  AFAIK the P(Y) encryption is straightforward
symmetric crypto.

@_date: 2011-07-28 17:58:07
@_author: Peter Gutmann 
@_subject: [cryptography] Military chip crypto cracked with power-analysis 
That's a really, really misleading tagline.  They've successfully attacked the bitstream encryption for Xilinx FPGAs, and while some of those are used by the military, they're also used in vast numbers of other things.  In addition recovering the bitstream doesn't help you break any crypto the military may have implemented in the FPGA.
I guess "Tamagotchi encryption cracked"[0] doesn't make as good a headline.
[0] Yeah, I know, technically they use an ASIC not an FPGA.  Insert the name     of some no-consequence FPGA-using toy here.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-06-03 01:53:43
@_author: Peter Gutmann 
@_subject: The Underground Website Where You Can Buy Any Drug 
Coming up next week, "The Bitcoin-based Child Porn Market".  And don't miss
our exciting future six-part series "The al-Qaeda/Bitcoin Connection".
  The sound of hoof beats 'cross the glade
  Good folk, lock up your son and daughter
  ...

@_date: 2011-03-22 01:32:11
@_author: Peter Gutmann 
@_subject: [cryptography] Another signature-scheme blunder 
Looks like Motorola made a similar mistake to Sony in their digital
The description is a bit confusing (did they really use Elgamal signatures
rather than, say, DSA?), but it's basically the same thing Sony did.  If they
used actual Elgamal sigs though they went even further than Sony, along with
rolling their own broken crypto implementation they also decided to go their
own way with the signature scheme they used.  As I've said a number of times
  In practice you don.t need to know all the gory details of encryption modes
  and IVs and other cryptoplumbing, you just need to make sure that you apply
  the right tool for the job.  The right tool for fixing a blocked drain is a
  plumber, and the right tool for dealing with problems requiring cryptography
  is a security library written by someone who knows what they.re doing.
Or to quote Bruce:
  "anyone who creates his or her own cryptographic primitives is either a
  genius or a fool.  Given the genius/fool ratio for out species, the odds
  aren't very good".
cryptography mailing list
cryptography at randombit.net

@_date: 2011-03-23 19:04:06
@_author: Peter Gutmann 
@_subject: [cryptography] Trusted CA compromised, 
Interesting post by Jacob Appelbaum on the compromise of a trusted CA that was
used to issue fraudulent certificates:
The discussion shows up (yet again) one of the (several) killer problems of
CRL/OCSP-style blacklisting, since you can only blacklist certs that you know
that a certificate vending machine has issued, there could be arbitrary
numbers of further certs out there that can't be revoked because the vending
machine doesn't know that it issued them.
cryptography mailing list
cryptography at randombit.net

@_date: 2011-03-26 17:34:22
@_author: Peter Gutmann 
@_subject: Iranian state-sponsored cyberwarfare is indistinguishable from 
Pretty much every news report I've seen so far that mentions any kind of
Iranian connection is claiming that it's Iranian state-sponsored hacking.  If
what's happened with the certs so far (someone grabbed a few sample certs for
high-profile domains, and there was a report of one of them briefly appearing
on a test server in Iran) is an indication of their competence then we really
have nothing to fear from them.
Let's look at what would have happened if *I'd* figured out a way to compromise a CA.  First, I'd get a few test certs issued for high-profile domains, Microsoft, Google, Yahoo, and perhaps a CA cert just for giggles.  Then I'd set up a server somewhere and install one of the sample certs to see whether any web browser noticed a problem.
Gosh, this sounds awfully like what actually happened.  New Zealand must have
a state-sponsored cyberwar program!  The only difference in my case is that
after a day or so of inviting security people to have a giggle at the test
server with my "genuine" cert, I'd notify the CA about the problem.  If I was
an Iranian script kiddie I probably wouldn't have much motivation to do that.
So what we have here is either (a) the world's most incompetent state-
sponsored cyberwar program, who get the keys to the kingdom and then have no
idea what to do with them, or (b) a bunch of script kiddies having fun.
What do you reckon the odds are?
(And in all this I haven't seen any mention of the Al Kai-yee-da angle.  What happened, is everyone asleep?).

@_date: 2011-03-29 14:22:30
@_author: Peter Gutmann 
@_subject: Iranian state-sponsored cyberwarfare is indistinguishable 
The original source of the info about the hack has now posted the private key
corresponding to one of the bogus certs at   The
public-key components are identical, haven't verified that the private key
matches yet, but I'm going to guess it will.
So a global CA wasn't 0wned by a nation-state cyberwar agency but by a random
script kiddie having some fun.  Oh the embarassment :-).

@_date: 2011-03-29 15:50:38
@_author: Peter Gutmann 
@_subject: Iranian state-sponsored cyberwarfare is indistinguishable 
For people who aren't following this via pastebin, to paraphrase Crocodile
Dundee, "you call that a successful CA attack?  *This*
 is a successful CA attack":
  "Here is another proof:   I uploaded
  JUST 1 table of their ENTIRE database which I own."
Looks like every Comodo account should now be regarded as compromised.  I
wonder if we'll finally see a CA cert pulled from a browser?  Or does the CA
have to behead someone live on Youtube before the browser vendors will act?

@_date: 2011-11-09 23:12:12
@_author: Peter Gutmann 
@_subject: [p2p-hackers] Verifying Claims of Full-Disk Encryption in 
Eugen Leitl  quotes Tom Ritter :
Without wanting to sound too facetious, and mostly out of curiosity, what does
FIPS 140 have to do with the threat modelling you've done?  It doesn't address
the vast majority of the stuff you've listed, so the threat-modelling is kind
of a non-sequitur to "starting with FIPS 140".  If you wanted to deal with
this through a certification process you'd have to go with something like the
CC (and an appropriate PP), assuming the sheer suckage of working with the CC
doesn't tear a hole in the fabric of space-time in the process.

@_date: 2011-09-07 14:40:57
@_author: Peter Gutmann 
@_subject: [cryptography] Diginotar broken arrow as a tour-de-force of PKI 
[Responding to the same three lists as before, please trim followups if you
 feel it's off-topic]
In response to my earlier "OCSP is unfixably broken, by design" comments, a
couple of people have responded off-list with variants of "OK smartypants, how
would you do it better?".  In order to provide a general answer (and avoid
fragmenting the discussion into lots of private-mail threads), I'll point to
  This addresses all the problems I've pointed out in OCSP, as well as things
OCSP never considered like performance issues (thus Verisign's security-
breaking OCSP "optimisations").  It's been peer-reviewed and vetted, and I
could have it re-posted in current draft format in a couple of days if there's
any interest in finally switching validity-checking to proper whitelists (and
fixing all of OCSP's other bugs).
Two notes:
1. This isn't a "get my pet protocol published", just a convenient means of
   pointing out that this problem has been well-known among security
   architects, thought about, and solutions designed, at least a decade ago.
2. You may notice the rather odd form of the draft, as an S/MIME work item.
   The reason why this was never published was because it proved impossible to
   get past PKIX because it wasn't blacklist-based and was therefore
   incompatible with CRLs.  The document starts in the late 1990s and mutates
   over time as I tried to work around PKIX' resistance to whitelist-based
   validity-checking.  After a couple of years of battling to get anything
   like this adopted I just gave up, as the "CMS" in the draft implies towards
   the end I was resorting to trying to launder it via the S/MIME working
   group to get it published.  I think it was when someone told me that it'd
   be referred back to PKIX for approval (as part of some IETF mechanism to
   prevent people doing end-runs around working groups as I was doing) that I
   realised it was never going to go anywhere.
Anyway, a solution exists, it's been implemented and in active use for at
least a decade, and I believe it fixes all of OCSP's numerous flaws as well as
ones that were never even considered in OCSP, such as performance implications
(in one test while looking at throughput I managed to - accidentally - DoS a
LAN with a single 300MHz PIII machine running this protocol.  Try doing that
with OCSP).
cryptography mailing list
cryptography at randombit.net

@_date: 2012-04-04 17:03:41
@_author: Peter Gutmann 
@_subject: [cryptography] World-class protracted social engineering [was: 
And Skype.  And SSL (as anon-DH opportunistic crypto).  And STARTTLS.
The defining characteristics of those two groups are that  is something that
business requirements dictate you have to use Or Else and that (typically)
some other poor guy sets up for you (or at least does the majority of the hard
work), and that  is completely transparent to the user.  Unfortuately the
latter group is anathema to crypto purists because none of the technologies
use [insert long list of security pixie dust here], which coincidentally is
also all of the stuff that makes the security tools too hard to use.
cryptography mailing list
cryptography at randombit.net

@_date: 2012-04-19 00:25:08
@_author: Peter Gutmann 
@_subject: [RISKS] Risks Digest 26.79 
Odd that that was still an issue, during the Auckland blackout in 1999 the
same thing happened, generators that were tested every six months and kept
topped up failed when they were run over a longer period because the fuel
level got down to the sludge at the bottom which got drawn into the generator.
I'd have thought they'd have taken steps do deal with this by now...

@_date: 2012-12-06 02:01:28
@_author: Peter Gutmann 
@_subject: Custom Chips Could Be the Shovels in a Bitcoin Gold Rush 
Eugen Leitl  forwards:
I guess the main lesson from this (well, the second lesson after the fact that
Extraordinary Popular Delusions needs a new chapter) is that if you're doing
password hashing, use anything but SHA-256.

@_date: 2012-12-06 12:35:29
@_author: Peter Gutmann 
@_subject: [liberationtech] /. ITU Approves Deep Packet Inspection 
Eugen Leitl  forwards:
Yes.  In the current climate if the ITU tried to standardise ponies, people
would find reasons why ponies are evil.

@_date: 2012-12-15 11:08:57
@_author: Peter Gutmann 
@_subject: btw, the itu imploded 
Eugen Leitl  quotes:
This remains me of a passage on journalism from the classic "How to be an
Alien" (cut down somewhat for size):
--- The Fact ---
There was some trouble with the Burburuk tribe in the Pacific Island,
Charamak. A party of ten English and two American soldiers, under the command
of Capt. R. L. A. T. W. Tilbury, raided the island and took 217 revolutionary,
native troublemakers prisoner and wrecked two large oil-dumps. The party
remained ashore an hour-and-a-half and returned to their base camp without
loss to themselves.
How to report this event? It depends on which newspaper you work for.
--- The Times ---
... It would be exceedingly perilous to overestimate the significance of the
raid, but it can be fairly proclaimed that it would be even more dangerous to
underestimate it. The success of the raid clearly proves that the native
defences are not invulnerable; it would be fallacious and deceptive, however,
to conclude that the defences are vulnerable. The number of revolutionaries
captured cannot be safely stated, but it seems likely that the number is well
over 216 but well under 218.
--- Evening Standard (Londoner's Diary) ---
The most interesting feature of the Charamak raid is the fact that Reggie
Tilbury is the fifth son of the Earl of Bayswater. He was an Oxford Blue, a
first-class cricketer and quite good at polo. When I talked to his wife (Lady
Clarisse, the daughter of Lord Elasson) at Claridges to-day, she wore a black
suit and a tiny block hat with a yellow feather in it. She said: "Reggie was
always very much interested in warfare." Later she remarked: "It was clever of
him, wasn't it?"
If you are the London correspondent of the American paper
--- The Oklahoma Sun ---
simply cable this:
    "Yanks Conquer Pacific Ocean"

@_date: 2012-02-11 19:05:59
@_author: Peter Gutmann 
@_subject: 30,000 Domestic Drones to Fill Our Skies, Civil Liberties 
Restrictions on shining laser pointers at aircraft only applies to piloted
craft, right?

@_date: 2012-02-27 02:52:06
@_author: Peter Gutmann 
@_subject: [cryptography] Diginotar summary 
The following is an attempt to gather all the information on the Diginotar
meltdown in one place.  There's references to external sources ("[REF...]")
and cross-links ("!!!!!!") which aren't present in the text, but apart from
that it should be pretty complete.  I've posted it here in case anyone finds
it useful, and if there's anything I've missed or that's incorrect, please let
me know.

@_date: 2012-01-21 01:52:01
@_author: Peter Gutmann 
@_subject: Megaupload.com seized 
Eugen Leitl  quotes:
Kim Schmitz (or whatever he's calling himself this week) is a survivor.
He'll be back, even if Megaupload isn't.

@_date: 2012-06-13 17:26:39
@_author: Peter Gutmann 
@_subject: [silk] Flame is Lame 
Eugen Leitl  quotes:
Yeah, because cryptographacamy is magic.  The exploit may have used 0day and
rootkits and ROP and stealth techniques and self-modifying code and who knows
what else, but any five-year-old can do that.  However, if there's any
cryptographi... cryptograma... magic involved then it had to have been done by
sikrit gummint agencies.
I'm not saying it was or it wasn't, but I am a bit disturbed at the level of
magical thinking that goes with anything involving crypto.  There have been
some pretty sophisticated attacks on crypto keys in embedded devices for
jailbreaking purposes that were done by enthusiastic amateurs, not even the
likes of (to pick some random examples of crypto people who've done this
before) David Wagner or Ed Felten or Markus Kuhn but just some random guys who
decided to give it a go.
Looked at another way, if you submitted a paper "Yet another chosen prefix attack on MD5" to Crypto/AsiaCrypt/Eurocrypt, do you think it'd get accepted?.  I'm not trying to denigrate the achievement, just to add a little perspective.

@_date: 2012-06-25 22:01:14
@_author: Peter Gutmann 
@_subject: [liberationtech] Single board mini computers as 
Eugen Leitl  quotes:
I like the Alix boards from PCEngines, they come with nice cases, don't have
the severe heat problems that many of the Arm-based boards do, and run
any standard x86 binaries.

@_date: 2012-11-16 23:55:18
@_author: Peter Gutmann 
@_subject: from somelist somewhere 
Well, that's the theory anyway.  In practice the browser crashed with a memory
corruption error after about the fourtieth tab was opened.

@_date: 2012-11-27 14:15:35
@_author: Peter Gutmann 
@_subject: [drone-list] US DoD Directive on Autonomy 
Eugen Leitl  forwards:
So the goal is the same as Orange book A1, but with a wider and scarier range
of attacks to defend against.  OK then.
When are the deliverables for this due?

@_date: 2012-10-25 12:21:56
@_author: Peter Gutmann 
@_subject: [cryptography] DKIM: Who cares? 
Steven Bellovin recently forwarded the following link to another list:
  In summary, it turns out that what seems like half the world's DKIM users are
using toy keys as short as 384 bits.  This isn't just Joe's Pizza and
Panelbeating, it's a worldwide who's-who of big-site DKIM users all using weak
keys.  Does anyone know why they all do this?  Since it's so widespread, my
guess is that the organisations involved don't really care about it and are
just going through the motions, "we're doing this for form's sake and because
not doing so would look bad, not because we believe it adds anything
cryptography mailing list
cryptography at randombit.net

@_date: 2013-08-15 12:49:16
@_author: Peter Gutmann 
@_subject: Switching power supplies 
Another thing about switchmode design is that unless it's pretty simple,
you're better off outsourcing it (meaning, get a pre-built one).  Back when
all you needed was a 78S40 and a few capacitors, resistors, and inductors it
was simple enough, but nowadays you can get a high-efficiency (90+% rather
than ~70%, look for one advertised as efficiency class V), over-voltage, over-
current, short-circuit protected power supply module for less than the cost of
the parts, it's really not worth doing yourself unless you need something
particularly exotic.
Cypherpunks assemble systems out of existing modules that someone else has
spent the time to develop and tune.

@_date: 2013-08-18 19:59:26
@_author: Peter Gutmann 
@_subject: see something, say something stamps 
On the remote chance that they'd even notice it, and the equally remote chance
that they'd bother threatening legal action, all you'd need to do is send a
link to the Wikipedia article on Streisand Effect and they'd go back to
pretending they didn't see it.
In any case since it's use in this case is for satirical purposes (IANAL), it
may be OK anyway.  I just want to get it on a t-shirt.

@_date: 2013-08-22 23:05:50
@_author: Peter Gutmann 
@_subject: [cryptography] urandom vs random 
Just appeared on the GnuPG list:
NeuG 0.11 was released.  NeuG is an implementation of True Random
Number Generator based on quantization error of ADC of STM32F103.
It is basically intended to be used as a part of Gnuk, but we also
have standalone USB CDC-ACM version (you can get random stream from
it's more when connected to USB 2.0 Hub.
The output is tested NIST STS 2.1.1 and Dieharder 3.31.1.
Highlights are:
* Replacement of kernel (thread library)
  Instead of ChibiOS/RT, we now use Chopstx.
* Improved performance
  The output of random numbers got faster than the previous
  implementation by 30% or so.
* Unsupported targets
  CQ_STARM, STBEE, STBEE Mini, and STM32_PRIMER2 are not
  supported in this release, but porting should be easy.
Here are some links for NeuG, Gnuk and FST-01 (the hardware).
NeuG (under Gnuk Repository):
    Gnuk News:
    FST-01 introduction:
    FST-01 Q&A site:
    Japanese Documentation for FST-01 and Gnuk Token:
    cryptography mailing list
cryptography at randombit.net

@_date: 2013-08-27 00:28:54
@_author: Peter Gutmann 
@_subject: [Cryptography] Implementations, attacks on DHTs, Mix Nets? 
For people who are interested, the list I have (for a year or two back) is:
"Security Considerations for Peer-to-Peer Distributed Hash Tables", Emil Sit
and Robert Morris, Proceedings of the 1st International Workshop on Peer-to-
Peer Systems (IPTPS'01), Springer-Verlag LNCS No.2429, March 2002, p.261.
"A Survey of Peer-to-Peer Security Issues", Dan Wallach, Proceedings of the
2002 International Symposium on Software Security (ISSS'02), Springer-Verlag
LNCS No.2609, November 2002, p.42.
"Eclipse Attacks on Overlay Networks: Threats and Defenses", Atul Singh,
Tsuen-Wan Ngan, Peter Druschel and Dan Wallach, Proceedings of the 25th
International Conference on Computer Communications (INFOCOM'06), April 2006,
"The Index Poisoning Attack in P2P File Sharing Systems", Jian Liang, Naoum
Naoumov and Keith Ross, Proceedings of the 25th Conference on Computer
Communications (INFOCOM'06), April 2006,
"Conducting and Optimizing Eclipse Attacks in the Kad Peer-to-Peer Network",
Michael Kohnen, Mike Leske and Erwin Rathgeb, Proceedings of the 8th IFIP-TC 6
Networking Conference (Networking'09), Springer-Verlag LNCS No.5550, May 2009,
"Combating Index Poisoning in P2P File Sharing", Lingli Deng, Yeping He and
Ziyao Xu, Proceedings of the 3rd Conference and Workshops on Advances in
Information Security and Assurance (ISA'09), Springer-Verlag LNCS No.5576,
June 2009, p.358.
"Hashing it out in public: Common failure modes of DHT-based anonymity
schemes", Andrew Tran, Nicholas Hopper and Yongdae Kim, Proceedings of the 8th
Workshop on Privacy in the Electronic Society (WPES'09), November 2009, p.71.
"Poisoning the Kad Network", Thomas Locher, David Mysicka, Stefan Schmid and
Roger Wattenhofer, Proceedings of the 11th International Conference on
Distributed Computing and Networking (ICDCN'10), Springer-Verlag LNCS No.5935,
January 2010, p.195.
If there's anything significant I've missed, feel free to fill in the gaps.
The cryptography mailing list
cryptography at metzdowd.com

@_date: 2013-12-02 22:34:54
@_author: Peter Gutmann 
@_subject: NSA: The Game 
For those of you familiar with the game Werewolf (also known as Mafia), here's
an updated version, NSA.

@_date: 2013-12-03 08:54:40
@_author: Peter Gutmann 
@_subject: NSA: The Game 
Yep, that would work too, I'll add it as an option.  Also, when it was playtested here some folks found it easier to identify as the more traditional "villagers" rather than "Internet users", although I think it should really be "Internet users".
I'll be in San Jose on the weekend of the 14th if anyone wants to play a round or two of NSA.

@_date: 2013-12-15 08:51:07
@_author: Peter Gutmann 
@_subject: BlueHat v13 crypto talks - request for leaks ;) 
ECC however has the downside that it's incredibly brittle.  For example
there's the scary tendency of DLP-based ops to leak the private key (or at
least key bits) if you get even the tiniest thing wrong.  For example if you
follow DSA's:
  k = G(t,KKEY) mod q
then you've leaked your x after a series of signatures, so you need to know that you generate a large-than-required value before reducing mod q.  The whole DLP family is just incredibly brittle, a problem that RSA doesn't have. I'm much more comfortable with RSA, there's far fewer things that can go

@_date: 2013-12-17 18:23:43
@_author: Peter Gutmann 
@_subject: BlueHat v13 crypto talks - request for leaks ;) 
Yes, this is one of several variations of subtle leak-the-private-key issues,
rather than the standard obvious-leak-the-private-key.  The code comment I've
got has, alongside other observations:
           The best reference for this is            probably "The Insecurity of the Digital Signature Algorithm with            Partially Known Nonces" by Phong Nguyen and Igor Shparlinski or            more recently Serge Vaudenay's "Evaluation Report on DSA"
Then there's tricks like:
   Suppose that the
   certificate contains a copy of the certificate signer's DSA parameters,
   and the verifier of the certificate has a copy of the signer's public key
   but not the signer's DSA parameters (which are shared with other keys).
   If the verifier uses the DSA parameters from the certificate along with
   the signer's public key to verify the signature on the certificate, then
   an attacker can create bogus certificates by choosing a random u and
   finding its inverse v modulo q (uv is congruent to 1 modulo q).  Then
   take the certificate signer's public key g^x and compute g' = (g^x)^u.
   Then g'^v = g^x.  Using the DSA parameters p, q, g', the signer's public
   key corresponds to the private key v, which the attacker knows.  The
   attacker can then create a bogus certificate, put parameters (p, q, g')
   in it, and sign it with the DSA private key v to create an apparently
   valid certificate.  This works with the DSA OID that makes p, q, and g
   unauthenticated public parameters and y the public key, but not the one
   that makes p, q, g, and y the public key
That's not leaking the private key, but it allows signature forgery via
another mechanism that's totally unrelated to "was the fundamental DSA
algorithm implemented correctly".  As I said, the DLP algorithms are really,
really brittle, you have to worry about all sorts of things that aren't a
concern with RSA.

@_date: 2013-12-22 09:58:49
@_author: Peter Gutmann 
@_subject: soft backdoors: ECDSA vs RSA vs EdDSA (aka EC Schnorr) (Re: 
It wasn't "some people", it was almost every implementation at the time.  When
the standard very clearly says "do, X, Y, Z" then everyone sits down and
implements X, Y, and Z exactly as written (well, except for professional
paranoids who build in extra safety margins :-).  So if it was deliberately
weakened then it was a very successful weakening.

@_date: 2013-02-19 04:07:11
@_author: Peter Gutmann 
@_subject: [cryptography] Which CA sells the most malware-signing certs? 
I've just done a quick tally of the certs posted to
 a.k.a. "Digital
Certificates Used by Malware".  Looks like Verisign (and its sub-brand Thawte)
are the malware-authors' CA of choice, selling more certs used to sign malware
than all other CAs combined.  GeoTrust comes second, and everything below that
is in the noise.  GoDaddy, the most popular CA, barely rates.  Other CAs
who've sold their certs to malware authors include ACNLB, Alpha SSL (which
isn't supposed to sell code-signing certificates at all as far as I can tell),
Certum, CyberTrust, DigiCert, GeoTrust, GlobalSign, GoDaddy, Thawte,
StarField, TrustCenter, VeriSign, and WoSign.  Everyone's favourite whipping-
boy CAs CNNIC and TurkTrust don't feature at all.
Caveats: These are malware certs submitted by volunteers, so they're not a
comprehensive sample.  The site tracks malware-signing certs and not criminal-
website certs, for which the stats could be quite different.
cryptography mailing list
cryptography at randombit.net

@_date: 2013-01-06 02:26:27
@_author: Peter Gutmann 
@_subject: [cryptography] Why anon-DH is less damaging than current browser 
In the light of yet another in an apparently neverending string of CA
failures, how long are browser vendors going to keep perpetuating this PKI
farce? [0].  Not only is there no recorded instance, anytime, anywhere, of a
browser certificate warning actually protecting users from harm [1], but the
blind faith that browsers place in certificates is actively harming users when
things fail, as they have again and again and again.
Users, or at least technical ones with enough knowledge to understand the
issues, have completely lost faith in browser PKI.  If you look at discussion
threads on technical forums [2], browser PKI is seen purely as something to
roll your eyes at, to make jokes about.  No-one (and as before that's with an
implied "who understands the details") has any faith in it any more.
The total inability and/or unwillingness of the browser vendors to respond to
this and provide real security measures that don't involve simply changing the
silly-walk they do with certificates and continuing as before is not only not
helping users in any way, it's actively harming them, and users are aware of
Browsers may as well turn off all their PKI-related code and just use anon-DH
for everything, which would be safer than the current false-sense-of-security
silly-walk they're doing, not to mention saving tens (hundreds?) of millions
of dollars paid to commercial CAs by sites wanting to disable the browser
Browser PKI costs a fortune to run, it doesn't protect users from anything the
attackers are doing, and at worst it actively endangers them.  If it was a
commercial good, RAPEX would have it withdrawn [3].
[0] I mean "farce" in its theatrical sense here, "unlikely, extravagant, and
improbable situations [...] highly incomprehensible plot-wise (due to the
large number of plot twists and random events that often occur) [...] Farce is
also characterized by [...] the use of deliberate absurdity or nonsense, and
broadly stylized performances" (from Wikipedia, which has a more detailed
definition than e.g. the OED).
[1] See "So Long, And No Thanks for the Externalities: The Rational Rejection
of Security Advice by Users", Cormac Herley.
[2] And I realise the likes of Slashdot aren't the best of them, but it's the
most accessible and has the most participants, so it's a quick way to gauge
public opinion.
[3] "RAPEX is the EU rapid alert system that facilitates the rapid exchange of
information between Member States and the Commission on measures taken to
prevent or restrict the marketing or use of products posing a serious risk to
the health and safety of consumers".
cryptography mailing list
cryptography at randombit.net

@_date: 2013-01-13 23:09:42
@_author: Peter Gutmann 
@_subject: [liberationtech] Tragic News: Aaron Swartz commits suicide 
Eugen Leitl  quotes:
There's a far more likely cause: Security geeks/hackers tend to be INTP/INTJ
MBTI personality types.  This personality type is far more susceptible to
depression than other types (see e.g. "Myers Briggs Type Indicator personality
profiles in unipolar depressed patients", David Janowsky, Elliot Hong, Shirley
Morter and Laura Howe, World Journal of Biological Psychiatry, Vol.3, No.4
(October 2002), p.207), as is the related Aspergers type (see e.g.
"Psychological Disorder in Adolescents and Adults with Asperger Syndrome",
Digby Tantam, Autism, Vol.4, No.1 (March 2000), p.47).  So it's not so much
the environment (any number of non-hacker environments are also not exactly
warm fuzzies and hugs), it's a straightforward mental health issue.

@_date: 2013-07-24 15:08:24
@_author: Peter Gutmann 
@_subject: Gnu PG is more Safe ? 
That should actually say "because GnuPG is open source, people assume that
someone else has extensively peer reviewed it and therefore assume that it's
safe and secure".  For example there was a long-standing RNG bug that was very
obvious if you looked at the code, but was only discovered by chance when
someone who was interested in the RNG happend to read through the code and
thought "hmm, surely that can't be right".  Having code that's open source
doesn't help at all if no-one looks at it.
Argh, no.  The best way to confuse someone is to get them to read an RFC. Find
a good book on the topic, e.g. for SSL/TLS there's Eric Rescorla's "SSL and
TLS: Designing and Building Secure Systems".  Before that, read "Network
Security: Private Communication in a Public World" by Kaufman et al.

@_date: 2013-07-24 16:10:54
@_author: Peter Gutmann 
@_subject: Gnu PG is more Safe ? 
cryptlib,  been
around for... well, longer than GPG has :-).

@_date: 2013-07-24 19:31:20
@_author: Peter Gutmann 
@_subject: Gnu PG is more Safe ? 
There's been a bunch of work done in this area, another one that springs to
mind is Coverity's scan reports.  The general conclusion from them is,
unsurprisingly, that being open source doesn't magically make you more secure.
You only find bugs (vulns) if someone looks for them, and a closed-source app
that's actively analysed for vulns (because the vendor pays employees to do
it) is going to be more secure than an open-source app that no-one looks at
because they're not motivated to.  In either case the ones with the highest
motivation to look are the attackers.

@_date: 2013-11-07 12:44:58
@_author: Peter Gutmann 
@_subject: latest Snowden docs show NSA intercepts all Google and Yahoo 
"Hi, my name's Bob, and I'm a villager".
I wonder if there's time to get custom Werewolf cards made up for the upcoming
Kiwicon (which starts tomorrow,  werewolves -> NSA,
seer -> Snowden, healer -> EFF.

@_date: 2013-11-12 12:28:04
@_author: Peter Gutmann 
@_subject: [cryptography] NIST Randomness Beacon 
You could do it with a physical one-way function.  Take a photo of the victim
on top of the WTC and you know that it can't have been occurred after 9/11. To
generalise it, photograph the victim in front of some documented object and
then destroy the object.  I'm assuming in the movie-plot scenario that someone
who's kidnapped a victim won't worry about blowing up a statue in a park or
performing whatever the physical one-way operation is.  Depending on how evil
your movie-plot villain is (and how convoluted the plot will get), he/she
could kill random strangers after photographing them with the victim, in order
to fix a point in time.

@_date: 2013-10-03 23:18:37
@_author: Peter Gutmann 
@_subject: USB Block Erupters as RNG sources? 
"Very little", and "no".  They're basically custom Bitcoin-mining ASICs, I
looked at one a while back for use in password-cracking and they're really not
suited for it at all, you load a vector in and say "go" but since they're
quite I/O-limited you can't easily adapt them for hash-breaking.  As for RNG
use, they're entirely deterministic, how would you use them as an RNG source?

@_date: 2013-10-04 13:15:48
@_author: Peter Gutmann 
@_subject: [cryptography] the spell is broken 
Just as a bit of a counterpoint here, how far do you want to go down this
rathole?  Someone recently pointed me to the latest CERT vuln. summary
(because of a few interesting entries there):
Now this is just a single weeks' worth, and yet look at all the remote-code-
execution and seize-control-of-device issues in just that seven-day stretch.
The NSA doesn't really need to backdoor crypto when the barn door isn't just
propped wide open, it's entirely missing in some cases.
(I completely support Jon's position in terms of being seen to do the right
thing, but there are more things to worry about than just backdoored crypto).
cryptography mailing list
cryptography at randombit.net

@_date: 2013-10-10 01:22:45
@_author: Peter Gutmann 
@_subject: NSA UTAH data center 
For people wanting more information, the Domestic Surveillance Directorate web
site ("The men and women who work for the Domestic Surveillance Directorate
are Americans first, last, and always. Each employee is required to take a
solemn oath to support and defend the United States against all enemies,
especially domestic") has the details:
Peter :-).

@_date: 2013-10-25 16:14:13
@_author: Peter Gutmann 
@_subject: True necessity of Records? [was: CryptoSeal] 
I got the same response from talking to techies at a large telco, they kept
the records just in case they needed them (not for any specific LEO use, but
just in case they needed the info at some point in the future), and because it
was easier to keep them than to delete them.  In other words, throwing a few
more drives into a server farm was relatively straightforward compared to
figuring out what to delete, when, under what conditions, and how (lots of
different formats, data all over the place, etc).
(This issue isn't unique to telcos, it seems to be near-universal, it's always
easier to keep data lying around than to figure out what to delete).

@_date: 2013-09-22 21:40:53
@_author: Peter Gutmann 
@_subject: [coreboot] [liberationtech] Fwd: Firefox OS with built in support 
Eugen Leitl  forwarded:
Cute, but at $200 you'd have to really, really want the FOSS firmware.  Even
the PCEngines boards (also with FOSS, or at least non-commercial firmware) are
half that price, and if you're happy with a generic x86 with non-FOSS firmware
you can buy any number of barebones SFF boards for much less.

@_date: 2013-09-26 11:09:46
@_author: Peter Gutmann 
@_subject: [cryptography] The Compromised Internet 
The threat of people saying "we'll just throw some cryptography at it and then
all our problems will be solved".

@_date: 2014-04-24 04:19:30
@_author: Peter Gutmann 
@_subject: Fine grain Cross-VM Attacks on Xen and VMware (AES) 
That's just another proof of the inverse of Law  of the 10 Immutable Laws of
Security, "If a bad guy can persuade you to run his program on your computer,
its not your computer any more".  The inverse is the Immutable Law of Cloud
Computing Security, "If a bad guy can persuade you to run your program on his
computer, its not your program any more".

@_date: 2014-12-31 12:59:37
@_author: Peter Gutmann 
@_subject: What the hell can be done with this trinity? 
There's actually a security standard that's supposed to deal with this sort of
thing, FIPS 140 (people who have seen my previous posts about what a waste
of... well, everything FIPS 140 is should see what's coming here :-).  If you
recall the Snowden-provided NSA photos of their people intercepting Cisco gear
in transit and adding supplementary functionality to it:
* The physical seals are applied after it reaches its destination.  You order
  a special "FIPS kit" consisting of (allegedly) tamper-evident stickers that
  you apply to the gear after the NSA has tampered with it.
* Since your $40,000 router doesn't come with the stickers that you need for
  FIPS 140 compliance, you have to order them specially.  No-one bothers (the
  description I got was "in the n years I've been involved with this, I can
  count the number of customers who've done it on the fingers of one hand").
* No-one who works with the gear has any idea what a tampered sticker would
  look like, but in any case they're never checked once applied.
Still, at least there's a government standard for it.

@_date: 2014-02-13 15:42:10
@_author: Peter Gutmann 
@_subject: Snowden and Compilers 
It was demonstrated well before then, Arrigo Triulzi had demonstrated running an SSH server inside a NIC several years earlier.

@_date: 2014-02-26 15:47:39
@_author: Peter Gutmann 
@_subject: Gox 
What would they be prosecuted for, not storing the tulip bulbs under dry
enough conditions?  It's not as if they violated any banking regulations.

@_date: 2014-02-28 13:57:39
@_author: Peter Gutmann 
@_subject: Red Pike cipher 
The interest isn't in any comparison with AES, it's that Red Pike is a classified GCHQ-designed cipher from the crypto wars. The code matches the description by Ross Anderson and Markus Kuhn, but if it's non-genuine then it could just have been implemented to make sure that it matches the description.  It looks like a tweaked TEA-like cipher.  If it is genuine and it's from GCHQ, maybe it's EnglishBreakfastTEA.

@_date: 2014-01-11 14:38:25
@_author: Peter Gutmann 
@_subject: ECC curves that are safe safecurves.cr.yp.to 
Some of their objections seem pretty subjective though, I mean they don't like
the Brainpool curves because of:
  Several unexplained decisions: Why SHA-1 instead of, e.g., RIPEMD-160 or
  SHA-256? Why use 160 bits of hash input independently of the curve size? Why
  pi and e instead of, e.g., sqrt(2) and sqrt(3)? Why handle separate key
  sizes by more digits of pi and e instead of hash derivation? Why counter
  mode instead of, e.g., OFB? Why use overlapping counters for A and B
  (producing the repeated 26DC5C6CE94A4B44F330B5D9)? Why not derive separate
  seeds for A and B?
Is that really a big deal?  SHA-1 vs. RIPEMD-160.

@_date: 2014-01-20 17:04:44
@_author: Peter Gutmann 
@_subject: cypherpunks and hackers who dont code? 
Naah, it'd be displayed as a VU-meter style 10-LED display.  When you boot it,
all ten LEDs slowly light up as the boot progresses.  Then when you go online,
the 11th LED superglued onto the end of the other ten lights up as well.

@_date: 2014-01-20 19:51:32
@_author: Peter Gutmann 
@_subject: Fwd: [tor-talk] giving up pseudonymity after collecting 
His ideas are intriguing to you and you wish to subscribe to his newsletter?

@_date: 2014-06-09 07:47:20
@_author: Peter Gutmann 
@_subject: [Cryptography] Help investigate cell phone snooping by police 
People can use the material that was left over from when they made the hat.

@_date: 2014-03-14 11:55:11
@_author: Peter Gutmann 
@_subject: [cryptography] 2010 TAO QUANTUMINSERT trial against 300 (hard) 
This is relatively easy for home routers, since the self-signed certs they're
configured with are frequently CA certs.  In other words they ship from the
factory in a MITM-ready state.

@_date: 2014-03-20 12:31:11
@_author: Peter Gutmann 
@_subject: SHA-7 crypto patented by Italian Postal Service 
Is there any indication of what this SHA-7 is?  Before I pass judgement I'd
like to see a document from a technical writer rather than a generic press
release that potentially mangles beyond recognition what they've actually

@_date: 2014-03-24 14:47:16
@_author: Peter Gutmann 
@_subject: "Whew, wondered where we'd put those 200,000 BTC!" 
Absolutely.  Some time ago I had a long chat with someone who worked on large-
scale financial processing systems.  Among other things his organisation tends
to act as a stress test for any hardware or software they use since they push
it beyond what anyone else ever manages (and no, it's not HFT, just standard
banking clearing).  Their prime directive is that financial value can never be
created or destroyed, so you can never have a situation in which a failure
anywhere will result in one blob of financial value being recorded in two
locations, or no locations.  Saying that you'll address this by rolling back
transactions won't fly both because no standard database can handle the load
they work at, and because the financial world isn't going to stop and wait
while you perform a rollback.
To give some examples of what this entails, they only use the outer sets of
tracks on their disk arrays to maximise data throughput/minimise head
movement, if they were to use the entire platter the system couldn't keep up.
Cacheing doesn't help, they did try it with the most exotic cacheing
technology that EMC could provide them and found that after X hours throughput
dropped to a fraction of what it had been.  Although EMC had simulated this
situation they never expected that anyone would be able to do it in real life.
They also managed to figure out the computing power of a USG agency using a
certain type of architecture because, when they wanted to buy the entire
production run of a particular just-introduced CPU for several months they
found that an unnamed US customer had already bought six months worth of
production ahead of them.
I think this is about as far from hacking together "some crappy ruby code" as
you can get while still remaining on the same planet.

@_date: 2014-03-25 14:11:10
@_author: Peter Gutmann 
@_subject: "Whew, wondered where we'd put those 200,000 BTC!" 
This was a software guy (quoting what he knew about some of the special
hardware features), so he didn't go into that much detail on this sort of
thing, but in any case it's problem that's been (mostly) solved for decades,
just look for discussions of high-availability systems ( is one good starting
It's not for nothing that, for example, Tandems are sold under the name
NonStop (they're covered in a case study in the book referenced above).  I was
in a Tandem shop some years ago when it experienced a rapid sequence of power
glitches.  The mass of IT gear in the building needed everything from a reboot
to a reinstall to hardware replacement to get working again.  One of their
techies took me into the mainframe room to the Tandem console, which had a
series of reports "Power lost / Power restored / Power lost / ...".  Apart
from that there had been no effect.
There's a story that during the Loma Prieta earthquake a data centre
containing a Tandem machine was damaged in the quake.  It continued running,
lying on its side surrounded by debris, until they could bring in heavy
equipment to push it upright again.

@_date: 2014-05-29 22:24:57
@_author: Peter Gutmann 
@_subject: is truecrypt =?UTF-8?Q?dead=3F?= 
It's open-source, so there's the presumption of audit, "I couldn't be bothered
looking at it, but since it's open source someone else must have".  The odd
thing is that it's some of the commercial vendors, who are doing it for money
and can pay to have the code checked, for which you have at least some
presumption of audit, but since they're closed-source you're not allowed to
trust them.

@_date: 2014-05-31 13:26:05
@_author: Peter Gutmann 
@_subject: is truecrypt dead? 
The problem is that technically smart people aren't legally smart, and think
that a court/judge can be stymied with a modexp operation.  You can't really
convince them that the law will get at them eventually, no matter how fancy
they make their Rube Goldberg machine.

@_date: 2014-10-16 16:55:31
@_author: Peter Gutmann 
@_subject: Crypto mechanics in ios8 and android L 
That bites both ways.  If I can get control of your Android device (which,
given the exploit-like-it's-the-1990s state of security of the whole ecosystem
shouldn't be that hard) then I've MITM'd your net connection, while doing the
same for your router/access point is likely to be a lot harder.

@_date: 2014-10-26 22:38:08
@_author: Peter Gutmann 
@_subject: Time for IETF witch hunt? (was: NSA Co-Chairs of Crypto Forum 
(But then not allowing people to make their preferred crypto fashion statement
would also be removing their freedom to shoot themselves in the foot with a
machine-gun.  In any case as a security researcher I don't know what you're
complaining about, you're getting a guaranteed lifetime supply of material for
future presentations at Defcon/Black Hat/etc).

@_date: 2014-10-28 22:48:50
@_author: Peter Gutmann 
@_subject: CITIZENFOUR (of Pole Dancer Girlfriends etc.) 
There's an even bigger issue that's also still unresolved:
Clearly a disinformation campaign backed by media interests with vast budgets
and government connections.  As the last frame states:
  Who is this guy?  I didn't vote for him.  What influence he exerts over our
  government.

@_date: 2014-10-31 13:37:27
@_author: Peter Gutmann 
@_subject: are USB floppies toxic? 
More generally, search for "charge only usb cable" and you'll find lots
of things like this, e.g:
Something like this, $1.99 including shipping:
is great for carrying around for charging your phone when you're travelling, just mark it in some way so you don't get frustrated when you can't sync your phone with it...

@_date: 2014-09-20 10:58:25
@_author: Peter Gutmann 
@_subject: Fwd: [Cryptography] Shaming sites that send sensitive information 
grarpamp  forwarded:
My guess is that it's politically-motivated, if you're the NSA would you want
to buy your certs from a commercial CA, and if you're a commercial CA would
you want to be known as the supplier of trusted certs to the NSA?

@_date: 2014-09-30 15:14:42
@_author: Peter Gutmann 
@_subject: Bitcoin mining ASIC decapped 
In case anyone's interested, this site:
has some photos of what looks like a decapped Bitfury ASIC.  It's a pretty
unique structure...

@_date: 2015-08-14 05:24:08
@_author: Peter Gutmann 
@_subject: Privacy advocates resign over facial recognition plans 
References:  <2307550.aktsLoVmFc <5591A49E.4040204
 <19407322.87nTAoSQ5D
 <55CA2401.9070402
 <20150812122355.DB8F0680147
 <55CC7807.8040905
 ,
 <20150814002613.198DC68013F
For procmail users, I've found that:
* ^From: *carimachet
:0 B
* Cari Machet
gets rid of most of it.

@_date: 2015-12-02 00:29:25
@_author: Peter Gutmann 
@_subject: The Moral Character of Cryptographic Work 
References: <20151201164023.GA23078
For those who missed the talk this morning, he's also doing a public lecture
next Wednesday:
Feel free to drop by, and then follow it up with KiwiCon the next day:

@_date: 2015-12-16 05:43:34
@_author: Peter Gutmann 
@_subject: [FORGED] US Pres. Cand. Carly Fiorina Comes Out Against Crypto 
References: grarpamp  quotes:
They need to pass an Enabling Act to allow this, a law to remedy the distress
of the people and the nation, followed by a law against treacherous attacks on
the state and government, and maybe another one to safeguard the unity between
government and country.  That would give them all the leeway they need to act.

@_date: 2015-02-04 16:39:45
@_author: Peter Gutmann 
@_subject: What the fark is "TFC" 
It's Tennessee Fried Chicken (sometimes known as Tomato Fried Chicken due to
the way it was served), an early, unsuccessful competitor to the more popular
Kentucky Fried Chicken.
HTH, HAND.

@_date: 2015-02-05 14:30:33
@_author: Peter Gutmann 
@_subject: Tox.im 
This is why we have cryptography, it provides us with a precise mathematical
framework for debating the implications of various paranoid delusions.  No
matter how the gubmint is trying to get you, there's bound to be some
cryptographic pixie dust of some form that you can sprinkle to help you feel

@_date: 2015-02-23 12:45:02
@_author: Peter Gutmann 
@_subject: [Cryptography] trojans in the firmware 
Almost.  Its sole use is for very fast "drive erasure", i.e. you change the
key and the data on it becomes inaccessible.  Have a look at this
which describes what Samsung (and others) are doing, in particular slide 18.
The decryption key (DEK) is stored in the drive, and is unlocked using a
password (and "authentication key", AK).  So to decrypt the drive you extract
the encrypted DEK, brute-force the password (AK), and you're in.
In any case though it doesn't protect against an attack that occurs when the
drive is mounted since it looks like an unencrypted drive at that point (and
presumably the AK is hardcoded into a startup script or something similar in
order to survive power outages, so you can grab that if you really need it).
It's actually hard to see what purpose this "encryption" is serving (the
vendors studiously avoid providing a threat model), it doesn't protect live
data, it barely protects data at rest (say if you decide to Fedex the contents
of your data centre across town), the only thing it really does is allow for
fast erasure of contents, and protect against casual snooping of the "buy a
batch of drives on ebay and see what's on them" kind.
So I guess if ebay is your threat, it's good enough.  OTOH a BIOS password set
for the drive will do the same thing.
As a more general response to "what's the point", regulatory compliance ("our
drives were encrypted so we don't have to disclose the 40M credit card breach
from last week"), buzzword-compliance, CYA, it's not a bad idea from a
marketing point of view.

@_date: 2015-01-06 23:17:38
@_author: Peter Gutmann 
@_subject: What the hell can be done with this trinity? 
Uhh, I don't keep records of them, or at least there are mail logs but that's
an awful lot of stuff to cover.  In addition others have commented on it as
well not just me, the best way to find it would be to search the cryptography
list archives for "FIPS 140".

@_date: 2015-01-28 19:37:01
@_author: Peter Gutmann 
@_subject: Barrett Brown 
I dunno, I think the Malcolm Tucker wannabe act from two or three messages ago
was pretty dire.  What makes Malcolm so entertaining is that he's a creative
artist when it comes to swearing ("This is like The Shawshank Redemption, only
with more tunneling through shit and no fucking redemption" or "When I want
your opinion I'll give you the signal, and that signal's me being sectioned
under the mental fucking health act") while the OPs use came across as very
amateurish, no creativity at all, just some boilerplate swearing cobbled
together with rubber bands and matchsticks.  That wouldn't even get a conceded
pass mark for effort, it's a straight F.

@_date: 2015-07-24 12:18:01
@_author: Peter Gutmann 
@_subject: Hackers Remotely Kill a Jeep on the Highway 
References: <20150724120211.GA2562
I remember saying something like "I feel a bit lightheaded; maybe you should
drive..." And suddenly there was a terrible roar all around us and the sky was
full of what looked like huge bats, all swooping and screeching and diving
around the car, which was going about a hundred miles an hour with the top
down. And a voice was screaming: "Holy Jesus! What are these goddamn

@_date: 2015-07-26 21:42:14
@_author: Peter Gutmann 
@_subject: Hackers Remotely Kill a Jeep on the Highway 
You have to be careful with those, the straight USB-dongle ones are going to
be SDR-based, typically the RTL820T meant for DVB-T use (and re-purposed by
half the hacking world for all manner of other things), then you have the USB-
interface ones with more powerful SDRs, and finally you've got purpose-build
spectrum analysers.  Compared to the real thing, you're going to run into
severely limited bandwidth (anything that spreads the signal across a wide
spectrum is going to be difficult to impossible to deal with), and not-so-
spectacular signal handling (there's a reason why the real thing costs
thousands of dollars).
That's not to say that they're no good, just that you need to be aware that
you're getting what you pay for.  If you've got a specific purpose in mind,
check first that whatever you're getting will be able to do the job.  There's
quite a bit of material out there on this, google something like "sdr spectrum
analyzer" to find articles on it.

@_date: 2015-07-26 23:25:43
@_author: Peter Gutmann 
@_subject: Intercept receivers (was Re: Hackers Remotely Kill a Jeep on 
References: The problem with the HackRF (and other USB-based devices) is the bandwidth of
the USB connection, it's not that the HackRF hardware can't handle it, it's
that you can't get that much data to the PC.
(I have a HackRF - I needed a cheap way to track down some odd RFI issues -
and it's a pretty cool piece of hardware for the money, but, as I mentioned
earlier, you do get what you're paying for.  If I could make a wishlist, it'd
be nice to have a rev.2 with some work done on the front- end...).

@_date: 2015-06-02 07:41:15
@_author: Peter Gutmann 
@_subject: $330 3.3 GHz Spectrum Analyzer 
References: ,
 <1928767974.3301192.1433179588507.JavaMail.yahoo
And there's the catch...

@_date: 2015-04-01 19:57:09
@_author: Peter Gutmann 
@_subject: Cryptoanarchist slogan 
That's not such a good idea, because when you swap your state back in again
you can't decrypt it any more and end up with a kernel panic.

@_date: 2015-11-07 00:34:29
@_author: Peter Gutmann 
@_subject: [FORGED] Re: UK To Ban Crypto In Devices, Email And More 
References:  <56391C22.7010101
I don't really want to get involved in this debate (who has that much
asbestos?), but wanted to comment on one thing:
You're a townie then?  If it's like NZ, pretty much every farm in the country
has (or had) one or more rifles, typically a .303 because they were cheap and
a .22 for dealing with rabbit infestations (they're mostly useless against
possums, another major plague).  Also, the fact that you don't see them
doesn't say anything about whether they're there or not.  At the time of the
gun grab, a friend of mine who lived in Queensland and was doing some work on
his house found it more or less impossible to buy PVC fittings of particular
sizes and types, the explanation being that the stocks had been drained by
people using them to sequester their firearms.  So they may have managed to
destroy large numbers of firearms, but they also drove large numbers off the
books and underground (literally, in many cases).

@_date: 2015-11-08 02:10:19
@_author: Peter Gutmann 
@_subject: [FORGED] Re: UK To Ban Crypto In Devices, Email And More 
References:  <56391C22.7010101
 <9A043F3CF02CD34C8E74AC1594475C73F4B588DC
That's a good point actually.  In my enormous to-read pile I've got "Why
Johnny Still Can't Encrypt", and that's from fifteen years after the original
paper on PGP's unusability was published.  It's scary to think that companies
like Apple have done more to protect us from intrusive government surveillance
than nearly a quarter century of PGP has, because they've made it usable by
the masses.

@_date: 2015-11-08 08:40:51
@_author: Peter Gutmann 
@_subject: [FORGED] Re: [FORGED] Re: UK To Ban Crypto In Devices, Email 
References:  <56391C22.7010101
 <9A043F3CF02CD34C8E74AC1594475C73F4B588DC
 <9A043F3CF02CD34C8E74AC1594475C73F4B59632
 <563ebfbb.33268c0a.d899e.ffffcbab
 <563eebdf.431a370a.afed.ffffd5ca
 <563F06AB.2010208
... and this is pretty much the poster child for why we have so much unusable
crypto today.

@_date: 2015-11-24 01:31:38
@_author: Peter Gutmann 
@_subject: [FORGED] Yoga class cancelled for "cultural issues" 
References: They're really going for that Poe's Law prize this year aren't they?

@_date: 2015-11-25 02:37:28
@_author: Peter Gutmann 
@_subject: [FORGED] NATO member Turkey just shot down Russian military jet 
References: If you ignore several centuries of political machinations and outright warfare
then yes, Russia has been pretty friendly to Turkey.
With friends like Putin, who needs enemies...

@_date: 2015-10-09 15:25:15
@_author: Peter Gutmann 
@_subject: Introduce randommess in keypress timings 
References: <636897858.795946.1444330101517.JavaMail.yahoo
 <636897858.795946.1444330101517.JavaMail.yahoo
Wrong entropy source, if you go for Norwegian black metal you get at least
1024 bits of entropy [0].  Having said that, Putin's foreign policy speeches
will get you at least 512 bits of entropy in the same time frame.
[0] From an estimate done at Tons of Rock in Norway in June of this year.

@_date: 2015-10-22 23:12:21
@_author: Peter Gutmann 
@_subject: [FORGED] Re: State of the art in malware owning human? 
References: <20151022090553.GA2546
 <56293894.e3568c0a.ae64f.ffffecc1
After that, consult "Science and Pseudoscience in Clinical Psychology" on NLP.
Heck, just consult it anyway, it's a great read.

@_date: 2015-09-03 11:59:11
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
One saving grace about RFC 2631 was that it was pretty much universally
ignored for the reason that it was, well, a pretty stupid way to do things, so
the number of affected implementations would be approximately zero.
(I only know of one, rather minor, vendor who implemented it.  Microsoft
implemented it in receive-only mode solely so that they couldn't be accused of
being non-standards-compliant, but I'd be very surprised if there was anything
still around that supported it.  For starters you'd need to be able to find a
CA that could issue you a DH certificate...).

@_date: 2015-09-03 13:33:48
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0463
 <20150903133004.GB2732
Well, I think the problem will be finding any implementation of this at all,
or at least any that's still around now.
The static DH parameters need to be turned into a certificate by a CA.  I
don't know of any public CA that can issue these.

@_date: 2015-09-03 13:42:24
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0463
 <20150903133004.GB2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0566
 <20150903133823.GC2732
That just indicates support for PKCS  DH parameters, not anything else.  In
any case the page also says:
  OpenSSL currently only supports the older PKCS DH, not the newer X9.42 DH.
so that explicitly precludes using it in certs, even if code elsewhere would
support such usage.
I've gone through my (sizeable) cert collection and found a single example of
X9.42 certs, created by a USG contracting company paid to develop the code for
this and dating from 1996.  The certs are signed with a test DSA key, and
contain a number of errors (zero-length fields, the DH key is marked as a CA
signing key, etc).

@_date: 2015-09-03 15:38:23
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0463
 <20150903150801.GD2732
Oh sure, it's definitely broken.  OTOH I'm not sure if it's a deliberate
backdoor, the whole thing is such a bad design to begin with that something
like this is really just the icing on the cake.
It may be worth submitting an erratum to the RFC that mentions the problem,
just in case anyone is actually crazy enough to want to implement this in the

@_date: 2015-09-05 11:45:07
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0463
 <20150904082605.GA2705
 <20150904113437.GB2705
 <20150904120816.GC2705
 <20150905052803.GA2661
 <20150905070749.GC2661
You need to go back to the original source of all the DLP stuff, which is DSA
186-3 came along in June 2009, and that in turn points to SP 800-89, which has
a section 4 "Assurance of Domain Parameter Validity".  This one gets really
complicated because you can get the domain parameters from all over the place
(generated yourself, provided for you by a third party, found at the bottom of
a locked filing cabinet stuck in a disused lavatory with a sign on the door
saying 'Beware of the Leopard', ...).
So if you generate them yourself, you're OK.  If you get them from a CA then
you don't need to care because if the CA wants to attack you then they can
just issue a forged cert in your name and don't need to worry about
backdooring the params (in any case using shared params is a bad idea because
they allow forgery of signatures on certificates. Suppose that the certificate
contains a copy of the certificate signer's DSA parameters, and the verifier
of the certificate has a copy of the signer's public key but not the signer's
DSA parameters (which are shared with other keys). If the verifier uses the
DSA parameters from the certificate along with the signer's public key to
verify the signature on the certificate, then an attacker can create bogus
certificates by choosing a random u and finding its inverse v modulo q (uv is
congruent to 1 modulo q).  Then take the certificate signer's public key g^x
and compute g' = (g^x)^u. Then g'^v = g^x.  Using the DSA parameters p, q, g',
the signer's public key corresponds to the private key v, which the attacker
knows.  The attacker can then create a bogus certificate, put parameters (p,
q, g') in it, and sign it with the DSA private key v to create an apparently
valid certificate).
Finally, if you get them from the disused lavatory then you deserve everything
you get^H^H^H^H^H^H^H^HFIPS 186-3 has validation requirements that use the
optional j and seed parameters, but I've never seen them used anywhere so even
though the validation requirements exist, you can't apply them.
The real question though is, why would anyone use parameters they didn't
generate themselves?  All DSA implementations I've seen (apart from some
experimental code from the 1990s, which also encoded the j/seed values)
generate all the parameters themselves, it's not like ECDSA where everyone
ends up using some shared values that a "trusted" external party provides

@_date: 2015-09-06 07:56:07
@_author: Peter Gutmann 
@_subject: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key 
References: <20150903112721.GA2732
 <9A043F3CF02CD34C8E74AC1594475C73F4AF0463
 <20150904082605.GA2705
 <20150904113437.GB2705
 <20150904120816.GC2705
 <20150905052803.GA2661
 <20150905070749.GC2661
 <9A043F3CF02CD34C8E74AC1594475C73F4AF36EE
 <20150905133131.GJ2661
Whose DH?  There are three major users of this on the public Internet, IPsec,
TLS, and SSH, all of which have the server provide the DH values.  MITM'ing
yourself isn't much of an achievement.
I haven't seen anything about this (so far) that doesn't class it as a purely
certificational weakness.  Consider the following equivalent of the flaw, but
for RSA:
  I stand up a TLS server and provision it with a cert where the server-auth
  key has exponent 1.
There is nothing in any spec that I can immediately think of that says that
you have to reject keys with e=1 (e.g. RFC 3447 just says it's "a positive
integer").  Most implementation were quite happy to accept e=1 keys until
maybe two years ago when there was some bad publicity about them which forced
vendors to fix the problem, but before that no-one bothered rejecting such
obviously invalid keys.  Use of e=1 keys was even a documented Windows
"feature" to allow plaintext key export while still being FIPS 140 compliant
This isn't any deliberately-inserted backdoor in the RFC, it's just sloppy
wording.  In any case though if I configure my server with a key I know to be
broken then any problems I encounter are my own fault.
The reductio ad absurdam form of this is that I stand up a TLS server which
serves the private key to anyone that connects to it (or puts it in the SSH
banner, or whatever).  OK, so I've proven that I can backdoor myself.  I can't
see how a third-party attacker can do anything though (for DH, RSA, or just
straight publish-the-key) unless I help them do it.
[0] Where "FIPS" = "Farcical Information Processing Security".

@_date: 2015-09-06 11:01:39
@_author: Peter Gutmann 
@_subject: =?Windows-1252?Q?RE:_Hackers_spent_at_least_a_year_spying_on_Mozilla_to_d?= 
References: <20150905153537.GO2661
 <55eb6758.5a18370a.bcf8c.3cf2
Not to mention their plan to deprecate their extension API, which is the only
thing still separating them from actually being Chrome.  It looks like there
could be a race between them naturally driving their market share to zero
before the API-deprecation, or the API-deprecation forcing the issue.
What we'd really need is a reboot of the project to take it back to its roots,
removing layers and layers of accumulated bloat and "features" no-one wants,
run by dedicated developers who actually listen to their users rather than
doing whatever they think is trendy (mostly just cloning Chrome) and forcing
it on their users.  It'd be like Firefox rising anew from the ashes.  They
could call it, oh, I dunno, something like "Phoenix".

@_date: 2015-09-08 07:20:41
@_author: Peter Gutmann 
@_subject: Hackers spent at least a year spying on Mozilla to discover 
References: <20150905153537.GO2661
 <55eb6758.5a18370a.bcf8c.3cf2
 <20150906055841.GA2609 <1641850.IyAd3s2aHy
 <55edc16b.6465420a.2449d.0c81 <20150907184910.GR7320
You forgot the most critical ones, the extensions you need to undo all the
crap that Mozilla have piled onto Firefox since they started on their copy-
everything-Chrome-does spree.  Classic Theme Restorer is the first extension I
load on any new install (even before NoScript), it's now comprehensive enough
that it's probably the only one you need, although Hide Tab Bar With One Tab
is also useful.

@_date: 2015-09-23 02:37:06
@_author: Peter Gutmann 
@_subject: Focusing x-rays 
References: Ten out of ten for knowing what it was, but minus several million for using
Wikipedia as the reference.

@_date: 2015-09-23 04:37:39
@_author: Peter Gutmann 
@_subject: Windows 10 
References: <556D8DFD.6050402 <557BCAEB.3080003
You're the product, not Windows.  That was the good thing about the old
Microsoft (yes, there were good things about them), they took your money and
left you alone to do whatever you wanted with their software.  Now, like
Google (where you're entirely the product, for sale to anyone with money) and
Apple (where you're still the product, but the sole customer is Apple),
they're turning their customers into the product.
(Not to mention that W10 has moved even further along the path of treating
your PC like a cellphone.  It's possibly the first GUI I've used that was
literally painful to use, the all-white-all-the-time UI theme was like staring
into a lightbox, my eyes hurt after an hour of two of setting up a neighbour's

@_date: 2016-04-07 05:12:11
@_author: Peter Gutmann 
@_subject: [FORGED] Re: [Cryptography] A humble recommendation 
References:  <570528d0.1070105 <570572ad.7060805
 ,
I've seen troopships on fire off the shoulder of Orion.

@_date: 2016-04-24 18:25:37
@_author: Peter Gutmann 
@_subject: Clipper chip datasheet? 
References: <20160424000637.0C7A92011A
I don't know about docs, but you can buy the devices themselves in bulk:
As Lucky Green recently pointed out to me, the government's previous attempt
at backdooring crypto is now being sold as scrap.

@_date: 2016-02-11 03:00:21
@_author: Peter Gutmann 
@_subject: Small codebase as a prerequisite for security 
References: That's because you need to add way too much other stuff to them to make them
generally useful.  My favourite quote on this, attributed to Nick Foster, is:
  You know, when you have a program that does something really cool, and you   wrote it from scratch, and it took a significant part of your life, you   grow fond of it. When it's finished, it feels like some kind of amorphous   sculpture that you've created. It has an abstract shape in your head   that's completely independent of its actual purpose. Elegant, simple,   beautiful. Then, only a year later, after making dozens of pragmatic   alterations to suit the people who use it, not only has your Venus-de-
  Milo lost both arms, she also has a giraffe's head sticking out of her   chest and a cherubic penis that squirts colored water into a plastic   bucket. The romance has become so painful that each day you struggle with   an overwhelming urge to smash the fucking thing to pieces with a hammer. You can write pretty good, minimal, very high-assurance code if you follow
something like DO-178B and get people who are a fair way down the ASD
spectrum to work on it, but then you've got something that's hardcoded to
do one thing really well in a tightly-controlled environment, and nothing else.  A lot of the crap out there exists because it has to interact with
a bazillion buggy pieces of hardware and software and support unique
absolutely mission-critical customer requirements that no-one else on earth has.  seL4 makes all of this someone else's problem, while Linux and Windows and whatnot make it their problem.

@_date: 2016-02-12 04:20:35
@_author: Peter Gutmann 
@_subject: Small codebase as a prerequisite for security 
References:  <9A043F3CF02CD34C8E74AC1594475C73F4BED0BF
XKCD is, as usual, most apropos here:
A huge amount of embedded stuff doesn't even have a kernel mode, because its
irrelevant (or, if the hardware does actually support two different modes,
everything is run in the highest-priv'd mode).  Either the system is
robust/secure/reliable or it isn't, whether there's a kernel/user split is

@_date: 2016-02-14 06:18:02
@_author: Peter Gutmann 
@_subject: [FORGED] Re: Brit spies can legally hack PCs and phones, say 
References: <20160213092748.GA2421
"It is responsible discretion exercised in the national interest to prevent
 unnecessary disclosure of eminently justifiable procedures in which untimely
 revelation could severely impair public confidence".

@_date: 2016-02-15 02:09:37
@_author: Peter Gutmann 
@_subject: [FORGED] Samsung Warns Customers: Watch Your Mouth 
References: ... which can then be reactivated by anyone who walks through the 6.022e23
security holes that come preconfigured in any "smart" TV.
... thus reducing it to a dumb TV.
(Anyone know how long a TV will run like that, without any access to the
constant stream of communication those things want to engage in?).

@_date: 2016-02-18 09:23:17
@_author: Peter Gutmann 
@_subject: Inside John Kerry's Photo Op With Hollywood Leaders: Anti-ISIS 
References: <20160218091308.GA2430
You mean Chris Korda's work?
Peter :-).

@_date: 2016-01-31 15:00:04
@_author: Peter Gutmann 
@_subject: New High School Principal's speech to students. 
References: <510A847E700D4DD684DDF160ADA31ECB
 ,
Since it came from talk show host Dennis Prager and not any high school
principal, it's unlikely anyone'll get fired over it.

@_date: 2016-07-04 10:09:34
@_author: Peter Gutmann 
@_subject: [Cryptography] Android Full Disk Encryption Broken - Extracting 
References: ,
 <5BCAC416-4DDD-4E0D-87E9-9B62E82E6C6A
I think a more direct lesson here is that taking a security mechanism that
consists of a bit flag used to tag a block of memory, defining any such tagged
area as secure by executive fiat, and selling it as TrustZone, is no match
for, you know, actually doing real security.  It's not like this hasn't
happened before, in 2013 Motorola cellphones got 0wned via attackers targeting
the insecure TrustZone and attacking from inside that out to the (apparently)
quite secure non-TrustZone code.

@_date: 2016-07-04 10:13:40
@_author: Peter Gutmann 
@_subject: [Cryptography] Android Full Disk Encryption Broken - Extracting 
References:  <5BCAC416-4DDD-4E0D-87E9-9B62E82E6C6A
... which is exactly what was exploited in the 2013 attack, alongside a whole
boatload of other missing defensive features, no DEP, no ASLR, executable
stack, strcpy()s all over the place, it was described at the time as a "hack
like it's 1999" attack.  As I said in the previous post, security is more than
just a fancy name and a lot of marketing, you have to actually make an effort
to make it secure.
Oh, and given that this looks like a repeat of the same flaws from three years
ago, patching your insecure code also helps.

@_date: 2016-05-21 07:13:05
@_author: Peter Gutmann 
@_subject: [FORGED] Fascism, Nazism, Henry Ford's successful sueing of the 
Trick'
References: That was happening at least as far back as ancient Rome.

@_date: 2016-05-22 04:53:29
@_author: Peter Gutmann 
@_subject: [FORGED] Fascism, Nazism, Henry Ford's successful sueing of the 
Trick'
References:  <9A043F3CF02CD34C8E74AC1594475C73F4C86A4B
 <3745A69F-4C7B-444C-B328-62B3AB80D567
I was thinking more the end of the empire, when practically everything was for
sale, incuding the throne itself (Didius Julianus bought it from the
Praetorians).  You had to be careful though, Galba was put in power by the
Praetorians, wouldn't pay them for lack of money (there was a formal name and
process for this, the donativum), and was removed again by them not long
afterwards.  Perhaps a bit like a president failing to favour their biggest
campaign contributors and losing the next election.
