
@_date: 1996-02-28 20:52:22
@_author: Dimitris Tsapakidis 
@_subject: Diffie-Hellman for Matchmaking? 
sci.crypters and cypherpunks:
This is a followup to my "Dating Problem" question I posted on
sci.crypt, some months ago. I am trying to find or design some
matchmaking protocols (and implement one of them, eventually)
that have all the nice properties, like privacy and fairness.
I came up with two or three candidate protocols, but they all
rely on the Diffie-Hellman "common key" for mutual authentication.
I haven't seen it used for such purposes in the literature, and I
am suspicious.
The setup is the same as in Diffie-Hellman key exchange.
Assume global: prime n and primitive element g mod n. All the
participants have a pair of (secret, public) keys, where
public=g^secret mod n. By common key I mean
g^(secret_a*secret_b)mod n.
Person A is interested to match person B, so he computes
g^(AB)mod n. B is interested in X, where X may or may not
be A, and calculates g^(BX)mod n. Now, they compare these
two "common keys" either using some Zero Knowledge scheme
that ensures fairness (at no point one party has significantly
more information than the other) or through a Trusted Third Party.
If they are the same, then this means X=A, so A and B
have a match (e.g. a date). The common keys must remain
secret (hence the ZK above): if g^(BX)mod n "escaped"
to the public, then the real X would find out that
B is interested in him.
Is anything wrong with this, specificaly with the use
of the "common key"?
  Dimitris

@_date: 1996-03-05 19:48:56
@_author: Dimitris Tsapakidis 
@_subject: Diffie-Hellman for Matchmaking? 
Ok, I am reposting this, with more detail this time. Hope this
answers the two questions I received.
I want to design/find some matchmaking protocols. I define matchmaking
as follows:
Bob must find out whether Alice has declared (commited) her interest
in him, if and only if he has declared (commited) his interest in her.
Before he does so, he can at most know that a girl is interested in him.
Another description: Bob and Alice can have a date if they both commit
to each other. If only one commits, nobody will ever find out about it.
Below are the protocols I came up with. They all depend on the
Diffie-Hellman "common key" as derived in the DH key exchange.
- T is the trusted third party.
- hash_k() is a keyed hash function with key k.
- pseudo(Alice) is a pseudonym for Alice.
- n is a large prime.
- g is a primitive element mod n.
- A is Alice's secret exponent. Her public key would be g^A mod n.
- Alice's and Bob's "common key" would be g^(AB)mod n
1. The mediated off-line one:
- T selects a secret k (which he uses for the duration of a month,
  say).
- Alice is interested in Bob, so she calculates a=g^(AB)mod n and
  anonymously and securely sends it to T along with pseudo(Alice).
- T calculates c=hash_k(a) and broadcasts c and pseudo(A) to the
  planet or puts them on a bulletin board.
- Bob is ignorant of Alice's actions. If he ever decides that he
  likes her, he calculates and sends a=g^(AB)mod n to T (plus
  pseudo(Bob)). T will calculate hash_k(a) which equals c. T broadcasts
  c plus pseudo(B) so both Alice and Bob will know they have a match.
  If Bob is not actually interested in Alice, he doesn't perform this
  step at all, so nothing happens, and Alice just assumes Bob is not
  interested.
Replay is not an issue here.
2. The mediated on-line one:
- Alice is interested in Bob, so she calculates a=g^(AB)mod n and
  ANONYMOUSLY approaches Bob.
- Bob calculates b=g^(BX)mod n, where X may or may not be Alice.
  If Bob is not interested in anyone, he could tell Alice to leave,
  or select a random X while calculating b.
- Alice and Bob want to compare a and b. They generate a random k using
  some coin-flipping protocol. Then they send (possibly pseudonymously)
  hash_k(a) and hash_k(b) to T who compares them and announces the
  result.
Using a keyed hash function reduces the trust on T, compared to
protocol (1), I hope. Now, T has to conspire with one of the
parties to get the "common key". I suspect this can be improved
using the Digital Envelopes protocol as described by Fagin,
Naor and Winkler in "Comparing information without leaking it"
to replace the hashing.
3. Non-mediated on-line one: This third protocol would remove T in
(2). Alice and Bob would compare their "common keys" directly. The
problem here is fairness i.e. to ensure nobody finds the result
of the comparison first. If this was possible, people could
"probe" other people's interests and terminate the protocol
as soon as they find the answer (i.e. the result of the
"common key" comparison). I think ZK protocols would be of use
here. I am still working on this one.
Assume that in any of these protocols Alice calculates her "common key"
with X: a=g^(AX)mod n which means that she is interested in X. The
reason a must remain sercet is that if X learns it, he could calculate
all possible b(Y)=g^(YX)mod n until he finds a Y such that b(Y)=a,
in which case he will find out Alice is interested in him. Note
that X will not try all possible values for Y, but will use the
public keys of all the girls, instead.
I would appreciate any comments on these protocols and on the
use of DH "common key".
  Dimitris

@_date: 1996-03-10 06:06:44
@_author: Dimitris Tsapakidis 
@_subject: Square pegs in round holes, matchmaking, corporate mailservers 
Let's stick one thread this time. I lost track when the Subject header
was changed. Twice! :-)
The original definition of the problem:
You got me confused. Does this thing exist, or you would like it to
exist? :-)
on which Hal commented:
Correct. I believe my hash_k is equivalent to your **t (which I thought
as well, but preferred to use hash_k in my original description). Hence,
my "mediated off-line" protocol can also be written as:
- Bob, who likes Alice, sends [g**ab, pseudo(B)] to Trend who posts
  [g**abt, pseudo(B)]. Alice learns nothing at this point.
- If she ever decides she likes Bob, she sends [g**ab, pseudo(A)] to
  Trend, who posts [g**abt, pseudo(A)].
So Bob and Alice notice
g**abt, pseudo(B) and
g**abt, pseudo(A)
being posted so they know they have a match.
Somebody who knows t can only find out who is interested in them.
Nothing more.
T could possibly be replaced by n T(i)'s each of whom has a secret
key t(i). But this is another thread.
Hal added:
Assuming we have a fair AND protocol, Alice cannot initiate it with
Bob, because this would demontrate her interest. Solutions:
1) You can force all possible pairs to execute the protocol, as you
said, but is not very practical.
2) Alice could initiate the protocol even if she is not interested,
in order to "hide" the cases when she is genuinely interested. Not
very practical, either.
3) My proposal (protocol 3 in my previous posting) is that Alice
approaches Bob anonymously. But they can't execute the AND gate,
because Bob doesn't know who she talks to. What they compare is:
Alice's number: g**ab and Bob's number: g**bx where x is the
girl he likes.
Thanks, I will have a look. This will only work if there is a law
forcing newly met pairs of people to enter the protocol, as in
(1) above, right?
  Dimitris
