
@_date: 2003-08-05 15:11:41
@_author: Simple Nomad 
@_subject: Slow but interesting sender-hiding covert channel program 
References: <5.1.1.6.2.20030805003511.02eaee38
Well, I was going for cute. Actually, this is simply an expanded version
of covert_tcp. The main things I do differently is make sure the file
size is loaded into the IP ID field in the first packet, and am using
ISNs. This limits your file size to 64K, and sticks out like a sore
thumb if your sender's OS doesn't do random IP IDs.
If the sender sets the source port to a closed port on the target
system, the target system will receive an unsolicited SYN-ACK and
(assuming RFC compliance) should send a RST to the system bouncing off
of. This assumes firewalls and other network devices are not doing other
It would help if you can specify the TTL for ncovert just to avoid this
type of detection. Yes, I wrote the despoof tool as well, so I was aware
of that possibility.
Quite frankly I was truly going for the "idea" of covert communications,
to kind of get some of the Black Hat crowd thinking about it. I'm
already started on the next version, which should include a checksum
signature scheme that allows for better tracking of packets (so the
speed can be improved), forging multiple sources and using multiple
bounce locations, and randomized timing of the sending of packets -- all
ideas brought up during the Q&A as well as over beers afterward.
The tool can be retrieved from
 for those interested.
Bitches, complaints, but especially patches that address said bitches
and complaints are welcome.
