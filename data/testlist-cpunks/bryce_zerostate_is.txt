
@_date: 2013-08-22 12:00:52
@_author: Bryce Lynch 
@_subject: [Doctrinezero] HTTPS 
Hash: SHA1
It's more complicated than that.
Most of the time, whenever someone buys an SSL certificate pair signed
by a CA, they have the CA generate the certificate pair for them
(because OpenSSL's command line is pants, usually), sign it for them,
and then send them the whole mess.  The CA archives copies of the
public and private certs after signing.  We've seen several times in
the past where CAs have given untrusted third parties copies of those
signed certs.  Ouch.
There is a subtle flaw in the CA ecosystem: So long as a cert is
signed by a CA that the client trusts, it doesn't matter /who/ the
signer was.  So, example.com could buy an SSL certificate from Thawte,
and Eve could buy an SSL cert from Comodo for example.com.  Eve could
then use her cert for example.com to run a man-in-the-middle attack
against users of example.com, and their browsers would never notice
because both Thawte and Comodo are trusted.  The SSL protocol has no
provision for noticing if and when the trust chain changes in
mid-flight.  Double ouch.  We've seen this one happen in the field
several times.  This is how ComodoHacker wrecked so much havoc a few
years ago.
There is another flaw in SSL: Wildcards.  It is not uncommon for
companies to buy SSL certs valid for *.example.com, so that they have
only one cert covering all of their SSL enabled resources.  What isn't
obvious is that it's possible to generate a valid cert for *.com.  Or
*.org.  Or *.  Those certs are valid for *.com, or *.org, or * (any
SSL enabled resource on the global Net) until they expire.  A few of
the big CAs sell these for whoever can pony up for them (they're very
expensive) because they can be loaded into DPI/DCI hardware which
basically carries out MITM attacks for detecting data exfiltration.
That they are also used for surveillance comes with the territory.  At
least one CA that was pwned in the past five years had a number of
wildcard certs generated by the attacker for * which are good until 1
January 2038.  Uh-oh.
Third parties have been trying to find ways to fix this - certificate
pinning, TOFU/POP, Webs of Trust for SSL, Convergence, manually
untrusting every CA in your browser - but none of them have caught on.
