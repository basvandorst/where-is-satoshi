
@_date: 1992-12-01 09:03:17
@_author: Karl L. Barrus 
@_subject: remailer scripts 
In a previous message, Hal Finney describes in general terms how the
anonymous remailer works.
I have a "spare" account I could use to set up such scripts - it's an
HP9000 model 730 running HP-UX (if that matters).
So if someone will send me the scripts, I will try to install them and
test them myself.  And if I get it working, there will be a new anonymous
remailer for our use...

@_date: 1992-12-01 09:18:49
@_author: Karl L. Barrus 
@_subject: Nike says: Just Do It 
I agree with Mark's letter: we've philosophized enough - let's
implement a digital bank.
The only thing I have to go on is a recently posted summary of a
digital cash scenario - apologizes to the poster, I don't have the
article handy and I can't remember who nicely summarized the protocol.
If that summary isn't good enough, I'll go look for more of Chaum's
I'm willing to help pull such a feat off - even if to start I (and
anybody else who wants to help!) take Email and respond by hand.  The only high precision math routines I have are the rsa programs that
are available  (see Dave Vincenzetti's (sp?) recent
message on sci.crypt) OR what I used during my crypto class for
working through various protocols: Mathematica.  Automating the
procedure can come later, and I'm willing to work with anybody in
doing that as well.  If initially the transactions are handled by hand
and Mathematica, don't expect a rapid turnaround! :-) The nice thing
about Mathematica is that I can run it remotely and don't need to be
in front of the NeXT to do it - especially since the command line
version is good enough for out purposes: high precision integer math,
I remember the protocol involved a hash (MD5 is suggested) of an input
to produce a number.  Suggestions?  Would turning the MD5 output into
a hex number be good enough?
Anyway, I'm going to work through the protocol a few times by hand and
post again with more info in a bit...

@_date: 1992-12-01 19:20:22
@_author: Karl L. Barrus 
@_subject: anonymous remailer 
Fellow cypherpunks:
There is a new anonymous remailer for our use.  Its address is
elee7h5 at rosebud.ee.uh.edu, its name is "remailer03", and here is the
public key:
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.0
-----END PGP PUBLIC KEY BLOCK-----
Also, here is a script I have to use the remailers.  It is the
ultimate in brute force :-)  Perhaps if more people implemented
remailers, a general script can be written to bounce mail off them
all, or a subset of them all, in the style of Bill's scripts which were
recently posted.  It didn't take long at all to set up: I spent most
the time installing perl in my account, and tracing down an annoying
bug that was my fault - I forgot to make the *.pl files executable.  if [ $# != 3 ]
mail1=hal at alumni.caltech.edu
mail2=remailer at rebma.mn.org
mail3=elee7h5 at rosebud.ee.uh.edu
if [ $3 = remailing -o $3 = hal -o $3 = alumni -o $3 = 1 ]
  remail=$anon1
  mailaddr=$mail1
if [ $3 = remailer -o $3 = rebma -o $3 = 2 ]
  remail=$anon2
  mailaddr=$mail2
if [ $3 = remailer03 -o $3 = elee7h5 -o $3 = rosebud -o $3 = 3 ]
  remail=$anon3
  mailaddr=$mail3
echo "::" > $t1
echo "Request-Remailing-To: $dest" >> $t1
echo "" >> $t1
pgp -ea $t1 $remail
echo "::" > $t2
echo "Encrypted: PGP" >> $t2
echo "" >> $t2
cat $t1.asc >> $t2
cat $message >> $t2
rm -rf $t1 $t1.asc
mail $mailaddr < $t2

@_date: 1992-12-02 06:34:45
@_author: Karl L. Barrus 
@_subject: summary of remailers 
Here is a summary of the currently available anonymous remailers:
hal at alumni.caltech.edu
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.01
-----END PGP PUBLIC KEY BLOCK-----
remailer at rebma.mn.org
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.0
-----END PGP PUBLIC KEY BLOCK-----
elee7h5 at rosebud.ee.uh.edu
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.0
-----END PGP PUBLIC KEY BLOCK-----

@_date: 1992-12-02 18:17:58
@_author: Karl L. Barrus 
@_subject: digital banking, file formats, etc. 
This is a run through of Hal Finney's summary of the bank protocol.
Here is what I envision the digital bank working like, with rough  sketches of file formats, conspicuously similar to the remailer's  1) Alice chooses x, r
   Alice computes B = r^3 * f(x) mod n
   Alice sends the following message to the bank via an anonymous      ::
    withdraw
    Reply-To: In the final version, this message will be encrypted as well
2) Bank computes D = B^(1/3)
   checks  for balance, withdraws if ok
   Bank sends to appropriate remailer
    ::
    Encrypted: PGP
3) Alice computes C = f(x)^(1/3) by dividing D by r.
   Alice gives Bob (x, C) - via anonymous mail, presumably :-)
4) Bob wants to verify (x, C)
   Bob mails to Bank via anonymous remailer
    ::
    verify
    Reply-To:     In the final version, this message will be encrypted as well
5) Bank checks x to see if its been used
   Bank sends back to remailer
    ::
    Encrypted: PGP
6) Bob accepts the "cash"
   Bob sends to bank via anonymous remailer
    ::
    deposit
    Reply-To: 7) Bank checks x, C, account name; if everything OK, deposit
   Bank replies via anonymous remailer
    ::
    Encrypted: PGP
Alice and Bob may send message to and receive messages from the bank  via anonymous remailers.  Or more than one...
During the testing/development phase, account names and balances can  be made public (available via finger command or something like that)  for verification.
Account names can be hashes of some user chosen string (Email address  plus random text, etc.)
Customers must be able to   choose: two random numbers x, r
  compute: f(x)
           r^3 * f(x) mod n
           f(x)^(1/3) or C^3
  solve: D = C r mod n for C
Bank must be able to
  solve: D^3 mod n for D
So, PGP has routines which can generate random number, calculate  hashes, and be modified slightly to perform the necessary math.  The  Bank will be supported by a host of scripts and the math performing  PGP routines.
Sometime later I will post a run through of the digital bank protocol  (all numbers and done with Mathematica) as an example for those who  are interested in an example of the protocol.
Any input or comments or help will be welcome.  Or, if someone else  is further along than me, I volunteer!  Unfortunately, since the end  of the semester draws near, I will be unable to work on this very  much for the next few weeks.  Besides, I've got to go pick up the  O'Reilly and Associates Perl book to move this project along...

@_date: 1992-12-02 19:49:53
@_author: Karl L. Barrus 
@_subject: bank protocol run through 
I find it useful to work through a protocol by hand a few times to  really see what's going on.  Here is an example of the digital bank  protocol.  It is meant for people who are curious to see if it works,  as educational material for new subscribers, or general interest.
I'm choosing relatively small numbers to use: in a real  implementation, they would be much much larger.
OK, let's start!
So there it is, with numbers and Mathematica statements for those who  have access to Mathematica.  Hopefully, the numbers are large enough  to convince people it didn't work out by chance.
Now, the code to perform the math must be written, as well as the  scripts to support the bank.  Has anyone used the RSAREF routines, or  should we stick to what's supplied with PGP?  I haven't thought that  far ahead.  Like I said earlier, I'll pick up work on this in a few

@_date: 1992-12-03 11:21:49
@_author: Karl L. Barrus 
@_subject: digital banking, file formats, etc. 
I intend for the communications themselves to encrypted as well.  This
would call for the remailing request to also somehow include Alice's
public key, and Bob's communications to include his public key, etc.
This will prevent intercepted mail from tampering and keep the
anonimity.  .  Possibly the bank will have two public keys: one for
money, and one for mail.
However, in the initial phase to keep things simple, the messages
won't be encrypted - only the remailing info will.  This will
implement the anonymous part, and allow transactions, but will provide
no protection against intercepting mail, etc.  Heck, the initial
system will only allow withdrawals and deposits of a constant
denomination, so I'll worry about spoofing later :-)
I'm operating under the premise of getting something out that is
usable but not full blown.  So extra denominations, fully encrypted
messages, etc. will be added later.
Also, I received a mail from rjc at gnu.ai.mit.edu (Rob Crowley?) - whose
mail I seem to have misplaced - voicing concern over proving deposits in
the event that the bank can't be trusted.  Any of the digital currency
protocol articles discuss this issue?  I guess I need to visit the
library again and do some more research, after finals.

@_date: 1992-12-04 10:02:46
@_author: Karl L. Barrus 
@_subject: No Subject 
This is important, which is why its nice to have source code.
However, be prepared to invest a little :-) time in the study of PGP's
code; I recently printed it out and must have sucked a toner cartridge
nearly dry as it took more than 500 pages!  Check out 'wc -l *.[ch]'
which results in 22720 lines for me.
Get the md5.doc from rsa.com - available via anonymous ftp.  It
explains the algorithm (which is largely bitwise operations on blocks
of the input stream) and even includes source code.
Somebody posted a cryptographically strong prng to sci.crypt recently,
but I haven't had a chance to look it over.  I have my own rng - a ten
sided die, which I haven't had occasion to use, yet.  Phil Karn's DES package includes source code for uuencode, which
performs this translation.  I'm sure it is somewhere in the PGP code
as well.  There is also RFC 1113.
Close!  That looks like the formula for solving ax mod n = d for x
given a, n, d.
RSA: pick two primes p and q.  Then n=pq.  As Hal Finney said, the two
primes should be "good" in the sense that p-1 and q-1 have no small
prime factors.  Obviously, you can't avoid having 2 divide p-1 and
q-1, but that should be about it.  Also, p and q should differ in
length by a few digits otherwise an enemy may begin to try factoring n
by starting near sqrt(n).
Pick a decryption exponent d.  d and phi(n) should be relatively
prime, where phi(x) = Euler totient function = # of numbers less than
x which are relatively prime to x = x-1 for x prime.  For n, phi(n) =
(p-1)(q-1).  Calculate the inverse of d mod phi(n) and call it e, your
encryption exponent (e = d^(-1) mod phi(n)).  Publish n and e as your
public info, and keep d secret as your decryption key.
Somebody encrypts a message by calculating M^e mod n.  You decrypt the
ciphertext by calculating C^d mod n.
For example: p=7, q=11 => n=77 and phi(n)=60.
I pick d=13, gcd(13,60) = 1 so it is acceptable.
Then e = 13^(-1) mod 60 = 37.  Check: 13 37 mod 60 = 1.
A message M=20 is encrypted as 20^37 mod 77 = 48.
I decrypted the ciphertext 48 like this: 48^13 mod 77 = 20, and I got
back the original message.

@_date: 1992-12-13 14:56:08
@_author: Karl L. Barrus 
@_subject: Electronic P.O.Boxes 
only way to be able to receive "anonymous replies" is for you to
include in your message the appropriate header.  This is the method I
use: create the necessary remailing request to your real mail address,
and include that with the instructions on how to use it.  For example:
----here is a sample letter----
reply, cut everything below the marks, add your text on the end, and
send the whole thing to this address: -----cut here-----
Encrypted: PGP
----cut here----
----end of the sample letter----
It works!

@_date: 1992-12-15 09:43:54
@_author: Karl L. Barrus 
@_subject: remailer extension (contact field) 
I've added a contact field to my remailer.  To contact me (the
operator of remailer03 ) you can use the
following header:
----cut here----
----cut here----
Note the colon after contact and the blank line at the end.
Encryption of this header is supported as well; you can reach me by
encrypting this contact header and doing the usual.
For those interested - here are the changes to maildelivery and
remail.pl (I haven't been able to study the remailer code much, and am
just learning perl, so this can probably be improved.)
Changes to maildelivery, before the * on the last line
Add the following: (I spaced everything out in the file)
Contact  ""  pipe R  remail.pl
Contact  ""  file A  archive.remail
Add to remail.pl, before the block that begins
                  if (/^Request-Remailing-To:/ || /^Anon-To:/)
if (/^Contact:/) {
  chop ;
  s/^.*// ;
  $addressee = $_ ;
  $addressee = "my.id at some.other.machine" ;
I don't know perl well enough to figure out what can or can't be
deleted (specifically the $addressee = $_ line, etc.)

@_date: 1992-11-15 18:43:30
@_author: Karl L. Barrus 
@_subject: Chaum's papers 
What else has Chaum written about?  I saw his Scientific American
cryptomoney article, and have heard of his dc-nets, but what other
protocols has he discussed?  Any pointers on journal articles would be
appreciated - I think tomorrow I'll hit the library and go sifting for
everything Chaum has written!

@_date: 1992-11-29 07:38:56
@_author: Karl L. Barrus 
@_subject: crypto banking 
I'd like to see a digital bank go up as well - just to be able to work
through the protocol, at first.  I took a cryptography course last
summer at the university, and learned a lot (and had some fun!)
working through various protocols: coin flipping, poker, subliminal
channels, number comparison without giving away the numbers involved,
signatures, etc., and more recently since joining this group: dc-nets.
It doesn't have to be fancy: this list or maybe just email between
various participants at first, maybe then a fancier system with
transactions posted or made public for study, then a more advanced
system with telnet or mail to the digital bank and transactions kept
private.  We could make everybody's account balance public and then
study ways to avoid traffic analysis on account fluctuations (maybe
the only way to do this is to keep balances secret) - maybe everyone
can have more than one account and pay off transactions with a little
bit from each account (this would be inconvenient though...)

@_date: 1992-10-21 13:26:56
@_author: Karl L. Barrus 
@_subject: the acronym TEMPEST 
TEMPEST = Transient ElectronMagnetic Pulse Emission STandard.  Pretty
cool sounding acronym :-)

@_date: 1992-10-21 13:44:45
@_author: Karl L. Barrus 
@_subject: fast elliptical encryption 
In the winter NeXTWorld magazine, the article ("Tales from the Crypt")
on page 94 mentions various topics of interest: public key encryption,
export restrictions, the role of the NSA, etc.  (It's just a one page
article and doesn't go into much depth).
Anyway, NeXTStep 3.0 is bundled with fast elliptical encryption for
NeXTMail.  As a result, 3.0 is export restricted.
Does anybody know about the "fast elliptical encryption" public-key
system?  How different is it from good ol' RSA?  Is it related to the
elliptic-curve factoring algorithm (am I remembering this correctly -
I don't know how elliptic curve factoring works, but I remember seeing
a reference to it somewhere)?
Just curious...

@_date: 1993-01-04 12:04:01
@_author: Karl L. Barrus 
@_subject: Acceptance of Keys 
"unacceptable" to accept keys electronically is that you may be
vulnerable to spoofing.  Okay, in reality, you have to realize that
attacking cryptographic protocols is a paranoid view of things, and
that you may not be attacked, but... if you send your public key to
somebody, it could be possible for someone to eavesdrop, grab your
key, substitute their own, and send that one along.  Then when someone
responds to "you", the eavesdropper could read the message, re-encrypt
it with the public key they stole, and send it along to you.  Then,
you don't even know you are the victim of eavesdropping.
Which makes it tough unless you can meet people face to face.
However, the latest version of pgp contains an option which computes
the md5 hash of your public key - which allows you to call someone,
and read each others hashes, thus completing the verification over the
phone.  Of course, now you have to worry about receiving their correct
phone number... :-)

@_date: 1993-01-07 11:10:50
@_author: Karl L. Barrus 
@_subject: double anonymity via pax and penet 
penet together.  Briefly, the anonymous service at anon.penet.fi
supports anonymous remailing (but you must register your id),
anonymous posting, and anonymous forwarding.  The remailer at
pax.tpa.com.au support anonymous remailing (runs pgp, must register
your key for encryption service) and anonymous posting.  For more
info, get the help files by mailing to help at anon.penet.fi and
anon.info at pax.tpa.com.au.
services to establish an id on the other one, and also establish a
path back to you.  Then, you should be able to receive mail by having
it sent to an anonymous id on one of the services, which will then
forward it to another anonymous id on the other service, which will
then forward to you.
cryptographically protected remailers, but I thought I'd explore using
these others ones also.
you can get one by simple trying to use it (for example, posting a
message).  Since the remailer at anon.penet.fi allows anonymous
forwarding (using the % notation), I established a double system as
follows: (for convenience I shall reveal the anonymous id's I was
assigned by this test procedure;  shall mean  and
 shall mean I mailed to anon.post.alt.test%pax.tpa.com.au at anon.penet.fi from
barrus at tree.egr.uh.edu.
This went to anon.penet.fi, where I was allocated an anonymous id for
barrus at tree.  The id I was given for barrus at tree was an5022 at penet.
Then, penet forwarded to anon.post.alt.test at pax.tpa.com.au (because of
the % notation), which resulted in two things: a post to alt.test, and
the establishing of an id on pax for the anonymous id on penet -
anon.435 at pax.  After a few minutes, I recieved acknowledgment of my
post to alt.test, sent from penet.  So pax sent the acknowledgement to
the anonymous id at penet, which then sent it to me - barrus at tree.  I
also watched for my post to alt.test to appear, which it did.
pax allocated from my other account (elee9sf at menudo.uh.edu).  I sent
from the other account because I already have an anonymous id for that
one, and I wanted to keep new account allocation to a minimum, but as
it turns out I think I messed up.  Anyway, the mail I sent made it to
barrus at tree (via pax and penet), but I was allocated another anonymous
id from penet (an5030 at penet), and the notice came to elee9sf!
acknowledgement must be.  When I mailed to anon.435 at pax from elee9sf,
I wasn't allocated an anonymous id because I have one.  So pax sent
the message to an5022 at penet.  But penet hadn't seen a message from
anon.435 at pax, so it allocated another id, and sent to acknowledgement
back to anon.435 at pax.  But for some reason, the remailer at pax didn't
send this to an5022 at penet - it jumped it and responded to my account
elee9sf at menudo.uh.edu.  So the pax service seems fairly intelligent.
Or there is a bug :-)
thought I would be assigned an anonymous id at pax for barrus at tree,
but I wasn't.  Actually, for some reason, I was mailed the
acknowledgement of yet another anonymous id, an5047 at penet!
which would forward to an anonymous id on penet (and vice versa), and
I succeeded:
  mail sent to anon.435 at pax goes to barrus at tree via penet
  mail sent to an5030 at penet goes to elee9sf at menudo via pax
as an unplanned effect:
  mail sent to anon.437 at pax goes to elee9sf at menudo via penet
  mail sent to an5047 at penet goes to barrus at tree via pax
of this procedure: an5022 at penet, an5030 at penet, an5047 at penet (I don't
understand this one), anon.435 at pax, anon.437 at pax (I don't understand
this one either).  I figured I would use four id's: one from penet for
barrus at tree, one from pax for barrus at tree, one from penet for pax, and
one from pax for penet.
from barrus at tree, the mail doesn't arrive in either of my accounts.
So I'm still trying to sort out this mess before I mail to the
administrators at both sites, explain what happened, and have these
various id's deleted.  Anybody with an id already established on pax
or penet is welcome to mail to me at anon.208 at pax or an5030 at penet to
help me figure out if it worked (I've run out of accounts to test this
from and I don't want to involve elee7h5 at rosebud where I'm running a
from elee9sf, where I have an id.  Maybe by mailing from barrus at tree I
would have been assigned an id, and recieved acknowledgement of an id
from penet for the id at pax, and possibly an5047 at penet wouldn't have
been generated.
cypherpunk remailers to the first link in the pax/penet remailers
chain.  This would hide our remailers from others, since pax and penet
are well known anonymous services.  I haven't thought of a way to send
messages (other than posting to usenet) via pax/penet.  So I could
post a message, as described above, and collect responses via a double
anonymous reply.

@_date: 1993-01-07 13:53:49
@_author: Karl L. Barrus 
@_subject: chaining remailers... 
Geez, I can't beleive I forgot to consider that responding to me will
result in a steady stream of anonymous id allocations.
Guess I was caught sleeping on that one!
Back to the better cryptographically protected cypherpunk remailers
and Hal's "constructed" anonymous addresses...and I better ask the
administrators at pax and penet to wipe out some allocated id's :-)

@_date: 1993-01-10 21:42:51
@_author: Karl L. Barrus 
@_subject: No Subject 
Hal <74076.1041 at compuserve.com> said:
Actually, what I expected to happen was this: the acknowledgement of
an anonymous id on penet for the anonymous id on pax would be
generated, and this ack would be sent via the chain back to me
(barrus at tree) since I established the chain.  That is, I had linked anon.435 at pax to an5022 at penet to barrus at tree.
Then, upon mailing to anon.435 at pax from my other account (which
already has an anonymous id established, so another would not be
generated), the mail would proceed to an5022 at penet, which would create
an id and send it back to anon.435 at pax.  Now I expected this ack to
then be turned right around, send to an5022 at penet and then on to
barrus at tree.  So I was expecting the creation of another anonymous id,
but the acknowledgement didn't go to barrus at tree.
My original thinking was that once I established the id's in both
direction, when someone responded to anon.435 at pax, they would be
allocated an id if they didn't have one.  And since penet had by this
time seen anon.435 at pax, no new id would be made, and the mail would
proceed on the me.  Anyway, that was an experiment that seems to lead to explosive
anonymous id growth :-) I agree with Matthew that not mailing back an
ack would help cut down the flurry of mail, but it still results in
all sorts of extra id's.  I was hoping the whole thing would be like a
pointer: mail to id1 at pax forwards to id2 at penet and then on to me with
no extraneous account manufactured.
But since we have our own cryptographically protected remailers, we
cypherpunks can make our own remailing chains (Hal's constructed
anonymous addresses).  This way, you can decided on the path of your
outgoing mail and your return mail: create the appropriate header, and
attach your message on the end.  To receive responses, just send a
response header with the return path encrypted along with instructions
to your recipient to cut the response header into a new file, add a
message to the bottom, and mail to the appropriate remailer.  (Note:
I've used this method successfully twice, so it isn't too hard to do).
Just remember that if your recipient doesn't have pgp, don't route
your mail through extropia or their message will be blocked.
If I get a chance I'll work on a program that will generate the
appropriate header given routing input.

@_date: 1993-01-11 13:03:35
@_author: Karl L. Barrus 
@_subject: constructed anonymous addresses 
Had sort of a slow day at work, so I had the chance to crank out this:
Here is a rough script which will allow you to route your mail through
the various remailers.  (However, extropia is not yet supported...I'm
working on it).  You must have the public key for each remailer on
your keyring.
Save the file, run it, and it will prompt for 1) mail, or 2) header.
Choose 1 to pick a path and send a file, choose 2 to create a header
which can be used to reach you.  I intend option 2 to be used as
follows: create a message to someone you want to remain anonymous
from, run the script, pick 2, follow the prompts, and then instruct
the script to append the header to your letter.  Then your recipient
will be able to follow the directions and respond to you.
When the script prompts for "And then to (1-3 or address)", to end the
process, type the final address you want your mail sent to.  Of
course, if you are creating a header, you'll want to type your own
Further improvements include supporting extropia; and rewriting in C,
perl, awk, ksh, or any language with arrays!
I've tested this script using the remailers at alumni and rosebud,
because the turnaround time seems faster.  But there is no reason
that rebma shouldn't work as well.
--------8<--cut here-->8--------
# support script for anonymous remailers
# allows routing a message through various remailers
# NOTE: extropia remailer not supported just yet
 out which mode user wants
echo "Do you want to:"
echo "1. Create routing and mail a file"
echo "   This will allow you to specify the route your message will take,"
echo "   and mail a file through that route."
echo "2. Create remailing header"
echo "   This creates an appropriate remailing header, with instructions."
echo "   Include the generated file in one of your own messages and"
echo "   someone else can use it to reply to you."
read choice
 remailers
mail1=hal at alumni.caltech.edu
mail2=remailer at rebma.mn.org
mail3=elee7h5 at rosebud.ee.uh.edu
mail4=remail at extropia.wimsey.com
 files
 up header
echo "::" > $t1
echo "Encrypted: PGP" >> $t1
echo "" >> $t1
 out .anon3
cat /dev/null > $t3
 menu
echo ""
echo "1) $mail1"
echo "2) $mail2"
echo "3) $mail3"
 "4) $mail4"
echo ""
 hop
echo "Mail to (1-3): "
read to
 from number to address
if [ $to = "1" ]
  to=$mail1
elif [ $to = "2" ]
  to=$mail2
  to=$mail3
 loop
while [ $notdone ]
 out remailing request
#	echo "remailing to $rto; encrypted for $to"
if [ $choice = "1" ]
 include message
  echo "Message to include? "
  read msg
  if [ ! -f $msg ]
  then
    echo "$msg not found"
    exit 1
  fi
  cat $msg >> $t3
  elm -s "anonymous mail" $firsthop < $t3
  echo "Append to file: "
  read msg
  echo "--------8<--cut here-->8--------" >> $msg
  cat $t3 >> $msg
  echo "" >> $msg
  echo "> $msg
  echo "> $msg
  echo "> $msg
rm -rf $t1 $t1.asc $t2 $t2.asc
 of script----------------------------

@_date: 1993-01-12 20:00:31
@_author: Karl L. Barrus 
@_subject: security of constructed addresses 
Alert!  Hal Finney has alerted me to a problem with the way my script
builds an anonymous remailer chain.  Simply saving eachheader portion
into a seperate file and running pgp on the pieces reveals each link
in the chain.
The solution (also from Hal Finney) is: hide the intermediate hops
until they get to the machine that needs them.
(machine1, encrypt1(machine2, encrypt2(machine3, encrypt3(user at dest))))
Here, the entire header is decrypted at each remailer, revealing the
next destination to that remailer only.  No peeking ahead!  The only
remailer that will be revealed is the first one, where mail has to be
sent anyway.
I'll rework the script, provide a ksh version, and write a little help
file ASAP.

@_date: 1993-01-12 20:12:55
@_author: Karl L. Barrus 
@_subject: mental poker 
Okay, anybody want to play mental poker with me???
A protocol involving bit committment was posted to sci.crypt recently,
which we can use to play.  There is an RSA protocol, but a commutative
encryption/decryption is required, which I don't think PGP provides.
So here is the protocol:
1) A shuffles cards, creates a message M1 that lists the cards by
number.  A appends a random bit stream, and computes the hash (using
MD5).  A sends hash MD5(M1) to B.
2) B composes message M2 that lists the cards he chooses by number.  B
appends a random bit stream, and computes the hash.  B sends the hash
MD5(M2) to A.
3) A sends B M1 so B can get his cards.
4) B shuffles the remaining 47 cards, lists them by number, appends a
random bit stream to create M3, and computes the hash.  B sends hash
MD5(M3) to A.
5) A chooses cards by number, appends a random bit stream to create
M4, and computes hash.  A sends MD5(M4) to B.
6) B sends A M3 so A get get her cards.
A and B can catch cheating by comparing the various message and
Getting extra cards can be left as further extensions, as can multiple
players (3 or more).
Any takers?
By the way, the hash function implementation I have is the sigfetch
routine contained in tripwire.  It includes md5, md4, md2, snefru,
crc, and crc32.  So before a game starts the players should verify
their respective hashers.

@_date: 1993-01-13 09:15:34
@_author: Karl L. Barrus 
@_subject: mental poker protocol 
Oops.  I typed too quickly; the posted protocol specified shuffling
the entire deck to form message M3.  Thus, each player draws from a
full deck.  While this isn't exactly poker, I'm still willing to play
somebody.  So Hal's right: the original protocol is different - it's
not broken like the one I posted :-)
The post to sci.crypt was in response to a bit commitment question.
Here, players commit by making public their hashes.  Later, everyone
can verify when the messages are known.
If anyone's interested, send me a notice to elee9sf at menudo.uh.edu.
(The server for my other account is acting erratic and I'm considering
moving my subscription).

@_date: 1993-01-13 17:42:17
@_author: Karl L. Barrus 
@_subject: new remailing script 
Here is the new sh version of the remailing script.  Enjoy!
# support script for anonymous remailers
# allows routing a message through various remailers
# NOTE: to use extropia remailer, uncomment the appropriate lines
#       see the documentation file
 out which mode user wants
echo "Do you want to:"
echo "1. Mail a file via anonymous remailers"
echo "2. Create a remailing header and append to a file"
echo ""
echo -n "Your choice? "
read choice
if [ "$choice" = "" -o "$choice" -lt 1 -o "$choice" -gt 2 ]
  echo "Error.  Improper mode selected."
  exit 1
 remailers
mail1=hal at alumni.caltech.edu
mail2=remailer at rebma.mn.org
mail3=elee7h5 at rosebud.ee.uh.edu
mail4=remail at extropia.wimsey.com
 files
 up encrypted pgp header
echo "::" > $t1
echo "Encrypted: PGP" >> $t1
echo "" >> $t1
 out .anon3
cat /dev/null > $t3
 final destination
if [ "$choice" -eq 1 ]
  echo -n "Final destination (user at host): "
  echo -n "Your email address (user at host): "
read to
 if no final destination
if [ ! "$to" ]
  echo "Error.  No destination specified."
  exit 1
 menu
echo ""
echo "Mailing via:"
echo "1) $mail1"
echo "2) $mail2"
echo "3) $mail3"
 "4) $mail4"                      # uncomment to use extropia
echo ""
 loop
while [ $notdone ]
 out remailing request
  echo -n "via (1-3 or q)? "
  read rto
  if [ "$rto" = "" -o "$rto" = q ]
  then
  else
 number to address
#	  4) rto=$mail4;;              # uncomment to use extropia
 up remailing request header
#	echo "remailing to $rto; encrypted for $to"
  fi
if [ "$choice" -eq 1 ]
 include message
  echo -n "Message to include? "
  read msg
  if [ ! -f "$msg" ]
  then
    echo "Error: $msg not found"
    exit 1
  fi
  cat $msg >> $t3
  mail -s "anonymous mail" $to < $t3
  echo "Mail sent."
elif [ "$choice" -eq 2 ]
  echo -n "Append to file: "
  read msg
  echo "--------8<--cut here-->8--------" >> $msg
  cat $t3 >> $msg
  echo "" >> $msg
  echo "> $msg
  echo "> $msg
  echo "> $msg
  echo "Error. Invalid choice."
  exit 1
 up some of the temporary files
rm -rf $t1 $t1.asc $t2 $t2.asc

@_date: 1993-01-13 17:46:04
@_author: Karl L. Barrus 
@_subject: help file for remailing script 
And here is a short help file I've written.  I will try to write
another version of this script (maybe in perl or something) and submit
everything to be placed on the ftp site.  To cut down on mail, I won't
be mailing further versions, etc. to the list, so request it from me
or get it via ftp (once I get around to submitting it).
hop.mail is a shell script that automates the process of using the
cypherpunk cryptographically protected remailers.  Briefly, it has two
modes of operation: one is to send a file, the other is to create a
header which can be used by someone else to send a file to you.
WHAT YOU NEED TO HAVE
Well, you need to have PGP installed.  Also, you'll need the public
keys of the various remailers on your keyring.
SENDING A FILE
Create the message you want to mail, and save it as a file.
To send a file, choose option 1.  You will then be prompted for the
final destination of the file you would like to send (by final
destination I mean email address).  After that, the script will
continue prompting you for routing information.  Each remailer you
specify routes your mail through that particular remailer.
Note: due to the way the remailing headers are built up, the path your
file will actually take is the reverse of what you specify.  That is,
the first remailer you route through will be the one you file will
appear to come from.  The last remailer you specify is actually the
first hop in the chain.  After routing your mail through as many remailers as you want (keep in
mind that your mail will arrive slower the more hops you take), enter
'q' to exit.
After you have set up your mail route, the script will ask what file
you wish to send.  The file is simply appended on to the header, and
the whole thing is sent off.  No encryption of the file takes place.
If you wish, you may encrypt the file you want to mail with your
destination's public key or some other encryption scheme.  The
advantage of not encrypting the message in with the remailing header
is that you can use this script to mail to people who don't use pgp.
CREATING A HEADER
Create the message you wish to send and save it as a file.
Choose option 2 to create a header.  The steps are similar to sending
a file, except remember that someone will use this to reply to you, so
type in the address you want them to respond to.  This can be your
real mail address, or an anonymous id on one of the various anonymous
services, or anything else.  Route your mail like you want, and enter
'q' to exit.
At this point, you will be prompted for a file to append to (the
message you created).  Enter the file you want the remailing header
appended to.  Now you have a file which contains the message you
typed, as well as instructions on how whoever you mail it to can use
the included header to reply to you.  If you wish, you may mail this
file via option 1!
My first attempt at this script simply built each header separately.
This worked, but was vulnerable: simply save each piece in a separate
file, run pgp on them, and you will be told which remailer the header
is encrypted for!
This version nests the encryption, so that only the next destination
is revealed to the current remailer.  That is, the structure of the
header is:
encrypt1(address2, encrypt2(address3, encrypt3(message)))
So when your file arrives at remailer1, the header is decrypted to
reveal the next hop, and the rest of the header is mailed off the
remailer2, where it is decrypted to reveal the next hop, etc.
As I said above, the file you send is not encrypted.  If it bugs you
that your file is mailed plain text, then encrypt it first if the
person you are sending to can decrypt.  I purposely did not encrypt
the file you want to send so you can use this procedure with people
who don't have pgp.  Or you can post to usenet via a email-to-usenet
gateway.  Or whatever.
Also, the remailer at extropia is not supported yet.  Not because I
don't like it, but because encryption must be used there.  This isn't
bad or anything, but it causes difficulty building the remailing
header separately.  Extropia will not allow you to mail plain text
through it, you must encrypt it with extropia's public key.  So if you
do that, then you should be able to use extropia, and you'll need to
go through and uncomment the appropriate lines.
Finally, the mail command I used in the script is Make the appropriate changes if you want to use another mailer or
change the subject line Ug.  :-)  Send reports of problems to elee9sf at menudo.uh.edu, or
barrus at tree.egr.uh.edu, and I'll look into them!  Or, send any
comments you might have.

@_date: 1993-01-14 06:36:40
@_author: Karl L. Barrus 
@_subject: anonymous service shutdown (pax) 
This was posted to alt.security.pgp: (I trimmed the header)
The anonymous and encrypted mail service at PAX has been shutdown.
The site that connects PAX has been told by someone from AARNet (the
Australian Academic Research Network) that the service is unsuitable
for AARNet, and that if it is not stopped then the feeding site will
be disconnected from the net.
There has been no communication from AARNet to me or anyone else at
PAX, but I cannot allow the feeding site to put itself at risk hence
the service is closed until further notice.
I am lead to believe that this is not so much AARNet's policy, but the
NSF Net's policy and the NSF have brought pressure to bear on AARNet,
as they believe that all mail that crosses their network must be traceable
to its origin, ipso facto no anonymous mailers. I have not been approached
by either organization personally so I cannot confoirm this.
I am extremely disappointed but c'est la vie.
It was an interesting experiment, and proof that the concept of anonymous
encrypted mail is feasible with simple tools. Hopefully someone somewhere
outside the jurisdiction of these authorities will be able to continue the
good work.
david clunie (dclunie at pax.tpa.com.au)
ex-anon.admin at pax.tpa.com.au :(

@_date: 1993-01-21 06:15:39
@_author: Karl L. Barrus 
@_subject: PGP on BBS 
Well, you could always allow the users to download the public key file
and do the encryption on their home machine, and then upload the mail file.
That way their secret key stays off the BBS...
