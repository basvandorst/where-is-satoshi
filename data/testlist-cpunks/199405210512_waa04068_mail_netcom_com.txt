
@_date: 1994-05-20 22:12:30
@_author: catalyst-remailer at netcom.com 
@_subject: Is my DH exchange secure? 
nelson at sgi.com describes some of the precautions required to use DH
exchange safely:
** begin quoted text ***
The prime p wants to be chosen with a little care, and the "random" numbers a and b may want to be "selected" to eliminate certain undesirable values.  I'll explain below.
Within the field Z_p (the set of integers 0..p-1) where p is prime,
there are elements whose successive powers make up all the elements of
the field Z_p.  These numbers are called "primitive" elements or
"generators" of the field Z_p.  That is, if g is a generator of the field Z_p, then the successive powers g, g^2, g^3, ...  g^(p-2), g^(p-1) mod p include all the p-1 non-zero elements of Z_p.
The set of unique numbers produced by taking succesive powers mod p of an
element m of Z_p is a group, the "multiplicative span" of m, which is a subgroup of Z_p.  The number of elements in the group generated by m
is called the "order" of m.  Primitive elements of Z_p have order p-1.
Not all of the elements of Z_p are primitive.  Some elements of Z_p have very small orders.  At least one element will have order 2.
Given that p is prime, the orders of the elements of Z_p will all have
values that are products of some or all of the prime factors of p-1.
Since p is prime (and p=2 is not interesting ;-), p-1 will contain the
factor 2.
An small example may make this point clear.  Let p == 11.
The prime factors of p-1 are 2 and 5.  Hence we expect the orders of the elements of Z_11 to be 2, 5, or 10.  By enumerating the groups of the elements of Z_11 we see this is so (for Z_11).  E.g.
Element Ring                            Order
