
@_date: 2004-10-13 20:59:40
@_author: Joerg Schneider 
@_subject: Certificate serial number generation algorithms 
Richard Levitte - VMS Whacker schrieb:
- Another option that I've seen is to use a counter and encrypt it with a block chipher using a fixed key. This guarantees uniqueness (because encryption is bijective) while concealing the counter and using less bytes than a hash.

@_date: 2005-01-06 11:57:30
@_author: Joerg Schneider 
@_subject: Banks Test ID Device for Online Security 
Same here in Germany. The banks send you paper lists with TANs (transaction numbers, e.g. 100 per list), which you to enter in addition to your PIN. For each transaction you need a new TAN.
Unfortunately that does not prevent MITM phishing (see separate post "Re: AOL Help : About AOL? PassCode"

@_date: 2005-01-06 11:44:02
@_author: Joerg Schneider 
@_subject: AOL Help : About =?ISO-8859-1?Q?AOL=AE_PassCode?= 
So, PassCode and similar forms of authentication help against the current crop of phishing attacks, but that is likely to change if PassCode gets used more widely and/or protects something of interest to Actually I have been waiting for phishing with MITM to appear for some time (I haven't any yet - if somebody has, I'd be interested to hear about), because it has some advantages for the attacker:
* he doesn't have to bother to (partially) copy the target web site
* easy to implement - plug an off-the-shelf mod_perl module for reverse proxy into your apache and add 10 minutes for configuration. You'll find the passwords in the log file. Add some simple filters to attack PassCode.
* more stealthy, because users see exactly, what they are used to, e.g. for online banking they see account balance etc. To attack money transfers protected by PassCode, the attacker could substitute account and amount and manipulate the server response to show what was entered by user.
Assuming that MITM phishing will begin to show up and agreeing that PassCode over SSL is not the solution - what can be done to counter those attacks?
Mutual authentication + establishment of a secure channel should do the trick. SSL with client authentication comes to my mind...

@_date: 2005-03-04 13:44:42
@_author: Joerg  Schneider 
@_subject: Colliding X.509 Certificates 
are identical except for the public key and that the attacker knows the
private keys for both.
Do you think it would be possible to modify the attack, to get different
Subject DNs or SubjectAltNames under the control of the attacker? This
would scare me more.
On a different note:
In a real life scenario a CA would accept PKCS requests, create the TBS
using parts of the requests, providing other parts like notBefore/notAfter
and the serialNumber, and finally sign the result. This would make the
attack more difficult, as the attacker would have to guess, what the CA
makes out of the request, including time of issuance and serialNumber.
Do you think choosing the serialNumber in a way that it cannot be guessed
by the attacker would be an effective way to counter collsion based
attacks on CAs?
Best regards,

@_date: 2005-03-11 11:52:00
@_author: Joerg  Schneider 
@_subject: Colliding X.509 Certificates 
number or RDN component (after all, a CA should vet the DN and not simply sign what's in the PKCS request), such that the public key does not end up at an "appropriate" DER-encoded offset in the
Yes, there seem to several possibilities to defend against this kind of attack in a real world scenario. Modifying the subject DN in a way
un-predictable by the attacker is one of them. For Benne's attack it would
be enough to modify its length, so that the public key doesn't get to the
required offset.
I would like to have a general way to fend off collision attacks on
certificates. To this end I propose that the CA generates the certificate
serialNumber in a way that cannot be guessed. Some CAs are already doing
this, I guess mainly to prevent people from seeing how many certs they
There are several advantages of using the serialNumber:
* it has no semantics that we might break, as long as we make sure it
stays unique
* it is one of the first items in a certificates, before any content an
attacker might control
* its no problem to make it e.g. 128 bits long
By putting an un-guessable value in the serialNumber, the attacker is
faced with a similar problem as with a HMAC, which people believe are not
affected by the known collision attacks. For this reason I believe with
un-guessable serialNumbers, we should be safe to use a hash function,
which is not collision resistant, as long as it is 2nd pre-image
Its rather easy to implement un-guessable servialNumbers:
* use a cryptographically strong PRNG (and keep the seed secret) or TRNG
* encrypt a counter with a block cipher (and keep the key secret)
Best regards,

@_date: 2005-03-11 12:51:39
@_author: Joerg  Schneider 
@_subject: Xiaoyun Wang et. al.: Full paper on last year's MD[45]/RIPEMD  
Xiaoyun Wang, Hongbo Yu: How to Break MD5 and Other Hash Functions,
Xiaoyun Wang, Hongbo Yu: Cryptanalysis of the Hash Functions MD4 and RIPEMD,
