
@_date: 2003-07-04 11:06:04
@_author: tom st denis 
@_subject: LibTomNet [v0.01] 
[repost from sci.crypt]
Oh no, not another LibTom thing! arrg!
First the temp url...   I'll get a
net.libtomcrypt.org VHOST setup shortly.
LibTomNet is a library designed to provide streaming TCP/IP privacy and
authentication.  It uses LibTomCrypt as the crypto provider.
The lib uses RSA for key exchange [and the client may scrutinize the
key before making the connection via a callback], AES-128-CTR [two
different keys for each direction] and SHA1-HMAC.  The niche of the lib
is that my library compiles to a mere 10KB.  Add SHA1, AES, HMAC, RSA
and LTM and you get 60KB demo apps   Ideally you should build LTC
without mpi.o and link against both LTC and LTM.
The lib does not implement any other protocol like SSH/SSL/TLS [etc].
I have to mention this in good conscience.  I ==>STRONGLY<== DISCOURAGE
people from using this library in fielded systems.  I've only been
working on it for a day and I wouldn't be surprised if there were
numerous bugs or points of attack [I've fixed a dozen since last
That being said the code uses fairly standard BSD style socket calls.
It works in Linux and should port rather trivially to QNX, UNIX, IRIX
and Win32 [among others].  What I would appreciate is if people could
help and send patches to get the code to work in other OSes.
I'd like to get it working in at least Linux and Win32 by next week.
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-07-07 16:07:43
@_author: tom st denis 
@_subject: LibTomNet [v0.01] 
Maybe its just me but SSL is overly complicated.  I've been dabbling
with crypto since I was sixteen.  I've written several popular libs
already [LibTomCrypt and LibTomMath] so while I'm not a PhD in crypto I
think I'm fairly competent enough to sit down and implement an
algorithm per specs [to a limit].
Two weeks ago I sat down to learn how to code my own SSL lib [key on
being small].  Suffice it to say after reading the 67 page RFC for SSL
3.0 I have no clue whatsoever how to implement SSL.  The RFC looks like it was written by a member of the ACLU and done at
an hourly rate of some sort.  It contains no test vectors, no sample
source code and generally is not enough information to code a compliant
SSL protocol.
So I wrote LibTomNet.  It provides exactly what I wanted and is very
simple to understand and work with.
My 64KB demo includes the server, the client, all the crypto [including
a full RSA implementation] and the LibTomNet protocol.  I could make
the demo smaller by manually trimming LibTomCrypt.
Not only is my code way smaller than a compliant SSL library but it is
also simpler.  There are only eight functions in LibTomNet and of
LibTomCrypt you only need a half dozen at most [setup the prng, RSA key
gen, export/import].  In otherwards my code is [should be] very easy to
work with since there is a minimum of clutter to get in the way.
I mean just download a copy [v0.03 is the latest] and check out the
demo [demos/ex1.c]!
At anyrate LibTomNet is not an SSL replacement.  It's a library for
developers who need simple to work with secure sockets.
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-07-07 17:37:09
@_author: tom st denis 
@_subject: LibTomNet [v0.01] 
No he can't.  You need a correct HMAC for the data to be accepted. This allows a replay attack which I should fix.  One beer.
Ultimately though the plaintext won't match if you replay though so its
only half a bug [though a bug that must be fixed].
I don't even know what that is but my protcol must read an entire block
before parsing it.
Which is why people should use some authentication scheme ontop of
this.  Note that the server has no clue who you are after making the
connection.  This is intentional.\
So if you are in the area [or at Crypto'03] I'll buy you a beer.
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-06-03 15:48:42
@_author: tom st denis 
@_subject: Analysis of TKIP from 802.11i 
Tommorow afternoon I'll be unleashing a paper on the TKIP algorithm
from 802.11i on my website.  My attack breaks the algorithm in "theory"
and cannot be used in practice just yet.
Just want to get some attention to the paper.  I've never really broken
a fielded algorithm and I'd be grateful for feedback [and perhaps some
peer review].
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-04 12:24:57
@_author: tom st denis 
@_subject: Analysis of TKIP from 802.11i 
I ran into some snafu's.  My attack was based on a truncated
differential [which does exist] but I forgot to take into account the
S/N ratio.  Turns out the attack doesn't work.
I'm going to re-target the paper I was writing and present what results
I did come up with anyways so others will know what I tried.
As it stands right now I haven't broken the TKIP algorithm [in the
black box model I was using].
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-05 06:34:38
@_author: tom st denis 
@_subject: TKIP Paper [draft] 
A draft of the paper is available at Keep in mind I torpedo'ed my attack which was the crux of the paper in
mid stream... So if the paper seems a bit hurried that's because
several people have privately written asking to see it [regardless of
the fact].
So if you want to see what I was tinkering with by all means go ahead.
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-08 14:47:02
@_author: tom st denis 
@_subject: An attack on paypal 
I disagree.  That attack is more akin to a "Hi, I'm calling from
{insert bank here} and we need your CC info to update your file."
That doesn't mean credit cards [nor your bank] are flawed.  It means
you're an idiot for giving out the information.
Note that this "attack" doesn't actually exploit the automated side of
things.  It doesn't learn the secret key [password] nor does it decrypt
packets [via https].  The attack is based on you giving out the
secrets, and alas, no crypto can really stop that [unless you stop
letting the users have the secrets].
So your "conclusions" are a bit off.
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-09 14:42:54
@_author: tom st denis 
@_subject: NIST selects the OMAC as new block cipher mode 
I'm thinking of adding OMAC to LibTomCrypt however I have a question
not resolved in the paper [or at least I didn't see it].   What is the
standard for computing u^-1 [L * x^-1 specifically] for arbitrary block
sizes?  I would have simply used a shift code .e.g. L2 = L1 xor (L1 << 1) Or something like that since it can be computed for any size block
cipher relatively easily.
Tom  Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-12 15:41:29
@_author: tom st denis 
@_subject: An attack on paypal  
On the whole PKI as used today is fairly useless.  I mean just because
Company A signed/issued me a key doesn't mean I'm a nice guy nor a
legit business.  All it means is I paid money to have another company
sign my key.
What *would* be more useful is a model of web-o-trust.  E.g. you make
up your own key.  Then you import public keys from third-party auditors
you trust.  Overtime the auditors will visit the business and if they
like it they will sign the key. So say you trust auditors A, B and C and I trust auditors B, C and D. Well chances are if company Z is good the will be audited by at least
one of the auditors we have in common.  Unfortunately there is easy corruption in this model so you would have
to keep tabs on your auditor yourself.   However, in this model it
wouldn't cost money [hey everything net-related should cost money
right?] and would actually be meaningful.
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-13 11:16:26
@_author: tom st denis 
@_subject: Session Fixation Vulnerability in Web Based Apps 
You really lack some fundamental understanding.
https uses a secure private link to create a private http session.  It
has NOTHING todo with authentication nor identity.
For example, when you first login to say yahoo [for email] you're on
https.  Even before yahoo knows who you are.  Think of a verbal
handshake in the "get smart" cone of silence..
The fact that people randomly give away *their* secrets doesn't mean
the system is flawed.  It means the people are ignorant.
Do you Yahoo!?
Yahoo! Calendar - Free online calendar with sync to Outlook(TM).

@_date: 2003-06-25 09:59:41
@_author: tom st denis 
@_subject: Draft Edition of LibTomMath book 
The Draft Edition of the LibTomMath book [book about how to implement
bignum math] is freely available on my site at
Keep in mind it is a draft and has not been edited yet.  However, if
you ever wanted to learn how to implement efficient [portable too]
bignum math routines you might want to give it a read.
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-06-25 12:22:39
@_author: tom st denis 
@_subject: Draft Edition of LibTomMath book 
Just a quick comment.  The PDF is not a "web friendly" PDF so you if
you are trying to view it inline with your browser you have to wait for
it to download completely first.
I've managed 80KB/sec off the site so it doesn't take too long to grab
it.    Alternatively you can grab the .PDF.BZ2 file and decompress it
locally.  I'm only making this comment because I've noted quite a few
incomplete downloads...
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-06-25 16:37:35
@_author: tom st denis 
@_subject: Draft Edition of LibTomMath book 
Very true.  LibTomMath will actually wipe the memory allocated [via
memset] before free'ing but I leave it up to the end user to lock their
heap from swapping.
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-06-27 13:33:28
@_author: tom st denis 
@_subject: Feedback from the LibTomMath Book? 
Close to 100 people have downloaded the book so far [which is alot
given the nature of the book] and although it has only been two days I
was wondering if anyone has any initial impressions [good or bad].
I'm going to start the editing phase of the text fairly soon so I'd
like to know what people thought of it before I got started.
I won't repost the url since I don't want to "spam" the list [if you
want it just email me in private].
Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-06-27 15:04:19
@_author: tom st denis 
@_subject: Feedback from the LibTomMath Book? 
[Originally I was going to make this a private reply but since I have a
cool explanation of Karatsuba I'll share it with the group]
Two problems
1.  I don't fully understand the FFT based solutions
2.  I personally don't see the need for FFT in common day algorithms. Heck even Toom-Cook won't kick in until the numbers are very large.
I do include a Newton based root function which is fairly fast [haven't
timed it against others].  I'll look into others.
Examine the terms.  ac = W(oo) = 1W_2 + 0W_1 + 0W_0
bd = W(0)  = 0W_2 + 0W_1 + 1W_0
The middle term
(a - b)(c - d)
can be written as (a_1 - a_0)(b_1 - b_0)  = (-a(-1))(-b(-1)) = -\Zeta_{-1}
Where a(x) = a_1*x + a_0 [same for b(x)]
So -a(-1) == -(a_1 * -1 + a_0) == a_1 - a_0
This would give where W(x) == w_2 * x^2 + w_1 * x + w_0
-W(-1) = (-a(-1))(-b(1)) = -(w_2 * 1 + w_1 * -1 + w_0) = -w_2 + w_1
Which combined gives you the matrix
 W(0)  =  0  0  1
-W(-1) = -1  1 -1
 W(oo) =  1  0  0
This means adding the two terms gives you the middle w_1 term.  Hence
the polynomial is actually correct.
Alternatively you can use W(1) = w_2 + w_1 + w_0 = a(1)b(1) and
subtract the first and third row from the middle.  Will do.  I wanted to get the book out the door quick so I just
finished the pseudo code ... Do you Yahoo!?
SBC Yahoo! DSL - Now only $29.95 per month!

@_date: 2003-03-11 08:28:32
@_author: tom st denis 
@_subject: Proven Primes 
What is the benefit of having leading/trailing bits fixed?  As far as I
know it doesn't make any form of index calculus attack any harder to
Do you Yahoo!?
Yahoo! Web Hosting - establish your business online

@_date: 2003-05-03 16:09:35
@_author: tom st denis 
@_subject: The Pure Crypto Project's Hash Function 
As the author LibTomMath I have to disagree with this.  My modular
exponentiation routines are fairly simple and straightforward.  My
routines are based on a k-ary sliding window implemented as two
seperate functions [one version use Barrett reductions and the other
uses Montgomery or Diminished Radix reductions].
As quite a few people have observed [most notably Tom Wu of Arcot]
LibTomMath achieves exptmod throughputs of roughly 1/2 of GMP on a x86
platform with GCC 3.2.  That isn't bad for all ISO C source code [e.g.
no ASM optimizations]
If you understand how a k-ary algorithm works you shouldn't have much
difficulty following my code.  So I have to disagree with the statement
My two cents on this whole thread...  Definitely modular, concise and
well organized code is a must for secure software.  It is, as others
pointed out not a catalyst for secure software.  That is, just because
a weak cipher is clearly written doesn't mean its not a weak cipher.
As to making their own hash I too would have to strongly disagree with
that.  You really ought to either design a cipher/hash or design a
cryptosystem.  You shouldn't do both at the same time because you are
bound to miss steps here and there.
Do you Yahoo!?
The New Yahoo! Search - Faster. Easier. Bingo.

@_date: 2003-05-04 06:59:25
@_author: tom st denis 
@_subject: The Pure Crypto Project's Hash Function 
While thats cute and all real implementations like GMP and LibTomMath
do not use square-multiply since its too slow.  I'm not arguing that modexpt is a hard thing to implement decently fast
[heck I'm only a high school grad]  :-)
Apparently though you're understanding of the subject is lacking. Since the original question of security was whether you understood how
the implemention of modexpt you were using worked [if you use
square-multiply its going to be hella slow!]
Do you Yahoo!?
The New Yahoo! Search - Faster. Easier. Bingo.

@_date: 2003-05-19 10:13:52
@_author: tom st denis 
@_subject: Primality Algorithm 
As I understand it it means GF(n)[x]/(x^r - 1) which is fancy talk for
the field generated by (x^r - 1) of characteristic n.  e.g. the
coefficients of the polynomial are reduced mod n.
In all honestly unless you are doing this for research purposes you
might as well just use say 8 rounds of Miller-Rabin.  For all practical
purposes that is just as good [chances of failure < 2^-80].
Do you Yahoo!?
The New Yahoo! Search - Faster. Easier. Bingo.

@_date: 2003-05-19 10:17:23
@_author: tom st denis 
@_subject: Modulo based hash functions [was: The Pure Crypto  Project's Hash Function] 
Wow you single-handly rediscovered why we pad hashes before signing
with RSA...
See, this is the ====>EXACT<==== reason why you shouldn't be inventing
new crypto algorithms without at least doing some research first.
Do you Yahoo!?
The New Yahoo! Search - Faster. Easier. Bingo.
