
@_date: 2016-04-05 20:00:53
@_author: david wong 
@_subject: [Cryptography] At what point should people not use TLS? 
WhatsApp just announced end-to-end encryption on their service, and the
details show that they do not use TLS but another TLS-like protocol called
Noise Pipes which was designed by one man. From Moxie (
 ):
with them to transition over to Noise Pipes, which has some advantages over
what they were doing before.
I know Moxie has given a lot of thoughts into TLS, and that Trevor is a
legend, bla bla bla... but what about "crypto should be boring"? What about
the peer-review and all the research done around TLS and its implementations?
But then it might makes sense, if the protocol is simple enough, to try and
build that subset of TLS. But what might go wrong? What has to be re-designed?
Replay protection? Consistency? Integrity? It implies that you already know a
lot about TLS... What do you people think?

@_date: 2016-04-08 08:09:15
@_author: david wong 
@_subject: [Cryptography] At what point should people not use TLS? 
Fair enough, but as half (I'm making that up but I have a feeling it's more
than half) of TLS' vulnerabilities were found not in the protocol but in
implementations. I think it's also fair to think about a worrying closed-
source implementation of an already too-fresh TLS replicant.

@_date: 2016-04-26 12:35:30
@_author: david wong 
@_subject: [Cryptography] what crypto stuff to buy? 
I have money I need to spend before the end of the month. Anything crypto
worth buying? Courses, material, devices, conferences, ...
  * I heard there is an [IACR membership]( for 50$, sold!   * Crypto 2016 and CHES 2016 are both in Santa barbara in August, but they're still not selling tickets atm
  * Anything else?

@_date: 2016-04-28 11:27:38
@_author: david wong 
@_subject: [Cryptography] WhatsApp: Why asymmetric key instead 
I too would have liked to see both, and a "strong" label being assigned to
those who I verified in-person.
But only 256 bits key space??  You are developing a "new" algorithm in 2016; and you are using a  fixed 256 bit key space.  It's surely enough for %99 percent of attackers. But, I am not sure  about resourceful attackers in long term.
the keyspace is not the problem here, a 256 bit keyspace is impossible to
brute-force and will remain impossible to brute-force unless we have some
crazy breakthrough (but then I suppose no crypto would resist). This is
because, if we currently are able to do something like 2^80 (and this is an
highly hypothetical number). If that's the number of cycles we can provide to
a brute-force, then providing 2^81 would require the same amount of work times
two. So getting to 2^85 would already seem impossible, imagine 2^256.
So the problem really is what is the best attack against curve25519, and the
best known attack is only halving the keyspace making it a 2^128 one, which is
also impossible and will remain so as long as we don't discover a crazy

@_date: 2016-04-28 11:32:01
@_author: david wong 
@_subject: [Cryptography] WhatsApp: Why asymmetric key instead 
Maybe a better approach is to see how much power (at a maximum) we can suck
out of the planet (or sun with some Dyson sphere
 and how much cycles (at a
maximum) we can operate from this amount of power
( Bernstein ran some
numbers on that here:

@_date: 2016-02-05 14:08:00
@_author: david 
@_subject: [Cryptography] DH non-prime kills "socat" command security 
I'm digging into the topic and summarizing everything on this github repo: it would be interesting to try several factoring algorithm like pollard's p-1, ECM, p+1 ... Also, try and provide some estimations. If the factorization of the last composite has a lower bound of X => Pohlig-Hellman won't work.
Another question: if it was indeed a mistake, how could that number would have been generated? And what are the probabilities that the factorization would include big primes/small primes if generated this way?

@_date: 2016-02-09 10:49:26
@_author: david 
@_subject: [Cryptography] DH non-prime kills "socat" command security 
Didn't logjam also taught us that it's not always a good idea to have hard-coded parameters (and in the logjam case it was a DH hardcoded param)

@_date: 2016-03-17 20:39:33
@_author: david wong 
@_subject: [Cryptography] Is the real cause of the recent socat error now 
To answer the title: no, we don't know. It was probably a developer who had
no idea how crypto works. For the story, the guy who submitted the patch
erased both his personal blog and his github account the day the security
was publicly disclosed
involving the Miller-Rabin Test) was employed instead of Maurer's algorithm
of provable prime generation. Hence with some, though practically very
minute (depending on the parameter t of the Miller-Rabin Test), probability
one could indeed have obtained a composite instead of a prime number
Even with M-R you would have to know exactly what bases would be used to
test the prime (so the test would have to use the deterministic version of
M-R) to produce the prime in the first place. And this would have to be
done maliciously. (cf.
I've tried a bunch of things, and so have other people. Nothing works
except if you append "f0" to the hexstring: you obtain a prime. It could
mean it was truncated to reach 1024bits exactly but this doesn't mean
anything as you will often be able to add a higher byte to a non-prime to
make it prime. There was also some effort on the mersenne forum to factor
the composite modulus but only two small factors were found (by trial
I don't think this is a backdoor, but I found the idea interesting: how to
change one value in your ephemeral Diffie-Hellman parameters to make it a
backdoor. I've implemented ways to do it:
 and plan to release a
paper whenever I'm done (if someone is interested to discuss about it ping
If there is something we can do, to react positively from this story, is
check for similar potential backdoors in VPN implementations be them closed
or open source. Good thing a list was released a few days ago:

@_date: 2016-03-18 10:45:40
@_author: david wong 
@_subject: [Cryptography] Is the real cause of the recent socat error now 
confusing in this context.
The paper shows how to build a "fake" prime that passes the deterministic
version of the Rabin Miller test. To test Rabin Miller you can take random
bases OR you can always run it with the same set of bases (which is the
deterministic version of the test). They show that you can choose a number n =
p * q, where p and q are somehow related and they will pass the test for every
base b if b is coprime to p and b is a square modulo q.  As I said this method works if you know in advance the bases that will be used
(which is rarely the case I suppose). Also it seems like you are really
limited in the number of witness you fool, but this is an old paper and we
might be able to do better now.
I have two techniques so far: hiding a subgroup in a composite modulus or
hiding a smooth order in a composite modulus.
In both you generate your modulus n = pq with two fairly strong primes (to
avoid any factorization algorithms).
In the first technique p and q both hide a small subgroup for your generator,
so by taking a public key modulo p and q you only have a small discrete
logarithm to compute (so you can use Pollard Rho)
The second technique has p-1 and q-1 both B-smooth, with B large enough to
avoid the p-1 factorization algorithm (so >10^15 according to the records
of p-1). This way you can use Pohlig-Hellman.
The implementation/exploitation of TLS is a bit more verbose, gotta extract
some information, recompute the premaster key, derive the master key, derive
the keys, decrypt

@_date: 2017-11-13 14:20:58
@_author: David Wong 
@_subject: [Cryptography] Is ASN.1 still the thing? 
It depends on your use case, JSON is a textual and ambiguous data
formatting structure, while ASN.1 with DER is a binary and unambiguous
data formatting structure. Meaning it is faster and if security relies
on it you will have "less" troubles.
If you want something fast (binary), but don't want the awfulness of
ASN.1 I believe google's protobuf is the state of the art solution. Or
better, you can have a fixed structure (with fixed sized fields) and I
believe this is what Wireguard does.

@_date: 2019-03-21 21:58:30
@_author: David Wong 
@_subject: [Cryptography] Best/simplest document encryption 
I needed something like that so I wrote  On windows it adds context menu to files for easy encryption/decryption.

@_date: 2019-03-22 16:48:39
@_author: david wong 
@_subject: [Cryptography] Best/simplest document encryption 
It’s not based on asymmetric cryptography. Every time you want to encrypt you will generate a new key, you then have to give the key and the encrypted files to your recipient in two different channels. It’s way simpler to use. I basically wrote this because I was tired of my clients not wanting to use pgp or spending too much time to figure it out. The code is extremely simple and I was hopping to have good integration on different platform.
