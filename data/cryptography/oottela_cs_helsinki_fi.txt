
@_date: 2016-10-26 03:35:16
@_author: Markus Ottela 
@_subject: [Cryptography] TFC - instant messaging with endpoint security 
Thought I'd share my three-year project with the community.
The tl;dr is TFC is an end-to-end encryption plugin for Pidgin IM client where the TCB is split and separated on two isolated computers behind unidirectional, data-diode enforced RS232 gateways. This configuration prevents infiltration of malware to transmitter computer and exfiltration of keys/pt from receiver computer. The networked computer running Pidgin never has access to private keys or plaintexts.
The cipher is XSalsa20-Poly1305, where the symmetric key is either pre-shared or exchanged with Curve25519 ECDHE. MACs provide deniable authentication and PBKDF2-HMAC-SHA256 provides per-message forward secrecy with hash-ratchet.
Key generation uses Linux kernel CSPRNG but also allows mixing in entropy from a HWRNG sampled by Raspberry Pi via GPIO natively or over SSH. (Both HWRNG and data diodes are free hardware design).
Group messaging is done by multi-casting messages to each recipient provided all members have exchanged a key pair for private messaging.
The last feature I'd like to highlight is trickle connection where user sends a constant stream of noise packets to recipient / group, inside which messages can be delivered. Files can be sent to recipient(s) in background during the conversation.
Written in Python, licensed under GPL. I hope you find it interesting.

@_date: 2017-05-06 16:47:09
@_author: Markus Ottela 
@_subject: [Cryptography] CFB/OFB/CTR mode with HMAC for key stream 
Using something else than djb ciphers or AES is usually beneficial when cascading a set of algorithms. The goal would then be to use different cryptographic primitives in case one fails. Not trusting AES but trusting NSA's SHA256 seems a bit weird, both because of the author and because IIRC, early hash functions have a messy design.
I'm not entirely sure why three layers of AES256 are more secure than one. If the algorithm is not secure (meaning there is a method to break it in polynomial time), wouldn't the amount of security only increase by three-fold? Using another cipher based on some other primitive that happens to not be broken would actually be secure, right?
