
@_date: 2003-02-04 16:15:40
@_author: Ralf Senderek 
@_subject: question about rsa encryption 
And if one loves to learn about every single one of them, can
you (or others) give some references ?
Thanks in advance
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-02 19:42:04
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
I would like to ask the list's expertise to assess the
hash function below, which is used in the Pure Crypto Project
to create signatures. The project's intention is to provide
encryption and signing with the smallest amount of readable
code possible using only one basic crypto primitive,
a function ModExp(A,B,C) which calculates A**B mod C.
As this function is neccessary for RSA encryption the hash
function should be based on this function as well, even though
that slows down the process. You can find my remarks on the
security of the hash function at:
       I would be very thankful for comments and constructive criticism.
The Pure Crypto Hash Function :
    Prime = 106603488380168454820927220360012878679207958575989291522270608
    237193062808643
    Ho = PublicKeyModulus mod Prime
    for every character in the message text
    do
         Hi+1 = (Hi + 19) XOR ModExp((Hi + Ho), (character i + 19), Prime)
    done
The hash function produces 256 bit output values.
Thanks in advance.
    Ralf Senderek
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-03 17:28:24
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
That's why RSA is used in the project.
The goal is of course : "most secure" AND "most clear" AND "smallest code"
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-03 20:41:31
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
good: YES, preferably the best.
fast: MAYBE, if I'd sign my day's work I can wait the few seconds
      PCP needs to sign my day's effords
cheap: NO, if I need cheep hashing I'd use PGP-2.6.3i or md5sum
Small code? How many lines of C-code is sha-1 in openssl? Can you
explain every single one to me with respect to its security?
These questions  shall only shed some light on the problem that most of the
crypto we are using every day is not really understandable for most
of us. And in this respect, I think, the Pure Crypto Hash is a
step forward.
And the original question was not why I am not willing to use sha1 but
if the Pure Crypto Hash is secure. I really would like to know the
list's assessment on this.
Comments and criticism always welcome.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-03 20:59:29
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
Because it is "cheap" and not because the users understand what they are
doing. There may be other reasons, but none of them is "clarity" or
"conciousness of what's going on".
First of all, I'm not advocating not to use PGP. I've spend plenty of
time to explain the background principles of PGP, but we have this
complexity problem now and the development of PGP in recent years
does not at all point into a direction to solve this problem.
The short version of my compelling reason is :
Why the Pure Crypto Project started
As crypto products have developed over the years they have become more
and more complex and also more inscrutable leaving the user in a fatal
dependence on crypto code which almost nobody fully understands
nor analyses for all its security implications. Most people have
inevitably accepted this situation without being able to know
in detail what they are doing when they use crypto programs,
although the basic principles are widely known, the specifications
are all published and of course the code is open for inspection.
But as the code grows more and more complex it is simply beyond
the state of the art to analyse this sort of code with respect
to all implications for security.
The Pure Crypto Project (PCP) started to turn the process in a
different direction and to tackle the inscrutability problem by
developing a program that consists of a very small amount of
highly readable code that will be clear and understandable not only
for security experts but for many crypto-literate people.
So the most important objective of PCP is to restrict itself to
one well known basic function (RSA and Modular Exponentiaton)
to provide encryption and signing with only a few hundred lines of
security relevant code that can be fully analysed with respect
to its security implications.
one can only agree, but from the point of view, that it it
neccessary to regain control over what you do when you use
crypto PCP is a very, very good approach!
So please elaborate on your concept of "good" and "bad".
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 08:29:20
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
Yes, of course I can, otherwise the Pure Crypto Project would lack its
second most important feature, clarity, security being the most important.
Fortunately I have to explain only 10 lines of code:
          def ModExp (Base, Exp, Mod):
                Hash = 1
                X = Exp
                Factor = Base
                while X > 0 :
                      Remainder = X % 2
                      X = X / 2
                      if Remainder == 1:
                               Hash = Hash * Factor % Mod
                      Factor = Factor * Factor %  Mod
                return Hash
I have explained this sucessfully even to 18 year olds who wanted to
learn about computer security. I will explain off-list on request.
No, I cannot. As I'm using bare multiplication and addition of long
integers, I cannot rule out the possibility that the Python-interpreter
executes some malicous code when multiplying x and y. But I don't have
any reason to assume that.
I'm not sure, primes sometimes make an argument simple, please read
my remarks on security.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 08:37:21
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
Don't blame the users! It's the complexity problem, I try to tackle it.
So everything new must be bad, because it isn't "known to be .. secure"?
I can live with that.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 08:57:15
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
If there was a hash based on ModExp() with a long tradition of
scrutiny like RSA for twenty years I surely would have taken it.
I am not keen on inventing new things, but I don't accept that we
leave the user alone with the complexitiy problem in a fatal dependence
on code he has not even the chance to understand. And I don't mean
sha1 in particular but the whole cryptosystem.
Does the list know of any hash based on Modexp with a better reputation
than mine, I'd be happy to know.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 10:41:43
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
Please assume for a second PCH would be secure, then because of the
fact that for the same reason there is no symmetric cipher in PCP
we will get a secure public cryptosystem entirely dependend on
RSA, Euler, Multiplication and Addition which many of us can fully
understand and which is slower than what we have and what most of us
cannot fully understand because of complexity reasons. But it is not
that slow that we cannot use it and it will be in the public domain.
Exactly because there will be only 100 lines of securtity relevant code
and everything is done with pretty old-fashioned crypto some fresh
thinking is required to solve the complexity problem. And PCP is one
alternative only which (afaik) didn't exist yet.
Naybe some of the list's members value the idea of undeerstandable
crypto, it was the only motivation for me to start working on PCP
over a year ago. And then the question remains: Is PCH secure?
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 11:06:59
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
PCP uses the hash for signatures, so the modulus of my signignkey is used,
the recipient needs to have my signingkey to verify. If he doesn't have
the right one he cannot even do that and that is fine.
I'v given the code of ModExp in a different posting, no, there is no
overflow, only a "slightly bigger base" to be processed.
Thats what I wanted, the Prime gives the upper bound of hash values.
I took the prime from the RSA-155 challenge (512 bit), the second factor,
with factoring results in August 1999. As far as I can see from my
analysis there is no reason to assume, that the hash does not scatter
its output properly.
Thank you for your comments.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 11:20:41
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project's Hash Function 
Of course!
In PCP C will never be n, because n is composite and C is a prime
(taken from the RSA-155 challenge). In PCP messages m and m' will
always be hashes and there are naturally additional precautions taken
to prevent that Alice is tricked into signing something that looks
like already encrypted material, that is long numbers. It will issue
a warning, if the text to be signed contains long numbers.
Thus the Pure Crypto Hash will stop this attack reliably inside PCP.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-04 17:17:35
@_author: Ralf Senderek 
@_subject: my take on "PCP" 
I never tired to convince anyone to just trust the hash. Instead I
presented it to the list for criticism. Still I haven't got much
criticism with respect to the hash function. I thank all who replied
to the subject.
The PCH does make sense (if any) only within PCP, I haven't released
the full code as it is in preview mode. I do not intend to advocate
the use of PCP without "real world analysis". But I had to produce
an implementation to see if it can be done and if it is not too slow.
(BTW it isn't). So I don't see that I am likely to cause harm and I
may reject your accusation.
Seeing it work well does not mean that I can understand it.
I do see this risk as well. That's why I asked the list for expertise.
What the hell is wrong with that?
I don't have any and I never claimed to have one.
It's amazing to see what an amount of unfair imputation is caused by
just thinking in a different direction.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-05 07:11:01
@_author: Ralf Senderek 
@_subject: my take on "PCP" 
The idea, the code, the explanation and my analysis are all in
     And fortunately my seriousness does not at all depend on the fact
whether or not I managed to get it into your favourite crypto journal.
Not seeing it in print will never prevent further analysis.
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-18 13:21:16
@_author: Ralf Senderek 
@_subject: Modulo based hash functions [was: The Pure Crypto Project's Hash 
Thank you for the references.
Anton describes two proposals for hash functions based on modular
arithmetic (with some conditions on g, p, q, a, b and the inputs xi):
A (Shamir, Rivest) :    hash-A(x) = g^x (mod p*q)
B (Chaum, van Heijst :  hash-B(x1,x2) = a^x1 * b^x2 (mod p)
   Pfitzmann)
I am not concerned about speed unless it is going to make the hash
unusable, but with factoring of p*q being infeasible we have at least
2048 bit hash values, expanding the size of signatures by a factor of 13,
compared to sha1.
And proposal A is clearly not multiplication free, so you will be
able to find Z, X and Y with hash(X)*hash(Y) (mod p*q) = hash(Z).
As the hash shall create signatures with RSA, one needs multiplication
freedom, and (AFAIK) cannot process the whole message in one step.
The prove of collision resistance, Ronald Rivest has given in an earlier
posting, might be ruined if a Davies-Meyer-like feed forward process is
wrapped around the exponentiation.  hash(i) = something(xi) XOR hash(i-1)
The second proposal is subject to the same dilemma.
Is it possible to have both, a prove of collision resistance and
multiplication freedom?
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-05-19 09:09:21
@_author: Ralf Senderek 
@_subject: Modulo based hash functions [was: The Pure Crypto  Project's 
if you can convince me, that the proposal (A) can safely be used
together with RSA-encryption to create signatures I am more than
willing to kiss the Pure Crypto Hash goodbye and to replace it
with the Shamir-Rivest-Hash (please feel free to assign any different
But for the sake of clarity (and truth) let us use this hash to
create signatures using secrets p=43 and q=79 assuming that the
factorization of n=3397 is "unknown". We can go into 2048 bit space
the other day.
Let x=1234 and y=2345 be two inputs.
I choose g = lcm(42, 78) = 546 as the hash's generator.
(Please correct me if I am doing wrong here)
The SRH now is :    hash(x) = 546 ^ x mod 3397
We get:    hash(x)    = 2949
           hash(y)    = 1284
           hash(x+y)  = 2258
Now we use the same modulus to create signatures using d = 113 as the
secret signingkey and e = 29 for signature verification.
           sig(hash(x))   =  1029
           sig(hash(y))   =  1125
So if you happen to be Alice and you have created the signatures on x and y
someone can compute
                                            = 2645
and pretend to have Alice's signature on z = x+y, which verifies correctly.
At least one cannot use the same modulus for hashing and signing
which is a pity, because the only p and q the user is convinced to be
unknown are his own p and q.
On the other hand, if there were different moduli (n,n') for signing and
hashing the signature on hash(x+y) would be different too, but I
cannot say that it is impossible to run into the same problem again.
So if the prove still holds, PCH is dead, long live SRH!
* Ralf Senderek     * What is privacy *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *     without     *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *   Pure Crypto?  *

@_date: 2003-11-27 20:23:36
@_author: Ralf Senderek 
@_subject: Problems with GPG El Gamal signing keys? 
I think no-one will blame you for this, you couldn't have known the
effects. But what are we going to learn? Heading for far less complexity
is the future!
   Regards
       Ralf Senderek
* Ralf Senderek     *  What is privacy  *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *      without      *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *    Pure Crypto?   *

@_date: 2003-10-07 18:59:18
@_author: Ralf Senderek 
@_subject: Simple SSL/TLS - Some Questions 
(answering Jill's questions)
I'd strongly recommend to think about some code-signing which would
best be included in the source code but could as well be distributed
as separate signature files. Including a note in your licence (whatever
it will turn out to be) this will not only help to spot and reject
unauthorized and dubious attempts to "improve" your code but
will also deter those who might call your code "crap" without having
seen the "real thing".
Good luck.
* Ralf Senderek     *  What is privacy  *
* Sandstr. 60   D-41849 Wassenberg  +49 2432-3960       *      without      *
* PGP: AB 2C 85 AB DB D3 10 E7  CD A4 F8 AC 52 FC A9 ED *    Pure Crypto?   *

@_date: 2003-09-08 19:45:39
@_author: Ralf Senderek 
@_subject: The Pure Crypto Project is released into the public domain 
The development of the Pure Crypto Project has now finished
and the source code is finally released into the public domain.
     There is a detailed explanation of the security mechanisms and
the background of PCP in
    I'd like to thank everyone who had supported the development
with constructive criticism and helpful hints.
Ralf Senderek
-----BEGIN PURE-CRYPTO SIGNATURE-----
Hash: SDLH  *** based on modular exponentiation and RSA alone ***
Ralf Senderek, Wassenberg PCP signingkey 2003 -----END PURE-CRYPTO SIGNATURE-----
