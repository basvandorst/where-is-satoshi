
@_date: 2014-01-05 17:04:20
@_author: Nathan Dorfman 
@_subject: [Cryptography] Using Raspberry Pis 
Anyone who is interested in a "home server/firewall" device like this may
want to look at the EdgeRouter Lite from Ubiquiti (~US$90-100). It can run
FreeBSD 10.0 -- with a full read/write filesystem, as the storage inside is
a regular 4GB USB flash drive. Currently, installing FreeBSD requires taking
out this flash drive and writing an image to it, as well as using a serial
console cable to change a bootloader setting. However, in the near future,
an installer that can easily be run from the factory OS should hopefully be
I have ready-to-go FreeBSD images for the device available, as well as a
detailed guide to getting up and running, at  I
also have, of course, a simple shell script that can build identical images
from your own copy of the FreeBSD source tree, at
Installing FreeBSD gives up some of the high-performance features of the
device, however, it still beats the pants off a Raspberry Pi. It also has
some hardware crypto support, and that also works in FreeBSD, if that's your
cup of tea.
Just two very preliminary tests:
1. iperf, between two gigabit PCs, with the ERL in the middle passing
packets only (no filtering):
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-30.0 sec   905 MBytes   253 Mbits/sec
More threads, same result:
[ ID] Interval       Transfer     Bandwidth
[  5]  0.0-30.0 sec   229 MBytes  63.9 Mbits/sec
[  6]  0.0-30.0 sec   262 MBytes  73.2 Mbits/sec
[  8]  0.0-30.0 sec   203 MBytes  56.7 Mbits/sec
[  7]  0.0-30.0 sec   211 MBytes  58.9 Mbits/sec
[SUM]  0.0-30.0 sec   904 MBytes   253 Mbits/sec
2. Encryption with and without the hardware-accelerated cipher mode, on a
50MB file in memory (tmpfs):
# df -h /tmp ;  dd if=/dev/urandom of=50MB bs=10k count=5k
Filesystem    Size    Used   Avail Capacity  Mounted on
tmpfs         192M    4.0K    192M     0%    /tmp
5120+0 records in
5120+0 records out
52428800 bytes transferred in 16.993329 secs (3085258 bytes/sec)
# for i in $CIPHERS ; do
echo -n "$i : "
time openssl enc -$i -nosalt -k 'nothing to hide' < 50MB > /dev/null
aes-256-cbc :         2.02 real         0.28 user         1.73 sys
aes-128-cbc :         1.95 real         0.24 user         1.71 sys
aes-256-ctr :        12.25 real        11.41 user         0.83 sys
aes-128-ctr :         9.45 real         8.58 user         0.85 sys
rc4 :         3.33 real         2.48 user         0.84 sys
I have yet to test any real setup, with packet inspection, NAT, and VPN, but
it's showing a lot of promise. Hopefully, someone out there finds this
useful... or better yet, wants to get involved with making things better.

@_date: 2014-01-05 20:06:23
@_author: Nathan Dorfman 
@_subject: [Cryptography] Using Raspberry Pis 
Yep, I'm in a similar boat, and I'm hoping the ERL with FreeBSD will have
plenty of breathing room left over for stateful inspection, VPN, etc. The
AES hardware acceleration will hopefully help with the VPN.
It may be worth noting that with the factory OS (based on Vyatta), the
device performs a lot better. A binary-only kernel module uses the on-board
FPGA for packet processing, and pushes the whole 1Gb/s. This isn't
available under FreeBSD, but of course you get an OS that you can build from
source yourself, and it works plenty well enough.
Well, I haven't tried it yet, but it's literally just a 4GB USB thumb drive
in there -- to install FreeBSD, I took it out, put it in my computer, wrote
an image to it, and put it back in. I see no reason why you couldn't just
replace it with a 64GB one, or whatever. I have one lying around here
somewhere, let me find it and give it a shot, and I'll get back to you.

@_date: 2014-01-08 12:52:18
@_author: Nathan Dorfman 
@_subject: [Cryptography] Using Raspberry Pis 
I have yet to play with the BBB, but the Raspberry Pi makes a great, cheap
air-gap box. For instance, I write science fiction stories that I don't want
anyone to read (I just don't think I could take that kind of rejection). I
use a $25 Raspberry Pi model A, which boots right into my word processing
software with only an encrypted LUKS partition and tmpfs writable. I can
take it with me anywhere HDMI displays and USB keyboards can be found. If I
really need to travel light, it's just the microSD card as you say, which
can be accessed on any appropriately secured Linux machine.
What I would like next is a solution for PGP keys, and I'm a total noob at
this so I'd like to hear what you guys think. One simple solution would seem
to be a Raspberry Pi on the local network that exposes nothing but a gpg
command line interface over ssh, with one time authentication to prevent
replays of the passphrase. Signed messages would be sent right back, but
decrypted ones could only be shown via the RaPi's HDMI out port.
How can this be improved? Would a serial connection (and no networking) be
best? It seems safer than moving physical storage media back and forth --
those USB drives have a decent track record as an attack vector.
