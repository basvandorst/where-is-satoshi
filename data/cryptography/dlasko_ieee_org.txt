
@_date: 2007-07-07 22:53:17
@_author: Darren Lasko 
@_subject: FIPS 140-2, PRNGs, and entropy sources 
I have a couple of questions related to FIPS 140-2:
1) Can a product obtain FIPS 140-2 certification if it implements a PRNG
from NIST SP 800-90 (and therefore is not listed in FIPS 140-2 Annex C)?  If
not, will Annex C be updated to include the PRNGs from SP 800-90?
2) Does FIPS 140-2 have any requirements regarding the quality of the
entropy source that is used for seeding a PRNG?  I couldn't find any such
requirement, which seems like a glaring oversight when evaluating the
security of a product that may generate keys and other critical security
Thanks for your help.
Best regards,
Darren Lasko

@_date: 2007-07-09 16:08:33
@_author: Darren Lasko 
@_subject: FIPS 140-2, PRNGs, and entropy sources 
Hey, look at that!  I guess I should have downloaded the latest
version before posting my question... I was looking at a revision I
downloaded back in November.  Sorry for the superfluous question.
Thank you, that's very good information.
Again, good information.  However, it seems pretty nebulous about how
they expect you to measure the number of operations required to
compromise the security of the key generation method.  Do you know
what kind of documentation the labs require?
SP 800-90, Appendix C.3, states that the "min-entropy" method shall be
used for estimating entropy, but this method only uses the
probabilities assigned to each possible sample value.  I'm guessing
that measuring ONLY the probabilities associated with each sample is
insufficient for assessing your entropy source.  For example, if I
obtain 1 bit per sample and I measure 50% 0's and 50% 1's, I have
"full entropy" by that measure, even if my entropy source always
produces "1010101010101010....".
Is the "NIST Statistical Test Suite" sufficient for evaluating your
entropy source, and will the certification labs accept results from
the STS as an assessment of the entropy source?
Thanks and best regards,
Darren Lasko

@_date: 2009-02-12 13:45:10
@_author: Darren Lasko 
@_subject: Key Management Interoperability Protocol (KMIP) 
Probably of interest to this group...
Best regards,
Darren Lasko
Principal Engineer
Advanced Development Group, Storage Products
Fujitsu Computer Products of America
[Moderator's note: the page is about something called KMIP that a few
companies seem to have privately developed.
It is generally considered friendly to include enough information with
a forwarded URL so that readers can decide if they want to look at
what is being referenced. I may start being strict about that in the
future. --Perry]

@_date: 2009-05-06 09:58:06
@_author: Darren Lasko 
@_subject: CSPRNG algorithms 
Here is a list of the FIPS-approved random number generators:
NIST Special Publication 800-90 provides recommendations for
"deterministic random bit generators" (not sure why they chose to use
"DRBG" instead of "PRNG") based on hash functions, block ciphers, and
number theoretic problems (speculation exists that the latter contains
a back door).
Best regards,
Darren Lasko
Principal Engineer
Advanced Development Group, Storage Products
Fujitsu Computer Products of America

@_date: 2014-06-19 16:32:55
@_author: Darren Lasko 
@_subject: [Cryptography] Shredding a file on a flash-based file system? 
When the encryption key isn't just "stored" in the drive hardware.  Any
implementation worth its salt will only store the key wrapped with the
authentication credentials required for unlocking the drive.  This is no
different from how software-based full drive encryption products protect
their encryption keys.

@_date: 2014-06-19 23:37:04
@_author: Darren Lasko 
@_subject: [Cryptography] hardware vs software FDE (was Re: Shredding a 
That's not what I was addressing, though.  I was addressing the assertion
that if the attacker has the drive platters in hand, then he also has
access to the key.
However, to your point that "in the software implementation, you can more
or less check that everything is working as expected," this only holds true
if it's open-source (and as we have found recently, this is still no
guarantee against nasty security "flaws"), or if you're willing to
reverse-engineer a closed-source product (which you could also do with a
hardware-based product, though likely at a greater expense).
While it's true that even with a closed-source product you can take a look
at the ciphertext and verify that you see random-looking bits, and maybe
verify through experimentation that it's not using a poor choice of cipher
mode like ECB, getting the actual encryption algorithm right isn't anywhere
near the hardest part.  How are the encryption keys generated?  What is the
entropy source used for generating the keys?  How are the keys
cryptographically protected w/ authentication credentials before storing to
the drive?  If passwords are used, are they "strengthened" with something
like PBKDF2?  What's the iteration count?  How do you know the KDF was
implemented correctly?  When you change your password, how do you know that
the "old" wrapped key blob (wrapped with the old password) was eradicated
from storage (the "shredding a file on a flash-based device" problem)?  I
don't see how you're going to check these in a McAfee EEPC, MS Bitlocker,
PGP WDE, etc.

@_date: 2014-06-26 18:03:37
@_author: Darren Lasko 
@_subject: [Cryptography] hardware vs software FDE (was Re: Shredding a 
Hi Perry,
Sorry for the very slow reply; I was away on vacation.
On Fri, Jun 20, 2014 at 9:04 AM, Perry E. Metzger I really don't think I missed your point.  I even acknowledged that point
in my previous post.  My counter-point is merely that the actual media
encryption part, while vitally important, is only a small part of the
overall FDE solution.  The other parts of the solution are equally
important, much harder to get right, and not readily verifiable in *either*
a hardware solution or a closed-source software solution.  I would argue
that if you don't trust hard drives with built-in encryption, then you also
shouldn't trust closed-source software drive encryption products (and maybe
you don't).
In fact, even the actual media encryption part is probably much harder to
verify in a closed-source software implementation than you might be
If the sectors on the drive are encrypted with some particular
Getting "that key" out of a closed-source software FDE product will require
reverse-engineering the product or employing something like the techniques
used in the Princeton "cold boot attack".  And once you have the key, you
also need to know the encryption algorithm and cipher mode being used
(which is usually specified in the product documentation) *plus* the
product's algorithm for generating IVs/tweaks for the cipher mode (probably
only discoverable by reverse-engineering, since I've never seen a
closed-source implementation give this level of detail in its
documentation).  This is why I said in my previous post, "you can take a
look at the ciphertext and verify that you see random-looking bits, and
maybe verify through experimentation that it's not using a poor choice of
cipher mode like ECB."  Anything more than that will require you to dive
deep into the inner workings of the product.
Software-only products are capable of implementing equivalent levels of
malfeasance, for example by obfuscating the plaintext media encryption key
and stashing it in the area of the drive they reserve for their pre-boot
code and metadata.  They could even encrypt the media key using a public
key to which the developers (or their "partners") hold the private key.
Again, not without the key.
Your original comment was about "checking/verifying", not "disclosure".  If
you look at the datasheets for self-encrypting drives from just about any
respectable manufacturer, they disclose the encryption algorithm/mode:
FIPS 197 certified)
Seagate has FIPS 140-2 certification on various models, so even more
information can be gleaned from their public security policies (e.g.
and CAVP certifications (e.g. AES cert  for XTS, CBC, and EBC)
Just to reiterate, checking that the actual media encryption is implemented
correctly in a closed-source software product is not a straightforward task
(even though you can easily "see" the ciphertext).  We haven't even
discussed how you would verify the other (and trickier, IMO) bits of the
product, such as entropy source & RNG for generating media keys, how
passwords are "strengthened", how the media key(s) are cryptographically
protected with the "strengthened" authentication credentials, how the "key
blobs" are sanitized from the drive (especially on flash-based storage
devices), etc.
I think it's fair to say that hardware-based FDE solutions aren't any more
"untrustworthy" than their closed-source software counterparts, and I think
one could even argue that open-sourced isn't a silver bullet (
  Even in software implementations, there
are a variety of components that are just as difficult to verify everything
is working as expected; and as such a high level of faith is required that
the software isn't sabotaging you.

@_date: 2016-04-20 15:12:53
@_author: Darren Lasko 
@_subject: [Cryptography] Security on TRIM for full-disk encrypted SSDs 
TRIM as supported in SATA devices has several flavors, see
  It's fairly typical
for SATA devices to return all 0's for any LBA that has been TRIM'ed.
Therefore, an attacker can read the entire drive, and make note of which
LBAs return all 0's.  These will be the LBAs that are currently "not in
use" by the filesystem.
