
@_date: 2016-08-30 00:24:18
@_author: Stanislav V. Smyshlyaev 
@_subject: [Cryptography] Key meshing (Re: [Crypto-practicum] Retire all 
Dear Jerry,
Thank you for your questions.
The reason for using key meshing is the increase of the limits on the total
size of plaintext that is allowed to be encrypted in a specific mode due to
1) evident combinatorial reasons (birthday paradox etc), 2) side-channel
attacks using leakages that occur when you use a key (e.g. when you xor
your key with some data you always have a signal on a bus that induces a
leakage - the more you use the key, the more you leak about it) and 3)
classical cryptanalysis techniques such as linear cryptanalysis that
require certain material to be applicable.
Our results on this topic are presented in the preprint
 where it is shown that the bounds on total
material that can be encrypted in CTR mode increase quadratically in
classical models. Maybe you will find them interesting and answering your
About "so often" - the change is made during each session (for every new
start with a fresh IV), so the total material that is actually encrypted on
the first key is 1024*number of starts. And this can be a reasonable number
if you have to deal with powerful adversaries using side-channels. But the
constant (as "1024") depends on your adversary model.
Your considerations about the possibility of learning all following keys
when you know a particular one are right - but that's a completely
different task that can be solved by using key trees methods, KDFs from a
single master secret etc.
I'd be glad to answer all your questions about the construction, the
analysis and the applications.
Thank you again for your interest.
Best regards,
Stanislav V. Smyshlyaev, Ph.D.,
Head of Information Security Department,
CryptoPro LLC
С уважением,
Станислав Смышляев, к.ф.-м.н.,
Начальник отдела защиты информации
ООО «КРИПТО-ПРО»
2016-08-29 18:06 GMT+04:00 Dmitry Belyavsky :

@_date: 2016-08-31 08:41:40
@_author: Stanislav V. Smyshlyaev 
@_subject: [Cryptography] Key meshing (Re: [Crypto-practicum] Retire all 
Dear Phillip,
Thank you for your question! Indeed, the key schedule question is really
important here – but I'd add a little about another issue. The thing is
that such a mode of operation relies on block transformation properties
(something close to APN properties of Boolean mappings) that could have
been not examined for a particular cipher when it was created.
And such a question should be examined separately for each cipher –
related-key attacks could be a problem for a large class of ciphers for
such a simple mechanism of changing a key. Moreover, it won't help neither
for resistance to side-channel attacks (the leakage info accumulated by
adversary after several blocks with "K, K+1, K+2..." can be used together
since the keys are quite close) nor to classical cryptanalysis methods (for
example, if you have some variant of linear cryptanalysis applicable, it
won't be too difficult to modify it from the case of finding relations on
"K" to the case of finding relations on {"K+i"}, where i is the number of a
So if you change the key online, then you should better change it in some
"pseudorandom" way.
Kindest regards,
2016-08-31 1:33 GMT+03:00 Ray Dillinger :
