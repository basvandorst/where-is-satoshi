
@_date: 2015-09-21 09:38:24
@_author: Ilya Kasnacheev 
@_subject: [Cryptography] Feedback welcome on autentication/password 
Hello, I want to share my idea with you. If some places are not clear
enough, you can try to guess or just ask me.
Main idea:
Boris hashes some secret value many many times recursively (SHA(X),
SHA(SHA(X)), ...), yielding chain of hashes.
Boris gives the last hash in chain to Anne. When Boris want to prove that
he came back and is genuine, he transmits previous hash in the chain. Anne
hashes it and looks up if she saw that hash before - if she did, it's
really Boris.
Are there holes in this scheme?
Why I think it is interesting:
  - Boris can generate a lot of hashes chains from single random secret by
concatenating it with known non-secret tags (service name, device id,
  - Boris can then store secret securely (print it on paper and shove it
somewhere) or you can even divide it into parts to store in different
  - If a device is lost or compromised by Constantine, he can pose as
Boris, but Boris has access to "earlier" hashes in the chain (which are not
stored on that device), so he can retake communication with Anne back and
hopefully minimize losses.
  - Boris can have two different hash chains on his two devices (say,
laptop and phone) so he can use both when wanting Anne to do something
sensitive, like transferring funds.
  - Boris can have three different hash chains, one his devices plus on his
cloud service D-Secure. D-Secure will provide extra confirmation to Anne
upon validating Boris using mobile text service (SMS confirmation), for
example. However D-Secure can't contact Anne posing as Boris, because this
chain alone is not authoritative, she will know that.
  - Anne may lose Boris' code without much impact, because she will not
accept codes she has already seen, only ones that match after hashing.
Comparing this to other authentication methods:
  - Passwords have this advantage that you can enter them from your memory,
anywhere. Everything else about passwords is bad.
  - 2-factor auth depends on trust to one large third-party cloud.
  - TOTP depends on shared secret - lose it, game over.
  - Public-private key pairs are notoriously cumbersome to get right, and
you have to carry private key on device you own - lose it, game over.
Theoretically asymmetric crypto can do most of things described, but
proving that the whole system is sound becomes close to impossible.
Any input is welcome.

@_date: 2015-09-21 14:28:16
@_author: Ilya Kasnacheev 
@_subject: [Cryptography] Follow up on my password replacement idea 
Hello again. It seems that I failed to bring my idea across.
It's not "just" S/Key, rather it is about hash sequence generation. It
should work as follows:
1) Generate N random secret codes: CG1, CG2...CGN.
2) Calculate root secret: Root = HASH(CG1 + CG2 ... + CGN), where + is
3) For M every devices (PC, mobile, cloud) generate device secret DS1, DS2
... DSM: DSx = HASH(Root + DeviceName)
4) Forget root secret.
5) Distribute secret codes CGx so you need, say, >50% of devices to make
root secret together once again. For example, for three devices, first has
CG1 CG2, second CG2 CG3, third CG1 CG3.
6) You may now create service secrets (for every device X every service):
SDxSy = HASH(DSx + ServiceYName). This does not require Root secret.
7) Compute a sequence of hashes starting from SDxSy and you can use them to
authenticate via S/Key - of course, every service has to keep track of
several hash sequences coming from your different devices on one account,
as e.g. github does with key pairs. Can also make service require more than
one S/Key sequence approval for sensitive operations like money transfer or
account removal.
8) When we need to add device to the loop / remove compromised or scrapped
device / etc - We bring enough devices together to have every CGx ready and
may recompute every S/Key sequence.
What do you think of that? Because current situation with passwords on the
internet is unmanageable and replacement is needed - waterproof enough to
do users more good than harm.
Sorry to bother you again.

@_date: 2015-09-23 05:03:35
@_author: Ilya Kasnacheev 
@_subject: [Cryptography] Follow up on my password replacement idea 
Thank you for the link.
Regarding user experience problem. I don't think there's an universal
solution. I think there's a number of small solutions and best practices
which together should make users' life bearable and predictable in exchange
to some extra effort on their part.
Bank accounts - I guess they already require 2 factor auth, in my
experience in form of text (SMS) messages. When you login, they send you a
text with a number, you input that number thus proving that you control
your cell number.
Of course this fails in case the attacker steals your phone and knows where
your account is. This only protects desktop from being compromised.
Logging in should be as painless as possible, but for dangerous operations
we could ask user for 2nd step confirmation. Dangerous operations are, for
example, account deletion.
All operations that are not dangerous and not require 2nd step confirmation
should be easily reversible. Reverting the damage should be cheaper than
inflicting damage, this way attackers are dissuaded from investing effort.
In future there will be big scandals regarding to cybercriminals making use
of huge (login, password) databases they already have, trying those pairs
on various services and inflicting dollar of losses while making a cent in
profits. Here we will see interest in more secure authentication coming
from the common folk.
I also had a few talks and had more insight: Some people don't care about
passwords that much. They care about their email and maybe primary social
network but not about 100+ random accounts over the net that they
Some people like to logoff from services after they finish using them
(tricky with my scheme)
Those who at least care about their e-mail are quite happy with existing
2fa like Google provides.

@_date: 2015-09-28 12:44:02
@_author: Ilya Kasnacheev 
@_subject: [Cryptography] Follow up on my password replacement idea 
2015-09-22 22:59 GMT+07:00 Bill Cox :
Thank you for the link.
I don't think there's an universal solution. I think there's a number of
small solutions and best practices which together should make users' life
bearable and predictable in exchange to some extra effort on their part.
Bank accounts - I guess they already require 2 factor auth, in my
experience in form of text (SMS) messages. When you login, they send you a
text with a number, you input that number thus proving that you control
your cell number.
Of course this fails in case the attacker steals your phone and knows where
your account is. This only protects desktop from being compromised.
Logging in should be as painless as possible, but for dangerous operations
we could ask user for 2nd step confirmation. Dangerous operations are, for
example, account deletion.
All operations that are not dangerous and not require 2nd step confirmation
should be easily reversible. Reverting the damage should be cheaper than
inflicting damage, this way attackers are dissuaded from investing effort.
In future there will be big scandals regarding to cybercriminals making use
of huge (login, password) databases they already have, trying those pairs
on various services and inflicting dollar of losses while making a cent in
profits. Here we will see interest in more secure authentication coming
from the common folk.
I also had a few talks and had more insight: Some people don't care about
passwords that much. They care about their email and maybe primary social
network but not about 100+ random accounts over the net that they
Some people like to logoff from services after they finish using them
(tricky with my scheme)
Those who at least care about their e-mail are quite happy with existing
2fa like Google provides.
