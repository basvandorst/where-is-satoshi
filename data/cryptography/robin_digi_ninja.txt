
@_date: 2017-12-20 09:02:35
@_author: Robin Wood 
@_subject: [Cryptography] paragraph with expected frequencies 
Something a little less technical than a normal question...
I'm working on a bit of crypto with my young daughter and we are about to
look at frequency analysis. Are there any short UK English paragraphs where
the frequency of letters is about what you would expect based on frequency
charts? i.e. E then T, A and O.
Bonus if the digraphs are also roughly in order.
I want to count the letters by hand so don't want anything too long and it
has to be PG content.

@_date: 2017-12-20 22:42:09
@_author: Robin Wood 
@_subject: [Cryptography] paragraph with expected frequencies 
I'm one of the organisers of the SteelCon conference where we have a kids
track. This year, during the opening talk, Pippa (6) set the kids two
crypto challenges, one Pigpen and one rot13, she then came up onto stage at
the end and gave prizes to the ones who had solved them.
She loves puzzles and this is just another type of puzzle to her.

@_date: 2017-12-21 23:05:25
@_author: Robin Wood 
@_subject: [Cryptography] paragraph with expected frequencies 
Oh well, was worth a try. I'll grab some cuttings from different newspapers
and start with those and see how we go.
Start with some counting by hand then write some code to do bigger texts
and create graphs.
Might be interesting to try to find texts that do fit the expected
frequencies, maybe a discussion of the Queen jumping in a Zumba class :)

@_date: 2017-07-01 19:23:35
@_author: Robin Wood 
@_subject: [Cryptography] demonstrating SSLv2 weaknesses 
Occasionally when I'm doing security tests for clients one will pick me up
on a reported vulnerability and ask me to demonstrate it. For things like
SQLi or MS17-010 it is fine as they are fairly easy to demonstrate but I
was thinking about the crypto weaknesses.
I regularly write up SSLv2/v3/RC4 etc as weak but if I were challenged to
demonstrate why I couldn't. A friend said it wasn't worth the hassle of
demonstrating as I could just point them at all the white papers but I know
some people who won't be convinced unless they see something happen,
whether that is a message decrypted or traffic modified.
For smaller firms at least, the argument being that if I, as a professional
tester who is paid to do this type of thing, can't do it, then is it worth
worrying about it as an issue? Sure, a nation state can do it and
researchers in a lab with lots of resources can, but their adversaries are
more likely to be script kiddies or, at worst, a customer with a grudge.
So, are there any practical, walk through, demos attacking SSLv2, v3 or any
of the other of the crypto that regularly gets written up as weak? I'd love
to have one in my bag that I could get out if I ever were challenged.

@_date: 2017-07-02 11:17:29
@_author: Robin Wood 
@_subject: [Cryptography] demonstrating SSLv2 weaknesses 
Do you know any good references to start with for looking at it?
Your comment highlights a second problem I see with writing up crypto based
vulns. Trying to get successful exploitation (from what I can tell) is
likely to be very hard in most real world situations as the clients won't
use the weak stuff. This gets written up as medium and sometimes even high
risk which it sort of is but at the same time isn't due to other

@_date: 2017-03-08 21:01:51
@_author: Robin Wood 
@_subject: [Cryptography] encrypting bcrypt hashes 
No, they are, I'm trying to answer a question which was put to me in a very
specific way.
That makes sense, I'll pass that on as a suggestion.
My feedback already has the caveats written up. I'm making it very clear
that I'm only discussing the PINs as stored in the database, any access to
source code, config, running processes, or anything else, is not in scope.
I didn't get to talk to the security team, just the developers, so I didn't
hear the exact threat model they were thinking of.

@_date: 2017-03-09 10:58:12
@_author: Robin Wood 
@_subject: [Cryptography] encrypting bcrypt hashes 
Good to know that bit of maths
Seems reasonable.
It was specifically encrypting the hashed values.
What they are doing is currently capturing the PIN as entered by the user
and then storing it in their own database before passing it on to the out
sourced authentication service. Doing this they hope to collect the PINs
for a majority of their users. Once they've got a good number they are
going to start doing the authentication themselves and pass any they don't
have in their database through to the external system. After a while of
doing that they will turn off the external system and any they don't have
will be dealt with by a yet to be decided mechanism.
Once it is all in-house they can then start to implement passwords rather
than PINs and add 2FA.
They have five (I think) attempts before lock out and reset is based on a
call to customer services or an online mechanism that I've not seen.

@_date: 2017-05-26 15:33:06
@_author: Robin Wood 
@_subject: [Cryptography] key lengths in different places 
I did a Nessus scan of a site and one of the TLS issues reported was medium
strength ciphers, the one picked out was:
DES-CBC3-SHA Kx=RSA Au=RSA Enc=3DES-CBC(168) Mac=SHA1
I also scanned the site with sslscan (screenshot attached) and SSL Labs and
both reported the same cipher but with 112 bit keys. I reported this to
Tenable as a mistake in their reporting as they showed 168 rather than 112,
they came back with the following reply:
Does this make sense? Are there different bit lengths depending on what you
are talking about and if so, is there a way to know which is being reported?
If I'm completely wrong on how I'm reading this please point me at any
intro docs that explain explain what is going on.

@_date: 2017-05-26 20:46:22
@_author: Robin Wood 
@_subject: [Cryptography] key lengths in different places 
A brilliant explanation, thanks.
I'll have to work out which version the different tools I use use.

@_date: 2017-10-15 21:19:49
@_author: Robin Wood 
@_subject: [Cryptography] filtering html 
For arbitrary content I'd have thought it wasn't possible. Imagine trying
to pass Google Inbox through a service such as this, you'd never be able to
recreate the content in just HTML.

@_date: 2017-10-16 20:40:15
@_author: Robin Wood 
@_subject: [Cryptography] filtering html 
I'd have thought lots of people do but does it matter for this scenario?

@_date: 2017-09-13 21:23:21
@_author: Robin Wood 
@_subject: [Cryptography] letsencrypt.org 
That is a lot of scripts. I've been using LE for about a year and I use an
Apache based variant of the scripts Scott talks about in this blog post and
a second one it references.
I always get a little worried when the 3 month renewal comes around but the
email from cron with the success messages always come in on time.

@_date: 2017-09-14 13:30:28
@_author: Robin Wood 
@_subject: [Cryptography] letsencrypt.org 
Mine doesn't, it does everything as a low privilege user and then has sudo
privileges to restart apache.

@_date: 2017-09-14 16:30:37
@_author: Robin Wood 
@_subject: [Cryptography] letsencrypt.org 
The CSR is readable, the certificate read/writable, it doesn't need access
to the private key.
I could make the certificate write only but allowed it to be read so I
could check how long it had left before it expired so I could trigger a
renewal in the last 7 days of its life. I could work around this but didn't
see the need.

@_date: 2017-09-15 18:54:12
@_author: Robin Wood 
@_subject: [Cryptography] letsencrypt.org 
This is Scott's description of the scripts he uses:
I swapped out the calls to nginx with Apache and set up  permissions so
that the acme user could only call apachectl restart.

@_date: 2020-10-21 18:59:24
@_author: Robin Wood 
@_subject: [Cryptography] Fun with printers, 
I went on a segmentation test once and the first segment the client put me
on was the one shared between guest WiFi users and their big fleet of
printer / scanners.
They were an insurance company and printed cheques on these devices and
scanned all their post on them. Everything was saved locally for a very
long time.
Not great segmentation to start with, made even worse by the fact all
devices had default login creds.
I hope they listened to my advice of rethinking that group but I never went
back to find out.
