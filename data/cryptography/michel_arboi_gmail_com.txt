
@_date: 2007-09-20 21:39:36
@_author: Michel Arboi 
@_subject: OK, shall we savage another security solution? 
Evidian (former Bull Soft) built such a gizmo.
I think this is this:

@_date: 2016-06-15 16:50:48
@_author: Michel Arboi 
@_subject: [Cryptography] Tool for XOR encryption 
Maybe the tool can implement double XOR, which should be twice harder
to break? PS: this message is encrypted with double-ROT13, contact me for the key.

@_date: 2019-05-14 15:17:56
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & /dev/urandom 
paranoia: I played with Dieharder (evolution of the famous Diehard statistics tests)
There was a known bug wth 500 & 501 generators (/dev/random and /dev/urandom):
Once this bug is fixed, or by using a file filed with binary data
(dieharder -g 201 ...) I still find weaknesses with urandom
1. I get at least one WEAK result nearly every time I run "dieharder  -a -g 501"
2. These weaknesses do  not appear with /dev/random
3. The tests which failed are not always the same.
Failed tests I got so far:
rgb_lagged_sum (7 times), rgb_bitdist (6), sts_serial (3),
rgb_minimum_distance (2),
rgb_permutations (2),
diehard_crap, diehard_rank_32x32, rgb_kstest_test, sts_runs
Am I doing something wrong or is there a true weakness in /dev/urandom?
$ dieharder  -a -g 501
#            dieharder version 3.31.1 Copyright 2003 Robert G.
Brown          #
rng_name    |rands/second|   Seed   | /dev/urandom|  1.79e+07
test_name   |ntup| tsamples |psamples|  p-value |Assessment
diehard_birthdays|   0|       100|     100|0.46753772|  PASSED
diehard_operm5|   0|   1000000|     100|0.84242621|  PASSED
diehard_rank_32x32|   0|     40000|     100|0.22126282|  PASSED [snip]
          sts_serial|  12|    100000|     100|0.59332179|  PASSED
          sts_serial|  12|    100000|     100|0.99723352|   WEAK   <---
          sts_serial|  13|    100000|     100|0.73984626|  PASSED
          sts_serial|  13|    100000|     100|0.75394894|  PASSED
          sts_serial|  14|    100000|     100|0.53569954|  PASSED
          sts_serial|  14|    100000|     100|0.84443587|  PASSED
          sts_serial|  15|    100000|     100|0.70062655|  PASSED
          sts_serial|  15|    100000|     100|0.86398789|  PASSED
          sts_serial|  16|    100000|     100|0.77044189|  PASSED
          sts_serial|  16|    100000|     100|0.40665896|  PASSED
         rgb_bitdist|   1|    100000|     100|0.23117788|  PASSED
         rgb_bitdist|   2|    100000|     100|0.72830922|  PASSED
         rgb_bitdist|   3|    100000|     100|0.96816091|  PASSED
         rgb_bitdist|   4|    100000|     100|0.58267893|  PASSED
         rgb_bitdist|   5|    100000|     100|0.42065873|  PASSED
         rgb_bitdist|   6|    100000|     100|0.71015893|  PASSED
         rgb_bitdist|   7|    100000|     100|0.99864266|   WEAK   <---
         rgb_bitdist|   8|    100000|     100|0.59789616|  PASSED

@_date: 2019-05-15 14:08:26
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & /dev/urandom 
Le mar. 14 mai 2019 à 18:51, Natanael  a écrit :
I (nearly?) always get a couple of "WEAK" results with urandom, not with random.
I'm confused, as this is to be the same PRNG in fact -- random is just
guaranteed to be regularly reseeded if I understood correctly.

@_date: 2019-05-15 14:12:10
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & /dev/urandom 
Le mer. 15 mai 2019 à 01:36, John Kelsey  a écrit :
I never get that with random, or with a much lower probability than
urandom. That's odd.
I'm doing all these tests on computers that have been up and running
for days. Moreover, one of them has a OneRNG hardware key. This does
not change anything to the results.

@_date: 2019-05-15 14:27:03
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & /dev/urandom 
Le mer. 15 mai 2019 à 06:24, Sidney Markowitz  a écrit :
So I should run the tests in "resolve ambiguity" mode, like this?
dieharder -a -g 501 -k 2 -Y 1
man dieharder says:
       -k ks_flag - ks_flag
              0 is fast but slightly sloppy for psamples > 4999 (default).
              1 is MUCH slower but more accurate for larger numbers  of  psam‐
              ples.
              2  is  slower still, but (we hope) accurate to machine precision
              for any number of psamples up to some as yet  unknown  numerical
              upper  limit  (it  has  been  tested out to at least hundreds of
              thousands).
              3 is kuiper ks, fast, quite inaccurate for small samples, depre‐
              cated.
       -Y Xtrategy - the Xtrategy flag controls  the  new  "test  to  failure"
       (T2F)
              modes.  These flags and their modes act as follows:
                0  -  just run dieharder with the specified number of tsamples
              and psamples, do not dynamically modify a run based on  results.
              This is the way it has always run, and is the default.
                1  - "resolve ambiguity" (RA) mode.  If a test returns "weak",
              this is an undesired result.  What does that  mean,  after  all?
              If  you  run  a  long  test series, you will see occasional weak
              returns for a perfect generators because p is uniformly distrib‐
              uted  and  will appear in any finite interval from time to time.
              Even if a test run returns more than one weak result, you cannot
              be certain that the generator is failing.  RA mode adds psamples
              (usually in blocks of 100) until the test result ends up solidly
              not  weak  or  proceeds to unambiguous failure.  This is morally
              equivalent to running the test several times to see  if  a  weak
              result  is  reproducible,  but  eliminates  the bias of personal
              judgement in the process since the default failure threshold  is
              very small and very unlikely to be reached by random chance even
              in many runs.
              This option should only be used with -k 2.

@_date: 2019-05-16 21:45:00
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & /dev/urandom 
Using "dieharder -a -g 501 -k 2 -Y 1 -P 10000000" I still get WEAK results.
I can hardly increase the -P parameter, as the memory use skyrockets.
I got a FAIL once but was unable to reproduce ut.

@_date: 2020-01-16 18:05:42
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & symmetric cryptosystems 
In May 2019, I noticed strange results of the Dieharder statistical test
suite with Linux /dev/urandom
Very often, dieharder reported inconclusive "WEAK" results on some tests,
even when running "dieharder -a -g 501 -k 2 -Y 1", which looks suspicious
(-Y 1 = "resolve ambiguity" mode)
(WEAK is inconclusive, FAIL reports a real weakness.See the thread "
Dieharder & /dev/urandom" on this ML, starting from 2019-05-14)
A totally predictable PRNG which just hashes (SHA1) a counter with a
constant string passes all Dieharder tests with flying colours. I expected
a cryptographic PRNG to exhibit the same behaviour.
Now, I noticed that AES_OFB produces the same suspicious results. Once
again, I cannot explain this. As far as I know, AES_OFB should be totally
unpredictable and immune from any statistical weaknesses. I do not get any
FAIL, but I don't understand why Dieharder reports so many inconclusive
$  dieharder -a -g 205 -k 2 -Y 1
#            dieharder version 3.31.1 Copyright 2003 Robert G.
Brown          #
   rng_name    |rands/second|   Seed   |
        AES_OFB|  2.45e+07  |3424392396|
        test_name   |ntup| tsamples |psamples|  p-value |Assessment
   diehard_birthdays|   0|       100|     100|0.55850015|  PASSED
    diehard_2dsphere|   2|      8000|     100|0.31695338|  PASSED
    diehard_3dsphere|   3|      4000|     100|0.72645403|  PASSED
     diehard_squeeze|   0|    100000|     100|0.99526250|   WEAK
     diehard_squeeze|   0|    100000|     200|0.75277078|  PASSED
      rgb_lagged_sum|   2|   1000000|     100|0.97574458|  PASSED
      rgb_lagged_sum|   3|   1000000|     100|0.99541232|   WEAK
      rgb_lagged_sum|   3|   1000000|     200|0.87608184|  PASSED
      rgb_lagged_sum|   2|   1000000|     100|0.97574458|  PASSED
      rgb_lagged_sum|   3|   1000000|     100|0.99541232|   WEAK
      rgb_lagged_sum|   3|   1000000|     200|0.87608184|  PASSED
        dab_monobit2|  12|  65000000|       1|0.58649430|  PASSED
I am looking for any kind of explanation.Is there a bug in Dieharder? Did I
over-estimated the importance of WEAK results? Is OFB_AES known to be
slightly biased?

@_date: 2020-01-17 15:25:18
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & symmetric cryptosystems 
Le jeu. 16 janv. 2020 ? 23:37, james hughes  a ?crit :
I'm not sure I understand the role of the plaintext, considering that
it is just XOR-ed with the cipher stream. Did I miss something?
What do you mean by "not random"? That it will cycle eventually?
2^127 is safe in practice for any PRNG (if I am lucky). We'd need an
impractical amount of resources to detect the cycle.
What is the probability of getting a short cycle?
Is there a real difference between hashing a counter (concatenated to
a nounce) and encrypting it as in CTR mode?

@_date: 2020-01-18 12:18:16
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & symmetric cryptosystems 
Le ven. 17 janv. 2020 ? 22:51, Michael Kj?rling  a ?crit :
5.4.8-gentoo. I have to reboot, I installed 5.4.12-gentoo recently,
from sys-kernel/gentoo-sources-5.4.12.
Anyway, I was not playing with /dev/urandom this time, just AES_OFB
from Dieharder.

@_date: 2020-01-18 13:50:43
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & symmetric cryptosystems 
Le ven. 17 janv. 2020 ? 18:51, james hughes  a ?crit :
I see.
Anyway, the chance that it hits a short cycle that is picked up by
Dieharder seems pretty low. That's odd.
Note that I don't have WEAK results every time. Just too often to make
me comfortable
There is a new 3.29.4beta Dieharder version on the web site. I'll
check if the behaviour is different.
Actually, I was confused. I thought this was more or less related to
what I saw with urandom.
But urandom is based upon Chacha20; its property are different.
PGP key ID : 0x85A1C6A1 - 0x05054F8485A1C6A1
Fingerprint: 1DC3 8857 B930 0B6B 9420  5D56 0505 4F84 85A1 C6A1

@_date: 2020-01-18 13:54:12
@_author: Michel Arboi 
@_subject: [Cryptography] Dieharder & symmetric cryptosystems 
My mistake. The web page is not up to date. 3.29.4 beta is actually an
old version.
