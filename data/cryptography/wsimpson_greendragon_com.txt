
@_date: 2001-08-03 09:37:10
@_author: William Allen Simpson 
@_subject: moving Crypto? 
Selected Areas in Cryptography  is in Toronto this year, move Crypto to Vancouver to preserve spacial entropy.

@_date: 2001-08-13 19:28:54
@_author: William Allen Simpson 
@_subject: CBCS is IACBC, has no Intellectual Property 
I was recently directed to the IACBC-IP.PDF claims.  Although I cannot
attend your conference (due to a conflict with another conference beginning the next day), please consider these brief comments. I support the inclusion of an Integrity-Aware CBC mode, but would prefer that it be called Cipher Block CheckSum (CBCS), as it has been in my original messages and papers circa 1994-1997.
Although these papers were directed at the specific application of Internet Protocol Security (IPSec), of which I was a principle author, the CBCS modes are sufficiently general to use in any AES application.
CBC with checksums was first discussed on the IPSec mailing list in 1994, and formally presented at IETF.  Specifications were distributed world-wide via the IETF on-line collection of internet-drafts.
Whitening the plaintext and/or ciphertext with a constant, pseudo-random sequence, cryptographic hash used as a pseudo-random function, and such combinations were documented in part 4 of "Internet Security Transform Enhancements", draft-simpson-ipsec-enhancement-00.txt, April 1996.
The more recent "Cipher Block CheckSums (CBCS)" was first documented in draft-simpson-cbcs-00.txt, July 1997, although earlier less generic versions were discussed on various mailing lists.
These capabilities have all been implemented in the "Photuris: Session-Key Management Protocol" (RFCs 2522 and 2523), and discussed on the Photuris implementors' mailing list.
The IACBC diagrams are subsumed in the CBCS diagrams.
Variants with only plaintext whitening (series Sa) or only ciphertext whitening (Sb) are described in the text.
CBCS2 with 1 encryption key (k) and 2 integrity keys (Sa, Sb):
              IVa     P1              P2              Pi
      |               |               |
            +-----+   v   +-----+     v   +-----+     v
        Sa->|  S  |->(X)->|  S  |->->(X)->|  S  |->->(X)->
            +-----+   |   +-----+     |   +-----+     |
                      v      ^        v      ^        v
                   +-----+   ^     +-----+   ^     +-----+
                k->|  E  |   ^  k->|  E  |   ^  k->|  E  |
                   +-----+   ^     +-----+   ^     +-----+
      ^        |      ^        |
              IVb     +->->->+        +->->->+        +->->->
      |               |               |
            +-----+   v   +-----+     v   +-----+     v
        Sb->|  S  |->(X)->|  S  |->->(X)->|  S  |->->(X)->
            +-----+   |   +-----+     |   +-----+     |
                      v      ^        v      ^        v
                      +->->->+        +->->->+        +->->->
               |               |
                      C1              C2              Ci
The IBM patent may be restricted to their particular summation function Fk(), several of which are suggested for various block sizes.
CBCS and CBCS2 both recommended a different function, specified generically, independent of block size:
1) addition modulo 2**N with end around carry (N = bits in block);
2) count of the number of 1-bits in the sum (population count);
3) left circular rotation of the sum by the bit count.
Any such F() could be substituted, and the function specification is not a requirement of CBCS generically.  As a practical matter, a single function MUST be chosen for interoperability.

@_date: 2001-07-10 22:33:55
@_author: William Allen Simpson 
@_subject: Navajo Code Talkers 
H. CON. RES. 174
Authorizing the Rotunda of the Capitol to be used on July 26, 2001, for a ceremony to present Congressional Gold Medals to the original 29
Navajo Code Talkers.

@_date: 2001-06-04 21:56:08
@_author: William Allen Simpson 
@_subject: Starium (was Re: article: german secure phone) 
I thought they were going to release the details and do a public standard?  Where are the details?
Is there any interest in putting together a little research group?
Here's what I think the basic requirements would be:
 - must work as bump in the cord for any analog phone line, and talk peer to peer with any similarly configured analog phone line.
 - must talk with any similarly configured digital phone line.
 -- correllary, should work with OffTheSelf V.34 modem chips.  We already know how to do this with ISDN NAPs.  No real need for V.92.
 -- correllary, will also work with phone talking to computer.
 - must use diffie-hellman generated shared secrets.
 - must use either/both pre-configured secret and/or public-key for identification phase to prevent MonkeyInTheMiddle.
 - price point under $100.
 + a big plus would be to figure out how to use with currently deployed IP phones.  I'll note that Cisco phones load their firmware using TFTP, which I think is pretty insecure, so upgrades shouldn't be a problem, and might very well lead to a much better product....

@_date: 2001-06-06 00:59:11
@_author: William Allen Simpson 
@_subject: secure phone (was Re: Starium...) 
OK, it seems to me that all the pieces are already in place.  Maybe I'm biased, but IETF already has specifications that cover the wish list.
V.34 modem chip.  VoIP/RTP/IP/PPP/HDLC with Header Compression.
All standard!  Very low overhead (about 5-8 bytes per packet).  Pretty simple and CommonOffTheSelf (COTS).  IP/PPP/HDLC is very small code size, about 20KB on an embedded 186, as implemented for Vocal in '92 and Qualcomm in '93-95.  Haven't implemented the rest, so don't know....
Manufacturing cost under $20 each 1000 quantities.
The user hears a 2 second modem tone.  No answering tone, no modem negotiation.  No user interaction, no muss, no fuss. The modem tone could even be an advertisement.  "What's that sound?"  "My new privacy box, only $50 at   You should get one, too."
Another advantage: the spooks won't be able to tell a voice privacy modem from a computer modem.
PPP/HDLC/ISDN.  Already allows for interoperability with PPP/HDLC on
async modems, and has a long history of interoperability testing.
An advantage of digital could be an alternate negotiation on the signalling channel.  Eliminates the modem tone for digital to digital.
Now, the question is where to put the encryption.  PPP has it.  IP has it.  But, I expect that VoIP/RTP would want it on the voice alone?
If you use standard ESP (IP), you need all the anti-clogging facilities anyway.  But ESP would defeat the Header Compression and add a huge amount of overhead.  Much more of a problem for 20 byte voice packets than for 1500 byte data packets.
Isn't there a sourceforge equivalent version of PGPfone?
Couldn't we just retrofit PGPfone to use VoIP?
We already have all the rest of the software installed (IP/PPP).
Anybody know any details about their protocol?
Is it possible to sidestep their IP rights by using COTS?
William Allen Simpson
    Key fingerprint =  17 40 5E 67 15 6F 31 26  DD 0D B9 9B 6A 15 2C 32

@_date: 2003-02-09 12:08:09
@_author: William Allen Simpson 
@_subject: PATRIOT2 affects individuals, citizens & authentication 
Reading the HTML version:
 ... investigations of "lone wolf" terrorists or "sleeper cells" may not be authorized under FISA. ... This provision would expand FISA's definition of "foreign power" to include all persons, regardless of whether they are affiliated with an international terrorist group....
Requiring the additional showing that the intelligence gathering violates the laws of the United States is both unnecessary and counterproductive, as such activities threaten the national security regardless of whether they are illegal. However, there does not appear to be a statutory defense for agents who engage in surveillance or searches pursuant to FISA authorities under which no prior court approval is required ... This provision would clarify that the "good faith reliance" defense is available, not just when agents are acting pursuant to a FISA Court order, but also when they are acting pursuant to a lawful authorization from the President or the Attorney Another context in which different types of "foreign powers" are treated differently is the FISA definition of "United States person." United States persons have a more protected status under FISA for certain purposes, such as dissemination of information. ... The amendments in this section will facilitate the investigation of threats to the national security posed by such groups by reassigning them to the less protected
status now accorded to foreign powers....    13."(b) The terms 'encrypt' and 'encryption' refer to the    14.scrambling (and descrambling) of wire communications, electronic    15.communications, or electronically stored information, using    16.mathematical formulas or algorithms in order to preserve the    17.confidentiality, integrity, or authenticity of, and prevent unauthorized    18.recipients from accessing or altering, such communications or    19.information." Even "integrity" and "authenticity" would be subject to investigation for "Unlawful use of encryption". We often write scenarios where a monkey in the middle (MITM) tampers with communications.  Our "national security" apparatus prefers that it be able to alter our communications and impersonate those under investigation.
Remember, I was investigated for treason by the FBI for merely writing the specification for PPP CHAP, an authentication protocol.

@_date: 2003-01-09 19:06:41
@_author: William Allen Simpson 
@_subject: DeCSS, crypto, law, and economics 
I've been composing this reply for days, and the thread just keeps getting longer, so I'll try to keep the response concise, and consolidate in a single message.
Before it gets lost in the shuffle, I do want to thank John Gilmore for actual technical crypto information!  I had no idea that they were selling DVD blanks with the key areas unusable.  That has a profound effect on the whole debate, as it limits producer competition. This starts the thread, and the labels (and concepts) are wrong.  It's been a long time since college, but even I can look up Adam Smith, chapter VII.
The "wealth" created is only that based on the original new things, and valued at the "natural" price.  Your graph shows a TRANSFER of wealth
(meaning monopoly profits), as the consumer price rises.  Stradivarius violins are thousands of times more expensive than they were a mere decade ago -- because of scarcity and extremely rare sales, not an increase in overall wealth they bring to society. Not so!  As long as the price is greater than the cost (far far left of your tick mark), there is no reason that the goods cannot be produced FOREVER.  Society benefits FOREVER.  What you have indicated is where the *seller* maximizes gains, not where society maximizes gains.  That is the optimum profits, not the optimum wealth.  Rather, the optimum wealth will be created by the lowest possible price, as more consumers will be able to afford the commodity and more of the commodity will be produced!
(Remember Henry Ford paying his workers enough to actually buy the cars they built, a novel concept at the time, setting off a transportation Therefore, your graphs say to me: market segmentation is indicative of monopoly rents. The problem with this example, as is often the case with economists, is it assumes perfect knowledge and rational behaviour. In real life, all the publisher knows at the time of decision is that in the PAST, there have been similar books that have sold for $6 and $3, and that there are at least 2 purchasers.  Therefore, the $7 costs of printing will be covered, and the book will be produced.  All the rest of the rationale is hogwash.  Instead, at auction, the low cost consumer will quit at $4 on the 1st book (the other purchaser will have a bargain believing the book to be worth $6), and then purchase the 2nd at $3.  Wealth will be maximized (and profit will be minimized).
Ah yes, the old "What is good for General Motors is good for the Country" argument.  Thanks for bringing this paper to our attention.
As my (former) congresscritter says, "Using the DMCA, they want to control the room you're in, the chair you sit in, and the lamp you use."
Ahem, I beg to differ.  I haven't forgotten the foolish papers he wrote on Internet pricing, (bringing us back to our topic) cryptographically signing every packet, and carrying an additional micro-payment payload, so that they could "bid" at every router. As I pointed out at the time, the functional equivalent of every little passenger vehicle dragging along a train of boxcars, just to pay tolls. Thoroughly impractical. BTW, while researching his articles on the topic, I discovered that he'd been peddling the same papers to multiple journals (slightly modified)  and padding his C.V.  Not intellectually honest, either.
Have we forgotten that Jackson was turned down by many studios, before
he was allowed to make this magnificent (and profitable) film?
Then, when it was shown to be profitable, the larger studio BOUGHT the smaller ones!  Very like M$.  Very like a monopoly (or oligopoly).
I've seen no evidence that higher profits result in any increase in studio productivity, or production of marginal profit, quality films.  Instead, those are usually produced as "indies". I've seen several cases where an ALREADY established profitable director will insist on doing a marginal film as part of a continuing contract. Let us not forget that the most highly paid woman in the UK was given her start just a few years ago by a grant from the Scottish Arts Council, for a book nobody else would fund.  (Rowling and "Harry Potter")
Let us not forget that our beloved Internet (or more accurately its NSFnet predecessor) was funded by grants from the US government and the State of Michigan.  The "market forces" were pushing OSI and monopoly control.

@_date: 2003-01-10 08:53:09
@_author: William Allen Simpson 
@_subject: DeCSS, crypto, law, and economics 
The points I was making here are (1) the terms used were wrong and (2) there were no net benefits (wealth) to "society" from the monopoly.
It is wrong, since it doesn't have any correspondence to the case at hand (DVDs, cryptography).  In fact, it is directly contrary: (1) the producers are not omniscient, and (2) the consumers have knowledge about pricing, and (3) neither the producers nor the consumers act rationally.
We can speculate forever about universes where we travel faster than the speed of light, but really, I don't see why we should bother with using such universes to model our current discussion. I'm explicitly stating that the consumers have concurrent knowledge about pricing.  The consumers may decide that their values are different.  (That may not be rational.) What you mean is FORCE the consumers to pay more than one another, even when everyone knows it a priori to be irrational. The question raised was whether the commodity would be produced.  The producer knows that in the PAST there was sufficient income from these consumers for the goods to be profitable. The producer is not pre-cognitive.  In the case at hand, producers know that some movies/theatricals simply never make a profit, no matter how wonderful.  That's risk.
Certainly.  For example, each consumer could decide not to bid unless the commodity is a "bargain" -- a behaviour frequently seen in real life at flea markets or garage sales.  In that case, the producer will not make his nut.  So?  Absent FORCE, there's never a guarantee of profit.

@_date: 2003-01-10 13:35:57
@_author: William Allen Simpson 
@_subject: DeCSS, crypto, law, and economics 
I thought I made a fairly clear and cogent original synopsis, but apparently we're heading off into religious wars. I'm going to invert Eric's argument:
Look, I'm sure we are all in agreement on this point, with two caveats already expressed earlier:
 1) producers don't just want any profit, they want the biggest possible     profit, and are less likely to produce something when there is     something else even more profitable.
 2) we have examples where producers' desire for the biggest possible
    profit stopped development of a product, the public sector stepped in,     and the resulting product created wealth far beyond the dreams of the     original -- the Internet, Harry Potter.
So, in the matter of DVDs, we all agree that the product _has_ been produced.  There are only artificial barriers in the market.
The model (you proposed quoting Varian) required perfect knowledge of the producer, and complete lack of knowledge by the consumer.  That's not planet Earth.  The model doesn't work on planet Earth.
Only when the consumers are unaware of the practice, and/or where the companies have raised a monopolistic legal barrier to *FORCE* the consumers to pay different prices.  Note that some vendors are attempting to use the DMCA to prevent consumers learning about pricing differences, as reported Dec 2 on politechbot.com and  There has been no conclusive evidence presented here.  The Varian arguments presented are fallacious.  And other legal opinion presented here concluded otherwise.
Name us a DVD title that would not have been introduced without market segmentation, because it would have been unprofitable!?!?
Or is this just a religious belief?
Further deponent sayeth not.

@_date: 2003-01-21 18:15:34
@_author: William Allen Simpson 
@_subject: Verizon must comply with RIAA's DMCA subpoena 
Declan McCullagh recently posted an interesting article on a legal   He's placed the decision here:
  All this to learn the identity of a computer at a particular IP address.  Presumbly, Verizon will now be smart enough to say: "All of our IP addresses are assigned using DHCP, and we have no record of the name of any subscriber associated with an IP address."  When reading the article and then the opinion, I found a discrepancy.  Declan says the Verizon subscriber "allegedly was sharing" (that is, outgoing traffic to other users), while the opinion explicitly says "downloaded" (presumably, incoming from other users).
This raises the question in my mind, how would the RIAA know?  Are they snooping on Verizon's network?  Wouldn't this eavesdropping be solved by using encryption?
Discussing this with Niels Provos, he mentioned they might have a honeypot, and track the IP addresses of downloads.  But then, wouldn't the downloads be "authorized" by the RIAA, and thus not infringing? Although the opinion itself is clear as far as it goes, unfortunately it doesn't cover the issues that are more important to us.  The judge declined to rule, as the Verizon lawyers left it to amici to argue,   Without a "properly developed record," the court found that the   defendant effectively waived the constitutional challenge:   17 Verizon devotes only two sentences and a footnote to the   constitutional issues, contending that the subsection (h) subpoena   authority, if broadly construed, raises substantial Article III   (judicial power) and First Amendment (freedom to engage in anonymous   speech) questions.
  [opinion page 30]

@_date: 2003-01-23 11:45:05
@_author: William Allen Simpson 
@_subject: Verizon must comply with RIAA's DMCA subpoena 
Speaking with my ISP hat on, we had an "experience" (described on NANOG and such) with legal process several years ago.  Since then, we:  1) never back up the mail servers -- if any fail, we would regenerate     the account information from billing records, but any unPOPed mail     will be lost.
 2) regenerate DSL IP addresses every 6 hours (except for those     companies paying extra for static IPs).
 3) syslog dialup IPs to a separate server, where they would be lost     when the power goes away, and in any event should roll over every day.
It's not really a sales item.  Since we are only local, I'm not sure how many customers would be "sold" by this feature.  Farmers and college students tend to be oblivious.
But there is a strong economic rationale.  We save untold operational expense, support costs, and legal fees.  (The legal cost of complying with that single interstate subpoena cost us an entire month of revenue.)
The DMCA provides for "standard technical measures" that
  "(C) do not impose substantial costs on service providers or substantial    burdens on their systems or networks."
Thus, we need to specifically ask our ISPs (market demand) to drive the process for these measures that   "(A) have been developed pursuant to a broad consensus ...."
Certainly, we're part of the consensus!?!?
Oh yes, operationally we need to keep IPs around for a short time to track network problems and enforce the AUP.  But we've found 6 hours to a day to be entirely adequate.

@_date: 2003-01-26 21:31:42
@_author: William Allen Simpson 
@_subject: Verizon must comply with RIAA's DMCA subpoena 
With all due respect to the commentator and the tremendous amount that he has contributed to the community, I had to go eat a pint of ice cream and cool down, I was so incensed after reading his comments.  Here's my attempt at a rational reply:
I don't think we caved, or are "cowardly shits".
We're too small for an "in house" lawyer.  But I won't expect sysadmin employees to go to jail.  In the main, we have to work with the system as it exists, while we work to improve it.
Those who know me well are aware that I've a few experiences along these lines in my life.
 - I've been jailed for civil contempt of court.
 - I've endured FBI investigation (google for it).
 - I've survived a 7+ year IRS audit, including 2 cases taken all the way    to the 6th Circuit, looking to see whether my cryptographic activities    were financially supported by foreigners.  - I've been party to many other cases (primarily FOIA), setting local    and state precedents argued all the way to our highest state court.  - I've been involved in electoral politics for 25+ years, and am    reasonably familiar with certain elected officials and governments.
We got one of the main ACLU attorneys in our state.  We sent back the original because it misspelled the name of the company, then challenged the scope, and finally limited the records provided.  That is, we resisted every step of the way. Then, we changed our Best Current Practices so that such a subpoena would be more difficult to fulfill in the future.  And urged the world to follow our example (well, NANOG and later this list). Here's a little story: this week I learned that one of our valuable security doctoral candidates doesn't vote, and doesn't want to learn about or discuss politics and the political implications of what she does.  This was particularly disturbing to me, as she is a naturalized citizen, coming from the old soviet union.  In other venues, new citizens are the most active in politics, happy to be somewhere they can participate. Sometimes, engineers have persistent tunnel vision....
I've always believed there's more to security than bit twiddling, and I've done my best to practice what I preach.
As I've written IETF drafts over the past 14 years, I was long an advocate of adding a "security considerations" section to everything we've done.  And I've generally added an "operational considerations" section, too. We always need to think about the consequences of our work.  It needs to enhance security.  It needs to protect the powerless from the powerful, even when the users don't think they have "anything to hide".  It needs to be easy to use (or it won't be used).
So, in some respects, you're preaching to the choir.  But there is a time and place for civil disobedience.

@_date: 2003-01-27 13:34:41
@_author: William Allen Simpson 
@_subject: Verizon must comply with RIAA's DMCA subpoena 
[Moderator's note: I think this is slipping from relevance... --Perry]
Good thing that you never post complaining about security policy and governments, then....  Funny, that seems a constant theme on this list!
For most of the years I've been involved, the very idea of public, unclassified, non-govermental activity in cryptography and security was actively opposed by our respective governments.
That changed through direct activism by many of those on this list.  Democracy is not a spectator sport.
To be involved in security is to be concerned with policy.  Ignorance of policy automatically disqualifies somebody to be a security analyst, since they have no basis for analysis.  Security requires more than mere bit twiddling.
What "civil right" would that be?
Does Australia have some sort of enumerated "right" to benefit from the work of others without contributing?
And you personally worked to educate them -- how?
And you personally worked to educate them -- how?
Sounds like an excellent "hack" of the system!  Although, with petition signatures from 5% of the electorate for each party to gain a place on the ballot, 30 parties would indicate that he had 150% of the voters sign petitions....  Either there was an error in the petition validation process, or the party qualifications are unreasonably low (5% to 15% is typical), or you're exaggerating a wee bit....
(Here, you have to show a minimum of support to gain a place on the ballot.  Indeed, incumbent officials have to go out and gather thousands of signatures to be placed on the ballot, even when their party has already qualified for the election.  Heck, many places don't require a politician to be a member of any party, as long as they separately qualify to a slightly higher standard.)

@_date: 2003-06-03 11:54:19
@_author: William Allen Simpson 
@_subject: What is currently recommended? (New v Old) 
I'll second that.  I've been considering a new release of Photuris, in honor of its upcoming 10th anniversary, and was wondering what should be the "best" defaults? Or should the hash be SHA-256?  Or is RIPEMD still going strong?
I've seen a number of messages disparaging MD5 as possible to be broken (in the next decade or so, or speculated already), but no firm recommendations on the replacement....
Likewise, CAST versus Blowfish versus AES (Rijndael) versus .... Now, I know when you rub 2 cryptographers together, you get (2**2)-1 opinions; but I'm getting rather tired of the continual griping without solid recommended alternatives....

@_date: 2003-06-30 13:05:38
@_author: William Allen Simpson 
@_subject: Attacking networks using DHCP, DNS - probably kills DNSSEC 
Would this be the DHCP working group that on at least 2 occasions when I was there, insisted that secure DHCP wouldn't require a secret, since DHCP isn't supposed to require "configuration"?
And all I was proposing at the time was username, challenge, MD5-hash
response (very CHAP-like).  They can configure ARP addresses for "security", but having both the user and administrator configure a per
host secret was apparently out of the question.

@_date: 2003-03-29 13:31:50
@_author: William Allen Simpson 
@_subject: Run a remailer, go to jail? 
I've just read Declan's politech article sent out this morning, referencing his full report at:
 I was shocked to see that Michigan has *already* passed such a law!
I've found the new law(s), and they basically outlaw my living in Michigan starting March 31st:
This was passed in a lame duck session (December 11, 2002) as part of a big omnibus crime act that covered everything from "adulteration of butter and cream", to "trick or acrobatic flying" to "false weights and measures", mostly increasing fines and/or jail for existing offenses.  Michigan is a leader in overcrowding its prisons.  There was other lame duck legislation passed, before a new Governor took office, almost all of it bad for civil liberties!
The Bill analysis basically quotes the MPAA website!
Michigan's version was done by modifying existing statute concerning "cable or satellite television" service providers, and drastically broadening it to "TELECOMMUNICATIONS". Michigan 750.219a outlaws avoiding a communication charge.  Period.  No defraud.  "avoid or attempt to avoid ... by using any of the following:    "(a) A telecommunications access device.    "(b) An unlawful telecommunications access device.    "(c)..."
Configuring your ISDN to be a voice device, and then sending data over the device, would be a violation (SBC/Ameritech charges more for data than voice).  Most folks around here are willing to settle for 56Kbps
+ 56Kbps (fixed fee) instead of 64Kbps + 64Kbps (per minute).
Configuring a wire pair purchased as a "burglar alarm circuit" (lower fee) and then using it as DSL (avoid high fee) would be a violation. I run an ISP using this technique. Note that the equipment can equally be "a" device, *OR* an "unlawful" device.  This was a major change from previous law, which required that the device be (a) stolen or (b) counterfeit.
Note that an "unlawful" device would be, among many things listed, a "wireless scanning device".  Also, reprogramming or modifying anything. In Michigan, 750.540c(1):
  "(b) Conceal the existence or place of origin or destination of any   telecommunications service."
Subsection (2) is against programmers. Subsection (3) is against documentation writers.
Subsection (4) is    "A person who violates subsection (1), (2), or (3) is guilty of a    felony punishable by imprisonment for not more than 4 years or a    fine of not more than $2,000.00, or both. ... Each unlawful    telecommunications access device or telecommunications access device    is considered a separate violation. "
Writing documentation used by many persons who write programs for many more persons could land me in gaol for a very long time.
Michigan included both.
Also, using any device "without the express authority of the telecommunications service provider", which pretty clearly covers NAT. (Some cable companies try to charge per machine, and record the machine address of the devices connected.) Also, reprogramming a device (and software and computer chips are explicitly included) "that is capable of facilitating the interception, transmission, retransmission, decryption, acquisition, or reception of any telecommunications, transmissions, signals, or services" would seem to prohibit mod'ing of M$ Xboxen. Linux/*BSD users reading DVDs (or just about anything else) are outlaws. This is a breathtakingly broad Act.

@_date: 2003-10-17 09:43:02
@_author: William Allen Simpson 
@_subject: Feds admit error in hacking conviction 
Federal prosecutors asked a San Francisco appeals court this week to reverse a computer-crime conviction that punished a California man for notifying a company's customers of a flaw in the company's e-mail service. Filed on Tuesday in San Francisco's Ninth District Court of Appeals, the unusual request conceded that federal prosecutors in Los Angeles erred in bringing a criminal case against, and obtaining the conviction of, 30-year-old Bret McDanel. The one-time system administrator has already served his 16-month sentence and is currently on supervised release, during which time his access to computers is curtailed. If the court agrees to overturn the conviction, it will remove a precedent that could have squelched the research of many security experts. The original conviction by U.S. District Judge Lourdes G. Baird determined that, by revealing a flaw in a system's security, a researcher could be accused of harming the system, a violation of computer crime laws.
Thom Mrozek, a spokesman for the U.S. attorney's office for the Central District of California said that prosecutors rarely ask for a reversal. "It's pretty damn rare," he said. "I have never seen it happen."

@_date: 2003-09-27 18:51:26
@_author: William Allen Simpson 
@_subject: Reliance on Microsoft called risk to U.S. security 
OK, I'll lend mine.  With my ISP hat on, the vast majority of support calls have to do with users ignoring the content of M$ dialog boxes,  hitting YES or OK, then calling when things don't work.  Admittedly, the text in those dialog boxes isn't particularly useful.  But this costs us a lot of good old hard cash.
Or with my personal hat, my 15-year-old niece had an infected machine.  Actually a multiply infected machine.  Took me several hours to clean up.  And then I watched her check her yahoo mail, and click yes on the very next Norton/McAfee dialog box, reinfecting her Comcast connected machine before my very eyes. Why, I asked?  I just spent a lot of time fixing your machine, and explained what had gone wrong.  She says, "That message came from my best friend at school."  Of course it didn't.  But it probably came from another friend with them both in the address book.  And social engineering is a lot more powerful than any amount of training, no matter how very recent!
The answer to a technical problem is _not_ depending on user caution!

@_date: 2004-07-01 11:18:29
@_author: William Allen Simpson 
@_subject: US Court says no privacy in wiretap law 
Switches, routers, and any intermediate computers are fair game for warrantless wiretaps.
That is, at any time (the phrase "seconds or mili-seconds" [sic]) that the transmission is not actually on a wire.
Most important, read the very nicely written dissent.  The dissenting judge used the correct terms, referenced RFCs, and in general knew what he was talking about -- unlike the 2:1 majority!
  "... Under Councilman's narrow interpretation of the Act, the   Government would no longer need to obtain a court-authorized wiretap   order to conduct such surveillance. This would effectuate a dramatic   change in Justice Department policy and mark a significant reduction   in the public's right to privacy.   "  Such a change would not, however, be limited to the interception   of e-mails. Under Councilman's approach, the government would be free   to intercept all wire and electronic communications that are in   temporary electronic storage without having to comply with the Wiretap   Act's procedural protections. That means that the Government could   install taps at telephone company switching stations to monitor phone   conversations that are temporarily "stored" in electronic routers   during transmission. "
  [page 51-52]
As this is a US Court of Appeals, it sets precedent that other courts will use, and directly applies to all ISPs in the NE US.

@_date: 2005-01-08 09:04:11
@_author: William Allen Simpson 
@_subject: entropy depletion (was: SSL/TLS passive sniffing) 
Wondering how in the world we got into this endless debate, I went back
and re-read the entire thread(s).  I think that early comments were
It was Denker that jumped off into the realm of entropy density (again)
(Message-ID: <41C9A58E.7090203 at av8n.com>), recommending that nobody use
but wrong about our _need_ for practical security.
As David Wagner wrote with regard to another such claim:
There are already other worthy comments in the thread(s).  We are using
computational devices, and therefore computational infeasibility is the
standard that we must meet.  We _NEED_ "unpredictability" rather than
"pure entropy".
So, here are my handy practical guidelines:
 (1) As Metzger so wisely points out, the implementations of /dev/random,
"improve" things over time, without a firm understanding of the
underlying requirements.
 (2) The non-blocking nature of /dev/urandom is misunderstood.  In fact,
its secure state.  Once it reaches that state, there is no future need
to block.
 (2A) Of course, periodically refreshing the secure state is a good
thing, to overcome any possible deficiencies or cycles in the PRNG.  (2B) I like Yarrow.  I was lucky enough to be there when it was first
presented.  I'm biased, as I'd come to many of the same conclusions,
and the strong rationale confirmed my own earlier ad hoc designs.
 (2C) Unfortunately, Ted Ts'o basically announced to this list and
others that he didn't like Yarrow (Sun, 15 Aug 1999 23:46:19 -0400).  Of
course, since Ted was also a proponent of 40-bit DES keying, that depth
of analysis leads me to distrust anything else he does.  I don't know
whether the Linux implementation of /dev/{u}random was ever fixed.
 (3) User programs (and virtually all system programs) should use
 (4) Communications programs should NEVER access /dev/random.  Leaking
known bits from /dev/random might compromise other internal state.
Indeed, /dev/random should probably have been named /dev/entropy in the
first place, and never used other than by entropy analysis programs in
a research context.
 (4A) Programs must be audited to ensure that they do not use
 (4B) Accesses to /dev/random should be logged.

@_date: 2005-01-09 15:10:29
@_author: William Allen Simpson 
@_subject: entropy depletion 
Yes, that's my assumption (and practice for many years).
If we could actually get such devices, that would be good. In the real world, /dev/random is an emulated entropy device.  It hopes
to pick up bits and pieces of entropy and mashes them together.  In
common implementations, it fakes a guess of the current level of
entropy accumulated, and blocks when depleted. If there really were no relation to the previous output -- that is, a
_perfect_ lack of information about the underlying mechanism, such as
the argument that Hawking radiation conveys no information out of
black holes -- then it would never need to block, and there would
never have been a need for /dev/urandom!
(Much smarter people than I have been arguing about the information
theoretic principles of entropy in areas of physics and mathematics
for a very long time.) All I know is that it's really hard to get non-externally-observable
sources of entropy in embedded systems such as routers, my long-time
area of endeavor.  I'm happy to add in externally observable sources
such as communications checksums and timing, as long as they can be
mixed in unpredictable ways with the internal sources, to produce the
emulated entropy device.
Because it blocks, it is a critical resource, and should be logged.
After all, a malicious user might be grabbing all the entropy as a
denial of service attack.
Also, a malicious user might be monitoring the resource, looking for
cases where the output isn't actually very random.  In my experience,
rather a lot of supposed sources of entropy aren't very good.
Because we are starting from the postulate that observation of the
output could (however remotely) give away information about the
underlying state of the entropy generator(s).
I was thinking about cookies and magic numbers, generally transmitted
verbatum.  However, since we have a ready source of non-blocking keying
material in /dev/urandom, it seems to be better to use that instead of
the blocking critical resource....

@_date: 2005-01-11 13:48:56
@_author: William Allen Simpson 
@_subject: entropy depletion 
ummm, no, not by definition.
  blocks on insufficient estimate of stored entropy
  useful for indirect measurement of system characteristics
  (assumes no PRNG)
  blocks only when insufficient entropy for initialization of state
  computationally infeasible to determine underlying state
  (assumes robust PRNG)
These are the definitions we've been using around here for many years. It does help when everybody is talking about the same things.
I'll note that many systems (including the MacOSX that I'm using to
write this) have made /dev/random and /dev/urandom the same....

@_date: 2005-01-11 15:48:32
@_author: William Allen Simpson 
@_subject: entropy depletion 
Now here we disagree.  It was long my understanding
that the reason the entropy device (/dev/random)
could be used for both output and input, and blocked
awaiting more entropy collection, was the desire to
be able to quantify the result. Otherwise, there's no need to block.
Now I don't remember anybody suggesting that before!  Perfect,
except that an attacker knows when to begin watching, and is assured
that anything before s/he began watching was tossed.
In my various key generation designs using MD5, I've always used
MD-strengthening to minimize the entanglement between keys. There was MD5 code floating around for many many years that I wrote
with a NULL argument to force the MD-strengthening phase between
uses.  I never liked designs with bits for multiple keys extracted
from the same digest iteration output.
And of course, my IPsec authentication RFCs all did the same.  See
my IP-MAC design at RFC-1852 and RFC-2841.
That's OK, the writing was clearer the second time around.

@_date: 2005-11-17 18:52:43
@_author: William Allen Simpson 
@_subject: "ISAKMP" flaws? 
>> I mostly agree with you, with one caveat: the complexity of a spec can
 >> lead to buggier implementations.
 >
 > Well, then we fully agree with each other. Look at the message formats
 > used in the protocols they have attacked successfully so far.
 >
 > Humorously, security folks seem to have ignored this when designing our
 > protocols.
 >
Quoting draft-simpson-danger-isakmp-01.txt, published (after being
blocked by the IETF for years) as:
      A great many of the problematic specifications are due to the ISAKMP
   framework.  This is not surprising, as the early drafts used ASN.1,
   and were fairly clearly ISO inspired.  The observations of another
   ISO implementor (and security analyst) appear applicable:
     The specification was so general, and left so many choices, that it
     was necessary to hold "implementor workshops" to agree on what
     subsets to build and what choices to make.  The specification
     wasn't a specification of a protocol.  Instead,  it was a framework
     in which a protocol could be designed and implemented.  [Folklore-00]
   [Folklore-00]  Perlman, R., "Folklore of Protocol Design",
   draft-iab-perlman-folklore-00.txt, Work In Progress, January 1998.
Quoting "Photuris: Design Criteria", LNCS, Springer-Verlag, 1999:
   The hallmark of successful Internet protocols is that they are
   relatively simple.  This aids in analysis of the protocol design,
   improves implementation interoperability, and reduces operational
   considerations.
Compare with Photuris [RFC-2522], where undergraduate (Keromytis) and
graduate (Spatscheck, Provos) students independently were able to
complete interoperable implementations (in their spare time) in a
month or so....
So, no, some "security folks" didn't ignore this ;-)

@_date: 2005-11-18 13:35:30
@_author: William Allen Simpson 
@_subject: "ISAKMP" flaws? 
On the contrary:
  + a VERY SIMPLE "variable-length integer encoding", where every number
    has EXACTLY ONE possible representation (unlike ASN.1 which even the
    spell-checker wants to replace with assinine).
  + "similar to that of OpenPGP", the most common Open Source security
    software of the era, where the code could be easily reused (as it
    was in the initial implementation).
On the contrary, where are internal nested containers in the protocol?
However, as most things that cross the INTER-net, the packets are
encapsulated in UDP, IP, and some media frame, all of which may have
their own length.  That why there are copious "implementation notes",
saying for example:
    When processing datagrams containing variable size values, the length
    must be checked against the overall datagram length.  An invalid size
    (too long or short) that causes a poorly coded receiver to abort
    could be used as a denial of service attack.
I remember some observers complaining about the 17 warnings concerning
comparing the variable length to the UDP length, saying it cluttered
the specification.
I remember some implementers cheering about the 17 warnings concerning
comparing the variable length to the UDP length, saying it helped
clarify the specification as they wrote the code.
I defy you to find an INTER-net protocol without RTP/TCP/UDP, IP, and
media framing....
At the time, I only had 17 years of protocol implementation experience.
Another decade later, it still seems (to me) one of my better efforts.
Again, the ISAKMP flaws were foreseeable and avoidable.  And Photuris
was written before the existence of ISAKMP.

@_date: 2005-11-18 21:56:29
@_author: William Allen Simpson 
@_subject: "ISAKMP" flaws? 
Ah yes, Phil really _is_ like that, but then he was often working with
2400 bps satellites and ARRL links.  Did bring a smile :-)
But as another point, Phil was against having length fields in most
cases.  The transform parameters started as a list of single bytes, but
the "working group" (a misnomer) insisted on length fields.  I remember
Phil slumping down in his seat.  I convinced him we could treat them
all as 2 byte constants, since the length didn't actually vary.  ;-)
Ah yes, a couple of years after Photuris.  And wasn't Jon the _author_
of the PGP variable length integer specification?  Hoisted on his petard?
I did use all 32-bit length fields in RADIUS.  Different environment.
And finally, the reason for the extra specification of an extension
beyond 32-bit lengths was provided by an obscure fellow by the name of
Rivest.  He argued (insisted vehemently) that security specifications
should take all possible future-proofing precautions, even though we
currently don't see the need, so that the specification is _never_
ambiguous.  (I'm paraphrasing, he was far more loquacious.)
There aren't any.  I could, and did.
Have you actually read all (or any) of the specifications?
It's a sad day when reliability greater than provided by M$ or Netscape
is considered "extra cost".
I've always believed robust security merits the same attention to detail
that is needed in a device driver.  And I came of age in programming
communication device drivers when there was no guarantee that the
backplane would successfully carry the interrupt saying a byte had been
transferred, so you had a software timer to initiate a task to separately
query the hardware for lost characters or overruns.  And another hardware
(watch timer) interrupt just in case the software got stuck.
IBM 1800.  Alpha Micro.  HP 21MX.  IBM PC PIC.  Zilog.  Embedded process
control.  Electronically and physically noisy factory floor environments.
But it helps a lot when the specification is written hand-in-hand with
the code, so that every opportunity is taken to simplify the code.
So, where is the community to replace ISAKMP with something more robust?
Provos' Photuris code could be running on all the BSDs in a few months.
Maybe sooner, were payment involved.

@_date: 2005-09-17 10:52:48
@_author: William Allen Simpson 
@_subject: European country forbids its citizens from smiling for passport photos 
Do you really need to click on this link to know which one it is?
I guess we should give neutral facial expressions for the photo, then
smile (or frown) while in the airport....
Sounds like the technology (still) isn't ready for prime time.
(seen at

@_date: 2006-04-09 23:57:17
@_author: William Allen Simpson 
@_subject: Linux RNG paper 
Had a bit of time waiting for a file to download, and just read the paper
that's been sitting on my desktop.  The analysis of the weakness is new,
but sadly many of the problems werre already known, and several previously
discussed on this list!
The forward secrecy problem was identified circa 1995 by Phil Karn, who
therefore saved the changed state after generating each random key --
something similar to the paper's suggestion.
The lack of jitter in millisecond event time was also identified by Karn,
and he developed i386 code to determine microseconds from processor timing.
Sorry, I cannot remember whether it only worked on 386 and above, or also
186/286 we were using in cell phones at the time.  But I certainly used
it in a number of routers over the years....
We also noticed the event jitter was more important for unpredictability
than the actual event values, and all my code just added the value to the
microsecond time.  The code was fast enough to handle very rapid interrupt
time events by leaving complex functions for later.  This assumes a
cryptographically strong output function will sufficiently hash the bits
that calculating and saving the jitter itself is a waste of effort.
We also always used any network checksum that came across the transom,
including packets, IP, UDP, and TCP.  Yes, it is externally visible, but
the microsecond time is not, and adding them makes the actual pool values
less predictable (although within a constrained range).
Also, rather than deciding the pool was "full" of entropy, we just kept
XOR'ing the new values with the old, as a circular buffer (again similar
to the paper's suggestion).
Finally, a lot of this was discussed in public, and both Karn's and my
code variants were publicly available.  I don't have my old email
backups online, but I'm sure it was discussed at places such as the
tcp-group and ipsec circa 1995.
After the first Yarrow draft, it was discussed on the old linux-ipsec list
circa 1999 April 22, and on this list circa 1999 August 17.
After much discussion, Theodore Y. Ts'o wrote
(<199908160346.XAA09070 at tsx-prime.MIT.EDU>):
 >    Date: Sun, 15 Aug 1999 10:00:01 -0400
 >    From: wsimpson at greendragon.com (William Allen Simpson)
 >    Catching up, and after talking with John Kelsey and Sandy Harris at
 >    SAC'99, it seems clear that there is some consensus on these lists that
 >    the semantics of /dev/urandom need improvement, and that some principles
 >    of Yarrow should be incorporated.  I think that most posters can be
 >    satisfied by making the functionality of /dev/random and /dev/urandom
 >    more orthogonal.
 >
 > Bill, you're not the IETF working group chairman on /dev/random, and
 > /dev/random isn't a working group subject to consensus.  I'm the author,
 > with the sole responsibility to make decisions about what's best for the
 > device driver.  Of course, if someone else wants to make an alternative
 > /dev/random driver, they're free to use it in their system.  They can
 > even petition Linus Torvalds to replace theirs with mine, although I
 > doubt they'd get very far.
 >
Unfortunately, the fact that Linux remains vulnerable to the iterative
guessing attack was really due to Ted's intransigence, and some personal
relationship that he enjoys with Linus.
Thank you for the independent analysis once again bringing this topic to
everybody's attention.  Hard to believe that another 7 years have passed.

@_date: 2006-04-16 21:46:34
@_author: William Allen Simpson 
@_subject: Internet Identity Workshop (IIW) May 1-3, 2006 
This came to my attention via the wikimedia.org tech list:
Computer History Museum
Mountainview CA
A Ben Laurie is listed as going, but any more strong crypto folks out
there in the Bay area?

@_date: 2006-05-02 14:47:21
@_author: William Allen Simpson 
@_subject: what's wrong with HMAC? 
Actually, that paper really describes "version-2" (or even version-N) of
HMAC, as the original design paper had some serious flaws.
And the other constructions were not so much /ad hoc/ (they had been
proposed by various established security folks with varying amounts of
accompanying math) as *incompletely analyzed*.  A part of the problem is
that independent analysis wasn't forthcoming until long after
implementation.  The problem wasn't considered enough of a "hot topic" at
the time.
Another part of the problem was that the publication lag of RFCs was (is)
so ridiculously long.  The envelope method published in RFC 1828 was a
variant of the original developed as part of the IPv6 design circa 1993:
   key, fill, datagram, key, fill
but had been replaced circa 1995 by IP-MAC (in Photuris):
   key, fill, datagram, fill, key, fill
yet was not officially published (due to politics) for MD5 until:
* RFC 2522, "Photuris: Session-Key Management Protocol", March 1999.
and SHA1 even later (took so long it was published as "Historic"):
* RFC 2841, "IP Authentication using Keyed SHA1 with Interleaved Padding
   (IP-MAC)", November 2000.
Filling (padding to the natural block boundary of the algorithm) was/is
accomplished by the usual M-D strengthening technique.
I had a preliminary paper showing that the nested N-MAC/H-MAC design was
actually *weaker* than envelope style IP-MAC, but at the request of some
colleagues saved it for a book they were putting together.  Sadly, that
book was never published.
The basic problem is that the nested method truncates the internal
chaining variables, while the envelope method preserves them and
truncates only upon final output.
Of course, AFAICT, the trailing key makes the various recent attacks
on MD5 and SHA1 entirely inapplicable.

@_date: 2006-05-11 19:49:59
@_author: William Allen Simpson 
@_subject: NSA knows who you've called. 
Legal analysis from Center for Democracy and Technology at:
