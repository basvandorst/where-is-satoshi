
@_date: 2005-07-03 15:30:11
@_author: Lance James 
@_subject: Feature or Flaw? 
Hi all,
I wanted to introduce something that has probably been known for some time now, but has never been really addressed due to possible conflicting views of how SSL certificates should work, and where the CA's should (or should not) fit in. As we all know, the recent attention to the phishing threat vector has spawned some interesting views of how we look at certain responses that a web browser might appropriate in regards to certain conditions set by the server. Some of these include the recent "javascript dialog" box vulnerability, since there are requests that a javascript dialog box should display it's origin, etc... (see  In light of that, I thought it might be relevant to address a question that's been on my mind, and figure that the cryptography list may be the best place to find the answer. (the answer is 42, just kidding).
I've set up a site that requires a bit of imagination since I don't wish to expose any financial institutions (bankone is just a random example that I chose) that may be vulnerable to cross-user attacks, but I can tell you that this discovery of impact was done within an audit that explicitly demonstrated a problem. Also, I use a thawte signed certificate, so some mozilla browsers do not seem to regard it as a valid CA, please ignore that if you get a warning, as it is only a distraction of the real problem (aka, if it were a verisign cert it would not warn).
This site is set so that there is a frame of  inside my  site. The imaginative part is that you may have to reverse the rolls to understand the impact of this ( with  frame -> done via cross-user attacks trivially). At the bottom you will see the securescience.com certificate, but no indication of the bankone certificate. You will also not get any warnings due to the fact that the bankone certificate is validly signed by a CA. With the Cross-User threat vector, a phisher can easily use a validly signed Cert to perform a site takeover with no warning that an outside (the domain) certificate exists within the site. The lock does show that it's secure, and there are no indications that this site should not be "trusted" according to the rules that are dispersed to the mainstream public. Unfortunately, this "Mixed" attack in a cross-user scenario could be encrypting/decrypting the login page with the attacker cert and no one is the wiser without heavy inspection of the source code.
Feature, or flaw?

@_date: 2005-07-05 08:09:19
@_author: Lance James 
@_subject: Feature or Flaw? 
Ok, XSS or not, my concern is that you have multiple Certificates within a session, and the user is not aware of the others. Yes, they are valid, but define valid within SSL certs means, I go to geotrust or some CA, use my stolen credit card and buy a valid cert.

@_date: 2005-07-05 08:11:30
@_author: Lance James 
@_subject: Feature or Flaw? 
How would you go about doing that and still get the SSL Lock to remain as the banks? Can you give an example?

@_date: 2005-07-05 08:43:51
@_author: Lance James 
@_subject: Feature or Flaw? 
And as stated above, reverse the effect and it would be the banks in scenarios such as XSS. The Banks SSL cert is actually handling all the data, my concern is that the user is not aware of this and only trusts the domain that's indicated in the address bar's cert.

@_date: 2005-07-05 08:45:02
@_author: Lance James 
@_subject: Feature or Flaw? 
It's not the "new" issue - it's the concern that frames with other SSL protect information is not being indicated to the user, thus you can encrypt data with another valid cert within a frame(s) and the user will only know of the main cert from the domain that is indicated by the address bar.

@_date: 2005-07-05 09:55:24
@_author: Lance James 
@_subject: Feature or Flaw? 
Thank you - that was my point essentially. SSL is and always will be for web a broken concept.

@_date: 2005-07-06 06:58:41
@_author: Lance James 
@_subject: [Anti-fraud] Re: Feature or Flaw? 
I agree that so far this issue only lies within an XSS or already compromisable setup against SSL - so again, the site is considered compromised - but, the fact that embedded objects can be called into play that are considered "protected" within another frame can not be identified by the user, in my opinion, may cause unforeseeable risks.
This is technically true, the attacker can easily divise it's own forms and make it work rather easily (of course in the real world, the link would be a bit excessive when used in a phishing attack). I bring this up, for the same reason the "Secunia Javascript origin" vulnerability was brought up - is that really a flaw??? I'm not attempting to be alarmist, I'm trying to drive a point home.

@_date: 2005-07-09 11:05:48
@_author: Lance James 
@_subject: the limits of crypto and authentication 
There is a possible solution against an OLE event driven session rider such as this one. The solution I proposed was to use a variant of CAPTCHA that would add mutual authentication in the mix within the picture. Yes, there are some people that say CAPTCHA can be broken, but in the game of phishing, it's abouit numbers, not about silver bullets. The way to get around the "porn" CAPTCHA problem was to ask something that the user might only know and then ask the user about the activity they are performing.
This would stop this instance of E-gold attacks.

@_date: 2005-07-10 11:29:52
@_author: Lance James 
@_subject: Why Blockbuster looks at your ID. 
This goes along with paypal's "send a friend a debit card" feature (I saw this two years ago, I don't know if this is still present), but this essentially allowed a user to add any name to the debit visa card (treated in most places like a credit card) which in some cases actually allowed online hijacking of domain names (depending on registrar) because the name was the same on the visa card used.

@_date: 2005-07-11 17:13:23
@_author: Lance James 
@_subject: New Credit Card Scam (fwd) 
Even with standards in place for the consumer, that's only half of the circle. Phishers/Scammers are evolving rapidly and are either black hats themselves or have access to employing black hats to compromise sites, or perform cross-user attacks on the user. Companies like Amazon are only as secure as how they have devised their infrastructure - and as you and everyone else here knows, SSL is one layer of the "security in depth" infrastructure model. This threat vector has not been addressed by commercial entities that offer transaction services for many reasons, one being that the procurement process takes a long time just to get any security technology in place to fend off these attacks. Soon phishers will just use the site itself to phish users, pushing away the dependency on tricking the user with a "spoofed" or "mirrored" site.

@_date: 2005-07-11 21:31:38
@_author: Lance James 
@_subject: New Credit Card Scam (fwd) 
I'm being misunderstood - Cross-User attack concepts specifically is what I'm referring to. The straight on attacks on sites are definitely a processed phase within the many attack vectors they are performing, I'm just making clear that the businesses need to start working on those weak links.

@_date: 2005-07-29 16:01:13
@_author: Lance James 
@_subject: Diebold - might be of interest 
============================== START ==============================
Hi all,
I don't know if this is appropriate on this list, but I know that diebold voting systems have been an issue in the cryptography community for a while now. Having said that, I'm pasting an article that I received (from my parents actually) that might be of interest to this group. If it is not, just moderate :)
*Subject:* Black Box
Darkness is settling over the election process in San Diego.  I say get rid of anything electronic that has  to do with elections. Realistic VIEWING THE DIEBOLD VOTE-TALLYING SCREEN PROHIBITED
Jim March, a member of the Black Box Voting board of directors,
was arrested Tuesday evening for trying to observe the Diebold
central tabulator (vote tallying machine) as the votes were being
counted in San Diego's mayoral election (July 26).
(- online discussion: http:/ -)
According to Jim Hamilton, an elections integrity advocate from
San Diego, he and March visited the office of the registrar
of elections earlier in the day. During this visit, March made
two requests, which were refused by Mikel Haas, the San Diego
Registrar of elections.
1) March asked that the central tabulator, the computer that
tallies up the votes from all the precincts, be positioned so
that citizens could observe it. According to Hamilton, this
would have required simply moving a table a few feet.
2) March also asked for a copy of the ".gbf" files -- the vote
tally files collected during the course of tabulation - to be
provided for examination after the election.
During the tallying of the election, the Diebold computer
was positioned too far away for citizens to read the screen.
Citizens could not watch error messages, or even perceive
significant anomalies or malfunctions.
Unable to see the screen, March went into the office where the
tabulator was housed. Two deputies followed him and escorted
him out.
According to Hamilton: "He was not belligerent, not at all.
After he went inside the tabulator room he came [was escorted]
out and he said clearly 'I'm not resisting.' They handcuffed
him, took him out of the building. They put him in a squad car.
They're going to take him to the police station, book him and
take him to jail," said Hamilton. "He's getting charged with a
felony, 'interfering with an election official.'"
March's actions are the culmination of two years of increasing
frustration with the refusal of election officials to respond to
security deficiencies in the voting machines. The software that
tallies the votes in San Diego is made by Diebold Election Systems,
a company that has already paid the state of California $2.8 million
for making false claims, due to a lawsuit filed by March and Black
Box Voting founder Bev Harris.
On July 4, a report was released by European computer security
expert Harri Hursti, revealing that the Diebold voting system
contains profound architectural flaws. "It is open for business,"
says Hursti, who demonstrated the flaws on Leon County, Florida
Diebold machines. He penetrated the voting system in less than
five minutes, manipulating vote reports in a way that was
Despite the critical security alert issued by Hursti, San Diego
County sent 713 voting machines home with poll workers, increasing
the risk that the "memory cards" housed in the machines could be
hacked, and removing the argument that "inside access" was carefully
The arrest of Jim March underlines a fundamental problem facing
Americans today as, increasingly, they lose the ability to monitor,
verify, or watch any part of the counting process.
The San Diego registrar of elections knew of the security flaws in
the voting system. Diebold has never denied the vulnerability
identified in Hursti's report, found at
Despite knowledge of the increased risks, Haas made the decision
to create additional vulnerability by sending the machines home
with hundreds of poll workers.
While San Diego officials will no doubt point to a small seal on
the compartment housing the memory card (the component exploited
in Hursti's study), Black Box Voting has interviewed a former
San Diego poll worker, who reported that all that is necessary
to dislodge and then reaffix the seal is a small pair of pliers.
IN A NUTSHELL:
- The machines have been demonstrated to be vulnerable to
undetected tampering
- The San Diego registrar of voters chose not to take
appropriate precautions
- The main tally machine was placed in a location that was
impossible for citizens to observe
- Many voting integrity advocates have come to believe that
 voting machine reform now rivals the urgency of the Civil
Rights movement in the 1960s.
Jim March acted on those beliefs.
* * * * *
If you share the feelings that Jim March has expressed
about voting system secrecy, please forward this message to
your lists and to online blogs as appropriate. Permission
granted to reprint, with link to * * * *
Black Box Voting

@_date: 2005-06-08 12:26:47
@_author: Lance James 
@_subject: AmEx unprotected login site 
Protected or not, AmericanExpress.com has multiple web vulnerabilities -
I wouldn't log into it with a ten-foot pole :)
-----Original Message-----
[mailto:owner-cryptography at metzdowd.com] On Behalf Of Perry E. Metzger
Sent: Wednesday, June 08, 2005 12:16 PM
login box window itself They're still doing the wrong thing. Unless the page was transmitted
to you securely, you have no way to trust that your username and
password are going to them and not to someone who cleverly sent you an
altered version of the page.

@_date: 2005-06-23 21:15:26
@_author: Lance James 
@_subject: Some companies are just asking for it. 
John, I have some serious samples of "Consumer Mis-education" as it's been dubbed - I actually provided some of the samples in Aaron's report.
Side note, not only are the emails confusing, but every email that I get from a consumer, so far I've gotten (the american express in the powerpoint especially is really screwed) ebay, amex, bank of america all had major vulnerabilities that allow cross-user attacks within them. Not only that, to add to his report, with cross-user attacks (I'm probably preaching to the choir but, it's still interesting) you can foil SSL connections with the lock by using what I call a "Mixed-SSL" attack, where you have multiple frame control with your valid certs, but the domain url is  This in essence only indicates one SSL cert, that being the banks site that you have injected code into and by walking the DOM you essentially use your certs to maintain the secure frame objects. (For a demo of this contact me offline).
There was a point - oh yes, with the emails - in most of these cases, there can be what I call a bulk mail "replay" attack. Assume a phisher has a "BofA" account, and receives the bulk mailings of the legitimate Financial Institution (FI). This is a safe assumption because in the past we have seen a phisher utilize a real BofA email and just replaced the links with poisoned links that used BofA's site to phish the user. So with some timing, a "replay" attack can be organized - since we establish that say "BofA" has some vulnerabilities in XSS (This is just an example, no offense to BofA), the phisher can wait for a commerical legitimate marketing campaign and then mix in his poisoned mass mailing within the same time frame as these are going out. This will not only confuse the customer, but when reported may get underestimated because the FI did in fact send out a mass-mail to their customers*. The poisoned URL with the real domain and real (SSL-MIX) lock at the bottom of the screen belonging to Bank of America (even though the phisher took over the site) could potentially increase ROI by inducing "misplaced trust" or cause severe lack of confidence within the already troubling concept of online banking.
*Ironically, i did find a vulnerability previously in a certain FI mass mailing campaign that allowed me to arbitrarily subscribe anyone's email address to their campaign list and control settings for whether they get the "Solicited" Commercial Email. This adds to the effect since phishers can subscribe anyone, not just their customers.

@_date: 2005-06-25 12:15:44
@_author: Lance James 
@_subject: Some companies are just asking for it. 
I can vouch on that level as well, unfortunately what I can vouch for is covered under NDA - but I can tell you they are very serious about addressing security - mind you, no one is perfect.

@_date: 2005-03-24 22:53:00
@_author: Lance James 
@_subject: Off-list request 
I don't know if it's inappropriate to ask on this list, but regarding Can I get off-list quotes regarding a formal professional review and possible assistance in the steps taken to establish this cipher into the review process.
Thank you.

@_date: 2005-03-25 13:24:52
@_author: Lance James 
@_subject: Secure Science issues preview of their upcoming block cipher 
There is a miswording here, we were trying to show that both AES and CS2-128 are resistant to the same class of attacks. We definitely did not try to state that they are equivalent.
I recommend reading  to see for yourself.

@_date: 2005-05-26 13:52:40
@_author: Lance James 
@_subject: Citibank discloses private information to improve security 
But from your point, the codeword would be in the clear as well. Respectively speaking, I don't see how either solution would solve this.

@_date: 2005-05-31 11:20:50
@_author: Lance James 
@_subject: Citibank discloses private information to improve security 
I agree on the privacy issue, your point is well taken there.

@_date: 2006-01-25 11:18:19
@_author: Lance James 
@_subject: Kama Sutra Spoofs Digital Certificates 
Sounds like a "pseudo-Cache" attack then - is that not valid as a
"spoof" though?
There was an embedded SSL Cache attack a few years back, and that was
considered a man-in-the-middle spoof attack.
Is there a specific definition to that?

@_date: 2006-07-10 15:08:17
@_author: Lance James 
@_subject: Phishers Defeat 2-Factor Auth 
Full article at http: // blog.washingtonpost.com / securityfix / Citibank Phish Spoofs 2-Factor Authentication
Security experts have long touted the need for financial Web sites to move
beyond mere passwords and implement so-called "two-factor authentication" --
the second factor being something the user has in their physical possession
like an access card -- as the answer to protecting customers from phishing
attacks that use phony e-mails and bogus Web sites to trick users into
forking over their personal and financial data.
These methods work, however, only so long as the bad guys don't fake those
as well. Take this latest phish, spotted by the people over at Secure
Science Corp. It uses an impressively crafted Web-based e-mail that targets
users of Citibank's Citibusiness service, which -- as its name suggests --
caters to businesses. Citibusiness also requires customers who want to log
into their accounts online to use a supplied token in addition to their user
name and password. The small device generates an additional password that
changes every minute or so.
The scam e-mail says someone (a nice touch added here -- the IP address of
the imaginary suspect) has tried to to log in to your account and that you
need to "confirm" your account info. Not a whole lot that's revolutionary
there, but when you click on the link, you get a very convincing site that
looks identical to the Citibusiness login page, complete with a longish Web
address that at first glance appears to end in "Citibank.com," but in fact
ends at a Web site in Russia called "Tufel-Club.ru."
The site asks for your user name and password, as well as the
token-generated key. If you visit the site and enter bogus information to
test whether the site is legit -- a tactic used by some security-savvy
people -- you might be fooled. That's because this site acts as the "man in
the middle" -- it submits data provided by the user to the actual
Citibusiness login site. If that data generates an error, so does the
phishing site, thus making it look more real.
Update, 4:41 p.m. ET: I forgot to mention that while this phishing site was
active late last week and during the weekend, it has since been shut down.

@_date: 2006-07-11 10:59:50
@_author: Lance James 
@_subject: Phishers Defeat 2-Factor Auth 
Yep, the phishers finally started doing it. If it becomes a threat to them,
they will adapt.
-----Original Message-----
[mailto:owner-cryptography at metzdowd.com] On Behalf Of Anne & Lynn Wheeler
Sent: Tuesday, July 11, 2006 10:39 AM
happen to mention more than a year ago ... that it would be subject to mitm-attacks ... recent comment on the subject
 Threatwatch - 2-factor tokens attacked by phishers.
in thread in this mailing list more than year ago
 Citibank discloses private information to improve security
 Citibank discloses private information to improve security
 Citibank discloses private information to improve security
 Citibank discloses private information to improve security
 Citibank discloses private information to improve security
... and so on

@_date: 2006-06-01 10:04:36
@_author: Lance James 
@_subject: Status of SRP 
Here's where SRP fails:
1) SSL is built into the browser - doesn't stop phishers
2) Chrome or no chrome good luck getting it in there and having every
user understand it.
3) Traditional phishing works, but if you force them to change, the
malware propagation will only be higher than it is now, and I can give
you the numbers on how much data is stolen with malware (over 2 million
credit cards have been acquired since January via trojan software - how
do I know this, I monitor their blind drops constantly and one group's
daily take is over 150 megs of credentials on average.
SRP suffers from a rollback attack, chrome or no chrome - humans don't
know enough about this, and if the phisher does:
"Hi, we're having a problem with your account system as our SRP database
was corrupted, please login through the webpage to verify your
information and reset your SRP account to working order".
Surprisingly, many would fall for this.
My 2 cents.

@_date: 2006-05-30 19:37:14
@_author: Lance James 
@_subject: Status of SRP 
I disagree here, I don't think this will stop phishing for many reasons.
Please explain how it would. It will stop "man-in-the-middle" attacks on
the protocol, but phishers aren't attacking the protocols themselves.
It's still single-auth and I can still obtain the user password via
phishing. Please correct me if I'm wrong but phishing is before this
protocol will be accessed.
if Mallory convinces Carol to log into a spoofed site that looks like
Steve not running SRP, then u and x are obtained by Mallory. Mallory
simply logs into Steve with U and X.
In SRP what is preshared is g^x where x = H(s,p) where s is a salt and p
is the password.
p would be a weakness here because the user knows it, and in phishing,
if the user knows it, the user is vulnerable.
My 2 cents.

@_date: 2006-05-30 20:03:29
@_author: Lance James 
@_subject: Status of SRP 
I want to clarify, because by typing to fast, i think my variables may
be confusing since I was reading the spec of SRP from two diff docs.
u and x in my sentence was username and password not x being typical
derived secret.
what it should be is u and p. please note corrections.

@_date: 2006-09-08 10:26:45
@_author: Lance James 
@_subject: RSA SecurID SID800 Token vulnerable by design 
Hi Hadmut,
Another problem from what I see with Malware that steals data is the
formgrabbing and "on event" logging of data. Malware can detect if
SecureID is being used based on targeted events, example: Say HSBC
(Hypothetical example, not targeting HSBC) has two-factor logins in
place, the problem with this is that it is vulnerable to session riding
and trojan-in-the-middle attacks anyway, because the minute the user
logs in, the malware could launder money out (unless transaction auth is
in place, which in most cases it's not), or they could pharm the user
with a fake website that resolves as HSBC but they go in within the time
frame of that token being valid and have access. Either way, however you
cut it, SecureID/Two-Factor User auth is not protected against malware,

@_date: 2006-09-08 11:31:28
@_author: Lance James 
@_subject: RSA SecurID SID800 Token vulnerable by design 
Agreed, and since my research is focused on online banking I can see
yours and my point, either way, SecurID should not be the only concept
for dependence.
