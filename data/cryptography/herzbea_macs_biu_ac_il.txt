
@_date: 2004-08-16 16:50:10
@_author: Amir Herzberg 
@_subject: Websites, Passwords, and Consumers (Re: CRYPTO-GRAM, August	15,2004) 
The banks have nothing to do with it? Banks are often acting
irresponsibly and making it easier for phishers to lure their customers,
1. not protecting the login pages using SSL/TLS, e.g. (more examples here: 2. not using meaningful, consistent domain names (one of the following is spoofed:  3. not giving correct advice to customers (too many examples...)
4. not using signed e-mail to send their messages...
... and more...

@_date: 2004-08-17 16:03:08
@_author: Amir Herzberg 
@_subject: HMAC? 
Considering that HMAC goal is `only` a MAC (shared key authentication), the existence of any collision is not very relevant to its use. But furthermore, what HMAC needs from the hash function is only that it will be hard to find collision when using an unknown, random key; clearly the current collisions are far off from this situation.
So, finding specific collisions in the hash function should not cause too much worry about its use in HMAC. Of course, if this would lead to finding many collisions easily, including to messages with random prefixes, this could be more worrying...

@_date: 2004-07-07 20:10:21
@_author: Amir Herzberg 
@_subject: Using crypto against Phishing, Spoofing and Spamming... 
However,
I'm not sure what you mean by `logotype registry`. Such a registry already exist (off-web), i.e. national trademark offices, e.g.  These bodies could issue logo certificates. Or, private companies, e.g. verisign, can issue logo certificates, based on the official trademark registers; that shouldn't be hard.
As to a registry to hold these certificates - the site (e.g. bank) would probably keep it... and many other places (this is signed i.e. not risky to keep).
Finally, of course, until such certificates are available, we simply use the manual binding of logos/icons/names to public keys, on the first time you enter a secure site using a browser with our enchancement. It works great... very convenient, and very clear (see screen shots in paper).

@_date: 2004-07-08 18:35:05
@_author: Amir Herzberg 
@_subject: Can crypto help against Phishing, Spoofing and Spamming... 
Reminder: following lots of discussion on this list, I wrote proposals on how crypto can help solve phishing, spoofing and spamming problems.
Apparently few had problems downloading the PDF files from our (BIU) site.  so I've put both papers in ecrypt (which I believe is more reliable), and also, I've put HTML version in our site.
So, I apologize for the inconvenience if you tried before and got nothing, but these links should work fine, and I am very interested in your feedback:
# Protecting (even) Na?ve Web Users, or: Preventing Spoofing and Establishing Credentials of Web Sites, at  and # Controlling Spam by Secure Internet Content Selection, at  and

@_date: 2004-07-11 10:39:18
@_author: Amir Herzberg 
@_subject: EZ Pass and the fast lane .... 
The toll road that began operating here in Israel seems able to read your license plate number, without even requiring cars to slow down (and they definitely _don't_ slow down...).
So I think this observation about EZ Pass is probably true, but for some time ago; with current technology, reading license plates is possible (which, I guess, has some alarming privacy implications...).
Best regards,
Amir Herzberg
Associate Professor, Computer Science Dept., Bar Ilan University
 (information and lectures in cryptography &

@_date: 2004-07-11 10:49:52
@_author: Amir Herzberg 
@_subject: Using crypto against Phishing, Spoofing and Spamming... 
We think that the trusted credenatials and logo area will provide some protection against this as well,
since you get very clear indication of running an insecure site (see screen shots)... of course I agree with you that we should validate this intuition with user studies (and I'm trying to arrange these).
The Gartner study I've cited in my paper (off my homepage), and some other publications I've seen, claim very high actual damages.

@_date: 2004-07-11 11:15:01
@_author: Amir Herzberg 
@_subject: Using crypto against Phishing, Spoofing and Spamming... 
Exactly. Browsers simply require sites to have a certificate from any CA. Browswers can't even specify a list of their prefered/acceptable CA... This made it easier for SSL to roll-out, but, like you say, made certificates into commodities and almost meaningless.
Agreed! Except, I think that the user may also be involved in recognizing the more trustworthy CA, e.g. by including also a logo of the CA in the TCA - so I can see, `this site is IBM (since I see their logo) and this was validated by Verisign and/or the USPTO (since I see their `logo certified by` logo(s)).
I'm not sure I agree here. I think that many logos (e.g. of international companies) are already well protected by the existing network of trade mark offices. As to smaller companies, they would be protected by the logo but also by including icons/seals of credentials in the Trusted Credentials Area. E.g., getting back to your example, a site such as Perry's, which contain professional crypto information, should be able to get a credential from organizations such as IACR or ACM or Financial Cryptography or... and I guess these places would not give a credential (certainly not to the same logo) for a resturant.
So, the site logo becomes more meaningful when accompanied by the Logo Certifying Authority logo, and/or by appropriate credentials.
Let's not pick on Nigeria, but I get your point; but why should you set your browser to trust logo certificates from an LCA you don't trust?? The site can obtain multiple logo certificates if it wants its logo to be internentionally trusted.
Agreed. We already planned to have the LCA's logo in the TCA but I'll modify the paper (and code) to make this more clear and visible. Thanks!
BTW, notice that by default, and considering there is no CA certifying logos yet afaik, you simply have to validate the (regular) certificate on the first time you get a public key from the server...

@_date: 2004-07-13 13:09:30
@_author: Amir Herzberg 
@_subject: Question on the state of the security industry 
the paper, at:
contains excellent review of the area and of the known, existing tools (anti-virus, spam-filter, ...) and good practices for users and Michael, I've noted that the authors acknowledged you, so could you forward them our proposal (at my homepage or directly at  I'll love to hear their feedback..

@_date: 2004-07-14 15:57:33
@_author: Amir Herzberg 
@_subject: Can crypto help against Phishing, Spoofing and Spamming... 
Thanks! But, our prototype (for Mozilla) allows you also to select the Logo (or icon) for the site manually, although having it already signed by a trusted authority could be nice. Also: the trusted area can also display other credentials of the site, and in particular - logo and/or name of the CA.
I completely agree that existing CA solution in browser is lousy; did you notice that the main requirement to become a CA is to be a CPA (certified public accountant) and pay 1400$ to WebTrust? (more in paper)
That's why manual logo approval by the users is an important first step (works great - I don't know how I ever used e-banking without it). Second step may be for users to share these user-certified logos, and finally - for some trustworthy organizations to provide logo certificates.
Agree! We call this a credential, see in paper or just this screen shot

@_date: 2004-07-18 09:33:46
@_author: Amir Herzberg 
@_subject: dual-use digital signature vulnerability 
... skipped (it was long :-)
I don't see here any problem or attack. Indeed, there is difference between signature in the crypto sense and legally-binding signatures. The later are defined in one of two ways. One is by the `digital signature` laws in different  countries/states; that approach if often problematic, since it is quite tricky to define in a general law a binding between a person or organization and a digital signature. The other way however is fine, imho: define the digital signature in a (`regular`) contract between the parties. The contract defines what the parties agree to be considered as equivalent to their (physical) signature, with well defined interpretation and restrictions.

@_date: 2004-07-18 10:19:43
@_author: Amir Herzberg 
@_subject: On `SSL considered harmful`, correct use of condoms and SSL abuse 
Ian Grigg called attention to the fact that the use (as by pgp.com) of a lock in the FavIcon position (in the location bar) can be abused in site spoofing/phishing attacks, to fool users to think that a page is SSL protected, when it's not. In fact, this is part of Ian's `SSL considered harmful` page (at  `A page on the the harms and devastations wrought by implementations of SSL.`. With apologies to Ian, we recently saw another SSL-bashing by the folks in Artisoft, `SSL - does it protect you or is it a condom open at both ends ?` (their PR guy made a blunder of their technology... and their metaphor!).
I agree that the lock icon/logo as used in pgp.com may mislead users to think this is a protected site. But I think there is a bigger threat here. As your demo at  shows, a spoofing site could present the logo of the victim site. Now, most users don't even check the SSL logo.
In fact, many `serious` web sites ask users to enter passwords etc. in pages which are NOT PROTECTED, usually relying on a script in the page to invoke SSL just before submitting the information; this implies that a spoofing/phishing site can present the same content and collect the unencrypted passwords... I found such vulnerabilities in many of the most prestigious web sites, including Microsoft's Passport, Chase, E-Bay, Amazon, Yahoo! and TD Waterhouse (see screen shots at fig 5 of So my conclusion is: the problem is not with SSL/TLS, the problem is in their current use by browsers (and we present a possible fix in the paper). You can't sue the condom maker if it failed to protect it, although you've put it on carefully - but too late. Or if your partner promised to use it, but forgot.
So while `SSL is harmful` sounds sexy, I think it is misleading. Maybe `Stop SSL-Abuse!`

@_date: 2004-07-19 09:55:22
@_author: Amir Herzberg 
@_subject: Using crypto against Phishing, Spoofing and Spamming... 
(Eric Rescorla wrote in response to Ian Grigg)^2:
Ian, you are right!
Eric, you are right!
(Ok that was the famous Rabbi joke - hope you all know it - now SSL/TLS are a secure channel, and a pretty good one, but no more. I think Ian's complaint is not really against SSL but against the way it is used in browsers (I suspect he uses SB for Secure Browsing. Ian likes to invent acronyms and he thinks cryptographers should figure them out for themselves. It could be worse, some people send encrypted messages).
and you validated that the URL you got was the one you wanted (or at least in the same domain), and you know what's a domain to begin with, and you pay attention to all of that, and the CA is properly validating ownership of domains (do you know how easy it is to be an accepted CA?),
Exactly; as we said, SSL/TLS are good secure channel protocols.
I agree! That's exactly what we try to achieve - using SSL/TLS - in the Trusted Credentials (and logo) Area extension (we implemented for Mozilla). I'll love to hear your comments - see at  >.... Yes, it's
I completely agree that the problem is not due to SSL/TLS; in fact our solution is built on the use of SSL/TLS. The problem is with the way it is used in browsers. And in fact almost all phishing/spoofing attacks in fact do exactly what you wrote, i.e., do NOT invoke SSL at all (although really they could have got a certificate e.g. if they were willing to pay a bit). It is just too easy to fool users to not even noticing SSL is not used; even the `big guys` like Microsoft, Chase, Amazon, Yahoo!, e-Bay,... have unprotected web pages where they ask for your password etc. - they may encrypt it when you submit the form, but the user can't know this in advance, and therefore doesn't have any server authentication... (screen shots in paper or for the lazy:  Eric, I think this was rude, and quite unlike you. Nobody forces you to communicate. An apology would be in place.

@_date: 2004-07-22 11:08:08
@_author: Amir Herzberg 
@_subject: On SSL, SET,  `real PKI` and real code against Phishing/Spoofing 
brief comments/suggestions:
1. The whole discussion on how much eavesdropping is a threat is irrelevant. We all know it is a threat and the level is not important, as SSL/TLS provide a good, inexpensive solution. Drop this topic.
2. Stop beating the dead horse (SET). But yes, we should learn from mistakes... and Steve is right: SET main failure was lack of incentive to buyers and sellers. Such an incentive was our design assumption and I was assured by the CC `suits` they'll do it, but when they did, it was too little and much too late. And also they added so much baggage on this poor protocol that it became really so complex. But I am proud of few things in SET, especially...
 > It wasn't even a real PKI ...
No, exactly, it wasn't. Because what you refer to as `real PKI` (see original note...) - identities, revocation etc. - are not needed for this application (and many others). We need to use the tool that fits the job.
3. Which brings us back to SSL and Ian's objection... I think Ian _really_ objects to the fact that the major SSL/TLS deployments (browsers, servers) depend on `browser PKI`. And I agree: I think the `browser PKI` is a sad joke (on us), with the weakly-secure, not-really-trusted list of over-100 CAs. We can do much better - use SSL, but checking certificates better; display the logo of the site and/or of the CA, and allow users to decide on sites they trust (and their logos) manually...
We have been discussing these things on this list for ages, and some even asked `is there a real use for crypto`. Then, with Ahmad, we implement and document a cute little extension to Mozilla that uses SSL and certificates, but probably not what some may call `real PKI`. And guess what? You go back to argue on SSL vs. SET and such.
Guys: give us some feedback! Ok, it's a paper, not a note, but it is really pretty easy reading. And if this is too much, at least look at the screen shot:
 And then speak up - is it the right approach? Should we change something before releasing (hoping in a week or two) or longer term? Can you do it for IE or other browser?
(for the paper, see my homepage as below...)

@_date: 2004-07-22 13:37:35
@_author: Amir Herzberg 
@_subject: dual-use digital signature vulnerability 
Most (secure) signature schemes actually include the randomization as part of their process, so adding nonces to the text before signing is not necessary. OTOH, I don't see any problem in defining between the parties (in the `meta-contract` defining their use of public key signatures) that the signed documents are structured with a random field before and after the `actual contract`, as long as the fields are well

@_date: 2004-05-16 18:54:48
@_author: Amir Herzberg 
@_subject: Looking for mirror (or: better) sites to host my 
I keep the foils of my courses `intro to applied crypto` and `intro to secure communication and commerce` online at  Total of about 15 topics, each covered by pretty extensive set of foils (planned for between one and four 2-hour sessions for each topic).
However, I've had a lot of complaints about downloading my lectures from this (university) server, from people outside the university (it seems to work fine for my students). And fixing the problem here is bound to be painful. Plus anyway our location is not ideal (in many ways :-).
So, if anyone has a reliable ftp server where I could post the lectures (and update them via ftp), please let me know. The foils currently take about 25MB but I think I need at least 50MB and preferably 100MB so I can put additional stuff. I prefer a non-commercial site, which can be reasonably reliable and persistent.
In the meanwhile, if you find you cannot download the files, I guess I'll have to send by e-mail... Unfortunately these are pretty large files.
Needless to say, technical comments and corrections are also (or: especially) welcome.
Best regards,
Amir Herzberg
Professor, Computer Science Dept., Bar Ilan University
 (information and lectures in cryptography & security)

@_date: 2005-08-09 17:54:44
@_author: Amir Herzberg 
@_subject: Please try TrustBar 0.4 beta 9.3 with Hey! ... 
I've just placed new version of TrustBar including Hey! component for
testing usability and training users, please save to disk and then open
via FireFox, from:
The Hey! component is designed to support testing for other bars so I'll
be happy to cooperate in testing with other bars (e.g. petname, of
course). It is quite easy.
I will really appreciate if you test it - yourselves, of course,  but
also if you try to find one non-expert e-banking user and have him try
it for two weeks...

@_date: 2005-02-02 22:11:54
@_author: Amir Herzberg 
@_subject: Can you help develop crypto anti-spoofing/phishing tool ?  
We develop TrustBar, a simple extension to FireFox (& Mozilla), that displays the name and logo of SSL protected sites, as well as of the CA (so users can notice the use of untrusted CA). I think it is fair to say that this extension fixes some glitches in the deployment of SSL/TLS, i.e. in the most important practical cryptographic solution.
TrustBar works pretty well for several alpha users. The solution benefited a lot from discussions on this list, including substantial input by Ian. You can download it from  (and it is completely script so what you download is also the source code).
I am hoping some of you may be able to help improve, evaluate and deploy this solution. In particular, we need implementations for other browsers (e.g. IE...); we can also use help in continuing our development as several pretty cool ideas are not done yet, due to other commitments of us (Ahamd Gbara and me). For example, we designed a simple mechanism to allow sites to protect (cryptographically) also pages where SSL is too expensive, but it is waiting for implementation for a while...  And of course we need evaluations, code reviews, testing... In fact, I wouldn't object if some serious open-code developer assumed responsibility...
If people are interested, and want to discuss face to face, I'll be in RSA on 15-18/February...
Best, Amir Herzberg

@_date: 2005-02-03 16:18:53
@_author: Amir Herzberg 
@_subject: Can you help develop crypto anti-spoofing/phishing tool ? 
Daniel Carosone responded to me:
Unfortunately, users are not aware of what is a CA, and can't recognize trusted CAs. This fact is pretty obvious, but I've also validated it by appropriate user surveys (initial results already appear in the paper, see at my site  and I already have additional supporting results).
However, by exposing the brand (identity, logo) of the CA, and using simple terms (`identified by`) rather than jargon (CA), we allow users to identify suspect certifications, and we allow CAs to establish their brand - which, imho, is a good thing.
I find it almost a professional insult, that people go for non-crypto identification mechanisms to prevent spoofing and phishing. I mean, if we can't sell crypto for this purpose, this - imho - is a real failure.
Best, Amir Herzberg

@_date: 2005-02-06 15:34:20
@_author: Amir Herzberg 
@_subject: Can you help develop crypto anti-spoofing/phishing tool ? 
Ed Gerck responded to me:
This trust translates to:

@_date: 2005-02-09 15:30:11
@_author: Amir Herzberg 
@_subject: TrustBar: an open-source crypto anti-spoofing/phishing toolbar  
Ed Gerck (responded to me)^2:
... ...
This is one method of verifying, but probably not very useful for naive users... Instead, such users would base their trust on trusted evaluations of TrustBar by independant experts (like, hopefully, people on this list), or by receiving TrustBar from someone they trust (e.g. when Mozilla or Microsoft or other reputable company provide TrustBar functionality in the browser).
I think the most useful redundency here is the availability of _multiple_ (redundant) reviews of the code by independant experts.
Unfortunately, this test is neither feasible nor secure.
It is not feasible since you assume that the programs implement a (deterministic) function, while in reality programs are (usually) non-deterministic and often are also interactive processes (not a single function from input to output).
It is insecure since a program can fail only on a negligibly small fraction of the inputs, which will be invoked by the attacker. Namely, even if the programs are supposed to simply implement a (deterministic) function, e.g. AES_k(m), a rogue implementation could output AES_k(m) for all m except a special input e.g. "trapdoor", and output k when given m="trapdoor". The probability that your test will include the string "trapdoor" is negligible. QED
This is very good; I don't know if this change was motivated to any extent by TrustBar, but clearly our goals is exactly to introduce sufficiently secure solution into the browsers.
Unfortunately, our usability surveys provide clear evidence, that these improvements are still not enough to protect (most/naive) users... In fact, I doubt that many users are even aware of this feature and/or of what it means. Furthermore, currently, this information - as other info displayed by browsers - can be spoofed in different ways, as explained in our paper and in some of the previous works we cite.
Best, Amir Herzberg

@_date: 2005-02-09 19:41:36
@_author: Amir Herzberg 
@_subject: A cool demo of how to spoof sites (also shows how TrustBar  
Want to see a simple, working method to spoof sites, fooling Mozilla/FireFox/... , even with an SSL certificate and `lock`?
  See also:
   Want to protect your Mozilla/FireFox from such attacks? Install our TrustBar: (this was the first time that I had a real reason to click the `I don't trust this authority` button...)
Best, Amir Herzberg

@_date: 2005-02-10 09:28:34
@_author: Amir Herzberg 
@_subject: A cool demo of how to spoof sites (also shows how TrustBar  
No need to. I quite agree and certainly didn't claim that this (the fact TrustBar helps against this attack) is proof of TrustBar's value; after all I've been arguing for its value way before... It is just that this attack exactly highlights our claims about the need to improve visibility and in particular to make the CA a `brand` known to end user.
So far, I'm afraid we've done only `dry` surveys (which gave good indications, but I completely agree with you again, that they are insufficient). We want to do end-user testing and hope to do it, but we - Ahmad and me - have very limited resources (including time), and this is a big task. In particular, I really can't drop all of my other research and do just this... Which is exactly why I seek help from you and the others in this (and other) forums... I don't think this is only our business, after all.
Best, Amir

@_date: 2005-02-10 09:52:06
@_author: Amir Herzberg 
@_subject: A cool demo of how to spoof sites (also shows how TrustBar  
Sorry if I was not clear: I don't propose you install TrustBar because YOU need it as a solution. Many people on this list are security/crypto experts, interested in finding good solutions (for all/many users, not just for themselves), and my message was for them. And yes, while TrustBar works fine for me and apparently quite a few others, the current code is only a research prototype (on the other hand, I had already the good fortune of seeing similar research code being adopte3d by many products... e.g. with our IP-Sec code).
Best, Amir

@_date: 2005-02-10 09:59:15
@_author: Amir Herzberg 
@_subject: A cool demo of how to spoof sites (also shows how TrustBar  
Steve, my point was not the trivial fact that TrustBar would not display the homograph; suppose it did... even then, the user is _asked_ about the certificate, since it was signed by an unusual CA that the user did not specify as `to be trusted always`; this should certainly be a good warning for most users (and of course, a good situation to check for tricks such as homographs...).
And even if some user allowed this CA as `always trusted`, there is still a fair chance he'll notice that the brand of CA on his bank's site has suddenly changed... which may also raise the alarm.
Best, Amir Herzberg

@_date: 2005-02-10 10:10:04
@_author: Amir Herzberg 
@_subject: A cool demo of how to spoof sites (also shows how TrustBar  
This, of course, is up to Mozilla, not to me... We are trying to get Mozilla (and other browsers) to adopt the idea. I guess, once they do, they'll do a review and then sign, as first step towards integrating it into the browser package (you can't expect to protect all/most users, including naive, with an extension - signed or not...).
Absolutely! And I didn't write the code, btw, Ahmad did. I'm just writing designs, protocols, proofs, papers... (I like programming but rarely get to it, I'm afraid).
Of course; again: by posting on this list I am exactly encouraging people to review the code (it is all script so you can just download TrustBar and read it), write their own better code, etc...
Best, Amir Herzberg

@_date: 2005-07-03 08:55:18
@_author: Amir Herzberg 
@_subject: Menezes on HQMV 
From which it is easy to draw two contrdicting conclusions...
1. Proofs are useless, see how (even) Hugo got a flaw
2. Proofs are very useful, see how the presentation of a supposed-proof led to improved analysis and realization that more work needs be done.
I vote for  Amir

@_date: 2005-07-05 17:26:46
@_author: Amir Herzberg 
@_subject: Feature or Flaw? 
> Ok, I can do the `mental exercise` and understand the attack. But I'm not sure what is new here. Yes, if a web-site allows such XSS, then even SSL won't help it - it could end up sending the _wrong_ page, protected by SSL... And in this case I don't even think we can blame browser UI; the browser actually got this `bad` page from the server...
Maybe I miss something?
BTW, there is a new list focsed on such issues, at

@_date: 2005-07-06 09:34:11
@_author: Amir Herzberg 
@_subject: Feature or Flaw? 
Well, but I don't see that this has much to do with SSL, really. The problem is that the attacker is able to cause the server to send a page controlled (partially or fully) by the attacker. This should not happen. SSL is only supposed to ensure that the client got the page as the server sent it - and this does happen. Of course, this cannot protect against an infinite list of possible errors and vulnerabilities of the

@_date: 2005-07-10 12:02:21
@_author: Amir Herzberg 
@_subject: the limits of crypto and authentication 
Steve, thanks. Not really much of surprise, is it? Clearly, a user who lets malware onto his/her PC, e.g. a VBscript in this case, has lost control and is open to such attacks.
But... crypto and authentication, imho, are the best tools to prevent such malware from being installed. Yes, I know, this is far from the current situation, with corrupted PCs (Zombies) being a very large fraction (around a third?)...

@_date: 2005-07-14 18:43:15
@_author: Amir Herzberg 
@_subject: the limits of crypto and authentication 
This is incorrect. The main politics around SET was the artificial `merger` of iKP (from IBM & Mastercard) and STT (from Visa and MS). As far as I remember, CyberCash were involved but choose not to. They also did not disclose their protocol like the other proposals. I may be wrong about the CyberCash role, though, it was a while, and I don't think it matters so much...

@_date: 2005-06-01 15:05:17
@_author: Amir Herzberg 
@_subject: Trojan horse attack involving many major Israeli companies,  
Nicely put, but I think not quite fair. From friends in financial and other companies in the states and otherwise, I hear that Trojans are very common there as well. In fact, based on my biased judgement and limited exposure, my impression is that security practice is much better in Israeli companies - both providers and users of IT - than in comparable companies in most countries. For example, in my `hall of shame` (link below) you'll find many US and multinational companies which don't protect their login pages properly with SSL (PayPal, Chase, MS, ...). I've found very few Israeli companies, and of the few I've found, two actually acted quickly to fix the problem - which is rare! Most ignored my warning, and few sent me coupons :-) [seriously]
Could it be that such problems are more often covered-up in other countries? Or maybe that the stronger awareness in Israel also implies more attackers? I think both conclusions are likely. I also think that this exposure will further increase awareness among Israeli IT managers and developers, and hence improve the security of their systems.

@_date: 2005-06-07 12:25:06
@_author: Amir Herzberg 
@_subject: Hall of Shame of Unprotected Login Sites, and Phishing/Spoofing FAQ 
Many important, sensitive login sites are not protected, making it
easier to steal passwords from naive (and even experienced) users. See
`Hall of Shame` listing such sites at
Banks and FIs: PayPal, Chase, SmithBarney (CitiGroup), Bank of
America, TD Waterhouse, Amex, FirstCommand Bank, MidFirst Bank
Security services: MicroSoft Passport, EquiFax, InstantSSL
All sites were warned before being added to the Hall of Shame (few
actually fixed their sites and are therefore not on the page, e.g.
A related resource - a FAQ on phishing and spoofing, at

@_date: 2005-06-08 09:09:27
@_author: Amir Herzberg 
@_subject: AmEx unprotected login site (was encrypted tapes, was Re:  
Perry makes a lot of good points, but then gives a wrong example re Amex site (see below). Amex is indeed one of the unprotected login sites (see my `I-NFL Hall of Shame`,  However, Amex is one of the few companies that actually responded seriously to my warning on this matter. In fact, I think they are the _only_ company that responded seriously - but failed to fix their site... I had an interesting discussion with their security and web folks, and my conclusions are:
1. These are serious people who understand technology and security reasonably well. They are aware of many attacks, including much more advanced spoofing attacks (that can foil even an expert user of a `regular` browser - by regular I mean without improved security indicators like provided by TrustBar). Unfortunately, they use this awareness to justify to themselves the lack of protection (`why should I put a lock when some people know how to break it?`).
2. They have a serious problem in using SSL in their homepage, and for business reasons, they don't want to put the login on a different page.
3. They did not actually spell out the problem in using SSL in the homepage (like eTrade, for instance). But I think I know the reason (they didn't confirm or deny). I think the reason is that they host their site; in particlar, when I tried accessing it via https, I got an Akamai certificate... [I don't think they liked this observation; now you are led to the unprotected site]
4. Ultimately, what we have here is simply the `usability beats security` rule...
In fact, I'm bcc:ing their lead person, in case he wants to chip in and protect their professional image better than me (how about: `we reconsidered and will fix our login process`?)
below are the relevant parts of Perry's message... I think you'll agree you picked wrong example.
As I said, I agree with the above (and most of the removed stuff).
But below you jumped to the wrong conclusions.

@_date: 2005-06-09 08:57:49
@_author: Amir Herzberg 
@_subject: AmEx unprotected login site (was encrypted tapes, was Re:   
Ken, you are correct (see below). And in fact, if the page came from the right source (as validated by SSL and a secure browser extension such as TrustBar), I don't think there is any need to validate the source (which is impractical even for the geekest geek). After all, if a site is so clueless as to send you corrupted scripts, it may as well publish your password directly...
Best, Amir Herzberg
  > Unless I misunderstand, the problem is that I can not determine where my

@_date: 2005-06-09 09:24:59
@_author: Amir Herzberg 
@_subject: AmEx [add: and other] unprotected login site 
Perry: I share your feelings in this matter, great message (but I made some comments, see below). I'll appreciate the relevant Verizon URL so I'll add them to the Hall of Shame. Notice I already have several banks there, including Chase (which you also mentioned), and brokers, including CitiGroup's SmithBarney... And security companies including MS   Passport and EquiFax... More examples welcome (I'll also add `contributors` gladly). Thanks, Amir
Agreed. SSL is designed to protect against a MITM attacker, not a mere eavesdropper (for protecting only against eavesdroppers, we don't need certificates, DH would suffice, right?). Indeed, current browser security indicators are terrible, but that's why we do all this work on   secure usability, resulting in improved indicators (our TrustBar, and a host of others by now; every competent security person should use one and take care it's doing good job and not violating privacy). I firmly hope and believe this will soon be adopted by browsers, the IE people essentially told me they will, and some new browsers (NS, Ophera) already improved to some extent.
Well, of course, Microsoft are also training their users to enter passwords into unprotected login page, just like Amex - see the entry for MS Passport in the Hall of Shame... And btw, I had a long dialog with an exec in MS about it, and she actually _agreed_ and promised to fix it long ago, I'll ask her again how come nothing happens...
Examples will be added to the Hall of shame...
Absolutely, and I've also confirmed this by few lawyers...

@_date: 2005-06-09 12:31:26
@_author: Amir Herzberg 
@_subject: AmEx unprotected login site 
Sure, but:
1. This doesn't have any effect on non-SSL-protected sites (e.g. AmEx,... see `Hall of Shame`). And of course assumes users will notice the use of non-SSL-site...
2. This assumes that the problem is `untrusted site certificates`. Is it? Which CAs would you NOT accept anymore? In particular, would you now reject all `domain validated certificates` (about 25% of SSL sites I've heard)?? Much better imho to give the information to the user, possibly warning against (or blocking) certs from a CA you know to be bad.
3. This solution takes advantage of the fact that users don't have any idea which CA they trust... which is true but very bad, breaking the trust model. I think it is better to make the CA visible to the user (but in a way users can understand - I believe we have that with TrustBar).

@_date: 2005-06-09 16:18:28
@_author: Amir Herzberg 
@_subject: AmEx unprotected login site 
Ivars Suba responded to me:
As is clearly stated in messages you referred to, we all know Amex's site invoke SSL to encrypt the password. The problem is that a fake Amex site would not; and the user has no way to distinguish. Essentially, Amex site is secure against the (unlikely) eavesdropper, but not against the (much more likely) spoofer or the stronger (but possible) MITM.
So, my claims in Hall of Shame remain. Or do you want to protect the Amex process? This will be interesting.
You could of course do this filtering without also terminating the tunnel at your proxy. I agree that such filtering (without breaking the tunnel) is an advisable thing to do.
I agree most users don't know what's a CA doing and what's a PK cert. But my intuition - and research - show that they can learn very quickly if we use simple words instead of jargon. In TrustBar, we display the name/logo of the site, followed by the words `identified by` and the name/logo of the CA. Our (limited) testing shows users understand this very well. And of course this does not prevent you from also blocking in a proxy any CAs you don't trust. Let the user decide among these you can't rule out.

@_date: 2005-06-09 17:33:31
@_author: Amir Herzberg 
@_subject: AmEx unprotected login site 
Bless you for being so careful. I, instead, look at the logo of the site   and of the CA as displayed in TrustBar. This is much easier, and protects me from subtle changes in the URL e.g. homographic attacks, from spoofed address bars, and from certificates granted without proper validation, e.g. `domain validated` certificates. I would expect each security expert to use TrustBar (or other appropriate browser or browser extension - but check they don't send each URL to their server).
If you realize it at all. Phisher can easily make you unaware of this.
And no way you can protect your users by a proxy or a local TrustBar installation, which, as argued above, can protect reasonably well even naive or unsuspecting users.

@_date: 2005-06-22 15:27:47
@_author: Amir Herzberg 
@_subject: Exploiting AES cache timing attack 
A question: could this be exploited by evil employee Eve in site A, whose corporation uses IP-Sec VPN tunneling between sites A and B, and which can (somehow!) eavesdrop on the (encrypted) communication on the Net but _not_ on the (plaintext) communication on the intranet, to decipher the communication of a pair of honest employees, Alice in A and Bob in B?
If so, what's the best defense?

@_date: 2005-06-23 08:29:22
@_author: Amir Herzberg 
@_subject: Rephrased: Should login pages be protected by SSL - although it  
And many such sites are not protected, see `Hall of Shame` (link below)
This is correct, given the current security indicators in browsers; I even have some empirical data to support this (but it is also common sense). However, the use of SSL may help _some_ users:

@_date: 2005-03-16 12:11:33
@_author: Amir Herzberg 
@_subject: PK -> OTP? 
What's wrong with sending the device encryption of a random number (using the public key of the device), and the device sending back the number as proof of possession of the corresponding secret key?
Best, Amir Herzberg

@_date: 2005-03-16 12:18:15
@_author: Amir Herzberg 
@_subject: $90 for high assurance _versus_ $349 for low assurance 
John, thanks for this fascinating report!
Conclusion? `Not all CAs/certs are created equal`... therefore we should NOT automatically trust the contents of every certificate whose CA appears in the `root CA` list of the browser. Instead, browsers should allow users to select which CAs they trust sufficiently to identify sites, and to _know_ which CA is identifying the (protected) site they use.
This is easy to do, and of course you can add this to your Mozilla/FireFox browser by installing our TrustBar (from Best, Amir Herzberg

@_date: 2005-03-30 13:00:35
@_author: Amir Herzberg 
@_subject: how email encryption should work (and how to get it used...) 
I think this is a good summary of how it should work, except, that I don't think messages should be signed by default, only authenticated (MAC). Users should be clearly aware of making a non-repudable statement.
Plus, it may be preferable to use something like matasignatures.org to ensure authenticated e-mail does not alarm recipient with non-compliant e-mail clients.
A missing element is motivation for getting something like this deployed... I think spam could offer such motivation; and, I strongly believe that a cryptographic protocol to penalize spammers could be one of the most important tools against spam. I've presented such a simple crypto protocol (SICS) in SCN'04 [available off my site], and now work on open-source implementation (with student Jonathan Levi) of an improved version (SICSv2...), to be published soon. [I can send draft to experts willing to provide feedback...]
Best, Amir Herzberg

@_date: 2005-05-25 09:25:24
@_author: Amir Herzberg 
@_subject: how email encryption should work (and how to get it used...) 
James A. Donald responded to me:
I disagree. I believe that _accountability_ is a key element in stopping spam, and that cryptographic protocols (such as SICS) offer the best mechanisms to ensure accountability of spam. A `provable link to domain name`, imho, is merely a specific method of accountability (in the domain level), which is useful, but not necessarily optimal, esp. considering the need to support mobile users and many domains, not all fully trustworthy.
Agreed here and indeed a focal point in this effort should definitely be providing value to early adopters. I  believe we can provide such early advantages better via spam-fighting mechanisms, such as secure protocol between multiple spam-aware mail agents (MTA-MTA, MTA-MUA)); so that's what we are developing in SICS. I believe these efforts are complementary to providing encryption services.
Best, Amir Herzberg

@_date: 2005-05-30 15:34:30
@_author: Amir Herzberg 
@_subject: Trojan horse attack involving many major Israeli companies,  
Possibly the most visible Trojan attack was just exposed by the Israeli police. The Trojan was written (apparently) by an Israeli programmer, living in Europe in the last few years. It was planted in many Israeli companies, such as the major cellular companies. There were conflicting reports so far on the distribution method, and it may have used several, such as a program sent by e-mail or on CD to company. The scheme had three layers: the programmer; several `private investigation` companies (including the largest in Israel!); and the customers (including many hi-profile Israeli companies). The victims were also many leading Israeli companies. A lot of confidential documents were disclosed (via FTP to several servers, from which the customers downloaded the documents).
This is a story worth a movie, really, since there is also a personal and media issue here... This whole thing was discovered not by any of the victim companies, but  by a different victim: a well-known couple who wrote a `psychology-thriller`. The wife is the more well known; she is the host of an extremely popular (and controversial) talk-radio show, consulting listeners on different personal problems. This couple were apparently targeted by the Trojan for personal reasons; the programmer is their ex-son-in-law...
See more info e.g. at

@_date: 2005-05-31 16:47:57
@_author: Amir Herzberg 
@_subject: Trojan horse attack involving many major Israeli companies,  
John, yes, I believe the Trojan ran on Windows. In fact, I just met my kids schoolmaster, and turns out she was also a victim of that person - already 3-4 years ago!!! Her daughter learned with his in the same school, and apparently he got mad at them and started abusing them in the most crazy ways - for instance, he intercepted family pictures sent to them, and _disfigured_the_pictures!! She went to the police but I guess was less lucky and they didn't find him, she changed computers, dial-up connection, etc. etc...
As you say - movie stuff. Amir

@_date: 2005-05-31 17:05:59
@_author: Amir Herzberg 
@_subject: Citibank discloses private information to improve security 
Well, I have some usability tests that seem to prove your intuitive claim that most users don't know what's a CA. I don't know about arguments between experts on this. I think however that even naive users understand quite the TrustBar UI for SSL protected sites. We display something like  identified by . I'll   appreciate your thoughts/feedback, try it at

@_date: 2005-11-24 11:58:40
@_author: Amir Herzberg 
@_subject: `Identified by` <CA> technique of TrustBar adopted by IE, other  
IE 7 implements some of TrustBar and FF improvements to security indicators. Specifically, they now color-code the location bar and added, in SSL/TLS pages, the name of the site and the `Identified by`  - like TrustBar.
They do not yet implement some of our other mechanisms, including the petnaming (allowing users to select their own name or logo which will be automatically displayed on entering a specific site), and the `random training exercise attacks`. OTOH, at least regarding the last mechanisms, we definitely agree it is not yet ready for prime time (and hope soon to provide a better version of it).
Some relevant links:
 - IE developer describing the improved security UI, with some screen shots
 - KDE developer describes a meeting of developers of four major browsers (IE, FF, Opera, KDE) where they agreed to adopt these ideas
 - my page for info and downloads of TrustBar... TrustBar is a public domain, open source project.

@_date: 2005-10-14 10:23:23
@_author: Amir Herzberg 
@_subject: US Banks: Training the next generation of phishing victims 
I probably wasted more time than anybody on this crazy topic, and in 1. I keep `Hall of Shame` site of such unprotected login pages (even got me a DigiCrime title:  Inter-Net Fraud League Commissioner!)
2. With others, we develop TrustBar, an improved security indicator toolbar for FireFox, which also tries to protect users of unprotected login pages, e.g. by automatically redirecting to protected pages when Some results/observations:
1. Few companies that had a dialog with me said their marketing/site design folks insist on login via the homepage, claiming this is so much better for consumers compared to a separate login page. I see this as a very very extreme case of `usability beats security`.
2. Same companies also claimed that using SSL on homepage is too much overhead. Extreme case of `performance beats security`.
3. One company responded (to my warning of their unprotected login and the fact I'm going to add them to `hall of shame`) by legal threats. Typical case of `pay lawyers a lot, to avoid doing things right`.
4. One company sent me coupons for free trades. Rare example, I'm afraid...

@_date: 2005-09-14 13:47:01
@_author: Amir Herzberg 
@_subject: simple (&secure??) PW-based web login (was Re: Another entry in  
Below is a proposal, based on the problem statement by Paul Hoffman:
Excellent point. From which follows the question: can we improve the security of password-based web login, with less drastic changes - at least in the servers? Or is TLS-PSK the best/only way for us to improve pw-based web login?
I think we can. For simplicity and concreteness, let's say we have the following architecture: regular SSL-supporting client and server, and behind the SSL server we have a web server with the improved pw-login mechanism. We want to support some `improved pw-login clients`, let's say these will be regular browsers with an extension such as (a new version of) TrustBar.
Client and server begin with SSL `as is`. Now, the web server sends over this SSL-protected page a login page. Browsers without the extension, will handle it as a `classical` login form. But if the extension exists, it will detect that the server supports improved pw-based login, signalled e.g. with a META tag. The tag may also include number, denoted _Iterations_, which is the request number of hash-function iterations.
Now, we need to consider two cases: a `nomad` user, vs. a `stationary` user. Stationary case is much nicer, and can use a single PW for all sites (`single sign on`), and/or biometric/device solutions (which I won't discuss).
For a stationary user, the extension compares _Iterations_ and confirm it is at most one less than previous value of _Iterations_ used with this site. Also, the extension keeps a table r(PK) mapping the public key PK of each login site to an independant random value (we need this as real random value and can't derive them from the PW, to prevent dictionary attacks by fake sites).
Now, using a single PW, extension computes for a site with given PK the value H(0)=h(PK, h(r(PK), PW). It then sends to the web server H(_Iterations_), by H(i)=h(H(i-1)) - the usual trick. This looks pretty good at first sight, so let's see who finds a big, unfixable hole in this simple design - which requires `only` support by a script on the web server (and of course an appropriate extension, but that's something we know how to do... and we can do some `secure UI` to deal with spoofing by other applications on the PC).
Well, the case of nomad users - using a public terminal, without any secure storage facility - is less cool, imho, but there are some solutions there as well. The first is to use the old S/Key scratchpad method - user prints a few `one time passwords` for each of his login sites at home, to use on the road. Well, maybe not the most friendly solution, but will work (for known sites only). Notice that the `public PC` does not even need to have the extension for this low-tech solution to work (of course, this may allow a rogue site/PC to learn a specific OTP for a specific login site).
Another solution is to use site-specific randomizers, i.e. user will provide the value for the r(PK) table - or, we can give to the user the values of r(PK) table... these do NOT have to be passwords, since their role is really to act as `salt` - make it impractical for sites to do dictionary attack on the `main` password. Maybe we can get away with this, and try to prevent users from using the same values for multiple sites... Of course, in this solution, user still enters her real PW to the hosting, public PC - and security fails against key loggers etc. Also this still requires us to use the extension on these machines... so I like the previous solution better.
Ok, enough for now; now tell me what's wrong, etc.... It is definitely too simple to be any good.

@_date: 2005-09-14 17:43:27
@_author: Amir Herzberg 
@_subject: [Anti-fraud] simple (&secure??) PW-based web login (was  
If by pw sharing you mean using same pw to login to multiple sites - the designs tries to solve this (securely) and so, the _Iterations_ counters should be kept for each site separately.
Well, our experiance with TrustBar is contrary to that. We did not come across _any_ site that used different public keys in the different boxes. Of course, there is sense in using different key per box, to be able to identify broken-into box. But this requires many certificates and/or making browsers allow sites to sign secondary public keys; the first solution is expensive and ugly, the second requires fixing browsers, which is not very feasible...
Can you find any real counterexample? [if there are few of these, I can add an appropriate workaround easily for them - no major change]
Oops, that was mistyped: H(0)=h(r(PK), PW)). Server never sees PW, it stores only H(i) which is the latest it got; we can always begin a new chain by adding its endpoint.
Yes - see above
Do you see any MITM attack? Don't forget, this entire exchange is protected by `standard` SSL (using the server's public key PK).
I think you didn't notice that this entire exchange is all protected by the `standard`, server-auth SSL. So I just added client authentication, by sending the h^i(r(PK), PW) value, and the server can validate since it has h^{i-1}(r(PK), PW). Server never sees PW and cannot mount dictionary attack (if r(PK) has enough redundancy).

@_date: 2005-09-14 19:04:07
@_author: Amir Herzberg 
@_subject: Amazon's  
Amazon have this lovely service: if you tell if you forgot your pw, they send you to: where they ask you to confirm your identity... using 5 last digits of  a credit card you used with them.
Nice oracle to find last 5 digits... making it quite easy to find the full number.
Not that anybody would bother. Still, I find it funny.

@_date: 2005-09-15 10:45:23
@_author: Amir Herzberg 
@_subject: simple (&secure??) PW-based web login (was Re: Another entryin  
Some clarification of the proposal:
client has dedicated pw(server) to each server (today's situation). Client is supposed to be able to identify server based on the server's certificate etc., e.g. using TrustBar over regular browser.
Client also installs the pw-based login extension, and provides it with a `master pw` MPW.
Init1: client establishes SSL connection with server, to access login page. Let PK be the public key of the server.
Init2: server sends login form, with indication of support for secure login
Init3: extension identified this is a secure login, presents special window asking client to provide pw(server), and MPW if not provided yet, and to authenticate server (based on certificate).
Init4: extension generates random number and saves it as R(PK) - random number for this particular server (as identified by its public key PK)
Init5: extension sends to server, inside the SSL connection, a secure login submission, containing:
   1. pw(server) as (only) current means of client authentication
   2. h(h(MPW, R(PK))) - The value h(MPW, R(PK)) will be the `one time password` to be used in next login (we could also use a `hash chain` here but I removed it for simpicity and since it does not change much)
Init6: server verifies pw(server) (old password) and stores the received   h(h(MPW, R(PK))) as the hash of the new PW. It sends ack to the client (again protected by SSL).
Init7: upon receipt of ack, client knows pw was updated.
Regular login is pretty similar:
RL1: client establishes SSL connection with server, to access login page. Let PK be the public key of the server.
RL2: server sends login form, with indication of support for secure login
RL3: extension identified this is a secure login, presents special window asking client to provide MPW if not provided yet.
RL4: extension sends to server, inside the SSL connection, a secure login submission, containing:
   1. h(MPW, R(PK)) - The `one time password`
   2. h(h(MPW, r')) - a new one-time-pw validator for next login
R5: server verifies OTP (i.e. h(MPW, R(PK))), if OK, login is approved and saves new OTP validator h(h(MPW,r')). It sends ack to the client (again protected by SSL).
R6: upon receipt of ack, client knows pw was updated: R(PK)=r'.
This description glosses over dealing with failures, but this is not difficult; I also don't discuss how to support users of `public` PCs and changing PCs, solutions are possible.

@_date: 2005-09-19 14:54:14
@_author: Amir Herzberg 
@_subject: Defending users of unprotected login pages with TrustBar 0.4.9.93 
Most financial and other sensitive web sites use SSL/TLS to authenticate
the server and protect data from eavesdropping and from modification by
a Man In The Middle (MITM) adversary.
However, quite a few of these sites invoke SSL/TLS only _after_ user has
typed in her user name and pw, and clicked `submit`. This allows a MITM
adversary to send a modified login page to the user, which sends the pw
to the attacker (rather than encrypting it and sending to the site). See
below link to a `Hall of Shame (HoS)` listing such sites.
There are few things we can do about this. We can try to convince these
sites to use SSL/TLS _before_ asking for userid and pw; I tried, and few
fixed, but most did not. We can avoid using these sites, but this is a
bit heavy penalty e.g. if it is your bank. We can also try to find an
alternate login page which _is_ protected; in fact, we've found such
alternate, protected sites for most ebanking login sites (see HoS). But
this may be difficult for most (naive) users.
So, we decided to add support for users of these unprotected sites in
TrustBar. As of the latest version (0.4.9.93), available off my site
(below), we added two such mechanisms:
1. TrustBar will automatically download from our own server,
periodically, a list of all of the unprotected login sites, including
any alternate protected login pages we are aware of. By default,
whenever a user accesses one of these unprotected pages, she will be
automatically redirected to the alternate, protected login page.
2. TrustBar allows users to assign a name or a logo to sites, protected
or not (to help users identify fake sites). We now added a mechanism
computes a hash of every unprotected site for which the user has
assigned name/logo. TrustBar compares this hash on subsequent accesses
to the same site. If the site is not modified in five subsequent
accesses, TrustBar begins displaying `Same since `; and when the
site changes, TrustBar displays a warning. This can help users notice a
fake version of their login page. Unfortunately, this mechanism does not
work very well on most real-life login pages, since most of them contain
a tiny bit of frequently-changing data such as date or `random`
identifiers (mostly to identify a cookie-less client, we think). We are
working on improving the mechanism so it will be tolerant to such tiny
changes, without exposing the user to malicious changes.
Please try it and tell us what you think of TrustBar in general and
these features specifically. If you like it, please inform others, to
protect them, help convince browsers to incorporate such features, and -
last but not least for us - help us obtain more experimental data in our
research on secure usability. Thanks!
BTW, TrustBar is an open-source project, so if some of you want to
provide it to your customers, possibly customized (branded) etc., there
is no licensing required.

@_date: 2005-09-20 11:38:25
@_author: Amir Herzberg 
@_subject: Defending users of unprotected login pages with TrustBar  
Of course, users can turn this off for one page or for all, but that's not answering yet John's comments below - I respond following them...
Also: I am not crazy about this solution either, but I think the current situation, where very large banks insist on providing unprotected login pages, is even worse. I tried convincing them, and I must say few did change, e.g. Wells Fargo I think. I'll be happy to hear of better solutions (or do you think the current state is better?).
What if the list is signed by one or more authorities that users are willing to trust to this matter?
Or just have the list in a trusted site - after all, if someone breaks Google, they can redirect much more than by attacking our server...
We are not redirecting to a trustworthy site (e.g., your bank is insecure, try that one instead...). We simply redirect to an SSL protected page of the same entity (bank) if we know one.
Are you now against open source in general? After all, for this attack, Mozilla would be a much better target... In fact, since `everybody` uses Windows, any stupid program can redirect users to fake sites - and do much worse...
Anyway - thanks for the feedback.

@_date: 2005-09-20 12:03:07
@_author: Amir Herzberg 
@_subject: Defending users of unprotected login pages with TrustBar  
Why? What's your threat model?
 From the follow on, it seems you are concerned that even if the site's homepage say  would redirect to  like etrade for instance do, this can be redirected by a MITM attacker. Similarly, if the homepage only contains a link to the https: protected login page, like most banks do e.g. Citibank, then again a MITM may redirect this to his own page.
The user may not notice this change in address. In fact, with current browser UI, we know - by common sense and experiments - that almost all users will fail to notice such attacks. But our early experimental data with TrustBar seem to show that with improved UI, most users may be able to detect such spoofing attempts.
Moreover, a MITM attack may be done even if the user types  A MITM may reply to the SSL connection itself (e.g. via DNS spoofing). True, the browser expects a certificate for say chase.com and now will get a cert for a different site, so the user gets a warning message; however, this is the sort of messages that users often click-away without reading and definitely without understanding.
Furthermore, the attacker may even get a cert for the original address from one of the less-trustworthy CAs supported by the browser, in which case there is not even a warning - with current browser UI. TrustBar provides indicators which seem to allow most or at least many naive users detect such attacks (involving a non-trustworthy CA).
 > Users have to always remember
Impossible task, imho.
Web sites should use SSL to protect their login forms (and redirect from http if user tries to use it). This does leave the possibility of users being redirected to other sites, but at least the site has done the best it can. Indeed, very few non-US banks expose their customers in this way.
Thanks, and yes, I agree, this requires browser change, I don't think we can avoid this. Users can currently use our extension, and we hope that as more and more do so, browers makers will add such features.

@_date: 2005-09-22 09:13:13
@_author: Amir Herzberg 
@_subject: Defending users of unprotected login pages with TrustBar  
Before we do the first redirection, we do ask the user. However, since TrustBar is really part of our research on secure usability, we are aware that asking the user is a very problematic mechanism. Namely, we expect most users to simply click `yes` and forget about it. That's why I referred to it as default.
Seems that I must repeat my request: a lot of you seem to agree that current browser security UI is broken, here are we developed a seemingly usable tool trying to fix it, takes 2-3 minutes to install - why don't you spend that time and then tell us how to improve (or to stop wasting our time as well as your 5 minutes)? Of course, what we'll really love (for our usability data) is for you also to get some non-expert users to try to use the system... someone who really uses e-banking and cares about the (very real threat) of spoofing/phishing...
(This is what I was expecting when I started reading
Actually, from other feedback we got, I think we may extend the mechanism to be even more active, to protect also these pages which are not in our list of `known` unprotected login sites with a protected alternate site. What we may do is to archive a copy of these sites in your machine, and redirect you to the archived copy if/when the site `really` changes. This is a bit tricky as we need to ignore these small, insignificant changes that many of these sites do.
cool, this may also be something we can do for users (essentially requires us extending the auto-redirection features with wildcard

@_date: 2005-09-25 18:27:16
@_author: Amir Herzberg 
@_subject: An overview of cryptographic protocols to prevent spam 
I wrote an overview of Cryptographic Protocols to Prevent Spam, available at  This includes a brief discussion of some non crypto mechanisms as well.
I have tried to maintain reasonable balance between accuracy and conciseness, and to be fair while not hiding disagreements, criticism and controversial issues. However, I am sure there is a lot that can be improved, and will appreciate comments and suggestions for improvements, and try to incorporate in the final version of this document.
I apologize for cross posting this message, please excuse this - I hope you won't consider me a spammer...

@_date: 2005-09-26 08:53:59
@_author: Amir Herzberg 
@_subject: PKI too confusing to prevent phishing, part 28 
Is PKI the cause of this? I think not. This is a usability problem.
We try to fix this problem (and similar problems) with TrustBar. Indeed we even had incidents where people on the TrustBar team itself, and some security experts using TrustBar, thought there is a bug - why does TrustBar display `Bad Certificate` warning, when FireFox says the site is protected fine? But then we found out it was simply a self-signed site, or a site signed by a CA not in the list of the browser, or the most hard-for-users: a site with a certificate whose issuer is specified as Verisign (say), but with a wrong public key... this last one is really tricky; even expert users get confused in identifying this, even when using the certificate details dialogs (I checked for FireFox and IE).
There are many problems with PKI, and certainly with its implementation in browsers. But secure usability problems are worse. I think our community should try to be constructive. I definitely try myself, hence TrustBar. Please help me: try it and give me feedback, if you are a good programmer, lend a hand improving it; or find other ideas and implement Best, Amir Herzberg

@_date: 2005-09-26 09:28:19
@_author: Amir Herzberg 
@_subject: An overview of cryptographic protocols to prevent spam 
John, I'm disappointed; I expected you to be more tolerant. You got mad at me at page V which is still just reviewing the basic e-mail architecture related to spam. In this part, I explained what open-relays are and why people may try to disconnect from them, and described port-25 blocking which is common practice and necessary to protect domains from being blacklisted.
I discuss blacklisting techniques and their problems much later, in section 5.5 (page XXV). I discuss there, albeit briefly, false positives, abuse, and collateral damage. I agree about the importance of clarifying these concerns, and will try to improve this.
Frankly, however, I think you were a bit trigger-happy to conclude that I `bought-into` the censorship, black list approach. May I recommend that you ask first, shoot later? We had some discussions on this and while we may have differences, I thought you know I care a lot about freedom of speech.
And btw, yes, as users of some (legitimate!) mail services, both me and several family memebers (e.g. children) were blocked by domain blacklists... When this happened to my 7 year old child, I had to forward his answers to a magazine for him. I once almost lost a consulting engagement to blocked email. And Ross Anderson once had to resort to asking Adi to call me on the phone to deliver a message, since a crazy mail filter here (Bar Ilan Univ.) blocked his messages for weeks... And more incidents. So believe me I'm well aware of this problem.

@_date: 2006-01-18 19:25:49
@_author: Amir Herzberg 
@_subject: DoS attack on The Million Dollar Homepage 
I found the enclosed of some interest..
Blog, Tuesday 17th January 2006:
Site downtime, DDoS attack
I can confirm that MillionDollarHomepage.com has been subjected to a Distributed Denial of Service (DDoS) attack by malicious hackers who have caused the site to be extremely slow loading or completely unavailable since last Thursday, 12th January 2006.
I can also confirm that a demand for a substantial amount of money was made which makes this a criminal act of extorsion. The FBI are investigating and I'm currently working closely with my hosting company, Sitelutions, to bring the site back online as soon as possible. More news soon.

@_date: 2006-01-22 15:18:32
@_author: Amir Herzberg 
@_subject: New version (0.9.97) of TrustBar - first from the new developer  
Hi, the TrustBar project is finally back on track, with a new team of developers. For these who are not familiar, TrustBar is an extension to FireFox, which identifies SSL/TLS protected sites by the certified organization name and `Identified by:` , or by a name/logo of the user's choosing (`petname`).
The team now work on several exciting extensions such as how to defend also users of unprotected (non-SSL) web pages, but this will take some In the meanwhile, we have an improved version (0.9.97), which finally works nicely on both windows, MAC and Linux (as far as we tested); we also removed the `Hey` functionality which people really hated (but we learned a lot from it and a much changed version will appear in the To install, download from Feedback will be most welcome!

@_date: 2006-03-06 17:59:52
@_author: Amir Herzberg 
@_subject: Paper summarizing new directions in protecting web users 
I've summarized the current directions that our group is working on
towards improving security for web users. I'll probably soon post it as
HTML, but I'm terribly busy and so far just posted it in eCrypt as PDF,
see at We hope to soon be able to provide more details and working extension(s)
implementing these ideas - we are working on these. We would love your
feedback, and look forward to cooperate with _any_ browser vendor, or
security company (anti-virus, CA, etc.) that is interested in pursuing
these exciting opportunities.
Abstract. We describe the current state of web security, and identify
the main problems. We then present proposals for improvements,
including: secure site identification widget; secure and convenient
`single click logon`; improved validation certificates; and using
public-key signatures and automated resolutions and penalties, to defend
against malicious content including malware.
I'll appreciate your comments, suggestions and corrections.
BTW: I'll be in NYC all of next week, for the W3C Workshop on
Transparency and Usability of Web Authentication; in particular I'll
visit (and present) in Columbia univ. this Friday and in IBM Watson on
next Tuesday - so if any of you are around, I'll love to see you.

@_date: 2007-01-31 18:37:08
@_author: Amir Herzberg 
@_subject: length-extension and Merkle-Damgard hashes 
This is the well known `classical attack` against the `naive Merkle's construction`, which does NOT use either an IV (for the 1st block), or `MD-strengthening` (append the length appropriately, etc.). Which is why hash functions use a fixed IV for the first block, or append length or otherwise encode the end block, or, most often, do both (as e.g. in SHA1, MD5).
Prepending the length [without an IV], btw, is not necessarily a good For example, let's assume, for simplicity, that the length (in blocks) is encoded as 20 bits, prepended to the first block; and say the input/output block length is L, and for simplicity, assume a compression function from 2L to L (so the minimal input length is 2L). Let TWO be the 20-bit encoding of the number 2, and let THREE be the 20-bit encoding of the number 3.
Repeat until you find a collision (which you will, soon enough...):
- Pick a random (2L-10)-bits string $r\in_R \{0,1\}^{2L-10}$.
- Let H=h(THREE || r)
- If TWO=[first 20 bits of H] then, for every block $x\in \{0,1\}^L$, we have $h(H||x)=h((THREE||r)||x), i.e. a collision.
Best, Amir
