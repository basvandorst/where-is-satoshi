
@_date: 2015-11-04 11:09:33
@_author: Will Sargent 
@_subject: [Cryptography] Literature on reusing same key for AES / HMAC? 
Hi there,
I'm looking at a very specific issue, where the same secret key is used
with AES-CTR for encryption, and then later that same key is used for
signing the ciphertext with HMAC-SHA1.  I know that generally it's unsafe
for CBC-MAC (which I'm not familiar with) and RSA keys: I want to be able
to say AES / HMAC is a safe or unsafe construction, and so far I'm not sure
I've got two different sources, one saying that this is safe, the other one
that it is not.
Steve Weis here says that AES is not safe when using the same key for both
signing and encryption:
But Thomas Porrin says:
"With HMAC vs AES, no such interference is known. The *general feeling* of
cryptographers is that AES and SHA-1 (or SHA-256) are "sufficiently
different" that there should be no practical issue with using the same key
for AES and HMAC/SHA-1."
I've looked online, but don't know exactly what phrases to look for -- "key
reuse" is typically used in a "reusing key with same IV" sense, and "key
type mixing" doesn't show very much either.  "key separation principle"
brings up "On the Importance of the Key Separation Principle for Different
Modes of Operation" which is firewalled, and a paper on Key Reuse:
* and seems to be broadly applicable, but again... there doesn't seem to be a
paper available on AES-CTR + HMAC-SHA1.
I know people are busy, and any response at all will be useful, especially
if it can point me to the correct search terms or papers to back this up.
If the answer is "no-one's looked, but it can't be good" then that's fine

@_date: 2015-11-06 18:24:35
@_author: Will Sargent 
@_subject: [Cryptography] Literature on reusing same key for AES / HMAC? 
This is a system I'm decommissioning, because homegrown crypto is a Bad
Idea.  I want to be able to assert that the reuse of keys here, while not
recommended, has not been actively broken (or at least, there are no
publications to that effect), and if they used AES-CTR and then immediately
MACed the result and didn't mix it with anything... then they're probably
fine.  Maybe.
I think you need to be a bit careful about what is meant here by safe and
Right -- I know that AES-CTR + HMAC is a construction and so there are Ways
To Do That Wrong.  However, I can't know how users put them together.  I
have a library that exposes an encrypt method, and a sign (HMAC-SHA1)
method -- no real way to know how users composed them, if they did at all.
 Key purpose reuse is what Weis goes on to talk about is the general idea
It's more general advice.  The encrypt method is not used at all within the
system itself, only signing is used.  Some end users found and started
using the encrypt / sign methods for their own crypto and so I'm
deprecating those methods and sticking large warnings over everything.
Then I'm going to point them at Kalium or Keyczar and wish them good luck.

@_date: 2015-11-07 21:15:33
@_author: Will Sargent 
@_subject: [Cryptography] Literature on reusing same key for AES / HMAC? 
That's quite controversial.
Well, the first version used AES-ECB with unbounded input.  The second
version used AES-CTR without a MAC, and has a versioning scheme so it can
fall back to AES-ECB.  It's not something that needs to be around, and it
comes with no instruction manual.
I poked at this a bit with an AES-GCM proof of concept:
 but ultimately, it's better
handled by a high level crypto library.
Yeah, that vocab comes from Keyczar, which uses a "Signer" for both RSA
signatures and HMAC:
I don't see that there's an established harm or vulnerability, but it's not
something we want to maintain.
Right -- there is no "newer supported" one, and the current one has never
been supported, it was discovered.  It may cause some issues, but long term
moving to a supported library is the right move.
