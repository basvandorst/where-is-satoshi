
@_date: 2014-08-09 22:26:22
@_author: David Leon Gil 
@_subject: [Cryptography] Many curves versus one curve 
I think that Mike Hamburg has been working on a Sage(?) script to select a
curve satisfying the SafeCurves criteria deterministically from a random
seed. (He mentioned this on another list.)
It makes most sense on a per-application basis -- the computational cost of
verifying these conditions is fairly high.[*]
However. Some EC primitives lose some of their nice properties if users can
select arbitrary curves (even over a single prime field). E.g., ECDSA is
not subject to key-share attacks if all users use the same curve; it is, if
arbitrary curves are permitted. (Koblitz and Menezes discuss this in their
'Another look' papers.)
So current uses of EC might need re?xamination.
PS, or, taking the other side: There is, by the way, a good
counter-argument to the 'just increase the bit-length' argument djb uses
for single curves:
Suppose that an unknown fraction of elliptic curves has some undesirable
property. By using a large number of curves, we decrease the variance of
our risk in expectation. Under a minimax cost model, this is a big gain. (A
certainty of small loss, rather than a small chance of catastrophe.)
[*] For applications that are extremely length-constrained -- e.g., some
embedded devices -- provisioning with a per-device curve is the most
feasible way of increasing security. I, personally, would like a
standardized process for this.

@_date: 2014-08-10 19:36:55
@_author: David Leon Gil 
@_subject: [Cryptography] Many curves versus one curve 
william.allen.simpson at gmail.com
They may mention this in 'Serpentine course', but 'Security definitions'
has the most succinct description, at 2.2.4:
(This is unrelated to nonce issues, by the way.)
That is the argument we've been making for over 20 years.
I claim no priority!

@_date: 2014-08-11 00:23:56
@_author: David Leon Gil 
@_subject: [Cryptography] Fwd: Many curves versus one curve 
As Mike isn't on this list, he asked me to forward this.
---------- Forwarded message ----------
 I think that Mike Hamburg has been working on a Sage(?) script to select a
curve satisfying the SafeCurves criteria deterministically from a random
seed. (He mentioned this on another list.)
"Working on" is a bit strong.  I hacked something together, but I haven't
polished it at all.
The main search part is actually a slightly patched pari/gp with a python
driver to divide the work between cores.  The modification is to make gp
bail out of SEA as soon as it finds a small prime dividing |E| or |~E|, and
to return that prime.  The built-in SEA has a bail-out condition but it's
not as flexible.
The biggest problem is that it takes a few core days to generate a curve at
the 512-bit level.  Then it takes another couple core-days to process the
logs to make a certificate that this was indeed the first one.  It's a
Poisson process, so it could take more or less time than that.  This could
probably be shortened by someone with better SEA skills than mine,
particularly for the cert generation.
It makes most sense on a per-application basis -- the computational cost of
verifying these conditions is fairly high.[*]
Yeah, the cert takes like an amd64-core-minute to verify in Python.  Not
something you want to run alongside your 150 microsecond DH.  Also it
doesn't check all the Safecurves criteria right now, just low cofactor, so
the others would probably add to the cost unless there's an easy way to
certify them.
However. Some EC primitives lose some of their nice properties if users can
select arbitrary curves (even over a single prime field). E.g., ECDSA is
not subject to key-share attacks if all users use the same curve; it is, if
arbitrary curves are permitted. (Koblitz and Menezes discuss this in their
'Another look' papers.)
You'd need to hash in the curve being used.
So current uses of EC might need re?xamination.
 -dlg
 PS, or, taking the other side: There is, by the way, a good
counter-argument to the 'just increase the bit-length' argument djb uses
for single curves:
 Suppose that an unknown fraction of elliptic curves has some undesirable
property. By using a large number of curves, we decrease the variance of
our risk in expectation. Under a minimax cost model, this is a big gain. (A
certainty of small loss, rather than a small chance of catastrophe.)
I kind of like this argument, though having lots of curves is really
[*] For applications that are extremely length-constrained -- e.g., some
embedded devices -- provisioning with a per-device curve is the most
feasible way of increasing security. I, personally, would like a
standardized process for this.
I can post my GP patches if you want, though actually the important thing
to standardize is the verification.

@_date: 2014-08-21 00:56:09
@_author: David Leon Gil 
@_subject: [Cryptography] GPU farm ideas: Break SHA-1? 
A suggestion:
Carry out Marc Steven's attack and break SHA-1. The estimated complexity of
his attack is 2^62-ish. (A Fermi can do about 2^30 SHA-1 evals / s, and
a GK110 can do > 2^31 / second, IIRC.)
His code and thesis is online at (If you're interested in this area, message me off-list with your GPU
model, and I'll dust off the GPGPU micro-optimizations I have for SHA-1;
they can gain a factor of 1.1x to 2x over, e.g., djb's NearSHA Cuda code,
depending on the GPU. Of course, you may well have better
optimizations in-house given what your company does.)

@_date: 2014-08-21 16:20:01
@_author: David Leon Gil 
@_subject: [Cryptography] GPU farm ideas: Break SHA-1? 
I don't think that they had good differentials for SHA-1; I think even
the useful MD5 differentials post-date that effort.
But it would be interesting to know what they did; that information
might reduce the work-factor for an attack...
(Btw, does anyone have an opinion on whether Stevens' differentials
are likely valid?)

@_date: 2014-11-30 20:16:31
@_author: David Leon Gil 
@_subject: [Cryptography] Toxic Combination 
============================== START ==============================
So. What would it take to get
(1) scrypt/some other sequential-hard KDF
(2) a zero-knowledge challenge-response PAKE protocol
into UAs?

@_date: 2014-10-02 20:17:30
@_author: David Leon Gil 
@_subject: [Cryptography] Creating a Parallelizeable Cryptographic Hash 
You're probably better off using a construction that has been designed
to be a sound "tree hashing" mode. E.g., the Keccak team's Sakura tree
hash coding:

@_date: 2014-10-08 20:09:41
@_author: David Leon Gil 
@_subject: [Cryptography] Creating a Parallelizeable Cryptographic Hash 
As an aside, what you're describing is a function with low discrepancy
on the inputs. This is (interestingly enough) different from a
function that generates values indistinguishable from uniform random
numbers in the interval. (The values "anti-bunch", in some sense,
compared to random numbers.) See, e.g.,
 for the
fascinating details of low-discrepancy sequences and quasi-random
(I used to use (t,m,s)-nets and Niederreiter sequences for statistical
work. And folks here might know Harald Niederreiter's name from his
linear-code-based public key cryptosystem.)

@_date: 2014-10-14 00:01:49
@_author: David Leon Gil 
@_subject: [Cryptography] factoring small(ish) numbers 
cado-nfs + undergraduate + 1 month == answer
Or take a look at: It has the numbers you're after, as of two years ago. See also
One can debate what "easily" means, but for my purposes I am thinking of

@_date: 2014-10-15 17:46:19
@_author: David Leon Gil 
@_subject: [Cryptography] RFC: Generating RSA moduli / semiprimes with 
Request for citations!
Does anyone happen to know early references for the generation of
semiprimes with prescribed bit-patterns?
In particular, I know of the following articles:
    Vanstone, Scott A., and Robert J. Zuccherato. "Short RSA keys and
their generation." Journal of Cryptology 8, no. 2 (1995): 101-114.
    Lenstra, Arjen K. "Generating RSA moduli with a predetermined
portion." In Advances in Cryptology?Asiacrypt?98, pp. 1-10. Springer
Berlin Heidelberg, 1998.
    Young, Adam, and Moti Yung. "The Dark Side of ?Black-Box?
Cryptography or: Should We Trust Capstone?." In Advances in
Cryptology?CRYPTO?96, pp. 89-103. Springer Berlin Heidelberg, 1996.
    Desmedt, Yvo. "Abuses in cryptography and how to fight them." In
Proceedings on Advances in cryptology, pp. 375-389. Springer-Verlag
New York, Inc., 1990.
Young and Yung cite Yvo Desmedt as having introduced the idea for RSA
moduli in particular. (I don't have this conference proceeding to
verify the citation; can anyone verify this?)
There are also some works by GJ Simmons (e.g., "The subliminal channel
and digital signatures") from 1984-85 that seem apropos; does anyone
know if this is discussed there?
Also, it seems like this would have made an interesting exercise in a
number theory book; is it possible that the observation that you can
choose half the bits in a semiprime by one of the methods in the
papers above described anywhere in that literature?
- David

@_date: 2014-10-22 23:00:20
@_author: David Leon Gil 
@_subject: [Cryptography] Best internet crypto clock 
How about using the earth's rotation? :)
Only Superman can hack that...

@_date: 2014-10-24 19:32:54
@_author: David Leon Gil 
@_subject: [Cryptography] Uncorrelated sequence length, 
The current provable-security bounds on recovering from state
compromise require anywhere from 2KiB to 20 KiB of input entropy to
recover from "state compromise". See section 5.3 of
So, perhaps some applications would want a fairly large amount of entropy.

@_date: 2014-10-25 09:02:51
@_author: David Leon Gil 
@_subject: [Cryptography] Uncorrelated sequence length, 
That's fully accurate. (In fact, an earlier paper by Dodis points out
that /dev/random is broken at present:
 )
No good reasons; OSX (and some BSDs?), for example, uses Schneier's
Fortuna RNG, which is cryptographically sensible.
That would be better than what the Linux kernel is doing...
I believe that some folks are working on code to fix /dev/random, but
it's a fair amount of work to write / get merged.
Not sure.

@_date: 2014-10-25 22:49:53
@_author: David Leon Gil 
@_subject: [Cryptography] Quantum Sneakernet 
High-quality transoceanic cables would be expensive (unimaginably
expensive today); but there is no physical problem. Just a minor
engineering problem. ;) And, contra the paper, there are people
working on distributing qubits...

@_date: 2014-10-26 22:10:53
@_author: David Leon Gil 
@_subject: [Cryptography] A TRNG review per day: RDRAND and the right TRNG 
I thought that the whitening design had been published? They're using
CTR-DRBG instantiated with AES-128. (This, in itself, is probably all
the NSA could want; the security strength of that construction is
rather low.)
Here's the paper:
Thanks for the terrific summary of potential side-channel attacks.
Agreed; the quantum RNGs in particular make me laugh. (I'd wonder who
would be so stupid as to buy one, but even Google has bought into the
similarly craptastic D-wave nonsense.)
They need to publish layout information so that third-parties can
easily(-ish) verify it. Information on the "eight different
operational modes" supported by the RNG would be nice too.

@_date: 2014-09-09 17:43:37
@_author: David Leon Gil 
@_subject: [Cryptography] [messaging] "Keybase Attack" on RSA signatures 
Keybase attempts to bind user identities on social media to their PGP keys by having users publish an RSA signature under an unknown key, which Keybase refers to as a "proof". The (allegedly) signed message contains a link to their Keybase identity, but contains no information about their public key fingerprint.
After clicking on the link in the message we're taken to the Keybase web site where their alleged public key is listed. We are then asked to verify this key is authentic by checking if the digital signature in the original message verifies.
However, is this actually secure? Or more specifically:
?As you've noted, what keybase.io is doing appears to be fine; they include a lot of information about the public key in their proofs. It would be preferable to include the public key itself, or a strong hash of it.
Can we produce an RSA keypair such that an existing digital signature will verify under it if we control both the private and public key?
?Yes; this is a dual-share key-share attack. It works only if you allow users to choose arbitrary public exponents. You just create a smooth enough modulus that you can solve the discrete log problem on its component primes; this isn't incompatible with the modulus being difficult to factor.?
?(This can also be done, in theory, for ECDSA, but no implementations that I know of have made the mistake of permitting users to specify arbitrary base points.)
For the purposes of this problem, let's say it doesn't even need to be a good / secure RSA key, just one that the "proof" signature verifies under.
?Indeed; as best I can tell, keybase.io's OpenPGP implementation is not checking any of the RSA cryptosystem's validity conditions. (Neither does Google's E2E. GnuPGP and PGP check some, but not all.) What RSA public key consumers should check, in rough order of importance:
gcd(n, e) == 1
n mod 2 == 1
1 < e <= 2^16+1
(Note that the last two are more restrictive than the sufficient conditions for validity. There is no particular reason to be more lenient, however. It is also nice to check that n can't be factored by trial division or random ECM instances for rho, lambda, and p-1, but this is impractical for JS implementations.)

@_date: 2014-09-30 20:37:03
@_author: David Leon Gil 
@_subject: [Cryptography] Fwd:  "Spy Agencies Urge Caution on Phone Deal" 
It's the "Number Portability Administration Center": (The site has many helpful FAQs, like "Why do law enforcement agencies
and PSAPs access the NPAC?")

@_date: 2015-05-09 12:18:05
@_author: David Leon Gil 
@_subject: [Cryptography] A Fun Trick: The Little MAC Attack 
Koblitz's and Menezes's papers about HMAC and NMAC explain this quite nicely:
"Another Look at Security Theorems for 1-Key Nested MACs."
"Another look at HMAC." This is (one of several reasons) that I dislike HMAC, and wish that
people would use hash functions with indifferentiability proofs
What applications, out of curiosity?
(I've been looking for a cite for this...)
- David

@_date: 2015-05-27 20:25:29
@_author: David Leon Gil 
@_subject: [Cryptography] an associative hash function 
I quite like the construction, so I thought I'd note that this may
have some applications in anonymous routing as well.
Perhaps a construction from lattice-based CRHFs might achieve O(1)?

@_date: 2015-10-06 02:19:58
@_author: David Leon Gil 
@_subject: [Cryptography] [openpgp] OpenPGP SEIP downgrade attack 
This is a very nice explanation of the downgrade attack. I suspect that its
discovery predates your work: See
 (scroll down a bit) for a
bug where I note it.
On Mon, Oct 5, 2015 at 6:52 PM Peter Gutmann
