
@_date: 2016-08-31 11:33:25
@_author: Georgi Guninski 
@_subject: [Cryptography] MATH: Unlikely correctness of paper will break some 
The Discrete Logarithm Problem over Prime Fields can be
transformed to a Linear Multivariable Chinese Remainder
H. Gopalakrishna Gadiyar, R. Padma
(Submitted on 25 Aug 2016)
I am pretty sure if this paper is fixable, it will efficiently break
DLs over F_p^* at least for primes of the form p=2q+1 with q prime.
Is the paper fixable?
How would it break IMHO:
The authors claim (18) (19) that they reduce DL to two constrained
linear congruences with different moduli in the two unknowns
n,\beta_n and the constraints are 0 < n < p, 0 < \beta_n < p.
This is efficiently solvable via integer programming due to result
of Lenstra about integer linear programs in fixed number of variables.
Work over the integers adding two integer unknowns $x,y$ to get rid
of the congruences and keep the inequality constraints, getting
integer program in _only four unknowns_.
Shorter version of this was posted few days ago on cpunks.org, no
replies so far.
The authors don't appear to be cranks/crackpots, though
scholar.google.com doesn't recognize them AFAICT.

@_date: 2016-10-01 15:29:38
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct DSA 
I see, openssl tries to generate valid stuff, while accepting invalid
stuff by _bad_ "external programs".
Certainly, accepting invalid signatures (generated by external program)
or something like shellshock/hearthbleed is much more interesting,

@_date: 2016-10-01 15:37:20
@_author: Georgi Guninski 
@_subject: [Cryptography] distrusted root CA: WoSign 
AFAICT, things are more complicated since WoSign bought StartCom and
they have some cross-signatures, possibly to WoSign roots.
So mozilla might have to ditch StartCom too, which will break a lot of
stuff for the lusers.

@_date: 2016-10-02 13:49:54
@_author: Georgi Guninski 
@_subject: [Cryptography] distrusted root CA: WoSign 
Startcom were big CA, maybe something like 6th biggest in the world.
Their customers will be pissed off for killing the certificates.
Don't get "distrust future certs". Mozilla either trust root(s) or not.
Root(s) can trivially sign "old" cert requests, requiring old date now.
Having in mind the chinese have the Startcom, roots, they can issue
essentially whatever chaining up to root as long as the roots are trusted.

@_date: 2016-10-03 20:35:21
@_author: Georgi Guninski 
@_subject: [Cryptography] distrusted root CA: WoSign 
Can the people (aka sheeple) do anything to change the CA/vendor situation
(possibly screwing the CAs/vendors with a chainsaw)?

@_date: 2016-10-11 20:02:23
@_author: Georgi Guninski 
@_subject: [Cryptography] 
=?utf-8?q?rapdoors=E2=80=9D_in_millions_of_crypto_keys=22?=
Haven't read the paper yet.
Isn't this disturbing sign for elliptic curve crypto, where the
"mainstream" curves are given by the "authority"?
Curves are of relatively small order, so even exponential algorithm with complexity
O(n/k) for nice $k$ will break them, not counting subexponential stuff.

@_date: 2016-09-01 08:52:24
@_author: Georgi Guninski 
@_subject: [Cryptography] MATH: Unlikely correctness of paper will break 
Haven't debugged the paper yet. Appears to me they don't mention
uniqueness of the solution.
It is very interesting to me they claim to reduce DL to _linear
congruences_ with few inequality constraints.
In (18), (19) and Numerical example on p. 4 they have two linear
congruences in two unknowns n,\beta_n where $n$ is the secret exponent
and the implicit constraints 0 < n,\beta_n < p. Solving this is
efficient with integer programming as explained in the OP.

@_date: 2016-09-02 08:28:31
@_author: Georgi Guninski 
@_subject: [Cryptography] MATH: Unlikely correctness of paper will break 
Feel free to forward to the other list, possibly CC'ing me.
After some discussion with kristian.gjosteen at math.ntnu.no, I believe
there are critical problems even if the equations are correct.
Their numerical example indeed doesn't agree with b_1 from (13).
The problem appears to be the correct upper bound for \beta_n is pq, not p. This essentially makes \beta_n free variable in their
congruences, giving solution for all n (the secret exponent).
The paper doesn't mention uniqueness of the linear solution.

@_date: 2016-09-03 08:49:35
@_author: Georgi Guninski 
@_subject: [Cryptography] "Flip Feng Shui: Hammering a Needle in the 
... Flipping random bits in a word at chosen location is very powerful primitive.
I am taking bets that it is moderately easy to exploit via many vectors.
Flipping random bits of zero word make it nonzero.
In a boolean context, this flips False and True, screwing the logic.
eg in:
if(is_root || is_authorized) give_em_power();
else drop_em();

@_date: 2016-09-08 10:29:19
@_author: Georgi Guninski 
@_subject: [Cryptography] Finding the least significant bit of RSA secret 
I suppose this is well known and useless (if true).
The least significant bit of RSA secret exponent $d$ can be found
with high probability (and sometimes unconditionally) from signatures
of random stuff very fast. Get experimental support assuming H_i^d mod n are
the signatures, H_i is the padded hash (if this is not known from the
signature, ignore this mail).
Is this well known and useless?

@_date: 2016-09-11 11:29:19
@_author: Georgi Guninski 
@_subject: [Cryptography] Finding the least significant bit of RSA 
Thanks. Several people pointed offlist that d is always odd, so the question
doesn't make sense.
I missed that and tried random d's and random padded hashes per d.

@_date: 2016-09-24 14:22:06
@_author: Georgi Guninski 
@_subject: [Cryptography] Yahoo is sued for gross negligence over huge hacking 
Yahoo is sued for gross negligence over huge hacking
Yahoo Inc (YHOO.O) was sued on Friday by a user who accused it of gross negligence over a massive 2014 hacking in which information was stolen from at least 500 million accounts.
Ronald Schwartz, a New York resident, sued on behalf of all Yahoo users in the United States whose personal information was compromised. The lawsuit seeks class-action status and unspecified damages.
Pretty sure Yahoo have disclaimer they are "gross negligent", so the
suing is doomed, unless the morons failed to make such disclaimer.

@_date: 2016-09-25 15:25:47
@_author: Georgi Guninski 
@_subject: [Cryptography] Yahoo is sued for gross negligence over huge 
IANAL too, but suspect greedy lawyers will claim "it isn't negligence,
it is deity hackers hacked us, what could we do".
IMHO all of the IT industry will kick the bucket if they pay for damages

@_date: 2016-09-27 12:20:29
@_author: Georgi Guninski 
@_subject: [Cryptography] Two distinct DSA keys sign a file with the same 
Two distinct DSA keys sign a file with the same signature. Is this repudiation issue?
I have two distinct DSA keys k_1 and k_2, p_i are distinct 1024 bit
primes and q_i are 160 bit primes (easily can be made larger).
The other parameters of the keys are distinct, counting congruences.
On openssl 1.0.1t they produce exactly the same signature on a file:
$ openssl dgst -sha1 -verify key1.pub -signature file.txt.sig file.txt ; openssl dgst -sha1 -verify key2.pub -signature file.txt.sig file.txt
Verified OK
Verified OK
In addition I created with them two valid self signed x509 certificates.
The key owners can claim the other one made the signature,
which appears crypto repudiation issue.
How to try the signatures in other scenarios?
Is this known?
Is this theoretical weakness in openessl 1.0.1t?
Is this a bug at all?

@_date: 2016-09-27 21:03:43
@_author: Georgi Guninski 
@_subject: [Cryptography] Two distinct DSA keys sign a file with the same 
Offlist and on the cypherpunks list, some people suggested that I don't
check correctly the signatures or am using the _same_ key.
This is not the case, since with the ``paired keys'' I checked:

@_date: 2016-09-28 12:27:31
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct DSA 
Posting the keys/certs/private per some requests. The README:
Distinct DSA keys produce valid single signature of single file
and the x509 certificates from the private keys work on openssl 1.0.2j
Tested on openssl 1.0.2j (latest and 1.0.1t latest) on Debian 8.
The keys (also private are attached).
Also at We got a triple of distinct DSA keys (key1,key2,key3) which
successfully verify a single signature of a single file.
By ``distinct" we count congruences, the p_i and q_i are distinct.
$ openssl dgst -sha1 -verify key1.pub -signature file.txt.sig2 file.txt ; openssl dgst -sha1 -verify key2.pub -signature file.txt.sig2 file.txt ;openssl dgst -sha1 -verify key3.pub -signature file.txt.sig2 file.txt
Verified OK
Verified OK
Verified OK
Slightly harder to reverse pair of keys with the same properties is
$ openssl dgst -sha1 -verify key3.pub -signature file.txt.sig3 file.txt ; openssl dgst -sha1 -verify key4.pub -signature file.txt.sig3 file.txt
Verified OK
Verified OK
To produce other signatures: choose a key from the two sets and do:
$openssl dgst -sign key1.priv -out file.txt.sig file.txt
Then verify, which may fail with probability about 1/2 for the first
set and about 8/9 for the second set because of the random DSA $k$.
Deterministic signatures are possible, but not possible with unpatched
For the x509 certs:
cert1 works always.
cert2 works with probability about 1/2, to check:
$ openssl s_server -accept 8080 -cert cert2 -key key2.priv  -www
$ openssl s_client -connect localhost:8080
For client lynx(1) works too, with innocent warning about self signed
and CN mismatch.
In case of error, repeat few times.
cert3 and cert4 work with probability about 1/3.
Sketch of the numerology behind it.
For and overview of the simple DSA, check Wikipedia or better source.
The main idea is to use low multiplicative order of the generator $g$,
which is expected to be of multiplicative order $q$ (at least 160 bit)
prime modulo $p$.
The signature is (r,s), where for random $k$,
r=(g^k mod p) moq q
s=some function of x,k,r,MESSAGE
The public key is y=g^x mod p.
The signature is valid iff $r=v, v=g^f_1(r,s) y^f_2(r,s)=g^f_3(x,r,s)$
We choose $g_i$ of low multiplicative order modulo $p_i$, for (key3,key4)
it is $3$.
Whenever the "random" $k$ (for the first key of the pair)is multiple of $3$, r=1 mod p mod q
and $v=g^f_3_i(x_i,1,s_i)$. Since there are no congruence
obstructions, f_3_i(x_i,1,s_i) can both bi divisible by $3$,
giving $v_1=v_2=r=1$.
This is very easy to verify in a toy implementation or in python's
Choosing $g=1$ as in key1 works for all $p_i,q_i$ and the private
exponent $x$ doesn't matter.
Theoretically the keys are invalid, but the valid x509 certificates
working in |openssl s_client| and lynx suggest lack of key validation.

@_date: 2016-09-28 17:35:07
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct DSA 
[this thread is crossposted to Cryptography and Cypherpunks]
Isn't there RFC or some document which says what checks should be
Last year I bitched:
RFC-2631, fips 186-3 and openssl's implementation of DSA appear broken (and possibly backdoored)
 openssl

@_date: 2016-09-28 19:09:02
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct DSA 
This is by design and I knew it.
Was asking about the scope of this if any and also if the RFC/fips/spec
is buggy too or just a coding nonsense.

@_date: 2016-09-28 20:48:41
@_author: Georgi Guninski 
@_subject: [Cryptography] Yahoo is sued for gross negligence over huge 
Microsoft paid me $650 to scrub Windows 10 from my grandpa's PC, says man
Microsoft has paid the relative of an Alzheimer’s patient for having to scrub his PC clean of Windows 10.
Jesse Worley said he'd received a cheque for $650 from Microsoft – seen by The Register – which he told us he'd received after threatening the giant with court action over an unwanted Windows 10 upgrade.
Don't know if this is true, theregister appear yellow journos.

@_date: 2016-09-29 10:56:41
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct 
Exactly, especially when there are other subtleties in the openssl
So what contradicts this?
It works fine on latest openssl :)
Would you comment on key4 and key5?

@_date: 2016-09-30 13:22:40
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct 
To clarify the question, since you asked offlist.
The x509 certs in tar.gz pass verification with warning that they are
self signed, which easily can be fixed by signing them with valid
In openssl 1.0.2j (latest of know) in static int dsa_do_verify(
    i = BN_num_bits(dsa->q);
    /* fips 186-3 allows only different sizes for q */
    if (i != 160 && i != 224 && i != 256) {
        DSAerr(DSA_F_DSA_DO_VERIFY, DSA_R_BAD_Q_VALUE);
        return -1;
    }
So some standard makes $q$ in a small set of fixed bits.
Which standard says that all my keys are invalid? URL please.
An aside:
As I linked in this thread, DLOG is subexponential in size of $p$.
I don't exclude the possibility that is also subexponential or
efficient in the 160 bits subgroup of 1024 bit prime.

@_date: 2016-09-30 17:32:40
@_author: Georgi Guninski 
@_subject: [Cryptography] Posting the keys/certs for: Two distinct DSA 
Does it matter who created the keys if openssl accepts them?
I didn't use openssl for creation of the keys to minimize development
time (used pen, paper and a little computer).
Feel free to audit soundly if openssl can create invalid or weak keys
(especially in rawhammer environment ;) )

@_date: 2017-08-02 13:48:03
@_author: Georgi Guninski 
@_subject: [Cryptography] (EC)DSA partial knowledge of nonces and existential 
(EC)DSA partial knowledge of nonces and existential forgery with with structured nonces There are attacks against the private key of (EC)DSA when partial
knowledge of the nonces $k$ is known, e.g. least significant bits [1]
or shared bits [2].
On the other hand, existential forgery with structured nonces is
possible. In DSA the public key is (p,q,g,y=g^x). To forge a
signature (r,s) of integer $h$ for all integers a,b != 0 set:
r=(g^a y^b mod p) mod q
s=r/b mod q
h=a s mod q
Since y=g^x mod p, the unknown nonce is $k=a + b x$ where $x$ is the
private key. If $b=1, a=a'+2^l a''$ and we brute force the $l$ LSBs of
$x$, we can generate efficiently many messages with known LSBs (a' + (x
mod 2^l)), which appears in the favorable case the unconditional [1].
Similar existential forgery exists for ECDSA.
Forgeries were tested in practice.
Could this approach give subexponential algorithm for breaking the
private key, possibly under other assumptions?
[1] appears to be deterministic and the abstract starts:
[1] The Insecurity of the Digital Signature Algorithm with
Partially Known Nonces
[2] Attacking (EC)DSA Given Only an Implicit Hint

@_date: 2017-12-11 15:34:52
@_author: Georgi Guninski 
@_subject: [Cryptography] Bitcoin currency options? was: Cryptocurrency Futures 
Are there bitcoin (or cryptocurrency) currency options?
Essentially they are gambling instruments. IIRC unlike futures they
require significantly lower initial investment and the potential profit
is unbounded for the buyer.

@_date: 2017-12-13 12:21:42
@_author: Georgi Guninski 
@_subject: [Cryptography] Bitcoin theft and the future of cryptocurrencies 
If your bitcoin wallet is compromised, all your bitcoins are gone
forever. With a credit card, you have some chance of only minor
damage. If your computer is owned, your wallet is at risk.
This appears major problem for the widespread adoption of bitcoin
Fixing it appears to contradict decentralization, which opens another
can of "worms".
Potential approach is to use "trusted wallet proxy", but this may not
work in practice.
Are these concerns taken seriously?
Any technical attempts at mitigating cryptocurrency theft?

@_date: 2017-12-14 18:27:25
@_author: Georgi Guninski 
@_subject: [Cryptography] Bitcoin theft and the future of cryptocurrencies 
Thanks. On the cpunks list were suggested "cold storage" (docs on
bitcoin.com) and "multisigs".

@_date: 2017-12-16 11:28:20
@_author: Georgi Guninski 
@_subject: [Cryptography] How good random number generator is the human brain 
How good random number generator is the human brain at conscious level?
Searching the web returns forum speculations that it is bad PRNG and some paywalled medical articles claiming otherwise.
"Hardware" stuff like neurons firing or muscles moving doesn't count.

@_date: 2017-12-21 17:07:28
@_author: Georgi Guninski 
@_subject: [Cryptography] Lakestone Bank and Trust Just Made A Problem, 
This greedy bank well might kill herself, possibly downing large
amount of the rest of Ponzi scheme banks.
It is enough critical (possibly not large) part of their lusers to ask their money back.
This leads to the question:
How would a cryptocurrency work if the banking system is down or there
is global hyperinflation?
AFAIK the bitcoin core blockchain is about 150G and it can't track
every beer bought for pico BTC.

@_date: 2017-02-06 18:43:13
@_author: Georgi Guninski 
@_subject: [Cryptography] FYI: quantum cloning 
I can't parse the technical stuff. Does the last paragraph mean
they broke "old quantum crypto"?

@_date: 2017-03-02 18:55:25
@_author: Georgi Guninski 
@_subject: [Cryptography] Signing "random garbage" with someone else's public 
Assume you know someone's public key and one valid signature of
message M. Further assume you can sign with this key a lot of other
messages which are "random garbage". By random garbage I mean something that is a function of M and other parameter and it is not directly under your control (you can't sign anything of your choice).
The signing is in the mathematical model, not taking into account
hash functions.
Is this scenario attack at all? If yes how bad it is considered?
What is the cryptographic name of this (if any)?
Are any major algorithms known to be affected by this?

@_date: 2017-03-06 15:22:21
@_author: Georgi Guninski 
@_subject: [Cryptography] In ECDSA, 
garbage
In ECDSA, the signature of number H is pair (r,s).
Without knowing the private key and any signature made with the key,
one can sign:
1. "random garbage" (there is some complicated structure in it)
2. H=0
3. H=r
4. H=s
Is this known and/or trivial?
Attached are some Sage example for bitcoin's curve SEC256k1.
Would someone confirm or deny the examples with X=111 and unknown
private key indeed work?
Taking challenges:  give the public key Q_A=(x,y) on the curve.

@_date: 2017-03-10 10:16:06
@_author: Georgi Guninski 
@_subject: [Cryptography] In ECDSA, 
garbage
Ported it to python's ECDSA an it still works:
These signatures are like the math RSA forgery:  sign the H coming
from the hash function, not an actual message.

@_date: 2017-10-18 16:06:02
@_author: Georgi Guninski 
@_subject: [Cryptography] Conjecturally unsafe RSA primes $p=27a^2+27a+7$ 
We got strong numerical evidence that primes of the form $p=27a^2+27a+7$
are unsafe for cryptographic reasons since they can be found in the
Consider the following generic factoring algorithm for factoring
$n$ which is divisible by $p$. Suppose you known an elliptic curve
in Weierstrass form with known multiple $m$ of the order of $E$ modulo
$p$. Let $\psi_n$ denote the $n$-th division polynomial of $E$.
Choose random integer $X$. If $X$ is the $x$ coordinate on $E$ modulo
then $\psi_m(X) \equiv 0 \pmod{p}$. If it is not, $\psi_m(X)$ need not
vanish modulo $p$. By selecting few random $X$ we probabilistically find
$p$ from $\gcd(n,\psi_m(X))$.
that if $p=27a^2+27a+7$ and $kronecker(2k^3,p)= -1$ then the order of
$y^2=x^3+2k^3$ is $p$. In this case $n$ is multiple of the order, so we
can use the above algorithm by trying in addition random $k$.
We found $200$ bit factor with pari/gp in just few seconds.

@_date: 2018-02-03 12:21:44
@_author: Georgi Guninski 
@_subject: [Cryptography] Do some exploits require imagination/creativity or 
Do some exploits require imagination/creativity or only craftsmanship?
Probably an advance in fully automated exploit development will settle
It is complicated since sufficiently advanced craftsmanship is
indistinguishable from creativity.

@_date: 2018-01-09 12:22:14
@_author: Georgi Guninski 
@_subject: [Cryptography] Own on install. How grave it is? 
This is well known, haven't seen it discussed.
In short doing clean install (factory defaults) has a window of
opportunity when the device is vulnerable to a known network attack.
It used to be common sense to reinstall after compromise (probably
doesn't apply to the windows world where the antivirus takes care).
All versions of windoze are affected by the SMB bug to my knowledge.
Debian jessie (old stable) is vulnerable to malicious mirror attack.
More of interest to me are devices where the installation media is
fixed and can't be changed.
This includes smartphones and wireless routers.
Some smartphones might be vulnerable to wifi RCE (found by google?).
Some wireless routers might be vulnerable to wifi RCE or
default admin password attack over wifi.
Internet of Things will make things worse (some NAS devices are
Shielding the device might not be solution since updates must be
Are the above concerns real?
Have this been studied systematically?

@_date: 2018-01-10 09:53:01
@_author: Georgi Guninski 
@_subject: [Cryptography] Own on install. How grave it is? 
Yes. From my experience in this case the "reinstall" is pressing some
key combination during boot which resets to factory defaults. You still
need updates though.
