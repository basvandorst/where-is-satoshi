
@_date: 2001-04-24 07:12:25
@_author: Greg Rose 
@_subject: Requesting feedback on patched RC4-variant 
As Perry points out, you need integrity protection anyway, whether using RC4 or not. But I'd like to point out that this is one of the few things *not* really wrong with WEP. Remember that the signal is being send using DSSS (Direct sequence spread spectrum, similar to CDMA digital phones) and the chances of an attacker being able to change just one bit, or a targeted selection of bits, in a message, is essentially zero.
Mathematically true, and they shouldn't have done it this way, but essentially impossible in practice ... in THIS standard. It is certainly a more important mistake in some other (eg. IP) contexts.
But you think that CBC mode of a (non-sucky) block cipher is adequate protection? Sigh.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-04-25 07:46:00
@_author: Greg Rose 
@_subject: Requesting feedback on patched RC4-variant 
I absolutely agree that integrity protection is necessary, and I didn't mean to say otherwise. And you're right, I didn't think about bit-twiddling in a replayed frame (but doesn't the too-short frame counter thing prevent replay to some extent?).
You're right and I withdraw my comment.
Anyway, as a lover of stream ciphers, I just get upset when people point out the bit-twiddling attack, without realising that they are implicitly endorsing using block ciphers without robust integrity protection instead. If it needs integrity protection, add a MAC, and the ciphers are on even ground again.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-07-29 08:09:32
@_author: Greg Rose 
@_subject: Fix for RC4 (was: Re: Attention CipherSaber Users!!) 
The fix that's been suggested for some time in the common wisdom about RC4, namely discarding the first 256 bytes of output, would seem to be entirely adequate to address the problems discovered. If this is considered to be part of the key setup, it slightly less than doubles the time, and it's extremely simple.
I have always felt that folding in the key with only a single pass was a bit "close to the edge". Note that the RC5 *key schedule* does at least three passes! (Not strictly comparable, of course.)
Another alternative suggests itself, which would be to continue the key-based randomisation for a second pass over the state array. I'd worry about weak keys that somehow undid their own actions, though, so I think I still prefer just letting the randomisation-through-generation continue.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-07-30 11:09:52
@_author: Greg Rose 
@_subject: A pattern emerges... 
Well, Australia is also looking at (and probably soon to pass) similarly draconian legislation.
The EFA is Electronic Frontiers Australia -- see Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-06-05 09:43:41
@_author: Greg Rose 
@_subject: Starium (was Re: article: german secure phone) 
Not quite correct. They are dormant, but still exist, and the IP rights are for sale (including inventory).
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-06-12 06:31:40
@_author: Greg Rose 
@_subject: Starium (was Re: article: german secure phone) 
Not correct. It does push the encryption back into the visited network, to the  old "snoop the microwave backhaul" doesn't work. Once in the visited network, the (currently being worked on) Network Domain Security takes over, but that doesn't include encryption of voice. Note that if you're roaming somewhere, and place a call to somewhere nearby, most of the time your home network is never involved (except for location update and billing).
End-to-End, of some form, has failed for lack of support in the standards committee. (Support means at least 4 companies have to agree to work on it, provide specifications, etc.) Only 3 weeks ago it was put on hold again.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-11-25 11:22:09
@_author: Greg Rose 
@_subject: What's the state of the art in one-pass 
All of the early schemes were broken, as was the NSA's submission to the AES Modes of Operation workshop. However, three schemes, all similar in principal, have not only survived, but have proofs of correctness. The first was Charanjit Jutla's IAPM mode, another is Rogaway's OCB, and the third is from Gligor and Pompescu but I can't remember its name (I'm passing through SFO as I write this, so forgive me for not having references to hand).
Phil Hawkes and I have extended IAPM (and I believe the method is applicable to the other modes too) so that you can authenticate parts of the message that are not encrypted, like IP headers for example. We sent public comments to NIST about this, or I cam post more detail if you need.
At 05:29 PM 11/24/2001 -0500, Radia Perlman - Boston Center for Networking Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-09-10 11:11:43
@_author: Greg Rose 
@_subject: Compression side channel 
Huffman coding using a fixed code table is not a bad way to go. You can even peek at the characteristics of the input and choose a table based on that... having standardised tables for English text, intel machine code, MS-word documents, C code, other languages, etc. Fax machines do something like this, with a huffman code table conditioned on a set of standard documents, but I'm not sure whether it is just a single table or a set of "choose one of these".
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-09-10 11:11:43
@_author: Greg Rose 
@_subject: Compression side channel 
Huffman coding using a fixed code table is not a bad way to go. You can even peek at the characteristics of the input and choose a table based on that... having standardised tables for English text, intel machine code, MS-word documents, C code, other languages, etc. Fax machines do something like this, with a huffman code table conditioned on a set of standard documents, but I'm not sure whether it is just a single table or a set of "choose one of these".
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-09-17 09:20:24
@_author: Greg Rose 
@_subject: NYC events and cell phones 
If terrorists were stupid enough to use cellphones, they'd likely use ones they could use at home, which means (unless they were South American or domestic or Korean) GSM. So, if someone was going to ask service providers to turn off encryption, I know which ones I'd start with...
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-09-17 12:13:15
@_author: Greg Rose 
@_subject: NYC events and cell phones  
There is one very simple reason why they might have wanted the encryption switched off. Wiretapping at the base station requires a wiretap order, whereas sniffing the airwaves in a matter of national security is something the NSA is allowed to do (but they can't get a wiretap order in a hurry).
I don't know any facts in this matter at all, but I wouldn't be surprised if someone, somewhere, requested air interface encryption to be turned off.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2001-09-25 07:14:55
@_author: Greg Rose 
@_subject: <nettime> "Pirate Utopia," FEED, February 20, 2001 
I'm afraid I have to disagree. They could all be images manipulated by a different steganographic program from the one(s) that are being tested, and/or they could all have been manipulated by very disciplined people using high-entropy passwords. Lack of evidence is at most suggestive.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-04-05 11:24:18
@_author: Greg Rose 
@_subject: Errors in FIPS 198 (HMAC) 
Dear Jim,
I wasn't sure who to email this comment to, but have met you a couple of times, so you're it. I trust you'll forward it as required. (To readers of the Cryptography mailing list: please consider Mr Foti if following up.)
In the new FIPS 198 specifying HMAC, there is a typographical error in Appendix B which talks about truncating the output HMAC value. In the third paragraph it refers to "the block size, b". However, the hash function has two block sizes, an input block size "B" and an output block size "L", and the output of HMAC (before truncation) is of length "L", not "b" or "B". A naive reading of the appendix would have us use a minimum of 256 bits to truncate a 160-bit output (referring to SHA-1)! The text in the main body correctly uses "L" in this context.
Also, the reference in Appendix A for SHA-1 is to RFC 2104, which I think is a bit strange given that there is a perfectly good FIPS (180-1) specifying SHA-1. In fact RFC2104 does not "specify" SHA-1 at all, itself referring to FIPS-180-1. The only example code in RFC2104 is for MD5.
Lastly, FIPS-180-1 specifies that the output of SHA-1 is 5 32-bit words, and explicitly does *not* specify an ordering to the bytes of the output words, although common usage is that they should be treated as most-significant-byte-first as is done to create words from the input bytes. I believe that FIPS-198 should specify a word-to-byte-order, otherwise it is impossible to unambiguously truncate the 160-bit output to a size that is not a multiple of 32 bits. (Note: I actually consider this a deficiency in FIPS-180-1, but I assume that it would be preferable to add detail to a new FIPS than to update an old one.)

@_date: 2002-02-05 14:17:24
@_author: Greg Rose 
@_subject: Welome to the Internet, here's your private key 
I think an RSA signature can be no smaller than the key modulus, so an RSA sig with a 1024-bit key is going to be 128 bytes plus some overhead, no matter what. I think you (Lynn) meant DSA here. Or maybe you did mean RSA, given that you then go on to DSA... I don't know.
This forced me to instrument my FIPS-140 code to measure it. It takes 1.42 ms to run a test on a Sun Ultra at 250MHz (I know, this is an ancient machine). It's all integer arithmetic, on short integers at that, except for the chi-square poker test, which (currently) does some floating point but could easily be recoded to do scaled, 32-bit integer (16 x 16 -> 32 bit multiplies, 16 of them, would be the bottleneck). Anyway, on a 0.5 MHz smarcard, it's probably fair to assume this would take 0.5 seconds or so (my C code is meant for clarity, not speed). This is probably less than the time required for an RSA or DSA signature (taking into account the precomputation) without hardware acceleration.
The scariest thing, though... at first I put in an unkeyed RC4 generator for the self-test data, but accidentally ran the FIPS test on a straight counter output... and it passed (even version 1)! I'd always assumed that something in the regularity of a counter would trigger it. Running through the buffer, XORing consecutive bytes, makes it fail quite handily, but might also have the undesirable effect of hiding a bias in the data, if there was one. I'm thinking of suggesting to NIST that a stronger test would be to run the test on the raw data, and then on the data after XORing consecutive bytes... if it's really random stuff it should pass both, and in the meantime this would catch all sorts of failures. Any comments?
Anyway, if anyone wants it, the new fips140.c (with self-test and timing loop support, but no other changes) is on my web page.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-02-06 06:15:54
@_author: Greg Rose 
@_subject: URL for fips140.c 
Sorry, I should have been more specific:
 goes straight to it.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-02-06 10:06:46
@_author: Greg Rose 
@_subject: Welome to the Internet, here's your private key 
Yep, that's a small and useful optimisation.
I recognise this too.
My goal when I wrote the code was to cleanly implement the FIPS as it described the tests... which I think I did. Anyone who *truly* cares about optimising it for a smartcard for example, won't use C code to do it. As I said, the only nasty things that would remain at that point are the 16 multiplies (16x16->32 bit integers), calculating the squares of the poker values... these are pretty much unavoidable. Given that, I don't understand why the FIPS specified the tests using floating point... *they* should have made this optimisation (as they did for the bounds on the runs test, which they initially got wrong anyway...)
While priming the RC4 table, I accidentally filled the data buffer instead (D'oh!) with consecutive byte values 0x00, 0x01, ... 0xFF, 0x00, ...
This very much passes the FIPS 140 tests for randomness, despite being nothing like it:
9932 ones
Poker test: 317 0x0s
Poker test: 317 0x1s
Poker test: 317 0x2s
Poker test: 317 0x3s
Poker test: 316 0x4s
Poker test: 316 0x5s
Poker test: 316 0x6s
Poker test: 316 0x7s
Poker test: 316 0x8s
Poker test: 316 0x9s
Poker test: 316 0xAs
Poker test: 316 0xBs
Poker test: 304 0xCs
Poker test: 300 0xDs
Poker test: 300 0xEs
Poker test: 300 0xFs
Poker test ChiSquared parameter = 2.304
2497 runs of 1 0s
2529 runs of 1 1s
1252 runs of 2 0s
1255 runs of 2 1s
628 runs of 3 0s
621 runs of 3 1s
317 runs of 4 0s
307 runs of 4 1s
159 runs of 5 0s
152 runs of 5 1s
160 runs of 6 0s
149 runs of 6 1s
I, like you, thought it would flunk, but it doesn't.
An interesting question. One of the utilities I have lying around happens to do LFSRs... so I can answer this.
Up to LFSR length 8, there are too few runs of length 6 or greater, so they must fail. LFSR Length 9 fails the low end of the chi-squared test... too evenly distributed. (Note that the counter above only passes this because it cuts off in the middle of a byte count, and so skews away from the one-heavy end of the spectrum). Hmmm... a table is required. (I'm using the first polynomial specified in Schneier of each length, impulse sequence:
$ lfsr -n 20000 16 5 3 2 | binbin | fips140)
Poly Length     Description of failure
-----------     ------------------
9               Poker test too regular
10              Poker test too regular
11              Poker test too regular
12              Passes test! (12, 6, 4, 1, 0)
13              Passes test! (13, 4, 3, 1, 0)
14              Passes test! (14, 5, 3, 1, 0)
15              multiple runs test failures (byte alignment too good?),
                 but passes poker test
16              Passes test! (16, 5, 3, 2, 0)
17              Passes test! (17, 3, 0)
At this point I am detecting a pattern... So, I'm afraid it isn't true that it will pick up even these simple linear sequences. (An LFSR of length 12 only generates 4095 bits, repeated about 5 times!) I find this less surprising, actually. LFSR output "looks" random in some more fundamental I was surprised that these simple software bad-generators managed to pass the test, although the point of the test is more to check out hardware failure-modes, like biases or stuck bits. Still. Interesting.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-02-07 06:56:36
@_author: Greg Rose 
@_subject: Welome to the Internet, here's your private key 
But it is interesting that, had the FIPS test worked on a multiple of 256 bytes, it would have caught it, because it uses a two-sided ChiSquare test. In other words, perfect frequency distribution (of nybbles) is also something it will reject... but it wasn't perfect because a sequence stopped early.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-02-07 14:10:54
@_author: Greg Rose 
@_subject: Welome to the Internet, here's your private key 
Yes, I agree, but it isn't my test, it's just my code for the FIPS test.
B-M is not something I'd normally recommend to run in power-up tests...
Correct, thank you. I've delayed releasing a bunch of my utilities for stuff like this because I hadn't yet had time to clean them all up and make them consistent... and it turned around and bit me. The "LFSR" program outputs ascii 0 or 1... I then used "binbin" to turn it into packed bytes, and this program was putting bits into bytes lsb-first. But the FIPS test (which originally did lsb-first too, but I was then convinced msb-first was "more conventional") didn't agree. It's interesting (but not worth pursuing) that simply reversing the bits in the bytes makes it fail the test. Anyway, now that I've changed this convention, my results agree with We've probably worn out everyone's interest with this, now. I'm happy to go offline with it though.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-02-18 11:38:26
@_author: Greg Rose 
@_subject: theory: unconditional security 
Like One-Time Pads, it seems stunningly useful only until you consider the practicalities. You still need key material as long as (in fact, twice as long as) the message, and you still cannot ever reuse the key material.
The sci.crypt FAQ has some material about why OTPs are useless in practice, and might have some references.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-01-10 12:05:00
@_author: Greg Rose 
@_subject: Quote of the Day 
I just found the following wonderful quote in the just out draft IEEE 802.11i document that defines security for wireless networks. In particular this is the section that describes the old WEP.
I like it...
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-01-16 13:20:17
@_author: Greg Rose 
@_subject: Linux-style kernel PRNGs and the FIPS140-2 test 
There was an error in the bounds for the runs test specified by NIST; last october they updated FIPS 140-2 to specify new bounds. An updated version of my code can be found at  (our old web pages are stale, and I'm still trying to have them taken down by our ex-ISP).
Here's an excerpt from the comment in the new code:
  * Version 1.3 -- Bill Chauncey and his colleages pointed out to NIST that
  * the bounds in the runs test were incorrect.
  * They issued an update 2001-oct-10.
If the new one still shows an anomalous number of runs test failures, there is a real problem.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-01-27 13:56:13
@_author: Greg Rose 
@_subject: biometrics 
There are two problems with this statement. The first is that while COMP128 was a "demonstration" (not "test") algorithm, it turns out that well over half of the deployed GSM systems do in fact use it. And there is a very interesting paper coming soon to a conference but the program hasn't yet been announced, so I can't yet say any more, but it attacks the SIM. Ross Anderson and Markus Kuhn and their group at Cambridge have done some very impressive work on getting secrets out of SIMs and smartcards in general.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-07-30 10:39:48
@_author: Greg Rose 
@_subject: building a true RNG 
Actually, it's covered very well (but briefly) in HAC (in section 2.1.6) and they refer to a seminal work by Flajolet and Odlyzko (Google finds references to it quite easily).
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-06-22 06:50:58
@_author: Greg Rose 
@_subject: RSA getting rid of trusted third parties? 
a) it isn't clear to me that RSA would have the right to revoke the organisations certificate; maybe they build it into their license agreement.
b) browsers *don't check* the revocation status on certificates, and the field that points to the server for the revocation list is almost never filled in anyway.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-03-22 15:39:01
@_author: Greg Rose 
@_subject: Secure peripheral cards 
But don't forget that your pentium can't do anything *else* while it's doing those RSAs... whereas the machine with the nForce can be actually servicing the requests.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-10-03 03:21:05
@_author: Greg Rose 
@_subject: Optical analog computing? 
But Colossus was not for Enigma. The bombes used for Enigma were electro-mechanical. I'm not aware of any application of optical techniques to Enigma, unless they were done in the US and are still classified. And clearly, the first bulk breaks of Enigma were done by the bombes, so I guess it depends whether you count bombes as computers or not, whether this statement has any credibility at all.
Williams/Zenon 2004 campaign page: Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-10-16 14:01:03
@_author: Greg Rose 
@_subject: [Bruce Schneier <schneier@counterpane.com>] CRYPTO-GRAM, 
I hate to point this out since it sounds like nitpicking, but it's eXtended Sparse Linearisation (XSL), not the spreadsheet XLS.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-10-23 09:01:39
@_author: Greg Rose 
@_subject: Why is RMAC resistant to birthday attacks? 
A nit... this isn't *quite* true for HMAC; the collision could have been in the outer hash function evaluation, not the inner. I haven't yet looked at RMAC and don't know what DMAC is, so I can't comment on them.
Still, the attack gives a 50% chance of forging an HMAC, so it's a valid Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-09-17 08:21:15
@_author: Greg Rose 
@_subject: Cryptogram: Palladium Only for DRM 
Well, the bank's and the users' interests are only *mostly* aligned. The user really wants to be able, in the case of some strange disagreement, to take the application to a disassembler and show that it occasionally transfers twice as much money as it is supposed to, and show that its own records note such transfers. Under Palladium, the user loses the ability to audit either the program itself or the program's static data. In theory, this doesn't matter, but in practice...
I agree that all of the other protections can be provided by proper OS-level security, and don't need Pd. So again, Pd just takes that burdensome self-protection ability away from the user.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-09-17 10:12:25
@_author: Greg Rose 
@_subject: Cryptogram: Palladium Only for DRM 
... and how long before someone realises that it can be a five line program, that says "load this 3 Mb buffer from this encrypted data file, then jump to it"?
You also didn't address the point that the user's copy of the auditable data is no longer accessible to the user, making a mockery of the audit Your rebuttal lacks substance. The issue is loss of control and accountability.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2002-09-28 03:02:47
@_author: Greg Rose 
@_subject: RSA's RC5-64 Secret Key Challenge has been solved. 
Kasumi (in the form of "f8" (ciphering) and "f9" (integrity) is beginning to be deployed in UMTS (WidebandCDMA) mobiles as we speak. But an exact specification of how to use Kasumi as A5/3 has only just been agreed; it will be 6-12 months (at least) before any significant amount of equipment, either fixed or mobile, will be produced and deployed, and it will be a couple more years after that before there will be significant probability that a call is encrypted using A5/3.
A5/3 will be stuck at 64 bit keys for the forseeable future, due to compatibility issues in the protocol. f8 and f9, on the other hand, already use 128-bit keys.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-12-21 07:58:21
@_author: Greg Rose 
@_subject: I don't know PAIN... 
I've seen, for many years, the acronym "CAIN", where the C is "Confidentiality". I think that was in the Orange Book.
There's also, historically, an R for "Robustness" or "Reliability" in many military contexts, instead of the N for Nonrepudiation. That is, protection from denial-of-service attacks.
Lastly, the A is often Authorization rather than Authentication, since integrity implies identification of the source.
The first time I recall seeing PAIN was just a few weeks ago, in postings by Lynn.
I don't know if that helps, because I certainly got mightily confused while writing it.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-02-11 13:32:01
@_author: Greg Rose 
@_subject: Columbia crypto box  
I agree that on balance, the implementation of RC4 for WEP was very wrong. But by your own numbers (and on the assumption that RC4 generates bytes twice as fast as AES and that the cost of keying is equivalent to generating 256 bytes) RC4 should win, computationally, on packets greater than 256 bytes.
More modern stream ciphers such as SOBER-t32, SNOW2.0 and Turing, all of which explicitly support Initialisation Vectors to generate distinct streams, perform much better than AES for a job like this. I happen to have the numbers to hand for a comparison of my implementation of Turing vs. Brian Gladman's highly optimised AES (because the paper is being presented in two weeks at FSE), and computationally speaking Turing overtakes at about 100 bytes and generates bytes about 5 times faster from there on. SNOW2.0 overtakes almost straight away, and generates bytes about 3 times faster (haven't measured that myself, but I believe it). The combination of Turing for encryption and HMAC-SHA-1 for MAC outperforms AES even in OCB mode on my laptop.
(Lest anyone ask, no, I'm not suggesting adopting Turing or SNOW2.0... they're too new. And I'm not trying to promote my own cipher particularly. You said: "A block cipher is clearly a better choice here." This is almost, for me, the canonical case for a stream cipher. What's clear to you isn't clear to me. Can you elucidate, please?
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-02-13 04:43:37
@_author: Greg Rose 
@_subject: Columbia crypto box 
This *still* allows a dictionary attack; in fact, it allows a more powerful one than revealing 16 bits of the key does.
If you just reveal 16 bits of the key, then an adversary either needs to store 2^56 dictionary entries, or enumerate 2^40 keys.
If you do as CDMF does, there are effectively only 2^40 possible 56-bit keys; these can be precomputed and stored on eg. tape. (7.5 terabytes, well within tape library range 10 years ago.) So you can *still* brute force the keys just as easily, noting that all this really does is avoid two hash function invokations per key. More, though, you can now compute and store (in comparable tape space) the dictionary, so CDMF *does* allow a precomputed dictionary attack that requires only storage for 2^40 dictionary entries (whatever size they are).
So CDMF isn't that neat, really...
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-02-18 13:09:55
@_author: Greg Rose 
@_subject: AES-128 keys unique for fixed plaintext/ciphertext pair? 
I'd be very surprised if this were true, and if it was, it might have bad implications for related key attacks and the use of AES for hashing/MACing.
Basically, block encryption with a given key should form a pseudo-random permutation of its inputs, but encryption of a constant input with a varying key is usually expected to behave like a pseudo-random *function* Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-01-22 07:47:34
@_author: Greg Rose 
@_subject: Key Pair Agreement? 
At 09:08 PM 1/20/2003 -0500, Radia Perlman - Boston Center for Networking This is the essence of the "DEADBEEF" attack on PGP. PGP used the least significant bits of the modulus as the key ID. If you want to create a key with a particular key ID, you just hack the code so that it checks for primes that end in things which will multiply together to yeild the desired answer; the easy case, of course, is 0x00000001 and 0xDEADBEEF, which is what was done to create the Prime Rib Lovers' key as a proof of concept[*]. There does not appear to be any significant erosion of security, although I'm not sure if anyone's thought too seriously about that specific case either.
[*] I note that there are three keys on the us.pgp.net server with 0xDEADBEEF as their key ID (including the one mentioned above), and one of them is even a DSA key! I can only assume this was brute forced through the hash function.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-07-02 15:59:43
@_author: Greg Rose 
@_subject: Crypto 2003 
This year's Crypto conference is in Santa Barbara August 17-21. The early registration deadline is July 14th. Full program information is available at   .
It'll be great, both technically and socially!
(General Chair)
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-06-11 02:47:48
@_author: Greg Rose 
@_subject: Keyservers and Spam 
I have to partially disagree, in the area of well known pseudonyms. Why would you want to contact someone you've never actually met? Because of their reputation, that's why. So what if the name by which you know them is fake, in the sense of not being the one on their driver's license? Like, for example, Mudge, Hobbit, Lucky Green, Black Unicorn. Three of whose keys I have signed in good faith, to attest that if you trust me, and send mail to one of those, it will get to the individual you thought it would get to, even though you don't know their name. Did that make sense?
That still doesn't solve your fundamental problem, though... I bet they all get spam.
There's a relatively simple hack that helps in this context; have the keyserver refuse to return more than some small number of keys for any query. If I ask for the keys of all the "Jill"s, it'll say "too many... refine search". (There are 252 on us.pgp.net.) If I ask for "Ramonsky" it'll hopefully return just a couple (or in this case none). It should refuse too many requests in a row from a single source. By the time a spammer with a list of common names gets around this with either a long, slow attack, or a distributed attack, much of the value will have gone out of it for them.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-03-03 11:09:17
@_author: Greg Rose 
@_subject: Some good words needed... 
After a long effort, I finally got agreement from my company to make our encryption algorithms freely available. (See  if you care.) Somewhat unexpectedly, we now have a number of queries saying basically "That's unpatriotic, giving it away to the terrorists!" Note that they were already *available* to them, it just wasn't free for all uses! So I guess it's unpatriotic to fail to make money from these terrible weapons. I won't even get into the issue of me being a furriner in the first place. Anyway.
I'm perfectly capable of writing my own words on the subject, but I also know that they've been written many times before. What are people's "favourite", succinct expressions of why it's OK to give away encryption To keep the list uncluttered, I suggest people send me suggestions, and I'll compile, collate, and report back to the list.
thanks and regards,
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-03-09 12:33:27
@_author: Greg Rose 
@_subject: Proven Primes 
Tom St Denis  has a program that constructs provable primes, by bootstrapping them from smaller proven primes. The trouble is that his stuff is off the air at the moment. You might write to him, though. It's pretty quick, IIRC.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-11-27 14:45:47
@_author: Greg Rose 
@_subject: Open Source Embedded SSL - Export Questions 
I'm afraid that I can't agree with this howling logical error. RC4 is showing its age, but there are other stream ciphers that are acceptable, and there are block ciphers (such as FEAL, same vintage as RC4) that aren't even vaguely secure.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-09-07 07:56:46
@_author: Greg Rose 
@_subject: cryptographic ergodic sequence generators? 
The characteristic you ask for is exactly that of an n-bit block cipher in Counter Mode. For example, that's exactly why we developed Skip32, which is on our web page; we needed an unpredictable but non-repeating 32 bit nonce.
If you aren't prepared to accept the cost of a (scaled down) block cipher, then you'll have to restate your requirements.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-09-09 02:37:04
@_author: Greg Rose 
@_subject: Code breakers crack GSM cellphone encryption 
Actually, patenting the method isn't nearly as silly as it sounds. Produced in quantity, a device to break GSM using this attack is not going to cost much more than a cellphone (without subsidies). Patenting the attack prevents the production of the "radio shack (tm) gsm scanner", so that it at least requires serious attackers, not idle retirees or jealous teenagers.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-09-09 03:39:00
@_author: Greg Rose 
@_subject: Code breakers crack GSM cellphone encryption 
No, that's not right. The attack *avoids* A5/3, by making the terminal end of the call fall back to A5/2, solving for the key in real time, then continuing to use the same key with A5/3.
A5/3 (based on Kasumi, and essentially the same as the WCDMA algorithm UEA1) is not in any way compromised by this attack.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-09-29 08:33:59
@_author: Greg Rose 
@_subject: A quick question... 
I think your friend has a very limited understanding of what's going on; he's right in some small sense, but wrong in practice.
"Cubing" is coming from the assumption that the public exponent is 3, which is possible for RSA but rare in practice; 17 or 2^16+1 are much more common values. It also relies on using some rawly implemented RSA, so that all that is in the RSA payload is the hash, and nothing else. This violates all the standards that specify that the payload should be padded with stuff that, among other things, guarantees that even with an exponent of three, the answer will have exceeded the modulus and been subject to modular reduction. So he's talking through his hat.
So, here's the attack. Suppose you have a 160-bit SHA-1 hash of some document, and it just happens to be a perfect cube (integer-speaking). Then the cube root of that hash is a valid signature independent of the modulus, so long as the public exponent is 3. Adding (and checking) correct padding (eg. OAEP or PSS, see the PKCS standards) makes it extremely unlikely that there will be a cube root for the attack to work on.
Others may want to correct me or elaborate further, but I think that's correct.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2003-10-01 10:27:22
@_author: Greg Rose 
@_subject: Literature about Merkle hash tries? 
I know that the technique dates back (at least) to IBM in the 60s. I used to know the name of the inventor but can't bring it to mind at the moment. The Berkeley UNIX library dbm uses essentially this philosophy, but the tree is not binary; rather each node stores up to one disk block's worth of pointers. Nodes split when they get too full. When the point is to handle a lot of data, this makes much more sense.
Hope that helps,
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-04-04 07:57:18
@_author: Greg Rose 
@_subject: Do Cryptographers burn? 
Basically, the cryptographers you refer to have risen to where they are through a process of academic training that praises honesty, hard work, and correct results. For them to suddenly cross some undrawn and unadvertised line in the sand and start faking or suppressing results, all at the same place and time, without a single one of them going for the glory of publishing "The Factoring Paper", is literally incredible.
Besides, people who can't remember to wear matching socks don't make good conspirators ;-).
So, no, you don't have to trust all of them, just that statistically some of them will slip occasionally, and the house of cards would fall down. Therefore there is no house of cards.
Greg Rose                                       INTERNET: ggr at qualcomm.com
Qualcomm Australia          VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,                Gladesville NSW 2111    232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-17 09:20:34
@_author: Greg Rose 
@_subject: SHA-1 rumors 
No, it was on the compression function, but not in any sense "reduced". But you had to start with particular values of the chaining variables, and in practice no-one knows how to do that, so MD5 (as a whole) isn't broken by this, at least until tomorrow evening. The rumour here is that MD5, HAVAL, and RIPE-MD are all goners. We know SHA-0 is toast too. There might also be results against SHA-1. Hash functions are hard.
And the reason you haven't heard any progress from Dobbertin is because his employers told him to either stop working on it, or stop talking about it, depending which version of the story you've heard. Since he works for the German NSA-equivalent, I guess he would take this seriously.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-18 13:11:22
@_author: Greg Rose 
@_subject: MD5 collisions? 
Eli Biham -- has collisions on 34 (out of 80) rounds of SHA-1, but can extend that to probably 46. Still nowhere near a break.
Antoine Joux -- his team announced the collision on SHA-0 earlier this week. There is concentration on the so-called "IF" function in the first 20 rounds... f(a,b,c) = (a & b) ^ (~a & c). That is, the bits of a choose whether to pass the bits from b, or c, to the result. The technique (and Eli's) depends on getting a "near collision" in the first block hashed, then using more near collisions to move the different bits around, finally using another near collision to converge after the fourth block hashed. This took 20 days on 160 Itanium processors. It was about 2^50 hash Xiaoyun Wang was almost unintelligible. But the attack works with "any initial values", which means that they can take any prefix, and produce collisions between two different suffixes. The can produce the first collision for a given initial value in less than an hour, and then can crank them out at about one every 5 minutes. It seems to be a straightforward differential cryptanalysis attack, so one wonders why no-one else came up with it. The attack on Haval takes about 64 tries. On MD4, about 4 tries. RIPE-MD, about 2 hours (but can improve it).  SHA-0 about 2^40 (1000 times better than Joux).
Xuejia Lai clarified that the paper on E-print has been updated with correct initial values. They were initially byte-reversed, which they blamed on Bruce Schneier.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-19 00:49:17
@_author: Greg Rose 
@_subject: MD5 collisions? 
In the light of day and less inebriated, I'd like to clarify some of what I wrote last night, and maybe expand a bit. My original account wasn't what I'd like to think of as a record for posterity.
This was not meant as a criticism. It just meant you had to concentrate really hard. Her English is much better than my Chinese.
As mentioned previously, the idea is to produce a good "partial collision" with the first blocks input to the hash, and then from two similar starting points, find subsequent blocks that correct them back to the same output. So, for a given input chaining vector, it takes about an hour to get the partial collisions in the first input block. From there, they can compute subsequent "second blocks" to produce the collisions in a few minutes.
Note that they did two entirely new collisions for MD5 overnight, communicating back to China, when they found out about the endianness problems. No-one can now argue that they can't find collisions at will.
With further hindsight, and Phil Hawkes' help, I understand now. The technique needs to alternate between single bit (xor) differences and subtractive differences, with careful conditioning of the bits affected to make sure the right carries do, or don't, propagate. This is explained in Phil's upcoming paper about SHA-2 cancellations, which was presented later in the rump session. That should be on e-print in the next couple of days. The Chinese team is also writing a much more detailed paper, but it will take longer.
There has been criticism about the Wang et. al paper that "it doesn't explain how they get the collisions". That isn't right. Note that from the incorrect paper to the corrected one, the "delta" values didn't change. Basically, if you throw random numbers in as inputs, in pairs with the specified deltas, you should eventually be able to create your own MD5 collisions for fun or profit. How they got this insight, we'll have to wait for... but the "method" is already there.

@_date: 2004-08-19 02:19:48
@_author: Greg Rose 
@_subject: MD5 collisions? 
This, too, is overly simplistic an explanation. Doing it like this would effectively multiply the work for the near-collision in the first block and the correction in the second block, which is not what you want. To be efficient, you need to divide-and-conquer; make random pairs of first blocks until you find a pair that have the right very small difference in their chaining outputs. Then, from those first blocks, try to find second blocks that work. This adds the amounts of work, rather than multiplying them.
Apologies for any confusion.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-19 02:51:35
@_author: Greg Rose 
@_subject: MD5 collisions? 
If I've understood it correctly, the answer is "sort of". For a given input, it seems that there is some non-trivial chance that the input+delta would produce the same hash, that is, a 2nd preimage. But the probability, for any single arbitrary message, might be quite low (especially since you'd have to multiply the probabilities of success for the first and second blocks; see my other message just before this one). But it seems to me that that probability would still be much better than the 2^-n that it should be for an n-bit hash.
For example, the MD5 collision in 2^40 work is really two separate near-collisions, each taking a bit less than 2^40 work. If you apply the deltas to a random message M, both blocks at the same time, it seems to me that the probability of success is about 2^-80; it either works or it doesn't. But that 2^-80 is a much better chance than you would have had for two random messages (which is really message M and a random delta).
But I could also be mistaken on this.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-19 04:25:48
@_author: Greg Rose 
@_subject: SHA-1 status, plus request for explanation... 
Correct, and at the end of his full talk this morning Eli said "we're not close to breaking SHA-1 with this".
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-08-23 06:14:43
@_author: Greg Rose 
@_subject: Bad day at the hash function factory 
Phil Hawkes' paper on the SHA-2 round function has just been posted as Eprint number 207. It contains rather a lot of detail, unlike some of the other papers on the subject of hash function collisions.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-07-10 10:28:49
@_author: Greg Rose 
@_subject: EZ Pass and the fast lane .... 
If they could do that reliably, they wouldn't need the toll thingy, nu? I have been told by someone in the photo-enforcement industry that their reliability is only around 75%, and they're very expensive, and ... anyway, not a viable solution to the problem given the current economics. But to a weekly commuter over one of the bridges in New York, for example, it's $1000 per year.
Until recently, when viruses and worms started to be used to assist spamming, what incentive did a miscreant have to invade hundreds or thousands of computers?
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-06-07 15:09:28
@_author: Greg Rose 
@_subject: Article on passwords in Wired News 
Actually, they just discontinued it too, as of end of may.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2004-06-20 07:03:31
@_author: Greg Rose 
@_subject: BBC story on Iran codes 
Gee, a pity they can't calculate 2^128 correctly.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Australia       VOICE:  +61-2-9817 4188   FAX: +61-2-9817 5199
Level 3, 230 Victoria Road,             Gladesville NSW 2111/232B EC8F 44C6 C853 D68F  E107 E6BF CD2F 1081 A37C

@_date: 2005-08-12 13:42:08
@_author: Greg Rose 
@_subject: Number of rounds needed for perfect Feistel? 
Here's my understanding, but it's from my memory, so don't take it too seriously.
First, Luby-Rackov gives you a lower bound of four rounds. Note, though, that the random functions you need must be independent of each other, so you'll need to put something into AES that is dependent on the round number to ensure this (and it avoids slide atttacks too). Secondly, the security bound is only 2^(N/4), because you're fighting the birthday paradox on collisions in half-blocks.
Then a couple of years ago, at crypto, there was a paper that showed that 6 rounds was as secure as it gets in the non-chosen-text model, and 7 rounds is secure enough even with adaptive chosen-text attacks: see Luby-Rackoff: 7 Rounds are Enough for 2^n(1-epsilon) Security
Jacques Patarin , crypto 2003. You still need the round functions to be different.
Hope that helps.
Greg.

@_date: 2005-02-04 10:51:14
@_author: Greg Rose 
@_subject: Is 3DES Broken? 
I'm surprised that no-one has said that ECB mode is "unsafe at any speed".
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-02-17 13:40:43
@_author: Greg Rose 
@_subject: SHA-1 cracked 
No, that's not what it says. It says that "Note that padding rules were not applied to the message." This is exactly the same as the previous breaks; it just means that the collision appears in the chaining output... if you just append anything at all to the end of the texts, and pad it correctly, you will have valid SHA-1 hashes. Nothing different here than from the MD4/MD5/SHA-0 breaks.
Since I'm typing anyway, I'll also reply to Joseph Ashwood's earlier mail, in which he said:
If you look at Phil Hawkes' paper , you will see that the SHA-2s are very different algorithms, and my own opinion is that the data-expansion part of the algorithm is *seriously* beefed up. My guess is that the NSA were already worried about this kind of attack (whether they'd found it or not). We don't have a good analysis of the data-expansion part, but I'm pretty sure that it'll defeat the Wang Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-01-04 12:10:11
@_author: Greg Rose 
@_subject: SSL/TLS passive sniffing 
Am I understanding correctly? Does SSL/TLS really generate a new P and G for each connection? If so, can someone explain the rationale behind this? It seems insane to me. And not doing so would certainly ease the problem on the entropy pool, not to mention CPU load for primality testing.
I must be misunderstanding. Surely. Please?
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-06-03 06:38:44
@_author: Greg Rose 
@_subject: [Clips] Storm Brews Over Encryption 'Safe Harbor' in Data 
Ah, imagine the beautiful circularity of the Justice Department using encryption to protect their criminal identity database from disclosure... or not.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-06-14 11:54:08
@_author: Greg Rose 
@_subject: expanding a password into many keys 
You know, the proof that HMAC is a good MAC requires that the *compression function* of the underlying hash is good. And for almost all applications like this one, both the input password and the sequence number, tag name, or whatever the second input is, all fit into a single compression function block. So you already get exactly what you need from the hash function, without needing the extra layer or two. They can't hurt much(*), but they don't actually help either.
(*) actually each layer reduces the space of output keys slightly; not enough to matter in practice, but it is actually infinitesimally worse than just doing the hash.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-11-01 08:33:39
@_author: Greg Rose 
@_subject: Symmetric ciphers as hash functions 
Not so... the SHA family are all unbalanced Feistel structures. Basically, for SHA-1 a complex function of 4 words and key material (in this case expanded data to be hashed) is combined with the fifth word. The fact that the four words don't change is the giveaway that it's a feistel structure. The later SHAs have a more complicated structure, blurring the boundary a bit, but I'd still call them unbalanced Feistel.

@_date: 2005-10-04 10:13:32
@_author: Greg Rose 
@_subject: Venona not all decrypted? 
Here's my understanding of how Venona worked, and why budget would be a problem. I could be completely off base, though.
The OTPs were only very occasionally misused, by being used more than once. So the breaks occurred when two separate messages, or possibly fragments of messages, were combined in such a way as to cancel out the OTP, then the resulting running-key cipher was solved to yield the two messages. I don't think that the NSA had access to the pads themselves, except after having recovered the messages (and hence the pad for those messages). So there really isn't likelihood that that pad would be reused even more times.
To detect that a pad has been reused, you basically have to line up two ciphertexts at the right places, combine them appropriately, and run a statistical test on the result to see if it shows significant bias. This is an O(n^2.m) problem, where n is the number of units to be tested (maybe whole messages, maybe pages of OTP, maybe at the character level? Who knows?) and m represents enough text to reliably detect a collision. There was a very large amount of intercepted data, and it's presumably all stored on tapes somewhere, so that n^2 factor probably involves actually mounting tapes and stuff.
But in a way, you're right; it should, with today's technology, be possible to just read all the tapes once onto a big RAID, and set the cluster to work for a year or two.
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2005-10-18 09:24:17
@_author: Greg Rose 
@_subject: SecurID and garage door openers 
Yes, at registration time the server checks that the clock skew is reasonable (IIRC, within 100 minutes either way). From then on it knows and remembers the approximate clock skew.
Ahh, one of the dirty little secrets. If the base receives two sequential outputs from a registered token, even if they are a long way away from the currently expected output, it will resynchronize to that. The replay protection just means that the attacker needs to record two sequential accesses, not a single one. When all is working as expected, this means the attacker must target you and hang around for a day, or do a lunchtime attack on your zapper.
Greg.

@_date: 2005-09-15 10:25:30
@_author: Greg Rose 
@_subject: ECC patents? 
They (NSA) did pay, and they (Certicom) did stick it in our faces. See, eg.,  . Did you miss this at the time?
Greg Rose                                    INTERNET: ggr at qualcomm.com
Qualcomm Incorporated     VOICE: +1-858-651-5733   FAX: +1-858-651-5766
5775 Morehouse Drive                    San Diego, CA 92121   232B EC8F 44C6 C853 D68F E107 E6BF CD2F 1081 A37C

@_date: 2006-04-02 14:33:31
@_author: Greg Rose 
@_subject: is breaking RSA at least as hard as factoring or vice-versa? 
It's conceivable that there might be a way to decrypt RSA messages without knowing d. If you don't know d, you still can't factor n. Whereas if you can factor n, you can find d, and decrypt messages. So the problems are not equivalent, and the RSA problem might be easier than the integer factorization problem. (At least, the above is my

@_date: 2006-08-27 09:15:03
@_author: Greg Rose 
@_subject: Chasing the Rabbit - a cryptanalytic contest 
Dan did *not* make the presentation. He was on the program but didn't speak.

@_date: 2006-08-28 08:45:56
@_author: Greg Rose 
@_subject: Chasing the Rabbit - a cryptanalytic contest 
Sorry, my apologies. I hadn't meant my reply to go to the whole list, either... fat fingered it.

@_date: 2006-06-07 04:07:41
@_author: Greg Rose 
@_subject: U. Washington Crypto Course Available Online For Free 
I hardly think that you can discount the skills of Josh Beneloh and Brian LaMacchia.
Damn, I was trying to hire Yoshi...

@_date: 2006-03-23 14:50:01
@_author: Greg Rose 
@_subject: Entropy Definition (was Re: passphrases with more than 160 
As a minor nit, shuffling *in an unpredictable manner* adds entropy, because there is extra randomness being brought into the process. If I was one of those people who can do a perfect riffle shuffle, reordering the cards in this entirely predictable manner does not increase or decrease the existing entropy.
So in one sense, the answer is a simple "no"... nothing you can do to a passphrase can increase its (that is, the passphrase's) entropy. You can add randomness from another source, and increase the total entropy, but I don't think that is relevant to the original question.

@_date: 2006-11-08 21:39:28
@_author: Greg Rose 
@_subject: Can you keep a secret? This encrypted drive can... 
Hmm, I disagree with this. Firstly, I don't think SHA-1 *is* holding on... while we don't have an example collision yet, there is no real doubt that one can be found in about 2^64 operations, which is less than the required 2^80. And SHA-2 does have a significantly different design in one area; the data expansion part is much stronger than SHA-1's, and almost certainly defeats the Wang-style attacks. Our paper on eprint gives some justification for why SHA-2 would appear to be resistant to these kinds of attacks.

@_date: 2006-10-13 10:46:18
@_author: Greg Rose 
@_subject: handling weak keys using random selection and CSPRNGs 
Actually, no. I have a general purpose stats program that I often use for cryptanalysis as part of my tookit. I pointed it at my photos folder, and every single jpeg file had results like this:
samples:      88246
unique:       256
sum:          11413854
sum squares:  1943201034
maximum:      255
minimum:      0
range:        255
mean:         129.34132
variance:     5291.1565
std dev:      72.740336
median:       130
exp freq:     344.71094
max freq:     623
mode count:   1
mode:         0
min freq:     109
unmode count: 1
unmode:       192
chi^2:        4375.0414
chi^2 df:     255
pr(chi^2):    1.00000 (*** certainly non-uniform distribution ***)
bad buckets:  96
KS+:          1.0002392
pr(KS+):      0.86510
KS-:          6.6097712
pr(KS-):      1.00000 (*** certainly non-uniform distribution ***)
KS(both):     3.8050052
pr(KS_BOTH):  1.00000
The simplest test is just the chi-squared test on the frequency of bytes, and it's way out of range on even fairly small jpegs. The Kolmogorov-Smirnoff test almost always bingos too. And even if the chi-squared passes, the binomial test on individual byte-value frequencies will flag the data as non-random; note the "bad buckets" count above; the detailed output is suppressed when the chi-squared test fails, since there will generally be too much of it.
The only things that it usually passes as good are for-purpose random number generators' or ciphers' outputs. Everything else (including a terabyte of RC4 output, executables, zip archives, jpegs, mpegs, mp3s, ...) that I've pointed it at, fails one or more of the tests.
True random-looking-ness is hard to find... :-)

@_date: 2006-10-14 16:15:44
@_author: Greg Rose 
@_subject: handling weak keys using random selection and CSPRNGs 
Not specifically, but see below.
I don't think so. If you look at the data I quoted in the email you quoted from, the difference in frequency between the most frequent byte and least frequent byte was over 500 occurrences. I doubt that the jpeg header alone could account for that, although I'll give you that since the byte value in question was zero, it may have something to do with it.
The jpeg header is more complicated than I want to take the time to understand at the moment. So here; I took the smallest meaningful jpeg I had lying around (taken from someone's low-res camera in 2002), and I dropped about the first half of the file, keeping only the last 34k. Note that the very same troublesome statistics show up.
I attach the picture in case anyone wants to duplicate the statistics. I'm the ugly one on the right. I don't even know who most of the other people are.
Now, you said "compressed files" and you might not have meant pictures, but note that L-Z style compressed files don't really have much in the way of headers. If the headers were a problem, you'd expect longer files to bury any deviation in the noise, but it doesn't. The longer the files I test the more certainly non-random they are.
I stand by my statements.

@_date: 2006-10-17 21:59:55
@_author: Greg Rose 
@_subject: hashes on restricted domains: random functions or 
It would be unexpected and certainly very surprising if SHA-1 formed a permutation of 160-bit inputs.
Yes, it's correct. No, it's not worth worrying about. See the Handbook of Applied Cryptography for more details, but the executive summary is:
If you start with a particular input and repeatedly hash it (and on the assumption that SHA-1 is an approximation of a decent PRF), you expect to go through about 2^80 unique values before eventually settling into a cycle of length about 2^80. There are probably a (smallish) number of distinct such cycles. But since you'd have to wait a very long time before this mattered, it isn't a practical

@_date: 2006-09-14 11:03:08
@_author: Greg Rose 
@_subject: Exponent 3 damage spreads... 
So, there is at least one top-level CA installed in some common browsers (I checked Firefox) that uses exponent-3. It is "Starfield Technologies Inc." "Starfield Class 2 CA". There may well be others... I only looked far enough to determine that that was a So the next question becomes, what browsers used OpenSSL and/or their own broken code, and need to be patched? I have no idea.
Thanks to Alex Gantman for asking the question...

@_date: 2006-09-14 11:09:15
@_author: Greg Rose 
@_subject: Why the exponent 3 error happened: 
I beg to differ. A programmer who didn't understand the significance of crypto primitives would (as many did) just search for the end of the padding to locate the beginning of the hash, and check that the next set of bytes were identical to the hash, then return "true". So
01010101 ... 10101010101010000 hash crappetycrap
would still be considered valid. There's a lot of code out there that ignored the fact that after the FFs was specific ASN.1 stuff, and just treated it as a defined part of the padding.

@_date: 2006-09-14 11:27:12
@_author: Greg Rose 
@_subject: Exponent 3 damage spreads... 
I thought this for a while, but no, it isn't true. Take a number k, which is of the order of 2^1008 (which is what a properly padded 1024-bit RSA signature will look like numerically). So the cube root of K is a real number of the order of 2^336... call this k'. Now on average it will be within +/- 0.25 of the nearest integer, so for sake of argument let i = k' + 0.25 be an integer.
i^3 - k = (k' + 0.25)^3 - k
         = k + 0.25*k'^2 +0.0625*k' + 1/64 - k
which is of order 0.25*k^2/3, ie, 2^670. Unless you are using very large hashes indeed, the chance of a properly padded RSA signature being a perfect cube is vanishingly small.
I don't yet agree with this conclusion.
I just have to mention that e=2 is Rabin signatures, and they have different and very stringent requirements for signatures. Maybe the same problem exists, maybe it doesn't, I don't know.

@_date: 2006-09-28 13:13:15
@_author: Greg Rose 
@_subject: A note on vendor reaction speed to the e=3 problem 
The "sum" command has existed in Unixes since before VMS existed. Checksum has too many characters in the name ;-).

@_date: 2007-06-22 13:08:19
@_author: Greg Rose 
@_subject: Quantum Cryptography 
To be used in key distribution I have to have laid a private optical fiber between me and my correspondent. I could have paid a lot less for an armored truck to carry the key for me. (I know you can do QKD without the fiber these days, but how do you know that you agreed the key with the person you think you agreed it with? It's turtles all the way down.)

@_date: 2007-05-23 10:29:08
@_author: Greg Rose 
@_subject: 307 digit number factored 
Last night at the Eurocrypt rump session Arjen said that there were two things that were different this time. One is that they got all the big factoring groups to work together for the first time. The other is that they managed to distribute the matrix reduction phase to four machines... previously this has always needed a single huge machine. It sounds like a big deal to me too. (I don't know how they did it. I look forward to trying to understand the details.)
I'll get the quote wrong, but he also said something like:
"doing 1024 bits sounds about 5 times easier now, than doing 768 bits did in 1999 when we did 512 bits."

@_date: 2008-08-19 15:38:43
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
Stunningly smart, and an excellent and understandable presentation.
Basically, any calculation with inputs and outputs can be represented as   an (insanely complicated and probably intractable) set of binary multivariate polynomials. So long as the degree of the polynomials is not too large, the method allows most of the nonlinear terms to be cancelled out, even though the attacker can't possibly handle them. Then you solve a tractable system of linear equations to recover key (or state) bits.
His example was an insanely complicated theoretical LFSR-based stream cipher; recovers keys with 2^28 (from memory, I might be a little out), with 2^40 precomputation, from only about a million output bits. They are working on applying the technique to real ciphers... Trivium, which is a well-respected E*Stream cipher, is in their sights.
My team's last LFSR-based cipher, SOBER-128, is I think well respected and fairly conservative. I can say that we are extremely lucky in the way we load the key and IV, that the degree of the polynomials piles up and is quite high; once the cipher is actually running, there are output   bits which would have been attackable (degree 16 is certainly tractable), except for lucky use of addition as well as s-boxes... the addition carries represent high degree terms.

@_date: 2008-08-19 16:53:37
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
With the disclaimer that I think I understand the attack but might nevertheless have misunderstood something:
A5/1 is difficult for this attack to apply to because of the clock-controlled shift registers (Adi said this).
A5/3 and the current WCDMA f8/f9 is based on Kasumi, and I'd be surprised if the attack applys. Ditto for the AES based CDMA security.
The soon-to-be-adopted spare WCDMA algorithm, SNOW-3G, may be vulnerable if used in other ways, but appears to me to be secure in the way it is used in 3G phones. Again, somewhat lucky though, the attack comes very close to working. I believe the appropriate standards committee is going to go off and check this very closely (I spoke to one of the members).

@_date: 2008-08-19 17:37:00
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
Hmmm, interesting. I'm getting increasingly closer to talking through my hat, but...
Skipjack has an 8x8 S-box, so by definition the maximum degree of the polynomials for a trip through the S-box is 8 (but it could be lower... I don't know off the top of my head). There are 32 rounds, but each word gets hit only in every fourth round... that is, each word gets hit 8 times. So the degree from beginning to end should be 64, probably out of range. However Adi mentioned a variant where you sort of "meet in the middle", where you have one set of equations to get to some particular bit in the middle from the plaintext, and you get to the same bit backwards from the output bits, and by definition the two polynomials are equal. This should halve the degree, to around 32, if I've understood correctly. With an 80 bit key the attack might be more efficient than brute force. Again from memory the complexity was O(n*2^2d+n^2), (n-bit key, d degree) for skipjack this might be about 2^70. Skipjack's nearly non-existent key schedule really helps. This might be a good project for a grad student.
Enough speculation from me... but I'll try to corner Adi later and ask him some of the questions that have been burning in my mind.

@_date: 2008-08-20 06:11:19
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
So I cornered Adi for a while. Of course he'd thought of almost
everything I wanted to ask.
You're not the first to think of RC4 (I confess I wasn't either). No, if
you try to express shuffling as a polynomial, its degree is off the planet.
As for some of the other things I said:
when you compound s-boxes, the degrees multiply. For some reason I can
no longer explain, I thought they added. So there's good news and bad news.
The good news is that my/our old designs are safe: degrees ~= 64.
The bad news (if you think of it that way), Skipjack is also safe, the
degree is 4096 (not 32), that is, 8^4 not 8*4.
... and I realised I forgot to mention probably the most interesting thing about
the attack! It treats the cipher as a black box. You don't need to know
anything about it, except access to an implementation that will accept
variable keys for the precomputation phase. If it isn't vulnerable, the
precomputation fails. But if it is vulnerable, you'll recover the keys
even though you have no idea what the algorithm itself is. Somewhere
along there you discover a distinguishing attack. Amazing.
Someone else suggested Bluetooth (E0). Probably not vulnerable because
the key scheduling is high degree, but neither Adi nor I can remember
enough detail to be sure; the keystream generator would be vulnerable if
the key-IV scheduling was simple enough.
I'm not sure whether Adi's invited talk or Wang's rump session (breaking
MD5, SHA-0, HAVAL, ...) is the high point of Crypto for me... I think Cube.

@_date: 2008-08-20 14:40:29
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
I spent about an hour trying to come up with a short but legible explanation of the technique, and failed. Sorry about that. I can visualize it, and could probably reproduce Adi's drawings on a whiteboard, but not with typing. The following is as close as I could come.
Basically the method focuses on terms of the polynomial in which only one secret bit of the key appears, and many of the non-secret bits. Using chosen (or lucky) plaintexts, vary all but one of the non-secret bits, and sum the output bits (mod 2, that is, XOR). Fix the other non-secret bit to 1. Now all the terms that involve less than the full complement of non-secret bits will appear an even number of times in the sum, and because it is mod 2, they will all cancel out! The only terms that will be left are the ones with one secret bit, and all ones for the non-secret bits... but that is linear in the secret bit! So what you are left with is a simple, linear, polynomial relating unknown (key) bits. Gather enough such equations, just a few more than the number of key bits will do, and solve the linear system in trivial time. Note that you had to have 2^(d-2) chosen plaintexts to sum over for each of the equations... that's where the complexity comes from. The attack is called Cube because in the case where d=4, each time you sum over all of the varying known bits, it can be visualized as the face of a cube, the corners of which are the possibilities for the 3 known inputs.
Hope that helps. Note that the formula I typed from memory for the complexity was wrong... it's O(n * 2^(d-2)), if the above is correct.
For anything more than this, you'll have to wait for the paper.

@_date: 2008-08-21 06:55:06
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
Yes, the program chair and committee did a great job. Whatsisname? Oh, yeah, David Wagner.

@_date: 2008-08-21 11:08:06
@_author: Greg Rose 
@_subject: "Cube" cryptanalysis? 
Yes, of course Adi is correct, but I blame you for reading what I wrote and not what I meant... :-)
Adi mentioned that the slides and paper will go online around the deadline for Eurocrypt submission; it will all become much clearer than my wounded explanations then.
thanks and regards,
(cc:ed back to the crypto list)

@_date: 2008-08-27 09:34:15
@_author: Greg Rose 
@_subject: Decimal encryption 
G'day Philipp,
There is a fairly standard technique for handling things like this.
1. encode your number N into a 133-bit string S
2. encrypt S with your favourite 133-bit block cipher (see below)
3. decode S to a number N'
4. if N' >= 10^40, goto 2 (that is, re-encrypt until it is in range)
5. N' is your answer.
This is uniquely invertible, although a little slow (since on average it will take 8.9% or so more encryptions because of the inner loop, and some side-channel information leaks when it does the extra encryptions. Decryption is exactly the same operation except step 2 uses decryption mode of the block cipher.
So, you don't have a 133-bit block cipher lying around? No worries, I'll sell you one ;-). Actually that is easy too. Take a trustworthy 128-bit block cipher like AES. To encrypt, do:
1. Encrypt the first 128 bits (ECB mode)
2. Encrypt the last 128 bits (also ECB mode).
To decrypt, do decryptions in the reverse order, obviously. It's easy to see that this is a secure permutation if AES itself is, depending on your definition of secure; if you add a third step, to re-encrypt the first 128 bits, it is truly secure. (Without the third step, tweaking a bit in the first 5 bits will often leave the last 5 unchanged on decryption, which is clearly a distinguishing attack; the third encryption makes it an all-or-nothing transform.)
I believe the above gives you a secure enough block cipher on 40 digit strings, and if you only ever encrypt single chunks, ECB mode should be fine... of course that depends on the real threat analysis of your system. It does about 2.19 AES encryptions per 40 digits, should be fast hope that helps,

@_date: 2008-08-27 14:27:00
@_author: Greg Rose 
@_subject: Decimal encryption 
Yes, I guess it is... hadn't thought of it that way. But yes, I confirm that I meant to do the encryptions in place.
It's a degenerate case of Rivest's All-or-nothing transform (which applies to larger, multi-block blocks, if you know what I mean :-) ). I believe he gave a security proof, some 6ish years ago. But I could be

@_date: 2008-08-28 15:04:48
@_author: Greg Rose 
@_subject: Decimal encryption 
One of the earlier messages (I lost it) said that Philipp said that there was information that could be used as a nonce. In that case, I would recommend a stream cipher used to generate 133 bits at a time; if the lump of bits represents an integer in the correct range, add it modulo 10^40... otherwise generate more bits. This is about as simple as it gets.

@_date: 2008-06-29 12:07:40
@_author: Greg Rose 
@_subject: Using a MAC in addition to symmetric encryption 
One of my favourite papers, by Steve Bellovin, is at It shows a number of ways in which IPsec with encryption but no integrity can fail.
The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC). We describe a number of attacks against various versions of these protocols, including confidentiality failures and authentication failures. The implications of these attacks are troubling for the utility of this entire effort.

@_date: 2008-05-22 10:28:25
@_author: Greg Rose 
@_subject: Bletchley Park museum in financial trouble 
There is a mechanism whereby US donors can send tax deductible donations to the trust. Go to  and search for the Codes and Ciphers Heritage Trust. I helped them rebuild Colossus a couple of years ago, and have just donated some more (thanks, Perry). Note, though, minimum donation is $500.

@_date: 2009-04-30 19:54:43
@_author: Greg Rose 
@_subject: SHA-1 collisions now at 2^{52}? 
It already wasn't theoretical... if you know what I mean. The writing  has been on the wall since Wang's attacks four years ago.
BTW, it is my (our) opinion that the current attacks can't be extended  to the SHA-2 family, due to the avalanche effect in the data  expansion, which is significantly different to the designs of its  ancestors. SHA-2 would need a new breakthrough.

@_date: 2009-08-19 14:46:10
@_author: Greg Rose 
@_subject: Crypto '09 rump session summary? 
Target collisions for MD5 can be calculated in seconds on a laptop,  based on just a small change in the first block of input. There was  also a semi-successful demo of MD5 certificate problems; you could  join the special wireless network, and any https connection would be  silently proxied using the fake CA certificate generated a few months  ago. (You had to set your clock back to 2004, though, since the CA  certificate was intentionally generated to be long expired).
The SHA-1 attack complexity of 2^52 was a correct improvement to an  incorrect result. Don't currently have an accurate estimate; IIUC it's  bounded above by 2^56.
The related-key attacks on AES have been extended to AES-192, and also  to some sort of non-standard AES-128, but it wasn't clear to me what  it was that they did. AES-128 as standardized is still (and likely to  remain) safe.
The National Museum of Computing (at Bletchley Park in England) is  doing interesting stuff, but is still starved for cash. There is a  501(c)3 you can donate to for tax deductibility and corporate  matching, if people want to donate.
Don't run algorithms on secret data in the cloud; it's not too  difficult for an attacker to get themselves assigned to the same  machine and use timing/cache attacks to recover your keys.
(At that point I was tired and inebriated and left.)

@_date: 2009-08-19 21:02:39
@_author: Greg Rose 
@_subject: Certainty 
Not directly, as far as I know. But some research and success on  preimages, yes.
They aren't particularly related, but there was a presentation at  Eurocrypt about MD5 preimages earlier this year. Or maybe it was MD4...

@_date: 2009-10-20 14:45:34
@_author: Greg Rose 
@_subject: Possibly questionable security decisions in DNS root management 
Ah, but this doesn't solve the problem; a compliant implementation  would be deterministic and free of covert channels, but you can't  reveal enough information to convince someone *else* that the  implementation is compliant (short of using zero-knowledge proofs,  let's not go there). So a hardware nubbin could still leak information.

@_date: 2010-07-09 11:02:33
@_author: Greg Rose 
@_subject: Question w.r.t. AES-CBC IV 
Unfortunately I can't remember the author, but there was a paper  showing that an encrypted counter was secure to use as IVs for CBC  mode. So encrypting a shorter random IV should also be secure.

@_date: 2010-09-27 18:26:08
@_author: Rose, Greg 
@_subject: Certificate-stealing Trojan 
Ah, the irony of a trojan stealing something that, because of lack of PKI, is essentially useless anyway...
100 years from now they'll be blaming the trojan for lack of a certificate infrastructure.
