
@_date: 2013-11-05 20:48:49
@_author: Paul Wouters 
@_subject: [Cryptography] DNSSEC = completely unnecessary? 
I've answered Moxie (and others) on this before:
ExecSum: you cannot avoid trust, making it hierarchical gives the least
trust to parties. You monitor those you have to trust more, more
That's a nonsense argument. Abuse of such powers, unlike the plethora of
CA certs, would need to be world visible, that is untargetted. It would
be very very visible. It is a huge win over CAcerts that can target
individuals with specifically crafted signed certs.
With dnssec, if the Government of Canada causes my nohats.ca to be
modified (appear red on your above map), then my domain's public
information changes. I would notice that. This is not an invisible
MITM like some CA cert injection.
Which ever organisation you pick for the initial "name and crypto key
lookup" has that power. What you must do is track and monitor, so ensure
that power is not abused.
It's very easy to say "trust no one". But if you want to talk to people,
you need to place trust in some. All replacements I have seen of
DNS(SEC) just move the problem elsewhere.
You want to have a hierarchical trust pyramid. You can monitor, and even
safeguard by picking some parts on the pyramic you trust more than the
top (root). This both scales and keeps the trust needed to be
given to a minimum. The higher in the hierarchy a trust organisation is,
the less targetted violation of trust they can do. Moving down, trust is
only handed down to entities that can only betray themselves, not
Any kind of "harvest and vouch" or "public ledger" solution is going to
be riddled with false positives, due to the delay between
publisher/owner of the data and the trustee/ledger updating itself.
Plus you don't even _know_ which parties it is that you are given
trust to when accessing "N of M" entities to determine truth.

@_date: 2013-11-06 17:02:10
@_author: Paul Wouters 
@_subject: [Cryptography] DNSSEC = completely unnecessary? 
I could send my DNS queries over tor or over an IPsec VPN to some resolver.
You are asuming my DNS goes out my network port in a way you can read
it and with private key of the root or TLD sent me custom answers.

@_date: 2013-11-21 22:18:56
@_author: Paul Wouters 
@_subject: [Cryptography] Cryptolocker 
I'm confused.
If the files are encrypted with a symmetric key, that key should still
be on the server and can be used to decrypt everything? It would make
more sense to encrypt it using the public key received, so nothing on
the infected machine could decrypt the data?

@_date: 2013-09-07 15:21:02
@_author: Paul Wouters 
@_subject: [Cryptography] Opening Discussion: Speculation on "BULLRUN" 
Yes that was the original intent, but I remember the reason for optin
was that it was impossible to realisticly fit the .com zone in the RAM
of modern servers at the time. Also signing would have taken much longer
to generate all the NSEC(3) records.
In general, the TLDs preferred a phased-in deployment where they could
exchange hardware over time. That is what optin offered, at the expense
of making spoofing just a tiny bit harder instead of much harder for
non-DNSSEC domains. Seems like a normal economical based decision to me.
These days, I don't think anyone should still run with opt-in anymore.
About as many as we have cryptography and cypherpunks mailing lists :P

@_date: 2013-09-08 23:36:05
@_author: Paul Wouters 
@_subject: [Cryptography] "Is DNSSEC is really the right solution?" [djb 
That is the most unprofessional talk I've seen djb give. He bluffed a
bunch of fanboys with no knowledge of DNSSEC that it was bad. His claims
about caching, amplification, etc were completely wrong, as Kaminsky and I
spend pointing out in the days after that CCC talk.
He seems to mostly egage in DNSSEC bashing to advertise his curve25519,
dnscurve and his "curve25519 the entire internet" ideas.
The easiest number to debunk was the DNS cache hit rate. The day after
his talk I collected statistics from the CCC event itself, A large Dutch
ISP and one of the largest American ISPs, and the numbers were above 80%
at minimum and close to 99% for the dns cache at the CCC itself.
His suggestion to pollute port 53 with non-DNS traffic, and to kill DNS
data authentication and replace it with transport-only security have
always been rejected by the community at large as insane. His proposal
to DDOS all DNS servers by making them perform crypto isn't very
realistic for deployments either.
DNSSEC is the result of a lot of fundamental design goals such as "100%
backwards compatibility", data authenticity, offline crypto signing,
crypto agility, not bypassing the cache infrastructure, etc etc.
Do I trust curve25519 more then the NIST curves? Yes I do. Do I think
djb should design internet protocols. No.
DNSSEC is a very secure and reasonable compromise for all the
requirements various parties had to secure the DNS. If you believe that
is not the case, please speak out with verifiable technical arguments,
and not with video hype. And I'll gladly take the time to explain

@_date: 2013-09-10 23:01:27
@_author: Paul Wouters 
@_subject: [Cryptography] History and implementation status of Opportunistic 
History and implementation status of Opportunistic Encryption for IPsec
NOTE:	On September 28, there is be a memorial service in Ann Arbour
 	for Hugh Daniel, manager of the old IPsec FreeS/WAN Project.
 	Various crypto people will attend, including a bunch of us
 	from freeswan. Hugh would have loved nothing better than his
 	memorial service being used as a focal point to talk about
 	"new OE", so that's what we will do on Saturday and Sunday.
 	If you are interested in attending, feel free to contact me.
In light of the NSA achievements, a few people asked about the FreeS/WAN
IPsec OE efforts and whatever happened to it.
The short answer is, we failed and got distracted. The long answer follows
below. At the end I will talk about the current plans that have lingered in
the last two years to revive this initiative. Below I will use the word "we" a
lot. Its meaning changes based on the context as various communities touched,
merged, intersected and drifted apart.
OE in a nutshell
For those not familiar with IPsec OE as per FreeS/WAN implementation. When
activated, a host would install a blocking policy for 0.0.0.0/0. Every
packet to an IP address would trigger the kernel to hold the packet and
signal the IKE daemon to go find an IPsec policy for that destination. If
found, the tunnel would be build, and an IPsec tunnel to the remote IP
would be established, and packets would flow. If no policy was found,
a "pass" hole was poked so packets would go out unencrypted. Public
keys for IP addresses were looked up in the reverse DNS by the IKE
daemon based on the destination address. To help with roaming clients
(roadwarriors), initiators could store their public key in their FQDN,
and convey their FQDN as ID when performing IKE so the remote peer could
look up their public key in the forward DNS. This came at the price of
two dynamic clients not being able to do OE to each other. (turns out
they couldn't anyway, because of NAT)
What were the reasons for failing to encrypt the internet with OE IPsec
(in no particular order)
1) Fragmentation of IPsec kernel stacks
In part due to the early history of FreeS/WAN combined with the export
restrictions at the time. Instead of spending more time on IKE and key
management for large scale enduser IPsec, we ended up wasting a lot of
time fixing the FreeS/WAN KLIPS IPsec stack module for each Linux release.
Another IPsec stack, which we dubbed XFRM/NETKEY appeared around 2.6.9 and
was backported to 2.4.x. It was terribly incomplete and severely broken.
With KLIPS not being within the kernel tree, it was never taken into
account.  XFRM/NETKEY remained totally unsuitable for OE for a decade.
XFRM/NETKEY now has almost all functionality needed - I found out today
it shoudl finally have first+last packet caching for dynamic tunnels,
which are essential for OE. Since the application's first packet triggered
the IKE mechanism, the application would start retransmitting before IKE
was completed.  Even when the tunnel finally came up, the application
was usually still waiting on that TCP retransmit.  David McCullough and
I still spend a lot of time fixing up KLIPS to work with the current
Linux kernel. Look at ipsec_kversion.h just to see what a nightmare
it has been to support Linux 2.0 to 2.6 (libreswan removed support for
anything lower then recent 2.4.x kernels)
Linux IPsec Crypto hardware acceleration in practise is only possible
with KLIPS + OCF, as the mainstraim async crypto is lacking in hardware
driver support. If you want to build OE into people's router/modem/setup
box, this is important, though admittingly less so as time has moved on
and even embedded hardware and phones are multicore or have special crypto
CPU instructions.
An effort to make the kernel the sole provider of crypto algorithms that
everyone could use also failed, and the idea was abandoned when CPU crypto
instructions appeared directly accessable from userland.
2) US citizens could not contribute code or patches to FreeS/WAN
This was John Gilmore's policy to ensure the software remained free for
US citizens. If no US citizen touched the code, it would be immune to any
presidential National Security Letter. I believe this was actually the
main reason for KLIPS not going in mainstream kernel, although personal
egos of kernel people seemed to have played a role here as well. Freeswan
people really tried had in 2000/2001 to hook KLIPS into the kernel
just the way the kernel people wanted. (Ironically, the XFRM/NETKEY
hook so bad, it even confuses tcpdump and with it every sysadmin trying
to see whether or not their traffic is encrypted) I still don't fully
understand why it was never merged, as the code was GPL, and it should
have just been merged in, even against John's wishes. Someone would
have stepped in as maintainer - after all the initial brunt of the work
had been done and we had a functional IPsec stack.
In the summer of 2003, I talked to John and together we agreed it was
time to fork. Openswan was born to clearly indicate US coders could
contribute. However, at that point the (then crappy) XFRM/NETKEY IPsec
stack was there to prevent OE from working due to the missing first+last
packet caching. The FreeS/WAN Project ended and Openswan continued. At
first in good pace, but that later slowed down and OE was no longer its
focal point.  (Due to legal reasons, I cannot go into details regarding
the openswan history)
3) Not using DNS without DNSSEC
There were various issues that caused DNSSEC to get massively delayed.
We needed DNSSEC to secure our DNS based distributed public key
platform. Although it would have worked fine to use DNS against passive
attackers (NSA trawling), we believed it was principly wrong to trust
cryptographic material that was untrusted and vulnerable against active
attacks. So while the developers encouraged people to put keys in DNS
even without security, no one else picked it up. It sucks to need to say
'we told you so'. But we should have really not waited on DNSSEC.
3) Dealing with the DNS working groups at IETF
The DNS community is one of the most pedantic group of people I know. They
are very smart, often right, and had been known to be extremely defense
of their DNS turf. (Note that things have improved considerably and if you
think this is still an issue, I'm happy to try and help)
IETF was divided about the convergence of the "security of the DNS"
and the "DNS as PKI" despite that this had always been a goal of DNSSEC
for a large group of people within the IETF. The FreeS/WAN people were
driving DNSSEC not so much for DNS as for the key distribution. After all,
you can detect DNS forging if you know your public keys.
When we had the KEY/SIG records ready to go, it was decreed that it
could only be used for the DNS itself. Applications could not use this
KEY record. To make that distinction more clear, on the next change in
the draft protocol, KEY was obsoleted and DNSKEY introduced.  So IPsec
keys were relegated back to TXT, since at the time we had no Generic
Record format (RFC 3597) support, so waiting for any new RRtype to get
any deployment to become usuable would take years. Almost everyone was on
bind4 and never upgraded left us with no other choice but the TXT. Even
though we wrote the OE and IPSECKEY RFCs, OE's only deployments were
done using TXT records.
4) DNSSEC was delayed by a decade
DNSSEC deployment was slowly gaining traction, but I think we really
needed the Kaminsky bug to get that extra push for DNSSEC outside the geeks
of the IETF. The US government mandate for DNSSEC in .GOV helped as well. But by this time, OE was mostly forgotten.
djb repeatedly tried to peddle his own warez. While not at all realistic,
it always gained a lot of hype and media attention and probably did
cause delays of DNSSEC deployment.
Kaminsky himself was shooting down DNSSEC too. I personally heckled
him at various Black Hat's and ICANN conferences until we finally sat
down for a couple of hours to talk about DNSSEC's history and design
goals. I'll claim my 15 minutes of fame for having converted him. It
helped having Kaminsky say that although he didn't like the complexity,
he couldn't see anything better. DNSSEC was needed for everyone.
DNSSEC was gaining traction.  Then we ran into a bunch of DNSSEC
deployment issues. We had the delays due to NSEC vs NSEC3 with OPTIN,
and then on top of that in 2008 when the first big ISP in Sweden
turned on DNSSEC in their resolvers all that traction was blown away.
Most consumer routers ran DNS proxies that implemented DNS as "known
bitstreams" instead of implemeting the actual DNS protocol. The DNSSEC
OK bit caused thousands of routers to drop DNSSEC packets as "invalid
DNS". The only realistic solution: Turn it off and wait two years for
those routers to get obsoleted by faster wifi standards and talk to those
vendors so they would not repeat their mistake with their next generation
of routers.
We now have the IPSECKEY record format (though RFC 4025 is not useful,
see below) and RFC 3597 for the generic DNS record deployed on all DNS
servers. And we're on our way to have DNSSEC on every end node (see
also draft-wouters-edns-tcp-chain-query-00 I just submitted to the IETF)
We have a mostly clean working UDP/TCP port 53 transport for DNSSEC
on most networks (in part thanks to Google DNS). Although our hotspot
handling is still a little rough, with dnssec-trigger the only tool
to hack configurable DNSSEC support into the OS for our coffee shop
visits when we need to rely on forged DNS.
4) When you're NAT on the net, you're NOT on the net.
Opportunistic Encryption relied on a clear peer to peer connection. But
we managed to degrade the internet into servers and clients. NAT was the
biggest problem, and with CGN around the corner, it's not something that
is going away despite IPv6 offering enough IPs for everyone. In fact,
for our "new OE", this is the biggest hurdle to overcome. When Alice
cannot talk to Bob because she cannot reach him due to a (carrier grade)
NAT, we are stuck wildly poking holes and hoping packets flow.
5) The reverse DNS tree is dead Jim
OE depended on the reverse tree as a security mechanism that someone
who was claiming a public key for a specific IP range was actually the
legitimate owner of that IP space. It was the security method for RFC-4025.
But unless you are running in a datacenter, you do not have access to
the reverse DNS. It is useless as key distribtion method. On top of that,
large IPv6 deployments don't even care any more to run any authoritative
DNS for their reverse.
6) BTNS
The IETF tried to revive this OE with the Better Then Nothing Security
("BTNS") working group. Contrary to the name, they also fell into the
"perfect is the enemy of good" trap and most discussion seemed to go into
"channel binding" to upgrade anonymous IPsec to some kind of authenticated
IPsec - at least by the time I became aware of them. In other words,
the most important problem of key distribution was left outside the scope
and no one actually seemed to have implemented anything. Though I have to
admit, I'm behind on reading the VPN auto-discovery drafts. It is just
very discouraging to still be reading problem statement drafts. More
over, I don't think we should setup IPsec tunnels based on packets
hitting the kernel. We have better ways now that we can leverage DNSSEC.
7) We were all complacent
The only interest for IPsec was for corporate VPNs. During the
above listed problem periods, OE people gave up. Some walked away
from IETF. While everyone gained an always-on portable IP device,
their crypto capabilities were practically non-existent. My current
iphone 5 can connect to a corporate VPN, but trying to make it _just_
send out encrypted packets is impossible. Some trickery can be used to
cause almost any packet to setup the VPN, but while that's going on it
is still leaking like a sieve. VPN is seen by phone vendors as a method
to gain some enterprise users, not as the tool to protect the consumer.
The Apple VPN client is a 10+ year old patched version of racoon. The
only vendor that took VPNs seriously was RIM and we punished them by not
buying their products, because we had other priorities like FourSquare,
Facebook and Twitter.
We can only hope that those PRISM players are now put under economic
pressure by frightened consumers to fix this. But as long as VPNs and
DNSSEC is slow and error-prone, it is better for them not to go there.
The New Opportunistic Encryption
I've been brainstorming with various people on how to put IPsec OE back on
the table. I've discussed this with a bunch of people around me, including
the late Hugh Daniel, John Gilmore and Hugh Redelmeier of freeswan.
The packet capturing 0.0.0.0/0 policy is not a good method because
we cannot make any decision on where to find a public key for an IP
address. The reverse is unusable, and IP addresses change often. We used
it because we had nothing better. But now we do. Since every (secure)
platform now runs DNSSEC on the end node, we can use this as our decision
making point. Imagine my phone running a DNSSEC resolver (say unbound)
and an IKE daemon (say libreswan). The DNS server has access to the set
of DNS name and matching IP address. It can lookup the key in the forward
DNS zone, and hand over the public key, dns name and IP address to the IKE
1) User tells browser to go to 2) browser does a lookup for the A/AAAA record of 3) DNSSEC resolver performs the lookup/validation for the A/AAAA record of
     and additionally looks up the IPSECKEY record of
    4a) The resolver will wait with returning the A/AAAA record to the browser
     until it knows if the IPSECKEY record exists or not. If not, it releases
     the A/AAA answer to the application. Packets flow in the clear.
4b) The resolver finds an IPSECKEY record. It sends the pubic key, the FQDN
     and the IP address(es) to the IKE daemon and waits for a response.
     Meanwhile it does _not_ release the A/AAAA record to the application.
5) The IKE daemon sets up the IPsec tunnel. We haven't reached agreement
    yet over how this should be done. There are two choices:
    a) The client uses an " ID for itself along with sending its
    public key inline with IKE. The client is responsible for ensuring there is
    no MITM attack, as it knows the server's public key (from DNSSEC). The
    responding server will just use any key it received inline if it was received
    for the " ID.
    b) The initiator (aka client) uses its own FQDN-based ID. It has
    preconfigured its DNS so that an IPSECKEY record exists for its FQDN
    (protected by DNSSEC). The key is not send inline with IKE. Instead,
    when the responder (aka server) sees the non-anonymous ID, it will perform
    a DNSSEC secured lookup to obtain the IPSECKEY out of band. Both parties
    confirm there is no MITM.
    The advantage of a) is that it leaks less user information and makes tracking
    users harder. The client can regularly generate another anonymous keypair.
    The disadvantage of a) is that it turns peers into clients and servers. And
    two clients cannot initiate OE to each other.
6) The tunnel is established and the IKE daemon notifies the local DNSSEC server
    that had instructed it to setup the IPsec tunnel.
7) The resolver releases the IP address to the application.
8) The applications starts sending packets and the IPsec policy encrypts them al.
I'm personally in favour of the  solution. But there is no reason why support
for both could not be implemented.
What are some of the obstacles and work to do:
1) writing the unbound plugin 2) writing the support for  for the server-side.
    This includes raw keys for IKEv2
    (
3) With NAT, the client suggests an inner-IP. This could be abused or clash,
    We need to 'contain' each connection, possibly using generated ipv6
    addresses 4) We cannot use the "gateway" field of RFC-4025, or people
    could trick a server into giving a client all communication to a certain
    IP address that does not belong to them
5) anonymous connections should generate throw-away keys to remain anonymous
6) implement draft-wouters-edns-tcp-chain or else latency/RTTs will prevent
    real-life deployment of DNSSEC validated IPSECKEYs on mobile devices.
7) This allows no upgrading from anonymous to mutually authenticated, but IKE
    policies can be added to the server/client that would match on different IDs
    (eg X.509) that work independantly of OE without introducing complicated
    channel binding promotion code. Other IKEv2 extensions could possible be
    applied to facilitate promitions.
I'm sure more implementation issues will show up once we get this going,
but there are no real fundamental issues why we cannot deploy this in
a couple of months of time. My plan is to get libreswan to support this
version of OE. Additionally, once we use draft-wouters-edns-tcp-chain,
it becomes cheap to do these lookups through the tor network. If the
tor exit nodes then also feed each other with DNSSEC cache material,
it should make tracing individual clients even harder.
(anyone willing to assist, especially with coding, do contact me)

@_date: 2013-09-12 20:28:56
@_author: Paul Wouters 
@_subject: [Cryptography] [cryptography] very little is missing for 
This is exactly why BTNS went nowhere. People are trying to combine
anonymous IPsec with authenticated IPsec. Years dead-locked in channel
binding and channel upgrades. That's why I gave up on BTNS. See also
the last bit of my earlier post regarding Opportunistic Encryption.
We can use IDs to identify "anonymous" and sandbox these connections. If
you want authenticated IPsec, use a different loaded policy that has
nothing to do with OE IPsec. In libreswan terms:
conn anonymous
 	right=yourip
 	rightid=
 	rightrsasigkey=0xAQ[....]
 	left=%any
 	leftid=
 	leftrsasigkey=%fromike
conn admin
 	[all your normal X.509 authentication stuff]
Merging these into one, is exactly why we got transport mode,
authenticated header,IKEv2 narrowing and a bunch of BTNS drafts no
one uses.
Stop making crypto harder!

@_date: 2014-04-02 18:57:01
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec is worse than unusable (Re: TLS/DTLS Use 
Trivial to add as a netlink library function in libnl if people cared
about it.
Various methods for tracking overlapping IPs are available in the kernel
stacks. KLIPS has SAref tracking, NETKEY/XFRM has sec_path.
We'll see. Writing security into every application hasn't been that
great of a success either.
Great success there too. ssh doesn't even have rollover support without
DNSSEC. And a single RST packet kills the connection. I'll take IPsec
to protect that raw TCP stuff.
TLS, well. sheesh. GnuTLS, openssl, apple bug. It seems a great
way to ensure all your applications suffer from the same security holes.
No it's not.
If you'd write the draft, you'd encounter the disagreements. Perhaps
that would help you personally see your opinion is rather simplistic and

@_date: 2014-04-07 22:49:57
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec is worse than unusable (Re: TLS/DTLS Use 
After today, perhaps people will appreciate out-of-band (IKE) key
exchange a little more :P

@_date: 2014-04-18 22:46:11
@_author: Paul Wouters 
@_subject: [Cryptography] Apple and OpenSSL 
"If your app depends on OpenSSL, you should compile OpenSSL yourself and
 	statically link a known version of OpenSSL into your app. This use of
 	OpenSSL is possible on both OS X and iOS. However, unless you are trying
 	to maintain source compatibility with an existing open source project,
 	you should generally use a different API."
Clearly Apple had user's security interest in mind when they stated that :P
Also how can the writer confirm app developers must staticly link in
openssl and say in the title "Apple dodged the heartbleed bullet".

@_date: 2014-08-11 10:30:33
@_author: Paul Wouters 
@_subject: [Cryptography] The role of the IETF in security of the 
the net?
If that was consensus ignored, then the cryptography lists themselves are one
consensus posting after the other :)
You are clearly confusing loud groupies with consensus.....
The IETF/CRFG process caught the mistake of dragonfly. So isn't this a
success story? The IETF/IRTF is one the most open organisation I've ever
worked with. It allows the enemies to join in, but collectively we have
the best chance of defeating any cryptography attacks against our open
proposals. Once you start filtering people based on affiliation, where
does it end? NSA? USG? Russia? China? Israel? Cisco? Huawei? Checkpoint?
How about former NSA people like Roger Dingledine, Dave Aitel or Snowden?
I completely fail to see your "clear consensus".
If you start to exclude everyone that disagrees with your opinion,
you'll end up with an empty group to make decisions. Of course, that
group of one will make the perfect decisions for _your_ world.
I mean, the "crypto community" can't even form a consensus on a single
mailing list to use, so I'm not very tempted to suggest IETF change
towards this crypto-anarchist model :)

@_date: 2014-12-24 14:04:43
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
that does not provide any proof for a parent stealing an entry from your
example.com. IN NS ns1.yournameserver.com.
example.com. IN DS 1234 8 2  IN A 1.2.3.4
While it does make sense to log DS, CDS and DNSKEYs, the real problem
lies in the fact that you don't "own" your domain and your parents
take-over is "legitimate" even if you don't agree with that. The log
can only log, the clients/monitors however have some really hard
decisions to make to distinguish domain ownership change versus hostile
Additionally, DNS is supposed to work in a split-world, which will
trigger false positives to the logs unless you can inform the logs
of such split-view.
Spamming can actually be simply reduced by refusing any DNSKEY/DS/CDS
that has an RRSIG lifetime shorter than about 1 day. Possibly also
rate limit the number of new delegations from any zone in time to
a reasonable maximum.
As I said, the A record hostile take over above is the real problem. We
don't want to start logging every DNS entry. But we would also not want
to track labels vs zone cuts. I'm not sure yet what the solution should

@_date: 2014-12-25 13:54:06
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
But that is easier spotted with a change od DS/DNSKEY. No need to
remember A records etc.
In a way it is. False positives destroy the reliability of the system.
Like Certpatrol.
But the folks parents' could do this without their knowledge or consent.
The TLSA direct delegation beyond the zonecut is the same problem as the
A record. And I do agree monitoring for A record changes makes no sense
and one should stick to public mey monitoring (DNSKEY/DS/TLSA etc)

@_date: 2014-12-25 13:58:33
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
certpatrol has proven this scheme is not good enough. The problem of
gathering information without confirmation from the "true source"
means you're in a race condition that is guaranteed to give false
positives. When I change my A/TSLA record, for a litle while the
world does not know it is legit or not.
That's what makes certpatrol completely useless.
This is a biased example. You already determined who the "real owner"
is. When someone takes cypherpunks.ca how can you tell if the new owner
isn't really the new owner? also the "news sites and advertise" doesn't
scale at all and has the same false positives problem. Users will turn
this off as fast as certpatrol.
client certificates are bad for anonymity.

@_date: 2014-12-27 12:22:21
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
As someone told me offline, qname minimalization actually solves this
That discussion has started, but the WG first wants to focus on the core
documents and complete those before moving into the other areas such as
DNSSEC and binary blob transparency.

@_date: 2014-12-27 12:25:24
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
You are confusing "opoprtunistic encryption" with "anonymous
encryption". If it is opportunistic, it does not mean that there was no
authentication. It just means it was not a pre-configured trust.
And regardless, encrypting the plaintext is not worse even in the
absense of authentication, as long as you don't mislead the enduser
about the security status.

@_date: 2014-12-27 15:05:13
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
The term OE originates from The FreeS/WAN Project of which I was a
Freeswan did not allow un-authenticated encryption. In fact it required
mutual authentication, which is one of the reasons it was too hard to
The IETF actually avoided defining the term OE and instead settled for
the term OS ("Opportunistic Security"):
I was (and still am) a very active opponent for using that particular
definition, which discussion you can find back in the IETF SAAG working
group archives.
See also People mean different things when they say OE, which is one reason to
stop using the term. Unfortunately, OS in my opinion just makes it
So I have about 20 years of experience with the term and its

@_date: 2014-12-28 14:42:19
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
edns-query-chain and persistent TCP connections to resolvers.
That is a continued concern for every system publishing something :/

@_date: 2014-12-29 22:20:25
@_author: Paul Wouters 
@_subject: [Cryptography] Certificates and PKI 
That would be wrong. For instance, for fedoraproject I am planning to
host _openpgpkey.fedoraproject.org as a separate zone, while not
everyone might do that.

@_date: 2014-07-18 15:47:43
@_author: Paul Wouters 
@_subject: [Cryptography] The role of the IETF in security of the 
the net?
They are not. Anyone can submit a draft to IETF. That does not mean
anything. Rest assured, I've talked to enough people to know that
no "trusted proxy" protocol change will happen.
If you fear one is being sneaked in somehow, contact me one or the
Security Area Directors at IETF.

@_date: 2014-11-14 17:11:27
@_author: Paul Wouters 
@_subject: [Cryptography] ISPs caught in STARTTLS downgrade attacks 
Disagree. Publish a openpgpkey/smimekey in DNS(SEC) and use it for
transport security. On your own receiving email server, decrypt and
store. You keep all the benefits. For super important stuff, use another
key which only lives on your offline machine, with key in a vault or
whatever you do.

@_date: 2014-11-14 17:37:52
@_author: Paul Wouters 
@_subject: [Cryptography] ISPs caught in STARTTLS downgrade attacks 
If you trust your mail provider enough to publish your key, there are
ways of discovering this per user:
There are a few implementations that already use this draft. There is
also one for smime:
I wish people stopped repeating red herrings.
First, there is a huge difference in using 1024 bit RSA keys for your
zone for 30 days and key strength for ensuring things cannot be
decrypted for 50 years. Second, no one needs to use 1024 bit keys. For
the software I maintain (opendnssec in Fedora and RHEL), the default
is 2048 bit RSA keys. Using ECC now is unwise because it is still having
a 25% validation failure rate. The world still needs to upgrade their
DNS servers.
If you are concerned about the root zone ZSK being 1024, and you think
that zone is broken, than you can configure additional TLD trust
anchors, eg the one for .org or .ca or .com. It is similar to cert
pinning. However, we are also working in the IETF to get transparency
logs for DNSSEC, so even if a parental key gets abused to sidestep your
zone with super strength key algo and size, you will find out you were
targetted. See None of these are alternatives for a personally verified strong openpgp
key. And all of these are better than plaintext. It raises the attack
from passive to active to active with a guarantee your attack will be
noticed. There is no reason not to do this. And anyone saying this
system is worse than their current plaintext solution should work on
solutions instead of living with their failure.
Seriously, the crypto community has too many cry babies and not enough
implementors. I'd be happy if someone designs and implements something
that's better. Please obsolete me.

@_date: 2014-09-16 10:40:09
@_author: Paul Wouters 
@_subject: [Cryptography] RFC possible changes for Linux random device 
so if you had all zeroes, now you have something that looks random but
is totally non-random? Why would you do that?

@_date: 2014-09-16 12:08:15
@_author: Paul Wouters 
@_subject: [Cryptography] RFC possible changes for Linux random device 
Then why do the AES operation on all zero's then, if it will not
get used anyway?

@_date: 2014-09-27 18:31:51
@_author: Paul Wouters 
@_subject: [Cryptography] The Trouble with Certificate Transparency 
That's why clients reporting a cert change to the TLS server is a very
useful tool. Once you are no longer MITM'ed and see a different cert,
you inform the legitimate owner that something bad happened. So it
becomes obvious to everyone without needing to monitor "1000s of logs",
because the owners will automatically collect rogue certs for
For important domains (defined by the user, for example by "having been
there once before") it can simply insist on rejecting every cert change
that has not been validated by a handful of indepedant logs. That is,
without a proper prepublishing period, you will not accept the new
certificate regardles of signatures of log entries. That prevents MITM
attacks completely for sites visited before. An OS or browser could also
prefetch the top 1000 domains daily, which would prevent fingerprinting
and will preload your OS.
CT is an infrastructure for security. Like all security, you need to
use it with the right tools.

@_date: 2015-04-27 17:05:30
@_author: Paul Wouters 
@_subject: [Cryptography] NSA releases 52, 
Done. Anyone can get these using: wget -r -np ftp://nohats.ca/nsa-friedman/ There is also a CHECKSUMS.txt.asc
ftp logs are deleted monthly.
[*] not that I think my IPs aren't on the very very long pervasive
     monitoring shortlist :)

@_date: 2015-12-22 12:34:45
@_author: Paul Wouters 
@_subject: [Cryptography] Juniper & Dual_EC_DRBG 
There is  but it
still does not explain how changing that constant would allow passive

@_date: 2015-12-23 00:37:50
@_author: Paul Wouters 
@_subject: [Cryptography] Juniper & Dual_EC_DRBG 
Another option is that the NSA originally did use some SHA1 and it was
not a backdoor, but they then figured out the same issue with Dual_EC_DRBG
(or found out from us) and decided they could actually get a backdoor.
Then they told Netscreen to put in those values.
Yet another option is that the NSA indeed backdoored Dual_EC_DRBG, but
figured out their adversaries could actually calculate their backdoor
key independantly, and since they use netscreen themselves, they wanted
a non-backdoor version.
Which could be a plausabile deniability to cover up a plain backdoor,
or a mole at netscreen to disable the 3DES defense to activate the
I don't follow your cause and effect here :P Also, it is pretty
obvious that no one who runs juniper themselves wants this ssh
password backdoor active. So I strongly doubt the NSA did that
or told juniper to do that.
That was not a bug, but a design choice, motivated by unknown to us
reasons (but surely not speed because it is slow and it also supposedly
used 3DES which is also slow)
It is interesting to see what will come out of juniper on this one. But
I would like to see a confirmation that this is actually happening.

@_date: 2015-12-23 22:16:03
@_author: Paul Wouters 
@_subject: [Cryptography] Juniper & Dual_EC_DRBG 
Also the firmware changes do not seem to indicate such a large change?
The disabling of the 3DES round seems to suggest it leaks whenever
random is used for anything. But most items are protected within IKE.
So yes, that seems the biggest and most likely candidate.

@_date: 2015-02-01 21:11:35
@_author: Paul Wouters 
@_subject: [Cryptography] best practices considered bad term 
Actually, we might think they can, but we have no proof as
far as I know. If you know more, I would be very interested.
We know that they take copies of all IKE traffic for their backend
processing and we know that they have an API that you can ask for
PSKs for a certain IKE peer. We don't know how they would have gained
those PSKs. I can think of three things:
1) They obtain(ed) the PSK via router compromise (so nothing to do with IKE,
    or aggressive mode or PSK specifically)
2) Peers might use modp768 which is too weak (possible modp1024 being
    weak too but that would cost a lot for a very low return - better
    to attack long term 1024 bit keys instead of ephemeral DH sessions
    that last between 1-8 hours)
3) They observed the unencrypted ID of Aggressive Mode, and running a
    brute force on the PSK against one or both peers. This would be pretty
    visible in the logs of both peers if the PSK is not "test" or "secret".
Note that for 3) you could do MITM against IKEv2 or IKEv1 Main Mode as
well to obtain the ID - your IKE session will fail but you'll get some
ID out of it when it is presented to you. Possibly also a sha1 of the CA
DN. So this is also not _really_ Aggressive Mode specific _unless_ the
attacker does not want to perform an active attack.
1) and 2) also have nothing to do specifically with IKE version of
Aggressive Mode (other than that IKEv2 would surely not allow modp768)

@_date: 2015-02-19 17:59:17
@_author: Paul Wouters 
@_subject: [Cryptography] Lenovo laptops with preloaded adware and an evil 
It's a jquery plugin with the same name as the malware ?

@_date: 2015-01-04 22:50:15
@_author: Paul Wouters 
@_subject: [Cryptography] 
No. Sane implementations of IPsec/IKE have always ensured a better
policy. This is usually based on longest prefix match first. This is
what KLIPS (from freeswan to libreswan) has always done, and what
freeswan to libreswan has emulated for NETKEY/XFRM to do. Additionally,
libreswan allows a manual override (priority=) and has a group of very
low priorities reserved for opportunistic encryption, so that
opportunistic will always be picked only if no staticly configured IPsec
tunnel matches first. If you have multiple policies, you have to create
some kind of automatic or manual order. That is not at all specific to
IPsec. Of course, building it into your applications (and thereby
increasing the complexity and exposure of all your applications with
crypto code) hasn't really worked so well with SSL/TLS either :P
Or compare that with the security model of openvpn where the servers can
suck random routes out of your system :P
This is like talking about the security and safely of the plane, and
then saying it's all weak and failure because the airport allows
terrorists to board :P Don't blame Airbus for airport security.
IPsec protects the transport. If you decide to use that secure transport
to build really dumb policies (like 0.0.0.0/0 GRE tunnels) then I cannot
help you other than pointing out your house of cards. You might have
build some privacy, but you definitely did not build something secure.
Sysadmins who build "routing based VPNs", where the policy is "allow all
to all" and the routes determine what you throw over the VPN are lazy
and not doing their job. And it's 90% of the big IPsec vendor's customer
base, so they had to make these unsafe features. Don't blame the
protocol, blame the admins.
Of course you already configured an EGRESS filtering right? So you never
have accidental packet leaks? Which helps against the above AND all
other rogue stupid routing hacks and compromises you have on your
internal network aimed at your outgoing links.
If you split tunnel is to RFC1918 space, again proper EGRESS should be a
fail safe. If you have a VPN to a public range, you should ensure that
range is added to your EGRESS filters if it is supposed to go over the
Yes, and everyone who owns a swiss army knife has managed to cut
themselves, and therefor these knives are bad and should be avoided at
all cost? You got a knife with 20 features - if you want to ensure you
don't cut yourself when using the knife as a screwdriver, get a
While I'll admit that our tools could be better, I find these examples
to be extremely poor. It mixes up enterprise networking (where admins
are supposed to have clue) with enduser laptops (where users should not
need any clue).
There any many things wrong with IKE/IPsec, and if I did not have to
care about stupid decade old (and recent) certification nonsense, I
would be the first to strip out a lot of crap that the design by
committee caused. Unfortunately that would just mean people cannot use
our IKE/IPsec software. So please if you want to improve IKE/IPsec, tell
the certification people to update their stupid checkboxes.
Meanwhile, we have to ship a swiss army knife with 20 functions, and
you are like the young boy sucking his thumb because he cut himself on
his new swiss army knife :P

@_date: 2015-07-09 17:13:52
@_author: Paul Wouters 
@_subject: [Cryptography] Caspar Bowden has died 
Caspar was instrumental to achieving privacy and fighting the
surveillance state. His achievements speak for themselves.
Personally, when I met him about 15 years ago when he was at FIPR,
he was an inspiration to me to keep working on privacy and ubiguous
encryption. That the fight for privacy is much bigger than a few crypto
geeks coding in their basement. He inspired and motivated me to keep
doing my little bits in the grand scheme of things.

@_date: 2015-03-25 22:51:22
@_author: Paul Wouters 
@_subject: [Cryptography] Certificate transparency on blockchains 
Note: I am the IETF co-chair of the trans working group responsible for CT. You can read
up on the drafts at: By calling it "Google CT", it purposefully ignores the fact that this
is an IETF standard: RFC 6962.
 	CA/log combos can use hidden Merkle trees to hide certificate
 	issuance, even in a world where CT is mandatory for all CAs. The CT spec
 	allows only one SCT to accompany a certificate, making  this attack
 	feasible. If clients require SCTs from more than one log, the likelihood
 	of this attack can be reduced.
Second, the 6962bis work explicitly includes a gossip protocol to
address this. Some even envision all browsers to be gossipers (although
some fear that leaks too much brower history). Regardless, there will
be very many logs/auditors/gossipers. So this is pretty much a red
herring. A first draft was presented last Monday at IETF 92 in Dallas:
 	Domain owners either have to put their trust in the CA they?ve
 	to correctly monitor all logs 24/7 for fraudulent issuance, or
 	have to monitor all logs themselves (something they are extremely
 	to do).
This is also incorrect. See page 6 of the presentation that Daniel Kahn
Gillmor gave at trans:
You can see that web clients, when detecting a new SCT or Certificate
will exchange this with the website. This means that the domain owner
receives reports automatically of all rogue certficates once the
web client is no longer under attack and connects to the legitimate
I did not read the blog post further as for why their solution is
better, mostly because I personally (no hats) do not believe in
protocols depending on bulk CPU power and heating up the world.

@_date: 2015-03-28 12:55:57
@_author: paul@cypherpunks.ca 
@_subject: [Cryptography] 
Not google's gossip protocol. This is an effort by the IETF. The
current authors are Linus Nordberg and Daniel Gillmor but a working
group adoption call will follow soon, upon where this becomes an IETF
trans working effort.
Yes, Google authors are playing an important part in this, and yes they
are contributing greatly on the RFC6962bis effort but so did Cisco on
IPv6 and we don't call that a Cisco protocol either.

@_date: 2015-10-17 01:08:00
@_author: Paul Wouters 
@_subject: [Cryptography] Fwd: freedom-to-tinker.com: How is NSA breaking 
Their measurement of 66% of VPNs are using weak DH is also based on a
wrong assumption of NO_PROPOSAL_CHOSEN. I did a write up on that:
Ah while the IPsec traffic was far less then TLS, it was actually far
more interesting. So I don't really agree with you here. Of course, now
everyone is using IKE/IPsec to watch netflix, which must piss of the NSA
more than it pisses of the Content Industry :)
ps. this is probably the nicest thing Peter has ever said about IKE/IPsec :)

@_date: 2015-09-15 16:22:17
@_author: Paul Wouters 
@_subject: [Cryptography] [cryptography] JYA and Cryptome Keys Compromised 
by unknown key.
Revocation could have been done by the person who stole the keys too.
That in itself is not good enough.
Which I cannot find on either pgp.mit.edu or pgp.surfnet.nl. I did find
them on keyserver.pgp.com, but I don't know who runs it and with the
additional captcha software, no idea if that is compromised :P
It is announced using short keyids, not to be trusted, and no finger
prints although we can get those from the key used to sign this message
I guess.
$ gpg --list-sigs D87D436C
pub   4096R/D87D436C 2015-09-15
uid                  John Young 15-0915 sig      N   D87D436C 2015-09-15  John Young 15-0915 sig          CA57AD7C 2015-09-15  [User ID not found]
sub   4096R/79F82F3B 2015-09-15
sig          D87D436C 2015-09-15  John Young 15-0915 $ gpg --list-sigs 8CD47BD5
pub   4096R/8CD47BD5 2015-09-15
uid                  Cryptome 15-0915 sig      N   8CD47BD5 2015-09-15  Cryptome 15-0915 sig          CA57AD7C 2015-09-15  [User ID not found]
sub   4096R/27BCF5FB 2015-09-15
sig          8CD47BD5 2015-09-15  Cryptome 15-0915 The keys are both announced but not signed by each other?
I fetched CA57AD7C which has 6863 signatures on it. It seems to be some
PGP global directory key, signed by a few people I know, but still seems
to be only proof that it came from the keyserver, not that the key
actually belongs to you.
But is that first key signed by the old keys? (which of course could
also have been done by the attacker, so you need to re-start a web
of trust with some of your personal confidants.
from an unknown key - with no direct signatures of any known trustable
key run by a human.

@_date: 2015-09-29 15:51:57
@_author: Paul Wouters 
@_subject: [Cryptography] Future GPG/PGP 
The openpgp group has been re-opened and an updated RFC is being
worked on.
excerpt from the charter:
 	This incarnation of the working group is chartered to primarily produce
 	a revision of RFC4880 to address issues that have been identified by the
 	community since the working group was originally closed.
 	These revisions will include, but are not limited to:
 	- Potential inclusion of elliptic curves recommended by the Crypto Forum
 	  Research Group (CFRG) (see note below)
 	- A symmetric encryption mechanism that offers modern message integrity
 	  protection (e.g. AEAD)
 	- Revision of mandatory-to-implement algorithm selection and deprecation
 	  of weak algorithms
 	- An updated public-key fingerprint mechanism
 	  The Working Group will perform the following work:
 	- Revise RFC4880
 	- Other work related to OpenPGP may be entertained by the working group
 	  as long as it does not interfere with the completion of the RFC4880
 	  revision.

@_date: 2016-04-26 14:27:29
@_author: Paul Wouters 
@_subject: [Cryptography] Darpa wants a secure messaging app based on 
So I guess it cannot be based on publicly verifiable cryptography then,
because then the backdoor would be impossible. Guess they can just go
back to using Skipjack :P

@_date: 2016-02-29 18:11:21
@_author: Paul Wouters 
@_subject: [Cryptography] 9999 keys for this one iPhone 
============================== START ==============================
It's definitely more than 10 even if you include fractions :)

@_date: 2016-01-19 00:13:05
@_author: Paul Wouters 
@_subject: [Cryptography] OpenSSL minimal "safe" configuration? 
RSA should not be disabled, only DSS. And yes, I had similar issues
where the ssh client went from doing dss keys to not doing dss keys
without any kind of warning for me to upgrade my keys, thereby locking
me out of several boxes (since I don't allow password authentication)
until I added this to my .ssh/config file:
 	Host *
 	PubkeyAcceptedKeyTypes=+ssh-dss
So that at least I could generate a new RSA key and update all my
machines. openssh should have really had a few versions where they
gave a clear warning about disabling this key in the future.
I'll leave that to Viktor to explain :)

@_date: 2016-11-26 15:00:22
@_author: Paul Wouters 
@_subject: [Cryptography] Security of Ubuntu RNG pollinate? 
It seems a rather weird solution. And with TLS 1.3 moving to ephemeral
keys with PFS, you need some randomness too before you can to HTTPS.
It seems that using something like haveged (man haveged) or
jitterentropy-rngd ( seems a simpler
solution that only relies on the host and or guest virtual hardware.
I'm not sure why Ubuntu thought these existing methods were not good
enough? I'm also worried that Ubuntu installs that generate SSH keys
are now dependant on a remote entropy server run by Ubuntu.

@_date: 2018-12-05 14:11:55
@_author: Paul Wouters 
@_subject: [Cryptography] What if Responsible Encryption Back-Doors Were 
A long long time ago I published the Transport of Intercepted IP Traffic (TIIT),
since then a publicly published document at ETSI :P
Basically, X.509 CA's issuing signed XML warrants to feed into your monitoring black box.
 	HI1 is concerned only with the administrative protocol involved with
 	LI.  This is used to handle communications between Provider and LEA
 	concerning interceptions. E.g. warrants will be issued through this
 	channel, extension and termination of LI will also be communicated
 	through HI1. Secure communication SHALL be used to transport relevant
 	documents. Which type of secure communication is used depends on the
 	LEA requesting the LI. It is typically an offline communication channel.
The "SHALL" (not MUST) is interesting. I guess they want to email the
xml files :)

@_date: 2018-10-06 23:11:05
@_author: Paul Wouters 
@_subject: [Cryptography] IKE/ISAKMP/IPsec complexity by design 
Almost all IKEv2 deployments do now. Those specifically use a certificate
on the gateway, and an EAP based user/password sceme on the client side.
IKEv1 did not allow asymmetric authentication, so indeed people just
used PSK because running a CA is too hard and expensive. But now all
all those people with VPN services on their phone (which almost always
use IKEv2 now) are not vulnerable to this.
It takes time for enterprises to catch up, I agree. And IKEv2 has
existed for over a decade, so doubly sad.
The protocol has been able to do X.509 plus user/password using IKEv1
XAUTH for like 20 years. If you want to point fingers at who is to blame
for PSK rollouts everywhere, blame the X.509 people and openssl usage. It
is still a giant investment in time and money to get an enterprise
CA going, and there is no good reason for that. It is the same reason
people didn't do SSL per default until ACME came along and automated it
(ok, money also mattered there)

@_date: 2018-09-04 11:24:44
@_author: Paul Wouters 
@_subject: [Cryptography] WireGuard 
No it does not. I quested Leonard Tan about this at ICANN 60:
 	PAUL:  Paul, IETF.  Let's say IETF gets the domains "ietf" in this
 	naming system and we pay our fees for a couple of years.  Everybody
 	uses the site.  And then at some point we forget to pay and the
 	domain falls back into the pool and somebody else registers it and we
 	don't know where they are or who they are.  Now I go to a court
 	system.  I get some legal opinion saying I own this trademark and now
 	I want to get this domain back.  Is there any way for me to get this
 	domain back?
 	LEONARD TAN:  So right now, the ens industry, you can change it
 	because it requires four out of seven people.  most of them are
 	ethereum developers.  And it is a consensus of them to make any
 	changes.  So it is possible, but it is going to be a very difficult
 	thing to do.
In other words, namecoin / ENS gets you nothing. You just end up in
yet another legal system or combined legal system or worse, just have
to provide some incentives to 4 out of 7 pseudo-random people, each
with their own human problems opening them up to bribery, blackmail or
coercion of some kind (threaten with jail, loss of job/health care or
just whack their knee caps)
And of course, if a system comes up that _really_ does not have this
override, then I just rephrase the above question with "I lost my private
key, how can I recover my domain worth millions" and they answer will be
"it is lost forever".
I love it when libertarian engineers think they can exist outside any
legal framework. Forget it, there will always be a mapping between
unmemorable numbers and names. The best you can do is limit the damage
anyone can do in an hierarchy spanning different juristictions
worldwide. Make yourself memorable in .com, .ru .cn .rs .is.
ps. See also:

@_date: 2018-09-04 22:47:29
@_author: Paul Wouters 
@_subject: [Cryptography] WireGuard 
Still, 5 years from now you are juggling two versions, and 10 years from
now three versions. Similarly, we went from cbc to gcm to whatever is
next and you'll want people using that and be compatible.
It's easy to start from scratch with very few options. But politics and
backwards compatibility and tweaks to harden or support some corner use
case will sneak in again.
My biggest issues with WireGuard is that they didn't sit down and
thought about how to best replace IPsec. They thought only about the
remote access VPN use case, put something together that mostly dictates
parameters out-of-band and then claiming how much better/faster/stronger
they are compared to IPsec. But IKE/IPsec offers much more then just a
Remote Access VPN. I suspect they will see over the next 10 years that
if the expand beyond the simple remote access use case, that they need
to -add their own warts to support these. There is a reason we have ESP
and AH, tunnel mode and transport mode, IPCOMP, MOBIKE, various user
authentication methods, various NOTIFICATION payloads, etc etc. I'd love
if that would all go away, but it won't unless either I or someone else
is being prevented their IPsec use case.
And there has been a lot of misinformation. WireGuard first claimed
to be much faster then IPsec until I showed them their claims were
wrong and they adjusted it to 5% faster (which is believable because
they don't support tunnel vs transport mode so have a few less bytes to
encrypt). They still complain that IKE/IPsec is "noisy" and that was based
on their complete misunderstanding of the DPD/liveness protocol in IKE,
in addition to not having the real world experience of NAT routers and
their protoport mapping bugs you need to work around. etc etc. Advising
people on a Mac to run a Linux VM just to get WireGuard as your VPN
service is not a sane thing to advise.
People forget that neither the IKE or ESP protocols have been broken
(unlike TLS). SLOTH came close but random SPI's saved it. It's just cool
these days to hate IPsec. But it is still an excellent work horse.
That said, yes I look forward to killing AH and IPCOMP and nested
transforms and IKEv1 and heck, I'd even drop PSK support because people
refuse to use strong random PSKs. It would be a large cut of code.
Anyway, I wish them luck in making and keeping a simple and strong
remote access VPN implementation, and urge them to be friendlier in
their community so as to not end up as loved as the systemd crowd :)

@_date: 2018-09-05 15:32:05
@_author: Paul Wouters 
@_subject: [Cryptography] WireGuard 
Yes, they use them.
You are very wrong. IPsec was already in massive use before openvpn,
before anyconnect, and before all Windows/Mac products moved to
IKEv2/IPsec, and even more so now those products have.
Google is the only vendor betting it all on TLS and neglecting Android's
VPN capabilities. All modern Windows, Mac, Iphones etc, all use IKEv2
with IPsec (if they aren't still running old/oudated openvpn)
 with cheap routers).
While TLS for single service containers is a good strategy, deployment
of entire VMs, clouds, etc is happening with IPsec using the Geneve
Also SDWAN is deploying IPsec (with or without IKE).
Everyone is making products that use virtual networks to move containers
and hosts through cloud or container providers that use IPsec.  Then we
have existing standards like DMVPN (aka FlexVPN) that is based on IKEv2 +
IPsec. And we have MPLS being replaced or wrapped in IPsec due to NSA's
"remove SSL here ;)"
And lets talk about all the VPN services that offer IPsec to protect
phones (hotspot shield, symantec vpn (formerly surfeasy), etc) that use
IPsec (even if it is mostly to bypass geo-strictions and not really for
security or privacy). Hundred thousands are connected using IPsec at
any time (which was very visible recently due to DNSSEC query for
trust anchors landing at the root nameservers, so it could be counted)
IoT is another huge deployment where we are seeing IPsec can be tweaked
for low power, low traffic usage with the ESP modifications for implicit
IV and diet ESP. This will be a standard feature of sensors etc.
IPsec has never seen more deployment than right now (even excluding
the netflix users). You can even trace this in the amount of interest /
participation in the IETF IPsecME working group.
So the idea that IPsec is dying is hopeful thinking at best :)
There has been a need to break out of administrative barriers and broken
networks, which a typical IETF protocol does not attempt by design. That
was the sole reason for SSL-VPNs coming into existence. That is now
dying because IKEv2/IPsec supports this now via RFC 8229 which is being
implemented for Linux as we speak.
You seem to be moving in very different echo chammbers compared to me :)

@_date: 2018-09-07 10:38:38
@_author: Paul Wouters 
@_subject: [Cryptography] WireGuard 
The perceived difficulty of IKE/IPsec is interesting, as it is mostly
A few months ago I visited NetDev, to show Linux kernel developers how
easy it is to setup an IPsec VPN. You can find the slides here:
A host to host VPN takes two slides to explain how to configure (slide 10-11)
A net to net VPN takes one more additional slide (slide 16)
A Remote Access VPN takes 3 slides as well (slide 19-21)
For those that still think this is too hard, there are scripts to
automate this for you and to generate server configs and client
profiles (for OSX/iOS)
(algo even supports WireGuard if you prefer that :)
For GSoC 2018, libreswan worked on making it even easier
to setup a Remote Access VPN by adding an admin gui. This
code is being finished up and should be ready very soon.
Then you can browse to your admin page, setup the server with some simple
questions, and send invite emails to your users to obtain VPN credentials
and client configurations over HTTPS.
If you think IKE/IPsec is too difficult to configure, you are going to
have a really hard time with IPv6. From a developer point of view, sure
there are (too) many smart and tricky knobs. But from an admin/user
point of view, all VPNs have roughly the same complexity. Usually in
the form of "how on earth do you generate proper X509 certificates".
Anyway, before the moderators poke me for being off-topic, I'll stop
posting in this thread. Feel free to contact me offlist with questions
on IPsec though.

@_date: 2018-09-18 14:06:32
@_author: Paul Wouters 
@_subject: [Cryptography] IKE/ISAKMP/IPsec complexity by design 
That's pretty silly. The same could be done for any DNS server, DHCP
server, BGP server, WWW server, TLS server... etc In fact, the TLS
options in apache are way more convoluted then IKE options :P
Do you have written text or anything that would confirm that? I am pretty
sure NSA/USG wanted and needed IPsec as well. While I know the author
in question has links to NSA (like most of the TLS hotshots have too!),
I am not convinced the "complexity" was intented to weaken, rather
intended to let NSA/USG have their required (defensive) use cases. Also,
keep in mind the difference between WireGuard and ESP with AES_GCM isn't
that great, because both protocols need to do basically the same thing.
Note that unlike TLS, the ESP and IKE protocols have had no protocol
breakage. So while everyone is free to complain about the complexity of
code involved, you can't argue that the designed-by-committe IKE/IPsec
protocols are insecure. They haven't been broken in 25 years.
I'd love to see references of this. I mean the Crypto War I was ugly,
and the attempt to force US citizens to not export strong crypto was
foolish and futile, I can see how events of those days were more
related to those political battles rather then some specific IKE/IPsec
And the best we can ever do, is use technical arguments to defend or
reject proposed changes to security items in our drafts and RFCs. For
example, I did ask for the reasoning behind DH22, DH23, DH24, and when
former IPsec WG chairs and the author you mention as having a 4 letter
name on RFC 5114 defining these groups could not come up with sound
technical arguments for these groups or present any origin of magic
numbers involved, we killed these groups in software and in protocol
with RFC 8247. So yes, I welcome the participations of the Five Eyes,
Russia and China in designing international crypto protocols at the same
time as I trust neither of them.
Your critique would be weak. A simpler yet still overly complicated
protocol like TLS has now been broken like 3 times or more. Not to
mention it has only seen serious PFS deployment for just a few meagre
years, whereas IKE/IPsec has done PFS for decades. IKE/IPsec might be
an old work horse, but it is _still_ getting the job done securely.
It has seen 20+ years of people trying to attack it, and the only
attacks to date have been to compromise the endpoint or for proprietary
vendors to screw up (and/or intensionally backdoor( their default random
number generations.

@_date: 2019-12-10 19:35:56
@_author: Paul Wouters 
@_subject: [Cryptography] "[CVE-2019-14899] Inferring and hijacking 
Note that I do not believe Linux IPsec using XFRM is affected, as it
does not depend on routing and when an IPsec policy is installed,
plaintext of that policy is dropped by the XFRM hooks, independent
of routing or rp_filter settings. I plan to do some more testing
over the next week or so.
We do have Traffic Flow Confidentiality support (tfc=1500 to pad to
max MTU or tfc=200 if you just want to mask these smaller packets
without more overhead).
That is still not good enough for all cases though, which
is why IETF is looking at the following draft for IPsec:
introducion slides: There are still some cases where it matters though. Imagine you are
watching a movie. Do you really want the traffic from client to server
to use up as much bandwidth as server to client to hide the fact that
you are mostly downloading? That would put a tremendous additional load
on the servers that have to receive all this "padding traffic" only to
drop it. Or do you want an idle ssh session to keep generating traffic
as if you are there?
Just filling up the blocksize is what TFC does, and it does not work
well. It still doesn't really pad a stream to hide the number of
packets, only the size. ESP/IPsec allows dummy packets but no one
sends those. The new iptfs proposal can combine / cut packets and
get better perfomance compared to stupidly adding full bogus packets.
Thoughts & Prayers for those :)

@_date: 2019-02-20 22:50:27
@_author: Paul Wouters 
@_subject: [Cryptography] A seemingly simple question ... 
TLS for netflows, IPsec for IP flows.
Check the previous iteration of the wireguard discussion. For raw public
key authentication, I showed both configs have 8 lines of basically
the same information, using the same ciphers.
Everything is so nice when you can claim version 0.x is not supported
and should not be used. And you have no backwards compatibility, or
defined RFC standard with multiple implementations and people
allowing and optimising for many different use cases.
But sure, it is 2019 and you go ahead and hard code IP addresses in your
wireguard configuration for each VPN client :P

@_date: 2019-01-22 10:38:19
@_author: Paul Wouters 
@_subject: [Cryptography] Implementing full Internet IPv6 end-to-end 
Note that IPsec supports asymmetric null authentication, which we use
for Opportunistic IPsec. So in that case, the client authenticates the
server (eg based on letsencrypt or DNSSEC or otherwise) and the server
does not authenticate the client. The client remains anonymous at the
IP layer, similar to how TLS works.
The problem is that a shared secret between strangers doesn't help me
identifying you from a crowd of strangers. We all have to publish
some kind of pseudo identity that others need to be able to verify.
Sure, now you might have prevented _our_ connection from a MITM, but how
do I know you are not the MITM ? Who are you? Who am I? Which two
parties are trying to communicate? How do you identify these parties
and how do they identify each other?
If you can answer that, you can answer how to obtain a public key of
that identity. Be it via DNS FQDN, CAs, blockchain publications, or
an ad in the New York Times.
So here, you only accomplish confidentiality to _a_ stranger. But you
have no idea which stranger.
What does that public key contain as identifying reference? an email
address? a Slack handle? A SSN?

@_date: 2019-01-24 12:02:56
@_author: Paul Wouters 
@_subject: [Cryptography] Implementing full Internet IPv6 end-to-end 
You miss the point. Talking with confidentiality to an IP address means nothing.
Using null-authentication with any protocol accomplishes the same. You
left out how binding that IP address to a psuedo identity would work.
If I talk with confidentiality with 2600::c900:9106:adca:dc36 then who
am I talking to? You ? Your server? Your phone? The NSA?
Besides that, anyone who controls some of the BGP tables or routing
can be an instance of 2600::c900:9106:adca:dc36 passing identification
of your crypto scheme. So I don't even know if I am talking to the "real"
2600::c900:9106:adca:dc36. And if you meant the IPv6 as a "shared
secret" then we have better methods like PAKE to go from a weak shared
secret we exchange at a party, to a strong secret we can use to
authenticate a private channel.
In other words, your proposal is the equivalent to any kind of
DiffieHellman key exchange. Now you have confidentiality, you need
to authenticate the other party.

@_date: 2019-05-29 11:10:59
@_author: Paul Wouters 
@_subject: [Cryptography] Craig Steven Wright's Bitcoin Copyright 5-20-2019 
I wanted to mention him here in a reply and call him out for his
fraudulent claims, but I forgot his name, so I googled "email inventor
fraud" and the first hit, presented in a nice "prime hit box" is
 	Fake email inventor
 	Ayyadurai makes the controversial claim to be the "inventor of email".
 	His claim is based on the software he wrote as a 14-year-old student at
 	Livingston High School (New Jersey). In 1979some sources say 1978he
 	wrote an implementation of an interoffice email system, which he called
 	EMAIL.
So yeah, he can go and add me as a defender if he wants and reads this
message. Shiva Ayyadurai fraudulently claims he invented email.

@_date: 2020-08-28 12:18:41
@_author: Paul Wouters 
@_subject: [Cryptography] any reviews of flowcrypt PGP for gmail? 
The solution is two apps. One with Stickers and Emoji and the kitchen
sink, and one with just the secure messaging core. If I was further in
my retirement phase, I might have taken on the work to try and publish
a stripped down version of Signal[*]
[*] If you have a funding source, I can do it sooner :)

@_date: 2020-01-12 23:23:07
@_author: Paul Wouters 
@_subject: [Cryptography] improved identification of non-targets 
You are forgetting the airlines that should be shot down.  How to
identify the difference between the two?  The only difference is which
humans are operating them. I don't think you can fix this by adding a
technical box to the system.

@_date: 2020-07-06 21:58:45
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
I thought this was done to prevent malicious or weak DH parameters. And that the
server was not expected to be able to determine the security of received
variable DH parameters in real time? And I thought TLS did this too?
That was way before my time ..... But I got the impression that at least
half of this was self-inflicted by the other IETF participants. And the
infosec community is still doing  this do itself all the time.
If that is so bad, why did WireGuard use this design too then?
Or is there is a mixup here of terms here (ICV, IV, Nonce, AEAD
components, grrr)
And if it makes you feel better, once I investigated the history and
lack of justification of RFC 5114, which Steve Kent admitted to having
just forwarded from NSA/BNN to IETF without explanation, I pushed to
kill the whole thing. It's now dead.
Even in my time, early wireless days, this was used a lot. Some
people didn't have the hardware to encrypt. And they had to sort
of trust the microwave was directional enough to be safe against
amateut eavesdropping. Also because AH was more often firewalled than
ESP. But I know of zero instances where someone accidentally negotiated
esp=null. Every implementation would require hardcoding that. Unless you
are referring to ESP without AH, which was kicked out a long time ago and
ESP changed to have AH builtin. It's just that raccoon/setkey refused to
die for so long ang ESP+AH was still needed. But while freeswan supported
it, openswan already dropped support in like 2003 or so.
Downgrade what?  IKEv1 was foolish to allow paylaods that were not
verified by crypto, such as the Vendor IDs. That meant we could not
build in an easy IKEv2 to IKEv1 downgrade protection. But then again,
only openswan/libreswan ever implemented connections that could be
either. Eeveryone else just froze their IKEv1 stack and made you
configure which protocol version to use. So also no downgrade
IKE/IPsec is missing the force of only having three important vendors
like browsers have. So we can't obsolete things as fast as we would
like. I still get complaints libreswan refuses DH group 2 (and DH group
5 in IKEv2).
I'd love to read those. If you have googlable strings or URLs for me, please let
me know.
Yet still, all the TLS protocol attaks like logjam, beast lucky13,
poodle, crime, none of them worked against IKE/IPsec. From a protcol
level, IKE and ESP have never been broken. The only thing that was "too
weak and shouldn't be used" was PSK with Aggressive Mode. And even there,
when using real PSKs you are safe. It is just that humans never muster
up the responsibility to do that. We are waiting on CFRG now to decide
on the PAKE's and hope to be able to phase out most PSK for PAKE. The
only other NSA attacks I know against IKE/IPsec were all based on
vulnerable firmware compromise, and then stealing credentials and
sessions keys.
I feel very much that things went:
SSL -> IKEv1 -> TLS 1.[012] -> IKEv2 -> TLS 1.3
I guess with QUIC and HTTP/3 it is kinda merging even more.
And now IKEv2 is up for a round of cleanup dumping old stuff, which
I've actively done with RFC 8247, 8221 and the current ikev1-graveyard
IKEv2 has its horrors too, don't get me wrong. Whoever in the IPsec
WG thought that EAP-TLS over IKE using 8 RTT was a good idea was crazy.
The whole Traffic Selector narrowing idea is super smart but in practise
just not really used much beyond their trivial cases and adds a lot of
As I said, I have never seen an actual protocol attack against IKE or
ESP. I'd love to see one.
Anyway, just the opinions of an cargo cult member :)

@_date: 2020-07-06 22:21:54
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws (fwd) 
Steve's exact words:
It's  been over 8 years since this RFC was published, and I have not looked at it since then. My recollection is that we wrote 5114 because an IPsec developer approached me and said that he wanted to support
these groups in a product. He said that he wanted test vectors for the groups, consistent with what we have done for many other algs. I persuaded Matt to generate the RFC because it was a relatively easy
task a good way for Matt to get acquainted with the RFC process.
As to your question, I have no info about how the NIST DH values were generated. However, I do agree with Yoav and Tero that it seems unduly prejudicial to declare these to be a MUST NOT. The fact that one
can generate trap-doored DH values that cannot be detected is not the same as having proof that a given set of values have been generated in that fashion. Moreover, if one interprets a MUST NOT in this
context to mean that an implementation supporting any of these groups is non-compliant, then that unfairly penalizes existing implementations, as Tero noted. Moreover, if the concern raised by the paper
(which I have read) is with MODP groups of size 1024 (or smaller), only 1 of the groups in 5114 fits that criteria (section 2.1).
I have not tracked the status of these NIST groups re evaluation criteria like FIPS 140-2. If these groups are approved for use in products evaluated under that FIPS (I don't know if they are), deprecating
them creates a possible conundrum for vendors who want to comply with RFCs and with FIPS evaluation criteria. Thus I suggest a less dramatic response than declaring all of the groups in 5114 to be MUST NOT.
I'm not a vendor of any crypto products (these days), and I've never been a crypto mathematician. So my views are based only on what I recall about the creation of 5114 and about IETF crytpo standards
practices in general.

@_date: 2020-07-07 17:22:57
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws (fwd) 
Steve Kent was and is _very_ familiar with the RFC process.
No, RFC 5114 was never widely supported, and never made it in the "defaults"
of ny IPsec implementations that I'm aware of.
If you're doing history, you should start with Windows NT SP3 NSAKEY :)
As I^W the IPsec working group wrote in RFC 8247:
    Groups 22, 23, and 24 are MODP groups with Prime Order Subgroups that
    are not safe primes.  The seeds for these groups have not been
    publicly released, resulting in reduced trust in these groups.  These
    groups were proposed as alternatives for groups 2 and 14 but never
    saw wide deployment.  It has been shown that group 22 with 1024-bit
    MODP is too weak and academia have the resources to generate
    malicious values at this size.  This has resulted in group 22 to be
    demoted to MUST NOT.  Groups 23 and 24 have been demoted to SHOULD
    NOT and are expected to be further downgraded in the near future to
    MUST NOT.  Since groups 23 and 24 have small subgroups, the checks
    specified in the first bullet point of Section 2.2 of "Additional
    Diffie-Hellman Tests for the Internet Key Exchange Protocol Version 2
    (IKEv2)" [RFC6989] MUST be done when these groups are used.
Note here that the argument against DH 23/24 was made "not in wide use"
to prevent any discussion about trustwortiness.
As for the implementation I work on (libreswan), we have disabled all
three at compile time the moment the RFC was published in 2017. In a year
or so, we will likely also remove the disabled code for it.
I personally don't care about the difference between domestic US or
otherwise, not being an American citizen. I am always amused at how
important Americans feel this difference is, because it means those
people find it acceptable that I have no privacy rights or expectations.

@_date: 2020-07-20 15:05:47
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
What were you hoping to see there? A historic status? I'm afraid a lot
more time would need to pass for the IESG to do that. But anyone can ask
them to, you don't need to write an RFC for it.
Note, when I said "It is now dead", I meant for IKE/IPsec. I don't think
TLS ever saw much use either, but I simply don't know if it is in use
there or not.

@_date: 2020-07-20 15:23:21
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
The whole point of DNSSEC was to skip the PKI middle-men. When DANE was
looking to get serious, the WebPKI people litterally invaded the small
room we had looking for the red emergency shutdown button. It is not
that DANE needed X.509/webPKI expertise. The only part of x.509 was
that webservers had to keep serving keys in x.509 containers, and all
the tools handled x.509 containers and not raw public keys. So the
DANE record just needed to say "just pull the public key, and drop the
What happend was actually exactly what people who wouldn't want everyone
to have universal cryptography got, another delay of DANE and some
proposal more complicated than needed with the messy PKIX-EE/PKIX-CA
versys DANE-EE/DANE-PKIX. I had to fight Richard Barnes of BBN to
keep a DANE type that did not (need to) trust a CA, a battle that I
had to figh tall over again with him when doing tls-dnssec-chains,
which got at least 3 years delay because they blocked it in the TLS WG.
I'd say the reverse of what you claim, actually happened.
I was not participating at IETF during this time, so I don't know, but I
do know I was the first Dutch ISP to run DNSSEC in production with 150
domains in the .nl.nl shadow tree, and the rollover issues were just
unsolved at that time. So I can see technical reasons why it was not
ready. I have no opinion or knowledge about the IAB motivation or
actions at that time though.
I'm pretty sure both you and I both feel that the two of us have  zero
chance of secretly working for goverments to prevent cryptographic
deployments to the masses.
Yet, the fact that we see the above in complete different ways, suggest
perhaps that instead of crediting NSA and GCHQ for the sabotaging our
communities, that our biggest enemy is in fact us, and not them.
Again, I wasn't there for that, but the IETF really believed IPv6 would
be there soon and NAT would die and don't develop for it. I would again
not give credit to TLA's for the simple incomptence of the IETF[1] :)
[1] I include myself in that :)

@_date: 2020-07-22 20:46:29
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
I cannot recall any issue or concern to "kick Ben Laurie out". Perhaps
more details would help, although not sure if that is still on topic for
this list.
I did not assume that. I _experienced_ a continued attempt to let WebPKI
overrule DNSSEC, thereby defeating the whole point of DNSSEC, which was
to build a trust hierarchy that does not depend on a Cab/forum Cabal and
500+ (yes we disagree on that) private keys able to sign anything
anywhere anytime.
Well duh. Without DNSSEC, you would not be obsoleted the webpki Bag of
500+ all powerful keys.
Indeed, I argued for that. And I still think it would have been best to
do so, but it was actually dropped as compromise. It would have done an
excellent job at obsoleting port 80. There is no gain in publishing
security keys when it can be made optional by an attacker.
Combining your two points is even more fatal! Publish keys without
DNSSEC, and you basically have a TLA MITM machine that's every
dicatator's dream.
Sure. People I guess realised it and came up with OPT-OUT for them.
Although for the life of me I cannot image why that isn't being moved
to Historic now and supported for it dropped. I just bought a 3rd hand
machine with 57GB of RAM and 32 CPU's for $150. There is no reason for
any real TLD to still use optout and reduce the security of the children
in their zone.
You just said the "PKI people" wanted "optional DNSSEC" and "webpki
still in the picture". We gave the webpki their "must comply to webpki
processing rules" modifiers for TLSA. May they rest in Historic soon.
The whole encrypted DNS thing has been badly handled by the IETF. Very
early on, I pointed out that you could simply do this with IPsec limited
to port 53 selectors, with the public key in an IPSECKEY record. I
demoed it. But people wanted their DNS-native solution, which at least
got rejected. Adding TLS makes less sense than IPsec to me, but fine. It
But for encrypted DNS, I wouls say the IETF was not the biggest issue.
With LetsEncrypt and browsers causing the majority of traffic to be TLS,
the only choke point for government censorship became DNS. And thus,
whatever happens with DNS will be ruled by the governments, and not the
standards bodies.
With everyone on unique (public) IP, I don't think your argument holds.
But people see NAT as a strong defense, and you can't argue against
that. Additionally, it protected ISPs from having customers run servers.
And lastly, the breaking of true end-to-end reachability, ensured
everyone's lightswitch, TV, microwave, thermostat, car, and teaspoon
cannot work without a continued service by the vendor. Free $$$$$

@_date: 2020-05-03 22:00:19
@_author: Paul Wouters 
@_subject: [Cryptography] The EFF 650 CAs lie 
Makes sense to me. If there are an unknown number of RAs and LRAs that
can trigger a CA to issue a certificate, then from the point of view of
EFF, it juts increases the amount of individuals that can cause a rogue
I think EFF's main concern was individuals and/or organisations that
could cause a certificate to be issued. Whether that is a direct CA
or another party doesn't really matter.
That only helps to clean up the mess, not to prevent it.
The main problem is that it is not hierarchical. And we need to ensure
goverment XX can control entries in their TLD XX. Regardless of whether
DNSSEC or WebPKI is technically better, the flat model of WebPKI is just
flawed. Nothing can fix the WebPKI if the USG can coerce a US company
to issue a Chinese or Russian certificate. Currenty, the only block in
this stream is Mozilla and Google and Apple - all basically under USG
sphere of coercion.
It's not. It is trivial to skip the root key and let CCTLD keys be in
configurations for their respective TLD only. It's actual a working
version of path-constraint.
But specifically for these very unlikely in practise, but possible in
theory attack of the root key, over at DNSOP at the IETF we are
currently running a call for adoption for a draft that allows a key
to announce it to be DELEGATION_ONLY, through which it cannot bypass
it's delegated children. And it allows DNSSEC Transparency to log
proof of a rogue (root) key - in which case the political system and
root zone operators could kick out the USG/ICANN/Verisign root key
for something else.
Please to send a message to DNSOP if you think this draft is a good
idea (and well, also when you think it is a bad idea)
Indeed. The EFF has now caused the reverse problem. Everyone now has to
trust them and only them. Of course, it does prove the point that since
all of domain validation happens via DNS anyway, we should just cut out
the CA middleman and do it via DNS and kick all the CAs to the curb.
Indeed. But I was shocked at LetsEncrypt original plan to kill all
these domains, and I'm glad they actually ended up violating the
CAB/Forum rules. Clearly ACME still needs some work so it can better
recover in these kind of scenario's.
But even taking one further step back. It is crazy that all this
security is ultimately decided by 4 US based broswer vendors. It
needs to be hierarchical where governments can make decisions of
trust and identity for their citizens and their organisations
independently of the US. DNS and DNSSEC is the only thing we have
that can do that.

@_date: 2020-05-29 11:49:20
@_author: Paul Wouters 
@_subject: [Cryptography] Zoom publishes draft cryptographic design for 
The problems are completely different. bitcoin is only about publishing
data everyone can always read. A group conference call is about a group
of X members sharing some private symmetric keys to encrypt video
streams, and then changing the keys when a participant is removed from
the group so they can no longer decrypt the stream. Then doing that
for a large always changing membership.
I haven't looked at the zoom spec. I'm a little sceptical because people
from OTR, Signal and MLS have been working on this problem for a long
time. Similarly, multicast support in IPsec is another instance of this
problem. It invariable has some kind of binary tree where leaves have
their own symmetric key and if someone leaves, only that lower branch
needs to be given a new crypto key. For IPsec, there is something called
group doi (RFC 5374) which is now being resurrected for IKEv2 in
It's a hard problem. I assume Zoom limits the problem set to "the leader
controls the group memberships", where as for chat protocols like OTR
and Signal, you would need some group agreement before allowing a group
change or someone could sneak in a fake user to get access to the
encrypted group chat.

@_date: 2020-11-18 10:36:18
@_author: Paul Wouters 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
But none of this benefits the user. It benefits the Advertisement Gods.
It gives _them_ more miliseconds to auction our privacy with targeted
ads while not delaying the user more so they lose interest in the web
It's really solving that we never got IPsec hooks into the application
and we couldn't trust the OS enough. A lack of signaling we are
connecting securely. And that is due to governments who didn't want
us to change the default mode of the internet to encrypted with IPsec
in IPv6 because then they couldn't monitor their citizens^Wenemies. So
now the enterprises work around this government restriction fallout. But
doing a crypto handshake for each flow is too expensive, so QUIC kinda
merges these into one. It's basically IPsecInTLSinUDP.
Proving again that the enemy is (all of) us.

@_date: 2020-11-25 00:56:07
@_author: Paul Wouters 
@_subject: [Cryptography] What happened to the E4M/TrueCrypt author 
A very long series of articles that this book is an extension of is
available at:

@_date: 2020-09-03 10:00:16
@_author: Paul Wouters 
@_subject: [Cryptography] Really good ideas, harsh reality, 
This document describes a mechanism to enhance IPsec traffic flow
    security by adding traffic flow confidentiality to encrypted IP
    encapsulated traffic.  Traffic flow confidentiality is provided by
    obscuring the size and frequency of IP traffic using a fixed-sized,
    constant-send-rate IPsec tunnel.  The solution allows for congestion
    control as well.

@_date: 2020-09-23 10:18:36
@_author: Paul Wouters 
@_subject: [Cryptography] A naming and key distribution infrastructure for 
We have millions of alice's who want to be  It can't work like
that. Look at a 12 year old who wants to get a gmail address. The good
namespace is already taken and they have to come up with weird stuff
that none of their friends can remember anyway.
I agree that you don't want an email address as unique qualifier because
people currently can't guarantee they can keep this identifier for life.
But you have a uniqueness and name mapping problem.
Again, nice for the first 100k users to get decent names. After that,
phb45986946 becomes unusable to remember, and mapping it all onto
one "squatted" pseudo TLD does not help.
you say you dont want  to not go to microsoft, but I'm not
sure about that either. I'm now letoams at twitter. Once you pull that
info, it should be able to publish that independantly later on? Even
if twitter ceases to exist. But that in itself runs into problems if
twitter deletes my account and lets someone else register it.
So, while user at FQDN is no permanent guarantee, it does have a guarantee
of uniqueness. The only global reliable one we have now. Sure, companies
and governments can take it away from you, and might force you to pick
up a new name, but the namespace is federated, so you can do that.
Sure, you can pick an unregistrable TLD like .mm-- and re-create the
uniquness there, but then you have to map it already to something else.
We can't all have memorable names in a single psudeo TLD. And I see
no guarantee that you can keep up the infrastructure for basically
guaranteeing uniqueness in a pseudo TLD either. You might run out of
money, die or get co-erced to stop running infrastructure. It could be
very de-centralized but to keep uniqness guarantee, something somewhere
has to make decisions and that CPU can be taken down. And handwashing
by saying Merckle tree or bitcoin doens't give me much confidence.
Two big problems. I see you are trying to solve them, but I'm not
convinced you have, or whether they are solvable.
