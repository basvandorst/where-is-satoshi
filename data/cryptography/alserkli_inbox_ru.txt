
@_date: 2005-08-03 10:52:29
@_author: Alexander Klimov 
@_subject: Ostiary 
For similar purpose I used to use .qmail based system: the script
started from .qmail when a message to some special address arrives,
the script checks the digital signature on the message, compare the
first line with stored counter (to avoid replay attacks) and executes
the needed command. The positive side of this technique is that it is
very simple (just few lines to code), does not need to open a port
(and so it is firewall-friendly, no need to talk with sysadmins, ...),
very unlikely to introduce security holes (qmail has quite good
records, and in my case the mail was needed anyway).

@_date: 2005-08-04 17:18:58
@_author: Alexander Klimov 
@_subject: Query about hash function capability 
Just sort all the rotations and use some known hash for the smallest.
For example, if you start with abcab you sort abcab, babca, ababc,
cabab, and bcaba, and calculate SHA1(ababc).
BTW: this rotate-and-sort technique is actually used for data
compression -- search for `Burrows-Wheeler Transform' if you are

@_date: 2005-08-12 23:18:28
@_author: Alexander Klimov 
@_subject: Number of rounds needed for perfect Feistel? 
IIRC the starting point was
 M. Luby and C. Rackoff,
 ``How to construct pseudorandom permutations from pseudorandom functions,''
 SIAM Journal on Computing, vol. 17, nb 2, pp. 373--386, April 1988.
Unfortunately, I was not able to quickly find it online, so you can
try any other paper which mentions Luby-Rackoff construction, e.g.,

@_date: 2005-08-17 17:03:46
@_author: Alexander Klimov 
@_subject: How many wrongs do you need to make a right? 
Probably, you want to save the signatures on the old lists,
but I dont see why you can not download only delta of the new revoked
certificates each day (e.g., using rsync).
Apparently it is just usual serial number: ``the military also has
revoked 10 million ... which has bloated to over 50M bytes in file
size,'' that is just 5 bytes for each entry.

@_date: 2005-12-07 13:56:33
@_author: Alexander Klimov 
@_subject: gonzo cryptography; how would you improve existing cryptosystems? 
Looks like they have fixed it: version 4.1 (2005-11-25) supports
tweakable narrow-block encryption (LRW).

@_date: 2005-12-08 16:05:00
@_author: Alexander Klimov 
@_subject: Countries that ban the use of crypto? 
This would make every computer user a criminal: default installations
of most *NIXes have openssh, Windows uses cryptography at least for
driver signatures, and in most cases there is an ssl implementation in
his browser. IANAL, but apparently there is no need to have a license
to *use* cryptography in Russia, but one does need a license to *offer*
cryptographic services ( for
            On the licensing [... 2001-07-13 ... 2001-07-20 ...]
 activity in the propagation of cipher (cryptographic) means; activity
 in the maintenance of cipher (cryptographic) means; the assignment of
 services in the region of the coding of information; development, the
 production of the cipher (cryptographic) means, protected with the
 use of cipher (cryptographic) means of information systems,
 telecommunication systems; activity in the delivery of the
 certificates of the keys of electronic digital signatures,
 registration of the owners of electronic digital signatures, the
 rendering of the services, connected with the use of electronic
 digital signatures, and the confirmation of authenticity of
 electronic digital signatures; activity in the development of the
 electronic devices, intended for secret obtaining of information, in
 the accomodations and the technical equipment (with exception of the
 case, if the activity indicated it is achieved for guaranteeing its
 own needs of legal person or individual owner); activity in the
 development and (or) to the production of the means of protection of
 classified information; activity in the technical protection of
 classified information; development, production, realization and
 acquisition for purposes of sale of the special technical equipment,
 intended for secret obtaining of information, by individual owners
 and by legal persons, that achieve owner's activity;
Arguably, this is better when the situation that everybody can sell
crypto snake oil. BTW, AFAIK, even when the *use* of crypto was banned
in Russia (it was around 1995, IIRC) there was no penalty defined.

@_date: 2005-12-12 18:15:05
@_author: Alexander Klimov 
@_subject: crypto for the average programmer 
Probably you have misunderstood it: if you do it correctly (e.g.,
use some standard method like RSAES-OAEP or even RSAES-PKCS1-v1_5)
you can send the same message to 3 (or whatever) separate users
without any bad consequences. The problem appears if you use some
non-standard method, e.g., plain RSA (c = m^e \pmod n).
This is quite simple: get some respected standard (see, e.g.,
NIST  or
PKCS ) and
implement it exactly. Interoperability is a bonus :-)

@_date: 2005-12-12 18:43:37
@_author: Alexander Klimov 
@_subject: NSA posts notice about faster, lighter crypto 
This makes me wonder how news are created -- the NSA announcement made
on 16 February 2005 becomes a news in December...
BTW, we already discussed here Suite B a couple of months ago (see,
e.g., "NSA Suite B Cryptography" thread started by Perry posted on
Thu, 13 Oct 2005 21:41:50 -0400 (EDT))

@_date: 2005-12-12 19:21:42
@_author: Alexander Klimov 
@_subject: crypto wiki -- good idea, bad idea? 
The problem is not the effort on the writer's side (it was actually
done many times in the past), the problem is the effort on the
reader's side and there is no hope to solve it unless direct to brain
information downloading is invented :-)
You can decide it for youself:

@_date: 2005-12-13 17:38:42
@_author: Alexander Klimov 
@_subject: [Clips] Hacker attacks in US linked to Chinese military: 
Sounds really convincing :-) Of course, only a military can type for
30 minutes without a single keystroke error. (I would rather guess
that this was a script.) "Left no fingerprints" is even more revealing :-)

@_date: 2005-12-15 11:35:36
@_author: Alexander Klimov 
@_subject: How security could benefit from high volume spam 
First of all, even if you receive 1000 spams a day plus a message from
your commander it does not give you much since the spams are from
random sources and the only one who sends you messages every day is
your headquarters.
OTOH, you can still use, say, yahoo mail and the only trace left in
your ISP is IP of mail.yahoo.com (of course, you should also use
one-time-mail-boxes :-). Provided that almost nobody uses email on
their home PCs (most IP black lists of spam fighters include ISP's
users and thus it is hard to send email directly anyway) all this
address logging seems pointless.
For web-browsing you can use tor. BTW, it looks like I cannot use
google thru tor anymore: the error message says that too many requests
are received from my IP (they try to stop worms which use google to
search for new victims).

@_date: 2005-12-19 19:42:10
@_author: Alexander Klimov 
@_subject: whoops (residues in a finite field) 
I guess the main reason is that the environments where these libraries
are supposed to be used are believed to be immune to the attacks
these checks are trying to prevent: the faults attacks are not
likely on a PC and especially hard to do remotely :-) OTOH, ICCs
(aka. smartcards) are quite vulnerable and usually do employ the
A fault attack does not exploit a bug, but, say, a power glitch or
It depends on what exactly you try to prevent: which information you
want to hide. For example, if you calculate RSA signature (with CRT)
on an ICC using dummy multiplications (to avoid side channel attacks)
and checks correctness only in the end, the fact that no error occurs
may suggests that the glitch was introduced during such a dummy
operation and thus it does not matter what you do if you detect an
error. OTOH if you check error on each arithmetic operation (including
the dummy one) you can just stop -- this does not give an attacker any
additional information since he might as well guess himself that the
power glitch he applied would cause a fault.
BTW, fault-based cryptanalysis is not limited to RSA with CRT (or
public key in general): block ciphers can be also vulnerable.

@_date: 2005-12-22 19:01:40
@_author: Alexander Klimov 
@_subject: RNG quality verification 
Consider an implementation which uses x = time and when
SHA1(hardcoded-string||x), SHA1(hardcoded-string||x+1), etc. as a
starting point to search for primes. Unless you know what is the
hardcoded-string you cannot tell that the random starting point was
not that random: it is very important to realize that randomness is
the property of the source and not of a string.
BTW, note that what you can see in the certificate request for an
RSA key is n and not p and q themselves.

@_date: 2005-07-14 17:16:58
@_author: Alexander Klimov 
@_subject: mother's maiden names... 
While we are very good at recognizing somebody we know on a picture,
it is in fact very hard to answer the following question: is the
person in front of you is the same person who is depicted on the
photo? AFAIR there were experiments which show that if you just get a
random photo of a person with the same race, age, and gender as you
have you have very good probability to successfully pretend that you
are the person on the picture. As a result the criminal don't really
need to change the photo to be able to pretend that he is you.

@_date: 2005-11-08 17:24:14
@_author: Alexander Klimov 
@_subject: gonzo cryptography; how would you improve existing cryptosystems? 
... or at TrueCrypt (which works on linux and windows):

@_date: 2005-11-09 11:06:08
@_author: Alexander Klimov 
@_subject: Fermat's primality test vs. Miller-Rabin 
I guess the small increase in efficiency would not be worth additional
program code.  Although the Carmichael numbers fool the Fermat test
(that is, $a^{n-1} = 1 (n)$) for *all* a, there are no such things for
the Miller-Rabin test:  for any odd composite n at least 3/4 of a's
fail the test, that is if you made m MR tests with random a's then you
are mistaken with probability at most (1/4)^m.

@_date: 2005-11-10 17:53:05
@_author: Alexander Klimov 
@_subject: Fermat's primality test vs. Miller-Rabin 
For large n the ratio s to log n is small (where n-1 = d 2^s) and s is
exactly the number of multiplication you may hope to avoid.
It is very easy to check.
561 is a Carmicael number (the smallest one), for example, for a = 2
2^560 = 1 (561) and the same for all a's coprime to 561.
Btw, 651 = 3*11*17, so don't try with a = 3 :-)
Let us now go to the RM test:  560 = 35 * 2^4 (d = 35 and s = 4), so,
e.g., for a = 2, 2^35 = 263 (that is a^d \ne 1) and
263^2 = 166, 166^2 = 67, 67^2 = 1 (that is a^{2^r d} \ne -1 \forall r
\in [0, s-1]), so RM test declares that 561 is composite and 2 is a
strong witness of this.

@_date: 2005-11-10 18:09:24
@_author: Alexander Klimov 
@_subject: Pseudorandom Number Generator in Ansi X9.17 
It is now called ANSI X9.31 Appendix A.2.4
 and yes, there is
 NIST-Recommended Random Number Generator
 Based on ANSI X9.31 Appendix A.2.4
 Using the 3-Key Triple DES and AES Algorithms
 Btw, anybody was lucky enough to cache the draft of X9.82 which was
posted on the NIST site some time ago?

@_date: 2005-11-14 10:04:20
@_author: Alexander Klimov 
@_subject: Fermat's primality test vs. Miller-Rabin 
The general consensus is that for 500-bit numbers one needs only 6 MR
tests for 2^{-80} error probability [1]:
  number of Miller-Rabin iterations for an error rate of less
  than 2^-80 for random 'b'-bit input, b >= 100 (taken from table
  4.4 in the Handbook of Applied Cryptography [Menezes, van
  Oorschot, Vanstone; CRC Press 1996]; original paper: Damgaard,
  Landrock, Pomerance: Average case error estimates for the
  strong probable prime test. -- Math. Comp. 61 (1993) 177-194)
   BN_prime_checks(b) ((b) >= 1300 ?  2 : \
                              (b) >=  850 ?  3 : \
                              (b) >=  650 ?  4 : \
                              (b) >=  550 ?  5 : \
                              (b) >=  450 ?  6 : \
                              (b) >=  400 ?  7 : \
                              (b) >=  350 ?  8 : \
                              (b) >=  300 ?  9 : \
                              (b) >=  250 ? 12 : \
                              (b) >=  200 ? 15 : \
                              (b) >=  150 ? 18 : \
                              /* b >= 100 */ 27)
and thus a single test gives ~2^{-13}.
[1]

@_date: 2005-11-20 10:54:37
@_author: Alexander Klimov 
@_subject: Haskell crypto 
It is a *purely* functional programming language.
TTBOMK the main reason why people write low-level crypto in something
other than C is for integration simplification (e.g., there is a lisp
sha1 implementation in the emacs distribution): IMO it is pointless to
write SHA in a language that ``can have properties of programs
proved,'' because test vectors are good enough, and there is no real
assurance that when you write the specification in a machine-readable
form you do not make the same mistake as in your code.
BTW, there is low-level crypto in Haskell as well:

@_date: 2005-11-30 18:36:21
@_author: Alexander Klimov 
@_subject: Encryption using password-derived keys 
IMO this is too much complicated: just generate random salt with your
PRNG and use PBKDF2(password, salt) as a session key.  Since PBKDF2 is
a (xor of) PRF outputs it is (pseudo-)random.

@_date: 2005-10-05 22:52:44
@_author: Alexander Klimov 
@_subject: Pseudonymity for tor: nym-0.1 (fwd) 
Since the problem we are trying to solve is to prevent '''automated''' [1]
vandalism, I guess the only solution is to use some Turing-test
system, for example, recognition of the number on an image. In fact,
this test only needed on the user registration form and for edit by
non-registered user.
The problem with any other more complex system (even if it works) is
that it prevents new users from becoming editors and thus it is
[1]  I guess, that non-automated vandalism is not a big problem since
     the number of watchers is higher than the number of vandals (otherwise,
     something is wrong with the system :-) and reverting to the previous
     content is not time-consuming.

@_date: 2005-10-14 21:28:51
@_author: Alexander Klimov 
@_subject: NSA Suite B Cryptography  
I guess that for common people there is no real problem with RSA in
next twenty years:
 * according to NIST [1] RSA-1024 is OK through 2010 and RSA-2048 is
   OK through 2030;
 * even now it takes only about 30 ms for an RSA-2048 decryption /
   signing on a PC [2] and the performance of mobiles is in the same
   range (~100 ms) due to dedicated coprocessors;
 * in most modern applications 256 bytes is not an issue.
Unfortunately, for Top Secret traffic they need 192-bit security that
is RSA-7680 [1] and so they want ECC *right now*.
[1] Recommendation for Key Management -- Part 1: General
    NIST Special Publication 800-57
    [2] Crypto++ 5.2.1 Benchmarks

@_date: 2005-10-16 00:41:46
@_author: Alexander Klimov 
@_subject: ECC patents? 
I have made a shallow review (comments are welcome!) of the
patents that Certicom claims are pertained to ECC implementation
and it looks like there are no real road-blocks for ECDH and
ECDSA among them. In other words, IIUC it is possible to
implement EC encryption and signing without violating any patent
(of course, the implementer must be lucky enough to avoid any
patented optimization).
BTW, it looks like OpenSSL developers share this POV: README [1]
on branch OpenSSL_0_9_8-stable which implements ECDH and ECDSA
has PATENTS section which does not say a word about ECC.
In order to make this review I located two documents [2,3] in
which Certicom lists its patents related to ECC. It is
impossible to say that nobody else has patents in this area, but
the fact that the web site of SECG [4] (which is "the first
working group anywhere that is devoted exclusively to developing
standards based on ECC") does not have claims by anybody else
can be viewed as a hint of this.
Let us now review these lists. The first of them [2] contains
the following patents:
  [As of May 26, 1999] Certicom is the owner of the following
  issued patents:
  US 4,745,568 Computational method and apparatus for finite
  field multiplication, issued May 17, 1988. This patent
  includes methods for efficient implementation of finite field
  arithmetic using a normal basis representation.
[Optimization of multiplication in GF_{2^n}]
  US 5,787,028: Multiple Bit Multiplier, issued July 28, 1998.
[Multiplication in GF_{2^{nm}}, IIUC it is of no use now due to
Weil descent attack for EC(GF_{2^k}) with composite k.]
  US 5,761,305 Key Agreement and Transport Protocol with
  Implicit Signatures, issued June 2, 1998. This patent includes
  versions of the MQV protocols.
  US 5,889,865 Key Agreement and Transport Protocol with
  Implicit Signatures, issued March 30, 1999. This patent
  includes versions of the MQV protocols.
  US 5,896,455 Key Agreement and Transport Protocol with
  Implicit Signatures, issued April 20, 1999. This patent
  includes versions of the MQV protocols.
[These three are about MQV protocol and so are unrelated to ECDH
and ECDSA.]
  Certicom has the exclusive North American license rights to
  the following issued patent:
  US 5,600,725 Digital signature method and key agreement
  method, issued Feb. 4, 1997. This patent includes the
  Nyberg-Rueppel (NR) signature method.
[Described as "pertains to PV signatures" below.]
  Certicom has patent applications that include the following:
   * Methods for efficient implementation of elliptic curve
     includes efficient methods for computing inverses.
   * Methods for point compression.
   * Methods to improve performance of private key operations.
   * Various versions of the MQV key agreement protocols.
   * Methods to avoid the small subgroup attack.
   * Methods to improve performance of elliptic curve
     arithmetic; in particular, fast efficient multiplication
     techniques.
   * Methods to improve performance of finite field
     multiplication.
   * Methods for efficient implementation of arithmetic modulo n.
   * Methods to perform validation of elliptic curve public keys.
   * Methods to perform efficient basis conversion.
The second [3] of the lists contains the following:
  [As of February 10, 2005] Certicom is the owner of the
  following issued patents:
  EP 0 739 105 B1 (validated in DE, FR, and the UK) "Method for
  signature and session key generation" pertains to the MQV
  protocol
[Anybody knows, where it is available online?]
  US 5,761,305 "Key Agreement and Transport Protocols with
  Implicit Signatures" pertains to the MQV protocol
  US 5,889,865 "Key Agreement and Transport Protocol with
  Implicit Signatures" pertains to the MQV protocol
  US 5,896,455 "Key Agreement and Transport Protocol with
  Implicit Signatures" pertains to the MQV protocol
  US 6,122,736 "Key agreement and transport protocol with
  implicit signatures" pertains to the MQV protocol
  US 6,785,813 "Key agreement and transport protocol with
  implicit signatures" pertains to the MQV protocol
[Menezes-Qu-Vanstone (MQV) protocol -- an authenticated protocol
for key agreement based on the Diffie-Hellman scheme.]
  US 5,600,725 "Digital Signature Method and Key Agreement
  Method" pertains to PV signatures
[Pintsov-Vanstone (PV) signatures -- a scheme with partial
message recovery.]
  US 5,933,504 "Strengthened public key protocol" pertains to
  preventing the small-subgroup attack
[This one contains the following claims:
    1. A method of determining the integrity of a message
       exchanged between a pair of correspondents, said message
       being secured by embodying said message in a function of
       .alpha..sup.x where .alpha. is an element of a finite
       group S of order q, said method comprising the steps of
       at least one of the correspondents receiving public
       information .alpha..sup.x where x is an integer selected
       by another of said correspondents, determining whether
       said public information .alpha..sup.x when exponentiated
       to a value t where t is a divisor of q provides a
       resultant value .alpha..sup.xt corresponding to the group
       identity and rejecting messages utilizing said public
       information if said resultant value corresponds to said
       group identity.
    3. A method according to claim 1 wherein said order q is a
       prime number.
but IIUC it is exactly what DSA does: q is a prime, p = q z + 1
is also a prime, g = h^z (p), that is g^q = 1 (p) and thus g "is
an element of a finite group S of order q ... wherein said order
q is a prime number," as a part of a signature g^x is sent, where
"x is an integer selected by another of said correspondents". Am
I missing something?]
  US 6,141,420 "Elliptic Curve Encryption Systems" pertains to
  point compression
[Point compression theme seems to start from the following
    29. A method of transferring the coordinates of a point on
        an algebraic curve defined by a function of two
        variables between a pair of correspondents connected by
        a data communications link comprising the steps of
        forwarding from one correspondent to another a
        coordinate of said point, providing at said other
        correspondent parameters of said algebraic curve, and
        computing at said other correspondent said other
        coordinate from said one coordinate and said algebraic
        curve.
    30. A method according to claim 29 including the step of
        forwarding with said one coordinate identifying
        information of said other coordinate and utilising said
        identifying information and a discriminating function to
        determine the appropriate value of said other
        coordinate.
In other words, instead of sending a pair (x,y) that satisfies
F(x,y) = 0 one sends x and the recipient recovers y using the
equation alone (29) or using an additional hint about which of
several y was used (30). Here the art is (lossless) data
compression and every "person having ordinary skill in the art"
is aware of predictor-corrector method used here: using partial
data (x and, possibly, a hint) and the knowledge of data
distribution (F(x,y)=0) the recipient recovers the whole
information. How it is possible to get a patent on such an
obvious application of a well-known technique?
trivial, but the case of EC(GF_{2^p}) probably is less so. In any
case, there is no problem to implement ECDSA and ECDH without
point compression.
Any pointers to prior art about at least point compression in
  US 6,618,483 "Elliptic curve encryption systems" pertains to
  point compression
[Here Claim 3 seems to be of the same type.]
  US 6,704,870 "Digital Signatures on a Smart Card" pertains to
  ECDSA
[Seems to be an optimization for a smartcard which uses
computational power of the card accepting device:
    == Abstract ==
    A digital signature scheme for a "smart" card utilizes a set
    of prestored signing elements and combines pairs of the
    elements to produce a new session pair. The combination of
    the elements is performed partly on the card and partly on
    the associated transaction device so that the exchange of
    information between card and device does not disclose the
    identity of the signing elements. The signing elements are
    selected in a deterministic but unpredictable manner so that
    each pair of elements is used once. Further signing pairs
    are generated by implementing the signing over an anomalous
    elliptic curve encryption scheme and applying a Frobenius
    Operator to the normal basis representation of one of the
    elements.]
  CH 693 252 "Verfahren und Vorrichtung zur Erzeugenung einer
  ganzen Zahl" [that is, IIUC, "Procedure and device for the
  generation of an integer"] pertains to key generation
[Any idea where to download this one?]
  US 6,078,667 "Generating Unique and Unpredictable Values"
  pertains to key generation
[The method disclosed in this patent:
    == Abstract ==
    An integer for a private key is generated utilising a pair
    of components that are combined in a fixed predictable
    manner. The first component is generated from a sequencer
    such as a counter that generates non-repeating distinct
    value and the second component is generated in a random
    manner. By combining the components the integer has a unique
    and unpredictable value.
is both obvious (to get X with properties A and B concatenate
X_a, which has property A, and X_b, which has property B) and
AFAIU pointless for real key-generation because a long-enough
random key is unique with overwhelming probability.]
  AU 758044 "Implicit certificate scheme" pertains to bullet
  certificates
  EP 1 066 699 "Method of generating a public key in a secure
  digital communication system and implicit certificate"
  pertains to bullet certificates
  US 6,792,530 "Implicit certificate scheme" pertains to bullet
  certificates
[Implicit (aka. bullet) certificates "allow the recipient to
extract and verify the public key of the other party from the
signature portion."]
  Pertinent patent applications:
   * Methods to improve the performance of elliptic-curve
     arithmetic.
   * Methods to improve the performance of finite-field
     operations.
   * Methods to improve the performance of private-key
     operations.
   * Methods to improve the performance of public-key
     operations, including signature verification.
   * Methods to improve the performance of modular arithmetic.
   * Methods pertaining to the validation of elliptic-curve
     public keys.
   * Methods to thwart domain-parameter attacks.
   * Methods to perform efficient basis conversion.
   * Methods to generate keys with desirable cryptographic
     properties.
   * Methods pertaining to PV signatures.
[1] [2] [3] [4]

@_date: 2005-10-17 15:59:51
@_author: Alexander Klimov 
@_subject: NSA Suite B Cryptography 
Since it turns out that ECDH and ECDSA with EC(GF_p) (even with point
compression) are not patented the following can be considered as
  All implementations of Suite B must, at a minimum, include AES with
  128-bit keys, the 256-bit prime modulus elliptic curve and SHA-256
  as a common mode for widespread interoperability. [...] ECDH is
  appropriate for incorporation of Suite B into many existing Internet
  protocols such as the Internet Key Exchange (IKE), Transport Layer
  Security (TLS), and Secure MIME (S/MIME).

@_date: 2005-10-26 18:24:22
@_author: Alexander Klimov 
@_subject: [PracticalSecurity] Anonymity - great technology but hardly used 
In fact, it is possible to setup it all thru privoxy alone:
#  5. FORWARDING
#  =============
#  This feature allows routing of HTTP requests through a chain
#  of multiple proxies. It can be used to better protect privacy
#  and confidentiality when accessing specific domains by routing
#  requests to those domains through an anonymous public proxy (see
#  e.g.  Or to use a caching
#  proxy to speed up browsing. Or chaining to a parent proxy may be
#  necessary because the machine that Privoxy runs on has no direct
#  Internet access.
#  Also specified here are SOCKS proxies. Privoxy supports the SOCKS
#  4 and SOCKS 4A protocols.
#  5.1. forward
#  ============
#  Specifies:
#      To which parent HTTP proxy specific requests should be routed.
#  Type of value:
#      target_pattern http_parent[:port]
#      where target_pattern is a URL pattern that specifies to which
#      requests (i.e. URLs) this forward rule shall apply. Use /
#      to denote "all URLs".  http_parent[:port] is the DNS name or
#      IP address of the parent HTTP proxy through which the requests
#      should be forwarded, optionally followed by its listening port
#      (default: 8080). Use a single dot (.) to denote "no forwarding".
Btw, I guess everybody who installs tor with privoxy has to know about
this since he has to change this section.
The problem is that it is not clear how to protect against `malicious'
sites: if you separate fast and tor-enabled sites by the site's name,
e.g., tor for search.yahoo.com, and no proxy for everything else,
yahoo can trace you thru images served from .yimg.com; OTOH if you
change proxy `with one click' first of all you can easily forget to do
it, but also a site can create a time-bomb -- a javascript (or just
http/html refresh) which waits some time in background (presumably,
until you switch tor off) and makes another request which allows to
find out your real ip.

@_date: 2005-09-11 17:15:00
@_author: Alexander Klimov 
@_subject: ECC patents? 
ECC is known since 1985 but seems to be absent in popular free
software packages, e.g., neither gnupg nor openssl has it (even if the
relevant patches were created). It looks like the main reason is some
patent uncertainty in this area.
An internet research shows that Certicom claims to hold quite a few
patents in the area. Some people claims that it is still possible to
implement ECC without violating any patent, because neither ECC in
general, nor ECDH, nor ECElGamal are patented. Yet another POV is that
although algorithms themselves are not patented the curves (especially
whose standardized by NIST) are patented (probably, only for GF(p) and
GF(2^n)-based curves are not).
Does anyone know a good survey about ECC patent situation?

@_date: 2005-09-12 11:58:14
@_author: Alexander Klimov 
@_subject: ECC patents? 
You are absolutely right the Sun patch was finally accepted,
although there were some patent-related discussions, e.g., at
There is also work on ECC for gnupg
and again there were patent-related discussions about the issue. ECC
is also implemented in crypto++ and other libraries.
But (potential) problem still persists: even if openssl implements ECC
it does not save you from patent issues if they exist.

@_date: 2005-09-12 18:09:36
@_author: Alexander Klimov 
@_subject: Is there any future for smartcards? 
Well, SC is just a processor which runs some software. Unfortunately,
in our non-perfect world a person can physically control his own
computer which is (logically) 0wned by somebody else :-) Of course, a
smart card inserted into compromised card accepting device can be
(mis)used by the 0wner as well, but at least the owner can be sure
that once she removes the card no new transaction can be
BTW, there is also `something-you-have' authentication use-case.

@_date: 2005-09-14 12:18:14
@_author: Alexander Klimov 
@_subject: ECC patents? 
What is Really Covered
  o  The use of elliptic curves defined over GF(p) where p is a prime
     number greater than 2^255 when the product satisfies the Field of
     Use conditions
  o  Both compressed and uncompressed point implementations
  o  Use of elliptic curve MQV and ECDSA under the above conditions
This hints that indeed only some particular curves are patented.
Grepping -list_curves of the new openssl (0.9.8) which has a list of
curves from SECG, WTLS, NIST, and X9.62 gives not that much:
  secp256k1 : SECG curve over a 256 bit prime field
  secp384r1 : NIST/SECG curve over a 384 bit prime field
  secp521r1 : NIST/SECG curve over a 521 bit prime field
  prime256v1: X9.62/SECG curve over a 256 bit prime field
Alternatively, this coverage can be interpreted that NSA is not
interested in curves which provide less security than 128-bit AES.
Any idea, which alternative is true?

@_date: 2005-09-19 22:36:09
@_author: Alexander Klimov 
@_subject: [Clips] Contactless payments and the security challenges  
Since the phone has an LCD and a keyboard it is possible to display
``Do you want to pay $2 to ABC, Inc. ?'' and authorize the transaction
only if the user presses OK (larger transactions may require the PIN).
An additional benefit is that it is your own card accepting device and
thus the risk that the PIN is keyloggered is lower (of course, this is
only as far as mobiles are more secure than usual windows pc).
I guess the idea is that each transaction is online, so you can just
notify your bank (who can identify you).
This problem is also solvable if the bank or a separate privacy
certification authority (as it is proposed in the TCG documents)
provides an alternative ID for your phone---an alias of the
endorsement key---for each new transaction,
But do not get me wrong: saying that all the common problems are
easily solvable does not mean that they are in fact solved in this
particular system...

@_date: 2006-08-23 13:57:22
@_author: Alexander Klimov 
@_subject: compressing randomly-generated numbers 
A random bit stream should have two properties: no bias and no
dependency between bits. If one has biased but independent bits he
can use the von Neumann algorithm to remove the bias, but if there is
a dependency no algorithm will be able to `strip' it.

@_date: 2006-08-23 16:06:28
@_author: Alexander Klimov 
@_subject: Solving systems of multivariate polynomials modulo 2^32 
There is a small optimization: modulo 2, x^n = x and thus if ``the
degrees of the polynomials are high (say 32) and the number of terms
they have is also big (for example 833, 2825 and 4708)'' it is not
more difficult to solve than degree 3 (xyz) with up to 8 terms. In
particular, the example is equivalent modulo 2 to
 x*y + z = 1
 x + y*z = 1
 x + y + z = 0
[[[ Btw, something is wrong in the example: the following program
 N = 2
 for x in range(N):
  for y in range(N):
   for z in range(N):
    if (x*y+z)%N==1 and (x**3+y**2*z)%N==1 and (x+y+z)%N==0:
     print x,y,z
 0 1 1
 1 0 1
 1 1 0
and apparently 1,0,1 is indeed a solution mod 2:
 1*0+1=1, 1+0*1=1, and 1+1+0=0
Trying all combinations is a reasonable strategy, but it is also
possible to use an iterative simplification (especially if there are,
say, 80 variables):
if y = 0 we get a linear system
 z = 1
 x = 1
 x + z = 0
that is 1,0,1 is a solution
if y = 1 we get also a linear system
 x + z = 1
 x + z = 1
 x + 1 + z = 0
that is 0,1,1 and 1,1,0 are also solutions.
Linearization (and relinearization) may also be an option.
Once we solved the system modulo 2^k, doing so modulo 2^{k+1} is much
simpler than trying all possibilities for the next bit. A nice
property of multiplication is that it gives linear relation in the
non-zero bit-slice, that is if we know that
 X = x 2^k + A
 Y = y 2^k + B,
where A and B are known and k>0, then modulo 2^{k+1} we have
 X*Y = xy 2^{2k} + (Bx+Ay) 2^k + AB = (bx+ay) 2^k + AB,
where a and b are the least significant bits of A and B (A = 2A'+a).
Since A and B are known constants, the next bit of XY is a linear
function (bx + ay + AB/2^k) of the next unknown bits of X and Y.
For example, in our case once we have (0,1,1) we represent X=2x,
Y=2y+1, and Z=2z+1 and write
 2x(2y + 1) + 1 = 1
 (2x)^3 + (2y+1)^2(2z+1) = 1
 2x+(2y+1)+(2z+1) = 0
remove everything divisible by 4
 2x + 1 = 1
 2z + 1 = 1
 2x + 2y + 2z + 2 = 0
and divide each equation by 2 (this is possible becuase (0,1,1) was a
solution modulo 2)
 x = 0
 z = 0
 x+y+z=1,
that is (x,y,z)=(0,1,0) and thus (X,Y,Z) = (0,3,1) modulo 4.
Btw, the matrix (and thus its rank) depends only on the LSB of the
current solution, thus for each solution modulo 2, there is either a
split on each new step (if the rank is not maximal and the system is
consistent on this step), or no splits at all (if it is maximal).

@_date: 2006-08-23 16:22:47
@_author: Alexander Klimov 
@_subject: A security bug in PGP products? 
The system works as follows: a random key K is used to encrypt all the
data on the volume; the passphrase is used to encrypt the key K. This
design allows to change the passphrase without reencrypting the whole
drive (only K needs to be reencrypted). One well-known side-effect is
that if one knows K he can decrypt the data. So, if an attaker knows
the password and can read your volume image at some point at time, he
can decrypt the volume even if you change the password (recall that
you have not changed the key).

@_date: 2006-08-29 13:17:30
@_author: Alexander Klimov 
@_subject: compressing randomly-generated numbers 
Well, it not really a claim since there was no definition, here it is:
A ``dependency stripping'' algorithm is a deterministic algorithm that
gets a stream of unbiased (but not necessary independent bits) and
produces a stream of several independent bits.
It is no a deterministic algorithm.
This requires a random key.
Recall that the whole point was to extract random bits -- if we
already have useful random bits we can simply output them and discard
the input stream.
Consider ``x a x b x c x ...'', sampling every other bit throws away
most of entropy.
In general, there is no ``dependency stripping'' algorithm because an
input x,x,x,..., where all x are the same (either all 0 or all 1), is
possible. There is simply no enough entropy in the input to extract at
least two bits.
Interestingly, an additional requirement that the input stream has at
least two bits of entropy does not change the situation: Consider the
first two bits of the output. There are only four possibilities (00,
01, 10, and 11), so if the input is long enough then it is possible to
find four different inputs that give the same bits, e.g.,
 A(0001) = 00...
 A(0010) = 00...
 A(0100) = 00...
 A(1000) = 00...
An input that contains 0001, 0010, 0100, and 1000 with the same
probability has two bits of entropy, but it is always transformed by
the algorithm into 00... and thus the first two bits are not
independent. (Strictly speaking, if we recall a requirement that the
input bits are unbiased we should also include into the set of inputs
1110, 1101, ..., but this does not change the result.)
See above about ``sampling at a slower rate.''

@_date: 2006-12-04 09:11:27
@_author: Alexander Klimov 
@_subject: Can you keep a secret? This encrypted drive can... 
AES-256 means AES with 128-bit block and 256-bit key, so AES-256
encrypts the same amount of data as AES-128.
As of hardware implementation, one can use several engines in
parallel, although even a single one can be faster than needed,
for example, with 280 MHz there are 2e7 blocks per second, that is
320 Mbyte per second.

@_date: 2006-02-08 18:15:08
@_author: Alexander Klimov 
@_subject: square roots modulo a prime p 
I have checked several papers and software packages which implement
modular square root and it looks like there is no agreement about what
algorithm is the best except that everybody does the same for p=3(4).
Chapter 3 of HAC suggests special algorithms for p=3(4) and p=5(8); a
general algorithm (IIUC, Shanks-Tonelli algorithm) which has
complexity O(|p|^3 s), where s is such that t is odd in t 2^s = p-1;
and an algorithm based on polynomial modular exponentiation:
 r = x^{(p+1)/2} mod (x^2 - bx + a)
where b^2-a is a quadratic non-residue modulo p for cases where s is
Some standards, e.g., IEEE 1363-2000, X9-1.62, etc. use same approach
for 3(4) and 5(8) but propose an algorithm based on Lucas sequence in
general case.
Looks like GMP does not implement any algorithm.
Openssl uses Tonelli/Shanks algorithm (crypto/bn/bn_sqrt.c) checking
simple cases first.
Crypto++ (nbtheory.cpp) seems to do the same as openssl but does not
check 5(8).
NTL uses the smartest approach: it implements 3(4) and when for
s < sqrt(|p|) it uses Tonelli/Shanks algorithm and for large s it uses
polynomial reduction.
So I wonder why no well-known programs implement what respectable
standards suggest? And the other way around: why standards suggest
what is not usually implemented?

@_date: 2006-02-08 18:57:06
@_author: Alexander Klimov 
@_subject: FWD: [IP] Encrypting Bittorrent to take out traffic shapers 
A better solution is to stop paying to ISP which does not provide you
with what you have paid for.
Since one can easily encrypt >60 Mb/s with AES on a modern computer it
does not matter what algorithm to use (unless, of course, you have a
wider than 60 MB/s connection).
BTW, if ISP really wants to slow down bittorrent it can use some other
methods: there is usually constant port (6881, IIRC), and quite
specific communication patern.

@_date: 2006-01-12 13:14:53
@_author: Alexander Klimov 
@_subject: long-term GPG signing key 
This would need 8 x 2^{64} bytes of storage which is approximately
2,000,000,000 DVD's (~ 4 x 2^{32} bytes on each).
Probably, you are referring to the fact that during encryption of a
whole DVD, say, in CBC mode two blocks are likely to be the same
since there are an order of 2^{32} x 2^{32} pairs.

@_date: 2006-07-26 10:43:43
@_author: Alexander Klimov 
@_subject: Crypto to defend chip IP: snake oil or good idea? 
If I understand correctly, it is not similar to DRM, it is more like
dongles used in some software ,
but intended to protect hardware instead of software. I guess it has
the same problems as dongles: either you have to implement some major
functionality on the dongle (and thus greatly complicate development),
or you simply include something like ``dongle present?'' queries in
several key points (and thus make it trivial to crack by anyone
skilled in the art).
Experience with the software dongles shows that this idea works in a
limited number of cases, for example, it works if one wants to protect
a game that has high value during its first month after the release
(cracking a strong protection may take some time), but dongles are
almost useless for protection of long-life programs (although it can
be very hard to crack a protection if the dongle is not given to the
I don't know what is easier to `fix': a software program given as a
binary code or a hardware design given as a net-list, but you are
absolutely right, it is very important to consider that software is
routinely cracked by hobbyist, whereas hardware must withstand more
organized efforts.

@_date: 2006-03-22 15:51:15
@_author: Alexander Klimov 
@_subject: passphrases with more than 160 bits of entropy 
If you want 512 bits use SHA-512.
What about dividing passphrase into blocks and hash them separately --
if the size of a block is the same as the hash output's size entropy
reduction should be minimal.
BTW, with respect to entropy reduction is there any explanation why
PBKDFs from PKCS5 hash
 password || seed || counter
instead of
 counter || seed || password
and thus reduce all the entropy of the password to the size of the
internal state.

@_date: 2006-03-30 12:04:11
@_author: Alexander Klimov 
@_subject: Your secrets are safe with quasar encryption 
It sounds like "encrypting" $P$ by xoring it with random $K$ and
sending both $P \Xor K$ and $K$ -- no very secure :-)

@_date: 2006-11-02 18:40:27
@_author: Alexander Klimov 
@_subject: Can you keep a secret? This encrypted drive can... 
If a PC is used by an interactive user, it is irrelevant how much
access time is increased, as far as the user cannot see a difference
without a timer. Several times I have read that disk encryption is not
noticeable. My own experience shows that I cannot notice any
difference: emacs and pine respond immediately to every key-press if I
use encrypted disk or not; firefox waits for data from network the
same amount of time; mplayer does not drop frames with or without disk
encryption; compilation of kernel takes some noticeable time with or
without encryption, but I don't know how much exactly since I spend
this time in some other program.
I don't want to say that the difference is irrelevant for all uses,
e.g., if one edits video with 2k resolution or hosts a busy database,
they can see very real difference, but such use-cases are minority and
they are not done on portable computers anyway.
I guess many people here have tried full disk encryption for
themselves, do you notice any difference in performance or not?

@_date: 2006-11-07 12:07:34
@_author: Alexander Klimov 
@_subject: Can you keep a secret? This encrypted drive can... 
I am not sure that compilation is worst case for disk performance:
once system compiled the first file, the compiler and most of .h files
are in RAM and should not be fetched from disk. Note that RAM of
modern computers is large enough to store all the source code of a
project (except, maybe, openoffice.org).
My guess is that slow compilation is a result of access time
misconfiguration: if a filesystem has access time enabled, then each
time a file is read, the file system updates access time on disk. A
solution is to set noatime option on the filesystem used for
compilation. A better approach is to mount tmpfs as /tmp, and build in
inodes with size and nr_inodes options).

@_date: 2006-11-09 10:33:44
@_author: Alexander Klimov 
@_subject: Can you keep a secret? This encrypted drive can... 
Looks like you are doing a common mistake of using ``entropy source''
(or, probably, even``source of entropy input'') as output of your
generator (see NIST SP 800-90 for details). With such attitude, the
next step is to use identity mapping as a block cipher :-)

@_date: 2006-10-09 11:54:51
@_author: Alexander Klimov 
@_subject: TPM & disk crypto 
IIUC, TPM is pointless for disk crypto: if your laptop is stolen the
attacker can reflash BIOS and bypass TPM. Moreover, TPM is actually
bad for disk crypto: without it you lose your data only if your HDD
dies, now you lose your data if your HDD dies *or* if you motherboard
dies. If the user is not experienced in BIOS reflashing, they also
lose their data if OS crashes and refuses to boot (not uncommon for
some common OSes).

@_date: 2006-10-10 17:42:57
@_author: Alexander Klimov 
@_subject: TPM & disk crypto 
Even if BIOS is real ROM, but there are some inter-chip links between
ROM, CPU, and TPM, it seems possible for an attacker with an iron and
FPGAs to trick the TPM to reveal the secret. That is against
highly-motivated attacker TPM does not give really more protection
than truecrypt, but for a casual attacker (who is just curious what is
on a stolen laptop) even truecrypt is enough.

@_date: 2006-10-10 19:26:39
@_author: Alexander Klimov 
@_subject: TPM & disk crypto 
The argument that TPM can prevent trojans seems to imply that the
trojans are installed by modification of raw storage while the OS is
offline. Probably, this can be a case for malicious internet-cafes,
but 99.9% of trojans on home PCs of normal people are installed when
the OS is active (0.1% is for trojans installed by law enforcement).
(Of course, an attacker with physical access can install physical
trojans: hardware keylogger and camera.) Since a regular installation
should not change ``reported OS hash,'' TPM will not be able to detect
the difference. Am I missing something?
Btw, how the TCG allows to regularly change the kernel for security
patches and still keep the same ``reported hash''?

@_date: 2006-09-06 13:02:56
@_author: Alexander Klimov 
@_subject: Raw RSA 
If an attacker is given access to a raw RSA decryption oracle (the
oracle calculates c^d mod n for any c) is it possible to extract the
key (d)?
It is known, that given such an oracle, the attacker can ask for
"decryption"  of all primes less than B, and then he will be able to
sign PKCS-1 encoded messages if the representative number is B-smooth,
but is there any way to actually recover d itself?

@_date: 2006-09-07 18:27:48
@_author: Alexander Klimov 
@_subject: Raw RSA 
I want to extract the exponent that is used by the oracle: this is the
difference between the chosen-plaintext attack (it does not require an
oracle, since it is a public key scheme) and the chosen-ciphertext
attack (CCA1).

@_date: 2006-09-10 23:36:38
@_author: Alexander Klimov 
@_subject: Raw RSA 
Suppose that an attacker runs an activex control on the user's
computer and the control is able to ask a smart card connected to the
computer to perform raw RSA operations with user's private key. The
goal of the attacker is to be able to sign some useful messages with
the user's private key *after* the user disconnect his smart card.
If the attacker needs to sign a message x, he needs to find a smooth
number y = x + k n, where n is the RSA modulus and k is some arbitrary
number. I forgot what was the algorithm to find such y (I am not even
sure that it exists), IIRC, it was based on LLL.

@_date: 2006-09-21 19:16:22
@_author: Alexander Klimov 
@_subject: Did Hezbollah use SIGINT against Israel? 
It is not clear that with modern technology interception is
impossible, at least during Second Gulf War the reports about
SIGINT against US were quite convincing:
IIUC, spread-spectrum communication is not much stronger than the
background noise, and thus the traffic analysis is not that easy
My guess that at least some information was leaked due to cellular
phones (the solders were routinely calling their families).
"Besides radio transmissions, the official said Hezbollah also
 monitored cell phone calls among Israeli troops. But cell phones are
 usually easier to intercept than military radio, and officials said
 Israeli forces were under strict orders not to divulge sensitive
 information over the phone."
Even if one don't care what was said over the phone, a lot of
information can be extracted from mere location of a phone
(especially, if one knows the owner of each phone):
"Israeli officials said the base also had detailed maps of northern
 Israel, lists of Israeli patrols along the border and cell phone
 numbers for Israeli commanders."

@_date: 2006-09-26 15:10:12
@_author: Alexander Klimov 
@_subject: interesting HMAC attack results 
According to Section 1.4 of (*), the new result on HMAC does not
contradict the analysis in (**). That is the assumption used by Mihir
Bellare do not hold for MD4, MD5, and SHA-1.

@_date: 2007-04-26 13:04:25
@_author: Alexander Klimov 
@_subject: More info in my AES128-CBC question 
For CBC mode the IV should be random because it is added
directly to plaintext. For example, if one sends `010' with IV
`001' the result of the xor will be the same as if they
subsequently send `101' with IV `110' and thus an attacker will
be able to learn something about the plaintext. If the IV is
random then we expect a collision after 2^{n/2} messages, but if
IV has some structure (or if an attacker knows the next IV
before they insert their own plaintext to be encrypted) the
probability of collision may become too high.
For some other modes (e.g., CFB, OFB, or CTR) the IV only needs
to be fresh, since the IV is first processed by the cipher. But
even in this case it is a good idea to use random IVs to protect
against state roll-back attacks.

@_date: 2007-04-26 13:35:49
@_author: Alexander Klimov 
@_subject: open source disk crypto update 
The real question is what attacks you are talking about.
For example, protecting confidentiality of /boot and /usr that
contains software that everybody can find on millions of other
computers makes little sense. (OK, your kernel configuration may
be unique, but do you really consider it confidential?)
Do you want encryption to ensure integrity of you software? (Of
course, that would be contrary to common crypto wisdom.) Are you
afraid of attackers secretly changing your software (to monitor
you?) while your computer is off? If so, are you sure that there
is no hardware keylogger in your keyboard and there is no camera
inside a ceiling mounted smoke detector [1]?
In any case, it is a good idea to always start with definition
of the problem and then check if the solution really solves it.
(For example, eve if the problem is that your computer is too
fast, you cannot solve it with encryption :-) )
[1]

@_date: 2007-04-26 16:14:34
@_author: Alexander Klimov 
@_subject: More info in my AES128-CBC question 
The order of events is important. Consider a chosen plaintext
attack: a secret message was sent other a CBC-encrypted channel.
For example, it was a single block with padded "yes" or "no" and
the encryption is x0||x1, where x0 is a random IV and
  x1 = E(x0 xor "yes"),
the attacker can now submit their message to find the secret
one. If the attacker knows that x1 is going to be used as the
next IV, they can try to submit
  m = x0 xor "yes" xor x1
it will be encrypted as
  x2 = E(m xor x1) = E(x0 xor "yes") = x1
so if x2 = x1 the attacker knows that "yes" was sent, otherwise
it was "no".
If the new IV is randomly selected *after* the attacker has made
his choice the attack is impossible.

@_date: 2007-04-29 12:24:48
@_author: Alexander Klimov 
@_subject: open source disk crypto update 
It is almost impossible to modify computer remotely once it is off. It
is possible to destruct computer physically (or by EM pulse), it is
possible to interact with computer remotely if `off' is actually some
kind of stand-by with lamps off. But once you disconnect your computer
from the power supply it should be immune from remote attackers. ``The
truly secure system is one that is powered of, ... and even then I
have my doubts.'' :-)
In most cases once computer can be compromised remotely, it is
already booted, and since disk encryption is transparent once the
computer is booted, it cannot change how easy it is to install
a root-kit remotely.
In this case you ensure integrity using a tamper resistant hardware
(assuming you always carry your USB stick with you). By the way, a
non-rewritable CD should be even better.

@_date: 2007-02-04 17:11:32
@_author: Alexander Klimov 
@_subject: Intuitive cryptography that's also practical and secure. 
Right, this is the theory, and in theory there is no difference
between practice and theory, unfortunately, in practice it exists:
   Oct. 19, 2004, while substituting for a seventh-grade
   language class at Kelly Middle School, Amero claimed she
   could not control the graphic images appearing in an endless
   cycle on her computer.
   "The pop-ups never went away," Amero testified. "They were
   continuous."
   Computer expert W. Herbert Horner, testifying in Amero's
   defense, said he found spyware on the computer and an
   innocent hair styling Web site "that led to this pornographic
   loop that was out of control."
   [Jury] convicted Amero, 40, of Windham of four counts of risk of
   injury to a minor, or impairing the morals of a child. She faces a
   sentence of up to 40 years in prison.

@_date: 2007-01-30 18:56:12
@_author: Alexander Klimov 
@_subject: Private Key Generation from Passwords/phrases 
In many cases the real goal is not to find all (or many) passwords,
but to find at least one, so one may concentrate on the most-oftenly
used salt. (Of course, with 60K passwords there is almost for sure at
least one "password1" or "Steven123" and thus the salts are

@_date: 2007-06-11 16:45:55
@_author: Alexander Klimov 
@_subject: luks disk encryption benchmarks 
I guess it is not the controller, but the kernel.
To be useful, benchmark should be similar to normal workload. Maybe
you should try to compile a kernel, or install/remove some package.

@_date: 2007-06-21 16:32:50
@_author: Alexander Klimov 
@_subject: wrt "Network Endpoint Assessment" 
I wonder what stops a trojan to disable an antivirus, but screw
the reporting system up so that it pretends that the antivirus
is still active?

@_date: 2007-06-21 19:58:08
@_author: Alexander Klimov 
@_subject: question re practical use of secret sharing 
Monolith is a simple tool that takes two arbitrary binary files
  (called a Basis file and an Element file) and "munges" them together
  to produce a Mono binary file (with a .mono extension). Monolith can
  also reconstruct an Element file from a Basis file and a Mono file.
So if one xors a Linux iso image and some movie, it is quite hard to
claim that the result is copyright-protected.

@_date: 2007-06-26 19:20:23
@_author: Alexander Klimov 
@_subject: Free Rootkit with Every New Intel Machine 
Even if a TPM is soldered to the motherboard it does not mean
that unsoldering is an esoteric art. There is a difference
between what media hypes about TPM and what TCG technical
documents say [1]:
   It is not expected that a TPM will be able to defeat
   sophisticated physical attacks.
Encrypted bus requires encryption cores on both ends and key
distribution resistant to MitM attacks. I suspect that if you
system already has so many crypto blocks in it, it would be
cheaper to implement TPM inside.
To logically bound TPM to the motherboard it is enough for BIOS
`loader' that hashes the rest of the BIOS, to include unique ID of the
motherboard into the hash.
[1]

@_date: 2007-06-28 18:51:10
@_author: Alexander Klimov 
@_subject: Quantum Cryptography 
I suspect there are two reasons for QKD to be still alive.
First of all, the cost difference between quantum and normal
approaches is so enormous that a lot of ignorant decision makers
actually believe that they get something extra for this money.
  If you tell a lie big enough and keep repeating it, people
  will eventually come to believe it.
The second reason is ``rollback'' (is it right term?): you pay
$100000 from your company funds to a QKD vendor, and they
covertly give $50000 back to you.

@_date: 2007-05-06 15:07:29
@_author: Alexander Klimov 
@_subject: AACS and Processing Key 
I guess we should pay more attention to the real motivation of
the players. In my opinion it is very unlikely that attackers
want to "maximize economic pain" of the defender, it is more
believable that they simply want to be the first to solve the
challenge. If it is a good approximation, then the best strategy
is to release the keys as fast as possible.
It is not obvious what the defender's motivation is: despite
their claims (do they believe themselves?) it seems unlikely that
DVD sales are significantly affected by availability of the
decryption keys or the ripped content. I guess the only problem
they have is the embarrassing situation due to PR. If it is
a good approximation, then likely the best strategy is to revoke
keys a couple of times to make public less interested and
pretend that everything is OK.

@_date: 2007-05-13 12:56:48
@_author: Alexander Klimov 
@_subject: Enterprise Right Management vs. Traditional Encryption Tools 
There are two different features of TPM: it can work as an embedded
smartcard (to identify computer), and it can be used to vouch for
integrity of booted software. The first feature does not add
much to DRM, because the attacker has the computer. The second feature
can be bypassed if OS or DRM software has exploitable bugs (or
with relatively simple hardware techniques, but let someone
build a bug-free DRM software first :-) ).
Actually there is no need for any TPM intrusive methods to
bypass the second feature mentioned above (the first one does
not need to be bypassed since attacker has the computer). Let us
see how TPM works:
  after reset, CPU sends a sequence of messages that report
  hashes of the booted software;
  TPM changes its internal registers (PCRs -- platform
  configuration registers) as a result;
  CPU sends a key to be encrypted and a description of PCR
  values required to decrypt it;
  TPM returns encrypted blob (it stores PCR requirements inside the
  blob).
Once the blob is saved outside, it can be used to make sure that
only required software can access the key:
  after reset CPU reports hashes of booted software and TPM
  changes PCRs;
  CPU send a blob to be decrypted;
  TPM decrypts it, checks PCR requirements, and return the key
  stored inside.
The crucial assumptions here are that (1) TPM cannot be reset
independently of CPU; (2) CPU's boot ROM cannot be changed (note
that in many cases the ROM used for boot is actually flash);
(3) the bus between CPU and TPM cannot be tampered with.
Now, to decrypt any blob there is no need to have a FIB (focused
ion beam) or a "scanning electron microscope," because the only
thing an attacker needs is to break one of the above
assumptions, for example, boot Linux, reset TPM by some hardware
manipulation, write a program to send to TPM the needed set of
PCR change requests, send the blob, get the decrypted key, and
print it out.
Note once again that TPM works exactly as expected, the only
problem is that the assumptions do not hold.

@_date: 2007-09-16 19:01:52
@_author: Alexander Klimov 
@_subject: using SRAM state as a source of randomness 
One can test a source of randomness by checking statistics of its few
samples, but if I understand the article correctly, in case of SRAM
each cell behaves as an independent source of randomness: some bits
are almost always stuck at fixed values while others have some
freedom. In this case it is pointless to do tests using initial SRAM
state after a single power on, because to gather a few samples from
each source one needs to repeatedly reset the device.
Applying statistical tests to a hash of the whole SRAM does not make
much sense either -- a good hash function will give statistically good
results even if you give it a counter.

@_date: 2007-09-20 11:23:59
@_author: Alexander Klimov 
@_subject: Scare tactic? 
There are many ways to use DH key-agreement. The one described
on the page is as follows: both A and B generate random values,
exponentiate, exchange results, and derive the same value. In
this case there is no point validating the `public key'
A receives from B: if B colludes with an attacker (and generates
the key belonging to a small subgroup), then B can as well tell
the final secret to the attacker.
The attack would make sense if it allows B to learn a long-term
secret of A, but if the `private keys' are randomly generated on
each exchange, then this problem does not exist.

@_date: 2008-04-23 12:53:56
@_author: Alexander Klimov 
@_subject: no possible brute force Was: Cruising the stacks and finding stuff 
I guess you are talking about Planck units, so let's make the
 Planck length is L = \sqrt{hbar G / c^3} ~ 1.6E-35 m,
 Planck time T = L/c ~ 5.4E-44 s,
so a cubic-meter-computer can have
 N = (1/L)^3 ~ 2.4E104 elements
and thus
 N/T ~ 4.5E147 operations per second
that is approximately 2^{490} operations per second in a cubic meter
of "Planck computer". Given a year (3.15E7 s) on a Earth-size
(1.08E21 m^3) Planck computer we can make approximately 2^{585}
OK, it was amusing to do these calculations, but does it mean
anything? I think it is more like garbage-in-garbage-out process.
If I understand correctly, L and T are not non-divisible units of
space-time, but rather boundaries for which we understand that our
current theories do not work, because this scale requires unification
of general relativity and quantum mechanics.
Even more bizarre is to think about the above "processing element" as
representing a single bit: according to quantum mechanics, states of a
system are represented by unit vectors in associated Hilbert space of
the system and each observable is represented by a linear operator
acting on the state space. Even if we have only two qubits they are
not described by two complex numbers, but rather by 4:
 a_0|00> + a_1|01> + a_2|10> + a_3|11>
and thus description of the state of quantum registers requires
exponential number of complex numbers a_i and each operation
simultaneously process all those a_i. Since we cannot measure
them all, it is an open question whether quantum computations
provide exponential speed-up and all we know right now is that
they give at least quadratic one.
By the way, if you have a computer with the processing power larger
than that of all the cryptanalysts in the world, it makes sense to use
your computer to "think" to find a better attack than a brute-force
search :-)
[OT] This is a strange thesis because all black hole solutions in
general relativity can be completely characterized by only three
externally observable parameters: mass, electric charge, and angular
momentum (the no-hair theorem) and thus in some sense they have zero
entropy (it is not necessary a contradiction with something, because
it takes an infinite time for matter to reach the event horizon).
[OT] Although Hawking showed that the total area of the event horizons
of a collection of black holes can never decrease, which is *similar*
to the second law of thermodynamics (with entropy replaced by area),
it is not clear that it allows to conclude that area *is* entropy.

@_date: 2008-04-30 12:49:12
@_author: Alexander Klimov 
@_subject: privacy expectations Was: SSL and Malicious Hardware/Software 
Even if you sign a contract that you do not have any expectations
of privacy, it does not mean that you do not have them: honestly,
you do expect that your coworkers are not going to read you
personal emails, right?
  Lance Corporal Jennifer Long was issued a government computer
  to use on a government military network. When she was
  suspected of violations of the military drug use policies (and
  of criminal laws related to drug use), Marine Corps criminal
  investigators reviewed the contents of email messages she sent
  to another military employee who was likewise using
  a government issued computer over the same government network.
  The messages were retrieved from the government mail server
  and later used against Long. On September 27, 2006, the United
  States Court of Appeals for the Armed forces had to decide
  whether Long had any expectation of privacy in these e-mails.
  The starting point for any analysis is, of course, the DoD
  policy expressed on its warning banner, which stated quite
  explicitly:
    [...] All information, including personal information,
    placed on or sent over this system may be monitored. Use of
    this DoD computer system, authorized or unauthorized,
    constitutes consent to monitoring of this system. [...]
  However, the military court, [...] found that Long did, in
  fact have some privacy interests in the contents of her
  communications. It noted that while the government said it
  could monitor, it rarely did.

@_date: 2008-08-03 14:54:54
@_author: Alexander Klimov 
@_subject: Randomness testing Was: On the "randomness" of DNS 
See .
Since p-value is supposed to be uniform on the interval [0,1]
for a truly random source, it is no wonder that with so many
p-values some of them are close to 0 and some are close to 1.
If your p-value is smaller than the significance level (say, 1%)
you should repeat the test with different data and see if the
test persistently fails or it was just a fluke.

@_date: 2008-08-04 16:13:48
@_author: Alexander Klimov 
@_subject: Randomness testing Was: On the "randomness" of DNS 
Of course, there are many tests for goodness of fit (Kolmogorov-
Smirnov, chi-square, etc.) and also you can calculate for a given
number of tests how many tests should have p-value below the
significance level. And after making hundred tests you ask yourself
what you gonna do once your test gives "good uniformity", say p-value
is 0.23, but the proportion is 0.95, while the minimum pass rate for
1% is 0.96.
Only a bad statistician cannot justify any predefined answer :-)

@_date: 2008-12-07 11:10:17
@_author: Alexander Klimov 
@_subject: AES HDD encryption was XOR 
With its Digittrade Security hard disk, the German vendor
  Digittrade has launched another hard disk housing based on the
  unsafe IM7206 controller by the Chinese manufacturer Innmax.
  The German vendor prominently advertises the product's strong
  128-bit AES encryption on its packaging and web page. In
  practice, however, the hard disk data is only encrypted using
  a primitive XOR mechanism with an identical 512-Byte block for
  each sector.

@_date: 2008-02-17 11:59:33
@_author: Alexander Klimov 
@_subject: Toshiba shows 2Mbps hardware RNG 
It depends on the attack: Consider John von Neumann's algorithm
that, say, outputs the first bit in each pair if bits are
different. If you apply EM attack and get 0s almost everywhere
 00 00 00 01 00 00 00 10 00 00 10 00 00
but cannot control where 1s are exactly, then JvN corrector helps, but
if your EM attack is such that it makes long runs of 0s and 1s
 00 00 00 11 11 11 10 00 00 00 01 11 11
and you can detect when the bits are produced then you know exactly
what bits are produced (if a bit produced on transition from 0s to 1s
then it is 0).
Considering speed of nondeterministic RNG, it seems pointless at least
for those who go thru FIPS certification. FIPS 140-2 says
  Commercially available nondeterministic RNGs may be used for
  the purpose of generating seeds for Approved deterministic
  RNGs. [...] An Approved RNG shall be used for the generation
  of cryptographic keys used by an Approved security function.
  The output from a non-Approved RNG may be used 1) as input
  (e.g., seed, and seed key) to an Approved deterministic RNG or
  2) to generate initialization vectors (IVs) for Approved
  security function(s).
and currently there is no Approved nondeterministic RNG, so the
only option is to use nondeterministic RNG to generate seeds
for the deterministic one and one does not need MBps speed to
generate a seed.
But again, comparing a useful feature and a check mark on
marketing slides, the latter is doomed to be implemented.

@_date: 2008-01-05 10:47:05
@_author: Alexander Klimov 
@_subject: Death of antivirus software imminent 
It sounds like: we cannot make secure OS because it is too large --
let us don't bother to make a smaller secure OS, just add some more
software and hardware to an existent system and then it will be
secure. Sounds like a fairytale :-)
Data at rest encryption is good since it protects data on lost
laptops, but it does not work against malware (if power is off,
malware does not run as well), especially if the data is used in
decrypted form on the running system. Probably with data at rest
encryption you can protect rarely used sensitive data, but not the
data you use regularly (by the way, how you are going to make sure
that you remove all malware when you work with that sensitive data?).
Now consider trusted paths: adding an additional `secure' button is
easy (MS was able to add more keys to our keyboards), but how you make
sure that (1) there is a trusted path from computer to user and (2)
users understand how to use and actually use it? There are many ideas
how to achieve the former, but apparently the latter always fails.
Fingerprint readers are added not because this adds much security (it
is reported to be easy to fool them once an attacker has a sample of
the fingerprint, and you are very unlikely to keep your computer free
from your fingerprints), but because USERS LIKE THEM: finger scanning
is faster than entering the password and seems to be more secure. I
suspect that if you use some data at rest protection and lose your
laptop while it is not completely off, the fingerprint reader is
Using embedded hardware to scan for viruses seems not very realistic:
you probably can use it to check parts of RAM that are not supposed to
be changed, but a lot of malware live outside of those areas.
Malware already evolved to P2P communication and thus it is
almost impossible to find the real master by tracing local
connections between hosts.
That is you propose to create a law that all malware must have some
key escrow mechanism? Or you mean that police should be able to force
every user to decrypt data sent to/from their computer? Both are
hilarious, but the sad thing is that in some countries each of them
can become a real law.

@_date: 2008-01-20 10:23:18
@_author: Alexander Klimov 
@_subject: Changes in Russian licensing of cryptraghical tools 
In my opinion such a "summary" is very confusing, I suspect that
for ordinary people item "1.b" is more important. The document
says (my translation):
  1. This document is not applicable to distribution of:
  [...]
  b) cryptographic means which are available without limit for
  retail distribution, or thru mail orders, or electronic deals,
  or deals by telephone software operating systems,
  cryptographic capabilities of which cannot be changed by
  customers, which are developed for installation by customers
  without additional significant support by supplier and which
  have technical documentation (description of algorithms of
  cryptographic transformations, communication protocols,
  interface descriptions, etc.) which is available for
  audits.
That is, if I understand correctly, this document is not
applicable to GnuPG or other such tools.
Given what is required to get a license (for example, 4.b in the
first document, says that one must have people trained in
information security), I guess the new law is not supposed to
limit use of cryptography by ordinary people, but to limit
distribution of snake-oil by self-proclaimed "professionals".

@_date: 2008-06-10 13:44:40
@_author: Alexander Klimov 
@_subject: Ransomware 
I suspect that home users are the main target of such viruses, and
such users usually do not make backups at all (I guess the people who
value their data enough to make backups, are also diligent enough to
do backup validation).

@_date: 2008-05-04 10:32:05
@_author: Alexander Klimov 
@_subject: OpenSparc -- the open source chip (except for the crypto parts) 
To be sure that implementation does not contain back-doors, one needs
not only some source code but also a proof that the source code one
has is the source of the implementation. With open-source software one
can get such a proof by compiling the source themself (as far as they
trust their compiler toolchain), but I don't see any way to get such a
proof for non-FPGA hardware.

@_date: 2008-05-14 12:26:20
@_author: Alexander Klimov 
@_subject: The perils of security tools 
I think we all should not miss this ROTFL experience:
Original code (see ssleay_rand_add)
 ,
the patch
and the end result

@_date: 2008-05-22 19:25:42
@_author: Alexander Klimov 
@_subject: The perils of security tools 
Apparently, there was even a "two-way" communication about the
issue in openssl-dev [1]
  The code in question that has the problem are the following
  2 pieces of code in crypto/rand/md_rand.c:
  247:
                MD_Update(&m,buf,j);
  467:
   PURIFY
                MD_Update(&m,buf,j); /* purify complains */
    [...]
  What I currently see as best option is to actually comment out
  those 2 lines of code.  But I have no idea what effect this
  really has on the RNG.  The only effect I see is that the pool
  might receive less entropy.  But on the other hand, I'm not
  even sure how much entropy some unitialised data has.
  What do you people think about removing those 2 lines of code?
but I guess nobody on the openssl side was bothered to check
exactly what code Kurt was talking about and thus a potential
ROTFL moment turns out to be a security disaster.
[1] Random number generator, uninitialised data and valgrind

@_date: 2009-08-03 16:29:19
@_author: Alexander Klimov 
@_subject: Attacks against GOST? Was: Protocol Construction 
Do you want to say that the GOST (28147-89) block cipher is broken? I
have never heard of an attack against it that is faster than the
exhaustive search.
By the way, it was not "overdesign" (IMO it is simpler even than DES),
nor it was an example of "the stereotypical Soviet..." According to an
informed source [1], it was specifically made to be not like military
ciphers:  its only purpose was to make something for non-military
cryptography that would not betray any Soviet cryptographic know-how
(this is why they chose to do something very similar to DES).
[1] Mikhail Maslennikov, "Cryptography and freedom" (in Russian)

@_date: 2009-08-10 11:42:45
@_author: Alexander Klimov 
@_subject: brute force physics Was: cleversafe... 
A problem with this reasoning is that the physical world and the usual
digital computers have exponential simulation gap (it is known at
least in one direction: to simulate N entangled particles on a digital
computer one needs computations exponential in N). This can be
considered as a reason to suspect that physical world is
non-polynomially faster than the usual computers (probably even to an
extent that all NP computations can be simulated).
While it is possible to use physical world to simulate usual computers
in the straightforward way (namely by using voltage levels of a
circuit to represent separate bits), it is not clear that doing
computations in this way is the best way to do computations, for
example, if the meaning of our computations are simulation of the
physical world, then it can be better to use direct
physical-to-physical mapping instead of physical-to-usual followed by
usual-to-physical: analog computers, such as wind tunnels, are still
in use.
I am not aware of any plausible argument why a brute force search in
general (a quintessence of NP class, by the way) or a key search
against any particular algorithm cannot be implemented in a direct way
significantly faster than in the indirect way, that is NP-to-physical
instead of NP-to-usual followed by usual-to-physical. All the fuss
about quantum computing is exactly because people believe that a
different mapping (not thru usual computers) can be more efficient (if
I understand correctly, right now neither the class of algorithms that
can be sped up this way is understood, nor the quantum computers of
practical capacity exist).
I see the situation in the positive way: the recent AES attacks
stress the fact that the key management should be done
correctly, in particular, keys should be derived thru KDF (not
a simple xor) and must be authenticated. With this attack in
hand it is much easier for us now to say why one should not use
K to encrypt messages of one type and K+1 for another type, or
why it is a bad idea to encrypt a key in CTR mode and store the
result without a MAC. I doubt it is possible to find any
professionally designed protocol or standard that becomes weak
due to the recent discovery.
Of course, if AES-256 was used (say for hashing) with input as
the key, then nobody should be surprised that the version that
takes 256 bits at a time is weaker than the version that spends
comparable time for processing only 128 bits.

@_date: 2009-08-13 12:54:37
@_author: Alexander Klimov 
@_subject: brute force physics Was: cleversafe... 
"Obvious" assumptions are hardest to trace: they assume that the
computation is done by bit flips which flip only constant number of
bits. QM computation is done with the whole state, that is a flip in
an N-qbit state simultaneously flips 2^N numbers describing this
state (if it were simulated by a classical computer).
I hope we agree that an exponential speed-up by QM computation *is*
possible (unless factoring is in P). That is why if we hear that (1) a
"physical limit" says that 2^N bit-flips cannot be done in a
one-light-year computer in a year, and we know that (2) the best
classical M-bit factoring requires 2^N bit-flips, and we know that (3)
this factoring can be done in few minutes on a QM computer, then we
must conclude that such "physical limits" are misleading.
Thanks, it is great reading!
Whether NP is physically computable is an interesting topic, but its
applicability to our subject is quite limited: for cryptography it is
important to know that none of the puzzles created by a user can be
solved in some particular time given reasonable investment in
hardware, and thus the fact that hard instances exist as size tends to
infinity cannot console a practitioner.
There is a set of rules in cryptographic design that are well
known to practitioners and are ignored by kibitzers. In many
cases it is much easier to do a normal design than to explain
why some proposed "improvements" are bad.
Consider a situation where some "smart" person comes to you and
say that for some reason (say, to save space) they want to use
CBC encryption, but keep IV constant; or they want to do CBC
encryption and CBC-MAC with the same key (as a bonus they get
encryption for free). What options you have once you manage to
stop the laughter?  In some cases it is enough to say: "No,
SP800-38a in Appendix C requires IV for CBC to be
unpredictable," but in other cases you also need to show
a plausible-looking attack against the "improvement". In this
situation it is clearly an advantage to have a known weakness of
ignoring rules of sane key management.

@_date: 2009-02-01 16:45:24
@_author: Alexander Klimov 
@_subject: full-disk subversion standards released 
If there were a direct link from TPM to display and speakers and
all the content rendering were done by TPM itself, then TPM
would be useful for DRM. An attempt to render content "securely"
on CPU is based on a theory that content owner can trust general
purpose OS after "secure boot". Experience shows that this
theory is wishful thinking.
Apparently, the only existing application of TPM is BitLocker:
it allows to boot OS from an encrypted disk without entering any
password. A careful analysis shows that TPM is a separate chip
that can be powered down without reseting the CPU and thus one
can load "non-trusted OS", reset TPM, starts "secure boot", and
get encryption keys. Even when (if) TPM will be the same chip as
CPU, I suspect a man-in-the-middle attack on CPU-to-RAM
communication will allow to take over the "trusted OS".
On the other hand, once we forget about all attestation and
secure boot applications, TPM is still a smartcard soldered to
your computer, so probably it can allow all the smartcard
use-cases (except, of course, the uses-case that require storing
the smartcard separately from the computer :-).

@_date: 2009-02-12 18:15:43
@_author: Alexander Klimov 
@_subject: full-disk subversion standards released 
The treat model is completely different: for DRM the attacker is the
user who supposedly has complete access to computer, while for server
the attacker is someone who has only (limited) network connection to
your server.

@_date: 2009-02-17 12:06:49
@_author: Alexander Klimov 
@_subject: how to properly secure non-ssl logins (php + ajax) 
Unfortunately, they are right: get SSL.
I suspect what you have coded is a reinvention of RFC 2617
(implemented, e.g., by mod_auth_digest in Apache).
Depending on your threat model, this can be all you need
(plaintext password is not transmitted, but this does not prevent
local dictionary attacks), but any such scheme fails miserable
against active attacks.

@_date: 2009-05-24 13:41:11
@_author: Alexander Klimov 
@_subject: Warning!  New cryptographic modes! 
IMO the simplest solution is to rsync a file container encrypted by
TrueCrypt (each block is separately encrypted by XTS).

@_date: 2009-05-27 16:48:27
@_author: Alexander Klimov 
@_subject: white-box crypto Was: consulting question.... 
Could you explain what is the point of "white-box cryptography" (even
if it were possible)?
If I understand correctly, the only plausible result is to be able to
use the secret key cryptography as if it were the public-key one, for
example, to have a program that can do (very slow, btw) AES
encryption, but be unable to deduce the key (unable to decrypt). If
this is the case, then why not use normal public-key crypto (baksheesh

@_date: 2009-11-02 09:45:14
@_author: Alexander Klimov 
@_subject: Truncating SHA2 hashes vs shortening a MAC for ZFS Crypto 
If you use hash only to protect against non-malicious corruptions,
when why you use SHA-2? Would not MD5 or even CRC be enough?

@_date: 2009-11-09 10:00:45
@_author: Alexander Klimov 
@_subject: TLS man in the middle 
The attack does not directly allow to see any plaintext, it only
prepends your data with attackers plaintext.
IMO if the Great Firewall administrator wanted to intercept TLS
traffic they would do the usual TLS MitM attack with replacement of
certificates (as done by some corporate firewalls). Using the
renegotiation attack for purposes allowed by law seems to be too
round about.

@_date: 2009-11-19 12:12:17
@_author: Alexander Klimov 
@_subject: Crypto dongles to secure online transactions 
The reasons can sound crazy from the technical person's point of view,
like they may want to have a card with their name on it in your
wallet. There are rumors that this is what ruined the idea that a
single smartcard (e.g., JavaCard) can replace all cards in your

@_date: 2009-10-19 09:31:38
@_author: Alexander Klimov 
@_subject: Possibly questionable security decisions in DNS root management 
Maybe they try to optimize for verification time.
$ openssl speed
                  sign    verify    sign/s verify/s
rsa  512 bits 0.000823s 0.000069s   1215.2  14493.7
rsa 1024 bits 0.004074s 0.000200s    245.4   5008.0
rsa 2048 bits 0.024338s 0.000663s     41.1   1507.5
rsa 4096 bits 0.159841s 0.002361s      6.3    423.6
                  sign    verify    sign/s verify/s
dsa  512 bits 0.000651s 0.000765s   1535.2   1306.6
dsa 1024 bits 0.001922s 0.002322s    520.3    430.7
dsa 2048 bits 0.006447s 0.007551s    155.1    132.4

@_date: 2009-10-26 12:39:39
@_author: Alexander Klimov 
@_subject: US crypto/munitions again? 
Does it means that US starts the war on crypto-munitions
again or it is simply a new article about the status quo?
  October 24, 2009
  Since then, the Department of Commerce, which administers
  munitions exports, has made some changes, forming the Bureau
  of Industry and Security to deal with the likes of Dr. Dobb's
  and acknowledging the concept of both open source software and
  the Internet.  Now, organizations and individuals are required
  to notify the Bureau before making open source cryptographic
  software public on the Internet.

@_date: 2009-09-23 12:41:50
@_author: Alexander Klimov 
@_subject: QNAP backdoor 
The premium and new line of QNAP network storage solutions allow for
full hard disk encryption. When rebooting, the user has to unlock the
hard disk by supplying the encryption passphrase via the web GUI.
However, when the hard disk is encrypted, a secondary key is created,
added to the keyring, and stored in the flash with minor obfuscation.
Additional Weaknesses:
The backdoor key is generated by rand() calls. As the rand() function
produces random numbers unsuitable for cryptographic keys. The
cryptographic strength of this generated key is approx 2^32, hence
feasible for breaking. This would make access to the flash
Original Vendor FUD:
"The functionality for encryption the hard disk does not include a
crypto backdoor."
(in response to a user question why two keyslots are allocated, and if
this is because of a backdoor)

@_date: 2010-08-17 15:04:00
@_author: Alexander Klimov 
@_subject: About that "Mighty Fortress"...  What's it look like? 
Each real-time check reveals your interest in the check. What about
privacy implications?

@_date: 2010-08-26 18:24:26
@_author: Alexander Klimov 
@_subject: questions about RNGs and FIPS 140 
I guess you misinterpret it. In no place 140-2 "does not allow
TRNG".  It says that nondeterministic RNGs should be used
*only* for IVs or to seed deterministic RNGs:
  Until such time as an Approved nondeterministic RNG standard
  exists, nondeterministic RNGs approved for use in classified
  applications may be used for key generation or to seed
  Approved deterministic RNGs used in key generation.
  Commercially available nondeterministic RNGs may be used for
  the purpose of generating seeds for Approved deterministic
  RNGs.  Nondeterministic RNGs shall comply with all applicable
  RNG requirements of this standard.
  An Approved RNG shall be used for the generation of
  cryptographic keys used by an Approved security function.  The
  output from a non-Approved RNG may be used 1) as input (e.g.,
  seed, and seed key) to an Approved deterministic RNG or 2) to
  generate initialization vectors (IVs) for Approved security
  function(s).  The seed and seed key shall not have the same
  value.

@_date: 2010-08-31 18:05:42
@_author: Alexander Klimov 
@_subject: RSA question 
What is the goal of an attacker?
Since he knows plain-text, it is definitely not plain-text; on the
other hand, no operations with the public key can help the attacker to
get the private key, whether he does these operations himself or
observes somebody else doing them.

@_date: 2010-05-24 11:55:41
@_author: Alexander Klimov 
@_subject: Quantum Key Distribution: the bad idea that won't die... 
============================== START ==============================
  Unconditional security proofs of various quantum key
  distribution (QKD) protocols are built on idealized
  assumptions. One key assumption is: the sender (Alice) can
  prepare the required quantum states without errors. However,
  such an assumption may be violated in a practical QKD system.
  In this paper, we experimentally demonstrate a technically
  feasible "intercept-and-resend" attack that exploits such
  a security loophole in a commercial "plug & play" QKD system.
  The resulting quantum bit error rate is 19.7%, which is below
  the proven secure bound of 20.0% for the BB84 protocol.

@_date: 2013-09-03 19:36:22
@_author: Alexander Klimov 
@_subject: [Cryptography] FIPS, NIST and ITAR questions 
I used to believe that hashing (unlike encryption) was not considered

@_date: 2013-09-09 14:07:58
@_author: Alexander Klimov 
@_subject: [Cryptography] [cryptography] SSH uses secp256/384r1 which has 
specified in SP800-90 for Dual EC DRBG!
NIST SP 800-90A, Rev 1 says:
 The Dual_EC_DRBG requires the specifications of an elliptic curve and  two points on the elliptic curve. One of the following NIST approved  curves with associated points shall be used in applications requiring  certification under [FIPS 140]. More details about these curves may  be found in [FIPS 186], the Digital Signature Standard.
No. They are widely used curves and thus a good way to reduce conspiracy theories that they were chosen in some malicious way to subvert DRBG.

@_date: 2013-09-09 14:18:41
@_author: Alexander Klimov 
@_subject: [Cryptography] AES state of the art... 
I am not sure what is the exact attack you are talking about, but I guess you misunderstood the result that says: "the attack works against AES-256, but not against AES-128" as meaning that AES-128 is more secure. It can be the case that to break AES-128 the attack needs 2^240 time, while to break AES-256 it needs 2^250 time. Here AES-128 is not technically broken, since 2^240 > 2^128, but AES-256 is broken, since 2^250 < 2^256, OTOH, AES-256 is still more secure against the

@_date: 2013-09-09 14:53:11
@_author: Alexander Klimov 
@_subject: [Cryptography] A Likely Story! 
NIST recommends at least RSA-2048 for a long time, for example NIST Special Publication 800-57, back in August, 2005 said:
 [...] for Federal Government unclassified applications. A minimum of  eighty bits of security shall be provided until 2010. Between 2011  and 2030, a minimum of 112 bits of security shall be provided.  Thereafter, at least 128 bits of security shall be provided.
Note that
 RSA-1024 ~ 80 bits of security;  RSA-2048 ~ 112 bits;  RSA-3072 ~ 128 bits So if anyone to blame for using 1024-bit RSA, it is not NIST.
BTW, once you realize that 256 bits of security requires RSA with 15360 bits, you will believe conspiracy theories about ECC much less. Here exponentiation with 15360 bits takes 15^3=3375 times more CPU time than a 1024-bit exponentiation, thus using RSA for 256-bit security is impractical.
Can you elaborate on how knowing the seed for curve generation can be used to break the encryption? (BTW, the seeds for randomly generated curves are actually published.)

@_date: 2014-03-17 17:55:03
@_author: Alexander Klimov 
@_subject: [Cryptography] How can I make use of the AES hardware on new 
It makes no sense to subvert hardware AES implementation by not doing AES correctly, since most likely the user will immediately see that he cannot decrypt the encrypted. A reasonable attack is to save or communicate the key thru a covert channel. This attack cannot be prevented if you also encrypt 1% of data with software AES. On the contrary, the hardware AES may be less susceptible to side-channel attacks (SCA), while 1% of software AES may reveal enough data for SCA to succeed.

@_date: 2014-09-07 11:16:37
@_author: Alexander Klimov 
@_subject: [Cryptography] sunsetting SHA-1 in Chrome 
Chrome will start the process of sunsetting SHA-1 (as used in  certificate signatures for HTTPS) with Chrome 39 in November. HTTPS  sites whose certificate chains use SHA-1 and are valid past 1 January  2017 will no longer appear to be fully trustworthy in Chrome?s user  interface.
Of course, there will be a conspiracy theory explaining why SHA-2, designed by NSA in 2001, is better than SHA-1, designed (and fixed) by NSA in 1993 and 1995.

@_date: 2014-09-25 08:59:21
@_author: Alexander Klimov 
@_subject: [Cryptography] Of writing down passwords 
Beware of cameras! Their resolution now is so good that an attacker without physical access can steal all your passwords using the reflection in your eyes.
Generate you own with pwgen.

@_date: 2014-09-27 10:09:42
@_author: Alexander Klimov 
@_subject: [Cryptography] Of writing down passwords 
One reason could be exactly that it allows to implement a better "corneal imaging system" as suggested in 2005 [1]:
  It turns out that the cornea of an eye and a camera viewing the
  eye form a catadioptric imaging system. We refer to this as a corneal
  imaging system. Unlike a typical catadioptric system, a corneal one is
  flexible in that the reflector (cornea) is not rigidly attached to the
  camera. Using a geometric model of the cornea based on anatomical
  studies, its 3D location and orientation can be estimated from a
  single image of the eye. Once this is done, a wide-angle view of the
  environment of the person can be obtained from the image. In addition,
  we can compute the projection of the environment onto the retina with
  its center aligned with the gaze direction. This foveated retinal
  image reveals what the person is looking at. We present a detailed
  analysis of the characteristics of the corneal imaging system
  including field of view, resolution and locus of viewpoints. When both
  eyes of a person are captured in an image, we have a stereo corneal
  imaging system. We analyze the epipolar geometry of this stereo system
  and show how it can be used to compute 3D structure. The framework we
  present in this paper for interpreting eye images is passive and
  non-invasive. It has direct implications for several fields including
  visual recognition, human-machine interfaces, computer graphics and
  human affect studies.
In 2008 [2], it was possible to read text in reflections "from the other side of the street or from a close-by building". They were using a telescope, but see their Figure 1 taken with a camera from a short [1] [2]

@_date: 2015-06-17 14:42:14
@_author: Alexander Klimov 
@_subject: [Cryptography] chromium: unconditionally downloads binary blob 
After upgrading chromium to 43, I noticed that when it is running and immediately after the machine is on-line it silently starts downloading "Chrome Hotword Shared Module" extension, which contains a binary without source code. There seems no opt-out config.
that extension:
- doesn't appear in the extension list;
- is apparently used to provide an ok google voice activation stuff.
The fact that Audio Capture Allowed is set to yes, and that both the
extension and the shared module are marked as enabled are definitely
bothering me.
We believe that the bug you reported is fixed in the latest version of
chromium-browser, which is due to be installed in the Debian FTP Shouldn't we see a DSA [Debian Security Advisory] following this Since no one really know which binaries have been downloaded there and
what they actually do, and since it cannot be excluded that it was
actually executed, such systems are basically to be considered
Quite a deal of people choose open source just to prevent that - get
untrustworthy / unverifiable code run on their systems - failed.

@_date: 2016-05-22 19:19:03
@_author: Alexander Klimov 
@_subject: [Cryptography] Entropy Needed for SSH Keys? 
The proper design is to use TRNG to seed DRBG (aka PRNG) and use only DRBG for crypto purposes. The idea that entropy of DRBG state can be lost due to its use is misleading. Once you have enough bits to seed DRBG (say, 384 bits for 256-bit security) you can use DRBG to generate all the keys you need.
The only reason one may want to reseed DRBG (by getting more bits from TRNG) is if he is afraid that someone learned the DRBG state (say, by reading kernel memory). I guess it is not your case.

@_date: 2018-02-08 15:00:47
@_author: Alexander Klimov 
@_subject: [Cryptography] changes in final NIST SP 800-90B 
A month ago NIST Special Publication 800-90B Recommendation for the Entropy Sources Used for Random Bit Generation was published. Anyone knows where the non-editorial changes since the "Second DRAFT" can be

@_date: 2018-02-11 10:11:43
@_author: Alexander Klimov 
@_subject: [Cryptography] Useless side channels 
A nitpick: Figure 9 (page 11) of  shows a more realistic situation, where it is the smartphone that is put inside a Faraday cage (bag) next to an air-gapped computer.

@_date: 2018-02-12 14:09:20
@_author: Alexander Klimov 
@_subject: [Cryptography] Useless side channels 
Once the data from an air-gapped computer is gathered by the phone, it will send it to attacker thru WiFi or modem.
Many smartphones cannot be really turned off, that is you cannot disconnect the battery every time you report to work on an air-gapped computer, thus workers switch the phone off and put it into a Faraday bag for extra protection.
IIUC, there is no other "test equipment" except the compass in the

@_date: 2018-03-14 22:08:21
@_author: Alexander Klimov 
@_subject: [Cryptography] Avoiding PGP 
As far as the use-case is to send messages to offline users you know, PGP is simply perfect. Practically, as far as family and close friends go, you can set it up for your kids or grandma and it simply works.
The problem only starts then none of the users is tech-savvy or only one is and he cannot support the other. I think this is quite rare use-case and it is very unlikely that someone without knowledge or support will be able to use any cryptographic system securely, so we should not blame GnuPG here.

@_date: 2018-03-16 18:11:32
@_author: Alexander Klimov 
@_subject: [Cryptography] Avoiding PGP 
That is why you do not explain WoT to them: you simply go to the grandma place, generate her key pair, take her public key to your device, put your public key on her device, configure her mail agent to use the key by default.
Compared to the time you spend teaching her to find inbox in the UI and how to interpret various number of ">" in the start of the line (and how to avoid messing with them), the key exchange you did is absolutely negligible.
This way you betray her mobile number. That would be strange idea, since the first thing I teach the grandma about is to never type-in her personal information.
We were talking about email. If you want IM, simply teach the grandma to start Pidgin and initiate OTR for her. Again a two-minute task which is absolutely negligible compared to the rest of the teaching.
Nope, for the grandma it is completely transparent.
I have not noticed that: professionals around me mostly use GnuPG. S/MIME is rare and mostly used for signatures. Encrypted 7-Zip files are common with lawyers, etc.

@_date: 2019-02-22 13:37:39
@_author: Alexander Klimov 
@_subject: [Cryptography] How widely are the PSK modes used? 
PSK is rare in web for humans, common in LwM2M (DTLS, actually).
