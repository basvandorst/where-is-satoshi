
@_date: 2003-12-12 14:15:17
@_author: Stefan Lucks 
@_subject: example: secure computing kernel needed 
First "Solution": Erease and load by hand
What would be wrong with
  1. ereasing the memories of the students' calculators
  2. loading the approved apps and data
immediately before the exam? (I assume, the students can't load
un-approved applications during the exam.)
(This is what some our teachers actually did when I went to school.
 Since there where no approved apps and data, step 2 was trivial. ;-)
2. "Solution": testguard and the like
  1. Load and
  2. run
a trusted application with full access to all resources (including storage
for applications and data, and CPU time, thus blocking all the other stuff
which might be running in parallel), nothing can prevent this application
from deleting all non-approved appliations and data.
I am not sure, what testguard actually does, but the above is, what it
*should* do.
The existence of a trusted kernel would only complicate things, not
simplify them. (You had to make sure that your application is running in
the highest privileges mode ...)
I think, both of my proposed "solutions" would actually solve your
problem. Else, please describe your thread model!
Without understanding your problem, no cryptographer can provide any
solution. And if (given a proper definition of the problem) it turns out
that there is a non-cryptographic solution which works -- so what?

@_date: 2003-12-15 18:33:47
@_author: Stefan Lucks 
@_subject: Difference between TCPA-Hardware and a smart card (was: example: 
There are two differences between TCPA-hardware and a smart card.
The first difference is obvious. You can plug in and later remove a smart
card at your will, at the point of your choice. Thus, for homebanking with
bank X, you may use a smart card, for homebaning with bank Y you
disconnect the smart card for X and use another one, and before online
gambling you make sure that none of your banking smart cards is connected
to your PC. With TCPA, you have much less control over the kind of stuff
you are using.
This is quite an advantage of smart cards.
The second point is perhaps less obvious, but may be more important.
Usually, *your* PC hard- and software is supposed to to protect *your*
assets and satisfy *your* security requirements. The "trusted" hardware
add-on in TCPA is supposed to protect an *outsider's* assets and satisfy
the *outsider's* security needs -- from you.
A TCPA-"enhanced" PC is thus the servant of two masters -- your servant
and the outsider's. Since your hardware connects to the outsider directly,
you can never be sure whether it works *against* you by giving the
outsider more information about you than it should (from your point if
There is nothing wrong with the idea of a trusted kernel, but "trusted"
means that some entity is supposed to "trust" the kernel (what else?). If
two entities, who do not completely trust each other, are supposed to both
"trust" such a kernel, something very very fishy is going on.
Can we do better?
More than ten years ago, Chaum and Pedersen presented a great idea how to
do such things without potentially compromising your security. Bringing
their ideas into the context of TCPA, things should look like in the
following picture
   +---------------+         +---------+         +---------------+
 Outside World | <-----> | Your PC | <-----> | TCPA-Observer |
   +---------------+         +---------+         +---------------+
So you can trust "your PC" (possibly with a trusted kernel ... trusted by
you). And an outsider can trust the observer.
The point is, the outside world does not directly talk to the observer!
Chaum and Pedersen (and some more recent authors) defined protocols to
satisfy the outsider's security needs without giving the outsider any
chance to learn more about you and the data stored in your PC than you
want her to learn.
TCPA mixes "Your PC" and the "observer" into one "trusted kernel" and is
thus open to abuse.
  D. Chaum and T. Pedersen. Wallet databases with observers.
  In Crypto '92, LNCS 740, pp. 89-105.

@_date: 2003-12-16 10:02:11
@_author: Stefan Lucks 
@_subject: Difference between TCPA-Hardware and a smart card (was: example: 
[I wrote]
Strange! Currently, I have three smart cards in my wallet, which I did not
want to own and which I did never pay for. I never used any of them. They
are packaged with some ATM cards (using conventional magnetic-stripe
technoloby) and implement a "Geldkarte".  (Since a couple of years, German
banks try to push their customers into using the "Geldkarte" for
electronig money, by packaging the smart cards together with ATM cards.
For me, there ares still too few dealers accepting the "Geldkarte", so I
never use it.)
OK, the banks are paying for the smart cards they give to their customers
for free. But they would not do so, if these cards where expensive.
BTW, even if you have only one, a smart card has the advantage that you
can physically remove it.
A smart card can do the same.
The point is that Your system is not supposed to prevent You from doing
anything I want you not to do! TCPA is supposed to lock You out of some
parts of Your system.
I am not sure, whether I fully understand you. If you mean that TCPA
comes with the option to run a secure kernel where you (as the owner and
physical holder of the machine running) have full control over what the
system is doing and isn't doing -- ok, that is a nice thing. On the other
hand, we would not need a monster such as TCPA for this.
Feel free to buy an overpriced second-hand car from me. I promise, I won't
object! ;-)
But seriously, with or without remote attestation, I would not consider my
secrets safe on your machine. If you can read (or play, in the case of
multimedia stuff) my secrets on your machine, I can't prevent you from
copying. TCPA (and remote attestation) can make copying less convenient
for you (and the RIAA is probably pleased with this), but can't stop a
determined adversary.
In other words, I don't think it will be too difficult to tamper with the
TCPA hardware, and to circumwent remote attestation.
Winning against the laws of information theory is not simpler than winning
against the laws of thermodynamics -- both are impossible!
Let me stress:
  -- Good security design means to separate duties.
  -- TCPA does exactly the opposite: It deliberately mixes duties.
It doesn't need to know, and it can't know anyway. All it needs to know
whether itself has been tampered with. Well, ... hm ... it more or less
assumes itself has not been tampered with (but so does the TCPA hardware).
You get them at the same place where you get TCPA hardware: In a possible
future. ;-)

@_date: 2003-12-16 10:51:17
@_author: Stefan Lucks 
@_subject: Difference between TCPA-Hardware and a smart card (was: example: 
Strangely enough, Carl Ellison assumed that you would have at most one
smart card, anyway. I'd rather think you are right, here.
I agree with you: A good compromise between security and convenience is an
issue, when you are changing between different smart cards. E.g., I could
imagine using the smart card *once* when logging into my bank account,
and then only needing it, perhaps, to authorise a money transfer.
This is a difficult user interface issue, but something we should be able
to solve.
One problem of TCPA is the opposite user interface issue -- the user has
lost control over what is going on. (And I believe that this originates
much of the resistance against TCPA.)
Agreed again!
Actually, all users have to trust the owner (or rather the sysadmin).
The key words are "have to trust"! As you wrote somewhere below:
I entirely agree with you!
Please re-read the paper!
First, it is not a mechanism for *creating* trust.
It is rather a trust-avoidance mechanism! You are not trusting the
observer at all, and you don't need to. The outsider is not trusting you
or your PC at all, and she donesn't need to.
Second, how on earth did you get the impression that Chaum/Pedersen is
about proprietary non open implenentations?
Nothing stops people from producing independent and verified
implementations. As a matter of fact, since people can concentrate on
writing independent and verified implementations for the sofware on "Your
PC", providing an independently produced and verified implementation woud
be much much simpler than ever providing such an implementation for the
TCPA hardware.
Independent implementations of the observer's soft- and hardware are
simpler than in the case of TCPA as well, but this is a minor issue. You
don't need to trust the observer, so you don't care about independent and
verified implementations.
With a Chaum/Pedersen style scheme, the chances of ever getting
independent (and possibly verified) implementations are much better than
in the case of TCPA.
As I wrote in my response to Carl Ellison's response, one of the main
advantages of the Chaum/Pedersen style approach is a clear separation of
duties. The TCPA misses this separation, and this is a sign of bad
security design.

@_date: 2005-06-02 19:12:09
@_author: Stefan Lucks 
@_subject: Collisions for hash functions: how to exlain them to your boss  
Magnus Daum and myself have generated MD5-collisons for PostScript files:
  This work is somewhat similar to the work from Mikle and Kaminsky, except that our colliding files are not executables, but real documents. We hope to demonstrate how serious hash function collisions should be taken -- even for people without much technical background. And to help you, to explain these issues   - to your boss or your management,
  - to your customers,
  - to your children ...
Have fun

@_date: 2006-03-22 08:25:47
@_author: Stefan Lucks 
@_subject: passphrases with more than 160 bits of entropy 
What kind of application are you running, that > 150 bits of entropy is
As I understand your proposal, you split up the passphrase P into L Blocks
P_1, ..., P_L, (padding the last block P_L as neccessary) and then you
output L*160 bit like this:
This does not look like a good idea to me:
   1.	If the size of the P_i is the internal block size of the hash
   2.	If the local entropy in each block P_i (or even the conditional
 	entropy in P_i, given all the P_{i-1}, ..., P_1) is low, then you
   3.	In fact, to calculate the entropy of F(P), you can take the
Any better solution I can think of will be significantly less performant
than just applying H(P). One idea of mine would be the function G:
   *	Let  be a counter of some fixed size, say 32 bit.
   *	Let J+1 be the number of 160-bit values you need (e.g., J = 4*L).
   *	G(P) = ( H(P_1,<0>,P_1,P_2,<0>,P_2, ..., P_L,<0>,P_L),
Would that be OK for you application?
In any case, I think that using a 160-bit hash function as a building
block for a universal one-way function with (potentially) much more than
160-bit of entropy is a bit shaky.

@_date: 2007-07-03 10:01:19
@_author: Stefan Lucks 
@_subject: The bank fraud blame game 
There is a big difference between a TPM providing this kind of service, and Peter's device. The TPM is supposed to be hard-wired into a PC -- so if you are using it to safe your banking applications, you can do banking at one single PC. On the other hand, Peter's device is portable, you can use it to do safe banking from your PC at home, or in the office (only during lunch-breaks with the employer's permission of course), or even at a public internet cafe. To this end, Peter's device would be much more useful for the customer than a TPM ever could be.
BTW, Peter, are you aware that your device looks similar to the one proposed in the context of the CAFE project? See
   This has been a more ambitious project, not just supporting secure banking applications at an insecure host PC, but rather a digital wallet.
Nevertheless, it may be interesting to study why the project failed (or ended without follow-on projects). I have no quick answer to this question, but as much as I understand, the banks where just not interested in deploying such a device. I guess, it was much too expensive at that time. Instead, in Germany we got the "Geldkarte", a simple and very cheap smartcard for payment purposes with neither a display nor a keyboard. The "Geldkarte" has been around us for about ten years, and, as far as I can tell, hardly any customer is interested in using it.
So long
