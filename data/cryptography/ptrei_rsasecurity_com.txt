
@_date: 2001-04-03 16:40:54
@_author: Trei, Peter 
@_subject: RSA Conference Expo free passes are still available. 
Sorry for the late notice, but I just found out that
the deadline for obtaining free passes has been
extended. While the website puts the free pass period as ending
a month ago, they are actually still available, but will
probably end today. At the door, they are $50.
What: Expo section at the RSA Security 2001 Conference Where:  Moscone Center, San Francisco When: 9am-5pm 10-11 April 2001
How:   Regsiter at Peter Trei

@_date: 2001-12-28 14:40:02
@_author: Trei, Peter 
@_subject: Stegdetect 0.4 released and results from USENET search availa 
There's a much simpler reason why few or no stego'ed messages are
present in usenet images: They form an inefficient  and unneeded distribution mechanism.
Try taking a peek at the Usenet newsgroup alt.anonymous.messages.
Dozens for PGP'd messages a day, from our old friends Secret Squirrel, Nomen Nescio, and Anonymous. Usenet has some very good properties for those wishing to maintain
privacy: multiple entry points, including from mail2news gateways,
flooding distribution independent of message content, and knowledge
of who reads what is restricted to the server from which the news is
read (and there are 1000's of news servers, as well as web based
systems such as groups.google.com). But you already know this.
Posting PGP to aam also avoids the bandwidth bloat imposed by stego,
and the extra complication of having to stego and destego images, as
well as generate the images used for cover.
Why would anyone bother hide tiny messages in ebay images or
alt.binaries.erotica.bestiality.hamster  when they can just post to Peter Trei
This e-mail, its content and any files transmitted with it are intended
solely for the addressee(s) and are PRIVILEGED and CONFIDENTIAL.  Access by any other party is unauthorized without the express
prior written permission of the sender.  If you have received this e-mail in error you may not copy, disclose to any
third party or use the contents, attachments or information in any way, Please delete all copies of the e-mail and the
attachment(s), if any and notify the sender. Thank You.

@_date: 2001-07-30 11:22:30
@_author: Trei, Peter 
@_subject: Effective and ineffective technological measures 
Take a look at Sklyarov's presentation:
and especially The listed company allegedly puts ROT13 in a dongle,
and then encrypts documents for $3000 a pop.
[In fairness, I can't confirm this from their own website,
and I suspect that they are just 'protecting' their own
investor reports].
....but read the whole Sklyarov presentation - this is
not the most fraudulent form of 'protection' being
foisted on naive e-publishers.
Peter Trei

@_date: 2001-06-04 13:33:00
@_author: Trei, Peter 
@_subject: Starium (was Re: article: german secure phone) 
You might want to look at Privatel
This is a voice only device.
Curiously, at the RSA Conference, they also showed the Privatel xi, which looked like , and also supported encrypted data.
Peter Trei

@_date: 2001-06-05 13:09:03
@_author: Trei, Peter 
@_subject: NSA tapping undersea fibers?  
There's an awful lot of uninformed speculation about how
undersea cabling is done in this thread.
I strongly reccomend that folks interested in this topic
read Neal Stephenson's very detailed (and entertaining!)
discussion of the topic in Wired, at
Peter Trei
A few quotes:
Shallow water is the most perilous part of a cable's route. Extra
precautions must be taken in the transition from deep water to
the beach, and these precautions get more extreme as the
water gets more shallow. Between 1,000 and 3,000 meters, the
cable has a single layer of armor wires (steel rods about as thick
 as a pencil) around it. In less than 1,000 meters of water, it has
a second layer of armor around the first. In the final approach to
the shoreline, this double-armored cable is contained within a
massive shell of articulated cast-iron pipe, which in turn is
buried under up to a meter of sand. Beyond 300 meters, the cable must still be buried to protect it
from anchors, tickler chains, and otter boards Over long (intercontinental) distances, the difference averages out to about
1 percent, so you might need a 2,525-kilometer cable to go from Songkhla to
Lan Tao. The extra 1 percent is slack, in the sense that if you grabbed the ends and pulled the cable infinitely tight (bar tight, as they say in the
business), it would theoretically straighten out and you would have an extra
25 kilometers. This slack is ideally molded into the contour of the seafloor
tightly as a shadow, running straight and true along the surveyed course. As
little slack as possible is employed, partly because cable costs a lot of
(for the FLAG cable, $16,000 to $28,000 per kilometer, depending on the
amount of armoring) and partly because loose coils are just asking for trouble
from trawlers and other hazards. In fact, there is so little slack (in the
layperson's sense of the word) in a well-laid cable that it cannot be grappled and
hauled to the surface without snapping it.

@_date: 2001-06-15 11:28:04
@_author: Trei, Peter 
@_subject: RC5-64 attack reaches 50% mark. 
The only RSA Secret Key Challenge known to be under active attack
at this time is RC5-64, by distributed.net. Last night this reached the 50% mark, having tested  9,225,283,403,065,065,472  keys at the time I write this, over 1331 days. The current rate is over 210 Gkeys/sec - they should complete the keyspace in the next 18 months.
See: Way back in the previous millenium, RSA (then Security Dynamics)
issued a series of 'secret key challenges', in which prizes were
offered for decrypting messages encrypted wish RC5 and DES.
I was responsible for getting SDTI to create the challenges, proposing
them to Jim Bidzos to complement the long standing RSA factoring
contests back in 1996. I was mainly interested in demonstrating that 56 bit DES (then the strongest exportable algorithm) was inadequate, and had created a proof-of-principle DES key-cracker  to demonstrate that the goal was achievable. Jim thought this was a good idea, and I was soon collaborating with RSA Labs in the design of the challenges - long before I came to work at SDTI/RSA.
The first challenge (40 bit RC5) fell in 3.5 hours, and was soon followed
by others, leading up to the 3rd DES challenge in 1999, when distributed.net and the EFF combined to brute force a 56 bit DES key in 23 hours.
The success in the attacks on the Secret Key Challenges created facts on the ground exposing the weakness of exportable crypto, and
in my opinion were important in causing the relaxation of US export regulations in early 2000
Peter Trei

@_date: 2001-06-26 13:53:15
@_author: Trei, Peter 
@_subject: Turing honored with statue. 
Conqueror of enigma code finally honoured
By Paul Francis
23 June 2001
Alan Turing, the national hero who broke the Nazi's enigma
code and is credited with turning the tide of the World War
Two, is to be honoured with a life-size statue.
The bronze monument, which will be unveiled today, comes
almost 50 years after the brilliant scientist was driven to
suicide by persecution over his homosexuality. Five years after
its inception, the 20,000 pound sterling sculpture of Turing
sitting on a bench holding an apple will be displayed
Manchester's Sackville Park in the city centre.
The mathematical genius became a national hero after his
involvement in World War Two, he also helped invent the
inaugural computer, at Manchester University, but was
persecuted and prosecuted for his homosexuality. He
committed suicide in 1954 by eating a poisoned apple.
Many believe Turing has never been recognised properly for his
outstanding contribution to science. But Glyn Hughes, the
statue's creator, is confident that Turing has finally earned his
rightful place in the history books. Hughes, from Adlington near
Chorley, said: " It's stunningly realistic. I'm sure it will go a dirty
black over time, but it looks wonderful today."

@_date: 2001-05-14 10:51:04
@_author: Trei, Peter 
@_subject: forwarded message from tylera19@hotmail.com 
It's an attempt by a spambot to get by a 'uniqueness filter'. A quick
google (Google is your friend) gives the stuff appended below. Peter Trei
Please ignore anything below the "End of Message" line.
What looks like extraneous text is automatically inserted into
our messages by our software mailing program
and constitutes what is called a "unique text insertion" or UTI.
It allows this message to bypass filters on some of the larger domains.
That's all.
Thank you for understanding. Success Unlimited International.
End of message.
Conversely,  this  analysis  of  a  formative  as  a pair of sets of
features  must  utilize  and  be  functionally  interwoven  with the
profound  meaning  of  "The  Raw  and  the  Cooked".   However,  the
incorporation  of additional mission constraints is unspecified with
respect  to  a  parasitic  gap  construction.   For  one  thing, any
exponential  Folklife  coefficient  effects  a  significant
implementation  of the anticipated fourth-generation equipment.   By
combining  adjunctions  and  certain  deformations,  the  earlier
discussion  of  deviance  necessitates  that coagulative measures be
applied  to  all  deeper  structuralistic conceptualization.   Thus,
within  given  parameters,  our  fully  integrated  field program is
further  compounded  when  taking  into  account  the  sophisticated
hardware.   Notice,  incidentally,  that  the  fundamental  error of
regarding  functional  notions as categorial suffices to account for
the overall negative profitability.   This suggests that the earlier
discussion  of  deviance  adds  explicit  performance  contours  to
possible  bidirectional  logical relationship approaches.   Clearly,
the  incorporation of agonistic cultural constraints is functionally
equivalent  and  parallel  to  an  important distinction in language
use.   By combining adjunctions and certain deformations, the notion
of  level  of grammaticalness necessitates that coagulative measures
be  applied  to  a  descriptive  fact.   Analogously,  the  fully
integrated  test  program is holistically compounded, in the context
of  the  levels  of  acceptability  from  fairly  high (eg (99a)) to
virtual gibberish (eg (98d)).

@_date: 2001-05-23 10:25:16
@_author: Trei, Peter 
@_subject: RSA Security announces new Factoring Challenges 
My employer, RSA Security, has revamped its Factoring Challenges.
Prizes now start at US$10,000 (factorization of a 576 bit modulus) to
US$200,000 (factorization of a 2048 modulus).
These are much higher prizes than were previously offered, and it is
hoped that their offer will spur new research.
For details, including the challenge numbers, see:
Peter Trei
RSA Security Inc.
ptrei at rsasecurity.com

@_date: 2001-11-28 11:19:42
@_author: Trei, Peter 
@_subject: private-sector keystroke logger... 
...or takes the data of interest (which is generally fairly small),
uuencodes it,
and sends it in an email or an encrypted usenet posting.
Any application which allows in interior machine to send data to the outside
creates a potential covert channel.  There's a reason why classified
are airgapped.
Peter Trei

@_date: 2001-10-01 11:19:00
@_author: Trei, Peter 
@_subject: Best practices/HOWTO for key storage in small office/home off 
I'd say you need to define your threat model a bit....
If you're worried about losing access to your key
accidentally, encrypt it with a strong passphrase
you are unlikely to forget and store multiple
copies - send it to a mailing list with persistant
archives (I hope you don't use cpunks :-), or even
print it in hex and store paper copies in various places. If your in dire straits you can always type
it in.
If you're worried about someone else accessing
the key, something like 3 is probably best (look
into my company's Keon product), but I'd consider
keeping the card with your person when not in use. Smartcards are usually PIN or password protected,
and an adversary who can get it off of you, but not
out of the safe, is unlikely to be able to use without
your cooperation - and at least you know it's been
I'd also worry a lot about disk remanence on whatever
system makes use of the keys - hopefully
you're running with a encrypted fs. Solution 1 might
work too, if you trust the safe.
Peter Trei

@_date: 2001-10-08 10:25:30
@_author: Trei, Peter 
@_subject: RC4 [was: RE: Passport Passwords Stored in Plaintext] 
[This response probably can't get to all of the lists to which  the original message was addressed to. Feel free to forward  it to those lists, if you can, and to other addresses as needed.
 -pt]
[I work for RSA, which owns RC4]
I strongly suggest that Alex and other interested parties read
Ron Rivest's recent paper on precisely this issue. It can be found at In protocols such as WEP, it is often necessary to generate different RC4 keys from different messages (or packets) from a common base key. A method frequently suggested to obtain the keys is to add or concatenate a counter to the base key. The
key-scheduling algorithm of RC4 has been widely recognized to be rather lightweight for this purpose, particularly when the initial few bytes of plaintext are easily predictable. RSA Security has discouraged such key derivation methods, recommending instead that users consider strengthening the key scheduling algorithm by pre-processing the base key and any counter or initialization vector by passing them through a hash
function such as MD5. Alternatively, weaknesses in the key scheduling algorithm can be prevented by discarding the first 256 output bytes of the pseudo-random generator before beginning encryption. Either or both of these techniques suffice to defeat the new attacks on WEP and WEP2.
(end extract)
Essentially, WEP sends successive packets (with well
known headers) using the initial output of RC4 keyed
with successive keys. This opens WEP up to a related-key attack.
I'm really curious what led to the use of RC4 in this
weird mode; a block cipher in CBC mode would have been more appropriate. I suspect that the selection was made  at a time when 40bit RC4 was [relatively] easy to export, while stronger block ciphers such as 56 bit DES were not. The moral re crypto restrictions is left to the reader.
Peter Trei
[Disclaimer: I work for RSA, but this note contains
my own opinions.]

@_date: 2001-10-16 10:43:52
@_author: Trei, Peter 
@_subject: Scarfo "keylogger", PGP 
Windows programs can incorporate the GUI components (MFC libraries, etc)
either as staticly linked libraries at compiliation time, or (more commonly)
dynamically linked libraries (DLLs).
One of my continual gripes about Windows security has to do with the GUI
DLLs. An attacker could silently replace a component with one which has
the old version number and the same API as the normal one, but which does something extra - for example, the component which handles the
textbox for entering passwords could check the system table to see if
the active program was PGP, and if so log the text entered. The user would be none the wiser, and even re-installing PGP would not restore
A secure system would use crytographically signed components,
and an application would check the signatures before loading a dynamic library. An attacker would then need to get the trojaned
components signed, which raises the bar.
Windows XP at least checks for drivers not signed by MS, but whose security this promotes is an open question.
Peter Trei

@_date: 2001-10-30 16:32:56
@_author: Trei, Peter 
@_subject: Yet more stego scare in the New York Times 
I'd add two:
with very limited traceback ability, and figuring out who has read a given message is also very difficult. Check out alt.anonymous.messages.
this group's posters are also heavy users of anonymous remailers and PGP. If
OBL & co were actually using the Internet, this is a heck of a lot simpler
stego'd images.
 The better of these use SSL and encrypted URLs, also manage
cookies intelligently. They sheild the user from both identification by the
target site,
and block an observer (for example, at a firewall) between the user and the
proxy from identifying the target site. Of course, none of this is shielded from the
proxy owner.
Peter Trei

@_date: 2001-09-17 11:15:53
@_author: Trei, Peter 
@_subject: Rijndael in Assembler for x86? 
I'll chime in with Perry here - The newer processors are insanely complex
beasties, with multiple execution units allowing some internal parallelism,
subject to register contention and under very complex rules. Anyone who
thinks they can do better optimizing within a small window is naive, or
much, much better than the average run of programmer.
Back when I was doing proof-of-principle for the DES crack, I spent a *lot*
of time optimizing DES code for the Pentium. While handoptimizing for
that processor more than doubled the speed, the really big gains all came from a higher level understanding of the problem; in particular my insight on speeding up key schedule generation about 80x, and the perversion of the Pentium II MMX registers to run 'bitslice' (no, I didn't
that) algorithms, testing 64 keys in parallel. The optimizing compilers have generally exceeded human ability in low-level optimizing - not that that won't stop me from trying, now and BTW, the code used for the DES crackers bears about as much
resemblence to regular DES code as a top-fuel dragster does to
a Toyota Corolla - its tweaked to a fare-thee-well for one function,
and totally useless for all others. Peter Trei

@_date: 2001-09-26 13:39:57
@_author: Trei, Peter 
@_subject: [FYI] Antiques man guilty of Enigma charge  
Only 3 in the world? I don't think so. At the last RSA conference, the
NSA had a historical 'museum', including an enigma. The woman running it said there were at least 40 still around. I know one firm which has two of them, along with various other
historical crypto HW.
They're rare, but not *that* rare. The toughest part in keeping
them going is getting the odd little lightbulbs which indicate the

@_date: 2002-04-16 15:54:27
@_author: Trei, Peter 
@_subject: Schneier (and RSA)  on Bernstein factoring machine 
Anonymous is missing the joke here. Bruce suggests that ordinary
non-paranoid users (here represented as 'businesses') should feel reasonably content with 1024 bit keys, but 'military institutions and those paranoid enough to fear them should have upgraded years ago'.
So, we have three categories of users: 1. businesses (ie, 'ordinary users)
2. Military institutions.
3. The paranoid (whether justified or not).
Well, Lucky's not a business, and he's certainly not a military
institution (despite his fondness for ordinance). What does that leave? Most of us who know him got a little chuckle out of this.
For RSA's 'official' position on this issue, take a look at:
If there's a call for it, I'll post the whole text so you can read
it without visiting our site (it's not too long).
Peter Trei
RSA Security

@_date: 2002-04-17 16:15:53
@_author: Trei, Peter 
@_subject: Schneier (and RSA)  on Bernstein factoring machine 
The last time you looked was too long ago, I'm afraid. Lucky is no
longer with RSA.

@_date: 2002-04-26 14:17:05
@_author: Trei, Peter 
@_subject: Disk encryption standards (was: RE: Two ideas for random number g 
A call for algorithms will be issued shortly. The WG chair, Jim Hughes,
"What I will be asking for is a mode that allows disk blocks to be
encrypted using an implicit IV (disk block number) and be non-mallable.
That is if any bit is tampered then the entire disk block is randomized.
Disk blocks can be any small multiple of 512 bytes. Typical values are
512, 1024, 2048 etc. bytes."  Have fun.
Peter Trei

@_date: 2002-08-01 16:14:06
@_author: Trei, Peter 
@_subject: Challenge to David Wagner on TCPA 
I'm going to respond to AARGH!, our new Sternlight, by asking two questions.
1. Why can't I control what signing keys the Fritz chip trusts? If the point of TCPA is make it so *I* can trust that *my* computer to run the software *I* have approved, and refuse to run something which a virus or Trojan has modifed (and this, btw, is the stated intention of TCPA), then why the hell don't I have full control over the keys? If I did, the thing might actually work to my benefit.
The beneficiary of TCPA when I don't have ultimate root control is
not I. It is someone else. That is not an acceptable situation.
2. It's really curious that Mr. AARGH! has shown up simultaneously
on the lists and on sci.crypt, with the single brief of supporting TCPA.
While I totally support his or her right to post anonymously, I can only
speculate that anonymity is being used to disguise some vested interest in supporting TCPA. In other words, I infer that Mr. AARGH!
is a TCPA insider, who is embarassed to reveal himself in public.
So my question is: What is your reason for shielding your identity?
You do so at the cost of people assuming the worst about your
Peter Trei
 PS: Speculating about the most tyrannical uses to which a technology can be put has generally proved a winning proposition.

@_date: 2002-08-02 10:43:21
@_author: Trei, Peter 
@_subject: Challenge to David Wagner on TCPA 
Not really. However, in todays actual environment, this is frequently true that those with something to hide use anonymity. While some people have maintained nyms for many years (I can't
think of anyone maintaining explicit stong anonymity right now,
actually - remember Sue D. Nym? ),  and used them to talk about a variety of issues, it's pretty rare.
It's rare enough that when a new anononym appears, we know
that the poster made a considered decision to be anonymous.
The current poster seems to have parachuted in from nowhere, to argue a specific position on a single topic. It's therefore reasonable  to infer that the nature of that position and topic has some bearing on the decision to be anonymous.
Since the position argued involves nothing which would invoke the
malign interest of government powers or corporate legal departments, it's not that. I can only think of two reasons why our corrospondent
may have decided to go undercover... 1. If we know who he/she/them were, it would weaken the argument
(for example, by making it clear that the poster has a vested interest
in the position maintained, or that 'AARGH! is the group effort of an
astroturf campaign).
2. If the true identity of the poster became known, he/she/them
fears some kind of retribution:
* The ostracism and detestation of his peers.
* The boycotting of his employer. * His employer objecting to his wasting company time on   Internet mailing lists.
Our corrospondent has not given us any reason not to infer the worst motives. This is, after all, a discipline where
paranoia and suspicion are job requirements.
Peter Trei
Disclaimer: The above represents my private , personal opinions only; do not misconstrue them to represent the opinions of others.

@_date: 2002-08-02 14:36:32
@_author: Trei, Peter 
@_subject: Challenge to David Wagner on TCPA 
While I reserve the right to respond to the rest of the poster's letter, I'd like to call out this snippet, which gives a very good reason
for both corporate and individual users to avoid TCPA as if it were weaponized anthrax (Hi NSA!).
OK, It's 2004, I'm an IT Admin, and I've converted my corporation over to TCPA/Palladium machines. My Head of Marketing has his
TCPA/Palladium desktop's hard drive jam-packed with corporate confidential documents he's been actively working on - sales projections,  product plans, pricing schemes. They're all sealed files.
His machine crashes - the MB burns out.
He wants to recover the data.
HoM: 	I want to recover my data.
Me: 	OK: We'll pull the HD, and get the data off it. HoM:	Good - mount it as a secondary HD in my new system.
Me:	That isn't going to work now we have TCPA and Palladium.
HoM:	Well, what do you have to do?
Me:	Oh, it's simple. We encrypt the data under Intel's TPME key, HoM:	Let me get this straight - the only way to recover this data is to
Me:	Um... Yes. I think MS might be involved as well, if your were using
HoM:	You are *so* dead.
Peter Trei

@_date: 2002-08-15 10:31:29
@_author: Trei, Peter 
@_subject: CT-RSA 2003 -- preliminary call for papers 
[From sci.crypt -pt]
Newsgroups: sci.crypt.research, sci.crypt
           Preliminary Call for Papers -- CT-RSA 2003
               Submission deadline: Oct. 1, 2002
      Cryptographers' Track, RSA Conference 2003 (CT-RSA 2003)
       April 13-17, 2003, Moscone Center, San Francisco, USA
                       (see also Following the success of the two previous editions, the
Cryptographers' Track of RSA Conference 2003 (CT-RSA 2003)
will be run as an anonymously refereed conference with
proceedings. The proceedings of CT-RSA 2001 and CT-RSA 2002 were
published in Springer-Verlag's Lecture Notes in Computer Science
series as LNCS 2020 and LNCS 2271, respectively.
Original research papers pertaining to all aspects of cryptography
as well as tutorials are solicited. Submissions may present theory,
techniques, applications and practical experience on topics
including, but not limited to: fast implementations, secure
electronic commerce, network security and intrusion detection,
formal security models, comparison and assessment, tamper
resistance, certification and time-stamping, cryptographic data
formats and standards, encryption and signature schemes, public
key infrastructure, protocols, elliptic curve cryptography,
cryptographic algorithm design and cryptanalysis, discrete
logarithms and factorization techniques, lattice reduction, and
provable security.
IMPORTANT DATES:
  Submission deadline:     Oct. 1, 2002
  Acceptance notification: Nov. 1, 2002
  Proceedings version:     Nov. 17, 2002
INSTRUCTIONS FOR AUTHORS:
The program committee invites research contributions and tutorials
in the broad area of applications and theory of cryptography.
Correspondence, including submissions, will take place entirely
via e-mail. All submissions will be blind refereed. To make a
submission, please send two separate e-mail messages to
                       marc.joye at gemplus.com
(the first message should contain the paper's title, the names and
affiliations of the authors and should identify the contact author,
including e-mail and postal addresses; the second message should
contain the submission itself in PostScript or in PDF).
The paper must be anonymous, with no author names, affiliations,
acknowledgements, or obvious references.  It should begin with a
title, a short abstract, and a list of keywords.  The paper should
be at most 12 pages (excluding the bibliography and clearly marked
appendices), and at most 18 pages in total, using at least 11-point
font and reasonable margins.  Submissions not meeting these
guidelines risk rejection without consideration of their merits.
For an accepted paper to be included in the proceedings, the
authors of the paper must guarantee that at least one of the
co-authors will attend the conference and deliver the talk
(registration fees will be waived for the co-author delivering
the talk).
PROGRAM COMMITTEE:
  Giuseppe Ateniese          Chi-Sung Laih
  John Black                 Tatsuaki Okamoto
  Daniel Bleichenbacher      David Pointcheval
  Rosario Gennaro            Bart Preneel
  Stuart Haber               Jean-Jacques Quisquater
  Helena Handschuh           Tsuyoshi Takagi
  Markus Jakobsson           Gene Tsudik
  Antoine Joux               Serge Vaudenay
  Marc Joye (Chair)          Sung-Ming Yen
  Kwangjo Kim                Moti Yung
  Seungjoo Kim               Yuliang Zheng

@_date: 2002-08-15 13:53:56
@_author: Trei, Peter 
@_subject: trade-offs of secure programming with Palladium (Re: Palladiu 
Russ: Take off your economic hat, and try on a law-enforcement one.
With DMCA, etal, the tools to get around TCPA's taking of your
right to use your property as you please have been criminalized.
(Don't argue that TCPA will always be voluntary. I don't beleive I have little patience with arguments which say 'Yeah, they can
make X against the law, but clever people like me can always
get around it, and won't get caught, so I don't care.'
Maybe you can, some of the time, but that's not the point. Most
people won't, either because it's too hard, they don't know what
they've lost, or because of a misplaced respect for the whims of The Men with Guns. This is not a Good Thing.
A freedom to skulk in the shadows, hoping not to be noticed, is not
the legacy I wish to leave behind.
Peter Trei

@_date: 2002-08-28 11:24:15
@_author: Trei, Peter 
@_subject: Smartcard in CD 
Sent: 8/27/02 9:36 AM
Could it be powered by the light from the CD reader laser? Could it then
modulate something to look like it is a CD being read?
Is there any indication that there is anyone from this company
this list?
[Excuse the cruddy formatting - I'm using Microsoft Outlook Web
I've actually handled these devices (sort of at the level of a
colleague saying "Here's something cool - what do you think we
could do with it?"
The early models have a pair of lithium cells built in (two for
balance). The company is looking into other battery technologies
as well - there are some paper thin batteries coming out.
(It's actually asounding that they can fit their board, batteries
included, into the thickness of a CD, but they've done it.)
I wonder about induction too - could you put a small magnet in
the disk, and use the varying induced fields in the reader mechanism to generate power?
Peter Trei

@_date: 2002-02-04 11:00:27
@_author: Trei, Peter 
@_subject: Losing the Code War by Stephen Budiansky 
I read the article (in the dead tree edition), and despite it's
technical inaccuracies, thought it was generally pretty good.
Don't forget that the MITM attack (which Schneier claims
takes 2^(2n) = 2^112 time), also requires 2^56 blocks
of storage. That's a lot, and the attack ceases to be
parallelizable, unlike the straight brute-force attack.
In fact, it's utterly intractable at the moment. Here's
2^56 bytes = 72 petabytes, and
I suspect you'd need 8 bytes per entry, or about 1/2 an exabyte. By contrast, all of morpheus is currently less than half of one petabyte. Google indexes about 3 billion
documents + 700 million usenet postings. At a
an estimated 100kb per item, that's roughly
the same as morpheus. I don't lose sleep over MITM attacks on 3DES.
Peter Trei

@_date: 2002-02-04 11:13:10
@_author: Trei, Peter 
@_subject: Welome to the Internet, here's your private key 
One other scheme I've seen, and which, while it doesn't give me
warm fuzzies, seems reasonable, is to issue the
the enduser a smartcard with a keypair on it. The SC generates
the pair onboard, and exports only the public half. The private
half never leaves the SC (there is no function on the card to export it).
If you trust the above, then the only copy of the private key
is on the SC, despite it having been generated without the
end users participation.

@_date: 2002-02-04 12:50:43
@_author: Trei, Peter 
@_subject: Losing the Code War by Stephen Budiansky 
Either way, my point stands: any attack which requires 2^56 blocks
of storage is probably intractable for the time being, imho. 10 years
from now, I'm not so sure.
Peter Trei

@_date: 2002-02-04 13:16:35
@_author: Trei, Peter 
@_subject: Unbreakable? (fwd) 
There are plenty of 'thought experiment' crypto systems which
are utterly infeasible in practice. Rabin's is one.
It does have perfect forward secrecy in that if Eve doesn't know ahead of transmission time what part of the keystream to grab,
she can't later decrypt the message.
But, as Nicholas points out, it doesn't solve the key distribution problem,
merely shifts it. Alice and Bob still have find some way to securely
coordinate beforehand what part of the 'random' bitstream they will
use as their OTP.
There are many other problems:
* The HW needed to generate cryptographically sound random data at the required rate is extremely expensive, if it exists at all. * The HW needed to recieve data at that rate is very expensive. * Since accuracy is required, error correcting codes will have to
be included, increasing the data rate still further.
*putting up a constellation of satellites is also very expensive - where's the revenue to do all this coming from?
...and the big one:
Could you *trust* the 'randomness' of a bitstream handed you
from a source you cannot check?
Sorry, folks, this one is a non-starter.
Peter Trei

@_date: 2002-02-04 16:51:13
@_author: Trei, Peter 
@_subject: Welome to the Internet, here's your private key 
I'm not the local expert on this, but there are SCs with
built-in crypto accelerators. They are designed for the use I described:
* Generate an RSA key pair on board, * export the public key,
* re-import the certificate, * wrap/unwrap a data block   (typically a session key or hash for signing)   using the onboard key pair without ever
  exporting the secret half of the key pair.
While they typically only use a PIN or passphrase
for protection, they usually will commit electronic seppuku if too many (typically 3) bad PINs or
passphrases are entered.
With these, you can let your CA admin run the
SW to create the keys and sign the public key,
and still have reasonable assurance that he has
not snagged a copy of the private key.
Peter Trei

@_date: 2002-02-06 11:12:20
@_author: Trei, Peter 
@_subject: Welome to the Internet, here's your private key 
We're generally talking about a 'is a person' or an 'is an employee' key, in
an enterprise situation. Having a single copy of the private key is usually
acceptable. If it's lost/destroyed then a new one can be issued. Since it's
so closely bound to a single person (typically for access/ email or Single Signon applications), having a private key that can't operate without the
of the owner (and the card) is usually a feature, not a bug.
Peter T

@_date: 2002-02-11 10:21:36
@_author: Trei, Peter 
@_subject: Losing the Code War by Stephen Budiansky 
Oh, I totally agree - my first followup (Feb 4) read:
- start quote - Either way, my point stands: any attack which requires 2^56 blocks
of storage is probably intractable for the time being, imho. 10 years
from now, I'm not so sure.
- end quote - The expansion of storage over the last 20 years is even more astonishing than the  speedup of microprocessors. The first IBM
PC to ship with a HD (PC-XT ~1983) had a 5 Mb drive. When I
worked for Columbia U, undergraduates were given about 50kb
of diskquota for a semester.
Nevertheless, 2^56 blocks of centralized storage is a lot, and will remain a lot for a while.
Peter Trei

@_date: 2002-02-11 13:59:24
@_author: Trei, Peter 
@_subject: Where's the smart money? 
My first thought on hearing of this was:
'Wil these survive a session in the microwave?"
(brings new meaning to the phrase 'hot money' :-)
Peter Trei

@_date: 2002-02-11 14:25:27
@_author: Trei, Peter 
@_subject: Where's the smart money? 
That's the scenario which is (semi) worrying. As
the tagged bills wear, some fraction of the RFID
transponders will inevitably fail. When this happens,
is the bill declared invalid? Will merchants regularly
check all incoming cash for a good tag? Is a bill with a bad tag presumed to be counterfeit? Can
it be exchanged?
Peter Trei

@_date: 2002-02-13 08:55:19
@_author: Trei, Peter 
@_subject: Announce: San Francisco Cypherpunks, Sat 2/16/02, 6pm - 225 1 
For the last 4 years I've been able to arrange space at the RSA conference
for the adjacent Cypherpunks meeting. I apologize for not doing so this
There were a number of factors:
1. RSA is running Monday -> Friday instead of the usual Sunday -> Thursday,
so the Saturday cp meet is no longer adjacent to the conference, which
us to get a room while setup was going on around us.
2. RSA is in San Jose, but Codecon is in SF, and is closely aligned with
member interests. Next year, RSA will be back at the Moscone center in SF.
3. Due to conflicts, I'm not out on the West Coast till Monday afternoon, so
can't host or attend the meeting personally. I'm really annoyed about that
As to the RSA conference web site, I've raised a stink about certain facets of it, and there will be a Flash-free site next year.
Peter Trei

@_date: 2002-02-13 19:50:14
@_author: Trei, Peter 
@_subject: Losing the Code War by Stephen Budiansky 
Well, I guess your resources include a LOT of time. 2^72 test
Lets be optimistic. Lets assume you can do a test every clockcycle, and
your cracker is running at 1GHz. How long would it take you to do 2^72
About 150,000 years, if my math is correct.
If Moore's Law holds out, you might get an answer in 20-30 years, for a
single message. (Subsequent ones would be a lot faster).
But it's all moot - no one who knows what they are doing uses 1 or 2 key DES, and even 3 key DES is only being put in new apps until folks are more confident with 128+bit AES. Peter Trei

@_date: 2002-02-27 09:52:23
@_author: Trei, Peter 
@_subject: "Cloak", or Cloaca? :-) 
I'm coming into this a bit late, but the security situation on PalmOS is not
quite as dire as you make out (at least thru OS 3.5, maybe later). The
is that the OS is single-threaded, and does not have preemptive
The OS sends the current app a message, saying, essentially 'Shut down
now and let something else happen'. The app can take it's sweet time about
this, and delay things long enough to zeroize or encrypt any sensitive data.
Peter Trei

@_date: 2002-01-09 18:01:25
@_author: Trei, Peter 
@_subject: RSA Conference 2002: Free Expo passes, academic discounts and sch 
(feel free to forward this message in its entirety)
The RSA Data Security Conference is being held February 18-22, 2001, at the McEnery Convention Center in San Jose, California.
This is the biggest computer security conference
in the world, with 200 vendors and over 10,000
attendees. Personally, I think it's a blast, and
attend every year.
I'm sending this to remind list members that,
although the full conference is quite costly,
there are (as in previous years) a couple of
ways to get all or part of the show for free,
and a discounted fee for academic types.
Full information on the conference can be found
at  (which, as others
have pointed out, is Flash-heavy :-( I'm talking to people to try to get that changed next year.)
See you there!
Peter Trei
ptrei at rsasecurity.com
[PS: I have no input into the scholarship selection
process, so don't send me anything.]
This e-mail, its content and any files transmitted with it are intended
solely for the addressee(s) and are PRIVILEGED and CONFIDENTIAL.  Access by any other party is unauthorized without the express
prior written permission of the sender.  If you have received this e-mail in error you may not copy, disclose to any
third party or use the contents, attachments or information in any way, Please delete all copies of the e-mail and the
attachment(s), if any and notify the sender. Thank You.

@_date: 2002-01-17 15:38:40
@_author: Trei, Peter 
@_subject: Horseman Number 3: Osama Used 40 bits 
An 'ex-Nato encryption expert' who can't do math, and doesn't
know the field.
40 bits ~~ a million million 60 bits ~~ a billion billion   He's off by a factor of a million. The fact that
10 bits ~~1000 (actually 1024) is something that is engraved inside the skull of anyone who actually deals
with this stuff. Much beyond 40 bits is impossible?
Tell that to distributed.net/EFF , which brute-forced a 56 bit key in under 24 hours a couple years ago, and
is currently working on a 64 bit key (They're 2/3 of the
way through at the moment).
Peter Trei
[Moderator's note: It wasn't a direct quote, and I generally assume
reporters misquote people anyway. Also, note that the general
confusion because the UK uses "thousand million" for the US "billion"
makes the whole thing even less clearly the expert and not the
reporter. --Perry]
This e-mail, its content and any files transmitted with it are intended
solely for the addressee(s) and are PRIVILEGED and CONFIDENTIAL.  Access by any other party is unauthorized without the express
prior written permission of the sender.  If you have received this e-mail in error you may not copy, disclose to any
third party or use the contents, attachments or information in any way, Please delete all copies of the e-mail and the
attachment(s), if any and notify the sender. Thank You.

@_date: 2002-01-18 12:02:34
@_author: Trei, Peter 
@_subject: Apology for Brian Gladman. 
Rich is correct. I was over the top. In response to my (much
more polite) letter to Mr. Gladman & New Scientist, it became
clear that the error was due to a journalist compressing down
his conversation with Mr. Gladman. Brian had been referring
to a (rounded up) bit strength for full 56 bit DES.
If Brian Gladman is listening, I apologize.
Peter Trei

@_date: 2002-01-21 09:55:53
@_author: Trei, Peter 
@_subject: password-cracking by journalists... 
I'm sure I'm picking nits here (and I praise God every day that
I Am Not A L*wy*r), but what does 'effectively' mean? If it can be
broken, was it effective? What level of work is required to make
it an 'effective technological measure'? If the standard is 'anything,
including rot13', then why is the word present in the rule at all?
Technological measures can range from violating the CDROM
standard and introducing deliberate errors to confuse some
readers, all the way up to full real-time, online, 3-factor The inclusion of the word 'effectively' presumes the existance of 'ineffective' technological measures, which it would be no crime
to circumvent. Where, then, is the distinction? I'm reminded of a humorous button I've seen at some SF
conventions: "Anything not nailed down is legally mine. Anything
I can pry up wasn't nailed down in the first place."
Peter Trei

@_date: 2002-07-10 15:31:23
@_author: Trei, Peter 
@_subject: New Chips Can Keep a Tight Rein on Consumers 
There's related legal precedent, but I'm too lazy to look up the
details. Over 10 years ago a game console manufacturer 'Foo'
(Nintendo? Atari?) sued an independent game cartridge
manufacturer, claiming copyright infringement in that the console checked that a specific location in the cartridge
contained the string "Copyright (c) Foo Inc."
The console maker lost; the judge ruled that including the
string was neccesary for perfectly legal compatibility reasons. (I note that it was also only visible to the console,
not to the consumer). This seems quite appropos to the
printer cartridge situation, but IANAL.
Peter Trei

@_date: 2002-07-12 11:18:12
@_author: Trei, Peter 
@_subject: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
I think I do. A 'second hand' root key seems to have some
trust issues - the thing you are buying is the private half
of a public key pair .... but that's just a piece of information.
How can you be sure that, as purchaser, you are the *only*
possessor of the key, and no one else has another copy (the
seller, for example)?
Peter Trei

@_date: 2002-07-31 11:34:58
@_author: Trei, Peter 
@_subject: Challenge to David Wagner on TCPA 
AARG!, our anonymous Pangloss, is strictly correct - Wagner should have
said "could" rather than "would".
However, TCPA and Palladium fall into a class of technologies with a
tremendous potential for abuse. Since the trust model is directed against
the computer's owner (he can't sign code as trusted, or reliably control which signing keys are trusted), he has ceded ultimate control of what he can and can't do with his computer to another. Sure, TCPA can be switched off - until that switch is disabled. It could potentially be permenantly disabled by a BIOS update, a security patch, a commercial program which carries signed disabling code as a Trojan, or over the net through a backdoor or vulnerability in any networked software. Or by Congress which could make running a TCPA capable machine with TCPA turned off illegal.
With TCPA, I now have to trust that a powerful third party, over
which I have no control, and which does not necessarily have
my interests are heart, will not abuse it's power. I don't
want to have to do that.
Peter Trei
Disclaimer: The above represents my personal opinion only. Do
not misconstrue it as representing anyone elses.

@_date: 2002-06-04 16:16:46
@_author: Trei, Peter 
@_subject: Lenstra, Shamir, Tomlinson, & Tromer on Bernstein 
Analysis of Bernstein's Factorization Circuit
Arjen K. Lenstra 1 , Adi Shamir 2 , Jim Tomlinson 3 , Eran Tromer 2
Abstract. In [1], Bernstein proposed a circuit-based implementation of
the matrix step of the number field sieve factorization algorithm. We
show that under the non-standard cost function used in [1], these cir-cuits
indeed offer an asymptotic improvement over other methods but
to a lesser degree than previously claimed: for a given cost, the new
method can factor integers that are 1.17 times larger (rather than 3.01).
We also propose an improved circuit design based on a new mesh rout-ing
algorithm, and show that for factorization of 1024-bit integers the
matrix step can, under an optimistic assumption about the matrix size,
be completed within a day by a device that costs a few thousand dollars.
We conclude that from a practical standpoint, the security of RSA relies
exclusively on the hardness of the relation collection step of the number
field sieve.
Keywords: factorization, number field sieve, RSA, mesh routing

@_date: 2002-06-19 12:46:38
@_author: Trei, Peter 
@_subject: DOJ proposes US data-rentention law. 
- start quote -
Cyber Security Plan Contemplates U.S. Data Retention Law
Internet service providers may be forced into wholesale spying on their customers as part of the White House's strategy for securing cyberspace.
By Kevin Poulsen, Jun 18 2002 3:46PM
An early draft of the White House's National Strategy to Secure Cyberspace envisions the same kind of mandatory customer data collection and retention by U.S. Internet service providers as was
recently enacted in Europe, according to sources who have reviewed portions of the plan. In recent weeks, the administration has begun doling out bits and pieces of a draft of the strategy to technology industry members and advocacy groups. A federal data retention law is suggested
briefly in a section drafted in part by the U.S. Justice Department. - end quote -

@_date: 2002-06-21 09:53:29
@_author: Trei, Peter 
@_subject: Followup: [RE: DOJ proposes US data-rentention law.] 
Two points:
1. According to Poulson, the DOJ proposal never discussed just what would be logged. Poulson compared it to the European Big Brother legislation, which required storage to Web browsing histories and email header data.
2. After I posted the same info to /.
(I'm the 'Anonymous Coward' in this case), Kevin updated
his article. The new version may be found at:
The relevant portions read:
- start quote -
U.S. Denies Data Retention Plans
The Justice Department disputes claims that Internet service providers could be forced to spy on their customers as part of the U.S. strategy for securing cyberspace.
By Kevin Poulsen, Jun 19 2002 12:24PM
But a Justice Department source said Wednesday that data retention is mentioned in the strategy only as an industry concern -- ISPs and telecom companies oppose the costly idea -- and does not reflect any plan by the department or the White House to push for a U.S. law. - end quote -
Peter Trei

@_date: 2002-06-24 09:56:54
@_author: Trei, Peter 
@_subject: DOJ proposes US data-rentention law.  
I tried sending this last week, but it did not seem to go through:
Two points:
1. According to Poulson, the DOJ proposal never discussed just what would be logged. Poulson compared it to the European Big Brother legislation, which required storage to Web browsing histories and email header data (NOT email body text
or IP traffic).
2. After I posted the same info to /.
(I'm the 'Anonymous Coward' in this case), Kevin updated
his article. The new version may be found at:
The relevant portions read:
- start quote -
U.S. Denies Data Retention Plans
The Justice Department disputes claims that Internet service providers could be forced to spy on their customers as part of the U.S. strategy for securing cyberspace.
By Kevin Poulsen, Jun 19 2002 12:24PM
But a Justice Department source said Wednesday that data retention is mentioned in the strategy only as an industry concern -- ISPs and telecom companies oppose the costly idea -- and does not reflect any plan by the department or the White House to push for a U.S. law. - end quote -
Peter Trei

@_date: 2002-03-01 16:14:35
@_author: Trei, Peter 
@_subject: The Original SSSCA 
[The SSSCA would require all devices capable of
carrying media content to have hardware locks
to prevent copyright violations. Essentially,
it turns all computers as closed as set-top
boxes - and about as useful.
See for background -pt ]
I've been watching the entertainment industry's
approach to computers with what I can only think of as
Kafkaesque horror.
It's simply unthinkable that preserving the business
models of entertainers trumps the utterly central role
of computers and the Internet in improviing our
Apparently the politicians are actually *receptive* to
this. I guess this just shows how money corrupts - the
heavy donor's interests outweigh those of the nation.
I've been trying to think of an analogy to show just
how awful the idea of the SSSCA is. I've had to go back
a way. A long way.
The SSSCA threatens to return us to a Stone Age model
of information use.
Disclaimer: The above are strictly the personal opinions of myself,
and I'd be astonished if my employer had any official
position on the matter (so don't pretend
otherwise). Feel free to copy this document in its entirety, with
proper attribution.
Peter Trei

@_date: 2002-03-07 10:04:34
@_author: Trei, Peter 
@_subject: 1997 RSA DES Challenge 
I might be able to help you. I was the person who
initiated the the DES Challenges, getting RSA
Data Security to sponsor them, and working
with people in RSA Labs on their design (this
was before I switched employers to RSA).
I also wrote one of the search engines. I have a fair bit of data, but some of it is
on Zip disks which may or may not still
be readable. I also have a lot of info
on the background of the challenges.
I gave a keynote speech at the 1997 RSA
Conference on the subject.
Peter Trei
Principal Engineer
RSA Security
ptrei at rsasecurity.com

@_date: 2002-03-26 11:14:38
@_author: Trei, Peter 
@_subject: distributed.net looking for a new ISP. 
Distributed.net, which has won several of the RSA Secret Key
challenges, and is currently 73% of the way through the
RC5-64 contest, has lost it's ISP.
Peter Trei
- start quote ------------------------
We need your help! URGENT: We have recently learned that our long-standing
arrangement with Texas.Net (formerly Insync) would end at
noon, Friday, March 22. Through an agreement with Insync, we
were hosted at no charge for many years. Though we have
tried to make other arrangements with them or to continue
our current service until we can make other arrangements, in
the end we had no choice but to move.
Several of the Austin cows made a road trip Friday morning
to retrieve our equipment from their colocation facility.
We have no reason to complain about Texas.Net or their
current decision. As a business, they chose to donate to us
for a long time, and have now decided that they must
stop. In dbaker's words in a letter to Texas.Net: "Our
experience with Insync has been excellent; I've never been
happier with an Internet provider. I've recommended them
(and indirectly, Texas.Net) to everyone and even this
[situation] won't change that."
Though United Devices has kindly offered to colocate our
primary servers for a short time at no expense, we find
ourselves in the market for a new ISP. If any of our
participants work for a major ISP in Texas (preferably
within a few hours of Austin, but we're not picky), and
would be willing to donate colocation space and
connectivity, we would eagerly like to speak with you. Our
typical bandwidth usage is 3Mb/s, and reliable uptime is of
course essential.
Please e-mail dbaker at distributed.net if you think you may be
able to help us in this area.
- end quote -----------------------------

@_date: 2002-03-26 16:34:34
@_author: Trei, Peter 
@_subject: One for the snakeoil file. 
[Note: I'm just passing on posts from sci.crypt. I've
 not confirmed this independently It appears that not every product which uses smart
cards is secure - pt]

@_date: 2002-05-21 11:52:01
@_author: Trei, Peter 
@_subject: Just how bad is the Microsoft Visual C++ 6 rand function, anyway? 
Now, I'm sure no one on this list would trust MSVC6 rand() for anything
important, but this post from sci crypt (which I have not cofirmed)
may be of interest:
Peter Trei
- start quote ---------------------
Newsgroups: sci.crypt, sci.crypt.random-numbers
In case anyone's interested, the rand() function that ships in the C runtime
library with Microsoft Visual Studio 6.0 is a *15-bit* LC-PRNG.  Not only
that, but the most significant bit, which is also the most random bit in an
LC-PRNG, is discarded by masking.
Code snippet follows:
int __cdecl rand (void)
        return(((holdrand = holdrand * 214013L + 2531011L) >> 16) & 0x7fff);
- end quote ---------------------------

@_date: 2002-05-29 14:29:39
@_author: Trei, Peter 
@_subject: FC: Hollywood wants to plug "analog hole," regulate A-D conve 
Actually, it's unlikely that anyone would embed watermarks in billboard
ads, or in ads in general. Copying an ad is usually a Good Thing from
the advertiser's point of view - more exposure. It's only the program
material which needs protection.
To get back to security; could I use this to defeat video surrveilliance
cameras, by wearing a copyrighted teeshirt??
This thread on this very silly idea from the MPAA has gone far enough, IMHO. Peter Trei

@_date: 2002-05-31 10:40:47
@_author: Trei, Peter 
@_subject: FC: Hollywood wants to plug "analog hole," regulate A-D conve 
This is the actual paragraph that people are refering to:
[from - start quote -
The primary means to address this issue, dubbed the "analog hole", is via embedded watermarks (which have additional applications as will be discussed below). In order to help plug the hole, watermark detectors would be required in all devices that perform analog to digital conversions.
In such devices (e.g., PC video capture cards), the role of the watermark detector would be to detect the watermark and ensure that the device responds appropriately.
- end quote -
Note that is refers to "all devices that perform analog to digital
conversions". I agree that compromising all a/d chip is probably not what the MPAA had
in mind (their example is a video capture card, a much more complex beast),
but overbroad language has gotten into too many laws for me to have any
that it can't happen again. What's going to happen when someone publishes
plans to remove the restrictions from a compromised vidcap card, and
how to mail order standard DACs? Will trafficing in DAC chips become a DMCA
I agree that the MPAA's reccomendation is laughable, but stupidity has never
stopped politicians from passing laws. Peter Trei

@_date: 2002-11-06 11:22:50
@_author: Trei, Peter 
@_subject: Did you *really* zeroize that key? 
[Moderator's note: FYI: no "pragma" is needed. This is what C's
"volatile" keyword is for. Unfortunately, not everyone writing in C
knows the language. --Perry]
Those of us who write code need to be reminded of this now and then.
Peter Trei
Software leaves encryption keys, passwords lying around in memory
       Monty Solomon         Wed, 30 Oct 2002 22:31:46 -0500
                Date: Thu, 31 Oct 2002 05:11:31 +1300 (NZDT)
       From: pgut001 at cs.auckland.ac.nz (Peter Gutmann)
       Subject: Software leaves encryption keys, passwords lying around in
       The following problem was first pointed out (in private mail) by
       Howard from Microsoft.  His writeup is now available at
       From a representative check of a few widely-used open source crypto
       programs, this affects quite a bit of software.
       The problem he points out is that clearing sensitive information such
       encryption keys from memory may not work as expected because an
       compiler removes the memset() if it decides it's redundant.  Consider
       example the following:
       int encrypt( const void *key )
         {
         puts( key );     /* Normally we'd encrypt here */
         }
       void main( void )  /* Because we can */
         {
         char key[ 16 ];
         strcpy( key, "secretkey" );
         encrypt( key );
         memset( key, 0, 16 );
         }
       When compiled with any level of optimisation using gcc, the key
       call goes away because of dead code elimination (see the MSDN article
       more details on this, which uses VC++ to get the same effect).  While
       can kludge enough stuff around a custom memory-clear call to fool the
       optimiser (hacks with 'volatile', touching the memory after it's
cleared and
       hoping the optimiser is fooled, etc etc) there's no guarantee that
       work for anything but the compiler(s) you happen to test it with -
       future enhancement to the optimiser may turn it back into a nop.
What it
       really needs is the addition of a        in the compiler.  Until then, a lot of security code will be affected
       this problem.
         [In RISKS, I tend never to alter British spellings.  However,
         in American English, an "optimiser" must be the ultimate miser.]

@_date: 2002-11-07 09:58:43
@_author: Trei, Peter 
@_subject: New Protection for 802.11 
How many stories have you read in the last year about
non-LEOs stealing email?
How many stories in the last year have you read about
Further, tapping into 802.11b nets Peter Trei

@_date: 2002-11-27 11:05:17
@_author: Trei, Peter 
@_subject: 'E-postmark' gives stamp of approval 
The PO tried marketing this service about 6 years ago. As far as I can see, this is almost identical to the last try.
It failed in the marketplace then, and I see no reason whatsoever to think it will suceed now. Favorite paragraph:       high-profile security lapses.
Peter Trei

@_date: 2002-10-07 10:26:49
@_author: Trei, Peter 
@_subject: [OT Canute] Re: [LINK] [Fwd: Interesting KPMG report on DRM] 
[lots of good stuff about the music business clipped]
[even more good stuff clipped]
In the interests of pedantry and accuracy, may I point out that Canute
did not actually expect to hold back the tide. Canute was an an early Danish king of northern England, living ~995-1035. Like most modern
leaders, he was surrounded by yes-men. Unlike them, he did something
about it:

@_date: 2002-10-17 14:11:36
@_author: Trei, Peter 
@_subject: QuizID? 
[Note of vested interests: I work on RSA SecurID, which is a
competing product.]
Based on the information at the site, and Quizid's statement that their hardware is manufactured by ActivCard, I have to
say that this looks an *awful lot* like the ActivCard Keychain Token, repackaged into a bigger form factor. Peter Trei
Disclaimer: The above represents only my personal opinion.

@_date: 2002-09-17 14:51:17
@_author: Trei, Peter 
@_subject: Cryptogram: Palladium Only for DRM 
Of course, this is just what AARG wants - he has never actually been
interested in trying to persuade you. He just wants to wear down the
people who are able to effectively dispute his claims to the point
where they shut up, abandon the field of battle, and leave his position
trimphant by default. He doesn't care about the truth, or whether you have shown him to
be false. He just wants to win. Peter Trei

@_date: 2002-09-20 14:17:11
@_author: Trei, Peter 
@_subject: unforgeable optical tokens? 
It appears to have replay resistance *between* readers - ie, the data
from reader A would be useless to spoof reader B, since the two readers
will illuminate the device at different locations and angles. I would worry about durability - they mention that a 0.5 mm hole can destroy the token. It would appear that dust, scratches, etc could
also invalidate it. Sure, it can be encased, coated, etc, but that all
raises the cost.

@_date: 2002-09-26 10:26:24
@_author: Trei, Peter 
@_subject: RSA's RC5-64 Secret Key Challenge has been solved. 
First, the official PR release:
A personal note:
In case people are wondering, the key turned out to be
63 DE 7D C1 54 F4 D0 39
and the encrypted message was
I'm really happy with this - I wrote to Jim Bidzos proposing
the contests way back in the fall of 1996, long before I came
to work at RSA. At the time, I was aimed at killing DES, and creating pressure to ease the export limits on key size (they had just been raised from a ludicrous 40 up to 56. I didn't think this was good enough). I feel that I entirely suceeded.
So I was in at the start of the contests, and at the end of
this one (I was one of the two people at RSA who independently confirmed the decryption).
I expect that this will be the last one attacked for a while - the next keylength is 72 bits, and at d.net's current rate, that would take them several centuries.
Peter Trei

@_date: 2002-09-27 11:27:00
@_author: Trei, Peter 
@_subject: RSA's RC5-64 Secret Key Challenge has been solved. 
I spoke to David McNett (nugget at distributed.net) yesterday. He told me that
they intend to fire up a the RC5-72 challenge, hoping to get lucky and find
the key near the beginning.
I think they're open to other suggestions, however. Factoring may or may not
be reasonable. While RC5, DES, etc require minimal memory and storage,
and can so run unobtrusively in the spare cycles of almost any machine,
- even the seiving step - has large memory and storage requirements. The
matrix reduction step at the end does not have any efficient distributed
I'm aware of.
I think the lower RSA factoring challenges *may* be possible - RSA-576 is
standing, with a $10k prize. Other factoring challenges have up to $200k
Challenges need to be carefully set up. It must be legal - hacking a
system in the face of the objections of the owner won't fly. It must be
in that there must be no reason to suspect collaboration between the challenger and the attacker. It must be realistic - it should model a
use closely enough to show that changes need to be made (the RSA secret
key challenges where designed with IPSEC headers in mind - the single DES
option was deprecated as soon as we showed that to be weak).
This is an exciting time. With RC5-64 fallen, there are a lot of options for
to do next. The most interesting thing may not involve cryptanalysis.
Peter Trei

@_date: 2003-04-01 16:35:00
@_author: Trei, Peter 
@_subject: Run a remailer, go to jail? 
Derek, etal
If you (or anyone) goes, I'm sure we'd all appreciate some notes on what transpired. I understand 17 different bills are being considered at this hearing, so don't blink or
you may miss it.
Peter Trei

@_date: 2003-04-24 09:56:06
@_author: Trei, Peter 
@_subject: DRM technology and policy 
[...]
["Those things" are creative works; movies, books, music, etc. -pt]
OK, I'll call you on this one - what is the basis of that presumption?
Some creative works require an up-front investment which is
beyond what can be acheived on a shareware or charity basis.
Would the LOTR trilogy be filmed without hope of ROI? Would
we be awaiting 'The Matrix Reloaded'? I don't think so.
There are several Bad Things about the current IP setup which
need changing. There are also plenty of Bad Things about current
business model of mass entertainment. However, remunerating
creators for their work, and investors who put money at risk to
fund a work beyond the level available to the creators, is a Good
How that can be fairly done, to the maximum benefit of us all,
I don't claim to know for sure. But if creators all have to have day jobs, and backers don't have a chance to recoup their investments,  creative work will dry up.
Peter Trei

@_date: 2003-02-04 11:28:53
@_author: Trei, Peter 
@_subject: A talk on Intellectual Property and National Defense 
Let me get this straight - in order to make the RIAA and MPAA richer, we're going to ban off-net computer use? If you're not near a WiFi hotspot you won't be able to boot your laptop?
Peter Trei

@_date: 2003-02-04 12:36:25
@_author: Trei, Peter 
@_subject: A talk on Intellectual Property and National Defense 
Adam is correct - I was responding to him.
'secure remote attestation that the boot sequence was followed'
seems to imply that a net connection back to Hollywood would be required to boot.
'All your computer are belong to us'.
Peter Trei

@_date: 2003-02-10 14:40:05
@_author: Trei, Peter 
@_subject: Columbia crypto box 
The weird thing about WEP was its choice of cipher. It used RC4, a stream cipher, and re-keyed for every block. . RC4 is
not really intended for this application. Today we'd
have used a block cipher with varying IVs if neccessary
I suspect that RC4 was chosen for other reasons - ease of
export, smallness of code, or something like that. It runs fast,
but rekeying every block loses most of that advantage.
Just my personal musings....
Peter Trei

@_date: 2003-02-11 10:25:57
@_author: Trei, Peter 
@_subject: Columbia crypto box 
If I recall correctly (dee3: Can you help?) WEP is actually derived
from the encryption system used in the Apple Mobile Messaging System, a PCMCIA paging card made for the Newton in the mid-90s.
This used 40 bit RC4.
Though only a few years have passed, it's difficult to remember now
what an encumberance the ITAR export regulations were. Essentially,
there was a (very short) list of ciphers and modes you could export.
40-bit RC4 was relatively easy to export. Anything better,or anything
which had not been already approved by the NSA, faced a bureaucratic
nightmare and huge delays if it was approved at all.
Peter Trei

@_date: 2003-02-11 11:21:17
@_author: Trei, Peter 
@_subject: Columbia crypto box  
I totally agree that WEP has/had problems well beyond the export issue,
but that's not my point. A product which cannot be exported will not be developed, generally speaking.
I quote from AC2 (Schneier), page 615 (which was published in 1996):
"The State Department does not approve of the export of products with strong encryption, even those using DES. [...] The Software Publishers
Association (SPA) has been negotiating with the government to ease
export license restrictions. A 1992 agreement between them and the
State Department eased the export license rules for two algorithms,
RC2 and RC4, as long as the key size is 40 bits or less."
So, it doesn't matter how espionage-enabled CDMF was, if you wanted to export crypto for general use, you were stuck with RC2 or RC4. This situation eased slightly (to 56 bits) around 1997, but did not reach today's conditions until 2000.  The AMMS system cited above dates to 1995.
(It feels weird to be citing Schneier as a historical document).
Peter Trei

@_date: 2003-02-13 11:08:45
@_author: Trei, Peter 
@_subject: Columbia crypto box 
You can actually do much better that that for key set up. To toot my own
horn, one of the critical events in getting software DES crackers running at high speed was my realization that single-bit-set key schedules can
be OR'd together to produce any key's schedule. Combining this with
the use of Grey Codes to choose the order in which keys were tested
(Perry's idea) led to key scheduling taking about 5% of the time budget.

@_date: 2003-01-15 09:56:01
@_author: Trei, Peter 
@_subject: RIAA turns against Hollings bill  
"enforcing compliance with voluntarily developed functional specifications"
appears to be NewSpeak for:
"Let the RIAA, not Congress, write the laws, and then send in
Men With Guns to enforce them."
Peter Trei

@_date: 2003-03-06 10:13:22
@_author: Trei, Peter 
@_subject: Scientists question electronic voting 
I'd prefer that the printed receipt be retained at the polling station,
after the
voter has had an opportunity to examine it. This serves two purposes: First,
it prevents the vote selling described above, and second, if a recount is
required, it allows the recount to be done on the basis of a trustworthy record, already certified by the voter as accurate.
This loses some of the economic benefits of all-electronic systems, since
security still needs to be provided for the receipts for some period, but
is far less prone to invisible abuse.
Peter Trei

@_date: 2003-03-06 13:05:15
@_author: Trei, Peter 
@_subject: Scientists question electronic voting 
I absolutely agree. Here in the US, where voters often have to make
over a dozen choices each time they vote, the value of automating
the process is significant. But it *must* be done in a way which
increases voter confidence in the result.
Ballot boxes are also subject to many forms of fraud. But a dual
system  (electronic backed up by paper) is more resistant to
attack then either alone.

@_date: 2003-03-13 13:23:34
@_author: Trei, Peter 
@_subject: Encryption of data in smart cards 
Every PINned SC I've seen has a very limited (typically 3) number
of failed attempts before it locks itself up. Once it's locked up, it
can only be reactivated by an administrator PIN, which is held
at much higher security by the issuer, and not available to the
card user.

@_date: 2003-03-28 23:54:41
@_author: Trei, Peter 
@_subject: Run a remailer, go to jail? 
To heck with remailers, anonymizing proxies, etal. As I read this,
the USPO is liable if it accepts a letter without a correct return
Peter Trei

@_date: 2003-03-31 13:07:54
@_author: Trei, Peter 
@_subject: Russia Intercepts US Military Communications? 
There are a lot of people who don't consider this source credible.
After the site was cited on the Interesting People list, the following
appeared. I'll leave it up to the reader as to who to believe.
Organization: Nautilus Solutions
Reply-To: sdpoe at acm.org
Dave - There's currently several newsgroup threads discussing iraqwar.ru (see
sci.military.naval:"The credibility of Iraqwar.ru or lack thereof" and
smn:"Intel evaluation 2003.03.25", in rec.aviation.military:"The Noted
Waterhead: Venik" and even in alt.engr.exploisves:"Russian analysis of
the ongoing battles in Iraq").
Regarding Venik and his site at  I suggest a
few minutes spent on Google will be informative. He's well know to both
sci.military.naval and rec.aviation.military posters and lurkers.
Historically he's not known for his accuracy. He's probably best known
for his heated assertions during the Yugoslavia conflict as to how many
planes NATO lost, NATO's "deliberate targeting of civilian targets", and
NATO's "use of chemical weapons". His claims of multiple shoot-downs of
everything from F-16s to B-2s and B-52s were somewhat quickly quashed
given the hobby of tail spotters worldwide. Many of his other claims,
such as "A NATO pilot admits that civilian targets were deliberately
attacked during the operation "Allied Force" and that NATO aviation used
chemical weapons" were likewise not later confirmed. See:
 and a Google search for "Venick
B-2 Shoot Down" as examples.
I would have to view anything with his name associated with it with
Archives at:

@_date: 2003-05-02 15:51:24
@_author: Trei, Peter 
@_subject: [Factoring]  TWIRL and RSA key sizes 
This just came to me over one of our internal mailing lists. It may be of interest.
Peter Trei
RSA Security

@_date: 2003-09-02 17:12:06
@_author: Trei, Peter 
@_subject: U.S. seeks OSCE pact on biometric passports 
Non-destructive, yet unreadable? Seems an odd
requirement. I suppose a dab of clear nail polish on
the contacts might work. Peter Trei

@_date: 2003-09-08 17:04:34
@_author: Trei, Peter 
@_subject: Code breakers crack GSM cellphone encryption 
Why the heck would a government agency have to break the GSM encryption
at all? The encryption is only on the airlink, and all GSM calls travel
through the POTS land line system in the clear, where they are subject to warranted wiretaps.
Breaking GSM is only of useful if you have no access to the landline
portion of the system.
Peter Trei

@_date: 2004-04-07 10:17:53
@_author: Trei, Peter 
@_subject: Firm invites experts to punch holes in ballot software 
This is kind of broken. Allowing the voter to get a receipt which
they take away with them for verification may allow the voter to verify
that their vote was recorded as cast, but also allows coercion and vote buying.
To their credit, the creators thought of this, and suggest a
partial procedural fix in the threat analysis document:
The first problem, or course, is that a person under threat of coercion will need to present the coercer with a receipt showing exactly the mix of votes the coercer required. This is leads to a combinatorial explosion of fake receipts that need to be available.
Having only one vote on each receipt might mitigate this, but it still
gets really messy.
Second, it's not clear how this protects against the coercer checking the
ballot online - will every fake also be recorded in the system, so
it passes the online check? Having both real and fake ballots in
the verification server makes me very nervous.
Its possible I've missed something - this is based on a quick glance
through the online documents, but I don't see any advantage this system has over the much more discussed one where the reciept is
printed in a human readable way, shown to the voter, but retained inside the machine as a backup for recounts.
Just my private, personal opinion.
Peter Trei

@_date: 2004-04-07 13:16:46
@_author: Trei, Peter 
@_subject: Firm invites experts to punch holes in ballot software 
The system described allows the user to take a reciept (which has
only numbers on it) and use a website to determine that the vote
was recorded correctly.
A decoy receipt would also have to pass this test.
Frankly, the whole online-verification step seems like an
unneccesary complication.
* Both real and decoy receipts would have to be in the database
for verification - which bothers me a lot.
* There seems to be no provision for recounts - what are they supposed to do - have everybody send in their receipts? How can you
tell the decoys from the real?
I give VoteHere kudos for releasing their source, but it doesnt
solve the e-voting problem.
Peter Trei

@_date: 2004-04-07 16:10:34
@_author: Trei, Peter 
@_subject: Firm invites experts to punch holes in ballot software 
Yes, that seems to be the case. Note that in the current
(non computer) systems, we have no way to assure that our votes  actually contributed to the total, but the procedural stuff of having mutually hostile observers to the counting process makes deliberate discarding of one side's votes less likely. (Non-deliberate losses - such as the recent failure to record cards marked with the wrong kind of pen - can still happen).
VoteHere, while they seem to be well-meaning, have
not solved the problem. Mercuri & Rivest have described how to do it right; we just need someone
to buld or retrofit the machines appropriately.
Peter Trei

@_date: 2004-04-07 22:14:06
@_author: Trei, Peter 
@_subject: voting 
I think Perry has hit it on the head, with the one exception that
the voter should never have the receipt in his hand - that opens
the way for serial voting fraud.
The receipt should be exposed to the voter behind glass, and
when he/she presses the 'accept' button, it visibly drops into the sealed, opaque ballot box.

@_date: 2004-04-09 11:05:40
@_author: Trei, Peter 
@_subject: voting 
Our anonymous corrospondent has not addressed the issues I raised in my initial post on the 7th:
1. The use of receipts which a voter takes from the voting place to 'verify'
their vote was correctly included in the total opens the way for voter
2. The proposed fix - a blizzard of decoy receipts - makes recounts based
on the receipts impossible.
Asking the readers of this list to 'familiarize themselves with the
literature', is, in many cases,  a little like telling Tiger Woods that he needs to familiarize himself with the rules of golf. We know the 'advanced cryptographic techniques' you refer to. We also know what their limitations
- what they can and cannot do. This is not the appropriate forum to try to say
"trust me".
Answer this:
1. How does this system prevent voter coercion, while still allowing receipt
based recounts? Or do you have some mechanism by which I can
personally verify every vote which went into the total, to make sure they
are correct?
2. On what basis do you think the average voter should trust this system,
seeing as it's based on mechanisms he or she cant personally verify?
3. What chain of events do I have to beleive to trust that the code which
is running in the machine is actually and correctly derived from the source code I've audited? I refer you to Ken Thompsons classic paper "Reflections on trusting trust", as well as the recent Diebold debacle
with uncertified patches being loaded into the machine at the last moment.
This last is an important point - there is no way you can eliminate the
requirement of election officials to behave legitimately. Since that
requirement can't be done away with by technology, adding technology
only adds more places the system can be compromised.
Based on the tone of this letter, I'd hazard a guess that 'privacy' has a
vested interest in VoteHere. If this true, it's a little odd that they are
willing to expose their source code, but not their name. We don't
bite, unless the victim deserves it :-) Opening your source is an
admirable first step - why not step out of the shadows so we can
help you make your system better?
I fear a system which does not have a backup mechanism that the
average voter can understand. While it's true that non-electronic
systems are subject to compromise, so are electronic ones, regardless of their use of ZK proofs, or 'advanced cryptographic
I do think electronic voting machines are coming, and a good
thing. But they should be promoted on the basis that they are easier to use, and fairer in presentation, then are manual
methods. Promoting them on the basis that they are more
secure, and less subject to vote tampering is simply false.
Peter Trei
RSA Security
Disclaimer: The above represents my personal opinions only.

@_date: 2004-04-16 12:03:13
@_author: Trei, Peter 
@_subject: voting 
I'd pretty much dropped this topic after it became clear that Mr. Leichter's
only response to the problems that people pointed out in VoteHere's
scheme (in particular, its vulnerability to vote coercion, and lack of
recountability) was to attempt to redefine them as non-problems. However, since the topic has arisen again.....
Ed's got a very good point. I always prefer security which relies for
its integrity on the laws of nature, rather than on people behaving
with integrity.
Peter Trei

@_date: 2004-08-26 11:09:49
@_author: Trei, Peter 
@_subject: How thorough are the hash breaks, anyway? 
[Disclaimer: I've never claimed to be a mathematician, nor even a
cryptographer:my business card says 'cryptoengineer'. I've always tried more to understand how to  properly use cryptographic primitives than to understand the deep theory of their construction. I go to people who know the theory when I have a question, and they come to me when they need something designed and built correctly and well.]
Looking over the recent work on hash collisions, one
thing that struck me was that they all seem to be attacks on known plaintext - the 'plaintexts' which
collided were very close to each other,  varying in only a few bits. While any weakness is a concern, and I'm not
going to use any of the compromised algorithms
in new systems, this type of break seems to be
of limited utility. It allows you (if you're fortunate) to modify a signed
message and have the signature still check out. However, if you don't know the original plaintext
it does not seem to allow you construct a second
message with the same hash.
There are many applications where a hash may
be exposed, but the attacker does not have access
to the original plaintext. One example is password
systems, where only the hash of the pw is stored.
Thus, the breaks seem to be of utility in some applications, but others remain (for the moment)
Am I missing something here?
Peter Trei

@_date: 2004-07-20 11:07:39
@_author: Trei, Peter 
@_subject: EZ Pass followup. 
This may be of interest to the folks discussing EZ pass.
On ne.transportation, there is a thread regarding
the subject, titled:
Surveillance Equipment on I-95?
The most interesting post follows.
Peter Trei
It is part of the weigh station bypass system.      If
the truck has a participating transponder, it can usually skip the weigh
station if everything is in order.  The transponder will display a green
light to bypass, a red means a trip to the weigh station.  The light stays on
for a few minutes so that compliance can be checked, if needed.  Some
stations have weigh-in-motion equipment to verify that the weight
There are two major weigh station bypass programs in North America: PrePass
and NorPass.  You can see what states they are used here:
   Connecticut's weigh station(s) have been
compatible with NorPass for several years and they just joined NorPass as a
full member a few weeks ago.    NorPass doesn't have any fees once you buy your transponder.  (PrePass
charges for each bypass with a daily maximum).  All systems use a compatible
transponder, and it is possible to buy a transponder that also speaks the IAG
protocol so it can be used at E-ZPass locations for tolls (after the
transponder is registered with E-ZPass).

@_date: 2004-07-27 10:28:09
@_author: Trei, Peter 
@_subject: DES: Now 'really most sincerely dead' 
Back in late 1996, I wrote to Jim Bidzos, proposing an RSA
Challenge to break single DES by brute force computation. Later in 1997, the first DES Challenge was successfully
Its taken another 7 years, but NIST has finally pulled single DES as a supported mode. Favorite line: "DES is now vulnerable to key exhaustion using massive, parallel computations."
Triple DES is still a supported mode, as it
should be.
So, if a product claims to use DES for
protection, you can now officially diss them for it.
Peter Trei
[Federal Register: July 26, 2004 (Volume 69, Number 142)]
[Notices]               [Page 44509-44510]
[DOCID:fr26jy04-31]

@_date: 2004-06-08 17:15:25
@_author: Trei, Peter 
@_subject: Security clampdown on the home PC banknote forgers 
"The software relies on features built into leading   currencies. Latest banknotes contain a pattern of   five tiny circles. On the ?20 note, they're disguised   as a musical notation, on the euro they appear in a   constellation of stars; on the new $20 note, the   pattern is hidden in the zeros of a background   pattern. Imaging software or devices detect the   pattern and refuse to deal with the image."
It would be interesting to figure out exactly what the
'don't copy' information is. If it's really just five
little circles, think of the fun you could have -
- create a rubber stamp with the appropriate image, and
stamp all kinds of documents.
- sell a line of printer paper which can't be copied or
- make web pages which can't be printed.
- draw or tattoo it on your forehead, and suddenly no photo of you can be printed (or perhaps, even ahhhhhh - the law of unintended consequences.
Peter Trei

@_date: 2004-05-19 13:59:56
@_author: Trei, Peter 
@_subject: EU seeks quantum cryptography response to Echelon 
Actually, I read this as the sort of puffery we more often see
from the snake-oil vendors; "Our proprietary Auto Generated
One Time Pad (TM) crypto is soooo strong that the government
may ban it - get it while you can!"

@_date: 2004-05-28 11:39:11
@_author: Trei, Peter 
@_subject: Satellite eavesdropping of 802.11b traffic 
R. A. Hettinga
I don't claim great expertise, but....
802.11b/g operates in the microwave range - My home
net falls over every time my kid heats up a
burrito (It comes right back, though).
GSM phones run at a MAX of 0.25 watts (GSM900) or 0.125 watts (GSM1800), but it is normal for the power used to be one hundredth of this maximum or less.
However, the base stations are much more powerful - 50 watts. I suspect the spy-from-orbit stuff looks at this, not the phone transmitter. 802.11b/g typically runs around 0.1 watt, and there is no high-power base station.
If this is the case, then the power in an 802.11b/g
net is 1/500th of that for GSM phones - which seems
to fit in with the difference in range. Phones operate with kilometers to the base station, while
802.11b/g is lucky to cover a whole house.
A big antenna would obviously be a lot of help, but a
smaller one a lot closer would be better. If you insist
on listening from orbit, geosync is probably not the way
to go - you'd want something like the Iridium constellation
of low-orbit sats (600 miles up).
Clarke orbit (geosync) is about 35800 km up. You'd get
a 10,000 fold advantage by putting your spysats at only
358km. I suspect that eavesdropping on 802.11b/g from orbit is pretty hard. The power levels are very low, and there may be several nets running on the same channel within a satellites' antenna footprint. My summary: Very tough. Probably not impossible.

@_date: 2004-11-30 10:16:11
@_author: Trei, Peter 
@_subject: RSA Implementation in C language 
Admittedly somewhat old and creaky, but try Googling RSAREF. I don't know where that stands for IP rights
(presumably we still have copyright), bout for
research it's a startin point.

@_date: 2004-10-25 09:30:50
@_author: Trei, Peter 
@_subject: Financial identity is *dangerous*? (was re: Fake companies, real money) 
If we're going to insist on dedicated, trusted, physical devices for these bearer bonds, then how is this different
than what Chaum proposed over 15 years ago? If you just add a requirment for face to face transactions,
then I already have one of these - its called a wallet
containing cash.

@_date: 2004-10-29 09:53:51
@_author: Trei, Peter 
@_subject: Financial identity is *dangerous*? (was re: Fake companies, real money) 
I've been programming phones and PDAs for several years.
They are certainly powerful enough for symmetric operations.
Some at the higher end can to public key operations at a
reasonable speed. The lower end ones can't. Try taking a
look at the new Treos, the newer PocketPC devices, and
phones such as the Motorola A760.
Some of the devices partition their storage, with portions
that are easily modified, and portions which are more
secure. The carriers generally want to prevent users from
modifying the SW in ways which could enable fraud or damage
the network, yet allow downloads of games, apps, etc.

@_date: 2005-04-25 10:05:02
@_author: Trei, Peter 
@_subject: From [IP] i secure cell phone via software 
Interesting encrypted VoIP application for
Symbian GSM phones.
Peter Trei

@_date: 2005-08-25 09:42:47
@_author: Trei, Peter 
@_subject: Another entry in the internet security hall of shame.... 
Ironically, Peter's message above kicked off warning
dialogs from MS Outlook, since it was signed using a keypair
signed with Peter's own self-signed root, which was not in MSO's list of trusted
Self-signed certs are only useful for showing that a given
set of messages are from the same source - they don't provide
any trustworthy information as to the binding of that source
to anything.
Peter Trei
(not digitally signed, and not pretending to be)

@_date: 2005-02-02 09:52:21
@_author: Trei, Peter 
@_subject: Dell to Add Security Chip to PCs 
Seeing as it comes out of the TCG, this is almost certainly
the enabling hardware for Palladium/NGSCB. Its a part of
your computer which you may not have full control over.
Peter Trei
Tyler Durden

@_date: 2005-02-03 11:51:57
@_author: Trei, Peter 
@_subject: Dell to Add Security Chip to PCs 
Erwann ABALEA
Congratulations on your new baby.
Working in the security business, paranoia is pretty
much a job requirement. "What's the worst that could happen?" is taken seriously.
The best that can happen with TCPA is pretty good -
it could stop a lot of viruses and malware, for one
But the worst that can happen with TCPA is pretty awful.
It could easily be leveraged to make motherboards
which will only run 'authorized' OSs, and OSs
which will run only 'authorized' software.
And you, the owner of the computer, will NOT
neccesarily be the authority which gets to decide
what OS and software the machine can run.
If you 'take ownership' as you put it, the internal
keys and certs change, and all of a sudden you
might not have a bootable computer anymore.
Goodbye Linux.
Goodbye Freeware.
Goodbye independent software development.
It would be a very sad world if this comes
to pass.
Peter Trei

@_date: 2005-02-07 16:09:32
@_author: Trei, Peter 
@_subject: RSA Conference, and BA Cypherpunks 
Once again, the RSA Conference is upon us, and many of the corrospondents on these lists will be in San Francisco. I'd like to
see if anyone is interested in getting together. We've done this
At past conferences, we've had various levels of participation, from 50 down to 3. Since the BAC Physical Meetings seem
to have pretty well died out, I'd like to propose that those
of us who are interested get together for lunch or dinner at some point.
I'll be arriving on site Monday afternoon, and leaving Friday
morning. Thursday night, at least, is already spoken for.
At the moment, it looks like Monday or Tuesday night may be the best, though a lunch is also possible.
Any takers?
Peter Trei
ptrei at rsasecurity.com
RSA Data Security Conference
Dates: Feb 14-18 2005
Place: Moscone Center, San Francisco
 While the full conference is rather expensive, note
that you can get a free Expo pass if you register online
by 5pm Feb 14th.

@_date: 2005-02-17 19:56:07
@_author: Trei, Peter 
@_subject: SHA1 broken? 
Actually, the final challenge was solved in 23 hours, about
1/3 Deep Crack, and 2/3 Distributed.net. They were lucky, finding
the key after only 24% of the keyspace had been searched.
More recently, RC5-64 was solved about a year ago. It took
d.net 4 *years*. 2^69 remains non-trivial.
-----Original Message-----
Sent: Thu 2/17/2005 5:49 AM
  > I believe you are incorrect in this statement. It is a matter of public
   Its fine assuming that moore's law will hold forever, but without that you can't really extrapolate a future tech curve. with *todays* technology, you would have to spend an appreciable fraction of the national budget to get a one-per-year "break", not that anything that has been hashed with sha-1 can be considered breakable (but that would allow you to (for example) forge a digital signature given an example)
   This of course assumes that the "break" doesn't match the criteria from the previous breaks by the same team - ie, that you *can* create a collision, but you have little or no control over the plaintext for the colliding elements - there is no way to know as the paper hasn't been published yet.

@_date: 2005-02-24 10:00:06
@_author: Trei, Peter 
@_subject: FW: [IP] One cryptographer's perspective on the SHA-1 result 
Full disclosure: Burt Kaliski and I share an employer.
Peter Trei
-----Original Message-----
Of David Farber
Sent: Wednesday, February 23, 2005 7:48 PM
Hi Dave --
As you might expect, the recent breakthrough on SHA-1 hash was a topic of
widespread discussion at the annual RSA Conference last week in San
Francisco.  Commercial cryptography is one of few fields in IT which has
totally absorbed the "open review" process.  We know from experience that an
ongoing and aggressive analysis of our current technology, searching out
potential weaknesses, is a critical part of the process by which we
strengthen it for the future.
RSA Laboratories has just posted a brief note on the recent SHA-1 result, to
supplement our earlier notes about MD5 and other hashes, at
In my opinion, the latest result on SHA-1 -- once confirmed -- will be one
of the most significant results in cryptanalysis in the last decade.  Hard
work indeed brings a profit, as the proverb says, and the perseverance of
Xiaoyun Wang, Yiqun Lisa Yin, and Hongbo Yu appears to have paid off with
this unexpected special attack on SHA-1 that can find collisions in less
than the promised 2^80 threshold.
It is a delight to congratulate the Shandong University team on their
achievement, and especially Dr. Yiqun Lisa Yin, for many years my colleague
at RSA Laboratories, and one of the co-inventors of RSA Security's RC6 block
This attack seems to have uncovered an unexpected weakness in one of the
essential properties of SHA-1, a one-way hash function with a 160-bit
output.  Essentially, this new research suggests that it is considerably
less difficult than expected to create two somewhat different data files
that can be reduced and compressed to an identical hash value.
Cryptographers call these "collisions" in hash outputs.
A hash function takes a variable-length digital input and coverts it into a
fixed-length pseudo-random hash value that can serve as a useful
"fingerprint" for the input file.  A one-way hash function like SHA-1 is
easy to compute in one direction, but it's very difficult to reconstitute
the initial file from the hash value.  A good hash function is also expected
to be "collision-free." That is, it should be hard to generate two input
files which, put through the hash function, generate the same hash value.
(Hash functions collisions must exist, of course, since the hash inputs can
be longer than the outputs -- but the design goal is to make them hard to
find in practice.)
These attributes have made the one-way hash one of the most useful
"primitives" in modern cryptography.  Hash functions are, for example,
essential in deriving message authentication codes (MACs) and "message
digests," the small file that is actually cryptographically "signed" to
create a "digital signature" for larger files, in a typical public key
crypto application.
MIT Professor Ron Rivest, one of the founders of RSA Security, created three
one-way hashes that were widely used by cryptographers over the past 20
years (MD2, MD4, and MD5), but each of those was eventually deprecated as
subtle weaknesses were discovered that suggested that the internal design
was less robust than desired against potential future attacks.
Any successful attack on SHA-1 based on the new result would still involve a
huge amount of computer processing, so this latest research is unlikely (as
many have said) to have any significant impact on past or current
applications.  It is, however, a wake-up call for cryptographers and the
industry leaders concerned with the long-term vitality of our technology.
The SHA (aka SHA-0) hash function was developed for the US government in
1995 for use within the Digital Signature Standard.  Its design was based on
MD4.  SHA was upgraded to SHA-1 early in its life cycle, apparently to
address undisclosed weaknesses discovered by the NSA, and today SHA-1 is the
industry standard.  It is widely used and has been trusted by both
developers and applied crypto engineers, although routine efforts to enhance
SHA-1 with longer output values have led to the quiet development of
SHA-256, SHA-385, and SHA-512 as design options for long-term applications.
Although RSA Security, and most standards organizations, have recommended
the use of SHA-1 for several years, Rivest's MD5 is still widely used in
many applications despite research in the 1990s that discovered "pseudo"
collisions within the internal operations of MD5.  Then, last summer, there
were additional results on MD5 that led many cryptographers to urge the
abandonment of MD5 for SHA-1, which had withstood a great deal of analysis
and was widely believed to be "still secure."
It is easy to understand, with this history, why the recent SHA-1 result
would be so unnerving.
Cryptographers are notoriously conservative in their definition of security,
and the "break" in SHA-1 is accordingly much more a crisis for the designers
of these algorithms than for their users.
Thankfully, the practical impact on most applications today is still
limited.  For instance, as others have already observed, existing signatures
are not at risk due to a collision attack.  Nor are the many applications
that rely only on the one-way property or the pseudo-randomness of SHA-1.
New signatures, moreover, are only at risk if a signer is willing to sign a
message essentially as directed by the attacker.  And for such situations,
the cautious signer can just incorporate a little random data at the
beginning of the message to thwart the attack.
But for the research community, the situation is quite challenging.
As my colleague, Dag Str?man, pointed out to me, the MD/SHA family (which
also includes the RIPEMD functions) exhibits characteristics of a
"monoculture": the algorithms share many similarities, and attack strategies
on one are somewhat readily (though with impressive effort) adapted to the
Even though no similar flaws have been reported in SHA-256 yet, several
months of analysis will be needed by the cryptographic community before any
reassuring conclusions can be drawn.
Beyond that, it is now clear that the industry needs an open evaluation
process -- like the Advanced Encryption Standard competition -- to establish
a new hash function standard for the long term, or at least an alternative
if SHA-256 and above turn out still to be good enough after review.
At the Cryptographers' Panel at the RSA Conference last week, we played
clips of previous panel statements to see how they'd stood the test of time.
In one of those clips, from 1997, I discussed the dependence of so much
modern cryptography on these hash functions and wondered whether we, as an
industry, had enough of them.  In hindsight, I wish I had been more forceful
in expressing my concern, because last week's result from the Chinese team
suggest that the answer, even then, was probably "no."
Too bad we didn't start working on the new ones back then.

@_date: 2005-01-04 15:24:56
@_author: Trei, Peter 
@_subject: Banks Test ID Device for Online Security 
The slashdot article title is really, really misleading.
In both cases, this is SecurID.

@_date: 2006-08-11 09:41:37
@_author: Trei, Peter 
@_subject: SSL Cert Prices & Notes 
It is with some irony I note that this message from
Peter Saint-Andre failed a signature check - startcom
isn't among the trusted roots in my copy of Outlook.
Peter Trei
-----Original Message-----
[mailto:owner-cryptography at metzdowd.com] On Behalf Of Peter Saint-Andre
Sent: Wednesday, August 09, 2006 1:05 AM
Have you looked at StartCom?
Peter Saint-Andre
Jabber Software Foundation

@_date: 2006-02-02 18:20:21
@_author: Trei, Peter 
@_subject: Unforgeable dialog. 
"secure" dialog, > what prevents them from using the same techniques
and/or code to create a visually >  > identical spoof? (Hi Piers!)
I actually dealt with this in a former job, where I wrote a proxy
for Xwindows which did similar decoration for trusted and untrusted
X clients.
The trick is to invert the indicators - your rendering engine (whether
an Xwindows server, browser, or a windowing OS) has final say over the outermost frame of all windows.
You mark the *untrusted* ones in the outer frame - a malicous client can
do whatever it wants inside its windows, but it can't overwrite and hide
the untrusted indicators in the outer frame. (We put a fat black border
around them).
Of course, if you run on an OS where any app can modify any binary,
you're SOL.
Peter Trei

@_date: 2006-01-13 09:57:25
@_author: Trei, Peter 
@_subject: long-term GPG signing key 
I've actually seen something like this happen in real life. As you know, RSA has been running a series of 'Secret Key Challenges', wherein we ask people to try to brute-force messages encrypted with RC5 at various keystrengths. There is
a cash prize for the person turning in the correct response.
The messages are encrypted in CBC mode with 32 bit blocks. The start of the message has a known plaintext
Most of the recent challenges have been won by distributed.net.
While they were working on the 64 bit challenge, I received an
email saying that a proposed solution had been found, and was asked
to check it. (We set up the challenges in such a way that the
correct keys are unknown, even to us). The supplied key correctly decrypted the first block, but the
rest were gibberish. After scratching our heads, we realized that d.net had found a collision.
It was almost a year later they found the correct key, for the
$10,000 prize. They immediately started on the 72 bit challenge.
(I'm not holding my breath).
Peter Trei

@_date: 2006-01-28 12:14:11
@_author: Trei, Peter 
@_subject: thoughts on one time pads 
You missed the old standby - the microwave oven.
The disk remains physically intact (at least after the
5 seconds or so I've tried), but a great deal of pretty
arcing occurs in the conductive data layer. Where the
arcs travel, the data layer is vapourized. The end result is an otherwise intact disk in which the
data layer is broken up into small intact islands surrounded by clear channels. It might be interesting
to try a longer burn, in which case you might also
want to put a glass of water in with the disk(s) to
preserve the microwave's electronics.
This is probably less effective than the other methods
you've described, but its very fast and leaves no noxious
residues. It also uses a very commonly available tool.
Peter Trei
-----Original Message-----
[mailto:owner-cryptography at metzdowd.com] On Behalf Of Peter Gutmann
Sent: Saturday, January 28, 2006 2:25 AM
For no adequately explored reason I've tried various ways of physically
destroying CDs:
- Hammer on hard surface: Leaves lots of little fragments, generally
still stuck
  together by the protective coating.
- Roasting over an open fire: Produces a Salvador Dali effect until they
  fire, then huge amounts of toxic smoke ("fulfilling our carbon tax
  was one comment) and equally toxic-looking residue.
- Propane torch: Melts them without producing combustion products.
- Skilsaw: Melts them together at the cutting point, rest undamaged.
- Axe: Like skilsaw but without the melting effect.
- Using the propane torch and hammer to try and drop-forge a crude
  density CD: Messy.

@_date: 2007-02-06 09:30:11
@_author: Trei, Peter 
@_subject: FW: Entropy of other languages 
As a very rough proxy, look at the length of the same text in different
translations. My father was in advertising in Europe. When they laid out a print ad,
they always did so using the German text. If the German fit, any other
language they were interested in would do so as well.
Now that I work (among other things) on cellphone applications, I'm
running into similar issues in internationalizing text on tiny screens.
Peter Trei
Disclaimer: This is a personal opinion. It may or may not jibe with my
employer's opinion.

@_date: 2007-02-07 13:54:55
@_author: Trei, Peter 
@_subject: Entropy of other languages 
IIRC, it turned out that Egyptian heiroglyphs were actually syllabic,
like Mesopotamian, so no fun there.  Mayan, on the other hand, remains
an enigma.  I read not long ago that they also had a way of recording
stories on bundles of knotted string, like the end of a mop.
The string-encoding system was Incan, not Mayan. They're called
'quipus', and while they contain a lot of numeric data, its highly debated whether
they were a generalized writing system (most experts seem to doubt it).
The Maya used an logosyllabic writing system which has been deciphered,
most of the progress having been made in the last 25 years or so.
Peter Trei

@_date: 2007-02-27 10:21:56
@_author: Trei, Peter 
@_subject: padlocks with backdoors - TSA approved 
Let us hope that happnes - it won't make passenger security worse, and
would demonstrate that The Emperor Has No Clothes.
Even if that doesn't happen, it is presumabley feasible to
the keys by dismantling the locks.
Peter Trei

@_date: 2007-06-21 13:11:57
@_author: Trei, Peter 
@_subject: question re practical use of secret sharing 
RSA's BSAFE 6.2.1.0 supports Bloom-Shamir secret sharing.
Peter Trei
Principal Engineer
RSA: the Security Division of EMC.
Disclaimer: I am not a spokesperson for RSA or EMC.
-----Original Message-----
Charles Jackson asks:

@_date: 2007-05-18 16:04:39
@_author: Trei, Peter 
@_subject: Russian cyberwar against Estonia? 
1. Do you have any particular evidence that any significant
number of  US .gov machines are bots? They may well be, just I haven't heard this.
2. If you read the articles, you'll find that there is a
lot of circumstancial evidence to support the notion that
the attacks are from Russia or Russia-sympathizers. The
government recently moved a Soviet war memorial from the
center of town out to a military cemetary in the suburbs, an
action that Putin condemned as 'desecration', and which led
to a fatal riot by ethnic Russians in Tallinn, as well as attacks on the Estonian embassy in Moscow.
If the Russians aren't behind this, who else should be
suspected? It isn't like Estonia has a wide selection of enemies. :-)
Peter Trei

@_date: 2007-05-22 09:50:40
@_author: Trei, Peter 
@_subject: Russian cyberwar against Estonia? 
*country*" :-)
This threatens to get off-topic. To drag it back, I'll note that NATO
sent electronic warfare experts to observe and advise, and there is much
speculation as to how countries should respond to such cyber attacks -
at what point do they become an act of war, and how much certainty of
the source must there be to merit a response?
I guess its possible this was a random hacker, but the timing seems implausible. Aside from the DDOS attacks, many Estonian websites have been vandalized, and the vandals made it clear the moving of the monument was their motivation. Check out:
In addition, Estonia's embassy in Moscow has been blockaded, Russia has
cut off oil and coal shipments, and closed some road and rail links. Putin has described the move as a 'desecration'. This is a major
diplomatic feud.
In fairness, its worth noting that the issue is also mixed up
in Estonian electoral politics:
The timing of the electronic attacks, and the messages left by
vandals, leave little doubt that the 'Bronze Soldier' affair is
the motivating factor. Whether Russian Government agents were
involved in the attacks is not proven, but certainly seems possible.
Peter Trei
Disclaimer: My own opinions; not my employers.
Full disclosure: My ancestry is half Estonian.

@_date: 2007-10-25 13:18:36
@_author: Trei, Peter 
@_subject: Elcomsoft trying to patent faster GPU-based password cracker 
I was the person who originated the DES Challenges at RSA, and also
helped set up and run them.
I knew that there was a stealth effort underway at SGI, but didn't know any of the details. A good deal of cool stuff came out of the contests.
Other prior art against this patent would include using the DSP
chip in the Amiga graphics set for non-graphics purposes, which
was often done back in the 80s.
Peter Trei
Sent: Thursday, 25 October 2007 3:25 AM
  Moscow, Russia - October 22, 2007 - ElcomSoft Co. Ltd. has
  discovered and filed for a US patent...Using the "brute force"
  technique of recovering passwords, it was possible, though
  time-consuming, to recover passwords from popular
  applications. For example...Windows Vista uses NTLM hashing
  by default, so using a modern dual-core PC you could test up to
  10,000,000 passwords per second, and perform a complete
  analysis in about two months. With ElcomSoft's new technology,
  the process would take only three to five days..Today's [GPU]
  chips can process fixed-point calculations. And with as much as
  1.5 Gb of onboard video memory and up to 128 processing
  units, these powerful GPU chips are much more effective than
  CPUs in performing many of these calculations...Preliminary
  tests using Elcomsoft Distributed Password Recovery product
  to recover Windows NTLM logon passwords show that the
  recovery speed has increased by a factor of twenty, simply by
  hooking up with a $150 video card's onboard GPU.
-Michael Heyman
