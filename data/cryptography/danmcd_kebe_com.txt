
@_date: 2013-12-23 11:12:55
@_author: Dan McDonald 
@_subject: [Cryptography] RSA is dead. 
Congratulations Phil, you touched a nerve...  :)
Hell, even guilt-by-close-enough-association can bite you in the ass.  I'm
sure many networking security types here remember the IPsec Key Management
fiascos of the mid-90s.  Let me concentrate on one facet: SKIP vs. IKE.
I moved to Sun after two years at NRL (not NSA), where our team did Good
Open-Source Work (TM) on IPv6 and IPsec (before the term open-source was
fully and properly generalized, natch).  Once I arrived at Sun, I wanted to
continue that work in IPsec (including IKE), but I was blocked by political
forces from the invented-at-Sun-Labs SKIP group.  "Oh don't trust that stuff,
it's a backdoor for Key Escrow!"  I've never seen such FUD thrown around in
my life, and all of it was nothing more than to protect the millions that got
thrown into that group.
Moral of the story -> there's a lot of collateral damage (including giving
ammunition to people with orthogonal agendas) when such bombshells strike,
and that damage often includes the innocent. I shudder to think how many
babies might be thrown out with the NSA-polluted bathwater.
(More details available in-person, preferably with Islay or a decent
not-so-hoppy craft beer.)

@_date: 2013-10-14 20:47:50
@_author: Dan McDonald 
@_subject: [Cryptography] /dev/random is not robust 
*LINUX* /dev/random is not robust, so claims the paper.
I wonder how various *BSDs or the Solarish family (Illumos, Oracle Solaris)
hold up under similar scrutiny?
Linux is big, but it is not everything.

@_date: 2013-09-05 21:16:32
@_author: Dan McDonald 
@_subject: [Cryptography] Suite B after today's news 
Consider the Suite B set of algorithms:
Traditionally, people were pretty confident in these.  How are people's confidence in them now?
(first-time caller) Dan McD.

@_date: 2013-09-07 15:06:35
@_author: Dan McDonald 
@_subject: [Cryptography] Bruce Schneier has gotten seriously spooked 
That very statement prompted me to start the Suite B thread a couple of days ago.
What concerns me most about ECC is that your choices seem to be the IEEE Standard curves (which have NSA input, IIRC), or ones that will bring down the wrath of Certicom (Slogan:  "We're RSA Inc. for the 21st Century!").
I've said this repeatedly over the past year, but if whomever ends up buying Certicom-owner Blackberry would set them free, it would help humanity (at the cost of the patent revenues, alas).

@_date: 2013-09-17 19:39:58
@_author: Dan McDonald 
@_subject: [Cryptography] The paranoid approach to crypto-plumbing 
People have made these attacks mildly practical (and note how old this and the cited paper are).

@_date: 2014-08-07 20:10:17
@_author: Dan McDonald 
@_subject: [Cryptography] All dice are loaded? 
If a die (or d6 for you D&D types) starts off as a uniform cube, it would
make sense 6 comes up slightly more.  It's the side with the least amount of
weight (6 cuts on the side).  The other side of 6 is 1, which has one cut on
the side, and has slightly more mass.
The question is how "statistically significant" those cuts are.

@_date: 2014-08-11 11:26:35
@_author: Dan McDonald 
@_subject: [Cryptography] Dumb question -> 3AES? 
Diffie's EDE algorithm for a block cipher would apply to AES, correct?
Apart from "further pounding the rubble", is there any reason one couldn't
(or shouldn't) consider 3AES for, say, long-term offline storage encryption?
Dan McD.

@_date: 2014-08-11 16:50:21
@_author: Dan McDonald 
@_subject: [Cryptography] Dumb question -> 3AES? 
I'm less worried about the AES algorithm being broken (and yes, I understand
about 3des's effective key strength) as I am against Moore's law (and yes, I
also understand that the 9nm node may be the last one using current
technologies) and long periods of time.  I may be (unnecessarily) worried
about someone brute-forcing the data over decades.
Pardon the parentheses,

@_date: 2014-01-14 14:08:08
@_author: Dan McDonald 
@_subject: [Cryptography] Boing Boing pushing an RSA Conference boycott 
Security shouldn't be an industry -- it should be a lifestyle.  (Just like
performance.)  The "suits" you mention are those who see security as an
income supplement income, not as something to be thought of at product design
Perry and other will remember the IPsec KM wars.  One of the participants had
an ENTIRE GROUP in a large company devoted to security-as-product behind
them.  It's really hard to fight that much momentum when, say, you're trying
to build it in properly to the OS.
If RSA goes down in flames, I only hope it helps kill the security-as-extra

@_date: 2014-01-21 19:47:14
@_author: Dan McDonald 
@_subject: [Cryptography] RSA is dead. 
And for bonus points, the resultant FUD kept me from doing anything inside Sun related to IPsec for at least a year.
BTW folks --> in spite of the fragmentation of the spec (KAME/WIDE vs. Solarish), you can write your own IPsec key exchange on most major UNIX platforms using PF_KEY.  As one of the authors of the spec - and expert on the Solarish (Oracle Solaris, Illumos) ones, I can help anyone with interfacing problems.

@_date: 2014-06-05 15:58:51
@_author: Dan McDonald 
@_subject: [Cryptography] To what is Anderson referring here? 
A noticeable amount of IPsec deployments (IKE to be precise) uses PSK.  Some
implementations even let you use self-signed certs and explicit trust (not
the Big Name in Redmond, however).
Key management is ALWAYS the elephant in the room.  IPsec *can*, when
properly built, decouple key management (e.g. IKE) from the protection of
packets (AH & ESP).  This allows people to build better/faster/stronger KM

@_date: 2014-06-05 22:08:06
@_author: Dan McDonald 
@_subject: [Cryptography] To what is Anderson referring here? 
So called "secure VPNs" with widely-shared PSKs and (ewww) XAUTH for use with
existing authentication infrastructures was what I saw a lot of.
Generally I'm still bitter about internal-corporate-resistance causing
Solaris to be late to the party with IPsec and IKE.  OTOH, seeing what others
did let us make very sane implementation choices (like v. easy generation and
use of self-signed certs) that quite frankly, I still use today (albeit on
Ahh, if I only had paying cycles to bring an open-source IKEv2 to illumos.
Any bullshit I encountered at Sun *paled* to what the Lawnmower brought.
(And IKEv2 is in S11.2. Pity we'll never see its source. There're still good
people working on Solaris.)

@_date: 2014-06-19 16:18:18
@_author: Dan McDonald 
@_subject: [Cryptography] encrypting hard drives (was Re: Shredding a file 
ZFS crypto, closed-source thanks to Oracle, was supposed to address this
problem.  Its design was to apply crypto in the "ZIO" path, like it does for
checksums.  I've not used Oracle Solaris, but apparently ZFS crypto is in
there and it supposedly works.
And let me state for people wondering, "Why isn't it in OpenZFS already?"
1.) Nobody with appropriate subject matter expertise has customers who are
    beating them up for it.
2.) The same people are being beaten up by their customers for other things.
So no paying demand == no ZFS crypto.

@_date: 2014-06-19 18:05:20
@_author: Dan McDonald 
@_subject: [Cryptography] encrypting hard drives (was Re: Shredding a file 
That blog is 3.5 years old.  I think things have likely improved since then.
For now, yes.  That's what you're stuck with.
gives a rat's ass about interoperating with the Lawnmower.
Until somebody holds a big contract over someone's head, though, it won't get
done.  It pains me, but I do understand why.

@_date: 2014-05-13 09:27:17
@_author: Dan McDonald 
@_subject: [Cryptography] What faults would you inject to test crypto 
Allocation failures and checking for leaks & what-not.
  Illumos, and other Solarish systems, have libumem to help with this.  Just remember that there's no difference between a DDoS and a busy day.  :)

@_date: 2014-05-21 21:43:23
@_author: Dan McDonald 
@_subject: [Cryptography] How secure are hashed passwords? 
1.) I'd heard *encrypted* passwords, not hashed.
2.) For some f*cked up reason, Ebay has an upper limit on password size.  NO idea why.  :-P

@_date: 2014-11-19 13:48:50
@_author: Dan McDonald 
@_subject: [Cryptography] 100% Transparency vs. 100% open-source (was New free 
Sorry if I missed a note addressing this on the thread, but as a potential
consumer of a CA, I'm more interested in knowing EXACTLY what blend of HW &
SW are being used, down to as much detail as possible, and where possible,
using open-source.
If they're using Brand X of HW crypto module, I'd like to know what Brand X
is, which model number, and hopefully Brand X has an open-source driver for
at least two open-source OSes (I'm partial to illumos, but I'm fine if the
two are FreeBSD and Linux, e.g.).
Someone else mentioned HW-RAID... my suggestion:  don't use HW RAID.  ZFS
(available for illumos, FreeBSD, and Linux using ZoL) provides strong
mirroring and data integrity without using special HW.  That's the sort of
transparency design trade-off I'd like to see a CA make.

@_date: 2015-08-02 11:56:05
@_author: Dan McDonald 
@_subject: [Cryptography] asymmetric attacks on crypto-protocols - the 
It's a problem, like terrorism is a real problem.  ALSO like terrorism, the mere threat of such a problem can be used by people with strong NIH infections to push their own terrible alternatives simply by waving the threat of the "rough consensus attacker" around.
This has happened in Real Life before, and it will happen again.  It doesn't diminish the actual problem of a rough-consensus attack, but the concept is rife for hiding other abuses.  (Were I real tinfoil-hat-wearer, I might argue a rough consensus attacker would use NIH fanatics as a second prong.)

@_date: 2015-08-04 11:22:10
@_author: Dan McDonald 
@_subject: [Cryptography] asymmetric attacks on crypto-protocols - the 
Whoa.  I've only seen the strong-NIH version -- you're saying the modified
DNSSEC was sabotaged by "NSA BULLRUN" folk?
Do you have mailing-list archive pointers for folks in the audience?  That
might be some fascinating reading.

@_date: 2015-02-25 14:42:22
@_author: Dan McDonald 
@_subject: [Cryptography] trojans in your printers 
Amen to that!
My printer (which is functionally spectacular, but carries all the risks you
mentioned) is on my local home network with a static IP address, and more
importantly, has no off-link route (default or otherwise) in its tables.  (I
also disable the wifi and only use its wired ethernet... I should confirm
that when I get home).  It's hard for it to phone anywhere when it can't get
packets off the local-LAN.
If you compromise my home network, I have larger problems than JUST the
printer being malicious.  Isn't it all about risk-assessment at the end of
the day, anyway?

@_date: 2015-11-03 06:37:23
@_author: Dan McDonald 
@_subject: [Cryptography] Why Rijndael ? 
I don't have any papers or things to point at, but I was at Sun while this was going on.  We liked Rijndael because:
- It wasn't inherently little-endian biased.
- It didn't use integer multiply
Both of those things helped its SPARC performance a lot vs. the other AES candidates.
Sorry for the mere anecdotes,

@_date: 2015-10-15 15:03:27
@_author: Dan McDonald 
@_subject: [Cryptography] Fwd: freedom-to-tinker.com: How is NSA breaking 
I also wonder how long it'll be until it works with 1536-bit modulii or
larger.  Also, about 6 years ago, there was an RFC for DH groups with larger
generators.  We got those, AND ECC, into Solaris/OpenSolaris well before
Oracle hit the fan.  I suspect that also will help.
I'm SO glad we shipped S9 with 1536-bit DH, and got 2048, 4096, and ECC in
before the Lawnmower showed up (even if the illumos IKE is a
closed-binary...).  Pity we missed updating certs to use hashes beyond
sha-1.  OTOH, for self-signed it isn't as important, neither is it for
Dan (dusting off his IPsec cap...)

@_date: 2015-10-16 10:46:29
@_author: Dan McDonald 
@_subject: [Cryptography] Fwd: freedom-to-tinker.com: How is NSA breaking 
In other words, there are lower hanging fruit once you leave 1024-bit land.
(And yes, I'm aware of the lower-hanging fruit.)

@_date: 2016-08-26 22:07:56
@_author: Dan McDonald 
@_subject: [Cryptography] "NSA-linked Cisco exploit poses bigger threat 
An academic language for concurrency I learned in grad school -- SR -- had a
concept that, while used as one point on one axis, could be used for a
goto-like construct you suggest.
SR had a 2-by-2 abstraction matrix: call & send were one syntactically
identical axis, and proc & in were the other.  The combinatorics are:
send --> proc  ====> Thread creation (or remote program creation... SR's
runtime did remote too)
send --> in    ====> Message passing.
call --> proc  ====> Procedure call (remote or local)
call --> in    ====> Thread rendezvous ( in() is a blocking operation).
Could one do a variant on call --> in to have multiple entries into a
function at various points within it?  I see assembly routines with such
properties a lot.
Not my biggest beef with languages today (that'd be the absurdity that
there's no byte-order-specific data typing, see
for my full rant), but SR's call/send ==> proc/in could be used for things
like Ron describes.

@_date: 2016-07-22 08:42:26
@_author: Dan McDonald 
@_subject: [Cryptography] Entropy of a diode 
Didn't someone on this list wok somewhere that used to use floppy-disk motors for entropy, until the floppy-disk-drive manufacturer suddenly have a quality uptick and the entropy became sadly uniform?

@_date: 2017-07-11 20:39:20
@_author: Dan McDonald 
@_subject: [Cryptography] Creepy correlation noted 
I can confirm this by checking my caller-ID records when nobody's home, AND by not picking up my landline even when I am home.

@_date: 2017-10-24 14:11:46
@_author: Dan McDonald 
@_subject: [Cryptography] Transactional software updates 
Not QUITE what you're proposing, but the concept of "boot environments" has
been around in Solarish (Oracle Solaris & some illumos distros) for almost a
Essentially, a boot environment (BE) is a ZFS filesystem that contains that
which the OS needs to boot.  You have a current one, and any number of old or
new ones.  The trick with BEs is to separate what is configuration vs. what
is OS.  I know Oracle Solaris made some progress in this area after the great
barn door closing of 2010, while the illumos distros that use BEs
(OpenIndiana and OmniOS) might not have.
Such a scheme would likely work for any sort of filesystem that allows
easily-instantiable datasets, not just ZFS.  (If I understand correctly, both
btrfs and APFS would also allow implementation of BEs. But I *am* very
You run updates on a new BE in the background while you plow forward (on the
two illumos distros, you may lose some state if it's stored on the BE's
filesystem... this is where Oracle Solaris may have improved things).  Once
you reboot, the newly active BE does its thing.  The old BE can remain until
you destroy it for free disk space.
One thing such a scheme needs to consider is that sometimes an update is a
no-going-back update.  Often these involve changing an on-disk format, but
this isn't always the case.

@_date: 2018-02-13 07:38:37
@_author: Dan McDonald 
@_subject: [Cryptography] RISC-V branch predicting 
Didn't the older MMDF do this as well?  I worked at an org. that used MMDF.  While I never administered it, I swore it employed multiple processes to isolate the root-needed parts.

@_date: 2018-01-22 20:41:00
@_author: Dan McDonald 
@_subject: [Cryptography] RISC-V isn't the answer 
I hope appropriate workloads find this beast helpful.  I remember the Afara
Websystems SPARC design, which was bought by Sun and became the Niagara
family of processors (T1000, T2000, etc. etc.).  Niagara did poorly on more
traditional workloads, and won market share more through energy efficiency
than raw performance.
Maybe with side-channels becoming more of a not-just-us-security-types
problem, such massively-cored architectures can have another go.

@_date: 2018-11-11 21:18:33
@_author: Dan McDonald 
@_subject: [Cryptography] Early data mining efforts by the KGB defeated 
TL;DR --> traffic analysis works, even on people.  :)

@_date: 2019-01-10 12:54:52
@_author: Dan McDonald 
@_subject: [Cryptography] Digital dyes for tracing digital leaks ? 
Not as sophisticated as the linear spanning you're proposing, but the illumos (nee OpenSolaris) slab memory allocator has had leak-allocation-use-after-free-debugging for years.
Here're the header files with the patterns:
Coredumps with the memory debugging enabled allow post-mortem commands like ::findleaks in mdb to do just that.
Here's a 15 year old blog post describing it for userspace:

@_date: 2020-02-23 09:59:42
@_author: Dan McDonald 
@_subject: [Cryptography] ACME/Let'sEncrypt tutorial? 
The recent Apple thread has got me thinking.
I've been looking at (after 20+ years) putting TLS on (still read-only) kebe.com. All of the documentation assumes you've read a tutorial of some sort.  Is it just the RFC itself?  Or is there a simpler tutorial out there I can read?

@_date: 2020-07-07 01:11:57
@_author: Dan McDonald 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
Your story is missing a bit of credit-where-due, Bill.
You're missing a part of, GASP, the US Government who actually had a practical mindset, and a mandate from TWO different sponsors (neither of whom were up the road on 295):  NRL.  There's a reason the 182x RFCs were Ran-only.  :)
I should point out here that while we were trying to get our work out, there were some license-purists who thought that, GASP, BSD licensing wasn't free enough.  This caused stinks that might've attracted the WRONG sort of scrutiny, and we were scare shitless about the up-the-road folks from putting the hammer down.
Oooh I do remember that.  I remember some crypto-centered cynics thought it couldn't be built, and then we had our wonder-intern port our IPv6 stuff to IPv4 quickly during the summer of 1995.  :)
That plus good old-fashioned hubris/NIH.  Moving forward to 1996, I had to fight a whole division of Sun (the ones who invented SKIP) while I was sitting mostly alone in Solaris Internet Engineering.
You've already name-dropped the biggest offender there.  I'd be very curious to know who else has been since detected.  BTW, that FUD was used against me during my first year at Sun (You can't trust Dan, he's an govt. plant!).  I have my own theories, of course.
And finally:  A lot of us knew Key Management in IPsec was completely fubar, and was a part to be experimented with.  APIs helped here, and honestly I'm surprised more people didn't take advantage of it.  See RFC 2367 (and its improved and better-documented version in Now... on to the other note:
.  .  .
Oh hell yes.  See my prior mention of SKIP.
FTR we never put Aggressive Mode into Solaris.  We OEMed the core of its IKEv1 (a well-written one too) because of the SKIP nonsense costing us over a year.  IKEv2 was started while OpenSolaris was still around, but finished during the Oracle  occupation.
Goddamned router vendors who wanted to put everything into more monolithic code-bases.  You should be splitting EAP into its own IPsec-protected exchange.  We had crudest versions of this working as a Test Tool that was also a Productivity Tool until Oracle  shut that tool down.
Only ones I ever saw were godawful corner cases using no integrity/authentication or authenticate-then-encrypt, which were either impossible or just really stupid to configure.  Kenny Paterson had a few in the 2007-ish timeframe.
My $0.02, because I refuse to be erased,

@_date: 2020-07-09 14:30:38
@_author: Dan McDonald 
@_subject: [Cryptography] "Home router warning: They're riddled with known 
It's one of the strongest arguments for:
1.) Decoupling the WiFi access point from the NAT/Router.
2.) FURTHER distrusting wifi/NAT/Router combos provided to you by your
    helpful ISP.  (I've a VZ one that's sat unplugged since 2009, e.g.)

@_date: 2020-07-12 00:13:23
@_author: Dan McDonald 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
Oh I'm so glad you further completed the big picture.  ESPECIALLY for the parts where I was still a grad student and hadn't yet joined the fray.
Thank you.
That was spinning up as I was leaving... smart folks who worked on that.
Yes, mid-1993 I was finishing my last classes in grad. school.  Ran hired me thanks to a post on misc.jobs.resumes.
One or more of JI or Perry told me about this.
A big fan. The NRL IPv6-in-BSD paper was presented at the January, 1996 USENIX (while I was travelling from DC to CA to start Sun).
I've met those various *SWAN folks over time.
And a blacksmith too, IIRC.
I was annoyed nobody ever ported Photuris or other KM experiments to PF_KEY.  It would've worked nicely, I think.
As mentioned earlier, Solaris had to OEM IKEv1's core (from a very good implementation) to make perceived time-to-market.  It's why IKEv1 in illumos (the successor of OpenSolaris) distros is in the closed-binary wad.
No idea about patents, but their developers had pulled the wool over way-too-many eyes inside Sun.  I could've attacked the problem differently in hindsight, but even had I done it differently, I'd have been up against a LOT of internal pressure.
RIPE has copies:
I probably have 'em squirreled away somewhere here too.
Thank you!

@_date: 2020-07-20 20:09:52
@_author: Dan McDonald 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
I was there in the mid-90s, and we IPng-ers detested NAT, and thought it was
our mission in life to kill it dead. NATs were middleboxes that altered
packets and were an extra single-point-of-failure!  Also, we though NATs were
going to be easy targets for... wait for it... attackers, including-and-
especially state-sponsored ones!
Was it a misguided decision to not think about NAT-Traversal until the
early-2000s? In hindsight, absolutely.  At the time, it did feel very much
like the right thing.
Hell, I'd imagined (and I wasn't alone) IPsec being presented to apps as a
socket option that you had to turn on *per-socket* to use.  1st year at Sun
convinced me that wasn't great, because of Legacy Software (TM).  So much
stupid and greed can do more to kill something than one imagines.  In the
late 90s, someone asked me if we could use IPsec to protect Oracle database
traffic w/o paying Oracle some godawful *additional* sum for what was
essentially turn-on-SSL.  I said yes, but nothing came of it.  I suppose
Oracle is one of those friends-of-the-government companies[1], but hey, it's
likely more about greed ("A lawnmower doesn't care about your hand, it just
cuts grass!" - B. Cantrill).
I agree with you, Paul -- we have ourselves as much to blame as any external
[1] If I wear the right tinfoil hat, I can imagine Oracle was encouraged to
    buy Sun to prevent OpenSolaris -- which had both could've-been fully-open
    IKEv2, and a could've-been fully-open ZFS Encryption, under development
    -- from staying open.  I'll note that within the last few years the
    latter is now available, but the former never had interest, even though
    one of my colleages has hammered away at it on-and-off since the closing
    of OpenSolaris and the creation of illumos.

@_date: 2020-11-18 01:12:30
@_author: Dan McDonald 
@_subject: [Cryptography] IPsec DH parameters, other flaws 
A long time ago I built an IPv6 implementation. Wasn't that hard to understand in the beginning, but then it kept getting BIGGER.
With hindsight, it's clear v6 is a classic Second-System Effect example. You've read The Mythical Man-Month by Fred Brooks, right?  (And some of the coolness of v6 found its way back to v4 as well.)

@_date: 2020-10-10 00:20:00
@_author: Dan McDonald 
@_subject: [Cryptography] Exotic Operations in Primitive Construction 
I tried it, and I think you've some bugs.  Starting with an extra close-paren on each expression.  Losing those made it compile.
Now granted, your choice of parentheses generally was good, but your constant expressions were to me unreadable.
I've attached a program which contains a test harness, the original function (with one close paren moved from each operation), and an IMHO more readable version of the original.  It compiles well on MacOS, and on illumos (OmniOSce), and probably will work with Linux or *BSD just fine as well.  Correcting the buggy code is an exercise left to the reader, however.
Sample output showing it's incorrect:
nowhere(/tmp)[0]% ./r32-32 0x2112
Original(0x2112) = 0x40800000
Readable(0x2112) = 0x40800000
nowhere(/tmp)[0]% I believe the reverse32 of 0x2112 is 0x48840000.

@_date: 2020-09-03 15:36:41
@_author: Dan McDonald 
@_subject: [Cryptography] Really good ideas, harsh reality, 
It looks like an attempt to reduce bandwidth waste.  One thing I worry about,
if IP packets can span multiple tunnel IP packets, won't end-to-end
performance suffer under even mild drop rates?

@_date: 2020-09-30 15:21:37
@_author: Dan McDonald 
@_subject: [Cryptography] Exotic Operations in Primitive Construction 
Many of the RISC machines of the 90s (including SPARC) didn't have rotate, in
spite of some crypto users' best efforts.  To be fair, once the UltraSPARC T2
(aka Niagara2) came along, they went right past rotate and straight to
hardware crypto.
That figure SHOULD be more like 20-25 years: It's a simple peephole
optimization.  Oddly enough, it took a 1996 IETF visit to figure out that
Sun's x86 compiler didn't do that peephole, and it took them another 2(?)
years to fix it.
