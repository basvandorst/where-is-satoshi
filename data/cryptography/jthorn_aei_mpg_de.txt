
@_date: 2004-09-30 13:20:08
@_author: Jonathan Thornburg 
@_subject: Linux-based wireless mesh suite adds crypto engine support 
[[about the Via crypto sets]]
UNDOCUMENTED_EVIL_WIRETAP_MODE can be just about impossible to spot
without full design oversight.  Even for a 3DES chip, where supposedly
you can use deterministic test vectors to verify things, the following
scheme due to Henry Spencer embeds an almost-impossible-to-spot-in-practice
(N.b. the original URL is now dead, but google on the quoted phrase
      "GOTCHA, YOU OPEN-SOURCE WEENIES -- NSA RULES!" found two other
      archived copies)
          _________________________________________________________________
     [Date Prev][Date Next][Thread Prev][Thread Next][Date Index][Thread
     Index]
  Re: linux-ipsec: Intel IPSEC accelerator gives 3DES protected 100Mbit Ethernet
       _________________________________________________________________
       * To: Linux IPsec        * Subject: Re: linux-ipsec: Intel IPSEC accelerator gives 3DES
         protected 100Mbit Ethernet
       * From: henry at spsystems.net (Henry Spencer)
       * From: linux-ipsec at clinet.fi
       * Date: Thu, 16 Sep 1999 10:48:52 -0400 (EDT)
       * In-Reply-To: <199909161411.KAA02388 at tonga.xedia.com>
       * Reply-To: linux-ipsec at clinet.fi
       * Sender: owner-linux-ipsec-local at sandelman.ottawa.on.ca
       _________________________________________________________________
  > I don't know if you still follow the CP list but we have
  > been having a long debate on the trustworthiness of Intel
  > hardware, especially their RNG...
  At first I thought this was pretty much a non-issue here.  The problem
  with the RNG is that it's so hard to decide whether its output is "really"
  random.  But 3DES is a deterministic transform which can be tested against
  other implementations, so you can easily establish whether the chip is
  really doing 3DES or not.
  Alas, then I got to thinking.  Suppose one built a 3DES accelerator chip
  so that, if and only if:
  (a) the chip is doing near-continuous encryptions at high speed, and
  (b) the keys are changing every packet or two, and
  (c) the chip detects -- via a simple mechanism like a little hash table --
          a key which has appeared before, recently, and
  (d) this key has not been marked "compromised" in the hash table, and
  (e) an internal 16-bit packet counter is all-1s,
  then
  (!) mark the key compromised in the hash table, XOR the key with the
  string "GOTCHA, YOU OPEN-SOURCE WEENIES -- NSA RULES!", prefix it with a
  random-looking constant bit pattern, and sprinkle the resulting bits into
  the encrypted data, in a haphazard but deterministic pattern.
  This is, of course, an encryption error.  But rules (a)-(e) make it
  essentially irreproducible, so it won't happen a second time (and will be
  quite difficult to reproduce even in a test setup).  Almost certainly it
  will get written off as a random error, and the affected packet will be
  re-processed correctly and re-sent, and all will be well.
  Except that an eavesdropper on the high-speed wire just looks for the
  constant bit pattern in the right places in a packet, and (almost) every
  time he sees it, he's nabbed an encryption key.
  There's no limit to the complexity that can be added -- especially if
  you're willing to consider active wiretapping, with the chip going into
  this mode only if it sees (say) an ICMP ping with the right data in it --
  to defeat attempts to find this sort of thing on the test bench.
  I fear I agree with William; nothing short of peer review of the hardware
  design makes such a device trustworthy.
                                                            Henry Spencer
                                                         henry at spsystems.net
                                                       (henry at zoo.toronto.edu)
  -
  This is the linux-ipsec-local at sandelman.ottawa.on.ca mailing list. It is a
  restrict-Post filtered version of linux-ipsec at clinet.fi.
       _________________________________________________________________
     Follow-Ups:
       * Re: linux-ipsec: Intel IPSEC accelerator gives 3DES protected
         100Mbit Ethernet
       * From: Richard Guy Briggs
         linux-ipsec at clinet.fi
     References:
       * Re: linux-ipsec: Intel IPSEC accelerator gives 3DES protected
         100Mbit Ethernet
       * From: pkoning at xedia.com (Paul Koning)linux-ipsec at clinet.fi
       _________________________________________________________________
       * Prev by Date: Re: linux-ipsec: Intel IPSEC accelerator gives 3DES
         protected 100Mbit Ethernet
       * Next by Date: linux-ipsec: IP Sec w/ dynamic IP addresses ?
       * Prev by thread: Re: linux-ipsec: Intel IPSEC accelerator gives
         3DES protected 100Mbit Ethernet
       * Next by thread: Re: linux-ipsec: Intel IPSEC accelerator gives
         3DES protected 100Mbit Ethernet
       * Index(es):
            + Main
            + Thread

@_date: 2005-12-05 19:09:33
@_author: Jonathan Thornburg 
@_subject: [Clips] Banks Seek Better Online-Security Tools 
I would never use online banking, and I advise all my friends and
colleagues (particularly those who _aren't_ computer-security-geeks)
to avoid it.
Ahh, but how do you know that the transaction actually sent to the
bank is the same as the one you thought you authorized with that OTP?
If your computer (or web browser) has been cracked, you can't trust
_anything_ it displays.  There are already viruses "in the wild"
attacking German online banking this way:
   I also don't trust RSAsafe or other such "2-factor authentication"
gadgets, for the same reason.
[I don't particularly trust buying things online with a credit card,
either, but there my liability is limited to 50 Euros or so, and the
credit card companies actually put a modicum of effort into watching
for suspicious transactions, so I'm willing to buy (a few) things online.]

@_date: 2005-12-12 21:47:55
@_author: Jonathan Thornburg 
@_subject: [spam]::Re: [Clips] Banks Seek Better Online-Security Tools 
In an earlier message, I wrote
Jason Axley asked
Basically, so far as I know the fine print in online bank service
agreements basically says "you (the customer) are responsible for any
transactions we receive with your username and pin, and our electronic
records are the final word on this".
Thus if there is an a false transaction on my account, i.e. one which
I did not intend to authorize (whether this happened due to insider
fraud in the bank, MITM phishing, virus in my computer, or whatever
other cause), the basic legal presumption is that it's my loss, not
the bank's.  I consider the risks of this too high.
I would want the same ability to refuse an unauthorized transaction
that I have now with credit cards, where basically any losses over
50 Euros/dollars are the bank's problem, not mine.
For online banking, any/all of
(a) insider fraud at the bank and/or anyone else to whom they've
     outsourced relevant processing
(b) computer breakin/theft at the bank and/or anyone else to whom
     they've outsourced relevant processing
(c) MITM phishing or DNS hijacking
(d) viruses/worms in my computer
(c) and (d) above.  Also liability for problems is mine, not the bank's
(see above).  Also there are few paper records that I can use to help
document problems.
In the offline world, (a) and (b) are mitigated by paper records
(and forms with my written signature) which crooks usually don't
bother forging.
If I wire-transfer money from my bank in Germany to my credit union
in Canada, my written signature is (supposed to be) required to verify
that I did in fact authorize the transaction.  If the bank sends my
money off to a crook's account (whether by mistake or due to deliberate
fraud), the next time I get a statement I'll notice, and I'll ask them
what happened.  If the bank can't show me a piece of paper with my
signature on it, my understanding is that (if I complain enough) I can
force them to refund the money to me (so it's then their problem to try
to recover it from wherever it went).
Where I live now (Germany) people don't use cheques, they do bank
transfers which the *payer* gives direct to her bank.  These (are
supposed to) have the written signature of the payer (the account-holder).
If someone forges one of these and takes money out of my account, I can
refuse the transaction and (I understand) the bank is legally required
to refund the money to me (and it's their problem to recover it from
whoever got it).
When I lived in Canada (where people use cheques in the same way
as in the US), my understanding is that
(a) Even with the transit/routing numbers, noone is supposed to be able
     to take money out of an account without prior written permission.
     A cheque constitutes such permission _for_a_specific_transaction_,
     but not for any other transaction(s).
(b) If someone forges another cheque (eg scans my signature etc),
     and my bank honors it and takes the money out of my account.
     then since I didn't actually sign that cheque, legally it's the
     bank's fault for honoring it, and (if I complain enough)
     I can force the bank to refund the money to me (so it's then
     the bank's problem to try to recover it from the crook).
Well, in certain places that's basically what people do.  For example,
many foreign people in Bhagdad don't venture out of the "green zone".
My point is that when substantial amounts of money are involved, IMHO
the internet is basically a "red zone" where I don't feel safe venturing.

@_date: 2005-07-06 16:04:43
@_author: Jonathan Thornburg 
@_subject: [Forwarded] RealID: How to become an unperson. 
As a Canadian living and working in Germany, my legal "ID card" is
my (Canadian) passport.  (I don't have a German (or Canadian!) driver's
license.)  When I bought a cellphone calling plan the cellphone store
asked for this (I guess the police want to make sure an identifyable
person can be found for each cellphone number).
It was clear from our conversation that very few (if any) Canadians
had ever bought cellphone calling plans from this employee before.
(Not suprisingly -- there aren't that many other Canadians living
or travelling here.)  Indeed, I rather suspect mine may have been the first Canadian passport this particular employee had ever seen.
So... just how reliably could he have spotted a fake passport?

@_date: 2005-03-21 14:55:20
@_author: Jonathan Thornburg 
@_subject: Security is the bits you disable before you ship  
Ick.  Why not the simpler/clearer (and hence safer -- complexity makes
it harder to find bugs of any sort, including security ones) snprintf()
     N_LINE  999
    static char line[N_LINE];
    len = snprintf(line, N_LINE, "%ul , %ul\r\n", rp, lp);
snprintf() first appeared in 4.4BSD and is now in C99, so any modern
system should support it by now.

@_date: 2005-11-08 12:15:42
@_author: Jonathan Thornburg 
@_subject: gonzo cryptography; how would you improve existing cryptosystems? 
Nice, but linux-only and requires special kernel support.  cfs supports
lots and lots of different OSs and doesn't require kernel modes.  So far
as I know, in this regard cfs is unique among cryptographic filesystems.

@_date: 2006-01-27 11:13:43
@_author: Jonathan Thornburg 
@_subject: thoughts on one time pads 
Two other problems with using a CD for OTP key material:
1. How to insure physical security for the N years between when you
exchange CDs and the use of a given chunk of keying material?  The
"single CD" system is "brittle" -- a single black-bag burglary to
copy the CD, and poof, the adversary has all your keys for the next
N years.
2. How to securely destroy it after use, to prevent retrospective
dumpster-diving?  Nothing short of physical destruction will stop a
determined adversary... and physical destruction is *hard*:
Smashing the CD with a hammer leaves individual fragments which can
still be read with a microscope.  (That would yield "some" key bits;
a serious adversary could "drag" these across archived encrypted-traffic
to find the position which decrypts to something that's statistically
Melting the CD should work... but in practice that takes a specialized
"oven" (I seriously doubt my home oven gets hot enough), and is likely
to produce toxic fumes, and leave behind a sticky mess (stuck to the
surface of the specialized oven).

@_date: 2006-05-22 16:44:26
@_author: Jonathan Thornburg 
@_subject: Crypto hardware with secure key storage 
If you're willing to switch from GNU/Linux to other free OSs, you
can get excellent hardware-crypto support.  In particular, OpenBSD
( supports a number of crypto boards/boxes,
detailed on their crypto page (
They provide nice documentation, in particular they have _very_ good
man pages.

@_date: 2006-11-06 15:18:15
@_author: Jonathan Thornburg 
@_subject: Can you keep a secret? This encrypted drive can... 
I've been using Matt Blaze's CFS (cryptographic file system) to encrypt
personal E-mail archives since 1994 or so.  CFS is about the slowest
cryptographic file system around: it's implemented outside the kernel
(via an NFS loopback mount), so there are lots of userland <--> kernel
transitions and data copies going on.  And it uses 3DES, which is a
lot slower than (eg) AES.
Despite all that, CFS performance is just fine.  Back when I started
using CFS, on a 33 MHz SPARC, the performance hit was noticable but
tolerable.  Now, when multi-GHz laptops abound, the CFS performance
hit is really a drop in the bucket for normal interactive use on
moderate-sized files.
As a test, I just tried
   time dd if=/dev/arandom bs=65536 count=512 of=32m
(to time writing 32 MB of random data to disk) on my laptop
(Lenovo/IBM Thinkpad T43P, OpenBSD 3.9-stable).  I ran the command
three times (with different file names each time) on each of:
(a) a CFS directory backed by my laptop's /home file system,
(b) my laptop's /home file system (BSD FFS with soft dependencies), and
(c) my laptop's /tmp file system (a memory file system)
I was careless/lazy, so these trials all started with the system at
its "idling" clock rate (600 MHz), and let the system ramp up the
clock rate as needed once it noticed the CPU usage.
The times (wall-clock seconds from the 'time' command) were pretty
consistent for each of the 3 trials:
(a) 10.33 10.75  9.69
(b)  2.12  2.08  2.05
(c)  1.84  1.89  1.85
So... even for 32-MB files, CFS only takes about 8 seconds for the
encryption.  For smaller files the hit is truly negligible -- when
I tried this test on 64K files there was no difference in times between
(a), (b), and (c) within the timing noise.

@_date: 2007-01-16 16:12:29
@_author: Jonathan Thornburg 
@_subject: It's a Presidential Mandate, Feds use it. How come you are not 
[[cogent arguments snipped]]
A further point:  Do you really want the granularity of your encryption
to be "one key per disk"?  I much prefer a cryptographic file system
which lets me have separate keys for separate categories of information
(eg one key for my tax forms, a different key for company-confidential
project stuff, a different key for old love letters, still another one
for My Secret Plan For World Domination, etc etc).  These might all
live on the same laptop, but they probably need quite different key

@_date: 2007-01-16 16:25:04
@_author: Jonathan Thornburg 
@_subject: It's a Presidential Mandate, Feds use it. How come you are not 
[[about full-disk encryption]]
Yes, encrypted disks aren't much good unless the OS also encrypts
(at least) swap space.  I note that OpenBSD ships with swap-space
encryption turned on by default.  The encryption is done in software
using Rijndael.  On modern hardware the performance hit is minimal
(compared to the cost of the disk access).  See
  for a discussion of the security model.

@_date: 2007-01-18 12:26:32
@_author: Jonathan Thornburg 
@_subject: It's a Presidential Mandate, Feds use it. How come you are not 
[[addressed to Steven Bellovin, but copied to the whole list]]
If I have data that's valuable enough to need encryption, I'm going
to be nervous trusting it to closed-source software.  How do I know
that Compusec's cryto is done properly?  As Bruce Schneier has
famously said, to the user snake-oil crypto looks just like good
crypto -- both scramble the bits enough to look "random" to the eye.
In contrast, even though I haven't personally read the {linux,bsd}
crypto source code, lots of serious crypto geeks have, so I can be
a lot more confident that it's of at least reasonable quality.
Another issue is that closed-source crypto hardware/software has had
back doors planted in it in the past, either for "key recovery when
customers loose their keys", or after pressure by assorted government
agencies.  I'm sure the NSA could bribe someone to backdoor the Linux
kernel, but it would be really hard to keep this a secret when many
"uncontrolled" people get to browse the source code.
For the above reasons, I wouldn't trust either of these.
I keep _my_ confidential files under Matt Blaze's CFS; any of the
other open-source {linux,bsd} cryptographic file systems would be
reasonable alternatives.

@_date: 2007-01-20 14:15:06
@_author: Jonathan Thornburg 
@_subject: It's a Presidential Mandate, Feds use it. How come you are  not 
OpenBSD has had swap-space encryption for some years, and recent versions
turn it on in the default install.  I don't know what the other BSDs or
various Linuxen do by default.
OpenBSD's swap encryption uses Rajndael/AES implemented in software.
The performance hit is small on modern hardware, and still acceptable
even on slow hardware (I haven't seen any problems on an old 486/33
laptop I'm using as a home firewall/router).
For laptops (where physical theft is major concern), I think the
combination of an encrypting file system and swap encryption gives a
pretty good -- and readily configurable -- security/performance tradeoff.

@_date: 2007-03-31 00:19:15
@_author: Jonathan Thornburg 
@_subject: *AEI-SPAM-MARK* Re: Governance of anonymous financial services 
There's another point:  Suppose you come up with an ideal system which
preserves secrecy in the way you'd like.  How are you going to convince
assorted government agencies (eg the US Treasury Dept and its kin in
other countries) that your System won't be used for money laundering,
terrorist financing, or other nefarious purposes?
[N.b. I am *not* trying to start a flame war here, and in particular I
am *not* accusing anyone on this mailing list of nefarious purposes.
Rather, I'm asking a serious question about the practicality of anonymous
(crypto-enabled) financial services in the 21st century, namely, will
governments be willing to allow them to operate?]
