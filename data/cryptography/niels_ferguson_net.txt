
@_date: 2002-12-04 16:59:50
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
TGi is working on it. How and when it will be put into general use depends
mostly on politics, and that is something I cannot predict.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-08 03:07:22
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
As the designer of Michael and the countermeasures I think I should respond.
Yes, the Michael countermeasures allow a DOS attack. This was widely
discussed in 802.11-TGi before the countermeasures were accepted.
We cannot make the countermeasures weaker without weakening the entire
security. As the security for Michael is already marginal, I strongly
advise against weakening the countermeasures, or even configurable
countermeasures. If you want a fast and insecure protocol you can use WEP.
What we don't want to do is to do all the work to get a secure protocol,
and then invite users to destroy critical security properties in the name
of efficiency.
The Michael-countermeasures based DOS attack is not important for the
following reason: there are other, more serious, DOS attacks in the basic
802.11 protocol. If we 'fix' the countermeasures to make the DOS attack
more difficult the attacker will simply switch to one of the other DOS
attack modes. The net gain is zero, so there is no reason not to use the
countermeasures as specified.
The crucial observation is that any station can delete a packet whilst it
is in transit. Here is how to do it:
- Listen for a packet that you want to delete in transit.
- Receive the packet (you can store it for future use if you want), and
turn on your transmitter just as the final 4 CRC bytes are being
transmitted. By transmitting at the same time the last 4 bytes will be
jumbled at the proper receiver of the packet. The receiver will find a CRC
error and discard the packet.
- Now the tricky part: send a MAC-level acknowledgement to the packet
transmitter. The receiver didn't get the packet, so it won't send an ACK.
But if the packet transmitter receives a properly formatted ACK (which has
no cryptographic protection) then it assumes the packet arrived in good order.
Some discussions with other engineers showed that it is quite possible to
do this attack with existing 802.11b chip sets. Just like airsnort directly
drives the chipset, a different attack tool could perform this one.
Now for the higher-level attacks. You can create rules about which packets
to delete. Even though packet data is encrypted, it is often easy to
recognise the packet type just by its size, source, destination, and order
w.r.t. other packets.
Deleting all TCP ACK packets will take down the TCP functionality. You get
a network where NFS and ping work perfectly, but POP and HTTP do not work.
Deleting DNS lookups or DNS responses could also be interesting. Deleting
ARP packets will prevent computers form logging into the network at all.
DHCP is another avenue of attack. The list is quite long.
This packet-deletion attack is very effective as a DOS attack. It actually
requires less total transmission time than the Michael countermeasures
based DOS attack, so it should be even harder to detect. There seems to be
no cure for this attack short from completely redesigning 802.11, and I
have a feeling there will be little support for that.
The bit about prosecuting a jammer is very optimistic. 802.11 operates in
an unlicensed band. I'm allowed to transmit as much power in that band as
anyone else. Even if you find the jammer, her reaction might simply be:
``yes, so what?''.
Anyone using a wireless network for mission critical use is out of his
mind, and I consider it to be criminally negligent. Jamming an RF network
is just too easy. You can buy a 1 kW jammer right in the supermarket; they
are called microwaves.
If people don't want security they can switch to WEP or switch off the
security altogether. The quote from TGi is: we have enough efficient and
insecure protocols already. We don't need to add another one. Making the
countermeasures configurable is just a bad idea. What's worse: the next big
security story will be how the new improved WPA security can still be broken.
Most networks don't have security personal. If the access point _can_ be
switched to be outside the firewall, why wasn't it there to begin with?
That is of course where it should have been all along. And if you have
automated DF equipment (probably very expensive) than you can find the DOS
attacker but not necessarily do anything about him.
There is an algorithm called Michelle. That was my second attempt. Michael
is the third attempt. (The first one was called Mickey.)
I'd love to see more work done on how good a MIC you can create on these
slow CPUs, but the issue is moot. Michael is almost a year old now. It is
going to be fielded soon. Any new design would have a lead time of about a
year or so. We shouldn't spend our time re-fixing WEP. Instead our efforts
should be directed towards getting a good security protocol in place, using
AES as the main cipher engine.
I believe most existing cards will be useable with 802.11i by putting a lot
of the cryptographic processing onto the laptop. The laptop has enough
computing power to keep up with the network. So the switch to an AES-based
security system does not require all old cards to be thrown away.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-11 23:46:46
@_author: Niels Ferguson 
@_subject: Possible fixes for 802.11 WPA message authentication 
I can't go into details here due to NDA considerations, but this idea
cannot be efficiently implemented on some of the existing hardware.
This has no effect on the best attack we have so far. The attack is a
differential attack, and changing the key doesn't change the probabilities.
Just like idea 2, this doesn't affect the best known attack as that attack
never tries to recover the Michael key.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-11 23:40:55
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
I quite agree. Here I disagree. The Michael countermeasures do not introduce any danger
that does not already exist in the system. Therefore, removing the
countermeasures has no benneficial effects.
As I mentioned before, there are generic DOS attacks against 802.11 that
require very few transmissions. These can be used to mount the same attack
against WEP, WPA, the future AES-based security protocols, or any other
security protocol on top of 802.11. It is thus not specific to Michael or
the Michael countermeasures. It is a very valid criticism of the system,
just not of Michael.
That is the currently best-known attack on Michael. It means that an
attacker can forge a packet with probability around 2^-29. That is the
probability of success for each attempted forgery. If you let him try 1000
packets per second, then we expect the first successful forgery within a
week. I only spent a limited amount of time searching for the best possible
attack. We have to assume that the attack will be improved somehow. Before
you know it you are down to a timescale of hours or seconds. Currently we
have a factor of 2^9 between the design strength of Michael and the best
known attack. That is a _very_ small factor for a newly invented
cryptographic function. We cut it as close as we dared, and much closer
than I feel happy with.
Attacking Michael without countermeasures is practical right now. Giving
the user the option to destroy security is not a good idea. The article you
quoted points out that the vast majority of networks are misconfigured. The
obvious lesson is _not_ to provide configuration options that result in
insecure networks. If you want an insecure network that is not vulnerable
to the countermeasures DOS attack, you can switch to WEP or switch of all
security. This goes back to the TGi mantra: "We have enough efficient
insecure protocols. We don't need another one."
Michael was the best I could come up with given the parameters that I was
given. If you want more security, the simplest thing is to add one or two
rounds to the Michael block function, but this comes at a significant
computational cost. The feedback from TGi was that if Michael is too slow
then people will simply not use it because of the reduced throughput. This
is a tradeoff: If you make Michael slower and more secure, then fewer
networks will use it. Like any tradeoff you can argue whether the right
point on the curve was chosen. That doesn't change the fact that using a wireless system for
mission-critical tasks is a really dumb idea, and there is _nothing_ we can
do to change that fact. All 802.11 systems are open to a DOS attack. I'm
sure that users will use it anyway for mission-critical applications, and
people will get killed by it. Yes, and it will be dangerous until some regulator comes along and outlaws
it, or outlaws the inteference. Regulators are why we no longer use lead
pipes for our water, take arsenic as an antibiotic agains syphilis, or
drive without seatbelts.
As far as I know, nobody has yet proposed any viable solution to DOS
attacks against a wireless network that operates in an unlicensed band.
Maybe we can do it, but I'm fairly sure it will require a complete redesign
of 802.11.
Yes, we might be able to solve all these problems, but nobody has yet even
proposed a solution. It certainly isn't possible on the time-scale we are
talking about, and it certainly won't work on existing hardware, which is
what Michael is all about.
No, the problem is that the 2.4 GHz band in which 802.11 operates is an
unlicensed band. Anyone is allowed to transmit 100 mW in it, I believe.
Standard microwave ovens work on this frequency and can cause interference
with 802.11 networks. As far as I know it isn't illegal to interfere with
an 802.11 network as long as you don't transmit more than 100 mW. Maybe you
need a half-lame excuse for your transmissions, but that could be as simple
as doing your own experiments on microwave communication protocols. (Note:
I'm not an expert on these things, but this is what I've picked up so far.)
That's not how I read it. The DOS attacks do not _cause_ the transmission
of a program or command. They _prevent_ it. And it isn't clear that
stopping a computer from doing its work causes damage to the computer.
Anyway, I believe this gets well outside the scope of Michael and should be
left to the lawyers.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-13 14:49:14
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
We've gone through all the main argument here, and I think it is clear we
don't agree. I started writing a detailed reply to your last message, but
most of it was just argueing that we need authentication on 802.11 packets.
TGi had a limited brief: improve the security for 802.11, and that includes
providing authentication. Many of your arguments depend on properties of other parts of the system. A
few forged packets won't cause too much danger. We can DF the transmitter,
and then do something about it. We can catch Bob when he collects the
money. We can detect the attack and let the humans respond to it. We can
implement alternative countermeasures in the form of a filter. You can't assume that any of these are true. We can't tell our customers
something like: "Here is the security upgrade for your existing hardware,
but you need to buy DF equipment, staff your wireless network security
office 24*7, re-design all your applications such that a few forged packets
do not do too much harm, buy new APs with enough memory to implement the
new filter functions, and establish a world-wide police system to arrest
Bob at any bank in the world when he tries to collect the money." Our job is to secure 802.11, nothing more, but certainly nothing less. That
means that we have to provide authentication for all packets. The only
sensible measure of how well we do that is how much effort it takes an
attacker to forge a single message. I will therefore restrict myself to the issue of securing 802.11, and not
go into any of the other aspects of the system.
The 2^-29 probability comes from carefully choosing a particular difference
pattern in the message. For certain carefully chosen difference patterns
the MIC value does not change. Alternatively, you can use carefully chosen
difference patterns in the message and a related chosen difference in the
MIC value. The probability here is taken over all possible Michael keys.
Yes. That seems more work for Bob than breaking into the office and tapping
directly into the Ethernet cables, which is the original security goal of WEP.
We all know it only takes one smart programmer to program it, and then the
attack becomes just a tool. My DOS attack is also a super-slick one. You
can think up many other ones that are much simpler to program, like
disturbing the beacon or sending false beacons. Besides, I don't understand where you want to go with this argument. You
argue for a configuration switch to switch of the countermeasures. The
basic forgery attack still exists, so now the attacker can do the DOS
attack and get the countermeasures switched off. Are you saying that
Michael without countermeasures is secure enough?
Not if you cancel the ARP packets for new stations. And the attacker would
detect these collusing stations and ignore their packets anyway. And I can
think of several more DOS attacks against 802.11, but I don't have the time
now to work out the details.
That is exactly what TGi is doing. There are two levels of strength, the
quick-fix for existing hardware which uses Michael, and a new security
protocol that uses AES as the cryptographic basis. The AES-based work isn't
finished yet, I gather. I agree that all new hardware should use the
AES-based security system, but it has to be finalised before people can
implement it.
I've worked in cryptographic security for over a decade now, and I've yet
to see a security option that helped making the systems more secure.
Security is only as good as the weakest link. Any option that creates a
weak link creates a security hole. If you have even a single hole, you
might as well not bother with the cryptography at all. If I had things my
way there wouldn't even be the option of switching the cryptography
protocol off.
Anyway, we seem to be mostly going around in circles, and this is quickly
losing its interest for me. I think I've given all the relevant arguments
from my side. We had exactly the same discussions within TGi, and after
much discussion TGi chose what it considered to be the best route. I don't
think this is the forum to re-do TGI's work. P.S. I'm not on this mailing list, so I can only respond to email that is
sent directly to me.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-14 18:19:04
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
I would contend that I am not "the same sort of standards people that let
WEP out the door". Have a look at my website and list of publications
( I've been designing cryptographic systems
since 1990. That doesn't mean that I don't make mistakes. I make many of them. Michael
is very much an on-the-edge design, due to the harsh requirements. It is
quite possible that someone will find a better attack against Michael, but
unless I really goofed it will take Ian more than a single lunch break. Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-16 15:16:55
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
802.11a, and 802.11b. The differences are purely in the PHY layer. That is,
the exact radio modulations are different, but the whole MAC layer is
identical. It would break modularisation to link a MAC layer feature to a
PHY layer feature.
The other reason is that 802.11a hardware is already being shipped, and the
AES-based cryptographic protocol has not been finalised. This would provide at most a very marginal security improvement. A
differential attack can leave the final MIC value unchanged, and adding an
extra encryption would not help. See the Michael security analysis for
Rotating the output in a key-dependent way is dangerous. You expose the
rotation constants to discovery using a differential attack.
Additional integrety checks would require extra cycles, which we could also
have spent on a more secure Michael version.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-19 04:57:39
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
The current alternative would be to ship _no_ 802.11a products. That might
be intellectually preferable, but that's not how the real world works.
Well, no. The time it takes for an attacker to forge a Michael packet
consists mostly of the 1-minute delays of the countermeasures. Using a
faster PHY protocol doesn't speed up the attack, so Michael has the same
strength for 802.11a and 802.11b.
But there _isn't_ enough processing power to run a super-Michael. If there
were, I'd have designed Michael to be stronger. Maybe you are suggesting is to add yet another cryptographic function; the
current Michael for existing hardware and a super-Michael for newer 802.11a
hardware. Developing super-Michael would cost a couple of month and a lot
of money. I would consider that a waste of effort that should have been
spent on the AES-based security protocols. That is where we are going, and
we need to get there ASAP. It is perfectly possible to design 802.11a
hardware today that will be able to implement the future AES-based security
protocols. That is what software updates are for.
There are millions of 802.11b chips out there. I don't know how many
802.11a chips there are in the field, but certainly a few orders of
magnitude fewer. Creating a significant slow-down for millions of fielded
units is unacceptable. The whole point of WPA is to work well on fielded
units. New hardware should implement the AES-stuff.
Aah, but the cost isn't negligible. The per-packet overhead is significant
for small packets, and adding more computations for each packet will reduce
the system throughput even further. For a performance-critical design this is a non-argument. We could apply an
FFT, and it may prevent certain attacks, but we won't.
But you'd need to implement SHA1 in software. I don't know whether there is
enough code and memory space on each of the fielded chip sets. Do you? And
do we have a cost estimate for implementing SHA1 on all fielded chip sets?
And how does that cost estimate compare to security improvement? Is this
worthwhile? Those are standard design questions. I looked at better mixing at the end
of the Michael function and decided against it. It would slow things down
and the attack that changes the last message word and the MIC value had
much the same security bound as the differential attack that does not
change the MIC value. There is no point in strengthening one link of the
chain if there is another weak link as well. Of course, this isn't how I
normally design cryptographic functions, but Michael is a severely
performance-limited design. No, that doesn't work. It would mean that doing a re-key protocol does not
ensure that the keys on both sides agree. It would be easier just to ask
for 128 key bits from the key management system. It has a PRF and should be
able to do it.
If you are suggesting to run IPsec over 802.11, I'm all for it. That is the
configuration that I would suggest. IPsec over 802.11, with the best 802.11
crypto switched on of course. But the higher layers are outside the scope
of our discussion. We are providing 802.11 security and can't count on the
higher layers.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-11-30 00:48:38
@_author: Niels Ferguson 
@_subject: DOS attack on WPA 802.11? 
No, but a new standard has to work on _all_ (or almost all) existing
hardware. Backward compatibility is of primary importance for acceptance of
the new standard. If it isn't backwards compatible it won't be used, which
is much worse.
There will be a stronger variant of WPA: The TGi AES-based protocol. It
just isn't finished yet.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-09-16 21:47:33
@_author: Niels Ferguson 
@_subject: Cryptogram: Palladium Only for DRM 
Dear all,
Well, it is kind of silly to argue with someone anonymous who doesn't even
provide a return address, but his or her arguments exactly reflect the
erroneous arguments for Pd.
Before we continue, I should state that all I know of Pd is based on the
presentation at the rump session of Crypto 2002 and the following
discussion with several Microsoft employees.
We don't need Pd for a "secure vault". Standard cryptographic techniques,
just like the ones that Pd uses, are perfect for this. And protecting the
secure vault form viruses etc. is something that you don't need Pd for. It
is the operating system that _chooses_ to allow one program to interfere
with another. I know it is too much work to rewrite Windows, but you could
run a secure kernel, very much like the Pd kernel, on existing Pentium
hardware and provide perfect separation between programs. If VMware can do
it on existing hardware, why can't Microsoft?
I designed e-cash banking protocols for a living at DigiCash. There is no
need for the remote bank to check that the local client is clean. Like I
said, we have cryptography to handle that. And a security kernel on Pentium
hardware could perfectly well check whether a client has been infected by
checking a digital signature. Again, no need for special Pd hardware at all. And this is where I think you go wrong. All the problems you mentioned can
be solved using existing hardware. If you take the Pd architecture and run
the 'secure chip' functionality on the main CPU, you get a system that
achieves all the goals of the Pd project, except that the user keeps
control of his own machine.
This was my original comment: the only reason why you need a separate chip
it to take away control from the user. And it is all done under the guise
of providing security for the user. Much of the Pd work is very valuable in
finally providing reasonable security for the PC, but the 'secure chip' is
only there to support DRM and take control away from the user.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-09-17 03:17:01
@_author: Niels Ferguson 
@_subject: Cryptogram: Palladium Only for DRM 
But I am not suggesting to do it purely in software. Read the Intel manuals
for their CPUs. There are loads of CPU features for process separation,
securing the operating system, etc. The hardware is all there!
The 'secure chip' in Pd is only needed for DRM. All other claimed benefits
of Pd can be achieved using existing hardware. To me this is an objectively
verifyable truth. How can that be an extreme position, unless you wish to
call anything that contradicts your marketing speak an extreme position.
How does the virus ever get to the security-critical portion of the OS?
Maybe I have to explain the obvious. On boot you boot first to a secure
kernel, much like the Pd kernel but running on the main CPU. This kernel
then creates a virtual machine to run the existing Windows in, much like
VMware does. The virus is caught inside this virtual machine. All you need
to do is make sure the virtual machine cannot write to the part of the disk
that contains your security kernel. There is a company here in Amsterdam called NAH6 who is doing exactly this
to secure a notebook. You first boot to a minimal Linux, start VMware, and
run Windows inside the VMware. You can then encrypt all disk accesses,
including things like the Windows swap file. No virus can get at the
security kernel, because it is caught in the VMware virtual machine. There
is a beta available for download at  This isn't rocket science.
But how does the virus get to the keys used to authenticate the user to the
bank? It doesn't. The virus could put a window up on the screen and entice
the user to type his password. The virus can then start the banking client
and generate the user interactions for the client to perform payments. But
guess what? This virus will work just as well against Pd. Of course, you
could put security features into the OS and GUI/keyboard to allow a
(secure) program to securely communicate with the user. But this solves the
problem both in my and the Pd setting. Again: no difference.
all. See above for the fallacy of your argument. The security kernel can easily
protect itself against any virus. Who are you protecting against? If the system protects the interests of the
user, then you don't need to protect the system from the user. The security
chip is only useful if you try to take control away from the user.
I've done years of research into securing transactions with the use of
tamper-resistant hardware. Back in '93 I published a paper on an electronic
payment system that used tamper-resistant hardware to improve security.
( It was one of our
main lines of work at DigiCash. Now, let me tell you our conclusions from years of research on how you
could use tamper-resistant hardware. The hardware becomes really useful if
it is owned and controlled by the user and it has its own controlled user
interface. That means a separate LCD screen and keys, not just a corner of
the monitor. That is not what Pd provides. There are some marginal
bennefits for having just a tamper-resistant module in the computer. But
then this module must be hardened from attack by the user, something the Pd
chips is not according to the presentation I saw. And the Pd presentation
never mentioned anything like the scenario where this gets even marginally
useful. You can, for example, use the tamper-resistant hardware to prevent users
from double-spending digital money, and then use cryptography to detect
them when they break the hardware and do it anyway. We looked at this for
years, but it isn't worth the trouble. The security provided by the chip is
not high enough to make it really useful for large or small transactions.
(It might be good enough for medium-sized transactions, but that is a
limited market.) No sensible bank will bet its own money on the chip (and I
have spent lots of time selling secure payment systems to banks) so you end
up using cryptography in real-time to prevent the attacks from occurring in
the first place. But then you don't need the chip anymore. Been there, done
that, even got the mug.
In the mean time we have gotten way off topic. I said the claimed benefits
of Pd can be achieved with existing hardware except for the DRM. You are
argueing that there is a use for a Pd-like secure chip, something that is
very different.
Like I said before, most of the Pd stuff is really welcome. Everything
except the secure chip is a great improvement, and long overdue. My
observation is that the secure chip is only needed to do DRM, and that
trying to sell it to the public under the 'we need more security' banner is
bogus. Now which part of this do you think is intellectually dishonest? And
what are my political aims? I have no interest in bashing MS or anyone
else. I just wanted to point out the flaws in some of the Pd arguments.
Please, name a few. So far the banking example seems to have fallen apart.
It also happens to be the field I've worked in for nearly a decade, so
maybe that helped. And a similar amount of code can achieve exactly the same on existing
hardware. The security kernel has the same set of functionality in either
case, so it remains the same size.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-09-17 12:48:52
@_author: Niels Ferguson 
@_subject: Cryptogram: Palladium Only for DRM 
Thanks, Peter, for a nice reference. That paper points out that the Pentium
doesn't make it easy to create a virtual machine that is perfectly
transparent, i.e. that the OS inside the VM cannot detect the VM at all. I
don't think that is the current concern, as the OS and secure kernel are
being developed by the same company. I'm sure the secure kernel is
significantly easier to develop if you can make some small changes to the
OS code, but even without this VMware shows that it can be done without any
help of the OS.
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E

@_date: 2002-09-17 17:37:46
@_author: Niels Ferguson 
@_subject: Cryptogram: Palladium Only for DRM 
Well, I'm tired of this. AARG, or whoever is hiding behind this pseudonym,
is obviously not reading the responses that I send, as he keeps asking
questions I already answered. I'm not going to waste more of my time
responding to this. This is my last post in this thread.
Have Fun!
Niels Ferguson, niels at ferguson.net, phone: +31 20 463 0977
PGP: 3EC2 3304 9B6E 27D9  72E7 E545 C1E0 5D7E
