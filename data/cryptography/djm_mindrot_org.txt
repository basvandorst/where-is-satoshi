
@_date: 2001-12-28 11:42:59
@_author: Damien Miller 
@_subject: (A)RC4 state leakage 
The common wisdom when using (A)RC4 as a PRNG seems to be to discard
the first few bytes of keystream it generates as it may be correlated
to the keying material.
Does anyone have a reference that describes this in more detail? Or
am I confused :)

@_date: 2001-09-20 09:38:54
@_author: Damien Miller 
@_subject: NYC events and cell phones  
Would switching off crypto improve the performance of the base stations at all? If so, the motivation may have been less sinister.
[Moderator's note: I was under the impression most base stations did
the crypto in hardware, so the answer would be "no, no performance
gain" for such equipment. Besides, the main concern would be open
channels, not CPU load. Anyone know better? --Perry]

@_date: 2003-10-17 07:07:13
@_author: Damien Miller 
@_subject: WYTM? 
I don't think that this is an accurate characterisation of the situation wrt SSH. The SSH protocol supports certificates (X.509 and OpenPGP), though most implementations don't. Around a year ago, Markus Friedl posted patches to enable X.509 certs for OpenSSH, but there was little interest.
Also, SSH is somewhere between the two extremes of ADH and the PKIish hierarchial trust. Protocol 2 uses DH, so you have the PFS properties, but most implementations offer better
opportunities for key verification than the popular SSL implementations (in web browsers). E.g. I don't recall a web browser offering a fingerprint for a private key, except behind a number of confusing dialogs, nor present me with ALL CAPS warnings when webservers change their keys.

@_date: 2003-10-19 01:42:34
@_author: Damien Miller 
@_subject: WYTM? 
I think that you are misrepresenting the problem a little. At least one vendor (ssh.com) has a product that supports both X.509 and PGP, so the inclusion of these in the I-D is not just marketing overriding reality - just a lack of will on part of the the draft's
authors. I have seen little involvement on the secsh wg mailing list by the ssh.com people since the public spat about trademark rights over "ssh" a few years back. Since noone else implements these two public key methods, the work has never been done. IIRC The wg decided to punt the issue to a separate draft if it ever arose
again. It hasn't in two years. In the meantime, everyone involved seems to have become deathly afraid of touching the draft so as not to impede its glacial progress through the IETF on its way to RFC-hood.
Whether a sizeable number of customers acutally use certificates for ssh is another matter. IMO The only real use for certs in ssh is the issue of initial server authentication. If one wants to use certificates to facilitate this process, they can already - just publish the server keys on a https server somewhere and/or sign them with PGP :)

@_date: 2004-06-16 23:54:17
@_author: Damien Miller 
@_subject: Is finding security holes a good idea? 
If developers are just treating bugs as isolated defects, and not
searching for typologies of problems then this may be true. If we search
for common problems and repair all that we find, then we will do better.
In many cases, this doesn't take as much additional work as finding the
first instance. Sometimes it can be as little work as writing a regexp.
Of course, not all bugs are as easy as replacing strcpy (e.g. integer
overflows are subtle), but this approach is working. What was the last
trivial buffer overflow in a *BSD?
I suspect that auditing coverage is usually going to be very similar to
the search patterns used by blackhats - we are all human and are likely
to be drawn to similar bugs. Auditing may therefore yield a superlinear
return on effort. Is that enough to make it a "good idea"?

@_date: 2004-09-21 16:42:37
@_author: Damien Miller 
@_subject: Time for new hash standard 
I haven't seen any discussion on constructions based on "universal
hashing", like the UHASH underlying UMAC[1]. Can any cryptographers
comment on this?
UMAC seems like a particularly nice MAC, because it is supposedly
provably-secure (to the extent that AES is) and benefits from hardware
speedups to AES.
[1]

@_date: 2005-12-17 12:09:20
@_author: Damien Miller 
@_subject: Crypto and UI issues 
Untrue, something which a moment's checking would have revealed.
A brand new key requires user acceptance:
A changed host key (a much more risky situation) forces the user to
manually remove the old key, hopefully forcing them to think about the

@_date: 2005-12-19 08:12:11
@_author: Damien Miller 
@_subject: browser vendors and CAs agreeing on high-assurance certificates 
How much money does a phishing site make before it is forced to close?
(and change its cert) Would it be greater or less than the cost of a HA
If browser vendors make UI changes to indicate the presence of a HA cert
to users (some are apparently considering changing the URL bar green),
and users trust HA certs more as a result, then that increases their
value when used in a scam.
It isn't too much of a stretch of the imagination that phishers would go
to the trouble of registering companies and forging enough of financial
record to meet the higher assurance standards if it would make users
more credulous of their site.

@_date: 2005-10-24 12:39:42
@_author: Damien Miller 
@_subject: [smb@cs.columbia.edu: Skype security evaluation] 
More worrying is the disconnect between the front page summary and the body of the review. If one only reads the summary, then one would only see the gushing praise and not the SSH protocol 1-esque use of a weak CRC as a integrity mechanism (section 3.4.4) or what sounds suspiciously like a exploitable signed vs. unsigned issue in protocol parsing (section 3.4.6).
Also disappointing is the focus on the correct implementation of cryptographic primitives (why not just use tested commercial or open-source implementations?) to the exclusion of other more interesting questions (at least to me):
- What properties does the proprietary key agreement protocol offer (it
   sounds a bit like an attenuated version of the SSH-1 KEX protocol and,
   in particular, doesn't appear to offer PFS).
- Does the use of RC4 follow Mantin's recommendations to discard the
   early, correlated keystream?
- How does the use of RC4 to generate RSA keys work when only 64 bits of
   entropy are collected from Skype's RNG? (Section 3.1)
- Why does Skype "roll its own" entropy collection functions instead of
   using the platform's standard one?
- Ditto the use of standard protocols? (DTLS would seem an especially
   obvious choice).
- What techniques (such as privilege dropping or separation) does Skype
   use to limit the scope of a network compromise of a Skype client?

@_date: 2005-09-02 09:59:53
@_author: Damien Miller 
@_subject: Another entry in the internet security hall of shame.... 
This sounds like a solution replete with all the problems that passwords have had all along: users choosing bad ones, using the same ones for different sites, never changing them, servers getting hacked (disclosing the probably-shared passwords of thousands of users), etc. ad nauseum...
The last threat is particularly pertainent because it appears there is a requirement for servers to retain the PSK in cleartext. (To be fair, the draft does RECOMMENDED that implementations provide a way to generate random PSKs, but this has been recommeded for passwords in general for decades, to little effect.)
Given the complete lack of good password management practice in the vast majority of websites, what will make them start doing things right with Maybe some of this could be solved with a good UI in the web browser (e.g. by treating the PSK as a key rather than a password), but arm-waving about UI refinements applies to improving certificate handling too.

@_date: 2006-08-09 13:08:03
@_author: Damien Miller 
@_subject: SSL Cert Prices & Notes 
Startcom ( also does free "low assurance" certificates. Their CA has already been accepted for the next major release of the
Mozilla products and, unlike CAcert, has undergone an independent audit.
See also  for Mozilla's
list of CAs and their status.

@_date: 2006-08-11 15:43:01
@_author: Damien Miller 
@_subject: compressing randomly-generated numbers 
What are you trying to achieve?
An ARC4 keystream derived from fixed key is 100% predictable and yet
cannot be compressed by anything you would normally call a "compression

@_date: 2006-06-24 12:25:36
@_author: Damien Miller 
@_subject: A weird macro virus story 
How do you know it was targeted and not just following the common email
virus/worm propagation behaviour of mining email contact lists and
mailboxes on victims' machines? Typically these malware forge both
sender and recipient addresses, and if both happen to be mined from
(say) a mailbox containing an archive of the cryptography at metzdowd.com
mailing list then the recipient will likely recognise the sender's name.

@_date: 2006-03-17 16:19:09
@_author: Damien Miller 
@_subject: Zfone and ZRTP :: encryption for voip protocols 
Points to them for making it explicit.
This is incomplete. The paragraph goes on to say:
The SSH trust model has certainly proved itself as useful, and is
probably perfectly appropriate for semi-adhoc telephony where voice
nuance offers an additional means of detecting phonies (pun!).
The screenshot on that page seems to indicate only three [a-z0-9]
characters form the "key fingerprint". My first impression was that
this was insufficient, but it is probably a good tradeoff. It is
short enough that people will actually use it, and an attacker might
only get a couple of tries of getting it wrong (in a 2^15 bit space)
before a human would be very suspicious.

@_date: 2006-11-02 06:46:55
@_author: Damien Miller 
@_subject: Can you keep a secret? This encrypted drive can... 
Who's secrets will they be keeping? Disk encryption and Object-based
storage (where the filesystem is basically pushed down closer to the
storage device, cf [1]) could be used to provide building blocks for
stronger DRM.
[1]

@_date: 2006-09-19 13:18:37
@_author: Damien Miller 
@_subject: Exponent 3 damage spreads... 
Having a standard parametised hash function does not necessitate that
ASN.1 instances of their output have to be parametised too. IMO it would make more sense to pick a progression of sizes similar to

@_date: 2007-01-19 08:25:08
@_author: Damien Miller 
@_subject: It's a Presidential Mandate, Feds use it. How come you are not 
It is even easier to use a good cryptographic transform in a way that is
utterly insecure then it is to come up with a secure-looking-but-broken
transform. How does this company apply AES-128 to the task of encrypting
disk sectors? There are lots of ways to do it, many of them wrong.

@_date: 2007-10-13 09:32:44
@_author: Damien Miller 
@_subject: Password hashing 
Some comments:
* Use of an off-the-shelf algorithm like SHA1 might be nice for "tick here
  for FIPS certification", but they render the hashing scheme more
  vulnerable to dictionary attacks assisted by (near-)commodity hardware.
  Contrast with OpenBSD's blowfish scheme, which is deliberately designed
  to not be implementable using off-the-shelf crypto accelerator chips.
* Hideously obfuscated and overcomplicated. Comments like those on step 11
  of the algorithm (some mumbo jumbo about a completely deterministic step
  "adding randomness") and the absence of any rationale for the complexity
  seem to indicate that they believe a complicated design will somehow
  thwart attacks by itself.
* Why specify the number of rounds directly? Most password and KDF schemes
  use an exponential scheme to match Moore's law.

@_date: 2007-10-30 18:03:03
@_author: Damien Miller 
@_subject: password strengthening: salt vs. IVs 
Use a good existing password hash (e.g. OpenBSD's bcrypt[1]) or some
well reviewed KDF (e.g. PKCS  PBKDF2[2]).
Perhaps I'm not imaginative enough, but I can't think of a use case
that is not covered by these algorithms. Given decent salt they
will not succumb to reverse (rainbow table) lookup and both include
parametised computation complexity to drive up the cost of brute
force attacks.
[1] [2]

@_date: 2007-09-13 08:44:53
@_author: Damien Miller 
@_subject: Another Snake Oil Candidate 
It protects against the common threat model of lost/stolen USB keys. Why is
this snake oil? Your criticism seems akin to calling a physical lock insecure
because it doesn't protect you from burglars once you have unlocked it.

@_date: 2007-09-21 09:52:47
@_author: Damien Miller 
@_subject: Scare tactic? 
I "discovered" this minor weakness in most of the open source IPSec
implementations in May of last year (identical checks for degenerate
exponents are actually recommended in RFC2142 section 2.3.1.1). It didn't seem like this weakness could be used for much - an evil IKE
endpoint could use it to force disclosure of symmetrically encrypted
exchanges that were keyed from DH, but such an endpoint has a myriad of other ways they could disclose this same information. Protocols that
do not perform authentication after DH (e.g. Tor) get bit much harder
Anyway, I fixed OpenBSD's isakmpd[1], tighened the checks in OpenSSH[2]
and reported the problem to the security contacts of ipsec-tools/racoon
and openswan (two other open source IKE implementations).
Racoon and openswan never bothered bother to fix it despite me sending a
patch for racoon at least.  I recall a rather bizarre conversation with
an openswan developer who said he would only accept a patch if I wrote
him a testcase to go with it.
OTOH Racoon/ipsec-tools would benefit from the extra sanity checks
that Ben Laurie added to OpenSSL for the 0.9.8a release[3], assuming
it was compiled against that version or later.
[1] [2] [3]

@_date: 2008-12-12 12:42:57
@_author: Damien Miller 
@_subject: CPRNGs are still an issue. 
Until someone runs your software on a SSD instead of a HDD. Oops.

@_date: 2008-12-17 09:42:38
@_author: Damien Miller 
@_subject: CPRNGs are still an issue. 
I think you have it quite backwards - in the absence of good evidence
that transaction timings on SSDs are dependent on some physically
unpredictable process (air turbulence, shot noise, etc.) then they
should not be considered suitable for cryptographic use, no matter how
"random looking" they are.

@_date: 2008-09-11 22:41:38
@_author: Damien Miller 
@_subject: street prices for digital goods? 
At such cheap prices, it must be close to the point where it would
be worth it for the the card issuers to buy the numbers as a loss
mitigation measure.

@_date: 2009-11-22 17:48:14
@_author: Damien Miller 
@_subject: Why the onus should be on banks to improve online banking 
It is a lazy argument that the banks should be held responsible just
because it is easy to regulate them. Moreover, it seems like magical
thinking that they would then suddenly start demanding liability
warranties from their software vendors. For a start, it is probable that
the majority of the problems are in their clients' software and not the
banks', so demanding liability insurance would from banking software
vendors would have little effect. Furthermore, the cost of liability
warranties may well be less than the cost of fraud.
Also, exactly how is second paragraph of the BSD license evidence of
protection(ism) of the software industry? It seems like no-liability is
an equilibrium that the software market has settled to without assistance
from government - is there evidence to the contrary?
A much better argument for the banks being responsible for the security
of customers' money is that this is exactly what we pay them for.

@_date: 2009-09-13 19:47:27
@_author: Damien Miller 
@_subject: RNG using AES CTR as encryption algorithm 
The seems unlikely, since we don't use OpenSSL for AES-CTR in OpenSSH.
I don't think OpenSSL even supports a CTR mode through its EVP API.
Any mistakes in implementing CTR mode in OpenSSH are therefore our own.

@_date: 2009-09-14 17:56:15
@_author: Damien Miller 
@_subject: RNG using AES CTR as encryption algorithm 
Actually, I'm half-wrong (or half-right) - there was a bug in OpenSSL, just
not in AES-CTR specifically. It was a mildly obscure bug in the EVP interface
that showed up when plugging in one's own ciphers. We now have automated interop regression tests againt PuTTY to catch this
sort of thing...
