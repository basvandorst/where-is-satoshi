
@_date: 2002-12-10 18:32:44
@_author: Ralf-P. Weinmann 
@_subject: Research signals safer smart cards 
Excuse me, I actually had to look at the above date twice to ensure it *really*
read 09/12/2002. Where exactly does this announcement contain anything that can
be considered news?  DPA attacks have been known to the academic world since at
least 1998-1999 as far as I remember.
Must've been a slow news day for the Register, huh?

@_date: 2002-02-12 19:23:22
@_author: Ralf-P. Weinmann 
@_subject: FlexiProvider 1.1.1 released 
Release announcement: FlexiProvider version 1.1.1
FlexiProvider - Harnessing the power of the Java Cryptography Architecture
The FlexiProvider group is pleased to announce the availability of version
1.1.1 of our open source toolkit for the JCA/JCE. The FlexiProvider toolkit
was previously known as cdcProvider, however in late 2001, our research
group decided to change the name of the toolkit.
Several significant changes have occured since the last release of the
provider, which was the cdcProvider 1.9.1:
    * The Standard Provider has been renamed to Core Provider.
    * The message digest SHA-1 was optimized for better performance.
    * Since NTT no longer supports the adoption of the E2 cipher, we decided
      to drop it in the current release of the Core Provider.
    * The mode classes for the symmetric ciphers were rewritten. This resulted
      in a higher throughput for these ciphers.
    * Design changes werde made to the class BasicCipher, which mode classes
      and padding classes interoperate with.
    * The EC provider now supports both GF(p) and GF(2n) arithmetic.
    * Furthermore, support for ECElGamal was dropped for security reasons
      and is now superseded by the integrated encryption scheme ECIES.
    * Support for the Diffie-Hellmann key exchange protocol ECDH was added
      as well as the Nyberg-Rueppel style signature scheme ECNR.
    * The block cipher SAFER++ (a NESSIE candidate) has been implemented and
      is available in the Core Provider.
    * The Number Field Provider, wich formerly was being announced but then
      withheld from the public, has now been released in an alpha-beta version.     * Bugs impairing the functionality of the provider were found and fixed in
      the Asymmetric ECB, RSA PKCS  v1.5 and v2.1 cipher as well as in the
      RSA PKCS  v1.5 signature classes.
As numerous bugs have been fixed we recommend users of the cdcProvider upgrade
to the latest version of the FlexiProvider as soon as possible.
The FlexiProvider group

@_date: 2002-09-27 13:16:19
@_author: Ralf-P. Weinmann 
@_subject: RSA's RC5-64 Secret Key Challenge has been solved. 
Is A5/3 deployed yet? If not, a brute force attack is not needed, for A5/1 and
A5/2 more efficient tools exist to cryptanalyse it. Even in real-time, although
you might need to invest in some hard disk space before being able to eavesdrop
and intercept. See the following paper for more information:
"A. Biryukov, A. Shamir and D. Wagner, Real Time Cryptanalysis of A5/1 on a PC"
As for A5/3, I'm not really sure what key length network operators are/will be
using, 64-128 bits are allowed in the design requirements documentation. The
specification should be available on the 3GPP website. A5/3 is based on Kasumi.

@_date: 2003-10-10 10:30:39
@_author: Ralf-Philipp Weinmann 
@_subject: Easy VPNs? 
Well it's not a VPN per se, and it's dependent on the SSH client
you're using but it may help you anyway: When using an OpenSSH [1]
client one can enable dynamic portforwarding (the -D switch or the
DynamicForward option in ssh_config) which gives you a SOCKS server on
the machine you ssh from.
Under un*xy operating systems supporting LD_PRELOAD or similar dynamic
linker options you can then use something like tsocks [2] to make all
dynamically linked (and non-suid) applications performing only
outbound TCP connections use your SOCKS server.  This is sort of a
hack but works pretty good for me.
Something I've done as well in the past is run Slirp[3] on a remote
machine and have an SSH tunnel between Slirp and the PPP daemon on my
local machine. This assumes you have sufficient privileges on the
client machine however. It allows you to do both outbound TCP and UDP
however I do not really advise this strategy because of [4].
[1] OpenSSH
    [2] TSOCKS - A transparent SOCKS proxying library
    [3] Slirp
    [4] Why TCP over TCP Is a Bad Idea

@_date: 2003-09-02 23:56:57
@_author: Ralf-P. Weinmann 
@_subject: PRNG design document? 
Hi Tim,
I think you should have a look at AIS 20 and AIS 31 - they are a little
bit formal and define their own terminology but otherwise seem to give sound
Evaluation guidelines for both deterministic pseudo-random number generators
(AIS 20) and physical random number generators (AIS 31), have been published by
the BSI (Bundesamt fuer Sicherheit in der Informationstechnik - a German agency
responsible for giving recommendations regarding the security of IT in
government use).
AIS 31 (English): AIS 20 (English): There's also a paper published in the CHES 2002 proceedings on the same
W. Schindler, W. Killmann: Evaluation Criteria for True (Physical) Random
Number Generators Used in Cryptographic Applications
URL:

@_date: 2005-03-07 23:52:18
@_author: Ralf-Philipp Weinmann 
@_subject: News at 8: Attacks on MD5 getting better 
Seems like not only Ms. Wang and her team are able to practically produce MD5 collisions anymore. Vlastimil Klima recently described [1] his own research and experiments and allegedly is able to produce collisions on an off-the-shelf 1.6 GHz Pentium M at a rate of one every 8 hours.
This, he concludes, is a speed-up of about a factor 3-6 over the Chinese team [to the crowd that can't wait till Eurocrypt 2005: see [2]].
Furthermore, he seems to be optimistic to be able to bring it down to about 2 minutes per collision on the same machine. *knock on wood*
I wonder how long it'll take till somebody comes up with a way to "calculate MD5 collisions by hand" :)
An now on to your regularly scheduled program...
[1] V. Klima: Finding MD5 Collisions - a Toy For a Notebook
     [2] X. Wang and H. Yu: How to Break MD5 and Other Hash Functions

@_date: 2005-03-25 18:23:24
@_author: Ralf-Philipp Weinmann 
@_subject: Secure Science issues preview of their upcoming block cipher 
You're probably looking for [1] by Barkan and Biham. What they do is replacing the irreducible polynomial and all the constants involved in Rijndael to get what they call "dual ciphers"; basically those ciphers are isomorphic to Rijndael. All in all they get 240 dual ciphers which are listed in [2]. What I found more interesting back then was that they also give square dual and log dual ciphers of Rijndael. I.e. let E be the Rijndael encryption and E' be the encryption function of the square/log dual Rijndael construction. Furthermore let f be a function that either performs bytewise squaring in GF(2^8) or replaces each byte with a logarithmic representation (relative to a generator g. you also need to fix log_g(0) = -\infty for this to make sense). Then
  E'(f(plaintext), f(key)) = f(E(plaintext, key))
holds. The squaring construction then also naturally extends to what they call "higher-order self dual ciphers": meaning you can apply the squaring multiple times.
In 2004 Wu, Lu and Laih then demonstrated that using Barkan's and Biham's method can indeed lead to more efficient implementations of AES/Rijndael in hardware.
[1] Elad Barkan and Eli Biham:
     In How Many Ways Can You Write Rijndael?
     ASIACRYPT 2002, Springer
     note: also on ePrint as      if you don't have Springer Link access
[2] Elad Barkan and Eli Biham:
     The Book of Rijndaels
     [3] Shee-Yau Wu and Shih-Chuan Lu and Chi Sung Laih:
     Design of AES Based on Dual Cipher and Composite Field
     Topics in Cryptology, CT-RSA 2004, Springer

@_date: 2005-03-25 21:00:28
@_author: Ralf-Philipp Weinmann 
@_subject: Secure Science issues preview of their upcoming block cipher 
You're probably looking for [1] by Barkan and Biham. What they do is replacing the irreducible polynomial and all the constants involved in Rijndael to get what they call "dual ciphers"; basically those ciphers are isomorphic to Rijndael. All in all they get 240 dual ciphers which are listed in [2]. What I found more interesting back then was that they also give square dual and log dual ciphers of Rijndael. I.e. let E be the Rijndael encryption and E' be the encryption function of the square/log dual Rijndael construction. Furthermore let f be a function that either performs bytewise squaring in GF(2^8) or replaces each byte with a logarithmic representation (relative to a generator g. you also need to fix log_g(0) = -\infty for this to make sense). Then
  E'(f(plaintext), f(key)) = f(E(plaintext, key))
holds. The squaring construction then also naturally extends to what they call "higher-order self dual ciphers": meaning you can apply the squaring multiple times.
In 2004 Wu, Lu and Laih then demonstrated that using Barkan's and Biham's method can indeed lead to more efficient implementations of AES/Rijndael in hardware.
[1] Elad Barkan and Eli Biham:
     In How Many Ways Can You Write Rijndael?
     ASIACRYPT 2002, Springer
     note: also on ePrint as      if you don't have Springer Link access
[2] Elad Barkan and Eli Biham:
     The Book of Rijndaels
     [3] Shee-Yau Wu and Shih-Chuan Lu and Chi Sung Laih:
     Design of AES Based on Dual Cipher and Composite Field
     Topics in Cryptology, CT-RSA 2004, Springer

@_date: 2006-07-31 14:14:18
@_author: Ralf-Philipp Weinmann 
@_subject: CLC 2006 - Workshop on Codes and Lattices in Cryptography 
============================== START ==============================
Apologies in advance if you receive multiple copies of this announcement.
CLC2006 - Workshop on Codes and Lattices in Cryptography
September 25th-27th, 2006
Technische Universitaet Darmstadt
Johannes Buchmann - Alexander May - Ulrich Vollmer
Confirmed Speakers:
Miklos Ajtai (IBM, USA)
Thierry Berger (Universite de Limoges, France)
Johannes Bl?mer (Universitaet Paderborn, Germany)
Nicolas T. Courtois (Axalto, France)
Matthieu Finiasz (EPFL, France)
Philipe Gaborit (Universite de Limoges, France)
Venkatesan Guruswami (University of Washington, USA)
Hideki Imai (University of Tokyo, Japan)
Kazukuni Kobara (University of Tokyo, Japan)
Pierre Loidreau (ENSTA, France)
Alexander May (TU Darmstadt, Germany)
Daniele Micciancio (University of California, San Diego)
Oded Regev (Tel-Aviv University, Israel)
Claus-Peter Schnorr (Universitaet Frankfurt, Germany)
Nicolas Sendrier (INRIA, France)
Code-based systems belong to the most promising candidates for
post-quantum cryptography. They are highly efficient. By easing the
constraints on storage capacity for key material, technological
progress has paved the way for their practical deployment. Yet, do we
feel certain enough of their security to recommend wide-spread
While the last 25 years since the first proposal of such a system by
R.J. McEliece have seen a steady stream of research into their
security, this effort pales in comparison to the scrutiny devoted to
currently deployed systems like RSA and ECC.
Efficient lattice reduction algorithms have been very potent tools of
cryptanalysis of many public-key cryptosystems. Applied to code-based
systems this tool has turned out to be a very blunt one since the lift
of cryptographically useful error-correcting codes yields lattices of
intractably high dimensions with an abundance of short vectors.
Yet, the question still remains open whether there is more than the
surface parallelism between, say, the decoding problem and the closest
vector problem in a lattice, whether cross-fertilization between the
research into the security of code- and lattice-based cryptosystems is
This small workshop undertakes an exploration of this question and
hopes to stimulate the dialogue between researchers of both
communities. The topics are
* Attacks on code- or lattice-based systems
* Hardness of underlying problems, weak instances
* The link between Decoding, Learning and Closest Vector Problems
* Average versus Worst Case Complexity
* Indistinguishability of hidden-trap door and random instances
* Security proofs of code-based systems
* Lattice reduction for cryptanalysis
* Lattice reduction algorithms, including their sensitivity to   properties of the instances they are applied to
Contributions to the workshop are solicited by invitation only. Travel
and lodging costs for the invited speakers are covered by the workshop
In order to encourage the presentation of work-in-progress and
contributions of survey character, all research presented may be
published elsewhere. However, we kindly request that participants
submit a three-page summary of their contribution for inclusion in the
pre-proceedings. There will be opportunity for revision and
enlargement in view of the results of the workshop. Post-proceedings
will be made available to the cryptographic community from the
document server of the hosting department.
The organizers gratefully acknowledge the generous support of the
Federal Office for Information Security (BSI).

@_date: 2006-09-19 00:02:54
@_author: Ralf-Philipp Weinmann 
@_subject: [cryptography] Re: Why the exponent 3 error happened: 
Hi Eric,
the attack indeed is not infeasible. Although if you do not want to  violate the padding specifications (minimum of eight 0xFF bytes), you  need moduli longer than 1024 bits. My colleague Andrei Pyshkin had  the following idea:
In the following, we will assume to public exponent e=3. Let s be the  signature of a message m. The message can be broken down into 3 parts:
m := f_1 || v || f_2
with f_1, f_2 being fixed and v variable. Note that f_2 denotes the  lowermost bits of the message. Furthermore let d=bitlength(f_2).
In order to calculate a signature s such that m is a perfect cube, we  carry out the following steps:
1. Calculate an x such that f_2 = x^3 mod 2^d with x < 2^d. This will
succeed with probability > 1/2.
2. Calculate s_0 = floor(cuberoot(m))
3. Calculate the signature s = s_0 + x - (s_0 mod 2^d)
Calculating the bounds for which moduli and fixed data structures  this attack will succeed is left as an excercise to the inclined reader.
Unfortunately we only found out that there has been prior art by  Yutaka Oiwa et al. *AFTER* we successfully forged a certificate using  this method (we being Andrei Pyshkin, Erik Tews and myself).
The certificate we forged however adheres to the padding  specifications unlike the one by Yutaka Oiwa that Simon Josefsson  forwarded to the list a couple of days ago:
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
Broken implementations can successfully verify it using the Starfield  Class 2 Certification Authority:

@_date: 2006-09-20 15:29:37
@_author: Ralf-Philipp Weinmann 
@_subject: [cryptography] Re: Why the exponent 3 error happened: 
Hi Ulrich,
You're using a version that has already been fixed. However the main  problem seems to be that you're trying to parse a certificate in PEM  format using the option -inform DER instead of -inform PEM ;)
At least that's how I can reproduce your error...

@_date: 2006-09-27 09:39:23
@_author: Ralf-Philipp Weinmann 
@_subject: Exponent 3 damage spreads... 
Hi Simon,
I'm not a NSS developer, but we did have a look at the code here to  figure out what EXACTLY those guys patched. The relevant portion can  quite easily be found by diff'ing the tags FIREFOX_1_5_0_6_RELEASE  vs. FIREFOX_1_5_0_7_RELEASE on their CVS tree for example. Insofar I  don't think that leaving the bug reports private after actually  shoving out the release does not really help things in this  situation; quite the opposite.
Relevant files to this problem that were patched turned out to be  security/nss/lib/cryptohi/secvfy.c and nss/lib/util/secdig.c. Have a  look at the function DecryptSigBlock() in secdig.c, lines 92-95
 >    /* make sure the "parameters" are not too bogus. */
 >    if (di->digestAlgorithm.parameters.len > 2) {
 >        goto sigloser;
 >    }
Quite amused, we also noted the following:
<     /* XXX Check that tag is an appropriate algorithm? */
 >     /* Check that tag is an appropriate algorithm */
 >     if (tag == SEC_OID_UNKNOWN) {
 >        goto sigloser;
 >     }
This means, that before the patch was applied, NSS indeed was  vulnerable to Kaliski's OID attack.
See above.

@_date: 2007-04-05 17:31:46
@_author: Ralf-Philipp Weinmann 
@_subject: WEP cracked even worse 
Hi Dave,
this of course is a question of how you value an attack: a key  recovery usually is worth more than a decryption oracle.
To send arbitrary packets with the fragmentation attacks described in  [1, Section 2.6], you need just a single (suitable) data packet.  However, in order to decrypt packets, you need either 2 (connectivity  to other networks that you have a host on that you can control, e.g  the internet) or approx. 2^7 packets (no access to outside hosts)  _per byte_ that you want to decrypt. Our method surely pays of if you  want to decrypt more than a handful of packets.
[1] Andrea Bittau, Mark Handley, Joshua Lackey
     The Final Nail in WEP?s Coffin
     IEEE Symposium on Security and Privacy 2006,

@_date: 2007-12-05 12:43:21
@_author: Ralf-Philipp Weinmann 
@_subject: Flaws in OpenSSL FIPS Object Module 
Hi Paul,
this may have been true in the past. Enter tools like BinDiff [1] and  BinNavi [2] and a skilled reverse engineer is able to shoot down  you're closed-source implementation almost as quickly as one for which  she has source (assuming she has binaries, of course).
[1] Zynamics BinNavi
     [2] Zynamics BinDiff

@_date: 2007-12-30 11:29:32
@_author: Ralf-Philipp Weinmann 
@_subject: Philips/NXP/Mifare CRYPTO1 mostly reverse-engineered 
From "MiFare?s CRYPTO1 stream cipher has captured my attention for a while.  However, hardware reverse-engineering is not a field I actively engage  in. So I was very happy when Karsten Nohl (University of Virginia),  Starbug and Henryk Pl?tz gave a talk at the 24C3 [the 24th Congress of  the Chaos Computer Club taking place in Berlin at this very moment]  yesterday evening showing that they have reverse-engineered most parts  of this cipher. CRYPTO1 uses a 48-bit LFSR-based filter generator to  generate key stream.
The filter function - if I understood correctly - uses 20 taps (this  was not mentioned in the talk, I asked Karsten privately about this)  however the degree of the boolean function implementing the filter,  thus it remains to be seen whether algebraic attacks can be applied.  Even if no algebraic attacks are applied, a BSW sampling TMTO will  break CRYPTO1 completely. This was pretty obvious before they gave  their talk, but now vendors actually have to worry about this being  out in the wild once the feedback and the filter function have been  My colleague Erik took photos of the slides which I put up on Zooomr  [0]. A video recording of the talk should be available shortly and  will be linked here."
[0]

@_date: 2007-02-27 15:50:51
@_author: Ralf-Philipp Weinmann 
@_subject: padlocks with backdoors - TSA approved 
Yes. It is old news, Bruce Schneier's Cryptogram mentioned it in  April 2004, actually [1].
Welcome to the "real world". Things suck here.
Some of apparently have the feature that you can tell *IF* the TSA  has opened them with their master-keys. You are supposed to find a  TSA notice in your bag if it has been opened and searched. Although  I'm not sure whether you can really raise hell if they forget to  stick the notice in there after having searched your bag.
G'night then.
[1] Crypto-Gram Newsletter, April 15th, 2004
