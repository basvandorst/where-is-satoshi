
@_date: 2006-12-27 14:45:41
@_author: lists 
@_subject: How important is FIPS 140-2 Level 1 cert? 
These statements are not entirely correct for FIPS 140-2 under current interpretations (to my understanding, at least).
For example,
ANSI X9.31 is not the only FIPS-approved PRNG. There are a few of them [1], although most of them are closely related.
You can reseed a FIPS-approved PRNG all you want, which means you could even effectively reduce a FIPS-approved PRNG to a whitener if you
desired. (There are some caveats here.) IIRC, yarrow takes this sort of approach. Also, as noted elsewhere, some of the PRNGs have explicit
mechanisms for you to feed in more entropy.
For an X9.31 PRNG, (re)seeding can include (re)keying the 2-key TDES and often does as implementers try to cram as much gathered entropy
into the PRNG as possible.
Also, lab interpretations of requirements can vary a bit in some of the more ambiguous areas, especially on the things like the stretches
made for validating software, or with novel implementations; however, overall, they are quite similar. I think the bigger lab variations
revolve around things like the staff on hand , which can effect, for example, how quickly a lab can understand a product, how effectively a
lab can interpret that understanding against the requirements, and how much bandwidth the lab has to just get the job done.
As to the original direction of this thread, I agree with these value adds. Point two is the main reason anyone pursues FIPS 140-2 at this
point, although this might change with the internationalization efforts. As to point one, it is worth noting that many vendors have not had
anyone review their crypto up until going through a FIPS 140-2 validation. And, FIPS 140-2 looks at the overall picture more than just
particular protocols, by including requirements in areas like the whole of key management, and authentication and authorization (noting this
applies at level 2). So, even at level 1, this can mean a fair amount of "real" problems being discovered and resolved as a result of the
process. (Of course, if you require stronger levels of third party review of a product, then higher levels of FIPS 140-2 validation or
perhaps other programs like NSA certifications are more what you should be looking at.) And, to add a third value, FIPS 140-2 validation can
function much like having letters like CISSP following one's name.
With regards to protocol interop, as part of the FIPS 140-2 process currently, algorithm testing is involved. Perhaps protocol testing
requirements should be included in the next revision of the standard being worked on at the moment [2]. I do agree this would help to
strengthen the FIPS 140 process.
(Reading this overall thread, it seems FIPS 140 is still considered some sort of voodoo. The FIPS 140-2 requirements are public [3], and
even the ambiguous areas have standard interpretations at this point.)
[1] [2] [3]

@_date: 2006-12-30 14:31:33
@_author: lists 
@_subject: How important is FIPS 140-2 Level 1 cert? 
============================== START ==============================
I have never heard of the seed being required to use a clock value,
and, under FIPS 140-2, using only a clock value to seed a PRNG is not
going to pass the key management requirements.
Now we are talking about something different, the date/time (DT)
vector of the X9.31 PRNG, which is not the seed of the X9.31 PRNG.
I don't think anything changed with the introduction of a power-up
PRNG KAT or PRNG algorithm testing. Even the NIST-defined PRNGs, which
are based upon the X9.31 PRNG, are open in regard to what an
implementer chooses to use as the DT vector.
Take the power-up PRNG KAT. By definition, this requires the use of
known values, which means, for an X9.31 PRNG, even the DT vector needs
to be set to a known value. Adding in entropy violates this
requirement, but, after the KAT is performed (and passed), the PRNG is
required to be seeded with "real" data before assuming its normal
operational state.
Take algorithm testing. This testing too requires the use of known
values, in this case provided by a testing lab, which are run through
an implementation to produce results that can then be verified by a
testing lab. For an X9.31 PRNG, this testing requires access to a
parameter (DT) of the X9.31 PRNG that may not normally be accessible
outside of the PRNG. It is just fine to have a test mode to provide
this access, and then the counter woes can be made to go away as part
of this test mode. (Note: Algorithm testing is once off testing
performed by the vendor and not normally deployed in a product.)
It seems to me that an implementation of an X9.31 PRNG without a test
mode makes no sense, for the reasons cited above. This mode would be
used in a self-testing state, or during algorithm testing, but not in
normal operational state.
As an example of a module with public source code, OpenSSL made it
through FIPS validation doing this. Their X9.31 PRNG normally uses
clock data for DT, but, in test mode, DT can be set from the outside
instead. This test mode is utilized for the power-up KAT as well as
algorithm testing. I can imagine this is not a unique occurrence.

@_date: 2007-07-10 12:37:37
@_author: lists 
@_subject: FIPS 140-2, PRNGs, and entropy sources 
For whatever reason, I get asked FIPS 140 questions and this one about
FIPS 140-2 comes up on occasion. It is good someone finally asked in
public and received a public reply. A bit convoluted, and this says
nothing about seeding requirements for a PRNG not used for key
generation/agreement, but it is the logic of FIPS 140-2 with regards to
PRNG seeding.
 From what I have seen, the labs understand what will pass muster with
NIST/CSE for FIPS 140-2 based on their experience with the many FIPS
140-2 validation efforts performed to this point, so they are a good
gauge of what NIST/CSE will smile upon here, even though there has been
little formal guidance. Most labs are fine with standard techniques for
gathering entropy from a system, such as polling various timings for
things like disk access, plus whitening, such as running the results of
the polling through a FIPS-approved hashing algorithm. Hardware RNGs,
such as a noise source, which can be used either as just another source
in the polling, or as the only source. When using a hardware RNG, most
vendors focus on this as the primary source of entropy, and labs will
often require many details about the hardware RNG as a result.
As far as what to provide, well, you need to describe how the PRNG is
seeded, give code pointers to the seeding and any entropy gathering
routines, include details on any hardware RNGs, and construct a general
rationale for why all this adds up to meeting the requirements. The labs
can take it from there and ask for more information as needed, such as
sample output from the entropy gathering routines to examine. If you are
concerned about not meeting the requirements, chatting with a lab or
consultant about what is required is not out of the question - it might
even provide some metric as to how friendly and responsive the team you
are considering working with for your validation will be.
FWIW, up to this point in time, I have rarely seen formal calculations
of entropy by vendors in the rationale for meeting these requirements
(those few times were mostly with vendors that built their own hardware
RNGs), and I have seen statistical tests used by vendors a little bit as
a part of the rationale behind meeting these requirements.

@_date: 2007-10-08 18:18:26
@_author: lists 
@_subject: Full Disk Encryption solutions selected for US Government use 
Yes, but an FDE product built on the OSSL FIPS module would not likely
meet the FIPS 140-2 check box, as there is potentially more FIPS 140-2
relevant functionality in the FDE product beyond what was validated in
the OSSL module, such as, say, the whole key life cycle for the FDE
product. That does not necessarily mean all of the FDE product is FIPS
relevant, so perhaps the FIPS relevant functionality in the FDE product
could be self-contained and validated by itself, or perhaps the whole
FDE product could be validated and the irrelevant functionality just
excluded from the FIPS requirements, etc. (As Gutmann says though,
vendors sometimes successfully employ a bit of hand-waving here, so you
never quite know what will satisfy the FIPS check box.)
Yes, the details are important. The OSSL FIPS module was tested on those
platforms, but is vendor affirmed on other platforms, assuming the
module meets the vendor affirmation requirements described in the FIPS
140-2 implementation guidance on a given "other" platform.

@_date: 2007-10-13 20:44:34
@_author: lists 
@_subject: Password hashing 
This does not extend the discussion at hand, but it might be useful to
some here who may have to deal with FIPS 140-2.
Although there are password hashing mechanisms built from FIPS-approved
algorithms (e.g., SHA-1 HMAC), there are no FIPS-approved password
hashing mechanisms specifically defined. Meaning, I think there is some
room to move here.
Now, assuming passwords are a critical security parameter (CSP) for a
module, password hashing built from non-FIPS-approved algorithms
automatically means the generated password hashes are considered to be
CSPs in the clear for FIPS 140-2 purposes (i.e., the password hashes are
just considered to an obfuscated form of the plaintext password), and so
we have to deal with the requirements revolving around plaintext CSPs
for those password hashes. Inside of the cryptographic boundary of a
module, CSPs can be maintained in plaintext, as they are considered
protected by the security mechanisms of the module, which gives us a
foothold for using such password hashing mechanisms.
However, while the passwords are considered in the clear, the fact they
are undergoing password hashing is not ignored - the authentication
mechanism must still meet the applicable authentication requirements of
FIPS 140-2, so the password hashing must not cause the password-based
authentication to fail to meet those FIPS 140-2 requirements. And, I
think password hashing mechanisms built from non-FIPS-approved
algorithms can still be used to help meet some FIPS 140-2 authentication
requirements - e.g, I can envision bcrypt being configured such that,
given a particular module's hardware, it slows does authentication
attempts sufficiently to satisfy some strength of authentication

@_date: 2007-09-13 22:31:20
@_author: lists 
@_subject: Another Snake Oil Candidate 
AES can be permitted for use in classified environments. See
 And, yes, the DoD
does use AES in certain circumstances.
While I don't understand this quibble about standard terminology, I do
note that the IronKey language is somewhat misleading. There are no
FIPS-approved non-deterministic RNGs at this point, as all of the
FIPS-approved RNGs are deterministic (pseudo) RNGs. (See
 It
is possible to use a non-deterministic RNG to seed a FIPS-approved PRNG,
but I don't know of anyone in the FIPS 140-2 world that claims doing so
makes the non-deterministic RNG "FIPS 140-2 compliant." (Also, if random data is utilized during key generation within a FIPS
140-2 module, then a FIPS-approved RNG must be utilized to generate that
data in order to meet FIPS 140-2 requirements. Since all the
FIPS-approved RNGs are PRNGs, a true RNG is not going to meet the FIPS
140-2 requirement here.)
Overall, colorful language and FIPS 140 hand-waving seem like the
marketing norm in the "security products that utilize crypto" world. I
think the language used by IronKey falls right in line with that, but I
don't get a sense of snake oil. Then again, I don't really care either.
