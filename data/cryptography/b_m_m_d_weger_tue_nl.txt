
@_date: 2004-09-16 09:43:51
@_author: Weger, B.M.M. de 
@_subject: public-key: the wrong model for email? 
Hi Ed,
What about ID-based crypto: the public key can be any string, such as
your e-mail address. So the sender can encrypt even before the
recipient has a key pair. The private key is derived from the
public key by a trusted party when the recipient asks for it.
Yes, the recipient does have some burden here, but it seems to
me that that is unavoidable.
I'm not saying that this is without problems (private key distribution,
inherent key escrow / recovery, revocation issues), or that it's easier manageable than traditional PKI, but it may solve some of your issues.
The idea for ID-based crypto comes from Adi Shamir, back in 1984.
The first practical and mathematically sound realisation is due to
Boneh and Franklin (Crypto 2001), and is brought to the market
by Voltage ( I don't know their products, only that
it exists, and I'm not a shareholder. I do think it's interesting
math and interesting crypto, and that it could lead to interesting Benne de Weger
========================================= Technische Universiteit Eindhoven Coding & Crypto Groep Faculteit Wiskunde en Informatica Den Dolech 2 Postbus 513 5600 MB Eindhoven kamer HG 9.84 tel. (040) 247 2704, bgg 5141 e-mail: b.m.m.d.weger at tue.nl www:  =========================================

@_date: 2005-06-13 21:53:04
@_author: Weger, B.M.M. de 
@_subject: Collisions for hash functions: how to exlain them to your boss 
Hi Eric,
Technically speaking you're correct, they're signing a program.
But most people, certainly non-techies like Alice's boss,
view postscript (or MS Word, or ) files not as programs but as static data. In being targeted at non-techies I find this attack more convincing than those of Mikle and Kaminsky, though essentially
it's a very similar idea.
Note that opening the postscript files in an ASCII-editor
(or HEX-editor) immediately reveals the attack. Stefan Lucks
told me they might be able to obfuscate the postscript code, but again this will only fool the superficial auditor.
========================================= Technische Universiteit Eindhoven Coding & Crypto Groep Faculteit Wiskunde en Informatica Den Dolech 2 Postbus 513 5600 MB Eindhoven kamer HG 9.84 tel. (040) 247 2704, bgg 5141 e-mail: b.m.m.d.weger at tue.nl www:  =========================================

@_date: 2005-03-01 20:21:37
@_author: Weger, B.M.M. de 
@_subject: Colliding X.509 Certificates 
Hi all,
We announce the construction of two different valid X.509 certificates
that have identical signatures. This is based on MD5 collisions.
One could e.g. construct the to-be-signed parts of the certificates,
and get the one certificate signed by a CA. Then a valid signature for the other certificate is obtained, while the CA has not seen proof of possession of the private key of this second certificate. The certificates we constructed can be downloaded from
We provide a short paper explaining in detail our method.
It is available on the website, and on the Cryptology ePrint Archive,
at This is joint work with Arjen Lenstra (Lucent Bell Labs and TU
and Xiaoyun Wang (Shandong University).
Benne de Weger
========================================= Technische Universiteit Eindhoven Coding & Crypto Groep Faculteit Wiskunde en Informatica Den Dolech 2 Postbus 513 5600 MB Eindhoven e-mail: b at m at d at nl www:  =========================================

@_date: 2005-03-11 12:11:35
@_author: Weger, B.M.M. de 
@_subject: Colliding X.509 Certificates 
Hi Joerg,
It's true that our 'attack' assumes that the attacker has sufficient
control over the CA, in particular over setting DN's, serial numbers and the validity period. Yet I have a few remarks on this.
A relying party cannot find out from the certificate alone whether
it has a "twin sister" or not. The fact that there is a random-looking
serial number doesn't help you there.
A newly issued certificate based on MD5 should not be trusted anymore anyway. The only reasonable measure against collision-based attacks is to declare MD5 dead. It's better to bury it than to try keeping it alive.
I have nothing against randomized serial numbers. But your security should be based on better ideas. And it's just as easy to avoid broken hash functions.
Benne de Weger

@_date: 2005-03-14 10:48:47
@_author: Weger, B.M.M. de 
@_subject: Colliding X.509 Certificates 
Hi Joerg,
It makes sense to do a risk analysis, based on a.o.
* how critical is the particular application to the business
* what threats are there (who might try something bad)
* what's the user community (in-house or the entire world or
  something in between)
and then accept a certain residual risk of continuing the use of
'broken' hash functions for some more time. At the same time it is wise to start deploying better hash functions. I hope the Microsofts and Suns and  of this world are working on this right now. It's clear that this is going to take a long time and cost a lot of money. We're very lucky that the present attacks are still to a large extent theoretical in nature, and do not (yet) lead to realistic attack scenarios (at least we couldn't think of one, and we haven't seen anybody else coming up with one).
The main lesson to be learnt here is that we have made our systems too dependent on a few cryptographic primitives only; much more
flexibility is needed. One of these days some smart person may come up with a real attack on ,
then you cannot afford two years to change your systems.
So I still think that the message we should send into the world is
to phase out MD5 now, and SHA-1 a.s.a.p. (NIST says: by 2010, that sounds very long to me). If you cannot do that for practical reasons, then that's your risk. When you accept that risk, that's fine with me.
Apart from that I've never understood why there are CA certificates with such incredibly long lifetimes. That's simply asking for trouble.
With current knowledge the answer is: yes. Randomized serial numbers will be sufficient. And indeed: a CA doesn't need hash collisions
to do real damage. ========================================= Technische Universiteit Eindhoven Coding & Crypto Groep Faculteit Wiskunde en Informatica Den Dolech 2 Postbus 513 5600 MB Eindhoven kamer HG 9.84 www:  =========================================

@_date: 2005-04-01 00:08:07
@_author: Weger, B.M.M. de 
@_subject: new result: "anti-colliding" x.509 certificate 
============================== START ==============================
Hi all,
Today I announce the construction of a valid X.509 certificate,
based on the MD5 hash function, that allows two different digital
signatures on the (identical) "to-be-signed" part. This is based
on a new technique of constructing MD5-anti-collisions. For details, see  This type of certificate is called "anti-colliding", as this is complementary to a construction, announced one month ago, of "colliding x.509 certificates", i.e. two different X.509
certificates with identical signatures, based on MD5-collisions.
See Benne de Weger

@_date: 2005-05-21 15:23:24
@_author: Weger, B.M.M. de 
@_subject: Anti-colliding certificates 
Hi All,
It's nice to see that my message on anti-colliding certificates finally
got through.
To fully appreciate its contents you should set back your internal clock
to the date the message was originally sent.
Benne de Weger

@_date: 2005-10-21 18:11:02
@_author: Weger, B.M.M. de 
@_subject: Smooth prime MD5 collisions 
Hi Ben,
Looks like this is essentially the same as, or at least very similar to,
what Arjen Lenstra and I did in Section 4 of the full version of our
"On the possibility of constructing meaningful hash collisions for
public keys",
see The proceedings version of this paper (presented at ACISP 2005,
in Springel LNCS 3574) skipped that section due to space limitations.
Benne de Weger
Technische Universiteit Eindhoven
Coding & Crypto Groep
Faculteit Wiskunde en Informatica
Den Dolech 2
Postbus 513
5600 MB Eindhoven
kamer:  HG 9.84
tel.:   (040) 247 2704, bgg 5141
e-mail: b.m.m.d.weger at tue.nl
www:

@_date: 2006-04-01 15:52:16
@_author: Weger, B.M.M. de 
@_subject: SHA1 coll 
Hi All,
The following two byte-strings (differing in a few bits only):
59 6F 75 20 61 72 65 20 41 70 72 69 6C 20 46 6F 6F 6C 20 6E 6F 2E 20 30
30 36 39 30 30 32 35 31 33 31 00
59 6F 75 20 61 72 65 20 41 70 72 69 6C 20 46 6F 6F 6C 20 6E 6F 2E 20 31
37 38 36 37 33 32 39 32 31 39 00
both have SHA-1 For more explanation, visit
Benne de Weger

@_date: 2006-02-11 14:20:15
@_author: Weger, B.M.M. de 
@_subject: Nonrepudiation - in some sense 
Hi all,
Moreover, it seems to me that:
1. it is misleading (at least in general) to state that SSL operates    "between client and application". SSL operates between client
(browser)    and (web) server; in many cases the real application might be on    another server, way behind the point where the SSL connection
   Are there any SSL-aware "applications" (i.e. implementing business
   rather than providing communication services) for which this solution
   may be useful?
2. it is misleading to state that SSL secures "transactions". SSL
   "sessions". The authentication of SSL applies only to the session
   not to the exchanged data, in which "transaction" data might be
present.    This is why (as Ben remarks) SSL does not provide non-repudiation.
3. with this solution you need your private key in at least two
different    places. This introduces essentially more complicated key management,
   and increases the risk of key compromise.
Benne de Weger
Technische Universiteit Eindhoven
Coding & Crypto Groep
Faculteit Wiskunde en Informatica
Den Dolech 2
Postbus 513
5600 MB Eindhoven
kamer:  HG 9.84
tel.:   (040) 247 2704, bgg 5141
e-mail: b.m.m.d.weger at tue.nl
www:

@_date: 2006-03-17 18:03:32
@_author: Weger, B.M.M. de 
@_subject: MD5 collisions in one minute 
Hi all,
You might be interested in knowing that my MSc student
Marc Stevens has found a considerable speedup of MD5 collision generation. His improvements of Wang's method
enables one to make MD5 collisions typically in one
minute on a PC; sometimes it takes a few minutes, and sometimes only a few seconds.
His paper (shortly to appear on the Cryptology ePrint
Archive) can be found on where we've also made his software available (source code
and a Win32 executable).
Benne de Weger

@_date: 2006-10-23 23:58:21
@_author: Weger, B.M.M. de 
@_subject: target collisions and colliding certificates with different identities 
Hi all,
We announce:
- an example of a target collision for MD5; this means:   for two chosen messages m1 and m2 we have constructed   appendages b1 and b2 to make the messages collide   under MD5, i.e. MD5(m1||b1) = MD5(m2||b2);
  said differently: we can cause an MD5 collision for   any pair of distinct IHVs;
- an example of a pair of valid, unsuspicious X.509   certificates with distinct Distinguished Name fields,   but identical CA signatures; this example makes use   of the target collision.
See where the certificates and a more detailed announcement can be found.
Marc Stevens
Arjen Lenstra
Benne de Weger

@_date: 2006-10-26 21:20:59
@_author: Weger, B.M.M. de 
@_subject: [Cfrg] Applications of target collisions: Pre or post-dating MD5-based RFC 3161 time-stamp tokens 
Hi Steven,
As far as we know, not one bit closer. Best known attack on MD5 preimage resistance still is brute force. You may interpret our result as enlarging the applicability of collision attacks. In that sense the gap to preimage attacks has diminished. But we have no measure available to tell by how much.
Benne de Weger

@_date: 2007-12-02 09:16:33
@_author: Weger, B.M.M. de 
@_subject: PlayStation 3 predicts next US president 
Hi William,
That's an "if" indeed, we say so on the website. How big it is, you
all form your own opinion.
This I read as a definition of 'reputable'. I disagree. We could just as easy have put the collision blocks
in visible images. We could just as easy have used MS Word
documents, or any document format in which there is some way
of putting a few random blocks somewhere nicely. We say so on
the website. We did show this hiding of collisions for other data
formats, such as X.509 certificates and for Win32 executables.
Our real work is chosen-prefix collisions combined with
multi-collisions. This is crypto, it has not been done before,
this is as far as we can get in MD5 cryptanalysis, and we think it's relevant. To sell it to the world we wrapped it up nicely.
You just throw away the wrapper. Benne de Weger

@_date: 2007-12-02 18:10:37
@_author: Weger, B.M.M. de 
@_subject: PlayStation 3 predicts next US president 
Hi William,
See I was referring to MD5. Apart from that, I'd be interested in
seeing references to older work on chosen-prefix multicollisions.
Our first chosen-prefix collision attack has complexity of about
2^50, as described in our EuroCrypt 2007 paper. This has been considerably improved since then. In the full paper that is in
preparation we'll give details of those improvements.

@_date: 2007-11-30 05:29:35
@_author: Weger, B.M.M. de 
@_subject: PlayStation 3 predicts next US president 
Hi all,
We (Marc Stevens, Arjen Lenstra and me) have used a Sony PlayStation 3 to correctly predict the outcome of the 2008 US presidential elections.
See  if you want to know
the details of what this has to do with cryptography.
We also announce two different Win32 executables that have identical MD5 hash values. This can be made to happen for any two executable
This implies a vulnerability in software integrity protection and code signing schemes that still use MD5.
See  for details.
Benne de Weger

@_date: 2008-12-30 16:40:44
@_author: Weger, B.M.M. de 
@_subject: Short announcement: MD5 considered harmful today - Creating a rogue 
Hi all,
Today, 30 December 2008, at the 25th Annual Chaos Communication Congress in Berlin,
we announced that we are currently in possession of a rogue Certification
Authority certificate. This certificate will be accepted as valid and trusted by all common browsers, because it appears to be signed by one of the commercial root CAs that browsers trust by default. We were able to do so by constructing a collision for the MD5 hash function, obtaining a valid CA signature in a website certificate legitimately purchased from the commercial CA, and copying this signature into a CA certificate constructed by us such that the signature remains valid. For more information about this project, see The team consists of: Alexander Sotirov (independent security researcher, New York, USA), Marc Stevens (CWI, Amsterdam, NL), Jacob Appelbaum (Noisebridge, The Tor Project, San Francisco, USA), Arjen Lenstra (EPFL, Lausanne, CH), David Molnar(UCB, Berkeley, USA), Dag Arne Osvik (EPFL, Lausanne, CH), Benne de Weger (TU/e, Eindhoven, NL).
For press and general inquiries, please email md5-collisions at phreedom.org.

@_date: 2008-09-16 21:01:51
@_author: Weger, B.M.M. de 
@_subject: RSA modulus record 
There's a new biggest known RSA modulus.
It is (in hexadecimal notation):
FF...(total of 9289166 F's)...FFDFF...(total of 1488985
F's)...FF800...(total of 9289165 0's)...001
It is guaranteed to be the product of two different large primes, and it has more than 80 million bits. Impressive security...
Benne de Weger

@_date: 2009-02-12 22:01:15
@_author: Weger, B.M.M. de 
@_subject: Property RIghts in Keys 
Hi all,
Here's a variant that I find interesting ;-). It's not about the public key but about the signature, another cryptograhic field
in a certificate that shares many properties with keys.
Say somebody has discovered a marvelous method of finding collisions
for a hash function. Then he creates two certificates, of which the
to-be-signed parts form a hash collision. Then he lets a CA sign one of them, and copies the signature into the other one, making
that a certificate that is indistinguishable from a valid one
issued by the CA. Has he broken any copyright law?
I admit this is a purely hypothetical case. Or... maybe it isn't?
Benne de Weger

@_date: 2009-01-10 23:32:44
@_author: Weger, B.M.M. de 
@_subject: MD5 considered harmful today, SHA-1 considered harmful tomorrow 
Hi Victor,
Will this situation have changed by the end of 2010 (that's
next year, by the way), when everybody who takes NIST seriously will have to switch to SHA-2? The first weakness shown in MD5
was not in 2004 but in 1995. Apparently it takes a very long
time before the awareness about the implications of using
weakened or broken crypto has reached a sufficient level. Though
I understand the practical issues you're talking about, Victor,
my bottom line is different.
In my view, the main lesson that the information security community, and in particular its intersection with the application building community, has to learn from the recent MD5 and SHA-1 history,
is that strategies for dealing with broken crypto need rethinking.
[[Maybe in the previous sentence the word "intersection" should be replaced by "union".]]
Benne de Weger
PS: I find it ironic that the sites (such as ftp.ccc.de/congress/25c3/) offering the video and audio files of the 25c3 presentation "MD5 considered harmful today", provide for integrity checking of those files their, uhm, MD5 hashes.

@_date: 2009-01-12 12:24:10
@_author: Weger, B.M.M. de 
@_subject: MD5 considered harmful today, SHA-1 considered harmful tomorrow 
Hi Peter,
I had algorithms in mind, as the 'hash crisis' is about algorithms.
For algorithms the situation might be simpler than for protocols.
It is conceivable that one of these days some clever person comes
up with, say, a practical chosen-prefix collision attack on SHA-1,
enabling something similar as we did with MD5. It is also conceivable that some clever person completely breaks Rijndael, or RSA.
Do software vendors (such as browser vendors) and service providers (such as CAs) have disaster recovery plans for such a situation? Or are these simply 'accepted risks' that nobody worries about? In my view it would be prudent to move SHA-1 out of the no-worry
One level up, and maybe an example of a general lesson James was
asking for: good practice to avoid availability problems is to
add redundancy. In hash functions the security in many applications
now seems to be completely based on SHA-1, a not-yet-broken but
known-to-be-weak algorithm. How can we avoid such situations?
(I am thinking long term here). When in 2012 the winner of the
NIST SHA-3 competition will be known, and everybody will start
using it (so that according to Peter's estimates, by 2018 half
of the implementations actually uses it), do we then have enough
redundancy? I was not around when Rijndael was chosen as the AES winner. Have there been discussions then about the number of winning algorithms? Why only one, and not three winners, say, with a sufficiently different design, that everybody then will implement? Can / should NIST do so with SHA-3? Is implementing three new hash
functions at the same time much more complicated than implementing
Benne de Weger

@_date: 2009-07-14 23:09:41
@_author: Weger, B.M.M. de 
@_subject: HSM outage causes root CA key loss 
Suppose this happens in a production environment of some CA
(root or not), how big a problem is this? I can see two issues:
- they have to build a new CA and distribute its certificate
  to all users, which is annoying and maybe costly but not a   security problem,
- if they rely on the CA for signing CRLs (or whatever   revocation mechanism they're using) then they have to find   some other way to revoke existing certificates.
No need to revoke any certificate.
Any other problems? Maybe something with key rollover or Seems to me that for signing CRLs it's better to have a separate "Revocation Authority" (whose certificate should be issued by the CA it is revoking for); then revoking can continue when the CA loses its private key. The CA still may have revoking authority as well, at least to revoke the Revocation Authority's Benne de Weger

@_date: 2009-07-15 20:04:27
@_author: Weger, B.M.M. de 
@_subject: HSM outage causes root CA key loss 
This neglects the not entirely unlikely possibility that long before your retirement
some clever person will have broken your cryptographic hash function or signature scheme.
I once saw a document refering to a PKI with a proposed certificate lifetime of 100 years. Those people really care about their grandchildren.

@_date: 2020-06-09 08:13:07
@_author: Weger, B.M.M. de 
@_subject: [Cryptography] Zoom publishes draft cryptographic design for 
Bart Preneel is right, but there's more to say. First this:
If p and q are of equal size (which they usually are) then phi(n) and n
are not just *roughly* the same size; actually the first half (minus 1) of their bits are exactly equal. If n has 2048 bits and p, q have both 1024 bits, then the difference of n and phi(n) is n - phi(n) = p + q - 1 which has only 1025 bits. And now the more important point:
Say that you first generate random e with your preferred size (small, large, whatever), and then compute d to fit e d = 1 (mod phi(n)). Then the probability distribution that d will follow is almost uniform over the range it will live in (which will be between phi(n)/e and phi(n)).
This is not something that I can prove mathematically, but you can do experiments and see it happening before your eyes.
As a consequence, the probability that d will be almost as large as
phi(n) is overwhelmingly large, whether or not e is small or large.
Roughly only 1 in a million d's will be 20 bits shorter than phi(n),
and only 1 in a million*million d's will be 40 bits shorter than phi(n).
Though I can't say it is untrue that "you *might* find a small d if e is
large", (they do exist!) it is extremely improbable. If you start doing experiments for a given n with an awful lot of random e's until you've found a small d (say of half the length of n, to stay well above the bounds Bart mentioned), and at the same time I start the Number Field Sieve to factor the same n, in the end (well after the sun has burnt down) we will find that I win.
Of course, if you want to force small d, you can do so, but then you have
to reverse the process: start choosing a small d and then compute e.
The same reasoning as above shows that with overwhelming probability now
e will be of full size.
Finally, it's even possible, and actually not that hard, to come up with
n, e, d such that both e, d are of approximately half the size of n
(or, a bit more general, e d is of approximately the size of n).
But then you have to even further reverse the process: first choose
e, d and then see if you can find primes p and q that fit your wishes. With a not too bad probability this works. Totally useless, but funny.
Benne de Weger

@_date: 2020-06-09 12:08:54
@_author: Weger, B.M.M. de 
@_subject: [Cryptography] Zoom publishes draft cryptographic design for 
Ralph wrote on June 6:
and on June 9:
Hi Ralph,
Sorry that I was drifting more off-context, and still am...
My points can be summarized as follows:
- a 2048 bit n with a 2041 bit e will give with overwhelming
  probability a d with bitsize close to 2048, unless you
  really do your best to get d smaller
- "don't worry there ar sooo many d's, all is fine" comes close;
  I would say: "don't worry *), the bad d's are sooo unlikely to   show up **), all is fine".
There's (afaict) nothing wrong with e = F4. But if you have doubts,
there's also nothing wrong with much bigger e's (unless performance
really is an issue). I agree with you that, generally speaking, only allowing <= 32 bit e in an implementation is a not to be preferred inflexibility.
*)  if you use proper random generation **) and you can anyway build in checks in your key pair generation
