
@_date: 2003-08-29 03:04:47
@_author: Anonymous 
@_subject: traffic analysis 
Suppose you are engaged in a video conference with another party via an
anonymous real-time communications network.  Don't you agree that you
cannot remain anonymous to that party, if they have the power to insert
arbitrary delays into communication links?  How could you prevent frame
dropouts when she delays your link into the anonymizing cloud?  You
can insert nulls, or get the cloud to do it for you, but it will be
obvious to the recipient that your video has stopped.
This again demonstrates that you cannot remain anonymous with realtime
communication against an adversary who can corrupt selected endpoints
and who can insert traffic delays.  If you disagree, explain how you
will counter this attack.

@_date: 2003-10-06 04:39:42
@_author: Anonymous 
@_subject: Interlock protocol chat program source code 
*
 * Two player chat program using the Interlock Protocol
 *
 * Based on Rivest and Shamir, "How to expose an eavesdropper",
 * Communications of the ACM, v 27 no 4 (Apr 1984), pp 393-395.
 *
 * Requires the free OpenSSL crypto library, from  *
 * Warning: this is a quick hack written in about three hours, as a
 * demonstration of the principle and not as bulletproof security code.
 *
 * Usage: First person starts the program listening for a connection
 * with ./interchat portnum.
 * Second person connects to him with ./interchat hostname portnum.
 * Each party types a line of chat, and once each person has entered
 * his line, the data is exchanged.  No data will be received until each
 * person has entered their next line.
 *
 * Under certain assumptions, this approach will detect man-in-the-middle
 * attacks.  Actually, this program can be used to try acting as a MITM:
 * the MITM runs two chat sessions in different windows, connecting
 * to the two "victims" who think they are talking with each other.
 * By manipulating the two conversations he can try to get the two
 * parties to talk and share information with each other such that
 * he learns any secrets being exchanged.
 *
 * This software is  * Copyright (C) 2003 by PGP key ID AEE49232,
 * fingerprint CC6BAB551D0D2B65BB0B6D981C801DF4AEE49232.
 * All rights reserved.
 *  * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following condition
 * is met:
 *
 *    Redistributions of source code must retain the above copyright
 *    notice, this condition and the following disclaimer.
 *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
        "openssl/bn.h"
 "openssl/sha.h"
 "openssl/evp.h"
 "openssl/hmac.h"
typedef unsigned char uchar;
 PADLEN		16
 MYBUFLEN	256
 MIN(x,y) (((x)<(y))?(x):(y))
BN_CTX *bnctx;
BIGNUM *p, *q, *g;
 XBITS	200
char *p_hex =	"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1"
char *q_hex =	"7FFFFFFFFFFFFFFFE487ED5110B4611A62633145C06E0E68"
char *g_hex =	"2";
BIGNUM *my_x, *my_y, *his_y, *shared;
uchar enckey[16], deckey[16];
uchar mymackey[16], hismackey[16];
static void
bnwrite( BIGNUM *bn, FILE *f )
static void
bnread( BIGNUM **bn, FILE *f )
static void
bnhash (EVP_MD_CTX *ctx, BIGNUM *bn)
static void
fwrite_enc (uchar *buf, int len, FILE *f)
static void
fread_dec (uchar *buf, int len, FILE *f)
static void
hashmsg (uchar *hashbuf, uchar *msg, int msglen, int direction, int mine)
 * then they exchange hashes of those messages, hashed with the public
 * and secret DH handshake values.  No, I need to add some randomness there,
 * too, don't I?
 */
static void
intercomm (int prio, FILE *f_in, FILE *f_out)
static int
dodh (int prio, FILE *f_in, FILE *f_out)
static void
keygen (uchar *key, unsigned keylen, char *name)
static int
docomm (int prio, FILE *f_in, FILE *f_out)
static int
client (char *target, int port, int nsides)
    int s, s1;
    int n;
    struct sockaddr_in sockaddr;
    s = socket(AF_INET, SOCK_STREAM, 0);
    if (s < 0) {
    }
    sockaddr.sin_family = AF_INET;
    sockaddr.sin_port = htons(port);
static char *
revlookup (struct sockaddr_in *otheraddr)
static int
server (int port, int nsides)
    int s, s1;
    int n;
    struct sockaddr_in sockaddr, otheraddr;
    s = socket(AF_INET, SOCK_STREAM, 0);
    if (s < 0) {
    }
    sockaddr.sin_family = AF_INET;
    sockaddr.sin_port = htons(port);
main (int ac, char **av)

@_date: 2003-10-24 02:34:40
@_author: Anonymous 
@_subject: New info on Palladium 
For some updated news about NGSCB, aka Palladium, go to the Microsoft
NGSCB newsgroup page at
This might be a good forum for cypherpunks to ask questions about
There was a particularly informative posting by Ellen Cram of Microsoft on
October 15.  Among other things she reveals that the Longhorn pre-release
to be distributed at the Microsoft PDC (conference) will include NGSCB
technology.  It's not clear how this will work without the specialized
hardware features, though.
Also getting attention is a bizarre attempt at guerrilla marketing,
where Microsoft employees are running blogs to promote Longhorn.
 provides a good example.  In "How
to Hate Microsoft", Robert Scoble, Longhorn technology evangelist,
wants you to tell him everything you don't like about Longhorn.  Pull no
punches, he begs.  So far there are a few comments about DRM but not
much specifically about Palladium/NGSCB.
On another front, John Walker of AutoCAD fame, who supported
a number of quixotic projects through the 80s and 90s, like the
ill-fated Xanadu, has a new publication out.  The Digital Imprimatur,
 presents a
dystopian future for the Internet that is heavily based on the potential
negative consequences of Trusted Computing technologies like Palladium.
In Walker's view, Palladium will spawn a net where you need a certificate
to participate, and this will naturally lead to a "fully trusted"
network where not only people, but all their transactions and documents
will be certified, hence traceable and accountable.  An "imprimatur"
is a government license to run a printing press, and we will experience
the same effect in the Trusted Internet of the future.
Although Walker's story is meant to be a cautionary tale, the list of
properties of the Trusted Net is so attractive that many readers are
questioning why we should oppose these developments: an end to copyright
violation, (unauthorized) eavesdropping, scams, security fraud, SPAM,
worms and viruses.  Walker's architecture also supports search engines
that are 100% accurate, with low maintenance.  The Trusted Net limits
child pornography (and children's access to adult porn), hate speech,
employee internet abuse, and tax evasion.  It inherently supports DRM,
satisfying the concerns of content providers and providing a foundation
for wide-scale distribution of copyrighted content.
Walker has put an intentionally favorable slant on his presentation in
order to demonstrate how plausible it is that people will accept the
restrictions of Palladium in exchange for all these benefits.  The spam
menace is already leading to calls for an Internet Drivers License even
from some circles within the pro-freedom crowd, and a Trusted Net would
be only a small additional step.
While Walker's description of "how to put the Internet genie back in
the bottle" is sobering, his track record as a prognosticator is not
promising.  He was wrong about the net before, and he's probably wrong
about it now.  A rather dull discussion forum for the essay is running
at
