
@_date: 2007-06-26 14:29:34
@_author: Jacob Appelbaum 
@_subject: Free Rootkit with Every New Intel Machine 
Are you discussing how they handle their encrypted swap, encrypted disk
(via FileVault) or their encrypted sleep image? I was unaware that Apple
had implemented full root file system encryption.
A positive match looks like this:
 +-o ApplePCISlotPM   +-o TPM  Jacob Appelbaum

@_date: 2007-09-06 12:04:39
@_author: Jacob Appelbaum 
@_subject: Seagate announces hardware FDE for laptop and desktop machines 
Seagate recently announced a 1TB drive for desktop systems and a 250GB
laptop drive. What's of interest is that it appears to use a system
called DriveTrust for Full Disk Encryption. It's apparently AES-128.
The detail lacking press release is here:
The relevant excerpt of it appears to be:
"The Barracuda FDE (full disc encryption) hard drive is the world?s
first 3.5-inch desktop PC drive with native encryption to prevent
unauthorized access to data on lost or stolen hard drives or systems.
Using AES encryption, a government-grade security protocol and the
strongest that is commercially available, The Barracuda FDE hard drive
delivers endpoint security for powered-down systems. Logging back on
requires a pre-boot user password that can be buttressed with other
layers of authentication such as smart cards and biometrics."
I found this somewhat relevant paper (though it seriously lacks
important details) on DriveTrust:
Has anyone read relevant details for this system? It seems like
something quite useful but I'm not sure that I trust something I can't

@_date: 2007-09-06 15:14:59
@_author: Jacob Appelbaum 
@_subject: Seagate announces hardware FDE for laptop and desktop machines 
It seems the the answer would be yes for the laptop at the very least.
It appears to use a firmware implementation. To quote their pdf I linked
to before [0]:
"DriveTrust technology implements on the drive a cryptographic service
provider that provides encryption, hashing, secure storage, decryption,
digital signature and random-number generating functions"
Though I think that unless they're providing their full firmware code,
it's not to be trusted. Though it should be possible to examine the on
disk bits with other known good implementations of AES128 (CBC? I'm not
All the more reason to investigate it. I wonder if they'll provide their
firmware if a big enough client were to request it. They also claim to
be about open standards:
"An open standard is being developed within the Trusted Computing Group."
Perhaps one of the Seagate developers is on this list? If not, I think
they probably should be...
[0]

@_date: 2008-04-24 18:58:41
@_author: Jacob Appelbaum 
@_subject: "Designing and implementing malicious hardware" 
"Silicon has no secrets."
I spent last weekend in Seattle and Bunnie (of XBox hacking fame/Chumby)
gave a workshop with Karsten Nohl (who recently cracked MiFare).
In a matter of an hour, all of the students were able to take a
selection of a chip (from an OK photograph) and walk through the
transistor layout to describe the gate configuration. I was surprised
(not being an EE person by training) at how easy it can be to understand
production hardware. Debug pads, automated masking, etc. Karsten has
written a set of MatLab extensions that he used to automatically
describe the circuits of the mifare devices. Automation is key though, I
think doing it by hand is the path of madness.
If we could convince (this is the hard part) companies to publish what
they think their chips should look like, we'd have a starting point.

@_date: 2008-12-30 17:52:08
@_author: Jacob Appelbaum 
@_subject: MD5 considered harmful today 
I wanted to chime in more during the previous x509 discussions but I was
delayed by some research.
I thought that I'd like to chime in that this new research about
attacking x509 is now released. We gave a talk about it at the 25c3
about an hour or two ago.
MD5 considered harmful today: Creating a rogue CA certificate
Nearly everything is here:

@_date: 2008-02-21 12:39:58
@_author: Jacob Appelbaum 
@_subject: cold boot attacks on disk encryption 
I'm one of the coauthors of the paper and I'd love to chime in.
This is correct.
Yes, this is also correct. Canned air is often found in server rooms. An
attacker might not even need to bring anything with them to leverage
this attack.
This is an important point. Without cooling, it's not merely a matter of
a second or less. This is a common misconception that even in light of
new evidence is difficult to believe. I think reading our paper and
understanding our graphs should help with this.
Yes. General purpose memory isn't a safe place to store keying material
and software countermeasures are a step behind. Even with obfuscated key
schedules or strange byte ordering, the physical properties of the
memory chips are going to be difficult to overcome.
As our paper states: "There is no easy solution to this problem."
I'm happy to field questions if this is the proper forum.
Jacob Appelbaum

@_date: 2008-02-21 14:47:55
@_author: Jacob Appelbaum 
@_subject: cold boot attacks on disk encryption 
Usually when doing a demo of this attack, people change their minds
quickly. I'm pleased to hear that in actual use cases you acknowledge an
actual problem.
While riding the BART this morning, I ran into Nate Lawson (from
Cryptography Research). He mentioned that he felt people would reply
with such endorsements. I'd like to take the time to disagree with
endorsing hardware products as a solution. Hardware solutions are going
to be hard to attack in some circumstances. But they may in fact be
worse without fully viewable (or Free) source software (for the
firmware, the FPGA or the layout of the ASIC, etc.
A great example of some so called "unbreakable" hardware disk crypto is
this snakeoil:
"A new generation of inexpensive disk drive enclosures using hardware
encryption and RFID keys do not fulfil the promises of their publicity.
The adverts claim 128-bit AES hardware encryption, but they don't tell
us how it is used."
Without transparency, I'd rather stick with software. It has issues, we
now know about another one.
Jacob Appelbaum

@_date: 2008-02-21 18:09:15
@_author: Jacob Appelbaum 
@_subject: cold boot attacks on disk encryption 
Actually, I hear that some companies store the keys on the platters of
the disk. Again this is if they're actually using crypto and not just
selling XOR'ed blocks of data.
To project the keys, they limit standard read commands to not enter
those areas of the disk. Of course the vendor provides a method to read
those areas of disk, it's just a matter of finding them.
Jacob Appelbaum

@_date: 2008-03-15 17:05:36
@_author: Jacob Appelbaum 
@_subject: wrt Cold Boot Attacks on Disk Encryption 
I think that it's clear that people were shocked when Max released his
work. Many people may discount the work if they (say like many
Thinkpads) do not have at IEEE 1394 port. This is of course not going to
stop someone from inserting a cardbus card. Furthermore, I think Max
didn't manage to demonstrate a contradiction to a commonly held thought.
I'm sure it was no surprise to FreeBSD kernel developers that you could
use Firewire to read kernel memory structures using DMA.
I think the most important aspect of this work is that by using
redundant (all Hail Nadia Heninger) keying information in memory we can
recover and make a pretty good confirmation. This means we don't have to
do reverse engineering to find keys and we can correct for errors.
Our keyfinder could be used with firewire and I think it stands on its own.
Jacob Appelbaum

@_date: 2008-05-04 01:15:43
@_author: Jacob Appelbaum 
@_subject: User interface, security, and "simplicity" 
(As a disclaimer, I've hacked a little on Tunnelblick (the mac os x GUI)
and I've talked at length with the creator of OpenVPN.)
I'm always curious to hear what designers of protocols actually use on a
daily basis. I'm also really curious how said designers evaluate their
I really like OpenVPN. It's really smooth to setup, it's very easy to
use on the Big Three Platforms.
Have you read the source to OpenVPN? Do you think that it's
cryptographically sound? Is it properly implemented?
I've found some stuff I wonder about and I'm curious if anyone else has?
Jacob Appelbaum

@_date: 2009-06-29 23:29:48
@_author: Jacob Appelbaum 
@_subject: password safes for mac 
This would be great if LoginWindow.app didn't store your unencrypted
login and password in memory for your entire session (including screen
lock, suspend to ram and hibernate).
I keep hearing that Apple will close my bug about this and they keep
delaying. I guess they use the credentials in memory for some things
where they don't want to bother the user (!) but they still want to be
able to elevate privileges.

@_date: 2009-09-25 01:26:22
@_author: Jacob Appelbaum 
@_subject: FileVault on other than home directories on MacOS? 
The devil is in the details. If you use your default keychain to unlock
a disk, I believe the _passphrase_ is still stored by LoginWindow.app in
plain text... So even if they destroyed keying material properly (do
they? Is there source we can review for how FV works?) when the disk
isn't in use, I somehow doubt that it's really safe to use FileVault in
some circumstances against some attackers. Especially if you have a
laptop and especially if you didn't turn on encrypted swap. Also
especially if you happened to use the encrypted swap feature when it
wasn't working. The list of hilarious bugs goes on and on.
(The LoginWindow.app bug is as old as the hills and I'm one of a dozen
people to have reported it, I bet. Apple still hasn't fixed it because
they rely on a users password being in memory to escalate privileges
without interacting with the user! I hear they're working on a fix but
that it's difficult because many systems rely on this "feature.")
I haven't been working on or thinking about VileFault much but I suppose
that we probably could add support for sparse bundles if someone wanted.
I've been bugging Apple for some specifications and so far, it's been
years without a real response.
Most of what we know is in VileFault:
It would be really awesome if Apple would open up all of this code or at
least publish a specification for how it works. With either we could
have a Fuse file system module to support these disk images on other

@_date: 2009-09-29 22:51:33
@_author: Jacob Appelbaum 
@_subject: Merry Certmas! CN=*\x00thoughtcrime.noisebridge.net 
Hello *,
In the spirit of giving and sharing, I felt it would be nice to enable
other Noisebridgers (and friends of Noisebridge) to play around with
bugs in SSL/TLS.
Moxie was just over and we'd discussed releasing this certificate for
some time. He's already released a few certificates and I thought I'd
join him. In celebration of his visit to San Francisco, I wanted to
release fun-times-at-moxie-marlinspike-high. This is a text file that
contains a fully valid, signed certificate (with private key) that can
be used to exploit the NULL certificate prefix bug[0]. The certificate
is valid for * on the internet (when exploiting libnss software). The
certificate is good for two years. It won't work for exploiting the bug
for software written with the WIN32 api, they don't accept (for good
reason) *! I suggest the use of Moxie's sslsniff[1] if you're so
inclined to try network related testing. It may also be useful for
testing code signing software.
It's been long enough that everyone should be patched for this awesome
class of bugs. This certificate and corresponding private key should
help people test fairly obscure software or software they've written
themselves. I hope this release will help with confirmation of the bug
and with regression testing. Feel free to use this certificate for
anything relating to free software too. Consider it released into the
public domain of interesting integers.
[0] [1]

@_date: 2010-08-18 20:30:58
@_author: Jacob Appelbaum 
@_subject: Collage 
Unlike haystack - this software appears to be real and to have
contributed something useful to the field of anti-censorship. Impressive
All the best,

@_date: 2010-09-15 03:16:34
@_author: Jacob Appelbaum 
@_subject: Haystack redux 
What Steve has written is mostly true - though I was not working alone,
we did it in an afternoon. It took quite a bit of effort to get Haystack
to take this seriously. Eventually, there was an internal mutiny because
of a serious technical disconnect between the author Daniel Colascione
and the supposed author, Austin Heap. Daniel has been a stand up guy
about the issues discovered and he really the problem space that the
tool created.
Sadly, most of the issues discovered do not have easy fixes - this
includes even discussing some of the very simple but serious design
flaws discovered. This has to be the worst disclosure issue that I've
ever had to ponder - generally, I'm worried about being sued by some
mega corp for speaking some factual information to their users. In this
case, I guess the failure mode for being open about details is ... much
worse for those affected. :-(
An interesting unintended consequence of the original media storm is
that no one in the media enjoys being played; it seems that now most of
the original players are lining up to ask hard questions. It may be too
little and too late, frankly. I suppose it's better than nothing but it
sure is a great lesson in popular media journalism failures.
All the best,

@_date: 2010-09-15 16:08:02
@_author: Jacob Appelbaum 
@_subject: Haystack redux 
The media hype? The fact that many Iranians were reaching out to people
in "the West" during the summer of 2009?
I guess the dissidents that you work with are all savvy, never tricked,
know how to make solid security evaluations, and so on? Generally
speaking... that is not my experience at all.
All the best,

@_date: 2013-12-18 13:12:51
@_author: Jacob Appelbaum 
@_subject: [Cryptography] 
=?windows-1252?q?ased_Key_Derivation_for_Elliptic_curve_Diffie=96Hellman_?=
 =?windows-1252?q?key_agreement?=
Why not simply use OTR? It works with Facebook chat already?
All the best,

@_date: 2014-08-19 14:13:28
@_author: Jacob Appelbaum 
@_subject: [Cryptography] [cryptography] STARTTLS for HTTP 
Not all HTTPS ports are properly configured to match what is served on
a given HTTP server. Also some networks block port 443 but not port
Also, it is an inband way of signaling that the server supports TLS.
I've heard that this is how TahoeLAFS does TLS with foolscap (HTTP upgrade).
It seems to have all of the normal TLS certificate issues, yes.
All the best,

@_date: 2014-09-21 05:46:57
@_author: Jacob Appelbaum 
@_subject: [Cryptography] new wiretap resistance in iOS 8? 
I like that proverb but it assumes a baseline standard of good. I
think John (Gilmore) is correct to not fall for the marketing hype. It
is false to say that the measure here is imposing a cost on the
attacker - how do you plan to verify that? How do you know what cost
it would impose?
I agree that good is better than none. I might even agree that that
we'll never reach perfect, so it is better to have good rather than
obviously bad. I don't however agree that this is good as that remains
to be seen.
Please do consider that they are described as an NSA PRISM partner.
Please do consider that they do appear to have recently lost their
warrant cannary.
How do you know that they don't escrow? We don't know more than what
they claim. Furthermore - do you need to escrow keys to mount an
attack? I suspect no.
Or perhaps it wasn't anything from the start?
If the crypto is bad or if the keys are weak - how will you know that
you've been bamboozled?
That is a bizarre statement.
The threat from the NSA is the same threat as from anyone with similar
capabilities. Consider that the NSA is tasked with compromising an
iPhone deployed in Qatar. Consider that they are the adversary that
rather than helping Apple, they have traditionally attacked Apple. And
no, it doesn't matter if you're a US citizens or a US company.
Just to settle this - Apple has signing keys. They keep those. They
use them to issue updates. They might not be escrowing *your* keys or
they might be doing something different. The protocols aren't open or
documented, we can't implement free and open clients that we can
verify. As Gilmore has rightfully pointed out, they have the capacity
to move and you suggest that they won't move when pushed? Consider the
case of Yahoo and the proposed fines?
I'm worried about all of those things but Apple headquarters is of
course the PRISM partner - your other comments are speculation. It is
well founded, I agree with it and I don't dismiss it either. Still -
here we have evidence of PRISM and Apple's complicity or
victimization. Just above you suggest that the enemy of the perfect is
the enemy of good enough - it may not be perfect, HTC phones may also
be weakened by someone - but if it isn't the NSA, I'd be happy with
that as a good solution. Especially since Apple products aren't made
by HTC. :-)
Probably the biggest threat from the NSA is that they'll feed your
location data to people who operate drone strikes. Using your nice
iPhone, they'll assist in murdering you.
And yes, they also backdoor crypto, actively exploit software and hardware bugs.
To that end - the Hobbesian world is already here. With Apple's help,
no less. Is it willing? How would we know? Is it coerced? How can we
verify? Absent all of that - you suggest that we... trust?
I'd encourage a read of  for a healthy dose
documents produced by the government for internal information
exchange. I love FOIA but I love Snowden's FOIA process a lot more.
They're spies. They are lawless. At best they claim these days that an
executive order is the same as a law enacted by Congress. They are
literally claiming that EO12333 allows them to do dragnet collection.
I've had a senior NSA person tell me that EO12333 allows NSA to
collect on the Tor network in the US and outside without exception.
This has cost them nothing. Alexander, Clapper and others are all
free. They are not punished - they are part of a culture of impunity.
The NSA and other "Intelligence Community" members have been doing
this for longer than I've been alive. They've been getting caught for
ages and no reform has changed anything except in public perception
that it is happening at all. It costs them nothing and has cost them
You can however be jailed for failing to produce information if say, a
Grand Jury, believes that you have it. You can be threatened with ever
expanding fines as Yahoo was by the FISA "court" process. Again, this
argument you're making misses the point by a country mile - the State
will put a boot on your neck and you will choke. With a person, it is
hard to do that silently. With technology, it costs them nothing and
if you're not checking, you might not even notice. And to Gilmore's
point, how will you check?
Open the protocols, free the implementations, discuss the legal
situations, deploy end to end crypto where a user is the only person
with a key, use ephemeral keys and then address each of the points
that Gilmore made.
But whatever is done - let us not remove the pressure - we need more
transparency and above all, we need accountability. To shift from
PRISM partner to thumbing their nose at their partners suggests that
they may turn again.
Wiretapped along with the rest of you,

@_date: 2015-12-24 04:21:45
@_author: Jacob Appelbaum 
@_subject: [Cryptography] Juniper & Dual_EC_DRBG 
I think you're on the right path here. It makes sense from what we've
published about their VPN decrypt capabilities. I think that anywhere
there is Cavium, we'll find a "SIGINT enabled" VPN.
Cavium is repeatedly mentioned in the archive and in documents.
All the best,

@_date: 2015-01-26 09:48:08
@_author: Jacob Appelbaum 
@_subject: [Cryptography] actual NSA protocol docs to mine... 
What baseless accusation? I made the statement last year based on this
and other documents. I worked on this latest story as well as the
others where I discussed these details openly.
All the best,
