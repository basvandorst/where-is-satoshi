
@_date: 2020-04-08 13:39:46
@_author: Marcus Brinkmann 
@_subject: [Cryptography] Dumb Question about Pair-Wise Authentication 
You are looking for a message authentication code (MAC). Because you are
using a pre-shared secret, you are looking for a keyed MAC.  The scheme
you suggest is naive (in a technical sense, not meant derogatory), but
it is not terrible.  By using H(message || key) you avoid the
length-extension attack that is inherent in the alternative H(key ||
message). However, security depends on H(message) being collision-free,
as otherwise H(m1) == H(m2) implies H(m1 || key) == H(m2 || key).
The keyed MAC that virtually everybody is using is HMAC. It's a bit more
complicated than your idea, but not by much. You can find its definition
in RFC2104 or on Wikipedia ( Note
that for a conforming implementation, the secret is hashed before use if
it is longer than the hash size, but not if it is shorter or equal!
That's a trap for the young ones.
tl;dr: Use HMAC with pre-shared key for message authentication.
Postnote: If you have any other security goals apart from integrity
(i.e. protection against replay attachs, confidentiality, detection of
message loss, etc), everything gets much more complicated very quickly.
 It would then be much easier to use a sledgehammer solution like TLS,
SSH, some VPN, or, if asynchonous messaging is a must, some variation of
the Signal protocol, e.g. using the Noise framework).
Alrighty :)
