
@_date: 2002-02-05 15:48:08
@_author: Kim-Ee Yeoh 
@_subject: Welome to the Internet, here's your private key 
I took a brief look at your code, and one optimization you could do is to
make a single pass for both the monobit and poker tests.  If c_0, c_1,
..., c_15 are the frequency counts of nibbles, then the monobit count is
just the sum over all i's of c_i * w(i), where w(i) is the Hamming weight
of i.
Also the chi-square for the poker test could easily be done in pure
integer arithmetic by clearing out the denominator of 5000.  (Of course,
it helps when your embedded system, such as the one I work with, has a
machine word size of 32 bits.  Your mileage on specific smartcards may
Could you clarify what you mean by "counter output"?  Are we talking about
a sequence of consecutive 8-, 16-, or 32-bit numbers?  If so, FIPS will
detect and flunk such sequences.  I'm almost as certain that a
maximal-period LFSR would be similarly detected.  A runs test, especially,
isn't fooled so easily.
As it stands, the FIPS-140 RNG testsuite is a good compromise between
speed and validation efficacy.  FIPS-140 is a standard for crypto-module
validation, and so long as your tests for the RNG component of your
crypto-module are comparable or exceed those specified in the standard,
you're doing fine.  You are quite at liberty to perform the additional
tests you've suggested.

@_date: 2002-02-06 19:29:04
@_author: Kim-Ee Yeoh 
@_subject: Welome to the Internet, here's your private key 
For 16-bit or 32-bit sequences of consecutive numbers starting with 0,
FIPS easily flunks them because there are too many gaps (consecutive runs
of zeroes). And if the runs test in FIPS were slightly extended, your sequence of
consecutive 8-bit numbers would have been easily caught too.  Here's the
full spectrum of runs for your sequence:
That there are 70 gaps of length exactly 7 but no blocks at all of the
same length is extremely anomalous behavior for the output of a putative
RNG.  Extending the runs test from 6 to 8 categories, i.e. counting blocks
and gaps for run-lengths of exactly 1 to 7 and for run-lengths of 8 and
greater, would easily have caught this.
I will even go further as to quantify what I mean by "extremely anomalous
behavior."  The expected number of blocks (or gaps) of length exactly p in
a uniformly random n-bit sequence is e(n,p) = (n-p+3)/2^(p+2) with a
variance of v(n,p) = (3*p^2-2*n*p-8*p+n-3)/2^(2*p+4) + e(n,p), a result
that can be shown without too much difficulty.  As n tends toward
infinity, the distribution in the limit is Gaussian (see Knuth V2 3E p69).
The probability that a uniformly random 20000-bit sequence has no blocks
of length 7 is no more than 2.1 * 10^(-10), several orders of magnitude
lower than the one-in-a-million threshold at which the FIPS tests are
As you have noted, simple LFSRs are easily detected by FIPS.  LFSRs of
longer period can be detected by using both a larger sample and analyzing
the full, rather than the truncated, runs spectrum.  Alternatively, if you
simply want to eliminate any possibility of an LFSR, just apply
Berlekamp-Massey. You want to recheck your last result.  The primitive binary polynomial
x^15+x+1 with a starting seed of 1 produces a sequence that starts with a
length-14 gap followed by a length-15 block.  The FIPS runs spectrum is:
 	 2		1284    	1250
FIPS passes the sequence.
