
@_date: 2001-04-25 07:46:31
@_author: David G. Koontz 
@_subject: Impact and purpose of IP/FP in DES 
What you are risking here is the right to refer to you software as DES.
If it isn't compliant with the Digital Encryption Standard, it isn't the
Digital Encryption Algorithm.  The Initial and Final Permutations, as
well as the Permuted Choice 1 specify how to get particular bits of data
into (from for FP) particular registers (when viewed as a hardware implementation).  If two implementations were to be allowed to interface
data in more than one way, they couldn't interchange data.  I've included
a copy of a usenet posting from 1994 explaining the permutations. I received
a copy of FIPS 46 from a chip designer at Fairchild in 1978 while working
on crypto in the military.  I probably still have my notes on plotting out the permutations into hardware.  Mr. Rallapalli at Fairchild implemented
the 9414 chips set which basically implemented a byte of L, a byte of R,
two mask programmable S boxes, and either the C or D registers in a 40 pin
IC.  The implementation was especially good at showing the nature of the
IP/FP permutations and PC1.  These being a pattern of 8 wires.  I've shown
this in a VHDL model of DES I did.  I'd be willing to send some one the
VHDL model which illustrates the 'disappearing permutations'.  In 1996
enholm at login.eunet.no (Morten Enholm) was trying to get a copy of it from
Mark Riordans ripem site  (ripem.msu.edu).  I'd be willing to vhdl pretty
print them into a pdf file so you could read the code (vhdl_des.tar.z). I'm not personally aware of any foreign copies of the VHDL code.  There
are three european VHDL implementations of DES in VHDL available on the
Web, all three are essentially translated from C, and show the permutations.
I'm including the toplevel as a pdf, which shows the translation between
byte bit order (7 downto 0) and NSA or IBM order (1 to 8), and hides the
IP in DIN(7 downto 0) and  FP in DOUT(7 downto 0) connections to the four
DSLICE's  (9414 chip equivalents, sans C and D registers).  I'm also
including dslice.vhdl as a pdf so you can see the organization.
You can find a sample C des implementation at:
(Either init_perm.c or inv_perm.c has a "| =" that should be "|=" for
gcc.  Some of the source files in this directory have CRLF instead of
just newlines, which can give some tools problems (make in particular).
This des program compiles for either big or little endian machines, although
the table size is unfriendly to small cache processors.  I wrote three
generations of much faster code I never released publicly.)
Of note are the FIPS Spec PUB 500-20 test vectors found in the file
I believe one of the test vectors has a key parity bit flipped in this copy.
In 1995 I figured out how to reduce the size of lookup tables for IP and FP
in a C implementation.
By the way, PC1 is a permuted choice instead of a permutation, because the parity bits in the key does not go into the C or D registers.

@_date: 2001-08-04 23:10:18
@_author: David G. Koontz 
@_subject: NSA's new mode of operation broken in less than 24 hours 
Had me going for a minute.  I had to check  as
well as the dual counter mode description.
I thought dual counter might refer to the two half blocks
found in the FNBDT Counter Mode  (which is instead the counter mode described by Lipmaa/Rogaway/Wagner).
Are there any references/urls/notes describing an analysis
of dual counter mode?  I searched web sites and NISTs Mode
of Operation Forum.  The only thing readily apparent is
that it appears to be inspired by the desire to generate
new protocols.  While FNBDT has been said to have been implemented
via wireless IP on notebooks,  I can sympathize with accumulating
overhead - especially in narrowband applications.

@_date: 2001-06-07 07:15:47
@_author: David G. Koontz 
@_subject: Starium (was Re: article: german secure phone) 
A quick look at bump on the line phone security boxes and potentially
secure mobile phones brings up the question of trust.  The Privatel box
has a 1024 bit modulus, and a 256 bit private key.  Lets say they sell
20,000 boxes over the life of the product.  They all operate off the same
modulus and prime number.  There are 20K 256 bit integers for their
products.  The manufacturer knows the prime and modulus and probably has
either a list of the private key parts or an actual association between
boxes and private keys.
They get approached by a TLA, the US DOJ or a secret court with a secret
order to hand over said information.  They have an employee sell out,
or through consequence of poor management get hacked, or otherwise the
information is stolen.  You need control over your own key exchange keys to have real security.

@_date: 2001-06-13 09:25:06
@_author: David G. Koontz 
@_subject: WAS: Thermal Imaging Decision Applicable to TEMPEST? 
Is the average person susceptible to TEMPEST attacks?
TEMPEST is the control of compromising emanations - the prevention of
secrets leaking out.  Contrast this with FCC or EN regulations for
EMI and difference is separating secret from not secret information -
RED BLACK separation.  Not having looked at any of the NACS*M documents
on John Youngs site, and not having seen them for almost 30 years
otherwise, one emphasis you see is on frequency content of emissions.
The FCC specs  start at a frequency where you could interfere with
CB radios.  Changes in the last decade or so, driven by the Europeans
to eliminate such things as power factor flicker on lights caused by
the motor in your laser printer have greatly added to how well protected
the equipment is that we buy today.
The major concerns are low frequency stuff, meeting EMI integrity in
installation (actually using properly shielded cables and the like),
and maintaining RED BLACK separation.  One could hypothesis that so
much of TEMPEST has been declassified because it is essentially covered
by FCC and EN regulations.  If you look at modern military grade crypto gear
designed for office use, it appears to be similar in design to COTS
Looking through some of the more recent Air Force manuals on John Youngs
site you see an emphasis on controlling accidental emissions - decoupled
phones when on hook, no transmitters or devices that could generate RF
in secure facilities and the like.  There is a specification on his site
that originates from the CIA (which controls security compartmentalized
information), that essentially relaxes physical EMI protections.  You can
build a SCIF without copper mesh in the walls today.  An important element
is physical separation (distance) between any attacker and equipment
that can radiate (at mandated reduced levels).
Thats not to say that the average computer user can't run up against (knowingly or unknowing) a problem they can't cure.  How would the average
guy deal with coupling between an ethernet cable and a phone line?  Guess
what, if you adhere to what you read in the manuals you can be more likely
to be immune from monitoring than not -  the difference is that unless
you do it, no one is going to do an RF sweep of your home or office.
(I recall a getting a trouble call while in the Air Force from a civilian
contractor at a classified location.  Seems their Gold phone (a secure
phone system with link encryption to a small central switch) was receiving
radio station AM 610 when ever the handset was offhook.  Something very
embarassing to say the least for a phone intended for SCI.  Turns out there
was a ground loop on an audio cable to the phone set, and a cold solder
joint acting as a rectifier - an accidental crystal radio.  We cured this
by rote examination of the installation against guidelines (at least to
find the ground loop).  Several years later I happened accross the same
phenonenom in a video game while working for a video arcade game company  - same radio station, too.)
Today I design digital equipment that operates in the gigahertz and up range - as will most computers in the next year or two.  There is an
barrier to monitoring digital microwave rate signals.  The equipment is
expensive, and out of budgetary range of all but private corporations and
national governments.

@_date: 2002-08-02 11:50:16
@_author: David G. Koontz 
@_subject: Challenge to David Wagner on TCPA 
The following had been mysteriously pared off my first response to
the above:
Anonymity is generally considered a a requirement for the political
process in the United States to protect the right to express political
speech without regard to being harrassed by those in power.  There
have been several federal court decisions in the last few years that
have struck down laws limiting anonymity for political speech.  One
that comes to mind was a requirement in Chicago, I think that required
the authors name on political phamplets.
Would a law requiring such technical measures for controlling access
to copyrighted information as proposed by representatives of Disney,
et. al. in the U.S. Congress recently that incidentally by design
prevented anonymity be found to be unconstitutionally limiting freedom
of political speech on the internet by its chilling effect?
On a slightly different note, copyrights are given to authors for
a limited time.  Should any technical protection mechanisms enacted
subsequent to law also be required to adhere to those limits? (as
in copyright expiry)  This could have the nice side effect of not
allowing extensions to copyrights be issued retroactively.  One
could also hope that fair use were enforceable under any law,
preventing copyrights from becoming absolute.
We could see society reshaped to fit poorly written laws.  Something
George Orwell could have foreseen.

@_date: 2002-06-20 07:57:04
@_author: David G. Koontz 
@_subject: DOJ proposes US data-rentention law. 
If the U.S. wasn't in an undeclared 'war', this would be considered
an unfunded mandate.  Does anyone realize the cost involved?  Think
of all the spam that needs to be recorded for posterity.  ISPs don't
currently record the type of information that this is talking about.
What customer data backup is being performed by ISPs is by and large
done by disk mirroring and is not kept permanently.
I did a bit of back of the envelope calculation and the cost in the
U.S. approaches half a billion dollars a year in additional backup
costs a year without any CALEA type impact to make it easy for law
enforcment to do data mining.  The estimate could easily be low by a
factor of 5-10.  AOL of course would be hit by 40 percent of this
though, not to mention a nice tax on MSN.  Call it ten cents a day
per customer in fee increases to record all that spam for review by
big brother.  I feel safer already.
Whats next, censorship?

@_date: 2002-06-25 17:12:43
@_author: David G. Koontz 
@_subject: MS TCPA/DRM OS to include escrow encryption equivalent? 
In an article entitled "Microsoft Aims to Improve
Security" on  :
"Microsoft also acknowledged that it hasn't resolved sensitive issues
of permitting access by government with a court order to a person's
encrypted data. The FBI has indicated it rarely encounters scrambled
information during investigations, but making such technology as
ubiquitous as Windows could invite use by criminals or terrorists.
``We recognize that something like this needs to be done responsibly,''
Juarez said.

@_date: 2002-05-25 14:50:53
@_author: David G. Koontz 
@_subject: FC: Hollywood wants to plug "analog hole," regulate A-D converters 
After hearing about the recent defeat of Sony's copyright protected CDs in Europe
with a marketing pen and having visited the above issue on the EFF site,
I spend some time thinking up schemes for watermarks detected by ADCs and
ways to defeat them.  Do not copy watermarks could be defeated by masking,
similar to the marker obscuring the security track on the Sony CDs.  If you
don't mind screwing around you could always transpose color components
going to the display device (similar to plugging RGB BNC connectors wrong.)
You could write software that inverse transposition on color components of
the captured data.
I don't think it is possible to built in watermark detection that can't be
defeated, even if detecting a watermark were to be required for operation,
it could be defeated.   I imagine it would be easier to buy smuggled in
devices.  If you didn't mind supporting your now a little more respectable
and reformed drugged lord or terrorist organization striking back at
the Great Satan by allowing ordinary citizens to exercise Fair Use.
I suppose it is too much to ask that the Justice Department investigate
these guys and the Pols they own under RICO?
Can you imagine watermarks on billboard advertisements?  How subliminal.
