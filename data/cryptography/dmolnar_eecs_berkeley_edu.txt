
@_date: 2004-07-10 17:32:07
@_author: David Alexander Molnar 
@_subject: EZ Pass and the fast lane .... 
I think it would be easier to provide drivers with a simpler method of
turning off their transponder. Recently ordered FasTrak tokens come with a
mylar bag for this purpose, which is too unwieldy. A switch, however,
might be enough.
This would not prevent an adversary from recording the IDs of cars that
pass through toll gates. It would, however, prevent reading those IDs at
other times.

@_date: 2004-07-13 01:08:30
@_author: David Alexander Molnar 
@_subject: FasTrak information 
Back in Fall 2003, David Wagner and I were looking at the FasTrak
transponders used in the San Francisco Bay Area. We were more interested
in the privacy aspects than in security, but we found some basic
information that may be of interest given the current discussion about
EZPass issues.
* FasTrak transponders use a spec called "Title 21," so called because
it is specified in Title 21 of the California Code. You can find a copy
* In principle, anyone can manufacture Title 21 compliant equipment. In
practice, SIRIT Technologies is a major vendor of Title 21 transponders
and readers in the Bay Area. You can find them at
(includes data sheets - check the reader controller card)
Another such vendor is TransCore (aka AmTech)
We looked into purchasing a reader controller card and antenna from SIRIT,
but were informed
We asked CalTrans about b) and were told that they would not authorize
SIRIT to sell transponders to us, but we were free to build our own. They
also suggested we talk to the university's transportation department to
come up with a research proposal "acceptable to CalTrans."
We then became occupied with library RFID and didn't come back to FasTrak.
I don't have the EE skills to build FasTrak readers, and right now don't
have the time to spend acquiring them. If anyone out there feels like
building this sort of thing, though, please let me know.
* Automatic number plate recognition (ANPR) has apparently improved
greatly in recent years. I gather this from reading recent articles in
transportation magazines and journals -- do not have the references on me
but can look them up this weekend.  Unfortunately I didn't find any hard
data on how much, exactly, it has improved.
entirely on automatic plate recognition. See also this web page on police
uses of ANPR in the UK:
Also interesting is this list of cities with congestion pricing, which has
some information on the technologies they use for vehicle identification:
We were interested in the setting where a 3rd party has FasTrak readers,
but not access to the database mapping ID to account. This seems like the
weakest reasonable threat model, but there are still some interesting
things you can do. For example, you could set up a device that takes
photographs of cars and associates them with FasTrak IDs. Then buy a lot
of pop-under ads, put the photos on them, and offer people a prize if they
identify the make of car correctly. (You could use something like the ESP
Game framework of Blum and Von Ahn to make sure the answers are right, or
at least right more often.)
Now filter out everything but the expensive (or easy to steal) cars. This
gives you the FasTrak IDs of expensive cars. Place a few readers in
parking garages, and then you know when expensive cars have been left
alone and where they are. That might be useful.
By the way, a friend mentioned that someone at AT&T had some recent
work on EZPass privacy issues. Does anyone know more?
-David Molnar

@_date: 2005-07-09 15:12:29
@_author: David Alexander Molnar 
@_subject: EMV [was: Re: Why Blockbuster looks at your ID.] 
Actually, smart cards are here today. My local movie theatre in Berkeley, California is participating in a trial for "MasterCard PayPass." There is a little antenna at the window; apparently you can just wave your card at the antena to pay for tickets. I haven't observed anyone using it in person, but the infrastructure is there right now.
Here's the MasterCard fact sheet about PayPass:
It appears to be a contactless smart card/RFID that uses the ISO 14443 standard for the RF interface. There is some documentation available, unfortunately most of it restricted to licensees.
You can do some Google searching to find MasterCard's involvement in standards-setting for EMV via smart cards over the years. From that it is possible to guess what PayPass might be doing, but I would prefer to know for sure. By the way, Visa is doing it too:
Chase appears to be issuing them now; you can apply for one online. From what I understand, contactless transactions are currently limited to $25 or less. This should reduce the incentive for someone to carry out the kind of relay/chess grandmaster attack described by Gerhard Hancke
"A Practical Relay Attack on ISO 14443 Proximity Cards"
Hancke and Markus Kuhn have a paper on "distance bounding" protocols to combat this kind of relay attack. Unfortunately it does not appear to be on Hancke's web page yet.
One of the nice things about these cards is that they also support the standard card number on the front and magstripe. So you could imagine a situation where the number is used as normal until fraud is detected, then revoked, but the contactless pay capability is not revoked. I have no idea if that is what they actually do, though.
-David Molnar

@_date: 2005-06-23 16:49:30
@_author: David Alexander Molnar 
@_subject: AES timing attacks, why not "whiten" the implementation? 
1) How do you generate this in a way that does not leak information about
the permutation generated?
2) How many times can you re-use a single indirection array?
3) How quickly can you generate new indirection arrays?
-David Molnar

@_date: 2005-10-20 13:43:08
@_author: David Alexander Molnar 
@_subject: [fc-discuss] Financial Cryptography Update: On Digital Cash-like 
One approach, investigated by Hal Finney, is to run the mint on a platform that allows remote attestation. Check out rpow.net - he has a working implementation of a proof of work payment system hosted on an IBM 4758.
-David Molnar

@_date: 2008-08-06 12:15:18
@_author: David Molnar 
@_subject: security questions 
[list of security questions snipped]
You might enjoy reading Ari Rabkin's recent paper at SOUPS 2008
on this issue:
"Personal knowledge questions for fallback authentication:
Security questions in the era of Facebook"
Ariel Rabkin
He has slides as well:
-David Molnar

@_date: 2008-12-27 12:39:44
@_author: David Molnar 
@_subject: Security by asking the drunk whether he's drunk 
Service from a group at CMU that uses semi-trusted "notary" servers to
periodically probe a web site to see which public key it uses. The
notaries provide the list of keys used to you, so you can attempt to
detect things like a site that has a different key for you than
previously shown to all of the notaries. The idea is that to fool the
system, the adversary has to compromise all links between the target
site and the notaries all the time.
Paper, code, and Firefox extension:

@_date: 2008-09-10 00:12:40
@_author: David Molnar 
@_subject: street prices for digital goods? 
Dan Geer's comment about the street price of heroin as a metric for success has me thinking - are people tracking the street prices of digital underground goods over time? The Symantec Threat Reports do seem to report advertised prices for a basket of goods, starting in Volume XI (March 2007) and running through the present. For example, Volume XI Table 3 states a Skype account is worth $12, valid Hotmail cookie $3, etc. These are interesting, but it's hard to see changes since they're reported as a band of prices presumably aggregated from many different I've also seen price anecdotes from Team Cymru. Plus of course the "Nature and Causes of the Wealth of Internet Miscreants" paper from CCS 2007. Is there a continuous feed of prices published anywhere (besides the underground servers, of course), or is this still something where you have to go gather data yourself if you want it?
I'm curious because it would be interesting to look at the "street price" for a specific online bank's logins before and after the bank makes a change to its security practices. (One not particularly great example of a change: adopting EV certs.) Alternatively, look at the price of some good before and after a prosecution. If this has already been done, my apologies, I'd appreciate the pointer.
finally, does anyone happen to know of a good review of how the focus on street price has performed as a metric for drug interdiction? that is, I could imagine cases where some specific intervention causes street price to rise but this doesn't lead to a corresponding improvement in things like deaths from drug overdose, number of people using, etc. Does that happen in practice so far as we know or not?
-David Molnar

@_date: 2008-09-20 04:11:15
@_author: David Molnar 
@_subject: street prices for digital goods? 
That would be useful for research. My colleague Karl Chen pointed out that it would probably be more useful for the underground market.
For the case of drug street prices, the U.S. Drug Enforcement Agency does keep a database of prices, called STRIDE, obtained from informant and undercover agent buys of drugs. These are records from actual buys, so they partially address the concern Richard Clayton raises about going by advertised list price -- but there are concerns (to which Richard alludes) about whether agents systematically overpay or informants systematically lie about the  price they paid for drugs in order to pocket the difference between money given to them for drug buys and the actual price.
STRIDE also includes data on purity of drugs assayed in DEA labs. This includes drugs seized by the feds, but not usually drugs seized by local agencies. There's actually a trio of papers here in particular that might be of interest to people who want to look at possible parallels between data gathering on drug street prices and illegal digital goods.
The first is an overview paper that discusses the conceptual and practical problems in doing price and purity analyses over time for illegal drugs. The paper also points out some interesting features of the drug market. For example, the author points out that drugs are "experience goods." That is, the purchaser does not know the actual quality of the good until after making the purchase. For drugs, quality means purity of the drug. What this boils down to is that when looking at time series of drug street prices, it turns out you need to model what the buyer believes the purity of the drug will be to make sense of the data.
"Price and purity analysis for illicit drugs: Data and conceptual issues"
J.P. Caulkins
Drug and Alcohol Dependence , Volume 90 , Pages S61 - S68
(Unfortunately the article is behind a paywall.)
The second looks at the STRIDE data and argues it is not suitable for use in economic analyses of the drug market. The primary criticism is that the data are mainly gathered from buys intended to produce evidence for busts, except for a smaller program aimed solely at heroin. They are therefore not a uniform sample of any kind. More interesting to me, however, is the author's contention that the data are not internally consistent: he is able to separate out prices reported by the DEA from prices reported by the DC metro police, then does a analysis showing that the two agencies report a statistically significant difference in prices. He concludes that the difference is greater than can be accounted for by normal price differences within a single city and that therefore something is wrong with the data.
"Should the DEA's STRIDE Data Be Used for Economic Analyses of Markets for Illegal Drugs?"
Horowitz, Joel L
The third and final paper is a rebuttal of the second. The authors claim that the second paper improperly lumps together retail and wholesale purchases of illegal drugs. They also claim that the second paper does not properly account for the relationship between price and purity of a drug. Once they toss the appropriate magic indicator variables into their regressions and stratify by purchase type, the supposed conflict between DEA and DC police reported prices disappears.
Why the DEA STRIDE Data are Still Useful for Understanding Drug Markets
Jeremy Arkes, Rosalie Liccardo Pacula, Susan M. Paddock, Jonathan P. Caulkins, Peter Reuter
NBER Working Paper No. 14224
Issued in August 2008
(Also paywalled, unfortunately)
What is the relevance to us? Well, I see a couple of points:
1) Like drugs, compromised PayPal accounts appear to be experience goods. In the case of drugs, quality is purity. In the case of compromised PayPal accounts, quality is something like the amount of money that can be successfully moved out of the account. Therefore, I would expect the same kind of modelling the buyer's "expected quality" of the good would be useful for us. In particular, failing to take it into account when analyzing price series could lead to the same kind of internal inconsistencies noted by Horowitz.
Not clear to me where other illegal digital goods stand. Botnets for example seem easy enough to test whether they are real. Also as Peter Gutmann points out, escrow services are possible and exist with illegal digital goods to aid fair exchange -- this is not reported for drugs.
2) Unlike STRIDE, the data sets we have reported so far were gathered specifically for research in mind, and not as part of some other mission. Unfortunately, they still are almost certainly not uniform samples of illegal prices, and unlike STRIDE, as pointed out, they are not actual transaction prices.
3) One of the complicating factors in drug data is the lack of standardized units. For example, Caulkins notes that 16% of all meth data reported in the STRIDE data was sold in units other than grams...and a few early analyses of the data didn't notice, yielding bogus results. A more serious issue is purity, again; the same $10 bag of pot may have wildly different amounts of THC. Similarly, as others have pointed out here, it is hard to do an apples to apples comparison of "compromised online banking accounts" if the lots of compromised accounts come in different sizes, from different banks, etc.
4) Finally, the sheer amount of money spent on drug enforcement and market disruption is huge. The NBER paper cites $8.3 billion expended by the federal government for the purpose of disrupting illicit drug markets, and $13 billion overall. How much do you think is spent, total, by everyone everywhere, on disrupting markets for illegal digital goods?
-David Molnar

@_date: 2009-02-14 12:54:29
@_author: David Molnar 
@_subject: Crypto Craft Knowledge 
[snip discussion of bad crypto implementation practices]
Yes, there's a need for a "crypto practices FAQ" to which one can refer.
In addition to individual education, it'd be helpful to have something
when pointing out common mistakes. For example, I was involved recently
in a discussion about MAC'ing prices returned by a shopping cart web
There's at least two gotchas here to consider:
1) The choice of MAC (i.e. why use HMAC instead of H(s||m) or H(m||s) ?)
2) replay attacks if the MAC'd item is not bound to the transaction or
the rest of the web page
I can point out these issues, but I don't usually have time to write
fully detailed examples. Having such examples goes a long way towards
increasing one's credibility in this kind of discussion. Ideally they
would be from deployed applications, but that's tough.
-David Molnar

@_date: 2009-02-17 02:01:25
@_author: David Molnar 
@_subject: Crypto Craft Knowledge 
This is a good point, and it reminds me of this presentation from Rusty
Russell on "levels" of Linux kernel interfaces. See
and following.
The main issue I see is how do you force the developer to adopt your
library and corresponding API? A secondary issue is what do you do if
there isn't a suitable library and API yet available? In cases where you
can't (yet) provide a simple "use cryptlib" response, a crypto practices
FAQ would be helpful for pointing out common problems and explaining
them well.
I've started a wiki in case anyone wants to hack on such a FAQ:
-David Molnar
