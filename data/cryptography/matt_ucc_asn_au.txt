
@_date: 2007-06-26 10:23:39
@_author: Matt Johnston 
@_subject: Free Rootkit with Every New Intel Machine 
To nit pick, the TPM is only present in some Apple Intel
machines and isn't used in any of them. See
Their OS decryption key is just stored in normal firmware,
unprotected AIUI.

@_date: 2009-11-03 23:08:40
@_author: Matt Johnston 
@_subject: Security of Mac Keychain, Filevault 
I took a look at the Mac OS X keychain format a few years
back,  is
what I came up with. The scheme looked roughly OK to me
though I'm not really qualified to give a good analysis of
its cryptographic security.
In summary it's using PBKDF2 (sha1, 1000 iterations, 20 byte
salt) on the password to create a master key, that in turn
encrypts a file key, which in turn encrypts item keys. It's
using 3DES-EDE3 in CBC mode, different IVs for each part,
though also some wrapping scheme that I don't know the
purpose of. Integrity checking is performed using
something a bit like a HMAC (but different), possibly for
backwards-compatibility reasons (my code ignores that).

@_date: 2013-11-06 20:55:06
@_author: Matt Johnston 
@_subject: [Cryptography] randomness +- entropy 
As a small data point, I'd use it. At first boot a SSH
server could slowly poll the ioctl in the background until
it's ready, then generate host keys. Saves having a delay on
first connection which will lead to mystified users.
I don't know if it would get used at a system level - for
upstart/systemd/whatever they'd probably prefer something
they wait for asynchronously?
Of course the systems that most need it probably won't get a
bleeding edge kernel for quite a while :-\
Dropbear SSH developer

@_date: 2016-03-11 18:41:00
@_author: Matt Johnston 
@_subject: [Cryptography] Help with Raspberry Pi IoT initialization... 
To verify the boot media externally, partition the disk leaving 20k at the end, and put the signature there. The signature should be over the entirety of /dev/mmcblock0 apart from that last 20k. Ralf: a read-only "mount -o ro" shouldn't touch the bytes on the card, though a block-level signature would be better. If your SD card contents is smaller than ram size you could erase the boot media by copying the entire SD card image into RAM, write zeroes over the entire device, then copy the SD card image back over minus the key - should be safe? For good measure spread the key into parts across the card.

@_date: 2017-07-07 18:33:50
@_author: Matt Johnston 
@_subject: [Cryptography] OpenSSL CSPRNG work 
Those cheap-sh*t routers could generate their SSH host keys
upon first connection. They're probably running Dropbear
which has '-R' to generate keys on-demand (added late 2013).
