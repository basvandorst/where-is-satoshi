
@_date: 2003-11-24 18:06:33
@_author: J Harper 
@_subject: Open Source Embedded SSL - Export Questions 
Hi All,
We've implemented a small version of SSL that we plan to release as open source by year's end.  I've seen some discussion on this group indicating that this would be useful in the embedded environments, given the current landscape of larger implementations such as OpenSSL (Crypto++, etc).  We developed this ourselves (using some of the crypto routines in Tom's libtomcrypt) as part of our Web services based device management software because we needed to keep our own footprint small, and I imagine there are others looking to do the same.
Once our code is released, we welcome feedback in terms of additional requirements, gotchas, etc. (and if you want to jump in now, that's fine too).  But before we can release, we need to understand the export issues (we're a US based company).  An overview of what we're developed for the first release:
SSLv3 protocol implementation
Simple ASN.1 parsing
Cipher suites:
    TLS_RSA_WITH_RC4_128_MD5
    TLS_RSA_WITH_RC4_128_SHA
    TLS_RSA_WITH_3DES_EDE_CBC_SHA
We're not looking for official legal advice, just some pointers to current online resources of how to go about registering our product in the US.  I've seen posts that for SSL implementations you "just need to send a letter to the government", but haven't come across an official government checklist and address.  We may be able to weaken the code down using the export ciphers, but I doubt end users will be interested in that level of encryption.  Plus, if we do have to limit key lengths, it seems a bit arbitrary with open source code, since users can simply change a few lines of code and have full strength crypto.  Are there any special provisions for source release (short of getting a tattoo, singing an mp3 or sending a model rocket over to Mexico - kidding, kidding)?
We'd appreciate feedback or pointers to documentation on the steps required for government registration and an approximate timeframe for the process.  On a different, but similar legal note, what current patent/trademark issues have people run across with the algorithms mentioned above?  RSA patents expired a few years ago and our ARC4 implementation is not trademarked as far as I understand (although most books on the subject seem a bit squirrelly).  Open source crypto libraries include implementations of these and other disputed algorithms including DSS and ECC, so I'm wondering how they handled the situation.
J Harper
PeerSec Networks

@_date: 2003-11-25 19:27:54
@_author: J Harper 
@_subject: Open Source Embedded SSL - Export Questions 
Thanks.  Pretty simple for open source code.  Single email to two addresses
once we have code available online.
(yes, notify is spelled wrong)
What about the patent/trademark issues?
----- Original Message -----
Sent: Tuesday, November 25, 2003 5:23 PM

@_date: 2003-11-26 14:56:40
@_author: J Harper 
@_subject: Open Source Embedded SSL - Export Questions  
Great feedback, let me elaborate.  I realize that AES is implemented in
hardware for many platforms as well.  I'll mention a bit more about our
cryptography architecture below.  Do you know why AES is so popular in
embedded?  ARC4 is faster in software and extremely small code size.  It
seems that trademark issues can be avoided and so cost should not be an
issue.  If RSA is selling RC4, I can't imagine it being very expensive due
to a widely known algorithm that generates the same bytestream.  Hasn't RC4
been milked dry yet :-) ?  Perhaps AES is easy to implement in hardware, and
doing so can reduce power requirements and offload the main processor,
although one would think that the same argument could be made for ARC4, plus
there is additional cost per device for the codec chip.  My guess is that
AES is patent free and provides better security than ARC4, which is
prompting its use:  We've designed the interface so it's easy to add new cipher suites, such as
TLS_RSA_WITH_AES_128_CBC_SHA.  We have also layered the cryptography
provider interface so it's easy to plug in specific implementations in place
of the ones we provide.  For example, if running on PocketPC, one could use
the MS Crypto implementation to reduce code size.  Alternatively, "engine"
supported algorithms in OpenSSL could be linked in for higher performance.
We are trying, however to provide the right feature set out of the box, so
AES should definitely go on the list.
The RFC above mentions that AES is an additional cipher suite for TLS.  Our
implementation initially supports only SSLv3.  We can do some testing, but
do you know whether or not it is possible to negotiate to an AES suite over
SSLv3?  My guess is no, because the RFC mentions the SHA HMAC for TLS, not
SSLv3's HMAC.
We've implemented SSLv3 because we wanted the most compatible version of SSL
that was still secure.  Adding optional TLS support would not be a big deal,
but we don't plan it for first release.
    J
----- Original Message -----
Sent: Wednesday, November 26, 2003 12:09 PM

@_date: 2003-11-26 17:40:59
@_author: J Harper 
@_subject: Open Source Embedded SSL - (AES) 
I've just taken a look.  This OCB mode for AES looks really interesting.
Encryption and MAC in one pass! Wait, OCB is patented.  That's not in
the spirit of AES :-)  I suppose one could do a user defined cipher
suite for AES OCB, if both client and server knew about it.  Anyway...
must focus on current release.
Any word on whether it's OK to use the TLS AES cipher suite with SSLv3?
-----Original Message-----
Sent: Wednesday, November 26, 2003 5:13 PM
As a separate issue from whether you want to implement AES, if you do decide to implement it look at Brian Gladman's code at It is the fastest free implementation of AES that I know of, and has a good history and credentials behind it as you can see from the background information linked from that web page.
  -- sidney

@_date: 2003-11-27 00:52:08
@_author: J Harper 
@_subject: Open Source Embedded SSL - (License and Memory) 
We're aware of these issues.  How do other people on the group feel?
We have implemented a block allocation scheme for our device Web
services product that would probably solve this issue.  Queues of
various structure sizes are held within a single chunk of memory.  This
has the nice side effect of cleaning up any leaked memory when freed.
If the demand is there we'll consider releasing the source for this as
well.  Doing an apache style per-session memory pool for SSL sessions
would be a nice way to make sure all memory was freed after each SSL
session closes.  For now we use the classic  sslMalloc malloc,
and let you swap in your own implementation if desired.
J Harper
PeerSec Networks

@_date: 2003-11-27 10:07:26
@_author: J Harper 
@_subject: Open Source Embedded SSL - (License and Memory) 
I'm familiar with the various standard licenses.  And your advice is
sound, we'll pick one that aligns with our goals for the release.  I
guess this could be viewed as a religious issue, but I'm interested in
the usage issue, especially for the small footprint space.  If Bill's
view of GPL is a common one in embedded, it is worth us taking into
account.  For us as a company releasing source, licenses with copyleft
will reduce the risk of forking and have other benefits.  The "viral"
nature of GPL in embedded, however, I think is a valid concern.  I think
Peter Gutmann's cryptlib is GPL compatible, what has been the
embedded/corporate response to it?

@_date: 2004-07-15 10:10:39
@_author: J Harper 
@_subject: Humorous anti-SSL PR 
This barely deserves mention, but is worth it for the humor:
"Information Security Expert says SSL (Secure Socket Layer) is Nothing More
Than a Condom that Just Protects the Pipe"

@_date: 2004-07-21 11:35:43
@_author: J Harper 
@_subject: Cryptography and the Open Source Security Debate 
There doesn't appear to be a discussion forum related to the Web post, so
I'll reply here.
We've gone through a similar thought process at my company.  We have a
commercial security product (MatrixSSL), but provide an open source version
for many of the good points Daniel makes.  There are a few additional
reasons that the general open-source conclusion isn't as clear cut however.
One of the benefits of having security algorithms open source is that the
code can be better trusted in terms of back doors.  So while Daniel may
trust the NSA, others may not.  Standard software typically isn't treated
with the same "positive paranoia", and therefore doesn't often have the same
requirement.  Back doors in closed source networked software, for example
can be somewhat tested for through network protocol analysis and controlled
through firewalls.  Cryptography must be trusted at an algorithm level,
since protocol analysis of the resultant data (should be) very difficult.
A larger problem with the expansion from cryptographic algorithm benefits to
open source benefits in general is one of pure code size.  The number of
lines of code of both Windows and Linux distributions is 30-40 million.  The
number of developers that 1. bother reading the code, 2. can actually
understand it, 3. have the expertise and motivation to suggest/correct
problems is a very small subset of developers for either proprietary or open
source solutions.  Developers that understand the complex interactions
between software components are even fewer.  When it comes down to it, a
very small set of people becomes trusted in whatever code area they
specialize in.  Crypto algorithms are typically on the order of 1000 lines
of code, with a large portion containing static key blocks.  Experts looking
at an open crypto algorithm require a great deal of expertise, but can also
be much more focused in their analysis.
This question is less related to the crypto specific conclusion, so I'll
keep it short.  The power of capitalism to produce competition and better
products is underestimated here.  Market pressure is growing for closed
source to become more secure, and when money is at stake, the products will
improve.  Peer review by tens of thousands of largely unpaid, untrained
developers vs. a corporation's all important shareholder value in this
increasingly security conscious market is a much more even fight than one
might expect.  This is why we have combined both sides of the debate to
produce a dual licensed product that has the security benefits of open
source, with the market responsibility of a commercial product.
J Harper
PeerSec Networks
----- Original Message ----- Sent: Tuesday, July 20, 2004 9:46 AM
is no.
majordomo at metzdowd.com

@_date: 2004-05-03 12:24:32
@_author: J Harper 
@_subject: MatrixSSL Embedded SSL/TLS 
For those of you who are interested in the coding aspects of crypto, I'd
like to announce that our small footprint SSL/TLS library, MatrixSSL is
available for download at With a footprint under 50KB, MatrixSSL not only meets device requirements,
it also provides a protocol implementation that is easy to read and
understand.  Some unique benefits for the cryptography community are:
+ Clean, clear implementation makes bugs and security issues easier to spot
and fix
+ Focused, well documented implementation of SSL is a good teaching tool
+ Open Source ensures potential backdoors and security issues can be found
+ Compact implementation of a standard security protocol removes an excuse
for homegrown solutions
I'm interested in your feedback about MatrixSSL.  We are actively working to
make sure this a unique solution that solves some of the issues preventing
adoption of standard security protocols in Internet enabled devices.
J Harper
PeerSec Networks
