
@_date: 2014-10-17 15:58:48
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Two Proposed BIPs - Bluetooth Communication 
I'd like to introduce two proposed BIPs. They are primarily focused on implementing the payment protocol using bluetooth connections. I've been working on automated point of sale devices and bluetooth communication is critical in my mind due to the potential lack of internet access at many points of sale, either due to lack of cellular internet coverage, lack of payee providing wireless internet, and/or due to financial constraints of the payer prohibiting them from maintaining a cellular internet service plan. These BIPs are largely modeled after the current functionality of Andreas Schildbach's android Bitcoin Wallet's bluetooth capability. I've discussed the communication scheme with him in depth and believe these proposals to clearly and accurately represent the communication scheme.
There is also an additional &h= parameter added to the bitcoin: URI scheme which applies to both bluetooth and http payment protocol requests which allows for a hash of the payment request to be included. This hash was proposed by Andreas as an amendment to BIP72, but others preferred not to amend BIP72 since it has already been put into place. The current version of Schildbach's bitcoin wallet already supports the "h parameter".
I'd appreciate feedback from everyone, particularly wallet developers as widespread bluetooth support among wallets is very important to me. I'm also very new to this mailing list as well as the BIP writing process, so I'd appreciate your understanding if my conventions are not standard. I am currently using the naming conventions "TBIP", so that I can propose /temporary/ BIP numbers, and cross reference between the two. Obviously these will change if the BIPs are formally adopted. You can find a copy of these proposed BIPs at the following links:
  *   * If you are interested, you can see a demonstration of many of the proposed features using Schildbach's wallet and my fuel pump in a video I recently created:  . The main thing not implemented is multiple URLs for the payment protocol, so, as a hack, I'm just presenting https vi QR code and bluetooth via NFC on my fuel pump for now.
There are a few known issues that could be improved to this bluetooth communication scheme as well as the general payment protocol and myself and Andreas would like to receive feedback regarding concerns and potential solutions. Some of the known issues are:
  * There may seem to be some inconsistency in the connection header
    messages between the payment request connection and the payment
    connection. This is largely because it is how Andreas originally
    implemented the communication and is hesitant to change it since
    there are many instances of is software already deployed that
    implement this scheme.
  * The current method uses an unauthenticated bluetooth connection for
    bluetooth 2.1 and newer devices (subject to man in the middle
    attacks, but not passive eavesdroppers), and an unsecure and
    unauthenticated connection for older devices. The known concerns
    here are that someone within 100 meters of the payer could track the
    bitcoin addresses used for the transaction and could possibly
    replace the refund address by submitting a forged payment message to
    the payee. Requiring bluetooth 2.1 and authenticating the connection
    out of band unfortunately don't seem to be as straightforward/simple
    of a task with most bluetooth libraries (although I'd love for
    someone to prove me wrong). It's possible this communication scheme
    could be extended to use an https "like" protocol that would not
    care if the underlying bluetooth connection is authenticated or
    encrypted. It's actually possible that http over a bluetooth socket
    (instead of tcp socket) could be implemented, however it is
    presently uncertain whether this would be too slow, too much
    overhead (both on the devices software and communication), or if
    http could easily be run over bluetooth sockets on all platforms.
  * There is no acknowledgement failure message possible in the payment
    protocol, only an acknowledgement message or lack of acknowledgement
    message. This issue seems to be a concern and as a result, the memo
    field is used to send an "ack" or "nack" in Schildbach's wallet. Can
    we add a boolean status field to the payment acknowledgement message?
  * I'd personally like a new optional boolean field added to the
    "PaymentDetails" portion of the "PaymentRequest" to allow for the
    payer's wallet to match the "Output" optional "amount" fields as a
    total amount of all Outputs, rather than requiring the amount for
    each output to be matched exactly. As it currently is, the payee can
    specify multiple receiving addresses in order to require a payer
    split up the payments so that when the payee then goes to spend the
    funds later, they don't necessarily have to give their payees as
    much knowledge of their balances and spending and receiving habits
    and sources. As the payment protocol currently is requiring all
    output amounts to be matched exactly for each output, there is no
    flexibility given to the payer in order to reduce a merging or
    unnecessary diverging of account funds, which can reduce the privacy
    of both the payer and the payee. If the payee were given the option
    to allow the payer the option to divide the amounts amount the
    outputs intelligently, there can be some privacy gained.
  * Amount of data stored in QR codes may be getting large when a
    backwards compatible URL is used (for wallets that don't support the
    payment protocol) and can be difficult to scan with outdoor screens
    that have an extra weather resistant pane when in direct sunlight.
  * The number of offline transactions of a wallet is limited to the
    known unspent outputs when they go offline. Long term, I'd like to
    see wallet devices that can use systems such as Kryptoradio's DVB-T
    based broadcast (but this will need yet another radio!). Another
    project may be to develop a blockchain query protocol of some kind
    where retailers can provide access to blockchain data so that
    customer's wallets can update their known unspent outputs via
    bluetooth. It's possible such a bluetooth system could be used in
    combination of "Kryptoradio" like broadcasts to provide multiple
    blockchain references.
  * The additional payment_url approach is a bit sloppy of a solution in
    the PaymentDetails portion of the PaymentRequest. It would have been
    ideal to just change this from an optional field to a repeated
    field, however, the backwards compatibility in the protocol buffer
    format will provide the last item in the array for a repeated field
    (to a code that expects it to be an optional field), rather than the
    first. Because of this, backwards compatibility with https payment
    requests wouldn't work if the payment_url field is just changed to a
    repeated field.
      o Possible alternatives to what is described in the proposed BIP
          + Change payment_url to a repeated field and then reverse the
            order of the parameter numbers in the payment_url, compared
            to the bitcoin URL "r parameter".
          + Create an additional, new payment_url_multi repeated field
            (or some better name), and then leave the original
            payment_url field in there for backwards compatibility (and
            then maybe phase it out in the future).
      o Reference
          +               # "|optional| is compatible with |repeated|. Given
                serialized data of a repeated field as input, clients
                that expect this field to be |optional| will take the
                last input value if it's a primitive type field or merge
                all input elements if it's a message type field."
Your comments and suggestions would be greatly appreciated.

@_date: 2014-10-20 11:12:08
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Two Proposed BIPs - Bluetooth 
Hello Mike,
Thanks for the feedback. I have indicated some replies below...
Andy Schroder
Whatever you all want to do here is fine with me. I am new to this process, so I have no preference. The payment_url portion is not actually part of "Bitcoin Wallet" yet though.
That's kind of what Schildbach and I were thinking so it is why we left the proposed spec defined as his app currently functions.
"Bitcoin Wallet" currently does a similar thing by submitting a payment request via NFC and skipping the bitcoin URI. This works just fine in conjunction with bitcoin: URI support. I'm not doing it this way on my fuel pump (still submitting a bitcoin: URI), because I don't think any other wallets (other than "Bitcoin Wallet" derivatives) support such a feature and because I'm not sure if signed payment requests can be transmitted over NFC well because the message may be too large when the certificate chain is included.
My point is, you can have both and if you are going to it doesn't hurt to include the h= parameter for cases when a bitcoin: URI will still be I'm not a cryptography expert, but why not just wrap the bluetooth connection with SSL and not reimplement ECDH? Is this hard to do with This sounds great, but I thought it is not desired to divulge a bitcoin public key until the time of signing a transaction. Isn't that the whole point of having a public key hash and never reusing addresses? This could be resolved by the payee immediately sending the payment to another address after receiving it, but that is kind of a waste of a transaction. Also, I would love a less PKI dependent way to authenticate a transaction between the two parties, but I was trying to minimize the discussion of general payment protocol modifications in this announcement.
We can do something like this, I guess. The issue I mentioned about the message headers being inconsistent will have to be fixed though to to do this. However, is anyone even using the HTTP base failure signal (I don't even know what it is)? What about when new protocols other than bluetooth are created? I'm just wondering if it's better to have more functionality defined at the payment protocol level so that developers have to learn less nuances about each particular protocol they are implementing the payment protocol over. The other thing is what if you want to indicate a failure, and a reason for that failure?
Understood, I was just throwing this thought out there, but do realize it is a separate discussion.
To be clear, the way I am currently implementing my fuel pump, I am specifying 4 payment addresses with no amount requirement and a h= parameter, and Schildbach's wallet does accept the payment request, but only chooses to use the first payment address (this may have something to do with the unspent outputs on my phone though). I believe Schildbach's wallet still works if multiple addresses are defined and multiple amounts, however, I'm not currently submitting payment requests this way because of the merge avoidance constraints mentioned below.
I don't trust HTTPS for a number of reasons. First off, it is way to easy to get a signed certificate with no real validation by the certificate signer. Second, the current PKI is a target for manipulation by surveillance organizations because there are too few parties involved. Third, even if you have a signed certificate that is really owned by the person they say it is, it's not easy for a payer to quickly verify the signer is really the correct one because retailers can contract out their payment process to another party, have a central office, subsidiary, or be doing business under a name that is not necessarily their legal company name. Even if we replace the PKI with something more distributed like namecoin, the third option is still going to be an issue, which warrants the need for the h= parameter.
I don't totally understand the background of what you are talking about here, but I think the h= parameter may designed to address the issues Schildbach has complying with the spec as you mention.
PKI is not in use for "Bitcoin Wallet" for providing payment request, but it is in use in my fuel dispenser that was demonstrated in the video. Actually, I should have clarified in my announcement that "Bitcoin Wallet" only allows for bluetooth incoming connections for submitting payment, not providing payment requests. Since the payment request is unsigned and small, it can just be submitted via NFC (as I have mentioned above), and bluetooth isn't really needed. Andreas does have a branch that supports this but it is not included in the master distribution branch. The primary reason he does not have this in the master branch is because the payment protocol only supports signing of payment requests via PKI, and it is difficult for a user to install a PKI signed certificate on android, just for a single peer to peer use case. I think for now he just uses that branch to test his functionality for fetching bluetooth payment requests from devices like mine (although I'm not aware of any other devices that actually exist right now).
It is a separate effort, but I was mentioning it because it is related. Your comment "Given that all interesting mobile devices have sophisticated internet access radios of various forms, I doubt it's worth putting much effort in here" makes me believe that you don't understand the need for this. If you are to provide a full fledged wifi connection to the customer, there would then have to be a very sophisticated proxy server that can allow only access to bitcoin nodes, and how to do that would be difficult since every node doesn't know all of the nodes in the network. You'd also have to be able to make the customer's phone automatically connect and disconnect from this service without leaving a saved access point name in their wifi access point list (otherwise you will have a bunch of them accumulate that you don't care about). Having dedicated blockchain access is going to be a necessity: everyone doesn't want a cellular internet plan, they can't always afford it, and it isn't always available, and as I just explained, wifi is currently a cumbersome solution to this problem.
All this was already known but was not proposed because it does not allow you to use the h= parameter. What do you propose to do instead of the h= parameter, but still allow for a trust anchor with the payee still be maintained? Another option is to do the hashing to the payment request before the payment_url is added to the payment request, however, this then can allow a hacker to change the payment_url.

@_date: 2015-02-05 18:38:17
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Two Proposed BIPs - Bluetooth 
With the recent discussion started today regarding another bluetooth communication proposal created by Airbitz, I'd like to bring people's attention back to this proposal that saw little discussion last fall. I guess I'm not sure why two proposals are being created. Is their some advantage of using bluetooth low energy over standard bluetooth (I'm not well versed in bluetooth low energy)? This NFC coupled approach seems to avoid a lot of issues with identifying the correct payee. You can see this proposed scheme demonstrated in action in a POS application in the video link below which demonstrates it with my fuel pump and Andreas Schildbach's wallet.
There was a small discussion that occurred after my original announcement below. If you are new to this e-mail list, you can find an archive of those few replies here: Since this original announcement, a few improvements have been made to the proposal:
 1. Improved documentation and explanation of the use cases in
    Schildbach's wallet's wiki
     1.  2. Issue with the payment_url field has resolved by changing to a
    repeated field and requiring the wallet to search for the protocol
    they want to use, rather than expecting it to be a certain element
    number in the list.
     1. Although there are some interesting use cases of Airbitz's proposal's work flow, tapping an NFC radio with a 5 mm range requires much less brain power and time than picking the correct name on the app's screen. The manual name picking is going to be especially crazy in a very congested location. The payer isn't ever going to want to have to try and figure out what register or payment terminal they are at for most applications I would ever use.
I'd like to see something happen with this technology. I've also noticed that micropayment channels have little formality to being established practically and it would be awesome if they could be managed over bluetooth as well. Maybe more improvements to the payment protocol can simultaneously result (and also extended to bluetooth) that embrace the establishment of micropayment channels.
Andy Schroder

@_date: 2015-02-05 20:40:32
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Two Proposed BIPs - Bluetooth 
I personally would prefer as low of range as possible for this bluetooth application considering the connection is not yet encrypted (mentioned below), and even if it were, it seems like it is always going to be better in case there is some vulnerability. From my testing with a bluetooth radio inside my metal cabinet, the range is ~5 meters, which is more than enough.
However, the connection is actually a bit slow when the whole certificate chain is included (~3-4s). You can sort of see this in my video ( A lot of the time is actually spent verifying the signature, and I'm not sure how much of it is doing the fetching (I haven't done any detailed timings using "adb logcat" and looking at the log entries), but I do know it is a little slower than an HTTPS payment request fetch over wifi (~2-3s). The reason I know most of the time is the signature verification is because an HTTPS payment request fetch over wifi and verification using breadwallet on apple is much faster (<1s) than HTTPS payment request on bitcoin wallet on android (apparently apple has a significantly more optimized signature verification algorithm). Bottom line is that there may be ~1s time transferring the data with this current bluetooth connection. Not sure how slow it will be with the BLE connection. Time is everything in a point of sale application.
So, I guess what I am saying is it seems like the lower speed and range gain with bluetooth low energy are not a benefit in my opinion. I'm not sure that the latency gain will be a benefit either unless the speed issues I am noticing with regular bluetooth are actually a latency issue with just getting the connection established, or actually transmitting the payment request data. How much power is going to be used for just a few second payment? It's not like the bluetooth connection is maintained for a long time like it may be in other non bitcoin use cases.
Where is a more appropriate place to discuss the other issues you have at length?
Andy Schroder

@_date: 2015-02-22 17:37:16
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
Hello Jan,
Regarding a few of your questions:
Andreas and I had a number of private discussions regarding the payment_url parameter. I had suggested a "additional_payment_urls" repeated parameter, but he didn't seem to like that idea and I personally am indifferent, so that is why we decided to just change payment_url to a repeated field. The spec is simpler without the "additional_payment_urls", but the wallets have to be a little bit smarter finding the right url they want to use in the list. It's maybe not a bad idea for the wallet to try all payment_url mechanisms in parallel. Should we add this as a recommendation to wallets in TBIP75?
I had heard from Andreas a few weeks ago that the multiple r parameters was not yet implemented. Maybe your interest can motivate him to do so!
I actually also happen to be using nfcpy. I am having some reliability issues as well with it. What exactly are your problems?
I have seen your video before. I guess I'm wondering how your prototype works with bitpay and bluetooth. Doesn't bitpay sign the payment request for you with an https based payment_url? If so, how do you add the bluetooth payment_url while keeping their signature valid? In your video it looks like the phone still has cellular and wifi reception (it is not You mention workflow options 1,2,3. You forgot to mention that options 1,2 are not backwards compatible with older wallets.
Regarding the NFC data formats. I would like to clarify that the wallets are having those events dispatched by the android OS. The "URI" and "mime type" events are sent to the application in the same way as from other sources such as a web browser, e-mail, stand alone QR code scanner app, etc.. So, I don't think the wallet actually knows it is receiving the event from NFC. That is one reason why so many existing wallets happen to support BIP21 payment request via NFC. Andreas can correct me if I am wrong on these statements. I'm a little weary sending the "mime type" based format over NFC because of backwards compatibility and because of the long certificate chain that needs to be transferred. You want that tap to be as robust and fast as possible. A bluetooth connection can have a retry without any user interaction.
I don't really understand why Mike Hearn has the objections to the h parameter. It seems like you should already be ready to produce the BIP70 payment request at the time when the URI is generated. I'd also like to clarify that the h parameter is for more than just unsigned payment requests. You can have a signed payment request with the wrong signer. There is way to much brainpower required to verify that the signer is actually the merchant you are doing business with. Just think how many times you shop at a store that you don't even know the name of. Also, the store may contract their payment processing out to another party, or they may have multiple store names but use the same payment processing system for all their stores, and the parent company has a different name. It's good to have both the h parameter AND the signed payment request.
I don't really like the Airbitz proposal. Figuring out if your selecting is the right one is a real nuisance. The idea is neat in a few applications, but I just don't think it is going to work for people as the most efficient and trouble free option day to day. I realize they are probably doing it to work with Apple's limited functionality phones (and BLE is a new buzz word). However, I don't think we should base bitcoin around what Apple wants us to do. They've already had their war on bitcoin. They are going to do whatever they can to protect their NFC based payment system. We need to make their platform the the less desirable one if they are going to play the game that way. If that means an Airbitz like proposal is implemented as a fallback, maybe that is fine and POS systems need to support both, but I just don't think we should limit what we can do because of Apple's products capabilities.
There is also the "ack" memo that I mentioned in reference [2]. I think we can improve upon this really. Can we make a new status field or different bluetooth message header? I know Andreas didn't want to change it because that is how his app already works, but I don't think the way it is is ideal.
I'd like to see some discussion too about securing the bluetooth connection. Right now it is possible for an eavesdropper to monitor the data transferred. I'd personally like to see if wrapping the current connection with SSL works or if we can run https over a bluetooth socket. There was some criticism of this, but I don't think it has been tested to know if it is really a problem or not. If we just run https over bluetooth, then a lot of my concerns about the message header inconsistencies will go away and the connection will also be secure. We don't have to reinvent anything.
Andy Schroder

@_date: 2015-02-22 18:32:05
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
Andy Schroder
I guess we need to decide whether we want to consider NFC communication private or not. I don't know that I think it can be. An eavesdropper can place a tiny snooping device near and read the communication. If it is just passive, then the merchant/operator won't realize it's there. So, I don't know if I like your idea (mentioned in your other reply) of putting the session key in the URL is a good idea?

@_date: 2015-02-22 18:35:07
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
Andy Schroder
As I mentioned in my other e-mail, I don't know that we can consider this NFC a private channel, so I don't think a session key should be transmitted over it.
The order is set so that it maintains backwards compatibility by providing the https request first. As mentioned in the proposal, the order of the r parameters has the recommended (but not required) priority. The wallet is encouraged to use the same protocol (but not

@_date: 2015-02-23 02:36:36
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
I agree that NFC is the best we have as far as a trust anchor that you are paying the right person. The thing I am worried about is the privacy loss that could happen if there is someone passively monitoring the connection. So, in response to some of your comments below and also in response to some of Eric Voskuil's comments in another recent e-mail:
Consider some cases:
If NFC is assumed private, then sending the session key over the NFC connection gives the payer and the payee assumed confidence that that a private bluetooth connection can be created.
If the NFC actually isn't private, then by sending the session key over it means the bluetooth connection is not private. An eavesdropper can listen to all communication and possibly modify the communication, but the payer and payee won't necessarily know if eavesdropping occurs unless communication is also modified (which could be difficult to do for a really low range communication).
If we send a public key of the payee over the NFC connection (in place of a session key) and the NFC connection is assumed trusted (and is unmodified but actually monitored by an eavesdropper) and use that public key received via NFC to encrypt a session key and send it back via bluetooth, to then initiate an encrypted bluetooth connection using that session key for the remaining communication, then the payee still receives payment as expected and the payer sends the payment they expected, and the eavesdropper doesn't see anything.
If we send a public key of the payee over the NFC connection (in place of a session key) and the NFC connection is assumed trusted (and is actually modified by an eavesdropper) and use that public key received via NFC to encrypt a session key and send it back via bluetooth, to then initiate an encrypted bluetooth connection using that session key for the remaining communication, then the payee receives no payment and the attack is quickly identified because the customer receives no product for their payment and they notify the payee, and hopefully the problem remedied and no further customers are affected. The privacy loss will be significantly reduced and the motive for such attacks will be reduced. It's possible a really sophisticated modification could be done where the attacker encrypts and decrypts the communication and then relays to each party (without them knowing or any glitches detected), but I guess I'm not sure how easy that would be on such a close proximity device?
Erick Voskuil mentioned this same problem would even occur if you had a hardwired connection to the payment terminal and those wires were compromised. I guess I still think what I am saying would be better in that case. There is also more obvious physical tampering required to mess with wires.
I'm not sure if there is any trust anchor required of the payer by the payee, is there? Eric also mentioned a need for this. Why does the payer care who they are as long as they get a payment received? Just to avoid a sophisticated modification" that I mention above? I can see how this could be the case for a longer range communication (like over the internet), but I'm not convinced it will be easy on really short ranges? It's almost like the attacker would be better off to just replace the entire POS internals than mess with an attack like that, in which case everything we could do locally (other than the payment request signing using PKI), is useless.
I'm not a cryptography expert so I apologize if there is something rudimentary that I am missing here.
Andy Schroder

@_date: 2015-02-24 00:53:30
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
I was saying provide a public key via NFC (or a public key fingerprint and then send the full public key over bluetooth). Instead of providing a new public key on each tap, why can't the payee just stop accepting connections from new parties on that "resource" after a session key has been received from the first person? If the person decides to have there friend or family pay for them instead and cancel the payment, they could just hit cancel on the POS or something (on my fuel pump I have a switch that needs to be turned, the purpose of this is to avoid wasting too many addresses) and/or do another NFC tap (if you're providing QR codes you'd still need a button of some kind though so it knows to refresh it), or the POS can just provide a completely new payment request to any new connections on that same "resource" which use a different session key.
I feel like the authentication of the payer to the payee in any future connections after they receive the session key from them (which was encrypted with the payees public key), comes from the fact that they are sending responses back that are encrypted using the session key they gave to the payee. The way I am seeing it is that the NFC tap or QR code scan is acting in addition to the visual name check on the signature verification in the wallet. If the certificate used isn't signed by a CA (self signed), it may be fine as long as you heard about it via NFC or QR code. I don't think it will require PKI and should still work It sounds like you are saying I'm proposing the customer is going to need a certificate signed by CA? If so, why? I don't need this for any https website I visit. It's not like the payee is sending anything to the payer that is private. The payment request only becomes private if something is actually received to it, otherwise, it is just discarded and it doesn't matter. Those bitcoin addresses are never used. It's just like a shopping cart on a website where someone aborts payment and cancels the order.
At one point I was thinking we could do something similar to Mike Hearn's suggestion in another recent e-mail where we re-use some existing part of the bitcoin URI to bootstrap some trust in a public key that the payee next sends via bluetooth after the NFC connection. Now that I'm reviewing my notes though, I can't see how this will work with a watching only wallet or if no backwards compatible (to BIP21) bitcoin address is presented in the URI (as Mike said).
What I was saying above about how you can stop accepting connections on that "resource" after a session key has been received by the first person could be problematic though. An evil person could just start making connections to every device they can, just to be mean, which would not allow the POS operator to receive payments from their real customers. If you do the other option I proposed, which is to just keep giving out new payment requests, you have other problems (on top of wasting addresses), which are that you can still have mean people giving you a denial of service attach on your hardware, or you could have an unusual situation where two people pay (don't know why they would do this though), so that is why I'm suggesting a manual tap or button press or switch turn being required.
I guess as more of a abuse filter, a new "resource" could be given instead with each tap, and the POS would just ignore all requests to an inactive resource. You may say, why not send a new public key (as you suggested) instead of a new "resource" with each tap (or button press if using QR codes), and then you can skip the sending of a static public key (or public key fingerprint), and ignore any data that is not encrypted with that public key. Maybe that is a better idea because it will shorten the bitcoin URI. However, I don't think its required from a privacy standpoint, it primarily just aids in combining the public key fingerprint with the changing "resource" name used to filter abuse. Or, am I missing something?
So, after thinking through the abuse scenarios I mentioned above, I think I am agreeing with you, but the reason I'm writing all this is to hopefully just get some feedback on my logic to learn something from this discussion. I do think sending a unique public key over NFC has to be better than a unique session key. It adds one more step, but seems to help. If we do this, can we then safely get rid of the h= parameter? That should make Mike Hearn happy, and also may alleviate the base64url Andy Schroder

@_date: 2015-02-24 01:14:43
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
Andy Schroder
I've had similar issues where the NFC device has to be disconnected and reconnected. I've got lots of error checking in my code on the NFC device, which helps, but still has problems sometimes. I've found if I limit how quickly a new connection can be made, that reduces the problem. Have you tried this?
What command line tool are you using with libnfc?
This sounds weird to me. Why are you even using bitpay at all if you are already going through the effort to remove a signature and change the memo field? Wouldn't it be better to just manage everything yourself?
I'm personally not to annoyed by the enable bluetooth popup. I do know what you mean about the "bluetooth is insecure, I should disable it" attitude. I used to have this same concern.
Well, with the multiple r parameters, they should also be able to do this on the payment request too.
I'm personally very weary of more permissions. Have you checked out how many unnecessary permissions a lot of bitcoin wallets have? Many of them are ridiculous. Although this one may be somewhat warranted, I wouldn't encourage it if they can just fall back to cellular if they don't want to use bluetooth. If they don't have cellular reception, they can go through the effort of pressing the enable button that pops up.

@_date: 2015-02-24 17:50:46
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
We can change "resource" to "Session ID" if you want.
I think the URL scheme should be:
But when connecting to the mac, the client indicates the SessionID in the header, and as you say, SessionID is derived in some way from PublicKey.
This is a slightly different format than both of your suggestions below, but seems to make more sense based on what you said in your entire message. The other thing is it can be used with more protocols without taking up more space in the URL.
However, by loosing the h= parameter, I think we are now loosing some benefit it brought to https based connections if the customer doesn't want to use bluetooth. Right?
Also, you talk about a new public key (and session ID) for each tap. I guess I'm wondering about this though. If the public key is compromised on the first tap, isn't their payment request already compromised?
Since we are securing everything, can we change the message header format from what Schildbach's bitcoin wallet implements to something more consistent? Maybe we can create a new UUID for this secure service so Schildbach's bitcoin wallet can still maintain backwards compatibility.
Andy Schroder

@_date: 2015-02-24 14:49:14
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
I think were talking about a lot of the same things. There is one key piece of information that I was not thinking about until you made it clear. Why the payee needs to identify the payer. In my fuel pump application, they really don't, so I wasn't thinking closely about these other situations. With my fuel pump, it won't even let you do anything until you sign a transaction and submit it. So, the payment request contains no personal information, it's just a request for payment, and not for anything specific. It doesn't know or care what you are going to buy until you make a prepayment, because there is no use in trying to start doing business without a signed transaction. This approach minimizes risk because once you dispense a fuel, or anything else, it's not like you can easily give it back if you happened to not have any funds. It also makes it a higher chance for a confirmation before the customer leaves. Other transactions have similar post payment traditions, like a restaurant (not fast food), where the seller doesn't know if you actually have enough money until you've already consumed the food, but this work flow seems to be a culturally driven one rather than risk driven.
In the discussion about an https website, there are many websites where no login or authentication by the client required to have a private connection. With a shopping website though, the customer can identify themselves without logging in by saying (in band) what they are intending to buy after the private connection has been established. At a cash register in person the items being purchased have no tie to the customer. The items being purchased were communicated to the seller out of band (in real life) and insecurely to establish that link. You are trying to make a tie between that list of items and the buyer separately, and that is why some unique identifier needs to be transmitted via NFC.
Stepping a bit back: I guess I'm wondering if it would be useful to encourage an opposite work flow where a micro payment channel is setup for most purchases. For example, if I go to the grocery store, it usually takes a minute or so to check out. If I immediately tap and open up a payment channel with the store when I start checkout, rather than finish, there can be more network propagation of that transaction while they are scanning all the items. They'll see the channel is open and start adding all the items I want to buy to that micro payment channel. I'm identified because I made a payment, not because I've transmitted a unique resource or used a unique public key to encrypt communication. A payment terminal would not allow for new payment channels to be open until the currently active one is closed. If I don't have enough funds left in the payment channel, they just stop scanning items. There may be some additional privacy implications of setting up micro payment channels all the time for everyday purchases. It also may not work for every sales case, so we may still need some way to authenticate the payer with a unique identifier. So, maybe we don't want to do this, but it is just a thought to consider.
So, unless someone thinks what I am proposing in my previous paragraph has any potential (as a complete solution, not a complement to solutions), the plan is the following:
  * Get rid of the "h=" parameter
  * Add a "s=" parameter that uses a unique public key for each session.
    This public key identifies the payee to the payer and payer to the
    payee.
  * Use a base58 encoding to save space and reduce the character set
    slightly.
  * Get rid of the resource? If a terminal is accepting payment from
    multiple customers simultaneously, it should be smart enough to
    distinguish between customers based on the public key they are
    encrypting the data with. Is this approach feasible?
  * When you said a new public key for each tap, do you see that as
    every single tap, or do you consider multiple taps from the same
    customer the same tap?
Andy Schroder

@_date: 2015-02-28 04:46:15
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Bitcoin at POS using BIP70, 
============================== START ==============================
Manually quoting a reply from Andreas that was sent privately while the e-mail list was 2 days delayed delivering messages ....
This bs: is not a bad idea. Is bts: any better/clearer than bs:?
I'm going to agree with Andreas on this. The other thing is we are making the resource name derived from the public key, so we are not even directly sending the resource name.
We are planning to send a unique public key of the payee via NFC. See other e-mails now that the e-mail list finally forwarded them through the other day.
Now for Eric's e-mail... More below.
See my comments above.
This may be true. Andreas, do you agree? I feel like there was something in your app where it did not currently compare the domain name to domain name the digital signature in the payment request used though. Maybe this was only for bluetooth though? However, can we trust DNS though? Seems like it is not too hard to get an alternate signed certificate for a domain name, and if you can serve false DNS and/or change TCP/IP routing, then your secure link can break down?
I get what you are saying, but I don't know that 2 taps with the same public key is the same as 1000 uses of the same public key?
If you'll check the proposed specification, the headers in each message (before the serialized payment request data is sent), are consistent from message to message.
I think we probably also want to combine new UUID's with Schildbach's suggestion (above) to use a new "bs:" (which I suggested maybe "bts:") protocol scheme.

@_date: 2015-06-10 12:46:49
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
Regarding changing the e-mail list provider. Is anyone interested in sponsoring it? There are non-free options, but it may be difficult to always ensure the fee is being paid to the provider. I think finding an agreeable free solution may have been the issue before? I've also thought of trying to make a pay per message or byte solution (and this cost could be dynamic based upon the number of current mailing list subscribers). This could solve the who pays problem (the sender pays), as well as motivate people to be more concise and clear with their messages, and at the same time limit spam.
Any thoughts?
Andy Schroder

@_date: 2015-06-10 14:41:32
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
Hello Troy,
I like the idea of the live mirrors. I'm personally just an amateur at setting up e-mail servers, but the first concern I have is that everyone hosting a mirror may not necessarily use the same SMTP MTA. I personally use postfix, but I'm not sure what most people use.
Some other features I'd like to see required is PGP/MIME support and ensuring that digital signatures are not broken by footers, etc. appended to the bottom of the message by the list. It might be nice to also allow for HTML messages?
Here is a link with some current statistics to get an idea what the load may be. I've been told there are about 1,200 subscribers. Andy Schroder

@_date: 2015-06-10 14:59:48
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
A couple of motivations for a mailing list switch:
 1. Sometimes the mailing list delays delivery for 10 minutes to several
    days.
 2. There are usually lots of ads at the footer of the messages. Really
    confuses new readers (for me at least), and seems like it really
    pollutes such a historical dialog that may be referenced long into
    the future. How would it be if the 10 Commandments, Magna Carta,
    Bill of Rights, The Sermon on the Mount, or The Gettysburg Address
    had ads intertwined within them?
 3. Don't think HTML messages are allowed.
 4. Seems like digital signatures are always broken on messages because
    the list server slightly modifies them (?), so my e-mail client
    doesn't verify them all.
Andy Schroder

@_date: 2015-06-10 15:12:02
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
Andy Schroder
I think they are usually PGP/MIME signatures that are not working right. If you'll notice from my e-mail headers:
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20100101 Thunderbird/24.2.0
X-Enigmail-Version: 1.6

@_date: 2015-06-10 15:36:42
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
Andy Schroder
It's possible that the enigmail extension is not working right, but I was under the impression that it is just feeding data to gpg and then receiving the response back. It's possible that your e-mail you just checked was not sent through mailman since I also replied directly to you explicitly (in which case the message has not been modified) and you probably have the setting in the mailing list set to not send duplicate messages if you are an explicit TO. I just deleted all explicit TOs for this message, so everyone should be receiving it through the mailing list and not directly. Is the signature still valid for you now? I think enigmail can handle messages with some signed and unsigned content, and maybe PGP/MIME inherently does not support this and a mailing list re-writing parts of messages is an expected action? If this message re-writing is an expected action and I'm correct that PGP/MIME does not support partially signed content, then maybe it is just a recommendation for this mailing list to not use PGP/MIME for messages sent to the list?
Can anyone else confirm?

@_date: 2015-06-10 16:03:57
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Is SourceForge still trustworthy enough 
Thanks for testing this clarifying things about PGP/MIME and I apologize for wasting your time with it. It looks like a SPAM filtering service I use is re-writing some parts of some plain text messages with some special/alternate encoding characters (not sure what it really is). Anyway, if I manually export/import a message from gmane (bypassing my e-mail SPAM filter), thunderbird/enigmail is not having problems verifying signatures. I guess I never realized this before because all other signed messages I normally receive are encrypted and the SPAM filter does not mess with non plain text data.
Andy Schroder

@_date: 2015-06-14 16:55:48
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Proposal: Move Bitcoin Dev List to a 
I'd support moving to a Linux Foundation e-mail list. I am also against google groups. I agree that the gesture of moving indicates that SourceForge is not playing nice on other issues and that moving this list shows their behavior is being acknowledged.
I understand your reason for wanting to delete the Source Forge account (after reading the links). However, the only problem with that is that the SourceForge archive is the oldest one I've found with some early messages from Satoshi. Myself finding Bitcoin after its inception, as well as this mailing list even later on, it's nice to be able to review the archives. SourceForge's interface to those archives is pretty bad though. I'm not sure if there is any way to get older messages archived on sites like gmane or mail-archive? Does anyone know? You mentioned importing the list archive as part of the migration plan, but I guess is this easy to do from SourceForge?
Andy Schroder

@_date: 2015-06-15 01:50:16
@_author: Andy Schroder 
@_subject: [Bitcoin-development] Proposal: Move Bitcoin Dev List to a 
Andy Schroder
I'd say just move forward with creating the new list. Once the new list is created, send an announcement encouraging people to join. The new list will be an opt in change, so you can encourage a transition date, but why require it? Maybe monitor the subscriber lists for each list and provide people regular updates as to what percentage of the people in the old list have subscribed to the new list. This will help inform people whether the new list will be adopted or not. People may also miss a single announcement e-mail. There are too many messages going through the list right now, and everyone doesn't read the list regularly.
I vote for "bitcoin-dev", only because of the consistency with the other projects that you mentioned, as well as the fact that I think there should be at least some name change to avoid confusion between the new and old lists.
I'd say move forward with the new list and subscribe it to the old list. That way the new list starts archiving the messages from here forward. There may be a little bit of a problem if someone joins the new list but not the old list, they may not be able to reply to a message sent to the old list? You probably would get a duplicate delivery if doing this, but you could encourage users who have joined the new list to turn off delivery on the old list (this is an option in the mailman settings page).
Once greater than 50% of the members of the old list are members of the new list, send out an announcement that the old list will be turned into read only mode in 3 weeks and to use the new list only after that time. This way you don't have to force use of the new list and a majority agreement is required before doing so and a technical leader is not required to enforce a change without a solid commitment from most of the members. Right before the old list is shut down, send one final announcement e-mail indicating it is closing and link to the new list (so that new subscribers will be aware if they are looking at an archive of some kind).

@_date: 2015-06-23 14:45:01
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Welcome to the new Bitcoin Dev List 
I'm not sure if anyone has submitted a request for gmane to monitor and archive this new list, but I did. Maybe it's not best for many people to re-request that? For those who aren't aware, gmane has a nice HTTP/HTML archive as well as a newsgroup proxy that is also very nice for reading the archive. They'll also subscribe the list to mail-archive.com for you.
I've also noticed that gmane ( does not have exactly the same archive for the old bitcoin-development list ( It's missing a few months at the beginning. The new list archive does contain the same thing as the old list gmane has an option to import old archives, so I'm seeing if they can do that with the  list, since it is complete. In order to avoid confusion on what list is the most complete, if they can, I may request them delete or rename their old, incomplete archive at  . It's possible they could even make this new list use that same name after deleting or renaming that old archive.
There is also bitcoin-list ( I think that one may be discontinued? That list appears to be older and contains some of Satoshi's original e-mails. On gmane though ( it is missing the first few years of archives. Do we want to try and preserve this historical correspondence on any way before sourceforce disappears?
Regarding message footers and the subject prefix of [bitcoin-dev], it would be cool if mailman allowed people to change this on a per-user basis.
Andy Schroder

@_date: 2015-06-28 21:45:09
@_author: Andy Schroder 
@_subject: [bitcoin-dev] A Proposed Compromise to the Block Size Limit 
Regarding privacy and the lightening network. Has this been well addressed? I haven't seen much that leads me to believe there is. Only options I see are to have many open payment channels, but that is still limiting and inefficient, or require an extensive number of hops in your payment route, but this is also limiting.
Andy Schroder

@_date: 2015-06-28 21:45:57
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Tree Chains 
I haven't heard anything about Peter Todd's tree chain idea ( in a while. Is there some reason it has dropped from discussion? Was there some major flaw discovered? It seemed like it would be an additional technology actively discussed as an alternative to raising the block size.

@_date: 2015-06-28 21:49:38
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Mailing List Administrivia - GPG, Archives, 
Although I'd say your writing style is a bit unfriendly and hard to identify/unclear at the specifics of some of your complaints, I do agree with many of your points.
I really have no idea what format the .txt.gz files are in that are on the current archive. If you unzip them, they are not text tiles.
gmane was able to change the subscription of the previous list to the current list. So, anyone who had a newsreader setup, it should be working again. There is some gap in their archive at the beginning of the archive, as well as last week while the list was transitioned. They requested a link to a single mbox file archive that they can use to restore the list archive in it's entirety. Anyone know how we can get this? The reference to another mailing list below ( has such a link on its archive page. It looks like the same interface so maybe that feature can just be turned on? I'm not sure if it gzips the mbox file on the fly whenever an http request is made or if it has some schedule and may be missing a few of the most recent messages?
Also, regarding the footer, if it can't be changed on a per user basis, I'd vote to get rid of it. Anyone with a reasonably powered brain can go to lists.linuxfoundation.org and find a way to get to the bitcoin-dev mailing list page. The information provided in the footer is also included in the email message headers as well. It's also included in the welcome e-mail when someone subscribes to the list.
Andy Schroder

@_date: 2016-08-08 13:09:45
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Authentication BIP 
I have mixed feelings about strictly tying the identity-public-keys with a network identifier. I think the purpose of this is to detect if someone has physically stolen and compromised my bitcoin node and placed it on another network under control of an attacker. This seems to be a bit of a benefit, however, an attacker could always spoof the original network identifier anyway.
I run my bitcoin node on an internet connection that does not guarantee a static IP address (although it usually stays the same for several weeks or months at a time). I'd like to be able to make secure connections back to my own node, even if I know the IP address may change from time to time. There are several reasons for wanting to this with a changing IP. The first is because the bandwidth on my internet connection with a guaranteed static IP address is considerably more expensive than my internet connection without a guaranteed static IP address. The second reason is because the DNS PTR record for my static IP address is personally identifiable based on other reasons/services. The internet connection that my bitcoin node is using without a guaranteed static IP address just has a PTR record that basically includes my IP address and ISP name. This isn't much use to the general public (although my ISP obviously knows who I am). The third reason is that I consider it a good thing from a privacy perspective if my IP address changes every once and a while.
Maybe a strict check option where the identity-public-keys must optionally match a specific network identifier would be a compromise? Maybe this is up to the client implementation to decide, so it should just be suggested in the BIP rather than required?
Is there an option for a wildcard here? Couldn't there be a case where the client wants to authenticate, but the bitcoin node does not care who it's clients are? This would be similar to many of the http based bitcoin block explorer API services that are out there. The API operators have built up some reputation, so people use them, but they don't necessarily care about who their users are.
What if I have bitcoind listening on multiple IPv4 interfaces? Can I have a different identity-key for each IPv4 interface?
Also, would it be possible to only allow this authentication on specific interfaces? In my example above where I have two internet connections, if you don't agree to loosening the tie between the network identifier and the identity-public-keys, maybe I would just connect my bitcoin node to both internet connections, but only allow a few authorized-peers on the static IP (which would be low bandwidth), and then not authenticate on the internet connection with the changing IP at all
If you don't want to increase complexity by adding these options, one could always accomplish the same thing by runing two instances of bitcoind and pairing the two over a local network, it would just be a waste of resources.
Does openssh have this same problem?
I'm assuming this could be parallelized very easily, so it is not a huge

@_date: 2016-08-08 13:54:53
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Authentication BIP 
Okay, that may be fine. You are saying otherwise you'd have to do a trial and error and this tying to a network identifier just speeds things up? If the DNS is spoofed, it's no big deal because the authentication will fail anyway?
Good point.
Simple enough.
So you are saying that you agree with me that the original text needs to be revised slightly or I am just misinterpreting the original text?

@_date: 2016-06-21 15:50:59
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Even more proposed BIP extensions to BIP 0070 
Bluetooth exchange of payment requests already has a noticeable lag with protocol buffers, so that would be another reason to argue against JSON, because JSON is less efficient size wise, correct? I will say that although protocol buffers have good platform support, I don't know that the documentation for each platform is very good. This is the main drawback I see with them. One additional advantage of protocol buffers is that the .proto file is a specification, whereas with JSON, you'd just have an example file, right?
Isn't keybase a centralized infrastructure? Are you against a blockchain based identification? There are a few out there. There is some confusion because onename's efforts are breaking away from namecoin though.
I like the idea of PGP signatures of payment requests. This allows for manual verification (in my mind, the highest quality) of key authenticity (or, with PGP you also have the option to opt into some centralized service for key verification). This can be useful when dealing with semi-manually issued invoices for goods and services. The local bitcoin wallet could just interact with the local PGP keyring. Although, one can already just send the payment request in a PGP signed e-mail, so I'm not sure if PGP signing is really needed if you're using PGP email. The main benefit may just be consolidating/itemizing into your bitcoin wallet's transaction history whether the payment destination/request was securely received or not. It may also be useful for someone to be able to extract a signed payment request from a signed PGP e-mail and send it to someone else to make a payment for you (maybe you don't want your accounting person to need your entire e-mail correspondence with a supplier to be able to just verify the payment request and make a payment for your company).
I'm concerned about extending the URI scheme too much. Isn't this going to reach the practical size limit of NFC and QR codes pretty quickly?
Andy Schroder

@_date: 2016-06-22 11:12:04
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Even more proposed BIP extensions to BIP 0070 
I disagree with your statements. There are many face to face use cases where the payment protocol is essential. Pretty much anything where the payee's hardware device that the payer interacts with is automated in public and/or operated or accessible by untrusted employees. In any of those cases the software on the payee's hardware device can be modified. Providing a signed payment request gives the payer additional confidence that they are paying the correct person.
See some examples here: There was a secure bluetooth protocol that Andreas Schildbach and Eric Voskuil and I were working on, but we never pulled it all the way together. This would also need a two way exchange for a face to face payment. This could be used without using some sort of key/certificate verification service if being done between two humans who are the direct senders and receivers of the payment and are using hardware that they personally own (not necessarily the case of untrusted employees or public vulnerable machines).
Did you not see my previous message about the size of the bitcoin: URI getting too big for NFC and QR codes? Do you not care about giving the payer the option of using multiple destination payment addresses? This is important for many reasons.
So, are you saying first the payer should send an unsigned transaction for review, and then once the payee has agreed it's good, they can send an ACK message back and then wait for the signed version? I don't think this is a bad option to have. Many wallets simultaneously broadcast a signed transaction to their peers and and also back to the payee via https or bluetooth. So, you'd have to add another step to do the unsigned transaction review in order to avoid a transaction being accidentally broadcast that both parties don't like.
Again, my comments above about issues with using bitcoin: URI for everything. Also, why do you want to bloat the blockchain with unnecessary refund transaction data?

@_date: 2016-06-22 12:20:38
@_author: Andy Schroder 
@_subject: [bitcoin-dev] Even more proposed BIP extensions to BIP 0070 
I understand the need for people to make repeated payments to individuals in real life that they know, without the payee every even taking the effort to make a formal payment request (say you're just paying a family member of friend back for picking something up for you at the store, and you've already payed them many times before).
For a subscription, wouldn't it be better to promote payment channels or just send another payment request? I've been brainstorming recently about a model where service providers could deliver invoices, receipts, and payment requests in a standardized and secure way. In addition to having a send, receive, and transaction history tab in your bitcoin wallet, you'd also have an open payment channels tab (which would include all applications on your computer that have an open real time payment channel, such as a wifi access point, web browser, voip provider, etc.), as well as a "bills to pay" tab. Since everything would be automated and consolidated locally, you wouldn't have to deal with logging into a million different websites to get the bills and then pay them. If it were this easy, why would you ever want to do a recurring payment from a single payment request? I understand why you may think you want to given current work flows, but I'm wondering if it may be better to just skip over to a completely better way of doing things.
Andy Schroder

@_date: 2020-07-21 01:25:44
@_author: Andy Schroder 
@_subject: [bitcoin-dev] The Cryptographic Relay: An Electrical Device For 
See multiple places below
Andy Schroder
, at constant pressure
Or, at constant temperature, higher entropy areas have lower pressure and lower entropy areas have higher pressure. See the background contour of the figure on the bottom left here for an example with carbon dioxide:
Don't know why I never thought of it this way!
Not necessarily "much larger". For example, a good geothermal heat pump has a COP greater than 8. That means 8 units of heat are removed for 1 unit of work input. That means that the total heat emitted by the refrigerator is only (1-(8+1)/8) = 12.5% higher than the heat it removes from inside the refrigerator.
and it's temperature does not begin to rise over time.
However, the entropy inside a chamber can still decrease if the pressure goes up and heat is allowed to conduct away as the temperature tries to go up. This however, also results in more work being input into the refrigerator, which means it still consumes energy. Also, if you are okay with the temperature inside a chamber going up (instead of down), you can consume energy and compress it adiabatically and the pressure will rise and so will the entropy rise.
Blocks freeze the transactions in place!
Or, blocks compress transactions in place.
Very interesting thought!
And you are saying below that risk can be mitigated if manufactures working very hard to build up enough market share that there is enough auditing of their devices that appear to be honestly manufactured?
I would just keep it simple and stick with simple standards for transistors and then let the user choose many of the parameters their own by supplying their own electro mechanical relay. Most I/O devices have a transistor in them, then you need a booster transistor to add on it to it to get enough current in order to actually drive a relay coil. This is more complicated for the end user, but gives them more flexibility.
This is true, but if the devices is complicated and interconnected enough, the cost to hot-wire may outweigh the gains of stealing the device. For example, in an electric car, the battery pack, inverter, motor, charge controller, media computer, autopilot computer, bluetooth radio, cellular radio, FM radio, A/C compressor controller, drivetrain coolant system controller, charge port controller, anti-lock brake controller, power window motors, door locks, ignition, etc. all were locked together, it could become prohibitively expensive to hot wire given all those components would need to be removed from the vehicle and a specific chip removed (which likely will be embedded). And, it's trivial to "bake in" the "cryptographic relays" into every component during the initial manufacturing process. So, the transfer of ownership could need to by performed on all components simultaneously in order to successfully sell/trade the vehicle in order for this transfer to be really effective.
