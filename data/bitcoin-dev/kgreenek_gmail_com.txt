
@_date: 2014-04-27 00:53:25
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Error handling in payment protocol 
Keep in mind that links don't always come embedded in html. Think of native
mobile apps.

@_date: 2014-02-11 02:00:53
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Extension for BIP-0070 to support 
Figured I would have a crack at reviewing this since Mike is out for a bit.
It was great running into you guys at the bitcoin fair in SF! Small world :)
I like how simple this is. You just give it an url to fetch the next
payment request and a date to fetch it.
What should happen if the client tries to fetch the PaymentRequest early or
late? Does it become valid after some date and stay valid for some length
of time? Also, what should happen if the client tries to consume the same
PaymentRequest twice (or multiple times) during the same period?
I do not think daily/weekly/monthly is flexible enough. What do you think
about having a concrete start time and end time when the next
PaymentRequest will be valid? This also prevents the wallet from having to
remember when it last sent a payment and getting skewed over time.
When a wallet hits the polling_url to download the next PaymentRequest, it
seems we need a way to communicate an error code to the wallet, for example
if the server canceled the contract without the wallet knowing. Perhaps a
separate polling_status_url, with a corresponding ACK message to indicate
if the PaymentRequest is available. What do you think of that idea?
One high-level comment -- the wallet in this design doesn't have any way of
knowing when the payments are supposed to end. I feel this is important to
show to the user before they start their wallet polling infinitely.

@_date: 2014-02-11 22:37:00
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Extension for BIP-0070 to support 
Sending this again and truncating since apparently the message body was too
Thanks for humoring my questions!
However i am not clear why we would a separate url for that?
Hmm, thinking about this more, adding a simple status_code in
PaymentRequest would be a much easier way to achieve this. However,
continuing to think about this even more, maybe the simple memo field along
with an empty set of outputs is enough already.
In bitcoinj, right now the code will throw a
PaymentRequestException.InvalidOutputs exception if the set of outputs is
empty with a message of "No Outputs". Because of that, there isn't a good
way to tell the difference between a payment request that had no outputs
and a payment request that had some invalid output(s).
*Question to everyone:*
How does bitcoin-qt handle a PaymentRequest with no outputs?

@_date: 2014-02-11 22:32:18
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Extension for BIP-0070 to support 
Thanks for humoring my questions!
However i am not clear why we would a separate url for that?
Hmm, thinking about this more, adding a simple status_code in
PaymentRequest would be a much easier way to achieve this. However,
continuing to think about this even more, maybe the simple memo field along
with an empty set of outputs is enough already.
In bitcoinj, right now the code will throw a
PaymentRequestException.InvalidOutputs exception if the set of outputs is
empty with a message of "No Outputs". There isn't a good way to tell the
difference between a payment request that had no outputs and a payment
request that had some invalid output(s).
*Question to everyone:*
How does bitcoin-qt handle a PaymentRequest with no outputs?
On Tue, Feb 11, 2014 at 10:01 AM, Stephane Brossier

@_date: 2014-01-27 14:03:22
@_author: Kevin Greene 
@_subject: [Bitcoin-development] BIP70: PaymentACK semantics 
+1 for an error field.
Should the wallet broadcast the transaction to the bitcoin network when it
receives an ACK, or always assume that the merchant server will do that?

@_date: 2014-01-27 14:39:56
@_author: Kevin Greene 
@_subject: [Bitcoin-development] BIP70: PaymentACK semantics 
Ok, so if there is no
_url specified in the PaymentRequest, then the wallet is responsible for
the transaction to the bitcoin network
Otherwise, the wallet should
rely on the merchant server to broadcast.

@_date: 2014-01-27 19:58:21
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Extension for BIP-0070 to support 
+1 to the idea of recurring payment requests.
Perhaps one way to realize this would be to add an optional URL to the
PaymentRequest object where the next PaymentRequest can be fetched and the
date at which the merchant expects the next payment.
On Mon, Jan 27, 2014 at 6:36 PM, Stephane Brossier

@_date: 2014-03-01 12:42:18
@_author: Kevin Greene 
@_subject: [Bitcoin-development] BIP70 extension to allow for identity 
Another example use-case to back up devrandom's point is using a twitter
handle as the "merchant name". In that example, a 3rd party service hosts
and signs the PaymentRequest, but when someone opens that PaymentRequest in
their wallet, they should know that they are paying the specified twitter

@_date: 2015-06-15 20:30:44
@_author: Kevin Greene 
@_subject: [Bitcoin-development] The Bitcoin Node Market 
Would SPV wallets have to pay to connect to the network too? From the
user's perspective, it would be somewhat upsetting (and confusing) to see
your balance slowly draining every time you open your wallet app. It would
also tie up outputs every time you open up your wallet. You may go to pay
for something in a coffee shop, only to find that you can't spend your
bitcoin because the wallet had to create a transaction to pay to sync with
the network.
Also, users of centralized wallet services like Coinbase would not have to
pay that fee; but users of native wallets like breadwallet would have no
such option. This incentivizes users to use centralized wallets.
So this is kind of imposing a worse user experience on users who want to
use bitcoin the "right" way. That doesn't seem like a good thing to me :/
On Mon, Jun 15, 2015 at 1:12 PM, sickpig at gmail.com

@_date: 2015-06-15 20:49:43
@_author: Kevin Greene 
@_subject: [Bitcoin-development] The Bitcoin Node Market 
?Hah, fair enough, there is no such thing as the "right" way to do
anything. But I still think punishing users who use SPV wallets is ?a
less-than-ideal way to incentive people to run full nodes. Right now SPV is
the best way that exists for mobile phones to participate in the network in
a decentralized way. This proposal makes the user experience for mobile
wallets a little more confusing and annoying.

@_date: 2015-06-15 21:05:46
@_author: Kevin Greene 
@_subject: [Bitcoin-development] The Bitcoin Node Market 
Just thinking off the top of my head here:
What if SPV wallets were exempt from the fee? Only full nodes would pay
other full nodes when initially sync'ing the blockchain. Then as long as
you keep your full node running for a long period of time, you'll
eventually make back the cost you paid to sync initially. This at least
incentives full node operators to keep their node running for as long as
possible once started.
This still imposes a worse UX on casual users who want full node security,
but don't want to run a server 24/7 (or perhaps simply aren't aware that
they have to). These users will watch their balance wither away each time
they open their wallet, but it would be very difficult to explain to them
why that is happening. It would just be frustrating and confusing.
Also, what happens when a user runs Bitcoin-QT for the first time after
downloading it to try it out? They wouldn't be able to sync the blockchain.
Even if the wallet has a balance, how would the wallet be able to see that
it has UTXO's without the ability to sync with the network for free?

@_date: 2015-03-04 18:13:38
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Useless Address attack? 
Bitcoind protects against this by storing the addresses it has learned
about in buckets. The bucket an address is stored in is chosen based on the
IP of the peer that advertised the addr message, and the address in the
addr message itself. The idea is that the bucketing is done in a randomized
way so that no attacker should be able to fill your database with his or
her own nodes.
 *
 * Design goals:
 *  * Keep the address tables in-memory, and asynchronously dump the entire
to able in peers.dat.
 *  * Make sure no (localized) attacker can fill the entire table with his
 *
 * To that end:
 *  * Addresses are organized into buckets.
 *    * Address that have not yet been tried go into 256 "new" buckets.
 *      * Based on the address range (/16 for IPv4) of source of the
information, 32 buckets are selected at random
 *      * The actual bucket is chosen from one of these, based on the range
the address itself is located.
 *      * One single address can occur in up to 4 different buckets, to
increase selection chances for addresses that
 *        are seen frequently. The chance for increasing this multiplicity
decreases exponentially.
 *      * When adding a new address to a full bucket, a randomly chosen
entry (with a bias favoring less recently seen
 *        ones) is removed from it first.
 *    * Addresses of nodes that are known to be accessible go into 64
"tried" buckets.
 *      * Each address range selects at random 4 of these buckets.
 *      * The actual bucket is chosen from one of these, based on the full
 *      * When adding a new good address to a full bucket, a randomly
chosen entry (with a bias favoring less recently
 *        tried ones) is evicted from it, back to the "new" buckets.
 *    * Bucket selection is based on cryptographic hashing, using a
randomly-generated 256-bit key, which should not
 *      be observable by adversaries.
 *    * Several indexes are kept for high performance. Defining
DEBUG_ADDRMAN will introduce frequent (and expensive)
 *      consistency checks for the entire data structure.
 */
On Wed, Mar 4, 2015 at 5:40 PM, Thy Shizzle

@_date: 2015-03-04 18:16:07
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Useless Address attack? 
Also (I am fuzzy on the details for this), Bitcoind will detect when a node
is misbehaving and (I believe) it will blacklist misbehaving nodes for a
period of time so it doesn't continually keep trying to connect to tarpit
nodes, for example.

@_date: 2015-05-04 19:23:09
@_author: Kevin Greene 
@_subject: [Bitcoin-development] New release of replace-by-fee for Bitcoin 
I feel compelled to re-share Mike Hearn's counter-argument *against *
Please carefully consider the effects of replace-by-fee before applying
Peter's patch.

@_date: 2015-05-25 21:46:22
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Zero-Conf for Full Node Discovery 
This is something you actually don't want. In order to make it as difficult
as possible for an attacker to perform a sybil attack, you want to choose a
set of peers that is as diverse, and unpredictable as possible.
On Mon, May 25, 2015 at 9:37 PM, Matt Whitlock

@_date: 2015-05-25 22:12:04
@_author: Kevin Greene 
@_subject: [Bitcoin-development] Zero-Conf for Full Node Discovery 
This is true, but the device doesn't know if the LAN it's on is a safe
network or a hotel wifi, for example. So there would be a tricky UX there.
You'd have to ask the user during set up if this is a trusted LAN or not;
or something like that. That may not be an issue though depending on the
nature of the product. For example, Chromecast doesn't need any security
protections against trolls on the same LAN. I guess it just depends on what
you're planning to build.
On Mon, May 25, 2015 at 9:56 PM, Matt Whitlock
