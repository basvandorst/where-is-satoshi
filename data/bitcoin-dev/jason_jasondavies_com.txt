
@_date: 2018-04-10 01:42:32
@_author: Jason Davies 
@_subject: [bitcoin-dev] KETAMINE: Multiple vulnerabilities in 
These issues all stem from the RC4-based RNG implementation (with insecure
fallback entropy) in Tom Wu's jsbn library, published here:
Please refer to Tom Wu's URL, or this more up-to-date fork of Tom Wu's code
(published to NPM):  -- my repository on
GitHub was only ever intended to be a straight mirror of Tom Wu's code (created
over 7 years ago!).  I'll probably delete my mirror repository given that there
are now better JavaScript bignum alternatives, and in light of this report.
Jason Davies,

@_date: 2018-04-10 09:51:51
@_author: Jason Davies 
@_subject: [bitcoin-dev] KETAMINE: Multiple vulnerabilities in 
Yes, it looks like high-quality entropy via crypto.getRandomValues was only
added in Tom Wu's latest version (v1.4) in July 2013.
Note that even with v1.4, it still does not use high-quality entropy for
Internet Explorer, because getRandomValues is provided under window.msCrypto
for that browser.
  I think this is the real issue: even if high-quality entropy is utilised, the
RNG is RC4-based, which is known to generate biased output.
Finally, note that even Chrome used RC4 for crypto.getRandomValues at one
point (as recently as 2015)!
  Jason Davies,

@_date: 2018-04-10 14:32:36
@_author: Jason Davies 
@_subject: [bitcoin-dev] KETAMINE: Multiple vulnerabilities in 
I simply meant that Internet Explorer implements the Web Cryptography API under
window.msCrypto instead of window.crypto.  Thus, unless
msCrypto.getRandomValues is used, high-quality entropy will not have been used
by any of these libraries under Internet Explorer.
Jason Davies,
