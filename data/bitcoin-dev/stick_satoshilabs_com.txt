
@_date: 2016-04-21 19:23:48
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal to update BIP-32 
This is the main problem: we are not sure, because not a lot of software
does this checks. Also even if you do check, it's hard to handle an
exception (you can't always skip - what if the problematic node is m/44'?).
One of the motivations is to fix BIP-32 so it can be used for
non-secp256k1 curves as well. For NIST P-256 curve this chance is 2^-32.
Jochen even managed to find an example[1]:
m/28578'/33941 where m is derived from
"000102030405060708090a0b0c0d0e0f" seed.

@_date: 2016-08-16 16:48:53
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Hardware Wallet Standard 
I think it does not make sense to try to get this standardized for
current Bitcoin transactions. They are just too complex.
What might be interesting is to have something similar for Segwit and
Lightning transactions.
* TREZOR performs extended validation of the inputs, when all of
prev-txs are streamed into the device and validated. Your standard does
not tackle this at all and I don't think it's worthy to make this
standard unnecessarily complicated.

@_date: 2016-08-16 17:21:57
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Hardware Wallet Standard 
So you basically rephrased what I am saying but in another words.
I am for it. I am just saying we should create a standard for new forms
of transactions (Segwit and maybe Lightning), not the current "ugly" ones.

@_date: 2016-05-08 12:07:52
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal to update BIP-32 
Sipa: Marek told me you posted your answer and he received it, but it
never reached the list. Could you please resend after figuring out what
went wrong?

@_date: 2016-05-13 17:00:39
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
We had quite a long discussion in our team some time ago and we agreed
on that option  is much better and we'd like to implement this way in
True, if this BIP only supports P2WPKH.
P2WSH should probably be handled by another account type and another
BIP, anyway.
We have something in the pipeline, but no visible results yet.

@_date: 2016-05-13 18:11:05
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
I think this is over-optimization. What is the advantage of
m/0'/0x40000000 instead of m/whatever'/0 ?
But this is off-topic anyway, as we are discussing multiple-accounts per
wallet layout here, not one-account-per-wallet design.

@_date: 2016-05-13 19:57:11
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
I see the advantage here. But there is a major problem here.
We came up with BIP44 so a wallet can claim it is BIP44 compatible and
you can be 100% sure that you can migrate accounts from one wallet
implementation to another. This was not previously possible when a
wallet claimed it is BIP32 compatible.
Now we have a similar problem. When there is a BIP44 wallet, does it
mean it supports segwit or not? For this reason I would like to see
another BIPXX for segwit, so a wallet can claim it is BIP44, BIP44+BIPXX
or BIPXX compatible and you'll know what other wallets are compatible
with it.

@_date: 2016-05-14 16:07:18
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
That's simply not true. All reasonable wallets (reasonable = user
oriented) now use BIP39 mnemonic for doing exactly this.

@_date: 2016-05-14 16:08:23
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
This! Thanks Andreas for formulating my thought that I was not able to
articulate earlier.

@_date: 2016-05-15 12:04:01
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Bip44 extension for P2SH/P2WSH/... 
They are not BIP44 compatible wallets. This thread is about BIP44.
They are not following the spec and are thus not BIP44 compatible.
You should send all your coins to the new seed anyway, but I agree this
might be tricky for non-power users.

@_date: 2017-09-05 17:41:37
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] BIP49 Derivation scheme changes 
I am fine with both your proposal and proposal from Thomas
Let's just decide ASAP which one we'll use.

@_date: 2017-09-05 17:44:01
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: bip32 version bytes for segwit scripts 
I used this argument for mnemonic/seed, not xpub/xprv. I am fine with
this proposal of yours, so don't worry.

@_date: 2017-09-06 19:02:59
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: bip32 version bytes for segwit scripts 
If I were designing the serialization format today, I would drop the
fingerprint and expand child number to full BIP32 path. Good thing is
that we already have depth, so we know how long the BIP32 path would be.
So I suggest the following:
4 byte: version bytes
1 byte: depth
depth * 4 bytes: bip32 path
32 bytes
33 bytes

@_date: 2017-09-07 00:29:23
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for BIP-32 
The discussion about changing bip32 version bytes for SegWit got me
thinking and I ended up with what I think is the best proposal:
(It is hosted in SL repo for now, but if there is will, I would love to
have this added to BIP repo as an extension to BIP32)
Feel free to comment.

@_date: 2017-09-07 18:23:13
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for 
What if we added another byte field OutputType for wallets that do not
follow BIP43?
0x00 - P2PKH output type
0x01 - P2WPKH-in-P2SH output type
0x02 - native Segwit output type
Would that work for you?
The question is whether this field should be present only if depth==0x00
or at all times. What is your suggestion, Thomas?

@_date: 2017-09-07 18:25:30
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for 
Birthday is something SPV wallet developers have been wanting for years.
It helps them with the initial scan, so SPV wallet does not have to
download every block in the blockchain, but only the ones after birthday.
I will add some test vectors, when we agree this is the way to go.

@_date: 2017-09-07 18:37:19
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for 
Blockheight depends on the chain. XPUB is not tied to particular
Also there are already cryptocurrencies that do not use blockchain, but
directed acyclic graph (DAG) for storing transactions. So it would not
be obvious what number to use as a blockheight.
OTOH all blockchains contain timestamps in their blocks, so we can use that.

@_date: 2017-09-07 20:38:37
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for 
I think it's not worth complicating the field just to save two bytes.
But if we agree (for privacy reasons) that resolution of this field
should be reduced to week-level (as suggested by Jonas) or month-level
(as sugested by Peter), we could use just 16 bits for this.
TBH I think TREZOR will provide hardcoded constant for this field
(1.1.2014 for all its P2PKH xpubs and 1.8.2017 for all its
P2WPKH-in-P2SH xpubs). So no privacy is lost in this case, but if we
want to ENFORCE this on BIP level, we should decrease the resolution.
I think this is exactly what Thomas meant by "wallet developers are
going to use dirtier tricks" in his email, that's why I specifically
tried to avoid this. I see no good reason to do this, unless we want to
save some bytes and I don't think we are in need of doing this.
I think changing the human-readable part is the way to go. That way the
wallet can immediately say if it understands the format or not, without
parsing the binary data contents. Version bits were introduced in older
standards, because there was no such thing as human-readable prefix.

@_date: 2017-09-07 22:00:05
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Proposal: Extended serialization format for 
But the depth of exported public key will be null. It does not make
sense to export xpub for m or m/0' for your particular case.
I am fine with having the path there all the time.
Is that really the case? Why come up with a hierarchy and then don't use it?

@_date: 2018-12-23 19:46:12
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] BIP39 seeds 
1:256 for 24 words
1:16 for 12 words
This ratio is not too great and will be improved in the upcoming SLIP39
standard:

@_date: 2018-01-07 16:16:47
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] BIP 39: Add language identifier strings for 
I am advising not to use any other language than English for BIP39. I
got persuaded to allow more languages when writing BIP39 spec, but I
learned that it was something I should've been more persistently against.
I am currently drafting a new standard[1] which will allow also Shamir
Secret Scheme Splitting and there we disallow usage of a custom wordlist
in order to eradicate this mess. Will try to push this as BIP too once
we get it to the point we are OK with the contents.

@_date: 2018-01-08 13:39:20
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Satoshilabs secret shared private key scheme 
Hey Gregory!
Thanks for looking into the scheme. I appreciate your time!
Originally, we used a bi-directional function to be able to encode and
decode the key in both directions using the passphrase. We stretched the
passphrase using KDF and then applied AES or other symmetric cipher
We found the following (theoretical) problem:
If an attacker has knowledge of few words from the beginning of shares,
they are able to reconstruct the beginning of the master secret and if
the size of the reconstruced master secret is bigger then the cipher
blocksize (for block ciphers; for stream ciphers 1 bit is enough), then
they can reconstruct the beginning of the seed.
Can you find a scheme which does not have this problem? Or you think
this problem is not worth solving?
Yes. We want this to be possible to be computed on TREZOR-like devices
on boot, similarly how we compute BIP39 on boot right now.
Again, this is by design and it is main point why plausible deniability
is achieved both in BIP39 and SLIP39. If we used a different
construction we'd loose plausible deniability.
This is argument I keep having all the time.
Suppose we'd introduce a version to encode PBKDF2 rounds or even
different KDFs. We'll end up with different SLIP39 mnemonics, but they
will not be compatible among implementations (because TREZOR can only up
to 100.000 rounds of PBKDF2 and does not support Argon2 at all, while
other desktop implementation would rather use memory-hard Argon2).
My gut feeling is that this would lead to WORSE interoperability, not
better. Look at BIP32 for example. There are lots of wallet that claim
they are BIP32 compatible, but in reality they use different paths, so
they are not compatible. BIP32 is a good standard, but in reality
"BIP32-compatible" does not mean anything, whereas when you say the
wallet is "BIP44-compatible" you can be sure the migration path works.
Originally, we wanted to use 16-bit of CRC32 for checksum, but after the
discussion with Daan Sprenkels we were suggested to change this for
cryptographically strong function. The argument was that CRC32 contains
less entropy and mixing high-entropy data (secret) with low-entropy data
(checksum) is not a good idea.
Also, there is an argument between a checksum and ECC. We discussed that
ECC might not be a good idea, because it helps the attacker to compute
missing information, while we only want to check for integrity. Also the
word mnemonic is itself a ECC, because if you see the word "acadornic"
it is probably the word "academic".
Yes, checksum is supposed to prevent that.
Will fix the spelling. About the generic advice about SSS, anyone is
welcome to contribute to the text.

@_date: 2018-01-10 21:28:10
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Satoshilabs secret shared private key scheme 
Actually, scratch that. HW wallet would not know whether the host
computer is lying or not. The computer would not learn about the keys,
but still could be malicious and provide invalid result. Is that correct?

@_date: 2018-01-11 10:55:08
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Satoshilabs secret shared private key scheme 
Can you describe these two methods more in detail? How exactly would
they work? What crypto primitives would you use and how?

@_date: 2018-10-21 23:54:26
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Transaction Input/Output Sorting 
Your solution in the second part of the email does not solve the problem
you indicated in the first part of your email.
On Sun, Oct 21, 2018, 23:41 Ryan Havar via bitcoin-dev <

@_date: 2019-04-03 11:19:40
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] License for BIP39 word lists 
I am the author of the wordlist. Feel free to use it without any
However, we are finalizing SLIP39 standard for splitting shares which uses
a different wordlist with better properties. It might be more suitable for
your project.
See  and
On Wed, Apr 3, 2019, 09:32 Elia via bitcoin-dev <

@_date: 2019-04-09 11:49:53
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] License for BIP39 word lists 
We are in process of finalizing it, so it is not live in Trezor yet. It
will be soon, though. I suppose every wallet that uses BIP39 will adopt
this one as well.

@_date: 2019-12-24 20:25:02
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Base64-encoded descriptors 
I'd rather see something using Base58 or even better Bech32. Base64 is not
URL/QR code friendly.
On Tue, Dec 24, 2019, 18:06 Chris Belcher via bitcoin-dev <

@_date: 2019-02-16 17:49:06
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] NIH warning (was Re: [BIP Proposal] Simple 
Off-topic to main discussion of this thread. But I need to voice my opinion.
We've been using Protocol buffers in Trezor since the beginning and so
far it has proven to be as a great choice.
While I agree it is always risky to add an exotic dependency to a
software project, this one has lots of interoperable implementations in
all possible languages you can name and it's very easy to work with.
In the past, the Bitcoin dev community used the same arguments with
regards to PSBT and we ended up with something that is almost as complex
as protobuf, but it's de-facto proprietary to Bitcoin.
Cherry on top is that PSBT format can be easily translated back and
forth to PB making it even more obvious that PB should have been used in
the first place.
Now everyone ELSE needs to implement this proprietary format and this
actually hinders adoption, not using Protocol Buffers. If these were
used since the beginning, there would be much more PSBT usage already.

@_date: 2020-04-30 14:14:28
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] Sorting outputs of a transaction in alphabetic 
Best Regards / S pozdravom,
Pavol "stick" Rusnak
CTO, SatoshiLabs
On Thu, Apr 30, 2020, 10:21 SatoshiSingh via bitcoin-dev <

@_date: 2020-12-17 11:58:08
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] bip48 proposal 
I applaud this effort!
We tried to document the 48 path usage in this document:
The only difference I can spot is that our document also documents script_type=0 which is for the raw BIP-11 multisig. While almost not used in the wild, it could be imho documented in this proposed BIP as well.
Best Regards / S pozdravom,
Pavol ?stick? Rusnak
Co-founder and CTO, SatoshiLabs

@_date: 2020-03-20 17:29:49
@_author: Pavol Rusnak 
@_subject: [bitcoin-dev] RFC: Deterministic Entropy From BIP32 Keychains 
I read your proposal twice and I still don't know what kind of problem
are you trying to solve.
This should be obvious from the "Abstract" and it's bad if it's not.
