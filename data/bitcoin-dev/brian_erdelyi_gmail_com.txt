
@_date: 2015-02-01 08:49:05
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
In online banking, the banks generate account numbers.  An attacker cannot generate their own account number and the likelihood of an attacker having the same account number that I am trying to transfer funds to is low and this is why OCRA is effective with online banking.
With Bitcoin, the Bitcoin address is comparable to the recipient?s bank account number.   I now see how an an attacker can brute force the bitcoin address with vanitygen.  Is there any way to generate an 8 digit number from the bitcoin address that can be used to verify transactions in such a way (possibly with hashing?) that brute forcing a bitcoin address would take longer than a reasonable period of time (say 60 seconds) so a system could time out if a transaction was not completed in that time?
I?ve also looked into BIP70 (Payment Protocol) that claims protection against man-in-the-middle/man-in-the-browser (MitB) based attacks.  A common way to protect against this is with out-of-band transaction verification ( ).  I see how BIP 70 verifies the payment request, however, is there any way to verify that the transaction signed by the wallet matches the request before it is sent to the blockchain (and how can this support out of band verification)?  Perhaps this is something that can only be supported when sending money with web based wallets.
Brian Erdelyi

@_date: 2015-02-01 09:54:08
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
I think BIP 70 does a good job at verifying where the payment request came from.  I?m not convinced this is the same as verifying the transaction (ideally OOB).
The reason for OOB verification is if the entire computer is compromised.  Again, this may only be possible with a trusted intermediary or a web wallet.
Brian Erdelyi

@_date: 2015-02-02 13:40:11
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Another concept...
It should be possible to use multisig wallets to protect against malware.  For example, a user could generate a wallet with 3 keys and require a transaction that has been signed by 2 of those keys.  One key is placed in cold storage and anther sent to a third-party.
It is now possible to generate and sign transactions on the users computer and send this signed transaction to the third-party for the second signature.  This now permits the use of out of band transaction verification techniques before the third party signs the transaction and sends to the blockchain.
If the third-party is malicious or becomes compromised they would not have the ability to complete transactions as they only have one private key.  If the third-party disappeared, the user could use the key in cold storage to sign transactions and send funds to a new wallet.

@_date: 2015-02-02 14:07:52
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Yes, the second signing could be done by a mobile device that I owned and controlled (I wasn't thinking that initially).  I was thinking that online services are popular because of convenience and there should be a better way to address security (privacy issues not withstanding).
I think these are practical approaches and just doing a sanity check.  Thanks for the vote of confidence.
Brian Erdelyi
Sent from my iPad

@_date: 2015-02-02 14:10:12
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
I?m just late to the party I guess.  Thanks for the links.

@_date: 2015-02-02 14:35:59
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
I really like the concept of Bitcoin Authenticator and think it?s exactly what I was describing (without a third-party).
I think it?s a bit confusing when they describe Bitcoin Authenticator as 2FA.  I think it may be more accurate to describe it as out of band transaction verification/signing or dual transaction signing.  Regardless, it?s very exciting to see others are thinking about this too.
Brian Erdelyi

@_date: 2015-02-02 15:58:11
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Just trying to make sure I understand what you?re saying.  Are you eluding to that if two of the three private keys get compromised there is no gain in security?  Although the likelihood of this occurring is lower, it is possible.
As more malware targets bitcoins I think the utility is evident.  Given how final Bitcoin transactions are, I think it?s worth trying to find methods to help verify those transactions (if a user deems it to be high-risk enough) before the transaction is completed.  The balance is trying to devise something that users do not find too burdensome.
Brian Erdelyi

@_date: 2015-02-02 17:03:42
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
The mobile device should show you the details of the transaction (i.e. amount and bitcoin address).  Once you verify this is the intended recipient and amount you approve it on the mobile device.  If the address was replaced, you should see this on the mobile device as it won?t match where you were intending to send it.  You can then not provide the second signature.
Brian Erdelyi

@_date: 2015-02-02 17:42:34
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Transaction initiated and signed on device   Transaction is sent to device   On device  you verify the transaction and if authorized you provide the second signature.
Brian Erdelyi
Sent from my iPhone

@_date: 2015-02-02 17:49:11
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Excellent point of the recipient being compromised.

@_date: 2015-02-03 16:09:54
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Subject: Re: Proposal to address Bitcoin 
I think a standard for passing partially signed transactions is a great idea as well.  This would support interoperability of wallets/clients and third-party services (if users choose to use them).
Brian Erdelyi

@_date: 2015-01-31 18:15:53
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Hello all,
The number of incidents involving malware targeting bitcoin users continues to rise.  One category of virus I find particularly nasty is when the bitcoin address you are trying to send money to is modified before the transaction is signed and recorded in the block chain.  This behaviour allows the malware to evade two-factor authentication by becoming active only when the bitcoin address is entered.  This is very similar to how man-in-the-browser malware attack online banking websites.
Out of band transaction verification/signing is one method used with online banking to help protect against this.  This can be done in a variety of ways with SMS, voice, mobile app or even security tokens.  This video demonstrates how HSBC uses a security token to verify transactions online.   .
Many Bitcoin wallets and services already use Open Authentication (OATH) based one-time passwords (OTP).  Is there any interest (or existing work) in in the Bitcoin community adopting the OATH Challenge-Response Algorithm (OCRA) for verifying transactions?
I know there are other forms of malware, however, I want to get thoughts on this approach as it would involve the use of a decimal representation of the bitcoin address (depending on particular application).  In the HSBC example (see YouTube video above), this was the last 8 digits of the recipient?s account number.  Would it make sense to convert a bitcoin address to decimal and then truncate to 8 digits for this purpose?  I understand that truncating the number in some way only increases the likelihood for collisions? however, would this still be practical or could the malware generate a rogue bitcoin address that would produce the same 8 digits of the legitimate bitcoin address?
Brian Erdelyi

@_date: 2015-01-31 19:04:57
@_author: Brian Erdelyi 
@_subject: [Bitcoin-development] Proposal to address Bitcoin malware 
Thank you for this reference.  Interesting to see that there is a tool to generate a vanity bitcoin address.
I am still researching viruses that are designed to manipulate a bitcoin address.  I suspect they are primitive in that they use a hardcoded rogue bitcoin address as opposed to dynamically generating one.
As a start, this would help protect against malware that uses a static rogue bitcoin address.  The next thing would be for the malware to brute-force the legitimate bitcoin address and generate a rogue bitcoin address that would produce the same 8 digit code.  Curious to know how long this brute force would take?  Or perhaps, before converting to 8 digits there is some other hashing function that is performed.
Brian Erdelyi
