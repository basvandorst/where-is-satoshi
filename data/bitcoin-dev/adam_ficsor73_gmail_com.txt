
@_date: 2017-08-30 07:45:31
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] ZeroLink Fungibility Framework -- Request for 
I've been long working on Bitcoin privacy, mainly on TumbleBit
, HiddenWallet
 and BreezeWallet
. ZeroLink is my latest
effort to gather all the privacy reasearch I'm familiar with,
combine/organize them in a coherent and practical way. The main point
of ZeroLink is that "nothing is out of its scope", it is intended to
provide complete anonymity on-chain.
Amongst its many topics, ZeroLink defines mixing technique, coin
selection, private transaction and balance retrieval, transaction
input and output indexing and broadcasting and even includes UX
Users' privacy should not be breached neither on blockchain level, nor
on network level.
In a nutshell ZeroLink defines a pre-mix wallet, which can be
incorporated to any Bitcoin wallet without much implementation
overhead. Post-mix wallets on the other hand have strong privacy
requirements, so the mixed out coins will not lose their uniformity.
The requirements and recommendations for pre and post-mix wallets
together define the Wallet Privacy Framework.
Coins from pre-mix wallets to post-mix wallets are moved by mixing.
Most on-chain mixing techniques, like CoinShuffle, CoinShuffle++ or
TumbleBit's Classic Tumbler mode can be used. However ZeroLink defines
its own mixing technique: Chaumian CoinJoin, which is based on Gregory
Maxwell's 2013 CoinJoin recommendations and ideas
. I found this
technique to be the most performant, fastest and cheapest one.
Regarding adoption SamouraiWallet and HiddenWallet  are going
to implement and comply with ZeroLink and BreezeWallet
 also shows significant

@_date: 2018-12-01 19:07:40
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] BIP Proposal - Address Paste Improvement 
If this needs to be a BIP or not, that is up to this list to decide, I will
not be pushy abut it. We simply encountered a well defined and common issue
and we took the time to work out and specify our solution, so it may come
in handy for other developers encountering this same issue. We can argue
about the significance of it, but I suspect all arguments will come down to
how much an individual developer values UX or how much he does not.

@_date: 2018-02-13 18:25:50
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] Possible change to the MIT license 
I agree with the opposition on changing the license, because of the
branding attacks.
However having two coins with the same Proof Of Work is a zero sum game
from a security point of view. It may not be a bad idea to consider
changing the license in a way that only limits cryptocurrencies with the
same Proof Of Work, since they directly affect the stability and security
of Bitcoin.

@_date: 2018-01-24 00:31:59
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] Transaction Merging (bip125 relaxation) 
coins if you have a decent number of outputs well under the value
you're paying.
I have been playing around quite a lot these lines, too and created some
content that is worth to look at:
Also, you can try a simpler privacy oriented coin control implementation
with HiddenWallet:

@_date: 2018-11-07 21:09:53
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] BIP Proposal - Address Paste Improvement 
BIP: ?
Layer: Applications
Title: Address Paste Improvement
Author: nopara73 , David Molnar <
molnardavid84 at gmail.com>
Type: Standard Track
Created: 2018-11-07
Abstract. End-users often copy-paste addresses. This BIP aims to facilitate
the user experience regarding this process.
Motivation. Some services already implemented autopaste functions, which is
done as follows: the user clicks to the address box and a Bitcoin address
automatically gets pasted from the clipboard. Depending on the
implementation, this could be either annoying or not permissive enough if
it completely replaces the possibility of manually entering a Bitcoin
The BIP Proposal can be found here:
An implementation will soon follow in Wasabi Wallet.

@_date: 2018-11-12 10:23:53
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] BIP Proposal - Address Paste Improvement 
Thank you for all your comments. To sum up:
- There were no comments related to the implementation details.
- There are concerns about this may incentivize users to use copypaste
functionality extensively.
- A counter argument was made that crypto hijackers use the clipboard,
because that is the most convenient thing to hijack, not because they can
only hijack that and, if Bitcoin users would move to other ways of
specifying destinations, that may end up being just as an issue, too.
- The rest of the conversation was about crypto hijackers, which I think is
off topic in this thread.
Finally I'd like to note, there's already a work in progress implementation
in Wasabi: On Fri, Nov 9, 2018 at 1:14 AM Dmitry Petukhov via bitcoin-dev <

@_date: 2019-12-27 14:03:49
@_author: nopara73 
@_subject: [bitcoin-dev] Non-equal value CoinJoins. Opinions. 
The CashFusion research came out of the Bitcoin Cash camp, thus this
probably went under the radar of many of you. I would like to ask your
opinions on the research's claim that, if non-equal value coinjoins can be
really relied on for privacy or not.
(Btw, there were also similar ideas in the Knapsack paper in 2017:
 )
I copy the most relevant paragraphs here:
  ---------BEGIN QUOTE ---------
Consider a transaction where 10 people have each brought 10 inputs of
arbitary amounts in the neighborhood of ~0.1 BCH. One input might be
0.03771049 BCH; the next might be 0.24881232 BCH, etc. All parties have
chosen to consolidate their coins, so the transaction has 10 outputs of
around 1 BCH. So the transaction has 100 inputs, and 10 outputs. The first
output might be 0.91128495, the next could be 1.79783710, etc.
Now, there are 100!/(10!)^10 ~= 10^92 ways to partition the inputs into a
list of 10 sets of 10 inputs, but only a tiny fraction of these partitions
will produce the precise output list. So, how many ways produce this exact
output list? We can estimate with some napkin math. First, recognize that
for each partitioning, each output will typically land in a range of ~10^8
discrete possibilities (around 1 BCH wide, with a 0.00000001 BCH
resolution). The first 9 outputs all have this range of possibilities, and
the last will be constrained by the others. So, the 10^92 possibilies will
land somewhere within a 9-dimensional grid that cointains (10^8)^9=10^72
possible distinct sites, one site which is our actual output list. Since we
are stuffing 10^92 possibilties into a grid that contains only 10^72 sites,
then this means on average, each site will have 10^20 possibilities.
Based on the example above, we can see that not only are there a huge
number of partitions, but that even with a fast algorithm that could find
matching partitions, it would produce around 10^20 possible valid
configurations. With 10^20 possibilities, there is essentially no linkage.
The Cash Fusion scheme actually extends this obfuscation even further. Not
only can players bring many inputs, they can also have multiple outputs.
---------END QUOTE ---------

@_date: 2019-02-04 07:49:27
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] Card Shuffle To Bitcoin Seed 
Unlike mouse movement it works in a CLI software, which is great. However,
isn't there something else you can use instead of cards? Something with
invariant culture and maybe more common.
On Sun, Feb 3, 2019 at 7:27 PM Ryan Havar via bitcoin-dev <

@_date: 2019-02-17 20:42:05
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] BIP proposal - Signatures of Messages using 
In Wasabi wallet we are in the finishing line of an encryption manager.
I'll ask the OP to review your BIP and probably I'll do it myself, too
before I'd merge. Feel free to review/test our PR, too:
On Sun, Feb 17, 2019 at 6:01 PM Christopher Gilliard via bitcoin-dev <

@_date: 2019-03-06 15:28:02
@_author: Adam Ficsor 
@_subject: [bitcoin-dev] Privacy literature review 
I would like to grab the opportunity to point out that I am doing the same,
but in the form of presentations. I started with a two part presentation,
but I decided to make it into a 6 part presentation series in the future.
Part 1: Concentrating on network level privacy -
Part 2: Concentrating on blockchain level privacy -
I think this work is very important and nothing comparable has been done
before, so thank you for taking the time for this Belcher!
On Wed, Mar 6, 2019 at 1:38 AM Chris Belcher via bitcoin-dev <

@_date: 2019-09-23 07:20:31
@_author: nopara73 
@_subject: [bitcoin-dev] Block Batch Filters for Light Clients 
Please also take a look at "Applying Private Information Retrieval to
Lightweight Bitcoin Clients" Scaling Bitcoin talk. The academics were not
aware of BIP158 at all, yet came up with a similar scheme independently.
On Sat, Sep 21, 2019 at 11:40 PM Tamas Blummer via bitcoin-dev <

@_date: 2020-04-22 13:38:37
@_author: nopara73 
@_subject: [bitcoin-dev] Academic research regarding BIP0002 
Just a tip: if you'd like to get feedback on your work, then share your
work as well, since not many people are willing to commit to helping unless
they know how large the work is.
On Tue, Apr 21, 2020 at 10:51 PM Shiva Jairam via bitcoin-dev <

@_date: 2020-02-22 19:01:14
@_author: nopara73 
@_subject: [bitcoin-dev] Non-equal value CoinJoins. Opinions. 
"around 1 BTC"
While that would be true out of context, it depends on how you interpret it
and they interpret it really broadly: " One input might be 0.03771049 BCH;
the next might be 0.24881232 BCH, etc. "
requires that you have "around 1 BTC" outputs per user. you might as well
just use equal-valued CoinJoins, where the equal-valued outputs at least
are completely unlinked from the inputs.
you could transform that to a CoinJoin with 0.99, 0.99, 0.99, 0.01, 0.11
Equal valued coinjoins (1) waste more blockspace as your example
illustrates and (2) prevent arbitrary amounts, so you cannot send in
analyses to CashFusion, since the same analysis "around 1 BTC" can be
performed with the CoinJoin change outputs "around 0 BTC".
I've been wondering about this too. I think it cannot be applied to
existing CoinJoin schemes, as coin selection heuristics are quite a help
and that could be a reason why the changes can be deanonymized (I assume.)
For example if I want to analyze a Wasabi CJ, then I assume every input
that have > 0.1 BTC value to be THE valid input partition and I will only
look for the valid matching partition on the output side. I won't try to
find all the partitions and look at all the possible subset sums. (
At the very least coin selection for equal value coinjoins can be relaxed
to remove such assumptions and make the above math applicable for the
change. (If works.)

@_date: 2020-02-28 15:37:14
@_author: nopara73 
@_subject: [bitcoin-dev] [bitcin-dev] BIP157 Filter Type Extensibility 
BIP157 defines a section called "Filter Types" (
 )
are multiple *filter types* that determine which data is included in a
block filter as well as the method of filter construction/querying. In this
model, full nodes generate one filter per block per filter type supported.
and serialization format of the filter. A full node MAY signal support for
particular filter types using service bits. The initial filter types are
defined separately in BIP 158
, and one
service bit is allocated to signal support for them.
While it provides a way to extend to multiple filter types, it does not
provide a way to extend to filter type combinations. Such combinations are
possible if the filter types would have to be defined with the power of
two: 1, 2, 4, 8, 16..., so every octet of a byte array could denote a
specific filter type, this way we could be able to signal for any number of
combinations of those filter types.
Originally this idea is described in more details and with code here:
MarcoFalke suggested for me to submit it to the mailing list instead of a
GitHub issue then propose an update to the BIP if consensus is reached.

@_date: 2020-06-10 14:32:05
@_author: nopara73 
@_subject: [bitcoin-dev] Tainting, CoinJoin, PayJoin, CoinSwap 
The problem with CoinJoins is that desire for privacy is explicitly
signalled by them, so adversaries can consider them "suspicious." PayJoin
and CoinSwap solve this problem, because they are unnoticeable. I think
this logic doesn't stand for scrutiny.
kinds of coin histories: "clean", "dirty" and "suspicious".
The aftermath of you using a "dirty" coin is knocks on your door. You using
a "suspicious" coin is uncomfortable questions and you using a "clean" coin
is seamless transfer.
In scenario 1, you start out with a "clean" history. By using CoinJoins you
make your new coin's history "suspicious" so you have no incentive to
CoinJoin. By using CoinSwap/PayJoin your new coin can be either "clean" or
"dirty". What would a "clean" coin owner prefer more? Take the risk of
knocking on the door or answering uncomfortable questions?
In scenario 2, you start out with a "dirty" history. By using CoinJoins you
make your new coin's history "suspicious" so you have an incentive to
CoinJoin. By using CoinSwap/PayJoin your new coin can either be "clean" or
"dirty". What would a "dirty" coin owner prefer more? And here's an
insight: you may get knocks on your door for a dirty coin that you have
nothing to do with. And you can prove this fact to the adversary, but by
doing so, you'll also expose that you started out with a "dirty" coin to
begin with and now the adversary becomes interested in you for a different
You can also examine things assuming full adoption of PJ/CS vs full
adoption of CJ, but you'll see that full adoption of any of these solves
the tainting issue.
So my current conclusion is that PJ/CS does not only not solve the taint
problem, it just alters it and ultimately very similar problems arise for
the users. Maybe the goal of unobservable privacy is a fallacy in this
context as it is based on the assumption that desiring privacy is
suspicious, so you want to hide the fact that you desire privacy. And the
solution to the taint issue is either protocol change or social change
(decent adoption.)
PS.: Please try to keep the conversation to the Taint Issue as this email
of mine isn't supposed to be discussing general pros and cons of various
privacy techniques.
Any thoughts?

@_date: 2020-06-11 13:20:56
@_author: nopara73 
@_subject: [bitcoin-dev] Tainting, CoinJoin, PayJoin, CoinSwap 
Thank you all for your replies, I think everyone agrees here how it "should
be" and indeed I risked my post and my used terminology to further
legitimize the thinking of adversaries.
I'd have one clarification to my original post. It may not be clear why I
put PJ/CS to the same box. One way of thinking of CoinSwap is to swap coin
histories and PayJoin is to share coin histories. For the purposes of this
attack the consequences are roughly the same so that's why I think it's ok
to put them under the same umbrella in this discussion, but I wouldn't die
for it :)
And indeed I perhaps wrongly called this the "Taint Issue", maybe it should
be called "Coin Discrimination Issue" or something like that, not sure if
we have a term for this, but I'm sure we should have a term for this as
unlike some other, so far theoretical attacks on Bitcoin's fungibility, it
is currently being applied in practice.
On Thu, Jun 11, 2020 at 7:24 AM Mr. Lee Chiffre via bitcoin-dev <

@_date: 2020-09-19 17:01:07
@_author: nopara73 
@_subject: [bitcoin-dev] A Replacement for RBF and CPFP: Non-Destructive 
Wouldn't this enable a passive adversary listening the mempool to associate
unrelated TXO clusters to the same user?
On Sat, Sep 19, 2020, 15:38 David A. Harding via bitcoin-dev <
