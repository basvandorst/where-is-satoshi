
@_date: 2014-03-07 10:26:03
@_author: Johannes Zweng 
@_subject: [Bitcoin-development] Instant / contactless payments 
2014-03-06 12:26 GMT+01:00 Andreas Schildbach :
Just a small input to this point:
On Android 4.4 the new host card emulation (HCE) feature (aka: the phone
emulates a ISO-DEP Smartcard and processes ISO7816-4 APDU commands like a
Smartcard would do) only works when the display is on, but even when the
screen is locked (can be changed with "android:requireDeviceUnlock" in
Manifest). See here for detailled specification:
Using the HCE API on Android 4.4 also has the beauty that any app that
registers itself for HCE and sets its category to CATEGORY_PAYMENT in the
Manifest automatically shows up in Adroid's system settings under "Tap &
Pay" (where a user would expect payment applications).

@_date: 2014-03-07 13:00:33
@_author: Johannes Zweng 
@_subject: [Bitcoin-development] Instant / contactless payments 
2014-03-07 11:23 GMT+01:00 Andreas Schildbach :
Yes, that's also something adopted from the existing Smartcard world.
Existing smartcards can contain different payment applications (for example
in Germany the "Maestro" and the "Geldkarte" application on the same card).
So the terminal can actively request one specific application within the
But as Mike correctly said, we have no pre-existing infrastructure to
support. So decisions should only be based on what makes sense for the
Bad news: It seems - at least CATEGORY_PAYMENT - very credit card centric.
I'm not sure about this. I've built several HCE test apps and tested them
with readers (and other phones used as reader) but I did not notice any
difference to using CATEGORY_OTHER (besides that the apps using
CATEGORY_PAYMENT appear in KitKat's new shiny "Tap & Pay" menu).
HCE seems to cover only the payer side. I wonder if there is also an API
You are free to implement whatever protocol you want. On the reader side
you simply do a IseDep "connect()" and send your commands with
"transceive()" (
After sending the initial ISO 7816-4 "SELECT APPLICATION" command (see here
for some ISO 7816-4 doc:
which triggers Android HCE routing mechanism to route all following PDUs to
your HCE app, you are free to send whatever you want.
Anything you send with "transceve()" on the sender side, will be received
within your HCE application in the "processCommandApdu" method:
The only limitation is that you have a strict request/response model. The
reader terminal (or the reading phone) sends a request, the HCE phone sends
a response.
