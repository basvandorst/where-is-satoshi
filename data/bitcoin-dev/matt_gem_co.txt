
@_date: 2015-06-19 13:42:00
@_author: Matt Smith 
@_subject: [Bitcoin-development] Alternate HD path structure: BIP, blog, 
Hey guys,
The crew at Gem is considering a new HD wallet path structure for our
wallets, which are coin-agnostic, that separates the coin_type field
into two fields as such:
m / purpose' / network' / asset_type' / account' / change / index
where network refers to the blockchain (0 - bitcoin, 1 - testnet3, 2 -
litecoin, etc) and the new asset_type refers to the kind of asset to be
held in accounts below that path (Open Assets, Omni, Counterparty).
The intent is to allow us to validate the address format, select the
appropriate daemon to scan for tokenized assets, and choose multiple
blockchain data sources (that may not know anything about token systems
running on the blockchain they expose) relevant to an HDNode in the
wallet using only information in the HDNode's path -- without having to
maintain an explicit mapping of coin_type -> network.
For example, we already have the issue of mapping network identifiers
because of the lack of standardization across cryptocurrency libraries
which ends up being ugly and obnoxious to maintain, i.e.
netcode_map = {
  testnet: testnet3,
  bitcoin_testnet: testnet3,
  testnet3: testnet3,
  XTN: testnet3, ...
netcode_i_want = netcode_map[netcode_returned_by_libwhatever]
We want to avoid maintaining a similar asset_type_to_blockchain mapping.
Additionally, it would be helpful for utxo selection to exclude utxos
tied to assets based on path.
BIP43 seems to suggest that we request a BIP number and publish an
informational BIP specifying the new purpose. If that's not appropriate,
then maybe we just need to publish the information in a blog post to
allow any wallet developers who want to to implement
I was also wondering if anyone had previously suggested something
similar that I missed when cruising the mailing list archives on the
Matt Smith | Gem
 | GH:

@_date: 2015-06-19 16:31:51
@_author: Matt Smith 
@_subject: [Bitcoin-development] Alternate HD path structure: BIP, blog, 
I'm not sure I understand your question about the need to store paths in
the wallet database -- there's no way to infer the path of an address
inside an HD wallet from the address alone (short of an exhaustive
search), and HD wallets need to store either the paths, addresses, or
both that have been previously derived/used to monitor the blockchain
usefully, but those facts aren't new or specific to this path format.
The motivation for this path structure over standard bip44 is that it
separates the concept of network (or which blockchain I'm using) and
coin_type (or what kind of thing I'm sending over that blockchain).
This is useful, for example, if I want to import a wallet into my
application and I know that an account was in use at
where 99 is the identifier for, say, counterparty - I only need to check
the addresses derived below that path for balances against
counterpartyd. It may be worth pointing out that I expect multisig HD
wallet imports to require master keys and a list of account paths ? not
a list of addresses, as it's very possible that a new address could be
derived between the time when the wallet data was exported and when it
will be imported.
This use case might be very specific to our model, but the reason I
figured we should request a BIP # for this is that to start using it, we
need to pick a number for the purpose field and don't want to do it
arbitrarily (and risk having to change it later) or overload 44 (which
would be misleading).
Did I either  a) answer  or  b) misunderstand  your questions?
Matt Smith | Gem
 | GH:

@_date: 2015-06-19 19:40:52
@_author: Matt Smith 
@_subject: [Bitcoin-development] Alternate HD path structure: BIP, blog, 
Trivial to implement, a headache to *maintain*
But if a new platform is released on an existing blockchain, my wallet
doesn't need to know about the new magic number it claims in order to
handle it correctly.
Say I make a new token layer, BobCoin, which runs on bitcoin and say I
use an HD wallet and always generate new BobCoin token addresses as
m/ If I import that wallet into older HD wallet
software that doesn't know anything about BobCoin, it will still:
- understand what blockchain to query for utxos on the addresses below
that path
- be able to generate valid BobCoin addresses without any updates
I think this is particularly valuable if you're developing against a
platform where updates can't be forced on clients.
To be clear: I am not suggesting this as a general-purpose successor to
Matt Smith | Gem
 | GH:
