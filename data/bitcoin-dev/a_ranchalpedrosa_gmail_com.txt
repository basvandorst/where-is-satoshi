
@_date: 2018-09-06 11:19:24
@_author: Alejandro Ranchal Pedrosa 
@_subject: [bitcoin-dev] A BIP proposal for transactions that are 'cancellable' 
Hello everyone,
We would like to propose a new BIP to extend OP_CSV (and/or OP_CLTV) in
order for these to allow and interpret negative values. This way,
taking the example shown in BIP 112:
HASH160  EQUAL
 ???  ??? "24h" CHECKSEQUENCEVERIFY DROP
 ??? that gives ownership only to Bob for the first 24 hours and then to
whichever spends first, we basically propose using the negative bit value:
HASH160  EQUAL
 ???  ??? "-24h" CHECKSEQUENCEVERIFY DROP
 ??? meaning that both would have ownership for the first 24 hours, but
after that only Bob would own such coins. Its implementation should
not be too tedious, and in fact it simply implies considering negative
values that are at the moment discarded as for the specification of
BIP-112, leaving the sign bit unused.
This, we argue, an increase the fairness of the users, and can at times
be more cost-effective for users to do rather than trying a Replace-By-Fee
transaction, should they want to modify such payment.
We would like to have a discussion about this before proposing the
BIP, for which we are preparing the text.
You can find our paper discussing it here:
 (find attached as well)

@_date: 2018-09-07 09:07:25
@_author: Alejandro Ranchal Pedrosa 
@_subject: [bitcoin-dev] A BIP proposal for transactions that are 
Yes I agree with what you mean but this requires Alice to broadcast an additional transaction. Also, Alice is supposed to be able to 'cancel' the transaction in the first 24hours, not after them.

@_date: 2018-09-07 09:12:40
@_author: Alejandro Ranchal Pedrosa 
@_subject: [bitcoin-dev] A BIP proposal for transactions that are 
Hi all,
Thank you for the link, and also to Gregory for the remarks. I did not know about this previous proposal. I think the last paragraph of future work is interesting:
"It may be interesting to add enhance OP_CHECKSEQUENCEVERIFY  to allow outputs that are spendable by Alice until time foo, always spendable by Bob, and spendable by Joe only after time bar, or other such cases"
Perhaps it would allow this functionality, while keeping the validity of coins, if the new OP_zzz took an additional argument than suggested, such that the first one is the timelimit for Alice to keep the coin (say in the first 24 hours), and after those 24 hours the ownership goes to the third argument, say Bob.
That is, it is not possible to use only specifying the owner in the first 24 hours. Would this be considered harmful?

@_date: 2019-02-09 11:01:20
@_author: Alejandro Ranchal Pedrosa 
@_subject: [bitcoin-dev] Safer NOINPUT with output tagging 
Hi all,
An eltoo-like protocol that works (without going on-chain) if you can't predict in advance who will become absent would be a childchain. If the off-chain protocol can continue updating in the abscence of other parties, it means that other parties' signatures must not be required when they are not involved in the off-chain state update. If other parties' signatures must not be required, there must be a way of having a common verifiable 'last state' to prevent a party to simultaneously 'fork' the state with two different parties, and double-spend. A solution for this is a childchain for Bitcoin. An example of this is what is known as a 'Broken Factory' attack [1] I believe that in many cases other parties won't be able to continue until the unresponsive parties go back online. That might be true in particular scenarios, but generally speaking, the party might have gone unresponsive during a factory-level update (i.e. off-chain closing and opening of channels), while some parties might have given out their signature for the update without receiving a fully signed transaction. In this case they do not even know which channel they have open (the one of the old state that they have fully signed, or the one for the new state that they have given out their signature for). This is known as a 'Stale Factory', and can be exploited by an adversary in a 'Stale Factory' attack [1]. Even if they knew which state they are in (i.e. the party went unresponsive but not during a factory-level update), some of them might have run out of funds in some of their channels of the factory, and might want to update, while they will not be willing to wait for a party to go back online (something for which they also have zero guarantees of).
An eltoo-like protocol that works (allowing going on-chain) if you can't in advance who will become absent, then this is precisely why 'Transaction Fragments' have been suggested. They allow an eltoo-like protocol even when one cannot predict in advance who will become absent, or malicious (by publishing invalid states), cause the non-absent parties can unite their fragments and create a valid spendable factory-level transaction that effectively kicks out the malicious parties, while leaving the rest of the factory as it was. To the best of my understanding, the eltoo original proposal also allows this though.
[1]: Scalable Lightning Factories for Bitcoin,
