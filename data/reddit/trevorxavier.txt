@_author: trevorxavier
@_date: 2013-06-06 15:19:16
Your support is greatly appreciated, imkharn. Thank you so much.
@_date: 2013-06-06 17:09:59
Many thanks, notreddingit, for your input. You're right, ultimately the public decides which organizations are fair and trustworthy. I'm glad that I have been able to make a fruitful contribution to bitcoin gaming.
@_date: 2013-06-07 19:14:22
Thank you, fooot, for the comment. I appreciate the response I've been receiving for this analysis.
Yes, I will certainly agree: I wouldn't risk using these methods as a house, either. The identification of them, however, should empower people to carefully choose which casinos they place wagers with and show that "provably fair" may not be as provable as we might believe.
@_date: 2013-06-06 04:32:45
bitZino actually allows you to set the client seed before clicking 'Deal' and shows it to you throughout the hand. In practice, however, this client seed can be compromised by being suggested (overridden), predicted (by injection), or reset (by stalling).
As stated earlier, I am not accusing any gambling house of cheating. These are just proof of concepts.
Thank you for the additional input, JackPerth. It's greatly appreciated.
@_date: 2013-06-06 15:38:08
Thank you for writing, tlrobinson.
According to bitZino's owner, the initial shuffle is performed using a CSPRNG (see [here]( If it takes at least 250 bits of internal state on a regular PRNG to access all of the 52! permutations, I wonder how they can effectively shuffle 416 cards in an 8 deck game. My guess is that since only a single game is played with the deck, a user can reasonably expect to receive all possible permutations of dealt hands. Total guess here, however, since I don't know what CSPRNG they are using.
You're right! A browser extension would solve a great many issues. Nothing is strictly private when interfacing directly with a website.
As for the rest of your post, I find the information insightful. I'm going to take the afternoon to think about the process you described and craft a response. Thanks!
@_date: 2013-06-06 06:05:55
Super cool! Thank you so much, PrimeStunna. Your appreciation will be cherished! I will keep you up-to-date on our developments.
@_date: 2013-06-08 19:28:45
Absolutely! We've developed two possible solutions, currently being peer-reviewed internally, that tackles the issues (and more to come) of the browser-based execution of Provably Fair. One is a drop-in replacement for the current implementation, which we've called "Provably Fair II" and another is a completely novel take on the whole design. Since they are still being peer-reviewed, and I only have partial ownership of the work, I am unable to discuss them publicly at the moment. No fears, however, as I am sure an individual or group will take us up on our research and you'll see the results implemented soon.
Tonight, I may take a look at your site and write some thoughts. My thoughts will be just that: thoughts. Hopefully it will be enough for us to engage in good conversation, as each site has enormously different implementations of their games.
I know I looked at your site in our initial examinations of all bitcoin-based casinos at the start of our research, and I remember *loving* the look, as it brought me back to my youth.
Thanks again for the input, tbak. I'll keep you posted.
@_date: 2013-06-07 03:43:34
Thank you for your appreciation and follow-up. With all respect, while I do not believe your argument regarding risk bears anything on the integrity of Provably Fair, I will try to contribute to it.
The problem with your argument is that you assume your players would be able to identify these attacks in the first place. They will be able to do so **now**, but yesterday, less so. Clearly, even in the comments here, readers with technical backgrounds in HTML/JavaScript have questioned if rendered HTML or JS partials are even possible. killerstorm even went so far as to independently verify aspects of your site and confirmed that indeed, the attacks are plausible.
That said, now that the analysis has been released, I would agree that if your casino carried out any attacks, the damage to your reputation would be extreme. However, if bitZino or some other casino used these cheats prior to the release of our findings (yesterday) with the outlined discrimination and throttling protocols, they could have perpetrated the fraud at minimal risk.
Most importantly, and based on the rest of your post, both you and I agree: whether or not a casino gets caught bears nothing on the integrity of Provably Fair. As you have stated on numerous forum posts in the past, the system is designed to make gaming "impossible to cheat" and "guaranteed fair" so that players have the "ultimate trust" in your games. The plausibility that attacks exist in the wild and that a casino can choose to use them is why we believe the system is compromised.
I am very pleased that we have had a great discussion. I look forward to seeing your improvements to your implementation. My colleagues and I have also developed our own take on the mutual-distrust problem, and if you desire any help from us, please contact me. If not, hopefully you and I will have an opportunity to compare notes again in the future. All the best!
@_date: 2013-06-06 15:08:59
Thank you for writing, NicolaiS1993.
A main point of the article suggests that a house could effectively cheat a portion of its players by segregating them through bet or browser discrimination. By implication this means a majority of the cheats are performed on a minority of players.
The house would not want to go up against someone like you or me, so a it can observe us until it passes judgement on our play. Do we keep the Provably Fair dialog box open or closed? Are we betting more than X BTC? Are we progressive betting? Have we changed the client seed in the last Y hands? Did you respond (e.g. stop playing) when I sent a JavaScript partial that didn't really do anything (like change the color or speed of an animation)? **There are many metrics a house can use to segregate players.**
The house only needs to increase the house edge to 1-2% in order to see significant gains in the bottom line.
The goal behind this post is not to protect you or me. You seem to have a good background in the material and would be able to recognize an exploit, easily. Raising public awareness to the general public on the potential vulnerabilities is important to me, and is thus the motivation behind my writeup.
Thanks again. Keep sending good material!
@_date: 2013-06-06 05:23:51
Thank you, evoorhees, for the good point. I will make adjustments.
**Edit:** There is a 15,000 character limit which will require me to edit the post a little more thoughtfully, so I will make the statement here first and then integrate it into the post as best I can.
The analysis presented here examined a specific implementation of a browser-based "Provably Fair" system. Other implementations of this concept will vary from site to site, and may or may not exhibit similar vulnerabilities. Non-browser based implementations of Provably Fair (such as SatoshiDice) do not exhibit these weaknesses, and are not the focus of this analysis.
@_date: 2013-06-06 04:58:42
Thank you, PrimeStunna. I appreciate the kind words.
Yes, while identifying the potential exploits, my colleagues and I also developed a drop-in replacement for the "provably fair" system (you might call it "Provably Fair II"). We also developed a novel solution to the mutual-distrust problem that is a different take on the issue. It's currently being peer-reviewed, internally.
Both implementations preserve the player experience, such as being installation free and independently verifiable.
Since the methods are not entirely owned by me, I cannot discuss them at this time. I'm sure someone will take us up on our research and you'll see it implemented in the near future.
The outlook is very bright - I am certain "provably fair" is here to stay, albeit in a stronger form.
@_date: 2013-06-06 17:01:56
Thank you for your response and welcome to the discussion, libertaad.
When my colleagues and I set out to analyze Provably Fair on bitZino, we asked ourselves a couple of questions:
1. Can we produce compromised, but computationally accurate, "provably fair" shuffles?
2. Can we exploit these shuffles against the user to increase the overall house edge at minimum risk?
And after careful review, the answer is clear: Yes, a house can exploit players while claiming to be "provably fair".
The crux of this scheme relies on two components: population and risk. Population is controlled by discrimination, and risk is mitigated by throttling.
The post makes a very strong assertion that savvy users would be segregated away when deploying these cheats, either through bet or browser discrimination. We have developed the protocols for these techniques but have not yet released them. As public awareness on this topic increases, I will release the supplemental material which will round out my claims. The reason: my colleagues and I have been very concerned that the research presented here can be used as a zero-day exploit against players. The research could be implemented *today*, before players become aware of the issues, all while possibly being cheated out of bitcoins.
And again, all the house is trying to do is increase the overall house edge. If the house identifies vulnerable players and starts suggesting client seeds (a technique described above), then later a few of those players start inputting their own client seeds each hand, *the house was still successful in deploying the exploit.* The house does not need to cheat the entire customer base to be successful. Even if some of them (as you said, just a handful) independently compute unique client seeds, the remaining players are still vulnerable.
This is why we claim that the browser-based Provably Fair implementation is compromised. In fact, I believe you have alluded to that in your closing argument. If Provably Fair allows a "handful" (or more) of savvy users to ensure the house isn't cheating, and I can show that the remaining majority of users are still vulnerable to exploitation, then the system cannot be reasonably claimed as "fair" and, at the very least, cannot be "provable".
Thank you again for your post. If you lived closer, I'd take you to lunch for a lively discussion on the topic. Reddit, however, is just as fun! 
@_date: 2013-06-06 03:46:57
Thank you for your question, chriswilmer.
The mechanics are different with SatoshiDice. The rolls are completed by using data from the public blockchain. Players do not have to access the website in order to play.
BitZino is different. The player is generally required to visit the website in order to play, and the exploits illustrated here involve HTML and JavaScript partials.
@_date: 2013-06-06 04:15:03
Thank you for your comment, JackPerth.
In my analysis of bitZino, the typical hand operates in the following manner (using Blackjack as an example):
1. A user visits the website. The client seed is generated and a server hash is presented.
2. The user clicks 'Bet'. The client seed and server hash remain displayed.
3. When the user stands or busts, a new client seed is generated and a new server hash is presented.
The claims made in this post argue that there are multiple ways to influence, predict, or otherwise compromise the client seed prior to making the bet. This allows the house to influence the final outcome of the deck.
I also analyzed SatoshiCircle, and in my opinion, players are also vulnerable to the exploits illustrated in this post, since the client seed is generated using a JavaScript function.
@_date: 2013-06-06 04:37:46
Thank you for your kind words, interfect.
**Stalling** is the easiest way a house could get another shot at getting the deck to be shuffled with a new client seed.
You bring up a good point about no-risk discovery methods. Another exploit which does not exchange code involves `Math.random()` and **Browser Discrimination** which, in earlier browser implementations, can be compromised if the server can correctly predict the initial state. Older implementations seeded the PRNG with the current time in milliseconds. If the server could predict the exact time a new browser tab was opened in milliseconds (basically scroll through every millisecond in the last few minutes), it can start predicting client seeds. It would operate exactly like **Controlled Secret** without sending any compromising code.
Additionally, my post shows a `random()` function that utilizes `window.crypto` to generate more secure random numbers. When it fails for any reason, it falls back to a less secure `Math.random()`. Unfortunately, that `window.crypto` does not exist in older browsers and certain tablets. You do have to travel pretty far back in time, however, for the server to have a good chance at predicting the initial state (such as Google Chrome 3, but the current version is 27).
@_date: 2013-06-07 19:09:00
Thank you for your comment, tbak, and welcome to the discussion! It's great to see casino operators here evaluating our work.
I will discuss the economics and motivations of why a house would cheat, as well as the discrimination methods, in the second analysis. The reader will hopefully understand, as I have tried to explain in my first post, that the implications of getting caught bear nothing onto the notion of "provably fair". Remember, the idea of this whole concept is to make it so a house cannot cheat. The identification of exploits weakens the current browser-based implementation of Provably Fair, and as you probably know, *cryptographic systems never become stronger over time*.
Based on your comments, it seems clear that many of the counterarguments are based on detection, suggesting that people are both aware of what to look for and are actively doing so. To be quite honest, I am unable to imagine a high-stakes player (the target of these exploits via Bet Discrimination) compromising their playing experience to such extent as to perform a network analysis on every hand.
To put it into perspective, if the house wanted to cheat this player by suppressing royal flushes in draw poker at, say, 1 BTC wagers and above (to increase the house gain by a theoretical maximum of 1.90%), a player would be expected to analyze the network for about 40,000+ hands before even being given a good opportunity to detect cheating. 
More illumination will be provided in the second analysis. I look forward to more discussion on these issues.
@_date: 2013-06-06 08:55:50
Thank you for writing, killerstorm.
Yes, it is definitely possible to serve JavaScript partials to a client, and such a practice is becoming mainstream. If you're familiar with [Rails]( you can check out a tutorial hosted by RailsCasts, "[jQuery &amp; Ajax]( In the tutorial, the server renders Javascript partials. Unfortunately, this particular episode may require a paid account. I will try to locate another example.
To answer your second point: the server does not need to push the code, it simply renders the partial when the user interacts normally with the website. To play the games, a user will need to eventually click on 'Bet', 'Draw', or 'Deal' -- creating a request. The compromised code can be returned during any one of these interactions.
The compromised code is rendered in the browser, but does not modify the static files that are initially served to the client. As a result, someone clicking 'View Source' to examine the code will be able to verify that it was fair and legitimate, even if compromised JavaScript had been sent. This is why I described it as a "beautiful" exploit.
On most browsers, you are able to examine network data passing between the client and server, so it is possible to see the partials, but detecting them might be another matter (more on that when I grab a free tutorial).
Yes, I agree, it is definitely possible to implement a provably fair game in a browser. My claim is that the current implementation is very weak and vulnerable to exploitation by the house.
Thank you again for your comment. I hope I've clarified this point.
@_date: 2013-06-06 08:36:49
Your idea is actually very valid, reddit_chaos! One of our earliest thoughts on the issue was to use a "clearinghouse" to moderate bets between players and the house.
Interestingly enough, I've read that the general trend for *land based* casinos may be going in this direction. Instead of individual machines controlling their own random numbers, they would just be low-cost computers with fancy monitors. All of the actual gaming logic would be done across the network on centralized servers.
Fortunately, a clearinghouse is not needed to solve the Provably Fair conundrum for web-based casinos.
Thank you for your input!
@_date: 2013-06-06 07:08:14
Thank you so much, ThePiachu, for your kind words! I enjoyed writing it.