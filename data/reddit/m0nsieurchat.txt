@_author: m0nsieurchat
@_date: 2014-06-11 14:39:14
This comment might not get upvoted by I feel that it is my duty to write it.  
  
From what I know on my day job (I work at an ISP - Internet Service Provider as a senior network engineer), the fact that GHash.IO not being evil is not sufficient  
  
Here is why : all of their stratum mining addresses (nl1, us1...) are part of the same IPv4 address space announced by only one ISP : AdvancedHosters   
See - 
They might update their DNS zone at a fixed rate BUT at the time of this comment :  
us1.ghash.io - 46.229.169.89  
nl1.ghash.io -  88.208.33.202  
The purpose of the attack is to hijack those IPv4 address spaces, enabling an attacker to point the miners using GHash.io stratum gateways to his own mining infrastructures (AKA hijacking hashrate !!) 
  
I won't go into any detailed technical analysis but - on the Internet, it is *easy* to hijack an IPv4 address space. What you need to do is to be a registered ISP with an AS number in order to hijack another operator's prefix. 
(You find there is too much conditions in order to achieve such an attack ? You don't know me, but I can. And I am not the only one. We are thousands. I would lose my job doing this. But all I need to do is connect to my edge BGP router and announce GHash.IO prefixes on the major Internet Exchange - All the traffic will flow to my routers instead of going to AdvancedHosters edge routers.)  
We once hijacked some of Spotify's IPv4 prefixes by mistake and it perfectly worked - hundreds of gigabytes of traffic flew to our router that had nothing to do with Spotify.  
More infos about IPv4 prefix hijacking - Real life example :   
  
I'm not fond of cnet but it describes how Pakistan Telecom hijacked Youtube's prefixes. Feasible for Youtube, why not GHash ?
TTnet (Turkey) hijacking the WORLDWIDE internet trafic :  
China hijacking the ENTIRE internet trafic for 18 minutes. I don't need to tell you why and what they did with the mirrored data going through their routers. The entire internet was slowed down but still working :  
What is the purpose of such an attack ? Either disrupt Bitcoin mining rate by shutdowning GHash.io WORLDWIDE until ISP operators are starting to put countermeasures or the bitcoin difficulty readjusting
OR set up a mining stratum // node on my own infrastructure with GHash.io hijacked IPs and mine blocks (those blocks won't be invalid they WILLL BE accepted on top of the blockchain) and earn $$$$$$$$$$ from it.  
Solution ? For the technical guys working @ ISPs // Carriers there is the RIPE objects / RPKIs in order to secure IPv4 prefixes and tie those to an ISP, but the percentage of ISPs applying these measures is dangerously close to 0%. 
In fact ; there is no better solution than spreading the hashes.  
pointed out that SSL secured stratum would work - Why not asking your pool ops for that feature ?
  
TLDR ; anybody working at an ISP with an access to the BGP routers can hijack GHash.io trafic in order to temporarily disrupt the blockchain OR mine valid blocks to earn money. Having nice people working at GHash.io is not sufficient as anybody else could hijack GHash.io IPv4s.
@_date: 2014-06-11 20:06:53
From my comment below:


However ; You still need a registered AS (Autonomous System) number in order to realize an IPv4 hijack and EVERYBODY will be aware that your AS hijacked an IPv4 prefix.
It could be stealthly done by putting an agent in a foreign ISP in a foreign country.
For non-tech people trying to understand this, the Internet routing table is a bit like the blockchain (just a dumb comparison, in fact this is not the same thing at all ) where every IPv4 prefix announce is made public. You know who announce which prefix, where and when.
@_date: 2014-06-12 12:01:23
I'm sure I would not risk my job and infinite problems for only 25 BTC   
People with access to BGP routers are thousands but they still need to be into the cryptocurrencies hobby and malicious before we ever see the execution of such an attack.
@_date: 2014-06-12 11:55:41
Talking to reddit is an art with social codes and ancestral techniques.
@_date: 2014-06-12 11:58:38
Unfortunately, no.
It is about how BGP (Border Gateway Protocol) works regardless the IP version.
A good point made by is to implement and use SSL secured stratum protocol while the ISPs interconnecting to each other slowly implement RPKI and make use of announce filters
@_date: 2014-06-11 20:50:20
Nope, you can put more than one coinbase payout address on blocks. This is how Eligius payout queue and P2Pool work.
@_date: 2014-06-11 20:42:05
Yay SSL would be a good solution for centralized mining pools because an entity hijacking the IPv4 prefix of the pool wouldn't have the private key to prove they are the legitimate pool.
However you can still shutdown a major pool by redirecting the pool prefixes to a blackhole.  
  
EDIT  :
  
I'm quite a curious guy ; I tried to connect on us1.ghash.io on the HTTPS port (443) - I know this won't be any stratum SSL secured port.
Guess what ? There is a certificate (signed from usertrust) but is not valid as it was designed for : 
This domain still resolves to 46.229.169.89 which is us1.ghash.io as well.
While continuing my researches I found out  which is in the same IPv4 address space and affiliated to  which is affiliated to  (same person / company) which is affiliated to 
Just.. Funny.  
Edit :  is another entity affiliated to ghash.io // bitbonanza // bitcomplete  // bitfury.org
  
EDIT : the circle is now complete :  
;; ANSWER SECTION:  
mail.bitfury.org.       3004    IN      A       93.158.211.123  
;; ANSWER SECTION:  
mail.realab.org.        28646   IN      A       93.158.211.123  
;; ANSWER SECTION:  
mail.bitbonanza.co.     28795   IN      A       93.158.211.123
@_date: 2014-06-11 20:25:59
Thank you ! 
Let's say 500 bits equals one story : those IPv4 hijacks are common when you're working at an ISP or Carrier.
It is not a lie that governments and secret agencies are used to execute BGP IPv4 hijacking in order to mirror the datas going through their routers.  
Scenario : hijack whole internet prefix (0.0.0.0/0), log the data (It is sure they cannot log ALL the data but they are able to filter the interesting data and only keep those) and forward it to the legitimate destination so that nobody notices it.
 
This article describes how "someone" hijacked prefixes belonging to US agencies and offices. The trafic flew through Iceland before going to the legitimate destination :  
China hijacking the whole internet trafic for 18 minutes - Everything was slowed down but still working. I don't need to tell you what they did with the data they intercepted :  
@_date: 2014-08-20 12:10:16
Nothing is impossibru for Bitcoin's CEO.
@_date: 2014-06-11 20:08:18
Correct.   
Painful to realize, P2Pool might be the best solution against prefix hijacking.
@_date: 2014-06-11 21:22:46
How hard would it be to push SSL secured stratum protocol ?  
500 bits @_date: 2014-06-11 20:02:44
Answering your questions (thanks for reading that long comment by the way !) :
This attack would work on every IPv4 address space.  
Whereas some protections were designed against those hijacks, there is a few ISP / Carriers really implementing them.   
Most of the time, when such an attack works, the trafic is not hijacked for everyone.  
Internet routing tables are VERY complicated and unique for every ISP depending on where they pick and send their trafic.
Some people might get hijacked and redirected to the malicious routers, others don't.
From a dumb technical point of view, P2Pool would be vulnerable if someone decided to announce the whole IPv4 address space (in fact, you need to announce a bigger prefix than the legitimate one) or every IPv4 hosting a P2Pool.
A government or entity could realize such an attack.
However, I don't want it to sound like a "Dun Dun Dunnnn". Internet is very complicated and its design implies security flaws well known by the ISP and the people working on it. Like every place ran by businesses wanting to make money, the common sense is sometimes placed apart and measures to secure the system slow to be adopted.
As this security flaw (which is how internet routing works, not a Bitcoin flaw) is well known, an IPv4 hijack never lasts for too long (ISP always have a "NOC" - Network Operation Center where everything is on monitoring. An IPv4 hijack is instantly reported and measures taken. Those attacks usually last from 1 minute to a few hours. I remember having someone from Spotify calling our NOC by phone a few minutes after we started to announce some of their prefixes by mistake).  
I'm 100% sure it would work for GHash.io (or any other pool), but I don't know for how long. 
@_date: 2014-06-11 21:02:55
Right, and we're talking about the worst. Nobody ever will have the guts to execute that attack, eh?
@_date: 2013-11-28 13:18:59
Oh wow Reddit... I'm used to agree most of the time with you guys. But right now, this topic seems similar to a FIAT-Maker/Banker/Terrorist/Politician bitching about Bitcoin to me.
Freedom, and that kind of adjectives the community talks about.. Just let the other cryptocoins alone ? If they succeed, good for them. If they crash, c'est la vie.
