@_author: hrghr
@_date: 2013-04-13 04:40:36
You can't always build a bigger bottle, or use more of them.
You can only run a single order book on a single machine. So you are limited by your CPU.
Which is why you need to write a matching engine that doesn't waste cycles (that is, incidentally, what all the professionals developing exchange software do).
By actual engineer, I mean experienced engineer who get paid to write software, as opposed to every script kid who says "premature optimization is bad" every time you mention optimization.
@_date: 2013-04-13 00:52:43
I'm sure there are, but I don't know one in particular (I've only worked with real exchanges, and they aren't open source obviously).
There's a decent book called "Practical .NET for Financial Markets". It basically explains how to write a matching engine in C# (it's from the .NET 1/2 era, so the language has improved since, but it's still pretty good).
@_date: 2013-04-13 04:23:50
In Gox we trust... not.
@_date: 2013-04-12 03:04:00
Stabilize around which value? What's the correct price of a bitcoin? It's going to keep oscillating because there is no fundamental value whatsoever.
@_date: 2013-04-13 14:19:10
Yes, the drawing does help.
You're right about the second point, of course: between the time a trader sends an order, and the time it's processed by the exchange, the book will have changed, because there are concurrent users. That's fine (and, as you said, there's nothing one can do about it), as long as the trader gets the best possible execution when the order is processed.
Orders are typically assumed to be atomic operations on the book, but your system does seem to work.
I'm still trying to find an edge case to break it, though ;)
@_date: 2013-04-12 14:20:44
You have no idea what you're talking about.
You need to maintain a single order book. That's the difficult part.
@_date: 2013-04-13 03:54:57


You need to tell that to those idiots at the LSE, NASDAQ, etc. who all run a single order book per machine.
@_date: 2013-04-12 14:26:08
I'll put this up there.
It's not as simple as throwing more hardware at it.
They're probably using some shitty code written in PHP, with crappy algorithms.
It's not going to scale simply by throwing more hardware at it.
@_date: 2013-04-12 16:17:51
@_date: 2013-04-12 15:35:38
You have all the qualifications required to write an exchange trusted with millions of actual money and compete with Magic the Gathering Online eXchange.
Just don't forget to use NoSQL and cloud. You know, for scaling.
@_date: 2013-04-12 14:26:25
They lack skills.
@_date: 2013-04-14 02:14:54
Well, there are libertarians who have formally studied economics (I'm one). [this is why I said "reddit libertarians" and not "libertarians"]
It's entirely possible to both want less government interference in our lives and yet not speculate on gold or bitcoin.
@_date: 2013-04-12 04:21:34
I don't think so. It's been going on for 2+ years.
I know how to write exchange software, I know many people who write exchange/trading software. As far as I know, they're still working and they are have no plan to risk their 9-to-5, six-figures salary jobs to write Bitcoin trading software.
Thankfully you have MagicalTux, a high-school dropout, writing a shitty exchange in PHP.
@_date: 2013-04-14 00:28:31
EDIT: I'm actually answering to the poster above ("frontbutthole").
It's not even that. Read the actual paper by Satoshi. He/she/they didn't want to revolution the economy or whatever (they're not economists, which is why the economic underpinnings of bitcoin are braindead). They wanted to create a secure, anonymous *cash* system (i.e. a transaction system).
I'm pretty sure they're laughing (or cringing) that some people are actually moving their wealth into bitcoins with a hypothetical USD value.
@_date: 2013-04-13 10:18:12
I'm not following you.
You don't need to move anything around (except at the end of the trading day if you want to stay flat overnight, but you could keep the cash in there for weeks if you want and/or trust the exchange enough to not lose it).
@_date: 2013-04-12 04:02:47


This might work if you manage to have a widely used protocol with a description for what you buy (e.g. novel, can of tuna, etc.)
You could then compute the CPI from that information.
@_date: 2013-04-12 14:37:02
Actually, real matching engines aren't built around RDBMS, which is too slow.
Books are typically small enough to fit in RAM, and that's exactly how it's done (typically in process, on a single machine). Then you can log the trades to a RDBMS through a queue, and this needs not be in real-time.
@_date: 2013-04-12 04:23:52
In the forex market you can make money by predicting central bank actions, doing macroeconomic forecasts, etc.
None of this applies to Bitcoin.
@_date: 2013-04-12 23:30:55
There are good developers in Japan. I don't think they'd want to work for a semi-legit,fly-by-night operation run by expats, though.
@_date: 2013-04-12 23:39:36
Not every performance decision is premature optimization, you know.
Microsoft doesn't exactly write Office in Python then rewrite it in C or C++.
@_date: 2013-04-13 10:53:19
Well, it is theoretically possible to do it across multiple machines if you really want. It's going to be stupendously slower, though.
@_date: 2013-04-13 03:47:58
You are the one who is right.
It is a CPU bound problem, and as I've said in other comment, virtually every real-world exchange is written in Java, C++ or C.
@_date: 2013-04-12 04:13:29
Useful for what?
The only reason I wouldn't want to pay using my national currency is if I want my transaction to be anonymous (for gambling, porn, prostitution, drugs, etc.)
That's pretty much the only legitimate case for Bitcoin. It certainly is a valid market, but it's quite limited. And unfortunately it's the kind of stuff the government is likely to target.
I think there is a future for crypto-currencies for those markets, but probably not Bitcoin.
@_date: 2013-04-12 03:38:26
The market for basketball cards is probably growing, too.
@_date: 2013-04-13 03:50:58
No one uses Erlang or Haskell for real-world financial software.
@_date: 2013-04-13 04:02:53
Not for real-time trading.
Sure, they use everything from Python to Matlab, OCaml, etc. to develop quant models.
But for trading it's pretty much C++, Java and C
@_date: 2013-04-13 09:47:15


Well, in that case we *know* it's going to be a problem.
@_date: 2013-04-14 00:39:04
Apparently even fucking Satoshi doesn't understand Bitcoin! How crazy is that? Because if you read, you know, his actual paper called "Bitcoin: a peer-to-peer electronic cash system", he uses the word 'currency' once, in the introduction, to describe physical cash.
TIL: bitcoin is not a currency, according to its own inventor.
@_date: 2013-04-12 16:24:58
Read a good investment book (e.g. "A random walk down wall street") and talk to a financial planner from a good bank.
@_date: 2013-04-13 04:06:52
Premature optimization is when you optimize stuff you don't know you need to optimize.
Designing what is obviously the bottleneck with performance in mind from the beginning is what every actual engineer would do.
@_date: 2013-04-12 04:33:54
Writing good exchange software is not terribly difficult for competent developers. MtGox could hire competent developers themselves, if they knew what a competent developer is in the first place.
The problem is everything else. You have to deal with financial regulations, customer support, etc.
At the moment MtGox and other exchanges are cutting corners everywhere in that regard, but it's going to come back and bite them in the ass when mom and pop investors start losing their bitcoins.
@_date: 2013-04-13 04:46:01
Maybe I should explain why it's that important.
There are basically two options: either your exchange is dominant (like MtGox), in which case you obviously have a lot of traffic.
Or maybe we have many exchanges. In which case you *also* have a lot of traffic, from arbitrageurs.
So, in both cases, you'll have many, many transactions to deal with.
Unlike stock exchanges who can split different instruments on different boxes, you're only trading one product, so you can't do that.
@_date: 2013-04-13 23:51:07
Wow, I had no idea.
And clearly those are the ones interested in Bitcoin, right?
@_date: 2013-04-13 15:04:32
Cryptographic algorithms are the building blocks, and they're considered pretty safe indeed, but the protocols built using those building blocks (i.e. Bitcoin itself) might be flawed.
@_date: 2013-04-12 14:24:18
Erm, no.
@_date: 2013-04-12 23:27:33
Ah ah ah ah ah.
Really, that's a good question :)
@_date: 2013-04-12 14:51:25
Vous avez ete Goxed
@_date: 2013-04-12 23:42:08
Yes. Virtually every matching engine/exchange platform I know of is written in Java or C++ (there might be ones written in C# too, but I'm not aware of any).
@_date: 2013-04-14 00:25:16
OpenBSD, well known as the most performant operating system around!
@_date: 2013-04-13 14:31:03
There are absolutely zero drivers for Bitcoin. Not even Bitcoin adoption.
Bitcoin could be successful with bitcoin @ $2 or bitcoin @ $2000.
There's no reason for one vs. the other.
@_date: 2013-04-13 10:10:28
You don't need to move anything (in fact, you don't want to, because it's too slow, as others pointed out).
You just need to start with enough cash and bitcoins on each exchange. When you see an arbitrage opportunity, buy the cheap one on exchange A and sell the expensive one on exchange B. You end up with the same overall bitcoin position, but your overall cash position has increased.
@_date: 2013-04-12 15:38:19
How do you plan to store the users' passwords?
@_date: 2013-04-12 14:57:04
This is probably going to happen at some point.
Write some open-source, BSD-licensed matching engine and let the exchanges use it.
@_date: 2013-04-12 03:51:59
I live far away from the beach, so you can't imagine the work it is for me to bring back a bucket of sand...
Do you want to buy some, buy the way?
@_date: 2013-04-12 03:48:02
It's perfect if you exclude its completely crazy volatility and the infrastructure that is essentially built by incompetent teenagers and prone to crashes, lags, DDoS attacks, hacks, etc.
The thing is, it's not even genuine volatility. It's purely stochastic.
@_date: 2013-04-12 14:35:24
You can't use NoSQL to write a matching engine.
Gosh, people have no clue on this thread...
@_date: 2013-04-12 03:16:37
It's not going to happen.
Have you noticed how everyone here is trying to make money? And by money I mean US DOLLARS?
Economists have a sound principle that actor's actions are always more telling and relevant than what they say.
@_date: 2013-04-12 14:22:18
You have no clue either.
The main point of a real-time kernel is to have predictable interrupt handling. It's got absolutely nothing to do with the kind of stuff they're doing (heavy transactional processing).
Which is the reason why no exchange software runs on a real-time kernel.
@_date: 2013-04-12 16:14:35
The rule is, generally, to pick whatever currency you are using on a daily basis (there are exceptions, if you live in a country with very volatile exchange rate and high inflation). But EUR is fine. Otherwise you expose yourself to foreign exchange risk.
The best thing to do, really, is to go talk to a good financial planner. They will give you advice tailored for your particular situation (e.g. stuff to optimized your tax burden).
@_date: 2013-04-12 04:38:44
You can't compare a stock with Bitcoin.
You can value a stock based on its earnings. So you can explain, ex post, why it increased or decreased in value at a particular point in time.
You can't do that with Bitcoin. Can you explain the pattern we've seen today? Was there any information pertaining to the future of Bitcoin explaining this completely fucked up pattern?
@_date: 2013-04-13 12:34:50
OK, so while my hypothetical order is wrecking havoc on the ask side of the book, what do you do with the next order in the queue (on the front-end)?
@_date: 2013-04-12 16:22:07
The euro, as a currency, is perfectly fine.
The problem is that certain banks are not.
Generally, as a depositor in the euro zone, if you are under the government guarantee you will be fine, but as we have seen with Cyprus the limit can be crossed.
@_date: 2013-04-12 15:27:12
The bottleneck is the matching engine.
@_date: 2013-04-12 15:41:25
You talk like a fag and your shit's all retarded
@_date: 2013-04-13 03:45:33
Then you think wrong.
The reason you typically have those huge ass queues in front of a matching engine is precisely because it's a CPU bound problem.
@_date: 2013-04-12 03:09:26
For any asset like a bond, stock, etc. fluctuations are normal; they're the noise component of a random walk with drift model ON TOP of the expected value (the fundamental value).
The problem is that Bitcoin only has the noise component. The price is not oscillating around any value or trend. It's just freely moving, randomly.
@_date: 2013-04-13 12:50:55
We should check on legal advice forums if the owner is asking stupid questions.
@_date: 2013-04-13 14:19:30
Because I've worked with such systems.
@_date: 2013-04-12 14:43:38
Real-world exchanges get around that issue by splitting the load across instruments (e.g. different stocks on different boxes), but yeah, for a single instrument you need to maintain price-time priority, so you can't distribute it.
@_date: 2013-04-12 03:12:05
There is nothing to anchor the value of a Bitcoin at the moment.
Someone needs to be saying: "I'll always pay X Bitcoins to buy this kind of stuff", or "I'll always sell this product for Y Bitcoins". This is the role a central bank plays for a grown-up currency.
@_date: 2013-04-12 03:36:16
A *credible* and *trustworthy* actor able to make a promise they can keep to always buy or sell Bitcoins for a fixed price.
If they were saying: "I'm selling this widget for 20 Bitcoin" or saying "I'll always buy 1 Bitcoin for USD 20", that would work.
Again, they'll have to be credible/trustworthy.
@_date: 2013-04-14 03:00:19
I agree with you (in fact I think central banking of one form or another is compatible with libertarianism). And that's why I'm fairly suspicious of the Mises Institute kind of libertarians (even if I agree with them on the basic premise that government should be small).
They're also wrong about their rejection of all orthodox economics, etc.
@_date: 2013-04-12 03:55:34
I'd say it's more likely than not to completely fail.
It's used by:
* teenagers who like to have fun with new technology (nothing wrong with that, I was one of them)
* people who want to do bad stuff (drugs, laundering, etc.) with anonymous currency
* speculators who want to make money because it's the new craze
* Internet libertarians
I see a lot of posts about having Amazon, etc. to accept Bitcoins.
But what's the point? I can already buy books online using my credit card. I've been able to do that for 10+ years.
There is little genuine use for Bitcoin. It's cool, but it's not terribly useful.
@_date: 2013-04-12 03:44:50
(Of course, in practice it cannot really work, because there is a finite amount of Bitcoin.)
@_date: 2013-04-13 11:54:45
It won't work because of the price priority requirement.
Let's say I send a buy order, for 1000 shares at a price of 80. You have to clear all the asks below 80 first (price priority). So, depending on the state of the book, you might end up with many trades for a single order, at different price points. For example:
*    7 @ $76
* 100 @ $77
* 200 @ $78
* 500 @ $79
* 193 @ $80
How does your system deal with this case?
@_date: 2013-04-12 15:52:35
Sell the bitcoin now at whatever price you can get.
Since you're Italian, move most of your euros into a *good* offshore account (a big UK bank in the channel islands is a safe choice).
Then, according to your investment horizon and risk profile, invest in a mix of cash, fixed income mutual fund and equity mutual fund.
@_date: 2013-04-14 00:44:07
That's not the proper way to do arbitrage.
You don't need to transfer the coins around (it's way too slow anyway).
You need to do simultaneous transactions on both exchanges. When it's 102 on bitfloor and 92 on MtGox, sell 1 bitcoin on bitfloor and, at the same time, buy 1 bitcoin on MtGox.
Assuming you get immediate execution, your bitcoin position has not changed. You still have 1 bitcoin, but it's in another exchange (it moved from MtGox to bitfloor). But your cash position has increased. You paid 92 and you received 102, so you have $10 more (you need to deduct fees).
@_date: 2013-04-12 03:22:11
Fiat currencies are stabilized by a central bank.
Free banking currencies are pegged to a commodity such as gold.
There is no such thing for Bitcoin, which explains why it's randomly moving with no particular mean value or trend whatsoever.
It could have been a good system for anonymous payments, but it's clearly not a currency. And because it tries to be a currency, it's not a great system for anonymous payments.
I'm sure an alternative will emerge that uses cryptography to allow anonymous transfers of money but does not try to make that mechanism a currency itself.
@_date: 2013-04-13 09:48:10
There's a difference between open source software and people running services dealing with real money.
@_date: 2013-04-13 14:28:32
Which can be rephrased as "what the market thinks the market will think". That is the big problem with Bitcoin.
With a stock or a bond, it's "what the market thinks the future cash flows will be" (based on information about what the entity in question does). A huge difference!
@_date: 2013-04-14 00:52:13
What people don't seem to understand is that HFTs are the one permitting to break up exchanges (which is exactly why HFT has risen as market reforms have broken down exchange monopolies).
So if you want to see MtGox lose its monopoly you should cheer up on the HFT guys spreading the liquidity around other exchanges.
@_date: 2013-04-14 00:13:43
Retail e-commerce was, in the US, $186.2 billion in 2012 [1]. That's an average of $510 million per day. If Bitcoin represents 1% of that volume, that would be $5.1 million per day in transactions, which is realistically supported by a bitcoin @ $2.
Of course, there is also e-commerce outside of the US, and some days are much more active than others (e.g. around Christmas time). And e-commerce spending grows, year on year (perhaps Bitcoin would make it grow even more!)
A $2000 bitcoin allows circulating $22b, which represents about 15 days of total e-commerce spending.
I did this analysis in 5 minutes, so it's worth what it's worth. Now, if people use Bitcoin as a store of value (and not as an anonymous transaction mechanism, as it was designed), then yes you can imagine a Bitcoin with a crazy high valuation (but it's not going to happen).
[1] 
@_date: 2013-04-13 04:49:46
The traders where?
If you're talking about non-HFT traders, they generally use VBA and if they're sophisticated Python, R, Matlab, etc.
High-frequency traders use C++, Java, C
@_date: 2013-04-12 04:16:19
That's irrelevant. Iranian authorities can ban Bitcoin just like they ban the rest.
The problem is their totalitarian government, not fiat money.
@_date: 2013-04-14 00:34:22
Most of the reddit libertarian world.
@_date: 2013-04-13 14:24:34
"It's not a bubble because the Silicon Valley folks are on it."
@_date: 2013-04-13 04:22:09
They have a VeriSign certificate, so if your browser doesn't recognize it, that means you are not actually talking to MtGox, but to some bad guy trying to get your credentials.
Run away!
@_date: 2013-04-13 12:48:29
Why exactly should Bitcoin be significantly more valuable next week than today?
Where does the growth comes from?
@_date: 2013-04-12 04:08:52
Who isn't able to do it?
@_date: 2013-04-12 15:47:40
Don't forget to hash the passwords.
You need to find whatever hash is the fastest (MD5 is a good bet). You'd be surprised how slow some of the so-called dedicated password hashing functions can be...
@_date: 2013-04-12 02:59:12
The price is bouncing back and forth between some point and half its value in less than one hour and you expect merchants to take that risk?!?
@_date: 2013-04-13 03:49:49
Garbage collection does not start randomly just to piss you off.
You can control when it happens so it doesn't end up being a problem.
You can totally write low-latency software in Java if you don't do stupid memory allocations on the critical path.
edit: as sporkmonger said, 10s stop-the-world is not your typical garbage collection behaviour in 2013...