@_author: iamnotcraigwright
@_date: 2015-12-10 22:56:52
That is what I was attempting to test. Just how much faith should be placed in the identity of any sender to the bitcoin-dev mailing list? Not much.
Obviously, I didn't do anything to cover up the fact that this was a spoofed message. I really didn't expect the message to go through on the first try (well, second, after waiting for the 5 minute greylisting), and assumed that it would at least get caught based on the SPF record for Vistomail. The Aug 15 message to the mailing list from satoshi at least appeared to be sourced from a valid SPF sender for the domain. But there are still a lot of untrusted steps in there.
I have reason to believe I could have originated the message from the Vistomail SPF-approved list last night, though that would have been pushing ethical boundaries.
Anyone with access to the Vistomail server, legitimate or illicit, could easily spoof the Satoshi address while matching the appearance of legitimacy to that of the Aug 15 message.
Additionally, anyone with access to the linuxfoundation.org SMTP server could trivially spoof the message headers to make it appear from anywhere.
Hopefully this serves as a lesson, as dumb as it may be. Satoshi was pretty careful to ensure his primary, public communication channels could not be used as proof of identity. The strongest remaining mechanism to validate a message from Satoshi would be a signature with the private key of a known coinbase output, preferably the genesis block.
@_date: 2015-12-15 23:40:52
I suppose they could have been. Although there is some indication it was done by the listserv.
    X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
            smtp1.linux-foundation.org
Unless you're insinuating that whole message in the link is fake. I don't really have an argument against that possibility. Anyone on on the mailing list should be able to verify it.
@_date: 2015-12-16 00:11:26


Sure, why not.


Is your suspicion that the operator modified the message, or perhaps spoofed the entire thing, to the detriment of the appearance of running a tight ship?
@_date: 2015-12-10 19:32:20
It goes nowhere. Don't waste your time. No, really, don't bother looking into that any deeper.
@_date: 2015-12-15 00:59:53
I'm aware of how SMTP works. My point is that there are all sorts of protections that have been implemented on top of the protocol. SPF, DomainKeys, IP blacklists, etc. All of those things should have been a red flag - in fact [were a red flag]( Still, the message was accepted by the listserv. And then [manually approved]( for distribution to the list.
    TO: bitcoin-dev
    X-Spam-Flag: YES
    X-Spam-Status: Yes, score=5.7 required=5.0 tests=BAYES_05,MISSING_DATE,
            MISSING_MID,RCVD_IN_PBL,RDNS_DYNAMIC autolearn=no version=3.3.1
    X-Spam-Report: * -0.5 BAYES_05 BODY: Bayes spam probability is 1 to 5%
            *      [score: 0.0457]
            *  3.3 RCVD_IN_PBL RBL: Received via a relay in Spamhaus PBL
            *      [104.231.205.87 listed in zen.spamhaus.org]
            *  1.0 RDNS_DYNAMIC Delivered to internal network by host with
            *      dynamic-looking rDNS
            *  0.5 MISSING_MID Missing Message-Id: header
            *  1.4 MISSING_DATE Missing Date: header
    X-Spam-Level: *****
    X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
            smtp1.linux-foundation.org
    X-Mailman-Approved-At: Thu, 10 Dec 2015 06:57:29 +0000
The only thing that even slowed me down a little was the greylisting that the listserv does. Required making a second connection 5 minutes after the first sending attempt.
@_date: 2015-12-10 16:20:15


Agreed. I thought it would be harder than that.
    $ telnet smtp1.linuxfoundation.org 25
    Trying 140.211.169.13...
    Connected to smtp1.linuxfoundation.org.
    Escape character is '^]'.
    220 smtp1.linuxfoundation.org ESMTP Postfix
    helo mail.vistomail.com
    250 smtp1.linuxfoundation.org
    mail from: satoshi
    250 2.1.0 Ok
    rcpt to: bitcoin-dev
    250 2.1.5 Ok
    data
    354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
    FROM: satoshi
    TO: bitcoin-dev
    SUBJECT: Not this again.
    I am not Craig Wright. We are all Satoshi.
    .
    250 2.0.0 Ok: queued as 01BCADF
    quit
    221 2.0.0 Bye
    Connection closed by foreign host.
@_date: 2017-08-31 16:49:11


Nothing about money transmitter requirements appears to require that the units of value be considered money themselves.


You'd have to better define custody, but nothing in the regulations appears to require that the transmitter hold money. However, the fact that an LN node can participate in a transaction using a different currency than the inputs and outputs (atomic swaps) indicates that value is transferred *to* the intermediaries, it does not simply pass *through* them as it would for an infrastructure provider.


Foreign money transmitters and other money service businesses must also comply with FinCEN regulations or face penalties.
@_date: 2017-08-30 00:36:51
Bitcoin transactions, and even payment channels, are not the issue at hand. LN transactions, across a network of payment channels, are executed in a much different fashion.
In a bitcoin transaction, value does not pass through an intermediary. Like cash payment at the lemonade stand, the value transfers directly from the sender to the receiver. The network merely serves to produce a distributed ledger; a shared recognition of that transfer.
A payment channel abstracts things a bit, but still holds true as a direct transfer of value between two parties, with no intermediaries.
The exposure to regulation occurs when a third-party accepts value from one end of a transaction and makes it available to the other. Especially when there is a fee involved for doing so. Even today, with no new regulation introduced, performing such an activity without a license may violate money transmission laws.
As far as I can see, LN facilitates _exactly the activity_ which is subject to regulation. What am I missing? What features of the Lightning Network design prevent the application of existing regulation to the activities of network participants?  
@_date: 2017-08-29 22:42:18
Concerned, but hardly trolling; I'm genuinely interested in the answer. Bitcoin nodes and miners do not receive and transmit funds between users, they just share a record of the transactions occurring. Lightning nodes operate on a different principle. This isn't a "Government bans bitcoin!" issue, it's a "Government regulates Money Service Business'", which they regularly do.
Purchasing lemonade is a transaction between the buyer and the stand, when it occurs using cash. If the lemonade is paid for with a credit card, absolutely the parties involved in transferring the payment between the buyer and seller are covered by money transmitter regulations.
Much like exchanges operating in the US have had to implement KYC/AML, payment channels - or more specifically *the networks built atop them* - appear to present a significant opportunity for regulation. Simply *evading* regulations is unlikely to be a popular option for businesses operating within the law.
I've an open mind on this issue and am eager to understand how LN was specifically developed to circumvent attempts to regulate it.
@_date: 2017-08-31 16:56:07
They certainly can. That atomic swaps are possible is evidence of this. Consider a payment between A and B with intermediates C and D.
    (A) ---BTC---&gt; (C) ---LTC---&gt; (D) ---BTC---&gt; (B)
Intermediary C has clearly received A's BTC, and the BTC provided to B by D are not the same.
Given the intent and wording of the laws, I think it would be difficult to argue that C and D are simply infrastructure regardless of conversion.
@_date: 2017-08-31 18:53:16
The problem is that the regulations already exist, and they are broad enough to already cover LN. **The activity performed by routing on LN is already regulated.**
FinCEN doesn't need to do anything to extend existing regulations to the LN, its already covered. They could release a clarification that excludes LN from the existing regulations, but that seems unlikely as the regulations exist specifically to regulate this exact activity.
If FinCEN decides that your LN nodes acting as an intermediary while routing transactions is a money transmitter, and you aren't already licensed, you've violated the law. It doesn't matter if you thought the law didn't or shouldn't apply to you. You'll have the opportunity to make your case in court, but there isn't much room for argument here. At least, I have yet to see a convincing argument that LN is exempt. 
@_date: 2017-08-31 17:29:21
I'm not making an argument that it's right or good. But this is the regulatory environment that exists.
@_date: 2017-08-31 18:30:50
FinCEN concluded that the act of mining does not qualify as *acceptance* or *transmission* of funds.


Routing through LN is not equivalent to Bitcoin mining. Value is relayed from node to node. That atomic swaps between cryptos is possible serves as evidence of that.
Transacting as a node imposes an obligation on the receiving node to forward that value for the benefit of the sender/receiver. That's the whole basis of its security.
@_date: 2017-08-29 17:32:53
Any information you can provide on how the implementation of LN avoids the regulation around money transmitter status? From all appearances, LN would at least qualify as IVTS, and thus require licensing and KYC/AML per FinCEN rules. 


@_date: 2017-08-31 16:40:41


 




 


@_date: 2017-08-30 02:23:57


Immaterial? That activity is _precisely_ what the regulations regulate. 


If that is the best explanation for why money transmission regulations don't apply to LN, I hold very little hope for its future.
@_date: 2017-08-31 16:14:47


Despite the terminology, the relevant laws have no requirement that the units of value used are directly considered money.


@_date: 2017-08-31 16:03:06
If you're swapping CS:GO skins as a mechanism to transfer value between two other parties, you might be a money transmitter.
@_date: 2017-08-31 14:49:01


Atomic swaps on LN between cryptos is one of the biggest indicators that LN transactions *are* money transmission. It is obviously not simply the facilitation of a 1:1 transaction between A and B if an intermediate node can perform a conversion. Even if both sides of the transaction are handled in bitcoin, atomic swaps could occur between intermediate nodes.
@_date: 2017-08-24 15:58:36


Non-P2SH nodes see P2SH transactions as non-standard and will not forward them. However, they still receive the complete transaction and can fully validate the witness.
@_date: 2017-09-01 16:18:12
Directly swapping value is usually fine, so long as the swap is facilitating a legal transaction. The problem for LN comes from the fact that swapping value via intermediaries is a regulated activity.
@_date: 2017-09-20 02:57:13
Ugh, gotta earn my 2.5BCH...
any opinion to share on the status of LN hubs as money transmitters under FinCEN regulatory requirements?
@_date: 2016-05-04 05:40:56
The third party (by this I simply mean not-Craig) selection is to shutdown an avenue of attack. It applies mostly to a private demonstration such as the one Gavin supposedly experienced. It also applies to public demonstrations where allowing Craig to select an arbitrary text would demonstrate only that he has the pre and post image of the message, not control of the key. While a subject-specific message closes this gap quite a bit, there is still some room for doubt. In a private demonstration, especially one in restricted conditions, the attack could be even more deceptive.
Edit: That got longer than I was expecting. I think it's worthy of its own post.
@_date: 2016-05-04 00:33:22
Not sure that he would have. But, apparently by design, it is the only thing we have with which to validate a claim to any reasonable extent.
It is not entirely unreasonable that such an important key might be derived through some hard-to-reproduce yet easy-enough-to-remember expansion algorithm applied to a known seed, much like brain wallets.
@_date: 2016-05-04 06:01:47
I'm _reasonably_ confident I could have had the message delivered via a SPF-valid vistomail server, though it would have pushed some ethical boundaries. It was in my escalation plan as I really didn't expect the initial test to work. That thing was off-the-charts spam, and only thanks to one of the list admins' manual approval did it manage to make it through.
@_date: 2016-05-04 07:16:32
These attacks are totally valid, but far more specific and depend on control over more conditions. Direct modification to Electrum exposes potential for detection via signature mismatch and limits the attack to a single implementation. Without the trigger, it is possible that Gavin may notice discrepancies in hash operations for which he is familiar. It would break the ability to test known good/bad signatures using the same platform. Blockchain data is something that can independently checked after the event. Although Gavin can't take anything out of the room with him, he may notice if a different address is provided.
Attacking the hash function with a keyed trigger provides solutions to many of these potential points of discovery. It ties in well with Craig's compensatingly-extravagant infosec certification background. It is a potential method to pull off an up-close magic trick of this proportion. I won't bet coins on it, by any means, but it's an approach _I_ would consider.
@_date: 2016-05-04 00:39:47
I'd accept this in most cases, as it leaves little opportunity for hijinks. The contents of the message could be of more importance based on the conditions of the proof exchange. I'll detail my theoretical attack on the style of exchange that Gavin has described in another comment later. It's pretty similar to what has been proposed elsewhere, though I don't think I've seen my exact scenario laid out yet. 
Edit: thought experiment on fooling Gavin: 
@_date: 2016-05-04 03:44:04
@_date: 2016-05-04 13:58:36
Parameters for the creation of the message could have been worked out ahead of time, committed to in the NDA. If conditions were not favorable, simply refuse to sign the message. Haven't convinced anyone but there is no evidence of fraud.
@_date: 2016-05-04 07:54:02


This could be handled via the NDA. If we previously agreed to a shared generation of the message as a condition of the test, I can simply refuse to sign the one-party message. I have not convinced Gavin, but he has no evidence I have attempted to defraud him.
I'm still sticking to the trigger token. Without it, signing of Gavin-known messages with Gavin-known keys will not result in the expected output.
Edit: Also, if I may be so bold, I propose we standardize Gavin and Craig as the actors when describing cryptographic identification verification attacks, in the tradition of Alice, Bob, Eve, Mallory, et al.
@_date: 2016-05-05 13:56:38
I'm partial to attacking the hash function in memory. This would allow for triggering the attack only for specific messages (those with the trigger token "CSW") while minimizing the detectable footprint. 
Edit: It also fits with the newly revealed info that Gavin had a copy of the first 100 blocks, so it wasn't likely a MitM to provide a false blockchain.
@_date: 2016-05-03 16:02:19
It isn't legit, I spoofed it during the last round of Craig Wright bullshit.
Don't accept anything less than a public and validated Genesis block based signature of a third-party chosen plaintext.
@_date: 2016-05-04 14:20:11
I cannot explain that part. For what its worth, I'm not calling out any red flags here, just trying to match the proposed attack to the limited description of the event.
@_date: 2016-05-04 14:56:39
You are correct, it was not operating as an open relay. And at that time registration of new accounts was disabled. That is hardly the only way to have a server send an email on your behalf, however. This leads back to those ethical boundaries I was hesitant to push.
@_date: 2016-05-04 12:43:14
I'm not sure anyone would want to be associated with either side of this exchange.
@_date: 2016-05-04 08:09:33
Super-Gavin and IAmNotCraigWright, then?
@_date: 2016-05-04 07:41:54


It's going to show a pass for every signature that comes out of the tampered generator, right? How would it handle failing on the non-appended message while verifying the initialed version? 
If I sat you down in a hotel conference room from which you wouldn't be permitted to take any physical evidence, might you not attempt some mnemonic techniques to retain what little evidence you could verify afterward? Perhaps I am ascribing too much skepticism to our hypothetical Gavin, but it doesn't hurt to plan for eventualities. If executing a scam of this size, I would work from the assumption of the most hostile and capable adversary. In this case the only data that Gavin could not have previously memorized nor validate independently afterward is the hash of the modified message to be signed. And even that is a bit of a stretch, as super-Gavin could memorize the resulting hash of the modified message. I might have added some whitespace or other features in my modification to provide a seed of doubt in his memory.


@_date: 2016-05-04 12:52:36
The Wired article does not appear to be based only on the Reddit post, and may have involved some back-and-forth questioning to extract more detail. I cannot say for sure, only Gavin could answer that question. The additional information about the failed verification attempt does lead me to believe that the Wired account may be more complete. Gavin's earlier statement on Reddit could be seen akin to a magician's card force.
Regardless, I'm just proposing this as one possible route, which could explain many of the small details while not being ruled out by previous statements. As points out, there are other routes to the same end which could be carried out with varying levels of deception.