@_author: nptacek
@_date: 2014-02-12 05:15:50
Manual identification and removal instructions can be found here: 
@_date: 2014-02-16 21:17:30
I'm wondering if you have a copy of the source code and exe that I could take a look at? I was spreading the word about [OSX/CoinThief]( last week, and I'm curious to poke around in this as well. Thanks!
@_date: 2014-03-01 01:21:52
Hey there, I'm the guy who originally discovered CoinThief, so I'm actually in a position to answer your question! The copies of Bitcoin Ticker TTM distributed through the Mac App Store **do not** contain the malware. Recently it's been discovered that the malware was additionally being distributed with some pirated apps for OS X, however, so make sure to continue to get your software legally from the Mac App Store!
@_date: 2014-02-13 02:15:24
Nope, that is actually some adware bundled with the CNET Installer from download.com, which we wrote about back in October. We've got full removal instructions for that available here: 
We've got a more general overview of it available here:
@_date: 2014-02-12 00:56:15
I'm working on a writeup with instructions on checking to see if you're at risk. For now, check Activity Monitor (located in the Utilities folder) and see if a process called com.google.softwareUpdateAgent is running. It will be named exactly that, so don't freak out if you see something that doesn't exactly match it.
@_date: 2014-02-11 19:10:09
We'll be updating the post [here]( as more information becomes available.
Additionally, I'll try and stay active here to post new info. Recent investigations are showing that the malware might be making modifications to parts of Bitcoin-Qt, in an attempt to get private keys.
@_date: 2014-02-12 22:56:20
I was wondering that myself, so I looked into it further. It looks like the malware is taking the place of the main binary in the trojanized version of Bitcoin Ticker TTM, and is set up to run as an agent with a setting for LSUIElement in the Info.plist file. This basically makes it so it doesn't appear in the Dock. It has a copy of the real Bitcoin Ticker TTM main binary hidden in the app bundle. So the first time you launch the trojanized version of Bitcoin Ticker TTM, the invisible malware program is launched instead.
At that time, the malware program unpacks and installs its payload, then moves the correct app binary for Bitcoin Ticker TTM back into place, and removes the LSUIElement entry from the app's Info.plist file. It then launches the original Bitcoin Ticker TTM app, which is now back in the correct path for the app bundle, and you're none the wiser that a piece of malware just installed itself on your system.
@_date: 2014-02-12 04:29:50
Here's what we know so far:
This malware has been distributed under four different names so far: **BitVanity**, **StealthBit**, **Bitcoin Ticker TTM**, and **Litecoin Ticker**.
BitVanity and StealthBit were distributed on Github and promoted here on Reddit by [While the source code for those two projects looked to be legit, the precompiled binaries were definitely malicious.
Bitcoin Ticker TTM and Litecoin Ticker were distributed on **Download.com** and **MacUpdate.com**, and both app names appear to have been taken from legitimate apps in the Mac App Store. The malicious payload was **not** found in Mac App Store copies of these apps. It is not known at this time if the malware is being distributed under other names or on other download sites.
When run, the malware installs a browser extension in Chrome, Safari, and Firefox, which will appear in those apps as "**Pop-Up Blocker 1.0.0**" with the description "Blocks pop-up windows and other annoyances." There are some indications that this name and description were also taken from a legitimate browser extension. The browser extensions watch your web traffic, looking for specific headers for bitcoin-related websites. They communicate with the background process, which will periodically connect to a remote server (currently offline) to exfiltrate login credentials.
The background process is set to be constantly running via a launchd task. Additionally, the background process will check for the presence of Bitcoin-Qt, and appears to be modifying components of Bitcoin-Qt. Specifically, it appears to be patching **libboost_thread-mt.dylib**, possibly with the intent of leaking private keys from Bitcoin-Qt. I'm not familiar enough with the way Bitcoin-Qt utilizes libboost_thread-mt.dylib to be certain on this, however.
**To check for the presence of the malware on your system:**
1\. First off, you probably want to take a screenshot of these instructions or something, and disconnect your system from the internet, until you've verified that your system is clean.
2\. Open Activity Monitor (located in your Utilities folder), and look for a process called "com.google.softwareUpdateAgent." Note that this is a specific name that is currently known to be used by the malware.
3\. Open Chrome, Safari, and Firefox (if installed), and check for the presence of the "Pop-Up Blocker" extension.
4\. If you see either the "com.google.softwareUpdateAgent" process or the browser extensions, continue on to the removal instructions. If you do not see them, your system should be ok.
**To manually remove the malware from your system:**
Manual removal is going to require entering a few terminal commands. The commands must be entered exactly as they are listed below, so copy and paste them in if need be.
Before entering the terminal commands, go ahead and delete the app(s) from your system (BitVanity, StealthBit, Bitcoin Ticker TTM, or Litecoin Ticker) by dragging them to the Trash and emptying the Trash. Make sure to quit the apps before attempting to delete them.
1\. Open the Terminal (located in your Utilities folder), and type the following command:
launchctl unload ~/Library/LaunchAgents/com.google.softwareUpdateAgent.plist
Press the return key after entering the command.
This command will unload the launchd task, and stop the malware from constantly running in the background.
If you see a message stating "No such file or directory, nothing found to unload," the launchd task was not loaded on your system. 
2\. Next, you're going to enter a command to unhide the malware file itself, and move it to your Desktop. I'm opting to have you manually drag it from there to the Trash to avoid accidentally removing the wrong file. Unix pros can use a variant of 'rm' here. Type the following command, again pressing the return key after entering the command:
mv ~/Library/Application Support/.com.google.softwareUpdateAgent ~/Desktop/com.google.softwareUpdateAgent
In the above command, pay close attention â€“ there is a period before the first instance of com.google.softwareUpdateAgent. Putting a period before a filename on a unix system will hide a file. We're simply removing the period from the filename, which will cause the file to become visible.
3\. Next, you're going to do the same for the file that kicks off the launchd task, and move it to the Desktop. Type the following command, again pressing the return key after entering the command:
mv ~/Library/LaunchAgents/com.google.softwareUpdateAgent.plist ~/Desktop/com.google.softwareUpdateAgent.plist
4\. Drag the com.google.softwareUpdateAgent and com.google.softwareUpdateAgent.plist files that should now be present on your Desktop to the Trash, and empty the Trash.
5\. Open your web browser(s), and delete the "Pop-Up Blocker" extensions.
6\. Backup your wallet and reinstall Bitcoin-Qt.
7\. Change your password information for accounts you have on any bitcoin-related websites either from a system that you know is clean, or after you have ensured removal of the malware.
I think that's all for now. I'll post updates here going forward.
Edit: Note that some early variants of the malware use the name "com.google.xupdater" instead of "com.google.softwareUpdateAgent," and the terminal commands should be changed to match accordingly.
@_date: 2014-02-11 17:39:51
Make sure to also remove the com.google.softwareUpdateAgent.plist file from the LaunchAgents folder if you haven't already, I forgot to include that step in my original instructions. It's still the early stages of analyzing this malware, so for now that's looking to be the only related files, but analysis is still ongoing.
@_date: 2014-02-12 04:14:41
I've got an md5 hash of **0f9dfd4f238ffea1f1aeaa4b92dd28bd** for the main binary in the copy I downloaded from the Mac App Store today. If your copy isn't the latest version your hash might be different.
I've got an md5 hash of **e80278ad89385a8408c588ba447c3d86** for the main binary in the malicious version I downloaded from Download.com today.
@_date: 2014-02-10 23:55:27
Have you installed any other bitcoin-related apps in the past (especially ones off of Github)? It looks like something similar was distributed under the name "BitVanity" last spring and summer.
@_date: 2014-02-11 17:30:27
Did you originally install StealthBit, or are you seeing those browser extensions and the background process without having run StealthBit? I'm seeing reports from users who did not run StealthBit but who are still seeing the malware, so it looks like there might be secondary sources of infection. Trying to track them down now.
@_date: 2014-02-12 03:53:19
Easy way to check for now while I'm finishing up the writeup: Right-click (control-click) the Bitcoin Ticker TTM app in your Applications folder, and click "Show Package Contents." Open the Contents folder that appears, and if you see a folder called _MASReceipt, you've got a copy from the Mac App Store, which did not contain the malware payload when I investigated it earlier today. This is simply a quick-and-dirty temporary way to check. Full instructions on checking for the malware are coming soon!
@_date: 2014-02-12 05:34:46
@_date: 2014-02-12 03:32:45
Definitely go ahead and contact Download.com, MacUpdate.com, and Apple to make sure they're aware of the situation. Did you ever have the source code publicly available for Bitcoin Ticker TTM?
@_date: 2014-02-12 00:32:40
Today I found the malware being distributed under different names on different sites. The names we know it's been distributed under now are as follows: BitVanity and StealthBit (on Github), and Bitcoin Ticker TTM and Litecoin Ticker (on download.com and macupdate.com). More details are available on the post I made over [here](
Are you positive that the copy of BT Ticker you had was from the Mac App Store and not download.com/macupdate.com?
@_date: 2014-02-12 00:34:48
Here's some more information: [ It does look like it's messing with Bitcoin-Qt, and there's the possibility of a Firefox browser extension as well with some of the variants.
@_date: 2014-02-18 17:19:50
Are you positive that you downloaded it from the Mac App Store, and not from a download site like MacUpdate or Download.com?
@_date: 2014-02-10 14:44:18
Yes indeed.
@_date: 2014-02-11 16:35:13
Go to the Finder, then click the "Go" menu at the top of the screen. Hold down the "option" key on your keyboard and an entry for "Library" should appear in the Go menu. Click the Library entry, and a new window will appear, at which time you can stop pressing the option key. In the Library window, open the LaunchAgents folder. Do you have a file called com.google.softwareUpdateAgent.plist located in there? Note that there might be other similar-sounded files, but that is the specific one that we're looking for.
@_date: 2014-02-26 01:19:14
It looks like ESET found some additional infection vectors for the OSX/CoinThief malware I wrote about [earlier this month]( If you've pirated BBEdit, Pixelmator, Angry Birds, or Delicious Library, you might have been exposed.
There are probably torrents of other cracked apps being used to distribute the malware; I'll update this post as more information becomes available.
@_date: 2014-02-12 06:13:28
No, but I met him at a conference once. I don't think we're related, but we both ended up in computer security!
@_date: 2014-02-10 05:57:43
Going off memory here so give me a few to check my notes. For sure you'll wanna get rid of the browser extensions, which should be called "Pop Up Blocker" in the browsers themselves, and the file names are Extension.safariextz and Extension.chrome, for each respective browser. For the background agent itself do you have a process running just called "Agent"? If so, let me know, there will be specific instructions to unload it and stop it from running again.
Edit: The extension will show up as "Pop-Up Blocker 1.0.0" in Safari, and the background process is located at ~/Library/Application Support/.com.google.softwareUpdateAgent/com.google.softwareUpdateAgent, which is loaded via launchd from ~/Library/LaunchAgents/com.google.softwareUpdateAgent.plist. Note that these locations are specific, so if you see other references to Google's software update agent on your system, verify that you're not trying to get rid of the legitimate update agent. The terminal command to unload the launchd task (which stops the process from being restarted to always run in the background) is:
launchctl unload ~/Library/LaunchAgents/com.google.softwareUpdateAgent.plist
Due to the leading "." in front of the directory for the actual file in the Application Support folder, it will be hidden from view in the Finder. To remove it, go to the Terminal and type the following command, being sure to type it in exactly right so you're not accidentally deleting legitimate files:
rm -rf ~/Library/Application Support/.com.google.softwareUpdateAgent
@_date: 2014-02-10 05:31:32
Finally made an account on Reddit just to reply to this. After seeing this post early this morning I spent the day analyzing the malware and the preliminary analysis is available [here]( Basically, the pre-compiled StealthBit app acted as a dropper for a disguised payload which installed the background process to check in with the server for updates, send information, etc, and a browser extension for Safari and/or Google Chrome (depending on what you've got installed) that slurps up all your browsing data (which is where they got your wallet info from). I'm hoping to have more time to analyze it further tomorrow, but I've been at it for almost 10 hours straight and I'm exhausted!