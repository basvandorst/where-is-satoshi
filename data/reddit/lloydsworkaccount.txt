@_author: lloydsworkaccount
@_date: 2014-11-12 15:27:07
I don't 100% understand your comment, but the merchant wouldn't be able to execute much of an attack in this scenario. For example, if he tried showing you one price, then taking something much larger, that wouldn't work because when the transaction is sent to your device over NFC, the price is shown on the little display. If you don't agree with the price, you don't sign it. The merchant can't broadcast unsigned transactions, so he can't get more money than what you signed for.
@_date: 2014-11-12 15:37:10


He may not be one of the endpoints, but he doesn't need to be in order to steal your money. If an attacker is MITM, he can send you an authentic-looking transaction when you're expecting to see the transaction created by the merchant, but with his bitcoin address substituted in. You unwittingly sign his transaction and boom, he's got your money.
What do you mean by session key derived shared number? Regardless, my point was that there has to be some way to confirm that the number you're seeing on your device actually came from the merchant's POS, and not from an attacker, and the only convenient way to do that is to display it on the POS. It could come from anything - receipt number, etc. but IMO the less predictable the better. e.g. if it's derrived from receipt number then the attacker just has to have a friend who's in line before you.
@_date: 2014-11-12 11:41:16
This is really interesting. Imagine this:
* You go to pay for an item in a store, the price is displayed for you.
* Tap the NFC sensor with your device. Your GPG public key is transferred to the merchant over NFC.
* The merchant creates an unsigned transaction, encrypts it with your public key and sends it to you over NFC.
* Your device decrypts the transaction with your private key, displays the amount and address, asks you to confirm.
* You press OK to confirm, your device signs the transaction and sends it back to the merchant over NFC or Bluetooth.
* The merchant receives the signed transaction and broadcasts it.
Another possible addition to fight MITM attacks would be the addition of a short (6 character-ish?) alphanumeric code to the encrypted message that gets sent to your device. This same code would also be displayed on the merchant's POS terminal, alongside the price. If the codes don't match, something's up. An attacker couldn't intercept the code and relay it to you because it was encrypted with your public key, so only you can decrypt it. An attacker would have to be within visual sight of the POS and pretty quickly copy the code into his malicious GPG message in order to scam you. In practice, this should be impossible to execute, as the store's NFC containing the code would always reach your device before an attacker could see the POS, type it in and somehow get their message to you.
AFAICT, this means that there would be no need for any communication tech to be built into the device besides NFC (and maybe USB for firmware updates?), keeping the cost down, it could be a fairly simple CPU, no camera, cheap VFD or LCD screen, and resistant to MITM. It would also work in areas where there's no wireless internet (cell or WiFi), as the merchant would broadcast the transaction, not you.
Thoughts?