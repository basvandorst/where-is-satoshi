@_author: btcrobinhood
@_date: 2014-06-27 14:07:53
Re (1, 2): my clothing it as a BIP is a tongue-in-cheek joke.  
Re (3): where else would you propose?
@_date: 2014-07-02 05:16:06
Great job!  
Anyone using an old version, you should seriously consider upgrading.  The RNG changes and move to deterministic-ECDSA make this version much safer than the old one.
@_date: 2014-06-26 22:51:53
It's as people are speculating elsewhere in this thread ... brainwallet.org uses a weak random number generator.  Anyone on the internet could have snatched these coins just by looking at data in the blockchain.
What's kinda crazy is that this issue was [pointed out weeks ago by another redditor]( but brainwallet.org hasn't deployed a fix yet.
@_date: 2014-06-27 14:54:46
Re: the Braess Paradox.  Since asking for a refund isn't free and the Bobs out there are extremely unlikely to honor illegitimate refunds, I'd argue it will not be optimal to send a refund tribute with every transaction.
@_date: 2014-06-27 14:31:04
If everyone followed the conventions in the proposal there would be no need for them to make posts about the theft (or for me to attempt to otherwise deanonymize their account).  The protocol ensures Bob gets all the information he needs to safely return the funds.
My proposal includes a [proactive signaling method](  that does not rely on a centralized database (blockchain.info public notes) or some human-language mediated coordination.  
That said, Bob could still chose to send what I call the "proactive signal" transaction via bc.info with a public note.
@_date: 2014-06-26 20:20:40
Are you in control of the address that funded the brainwallets, 1NZD6ubz5nm89TNCyFYmwzaxxtj94CTu1o?  
Was this address generated safely?  
Can you sign a message with the private key for this address proving ownership of it?
@_date: 2014-06-26 21:15:28
That's sufficient proof you are indeed the original owner.
Cheers 
@_date: 2014-06-26 23:28:31
Correct other than that I'm not the guy who made the post pointing out the problem ... although I'm tickled he made a throwaway account for the bug report named [btclittlejohn](  
As far as I can tell he exploited the bug several days before he posted his report and swept a non-trivial number of wallets.  He did not find everything though ... I found LostAllMyBTC's wallets because my search was more extensive than the one he ran.
@_date: 2014-06-26 22:34:29
Glad to help.  No repayment necessary.  The coins are rightfully yours.
@_date: 2014-06-27 14:40:08
If Bob is a newb and doesn't know about the convention Alice is fucked either way.  The protocol is totally asynchronous so it doesn't matter if Bob is AFK for months ... he should eventually notice the tribute (especially if his wallet is programmed to highlight it).  
Alice is totally fucked if she doesn't follow the protocol.  By following it she's basically buying a (perhaps slim) chance of getting her coins back for 1337 satoshi (less than a penny).  
@_date: 2014-06-27 13:48:51
 or those upvoting, please elaborate.  
I'm not totally convinced this is a great idea either but saying an idea is stupid is not an argument.
@_date: 2014-06-26 20:49:00
On their web wallet the function is under the "Receive Money" tab.  Go to row for that address ... the "Actions" button in that row should have a "Sign Message" option.
@_date: 2014-06-27 13:26:36
Bob gets the end vote since he's holding the coins.  This protocol relies on Bob being well-intentioned.  In the case where Alice lies, Bob will simply ignore her requests.
@_date: 2014-06-27 02:59:47
@_date: 2014-06-27 16:29:33
Good point. 1057 (LOST) makes more sense.
@_date: 2014-07-01 20:19:39
That wasn't my bot.  To my knowledge, the Multibit client has never had a problem causing it to generate weak keys.  The attacker likely got access to a system/media on which this key was stored.
@_date: 2014-06-27 13:10:09
Good point.  I guess it's always actually within Bob's power to charge any fee he wishes since he has the coins.  Although I'm kinda torn on this.  On the one hand Alice can always tip Bob once he returns the coins ... on the other establishing a conventional fee (5%?) might actually encourage more people to comply with the protocol than would otherwise.
@_date: 2014-12-10 02:32:59
and a scholar :)
@_date: 2013-10-16 04:26:47
someone using ec2 could perform about ~10,000,000 guesses per USD.  if they had a GPU mining rig and were only paying for power, their cost efficiency would be several times higher.
the haystack site is somewhat misleading.  unless your password was machine-choosen, odds are that it will be significantly easier to crack than a brute-force estimate would imply.
@_date: 2013-08-15 10:33:48
That paper talks about the Apache Harmony SecureRandom provider ... I'm talking about the OpenSSL-based one.
In any event, a bit more info concerning this has been [given on the bitcointalk.org thread](
@_date: 2013-12-21 04:36:35
there are so many to choose from.  [here's one of the more colorful](
@_date: 2013-09-29 19:50:42
+฿0.01 verify
@_date: 2013-09-29 19:46:42
Less than once a day and most amounts are less than 0.01 BTC (although amounts are generally power-law distributed).  I've also noticed the rate trending downward ... people seem to be wising up.  
@_date: 2013-08-11 14:56:54
It needs to be random because an attacker can keep guessing k values until he finds one that works.
@_date: 2013-08-15 02:21:30
While I greatly admire your vigilante spirit for password hygiene, an *online* ongoing dictionary attack against a subset of users on a *specific site* has lots of thorny issues.
@_date: 2013-07-29 18:47:41
Thanks for the tips GSpotAssassin, killerstorm, sowbug and theterabyte ... especially GSpotAssassin.
theterabyte (or anyone else), what mechanism would you suggest that would ensure that I would be returning the coins back to the right person and not someone simply claiming to be the victim?
@_date: 2013-08-11 18:37:58
I stand corrected.
@_date: 2013-08-11 19:15:22
[Me]( after doing the math to estimate the actual entropy Android's SecureRandom must be seeding in order to generate the number of signature nonce collisions we've seen in the past few months.
@_date: 2013-11-03 22:47:14
I don't have any Afrikaans literature sources and as I've [stated before]( my bot doesn't parse poetry properly and so it misses most such passphases :(
I was PMed recently by someone who lost 10 BTC in brainwallets protected by Russian poetry-related passphrases ... wasn't my bot there either ... safe to say there's another guy out there who's stuffed his bot's index with pretty much every variation of every poem in every language so lookout.
@_date: 2013-07-29 21:35:59
Thanks :)
@_date: 2013-11-23 01:55:40
I can confirm what tharlam said is true.
@_date: 2013-08-11 13:35:12
First off, I did not steal these coins.  That said, I knew about the flaw.  If you're worried your address might be vulnerable, here's a list (albeit compiled as of last month) of all the addresses that are vulnerable.  If your address is on this list, expect coins sent to them to be snatched immediately:
Edit1: I've re-run my little program to find vulnerable addresses. It turns out in all of July/Aug there were only 6. New addresses not in my posted list are 17HHdLh4oXncuTejALwC6fgArVqPUxh2Sr 1BFhrfTTZP3Nw4BNy4eX4KFLsn9ZeijcMm 1FPSVbypWa7rBWbciKHJ983YWcucBn7aUQ
Any developer who suspects this may have something to do with their wallet software, feel free to contact me for more detailed information (i.e. which specific tx inputs / signatures were foobar + k values recovered).
Edit2: To clarify, I did not know about [this flaw]( until now ... I just knew bad signatures existed on the blockchain.  This is hella serious ... **any key you previously used with an android wallet should be retired regardless of it's presence on my posted list**.
@_date: 2013-10-16 18:00:23
[Returned to your change address.](
Seems like you would make good company with the guy who  setup the "banking establishments are more dangerous than standing armies" brainwallet.
@_date: 2013-08-16 18:00:07
Nikolay Elenkov reveals a fork-related issue [in the comment section here](  However, I'm honestly still confused because: 
* this still wouldn't explain the problem of repeated nonces for sequential inputs (which comprise 5 of the last 6 nonce repeats) and 
* my read of the code is that while OpenSSL is generally initialized in the zygote process, the specific self-seeding initialization of the [RNG]( doesn't happen until random bytes are requested ... which AFAIK would be after the zygote forks. 
* openssl thread-locks the PRNG state
BTW ... I don't have access to an 4.x android device or build environment, so I'm just freeballing my analysis here ... and probably overlooking something.
@_date: 2013-07-29 13:45:08
I've returned each of the 3 transactions [
The security issue here has nothing to do with blockchain.info  If you pick a bad passphrase for a brainwallet it does not matter what software you use to manage the private key associated with that brainwallet ... anyone anywhere can spend all day trying to crack your brainwallet just by looking at public information on the blockchain.
It's a rough and tumble world out there!  Bitcoin safely!
@_date: 2013-07-30 08:19:22
I am [Jesse James](  Thanks for the tip :)
@_date: 2013-08-20 12:53:59
I'm the researcher ... I knew they were all from blockchain.info because blockchain.info keeps track in their database which IP first relayed each transaction to them.  For normal transactions this will be some random IP on the network ... however, if a transaction was submitted directly to their web API (which usually only happens when it is submitted by their wallet) it will appear as "Relayed by IP: Blockchain.info" [eg](
@_date: 2013-08-20 18:29:38
I wrote my own blockchain parser that spits the entire blockchain into a text file.  At that point my script essentially just looks for repeated fields in records in a text file.  Sorry for the anti-climactic answer :)
@_date: 2013-11-09 21:51:43
Unicode 6.3 (the most current version) has 110187 characters and 249769 assigned code points (because some characters can have multiple code points) so with just 2 characters you have ~62e9 possible UTF-8 encodings which I estimate would cost about $~180k USD to exhaustively search.
If you assume he restricted his shenanigans to the subset of unicode that's actually commonly used (Unicode 1.0.0 - 12795 assigned code points) you are still looking at $~500 (worst-case) in compute time.  If you're a gambler, average search cost ($250) will still net you a profit.
But as others have pointed out, it's more than a bit sketchy that this update was posted under a different username ... if you assume a 40% chance of a scam going on here, the highest expected utility action is not to participate. 
My 2 satoshi.
@_date: 2013-08-14 08:01:59
"these aren't the droids you're looking for"?
don't spend all the loot in one place :)
@_date: 2013-11-04 15:40:54
Wasn't me ... still haven't added misspellings to my bot.
@_date: 2013-07-29 16:06:19
Lolz ... not as lucrative as you might imagine ... especially if one [makes a regular effort]( to give folks their coins back.
@_date: 2013-09-28 19:29:10
Your passphrase appears in Wikipedia, so it's actually very likely, since this is a common dataset for brainwallet miners, and it actually isn't that computationally expensive to index the whole thing on a subphrase level.  
FYI, it was not my bot ... wish it was, that way I could [help you out](  My bot never indexed this phrase because it incorrectly parses subphrases that appear in the context of quoted verse.
@_date: 2013-08-11 21:39:39
If you are using an android wallet, you are still  at risk [in light of the most recent post](  If you're on my list, that just means your private key has already been exposed.
@_date: 2013-10-27 01:33:04


^ This.  Teaching my bot about random edit/case managling rules is the last thing on my TODO list ... but it is on the list.
@_date: 2013-09-29 19:04:03
My bot.  I've [returned your funds]( (minus the standard tx fee) to the address you swept your "shuffles39" test to.  
Btw, I have "you stay classy san diego" indexed but not the case variant you tested with ... one day gotta get off my ass and add proper case/punctuation variants.
Edit: Whups ... forgot to include a fee with the tx I sent (one of the joys of using the raw transaction API), so it might get dropped.  Once it falls out of the pool I'll attempt a resend with the proper fee.
Edit2: Looks like my tx got confirmed despite 0 fee ... nice.
@_date: 2013-11-15 20:43:48
i'm familiar with the electrum.dat format and am happy to give it a try pro bono.
i should point out though, that if you really don't remember anything about the password and you actually chose it randomly from a large space (lots of uppercase/lowercase/numbers/symbols) then you are  shit out of luck since the electrum wallet design makes brute-forcing relatively expensive.
i can really only check about 10e6 possibilities for ya for free ... which means i need some sort of hint to have a chance ... unless your password is terribad.
anyway ... pm me if interested.
@_date: 2013-12-21 04:20:31
not to add insult to injury but 1KaPzW1GPpYMzYBVTbHQ2zaUNfaMhPfZiU is actually a brainwallet as well ... "qwertyuiopqwertyuiop".
wasn't my bot btw ... easy shit gets snatched up so quick these days chances of any single bot catching anything is pretty slim.
@_date: 2013-08-15 03:49:03
I'm kinda confused.  My read of the OpenSSL code would lead me to believe that it seeds itself with at least 32 bytes from /dev/urandom when you neglect to seed it yourself before hitting up RAND_bytes for randomness.
The fix outlined seeds OpenSSL manually from /dev/urandom (or if the OpenSSL-based SecureRandom isn't being used, simply serves randomness directly from /dev/urandom).  
It's unclear to me how the proposed fix would address the issue unless there was an inherent flaw in OpenSSL's self seeding.  
This fix does get rid of the 64-bit Apache Harmony SecureRandom provider ... which, while bad, mathematically could not have been the cause of the repeated signature nonces.
Even more confusing to me is how an OpenSSL self-seeding issue could lead to the particular pattern of repeated signature nonces observed ... in particular the majority of repeats occurred in the context of the **same transaction** for **sequential inputs**.  For this bug to be responsible, the PRNG would need to spit out the same 32-byte sequence back to back.  I don't see how this could happen with a  thread-locked digest-based PRNG with singleton state (like OpenSSL's default) ... even if you neglected to provide any seed state at all.
I'm sure I'm missing something but any other randomness nerds out there ... I'd love to hear from you.
@_date: 2013-11-23 07:37:18
if you are using tails you can get a new IP by clicking on the onion icon and selecting "New Identity".
blockchain can't really be blamed if they banned someone else who was abusing their service from a tor exit not you happen to be sharing.
@_date: 2013-08-12 02:42:07
Not true.  If the random number issue reported earlier today is as bad as [mike_hearn alludes it is]( , then **it is only a matter of time before all private keys previously created on android devices are compromised**.  
The ones on the list I provided are just the private keys that are now trivially guessed due to lack of randomness when they produced signatures to spend coins.
However, all keys **generated** in an environment lacking sufficient randomness will eventually be guessed by an attacker ... and [by my speculative adjusted estimate]( probably within several days.
@_date: 2013-07-29 13:00:17
The address 15gCfQVJ68vyUVdb6e3VDU4iTkTC3HtLQ2 is the brainwallet "You don't win friends with salad!"  PSA, don't use names of songs as brain wallets.  Mijalis, I'm happy to return your coins; please send me a safe (non-brainwallet) address under your control.
@_date: 2013-11-08 15:53:26
After ~1,000,000 guesses I've come to [this conclusion](
Could be my BIP38 implementation is screwy (wrote it from scratch just now), but kinda doubt it since it passes all the test vectors.  I hope I'm mistaken but if it turns out the "weak" password created for this contest is some box-drawing-character, kanji, sanskrit combo  can take his bitcoins and stick them up his unicode-loving ass.
Edit: Just in case it wasn't clear, the 1M I checked included all printable ASCII combos plus the set of common unicode trigrams for a dozen different languages.  My contemplated next step was to expand my brute-force search to include the Latin-1 unicode block ... about another dozen million more possibilities.  Theoretically this would still be worth the cost assuming the password is in this set, but IMHO someone cheeky enough use non-ASCII in a contest like this is probably going to go full-retard and use code points from the entire Unicode range ... which as others have pointed out, makes this a fruitless exercise  (╯°□°）╯︵ ┻━┻ 
@_date: 2013-08-11 16:11:12
As discussed in a [previous post]( there is no reliable way to find the victims.  
Will the rightful owner of the brainwallet "correct horse battery staple" please step forward?
@_date: 2013-08-11 18:13:47
My analysis of the [paper that led to this alert]( is that it would take a while to practically exploit this flaw in the context of a bitcoin wallet.  Assuming a GPU can check 2e6 keys per second, you're looking at ~300,000 years to brute force the PRNG's 64-bits of entropy.
Even if you had the fastest supercomputer in the world, it would still take ~6 years.  And these estimates optimistically assumes a RNG mileage of 0 when private keys were generated ... so in reality the problem is harder.
The fundamental issue is that elliptic curve operations are computationally expensive relative to most other crypto algorithms.
**I still advocate key rotation.**  But, when people report thefts, keep the cost of this attack in perspective before fingering it as the cause.
Edit: Another thing ... by my analysis, it is unlikely that recently reported [bad signatures]( were caused directly by this bug unless there are further problems with Android's SecureRandom implementation that the authors did not discover.  Even if all ~50e6 signatures on the blockchain were generated by Android wallets suffering from this problem, the chance of seeing two signatures sharing the same k value (assuming they are chosen uniformly from a set of order 2^64) is less than 0.01%.
@_date: 2013-08-11 14:43:08
It is impossible to tell from looking at the blockchain which wallet implementation created a transaction, so I have no idea which software is responsible; however, I have voiced related random number concerns to bitcoin developers directly in the past.
Truth be told, the vast majority of these signature fuck ups happened a long time ago (my guess is by people writing toy bitcoin implementations for fun who did not know crypto).  
To answer your last question: I spend it all on hookers and blow.  
@_date: 2013-12-19 19:00:23
the code stores the iteration count as an unsigned 32-bit integer meaning it's effective upper bound is 2^32 = ~4e9.
if one were to test every iteration count between 1 and 2^32 i tend to agree this would be kinda pointless ...  if you're gonna test several trillion brain wallets you'll likely get more bang for your buck throwing that CPU-power at any other data set.
might be worthwhile if you selectively test certain iteration counts and are using a GPU to iterate the hash.
i threw together a script to test the most common 6000 english words less than 6 chars and assumed the iteration count was drawn from the set of the most commonly occuring 3000 numbers less than 10000000. [however...](
@_date: 2013-11-15 22:57:09
now that i'm zooming in on this it's actually easier to brute-force electrum wallets than i originally posted.  no key deriviation function is applied to the password other than a double SHA256 and because the ciphertext is PKCS padded, you can immediately tell if a guessed password is correct or not.
the author does perform key-stretching when going from the wallet seed (what the mnemonic is an encoding of) to the master private key.  however, given that the seed is 128 bits of machine-chosen entropy in the first place, key stretching at that stage is irrelevant.  it really belongs where user chosen secrets are being used as keys; i.e. in the context of the wallet password, not the wallet mnemonic.
my 2 satoshi.