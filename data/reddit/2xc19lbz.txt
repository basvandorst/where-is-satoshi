@_author: 2xc19lbz
@_date: 2017-03-02 12:12:50


Me not.  Problem in my last comment is exactly the same as in my original post (just swap Alice and Bob)


Only in case both parties have latest txn properly 2-of-2 signed, but my concern is about situation when one party has such transaction while another party does not have it.


This is good, I didn't know about this and probably this is how LN is addressing such attacks.


What is CPFP?
@_date: 2017-03-04 16:32:04
By "exactly what I asked for" I meant detailed explanation of a procedure used to create new channel state, which I didn't find myself.  Now I know how it works, thanks to you.  The idea is that parties first create transactions for a new balance, so now either party is able to safely close channel an either old or new balance.  At this point channel is in a "Schr√∂dinger's cat" state.  Only after both parties received transactions for the new balance, they give up and ability to close channel at the old balance.  If Alice gave up old balance, but Bob didn't give up in a reasonable time, Alice will just close channel at the new balance (Alice already gave up an ability to close it at the old balance).  At this point Bob may front-run Alice's transaction and close channel at the old balance, so there are periods of time (quite short periods) when channel can be closed at either of two balances (old one and new one), and during these periods parties should not relay on whether new balance is already in force of not.  In other words, LN has sophisticated procedure for exchanging transactions between parties that allows to operate in a trustless way.
@_date: 2017-03-03 11:49:04
Bob cannot broadcast previous transaction because in this case Alice will immediately use newer transaction to punish Bob and get all the money.
@_date: 2017-03-02 11:52:27
OK.  So we have a problem here.  Once Bob's chain is longer, now Alice is not able to close the channel (because her chain is invalid), right?  And if Alice badly needs money, Bob may ask her to pay a fee for closing the channel.  Did I miss something?
@_date: 2017-03-03 13:41:54
Thank you!  Looks exactly like what I asked for.
@_date: 2017-03-02 11:39:48


How not sending something to Bob could make transaction (stored locally by Alice) invalid?
@_date: 2017-03-02 11:48:16
OK.  So how this "both agree" works?  How LN prevents the situation when from Bob's point of view only Bob agreed yet, while at the same time from Alice's point of view both parties already agreed?  I.e. Bob agrees first, sends proof to Alice, Alice agrees as well, but does not send anything back to Bob.