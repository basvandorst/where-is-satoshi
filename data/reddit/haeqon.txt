@_author: haeqon
@_date: 2013-11-16 15:29:42


Oh that is so untrue, it's hilarious. 
Every blockchain.info wallet has a "secret" key inside that proves to blockchain.info that the wallet is open. You use that "secret" when doing things like adding the 2FA, so it's definitely something you want to keep hidden. Revealing it can bypass 2FA, add it, change your email, pretty much anything in the settings panel.
In the source that they had published for the server, there was a command named "resolve_alias" which printed the secret key for any given wallet. I'm not even kidding. I wrote a POC for that, and only then found out that the security page lied and the server was running different code. 
A devastating bug by all counts, and it was caught by an outside researcher (me). 
My discussion with "Roger" regarding this one: 
@_date: 2013-11-16 16:52:13


You clearly didn't read the bit where I accidently ran the XSS exploit against your server, and gained execution in the two most common browsers. Linking me to stuff like that is worthless if it's not happening in practise. 


We can keep going in circles, but I've already said I don't have access to my old account. Both it and this one were most clearly not ones I regularly use. 


Not what I mean. 
Visiting /login_dropbox?GUID= with my wallet open gives me a dropbox auth page. Visiting it without my wallet open gives me "access denied". There's no information at all on that URL that looks like the secret wallet code, save for the SID cookie. Removing the SID cookie gets me back to "access denied". 
It makes no sense except to say that you're storing authentication information for the wallet tied to the SID, only the only request made out when a user authenticates is to the APi request for wallet balances. That means you're storing those requests and connecting them to the GUID, right? 
This would be easier if you didn't hardcode your API values, or whatever you've done to make the code unpublishable. 


I'll show you if you fix your demo wallet. It's completely useless at the moment, asking for a password which I clearly don't have.
ED: Found a way to replicate it. 
* Open your wallet
* Click a transaction to view it's details
* Look at the frame URL
Looks pretty intentional to me. There's no reason for that GUID to be there unless you're specifically trying to correlate addresses with wallets. It's very much intentional. 
Here's the line of code which you commited: 
Please be sure to repond to this one.
@_date: 2013-11-16 19:31:19
I replied to the parent with a little explanation. 


The comments downplaying both bugs as not working, not possible, or not having a large impact are worse. The bit about "modern browsers" blocking it is borderline lying. 
@_date: 2013-11-16 15:05:03
I wouldn't even be able to tell you the alias I initially used, as it was from a now removed mail service. An unfortunate side effect of using services like lavabit I suppose. My emails to you at the time were simply just a request for a security contact and nothing more. 


If I was being hostile I would have just just looted the hundreds of thousands of wallet files you have stored with either one of my XSS bugs. As I have absolutely no interest in stealing from innocent users, my goal was clearly just getting you to actually fix bugs properly. Again, why would I make either of the two posts if I didn't have your users interests at heart?
Please point out to me where in my emails I was rude to you or your team. 
******* 
While I've got you actually giving me proper answers.
*  Why do the frames leading to taint analysis in the My Wallet view include the wallet GUID in the URL? There's no reason for it to be there, unless you wanted to associate addresses with wallets. 
* How are you associating wallets with the "SID" cookie, and why? It's fairly clear that some link is being made.
* You need to stop including remote javascript resources for your "share" buttons. I can't believe I even need to say that. 
@_date: 2013-11-16 15:47:25
As I've proved twice over too, the backend had multiple XSS holes. XSS leads to the wallet file being stolen, but is also an avenue for phishing of the password at the same time. 
Brute forcing is not as difficult of a job as you might imagine, given that they only used 10 rounds of KDF in their wallet encryption. Sure they've added more now, but only if you find a hidden option and turn it on, and are willing to break all their apps in the process. 
@_date: 2013-11-17 06:17:49
+$1 verify
@_date: 2013-11-16 15:12:53
They can't control the size of withdraws. If someone has control of your wallet on blockchain.info, then the funds are gone. Even if there was a cooling off period, everybody would be able to work around it and send just slightly less than the trigger time. 
@_date: 2013-11-16 14:25:57


What on earth are you talking about? I attempted to disclose my first vulnerability four times over 6 months before posting on reddit, something I made painfully clear in my first post. I'd discovered the TX parsing vulnerability before Gregory Maxwell did, somewhere around February.  This was dismissed as the support tickets being lost, and being confused with an extortion attempt. 
**It's fairly obvious that I was acting in good faith, otherwise I would have used or sold it, why else would I bother making such a scene to get your attention?**
Ignoring my emails, but replying to this public post within minutes is a fairly good demonstration of what I'm talking about here. Can you explain why you didn't even bother to give me a "no" after you'd offered the source in the first place? I'm willing to provide the full headers of my emails to prove that this discussion took place, and that my communition was clean and not at all rude. It's been a month, and you can hardly claim that you've been too busy. 


EDIT: Here's a copy of my emails to blockchain.info, to prove that I was not in any way rude to them while disclosing bugs. Latest sent at the top, my initial request at the bottom.
@_date: 2013-11-16 16:11:10
I realize now, but I didn't when the original was submitted. I was under the impression that reposting with this title was appropriate rather than editing it to fit. 
@_date: 2013-09-26 01:27:04
A week for a service holding hundreds of thousands of Bitcoin, are you serious!? They have made absolutely no attempt to reach out to security researchers, don't offer a GPG key to report bugs with, or even a dedicated security email address. For a website that claims to be the most secure way to store your Bitcoin, that's pretty piss poor. 
Maybe a week to fix a bug that is deep in a system, but not to repond to a damn email. 
@_date: 2013-11-17 04:09:57


I'm not too convinced by that. There's plenty of space in my tag XSS, and if you waited until being in the My Wallet to execute it, you'd have all the tools you needed to send the funds elsewhere. 


Without the secret key there's no way the server could know you've logged in, right? I'm asking how it is set in the first place, as the only request made out from the wallet when you log in is to */multiaddr. I don't understand how the server suddenly knows you have logged in , as the wallet secret isn't passed back. 


I got my pages wrong because I couldn't see what I was trying to explain (your demo wallet is **still** broken). 
You've already said the language is controlled by the SID cookie, which that page would be fine with seeing. If it wasn't you could just pass the language rather than leaking the contents of the wallet uselessly into your logs. 
Why is it really there?
****** 
Please just respond to my and other people's emails in the future, it means we can nut things out in private without all of this mess. 
@_date: 2013-11-17 03:57:16
* I found a hole that existed in the code
* I prepared a POC, found that the code stated wasn't what was running 
* I contacted the author to ask why the security docs they posted weren't being followed
There *was* a hole, it was just moved or removed before I got to it. 
@_date: 2013-09-26 02:36:58
You guys seriously should seriously improve your contact with researchers. At a bare minimum you need a dedicated email contact, preferably a GPG key, and some details of your bounty program. You are after all admitting on the page before that you store tens of millions of dollars in Bitcoin. Instead, I had to go through a web form that told me not to submit a "none english question" (sic). 


In this case, update the ticket. 


I've attempted three times in the last 6 months to make contact, though not under the same pseduonym. Emails bounced, tickets were ignored. 


Email is fine. 
@_date: 2013-11-16 15:15:39
To elaborate, I disclosed on reddit that I had discovered an issue, reported it, and then waited very defiantly until after it was fixed to talk about it in any detail. I fended off questions in the original thread up until that point. 
@_date: 2013-11-17 06:18:23
+$2 verify
@_date: 2013-09-26 10:33:41
Excuse me? I only had to make this post because you constantly ignored my attempts of contacting you, months have passed.  
    Received: from 209.15.212.49 by rms-us018 with HTTP
    Content-Transfer-Encoding: 8bit
    Content-Type: text/plain; charset="utf-8"
    Date: Thu, 26 Sep 2013 04:03:40 -0400
    From: haeqon
    Message-ID: &lt;20130926080341.156360
    MIME-Version: 1.0
    Subject: ********** Disclosure
    To: roger
    X-Authenticated: 
    x-gmx-attachvcard: false
    X-Mailer: GMX.com Web Mailer
    X-Priority: 1 (high)
    x-registered: 0
    X-GMX-UID: OTg2SW9UNUQ2Od7lhH9uT2VIN1xIO4Lo
    X-Flags: 1501
I will resend it immediately. 
@_date: 2013-09-26 07:34:14
I wasn't filled with hope given that my previous ones, months ago, were completely ignored. There was no response until a few hours ago, when I asked for it. 
@_date: 2013-11-16 15:52:16
* Open the wallet, click "taint analysis". 
* Open an address in the explorer, click "donate". 
Both have share buttons that are remotely included via JS. Not an easy attack or a practical one, but stupid easy to fix if Ben bothered. 
@_date: 2013-11-17 05:08:46


Ignored me for 6 months, fixed two bugs when I made a post on reddit about it, but then went back to ignoring my emails when I requested more information. 


They removed the files from github, not me, did you even read the post?
@_date: 2013-09-26 21:09:45
+1MBVyd5myRGsQJwFR4nweHWSUsV9acwh9a 0.01BTC verify
@_date: 2013-09-26 02:53:08
Appreciated, thank you. 
@_date: 2013-11-17 06:18:50
+$1 verify
@_date: 2013-09-26 01:52:06


Not directly. It's an attack that can't be just pulled out of a hat, there's preparation involved. It's serious, but not easy. 
@_date: 2013-11-18 12:42:50


Let me just point out that I gave them 6 months for the initial bug, source code was offered to me (I never asked), and then they resumed ignoring my emails again. At no point was I told that access would not be granted. 
@_date: 2013-09-26 22:50:35
I've actually reported two very similar bugs to banks in the past. One supplied a dedicated contact and GPG key, the other just an email address. One responded within minutes, the other gave me a call back in under an hour on a Saturday. 
Both were excellent given the amount of testing even the smallest of their patches has to pass before going live. 
@_date: 2013-09-26 13:19:38
That's the person that wrote the website. 
@_date: 2013-09-26 07:04:25
I got no response to the contact until I made this post. A lack of dedicated security address, as mentioned numerous times in the thread, is also completely unacceptable. 
@_date: 2013-11-17 06:17:58
+$1 verify
@_date: 2013-09-26 02:01:24
Coinbase also pay a bounty. I doubt this one will. 
@_date: 2013-09-26 02:07:56
I read the writeup of that actually, and I was quite pleased with their response. Lets see if Ben Reeves is as friendly when I finally get ahold of him. Doubt there'll be a bounty though, given the cold response so far. 
@_date: 2013-11-16 20:13:32
 How long is the password? Do you know anything about the format it might have taken? The more you can remember, the easier it is to crack. If you think it might be simple then it's probably a very easy job.
@_date: 2013-11-17 04:16:59
I've not played with it much, but I don't imagine so. Just be careful making your business rely on another's. 
@_date: 2013-11-16 18:31:08
blockexplorer.com is open source in a loose sense. Unfortunately it needs weeks of processing and 150GB+ of databases to do it's job. You're not wrong though. 
@_date: 2013-09-26 03:03:41
Thank you. 
@_date: 2013-11-17 06:18:37
+$1 verify
@_date: 2013-11-16 15:37:08
There is actually some issues in their extensions too. They include remote javascript in some of the views, meaning that if a "like button" site is compromised, the users could be attacked or phished using their leverage over the wallet code. 
(I assumed wrong with this one, it's just an issue in the website, see below)
@_date: 2013-11-16 16:26:24


Modern browsers would have not protected in **any way** against either of my attacks. Noscript protects occasionally, but mainly against reflected XSS. Especially due to my accidental trigger of the second one, I was able to confirm that it did indeed execute on Firefox and Chrome. If they aren't major browsers I don't know what are. 


What was my alternative? **I emailed the support address, your email address I got from the domain name, and filed a support ticket. I waited for half a year.** Was I meant to wait more months, go around to your house? I think email contact is more than discrete enough. 
What exactly is the proper way of disclosing a bug to you that won't cause you to ignore me?


It also seems to control the Dropbox and Google Drive authentication too, because the wallet secret isn't passed in that url. There's no other identifying information in the popup window, no referral information, no identifier in the URL itself. Though I don't know how it does without also knowing the contents of the wallet, or at least that the user has recently logged in. 
I'd check myself, but, yeah. 


Go to a wallet, view the "taint" on a transaction, an iframe will pop up inline in the wallet view containing the wallets address, and its GUID in the URL. There's no reason for this except invading your users privacy. 


You're just priming yourself for disaster there. 
Your demo wallet is also broken and asks for a password now. 
@_date: 2013-09-26 14:56:09
Appreciated, thank you. 
@_date: 2013-11-17 06:17:28
Safer? Yes. Private? No.
@_date: 2013-11-16 16:12:31
I assumed rather than checking, it looks like I assumed incorrectly in this case. I've edited the parent to reflect this. 
@_date: 2013-09-26 12:48:33


Less than 14 days on a Bitfury rig is not impossible really.


    &lt;script src="
That would easily fit, and from there you can bootstrap to a full javascript exploit that can dump the users Web Wallet, which is stored (though weakly encrypted) in localstorage. 
@_date: 2013-09-27 01:23:22
Sorry for taking you too seriously then! 
+$1 verify
@_date: 2013-09-26 07:16:55
Much appreciated. 
@_date: 2013-09-26 02:16:15
Yes, if I were the owner I would certianly be paying out for bugs. 
@_date: 2013-09-26 02:19:21
Yes. 
@_date: 2013-11-17 04:16:06
Thank you. 
@_date: 2013-11-17 06:19:05
+$1 verify
@_date: 2013-11-16 17:38:51


I wouldn't relay on their estimator, it says it will take millions of years to crack a password like Password4321. Assume 100M attempts a second per mid range GPU, and assume that the attacker has a lot of them. 
 &gt; Bullshit, I use a Blockchain.info wallet with 113 bits of entropy  
You're an outlier, and I commend you for having a strong password. 
@_date: 2013-11-16 16:45:21
32 characters is not breakable, but people using a service like this wouldn't use a password like that. A random 32 character password isn't easy to remember, easy to type, and in this world there's really no recovery if you forget it. People are bad at passwords, there's piles of evidence to show that. 
@_date: 2013-09-26 13:19:04
Take a look at the inital post, I've edited in a description.
@_date: 2013-11-16 19:23:08
I can see the motivation behind that, but I'm very firmly set in reporting things properly and without any malicious intent. It's especially vital in situations like this, where disclosing an exploitable bug can cause widespread damage. 
That said, their handling of the issues (ignore me until I make a stink) is ridiculous given that their "transactions sent" counter goes up by thousands of dollars a second. I've had a number of good disclosures recently (not counting this one), and not one of them was ever public because they didn't have to be. 
@_date: 2013-11-16 20:55:27
This way protects their users rather than stealing from them. I've no inclination to steal. 
@_date: 2013-09-26 03:14:38
Pardon? This was a successful attempt at getting an audience for responsible disclosure. 
@_date: 2013-09-27 01:20:27
This is incorrect. If you have logged into the My Wallet service, there's a complete copy of the encrypted wallet stored in localstorage which the attack would have access to, if it has been used maliciously. There's nothing to suggest that it was though. 
@_date: 2013-11-16 13:49:25
As promised, here's the writeup for my two reported bugs: 
**Decoded TX XSS**:
Essentially in a number of views blockchain.info shows the "decoded" view of a hex string, be that in the TX body itself or the coinbase of a block. In this case neither one was escaped or otherwise filtered, which leads to XSS on the root domain of blockchain.info, also where the web wallet service is run.
Earlier in the year I attempted to notify them of this in the transaction view, but ultimately gmaxwell got there first. I only realized that they never applied the same patch for the coinbase view just recently when looking at the source of a generation TX page.
There's a clean example of the TX view XSS here, though this is the one independantly reported by gmaxwell.
**Tagged Address XSS**:
This was a serious one, which was fixed within seconds of my report. URLs you submit to blockchain.info for tagging are checked by the server visiting the URL, and checking if the address you entered is also on the page. If it was it passed through and is printed on both the tags page, and the front page, and on any page that address exists on. 
This URL made it through their filter, assuming example.com contains the bitcoin address we are attempting to tag. 
     this were an actual exploit, your mywallet would be empty.")&lt;/script&gt; 
XSS on blockchain.info is particularly dangerous as, known to the user or not, the encrypted wallet is stored in localstorage on the users machine. Has this been exploited, it would enable a wallet to be completely stolen with no interaction from *any visitor to blockchain.info*.
The passwords on a wallet are no protection, as there's GPU tools out there that can do tens of millions of attempts a second, and even include blockchain.info's format as a default option. 
@_date: 2013-11-17 06:19:17
+$1 verify
@_date: 2013-09-26 01:21:20
For this bug; few days.  
Last time; months with no return contact. 
@_date: 2013-09-26 01:24:32


The bug is fairly obvious if I mention any of it's features, so I won't in this case. 
I would caution against using the service at all though, given their pathetic security history. 
@_date: 2013-09-26 02:10:25
You'll find out once it's been fixed, sorry. 
@_date: 2013-11-17 08:27:33
Alright, well try answering my questions. If you know anything about the wallet password, you can probably recover it. 
@_date: 2013-11-16 15:26:06
Neither would work without javascript disabled, but then again the wallet would be disabled in that situation too. As the exploiting site in this case would be blockchain.info, there's no way of selectively allowing certain scripts to run. There would if they moved their wallet service to another domain like  but I doubt they ever will. 
@_date: 2013-09-26 22:46:06
Two exploitable bugs on a major Bitcoin website, one that you didn't see here that was absolutely critical and could have been used effortlessly. 
@_date: 2013-09-26 01:51:40
I'm not disclosing anything yet. I'm attempting to make contact. I certainly agree with you here. 
@_date: 2013-09-26 00:59:33
This is a feeble attempt at responsible disclosure. I have attempted contact with the domain owner, filed multiple support tickets, posted here, and private messaged the owner. 
Failing this, I'll just post a full disclosure.