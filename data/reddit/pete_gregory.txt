@_author: pete_gregory
@_date: 2016-07-11 11:52:32


Wrong here, there will be plenty nodes (fully validating) who will spot this immediately, which makes this scenario not realistic at all.
@_date: 2016-07-13 19:00:53
As a side node, idea coming from a different discussion - actually such a solution I propose is also anti-inflationary (as this is one of the arguments you used against), because amount of bitcoins in circulation at a particular block height is know from bitcoin supply curve. So the worst thing can be done is double spend of transactions for the transactions which malicious player have private keys to. Which I can't even come up with an idea what kind of double spend 100% of miners will agree upon.
@_date: 2016-07-11 11:11:39


Can you please come up with at least 1 scenario when "starting with bad data" is possible? It can only happen when 100% of the miners put invalid transactions there on purpose. Now, if you have 100% of miners who cheat - then you have much much bigger problems in bitcoin than some nodes potentially get initiated with bad data and this case will be addressed (that was mentioned in the paper). This is the same argument Greg used, but it is simply wrong. This onchain pruning approach is trustless in the same way bitcoin can be considered trustless.
The advantage is a new node can start within 1 hour instead of a week and also having much lower bandwidth and hardware requirements (which means much higher decentralization potential than currently is). I can't even understand your claim that there is no big advantage. After xthin blocks and compact blocks implementation such onchain pruning could [solve the main left problem according to theymos](


This is plain wrong. SPV can be misled by sybil attack, moreover you lose privacy with using SPV node as someone could associate your IP with bitcoin addresses and bticoin address between each other that they belong to the same owner. The type of node I describe doesn't have any of these drawbacks. It is basically similar to a fully validating node in this.
@_date: 2016-07-11 15:02:13
Yes, I see your point now. You are right. But this vector of attack is possible only within short window of several blocks around 4096 height or when absolute majority of miners decide to cheat for a long time.
In this case the client will see that something is wrong and postpone validating of new transactions until the full blockchain is downloaded and it operates as a full node.
I practically don't see any scenario when 100% of miners will fall to fraud. Yes, I do understand we should not rely upon them, but for practical matters it will make new nodes available to run as a validating node much faster. So I still see a huge value in it.
@_date: 2016-07-11 14:11:46
As I replied to you before, you are not relying only on majority of miner nodes, you rely on the whole network including all fully validating nodes. This is a different story.
I don't say that UTXO nodes should replace all fully validating, so not sure why you're referring to original white paper about it. They will still be there and you are free to run one (fully validating) if enough resources.
@_date: 2016-07-11 12:32:22
Well, as I said before, I don't resist it, and this can be implemented for sure, I would add it via parameter (opt-in or opt-out could be discussed). But I just don't see any possible attack vector when it is needed, so you don't really get anything much apart from spending resources on downloading it and then CPU processing for validating all history in my opinion, because in the end you will get the same UTXO set you had before.
But just to be sure 100% that none of attacks is possible here - it can be done for sure.
@_date: 2016-07-11 09:17:23
You probably didn't look carefully, it is a validating node. It just start validating himself from a point in time (wheren UTXO batch is availalbe), however, the UTXO batch is verified by the whole network. It is way far away from SPV node.
Yes, it is not the same validation as in validating full blockchain yourself. But if on scale 1-10 SPV node is 1 and full node is 10, this type of node is probably 8-9 with respect to validation process.
@_date: 2016-07-11 19:38:12
I wrote the paper without knowing of UTXO commitment proposal. And I still find it is a bit different thing. UTXO commitment is something about ongoing recalculating UTXO, and I have an approach to do it just once in a while, which will reduce load on nodes dramatically.
Also UTXO commitments is targeting to reduce UTXO afaiu, my approach is to make initial node start much faster and resync faster as well in case node DB is broken. So I think goals are different.
@_date: 2016-07-11 12:46:16
My doc describes exactly this, but:
* without 1 hour pause
* and having a delay of blocks in order to preserve security at reasonable level.
Your approach is only better that new nodes won't need to download last 4096 blocks (which is very fast compared to downloading 420000 blocks), but introduces a lot of flaws. Consensus should be reached via information in longest blockchain with biggest hash power, not via other communications or agreements.
@_date: 2016-07-11 12:21:44
I don't say it is a replacement for a full node. It is a solution for improvement to nodes that can't be a full node based on increased resources required while network is growing.
Hopefully, now you see the difference between SPV and such type of a node with respect to validation. It is not only about privacy that you finally mention.
You can't have 100% secure system, it is a matter of compromise and required security threshold always. What you get is "almost full node", may times more secure than SPV node, with a bit higher resource requirements, which is a big improvement to the network and keeping it decentralized.
According to your logic segwit should not be implemented because not all nodes will validate transactions, but this is obviously wrong decision if you think so. Onchain pruning is a complementary solution, it can reduce resources even after segwit implementation many times.
@_date: 2016-07-13 11:18:17


Sorry, I don't get your argument. How some malicious miner with 0.001% hash power can produce longer chain against consensus?


No, when you said that before I confirmed to you I understand there is a security trade-off, and I also pointed it in the paper and in the comments here on reddit.
I was arguing not that someone told about security trade off, but rather came up with scenarios far from reality, like 100% of miners will agree to fake the content of blockchain with invalid info.
Actually the very first comment of mine on this subreddit was "Yes, it is not the same validation as in validating full blockchain yourself. But if on scale 1-10 SPV node is 1 and full node is 10, this type of node is probably 8-9 with respect to validation process."
For me it is pretty clear that grade 8-9 out of 10 is a security trade-off.


Ok, now I got your idea. Sorry, wording you used misled me (to be honest sometimes for me it is a bit hard to get the idea from your explanations). Yes, adding hash of UTXO into the software code could be a solution.
The only question is the periodicity of software update needs to follow, but at least an update with just hash code change could be released in this case.
The idea is that if people trust software (based on external audit of open source code), they should also probably be ok with trusting the reference to UTXO. I think actually something similar was before when torrent file of blockchain was distributed before via trusted site, but then for some reason it stopped.


Are you referring to blockchain or UTXO set, because you mention both and it is confusing.
My point was if they store 75 Gb, what practically stops them to store 1.3 Gb more? It has no implication on storage capacity (just 2% more used). UTXO set will always be very small compared to full blockchain size, which means in case node is capable of storing blockchain, storing extra UTXO snapshot for one moment 4096 blocks ago is not an issue.


I read. I don't get what is incompatible there. These are two totally different approaches. Yes, Peter's approach might solve much bigger and other problems than what I describe in the paper. But I don't see how they are incompatible, they are just different, and could coexist. Probably my solution could be replaced when TXO commitments are finally implemented.
The main issue with what Peter describes - is when it is going to be implemented. The solution seems quite complex and as far as I understand not yet finalized even description. What I suggest is something very easy to implement that could help bootstraping nodes faster and with much lower resources.
I do agree that Todd's implementation will cover the purpose of my proposal and might be superior to it, the only question is when.


The issue is not in storage capacity and I clearly wrote about it in the paper, also mentioning pruning mechanism in the Core client already implemented. The issue is with downloading the whole blockchain, which needs to be done prior or ongoing with pruning, and re-validating the whole history of all transactions in order to prune blockchain on the client side (that is where the max load and time delay comes from).


Yes, but "doubling" sounds very exaggerating when you talk only about 4Gb of disk drive in total. Which can be even easily stored on a cheap mobile phone today.
So the question is basically what would you prefer to spend a week before you can become a node and then have 2 Gb of your drive used, or to start within an hour and have 4Gb disc space used instead. I think the answer is pretty obvious.


I think that's because you put accents on the wrong things, like mentioning that I was not accepting security trade-off, which is obviously not the case. Anyway, I appreciate your time and effort spent here with discussing it.
As a summary, I understand the issue could be addressed with other solutions, like Todd's TXO commitment, however, it is much more complex that what I suggest and is planned to solve mainly a totally different problem (UTXO growth and its fit into limited RAM compared to hard drive space).
Having in mind that you had similar idea about 5 years ago, I truly don't understand why such a simple thing has not yet implemented. At least, I could not find an answer in your responses as have not found any strong argument against it.
@_date: 2016-07-11 11:35:24


Why so. There will be plenty of nodes doing full validation as well as checking this UTXO hash. So if miners cheat - it will be immediately seen and reported by the network. Don't get your reasoning here. I never claimed that there will be less fully validating nodes than today. It is a matter of option to give people a choice. If you are able to run a fully validating node and doing so - you just continue in the same way. Moreover I don't see any practical reason all miners will cheat. Like Greg claimed that they could inflate currency by generating more BTC to their own addresses. But miners will be abandoned immediately then, it just doesn't make sense. Also this could practically happen when there is only one owner of all mining power/pool, which probably won't happen every, as we are in oligopoly mode rather than monopoly here.


Why? If you reach finish line with downloading and validating the full blockchain - you will definitely be able to do this with my proposal, just many times faster.


Well, if you are talking about an attack of similar level when somebody recreates full blockchain with same hash power required for all history or for 4096 blocks in my description - than yes, you are right. But it will never happen practically, like you theoretically can bruteforce private key for given public key, but not possible practically.


Well, the point is to give a way to become a part of the network with much lower resources needed (higher decentralization), while not losing almost anything compared to fully validating nodes. Of course, after starting fast you can download the full blockchain retrospectively in order to recreate the UTXO you initially started and becoming fully validating node, but I don't see any practical meaning in this honestly.
@_date: 2016-07-14 06:49:19
Yes, they can reassign, but won't be able to spend it unnoticed. All economic incentives are against such scenario and economic incentives is what keeps bitcoin running. All major players like Bitpay, Coinbase, all exchanges etc will still be running full nodes and fake bitcoins will easily be spotted by them in case they land on the blockchain and such blocks will be orphaned, so what is the point for miners to do this when they can put hash power into mining proper blocks and earn real bitcoins?
@_date: 2016-07-11 12:47:54
Yes. this definitely can be added.
@_date: 2016-07-14 20:05:19
Coinbase and Bitpay both have even their own full node implementations (toshi, bitcore). I hardly believe Bitstamp or Kraken don't run their own nodes, for example.
Also your argument is not valid, as even if they don't run a full node on their own, they still rely on an external *full* node. There could be trust relationships between these parties today, but it doesn't make my argument invalid, that in case 100% of miners will put fake txn into block it will be immediately spot and rejected by the network.
Also when you say "major parties"  what does it mean? Could you please provide at least one example of such a company? To be honest I hardly believe any well known exchange or company with 7 digit turnover per month of customer funds don't run their own full nodes.
@_date: 2016-07-12 22:22:36


Are you talking about hidden selfish mining with dominant hash power? And then this malicious player just publishes longer chain including one of the "4096 block" with some fake UTXO hash there? Formally, this will be longer chain, but it will be reported everywhere (same as if it happens today). That's just description of 51% attack, which is no different than it is going to be treated today, right? Or you meant something different?


Well, this was why I came up with some attack and flaws scenarios section in this doc and tried to evaluate whether these are real issues. I don't think your accusation is honest here, as I did try to think objectively and for the better of most network participants.


I was not arguing that there is no security trade-off, can you please link to the exact other comments, which you mean here?
When someone said that based on my proposal, all miners could come together and put fake UTXO in such a UTXO block, yes I argued about this. I still think this is not realistic scenario and there is only theoretical possibility for this.
I do accept that some could be malicious, but 100% at the same time is just not possible. But even if it happens, there is still a way around it, UTXO nodes will know about this attack happening and behave accordingly.


Do I understand correctly that this only based on the UTXO sets stored on nodes and passed to connected nodes? In such a way this is much lower security solution than I propose. Trusting some nodes because they were longer seen online, is it what you mean in simple terms? How it could be comparable to full PoW of the network?


Ok, then I got it wrong. But if it is so, that means all from current 5K full nodes from now on will need to propagate bigger than 1 Mb blocks? On segnet it was reaching even 4Mb. Absolutely all of the nodes? Isn't it the reason your team is against bigger block? Should not it lead to centralization?


Consistency of coin creation - isn't it the same as anti-inflation you mentioned before, but just different wording?
Double-spending preventing is really nothing compared to ability to create fake transactions without proper signature, meaning without having private keys to those public keys, am I right?
So for me UTXO blocks security it still looks at least comparable to the segwit lite nodes, but probably even superior. But now I'm a bit confused as you said such lite nodes were dropped from segwit concept, however still continue some discussion here about it.


Can't follow you here, new to old what? You mean old to new UTXO set?


Why would not they store full UTXO set of data for 4096 block before state and also hash for it? What stops them from doing it? As I said compared to current 75Gb of the blockchain they store already it is just extra 1.3Gb. So only 2% more of storage on disc drive. Moreover, no computation is required or very minor, because they can generate this UTXO set when they were 4096 block before current state, so during normal operating of a node they just make a snapshot of UTXO set and store it. What is wrong with such a logic?


Sorry I don't get you here. Introduce which optimization? Incompatible with what? And today what will be compatible with what?
Just to repeat my vision. Today nodes already have current UTXO set when they run. What stops to add algorithm that at particular height of blocks UTXO set is snapshoted and stored separately as a file datastructure and also hash of it, so that 4096 blocks later hash of it will be included into main blockchain? Even if there is some orphaning happens around this 4096 block time, node can still recreate needed UTXO set in parallel, as there are 4096 blocks till the time it is going to be included (~1 month). This won't affect current load in any practical way.
@_date: 2016-07-11 19:34:53


Yes, I confused with SPV described in bitcoin whitepaper. I agree that it is not the same level of secuirty as full node, but is very close to it and is far from SPV. It's not only about what miners produce, but also what other nodes relay.


How is it different here? If the has of UTXO included is wrong, nodes won't accept it. Be it other mining nodes - then block is orphaned, or other plain nodes, which won't relay such a block.


Yes, agree. I was not attentive enough and I was pointed to this fact by others. You did mention to get included it in the block. From this thread it is not clear why you refused from the idea you promoted yourself back in 2011. And today such a solution is of much more help than it was 5 years ago.


It is just 1.3 Gb of disk space now, as it gets fully renewed you need to store only last version. Compared to 75Gb current blockchain size it is just 2% and will get smaller over time.


- old nodes will not be able to validate new transaction
- new nodes will still be divided (afaiu), some will be fully validating as well (e.g. mining nodes), and will need to download both datastructures, other nodes will be lite in the sense, that they won't download/store/relay signatures structure. In this sense they will rely on what is mined on the blockchain.
So it is change to a security model, you understand security in some strange way.


Which is still 7x higher than 1.3 Gb of current UTXO, and even more I believe that my approach is more secure as it allows just to remove some transactions, while the rest is still validated. In segwit lite nodes won't validate all transactions in history, which is much worse security wise. And still my solution can be implemented on top of segwit, which will be even better improvement.


Well, it obvios does. It UTXO has 10 cents at current market price, and fees are 30 cents, it won't be spent, and in case fees are 2 cents, than it is profitable again to spend and can be used.


yes, these won't be spent in anyway and increase UTXO forever, but bitcoin is permissionless, so there is no way to control it and probably it shouldn't.


I did skim through and have not found what will become impossible if my solution is implemented. Will try to read carefull again and understand. Hint is appreciated.


Yes, you are right, what I meant old nodes will still be able to follow longest chain and there won't be hardfork. If you read what I describe it exactly what you describe here.
I read your arguments and I still don't see clear reason why it can't be done and how worse it will make things. I see only improvements. You say something will not be possible if it is implemented - but not clear what. Will check.
@_date: 2016-07-11 12:03:06


Well, if you use this as an argument - there should be no SPV nodes at all, right? But there are.


I'm talking about consensus rules. And it can't be used as a double standard. If it gets activated and somebody creates fake UTXO and  includes hash in the block - such block will be rejected by honest nodes. Your argumentation about Ethereum can be brought to bitcoin of today as well. The problem is what you claim as weakness in my approach is actually already exists today. Assume 100% of miners agree to put a transaction into a block *without* proper validation and then continue mining on top of this. Could you please explain how current bitcoin implementation will solve it, what will happen today in such scenario?


Because with limited resource when someone can't run fully validating node, such a person can run much better alternative than SPV, which is the only option for him today.


Not sure about which case you talk, but you agree that security of 6 and 4096 block confirmation are two totally different things. Also as I said the only scenario when it can happen is when 100% of all miners/pool decide to cheat, which I assume you don't have example for.
@_date: 2016-07-11 12:40:30


If there is at least one honest fully validating node connected - I will immediately be notified that there is something wrong with UTXO block as hash is different. Can you please elaborate on your "don't protect" claim? I understand when someone prevents me from believing that fraud txns are valid is exactly what *protecting* means.


The fact that all miners and *the whole bitcoin network (all fully validating nodes)* confirm it as valid solves this problem. I'm interested to hear a scenario when it does not.
@_date: 2016-07-11 09:53:38


Not really, SPV is a totally different thing, when you request data from other nodes and validate it partially. Onchain pruning is included into the main blockchain, which means it is sealed with all the network hash rate power and consequently all blocks on top of this. Moreover as the UTXO is renewed fully - you look only at the last block with height multiple of 4096, which means you always use the latest has power size available on the network, which mined 4096+ blocks on top of this. With reasonable level of security last 4096 blocks, give reasonable similar security level than whole blockchain.


Well, you trust the miners already with standard work (yes, you can proof check that all txns are valid there, but you can't influence it in any way if 100% of miners decide to cheat and mine longest chain with invalid txns). In this case it will be spot by community and measures taken. With approach I describe - it is absolutely the same, this pattern will be easily spot by community as there will be many nodes (non-mining), who has full chain and do check against UTXO snapshots. So not sure what is the exact problem here.


Its not a rehash, I don't find any description there of including it into main blockchain, which basically increases security dramatically, rather than just requesting info from other nodes.


Not sure I get full techinicaldetails here, but the way I described it - you don't need to calculate UTXO ongoing, so you don't need to maintain it.
You do this once in 4096 blocks with 4096 delay, so there is one month to do this and store the file. Moreover, as ongoing nodes have UTXO set calculated all the time, it is just a matter of making a snapshot, calculating its hash and waiting one month, so no extra job to do at all. Have I understood your argument correctly?


It is totally different, in segwit you make node trust miners for txns be correct, here you just trust that all txns are included in UTXO set, but you do validation of all in UTXO block and all the rest consequent in main chain blocks.
Segwit is totally different perspective, because segwit doesn't reduce current 75Gb blockchain size in any way, however approach I describe gives a 50x size and manifold CPU processing reduction today.


Well it depends on fees, and also BTC price. Non-profitable UTXO can become profitable one day, so trend is not clear. Also with ability to scale network via onchain pruning will allow to keep decentralization at the same level with bigger blocks, which will reduce fees.


What do you mean by hardfork? The way I describe it can be implemented via soft-fork and not changing any protocol consensus rules.
@_date: 2016-07-11 13:53:32


Orphaning can be a problem in just 1/4096 cases. I mean longer chains get orphaned for sure but with much lower probability, but as long as the the block with UTXO hash is orphaned - node just switches to another block, which is part of longer chain.
Moreover orphaning is not the problem in case both mined blocks were coming from honest miners, as UTXO set in both of them will be absolutely the same. Don't understand what kind of problem you try to describe here. Have you read the paper?
@_date: 2016-07-12 15:00:36


I don't remember I said there is absolutely no change in security level, sure there is. But compared to what we have today SPV and full node - this is a great trade-off that can be implemented.
Here on reddit and in the doc I talk about "preserving reasonable level of security" for such nodes. I'm not sure what you mean when you say: "but that the author failed to disclose that it was a change in the security at all (and continues to argue it here, in fact)"
Attack vector is when 100% of hashing power creates fraud blocks and also there is ongoing attack by increased number of fake nodes, in order to keep the chance that all nodes I connect to are fake, number of nodes has to be increased dramatically from current 5K. I doubt it can go unmentioned. Of course, it is possible to do as you say, but it will be so easily to spot, so it can't go unnoticed.
I hardly see any reason all hashing power would agree to come up with fake history of bitcoin.


Can you please share your thoughts here? What is an alternative proposition could be?




Well according to Peter's presentation (


So segwit (this was my understanding) introduces a new type of node, which will have blockchain without signature witness datastructure (every block limited to 1Mb). Assuming some full nodes today will switch to this type of node (due to limited resources) is also a change in the security with introduction of segwit. It is no different than security change in my proposition.
So segwit brings a new type of node, as well as my approach brings a new type of node. Even more, I assume my type of middle node (between full node and SPV node today) is no less secure than the new type of node born in post-segwit era.


Yes, but on the other hand apart from coinbase transaction all the rest can be falsified, because node doesn't have siganture witness - he will be clueless whether any txn is valid or not.
Anti-inflation detection is very loudly said here, you can't increase inflation anyway, because any txn issued by such a UTXO node using fake coinbase origin won't be accepted by a network and won't be mined and won't end on blockchain. So, true inflation increase can be achieved only via blockchain, which is obviously not the case here.


The argumentation line is no different (I thought about marginal addition, but just used realistic fee example for whole transactions), but you can just relatively change fee size and apply it to marginal example. It is no different as what matters in fee size is BTC/byte and not nominal value.


Do you have estimate of those that technically are not spendable, because all the rest definitely falls into spendable, the question is only when (what BTC market price and what are the fees). My point is that if there is no data to prove it, it is rather unjustified statement that "reduction to UTXO data may only be a constant factor improvement".


You are particularly talking about this new UTXO node types. They can easily build new UTXO set based on old UTXO set and part of main chain afterwards. So they can build and create hash and compare this hash to newly added on the main chain.
Basically your argument about they won't be able to check it lies on the fact that initial UTXO might be fake. But this is the concept itself. All full nodes will be able to build it and check against full main blockchain, so again I don't see it is a problem.