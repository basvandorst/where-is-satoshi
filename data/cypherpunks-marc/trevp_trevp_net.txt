
@_date: 2003-11-02 20:07:41
@_author: Trevor Perrin 
@_subject: cryptoIDs 
Hi cypherpunks,
First-time poster.  I've lurked awhile.  I'm working on a system for key infrastructure, and I'd like to invite criticism, comments, help, etc., from anyone interested.  You can find the paper and code here:
Here's a summary -
The system is based on a critique of X.509-style PKI.  The critique is this:  Any key infrastructure has to handle the twin tasks of:
  - Public-key distribution (Bob finding Alice's public-key)
  - Private-key management (Alice keeping her private-key(s) secure yet PKI handles the former through certificates, and the latter through certificate revocation.  These force a tight coupling between subjects (e.g. Alice) and CAs - subjects must contact CAs to get their certificates, and also to revoke keys and renew certificates.
Since the function of Trusted-Third-Parties (e.g. CAs) is to provide information to *relying parties* (e.g. Bob), I argue that this coupling of *subjects* with TTPs is inappropriate for a decentralized environment like the Internet.
In such an environment, different relying parties will trust different TTPs.  For the subject to procure certificates that would satisfy all these RPs, he'd have to predict the future to know which RPs will contact him, read the minds of these future RPs to know what they care about, and then contact the hundreds of TTPs these different RPs trust to procure relevant It would be better to decouple subjects from TTPs, so that subjects could perform private-key management without the involvement of TTPs, and so that TTPs could perform key distribution without the involvement of subjects.
The key to this separation of tasks is to use fingerprints as the interface between the "private" and "public" domains: the subject will use private-key management to perpetuate a long-lived public-key.  The fingerprint of this key will be the subject's "cryptographic identifier" - it will be passed around by TTPs and RPs to "speak about" the subject.
Now, private-key management and public-key distribution can proceed independently.  For private-key management, the subject will most likely keep his long-lived "root key" in a safe place, and use it only occasionally to certify "subkeys".  The subject may also do things such as splitting the root key into shares, using proactive and/or threshold signing schemes, using "threshold subjects" a la SPKI, using multiple layers of subkeys as "intermediate CAs", using revocation/revalidation to quickly disable compromised subkeys, or even just giving his root key to someone he trusts who has better security, and more competence with these techniques, than himself.
For public-key distribution, online trusted directories (such as DNS, LDAP, XKMS, etc.) should replace CAs.  Users would have address books containing trusted fingerprints, which they populate manually or by querying directories.
In sum, the argument is that fingerprints are better than certificates for key distribution, but that fingerprint key distribution is most effective when supported by cert-based private-key management, to secure the long life of the fingerprints.
This is similar to PGP (without the Web of Trust) - PGP uses fingerprints to authenticate distributed keys, and has subkeys that can be used for private-key management.
However, if you take this approach seriously, PGP's fingerprints and subkeys aren't good enough.  PGP fingerprints are too long, and PGP subkeys don't support important techniques like revalidation, threshold subjects, or multiple layers of subkeys.
So the paper presents "cryptoIDs", which are 20-character-long fingerprints; and cryptoID certificates, which are a certificate format designed solely for private-key management.
Anyways, I'm interested to hear what anyone thinks.  Thanks,

@_date: 2013-12-27 15:56:43
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Which discussion?  The only substantial discussion of Dragonfly at a
CFRG meeting appears to be at IETF 83.  Is that what you're referring
As a member of the "crypto practice community" I disagree.  Key
agreement protocols are widely understood to be a tricky area where
formal analysis is crucial.  Dragonfly's lack of such analysis was a
red flag.  Jonathan Katz, a world-class cryptographer, raised the
issue repeatedly.  The CFRG chairs ignored him and endorsed Dan
Harkins' bluster.
Seems like CFRG could use more outreach to the cryptography community
and less to the intelligence community.
I see.  That's terrifying.
If the IETF/IRTF community endorses Kevin through an open process I'd
give up participating in IETF/IRTF any further.  That's not
"acceptance", but you wouldn't have to listen to me any more.
I'm not advocating a formal policy.  I believe the selection (or
removal) of chairs involves weighing many factors, and is best handled
on a case-by-case basis.
I think those are bad ideas which would not prevent sabotage and would
burden innocent contributors.
No.  From what I can tell Kenny Paterson handled it well.
But amongst those defending Kevin, a major theme seems to be that
trustworthiness and expertise is not important for IETF/IRTF chairs
since they're presiding over an open process.
I disagree since chairs wield a great deal of power in the IETF/IRTF
process.  The "Lucky 13" disclosure highlights an additional duty
which has been entrusted to CFRG chairs and which is hard to audit.
That's a good description.  But so is your phrase "steering the RG in
an unfruitful direction".  Kevin's paragraph is below:
Scott Fluhrer proposed an elegant change to DragonFly that fixes this.
 In the EC case, replace
the while-loop with a for-loop, say =93for t =3D 1,,,,40=94.  On each pass
through this for-loop generate
a possible x- coorodinate as in DragonFly,  saving off the first x
value which corresponds to a
point on the curve.  The only thing that can go wrong here is doing
all 40-iterations without
finding a good x-coordinate.  This is quite unlikely to occur (~
10^-12), but when it does occur
it gives 40 bits of information about the password.  In some VERY high
volume applications it
might be prudent to choose a value larger than 40.
I'm still not sure what you're asking.  Let's just look at a crude
analysis of the "40-loops" countermeasure Kevin endorsed, comparing
CFRG draft-00 vs draft-01/draft-02.
Let's assume that modular square roots are calculated via modular
exponentiation, and that Legendre symbol calculations take less time.
Let's also ignore the variable time taken by a Legendre symbol
calculation and other conditional logic, and just count the number of
In draft-00, the hunt-and-peck loop in 3.2.1 performs Legendre symbol
calculations until it finds a square (probability ~1/2), at which
point a square root is performed.  So:
 - 1 modular exponentiation
 - Variable number of Legendre symbol calculations
   - geometric distribution with mean ~2, variance ~2
In draft-01 and draft-02, the hunt-and-peck loop continues until it
completes 40 loops, with a probability ~1/2 of performing a modular
exponentiation on each iteration.  So:
 - Variable number of modular exponentiations
   - binomial distribution with mean ~20, variance ~10
 - 40 Legendre symbol calculations
The 40-loops algorithm was intended to reduce timing variance but
instead increases it, and increases computation cost as well.  So I
think "ineffective" is a fair description.  Do you agree?
Sure.  Crypto's hard.  Mistakes happen.  But I'm uncomfortable with
the volume of mistakes in Kevin's handling of Dragonfly:
 * Endorsing Dragonfly despite better alternatives in the literature
 * Twice suggesting a way of deriving the DH generator which makes the
protocol breakable
 * Endorsing an ineffective timing-attack countermeasure
 * Misrepresenting CFRG consensus to TLS WG

@_date: 2013-12-24 12:02:43
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Hi David,
(trimming recipients back to CFRG list)
Would you agree that CFRG's charter includes providing crypto advice
to IETF WGs, and that this advice is an important output from CFRG?
I was thinking of TLS.  Kevin has provided advice to other groups
(HIP, JOSE), but I don't know whether that was construed as coming
from CFRG or Kevin.
Yes, I've asked why it was reported to TLS WG that CFRG approved of
Dragonfly, despite the record reflecting skepticism:
I've looked over his mailing list contributions.
Kevin seems unfamiliar with sidechannel attacks, RSA padding, provable
security, key agreement protocols, and consulting academic literature.
 I'm sure he's good at math, but I don't see the breadth of knowledge
I'd expect for his position.
His messages don't reflect a high standard of diligence.  He's made
significant mistakes with Dragonfly.  His tone reminds me of a bemused
hobbyist who doesn't care whether any of this is secure.
I believe there are people who could do a better job.
Having seen how CFRG contributions are ignored by the chairs, I'm not
surprised people aren't interested in contributing.
Has there ever been an open process for CFRG chairs?  I think you and
Ran Canetti were appointed at the beginning of CFRG, and then you
appointed Kevin as Ran's replacement with no call for other
candidates.  Is that right?
You seem to be arguing that intelligence agencies are the only people
who would propose someone for CFRG chair.
I'm not sure that's true.  Perhaps CFRG should follow an actual
process for selecting its chairs.  Kevin or anyone else would be
welcome to participate.
No, if I trusted that the "government communications security agency"
was actually working to provide "communications security" instead of
intelligence access.
It's difficult to ascertain that, of course.  Some uncertainty and
angst will attend any decision we make.  That's life in crypto.
Still, we should do the best we can to select a chair who is trusted
and respected by a wide audience.  At the current moment, I believe
that means avoiding the NSA.
 as
No one proposed that.
It's easy to scrutinize the work of a document author.
In contrast, the IETF/IRTF's lack of formal process places a lot of
power in the chair.  The chair has the ability to call consensus,
communicate this to other groups, and has "wide discretion in the
conduct of Research Group business" [1].  For the CFRG chairs this has
included handling an important security flaw prior to public
disclosure [2].
Even if we detect incorrect behavior from a chair, trying to challenge
it is hard and disruptive (see Dragonfly).
The competence and judgement of a chair, and his/her ability to
inspire trust, is very important to a successful WG or RG.
I've considered it.  But I won't contribute to this group under NSA leaders=
 to
 them."
That's [IGOE_3].  See the paragraph preceding your quote.  "steering
the RG in an unfruitful direction" is exactly how I'd describe it.
Not sure I understand this quibble.
I believe there's a serious timing attack risk in the CFRG and TLS
Dragonfly drafts, as has been explained repeatedly by many people.
I think CFRG deserves a chair who would be informed enough to
understand these areas, and diligent enough not to make the technical
and process mistakes that Kevin did.
CFRG's crypto advice has wide consequences.  It's reasonable to
consider feedback from outside the club of IETF crypto gurus.
Anyways, I'll be stepping away for a few days as well, happy holidays every=
[1] [2] Lucky 13 -

@_date: 2013-12-21 17:53:24
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Hi Stephen,
My impression is that WGs such as TLS do indeed rely on CFRG opinion.
Perhaps that's their choice rather than an IETF mandate.  Nonetheless
it does occur, as was quite clear in the handling of Dragonfly:
"The TLS WG isn't chartered to evaluate cryptographic mechanisms, so
where there is some question we generally rely on CFRG for an opinion"
 - Eric Rescorla, TLS WG Chair

@_date: 2013-12-21 17:25:53
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Hi Lars,
I think the issues here are also relevant to the IETF WGs which rely on CFRG.
I hope there's some way to engage this broader set of stakeholders in
the discussion.  I admit I'm not sure the best way to do that.

@_date: 2013-12-20 16:01:38
@_author: Trevor Perrin 
@_subject: [Cfrg] Requesting removal of CFRG co-chair 
Dear IRTF Chair, IAB, and CFRG:
I'd like to request the removal of Kevin Igoe from CFRG co-chair.
The Crypto Forum Research Group is chartered to provide crypto advice
to IETF Working Groups.  As CFRG co-chair for the last 2 years, Kevin
has shaped CFRG discussion and provided CFRG opinion to WGs.
Kevin's handling of the "Dragonfly" protocol raises doubts that he is
performing these duties competently.  Additionally, Kevin's employment
with the National Security Agency raises conflict-of-interest
Dragonfly Background
Dragonfly is a "Password-Authenticated Key Exchange" protocol (or
"PAKE").  Dragonfly was proposed to CFRG 2 years ago [PROPOSAL].
Compared to better-known PAKEs, Dragonfly has no security proof, a
lack of extensive security analysis, nonfunctional complications added
for IPR reasons, and some security issues [REVIEW].
Dragonfly became a hot topic recently when the TLS WG disputed CFRG's
alleged report that Dragonfly was "satisfactory", as well as disputing
that this report reflected CFRG consensus [TLS_1].  After extensive
criticism of Dragonfly, the TLS WG ceased work on a Dragonfly
extension [TLS_2].
NSA Background
The National Security Agency ("NSA") is a U.S. Intelligence Agency
which is believed to devote considerable resources to:
 - "Influence policies, standards and specifications for commercial
public key technologies"
 - "Shape the worldwide cryptography marketplace to make it more
tractable to advanced cryptanalytic capabilities" [BULLRUN]
While much is unknown about these activities, the NSA is known to have
placed a "back door" in a NIST standard for random number generation
[ECDRBG].  A recent report from the President's Review Group
recommends that the NSA:
 - "fully support and not undermine efforts to create encryption standards"
 - "not in any way subvert, undermine, weaken, or make vulnerable
generally available commercial software" [PRESIDENTS]
This suggests the NSA is currently behaving contrary to the recommendations.
Reasons for requesting Kevin's removal
1)  Kevin has provided the *ONLY* positive feedback for Dragonfly that
can be found on the CFRG mailing list or meeting minutes.  The
contrast between Kevin's enthusiasm and the group's skepticism is
striking [CFRG_SUMMARY].  It's unclear what this enthusiasm is based
on.  There's no record of Kevin making any effort to understand
Dragonfly's unusual structure, compare it to alternatives, consider
possible use cases, or construct a formal security analysis.
2)  Twice Kevin suggested a technique for deriving the Dragonfly
password-based element which would make the protocol easy to break
[IGOE_1, IGOE_2].  He also endorsed an ineffective attempt to avoid
timing attacks by adding extra iterations to one of the loops [IGOE_3,
IGOE_4].  These are surprising mistakes from an experienced
3)  Kevin's approval of Dragonfly to the TLS WG misrepresented CFRG
consensus, which was skeptical of Dragonfly [CFRG_SUMMARY].
4)  Kevin's NSA affiliation raises unpleasant but unavoidable
questions regarding these actions.  It's entirely possible these are
just mistakes by a novice chair who lacks experience in a particular
sort of protocol and is being pressured by IETF participants to
endorse something.  But it's hard to escape an impression of
carelessness and unseriousness in Kevin's work.  One wonders whether
the NSA is happy to preside over this sort of sloppy crypto design.
While that's of course speculation, it remains baffling that an
experienced cryptographer would champion such a shoddy protocol.  The
CFRG chairs have been silent for months, and haven't responded to
attempts to clarify this.
The position of CFRG chair (or co-chair) is a role of crucial
importance to the IETF community.  The IETF is in desperate need of
trustworthy crypto guidance from parties who are above suspicion.  I
encourage the IAB and IRTF to replace Kevin Igoe with someone who can
provide this.
Thanks for considering this request.
[PROPOSAL] [REVIEW] [TLS_1] [TLS_2] [BULLRUN] [ECDRBG] [PRESIDENTS] [CFRG_SUMMARY] [IGOE_1] [IGOE_2] [IGOE_3] [IGOE_4]

@_date: 2014-01-04 02:50:12
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Hi Scott,
In 2012 I can imagine you were thinking of something like your below
pseudocode.  However, Dan seems to have understood your 2012 messages
as saying that simply performing 40 loops of the draft-00 algorithm
was a sufficient timing-attack countermeasure.  I don't think we can
blame Dan entirely for that - your messages weren't as clear and
detailed as your current pseudocode.
In any case, I think everyone now agrees Dan's understanding, embodied
in CFRG drafts 01 and 02, is incorrect.  Work still needs to be done
to ensure individual loop iterations don't leak secret info.
Kevin seems to have shared Dan's understanding.  Or at least: he
considered the issue resolved in drafts 01 and 02, and made no effort
to look more deeply into the timing question.
Scott's proposals:
Dan and Kevin's reception:
Kevin's endorsement of draft-01 and draft-02:
"The design looks mature, it addresses a real need, and no one has
raised any issues."
"Kevin reports to TLS WG chairs that CFRG did not find any problems
with Dragonfly."

@_date: 2014-01-04 02:43:16
@_author: Trevor Perrin 
@_subject: Re: [Cfrg] Requesting removal of CFRG co-chair 
Sure, my advice:  There's a wealth of knowledge in academia that CFRG
is not tapping.  Having a CFRG co-chair who could serve as ambassador
to that community and a translator of its knowledge would be very
I'd recommend talking to some of the academic cryptographers who've
engaged with TLS and CFRG (Jonathan Katz, Kenny Paterson, Douglas
Stebila, David Wagner, etc), and see where that leads you.
Also, this would be a good discussion to pursue at Real World Crypto
(NYC, shortly).
Rene brought up the sidechannel issue again in July 2013, with no response:
But there's a bigger picture:  Regardless of timing attacks, Dragonfly
is inferior to alternatives already standardized or found in the
This opinion was well-expressed on the TLS and CFRG mailing lists when
Dragonfly was proposed.  This opinion was probably shared by many more
people than expressed it (like me), and was never adequately
addressed.  By Dec 2012, I assume most people had tuned-out a
discussion about an non-useful protocol that was proceeding without
regard to group opinion.
