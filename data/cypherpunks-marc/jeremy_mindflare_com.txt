
@_date: 2002-02-27 23:37:01
@_author: "Jeremy Lennert" 
@_subject: Re: Jail Cell Cipher (modified RC4) 
Memorizing the permutation table is arguably practical for 37 characters,
but is certainly infeasible for full-scale RC4 (256 entries), and 27 KSAs
isn't enough with an accuracy of 1 in 150,000 (once again, that's an
estimate for 256 entries with the standard KSA).
Putting aside for a moment the question of the size of the permutation table
as a security flaw in and of itself, does anyone see a way the new KSA can
be exploited?  I can potentially play around with the generator size, but it
won't do any good if the key schedule makes the generator insecure.
Grace & Peace,

@_date: 2002-02-23 16:15:13
@_author: "Jeremy Lennert" 
@_subject: Re: Jail Cell Cipher (modified RC4) 
The specification for the key requires all key values to be nonzero.  From
the web site:
"an array of key values K, where each value is a nonzero alphabetical
character or its numerical equivalent"
However, there was an error in the source code that allowed zeroes in the
key.  This has been corrected.  Any zeroes in the key definition now cause
the program to abort with an "invalid character" error message.
Regarding the distinguisher, I don't think I understand how distinguishing
the keystream from random amounts to an attack that will recover the
internal state.  Could you offer further clarification on that?
Incidentally, for paper-and-pencil applications, I'm assuming that the
message length will not exceed about 100 characters.
The problem with using full RC4 is not in the actual keystream generation,
but in running the key-scheduling algorithm.  Even if we only ran the KSA
for one round through the permutation table, estimated time is about 50
minutes (not necessarily impractical, but making many rounds to improve
security or repeated trials to improve accuracy very difficult) and the
chances of performing that entire round without error for my current best
estimations of accuracy are about 1 in 150,000.
For the modified RC4, accuracy still isn't great, but it is good enough that
careful error-checking may leave the algorithm feasible in terms of both
time and accuracy.
Grace & Peace,

@_date: 2002-02-23 06:46:37
@_author: "Jeremy Lennert" 
@_subject: RE: Jail Cell Cipher (modified RC4) 
I'm sorry, I don't think I said that very clearly.
CipherSaber discusses computer implementations for RC4.  I'm attempting to
construct a paper-and-pencil implementation of a modified version of RC4,
while still keeping the cipher secure against computer cryptanalytic
A description of the modified RC4 (and a brief description of the goal), as
I mentioned earlier, is available here:
Thanks for your time,

@_date: 2002-02-23 06:15:58
@_author: "Jeremy Lennert" 
@_subject: RE: Jail Cell Cipher (modified RC4) 
I'm not having difficulty with the implementation (the C++ code included in
my first message, also available at
 , already implements the cipher
correctly).  I'm inquiring regarding the impact of the changes on the
security of the cipher.
Grace & Peace,

@_date: 2002-02-23 04:34:58
@_author: "Jeremy Lennert" 
@_subject: RE: Jail Cell Cipher (modified RC4) 
I believe the standard name is "Solitaire," but "Pontifex" was used
initially in the book to conceal (temporarily) the fact that it involves
This cipher fails to meet the requirements for my hypothetical scenario
because it uses the original ordering of the deck as the key, and because
the cryptographer is not allowed to take anything in with him, this
permutation would need to be memorized, which seems impractical.  Also, if
it becomes standard to perform "jail cell" ciphers with cards, the jailer
will simply deny the prisoner access to a deck of cards.
Paper and pencil are used because they *must* be provided in order to write
a message at all.
Thanks for pointing this cipher out, though!  It is a good one.
Grace & Peace,
