
@_date: 2002-11-07 18:51:45
@_author: Stefan Brands 
@_subject: Re: "patent free(?) anonymous credential system pre-print" - a 
Hello Jason:
No, not at all. The paragraph on page 193 that I referred to is the one
starting with "In some PKIs it is desirable that certificate holders can
anonymously prove to be the originator of several showing protocol
executions." It _preceeds_ the paragraph on digital pseudonyms, which
starts with "A special application of the latter technique are
credential systems in which certificate holders [...] establish digital
pseudonyms with organizations". There are no specifics to be filled in, the paragraph on 193 states
everything there is to it. If the credential holder engages in several
showing protocols (whether in sequence or in parallel, and regardless of
whether at the same time or at different times -- the paragraph applies
to any situation), all that is needed to prove that no pooling is going
on is the abovementioned proof that the credentials all contain the same
hidden identifier. Note that the prover can _hide_ this identifier, thereby allowing him to
prevent linkability with other showing protocol executions for which no
link needs to be established. Of course, the technique also works if
there are many Cas. The user can even prevent the CAs from learning the
built-in identifier that is central to all (or a subset of) his/her
credentials.  (A special CA could issue restrictively blindeded versions
of the user's "identity", which the user then submits to different Cas
who encode it into the certificates they issue.)
Discouraging lending is not the same as preventing pooling. The lending
prevention technique was not intended to address pooling, the technique
on page 193 does a much more effective job at that. However, in your
approach, what prevents me from giving my credentials to someone else
who then uses them to gain access to a service without needing to pool
in any other credentials than the one I lent to him? Note also that when all credential attributes are specified within the
same certificate, and the verifier requires authorization information to
be contained within a single attribute certificate, pooling is
inherently prevented. There is no zero-knowledge variant of your protocol; the verifier ends
up with undisputable evidence (towards third parties) of the
transaction, and in particular of which attribute values have been shown
by the credential holder. Any digital signatures that are made by
certificate holders can be added to their dossiers; they form
self-signed statements that cannot be repudiated, proving to the whole
world who is the originator of a message and possibly what information
they were willing to give up in return for a service. Doing a
zeroknowledge variant of your proposal requires one to prove knowledge
in zk of various elements rather than showing them in the clear; this
requires extrmely inefficient zk techniques, such as for proving
knowledge of a pre-image under a specific hash function.
provide. I realize that many of the features of my work are described in a very
dense manner in the book, and therefore it is easy to overlook them. For
example, on the same page 193 there is a sentence "Using our techniques
it is also straightforward for several certificate holders to jointly
demonstrate that their showing protocol executions did not all originate
the same certificate holder, or for one certificate holder to show that
he or she was
not involved in a fraudulent transaction." The same applies to my
describtion of the simple hash selective disclosure technique on page
27, which only gets two sentences, and many others
techniques/functionalities. The only excuse I have for this is that the
book is a minor revision of my PhD thesis, and so the technical parts
had to be targetted towards an expert audience; while skilled
cryptographers will indeed find the dense statements more than
sufficient, and may even consider some of them as trivial applications
of the general techniques, I can see that this may not always be the
case for readers in general. Good luck with your research!
Stefan Brands

@_date: 2002-11-05 18:56:22
@_author: Stefan Brands 
@_subject: "patent free(?) anonymous credential system pre-print" - a simple 
The paper shows some promise but, apart from being insecure, has other
drawbacks that should be addressed:
- The system is subject to a simple attack. The problem lies with the
multiplication of the  hashes. Let's take the Chaum blinding as an
example, something similar work for the "Laurie"  protocol. The simple
idea is to take    X1 = [ \prod hash(bogus_att, salt_i) ] \times [hash(correct_att,
salt)]^{-n/2} modulo pq
   X2 = X3 = ... = Xn = hash(correct_att, salt)
Submit the blinded Xi's. Assuming X1 will not have to be opened (prob =
1/2 or 1, depending on  whether or not protocol is interactive), one
obains X1^d modulo pq from the signer, which  contains consistently all
the bogus attributes. Here is a suggestion for a "fix" to repair  this
total break. Make sure to that the signer, in additional to the
consistency check for the  opened blinded candidates, also checks that
the opened blinded candidates have _different_  values. Of course,
serious analysis needs to be done to ensure that this is enough to
guarantee security. I do not have the time to look into this, but my gut
feeling is that  variations of the attack based on the same principle
will still work, but with lower success  probability; this will have to
be compensated for by making n bigger, which makes the protocol  even
more inefficient. My advice is to the author is to analyze the proposed
fix, and explore  other possible fixes, before distributing an updated
version. - My work certainly does provide for "revocable anonymity" and "pooling"
prevention. For  pooling protection, see paragraph 2 on page 193,
section 5.11 page 210 paragraph 2, and  section 5.5.2 on page 211. For
not needing separate signing exponents for each attribute, see  page 266
last paragraph on the page. For recovable anonymity, see the e-cash
references on  page 264/5.
- The proposed hashing technique for selective disclosure was introduced
by myself in 1999.  Quoting from page 27 of my MIT Press book titled
"Rethinking Public Key Infrastructures":  "Another attempt to protect
privacy is for the CA to digitally sign (salted) oneway hashes of
attributes, instead of (the concatenation of) the attributes themselves.
When transacting or  communicating with a verifier, the certificate
holder can selectively disclose only those  attributes needed.22 {22
Lamport [244] proposed this hashing construct in the context of
one-time signatures. When there are many attributes, they can be
organized in a hash tree to  improve efficiency, following Merkle
[267].} This generalizes the dual signature technique  applied in SET
[257]." Since this technique is merely at the level of an observation,
and  because it is a simple generalization of the SET technique, I in
fact decided at the time to  put the entire paragraph under section
header 1.2.2 of my book, titled "Previous  privacy-protection efforts
and their shortcomings". - More seriously, the simple hash technique has numerous drawbacks, as I
explain on page page  27 of my MIT Press book, in the very same
paragraph: "Although certificate holders now have  some control over
which attributes they reveal to verifiers, they are forced to leave
behind digital signatures. Furthermore, they are seriously restricted in the
properties they can  demonstrate about their attributes; Boolean
formulae, for instance, are out of the question.  Worse, nothing
prevents the CA and others from tracing and linking all the
communications and  transactions of each certificate holder." Other
techniques, such as lending prevention and  limited-show, do not work
either. It was for these and other reasons that I was motivated to  work
on the more sophisticated selective disclosure in the first place. - In addition to various other drawbacks pointed out by of Dr. Adam Back
the proposal does not  offer a wallet-with-observer mode, discarding
protection, anonymous recertification /  updating, multi-application
certificates, etcetera. Hope this helps,
Stefan Brands

@_date: 2002-11-05 18:56:22
@_author: Stefan Brands 
@_subject: "patent free(?) anonymous credential system pre-print" - a simple 
The paper shows some promise but, apart from being insecure, has other
drawbacks that should be addressed:
- The system is subject to a simple attack. The problem lies with the
multiplication of the  hashes. Let's take the Chaum blinding as an
example, something similar work for the "Laurie"  protocol. The simple
idea is to take    X1 = [ \prod hash(bogus_att, salt_i) ] \times [hash(correct_att,
salt)]^{-n/2} modulo pq
   X2 = X3 = ... = Xn = hash(correct_att, salt)
Submit the blinded Xi's. Assuming X1 will not have to be opened (prob =
1/2 or 1, depending on  whether or not protocol is interactive), one
obains X1^d modulo pq from the signer, which  contains consistently all
the bogus attributes. Here is a suggestion for a "fix" to repair  this
total break. Make sure to that the signer, in additional to the
consistency check for the  opened blinded candidates, also checks that
the opened blinded candidates have _different_  values. Of course,
serious analysis needs to be done to ensure that this is enough to
guarantee security. I do not have the time to look into this, but my gut
feeling is that  variations of the attack based on the same principle
will still work, but with lower success  probability; this will have to
be compensated for by making n bigger, which makes the protocol  even
more inefficient. My advice is to the author is to analyze the proposed
fix, and explore  other possible fixes, before distributing an updated
version. - My work certainly does provide for "revocable anonymity" and "pooling"
prevention. For  pooling protection, see paragraph 2 on page 193,
section 5.11 page 210 paragraph 2, and  section 5.5.2 on page 211. For
not needing separate signing exponents for each attribute, see  page 266
last paragraph on the page. For recovable anonymity, see the e-cash
references on  page 264/5.
- The proposed hashing technique for selective disclosure was introduced
by myself in 1999.  Quoting from page 27 of my MIT Press book titled
"Rethinking Public Key Infrastructures":  "Another attempt to protect
privacy is for the CA to digitally sign (salted) oneway hashes of
attributes, instead of (the concatenation of) the attributes themselves.
When transacting or  communicating with a verifier, the certificate
holder can selectively disclose only those  attributes needed.22 {22
Lamport [244] proposed this hashing construct in the context of
one-time signatures. When there are many attributes, they can be
organized in a hash tree to  improve efficiency, following Merkle
[267].} This generalizes the dual signature technique  applied in SET
[257]." Since this technique is merely at the level of an observation,
and  because it is a simple generalization of the SET technique, I in
fact decided at the time to  put the entire paragraph under section
header 1.2.2 of my book, titled "Previous  privacy-protection efforts
and their shortcomings". - More seriously, the simple hash technique has numerous drawbacks, as I
explain on page page  27 of my MIT Press book, in the very same
paragraph: "Although certificate holders now have  some control over
which attributes they reveal to verifiers, they are forced to leave
behind digital signatures. Furthermore, they are seriously restricted in the
properties they can  demonstrate about their attributes; Boolean
formulae, for instance, are out of the question.  Worse, nothing
prevents the CA and others from tracing and linking all the
communications and  transactions of each certificate holder." Other
techniques, such as lending prevention and  limited-show, do not work
either. It was for these and other reasons that I was motivated to  work
on the more sophisticated selective disclosure in the first place. - In addition to various other drawbacks pointed out by of Dr. Adam Back
the proposal does not  offer a wallet-with-observer mode, discarding
protection, anonymous recertification /  updating, multi-application
certificates, etcetera. Hope this helps,
Stefan Brands
