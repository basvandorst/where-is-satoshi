
@_date: 2013-10-24 07:52:56
@_author: Stephan Mueller 
@_subject: Re: Curious RNG stalemate [was: use of cpunks] 
Am Mittwoch, 23. Oktober 2013, 23:46:26 schrieb Andy Isaacson:
Hi Andy,
Maybe CPU Jitter RNG provided on  helps here? The test results are prepared on a plethora of different CPUs, operating systems and compilers and thus should cover 95% of all users (I am trying to get test results for iOS to cover 99% of all users).
(disclaimer: I wrote the code and I may be biased in the judgment)

@_date: 2013-10-24 15:06:58
@_author: Stephan Mueller 
@_subject: Re: [Cryptography] /dev/random is not robust 
Am Donnerstag, 24. Oktober 2013, 05:06:16 schrieb Alon Ziv:
Hi Alon, Ted,
This issue is larger than SSHD, it covers dm_crypt too. Especially dm_crypt is vulnerable to this problem in case it is configured for full disk encryption. In this case, the installer generates the volume key as one of the first things during the initial installation. As this volume key cannot be changed for the lifetime of the system, it is highly important to have that generated properly (read: with good entropy).
Of course, you can say: well, installers have a graphical UI and therefore there is lots of mouse movements, etc. for /dev/random. But this is not always the case. Almost all distros allow an automated installation (anaconda allows that, the Debian/Ubuntu installer allows that, YaST too, ...), you can define automated installations with full disk encryption which only interrupt at the time when you have to provide the passphrase to protect the key. At that time, the key is already generated by libcryptsetup. But there was no real user interaction, no hard disk interaction and only limited interrupts to add entropy to /dev/random.
Using console-based installers is a bit better, but the user only needs to hit some keys before the volume key is to be created.
Now, you can say that is the responsibility of the Distros to catch that (e.g. require the user to hit a number of keys before generating the key), but I guess that approach is fragile.
I guess you can find many more examples of the issue where we need entropy at the time the current /dev/random code cannot provide that. I guess the only solution is to open up new entropy sources for that.
The cryptography mailing list

@_date: 2013-10-18 13:09:08
@_author: Stephan Mueller 
@_subject: Re: [Cryptography] /dev/random has issues 
Hi Ted,
There is one more strain on the entropy: ASLR. I provided a patch once ( that would have covered some aspects, but that was shot down with a link to a different patch -- see that thread.
Unfortunately, there is no fix for this issue as of now. Andrew mentioned an easy patch, which I think is not appropriate -- but Ted and Andrew think it is good.a
Ted, maybe it may be helpful to push either Andrew's or my the patch again, because that issue is a real strain.
The cryptography mailing list

@_date: 2013-10-28 16:41:44
@_author: Stephan Mueller 
@_subject: Re: [Cryptography] [RNG] /dev/random initialisation 
Am Montag, 28. Oktober 2013, 12:35:29 schrieb Sandy Harris:
Hi Sandy,
You are right, I only considered scenarios where adversaries can log on. In your considered situation, I concur that the information does indeed add entropy.
Right. Also see the answer from the Debian developer on LKML today who says that on Debian the kernel log or similar is injected into Right. But I meant the time stamp as follows:
ifconfig > /dev/random
clock_gettime(CLOCK_REALTIME) > /dev/random
netstat > /dev/random
clock_gettime(CLOCK_REALTIME) > /dev/random
I fully concur.
The cryptography mailing list

@_date: 2013-10-28 15:27:07
@_author: Stephan Mueller 
@_subject: Re: [Cryptography] [RNG] /dev/random initialisation 
Hi Sandy,
Thank you for summarizing that issue.
I do not think that this is helpful as any attacker is able to obtain such information as well. Thus, the information has zero entropy and can only be used to stir the pool more. If you stir in the time stamp when you invoke the commands, you may get entropy from that time stamp.
Furthermore, random.c is initialized so early in the boot cycle that neither the kernel nor user space has any ability to inject meaningful data to mix the initial state.
I would like to see the measurement they reference. However, I expect that 4 bits or more are based on the timer resolution being so high that no attacker can determine the precise device attachment time with a precision of more than 4 bits (e.g. 2**4 ns).
If we have such a high resolution timer, the CPU Jitter RNG will work as well. Thus, I took your suggestion and updated the CPU Jitter RNG patch to stir the entropy pools of random.c when they are initialized in My tests show that the jitter is all present at that time and can well be used to stir the pool. Please see  file That patch is such that at the time of init_std_data, 32 bytes (i.e. 256 bits) of entropy from the jitter is added to the entropy pool which is enough to already generate keys with sufficient strength.
The cryptography mailing list
