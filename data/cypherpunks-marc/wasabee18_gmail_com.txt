
@_date: 2013-08-15 11:11:23
@_author: wasa bee 
@_subject: Re: [cryptography] LeastAuthority.com announces PRISM-proof storage service 
but it's not the only place that happens. I've never used PGP but I've used
SMIME, so I'll refer to SMIME here (that may also apply to PGP anyway). In
SMIME, the keyWrap (which contains the AES key encrypted under each
recipient's public key) has some sort of headers that the recipient parses.
The header contains info about the intended recipients' certs, like issuer,
SN and email. sometimes it even contains the entire recipient's cert (if
memory serves). So one has to be careful of what info is contained in the
keywrap structure. If the email is present, it will leak even if To/From
were protected somehow. Even if the email is not present, maybe the cert
info provided for the decryption of the keyWrap still leaks enough info
about recipients... for e.g. it might be enough to identify people by their
cert rather than by their email.
Another example where all this matters is in BCC headers. In Firefox (last
time i checked was 2 years ago i believe), Firefox would send the same
message to both To,CC and BCC recipients. The BCC header of course is not
present in the message so recipients don't have access to it. However,
going thru the keyWrap structure leaks the fact that the message has also
been encrypted for an extra recipient so it breaks the BCC purpose.
It seems to me that as long as a long-term info is transmitted in each
message, it can be used for tracking who's talking to whom. Or one needs to
build some sort of deniability into the crypto scheme.
