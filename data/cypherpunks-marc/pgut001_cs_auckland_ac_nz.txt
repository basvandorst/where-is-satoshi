
@_date: 2001-11-03 05:15:47
@_author: Peter Gutmann 
@_subject: Re: Proving security protocols 
I may as well speak up as well then... I spent most of a chapter of my thesis
looking at formal security verification in fairly exhaustive detail (if I
missed anything I'm sure I'll hear about it soon :-).  You can get it as
  The conclusion is
that there are more effective ways to spend your time and money, but for the
full story I'd recommend you read the above document.

@_date: 2001-12-30 23:12:21
@_author: Peter Gutmann 
@_subject: RE: CFP: PKI research workshop 
Thus making it a perfect analogy for PKI [0].
[0] Before people flame me for this, what's currently widely-used is what's in
    X.509v1 modulo CRL support.  Anything else, you're on your own.

@_date: 2001-12-27 22:50:17
@_author: Peter Gutmann 
@_subject: Re: CFP: PKI research workshop 
The reason for this is that as we work on PKI deployment, we discover more and
more (previously unknown) problems which need to be solved.  If you look at PKI
in 1978 it was pretty simple (certificates in a "public file"), then in the
1980's it got more complex with directories and CRLs and whatnot, and after
that an ongoing stream of further issues which need to be addressed were
discovered as systems were finally deployed.  It's just getting harder and
harder as we discover more and more problems when we try and actually implement
the thing.  Even what we know now is only the tip of the iceberg compared to
what we're going to discover further down the track, and that's only
identifying the *problems* to be solved, not providing solutions.
PKI is like an erection: The more you think about it, the harder it gets.

@_date: 2001-12-27 21:41:28
@_author: Peter Gutmann 
@_subject: Re: CFP: PKI research workshop 
Naah, it's the monorail/videophone/SST of security.  Looks great at the World
Fair, but a bit difficult to turn into a reality outside the fairgrounds.
Peter (who would like to say that observation was original, but it was actually
       stolen from Scott Guthery).

@_date: 2001-12-15 17:36:09
@_author: Peter Gutmann 
@_subject: Re:  The MS DRM Patent and Freedom to Speak and Think 
I wonder how long it'll take for someone to locate the undocumented _MPAAKEY
which exists alongside MS's documented one?

@_date: 2002-04-26 06:19:42
@_author: Peter Gutmann 
@_subject: Re: Lucky's 1024-bit post [was: RE: objectivity and 
That'd be 4 + (2 + (12 + 18)) bytes = 288 bits for a 128-bit hash and PKCS

@_date: 2002-04-04 10:27:43
@_author: Peter Gutmann 
@_subject: Re:  what is GPG's #1 objective: security or anti-patent stance ( Re: on the state of PGP compatibil 
I've been in a similar situation.  Back when I was fighting our government over
crypto export controls, it was sometimes necessary to talk to journalists in a
manner which didn't give the spooks a week's advance notice about something
which they shouldn't have known about until they opened the morning paper.
This was in the days of PGP 5.x.  Some of the people I was talking with were
pretty patient, and often put up with multiple iterations of neither side being
able to decrypt the other's messages, but eventually the choice came down to
given the opposition advance notice or not having the story published at all,
and there's really not much choice there.
Now substitute "human rights group" for "journalist" and "secret police" for
"spooks" and you can see why this is a problem.  Non-commercial PGP has always
been by geeks, for geeks, with features more important than minor
considerations like usability.  Who cares if there are 146 semi-documented,
vaguely-defined command-line options, look at the algorithm choices!  If you
want to use some obscure hash algorithm which was fasionable for 2 months in
1997, you can, and who cares if it takes you half an hour, the FAQ, the
manpage, and an online search to figure out how to encrypt a file?
That's why non-commercial crypto will always struggle to find mainstream
acceptance.  Doing the crypto engine is (relatively) easy, and fun, and there
are lots of people willing to help.  Doing the UI components is dreary and
boring, and no-one is interested because they've just spotted a hash algorithm
published in the Journal of the Bratislavian Philological Society in 1978 which
they urgently need to add support for.
(Although I don't use Windows mailers, I've heard nice things about The Bat,
  which has built-in PGP support.
 Apparently at some point Pegasus Mail,  will have built-
 in PGP and S/MIME support as well).

@_date: 2002-04-04 10:27:43
@_author: Peter Gutmann 
@_subject: Re:  what is GPG's #1 objective: security or anti-patent stance ( Re: on the state of PGP compatibil 
I've been in a similar situation.  Back when I was fighting our government over
crypto export controls, it was sometimes necessary to talk to journalists in a
manner which didn't give the spooks a week's advance notice about something
which they shouldn't have known about until they opened the morning paper.
This was in the days of PGP 5.x.  Some of the people I was talking with were
pretty patient, and often put up with multiple iterations of neither side being
able to decrypt the other's messages, but eventually the choice came down to
given the opposition advance notice or not having the story published at all,
and there's really not much choice there.
Now substitute "human rights group" for "journalist" and "secret police" for
"spooks" and you can see why this is a problem.  Non-commercial PGP has always
been by geeks, for geeks, with features more important than minor
considerations like usability.  Who cares if there are 146 semi-documented,
vaguely-defined command-line options, look at the algorithm choices!  If you
want to use some obscure hash algorithm which was fasionable for 2 months in
1997, you can, and who cares if it takes you half an hour, the FAQ, the
manpage, and an online search to figure out how to encrypt a file?
That's why non-commercial crypto will always struggle to find mainstream
acceptance.  Doing the crypto engine is (relatively) easy, and fun, and there
are lots of people willing to help.  Doing the UI components is dreary and
boring, and no-one is interested because they've just spotted a hash algorithm
published in the Journal of the Bratislavian Philological Society in 1978 which
they urgently need to add support for.
(Although I don't use Windows mailers, I've heard nice things about The Bat,
  which has built-in PGP support.
 Apparently at some point Pegasus Mail,  will have built-
 in PGP and S/MIME support as well).

@_date: 2002-04-10 04:57:44
@_author: Peter Gutmann 
@_subject: Re: all about transferable off-line ecash (Re: Brands 
Just as a reference point, NZ switched from paper $1 and $2 to coins vaguely
similar to the US dollar coin a few years ago without any fuss.  If the USG
simply told people the notes were being withdrawn in 12 months (or whatver),
the change should work OK.
Having used both, I *much* prefer the coins.  Being in the US and having to
handle wads of tattered, grubby $1 notes, many of which wouldn't be accepted by
vending machines because of their condition or weren't the sort of thing you'd
want to touch just before you ate the food you'd bought with them, really
showed me what I was missing with $1 coins.

@_date: 2002-04-12 05:05:27
@_author: Peter Gutmann 
@_subject: Re: Coins vs. bills 
Not being from the US I have no idea who either of those two are, but that does
raise an interesting point: Maybe the reason no-one wants the coin is because
of who's on it.  Solution: Mint a coin with La Cicciolina (or whoever the US
equivalent would be) on it.  They'd be able to get rid of at least 140M of

@_date: 2002-04-24 15:09:49
@_author: Peter Gutmann 
@_subject: RE: Lucky's 1024-bit post [was: RE: objectivity and factoring 
There are both applications and crypto libraries which perform fairly extensive
checking on keys.  However, it's not as simple as you describe:
- GPG and (I believe) NAI PGP perform a pile of sanity checks which among other
  things are designed to make the Klima-Rosa attack a lot more difficult to
  pull off.  This works because PGP knows it's only going to be fed keys from
  other PGP implementations, so it doesn't have to put up with the quirks and
  oddities of random software.
- CryptoAPI expects keys to be in a certain format based on its own
  public/private key blob format, and crashes if they're not.  It doesn't seem
  to do any validation of parameters, and there's even a MSKB article telling
  you how to use an RSA key with e=1 to export plaintext secret keys (!!).
  This is the opposite end of the scale from the GPG/PGP approach.
- For crypto libraries, which have to be able to accept keys from all sorts of
  weird sources, it's difficult to get it right.  For example I perform a pile
  of checks on RSA keys (n = p * q, ( d * e ) mod p-1 == 1 and ( d * e ) mod
  q-1 == 1, ( q * u ) mod p == 1, etc [0], the standard stuff from the Klima-
  Rosa paper) and the FIPS 186 checks on DLP keys.  As a result, I keep getting
  complaints from people whose weird keys are being rejected by my code.  My
  standard response to this is "You've got the source code, if you want to use
  strange key parameters you can change the source to allow it" (transl."If you
  want to hang yourself, the rope's over there"), but that hardly works for
  commercial products.
As a result, (most) crypto libraries will continue to allow any old garbage as
key values.  User perception is more important than security.
[0] Speaking of RSA sanity checks, can anyone provide a sensible explanation
    why OpenSSH uses e=35?  I can think of several reasons why you wouldn't
    want to use this, but no sensible argument in support of it.

@_date: 2002-04-28 23:58:46
@_author: Peter Gutmann 
@_subject: Re: disk encryption modes 
It is a CBC MAC.  A CBC MAC encrypts n blocks and then takes the final output as the MAC.  Now look at where the IV for the second pass comes from.  It's a nice trick, because it works without any data expansion.
Originally in a sci.crypt post of about 10 years ago, more recently (which isn't saying much, it was years ago) in the docs for SFS,   Note that this is the speed-customised version, the version which uses two passes of encryption is in RFC 3211.

@_date: 2002-04-28 06:22:22
@_author: Peter Gutmann 
@_subject: Re: disk encryption modes 
Actually it's more general that that, the reason the original implementation
used such a simple first pass was because it had to run on things like 385/25's
which weren't too fast doing two passes of encryption.  For anything more
recent, you'd do two passes of encryption, the first to build the IV and the
second to encrypt with it.  This in effect means that the first pass is a MAC
of the data (alongside encrypting it) and the second pass is pure encryption.
This gives you some nice provable security properties which Phil Rogaway and
Mihir Bellare have done some work with (see
 and
 for some publications).  This
is the approach used in RFC 3211, which I'd regard as the proper (unconstrained
by having to run on a slow CPU) way to use the technique..
(I'm kinda surprised that this issue keeps coming up again and again, Colin's
 design is a general-purpose solution which works with any block cipher.  It's
 a solved problem, and has been so for about a decade).
While I'm on the topic, I'd also like to question the implicit assumption that
speed is the principal design target.  Having a lot of experience with disk
crypto on (by current standards) very slow machines, I must say that speed has
never been a problem for me.  Right now I'm doing software-based 3DES and I
can't even notice that the drive is encrypted.  Now if you're encrypting swap
and your system is thrashing I can see that you'd notice, but for the average
user who barely accesses the disk and who's running a modern OS which does
sensible buffering/cacheing, it really isn't an issue.  Far better to
concentrate on flexibility and security than to drop everything so you can
chase after this single red herring.

@_date: 2002-05-28 05:37:54
@_author: Peter Gutmann 
@_subject: RE: NAI pulls out the DMCA stick 
No, as I said before, what you're describing is PEM circa 1991, not S/MIME.  In
the S/MIME model, anyone can issue certs (just like PGP), including yourself.
In addition, many large CAs will issue certs in any name to anyone, so even if
you don't want to do your own keys a la PGP you can still get a Verisign cert
which behaves like a PGP key.
Rather than wasting all this bandwidth in a lets-bash-S/MIME-by-pretending-
it's-still-PEM debate (what is it with this irrational fear of S/MIME?), I'd be
more interested in a serious discussion on which key-handling model is less
ineffective, WoT or X.509-free-for-all.  At the moment both of them seem to
work by using personal/direct contact to exchange keys, with one side
pretending to be WoT-based (although no-one ever relies on this) and the other
pretending to be CA-based (although no-one ever relies on this [0]).  The end
result is that they're more or less the same thing, the only major
differentiating factor being that most X.509-using products don't allow you to
distribute your own certs the way PGP does.
[0] With my earlier caveat about exceptions for government orgs who have been
    instructed to rely on it, or else.

@_date: 2002-05-28 05:06:18
@_author: Peter Gutmann 
@_subject: Re: Edinburgh Financial Cryptography Engineering 2002 - CFP 
Unfortunately they've become either just another Crypto clone (FC in the last
year or two) or a collection of XML/J2EE/buzzword-du-jour be-ins (all the
rest).  The world still needs a good, technical e-commerce security conference
which isn't one of the above.
I'd love to see it resurrected.  While I can't really organise it because of
where I am, I'd be happy to referee papes or whatever.  Having served on PCs
for several other security conferences, I've seen enough papers of the
appropriate kind submitted elsewhere to indicate that there'd be enough for an
e-commerce security conference (in other words there's no shortage of material
there).  The Usenix one, during its short lifetime, attracted some really good

@_date: 2002-05-27 08:11:18
@_author: Peter Gutmann 
@_subject: Re:  S/MIME and web of trust (was Re: NAI pulls out the DMCA 
I proposed some very simple additions to X.509 which would allow you to use the
certs in the same way as PGP keys a year or two back.  Unfortunately the PKIX
WG chair is about as open to PGP-style additions to X.509 as some PGP people
are towards S/MIME.
(You can also do PGP using X.509 certs, I've been doing that for awhile just
 out of sheer bloody-mindedness :-).

@_date: 2002-05-01 05:47:49
@_author: Peter Gutmann 
@_subject: Re: Got carried away... 
No no, he was referring to "little tanks", presumably Lt.Gruber's one.  The security model there is that if you steal it, Herr Flick hits you over the head with a huge knackwurst.

@_date: 2002-05-10 16:01:11
@_author: Peter Gutmann 
@_subject: Re:  attack on rfc3211 mode (Re: disk encryption modes) 
Right.  One minor point, the IV is never zero, for disk encryption it's a
cryptographic transform of the sector number, for PWRI it's supplied by the CMS
algorithm parameter (this doesn't affect the attack).
Yup.  Actually the no-stored-IV encryption was never designed to be a non-
malleable cipher mode, the design goal was to allow encryption-with-IV without
having to explicitly store an IV.  For PWRI it has the additional nice feature
of avoiding collisions when you use a 64-bit block cipher, which is probably
going to be the case for some time to come even with AES around.  It was only
after all that that I noticed that the first pass was effectively a CBC-MAC,
but it didn't seem important enough to mention it in the RFC since it wasn't an
essential property (good thing I didn't :-).
Even with PWRI you get at most ~32 bits of protection, and can bypass even that
if you encrypt 5 or more 64-bit blocks and mess up the second block, since the
garble will propagate to at most 4 of the 5 blocks.  The 32-bit limit was
deliberate, I was worried about dictionary attacks above all else (in fact the
first version of the wrap was a bit too paranoid in that it had no redundancy
at all, which unfortunately meant that it wasn't possible to catch incorrect
passwords.  User complaints lead to the addition of the 24-bit check value
which is enough to catch virtually all mistyped passwords but not enough to
provide more than a small reduction in the number of guesses necessary for an
attacker.  The length byte is there so an attacker can't perform an iterative
attack where they change the algorithm ID for the wrapped key to 40-bit RC4 and
brute-force it, then 56-bit DES and brute-force the 16-bit difference, then 80-
bit Skipjack, 112-bit two-key 3DES, and finally 128-bit AES.  There was another
key wrap design where this was possible).
Digressing from the original disk-sector-encryption, I'd be interested in some
debate on the requirements for password-based key wrapping.  The design goals
I used were:
  1. Resistance to dictionary/password-guessing attacks above all else.
  2. No need to use additional algorithms like hash algorithms (see the RFC for
     the rationale, to save me typing it all in again).
The reason for 1. is that provided you use a secure cipher the best approach
for an attacker is going to be a dictionary attack or similar attack on the
password used to wrap the key.  Since the wrapping key is going to be used to
protect things like long-term private keys, this is an extremely high-value
Note that the immunity to key-guessing requirement is mutually exclusive with
modification-detection, since (for example) storing a SHA-1 hash would allow
you to immediately verify whether you'd found the password/key.  This is the
exact problem which PKCS  has, you don't need to attack the key wrap since
the MAC on the wrapped data is a much easier target.  There's another key wrap
which stores a full SHA-1 hash alongside the wrapped key (to protect against
some problems present in an earlier version of the same key wrap mechanism,
which fell to fairly trivial attacks).  This is great for integrity protection,
but terrible for security, since it allows you to verify with pretty much 100%
accuracy whether you've guessed the password.    I also looked at some sort of
OAEP-like wrapping (or, more generally, a Feistel-like construct of the kind
used in OAEP), but it seemed a bit ad-hoc when used with symmetric key wrap
rather than RSA.
Does anyone have any thoughts on symmetric key wrap, and specifically the
differences between high-value and low-value (ephemeral) key wrap requirements?
General rant: It's amazing that there doesn't seem to be any published research
  on such a fundamental crypto mechanism, with the result that everyone has to
  invent their own way of doing it, usually badly.  We don't even have a decent
  threat model for this, my attempt at one for password-based key wrap may or
  may not be appropriate (well, I hope it's more or less right), but it's going
  to be rather different than for a situation where you have an ephemeral
  symmetric key rather than a fixed, high-value key wrapping another key.  The
  same problem exists for things like PRFs, we now have PKCS  but before
  that everyone had to invent their own PRF for lack of anything useful, with
  the result that every single protocol which needs a PRF has its own,
  incompatible, often little-analysed one.
More specific rant: Looking at the security standards and protocols deployed in
  the last decade or so, you'd be forgiven for thinking that the only crypto
  research done in the last 10 years (beyond basic crypto algorithms) was
  STS/SPEKE and HMAC.  There seems to be this vast gulf between what crypto
  researchers are working on and what practitioners actually need, so while
  conferences are full of papers on group key management and anonymous voting
  schemes and whatnot, people working on real-world implementations have to
  home-brew their own mechanisms because there's nothing else available.  The
  RFC 3211 wrap is actually parameterised so you can slip in something better
  when it becomes available, but I can't see that ever happening because
  researchers are too busy cranking out yet another secure multiparty
  distributed computation paper that nobody except other researchers will ever
  read.
(Did I miss offending anyone? :-).

@_date: 2002-05-13 06:40:14
@_author: Peter Gutmann 
@_subject: Re: Edinburgh Financial Cryptography Engineering 2002 - CFP 
Phew, at least I'm not the only one who's been thinking that (I grumbled to one
of the organisers a while back that they ought to rename it BermudaCrypt, since
it was that in all but name anyway).  Does anyone know what happened to the
Usenix e-commerce conferences?  They were in the vein of what FC used to be...
there's also the EC-Web conference, although that has more of an emphasis on
web technology than EC.

@_date: 2002-05-27 08:06:21
@_author: Peter Gutmann 
@_subject: RE: NAI pulls out the DMCA stick 
Grab whatever crypto software you feel most comfortable with that does X.509
and start cranking out certs.
Certs are for public-key algorithms, so Twofish would never appear in there
(well, I guess you could certify a Twofish key, but I'm not sure what the point
would be).
You have to distinguish between the X.509 format and tools to use X.509.  I
assume you're after a manual for the tools, rather than RFC 3280, for the same
reason that most PGP users don't start by reading RFC 2440.  In that case,
refer to the docs for your crypto toolkit.

@_date: 2002-05-27 07:56:48
@_author: Peter Gutmann 
@_subject: RE: NAI pulls out the DMCA stick 
I'll say this one more time, slowly for those at the back: What you're
criticising is PEM circa 1991, not S/MIME.  Things have moved on a bit since

@_date: 2002-05-24 05:13:18
@_author: Peter Gutmann 
@_subject: RE: NAI pulls out the DMCA stick 
The only CA-issued certs I've ever used were free, and under a bogus name.
Usually I just issue my own.  You really need to find a better strawman than
this if you want to criticise S/MIME.

@_date: 2002-05-24 05:04:18
@_author: Peter Gutmann 
@_subject: Re: NAI pulls out the DMCA stick 
It never had much in the way of compatibility problems (see e.g. RSA's S/MIME
interop page, if it still exists - even Microsoft's implementation would
interoperate without any real trouble).  It *did* have a problem that the
compatibility was typically at the level of RC2/40.  This hasn't been an issue
since the export controls were lifted.
Well, there's  for
starters, which has been around for some years.

@_date: 2002-05-24 06:55:09
@_author: Peter Gutmann 
@_subject: Re:  Joe Sixpack doesn't run Linux 
Those who care about security [0] use PGP, the rest use S/MIME.  To steal a
line from Hexed:
  "S/MIME: For people who could care less".
Actually it's not even that, it's closer to:
  "Plaintext: For people who could care less".
I have yet to exchange an encrypted S/MIME message of any significance with
anyone, ever.  Even if the other side is using an S/MIME-enabled mailer, we
usually end up using PGP even if it means having to try half a dozen different
versions to find one which will process the other side's messages.  While I'm
in a quoting mood, there's also Marshall Rose's comment about X.400 to steal:
  Two people meet at a conference and exchange email addresses.  They get back
  to their offices and want to communicate securely.  If both sides are using
  PGP x.y.z, they communicate securely.  If one side is using PGP x.y.z and the
  other isn't, they wait for a message and then keep trying different PGP
  versions until they find one which will process the message.  If they aren't
  using PGP, they communicate in plaintext and hope no-one's listening.
  (In case that's forwarded or quoted out of context, this is a comment on a
   social issue, not a software issue).
[0] With the corollary: "and aren't government users", S/MIME is used a fair
    bit in certain areas, it just doesn't get much public exposure.

@_date: 2002-05-27 10:54:22
@_author: Peter Gutmann 
@_subject: Re:  Government subsidies: our last, best hope for 
"Lucky Green"  writes, and I add my $0.02:
It's also become increasingly difficult for crypto-enthusiasts within a company
to convince mgt. that a new project should use PGP.  A year or two back you
could still, with a bit of persuasion, convince a company to go with PGP rather
than S/MIME or SSL or whatever (and "whatever" is, with frightening frequency,
IPsec, of which more below).  This is now almost impossible to do, because PGP
is seen as having very little industry support, which terrifies management.
The major reason for this is the incessant need of the PGP standards
contributors to keep tweaking the spec for every little issue which comes down
the track, constantly breaking compatibility with the current code base.
Unfortunately given that someone is going to come up with some novel problem
which PGP doesn't quite address at the moment but which can be fixed with a
minor update, every six months or so, it's quite possible that the standard
will never settle down until someone gets around to shooting the engineers and
backing out the last dozen or so compatibility-breaking tweaks and updates.
Only if it's broken, and that's the "problem" with PGP: It ain't broken.  I can
take my 10-year-old copy of PGP 2.6.x and be no less secure with it than with
the very latest NAI release.  The only reason most people ever dumped ssh 1.x
was because of very widely-publicised exploits, and even then for many users it
took the widespread use of ssh rootkits to get them to go to 2.x.  PGP hasn't
had that problem.  Like the Energizer bunny, it just keeps on going.  Look at
the Disastry PGP releases with source code going back 10 years, it's like
taking a trip back in time.  Except for the gratuitous changes in packet
formats and whatnot and a few new algorithms, you could use it to process
current messages (it's one of the first of my standard suite of PGP versions to
try).  In fact since good ol' 2.x will interoperate with any other 2.x-vintage
version out there but post-2.x stuff is nothing but interop trouble, there's a
strong incentive *not* to upgrade.
It's not PGP specific.  It's because it ain't broken, and going to a newer
version is frequently more painful (due to interop problems) than staying with
what works.
As a matter of fact I keep an old DOS box stashed away for emergencies.  No
matter how bad things get, you can always bring up DOS on whatever random
hardware you can scrape together from various corners, fire up a terminal
emulator, and get online.
That's always been the problem with crypto software.  Crypto is cool and fun to
do.  It is (compared to the UI) relatively easy to implement given a decent
toolkit with a good selection of algorithms and whatnot (just to show I'm not
blowing smoke, it took me around two weeks to add OpenPGP as a target format
for cryptlib enveloping).  OTOH UI work is painful and boring and not even
remotely sexy.  It'd take me forever to put a UI at the level of Outlook (which
is what the masses would expect) onto cryptlib, and even if I knew anything
about Windows GUIs you couldn't pay me enough to do it.  There are however a
few products which have managed this, eg The Bat,
 so it's not impossible.  Sure,
it's not Outlook, but it's an impressive piece of work for one person.
Frequently because of management misunderstanding... no, let's be honest, total
cluelessness, though.  "You got a security problem?  No worries, just install a
VPN.  Sign here please".  VPNs are being sold as the solution to everything
from viruses to premature baldness, and occasionally even because of concerns
about outsiders grabbing sensitive data off external networks, although the
latter seems to be the exception rather than the rule.  Either the complete
lack of addressing (or even considering) the threat model before deployment, or
the fact that everyone including the tea lady are regarded as requiring access
once it's deployed, mean it's just an expensive collection of electronic worry
beads once installed.
These things are great, for $29.95 and a little isopropyl alcohol (or acrylic
spray paint) you get a nice GemPC430 card reader and drivers (they're normally
$60-70).  The card is just a dumb memory card though, so you still need to get
a GPK8K alongside the reader.

@_date: 2002-05-29 06:05:17
@_author: Peter Gutmann 
@_subject: Re:  PKI: Only Mostly Dead 
"R. A. Hettinga"  quotes:
Actually it's not quite that bad.  I have a paper "PKI: It's Not Dead, Just
Resting" (no relation to the article, despite the name) which takes a
(hopefully) somewhat detached look at PKI issues and how they can be addressed,
covering (as far as possible within the 15-page limit) the X.509 and PGP
approaches, as well as the other usual suspects like AADS, XML/SAML, SPKI, and
so on, as well as some areas which nothing seems to be doing at the moment -
it's an attempt to do a grand unified view of PKI without ending up with a
whole book.  I've also tried to throw in a reasonable amount of historical
perspective to explain why some (mostly X.509) things are done the way they
are.  It may or may not appear in ;login, the Usenix journal, at some point,
although I haven't heard anything for awhile.  It's available from
 (zipped PDF) for anyone
who's interested.  I wouldn't link to it at the moment because of its current
in-limbo status, once it's officially published somewhere I'll add a link from
my home page.

@_date: 2002-06-20 09:12:12
@_author: Peter Gutmann 
@_subject: Good quote on biometric ID 
I was reading a late-70's paper on computer security recently when I saw that
it contains a nice quote about the futility of trying to use biometrics to
prevent Sept.11-type attacks, I thought I'd share it with people:
  When a highway patrolman is sent to his duty, he has to be given the
  authority to cite traffic violators.  This cannot be done explicitly for each
  violator because at the time that the patrolman is sent to his duty, the
  traffic violator does not exist, and the identity of the future violators is
  not known, so that it is impossible to construct individual access rights for
  the violators at that time.  The point is that the patrolman's authority has
  to do with the behaviour of motorists, not their identity.
  - Naftaly Minsky, "An Operation-Control Scheme for Authorisation in Computer
    Systems", International Journal of Computer and Information Sciences,
    Vol.2, No.2, June 1978, p.157.

@_date: 2002-06-01 08:18:20
@_author: Peter Gutmann 
@_subject: Re:  PKI: Only Mostly Dead 
Thankyou Nobody.  You should have found the e-gold in your acount by now :-).
  "Opinion is divided on the subject" -- Captain Rum, Blackadder, "Potato".
The use with SSL is what Anne|Lynn Wheeler refer to as "certificate
manufacturing" (marvellous term).  You send the CA (and lets face it, that's
going to be Verisign) your name and credit card number, and get back a cert.
It's just an expensive way of doing authenticated DNS lookups with a ttl of one
year.  Plenty of PK, precious little I.
You can play with semantics here and claim the exact opposite.  All of the
cases you've cited are actually examples of global distinguisher + locally
unique name.  For example the value 1234567890 taken in isolation could be
anything from my ICQ number to my shoe size in kilo-angstroms, but if you view
it as the pair { ,  } then it makes sense
(disclaimer: I have no idea whether that's either a valid ICQ number or my shoe
size in kilo-angstroms).
(This is very much a philosophical issue.  Someone on ietf-pkix a year or two
 back tried to claim that X.500 DNs must be a Good Thing because RFC 822 email
 address and DNS names and whatnot are hierarchical like DNs and therefore
 can't be bad.  I would suspect that most people view them as just dumb text
 strings rather than a hierarchically structured set of attributes like a DN.
 The debate sort of fizzled out when no-one could agree on a particular view).
I think the unified view is that what you need for a cert is a global
distinguisher and a locally meaningful name, rather than some complex
hierarchical thing which tries to be universally meaningful.  Frequently the
distinguisher is implied (eg with DNS names, email addresses, "for use within
XYZ Copy only", etc), and the definition of "local" really means "local to the
domain specified in the global distinguisher".  I'm not sure whether I can
easily fit all that into the paper without getting too philosophical - it was
really meant as a guide for users of PKI technology.

@_date: 2002-06-01 08:18:20
@_author: Peter Gutmann 
@_subject: Re:  PKI: Only Mostly Dead 
Thankyou Nobody.  You should have found the e-gold in your acount by now :-).
  "Opinion is divided on the subject" -- Captain Rum, Blackadder, "Potato".
The use with SSL is what Anne|Lynn Wheeler refer to as "certificate
manufacturing" (marvellous term).  You send the CA (and lets face it, that's
going to be Verisign) your name and credit card number, and get back a cert.
It's just an expensive way of doing authenticated DNS lookups with a ttl of one
year.  Plenty of PK, precious little I.
You can play with semantics here and claim the exact opposite.  All of the
cases you've cited are actually examples of global distinguisher + locally
unique name.  For example the value 1234567890 taken in isolation could be
anything from my ICQ number to my shoe size in kilo-angstroms, but if you view
it as the pair { ,  } then it makes sense
(disclaimer: I have no idea whether that's either a valid ICQ number or my shoe
size in kilo-angstroms).
(This is very much a philosophical issue.  Someone on ietf-pkix a year or two
 back tried to claim that X.500 DNs must be a Good Thing because RFC 822 email
 address and DNS names and whatnot are hierarchical like DNs and therefore
 can't be bad.  I would suspect that most people view them as just dumb text
 strings rather than a hierarchically structured set of attributes like a DN.
 The debate sort of fizzled out when no-one could agree on a particular view).
I think the unified view is that what you need for a cert is a global
distinguisher and a locally meaningful name, rather than some complex
hierarchical thing which tries to be universally meaningful.  Frequently the
distinguisher is implied (eg with DNS names, email addresses, "for use within
XYZ Copy only", etc), and the definition of "local" really means "local to the
domain specified in the global distinguisher".  I'm not sure whether I can
easily fit all that into the paper without getting too philosophical - it was
really meant as a guide for users of PKI technology.

@_date: 2002-06-13 03:13:15
@_author: Peter Gutmann 
@_subject: Re: Sci Journals, authors, internet 
Usenix is really good with this.  You agree not to re-publish anything for a
period of one year (to cover their print distribution), although you're allowed
to put a copy on your home page.  After that, you're free to do what you like.
They also make all their stuff available online at no charge after a year. This
is why I preferentially submit papers to Usenix rather than ACM or IEEE, I want
to get the information out there where it does some good, not have it locked up
in a copyright prison for all eternity.  I can't imagine that the ACM is going
to make much (if anything) from the reprint rights of a ten-year-old article on
distributed search algorithms, but by locking it up, very few people ever have
access to it.
(Hmm, I wonder if it can be argued that making stuff intended for public
 distribution inaccessible violates the creator's moral rights?  I know that
 doesn't apply in the US, but in other countries it might work.  Moral rights
 can't be assigned, so no publisher can take that away from you.  Any lawyers
 out there?).
That's more traditional for publishers like IEEE and ACM.  OTOH they seem to
turn a blind eye to people making papers available on their home pages, even if
the publishing agreement says you shouldn't do that.  I suspect the backlash
would be too strong if they tried to clamp down on this, although I wish it'd
be formalised in some way rather than leaving it as a grey area.

@_date: 2002-07-21 07:47:39
@_author: Peter Gutmann 
@_subject: Photos of Bad Aibling RSOC posted 
I've finally got around to posting the photos of Bad Aibling RSOC which I took
two years ago.  From the web page:
  There are very few photos of the Bad Aibling RSOC around, only one or two
  rather old, grainy illustrations which presumably came from newspaper
  articles.  When I was in the area in the summer of 2000 I took the
  opportunity to wander round and take a few photos, which I've posted below
  as scanned.  These were taken with a borrowed camera and a fixed 50mm lens,
  so don't expect too much (I'm a cryptographer, not a photographer).  Note
  that this page can take awhile to load because of the number and size of the
  images.
Available at

@_date: 2002-07-13 06:34:36
@_author: Peter Gutmann 
@_subject: Re: Ross's TCPA paper 
Hmm, I can just see it now, Windows 2005 ships as three CDs, a 400-page EULA, a
fine-tip soldering iron, a magnifying glass, an EMBASSY chip, and a copy of
"SMD Soldering for Dummies".

@_date: 2002-07-13 06:15:59
@_author: Peter Gutmann 
@_subject: RE: DNA databases to be classified 
"Lucky Green"  quoted:
I saw this on BBC news.  It took a very sophisticated lab two years work to
produce polio.  They thought they might be able to do smallpox given about 20
years work.  They even managed to slip in an Internet reference in the story. I guess "We synthesised polio from RNA" just isn't newsworthy enough on its

@_date: 2002-07-11 15:18:09
@_author: Peter Gutmann 
@_subject: RE: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
I'd heard stories of collapsed dot-coms' keys being auctioned off, that being
the only thing of value the company had left.  It makes the title of Matthias'
paper even more appropriate.
(However, I do think that anyone wanting to compromise your security will use
 this morning's MSIE hole to do it rather than buying a CA key.  OTOH it'd be a
 great universal skeleton key for government agencies charged with protecting
 the world from equestrians).

@_date: 2002-07-11 15:18:09
@_author: Peter Gutmann 
@_subject: RE: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
I'd heard stories of collapsed dot-coms' keys being auctioned off, that being
the only thing of value the company had left.  It makes the title of Matthias'
paper even more appropriate.
(However, I do think that anyone wanting to compromise your security will use
 this morning's MSIE hole to do it rather than buying a CA key.  OTOH it'd be a
 great universal skeleton key for government agencies charged with protecting
 the world from equestrians).

@_date: 2002-07-11 03:17:52
@_author: Peter Gutmann 
@_subject: Re: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
Both Netscape 6 and MSIE 5 contain ~100 built-in, automatically-trusted CA
 * Certs with 512-bit keys.
 * Certs with 40-year lifetimes.
 * Certs from organisations you've never heard of before ("Honest Joe's Used
   Cars and Certificates").
 * Certs from CAs with unmaintained/moribund websites ("404.notfound.com").
These certs are what controls access to your machine (ActiveX, Java, install-
on-demand, etc etc).
  * It takes 600-700 mouse clicks to disable these certs to leave only CAs you
    really trust.
(The above information was taken from "A rant about SSL, oder: die grosse
 Sicherheitsillusion" by Matthias Bruestle, presented at the KNF-Kongress
 2002).
How many more do you need?

@_date: 2002-07-11 03:17:52
@_author: Peter Gutmann 
@_subject: Re: IP: SSL Certificate "Monopoly" Bears Financial Fruit 
Both Netscape 6 and MSIE 5 contain ~100 built-in, automatically-trusted CA
 * Certs with 512-bit keys.
 * Certs with 40-year lifetimes.
 * Certs from organisations you've never heard of before ("Honest Joe's Used
   Cars and Certificates").
 * Certs from CAs with unmaintained/moribund websites ("404.notfound.com").
These certs are what controls access to your machine (ActiveX, Java, install-
on-demand, etc etc).
  * It takes 600-700 mouse clicks to disable these certs to leave only CAs you
    really trust.
(The above information was taken from "A rant about SSL, oder: die grosse
 Sicherheitsillusion" by Matthias Bruestle, presented at the KNF-Kongress
 2002).
How many more do you need?

@_date: 2002-08-30 05:35:07
@_author: Peter Gutmann 
@_subject: Re: Cryptographic privacy protection in TCPA 
I designed something along these lines some years ago as a way of building a
fault-tolerant key management system.  The idea is that you create a pile of
keys, and these vote on key updates.  If a key is compromised, you sign its
replacement with a quorum of non-compromised keys, and replace the bad key.
You also periodically roll over keys as a preventive measure, limiting
exposure due to compromises.  No need for a PKI or anything else complex like
that, it's all automatic and transparent.
There can be slight problems if a device stays offline long enough that enough
keys have been rolled over to make reaching a quorum impossible, which was an
issue when I designed the thing but rather unlikely now.  I can dig up the
exact details in case anyone's interested.

@_date: 2002-08-30 03:37:25
@_author: Peter Gutmann 
@_subject: Re: right MTA for crypto support 
Oops, sorry, trimmed the wrong text.
Currently the amount of my mail protected by traditional means is essentially
nonexistant.  I get one piece of PGP-encrypted mail every month or two (and I
was one of the peope who helped write the thing!) and I don't recall ever
having received or sent any S/MIME-encrypted mail.  OTOH something like 10-15%
of all my mail is protected by STARTTLS, and the figure is rising continuously
and will continue to do so (particularly if MS make some minor changes in
Exchange which I've asked some people there about).
It doesn't matter how many types of mail encryption software I have sitting
unused on my hard drive, 10% (and growing) coverage with reasonable protection
is better than 0% coverage with good protection.

@_date: 2002-08-19 05:28:39
@_author: Peter Gutmann 
@_subject: Good survey article on crypto hardware 
There's a good article on software and hardware for reconfigurable computer
systems (e.g. FPGA's) in the June 2002 ACM Computing Surveys for people who are
interested in that sort of thing.  This is the sort of hardware which is often
used for crypto when a full ASIC isn't economically viable (one of those
combined PPC+FPGA cores would be quite interesting for crypto use).

@_date: 2002-08-30 05:35:07
@_author: Peter Gutmann 
@_subject: Re: Cryptographic privacy protection in TCPA 
I designed something along these lines some years ago as a way of building a
fault-tolerant key management system.  The idea is that you create a pile of
keys, and these vote on key updates.  If a key is compromised, you sign its
replacement with a quorum of non-compromised keys, and replace the bad key.
You also periodically roll over keys as a preventive measure, limiting
exposure due to compromises.  No need for a PKI or anything else complex like
that, it's all automatic and transparent.
There can be slight problems if a device stays offline long enough that enough
keys have been rolled over to make reaching a quorum impossible, which was an
issue when I designed the thing but rather unlikely now.  I can dig up the
exact details in case anyone's interested.

@_date: 2002-08-28 03:26:47
@_author: Peter Gutmann 
@_subject: Re: right MTA for crypto support 
Actually it's better than any other mail security out there.  See the slides
for my talk at Usenix Security ( for more
details (the StartTLS stuff is about halfway through).

@_date: 2002-09-25 06:56:04
@_author: Peter Gutmann 
@_subject: FIB workstation photos 
As part of its tour of Nvidia, Anandtech got to look at an FIB workstation of
the kind used for (among other things) reverse-engineering and modifying
semiconductors.  For those who have never seen one of these things, there are
photos at

@_date: 2002-09-04 05:14:16
@_author: Peter Gutmann 
@_subject: Re: S/MIME in Outlook -- fucked. 
One of the eternal problems of X.509 software:
Implementation Problem Redux
Certified for use with Windows
- Microsoft owns the trademark
- Submit software to Microsoft, who perform extensive testing
- Passing software can use the certification mark
- Reasonable (given the size of the deployed base) interoperability among   tested products
- RSADSI owns (owned) the trademark
- Simple interoperability test for signing and encryption

@_date: 2002-09-05 03:12:15
@_author: Peter Gutmann 
@_subject: Re:  no ICs in nukes... 
There are no ICs in *safety-critical* areas (they use discrete components and
mechanical interlocks).  An earlier slide is quite clear that there are ICs
in there.

@_date: 2002-09-17 04:00:41
@_author: Peter Gutmann 
@_subject: Re: Cryptogram: Palladium Only for DRM 
There was a rather nice paper at Usenix Security 2000 on this [pause]
available from

@_date: 2002-09-24 07:12:47
@_author: Peter Gutmann 
@_subject: Re:  What good are smartcard readers for PCs 
============================== START ==============================
Companies buy a few readers for their developers who write software to work
with the cards.  They may even roll out a few in pilots, and put out a stack of
press releases and print brochures advertising how hip they are for using smart
cards.  Eventually the clients discover how much of a bitch they are to work
with (installation problems/buggy drivers/incompatibilities/not having your
card when you need it/etc, not helped by the fact that smart card vendor after-
sales support is the most client-hostile of any PC hardware type I know of)
that users decide to live with software-only crypto until the smart card scene
is a bit more mature.
Given that n_users >> n_card_vendors, this situation can keep going for quite
some time.

@_date: 2002-10-06 04:33:39
@_author: Peter Gutmann 
@_subject: Interesting KPMG report on DRM 
KPMG have a report "The Digital Challenge: Are You Prepared?" available at
 in which they surveyed execs at
media companies and conclude that they're focusing too much on (trying to)
lock up content using encryption rather than how to do something useful with
  Digital content is getting a lot of attention - but not at the board level,
  where it is urgently needed. As a recent KPMG survey of top executives
  shows, media companies are focusing too much on encryption and other
  defensive technologies while failing to develop proactive strategies that
  recognize and leverage their online intellectual property assets.
  But the industry.s efforts to grapple with losses on this scale by locking
  away content behind multiple layers of protection - whether encryption,
  copyright protection, or authentication - have tended to detract from the
  user experience while failing to deliver the hoped-for revenue streams.
  Indeed, for all the publicity, expert attention, and corporate ingenuity
  devoted to digital piracy, it is striking that global content companies have
  not yet been able to find a working solution.
  This white paper, organized around a survey conducted for KPMG by The
  Economist Intelligence Unit, takes the industry.s pulse on The bottom line
  is that media companies need to shift their focus from a circle-the-wagons
  defense of digital intellectual property to innovative strategies for
  managing online content as a core revenue source. To achieve this shift,
  digital intellectual property needs to be valued properly, just like other
  assets on the balance sheet. Also, its protection needs to be treated as a
  key issue of corporate governance and given sustained and dedicated board-
  level attention.
  It is clear from the survey that media executives are trying to remain
  optimistic about the potential of digital content - but securing
  intellectual property rights is an uphill battle. In the quest for the right
  mix of measures to fight piracy, executives are relying heavily on
  encryption as well as reactive steps to police and punish violators. At the
  same time, however, many companies fail to conduct systematic accounting for
  their digital assets, or to pursue more proactive strategies to build new
  revenue streams from their online content.
  Media companies have so far failed to pioneer new business models that would
  rob piracy of its appeal. Preoccupied with defending the barricades against
  pirates, the industry has shown a deficit of creativity and innovation in
  rolling out products and services that can compete with the pirates. This
  was clear in KPMG.s survey, where only a handful of respondents saw offering
  potential abusers the chance to distribute content legally as a way of
  protecting digital intellectual property.
  In addition, the content industry remains hostage to its own strict
  interpretations of copyright laws and definitions of intellectual property.
  Most leading media organizations have their roots in traditional media
  formats - they still consider every bit of content they produce to be
  subject to copyright and they defend it - tooth and nail. However, today.s
  Internet world conflicts with this business model, as consumers expect more
  fluid boundaries and demand a free flow of information.
Good stuff, read the whole thing at

@_date: 2002-10-01 01:54:30
@_author: Peter Gutmann 
@_subject: Real-world steganography 
I recently came across a real-world use of steganography which hides extra
data in the LSB of CD audio tracks to allow (according to the vendor) the
equivalent of 20-bit samples instead of 16-bit and assorted other features.
According to the vendors, "HDCD has been used in the recording of more than
5,000 CD titles, which include more than 250 Billboard Top 200 recordings and
more than 175 GRAMMY nominations", so it's already fairly widely deployed.
Hidden Code Addition/Output Dither/Quantization
The final step in the reduction to 16 bits is to add high-frequency weighted
dither and round the signal to 16-bit precision. The dither increases in
amplitude in the frequency range of 16 to 22.05 kHz, leaving the noise floor
flat below 16 kHz where the critical bands of hearing associated with tonality
occur. As part of the final quantization, a pseudo-random noise hidden code is
inserted as needed into the least significant bit (LSB) of the audio data. The
hidden code carries the decimation filter selection and Peak Extend and Low
Level Range Extend parameters. Inserted only 2?5 percent of the time, the
hidden code is completely inaudible-effectively producing full 16-bit
undecoded playback resolution. The result is an industry-standard 44.1-kHz,
16-bit recording compatible with all CD replication equipment and consumer CD
The paper describing the process is available under the somewhat misleading
name   The description of
the stego en/decoding process is on p.15 (it's a rather long excerpt, but it's
interesting stuff):
As part of the final quantization, a hidden code side channel is inserted into
the LSB when it is necessary for the encoder to inform the decoder of any
change in the encoding algorithm. It takes the form of a pseudo-random noise
encoded bit stream which occupies the least significant bit temporarily,
leaving the full 16 bits for the program material most of the time. Normally,
the LSB is used for the command function less than five percent of the time,
typically only one to two percent for most music. Because the hidden code is
present for a small fraction of the time and because it is used as dither for
the remaining 15 bits when it is inserted, it is inaudible. This was confirmed
experimentally with insertion at several times the normal fraction of time.
The mechanism which allows insertion of commands only when needed consists of
encapsulating the command word and parameter data in a "packet". A
synchronizing pattern is prepended to the data and a checksum is appended. The
resulting packet is then scrambled using a feedback shift register with a
maximal length sequence and inserted serially, one bit per sample, into the
LSB of the audio data. The decoder sends the LSB's of the audio data to a
complementary shift register to unscramble the command data. A pattern
matching circuit looks for the synchronizing pattern in the output of the
descrambler, and when it finds it, it attempts to recover a command. If the
command has a legal format and the checksum matches, it is registered as a
valid packet for that channel. The arrival of a valid packet for a channel
resets a code detect timer for that channel. If both channels have active
timers, then code is deemed to be present and the filter select data is
considered valid immediately. However, any command data which would effect the
level of the signal must match between the two channels in order to take
effect. The primary reason for this is to handle the case where an error on
one channel destroys the code. In such a case, the decoder will mistrack for a
short time until the next command comes along, which is much less audible than
a change in gain on only one channel, causing a shift in balance and lateral
image movement. If either of the code detect timers times out, then code is
deemed not to be present, and all commands are canceled, returning the decode
system to its default state. If the conditions on the encoder side are not
changing, then command packets are inserted on a regular basis to keep the
code detect timers in the decoder active and to update the decoder if one
starts playing a selection in the middle of a continuous recording.
Since the decoder is constantly scanning the output of the de-scrambler shift
register for valid command packets even when none are present, the possibility
exists that there may be a false trigger. For audio generated by the encoder,
this possibility is eliminated in the absence of storage and transmission
errors by having the encoder scan the LSB of the audio data looking for a
match. If a match to the synchronizing pattern is found, the encoder inverts
one LSB to destroy it.
Modern digital storage and transmission media incorporate fairly sophisticated
error detection and correction systems. Therefore, we felt that only moderate
precautions were necessary in this system. The most likely result of an error
in the signal is a missed command, which can result in a temporary mis-
tracking of the decoding, as mentioned above. Given the low density of command
data, and the small changes to the signal which the process uses, these errors
are seldom more audible than the error would be in the absence of the process.
The chances of a storage error being falsely interpreted as a command are
extremely small.
For material not recorded using the encoder, a small probability for a false
trigger does exist. Given a moderate length for the scrambling shift register
so that its mapping behaves in a noise-like fashion and a choice of
synchronizing pattern which avoids patterns likely to appear in audio data
with a higher than average probability, susceptibility to false triggers can
be made arbitrarily small by increasing the length of the part of the packet
requiring a match. In the case of the current system, the combination of the
synchronizing pattern with the bit equivalence for all valid commands plus
check sum results in a required match equivalent to 39 sequential bits. For a
stereo signal, in which a match must occur in both channels within a one
second interval and the commands in both channels must specify the same gains,
this amounts to an expectation of one event in approximately 150 million years
of audio.
The scrambling operation uses a feedback shift register designed for a maximal
length sequence in which data taken from taps in the register are added using
modulo two arithmetic, equivalent to an 'exclusive or' operation, and fed back
to the input of the register. For a given register length there are certain
configurations of taps which will produce a sequence of one and zero values at
the output that does not repeat until 2N-1 values have emerged, where N is the
length of the shift register. This corresponds to the number of possible
states of the shift register minus one illegal state, and is called a maximal
length sequence. Such an output sequence has very noise-like properties and,
in fact, is the basis of some noise generators. We use the noise-like behavior
of the generator to scramble the command signals by adding them modulo two to
the input of the shift register, as for example in Figure 7a. This has the
advantage that a second similar shift register with taps in the same places
but with only feed forward addition modulo two (Figure 7b) will reproduce the
original input sequence when fed with the output of the first one. The fact
that the decode side has no feedback means that the initialization
requirements are limited to having N input samples prior to the beginning of
decoding, which means that the decoder will "lock up" very quickly. In this
scheme, the presence of a bit error anywhere in the length of a packet plus
initialization sequence will completely scramble the data, preventing
recovery. However, in practice, this has not been a problem for reasons
described above.

@_date: 2002-11-08 04:40:02
@_author: Peter Gutmann 
@_subject: Re: Did you *really* zeroize that key? 
You can't, in general, assume the compiler won't optimise this away
(it's just been zeroised, there's no need to check for zero).  You could make it volatile *and* do the check, which should be safe from being optimised.
It's worth reading the full thread on vuln-dev, which starts at
This discusses lots of fool-the-compiler tricks, along with rebuttals
on why they could fail.

@_date: 2002-11-07 02:07:21
@_author: Peter Gutmann 
@_subject: Re:  Did you *really* zeroize that key? 
No it isn't.  This was done to death on vuln-dev, see the list archives for
the discussion.
[Moderator's note: I'd be curious to hear a summary -- it appears to
work fine on the compilers I've tested. --Perry]

@_date: 2002-11-07 02:07:21
@_author: Peter Gutmann 
@_subject: Re:  Did you *really* zeroize that key? 
No it isn't.  This was done to death on vuln-dev, see the list archives for
the discussion.

@_date: 2003-01-27 04:39:30
@_author: Peter Gutmann 
@_subject: Re: Big Brotherish Laws 
That's because non-US licenses constitute automatic permission for minor
traffic law violations.  The scenario is something like the following:
[Driver gets pulled over].
Driver: "Gidday mate, hows it going?"
[Cop asks for license, looks at it]
Cop: "Ahhhh, screw it, too much paperwork.  Don't do it again.  HAND".

@_date: 2003-02-05 04:08:17
@_author: Peter Gutmann 
@_subject: The Crypto Gardening Guide and Planting Tips 
After much procrastination I recently put the Crypto Gardening Guide and
Planting Tips online at
 this may be of
interest to readers.  From the introduction:
  There has been a great deal of difficulty experienced in getting research
  performed by cryptographers in the last decade or so (beyond basic
  algorithms such as SHA and AES) applied in practice.  The reason for this is
  that cryptographers don't work on things that implementors need because it's
  not cool, and implementors don't use what cryptographers design because it's
  not useful or sufficiently aligned with real-world considerations to be
  practical. As a result, security standards are being created with mechanisms
  that have had little or no security analysis, often homebrew mechanisms or
  the standards editor's pet scheme.  The problem is a lack of communication:
  Cryptographers often don't seem aware of the real-world constraints that
  their design will need to work within in order to be successfully deployed.
  The intent of this document is to cover some of those real-world constraints
  for cryptographers, to point out problems that their designs will run into
  when attempts are made to deploy them.  Also included is a motivational list
  of extremely uncool problems that implementors have been building ad-hoc
  solutions for since no formal ones exist.

@_date: 2003-06-27 04:16:17
@_author: Peter Gutmann 
@_subject: Re: Senators from Utah being Southern 
Great film, source of one of my favourite movie quotes:
  Have you ever noticed that in the Bible whenever God needed to punish
  someone, when God needed a killing, he sent an angel?  Can you imagine what
  a creature like that must be like?  Your entire existence spent praising
  God, but always with one wing dipped in blood.  Would you ever really want
  to *meet* an angel?"
(so much deeper than "I'll be back").

@_date: 2003-06-12 04:35:11
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal 
Just to clarify this, so you need a multivalued CN, with one containing the
expression "(a|b|c)" and the remaining containing each of "a", "b", and "c"?
Is it multiple AVAs in an RDN, or multiple RDNs?   (Either of these could be
hard to generate with a lot of software, which can't handle multiple AVAs in
an RDN or multiple same-type RDNs).  Which hack is for MSIE and which is for

@_date: 2003-06-12 04:35:11
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal 
Just to clarify this, so you need a multivalued CN, with one containing the
expression "(a|b|c)" and the remaining containing each of "a", "b", and "c"?
Is it multiple AVAs in an RDN, or multiple RDNs?   (Either of these could be
hard to generate with a lot of software, which can't handle multiple AVAs in
an RDN or multiple same-type RDNs).  Which hack is for MSIE and which is for

@_date: 2003-06-12 04:35:11
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal 
Just to clarify this, so you need a multivalued CN, with one containing the
expression "(a|b|c)" and the remaining containing each of "a", "b", and "c"?
Is it multiple AVAs in an RDN, or multiple RDNs?   (Either of these could be
hard to generate with a lot of software, which can't handle multiple AVAs in
an RDN or multiple same-type RDNs).  Which hack is for MSIE and which is for

@_date: 2003-06-11 02:44:17
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal 
There's a wonderful story at  by someone who
tried to see how b0rken he could make his signature before anyone complained.
He tried at various times a random scribble, a crosshatched scribble, a
regular grid, an 'X', a drawing of a stick-figure person, his name in Egyptian
hieroglyphics, various famous people's names, and even "I stole this card".
No-one ever complained.

@_date: 2003-06-10 13:16:06
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal --> secure UI for browsers 
Maybe MS will implement something like the secure attention key in the old VAX
A1 VMM (Ctrl-Alt-Del already serves this purpose for logins) which gives you a
guaranteed non-spoofed interface to the kernel (see for example "A
Retrospective on the VAX VMM Security Kernel" by Karger et al for more
information on this).  They certainly have the VMS knowhow :-).

@_date: 2003-06-10 02:21:57
@_author: Peter Gutmann 
@_subject: Re: An attack on paypal --> secure UI for browsers 
Ka-Ping Yee has a web page at  and a lot of interesting
things to say about secure HCI (and HCI in general), e.g. a characterisation
of safe systems vs. general-purpose systems:
  In order for Alice to use her computer usefully, she has to be able to
  instruct programs to do things for her.  In order for those programs to
  carry out tasks, she has to trust those programs with some authority.  So
  every useful operation involves making the system a little bit less safe.
  In order to keep the system from becoming unboundedly unsafe, Alice must
  also be able to make her system more safe.
  A system in an ultimately safe state is one that can't do anything other
  than what was planned ahead of time.  General-purpose computing is useful to
  Alice only because she can make unpredictable inputs into the system, asking
  it to do new things.

@_date: 2003-06-29 03:55:14
@_author: Peter Gutmann 
@_subject: Re: Low cost cruise missile 
Good grief, what a load of drivel!  I'm sure Bruce will be amused to hear that
the toys he plays with in his spare time are now a threat to world security...
I wonder what his pulsejet-powered go-kart would be classed as?  The
journalist obviously went to a lot of trouble phoning various agencies and
people for comment, but didn't spend 10 seconds with google to see that these
things are commonly available all over the world.
(I think Bruce may have, to some extent, shot himself in the foot a bit by
 presenting it the way he has, although given his talent for self-promotion
 I'm sure it wasn't accidental :-).  Maybe he'll get his funding now.  In any
 case anyone can buy a standard commercially-built jet engine or build their
 own from one of the zillion web pages devoted to this topic and have as much
 of a "cruise missile" as he has.  The guidance system is left as an exercise
 for the reader).
Must have been a really slow news day...

@_date: 2003-07-01 09:01:40
@_author: Peter Gutmann 
@_subject: Re: Attacking networks using DHCP, DNS - probably kills DNSSEC 
Given that their goal is zero-configuration networking, I can see that being
required to provide a shared secret would mess things up a bit for them.  It'd
be a bit like PKIX being asked to make ease-of-use a consideration in their
work, or OpenPGP to take X.509 compatibility into account.

@_date: 2003-07-01 09:01:40
@_author: Peter Gutmann 
@_subject: Re: Attacking networks using DHCP, DNS - probably kills DNSSEC 
Given that their goal is zero-configuration networking, I can see that being
required to provide a shared secret would mess things up a bit for them.  It'd
be a bit like PKIX being asked to make ease-of-use a consideration in their
work, or OpenPGP to take X.509 compatibility into account.

@_date: 2003-07-30 13:01:08
@_author: Peter Gutmann 
@_subject: Re: AP by any other name ... 
It's been used in other areas as well, and for rather longer than ten years.
For example, one of the most accurate estimates of the entropy of natural
language involved people placing bets on the value of the next letter seen (as
opposed to the more traditional "I guess it'll be an 'e'" estimation

@_date: 2003-07-30 13:01:08
@_author: Peter Gutmann 
@_subject: Re: AP by any other name ... 
It's been used in other areas as well, and for rather longer than ten years.
For example, one of the most accurate estimates of the entropy of natural
language involved people placing bets on the value of the next letter seen (as
opposed to the more traditional "I guess it'll be an 'e'" estimation

@_date: 2003-07-30 13:01:08
@_author: Peter Gutmann 
@_subject: Re: AP by any other name ... 
It's been used in other areas as well, and for rather longer than ten years.
For example, one of the most accurate estimates of the entropy of natural
language involved people placing bets on the value of the next letter seen (as
opposed to the more traditional "I guess it'll be an 'e'" estimation

@_date: 2003-07-30 13:01:08
@_author: Peter Gutmann 
@_subject: Re: AP by any other name ... 
It's been used in other areas as well, and for rather longer than ten years.
For example, one of the most accurate estimates of the entropy of natural
language involved people placing bets on the value of the next letter seen (as
opposed to the more traditional "I guess it'll be an 'e'" estimation

@_date: 2003-07-31 17:05:48
@_author: Peter Gutmann 
@_subject: RE: Secure IDE? 
But the IV is repeated, every time you encrypt new data for that sector.  You
need to either store a random IV for each sector (usually infeasible) or make
two passes over the data (details vary), using the output from pass 1 to
affect pass 2 (slow).
Customised, not custom.  Think of it as a Chinese-menu type setup, it's a one-
size-fits-all BIOS with appropriate modules compiled in for handling the CPU
and chipset features.  Now motherboard vendors can plug in their own feature
modules, but it's a somewhat nontrivial option usually used only for highly
marketable features (overclocking options, ability to re-flash from Windows,
etc etc).

@_date: 2003-07-31 15:23:39
@_author: Peter Gutmann 
@_subject: RE: Secure IDE? 
I get the feeling they use ECB for speed (heavy pipelining) rather than
Where would you store them?  The feature of this is that it's fully
transparent, so you can't store IVs anywhere.
That one's the only thing I can't find a good technical reason for... perhaps
it's just commercial, since they see the dongles as a revenue source and will
sell you software to set up n dongles yourself, where price is proportional to
How would you do this without a custom BIOS (remember that their general
product is for dropping into any PC)?
I'm more worried about key backup - it's bad enough having cheapest-possible-
components IDE drives without complicating it further with a second point of
failure.  In the meantime a better option is still the triumvirate of:
- Sensitive data saved only to RAM disk.
- 3DES-encrypted volume mounted as a filesystem, which I can back up in
  encrypted form if necessary, and with all crypto done in software with per-
  sector random IVs, user-generated keys, and all the other stuff you asked
  for.
- Encrypted swap.
(Oh yeah, and a UPS so you're not tempted to temporarily save stuff to disk
 elsewhere in case the RAM drive goes away suddenly).
If you're worried about Joe Burglar grabbing your laptop (for the value of the
laptop) and your business data being leaked as collateral damage, or someone
stumbling across your warez or pr0n, then it's probably adequate.  Since this
is what general users would be worried about, I'd agree with the statement.
Anyone worried about more than that (probably about 0.01% of the market) isn't
a general user any more.

@_date: 2003-07-31 04:06:00
@_author: Peter Gutmann 
@_subject: RE: Secure IDE? 
DES/ECB, originally with a 40-bit key, more recently with 56-bit and 3DES.
Keys generated by the manufacturer onto a USB dongle.  No easy way to make
backups of the dongle.  It's a messy tradeoff: If you want something like
laptop/data-theft-protection (which will suit the majority of the market),
then DES-40/ECB is fine, but you want to be able to back up the dongle because
if that goes (and after multiple insertions and removals it will) you've lost
all your data.  OTOH if you want protection from the MIB the fragile nature of
the key storage is probably a benefit, but then you want 3DES/CBC to go with
it.  At the moment you have laptop-theft-protection crypto and MIB-protection
key storage.
You can buy truckloads of these things on ebay for about $20 a pop if you want
to play with one.

@_date: 2003-07-31 04:06:00
@_author: Peter Gutmann 
@_subject: RE: Secure IDE? 
DES/ECB, originally with a 40-bit key, more recently with 56-bit and 3DES.
Keys generated by the manufacturer onto a USB dongle.  No easy way to make
backups of the dongle.  It's a messy tradeoff: If you want something like
laptop/data-theft-protection (which will suit the majority of the market),
then DES-40/ECB is fine, but you want to be able to back up the dongle because
if that goes (and after multiple insertions and removals it will) you've lost
all your data.  OTOH if you want protection from the MIB the fragile nature of
the key storage is probably a benefit, but then you want 3DES/CBC to go with
it.  At the moment you have laptop-theft-protection crypto and MIB-protection
key storage.
You can buy truckloads of these things on ebay for about $20 a pop if you want
to play with one.

@_date: 2003-07-31 04:06:00
@_author: Peter Gutmann 
@_subject: RE: Secure IDE? 
DES/ECB, originally with a 40-bit key, more recently with 56-bit and 3DES.
Keys generated by the manufacturer onto a USB dongle.  No easy way to make
backups of the dongle.  It's a messy tradeoff: If you want something like
laptop/data-theft-protection (which will suit the majority of the market),
then DES-40/ECB is fine, but you want to be able to back up the dongle because
if that goes (and after multiple insertions and removals it will) you've lost
all your data.  OTOH if you want protection from the MIB the fragile nature of
the key storage is probably a benefit, but then you want 3DES/CBC to go with
it.  At the moment you have laptop-theft-protection crypto and MIB-protection
key storage.
You can buy truckloads of these things on ebay for about $20 a pop if you want
to play with one.

@_date: 2003-09-12 06:10:24
@_author: Peter Gutmann 
@_subject: Re: Fatherland Security agents above the law? 
I thought it was "The news media will do anything for a story, even if they
have to manufacture it themselves".  Given that the US is currently obsessed
with terrorism, creating a sensationalist story related to it is a sure-fire
winner, even if the more accurate wording of "ABC ships expensive yacht
ballast to US" would get less attention.
(Come to think of it, I'm sure I could raise at least a moderate stink over
 here by letting it slip that some of the America's Cup yachts that were here
 earlier in the year may have had (shock, horror!) dangerous radioactive
 uranium in their keels, in violation of the government's anti-nuclear
 stance).

@_date: 2003-09-22 00:45:37
@_author: Peter Gutmann 
@_subject: Re: Walker: NAT means you are a consumer, not a peer 
Isn't that synonymous with "Speak Freely maintenance is ending"?
Peter :-).

@_date: 2003-10-29 05:59:54
@_author: Peter Gutmann 
@_subject: Re: NSA Turns To Commercial Software For Encryption (fwd from 
Yup, and that's all they did.  I've seen some downright bizarre
interpretations of this particular portent on the web (
slashdot), but the simple fact is that the NSA, in its role as the
agency responsible for overseeing crypto use by the USG, got a blanket
Certicom patent license for cases where ECC (of the Certicom-patented variety)
is used, just as they got a blanket DSA license for DSA, and would have had to
get a blanket RSA license before that if it hadn't been USG-funded work and a
blanket DES license if IBM hadn't made the patent freely usable.  Certicom's
PR folks, seeing an opportunity, put out a press release saying that the NSA
had licensed their patent(s).  This does not mean that the NSA is about the
drop their own crypto for ECC (definitely the silliest interpretation of
Certicom's press release I've seen), nor is it a sign that they believe RSA is
dead or that the end of the world is nigh, etc etc etc.

@_date: 2003-10-24 04:23:14
@_author: Peter Gutmann 
@_subject: RE: C3 Nehemia C5P with better hardware RNG and AES support 
Apart from the obvious "what cool thing can we fit in -> <- this much spare
die space?", the obvious target is SOHO routers/firewall boxes.  My spies tell
me that it's already being used in a number of products like this, and the
addition of AES will help the process.  Hardware SHA-1 in the next rev makes
it even better, since you can now do IPsec and SSL tunneling purely in
hardware (and then you lose it all again in the crappy Rhine II NIC, but
that's another story).
Not for SOHO use it isn't, the initial handshake overhead is negligible
compared to the constant link encryption overhead.  The alternative is to do
the crypto externally, for which you're paying for an expensive and power-
hungry crypto core capable of doing a zillion DH/RSA ops/sec that gets used
once every few hours.  The alternative is to load or load your standard
firewall firmware into a Nehemiah and offload all the crypto and RNG stuff.

@_date: 2003-10-24 03:33:33
@_author: Peter Gutmann 
@_subject: RE: RSA performance on Athlon64 vs. Itanium 
Taking some guesses here at the code being used:
x86-32 hand-tuned asm optimised for Pentium Pro.
x86-64 code, gcc optimised for Athlon64.
x86-64 hand-tuned asm optimised for Athlon64.  I'm guessing this one has the
same catch as the Itanium speed test.
My PoS hardware test PC and a $25 Broadcom chip beats your Athlon 64 :-).

@_date: 2003-10-24 03:33:33
@_author: Peter Gutmann 
@_subject: RE: RSA performance on Athlon64 vs. Itanium 
Taking some guesses here at the code being used:
x86-32 hand-tuned asm optimised for Pentium Pro.
x86-64 code, gcc optimised for Athlon64.
x86-64 hand-tuned asm optimised for Athlon64.  I'm guessing this one has the
same catch as the Itanium speed test.
My PoS hardware test PC and a $25 Broadcom chip beats your Athlon 64 :-).

@_date: 2003-10-24 03:25:41
@_author: Peter Gutmann 
@_subject: Re: RSA performance on Athlon64 vs. Itanium 
The reply, sent off-list, was something like "You're running x86-32 code on an
x86-64 CPU in emulation mode, what do you expect?" :-).  In addition the
Itanium RSA demo code works by turning the CPU into a $1000 ASIC, so you'd
need to test it for SSL handshakes per second or something similar where the
CPU has to do some other work besides RSA crypto ops.

@_date: 2003-10-18 10:11:17
@_author: Peter Gutmann 
@_subject: Re: C3 Nehemia C5P with better hardware RNG and AES support 
In case anyone's interested, there's a cpu die photo at
 showing the
amount of real estate consumed by the crypto functions (it's the bottom
centre, a bit hard to read the label).

@_date: 2003-10-18 10:11:17
@_author: Peter Gutmann 
@_subject: Re: C3 Nehemia C5P with better hardware RNG and AES support 
In case anyone's interested, there's a cpu die photo at
 showing the
amount of real estate consumed by the crypto functions (it's the bottom
centre, a bit hard to read the label).

@_date: 2003-10-16 03:18:18
@_author: Peter Gutmann 
@_subject: Re: C3 Nehemia C5P with better hardware RNG and AES support 
The security app note is also entertaining reading.  For example it lists one
of the motivations for getting security right as "your husband may find out
...".  On why they didn't save a copy of the test data for the NIST suite:
"(Hey, do you have 10TB of disk drives lying around? We can fill a 30 GB drive
with raw bits in a little more than 30 minutes - if the drive controller can
keep up with us.)".  And a little further on it refers readers to "Marketing
quote from CRI" (which was a slip-up this time).  The app note was actually
written by humans.  Cool.

@_date: 2003-11-27 08:56:25
@_author: Peter Gutmann 
@_subject: RE: C3 Nehemia C5P with better hardware RNG and AES support 
coderman I've got code to use it under Windows in the latest cryptlib snapshots (soon
to be the 3.1 release), which you can grab via the download link at
  The RNG code is in
misc/rndwin32.c, and is available under a dual license (BSD or GPL, your
choice).  Note though that I don't actually have a C5XL to play with, so at
the moment I've only been able to verify that it won't crash when run on AMD
and Intel CPUs.  If anyone has a C5XL with Windows installed, I'd be
interested in hearing about any problems.

@_date: 2003-11-27 08:56:25
@_author: Peter Gutmann 
@_subject: RE: C3 Nehemia C5P with better hardware RNG and AES support 
coderman I've got code to use it under Windows in the latest cryptlib snapshots (soon
to be the 3.1 release), which you can grab via the download link at
  The RNG code is in
misc/rndwin32.c, and is available under a dual license (BSD or GPL, your
choice).  Note though that I don't actually have a C5XL to play with, so at
the moment I've only been able to verify that it won't crash when run on AMD
and Intel CPUs.  If anyone has a C5XL with Windows installed, I'd be
interested in hearing about any problems.

@_date: 2003-11-04 12:06:55
@_author: Peter Gutmann 
@_subject: Re: Chaumian blinding & public voting? 
A friend of mine likes to say that lotteries are a tax on stupidity: The
dumber you are, the more tax you have to pay.

@_date: 2003-11-02 03:05:37
@_author: Peter Gutmann 
@_subject: Spelling corrections are now export-controlled 
Looks like the USG is going to outdo its ITAR silliness of a few years ago
with something even more ridiculous: Grammar and spelling corrections now
require an export license.  The following was forwarded to me by Clark

@_date: 2003-11-18 00:43:13
@_author: Peter Gutmann 
@_subject: Re: Partition Encryptor 
Since this was last discussed (without resolution) in alt.security.scramdisk
about a week ago, I'd say the answer is "Probably not".  A better question
would be "Can someone who knows about NT device drivers make the necessary
changes to the code (it's GPL'd and freely available)?".

@_date: 2003-11-17 11:51:52
@_author: Peter Gutmann 
@_subject: Re: Partition Encryptor 
ScramDisk (Win9x) or E4M (Win2K) will do it if she can handle a container-
volume encryptor rather than a partition encryptor, both are open source.  E4M
needs some minor updates for XP by someone who knows about NT device drivers,
otherwise you'll occasionally get problems unmounting volumes.

@_date: 2003-11-17 11:51:52
@_author: Peter Gutmann 
@_subject: Re: Partition Encryptor 
ScramDisk (Win9x) or E4M (Win2K) will do it if she can handle a container-
volume encryptor rather than a partition encryptor, both are open source.  E4M
needs some minor updates for XP by someone who knows about NT device drivers,
otherwise you'll occasionally get problems unmounting volumes.

@_date: 2003-11-27 13:24:20
@_author: Peter Gutmann 
@_subject: RE: [Asrg] Re: [Politech] Congress finally poised to vote on 
Do you have any more details on this for those who don't normally follow

@_date: 2003-11-27 13:24:20
@_author: Peter Gutmann 
@_subject: RE: [Asrg] Re: [Politech] Congress finally poised to vote on 
Do you have any more details on this for those who don't normally follow

@_date: 2003-12-15 10:46:07
@_author: Peter Gutmann 
@_subject: Re: PKI root signing ceremony, etc. 
Not necessarily.  I looked at this in an ACSAC'2000 paper (available from
  This uses a TP-capable database
as its underlying engine, providing the necessary auditing capabilities for
all CA operations.  This was desgined to meet the security/auditing
requirements in a number of PKI standards (see the paper for full details,
I've still got about 30cm of paper stacked up somewhere from this).  The paper
is based on implementation experience with cryptlib, you can't do anything
without generating an audit trail provided you have proper security on the TP
system (that is, a user can't inject arbitrary transactions into the system or
directly access the database files).  I tested the setup by running it inside
a debugger and resetting/halting the program at every point in a transaction,
and it recovered from each one.  It can be done, it's just a lot of work to
get right.
I should mention after having done all that work that most CAs rely on
physical and personnel security more than any automatic logging/auditing.
Take a PC and an HSM, lock it in a back room somewhere, and declare it a
secure CA.

@_date: 2003-12-25 01:15:12
@_author: Peter Gutmann 
@_subject: Re: U.S. in violation of Geneva convention? 
Unfortunately after GulfWarII the "winners" hadn't learned their lessons from
WWII very well.  At the end of the war, despite the bombing campaigns, Germany
had a vaguely functional administration and (heavily rationed) food, coal,
electricity, etc were available.  The Allies systematically dismantled all of
that, both through apathy (no real planning beyond "Move in and occupy the
place") and their zeal to rebuild the country in their own image.  For
example, they prevented anyone who'd ever been a Nazi party member from doing
their job.  Well the problem was that to do almost anything, you had to be a
party member, so they instantly stopped all civil administration,
engineering/maintenance work, teachers, the judicial system, the police, you
couldn't even deliver the mail without being a party member (since they were
government employees).
Virtually every male over the age of about 16 had been in the military and had
experience with weapons.  So you now had a mass of unemployed ex-military who
desperately wanted food and clothing, and had access to an almost infinite
supply of weaponry.  In addition Germany after the war attracted what one of
the allied leaders (Eisenhower?) described as "the scum of Europe", eager to
make a quick buck (in Iraq it's folks eager to beat up the infidels).  This
lead to sizeable pitched battles between the armed gangs and the occupying
military, with the military frequently being outgunned by the gangs.
Substitute Germany -> Iraq and profit / food -> religion /nationalism and the
same situation exists today.

@_date: 2004-01-17 05:02:28
@_author: Peter Gutmann 
@_subject: uATX motherboard with built-in crypto 
I just noticed that ABIT have a nice uATX motherboard with a built-in Cavium
crypto engine "capable of processing up to 400Mbps of IPSec traffic or 3,500
RSA operations per second".  Details at

@_date: 2004-02-13 23:34:01
@_author: Peter Gutmann 
@_subject: Re: FCC vs decentralization 
The RIAA/MPAA and US govt.are working on that.  Stand by.

@_date: 2004-02-13 23:40:11
@_author: Peter Gutmann 
@_subject: Re: Call to the Usual Suspects 
Do these things actually get organised?  I thought you just bump into other
Cpunks via the usual Brownian motion and at some point someone suggests a
place to go, half the participants slope off to an alternative establishment
on the way there, and that's how dinner gets arranged.

@_date: 2004-03-06 12:26:47
@_author: Peter Gutmann 
@_subject: Re: Earthlink to Test Caller ID for E-Mail 
"A way that works *in theory* would involve ...".  The chances of any vendor
of mass-market software shipping an MUA where the user has to enter a password
just to send mail are approximately... zero.
In that case you can just filter by sender IP address or something (anything)
that's simpler than requiring a PKI.  Again though, that's just another
variant of the "Build a big wall" dream.  In order to have perimeter security
you first need a perimeter.  If the spammer you're trying to defend against is
your own mother (because she clicked on an attachment you sent her, it says so
in the From: address, that's actually a spam-bot), you don't have a perimeter.
All you have is a big pile of Manchurian candidates waiting to bite you.

@_date: 2004-03-06 07:24:09
@_author: Peter Gutmann 
@_subject: Re: Earthlink to Test Caller ID for E-Mail 
I think you mean:
  If we really do get cryptographic signatures on email in a way that works,
  expect 80% of all spam to contain legit signatures from hacked PCs.
This is just another variation of the "To secure the Internet, build a big
wall around it and only let the good guys in" idea.

@_date: 2004-04-17 21:42:36
@_author: Peter Gutmann 
@_subject: Re: Fortress America mans the ramparts 
Details are available from sources like
(in general the docs are at where MRTD = machine-readable travel documents) although you have to be
careful what you reference since they're still frantically updating the
designs as they go, so any document will be out of date in a few months.  It's
also being (as far as I can tell) designed by people with little or no
security experience, under intense pressure from the US to Do Something About
Security.  Early technical drafts I saw (not the generic whitepapers on the
site, which are pretty vague) were an appalling pile of kludgery.  From what
I've heard since then it hasn't gotten any better.  I dunno whether this is
because the work is being contracted out to the Usual Suspects, who don't know
much about the area, or whether they did try and get experienced people in and
were told that what they were trying to do wouldn't work and/or couldn't be
done in less than 5-10 years.

@_date: 2004-05-22 09:17:39
@_author: Peter Gutmann 
@_subject: The life of a Kiwi contractor in Iraq 
There's an interesting look at the situation in Iraq from the point of view of
a third-party contractor, in an article in the Sunday Star Times,
Most quotable quote:
  The thing that pisses us off is the Yanks had no idea what to do after
  they'd taken out the Iraqi army. They rocked on in, took them out and then
  thought: OOh shit, what do we do now?

@_date: 2004-06-27 05:19:29
@_author: Peter Gutmann 
@_subject: Re: [IP] When police ask your name, 
In his house at R'lyeh, dead Cthulhu waits knitting?  I think a few typos may
have crept into that one.
No, you're thinking of Hast(&%
Error: No route to host.

@_date: 2004-06-15 15:37:54
@_author: Peter Gutmann 
@_subject: Re: Breaking Iranian Codes (Re: CRYPTO-GRAM, June 15, 2003) 
"R. A. Hettinga"  forwarded:
Someone (half-)remembered reading the Crypto AG story in the Baltimore Sun
several years ago, bragged to Chalabi that the US had compromised Iranian
crypto, and the story snowballed from there.  The story could have started out
with a loquacious (Sun-reading) cab driver for all we know.  Some reports have
suggested the source was drunk, so maybe it was a drunk in a bar.  Maybe
Chalabi read the story himself and invented the snitch to make it seem more
important than it was, or to drive the US security community nuts with an orgy
of internal witch-hunting.  Given the lack of further information, it could
have been just about anything.

@_date: 2004-06-15 15:37:54
@_author: Peter Gutmann 
@_subject: Re: Breaking Iranian Codes (Re: CRYPTO-GRAM, June 15, 2003) 
"R. A. Hettinga"  forwarded:
Someone (half-)remembered reading the Crypto AG story in the Baltimore Sun
several years ago, bragged to Chalabi that the US had compromised Iranian
crypto, and the story snowballed from there.  The story could have started out
with a loquacious (Sun-reading) cab driver for all we know.  Some reports have
suggested the source was drunk, so maybe it was a drunk in a bar.  Maybe
Chalabi read the story himself and invented the snitch to make it seem more
important than it was, or to drive the US security community nuts with an orgy
of internal witch-hunting.  Given the lack of further information, it could
have been just about anything.

@_date: 2004-06-16 13:19:30
@_author: Peter Gutmann 
@_subject: Re: crypto on *really* cheap hardware 
You forgot to mention "sometimes it'll stay up for as long as several hours
before crashing/locking up".  I guess this is a security feature, if someone
breaks in they'll only be able to use it for a short time before it locks up
or crashes.
Peter (who doesn't own one, but has heard horror stories from owners).

@_date: 2004-07-07 02:42:03
@_author: Peter Gutmann 
@_subject: Re: UBL is George Washington 
It depends on what your goal is.  As someone else on this list pointed out,
terrorism is just another form of PR.  If OBL took out (say) that huge AT&T CO
in the center of Manhattan (the skyscraper that looks like something out of a
SF film), every cellphone user in the country who's had any dealings with AT&T
would help him pack the explosives.  Sure, there'd be some economic damage,
but Joe Sixpack would barely notice, and certainly wouldn't care.  OTOH the
WTC had enough significance and enough lives involved that everyone had to sit
up and take notice.  He knew exactly what target to hit to create the biggest
mess (I offer the results in the last two years as proof).

@_date: 2004-07-06 01:50:35
@_author: Peter Gutmann 
@_subject: Re: UBL is George Washington 
It's been extraordinarily successful.  The US is driving itself (and a lot of
the rest of the world) nuts with terrorists-under-the-beds paranoia.  I
recently saw a replay of some speech that Bush made shortly after 9/11 where
he said something about "the terrorists wanted to demoralise? frighten? us.
This has failed", and my reaction was "Who are you kidding?".  The terrorists
have achieved their goals, and then some.  The correct response would have
been what the UK did in WWII, which was "business as usual" to let the
opposition know that they couldn't be intimidated.  In contrast, all Bush is
doing is telling them which buttons to push.

@_date: 2004-07-17 12:03:50
@_author: Peter Gutmann 
@_subject: Re: vacuum-safe laptops ? 
When I investigated this a while back, gumstix were about the best deal.  They
also have pretty good support, it's a small company and the techies directly
answer queries on mailing lists.

@_date: 2004-07-25 00:55:21
@_author: Peter Gutmann 
@_subject: Re: Texas oil refineries, a White Van, and Al Qaeda 
After several earlier events (the biggest being Oppau in Germany in 1921,
which left a crater the size of a city block), fire safety folk were given an
incentive to discover the true chemistry of ammonium nitrate.  Google for
"Texas city" + Grandcamp (the ship carrying the ammonium nitrate) for the full

@_date: 2004-07-25 00:47:06
@_author: Peter Gutmann 
@_subject: Re: Texas oil refineries, a White Van, and Al Qaeda 
At Usenix Security a few years back, we [a bunch of random security people,
most of whom were foreign nationals] drove around Buckley AFB taking photos of
the radomes, SCIF, etc etc.  As we were doing this, we noticed a Chinese
national doing the same thing.  We wondered what the etiquette for this was,
do we exchange business cards, offer to trade photos, etc etc?  This was
before 9/11, no-one took any notice of us at the time.

@_date: 2004-08-27 11:04:37
@_author: Peter Gutmann 
@_subject: Cheesecloth security for hard drives 
Globalwin has just introduced an external hard drive enclosure ( with built-in 40-bit DES
encryption (and if it's the HW I think it is, that's 40-bit DES in ECB mode,
and the vendor generates the key for you).

@_date: 2004-08-03 05:11:23
@_author: Peter Gutmann 
@_subject: Re: TERRORISTS ARE AMONG US! (Was: A close look at John Kerry's *real*  tech agenda ) 
He went on to remind citizens to stay alert, trust no-one, and keep their
lasers handy.

@_date: 2004-08-02 15:57:02
@_author: Peter Gutmann 
@_subject: Re: Giesecke & Devrient 
Yup.  It's standard banking-industry stuff, unless you're a large
bank/government/whatever and are prepared to sign over your firstborn and
swear eternal secrecy, they won't talk to you.
They're associated with good buzzword-compliance.  Since it's impossible to
get any technical details out of them, it's rather hard to say.  If you've got
something like a PKCS  driver off them then you should be OK, but if you
want to do any low-level work with the card yourself, find another vendor.
Nothing you can't get from a pile of other vendors who will actually talk to
you.  Unless you've got some business reason to deal with them, I wouldn't
bother (I have nothing against them per se, they just do business in a way
that isn't useful to me... and I'm sure they think the same of me).

@_date: 2004-08-02 15:36:45
@_author: Peter Gutmann 
@_subject: Re: Giesecke & Devrient 
G&D produce (or help produce) things like banknotes and passports (and have
been doing so for more than a century), the secrecy comes with the territory.

@_date: 2004-08-18 06:43:55
@_author: Peter Gutmann 
@_subject: Re: HMAC? 
Perhaps they've managed to reduce RFC 3607 to practice :-).

@_date: 2004-10-28 03:08:57
@_author: Peter Gutmann 
@_subject: Re: Cyclotrimethylene trinitramine 
It's not all too hard to make from hexamine (although quite inefficient,
the bulk manufacture isn't done that way) for someone with access to a bit of chemical equipment.  I couldn't believe the fuss they're making over this, it's just another HE, although more brisant than most.  The story is about as interesting as "Stick of dynamite discovered in Baghdad parking lot", the media is making it sound like someone's absconded with a live nuke.  I guess they couldn't spend the necessary
30 seconds or so it'd take to look it up somewhere and see what was

@_date: 2004-10-15 08:21:56
@_author: Peter Gutmann 
@_subject: Vote-counting glitch in NZ local elections 
Looks like you can mess up voting even if there is a paper trail.  These are
paper votes that are electronically counted, so the problem was in the
electronic processing, not the actual voting procedure.
Let me count the ways ...
An electronic processing and counting botch-up has left the results for seven
city and district councils and 18 district health boards up in the air. Final
results, due yesterday, have been delayed indefinitely.
Mr Carter blamed the company Datamail, which was contracted by Electionz.com -
the company hired by many councils to manage their elections - to count the
votes from electronically scanned voting papers.

@_date: 2004-10-15 08:13:46
@_author: Peter Gutmann 
@_subject: At least there's some (attempt at) common sense in airline security 
Ease off says air security boss
Security on domestic flights is too strict and should be downgraded, says the
head of the Aviation Security Service.
General manager Mark Everitt, a former police detective with 21 years'
experience, said if he had his way passengers would be able to take Swiss Army
knives and other small, sharp objects on board domestic flights.
"I'm actually an advocate for letting these things back on the aircraft. It's
time to back up a little," he told delegates at the Police Association's
annual conference yesterday.
But New Zealand had to meet international security standards and his personal
view was not enough to instigate a review of security standards.
Knowing levels of risk was the key to ensuring flights were safe, said Mr
Everitt. The banning of small knives did not stop attacks in the air.

@_date: 2004-10-15 06:59:53
@_author: Peter Gutmann 
@_subject: Re: Cash, Credit -- or Prints? 
I've seen a number of smart card/PCMCIA combo devices that to this, they have
a discrete fingerprint sensor device connected to a discrete crypto device.
You can fake out the fingerprint check portion by tying one of the connecting
lines to Vcc or GND.

@_date: 2004-10-03 14:59:57
@_author: Peter Gutmann 
@_subject: Re: Foreign Travelers Face Fingerprints and Jet Lag 
I never made any comment about who's keeping what in or out (the wall was
officially an anti-fascist protection barrier, also meant to keep out a
demonstrated threat).  What I was pointing out was that having been through
both East German and US border controls, the US ones were more obnoxious.

@_date: 2004-10-03 09:18:24
@_author: Peter Gutmann 
@_subject: Re: Foreign Travelers Face Fingerprints and Jet Lag 
The US now has the dubious distinction of being more obnoxious to get through
the borders than the former East Germany (actually even without this measure,
the checks had become at least as obnoxious as the East German ones).  I
wonder whether the next step will be building a wall...
Peter (who'll be thinking really hard about any future conference trips to the
       US).

@_date: 2004-10-26 04:27:03
@_author: Peter Gutmann 
@_subject: Re: Financial identity is *dangerous*? (was re: Fake companies, real money) 
They're not "using it in their development shop", that's their standard
development environment that they ship to all Windows CE, Pocket PC,
SmartPhone, and XP Embedded developers (and include free with every copy of
MSDN).  If an entire branch of my OS development was centered around a
particular technology, I'd want to make sure I owned both the technology and
the developers who created it and will be maintaining/updating it in the
future.  This isn't an optional add-on that MS uses internally, it's a core
component of their embedded OS effort that they push out to anyone who'll take
it in an attempt to dissuade them from going with QNX, embedded Linux,
VxWorks, etc etc.

@_date: 2004-10-24 02:13:38
@_author: Peter Gutmann 
@_subject: Re: Financial identity is *dangerous*? (was re: Fake companies, real money) 
The answer to that one is actually "To provide a development environment for
Windows CE (and later XP Embedded)" (the emulator that's used for development
in those environments is VirtualPC).  Thank you for playing.

@_date: 2004-11-11 03:24:22
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
You also had to look at what they were up against.  Witness the complete
massacre at Isandlwana (the classic Zulu bull-and-horns overran the
British camp because the troops were too far away from their ammunition
to resupply, no doubt copying Elphinstone's tactic in Afghanistan) vs.
post-Isandlwana use of Gatling batteries and massed field artillery (some of which was converted Naval artillery), e.g. Ulundi, where post-battle reports were of piles of Zulu dead mown down by Gatlings.
The British only thought that the Zulus were just semi-naked savages until Isandlwana.

@_date: 2004-11-08 05:47:55
@_author: Peter Gutmann 
@_subject: Re: In a Sky Dark With Arrows, Death Rained Down 
As I said in my previous message, this is the topic of endless debate, and in
particular the high death toll among the nobles could arisen from any number
of causes.  For example at Crecy the French king (Philip the something'th) had
the oriflamme (French war banner indicating that no prisoners could be taken)
displayed because he was worried that the gold-rush for enemy nobles to ransom
would screw up the French battle order, resulting in huge losses when the
French ended up at the losing end.  There's speculation that they did the same
thing at Agincourt, because no French chronicler of the time raised even a
murmur about the killings.  So something like that could have been just as
much the cause as any order given by Henry V to dispatch leftovers after the
battle (for example the mass slaughter of the first and second lines
("battles") of French, bogged down in mud (the battle was fought in a rain-
soaked freshly-ploughed field), by English commoners occurred very early in
the battle, while the killing of stragglers under Henry's orders didn't happen
until the following day, or the very end of the battle for prisoners).  If you
really want to continue this, please do it in soc.history medieval, there are
already thousand-odd-message threads going over every nuance of this.

@_date: 2004-11-06 07:10:49
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
The figure that's usually quoted is that 80% of German's military force was
directed against Russia.  Of the remaining 20%, a lot had already been engaged
by France, the UK (via the BEF, the RAF, North Africa), Greece, etc etc before
the US got involved in Europe.  So the Russians should get most of the credit.

@_date: 2004-11-04 09:31:31
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
We're talking about different things, the War on Bogeymen vs. the War for Oil.
In its war on bogeymen, the most notable thing the USG has achieved to date is
to create vastly more of them.  Its strategy is about as effective as the
paras were on Bloody Sunday, i.e. its actions serve mostly as a recruitment
drive for the opposition:
  I swear by Almighty God [...] to fight until we die in the field of red gore
  of the infidel tyrants and murderers.  Of our glorious faith, if spared to
  fight until not a single trace is left to tell that the Holy soil of our
  country was trodden by these infidels.  Also these robbers and brutes, these
  unbelievers of our faith, will be driven into the sea, by fire, the knife or
  by poison cup until we of the true faith clear these infidels from our
  lands.
(Whoever wrote the original was definitely no English lit major).

@_date: 2004-11-03 05:29:45
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
Fighting an unwinnable war always seems to produce the same type of rhetoric,
whether it's the war on some drugs, the war on anyone Bush doesn't like, or
the war on anything non-German.  The only thing that changes over time are the
identities of the bogeymen that are used to justify it.
(Do you seriously think the war on bogey^H^H^Hterrorism can ever be won?
 Leaving aside the obvious debate that you can't even tell who you're at war
 with, how do you know when you've won?.
 We have always been at war with Terroristia)

@_date: 2004-11-03 04:21:19
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
Well it wasn't the point I was trying to make, which was comparing it to
predictions made by (the propaganda division of) another super-power in the
mid 1940s about winning an unwinnable war because God/righteousness/whatever
was on their side, and all they had to do was hold out a bit longer.  Compare
the general tone of the WSJ article to the one in e.g. the first half of

@_date: 2004-11-02 14:32:42
@_author: Peter Gutmann 
@_subject: Re: This Memorable Day 
And it's not even original, they've mostly just translated it into English,
updated it a bit (e.g. League of Nations -> UN), and changed the Russian names
and references to Middle Eastern ones.

@_date: 2004-11-08 03:12:53
@_author: Peter Gutmann 
@_subject: Re: In a Sky Dark With Arrows, Death Rained Down 
Normally I'd dig up various refs, but since this topic has been beaten to
death repeatedly in places like soc.history.medieval, and the debate could
well go on endlessly in the manner of the standard "What would have happened
if the North/South had done X?", I'll just handwave and invite you to dig up
whatever sources you feel like yourself.
Nobles expected to surrender to other nobles and be ransomed.  Commoners
didn't respect this, and almost never took prisoners.  Henry's orders didn't
make that much difference, at best they were a "we'll turn a blind eye"
notification to his troops.  When you have English commoner men-at-arms (front
row) meeting French nobles (front row, hoping to nab Henry and other for-
ransom nobles, and to some extent because it was unseemly to let the commoners
do the fighting, although they should have learned their lesson for that at
Courtrai) there's going to be a bloodbath no matter what your leader orders.
For the peasants it's "get him before he gets me", not a chivalric jousting
match for the landed gentry.  In addition the enemy nobles had weapons and
armour that was worth something, while a ransom was useless to a non-noble (if
Bob the Archer did manage to captured Sir Fromage, his lord would grab him,
collect the ransom, and perhaps throw Bob a penny for his troubles).
(There's a lot more to it than that, but I really don't want to get into an
 endless debate over this.  Take it to soc.history if you must, and if
 anyone's still interested in debating this there).

@_date: 2004-11-06 07:20:05
@_author: Peter Gutmann 
@_subject: Re: In a Sky Dark With Arrows, Death Rained Down 
That's the traditional Agincourt interpretation.  More modern ones (backed up
by actual tests with arrows of the time against armour, in which the
relatively soft metal of the arrows was rather ineffective against the armour)
tend to favour the muddy ground trapping men and horses, lack of room to
manoeuver/compression effects, and arrows killing horses out from under the
knights, at which point see the muddy ground section.  Obviously the machine-
gun effect of the arrows was going to cause a number of minor injuries, and
would be lethal to unarmoured troops, but they weren't quite the wonder-weapon
they're made out to be.
(There were other problems as well, e.g. the unusually high death toll and
 removal of "ancient aristocratic lineages" was caused by English commoners
 who weren't aware of the tradition of capturing opposing nobles and having
 them ransomed back, rather than hacking them to pieces on the spot.  Again,
 arrows didn't have much to do with the loss of so many nobles).

@_date: 2004-11-12 08:08:18
@_author: Peter Gutmann 
@_subject: Re: Cell Phone Jammer? 
Try the SH066PL, a nice portable that looks exactly like a cellphone, it's one
of the few portables I know of.
Google is your friend, there are tons of these around, with varying degrees of
sophistication.  These are definitely not portable, taking several amps at
6-12V to power them.
None of them are exactly cheap.

@_date: 2004-12-05 09:00:44
@_author: Peter Gutmann 
@_subject: Re: Unintended Consequences 
One of the characters in Hercules Returns is called Labia, and lives in the
town of Chlamydia.  There are a number of other characters with similar names.

@_date: 2004-12-03 09:21:35
@_author: Peter Gutmann 
@_subject: Re: Anti-RFID outfit deflates Mexican VeriChip hype 
"R.A. Hettinga"  forwarded:
Since kidnapping is sort of an unofficial national sport in Mexico (or at
least Mexico City), this is particularly apropos.  An implanted RFID seems to
be just asking for an "express kidnap", something more traditionally used to
get money from ATMs.

@_date: 2004-12-03 09:21:35
@_author: Peter Gutmann 
@_subject: Re: Anti-RFID outfit deflates Mexican VeriChip hype 
"R.A. Hettinga"  forwarded:
Since kidnapping is sort of an unofficial national sport in Mexico (or at
least Mexico City), this is particularly apropos.  An implanted RFID seems to
be just asking for an "express kidnap", something more traditionally used to
get money from ATMs.

@_date: 2005-02-23 07:53:25
@_author: Peter Gutmann 
@_subject: Re: On the road to truth and madness 
The following was my variant on this from a few years ago, representing the
56th IETF PKIX meeting minutes.  Note that this is from the book form, not the
film version of the text:

@_date: 2005-02-04 11:47:58
@_author: Peter Gutmann 
@_subject: RE: Dell to Add Security Chip to PCs 
A simple crypto device controlled by the same software is only slightly less
nonsensical.  That is, the difference between software-controlled keys and a
device controlling the keys that does anything the software tells it to is
negligible.  To get any real security you need to add a trusted display, I/O
system, clock, and complete crypto message-processing capability (not just
"generate a signature" like the current generation of smart cards do), and
that's a long way removed from what TCPA gives you.
Yes he will.  That is, he may not really need to do it, but he really, really
wants to do it.  Look at the almost-universal use of PKCS  to allow people
to spread their keys around all over the place - any product aimed at a mass-
market audience that prevents key moving is pretty much dead in the water.
The only effective thing a TCPA chip gives you is a built-in dongle on every
PC.  Whether having a ready-made dongle hardwired into every PC is a good or
bad thing depends on the user (that is, the software vendor using the TCPA
device, not the PC user).

@_date: 2005-02-04 11:47:58
@_author: Peter Gutmann 
@_subject: RE: Dell to Add Security Chip to PCs 
A simple crypto device controlled by the same software is only slightly less
nonsensical.  That is, the difference between software-controlled keys and a
device controlling the keys that does anything the software tells it to is
negligible.  To get any real security you need to add a trusted display, I/O
system, clock, and complete crypto message-processing capability (not just
"generate a signature" like the current generation of smart cards do), and
that's a long way removed from what TCPA gives you.
Yes he will.  That is, he may not really need to do it, but he really, really
wants to do it.  Look at the almost-universal use of PKCS  to allow people
to spread their keys around all over the place - any product aimed at a mass-
market audience that prevents key moving is pretty much dead in the water.
The only effective thing a TCPA chip gives you is a built-in dongle on every
PC.  Whether having a ready-made dongle hardwired into every PC is a good or
bad thing depends on the user (that is, the software vendor using the TCPA
device, not the PC user).

@_date: 2005-02-03 04:53:22
@_author: Peter Gutmann 
@_subject: RE: Dell to Add Security Chip to PCs 
Neither.  Currently they've typically been smart-card cores glued to the MB and accessed via I2C/SMB.

@_date: 2005-02-03 04:53:22
@_author: Peter Gutmann 
@_subject: RE: Dell to Add Security Chip to PCs 
Neither.  Currently they've typically been smart-card cores glued to the MB and accessed via I2C/SMB.

@_date: 2005-02-16 05:38:20
@_author: Peter Gutmann 
@_subject: Re: How to Stop Junk E-Mail: Charge for the Stamp 
And the spammers will be using everyone else's PC's to send out their spam, so
the spam problem will still be as bad as ever but now Joe Sixpack will be
paying to send it.
Hmmm, and maybe *that* will finally motivate software companies, end users,
ISPs, etc etc, to fix up software, systems, and usage habits to prevent this.

@_date: 2005-02-16 05:38:20
@_author: Peter Gutmann 
@_subject: Re: How to Stop Junk E-Mail: Charge for the Stamp 
And the spammers will be using everyone else's PC's to send out their spam, so
the spam problem will still be as bad as ever but now Joe Sixpack will be
paying to send it.
Hmmm, and maybe *that* will finally motivate software companies, end users,
ISPs, etc etc, to fix up software, systems, and usage habits to prevent this.

@_date: 2005-02-23 13:29:46
@_author: Peter Gutmann 
@_subject: Re: I'll show you mine if you show me, er, mine 
"R.A. Hettinga"  forwarded:
Isn't this a Crypto 101 mutual authentication mechanism (or at least a
somewhat broken reinvention of such)?  If the exchange to prove knowledge of
the PW has already been performed, why does A need to send the PW to B in the
last step?  You either use timestamps to prove freshness or add an extra
message to exchange a nonce and then there's no need to send the PW.  Also in
the above B is acting as an oracle for password-guessing attacks, so you don't
send back the decrypted text but a recognisable-by-A encrypted response, or
garbage if you can't decrypt it, taking care to take the same time whether you
get a valid or invalid message to avoid timing attacks.  Blah blah Kerberos
blah blah done twenty years ago blah blah a'om bomb blah blah.
(Either this is a really bad idea or the details have been mangled by the

@_date: 2005-02-23 13:29:46
@_author: Peter Gutmann 
@_subject: Re: I'll show you mine if you show me, er, mine 
"R.A. Hettinga"  forwarded:
Isn't this a Crypto 101 mutual authentication mechanism (or at least a
somewhat broken reinvention of such)?  If the exchange to prove knowledge of
the PW has already been performed, why does A need to send the PW to B in the
last step?  You either use timestamps to prove freshness or add an extra
message to exchange a nonce and then there's no need to send the PW.  Also in
the above B is acting as an oracle for password-guessing attacks, so you don't
send back the decrypted text but a recognisable-by-A encrypted response, or
garbage if you can't decrypt it, taking care to take the same time whether you
get a valid or invalid message to avoid timing attacks.  Blah blah Kerberos
blah blah done twenty years ago blah blah a'om bomb blah blah.
(Either this is a really bad idea or the details have been mangled by the

@_date: 2007-06-22 05:05:55
@_author: Peter Gutmann 
@_subject: Re: U.S. Eyes Antiterror Rules for Small Jets and Boats 
That's where the light is at the moment, so they're looking there.  DHS
insiders have told me that the next target is going to be pancakes.  And after
that, people who own dogs whose names begin with 'B'.  After that, who knows.

@_date: 2007-07-11 12:03:36
@_author: Peter Gutmann 
@_subject: Re: Want to be a computer scientist? Forget maths 
Now name someone who isn't a maths geek at a University who proves algorithmic
correctness as part of their work.

@_date: 2007-10-24 14:35:30
@_author: unknown_name 
@_subject: Re: World-first technology combines payment card and 
"R.A. Hettinga"  forwards:
Wow, someone's reinvented the Super Smart Card, circa 1989.

@_date: 2008-01-13 12:28:27
@_author: Peter Gutmann 
@_subject: RE: Storm, Nugache lead dangerous new botnet barrage 
It doesn't have much effect on passive blocking, but what it stops (or at
least makes lot harder) is two things: Active attacks (penetration of botnet
servers by security people is a serious problem for the botherders, and I
assume competing botherders find this an easy target as well), and leeching of
botnet-collected data by others.  It's mostly back to enterprise DRM again.

@_date: 2008-01-13 03:54:56
@_author: Peter Gutmann 
@_subject: RE: Storm, Nugache lead dangerous new botnet barrage 
If you ever find users who do this, could you send them my way? :-).
There may be some reference user somewhere in a display case who does this,
but in practice unless the computer explodes in front of them no-one ever
reacts to infection.  I've seen users whose laptop fans are running
continuously because the CPU is pegged at 100% by malware not have any idea
that this isn't a normal state of affairs.  I've seen users who patiently wait
something like 30 seconds for an Explorer window to open because that's just
how long Windows takes.  I've seen users whose PCs page themselves to death
every time they start an app, and that's quite normal.  I've seen attack ships
on fire off the shoulder of Orion...
More importantly, the sort of people who are likely to have machines riddled
with malware are the same ones who aren't likely to have any idea that
anything's wrong.  Bill Cheswick has a neat talk "Windows OK" in which he
describes his dad patiently using his malware-infested PC that nicely
illustrates this.
So you reduce it from 1M nodes to 900,000 nodes, that's not much of a loss.
The benefit you get from making it hard(er) to intercept and disrupt more than
covers it.

@_date: 2008-01-12 10:38:06
@_author: Peter Gutmann 
@_subject: RE: Storm, Nugache lead dangerous new botnet barrage 
Enterprise DRM for the botnet.
(Alternatively, "because they can".  They're not paying for the overhead, it
doesn't really make much sense not to encrypt everything).

@_date: 2008-04-03 11:02:07
@_author: Peter Gutmann 
@_subject: Recent results with reduced-round SHA-256 
Analysis of Step-Reduced SHA-256, Collisions and other Non-Random Properties for Step-Reduced SHA-256,
  Attacking Reduced Round SHA-256, Very brief summary: Attacks are feasible against just over 1/3 of the 64
rounds (meaning if you reduce SHA-256 to 23 or 24 rounds, it's vulnerable).
That number is slowly creeping upwards.

@_date: 2008-04-01 13:22:48
@_author: Peter Gutmann 
@_subject: Re: Fwd: [gsc] eBay Sick of Whole "Internet" Thing 
"R.A. Hettinga"  forwarded:
It makes some sense, they're trying to prevent reputation capital markets,
specifically scammers buying themselves positive feedback.  Of course the
measure they've chosen seems a bit heavy-handed...

@_date: 2008-09-27 12:33:10
@_author: Peter Gutmann 
@_subject: Re: [silk] Blackberry in India 
It could be almost anything.  Here's another scenario: government MIB's break into the targets house and illegally plant listening devices.  In order to explain where they got the information in court, they say they got it by decrypting Blackberry traffic via a process that's secret for notional security purposes.

@_date: 2008-10-21 07:16:41
@_author: Peter Gutmann 
@_subject: Re: hard to top this bullshit 
Wow, this really is the myth that never dies, only the names of the
participants change.  This first cropped up in the mid-90s when it was being
used by unknown foreign agents (today these would automatically be "the
Chinese") to smuggle secrets out of US national labs, and every few years it
crops up again with a few names changed to keep it topical.  I'm surprised it
took this long for it to be Al Qaeda's turn.
Prediction for the future: At some point it'll be the turn of copyright
infringers/file sharers to be the subjects of this myth (if they haven't
already, and I missed it).

@_date: 2009-03-04 15:28:53
@_author: Peter Gutmann 
@_subject: Re: Judge orders defendant to decrypt PGP-protected laptop 
If you have an appropriate netbook (about 50% support this, check your
manufacturer and model type), unplug the SD card containing the OS image and
replace it with the SD card containing the clean install of XP along with
"Letter to mom.doc" and "Aunty Edna's 90th birthday.jpg".  Once you're at your
destination, pull the real SD card from the collection in your camera bag and
reinsert it.  Takes next to no time at all, and it guarantees there really
isn't anything there to be found (including large collections of random noise)
in any normal search.

@_date: 2009-03-04 06:14:54
@_author: Peter Gutmann 
@_subject: Re: Judge orders defendant to decrypt PGP-protected laptop 
Very nice explanation.  The name I've used for this (attempted) defence is the
Rumpelstiltskin defence, for reasons that should be obvious (and at some point
I'll get around to finishing the writeup on this, which I get motivated to do
every time I see someone advocate the Rumpelstiltskin defence as a strategy to
use in court).

@_date: 2009-04-21 09:56:56
@_author: Peter Gutmann 
@_subject: Brazilians hijack US military satellites 
The whole story's at:
it appears that Brazilians wanting to communicate on the cheap are using US
FLTSATCOM links to talk to each other.  This works because "the communication
channel was open, not encrypted, lots of people used it to talk to each other"
(later they talk about hearing encrypted military voice comms, so I assume
they mean that there's no access control, not necessarily encryption).
Truckers use it because you get better quality voice than with CB. Drug
dealers use it to coordinate operations, rogue loggers use it to warn of raids
by the authorities.  As the story says "Until [they get upgraded to use
crypto], the military is still using aging FLTSAT and UFO satellites - and so
are a lot of Brazilians".

@_date: 2009-04-21 09:55:41
@_author: Peter Gutmann 
@_subject: Brazilians hijack US military satellites 
The whole story's at:
it appears that Brazilians wanting to communicate on the cheap are using US
FLTSATCOM links to talk to each other.  This works because "the communication
channel was open, not encrypted, lots of people used it to talk to each other"
(later they talk about hearing encrypted military voice comms, so I assume
they mean that there's no access control, not necessarily encryption).
Truckers use it because you get better quality voice than with CB. Drug
dealers use it to coordinate operations, rogue loggers use it to warn of raids
by the authorities.  As the story says "Until [they get upgraded to use
crypto], the military is still using aging FLTSAT and UFO satellites - and so
are a lot of Brazilians".

@_date: 2009-10-17 04:57:44
@_author: Peter Gutmann 
@_subject: Re: Why aren't known-plaintext attacks against digital media 
Which after compression turns into a handful of bytes, encoding (initially)
"big block of nothing" and then "same as before".
See above.

@_date: 2010-01-07 23:48:55
@_author: Peter Gutmann 
@_subject: RE: [Fwd] NIST-certified USB Flash drives with hardware 
It's not "have bugs", it's "failed to meet the silly-walk requirements set by
that lab".  The labs will always find at least one thing to nitpick (and
preferably several, even if it's just the punctuation in your paperwork [0]),
no matter how perfect your code, because to not do so would imply that they're
not doing their job.  In addition since the silly-walk changes arbitrarily
from one lab to another, the "bugs" found will be different for each lab.  If
you really don't want to make some required change (for example because it'd
mean re- architecting your entire product) then the easiest solution is to
jury-shop labs until you find one that waves you through.
As was recently pointed out on another list, it's very worthwhile from a
marketing perspective.  Doesn't guarantee much about security, but provides a
guarantee of sales to government agencies.  This is why the certification
costs for a company's product will often be taken from the marketing budget
rather than the engineering budget.
[0] This actually happened in one eval when they were really struggling to
    find anything to complain about.

@_date: 2010-01-07 04:12:29
@_author: Peter Gutmann 
@_subject: [Fwd] NIST-certified USB Flash drives with hardware encryption 
============================== START ==============================
Encrypting USB Flash memory from Kingston, SanDisk and Verbatim Vergrv_ern
Kingston, SanDisk and Verbatim all sell quite similar USB Flash drives with
AES 256-bit hardware encryption that supposedly meet the highest security
standards. This is emphasised by the FIPS 140-2 Level 2 certificate issued by
the US National Institute of Standards and Technology (NIST), which validates
the USB drives for use with sensitive government data. Security firm SySS,
however, has found that despite this it is relatively easy to access the
unencrypted data, even without the required password.
The real question, however, remains unanswered . how could USB Flash drives
that exhibit such a serious security hole be given one of the highest
certificates for crypto devices? Even more importantly, perhaps . what is the
value of a certification that fails to detect such holes?

@_date: 2010-04-09 23:44:45
@_author: Peter Gutmann 
@_subject: Re: Fwd: [ PRIVACY Forum ] Surveillance via bogus SSL 
Yes.  When your CA goes bankrupt its only significant asset is often the root CA cert(s) it owns, which get onsold to the highest bidder by the receivers. This has occurred numerous times in the past, and some roots have been onsold multiple times, since it's both a means of monetising the CA's remaining assets and (usually) the cheapest way for a new CA to get their own cert.
(I'm not sure whether the browser vendor will even know if it's been on-sold, or how the vendor is supposed to know unless the new owner volunteers the information.  Also you can't really "revoke" a root, and the browser vendors certainly can't do it, the best they can do is disable/remove it in the next

@_date: 2010-07-14 05:04:31
@_author: Peter Gutmann 
@_subject: Re: Intel to also add RNG 
A very small entity that (in its analog form) requires custom manufacturing
steps, is affected by every minor change to the material, the process, die
shrinks, you name it, and that most customers don't even know exists.  So you
need to rework, re-evaluate, and re-test it every time anything changes, and
your customer won't pay extra for it.
If you're Intel mgt I can't see this as being a very hard decision...

@_date: 2010-07-13 05:46:36
@_author: Peter Gutmann 
@_subject: Re: Intel to also add RNG 
Do you have any more details on this?  Was it a hardware problem, software
problem, ...?  How was it caught?

@_date: 2010-07-13 05:46:36
@_author: Peter Gutmann 
@_subject: Re: Intel to also add RNG 
Do you have any more details on this?  Was it a hardware problem, software
problem, ...?  How was it caught?

@_date: 2010-07-12 15:58:51
@_author: Peter Gutmann 
@_subject: Re: Intel to also add RNG 
You mean rampant paranoia from a small group of people... if you are genuinely
worried about this, just use it as another input to mix into your entropy pool
(which you should be doing anyway, never trust a single source of entropy).
I'd be quite happy to use the RNG on a Loongson CPU (if there was one) in this
manner, let alone an Intel CPU.
What killed it wasn't paranoia about Intel but their almost total lack of
interest in supporting it once the initial media attention waned.  This
doesn't look any different, note that it's not saying "This will be in Core2's
starting August" but "We've done this in the lab".

@_date: 2010-07-12 15:58:51
@_author: Peter Gutmann 
@_subject: Re: Intel to also add RNG 
You mean rampant paranoia from a small group of people... if you are genuinely
worried about this, just use it as another input to mix into your entropy pool
(which you should be doing anyway, never trust a single source of entropy).
I'd be quite happy to use the RNG on a Loongson CPU (if there was one) in this
manner, let alone an Intel CPU.
What killed it wasn't paranoia about Intel but their almost total lack of
interest in supporting it once the initial media attention waned.  This
doesn't look any different, note that it's not saying "This will be in Core2's
starting August" but "We've done this in the lab".

@_date: 2011-03-29 02:50:38
@_author: Peter Gutmann 
@_subject: Re: Iranian state-sponsored cyberwarfare is indistinguishable 
For people who aren't following this via pastebin, to paraphrase Crocodile
Dundee, "you call that a successful CA attack?  *This*
 is a successful CA attack":
  "Here is another proof:   I uploaded
  JUST 1 table of their ENTIRE database which I own."
Looks like every Comodo account should now be regarded as compromised.  I
wonder if we'll finally see a CA cert pulled from a browser?  Or does the CA
have to behead someone live on Youtube before the browser vendors will act?

@_date: 2011-03-08 02:59:32
@_author: Peter Gutmann 
@_subject: [cryptography] Reliably Erasing Data From Flash-Based Solid 
Sure, but that's why you're paying five-figure sums for the forensics boxes.
They already do this for pretty much every cellphone type under the sun, so as
soon as the demand emerges they'll do SSDs as well.  In addition the magic in
wear-levelling is where to move things to, when, and how, not in any magic re-
encoding of block data.  So the contents of the data blocks stay the same,
they're just in different locations.  This means that, once you exclude
metadata used by the FTL, what you'll see is the equivalent of a highly-
fragmented standard disk drive.  I'm not saying it'll be trivial, but it
shouldn't be that hard either.

@_date: 2011-03-07 00:49:58
@_author: Peter Gutmann 
@_subject: [cryptography] Reliably Erasing Data From Flash-Based Solid 
Only until forensics comapanies come up with hardware devices to suck the data out of the raw flash devices, bypassing the FTL that's causing the problem. I did a interview on this,  that discusses the various issues.

@_date: 2011-03-29 01:22:30
@_author: Peter Gutmann 
@_subject: Re: Iranian state-sponsored cyberwarfare is indistinguishable 
The original source of the info about the hack has now posted the private key
corresponding to one of the bogus certs at   The
public-key components are identical, haven't verified that the private key
matches yet, but I'm going to guess it will.
So a global CA wasn't 0wned by a nation-state cyberwar agency but by a random
script kiddie having some fun.  Oh the embarassment :-).

@_date: 2011-03-26 04:34:22
@_author: Peter Gutmann 
@_subject: Iranian state-sponsored cyberwarfare is indistinguishable from 
Pretty much every news report I've seen so far that mentions any kind of
Iranian connection is claiming that it's Iranian state-sponsored hacking.  If
what's happened with the certs so far (someone grabbed a few sample certs for
high-profile domains, and there was a report of one of them briefly appearing
on a test server in Iran) is an indication of their competence then we really
have nothing to fear from them.
Let's look at what would have happened if *I'd* figured out a way to compromise a CA.  First, I'd get a few test certs issued for high-profile domains, Microsoft, Google, Yahoo, and perhaps a CA cert just for giggles.  Then I'd set up a server somewhere and install one of the sample certs to see whether any web browser noticed a problem.
Gosh, this sounds awfully like what actually happened.  New Zealand must have
a state-sponsored cyberwar program!  The only difference in my case is that
after a day or so of inviting security people to have a giggle at the test
server with my "genuine" cert, I'd notify the CA about the problem.  If I was
an Iranian script kiddie I probably wouldn't have much motivation to do that.
So what we have here is either (a) the world's most incompetent state-
sponsored cyberwar program, who get the keys to the kingdom and then have no
idea what to do with them, or (b) a bunch of script kiddies having fun.
What do you reckon the odds are?
(And in all this I haven't seen any mention of the Al Kai-yee-da angle.  What happened, is everyone asleep?).

@_date: 2011-06-17 11:50:28
@_author: Peter Gutmann 
@_subject: [cryptography] Digital cash in the news... 
Is it a sign that your e-Monopoly-money has arrived when trojans start
targeting it?
(My guess is that since trojans already steal everything they can, including
lots of stuff with no obvious value, that the authors just added Bitcoin
wallets because they could).

@_date: 2011-06-12 06:21:58
@_author: Peter Gutmann 
@_subject: [cryptography] Digital cash in the news... 
There is a small but insignificant chance that fiat monies will collapse.
There is a small but insignificant chance that if this happens, the world will
  go to the bitcoin standard.
Since the Vogon Construction Fleet will have been and gone by this time, this
  will be a mostly academic issue.
Am I the only one who thinks it's not coincidence that the (supposed) major
use of bitcoin is by people buying hallucinogenic substances?

@_date: 2011-06-11 03:58:07
@_author: Peter Gutmann 
@_subject: [cryptography] Digital cash in the news... 
Finally an analogy I can use to explain bitcoin to the masses (well, assuming they know about the tulip mania).  I've been using Bartercard, which is a good analogy but somewhat limited in international recognition.

@_date: 2011-06-11 03:31:16
@_author: Peter Gutmann 
@_subject: [cryptography] Digital cash in the news... 
My response to this when it came up on the cpunx list:
Coming up next week, "The Bitcoin-based Child Porn Market".  And don't miss
our exciting future six-part series "The al-Qaeda/Bitcoin Connection".
  The sound of hoof beats 'cross the glade
  Good folk, lock up your son and daughter
  ...

@_date: 2011-06-02 13:53:43
@_author: Peter Gutmann 
@_subject: Re: The Underground Website Where You Can Buy Any Drug 
Coming up next week, "The Bitcoin-based Child Porn Market".  And don't miss
our exciting future six-part series "The al-Qaeda/Bitcoin Connection".
  The sound of hoof beats 'cross the glade
  Good folk, lock up your son and daughter
  ...

@_date: 2011-08-19 07:39:49
@_author: Peter Gutmann 
@_subject: [cryptography] Smart card with external pinpad 
They keep the PIN from the host because it's communicated directly from the
reader to the card.  OTOH the security, in the cases where I've looked at
them, is pretty bad, both the cards and the readers are horribly vulnerable to
malformed-data attacks.  In fact the biggest challenge when... investigating
them is to avoid bricking the card and/or reader, because it's so easy to do
via out-of-spec messages.  In addition many of the implementations are
horribly buggy so you have to send malformed packets to them to get them to
work (except if they're malformed the wrong way then you brick the card, which
is why you start with a stack of cards on the assumption that you'll brick
half of them as you're trying to figure out the messaging protocol).  I've
been told by people who have worked on them that significant chunks of
proprietary vendor drivers on the host are devoted to working around all the
implementation bugs in cards and readers.  If there's anyone who's worked on
reverse-engineering card protocols for something like OpenSC they should be
able to provide further info.

@_date: 2011-09-07 02:40:57
@_author: Peter Gutmann 
@_subject: [cryptography] Diginotar broken arrow as a tour-de-force of PKI 
[Responding to the same three lists as before, please trim followups if you
 feel it's off-topic]
In response to my earlier "OCSP is unfixably broken, by design" comments, a
couple of people have responded off-list with variants of "OK smartypants, how
would you do it better?".  In order to provide a general answer (and avoid
fragmenting the discussion into lots of private-mail threads), I'll point to
  This addresses all the problems I've pointed out in OCSP, as well as things
OCSP never considered like performance issues (thus Verisign's security-
breaking OCSP "optimisations").  It's been peer-reviewed and vetted, and I
could have it re-posted in current draft format in a couple of days if there's
any interest in finally switching validity-checking to proper whitelists (and
fixing all of OCSP's other bugs).
Two notes:
1. This isn't a "get my pet protocol published", just a convenient means of
   pointing out that this problem has been well-known among security
   architects, thought about, and solutions designed, at least a decade ago.
2. You may notice the rather odd form of the draft, as an S/MIME work item.
   The reason why this was never published was because it proved impossible to
   get past PKIX because it wasn't blacklist-based and was therefore
   incompatible with CRLs.  The document starts in the late 1990s and mutates
   over time as I tried to work around PKIX' resistance to whitelist-based
   validity-checking.  After a couple of years of battling to get anything
   like this adopted I just gave up, as the "CMS" in the draft implies towards
   the end I was resorting to trying to launder it via the S/MIME working
   group to get it published.  I think it was when someone told me that it'd
   be referred back to PKIX for approval (as part of some IETF mechanism to
   prevent people doing end-runs around working groups as I was doing) that I
   realised it was never going to go anywhere.
Anyway, a solution exists, it's been implemented and in active use for at
least a decade, and I believe it fixes all of OCSP's numerous flaws as well as
ones that were never even considered in OCSP, such as performance implications
(in one test while looking at throughput I managed to - accidentally - DoS a
LAN with a single 300MHz PIII machine running this protocol.  Try doing that
with OCSP).

@_date: 2011-09-06 13:45:30
@_author: Peter Gutmann 
@_subject: [cryptography] Diginotar broken arrow as a tour-de-force of PKI 
It was updated after it was posted.
The current link from the reports page is:
If it moves again you can find it with this URL:

@_date: 2011-09-04 06:15:32
@_author: Peter Gutmann 
@_subject: [cryptography] Diginotar broken arrow as a tour-de-force of PKI fail 
[Sent to three lists from which input would be useful, please trim followups
 if you feel it's off-topic]
I was reading through the various summaries of the Diginotar broken arrow yesterday and realised that it's a pretty comprehensive tour de force of every piece of PKI brokenness that people have been warning about for the past ten to fifteen years.  Almost everything in it would have been entirely avoidable if PKI were less driven by religious dogma and more by good, solid security engineering.  Here are some of the cases that spring to mind:
Blacklist-based validity checking, the Second Dumbest Idea in Computer
Security (Marcus Ranum), doesn't work:   Diginotar issued certs for which there was no record of issuance, therefore
  they couldn't be revoked.  Whitelist-based checking would have prevented
  this.
  (This one really is pretty incredible, PKI relies on the *second dumbest
  idea in computer security* for it's "security", and since that's just a   variant of the dumbest idea, default-allow, it could be argued that it
  actually relies on the dumbest idea in computer security).
Universal implicit cross-certification makes the entire system as weak as the
weakest link:
  Diginotar apparently issued certs for other majors CAs like Equifax, Thawte,
  and VeriSign, allowing them to usurp other major CAs.
Storing your private key in a dumb hardware device only provides epsilon
increase in actual security:
  An HSM or smart card that does anything the PC that it's attached to tells
  it to is only slightly more secure than simply storing the key directly on
  the PC.  You need to do more to secure a high-value signing process than
  sprinkling smart card/HSM pixie dust around and declaring victory.
Lack of breach disclosure requirements for CAs means that they'll cover
problems up if they can get away with it:
  Diginotar actively covered up, and later downplayed, the magnitude of the
  compromise.  They were only discovered because the certs were publicly used
  on a (large?) scale against victims.  Who knows how many other CAs have been
  compromised, but the public never noticed because the attackers were more
  circumspect and the CAs covered it up.
  (Unlike the other issues, which people had been pointing out repeatedly for
  one- to one-and-a-half decades, this one is relatively new and based on
  recent experience with other CAs' non-disclosure of problems).
Browser PKI is *the* point of security failure for browsers:
  Browsers do absolutely nothing (apart from a token, mostly ineffective site-
  blacklist check) to protect users beyond popping up a warning if the site
  owner didn't pay a CA for their cert.  Once this sole mechanism fails,
  there's nothing protecting the user.  Even the most trivial checks by
  browsers would have caught the fake Google wildcard cert that started all
  this.
OK, so PKI failed again, no harm done, the banks will reimburse you for card
  In this case it was more than just that, it appears to have been used by a
  very oppressive regime against its own citizens.  As the SANS diary says,
  "If you're a user in Iran, and had something to hide from your government,
  odds are you're in trouble with your government".
The browser trusted-root formula of "pass an audit, welcome to the gravy
train, please take a seat at the trough" doesn't work in terms of providing
  Diginotar both passed audits in order to get on the browser gravy train and
  then passed a second level of auditing after the compromise was discovered.
  The auditors somehow missed that fact that the Diginotar site showed a two-
  year history of compromise by multiple hacking groups, something that a
  bunch of random commentators on blogs had no problem finding.
There is no escape:
  Unlike many other aspects of security where you can choose not to use option
  A if it fails but switch to option B, with browser PKI there is no option B.
  Browser vendors have chosen to make PKI the only web-site security option
  available.  There is no fallback.  Site owners who are concerned about the
  security of their users can't do anything, because the browser vendors have
  chosen to prevent them from employing any other option (I can't, for
  example, turn on TLS-PSK or TLS-SRP in my server, because no browsers
  support it - it would make the CAs look bad if it were deployed).
Are there any more that I missed?
(A bit less than ninety-five theses, sorry.  In any case there's no door I can
easily nail them to).

@_date: 2011-09-17 14:03:36
@_author: Peter Gutmann 
@_subject: [cryptography] The consequences of DigiNotar's failure 
That's a non-sequitur.  What you're saying is that no-one working in an
environment where they actually need SSL should trust SSL.

@_date: 2011-09-23 11:21:38
@_author: Peter Gutmann 
@_subject: [cryptography] Nirvana 
No.  Or at least buried way, way down in a hidden corner there was something
that was a bit like that, sort of like painting one of the toenails on an
elephant, but the vast mass of the rest overwhelmed that one bit.

@_date: 2011-11-28 02:59:01
@_author: Peter Gutmann 
@_subject: Re: [cryptography] Declassified NSA Tech Journals 
Particularly interesting is "Some Principles of Cryptographic Security -
Summer 1974 - Vol. XIX, No. 3", sort of an updated/revisited version of the
oft-quoted Kerckhoffs's principles.
cryptography mailing list

@_date: 2011-11-09 10:12:12
@_author: Peter Gutmann 
@_subject: Re: [p2p-hackers] Verifying Claims of Full-Disk Encryption in 
Eugen Leitl  quotes Tom Ritter :
Without wanting to sound too facetious, and mostly out of curiosity, what does
FIPS 140 have to do with the threat modelling you've done?  It doesn't address
the vast majority of the stuff you've listed, so the threat-modelling is kind
of a non-sequitur to "starting with FIPS 140".  If you wanted to deal with
this through a certification process you'd have to go with something like the
CC (and an appropriate PP), assuming the sheer suckage of working with the CC
doesn't tear a hole in the fabric of space-time in the process.

@_date: 2011-12-23 01:37:31
@_author: Peter Gutmann 
@_subject: Re: Iran GPS Spoofing and the RSA Cipher 
Since when does GPS use RSA?  AFAIK the P(Y) encryption is straightforward
symmetric crypto.

@_date: 2011-12-05 04:33:23
@_author: Peter Gutmann 
@_subject: Re: From Facebook's Hackathon, TCP re-implemented over chat in 
I've implemented SMTP over TCP/IP over postcards.  Latency was a bit of a
pain, and packet loss was also an issue.
The fact that I'm terrible at dealing with snail mail didn't help either.

@_date: 2011-12-11 07:58:58
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
Oh, developers would do more than squawk about it.  Both Java and .NET
actually support the capability-based security that you mentioned, but it's so
painful to use that it's either turned off by default (.NET's 'trust
level="Full"') or was turned off after massive developer backlash (Java).
Even the very minimal capabilities used by Android are failing because of the
dancing bunnies and confused deputy problems, and because developers request
as close to any/any as they can get just in case (exacerbating the confused
deputy problem).
(One of the nice things about Android is that it's fairly easy to decompile
and analyse the code, so there have been all sorts of papers published on its
capability-based security mechanisms using this technique.  It's serving as a
nice real-world empirical evaluation of failure modes of capability-based
security systems.  I'm sure someone could get a good thesis out of it at some
Objection, tautology: Properly done, any (malware-related) security measure
would drop malware rates close to nil.  The problem is doing it properly...
cryptography mailing list

@_date: 2011-12-10 13:02:15
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
... dancing bunnies ... confused deputy ...
(This is a serious problem on Android phones.  The permissions systems is much
nicer than NT/Unix - mostly because it'd be hard to come up with something
that's worse - but it's fatally vulnerable to the dancing bunnies and confused
deputy problems.  For example one recent analysis of Android phones from a
range of vendors found that, out-of-the-box, before any user apps were even
installed, all of them leaked critical capabilities, all the way up to
MASTER_CLEAR for the phone).
cryptography mailing list

@_date: 2011-12-10 05:15:52
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
WHQL is a good analogy for the situations with certificates, it has to be made
inclusive enough that people aren't unfairly excluded, but exclusive enough
that it provides a guarantee of quality.  Pick any one of those two.
(I have a much longer analysis of this, a bit too much to post here, but
there's a long history of vendors gaming WHQL and the certifiers looking the
other way, just as there is with browser vendors looking the other way when a
CA screws up, although in the case of hardware vendors the action is
deliberate rather than accidental).
cryptography mailing list

@_date: 2011-12-09 04:27:32
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
My post was based on data gathered by a well-known anti-malware company, I'm just reporting what they found in real-world use.
In any case getting signing certs really isn't hard at all.  I once managed it in under a minute (knowing which Google search term to enter to find caches of Zeus stolen keys helps :-).  That's as an outsider, if you're working inside the malware ecosystem you'd probably get them in bulk from whoever's dealing in them (single botnets have been reported with thousands of stolen keys and certs in their data stores, so it's not like the bad guys are going to run out of them in a hurry).
Unlike credit cards and bank accounts and whatnot we don't have price figures for stolen certs, but I suspect it's not that much.
cryptography mailing list

@_date: 2011-12-08 22:02:01
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
Uhh, read my original text again.  This is your personal opinion.  Ask a bunch
of PKI people, or look at what real applications do, and you'll get any one of
the three interpretations I described.  The fact that you think this doesn't
mean that anything actually does it.
cryptography mailing list

@_date: 2011-12-08 03:28:36
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
The rate-limiting factor is how many certs you can steal, and how quickly.  The technology side doesn't even come into it.  So this is a valid measure, and will continue to be so, because you can't speed up the cert-stealing process.
It's the same with monetary fraud, the rate-limiting step there is how fast you can cash out the accounts.  Sure, your botnet has collected 50M accounts and associated authorisation information, but how fast can you cash them out?
Velocity limiting via computationally intractable means is one security measure that is universally effective and hard to bypass.
cryptography mailing list

@_date: 2011-12-08 03:20:38
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
The effectiveness of that isn't the PKI or the signing though, it's that Apple
vets the apps before allowing them in the store.  You don't need certs, all you need to do is have Apple sign the apps with a key that's burned into the iPhone.  PKI in this case just gets in the way.  Heck, you don't even need signatures, just have the iPhone contact Apple and say "I just got fed something with this hash, is it OK?".
(Due to a confusion over certs, you couldn't until recently even verify the
signatures yourself because Apple published a different cert on their web site
than the one they used for signatures.  But in any case any use of PKI, and
possibly even signatures, in this case is just unnecessary complexity).
cryptography mailing list

@_date: 2011-12-07 21:56:29
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
There is at least one very obvious benefit: When malware is signed, it can't
mutate on each generation any more but has to remain static.  This makes it
easier for the anti-malware folks to detect.
You can also use it a second way:
  When malware authors have signed their products (at least until now) with
  fraudulently-obtained certificates (but not stolen ones) the only thing that
  they've signed with that particular certificate is malware. This means that
  once a particular signed binary has been detected as being malware the virus
  scanner can extract the signing certificate and know that anything else that
  contains that particular certificate will also be malware, with the
  certificate providing a convenient fixed signature string for virus scanners
  to look for.  This actually provides a real, effective use for code-signing
  certificates, although it's certainly one that the PKI folks would never
  have dreamed of.
  Unfortunately as with many other arms-race tricks it only works as long as
  the malware authors don't try to counter it, either by buying a new
  certificate for each piece of malware that they release (it's not as if
  they're going to run out of stolen credit cards and identities in a hurry)
  or by siphoning large numbers of benign applications from software-
  distribution sites, signing them, and re-uploading them to other software
  distribution sites so that the signed files that constitute actual malware
  get lost in the noise.
See above, code signatures help increase the detecability of malware, although
in more or less the reverse of the way that it was intended.
cryptography mailing list

@_date: 2011-12-07 21:48:04
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
You have to remember that using TSAs for code is used purely as a means of
getting around the fact that for CA billing purposes the code-signing cert
expires after one year.  You need to extend this in some PKI-compliant manner
in some way, and timestamping is the only obviously available way to do it.
If you want to extend it in a non-PKI-compliant manner you just ignore cert
expiration for code signatures, as the Java folks did when they removed any
certificate-expiry checks in JCE 1.2.2 after the expiry of the JCE 1.2.1
certificate on 27 July 2005 caused considerable pain for vendors of products
that used it.
Alongside TB2F CA certs, code-signing TSA certs are another example of
irrevocable certs, which would make them tempting targets for theft.  Unlike
CA roots, they have to be kept online at all times since they're used for
automated code-signing.  There are probably many more examples of certs in
similar too-critical-to-revoke certs that can't be protected as well as CA
roots.  How many can you spot?
cryptography mailing list

@_date: 2011-12-07 21:38:55
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
Uhh, they were never said to deliver this property by anyone who knew anything
about law, they were simply declared to have it by mathematicians and
standards committees:
  The term "repudiation" has a specific legal meaning but this has nothing to
  do with the use of the term in certificates, and there seems to have been
  little to no input from lawyers into the PKI standards that were meant to be
  used for digital signatures (it's always amusing watching heated arguments
  in standards groups over what both sides think that lawyers might advise if
  they actually asked them).  In particular, disabusing geeks of the notion
  that what's referred to in crypto/PKI theory as nonrepudiation actually
  means anything in a real-world legal context is really, really hard.  Geeks
  really want to believe in the magic of cryptography.
In recognition of this, X.509 some years ago stopped even pretending that
digital signatures provided nonrepudiation.  The certificate flag that used to
be nonRepudiation is now called contentCommitment to indicate it's for a long-
term signature, while digitalSignature is for a short-term signature like
authenticating for an online service.
(There's a lot more to the NR/CC saga than that, very few implementers seem to
have got the memo about NR = CC and everyone just uses digitalSignature for
everything, see the "magic of cryptography" comment in the excerpt above).
cryptography mailing list

@_date: 2011-12-07 21:32:06
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
That's actually a known problem (at least to PKI people).  So what you're
really asking is whether a self-signed root cert can revoke itself, since a
lower-level cert can always be revoked by a higher-level one:
  The handling of CA root certificates is particularly problematic because
  there's no effective way to replace or revoke them.  Consider what would be
  required to revoke a CA root certificate.  These are self-signed, which
  means that the certificate would be revoking itself.  In the presence of
  such a revocation applications can react in one of three ways: they can
  accept the CRL that revokes the certificate as valid and revoke it, they can
  reject the CRL as invalid because it was signed by a revoked certificate, or
  they can crash (and some applications will indeed crash in this situation).
  Since revocation of a self-signed certificate is the PKI version of
  Epimenedes paradox "All Cretans are liars" and PKI applications are unlikely
  to be coded to deal with self-referential paradoxes, crashing is a perfectly
  valid response.
No, not really, the PKI folks have it sorted out: Ostrich algorithm, like many
other known paradoxes and problems created by the standards
cryptography mailing list

@_date: 2011-12-07 14:21:05
@_author: Peter Gutmann 
@_subject: Re: [cryptography] How are expired code-signing certs revoked? 
That wouldn't work, consider the untold numbers of install CDs shipped with
anything that you could think of conneting to a PC at some point (your shiny
new digital camera, your electric toothbrush, ...).  These are often extremely
out-of-date, but you can't block the install just because the cert has
cryptography mailing list

@_date: 2011-12-07 12:01:49
@_author: Peter Gutmann 
@_subject: [cryptography] How are expired code-signing certs revoked? 
Consider the following scenario:
1. Attackers steal a code-signing key and use it to sign malware.
2. The certificate for the stolen key expires.
3. Malware signed with the key turns up.
Since the signature is timestamped to allow it to still validate after the
original cert expires, it'll be regarded as valid.  Since the cert has now
expired, it won't be present in the CRL, or if it was present it'll be removed
(this is standard practice to manage CRL sizes).
How do you invalidate such a signature?
cryptography mailing list

@_date: 2012-01-20 12:52:01
@_author: Peter Gutmann 
@_subject: Re: Megaupload.com seized 
Eugen Leitl  quotes:
Kim Schmitz (or whatever he's calling himself this week) is a survivor.
He'll be back, even if Megaupload isn't.

@_date: 2012-02-27 03:30:46
@_author: Peter Gutmann 
@_subject: Re: [cryptography] US Appeals Court upholds right not to decrypt a drive 
James, meet Bertha.  Sorry about her cold hands, just give her a minute to get
the gloves on.  In the meantime if you'll drop your trousers...
cryptography mailing list

@_date: 2012-02-27 03:08:59
@_author: Peter Gutmann 
@_subject: Re: [cryptography] US Appeals Court upholds right not to decrypt a	drive 
It's not an exercise in game theory, it's standard police work. If they've watched you downloading child porn for six months, with enough evidence to get a warrant, and all they find is an encrypted partition and no trace of the pr0n anywhere else, then it doesn't take Sherlock Holmes to figure out where it most likely went.
(Talking to e-crime investigators is always illuminating. When they say they're "not stupid" they don't mean they have PhDs in game theory, they mean that they're (usually) going to come in with enough evidence and expertise to have a good chance of a successful prosecution. Being able to hide something with FDE is a very, very rare exception, generally one where evidence was very flimsy anyway).
cryptography mailing list

@_date: 2012-02-25 12:44:59
@_author: Peter Gutmann 
@_subject: Re: [cryptography] US Appeals Court upholds right not to decrypt a drive 
Uh, you know the bit where I said that the police are very good at getting
information out of people?  That also applies to people who initially decide
that they don't want to talk to the police.
cryptography mailing list

@_date: 2012-02-25 11:36:01
@_author: Peter Gutmann 
@_subject: Re: [cryptography] US Appeals Court upholds right not to decrypt a drive 
Ditto.  One other thing that you need to add, the police are very, very good
at getting information out of people.  They've been doing it with hardened
criminals for decades, so your average random geek is no problem.
cryptography mailing list

@_date: 2012-02-11 06:05:59
@_author: Peter Gutmann 
@_subject: Re: 30,000 Domestic Drones to Fill Our Skies, Civil Liberties at Risk 
Restrictions on shining laser pointers at aircraft only applies to piloted
craft, right?

@_date: 2012-03-31 08:02:09
@_author: Peter Gutmann 
@_subject: Re: [cryptography] Key escrow 2012 
That's because they serve little purpose and the tools are waaaay too hard to
use.  Someone (Matt Blaze?) once commented that if the NSA/FBI had done
nothing at the start of the crypto wars, AT&T would have sold a few hundred
TSD3600s and most of them would have sat on shelves gathering dust.  So in a
sense both sides won, we got to deploy strong crypto everywhere and the MIBs
get to reap the benefits of almost no-one using crypto for their comms (voice,
email, etc).
cryptography mailing list

@_date: 2012-04-18 12:25:08
@_author: Peter Gutmann 
@_subject: Re: [RISKS] Risks Digest 26.79 
Odd that that was still an issue, during the Auckland blackout in 1999 the
same thing happened, generators that were tested every six months and kept
topped up failed when they were run over a longer period because the fuel
level got down to the sludge at the bottom which got drawn into the generator.
I'd have thought they'd have taken steps do deal with this by now...

@_date: 2012-05-29 00:35:44
@_author: Peter Gutmann 
@_subject: Re: [cryptography] can the German government read PGP and ssh traffic? 
The technical details are long and tedious (a pile of machines that need to
talk via SSH because telnet and FTP were turned off/firewalled years ago, I
won't bore you with the details).  The important point isn't the technical
details but the magical thinking, "a private key sprayed all over the place in
plaintext is more secure than a line-noise password because everyone knows
passwords are insecure and PKCs are secure" (and, as I've said, this isn't an
isolated case).
cryptography mailing list

@_date: 2012-05-26 06:01:36
@_author: Peter Gutmann 
@_subject: Re: [cryptography] can the German government read PGP and ssh traffic? 
The government was asked "are encrypted communications creating any
difficulties for law enforcement in terms of pursuing criminals and
terrorists?".  The government replied "no, not really, so there's no need to
restrict the use of crypto by the public".
cryptography mailing list

@_date: 2012-05-26 05:57:07
@_author: Peter Gutmann 
@_subject: Re: [cryptography] can the German government read PGP and ssh traffic? 
That has its own problems with magical thinking: Provided you use PK auth,
you're magically secure, even if the private key is stored in plaintext on ten
different Internet-connected multiuser machines.  I don't know how many times
I've been asked to change my line-noise password for PK auth, told the person
requesting the change that this would make them less secure because I need to
spread my private key across any number of not-very-secure machines, and
they've said that's OK because as long as it uses PKCs it's magically secure.
cryptography mailing list

@_date: 2012-06-10 16:25:22
@_author: Peter Gutmann 
@_subject: Re: [cryptography] can the German government read PGP and ssh	traffic? 
Magical thinking works independently of technology, so I'm sure there's a lot
of it in the PGP world as well :-).
Notes is another matter entirely, it's never been subject to any independent analysis or scrutiny, so there could be holes in there big enough to drive a truck through (and from what I've both seen of other PKI implementations, and of Notes in general, I'm pretty sure they'll be there).  I'm not sure that an application that can barely be trusted to get a piece of mail from A to B correctly should be trusted to get its PKI right.  But then that's another debate entirely.
In both cases though you need to look at it from the point of view of "is the mechanism being employed appropriate for what's being secured" rather than "we use PKCs, all security problems are solved".
cryptography mailing list

@_date: 2012-06-05 12:11:06
@_author: Peter Gutmann 
@_subject: Re: [cryptography] can the German government read PGP and ssh	traffic? 
...except that a user study a few years back ("Inocilating SSH Against Address
Harvesting") found that two thirds of all SSH private keys were stored in
plaintext on disk.  You need to look at what actually happens in practice, not
what in theory should happen in an ideal world.
In any case though you're completely missing the point of my argument (as did
the previous poster), which is that a scary number of people follow the
thinking that "passwords are insecure, PKCs are secure, therefore anything
that uses PKCs is magically made secure" even when it's quite obviously not
secure at all.  This is magical thinking, not any kind of reasoned assessment
of security.
cryptography mailing list

@_date: 2012-06-13 05:26:39
@_author: Peter Gutmann 
@_subject: Re: [silk] Flame is Lame 
Eugen Leitl  quotes:
Yeah, because cryptographacamy is magic.  The exploit may have used 0day and
rootkits and ROP and stealth techniques and self-modifying code and who knows
what else, but any five-year-old can do that.  However, if there's any
cryptographi... cryptograma... magic involved then it had to have been done by
sikrit gummint agencies.
I'm not saying it was or it wasn't, but I am a bit disturbed at the level of
magical thinking that goes with anything involving crypto.  There have been
some pretty sophisticated attacks on crypto keys in embedded devices for
jailbreaking purposes that were done by enthusiastic amateurs, not even the
likes of (to pick some random examples of crypto people who've done this
before) David Wagner or Ed Felten or Markus Kuhn but just some random guys who
decided to give it a go.
Looked at another way, if you submitted a paper "Yet another chosen prefix attack on MD5" to Crypto/AsiaCrypt/Eurocrypt, do you think it'd get accepted?.  I'm not trying to denigrate the achievement, just to add a little perspective.

@_date: 2012-06-25 10:01:14
@_author: Peter Gutmann 
@_subject: Re: [liberationtech] Single board mini computers as circumvention tools 
Eugen Leitl  quotes:
I like the Alix boards from PCEngines, they come with nice cases, don't have
the severe heat problems that many of the Arm-based boards do, and run
any standard x86 binaries.

@_date: 2012-11-16 10:55:18
@_author: Peter Gutmann 
@_subject: Re: from somelist somewhere 
Well, that's the theory anyway.  In practice the browser crashed with a memory
corruption error after about the fourtieth tab was opened.

@_date: 2012-11-27 01:15:35
@_author: Peter Gutmann 
@_subject: Re: [drone-list] US DoD Directive on Autonomy 
Eugen Leitl  forwards:
So the goal is the same as Orange book A1, but with a wider and scarier range
of attacks to defend against.  OK then.
When are the deliverables for this due?

@_date: 2012-12-14 22:08:57
@_author: Peter Gutmann 
@_subject: Re: btw, the itu imploded 
Eugen Leitl  quotes:
This remains me of a passage on journalism from the classic "How to be an
Alien" (cut down somewhat for size):
--- The Fact ---
There was some trouble with the Burburuk tribe in the Pacific Island,
Charamak. A party of ten English and two American soldiers, under the command
of Capt. R. L. A. T. W. Tilbury, raided the island and took 217 revolutionary,
native troublemakers prisoner and wrecked two large oil-dumps. The party
remained ashore an hour-and-a-half and returned to their base camp without
loss to themselves.
How to report this event? It depends on which newspaper you work for.
--- The Times ---
... It would be exceedingly perilous to overestimate the significance of the
raid, but it can be fairly proclaimed that it would be even more dangerous to
underestimate it. The success of the raid clearly proves that the native
defences are not invulnerable; it would be fallacious and deceptive, however,
to conclude that the defences are vulnerable. The number of revolutionaries
captured cannot be safely stated, but it seems likely that the number is well
over 216 but well under 218.
--- Evening Standard (Londoner's Diary) ---
The most interesting feature of the Charamak raid is the fact that Reggie
Tilbury is the fifth son of the Earl of Bayswater. He was an Oxford Blue, a
first-class cricketer and quite good at polo. When I talked to his wife (Lady
Clarisse, the daughter of Lord Elasson) at Claridges to-day, she wore a black
suit and a tiny block hat with a yellow feather in it. She said: "Reggie was
always very much interested in warfare." Later she remarked: "It was clever of
him, wasn't it?"
If you are the London correspondent of the American paper
--- The Oklahoma Sun ---
simply cable this:
    "Yanks Conquer Pacific Ocean"

@_date: 2012-12-05 13:01:28
@_author: Peter Gutmann 
@_subject: Re: Custom Chips Could Be the Shovels in a Bitcoin Gold Rush 
Eugen Leitl  forwards:
I guess the main lesson from this (well, the second lesson after the fact that
Extraordinary Popular Delusions needs a new chapter) is that if you're doing
password hashing, use anything but SHA-256.

@_date: 2012-12-05 23:35:29
@_author: Peter Gutmann 
@_subject: Re: [liberationtech] /. ITU Approves Deep Packet Inspection 
Eugen Leitl  forwards:
Yes.  In the current climate if the ITU tried to standardise ponies, people
would find reasons why ponies are evil.

@_date: 2013-01-13 10:09:42
@_author: Peter Gutmann 
@_subject: Re: [liberationtech] Tragic News: Aaron Swartz commits suicide 
Eugen Leitl  quotes:
There's a far more likely cause: Security geeks/hackers tend to be INTP/INTJ
MBTI personality types.  This personality type is far more susceptible to
depression than other types (see e.g. "Myers Briggs Type Indicator personality
profiles in unipolar depressed patients", David Janowsky, Elliot Hong, Shirley
Morter and Laura Howe, World Journal of Biological Psychiatry, Vol.3, No.4
(October 2002), p.207), as is the related Aspergers type (see e.g.
"Psychological Disorder in Adolescents and Adults with Asperger Syndrome",
Digby Tantam, Autism, Vol.4, No.1 (March 2000), p.47).  So it's not so much
the environment (any number of non-hacker environments are also not exactly
warm fuzzies and hugs), it's a straightforward mental health issue.

@_date: 2013-04-08 01:06:45
@_author: Peter Gutmann 
@_subject: Re: [cryptography] ICIJ's project - comment on cryptography & tools 
Exactly.  If the NSA didn't exist at all the only difference we'd notice is
that there'd be less of this weird obsession with ECDSA (via pressure to adopt
Suite B).  Computer security as a whole wouldn't suck any less.
At the other end of the scale, 99.9% of developers who do know security have
no idea how to create *usable* security.  At the moment there are exactly two
crypto-using products I can think of that I'd feel confident a random member
of the public could walk up and use, those being Skype and iMessage.
(Unfortunately to the crypto-purists they're not good enough because they're
MITM-able.  You should be tunnelling SIP over OpenVPN, it's really easy,
here's a pointer to a list of links to 100-page discussion threads on web
boards for ways of doing this that may work sometimes).
Incidentally, the NSA is, from all the reports I've seen, even worse than we
are at making security usable.  My favourite publication on security
usability, Laura Heath's "An Analysis of the System Security Weaknesses of the
US Navy Fleet Broadcasting System, 1967-1974, as exploited by CWO John
Walker?", goes into this in more detail.
cryptography mailing list

@_date: 2013-04-05 00:12:33
@_author: Peter Gutmann 
@_subject: Re: [cryptography] ICIJ's project - comment on cryptography & tools 
So Louis Freeh has joined the DEA?  Or did they just strike the mid-90s dates
on the reports and add today's date?
Peter (still waiting for the sky to fall 20 years later).
cryptography mailing list

@_date: 2013-07-24 07:31:20
@_author: Peter Gutmann 
@_subject: Re: Gnu PG is more Safe ? 
There's been a bunch of work done in this area, another one that springs to
mind is Coverity's scan reports.  The general conclusion from them is,
unsurprisingly, that being open source doesn't magically make you more secure.
You only find bugs (vulns) if someone looks for them, and a closed-source app
that's actively analysed for vulns (because the vendor pays employees to do
it) is going to be more secure than an open-source app that no-one looks at
because they're not motivated to.  In either case the ones with the highest
motivation to look are the attackers.

@_date: 2013-07-24 04:10:54
@_author: Peter Gutmann 
@_subject: Re: Gnu PG is more Safe ? 
cryptlib,  been
around for... well, longer than GPG has :-).

@_date: 2013-07-24 03:08:24
@_author: Peter Gutmann 
@_subject: Re: Gnu PG is more Safe ? 
That should actually say "because GnuPG is open source, people assume that
someone else has extensively peer reviewed it and therefore assume that it's
safe and secure".  For example there was a long-standing RNG bug that was very
obvious if you looked at the code, but was only discovered by chance when
someone who was interested in the RNG happend to read through the code and
thought "hmm, surely that can't be right".  Having code that's open source
doesn't help at all if no-one looks at it.
Argh, no.  The best way to confuse someone is to get them to read an RFC. Find
a good book on the topic, e.g. for SSL/TLS there's Eric Rescorla's "SSL and
TLS: Designing and Building Secure Systems".  Before that, read "Network
Security: Private Communication in a Public World" by Kaufman et al.

@_date: 2013-08-22 11:05:50
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
Just appeared on the GnuPG list:
NeuG 0.11 was released.  NeuG is an implementation of True Random
Number Generator based on quantization error of ADC of STM32F103.
It is basically intended to be used as a part of Gnuk, but we also
have standalone USB CDC-ACM version (you can get random stream from
it's more when connected to USB 2.0 Hub.
The output is tested NIST STS 2.1.1 and Dieharder 3.31.1.
Highlights are:
* Replacement of kernel (thread library)
  Instead of ChibiOS/RT, we now use Chopstx.
* Improved performance
  The output of random numbers got faster than the previous
  implementation by 30% or so.
* Unsupported targets
  CQ_STARM, STBEE, STBEE Mini, and STM32_PRIMER2 are not
  supported in this release, but porting should be easy.
Here are some links for NeuG, Gnuk and FST-01 (the hardware).
NeuG (under Gnuk Repository):
    Gnuk News:
    FST-01 introduction:
    FST-01 Q&A site:
    Japanese Documentation for FST-01 and Gnuk Token:
    cryptography mailing list

@_date: 2013-08-20 12:07:55
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
... plugging it in when your service provider is in Belgium and you're in
Canada is going to be problematic for starters.
cryptography mailing list

@_date: 2013-08-20 06:45:23
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
"The standard way to do things"?  Or "a standard CSPRNG" (continually seeded cryptography mailing list

@_date: 2013-08-20 01:00:50
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
A friend of mine looked at this a while back using the pretty simple technique
of drawing a scatter plot from the samples.  The output of most disconnected
audio inputs is a long, long way from random, and in particular if they mute
on lack of input or have at least a modicum of noise filtering, you just get a
run of zeroes.
Huge amounts of theory, no actual measurement of what you're getting from the
raw data as far as I can see.  The very, very brief "Actual Measurement
Results" involved running Maurer's test on the hashed output of the generator.
Sound cards are useful as a general "mix in it regardless because it can't
hurt" source, but you'd never want to use them as your single point of failure
cryptography mailing list

@_date: 2013-08-20 00:46:42
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
You can get them for as little as $50 in the form of USB-key media players
running Android.  Or if you really insist on doing the whole thing yourself,
get something like an EA-XPR-003 ($29 in single-unit quantities from Digikey,
 and
solder on a zener diode and a few I2C environmental sensors for
noise/unpredictability generation.
I don't see what the point is though, given that there's more than enough
noisy data available on a general-purpose PC.
cryptography mailing list

@_date: 2013-08-18 01:47:32
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
And there's the problem, he used a D20 so there's a bias in the results.  If he'd used a D16 like this one,  then there wouldn't be a problem.  I keep 8D16 on my desk for just this purpose, two rolls and I've got an AES key.
cryptography mailing list

@_date: 2013-08-17 07:57:34
@_author: Peter Gutmann 
@_subject: Re: [cryptography] urandom vs random 
The problem isn't the API, it's the fact that you've got two mutually
exclusive requirements, the security geeks want the (P)RNG to block until
enough entropy is available, everyone else wants execution to continue without
being blocked.  In other words a failure of security is preferred to a failure
of functionality.  Until you resolve that conflict, no API (re)design is going
to help you.
cryptography mailing list

@_date: 2013-08-27 00:28:54
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Implementations, attacks on DHTs, Mix Nets? 
For people who are interested, the list I have (for a year or two back) is:
"Security Considerations for Peer-to-Peer Distributed Hash Tables", Emil Sit
and Robert Morris, Proceedings of the 1st International Workshop on Peer-to-
Peer Systems (IPTPS'01), Springer-Verlag LNCS No.2429, March 2002, p.261.
"A Survey of Peer-to-Peer Security Issues", Dan Wallach, Proceedings of the
2002 International Symposium on Software Security (ISSS'02), Springer-Verlag
LNCS No.2609, November 2002, p.42.
"Eclipse Attacks on Overlay Networks: Threats and Defenses", Atul Singh,
Tsuen-Wan Ngan, Peter Druschel and Dan Wallach, Proceedings of the 25th
International Conference on Computer Communications (INFOCOM'06), April 2006,
"The Index Poisoning Attack in P2P File Sharing Systems", Jian Liang, Naoum
Naoumov and Keith Ross, Proceedings of the 25th Conference on Computer
Communications (INFOCOM'06), April 2006,
"Conducting and Optimizing Eclipse Attacks in the Kad Peer-to-Peer Network",
Michael Kohnen, Mike Leske and Erwin Rathgeb, Proceedings of the 8th IFIP-TC 6
Networking Conference (Networking'09), Springer-Verlag LNCS No.5550, May 2009,
"Combating Index Poisoning in P2P File Sharing", Lingli Deng, Yeping He and
Ziyao Xu, Proceedings of the 3rd Conference and Workshops on Advances in
Information Security and Assurance (ISA'09), Springer-Verlag LNCS No.5576,
June 2009, p.358.
"Hashing it out in public: Common failure modes of DHT-based anonymity
schemes", Andrew Tran, Nicholas Hopper and Yongdae Kim, Proceedings of the 8th
Workshop on Privacy in the Electronic Society (WPES'09), November 2009, p.71.
"Poisoning the Kad Network", Thomas Locher, David Mysicka, Stefan Schmid and
Roger Wattenhofer, Proceedings of the 11th International Conference on
Distributed Computing and Networking (ICDCN'10), Springer-Verlag LNCS No.5935,
January 2010, p.195.
If there's anything significant I've missed, feel free to fill in the gaps.
The cryptography mailing list

@_date: 2013-08-15 00:49:16
@_author: Peter Gutmann 
@_subject: Re: Switching power supplies 
Another thing about switchmode design is that unless it's pretty simple,
you're better off outsourcing it (meaning, get a pre-built one).  Back when
all you needed was a 78S40 and a few capacitors, resistors, and inductors it
was simple enough, but nowadays you can get a high-efficiency (90+% rather
than ~70%, look for one advertised as efficiency class V), over-voltage, over-
current, short-circuit protected power supply module for less than the cost of
the parts, it's really not worth doing yourself unless you need something
particularly exotic.
Cypherpunks assemble systems out of existing modules that someone else has
spent the time to develop and tune.

@_date: 2013-08-18 07:59:26
@_author: Peter Gutmann 
@_subject: Re: see something, say something stamps 
On the remote chance that they'd even notice it, and the equally remote chance
that they'd bother threatening legal action, all you'd need to do is send a
link to the Wikipedia article on Streisand Effect and they'd go back to
pretending they didn't see it.
In any case since it's use in this case is for satirical purposes (IANAL), it
may be OK anyway.  I just want to get it on a t-shirt.

@_date: 2013-09-22 09:40:53
@_author: Peter Gutmann 
@_subject: Re: [coreboot] [liberationtech] Fwd: Firefox OS with built in support for OpenPGP encryption 
Eugen Leitl  forwarded:
Cute, but at $200 you'd have to really, really want the FOSS firmware.  Even
the PCEngines boards (also with FOSS, or at least non-commercial firmware) are
half that price, and if you're happy with a generic x86 with non-FOSS firmware
you can buy any number of barebones SFF boards for much less.

@_date: 2013-09-06 22:51:11
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Opening Discussion: Speculation on "BULLRUN" 
How does '(a) Organizations and Conferences' differ from SOP for these sorts
of things?
The cryptography mailing list

@_date: 2013-09-06 02:01:31
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Opening Discussion: Speculation on "BULLRUN" 
It's not just randomness, it's problems with DLP-based crypto in general.  For
example there's the scary tendency of DLP-based ops to leak the private key
(or at least key bits) if you get even the tiniest thing wrong.  For example
if you follow DSA's:
  k = G(t,KKEY) mod q
then you've leaked your x after a series of signatures, so you need to know that you generate a large-than-required value before reducing mod q.  The whole DLP family is just incredibly brittle.
That's assuming that the threat is cryptanalysis rather than bypass.  Why
bother breaking even 1024-bit RSA when you can bypass?
The cryptography mailing list

@_date: 2013-09-06 01:50:54
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Opening Discussion: Speculation on "BULLRUN" 
I think you're ascribing way too much of the usual standards committee
crapification effect to enemy action.  For example I've had an RFC draft for a
trivial (half a dozen lines of code) fix for a decade of oracle attacks and
whatnot on TLS sitting there for ages now and can't get the TLS WG chairs to
move on it (it's already present in several implementations because it's so
simple, but without a published RFC no-one wants to come out and commit to
it).  Does that make them NSA plants?  There's drafts for one or two more
fairly basic fixes to significant problems from other people that get stalled
forever, while the draft for adding sound effects to the TLS key exchange gets
fast-tracked.  It's just what standards committees do.
(If anyone knows of a way of breaking the logjam with TLS, let me know).
The cryptography mailing list

@_date: 2013-09-06 01:28:10
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Opening Discussion: Speculation on "BULLRUN" 
Not informed since I don't work for them, but a connect-the-dots:
1. ECDSA/ECDH (and DLP algorithms in general) are incredibly brittle unless
   you get everything absolutely perfectly right.
2. The NSA has been pushing awfully hard to get everyone to switch to
   ECDSA/ECDH.
Wasn't Suite B promulgated in the 2005-2006 period?
Peter (who choses RSA over ECC any time, follow a few basic rules and you're
       safe with RSA while ECC is vulnerable to all manner of attacks,
       including many yet to be discovered).
The cryptography mailing list

@_date: 2013-09-25 11:59:50
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA equivalent key length/strength 
Something that can "sign a new RSA-2048 sub-certificate" is called a CA.  For a browser, it'll have to be a trusted CA.  What I was asking you to explain is how the browsers are going to deal with over half a billion (source: Netcraft web server survey) new CAs in the ecosystem when "websites sign a new RSA-2048 The cryptography mailing list

@_date: 2013-09-24 04:27:58
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA equivalent key length/strength 
... and I guess that puts you firmly in the theoretical/impractical camp.
Would you care to explain how this is going to work within the TLS protocol?
It's easy enough to throw out these hypothetical what-if's (gimme ten minutes
and I'll dream up half a dozen more, all of them theoretically OK, none of
them feasible), but they need to actually be deployable in the real world, and
that's what's constraining the current debate.
The cryptography mailing list

@_date: 2013-09-23 08:47:45
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA equivalent key length/strength 
That's rather misrepresenting the situation.  It's a debate between two
groups, the security practitioners, "we'd like a PFS solution as soon as we
can, and given currently-deployed infrastructure DH-1024 seems to be the best
bet", and the theoreticians, "only a theoretically perfect solution is
acceptable, even if it takes us forever to get it".
(You can guess from that which side I'm on).
The cryptography mailing list

@_date: 2013-09-22 13:01:29
@_author: Peter Gutmann 
@_subject: Re: [cryptography] [Cryptography] RSA equivalent key length/strength 
You're assuming that someone got passed a suitcase full of cash and that was it.  Far more likely that RSA got a $10M contract for some government work and at some point that included a request to make the ECDRBG the default for .  All quite above board, nothing terribly suspicious to raise eyebrows.
cryptography mailing list

@_date: 2013-09-25 23:09:46
@_author: Peter Gutmann 
@_subject: Re: [cryptography] The Compromised Internet 
The threat of people saying "we'll just throw some cryptography at it and then
all our problems will be solved".

@_date: 2013-09-25 23:09:46
@_author: Peter Gutmann 
@_subject: Re: [cryptography] The Compromised Internet 
The threat of people saying "we'll just throw some cryptography at it and then
all our problems will be solved".
cryptography mailing list

@_date: 2013-09-06 01:42:47
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Implementations, attacks on DHTs, Mix Nets? 
[Apparently a pile of my mail got dropped, the following few messages are re-sends]
And that's the problem with DNS, it's the only global distributed database
that we've got, so everyone wants to use it as the universal substrate for,
well, anything.  We'd just need to get draft-ietf-dnsind-kitchen-sink-02.txt
adopted and people could cram anything they liked into the DNS.
The cryptography mailing list

@_date: 2013-09-06 01:44:11
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] NSA and cryptanalysis 
If I had to bet, I'd bet on anything but the crypto.  Why attack when you can
bypass [1].
[1] From Shamir's Law [2], "crypto is bypassed, not penetrated".
[2] Well I'm going to call it a law, because it deserves to be.
[3] This is a recursive footnote [3].
The cryptography mailing list

@_date: 2013-09-12 07:03:58
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Why prefer symmetric crypto over public key crypto? 
Was that the change that was required by FIPS 140, or a different vuln?
The cryptography mailing list

@_date: 2013-09-29 08:06:57
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA recommends against use of its own products. 
At least some X.500/LDAP folks thought they could do it.  Mind you, we're
talking about people who believe in X.500/LDAP here...
The cryptography mailing list

@_date: 2013-09-25 23:32:50
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA recommends against use of its own products. 
Software Defaults as De Facto Regulation: The Case of Wireless APs, Rajiv
Shah and Christian Sandvig, Proceedings of the 33rd Research Conference on
Communication, Information and Internet Policy (TPRC07), September 2005,
reprinted in Information, Communication, and Society, Vol.11, No.1 (February
2008), p.25.

@_date: 2013-09-25 23:18:08
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] RSA recommends against use of its own products. 
+1.  It's the Vinny Gambini effect (from the film My Cousin Vinny):
  Judge Haller: Mr. Gambini, didn't I tell you that the next time you appear
  Vinny: You were serious about dat? And it's not just Dual-EC-DRBG that triggers the "You were serious about dat?" response, there are a number of bits of security protocols where I've been... distinctly surprised that anyone would actually do what the spec said.
(Having said that, I've also occasionally been pleasantly surprised when, by unanimous unspoken consensus among implementers, everyone ignored the spec and did the right thing).
The cryptography mailing list

@_date: 2013-10-09 12:22:45
@_author: Peter Gutmann 
@_subject: Re: NSA UTAH data center 
For people wanting more information, the Domestic Surveillance Directorate web
site ("The men and women who work for the Domestic Surveillance Directorate
are Americans first, last, and always. Each employee is required to take a
solemn oath to support and defend the United States against all enemies,
especially domestic") has the details:
Peter :-).

@_date: 2013-10-04 07:52:28
@_author: Peter Gutmann 
@_subject: Re: [cryptography] the spell is broken 
Absolutely.  The one downside is that you then need to decide what the OTS is
going to be.  For example Mozilla (at least via Firefox) seems to think it
involves Camellia (!!!?!!?).
One way to deal with this that got discussed some time ago over dinner (dining geeks, not cryptographers) is to swap at random among a small number of probably-OK suites and/or algorithms, a sort of probabilistic-security defence against the OTS having a problem.  It's not like there's a shortage of them in... well, SSH, SSL/TLS, PGP, S/MIME, etc, anything really.
cryptography mailing list

@_date: 2013-10-04 00:15:48
@_author: Peter Gutmann 
@_subject: Re: [cryptography] the spell is broken 
Just as a bit of a counterpoint here, how far do you want to go down this
rathole?  Someone recently pointed me to the latest CERT vuln. summary
(because of a few interesting entries there):
Now this is just a single weeks' worth, and yet look at all the remote-code-
execution and seize-control-of-device issues in just that seven-day stretch.
The NSA doesn't really need to backdoor crypto when the barn door isn't just
propped wide open, it's entirely missing in some cases.
(I completely support Jon's position in terms of being seen to do the right
thing, but there are more things to worry about than just backdoored crypto).
cryptography mailing list

@_date: 2013-10-23 03:00:01
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] [RNG] on RNGs, VM state, rollback, etc. 
Well, you can get easy-to-install interfaces like this one:
that anyone can plug in in a few seconds, but it's a bit of a one-shot affair
in terms of sampling the 50Hz signal.
The cryptography mailing list

@_date: 2013-10-30 04:14:55
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] [RNG] /dev/random initialisation 
Yes, they won't let you feed in additional entropy.  In my case I managed to
get around it through some code subterfuge (they think they got what they
asked for and I know it was actually done right, not the way they wanted), but
it wouldn't surprise me if other implementers just threw up their hands and
did what the labs wanted.
The cryptography mailing list

@_date: 2013-10-03 10:18:37
@_author: Peter Gutmann 
@_subject: Re: USB Block Erupters as RNG sources? 
"Very little", and "no".  They're basically custom Bitcoin-mining ASICs, I
looked at one a while back for use in password-cracking and they're really not
suited for it at all, you load a vector in and say "go" but since they're
quite I/O-limited you can't easily adapt them for hash-breaking.  As for RNG
use, they're entirely deterministic, how would you use them as an RNG source?

@_date: 2013-10-25 03:14:13
@_author: Peter Gutmann 
@_subject: Re: True necessity of Records? [was: CryptoSeal] 
I got the same response from talking to techies at a large telco, they kept
the records just in case they needed them (not for any specific LEO use, but
just in case they needed the info at some point in the future), and because it
was easier to keep them than to delete them.  In other words, throwing a few
more drives into a server farm was relatively straightforward compared to
figuring out what to delete, when, under what conditions, and how (lots of
different formats, data all over the place, etc).
(This issue isn't unique to telcos, it seems to be near-universal, it's always
easier to keep data lying around than to figure out what to delete).

@_date: 2013-11-06 23:44:58
@_author: Peter Gutmann 
@_subject: Re: latest Snowden docs show NSA intercepts all Google and Yahoo DC-to-DC traffic 
"Hi, my name's Bob, and I'm a villager".
I wonder if there's time to get custom Werewolf cards made up for the upcoming
Kiwicon (which starts tomorrow,  werewolves -> NSA,
seer -> Snowden, healer -> EFF.

@_date: 2013-11-11 23:28:04
@_author: Peter Gutmann 
@_subject: Re: [cryptography] NIST Randomness Beacon 
You could do it with a physical one-way function.  Take a photo of the victim
on top of the WTC and you know that it can't have been occurred after 9/11. To
generalise it, photograph the victim in front of some documented object and
then destroy the object.  I'm assuming in the movie-plot scenario that someone
who's kidnapped a victim won't worry about blowing up a statue in a park or
performing whatever the physical one-way operation is.  Depending on how evil
your movie-plot villain is (and how convoluted the plot will get), he/she
could kill random strangers after photographing them with the victim, in order
to fix a point in time.

@_date: 2013-11-11 23:28:04
@_author: Peter Gutmann 
@_subject: Re: [cryptography] NIST Randomness Beacon 
You could do it with a physical one-way function.  Take a photo of the victim
on top of the WTC and you know that it can't have been occurred after 9/11. To
generalise it, photograph the victim in front of some documented object and
then destroy the object.  I'm assuming in the movie-plot scenario that someone
who's kidnapped a victim won't worry about blowing up a statue in a park or
performing whatever the physical one-way operation is.  Depending on how evil
your movie-plot villain is (and how convoluted the plot will get), he/she
could kill random strangers after photographing them with the victim, in order
to fix a point in time.

@_date: 2013-12-21 20:58:49
@_author: Peter Gutmann 
@_subject: Re: soft backdoors: ECDSA vs RSA vs EdDSA (aka EC Schnorr) (Re: BlueHat v13 crypto talks - request f 
It wasn't "some people", it was almost every implementation at the time.  When
the standard very clearly says "do, X, Y, Z" then everyone sits down and
implements X, Y, and Z exactly as written (well, except for professional
paranoids who build in extra safety margins :-).  So if it was deliberately
weakened then it was a very successful weakening.

@_date: 2013-12-17 05:23:43
@_author: Peter Gutmann 
@_subject: Re: BlueHat v13 crypto talks - request for leaks ;) 
Yes, this is one of several variations of subtle leak-the-private-key issues,
rather than the standard obvious-leak-the-private-key.  The code comment I've
got has, alongside other observations:
           The best reference for this is            probably "The Insecurity of the Digital Signature Algorithm with            Partially Known Nonces" by Phong Nguyen and Igor Shparlinski or            more recently Serge Vaudenay's "Evaluation Report on DSA"
Then there's tricks like:
   Suppose that the
   certificate contains a copy of the certificate signer's DSA parameters,
   and the verifier of the certificate has a copy of the signer's public key
   but not the signer's DSA parameters (which are shared with other keys).
   If the verifier uses the DSA parameters from the certificate along with
   the signer's public key to verify the signature on the certificate, then
   an attacker can create bogus certificates by choosing a random u and
   finding its inverse v modulo q (uv is congruent to 1 modulo q).  Then
   take the certificate signer's public key g^x and compute g' = (g^x)^u.
   Then g'^v = g^x.  Using the DSA parameters p, q, g', the signer's public
   key corresponds to the private key v, which the attacker knows.  The
   attacker can then create a bogus certificate, put parameters (p, q, g')
   in it, and sign it with the DSA private key v to create an apparently
   valid certificate.  This works with the DSA OID that makes p, q, and g
   unauthenticated public parameters and y the public key, but not the one
   that makes p, q, g, and y the public key
That's not leaking the private key, but it allows signature forgery via
another mechanism that's totally unrelated to "was the fundamental DSA
algorithm implemented correctly".  As I said, the DLP algorithms are really,
really brittle, you have to worry about all sorts of things that aren't a
concern with RSA.

@_date: 2013-12-02 19:54:40
@_author: Peter Gutmann 
@_subject: Re: NSA: The Game 
Yep, that would work too, I'll add it as an option.  Also, when it was playtested here some folks found it easier to identify as the more traditional "villagers" rather than "Internet users", although I think it should really be "Internet users".
I'll be in San Jose on the weekend of the 14th if anyone wants to play a round or two of NSA.

@_date: 2013-12-02 09:34:54
@_author: Peter Gutmann 
@_subject: NSA: The Game 
For those of you familiar with the game Werewolf (also known as Mafia), here's
an updated version, NSA.

@_date: 2013-12-14 19:51:07
@_author: Peter Gutmann 
@_subject: Re: BlueHat v13 crypto talks - request for leaks ;) 
ECC however has the downside that it's incredibly brittle.  For example
there's the scary tendency of DLP-based ops to leak the private key (or at
least key bits) if you get even the tiniest thing wrong.  For example if you
follow DSA's:
  k = G(t,KKEY) mod q
then you've leaked your x after a series of signatures, so you need to know that you generate a large-than-required value before reducing mod q.  The whole DLP family is just incredibly brittle, a problem that RSA doesn't have. I'm much more comfortable with RSA, there's far fewer things that can go

@_date: 2014-01-11 01:38:25
@_author: Peter Gutmann 
@_subject: Re: ECC curves that are safe safecurves.cr.yp.to 
Some of their objections seem pretty subjective though, I mean they don't like
the Brainpool curves because of:
  Several unexplained decisions: Why SHA-1 instead of, e.g., RIPEMD-160 or
  SHA-256? Why use 160 bits of hash input independently of the curve size? Why
  pi and e instead of, e.g., sqrt(2) and sqrt(3)? Why handle separate key
  sizes by more digits of pi and e instead of hash derivation? Why counter
  mode instead of, e.g., OFB? Why use overlapping counters for A and B
  (producing the repeated 26DC5C6CE94A4B44F330B5D9)? Why not derive separate
  seeds for A and B?
Is that really a big deal?  SHA-1 vs. RIPEMD-160.

@_date: 2014-01-16 12:22:40
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Boing Boing pushing an RSA Conference boycott 
Since when was 3DES a broken construct?  In fact in the early-mid 2000's there
were several papers published that made AES look a bit shaky (none of the
attacks were developed much further, but we didn't know that at the time), so
sticking to 3DES, with its extra quarter century of provenance, was a
perfectly sensible move.  Even now, it's unlikely that any algorithm has
received as much attention and analysis as 3DES.
The cryptography mailing list

@_date: 2014-01-20 04:04:44
@_author: Peter Gutmann 
@_subject: Re: cypherpunks and hackers who dont code? 
Naah, it'd be displayed as a VU-meter style 10-LED display.  When you boot it,
all ten LEDs slowly light up as the boot progresses.  Then when you go online,
the 11th LED superglued onto the end of the other ten lights up as well.

@_date: 2014-01-20 06:51:32
@_author: Peter Gutmann 
@_subject: Re: Fwd: [tor-talk] giving up pseudonymity after collecting experiences with pseudonymous project de 
His ideas are intriguing to you and you wish to subscribe to his newsletter?

@_date: 2014-02-13 02:42:10
@_author: Peter Gutmann 
@_subject: Re: Snowden and Compilers 
It was demonstrated well before then, Arrigo Triulzi had demonstrated running an SSH server inside a NIC several years earlier.

@_date: 2014-02-26 02:47:39
@_author: Peter Gutmann 
@_subject: Re: Gox 
What would they be prosecuted for, not storing the tulip bulbs under dry
enough conditions?  It's not as if they violated any banking regulations.

@_date: 2014-02-28 00:57:39
@_author: Peter Gutmann 
@_subject: Re: Red Pike cipher 
The interest isn't in any comparison with AES, it's that Red Pike is a classified GCHQ-designed cipher from the crypto wars. The code matches the description by Ross Anderson and Markus Kuhn, but if it's non-genuine then it could just have been implemented to make sure that it matches the description.  It looks like a tweaked TEA-like cipher.  If it is genuine and it's from GCHQ, maybe it's EnglishBreakfastTEA.

@_date: 2014-03-13 22:55:11
@_author: Peter Gutmann 
@_subject: Re: [cryptography] 2010 TAO QUANTUMINSERT trial against 300 (hard) targets 
This is relatively easy for home routers, since the self-signed certs they're
configured with are frequently CA certs.  In other words they ship from the
factory in a MITM-ready state.

@_date: 2014-03-13 22:55:11
@_author: Peter Gutmann 
@_subject: Re: [cryptography] 2010 TAO QUANTUMINSERT trial against 300 (hard) targets 
This is relatively easy for home routers, since the self-signed certs they're
configured with are frequently CA certs.  In other words they ship from the
factory in a MITM-ready state.
cryptography mailing list

@_date: 2014-03-19 23:31:11
@_author: Peter Gutmann 
@_subject: Re: SHA-7 crypto patented by Italian Postal Service 
Is there any indication of what this SHA-7 is?  Before I pass judgement I'd
like to see a document from a technical writer rather than a generic press
release that potentially mangles beyond recognition what they've actually

@_date: 2014-03-25 01:11:10
@_author: Peter Gutmann 
@_subject: Re: "Whew, wondered where we'd put those 200,000 BTC!" 
This was a software guy (quoting what he knew about some of the special
hardware features), so he didn't go into that much detail on this sort of
thing, but in any case it's problem that's been (mostly) solved for decades,
just look for discussions of high-availability systems ( is one good starting
It's not for nothing that, for example, Tandems are sold under the name
NonStop (they're covered in a case study in the book referenced above).  I was
in a Tandem shop some years ago when it experienced a rapid sequence of power
glitches.  The mass of IT gear in the building needed everything from a reboot
to a reinstall to hardware replacement to get working again.  One of their
techies took me into the mainframe room to the Tandem console, which had a
series of reports "Power lost / Power restored / Power lost / ...".  Apart
from that there had been no effect.
There's a story that during the Loma Prieta earthquake a data centre
containing a Tandem machine was damaged in the quake.  It continued running,
lying on its side surrounded by debris, until they could bring in heavy
equipment to push it upright again.

@_date: 2014-03-24 01:47:16
@_author: Peter Gutmann 
@_subject: Re: "Whew, wondered where we'd put those 200,000 BTC!" 
Absolutely.  Some time ago I had a long chat with someone who worked on large-
scale financial processing systems.  Among other things his organisation tends
to act as a stress test for any hardware or software they use since they push
it beyond what anyone else ever manages (and no, it's not HFT, just standard
banking clearing).  Their prime directive is that financial value can never be
created or destroyed, so you can never have a situation in which a failure
anywhere will result in one blob of financial value being recorded in two
locations, or no locations.  Saying that you'll address this by rolling back
transactions won't fly both because no standard database can handle the load
they work at, and because the financial world isn't going to stop and wait
while you perform a rollback.
To give some examples of what this entails, they only use the outer sets of
tracks on their disk arrays to maximise data throughput/minimise head
movement, if they were to use the entire platter the system couldn't keep up.
Cacheing doesn't help, they did try it with the most exotic cacheing
technology that EMC could provide them and found that after X hours throughput
dropped to a fraction of what it had been.  Although EMC had simulated this
situation they never expected that anyone would be able to do it in real life.
They also managed to figure out the computing power of a USG agency using a
certain type of architecture because, when they wanted to buy the entire
production run of a particular just-introduced CPU for several months they
found that an unnamed US customer had already bought six months worth of
production ahead of them.
I think this is about as far from hacking together "some crappy ruby code" as
you can get while still remaining on the same planet.

@_date: 2014-04-23 16:19:30
@_author: Peter Gutmann 
@_subject: Re: Fine grain Cross-VM Attacks on Xen and VMware (AES) 
That's just another proof of the inverse of Law  of the 10 Immutable Laws of
Security, "If a bad guy can persuade you to run his program on your computer,
its not your computer any more".  The inverse is the Immutable Law of Cloud
Computing Security, "If a bad guy can persuade you to run your program on his
computer, its not your program any more".

@_date: 2014-05-29 10:24:57
@_author: Peter Gutmann 
@_subject: Re: is truecrypt =?UTF-8?Q?dead=3F?= 
It's open-source, so there's the presumption of audit, "I couldn't be bothered
looking at it, but since it's open source someone else must have".  The odd
thing is that it's some of the commercial vendors, who are doing it for money
and can pay to have the code checked, for which you have at least some
presumption of audit, but since they're closed-source you're not allowed to
trust them.

@_date: 2014-05-31 01:26:05
@_author: Peter Gutmann 
@_subject: Re: is truecrypt dead? 
The problem is that technically smart people aren't legally smart, and think
that a court/judge can be stymied with a modexp operation.  You can't really
convince them that the law will get at them eventually, no matter how fancy
they make their Rube Goldberg machine.

@_date: 2014-06-08 19:47:20
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Help investigate cell phone snooping by police nationwide 
People can use the material that was left over from when they made the hat.

@_date: 2014-06-08 19:47:20
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Help investigate cell phone snooping by police nationwide 
People can use the material that was left over from when they made the hat.
The cryptography mailing list

@_date: 2014-07-28 04:02:53
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] hard to trust all those root CAs 
This is somewhat difficult to follow, it's a discussion of legal minutiae around a set of amendments to a law? bill?, could you perhaps provide a brief interpretation for us?  Has the result been tested in court?
The cryptography mailing list

@_date: 2014-07-25 04:13:57
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] hard to trust all those root CAs 
Yeah, and the judge and prosecutor who get your case will be helpless before
  your clever skills at evading them, because they've never had to deal with
  literal-minded people trying transparent dodges to get around the law
  before. You will doubtless enjoy the same success as tax protesters do when
  they end up in court.  And shortly thereafter, you'll enjoy an all-expenses-
  paid vacation with free room and board, courtesy of the US government.
This should be preserved somewhere as the standard response to the
Rumpelstiltskin Defence ("you can't prove I'm using crypto/know the keys so
you'll have to let me go").  This perfectly sums up what will happen to anyone
who wants to try the Rumpelstiltskin Defence in court.
The cryptography mailing list

@_date: 2014-09-19 22:58:25
@_author: Peter Gutmann 
@_subject: Re: Fwd: [Cryptography] Shaming sites that send sensitive information over HTTP 
grarpamp  forwarded:
My guess is that it's politically-motivated, if you're the NSA would you want
to buy your certs from a commercial CA, and if you're a commercial CA would
you want to be known as the supplier of trusted certs to the NSA?

@_date: 2014-09-30 02:14:42
@_author: Peter Gutmann 
@_subject: Bitcoin mining ASIC decapped 
In case anyone's interested, this site:
has some photos of what looks like a decapped Bitfury ASIC.  It's a pretty
unique structure...

@_date: 2014-10-28 09:48:50
@_author: Peter Gutmann 
@_subject: Re: CITIZENFOUR (of Pole Dancer Girlfriends etc.) 
There's an even bigger issue that's also still unresolved:
Clearly a disinformation campaign backed by media interests with vast budgets
and government connections.  As the last frame states:
  Who is this guy?  I didn't vote for him.  What influence he exerts over our
  government.

@_date: 2014-10-26 09:38:08
@_author: Peter Gutmann 
@_subject: Re: Time for IETF witch hunt? (was: NSA Co-Chairs of Crypto Forum Research Group, Legitimacy of WebC 
(But then not allowing people to make their preferred crypto fashion statement
would also be removing their freedom to shoot themselves in the foot with a
machine-gun.  In any case as a security researcher I don't know what you're
complaining about, you're getting a guaranteed lifetime supply of material for
future presentations at Defcon/Black Hat/etc).

@_date: 2014-10-27 18:19:38
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Best internet crypto clock: hmmmmm... 
That only applies if the final consumer of the image is a human being.  In
this case it's not human eyeballs that the image is intended for, and the
sensor manufacturers aren't optimising for that target.
The cryptography mailing list

@_date: 2014-10-26 20:57:13
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Best internet crypto clock: hmmmmm... 
There is, however, an ongoing battle between the device manufacturers and
people who use these artefacts, since the manufacturers see them as flaws and
try and eliminate them once they're pointed out.  This makes it really
annoying for people who use them for image-source authentication purposes.
The cryptography mailing list

@_date: 2014-10-09 05:37:55
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Best internet crypto clock 
You don't need a perfectly accurate clock, you just need to track the drift at
the receiving end.  In fact is you can bound the transmission latency (if it's
an online protocol rather than store-and-forward) you don't need a clock at
all on the sending device.
The cryptography mailing list

@_date: 2014-10-08 04:55:41
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Best internet crypto clock 
These already exist, and have been in use for many years:
The cryptography mailing list

@_date: 2014-10-02 07:18:39
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Best Internet crypto clock ? 
Look for work on secure/authenticated audit logs, e.g. google
"cryptographically secure audit logs" (there's an awful lot of material out
there, too much to post individual references to).
The cryptography mailing list

@_date: 2014-10-16 03:55:31
@_author: Peter Gutmann 
@_subject: Re: Crypto mechanics in ios8 and android L 
That bites both ways.  If I can get control of your Android device (which,
given the exploit-like-it's-the-1990s state of security of the whole ecosystem
shouldn't be that hard) then I've MITM'd your net connection, while doing the
same for your router/access point is likely to be a lot harder.

@_date: 2014-10-31 00:37:27
@_author: Peter Gutmann 
@_subject: Re: are USB floppies toxic? 
More generally, search for "charge only usb cable" and you'll find lots
of things like this, e.g:
Something like this, $1.99 including shipping:
is great for carrying around for charging your phone when you're travelling, just mark it in some way so you don't get frustrated when you can't sync your phone with it...

@_date: 2014-11-04 18:41:33
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] $750k Fine for exporting crypto 
That was my feeling too when this was first reported: Someone's being hit with
the crypto-controls universal hammer for something else, either something
they've done or something they're not doing ("we want you to do X for us, it'd
be a real shame if we suddenly found out that one of your products violated
some export control or other").  These things don't just suddenly pop up for
no reason...
The cryptography mailing list

@_date: 2014-12-09 22:05:50
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Toxic Combination 
Ian has already responded to this:
  As you yourself show below, asking for references is a setup for a
  knockdown.
However, let's give this a go.  I've collected them all in one place for
convenience, see:
  I count (well, Word counts) just under five hundred references for the
"Passwords" chapter.  Is that enough?
Now you have to come back and say that that's way too many, and you want just
one.  So I go through them and find some representative paper and forward it
to you.  You glance through it and find some reason why it won't work ("it
suggests using a 24-pixel menu bar but we only have 23 pixels available",
something like that).  So I go through and find another paper.  You come back
to me with some reason why it won't work.  We continue this dance until I get
tired of it and find something better to occupy my time.
As Ian has said, this is a setup for a knockdown.  It's like a religious
fundamenatalist asking "Send me a reference proving to me that God doesn't
exist", the outcome is a foregone conclusion, so the only winning move is not
to play.
In any case you have just under 500 references there, so you can't claim
"cannot point to a single example" any more.
(Incidentally, how many references did you require for certificates being effective in protecting browsers from phishing?).
The cryptography mailing list

@_date: 2014-12-08 11:06:15
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Toxic Combination 
Thanks, that was pretty much what I was going to say.  Just one minor nit:
Actually not quite, the CAB Forum isn't a secret cartel, they're quite public
about what they do, and even have their own web site.
Apart from that I agree with everything you've said.
The cryptography mailing list

@_date: 2014-12-07 03:14:15
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Toxic Combination 
I don't want anyone to design a new globally scalable system, in fact we don't
need any new "system" at all.  I just want to see the current browser strategy
of "hand over the password in plaintext to whoever asks for it" replaced with
"perform password-based mutual challenge/response auth", which short-circuits
the whole phishing equation.  We already have standard mechanisms defined for
this (TLS-PSK, TLS-SRP), they're just not implemented by any browser.
The cryptography mailing list

@_date: 2014-12-04 07:21:39
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Toxic Combination 
You forgot the rest of the list that gets trotted out:
It won't scale, there's no user demand, there's insufficient industry support, I ran out of gas, I had a flat tire, I didn't have enough money for cab fare, my tux didn't come back from the cleaners, an old friend came in from out of town, someone stole my car, there was an earthquake, a terrible flood, There have been endless studies done and papers published on how to do
perfectly usable shared secret-based authentication.  Heck, I devote
significant chunks of my book (draft) to them, I'd be surprised if there were
less than a hundred references to published work on how to do it.
Oh, that's a new one: Set a requirement that can't possibly be met (except
perhaps through the use of magic) and then claim you can't meet that
requirement, therefore it's not worth doing.
Looking past all the excuses, there is one, and only one, reason why no
browser supports proper shared secret-based mutual auth: The browser vendors
don't want to do it.  Meanwhile they're busy implementing more mission-
critical stuff like live in-browser video chat via WebRTC, because that's
functionality that everyone has been crying out for for a web browser.
The cryptography mailing list

@_date: 2014-12-03 07:34:20
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] Toxic Combination 
If by "UAs" you mean "browsers" then the answer is "something on the order of
divine intervention".  The browser vendors have to date shown themselves to be
totally resistant to implementing anything that would threaten the CA business
model, so it's unlikely that something like TLS-SRP or TLS-PSK will ever be
The cryptography mailing list

@_date: 2014-12-30 23:59:37
@_author: Peter Gutmann 
@_subject: Re: What the hell can be done with this trinity? 
There's actually a security standard that's supposed to deal with this sort of
thing, FIPS 140 (people who have seen my previous posts about what a waste
of... well, everything FIPS 140 is should see what's coming here :-).  If you
recall the Snowden-provided NSA photos of their people intercepting Cisco gear
in transit and adding supplementary functionality to it:
* The physical seals are applied after it reaches its destination.  You order
  a special "FIPS kit" consisting of (allegedly) tamper-evident stickers that
  you apply to the gear after the NSA has tampered with it.
* Since your $40,000 router doesn't come with the stickers that you need for
  FIPS 140 compliance, you have to order them specially.  No-one bothers (the
  description I got was "in the n years I've been involved with this, I can
  count the number of customers who've done it on the fingers of one hand").
* No-one who works with the gear has any idea what a tampered sticker would
  look like, but in any case they're never checked once applied.
Still, at least there's a government standard for it.

@_date: 2015-01-06 10:17:38
@_author: Peter Gutmann 
@_subject: Re: What the hell can be done with this trinity? 
Uhh, I don't keep records of them, or at least there are mail logs but that's
an awful lot of stuff to cover.  In addition others have commented on it as
well not just me, the best way to find it would be to search the cryptography
list archives for "FIPS 140".

@_date: 2015-01-28 06:37:01
@_author: Peter Gutmann 
@_subject: Re: Barrett Brown 
I dunno, I think the Malcolm Tucker wannabe act from two or three messages ago
was pretty dire.  What makes Malcolm so entertaining is that he's a creative
artist when it comes to swearing ("This is like The Shawshank Redemption, only
with more tunneling through shit and no fucking redemption" or "When I want
your opinion I'll give you the signal, and that signal's me being sectioned
under the mental fucking health act") while the OPs use came across as very
amateurish, no creativity at all, just some boilerplate swearing cobbled
together with rubber bands and matchsticks.  That wouldn't even get a conceded
pass mark for effort, it's a straight F.

@_date: 2015-02-24 05:30:26
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] trojans in the firmware 
There's another summary of the OLPC's use of flash at:
Warning: You probably don't want to read that if you're an OLPC fan...
The cryptography mailing list

@_date: 2015-02-22 23:45:02
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] trojans in the firmware 
Almost.  Its sole use is for very fast "drive erasure", i.e. you change the
key and the data on it becomes inaccessible.  Have a look at this
which describes what Samsung (and others) are doing, in particular slide 18.
The decryption key (DEK) is stored in the drive, and is unlocked using a
password (and "authentication key", AK).  So to decrypt the drive you extract
the encrypted DEK, brute-force the password (AK), and you're in.
In any case though it doesn't protect against an attack that occurs when the
drive is mounted since it looks like an unencrypted drive at that point (and
presumably the AK is hardcoded into a startup script or something similar in
order to survive power outages, so you can grab that if you really need it).
It's actually hard to see what purpose this "encryption" is serving (the
vendors studiously avoid providing a threat model), it doesn't protect live
data, it barely protects data at rest (say if you decide to Fedex the contents
of your data centre across town), the only thing it really does is allow for
fast erasure of contents, and protect against casual snooping of the "buy a
batch of drives on ebay and see what's on them" kind.
So I guess if ebay is your threat, it's good enough.  OTOH a BIOS password set
for the drive will do the same thing.
As a more general response to "what's the point", regulatory compliance ("our
drives were encrypted so we don't have to disclose the 40M credit card breach
from last week"), buzzword-compliance, CYA, it's not a bad idea from a
marketing point of view.

@_date: 2015-02-22 23:45:02
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] trojans in the firmware 
Almost.  Its sole use is for very fast "drive erasure", i.e. you change the
key and the data on it becomes inaccessible.  Have a look at this
which describes what Samsung (and others) are doing, in particular slide 18.
The decryption key (DEK) is stored in the drive, and is unlocked using a
password (and "authentication key", AK).  So to decrypt the drive you extract
the encrypted DEK, brute-force the password (AK), and you're in.
In any case though it doesn't protect against an attack that occurs when the
drive is mounted since it looks like an unencrypted drive at that point (and
presumably the AK is hardcoded into a startup script or something similar in
order to survive power outages, so you can grab that if you really need it).
It's actually hard to see what purpose this "encryption" is serving (the
vendors studiously avoid providing a threat model), it doesn't protect live
data, it barely protects data at rest (say if you decide to Fedex the contents
of your data centre across town), the only thing it really does is allow for
fast erasure of contents, and protect against casual snooping of the "buy a
batch of drives on ebay and see what's on them" kind.
So I guess if ebay is your threat, it's good enough.  OTOH a BIOS password set
for the drive will do the same thing.
As a more general response to "what's the point", regulatory compliance ("our
drives were encrypted so we don't have to disclose the 40M credit card breach
from last week"), buzzword-compliance, CYA, it's not a bad idea from a
marketing point of view.
freebsd-security mailing list
To unsubscribe, send any mail to "freebsd-security-unsubscribe

@_date: 2015-02-22 23:45:02
@_author: Peter Gutmann 
@_subject: Re: [Cryptography] trojans in the firmware 
Almost.  Its sole use is for very fast "drive erasure", i.e. you change the
key and the data on it becomes inaccessible.  Have a look at this
which describes what Samsung (and others) are doing, in particular slide 18.
The decryption key (DEK) is stored in the drive, and is unlocked using a
password (and "authentication key", AK).  So to decrypt the drive you extract
the encrypted DEK, brute-force the password (AK), and you're in.
In any case though it doesn't protect against an attack that occurs when the
drive is mounted since it looks like an unencrypted drive at that point (and
presumably the AK is hardcoded into a startup script or something similar in
order to survive power outages, so you can grab that if you really need it).
It's actually hard to see what purpose this "encryption" is serving (the
vendors studiously avoid providing a threat model), it doesn't protect live
data, it barely protects data at rest (say if you decide to Fedex the contents
of your data centre across town), the only thing it really does is allow for
fast erasure of contents, and protect against casual snooping of the "buy a
batch of drives on ebay and see what's on them" kind.
So I guess if ebay is your threat, it's good enough.  OTOH a BIOS password set
for the drive will do the same thing.
As a more general response to "what's the point", regulatory compliance ("our
drives were encrypted so we don't have to disclose the 40M credit card breach
from last week"), buzzword-compliance, CYA, it's not a bad idea from a
marketing point of view.
The cryptography mailing list

@_date: 2015-02-05 01:30:33
@_author: Peter Gutmann 
@_subject: Re: Re: Tox.im 
This is why we have cryptography, it provides us with a precise mathematical
framework for debating the implications of various paranoid delusions.  No
matter how the gubmint is trying to get you, there's bound to be some
cryptographic pixie dust of some form that you can sprinkle to help you feel

@_date: 2015-02-04 03:39:45
@_author: Peter Gutmann 
@_subject: Re: What the fark is "TFC" 
It's Tennessee Fried Chicken (sometimes known as Tomato Fried Chicken due to
the way it was served), an early, unsuccessful competitor to the more popular
Kentucky Fried Chicken.
HTH, HAND.

@_date: 2015-04-01 06:57:09
@_author: Peter Gutmann 
@_subject: Re: Cryptoanarchist slogan 
That's not such a good idea, because when you swap your state back in again
you can't decrypt it any more and end up with a kernel panic.

@_date: 2015-07-26 09:42:14
@_author: Peter Gutmann 
@_subject: Re: Hackers Remotely Kill a Jeep on the Highway 
You have to be careful with those, the straight USB-dongle ones are going to
be SDR-based, typically the RTL820T meant for DVB-T use (and re-purposed by
half the hacking world for all manner of other things), then you have the USB-
interface ones with more powerful SDRs, and finally you've got purpose-build
spectrum analysers.  Compared to the real thing, you're going to run into
severely limited bandwidth (anything that spreads the signal across a wide
spectrum is going to be difficult to impossible to deal with), and not-so-
spectacular signal handling (there's a reason why the real thing costs
thousands of dollars).
That's not to say that they're no good, just that you need to be aware that
you're getting what you pay for.  If you've got a specific purpose in mind,
check first that whatever you're getting will be able to do the job.  There's
quite a bit of material out there on this, google something like "sdr spectrum
analyzer" to find articles on it.

@_date: 2015-07-24 12:18:01
@_author: Peter Gutmann 
@_subject: RE: Hackers Remotely Kill a Jeep on the Highway 
I remember saying something like "I feel a bit lightheaded; maybe you should
drive..." And suddenly there was a terrible roar all around us and the sky was
full of what looked like huge bats, all swooping and screeching and diving
around the car, which was going about a hundred miles an hour with the top
down. And a voice was screaming: "Holy Jesus! What are these goddamn

@_date: 2015-07-26 23:25:43
@_author: Peter Gutmann 
@_subject: RE: Intercept receivers (was Re: Hackers Remotely Kill a Jeep on the Highway) 
The problem with the HackRF (and other USB-based devices) is the bandwidth of
the USB connection, it's not that the HackRF hardware can't handle it, it's
that you can't get that much data to the PC.
(I have a HackRF - I needed a cheap way to track down some odd RFI issues -
and it's a pretty cool piece of hardware for the money, but, as I mentioned
earlier, you do get what you're paying for.  If I could make a wishlist, it'd
be nice to have a rev.2 with some work done on the front- end...).

@_date: 2015-08-14 05:24:08
@_author: Peter Gutmann 
@_subject: RE: Privacy advocates resign over facial recognition plans 
For procmail users, I've found that:
* ^From: *carimachet
:0 B
* Cari Machet
gets rid of most of it.

@_date: 2015-09-06 11:01:39
@_author: Peter Gutmann 
@_subject: =?Windows-1252?Q?RE:_Hackers_spent_at_least_a_year_spying_on_Mozilla_to_d?= =?Windows-1252?Q?iscover 
Not to mention their plan to deprecate their extension API, which is the only
thing still separating them from actually being Chrome.  It looks like there
could be a race between them naturally driving their market share to zero
before the API-deprecation, or the API-deprecation forcing the issue.
What we'd really need is a reboot of the project to take it back to its roots,
removing layers and layers of accumulated bloat and "features" no-one wants,
run by dedicated developers who actually listen to their users rather than
doing whatever they think is trendy (mostly just cloning Chrome) and forcing
it on their users.  It'd be like Firefox rising anew from the ashes.  They
could call it, oh, I dunno, something like "Phoenix".

@_date: 2015-09-23 04:37:39
@_author: Peter Gutmann 
@_subject: RE: Windows 10 
You're the product, not Windows.  That was the good thing about the old
Microsoft (yes, there were good things about them), they took your money and
left you alone to do whatever you wanted with their software.  Now, like
Google (where you're entirely the product, for sale to anyone with money) and
Apple (where you're still the product, but the sole customer is Apple),
they're turning their customers into the product.
(Not to mention that W10 has moved even further along the path of treating
your PC like a cellphone.  It's possibly the first GUI I've used that was
literally painful to use, the all-white-all-the-time UI theme was like staring
into a lightbox, my eyes hurt after an hour of two of setting up a neighbour's

@_date: 2015-09-06 07:56:07
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
Whose DH?  There are three major users of this on the public Internet, IPsec,
TLS, and SSH, all of which have the server provide the DH values.  MITM'ing
yourself isn't much of an achievement.
I haven't seen anything about this (so far) that doesn't class it as a purely
certificational weakness.  Consider the following equivalent of the flaw, but
for RSA:
  I stand up a TLS server and provision it with a cert where the server-auth
  key has exponent 1.
There is nothing in any spec that I can immediately think of that says that
you have to reject keys with e=1 (e.g. RFC 3447 just says it's "a positive
integer").  Most implementation were quite happy to accept e=1 keys until
maybe two years ago when there was some bad publicity about them which forced
vendors to fix the problem, but before that no-one bothered rejecting such
obviously invalid keys.  Use of e=1 keys was even a documented Windows
"feature" to allow plaintext key export while still being FIPS 140 compliant
This isn't any deliberately-inserted backdoor in the RFC, it's just sloppy
wording.  In any case though if I configure my server with a key I know to be
broken then any problems I encounter are my own fault.
The reductio ad absurdam form of this is that I stand up a TLS server which
serves the private key to anyone that connects to it (or puts it in the SSH
banner, or whatever).  OK, so I've proven that I can backdoor myself.  I can't
see how a third-party attacker can do anything though (for DH, RSA, or just
straight publish-the-key) unless I help them do it.
[0] Where "FIPS" = "Farcical Information Processing Security".

@_date: 2015-09-05 11:45:07
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
You need to go back to the original source of all the DLP stuff, which is DSA
186-3 came along in June 2009, and that in turn points to SP 800-89, which has
a section 4 "Assurance of Domain Parameter Validity".  This one gets really
complicated because you can get the domain parameters from all over the place
(generated yourself, provided for you by a third party, found at the bottom of
a locked filing cabinet stuck in a disused lavatory with a sign on the door
saying 'Beware of the Leopard', ...).
So if you generate them yourself, you're OK.  If you get them from a CA then
you don't need to care because if the CA wants to attack you then they can
just issue a forged cert in your name and don't need to worry about
backdooring the params (in any case using shared params is a bad idea because
they allow forgery of signatures on certificates. Suppose that the certificate
contains a copy of the certificate signer's DSA parameters, and the verifier
of the certificate has a copy of the signer's public key but not the signer's
DSA parameters (which are shared with other keys). If the verifier uses the
DSA parameters from the certificate along with the signer's public key to
verify the signature on the certificate, then an attacker can create bogus
certificates by choosing a random u and finding its inverse v modulo q (uv is
congruent to 1 modulo q).  Then take the certificate signer's public key g^x
and compute g' = (g^x)^u. Then g'^v = g^x.  Using the DSA parameters p, q, g',
the signer's public key corresponds to the private key v, which the attacker
knows.  The attacker can then create a bogus certificate, put parameters (p,
q, g') in it, and sign it with the DSA private key v to create an apparently
valid certificate).
Finally, if you get them from the disused lavatory then you deserve everything
you get^H^H^H^H^H^H^H^HFIPS 186-3 has validation requirements that use the
optional j and seed parameters, but I've never seen them used anywhere so even
though the validation requirements exist, you can't apply them.
The real question though is, why would anyone use parameters they didn't
generate themselves?  All DSA implementations I've seen (apart from some
experimental code from the 1990s, which also encoded the j/seed values)
generate all the parameters themselves, it's not like ECDSA where everyone
ends up using some shared values that a "trusted" external party provides

@_date: 2015-09-03 15:38:23
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
Oh sure, it's definitely broken.  OTOH I'm not sure if it's a deliberate
backdoor, the whole thing is such a bad design to begin with that something
like this is really just the icing on the cake.
It may be worth submitting an erratum to the RFC that mentions the problem,
just in case anyone is actually crazy enough to want to implement this in the

@_date: 2015-09-03 13:42:24
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
That just indicates support for PKCS  DH parameters, not anything else.  In
any case the page also says:
  OpenSSL currently only supports the older PKCS DH, not the newer X9.42 DH.
so that explicitly precludes using it in certs, even if code elsewhere would
support such usage.
I've gone through my (sizeable) cert collection and found a single example of
X9.42 certs, created by a USG contracting company paid to develop the code for
this and dating from 1996.  The certs are signed with a test DSA key, and
contain a number of errors (zero-length fields, the DH key is marked as a CA
signing key, etc).

@_date: 2015-09-03 13:33:48
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
Well, I think the problem will be finding any implementation of this at all,
or at least any that's still around now.
The static DH parameters need to be turned into a certificate by a CA.  I
don't know of any public CA that can issue these.

@_date: 2015-09-03 11:59:11
@_author: Peter Gutmann 
@_subject: RE: Possible crypto backdoor in RFC-2631 Diffie-Hellman Key Agreement Method 
One saving grace about RFC 2631 was that it was pretty much universally
ignored for the reason that it was, well, a pretty stupid way to do things, so
the number of affected implementations would be approximately zero.
(I only know of one, rather minor, vendor who implemented it.  Microsoft
implemented it in receive-only mode solely so that they couldn't be accused of
being non-standards-compliant, but I'd be very surprised if there was anything
still around that supported it.  For starters you'd need to be able to find a
CA that could issue you a DH certificate...).

@_date: 2015-09-08 07:20:41
@_author: Peter Gutmann 
@_subject: RE: Re: Hackers spent at least a year spying on Mozilla to discover Firefox security holes ? and exp 
You forgot the most critical ones, the extensions you need to undo all the
crap that Mozilla have piled onto Firefox since they started on their copy-
everything-Chrome-does spree.  Classic Theme Restorer is the first extension I
load on any new install (even before NoScript), it's now comprehensive enough
that it's probably the only one you need, although Hide Tab Bar With One Tab
is also useful.

@_date: 2015-09-23 02:37:06
@_author: Peter Gutmann 
@_subject: RE: Focusing x-rays 
Ten out of ten for knowing what it was, but minus several million for using
Wikipedia as the reference.

@_date: 2015-10-22 23:12:21
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: State of the art in malware owning human? 
After that, consult "Science and Pseudoscience in Clinical Psychology" on NLP.
Heck, just consult it anyway, it's a great read.

@_date: 2015-10-09 15:25:15
@_author: Peter Gutmann 
@_subject: RE: Introduce randommess in keypress timings 
Wrong entropy source, if you go for Norwegian black metal you get at least
1024 bits of entropy [0].  Having said that, Putin's foreign policy speeches
will get you at least 512 bits of entropy in the same time frame.
[0] From an estimate done at Tons of Rock in Norway in June of this year.

@_date: 2015-11-24 01:31:38
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Yoga class cancelled for "cultural issues" (insufficient awareness by class attendees o 
They're really going for that Poe's Law prize this year aren't they?

@_date: 2015-11-08 02:10:19
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: UK To Ban Crypto In Devices, Email And More 
That's a good point actually.  In my enormous to-read pile I've got "Why
Johnny Still Can't Encrypt", and that's from fifteen years after the original
paper on PGP's unusability was published.  It's scary to think that companies
like Apple have done more to protect us from intrusive government surveillance
than nearly a quarter century of PGP has, because they've made it usable by
the masses.

@_date: 2015-11-07 00:34:29
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: UK To Ban Crypto In Devices, Email And More 
I don't really want to get involved in this debate (who has that much
asbestos?), but wanted to comment on one thing:
You're a townie then?  If it's like NZ, pretty much every farm in the country
has (or had) one or more rifles, typically a .303 because they were cheap and
a .22 for dealing with rabbit infestations (they're mostly useless against
possums, another major plague).  Also, the fact that you don't see them
doesn't say anything about whether they're there or not.  At the time of the
gun grab, a friend of mine who lived in Queensland and was doing some work on
his house found it more or less impossible to buy PVC fittings of particular
sizes and types, the explanation being that the stocks had been drained by
people using them to sequester their firearms.  So they may have managed to
destroy large numbers of firearms, but they also drove large numbers off the
books and underground (literally, in many cases).

@_date: 2015-11-08 08:40:51
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: [FORGED] Re: UK To Ban Crypto In Devices, Email And More 
... and this is pretty much the poster child for why we have so much unusable
crypto today.

@_date: 2015-11-25 02:37:28
@_author: Peter Gutmann 
@_subject: RE: [FORGED] NATO member Turkey just shot down Russian military jet 
If you ignore several centuries of political machinations and outright warfare
then yes, Russia has been pretty friendly to Turkey.
With friends like Putin, who needs enemies...

@_date: 2015-12-16 05:43:34
@_author: Peter Gutmann 
@_subject: RE: [FORGED] US Pres. Cand. Carly Fiorina Comes Out Against Crypto and Privacy 
grarpamp  quotes:
They need to pass an Enabling Act to allow this, a law to remedy the distress
of the people and the nation, followed by a law against treacherous attacks on
the state and government, and maybe another one to safeguard the unity between
government and country.  That would give them all the leeway they need to act.

@_date: 2015-12-02 00:29:25
@_author: Peter Gutmann 
@_subject: RE: The Moral Character of Cryptographic Work 
For those who missed the talk this morning, he's also doing a public lecture
next Wednesday:
Feel free to drop by, and then follow it up with KiwiCon the next day:

@_date: 2016-01-31 15:00:04
@_author: Peter Gutmann 
@_subject: RE: New High School Principal's speech to students. 
Since it came from talk show host Dennis Prager and not any high school
principal, it's unlikely anyone'll get fired over it.

@_date: 2016-02-14 06:18:02
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: Brit spies can legally hack PCs and phones, say Brit spies' overseers 
"It is responsible discretion exercised in the national interest to prevent
 unnecessary disclosure of eminently justifiable procedures in which untimely
 revelation could severely impair public confidence".

@_date: 2016-02-12 04:20:35
@_author: Peter Gutmann 
@_subject: RE: Small codebase as a prerequisite for security 
XKCD is, as usual, most apropos here:
A huge amount of embedded stuff doesn't even have a kernel mode, because its
irrelevant (or, if the hardware does actually support two different modes,
everything is run in the highest-priv'd mode).  Either the system is
robust/secure/reliable or it isn't, whether there's a kernel/user split is

@_date: 2016-02-11 03:00:21
@_author: Peter Gutmann 
@_subject: RE: Small codebase as a prerequisite for security 
That's because you need to add way too much other stuff to them to make them
generally useful.  My favourite quote on this, attributed to Nick Foster, is:
  You know, when you have a program that does something really cool, and you   wrote it from scratch, and it took a significant part of your life, you   grow fond of it. When it's finished, it feels like some kind of amorphous   sculpture that you've created. It has an abstract shape in your head   that's completely independent of its actual purpose. Elegant, simple,   beautiful. Then, only a year later, after making dozens of pragmatic   alterations to suit the people who use it, not only has your Venus-de-
  Milo lost both arms, she also has a giraffe's head sticking out of her   chest and a cherubic penis that squirts colored water into a plastic   bucket. The romance has become so painful that each day you struggle with   an overwhelming urge to smash the fucking thing to pieces with a hammer. You can write pretty good, minimal, very high-assurance code if you follow
something like DO-178B and get people who are a fair way down the ASD
spectrum to work on it, but then you've got something that's hardcoded to
do one thing really well in a tightly-controlled environment, and nothing else.  A lot of the crap out there exists because it has to interact with
a bazillion buggy pieces of hardware and software and support unique
absolutely mission-critical customer requirements that no-one else on earth has.  seL4 makes all of this someone else's problem, while Linux and Windows and whatnot make it their problem.

@_date: 2016-02-15 02:09:37
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Samsung Warns Customers: Watch Your Mouth 
... which can then be reactivated by anyone who walks through the 6.022e23
security holes that come preconfigured in any "smart" TV.
... thus reducing it to a dumb TV.
(Anyone know how long a TV will run like that, without any access to the
constant stream of communication those things want to engage in?).

@_date: 2016-04-07 05:12:11
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Re: [Cryptography] A humble recommendation 
I've seen troopships on fire off the shoulder of Orion.

@_date: 2016-04-24 18:25:37
@_author: Peter Gutmann 
@_subject: RE: Clipper chip datasheet? 
I don't know about docs, but you can buy the devices themselves in bulk:
As Lucky Green recently pointed out to me, the government's previous attempt
at backdooring crypto is now being sold as scrap.

@_date: 2016-05-22 04:53:29
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Fascism, Nazism, Henry Ford's successful sueing of the USGov, money and power - Fwd: A  
I was thinking more the end of the empire, when practically everything was for
sale, incuding the throne itself (Didius Julianus bought it from the
Praetorians).  You had to be careful though, Galba was put in power by the
Praetorians, wouldn't pay them for lack of money (there was a formal name and
process for this, the donativum), and was removed again by them not long
afterwards.  Perhaps a bit like a president failing to favour their biggest
campaign contributors and losing the next election.

@_date: 2016-05-21 07:13:05
@_author: Peter Gutmann 
@_subject: RE: [FORGED] Fascism, Nazism, Henry Ford's successful sueing of the USGov, money and power - Fwd: A  
That was happening at least as far back as ancient Rome.

@_date: 2016-07-04 10:13:40
@_author: Peter Gutmann 
@_subject: RE: [Cryptography] Android Full Disk Encryption Broken - Extracting Qualcomm's KeyMaster Keys 
... which is exactly what was exploited in the 2013 attack, alongside a whole
boatload of other missing defensive features, no DEP, no ASLR, executable
stack, strcpy()s all over the place, it was described at the time as a "hack
like it's 1999" attack.  As I said in the previous post, security is more than
just a fancy name and a lot of marketing, you have to actually make an effort
to make it secure.
Oh, and given that this looks like a repeat of the same flaws from three years
ago, patching your insecure code also helps.

@_date: 2016-07-04 10:09:34
@_author: Peter Gutmann 
@_subject: RE: [Cryptography] Android Full Disk Encryption Broken - Extracting Qualcomm's KeyMaster Keys 
I think a more direct lesson here is that taking a security mechanism that
consists of a bit flag used to tag a block of memory, defining any such tagged
area as secure by executive fiat, and selling it as TrustZone, is no match
for, you know, actually doing real security.  It's not like this hasn't
happened before, in 2013 Motorola cellphones got 0wned via attackers targeting
the insecure TrustZone and attacking from inside that out to the (apparently)
quite secure non-TrustZone code.
