
@_date: 2016-03-27 14:43:42
@_author: 50 kB/s, 100 kB/s 
@_subject: Re: [tor-talk] Traffic shaping attack 
Oskar Wendel:
This is interesting. Could you check other speeds too (50 kB/s, 100 kB/s)?
Thank you for this work. Hopefully, other users will comment on it.
This should not be the case.  has comparable
download speeds, where I easily get 600 kB/s, but cannot see any
interrupts. I conclude it is either that particular HS software
configuration or attack on that particular HS.

@_date: 2016-03-25 15:44:39
@_author: 128 MBytes/sec 
@_subject: Re: [tor-talk] Traffic shaping attack 
I've just subscribed to the list, sorry for late replies.
I'll add few details to this discussion.
krishna e bera:
Roger Dingledine:
I don't know how it is done. One time admin mentioned onionbalance, so he
about it. He didn't tell explicitly he uses it, but I suspect he does.
Admin's words "well over 6 TB of traffic per day" roughly means 80
MBytes/sec is
an average speed. Well, it is less than 1gbit/s (128 MBytes/sec), but it is
still high for the average connection speed.
This onion site has more than 200.000 registered accounts, but it doesn't
how many of them are online at the same time. In fact, the site is popular.
Registration on the site is often disabled. If it is not disabled it requires
invitation code which is not secret but for many users is a problem to find.
Download speed for single file varies from about 100 KBytes/sec to 1
The site supports 6 simultaneous downloads. Total speed of all simultaneous
downloads is about 1 MByte/sec. If 80 MBytes/sec is average speed, about 80
users use it in each time moment.
If "new identity" is used for the site while it is already downloading 6
extra 6 downloads can be launched at the same time. So, 12 will be in total.
When many downloads are active at the same time if one of them stops, most of
others don't. Downloads which are started after "new identity" action are not
"interrupts-correlated" to downloads started before "new identity" action.
Downloads started before "new identity" may be correlated each with other (if
one stops, other stop too), may be not. Correlation of interrupts between
is observed, but it is not so strong to tell about reliably.
This is what HS admin wrote about it:
"I see the same thing, it's mostly to do with server and tor relay load. I
it be better for creating a unique signature than simply looking at the
speed itself."
It is not clear what he means. Is it HS server side or HS client side?
There are two other onion sites which could have high traffic speeds:
I've never seen any regular interrupts with them.
The interrupts for _that_ site we discuss don't happen always, but very
It may be so that if proper circuit is chosen, interrupts are not observed.
I don't have reliable stat to confirm or deny it.
It may be not an attack, but some misconfiguration on server side. HS
admin is
notified about this tor-talk discussion. He could explain better what is
I checked metrics for a long period of time:
Note 5 short downfalls from September of 2015. All of them are decreasing
of the
total speed to 600 Mbits/sec. Are these downtimes of _that_ HS we speak
about? I
don't know. It looks as artificial as "we have only a single Tor HS with the
speed linerly growing with time, while total speed of other HS sites
(about 600
MBits/sec) is almost not changing."
Mike Perry | 20 Mar 23:14 2016:
I don't think we can do much if HS admin doesn't cooperate. Is there some
which can record how speed is varied in Tor circuits?
grarpamp | 20 Mar 23:49 2016:
Yes, link is known. This HS is in your HS list but it is unnamed there.
The HS
requires registration to download, and registration is now closed. So, the
without valid username and password is useless. I could post everything I
from other users, but I doubt it is allowed in tor-talk to mention links to
illegal sites.
coderman | 21 Mar 07:27 2016:
I think HS admin understands it well. This type of sites never lives long.
year is already a very long lifetime.
In this discussion I've read many words about guards. They may be not so
important for this attack as guard mixes traffic of many suspected users.
is important is ISP. If HS is under this modulation attack, any ISP in the
can easily compare statistics of all his Tor users to statistics of HS
interrupts. The more interrupts happen, the more reliable the detection is.
I want be completely wrong in my guess. If I am not wrong, the number of
deanonymized users can be as large as the number of victims of CMU attack.
As it is not the attack on Tor browser, nothing will help.

@_date: 2016-04-18 22:07:26
@_author: about 600 MBits/sec 
@_subject: Re: [tor-talk] Traffic shaping attack 
I'll comment about my previous message:
Recently admin of that service decided to shut it down. He told about
personal reasons like moving to another place where he will be unable to
get stable internet connection to manage his service. Users wrote that
two hours later after this announcement service went down. Onion
service disappeared permanently.
I was right. Check new metrics link:
At the end of March when service went down speed drastically dropped from
1500 MB/s to about 700 MB/s. So, the single onion site consumed 800 MB/s.
