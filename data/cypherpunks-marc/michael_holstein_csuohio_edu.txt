
@_date: 2007-04-27 18:51:28
@_author: Michael Holstein 
@_subject: Re: Tor nodes blocked by e-gold 
(gaak .. make that 759 queries, 709 NXDOMAIN, and 48 that appear somehow .. the rest of what's below is correct).

@_date: 2007-04-27 18:47:03
@_author: Michael Holstein 
@_subject: Re: Tor nodes blocked by e-gold 
Um, in the interest of settling this argument :
grep router cached-routers |grep -v signature |awk -F " " '{print "host "$3".dnsbl.sorbs.net"}' |sh
(most return NXDOMAIN, meaning not listed by SORBS). The ones that do, return the database in which they're listed as the last octet.
       new.spam.dnsbl.sorbs.net    127.0.0.6
    recent.spam.dnsbl.sorbs.net    127.0.0.6
       old.spam.dnsbl.sorbs.net    127.0.0.6
    escalations.dnsbl.sorbs.net    127.0.0.6
        badconf.rhsbl.sorbs.net    127.0.0.11
Of the 887 IPs I have in my cached-routers file, 709 return NXDOMAIN. The others :
0	http.dnsbl.sorbs.net
0	socks.dnsbl.sorbs.net
0	misc.dnsbl.sorbs.net
0	smtp.dnsbl.sorbs.net
2	*.spam.dnsbl.sorbs.net
0	web.dnsbl.sorbs.net
0	block.dnsbl.sorbs.net
0	zombie.dnsbl.sorbs.net
46	dul.dnsbl.sorbs.net
0	badconf.rhsbl.sorbs.net
0	nomail.rhsbl.sorbs.net
So, according to SORBS, they're blacklisted because they're in dynamic IP ranges
Michael Holstein CISSP GCIA
Information Security Administrator
Cleveland State University

@_date: 2007-12-20 19:28:20
@_author: Michael Holstein 
@_subject: Re: another seeming attack on my server's DirPort 
TCP windowing foolishness can be a result of ISP "bandwidth management".

@_date: 2007-12-19 14:11:02
@_author: Michael Holstein 
@_subject: Re: another seeming attack on my server's DirPort 
tweak as desired ... this would permit 1 connection per minute from a given IP. Replace (torDirPort) with whatever TCP port you're serving the DIR on.
iptables -A INPUT -p tcp --dport (torDirPort) -m state --state NEW -m recent --set --name TORdir -j ACCEPT
iptables -A INPUT -p tcp --dport (torDirPort) -m recent --update --seconds 60 --hitcount 1 --rttl --name TORdir -j LOG --log-prefix "TORdir flood"
iptables -A INPUT -p tcp --dport (torDirPort) -m recent --update --seconds 60 --hitcount 1 --rttl --name TORdir -j DROP
(adapted from a SSH bruteforce mitigation rule to do a similar thing..)
Michael Holstein CISSP GCIA
Cleveland State University

@_date: 2008-12-19 18:49:33
@_author: Michael Holstein 
@_subject: Re: UDP and data retention 
I don't see how ..
"tcpdump -s 1514 -w evidence.pcap ip proto \\udp"
is any harder than ..
"tcpdump -s 1514 -w evidence.pcap ip proto \\tcp"
Now I guess you could rig a communications "network" that dealt entirely in header-source forged UDP packets, but as best practices dictate (not the everybody follows them) .. one should filter egress of packets with a source address not within your netblock.
Michael Holstein
Cleveland State University

@_date: 2009-09-17 19:58:50
@_author: Michael Holstein 
@_subject: Re: "I Write Mass Surveillance Software" 
Here's one more link that explains the IXP series architecture
(basically, all the OP on Rededit was saying, was he's the guy that writes the microengine code)  .. the processors themselves aren't capable of realtime brute-force decryption ... but they are the sort of thing that can look for signatures/keywords/etc in a stream and act upon it at wire-speed.
As for breaking encryption, this would be a task better suited for a large farm of purpose-programmed FPGAs, since I'm not aware of any commercially-produced ASIC that does this (although the NSA does list jobs for "semiconductor fabrication", so I'm sure they're in that game).
IIRC the Russians had purpose-built their own ASICs to break DES when it was en-vouge .. I'm sure our side of the pond actively does the same.
Sneakier mice, better mousetraps.
Lather, rinse, repeat.
Michael Holstein
Cleveland State University

@_date: 2009-09-17 19:35:29
@_author: Michael Holstein 
@_subject: Re: "I Write Mass Surveillance Software" 
The mention of "C like" code and the DPI makes me think the hardware uses Intel's IPX series network processors. For those, the ruleset is basically written in C and uploaded to the device.
SANS has a whitepaper on doing Snort IDS with them, a fairly similar application to the above (this is for the 24xx series @ 2.5gbps)
The IXP2800 can do line-rate 10gbps
Michael Holstein
Cleveland State University

@_date: 2009-09-17 19:35:29
@_author: Michael Holstein 
@_subject: Re: "I Write Mass Surveillance Software" 
The mention of "C like" code and the DPI makes me think the hardware uses Intel's IPX series network processors. For those, the ruleset is basically written in C and uploaded to the device.
SANS has a whitepaper on doing Snort IDS with them, a fairly similar application to the above (this is for the 24xx series @ 2.5gbps)
The IXP2800 can do line-rate 10gbps
Michael Holstein
Cleveland State University

@_date: 2011-09-09 00:53:54
@_author: Michael Holstein 
@_subject: Re: [tor-talk] Tor banned in Pakistan. 
Of course .. any number of mechanisms exist to do exactly this, although
(generally speaking) it's not to provide a "live" VPN service. A
constant HTTP stream of nothing but .jpegs would be pretty suspicious.
Video-type services might be a better bet (because the traffic would be
more believable) but if you can't encrypt it, all that's required to
render the stego useless is to (slightly) re-encode it transparently
(eg: take your 640x480 MPEG stream and run it through ffmpeg to lower
the bitrate by 10k or some such).
One would detect this in the same way you do encrypted botnets .. you
stop looking for patterns *in* the traffic and start looking at *traffic
patterns* (ie: "that's odd, why is this machine doing a constant stream
of ICMP all of a sudden? .. what are these long DNS queries for?, why
are the HTTPS traffic ratios fairly symmetrical?" .. etc).
That's the key distinction here .. rather than try to "ban with
technology" (ie: "great firewall of china"), they went for "ban with
policy" .. meaning you'll likely never know if you're "getting away with
it" until the ISI shows up and drags you off.
I suppose a clever service would be for Twitter (et.al.) to allow you to
upload a keypair for stego and a https "twitpic" site that allowed each
image to be checked for a valid signature and stego'd text, which would
then be published.
Michael Holstein
Cleveland State University
tor-talk mailing list
