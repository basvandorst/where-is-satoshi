
@_date: 2015-06-11 04:42:41
@_author: Peter Fairbrother 
@_subject: Re: [Cryptography] Proposed US ITAR changes would require prepublication approval for most crypto re 
Sounds interesting,
They are basically trying to reintroduce the "born secret" principle, which in US law exists only in an unchallenged part of the Atomic Energy Act; though that concept has not been tested against First Amendment rights as the only previous case of note (United States v. The Progressive, 1979) was dropped by the Government before it reached the Supreme Court.
But it's "born again secret" as well as "born secret, again" - it applies to all previous technical data, whether widely disseminated or not.

@_date: 2015-08-19 06:52:56
@_author: Peter Fairbrother 
@_subject: Re: Recommended Movie:  "Sebastian" 1968. 
Not sure that was the one to spill the beans. I thought it was Winterbotham's 1974 book of the same name which first got the idea across to the public; though there was a French book in 1973 as well.
Like Winterbotham's book, which the TV show seems to be based on, it's also a bit confused and/or inaccurate. Much of what they tell - the conversations between Hitler and his generals, "knowing Hitler's most secret thoughts", and Hitler's message re Anzio which Gen Clark read - came from the breaking of the Lorentz SZ40, not the Enigma. Colossus, not Bombe.
And the Coventry story is fiction [1]. Churchill could not have been told the target from ULTRA decrypts. The ULTRA decrypts are now available in public records, and they do not mention Coventry.
[1] My theory: Probably it began as a story made up to impress the need to keep the ULTRA secret - "hey if the man at the door with the revolver who just threatened to shoot you doesn't impress you, Churchill allowed [2] the bombing of Coventry in order to keep the secret".
Later the story became an accusation, then a rumour, then a play - though by the time it became a play it was becoming obvious that ULTRA wasn't involved, and the motive for allowing the bombing changed to "Impressing the Americans" [3].
I can easily imagine someone telling Winterbotham the story (Winterbotham was the one who first told the Coventry story in public).
I can also imagine Winterbotham repeating the story, in confidence, in order to impress the listener with the need to keep the secret (and with W himself) so often that he didn't know whether it was true or not (he didn't claim to be personally involved).
Good story, and Churchill was probably capable of it - but it ain't true.
[2] not that there was anything he could have done to stop the bombing, but for the sake of the narrative ..
[3] requiring an even wilder suspension of belief, IME
Yes - but Leo Marks wasn't involved in that. He ~ stopped being a cryptographer when SOE was broken up at the end of the war.
What he did was hand ciphers, for agents in occupied countries - they couldn't carry cipher machines.
There is nothing else like Between Silk and Cyanide in the crypto literature. Crypto at the cutting edge, where a mistake is a painful death, and likely worse.
More, it is about how a cryptographer and his work interact with the world.
I would not like to have been Leo (I met him once), but hell if I don't respect him.
There is a TV documentary about him, called "A Very British Psycho" - an apt title.

@_date: 2015-08-18 07:50:40
@_author: Peter Fairbrother 
@_subject: Re: Recommended Movie:  "Sebastian" 1968. 
Based on a screenplay by Leo Marks - author of Between Silk and Cyanide: A Codemaker's War 1941-1945.
Essential reading. Leo was the codemaker for SOE. All hand ciphers and He wasn't at Bletchley - who called him "the one who got away" - though, and so no machine ciphers.
The Silk in the title was for OTPs which could be hidden in clothing from Gestapo/SS searches.
As I said, essential reading.

@_date: 2015-09-23 09:51:02
@_author: Peter Fairbrother 
@_subject: Re: Is this crypto paper real or fake? 
Yes, that is a big problem with SSL and TLS.
The desire for backwards compatibility and cipher agility means that the little padlock in the browser doesn't actually mean very much - the suite in use might be so weak as to be no better than unauthenticated More, the average user doesn't usually have a clue what's going on - How secure is the suite in use? Does the suite in use have forward security? Is there any authentication? Is the authentication reliable?  Is there any encryption? Is it actually secure in any way?  - these are questions the average user cannot answer.
Heck, I can't answer them most of the time without digging into the innards of the session.
Backwards compatibility and cipher agility also permit cipher suite choice degradation attacks like FREAK and logjam, where weak suites are forced on the user.
To be secure, cipher agility absolutely requires that weak or broken ciphers can be effectively and definitively eliminated from use - but there is no real mechanism in SSL/TLS for doing that.
One solution is - in TLS3 abolish cipher agility, and have only one suite: call it Jim's suite.
The little padlock in the browser now says "protected by Jim". Everybody now knows what that means, or can find out. The meaning doesn't change according to things going on in the computer which the ordinary guy has no clue about.
After a few years, when Jim's suite is getting a little iffy, introduce Tom's suite in TLS4. Depreciate Jim's suite, then remove it.
People shouldn't really be rewriting libreSSL - they should be writing libreTLS3 instead, with no cipher suite agility.
Apart from anything else, with only one suite and one protocol, that should be a lot easier to do.
ps is there an archive of libreSSL anywhere?

@_date: 2015-09-21 10:58:25
@_author: Peter Fairbrother 
@_subject: Re: Is this crypto paper real or fake? 
Yes. Pwnable.
Yes. Dodgy at best, likely pwnable, either now or soon.
Note, from the Wikipedia page, that in 2002 breaking a 109-bit prime curve took nearly two years, using presumably general purpose hardware.
By 2015 breaking 113 bit prime curves took 84 days on $15k worth of FPGAs.
If specialised hardware chips are developed (and they may well be in the pipeline, or even in use), then following the example of Bitcoin mining, that would become minutes or even seconds.
155 and 160 bit curves would be toast, at $10 million in today's money: and I'd be a little worried about 192-bit curves, especially for long-term security.
Plus, you can do a lot of the math for breaking a curve beforehand, once and only once, just from knowing only the curve details: and these results will be useful for all the points/numbers you might later want to find dlogs for on that curve.
So the second and subsequent dlogs on the same curve will be a whole lot cheaper than the first dlog/break.
Unfortunately, it is impractical to generate a new curve for each transaction; and it is not easy to generate and change curves very often, eg every day.
As a rule of thumb, the prime should be double the size of the security parameter - eg for 128-bit security you should have p = 256 bits or so - hence curve25519 (where p=2^255 - 19) etc.
For real unbreakable [excepting quantum computers] security I would not recommend anything less than 256-bit prime order fields.
In general, the field should be of prime order: extension fields are no longer generally considered secure (but see below).
I'm not a big fan of DJB's curve25519. You can do fast math in it - but then so can an attacker. And what if that extra structure, which allows fast computation, also introduces a weakness?
Wild speculation some would say, and it is - but that's pretty much what happened with extension fields. the extra structure in the field made some otherwise unimportant attacks easier.
I'd prefer a 256-bit prime chosen verifiably at random, with no "special" fast properties, and less exploitable structure.
If your hardware can't cope with that, don't expect whatever crypto you do use to be secure.
There is a fairly new curve from Microsoft, called FourQ (and FourQ to you too, Microsoft! :) which uses an extension field of p=(2^127 -1)^2, ie 254 bits. I won't go into why here, but like extension fields and curve25517, I don't trust it.
Stick to verifiably randomly chosen 256-bit prime field curves.
Be safe. Don't be sorry.

@_date: 2015-09-21 10:58:25
@_author: Peter Fairbrother 
@_subject: Re: Is this crypto paper real or fake? 
Yes. Pwnable.
Yes. Dodgy at best, likely pwnable, either now or soon.
Note, from the Wikipedia page, that in 2002 breaking a 109-bit prime curve took nearly two years, using presumably general purpose hardware.
By 2015 breaking 113 bit prime curves took 84 days on $15k worth of FPGAs.
If specialised hardware chips are developed (and they may well be in the pipeline, or even in use), then following the example of Bitcoin mining, that would become minutes or even seconds.
155 and 160 bit curves would be toast, at $10 million in today's money: and I'd be a little worried about 192-bit curves, especially for long-term security.
Plus, you can do a lot of the math for breaking a curve beforehand, once and only once, just from knowing only the curve details: and these results will be useful for all the points/numbers you might later want to find dlogs for on that curve.
So the second and subsequent dlogs on the same curve will be a whole lot cheaper than the first dlog/break.
Unfortunately, it is impractical to generate a new curve for each transaction; and it is not easy to generate and change curves very often, eg every day.
As a rule of thumb, the prime should be double the size of the security parameter - eg for 128-bit security you should have p = 256 bits or so - hence curve25519 (where p=2^255 - 19) etc.
For real unbreakable [excepting quantum computers] security I would not recommend anything less than 256-bit prime order fields.
In general, the field should be of prime order: extension fields are no longer generally considered secure (but see below).
I'm not a big fan of DJB's curve25519. You can do fast math in it - but then so can an attacker. And what if that extra structure, which allows fast computation, also introduces a weakness?
Wild speculation some would say, and it is - but that's pretty much what happened with extension fields. the extra structure in the field made some otherwise unimportant attacks easier.
I'd prefer a 256-bit prime chosen verifiably at random, with no "special" fast properties, and less exploitable structure.
If your hardware can't cope with that, don't expect whatever crypto you do use to be secure.
There is a fairly new curve from Microsoft, called FourQ (and FourQ to you too, Microsoft! :) which uses an extension field of p=(2^127 -1)^2, ie 254 bits. I won't go into why here, but like extension fields and curve25517, I don't trust it.
Stick to verifiably randomly chosen 256-bit prime field curves.
Be safe. Don't be sorry.

@_date: 2015-09-20 22:26:23
@_author: Peter Fairbrother 
@_subject: Re: Is this crypto paper real or fake? 
Both authors are well-known.
Google says the paper was published in the Journal of Cryptology in 1999.
The present day open ECC dlog record stands at about 114 bits, iirc: that method used ~2014 custom hardware, but not $10 million worth.
I'd guess Oorschot and Wiener got something in the numbers wrong. It However the parallel collision search technique they describe is very real, and has been used to effect. At a guess, the ECC dlog record above probably used it, as will most modern collision search algorithms.
As DJB quoted them, I'd guess that they invented the technique (though I knew of the technique, I thought Knuth described/invented it).
It's one of those things which are obvious in hindsight; but which can be dev'lishly hard to come up with in the first place.

@_date: 2016-05-06 08:57:45
@_author: Peter Fairbrother 
@_subject: Re: Craig Wright suspends campaign to be the 2016 Satoshi Nakamoto 
More evidence? Did he produce any evidence at all (which hadn't been faked)?
People have wondered aloud at his motive, but it isn't difficult - there is even a word for it, pretender.
Besides, apart from being cryptographically only semi-literate and an indifferent coder, he is too Aussie, too young, and too tall to have been Satoshi.

@_date: 2016-07-12 23:17:42
@_author: Peter Fairbrother 
@_subject: Re: The Laws (was the principles) of secure information systems design 
The laws of secure information systems design:
Law 0: It's all about who is in control
Law 1: Someone else is after your data
Law 2: If it isn't there it can't be stolen
Law 3: Only those you trust can betray you
Law 4: Attack methods are many, varied, ever-changing and eternal
Law 5: The entire system is subject to attack
Law 6: A more complex system has more places to attack
Law 7: Openings for good guys are openings for bad guys too
Law 8: Kerckhoffs's Principle rules
Law 9: A system which is hard to use will be abused or unused
law 10: Design for future threats
Law 11: Security is a Boolean
Law 12: People offering the impossible are lying
Law 13: Nothing ever really goes away
Law 15: "Schneier's law c" holds illimitable dominion over all... including these laws
Yes, I especially recognise 1,2, 7-11.
If you don't mind, I might include something with 8 and 9: as-is the "Laws" are a bit too theoretical, and too skewed towards security over I have always regarded the "Principles", soon to be "Laws", as mostly widespread and preexisting, and more of a communal than an individual effort - (revised) two come from Schneier, one from Satoshi, two from Jerry Leichter, several others are just well-known homilies recast - with myself more as an editor and arranger than anything else.
In fact I would like to see them written so as to be applicable to all systems, not just especially secure systems, or systems which have to be But that is even harder...

@_date: 2016-07-12 21:19:04
@_author: Peter Fairbrother 
@_subject: The Laws (was the principles) of secure information systems design 
I've been revising the principles, and came up with this. It's an early As ever, corrections and suggestions are welcome.
Calling them Laws is perhaps a bit overreaching - but on reflection I thought that's mostly what they are, break them and the system won't be I will put the Laws up on the 'net shortly, hopefully with a link for suggestions and comments.
The Laws of secure information systems design:
Law 0: It's all about who is in control
Law 1: Someone else is after your data
Law 2: If it isn't stored it can't be stolen
Law 3: Only those you trust can betray you
Law 4: Attack methods are many, varied, ever-changing and eternal
Law 5: The entire system is subject to attack
Law 6: A more complex system has more places to attack
Law 7: Holes for good guys are holes for bad guys too
Law 8: Kerckhoffs's Principle rulez! - usually...
Law 9: A system which is hard to use will be abused or unused
law 10: Design for future threats
Law 11: Security is a Boolean
Law 12: People offering the impossible are lying
Law 13: Nothing ever really goes away
Law 15: "Schneier's law c" [1] holds illimitable dominion over all... including these laws

@_date: 2016-07-17 15:08:50
@_author: Peter Fairbrother 
@_subject: Re: UK gov says new Home Sec will have powers to ban end-to-end encryption 
Err, how? The bill gives powers to require some backdoors [1], but it
doesn't ban encryption in any form.
Or do you think some types of mandatory backdoors and banning encryption
are the same thing?
[1] The HS doesn't control the backdoors, the "relevant operators" do.
The HS can require "relevant operators" to maintain the capability to
decrypt encryptions which they apply - but it doesn't say anything about
banning encryption which other people apply, or banning encrypted
communications where other people have done the encryption
As for doing the impossible and maintaining the capability to decrypt
encryptions other people have applied, if you can't do it, you can't do
it. There is no need or duty to do the impossible.
You are not *providing* a service. You may well be using one, but you
are not providing one. Therefore you are not a "relevant operator", and
that part of the Bill does not apply to you.
You have to read these things carefully.
You might argue otherwise, that maybe you are providing a service to
yourself. Stranger things have happened, but I very much doubt any  UK
Court would agree with you.
And even if by some dark and unlikely miracle a Court decided you are
providing a service, and are therefore a "relevant operator", what might
happen? The Home Secretary serves a Notice (which she signs with her own
withered hand) on little old you, personally, requiring you to maintain
the capability to decrypt your own comms.
At some later point, after you have returned the Notice for
reconsideration and she has consulted the relevant committees, Judge
etc, and then sent it back to you, she might require you to decrypt some
If you failed to do so because you have not maintained the capacity, she
could then institute civil proceedings for an injunction to make you
maintain that capacity in future.
But she can't send you to jail, or fine you, for having failed to
maintain that capability.
However the last four paragraphs are just fantasy, because you are not
providing a service, and therefore you are not a "relevant operator".
If you don't get it, I think the Bill is ugly, evil, stupid, invasive,
disproportionate and generally sucks big time - but it has fuck all to
do with banning encryption.

@_date: 2016-07-17 15:08:41
@_author: Peter Fairbrother 
@_subject: Re: UK gov says new Home Sec will have powers to ban end-to-end encryption 
Being kind, you might say they put a good face on it. Being more
realistic, they try and mostly succeed in slipping it through with the
nastier parts unnoticed.
That's what they did with RIPA, the previous act.
Oh, and afaict there are no contradictions anywhere in what I have said.
If you think I trust any of them, you are sadly mistaken.
The Lords however are slightly better than the Home Office, who write
the bills and tell their patsies in the Lords and Commons what to say
the bills mean - which is frequently quite different to what they
actually mean.
However I am expert - repeat expert - in reading the actual damn Bills,
and working out what they actually say.
Better than the members of the Lords or Commons, better than the
politicians who tell the Home Office cunts what to put in the Bills,
better than the DPPs who apply them - most of whom don't read the actual
Bills, just summaries, because the Bills are so complicated - and I am
approaching as good as the people who write the damn things.
If I don't go through all the details here it's just because the bills
are so obscure and complex it would take megabytes and days of arguments.
Then you would have to know the general legal framework behind the
wording of a Bill, and the general legal framework of the UK, before
knowing what it meant. And even then you might occasionally be surprised
by a decision, some Judges just make stuff up as they go along, and not
everything which should be appealed is.
But you are welcome to read it yourself, it is available at:

@_date: 2016-07-17 08:28:49
@_author: Peter Fairbrother 
@_subject: Re: UK gov says new Home Sec will have powers to ban end-to-end encryption 
Actually, just finding that in the Bill wasn't easy - and it isn't a single part, it's taken from at least five different places in the Bill. If it seems clear, then I did a good job putting them together.
Thing is, while the Bill isn't good, it doesn't have anything at all to do with banning end-to-end encryption. Or banning any sort of encryption.
It can require "relevant operators" to maintain some backdoors, most obviously in mobile link encryption and some VPNs and other encrypted links which are operated by "relevant operators".
Less obviously, it can be applied to some websites and the like.
But there is no power to ban encryption anywhere in the Bill.
If you as a private person apply the encryption yourself, there is no power in the Bill to make you backdoor it (though there have been powers in RIPA to enforce demands for keys in some circumstances since 2001), and there is no power to prevent you from using encryption.
Yep, we have a brand new female Home Secretary. The old one is now Prime Minister ...
(and she's madder than Mad Maggy Thatcher ever was 8-(
says! Perhaps next week is her bad week of
I was not clear - while the HS can extend the notices to eg include other forms of encryption not applied by "relevant operators", she cannot serve notices on, or force any other obligation on, anyone except "relevant operators".
If you are a private citizen and you aren't providing a service, she can't prevent you from doing any encryption you like, nor can she make you backdoor it.
PGP is okay, and there's not a thing in the Bill which says she can do anything to ban it.
Neither can she stop people using SSL/TLS, or except in the case of some UK-based servers, mandate backdoors in it.
She could in theory serve a notice on Google, Apple or Facebook - but in practice, none of these would actually be obligated to obey it.
err, no - that one is defined in the Bill, she can't change the meaning of "relevant operator".
She can change some of the things she requires "relevant operators" to do - but if you aren't a "relevant operator" she can't require you to do

@_date: 2016-07-16 17:02:57
@_author: Peter Fairbrother 
@_subject: Re: UK gov says new Home Sec will have powers to ban end-to-end encryption 
Things said in the Lords (or Commons), even by Government spokesmen, have approximately zero legal significance. To a very close approximation. Practically speaking, indistinguishable from zero.
What the Courts look at is the wording of the Act.
Which in this case is pretty bad, but not a power to ban end-to-end In fact, it doesn't affect most in-use forms of end-to-end encryption at And it doesn't say anything at all about applying your own encryption.
Details below, if interested.

@_date: 2016-08-26 10:22:47
@_author: Peter Fairbrother 
@_subject: Re: Quantum entangled-photon Chinese satellite. 
As Sean said, this is both possible and done.
Some points here - first, the "signal addition" process may or may not need to be quantum in nature. This depends on signal nature, strength etc, ie a strong multi-photon CW or coherent signal would not need quantum path addition, whereas a weak single-photon-at-a-time signal would need quantum path addition.
If quantum path addition is needed, signals from two mirrors cannot be converted or recorded separately, but must remain in their original quantum state, ie as quasi-photons, until they reach the single detector. In practice this can be done with optical cavities or fibres, but these are very demanding as to precise length, dispersion etc.
Thinking of this as a sum-of-paths problem, there is a potential path through one mirror/fibre, and a potential path through the other. The photon takes both paths - think of the dual slit experiment. If it doesn't take both paths but only goes through one mirror/fibre, then the resolution advantage of the large mirror separation are lost.
Second, the "curse of the sparse array". The % of photons which are detected is reduced from the % which would be captured by a mirror of area a is further reduced by the fraction 2a/A, where A is the area of a filled array of the same dimension as the synthetic aperture. The resulting signal can be very dim.
Because of this signal dimming, and the engineering demands of quantum-path addition hardware, the maximum practical synthetic optical aperture is about 200 meters, though quantum-based synthetic radio apertures up to 20km or so are used.
(vbli, very long baseline interferometry, which operates over thousands of km, is not quantum-path-addition based - it operates on either variations in a noisy signal or on the phase of CW signals, roughly Speculating about the megascope, about which I know nothing either, if it is a simple telescope designed to collect a significant fraction of single photons from a satellite for quantum cryptography purposes then it should be near-filled (no gaps) in order to avoid sparse array dimming problems. This can be done with many medium-large mirrors close to each other.
As to resolution, The Daily Fail gives a distance of 750 miles, or a close-ish LEO. Your 0.00448 arc second telescope would have a resolution of about 1 inch at that distance, which would probably be plenty enough.
However the Fail seems to be talking about something else, a telescope using quantum teleportation - but I don't know what that is.

@_date: 2016-08-06 00:10:36
@_author: Peter Fairbrother 
@_subject: Re: Quantum entangled-photon Chinese satellite. 
It doesn't pass info faster than light, it "generates keys" using a slower-than-light side channel to agree which of two possible perpendicular orientations to test.
You can only test one orientation per photon, that's the physics part, testing in one orientation will destroy all information about its polarisation in a perpendicular orientation - and unless both ends test the same orientations for an entangled pair the test results will not match by spooky action at a distance.
One way to do this, though not very secure, is for both ends to preagree which orientations to test.
They can get the same information at the same, super-relativistic time, but it's a bit like DH, the information they get is random, no classical information is actually passed between ends.
Another method is for both sides to test orientations at random, then choosing pairs for which both ends chose to test the same orientation. This requires an authenticated, but not necessarily secret, side channel between ends.
Unless implemented vary carefully, either version can be mitm'd easily [fsvo "easily"] enough.
The first method can be mitm'd by creating photons with known (but not entangled) polarisations in pairs, if you know the prearranged orientations to create the photons in.
The second method is a little trickier to mitm, but the no-cloning theorem, which states you can't clone an arbitrary unknown quantum state, doesn't actually say that you can't clone a photon without testing it's polarisation in one orientation - it says that, for linear polarisation of entangled photons, you can't do it more than 2/3 of the Then Mallory will get it right by chance half the time when cloning fails, so overall if Mallory tries to clone photons he will get the right result 5 times out of six.
This would roughly mean that the detectors would have to work correctly better than 5/6 of the time to prevent mitm - and single photon detectors which can do that, especially over orbital distances,  are like hen's teeth.
There are statistical methods which can work with less efficient detectors, but then the data rate drops to very slow indeed

@_date: 2016-09-19 22:02:36
@_author: Peter Fairbrother 
@_subject: Re: Permutations to scalars and back again. 
The mapping I described is a fully dense 1:1 bijective mapping between the 9075135300 possible ordered combinations of 18 zeros and 18 ones and the integers 0-9075135299.
If you didn't understand it, please ask, off- or on-list.

@_date: 2016-09-13 20:38:48
@_author: Peter Fairbrother 
@_subject: Re: Permutations to scalars and back again. 
Whether 18 ones and 18 zeros arranged together is a permutation is a bit problematic, and a question I won't go into - but much more relevant, it is a combination.
If you look up elementary combination theory, aka combinatorics, eg on google or wikipedia or an elementary statistics book. you will soon find a quantity usually represented by nCr ân choose râ
This is the number of ways of selecting r items from n possibilities, without replacement, when the order of selection is irrelevant.
This is pretty exactly what the arrangements of 18 ones and 18 zeros you describe are.
Values for nCr can be computed on some good calculators, or online calculators, or can be found using the expression nCr=n!/r!*(n-r)!.
So, there are nCr = 36C18 = 9075135300 different ways of arranging 18 ones and 18 zeros.
The above is standard math; the next part, converting combinations to integers and back by making and using a table, while fairly simple, is not in any textbook I know of.
If we list these combinations as if they were binary numbers, in numerical order, we will find that some of them have the first, highest-value, bit set, and some do not.
Of the combinations which have the highest bit set, the remaining bits will have 17 set bits in 35 bit spaces - ie, there will be 35C17 or 4537567650 possible combinations with the first bit set.
There will be 36C18 - 35C17 combinations where the first bit is not set.
In this case 36C18 - 35C17 = 35C17, and if we number from 0 the smallest-value combination where the first bit is set will be the 35C17 = 4537567650th combination.
By repeating this, you can find the values where the highest set bit is And so on.
This is one way to find the values in the table. Pascal's triangle and binomial theorem are two more, though at a deeper level they are all much the same.
The important bit is that that for the second-highest set bit, and so on, the values of lesser combinations caused by that set bit only varies according to which-highest bit is set, and the position it is in.
So we can list the positions of the first-highest, second-highest, and so on set bits, look up the values in the table, and add then together to get the number for a particular combination.

@_date: 2016-09-12 14:21:13
@_author: Peter Fairbrother 
@_subject: Re: Permutations to scalars and back again. 
Here's an example table for 3 ones and 3 zeros.
The entries are written as x,y[v], where x is 1 for the first 1, and so on, y is the position of the xth 1 in the permutation, v is the table value. The number of the permutation is found by adding three values for x=1,2,3 together.
   first 1
         second 1
        third 1
000111 - 0 -  1,4[0]  + 2,5[0] + 3,6[0]
001011 - 1 -  1,3[1]  + 2,5[0] + 3,6[0]
001101 - 2 -  1,3[1]  + 2,4[1] + 3,6[0]
001110 - 3 -  1,3[1]  + 2,4[1] + 3,5[1]
010011 - 4 -  1,2[4]  + 2,5[0] + 3,6[0]
010101 - 5 -  1,2[4]  + 2,4[1] + 3,6[0]
010110 - 6 -  1,2[4]  + 2,4[1] + 3,5[1]
011001 - 7 -  1,2[4]  + 2,3[3] + 3,6[0]
011010 - 8 -  1,2[4]  + 2,3[3] + 3,5[1]
011100 - 9 -  1,2[4]  + 2,3[3] + 3,4[2]
100011 - 10 - 1,1[10] + 2,5[0] + 3,6[0]
100101 - 11 - 1,1[10] + 2,4[1] + 3,6[0]
100110 - 12 - 1,1[10] + 2,4[1] + 3,5[1]
101001 - 13 - 1,1[10] + 2,3[3] + 3,6[0]
101010 - 14 - 1,1[10] + 2,3[3] + 3,5[1]
101100 - 15 - 1,1[10] + 2,3[3] + 3,4[2]
110001 - 16 - 1,1[10] + 2,2[6] + 3,6[0]
110010 - 17 - 1,1[10] + 2,2[6] + 3,5[1]
110100 - 18 - 1,1[10] + 2,2[6] + 3,4[2]
111000 - 19 - 1,1[10] + 2,2[6] + 3,3[3]
: 1 2 3
1: 10 x x
2: 4 6 x
3: 1 3 3
4: 0 1 2
5: x 0 1
6: x x 0
You will note that the numbers are the sum of the number beneath and the number beneath and to the right. This makes calculating tables (or individual values) easy.

@_date: 2016-09-12 10:24:14
@_author: Peter Fairbrother 
@_subject: Re: Permutations to scalars and back again. 
I had a similar problem, the way I solved it was to create tables as follows - I had to do a lot of conversions.
We are going to write the permutations as binary numbers, and then number them according to size.
Look for the first 1 in the permutation, ie the 1 which is in the highest position.
It can be at position 18, and then all the lower bits will be ones so it is permutation number 1.
If the first bit is in position 19 then there are 18 possible lower-value permutations. These are permutations 2 to 19. The table value for a first bit in position 19 is 2.
If the first bit is in position 20 then there are x possible permutations, permutations 20 to x. The table value for a first bit in position 20 is 20.
And so on, but we have to calculate x first.
Looking at permutations with a first bit in position 19, if the second bit is in position 18 then it is worth 1, if it is in position 17 then it is worth 0. If the third bit is in position 17, it is worth 1, and so on.
Note that eg a fifth bit in position 14, or a 17th bit in position 3, is always worth 1, no matter where the other bits are positioned.
This is true (with the appropriate value) for any combination of bitnumber and bitposition - it doesn't change if the other bits change So we create a table with values for the first, second, third etc bits of the permutation, and the positions in the permutation they are found in. We total those values, which gives the number of the permutation.
Calculating the permutation from the permutation number is straightforward, find possible ranges and subtract.
Hope this is clear, written in a rush. My email is real, you can contact me offlist.

@_date: 2016-11-21 19:08:25
@_author: Peter Fairbrother 
@_subject: Re: Britain and Apple Fucking Your Privacy 
encryption, this means that likely true encryption will be banned in UK?
If you get served an order, you probably can't use forward secrecy.
That's about all that has changed in respect to encryption.
There are other changes, mainly to required communications data retention regimes for ISP's, which are far more invasive in civil liberty terms.
Mechanisms to require decryption have been in place for years, since 2000 with RIPA, and some before. FSVO "much" they don't actually get used much, but they are there.
This part of the new Act only takes away the ability to say "I can't do it, I don't have the means (the key)", and only on some people (communications service providers), and only after they have been served an order to keep the "means of decryption".
An order under the new Act is only an order to, effectively, keep records of keys used - a requirement to disclose them or use them to decrypt ciphertext takes a warrant which is much harder to get.
(though those warrants are not as hard-to-get as they should be, or used to be - the Act changes that too, in a way which I personally believe is much more sinister in terms of the quantity of surveillance than anything the Act does in the new orders).
Note, it only applies to those who have been served an order to keep
keys used - and an order can only be served on communications service
providers, it cannot be served on private individuals or most [1] internet sites.
You can, partly, still use FS - supposing you used Diffie-Helman, you
would have to keep a record of your key-establishing secrets, rather than discarding them.
Which mostly nullifies the point of using FS: however not totally - the
other party, if they haven't been served an order, could discard their
key-establishing secrets.
Oh, and if Bob is not a "communications service provider", or is one but hasn't been served an order, or is outside the UK, then that part of the Act has no effect on Bob or Alice at all.  :)
The Home Office are shooting themselves (or rather us, the UK) in the foot a bit here. Very minor gain, lots of bad.
[1] but not all websites are exempt. If a site allows communications between individual visitors (rather than just between visitors and the site) then it can be served an order.
Or at least that's what the Home Office said, though I don't entirely agree that that is what the actual effect [2] of the Act will be.
So most social media sites can be served an order to keep keys used, or eg if they use don't use FS but do use SSL/TLS they would have to keep their private keys if served an order.
[2] eg it is unlikely, but perhaps a little uncertain, that cloud providers, or something like Apple iCloud, could be served an order.
Almost anyone, in theory at least - but not everyone.
Yes. Though I don't see how a boycott would change this, international traffic would still get routed through LINX.
Any of those based in the UK will in practice have to comply with any orders served on them. Though some might float canaries. I don't think a boycott would achieve much.
Perhaps - though it probably won't happen in the UK :(
