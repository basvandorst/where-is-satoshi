
@_date: 2012-03-07 21:07:40
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor and HTTPS graphic 
I think that it is important to differentiate national security and
law enforcement here. It is unlikely that agencies like the FBI and
its worldwide counterparts can break Tor anonymity. For instance,
public in USA is particularly hysterical about issues such as
pedophilia, yet FBI is apparently unable to locate members of
pedophile networks who use Tor =97 see National security agencies, on the other hand, have to think about the
=93big picture=94, and would not put their methods of work in danger of
disclosure by running software that they don't trust (Tor) in
locations that they don't completely control (geographically variated
commercial data centers), or indulge in otherwise risky behavior
(routing tricks and the like, which can be discovered by regular
Although I doubt that US agencies had anything to do with that relays
number spike, it could be a simple attempt to aid opposition in Iran
(i.e., not to introduce rogue nodes that leak information for later

@_date: 2012-03-07 14:43:03
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor and HTTPS graphic 
I think that's quite unlikely. The nodes must reside in commercial
data centers and run untrusted software (including necessarily
modified Tor clients), all of which exposes them to hacking risks and
to the resulting possibility of discovering the interception framework
employed (which is probably not unique to Tor, so that's a huge risk).
But one could try correlating Tor relays and Tor clients growth graphs
since, say, 2000 =97 if at some point there was a sharp growth in
USA-located relays without a corresponding growth in total clients,
and if those relays have similar bandwidth / data center quality
capabilities, then that could be "The Man".

@_date: 2012-03-07 01:21:11
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor and HTTPS graphic 
s thread seem to think the GPA is
Using $ grep 2012-03-05 relaycountries.csv | cut -d, -f2-3 | tr , ' ' | sort
-rn -k 2 | grep -v ' [0-9]$' | pr -t4
us 778            it 42             dk 24             ro 15
de 507            at 40             no 21             il 15
fr 170            cz 38             lt 21             ar 12
ru 169            pl 33             sc 20             br 11
nl 166            fi 33             lu 20             sk 10
zz 138            ch 33             es 17             nz 10
se 111            au 29             hu 16             gr 10
gb 107            ua 28             be 16             bg 10
ca 80             jp 24
From a cursory glance, all countries on the list (assuming that "zz"
is satellite or unclassified, and with the exception of Russia) are
NATO countries or similar, sharing electronic intelligence with the
USA. Russia is a potential war adversary, so its communications
interception is high-priority for the USA as well. In summary, the
traffic channels of absolute majority of Tor relays (Internet
backbones and satellite links) are easily accessible by the US
intelligence agencies. Intercepting and correlating all Tor traffic is
thus a question of willpower and resources prioritization, not

@_date: 2012-03-06 23:18:01
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor and HTTPS graphic 
While this may be true in the theoretical sense, it doesn't mean that
one can't make correlation attacks less practical. I find it hard to
believe that right now NSA, for instance, has Tor traffic analysis
tightly integrated into its worldwide communications sniffing
framework, simply because it's too much of a logistic problem, and
anonymous networks are unlikely to be sufficiently high-profile
targets so as to warrant expending the resources to deal with the
logistics (yet). But I think that it is entirely believable that NSA
has a dedicated project (even if only for research purposes) where the
traffic from all known relays (a relatively stable pool of ~3000
nodes?) is sniffed and analyzed =97 that would be relatively simple to
setup and maintain, given the unlimited interception capabilities. And
you can combat the latter =97 by extending and popularizing the entry
bridges concept, implementing exit bridges, making all clients relays
by default (even if that won't contribute significant bandwidth), etc.

@_date: 2012-04-06 01:43:49
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
You forgot to add =93relative to population size=94. I don't think that
such direct comparison makes sense, with Chinese users' motivation
being mainly circumventing the GFC. Russia has no Internet censorship,
so you can compare the data at the time when the paper was written and
now with similar countries. Then:
  Russia 146
  France 150
  UK 170
  US 864
(I omit Germany because it such an outlier)
Now ( approximate):
  Russia 15000
  France 26000
  UK 10000
  US 62000
So I wouldn't say that Russia's proportion has a tendency to increase,
discarding growth of Tor network per se, although I suspect that
proportion of Internet users in Russia increased much more in recent
years than in Western countries above. Most people don't change their
Internet usage patterns due to traffic interception laws, and Internet
criminals in Russia (e.g., carders) prefer double-VPN to Tor, from
what I heard.

@_date: 2012-04-05 21:41:55
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
True, but I was referring to a specific list of uses on the project
page, which in my opinion should have some backing, not mere
possibility of use (and does not list uses for which there is
overwhelming backing, which I think is dishonest). For instance, I can
easily imagine military intelligence using an *alternative* Tor
network, composed of frequently changing nodes with civilian IPs, all
of which are under complete control, for the purpose of
compartmentalization (i.e., disclosure of access IPs for a forum with
discussion of possible terrorist activities will not let anyone with
access to the alternative network infer which department performed the
analysis). But using the regular Tor network is too problematic =97
consider an analyst mistakenly logging somewhere with their private
password (wasn't there an embassy fiasco in that vein?).
Well, I think that some educated guesswork is at least useful for
formulating a hypothesis.

@_date: 2012-04-05 21:01:24
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
I don't think that enthusiasts (people who change their behavior
without being directly affected) can have a significant impact on
usage statistics when compared to millions of people who are impacted
directly (i.e., cannot access YouTube). In China, e.g., over half of
URLs are blocked, in my experience of couple of years ago, even under
same domain. That's a much more serious motivation to use a mechanism
like Tor to circumvent censorship, compared to traffic interception.
E.g., in Russia, if I am not mistaken, every ISP of certain size must
(by law) duplicate all of its traffic to an FSB-supplied box =97 where
are the users? Even in absence of legislation, people already know
that internal security services and military intelligence will (and
do) intercept everything they can.

@_date: 2012-04-05 02:24:28
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
I assume that it's different for each country. For China and Turkey,
it's probably mostly state-wide firewall circumvention, for Russia =97
paranoia and enthusiasts, for Italy I have no idea about the situation
There is Paul Syverson, who works at NRL, if I am not mistaken; did I
miss anyone else?

@_date: 2012-04-05 02:13:15
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
The paper has the advantage of correlating different statistics
(including intercepted traffic) and drawing conclusions that passed
peer review. I just pointed to the table instead of copy-pasting
quotes (I did skim the paper before doing that).
They might, but that's not what I would call =93military use=94. Do
network admins anywhere in the American military, for instance, set up
network access via Tor?
Well, you already have some statistics from personal interaction with
users, but you didn't want to share them on the =93Tor users=94 page
(e.g., there is no
section about people using Tor to trade illegal drugs, although that
must be a sizable proportion of users).

@_date: 2012-04-05 01:59:29
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
Perhaps I should have been more specific: the =93Militaries=94 section on
the =93Tor users page=94, as it is formulated, looks unrealistic and
artificial to me:
1. Field agents =97 who exactly are those? I these are regular soldiers,
then tools such as LiPoSe [1] make no provisions for Tor =97 if they are
using Tor on their own, then good for them, but I wouldn't call that
=93military use=94. If these are special agents and the like, then Tor is
most likely too unreliable and experimental for their purpose =97 they
have their own expensive toys.
2. Hidden services =97 too vague. In any case, a military C&C as a Tor
hidden service? This must be a joke.
3. Intelligence gathering =97 only for low-profile targets, perhaps.
Even for such targets, what is usually done is establishing civilian
network accounts, and proxying everything via them (or proxying
directly via some ISP gateway proxy). That way you don't run into the
possibility of rogue exit node intercepting unencrypted traffic, and
don't expose yourself as a Tor user, which might be quite unusual
(=93revealing the surveillance=94 in the section).
[1] Law enforcement is no military intelligence =97 these people would do
anything, since the most they risk is a failed investigation.

@_date: 2012-04-05 00:57:55
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
Table 2 (with Germany at the top) in [1] does seem to suggest that
=93Privacy enthusiasts=94 represent a significant proportion of Tor users.
Perhaps a 2nd place is deserved (higher than the =93Loonies=94) in the
estimated breakdown above. I would also place human rights activists
somewhere at the bottom of the list. The =93Militaries=94 section on the
=93Tor users=94 page is most likely completely phony, though.
[1]

@_date: 2012-04-04 21:51:08
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
I don't doubt that there are such uses, I am just wondering about the
actual percentage breakdown of different users. As it stands, the =93Tor
users=94 page at torproject.org is essentially propaganda aimed at
presenting a certain image, but I would like to know how would it look
like if sorted by users count. It's a frequent question, something
that many people would like to know =97 and ultimately, the reason that
the =93Tor users=94 page exists. Only problem, that page is not too useful
for answering the question. How would the top of the page look if
sorted by actual most popular uses? Would it be:
  * Asians and Muslim use Tor to get on Facebook
  * Loonies use Tor to hide from The Man
  * Stoners use Tor to buy drugs
  * Pedophiles use Tor to share videos
Or is that list completely wrong? Right now, it seems difficult to get
a reliable estimate.

@_date: 2012-04-04 13:10:51
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
I also hope that you don't mind me asking, because lacking reliable
survey data, you seem to be in a unique position of individually
interacting with a wide variety of Tor users (if I understand the idea
of volunteer Live Chat / Telephone support correctly). My question,
related to the estimated users breakdown I posted previously, is: how
many of the =93Normal people using Tor=94, i.e., those who don't fall into
any of the subsequent categories on the Tor users page, that you have
interacted with, are actually paranoid? In my experience, it is rather
easy to spot such individuals by their inability to =93let go=94, and the
tendency to return to the subject that bothers them in circles,
regardless of the conversation.

@_date: 2012-04-04 12:50:14
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
ail or call looking for help with accessing silk
In that case I would expect an appropriate subsection on the Tor users
page, provisionally titled =93Stoners use Tor=94 =97 perhaps with the guy
from the bottom half of the following image as a thumbnail:

@_date: 2012-04-04 11:45:48
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] access sites 
The Tor Project site has a rather pathetic (although quite extensive
and doubtless useful for propaganda purposes) "Who Uses Tor?" section
[1], a typical example of what I would call =93Western sanctimony=94. I
wonder whether anyone ever attempted to gather some actual
representative statistics of Tor users, perhaps via a survey. I would
expect a rough top of the list as follows:
  * Circumventing a state-wide firewall
  * Paranoid people in developed countries
  * Small-scale trading of illegal drugs
  * Viewing images and videos of pedophilia
[1]

@_date: 2012-08-12 00:29:59
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
You didn't read the thread, didn't understand the claims made, and
didn't bring up anything new, so I don't see a point in useless

@_date: 2012-08-11 07:16:20
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
This is indeed the case =97 clients choose exit nodes uniformly among
Fast+Stable routers, weighted by consensus bandwidth, excluding known
bad exits and specifically excluded exit nodes (e.g., by country =97
only done by a minority of users). An exit node with some minimal
bandwidth and a decent uptime will see a fair sampling of all exit
traffic; comparison of per-port statistics will require an easy
It is not a productive contribution, since it's an obvious assumption.
I even doubt that there are 50 HTTP .onion sites that see over 1000
daily visits.
You are just inventing corner cases. Port number and protocol can be
determined automatically, and anything that can't and is still in
top-50 will be an interesting find nevertheless.
Sure, I rely on my intuition. It is based on interacting with a
diverse userbase of Tor users. Yours is based on disliking my
conclusions and nothing else =97 you never brought up actual references.
No, the hypothesis is that Tor hidden services are mostly used for
criminal activities, and that Tor exit nodes are often used for such,
when Tor is used for the purpose it was designed for, and not as a
glorified proxy.
y likely to
Could be, but you have nothing of substance behind this suggestion. It
is criticism for the purpose of criticism =97 good for high-school
debates and for politicians, but of little value otherwise.

@_date: 2012-08-11 03:20:18
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
Sure, that's why the =93Tor users=94 page is more or less a rewritten and
expanded version of the original overview on Free Heaven [1], which is
a simple promotional writeup about people being able to circumvent
firewalls and hide their IPs, with the lone exception of something
that looks like an NRL-initiated internal military case study. Did you
write that page?
I don't want named users =97 I would be completely fine with anonymous
accounts. Anyway, I went over the stories in that directory (with the
exception of the PDF, which is inaccessible, and the source of that
PDF, linked from the Tor blog, is inaccessible as well), and they are
all about either (1) (mostly) activists circumventing a filter, or (2)
(rarely) activists hiding one's IP. Boring, especially considering
that most activists greatly overestimate their importance or attention
from authorities. Nothing about hidden services or intelligence
gathering, nothing about commercial espionage, not even about
anonymous blogging (not surprising =97 I am yet to see a popular blogger
who is not an attention whore).
Interestingly, there are a couple of non-trivial entries on =93Tor
users=94 page, like the US IBB entry =97 that's right there US foreign
intelligence supporting Tor usage by subversive elements in countries
of interest. I didn't spend too much time searching for that =97 did
they fund Tor? I think you should expand on this on the page, since it
shows some technical credibility.
By the way, those stories suggest that no one actually needs anything
beyond the most basic anonymity set reduction =97 it's just an
attractive R&D topic because you can make small incremental
Well, it's not really my job, but I think that you should focus less
on propaganda, and focus more on getting users involved who will then
expand the network instead of just using it as a proxy. Make everyone
a relay (even if low-bandwidth relays are not useful, and even if
there are theoretical issues =97 solve the issues instead) and have a
hidden service address by default. Work with file sharing software
developers to have a one-click setup of P2P sharing via Tor. Make an
easy interface for publishing files or simple sites on user's .onion
host. Don't invent use cases, because users have their own (which you
don't like and hence ignore) =97 facilitate network expansion which will
actually bring in new use cases.
[1]

@_date: 2012-08-10 20:43:52
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
environment to speak for a network as a whole.
Only because you don't understand how Tor works. The less you
understand, the more data you need.
tic to others.
That's not contribution, that's useless water-cooler chatter.
So propose a good scientific experiment, if you can. I have went over
Tor and Rendevous specs, and several conference papers before writing
some of the posts. What have you done, expressed doubt and dislike? I
don't care =97 contribute something useful

@_date: 2012-08-10 20:14:29
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
It's actually not far from what I estimated at the time, except that
the top is probably completely mundane firewall circumvention. [1]
The problem is that such selective focus detracts from the project's
credibility. Most Tor users, although they might not understand the
technical issues, are not stupid. They will browse .onion sites, and
see that the most active ones are related to drugs and pedophilia.
They will try to run an exit node, and see the abuse (and perhaps feel
the abuse when they are raided by LE). They will see that many sites
block Tor IPs, and understand that Tor is often used for uploading
questionable content.
Americans probably quickly adapt to that discrepancy, saying: ok, I
see =97 the =93users=94 page is actually what they want, and talking about
the actual situation is politically incorrect; this is just like
photoshopping black guys into pictures [2]. But most international
users will be genuinely surprised. And it's not like it is that
difficult to be honest: these are the people who we develop Tor for,
these are the users who provide traffic cover, these are the current
users, this is the reason for the early adopters composition, this is
how we expect the userbase to shift through the following years, etc.
That Table II is actually very interesting, and is the main reason
that I linked that paper (it's not on AnonBib, by the way). All the
entries in that table, except for the last two (=93Illegal/Questionable=94
and =93IllegalDrugs=94) are either non-existent or almost non-existent in
.onion-land (at least wrt. site activity). The last two entries,
however, are very well-represented. So if there was a way to get
.onion access statistics, then I would expect to find those two
categories (CP and drugs) completely overtaking everything else.
Actually, I just don't like propaganda. I am sure that no one would
make up all those make-believe descriptions of Tor users if Tor was
still a technical project, and wasn't being promoted by various policy
people (i.e., EFF, etc.).
[1] [2]

@_date: 2012-08-10 19:21:18
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
Even if you were logging everything that came out of an exit node that you=
 control, you wouldn't be able to get good stats from that.  You'd need a s=
ignificant sampling of other Tor exit nodes to do the same thing.
That's not true, but it shows that you lack the probabilistic
background required to reason about such things.
ou come in here asserting one of the most demonizing talking points against=
 Tor with nothing hard to back up your claims other than "some guy on reddi=
t said so."
Fine, don't accept it, but if you can't understand what's discussed
(as I said, Reddit post was just an illustrative example), and have
nothing to contribute, just move on. I don't understand this need to
inject an opinion just because you don't like the conclusions. Find
something non-trivial to add to the discussion first.

@_date: 2012-08-09 23:51:20
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
Now *that* can actually be measured at RV points, and I think should
be a part of Tor metrics. I suspect that the ratio is much closer to
1% (or even below that), but on the other hand, most =93regular=94 Tor
users probably don't need anonymity, and would use a free VPN if it
was as simple to install as a TBB, so the meaning of low percentage is
moot. And of course, you could say the same about most .onion users =97
they would trade drugs and CP on clearnet if that was legal. What I
would like to find is something interesting and unexpected that Tor is
used for (not from the propaganda list on =93Tor users=94 page).
Some of that information is available in [1].
[1]

@_date: 2012-08-09 23:00:39
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
Yes, if gathering .onion access statistics were possible, I would load
each .onion address in a top-50 list and see what it contains, or
search for the address if access requires authentication. The reason
is that I am curious and don't have an agenda to protect, unlike Tor
project policy people. Why do you pretend that it's difficult to do?
The Reddit comment was an illustrative example. The argument is that
Tor is well-known for the illegal (again, depending on jurisdiction)
content that it provides access to (Tor exit operators aren't raided
just because LE officers are bored). People don't come to this list
and ask how to get on some political dissidents .onion discussion
board. They come to ask how to get on Silk Road, and ask on other
support forums for Bitcoin support, presumably so that they can use
Bitcoins on Silk Road to buy drugs. On .onion and I2P imageboards,
they don't ask where they can download LOLcats =97 they ask where they
can get more CP, and get directed to OPVA and other boards. I don't
care either way, but this is well-known information, which you are
apparently oblivious to =97 which raises the question: why did you
decide that you have anything of value to contribute to this thread,
especially if you have no references?
It's simple: he ran an exit node, and sampled the URLs that people
accessed via the node. It is obvious =97 that's what he wrote.
e something
I would like you to stop posting useless replies. If you have
something to contribute, be it a proposed method of statistical
analysis, a reference to Tor exit operator who actually sampled
accessed URLs, or anything else, then great, otherwise you are not
bringing any new information or non-trivial conclusions to the table.
Calling someone sharing their experience a troll or a false flag can
be interesting psychologically, but it has no merit otherwise.

@_date: 2012-08-09 09:17:50
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
The Hidden Wiki [1] is (or are, there have been several alternates) a
good start. It used to be down quite often after some kids tried to
play in vigilantism on Tor network, but seems quite stable at present.
However, this won't give you a good idea of what resources are
actually popular. In my first reply in this thread I suggested that
relays can be patched to get .onion access statistics (referring to
rendezvous points), but after reviewing the rendezvous specification
[2] I need to admit that it's not possible =97 apparently, one would
need to gather statistics at introduction points (waiting until a
relay is chosen as an IP for a given hidden service), which would be
extremely slow, and would not provide bandwidth statistics.
[1] [2]

@_date: 2012-08-09 06:54:49
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
Where did I talk about exit node statistics? I mentioned the
possibility of gathering .onion access statistics.
So far you didn't say anything useful or non-obvious, so why did you
post? You didn't like someone's written experience, so he is
automatically a troll or a false flag =97 fine, bring your own

@_date: 2012-08-09 00:08:47
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
You don't need to classify large amounts of traffic for that =97 you can
sample URLs manually to get an idea of what your exit node is used
I just gave that link as an example of user experience with running an
exit node and looking at the traffic. Do you have a better statistic?

@_date: 2012-08-08 23:25:27
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
That's most certainly not true, or at least wasn't true a couple of
years ago. After the famous Russian 2ch.ru imageboard untimely demise,
a few alternatives quickly sprang, and the most high-traffic one (I
think 02ch.net) had a /cp board on a separate (likely hacked) Chinese
domain (with actual CP). I don't know why they did that =97 for trolling
potential, or perhaps to clean up the regular boards due to lack of
resources for moderation, but there you have it: most trafficked
clearnet Russian imageboard had an active /cp board for a few months.
Mind you, this is only a well-known public example =97 who knows how
many password-protected or obscure forums there are (by now, most
probably use https, but it's still possible to MITM them on an exit
node for analysis, since some / most users will always click through a
certificate warning).
Also, the =93immediate deletion=94 part is often not achievable, even if
server admins actively try to remove such content =97 CP videos (for
whatever definition of CP) in various social networks are a known
problem, especially when they are restricted to closed groups. A
=93known problem=94 not in the sense of an argument that politicians use
to promote themselves over the think-of-the-children case du jour, but
you would actually see imageboard threads with (irony alert) links to
abuse report queues on said social networks, full of such content.
If I were to guess, I would say that for any definition of illegal
content / activity, most such content is located on clearnet, since
Tor is simply too small. If anything, Tor provides an immense
opportunity for law enforcement to discover such activities in a
centralized manner, by setting a few exit nodes (and maybe relays for
finding out popular .onion addresses). E.g., instead of crawling the
whole web for terrorism forums, just analyze those sites that are
accessed via exit nodes (where you also have the opportunity to MITM).
Terrorists are dumb, but some are bound to have the know-how to
install Tor.

@_date: 2012-08-08 21:47:26
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
The =93Tor users=94 page isn't presented as a promotional page, it is
presented as a factual one. I also remember discussion on this list
where I expressed doubt about some aspects listed there (military
uses), and the overall claim was that the page is a good
representation of the current userbase.
So why not answer those questions honestly, and not pretend that users
are stupid? As I said, it detracts from the project's credibility.
Anyone who installs Tor (or I2P, for that matter) and explores the
hidden services, immediately sees the overwhelmingly illegal (mostly,
since it depends on jurisdiction) content. Anyone who runs an exit
node immediately sees that a sizable portion of the traffic is of
questionable nature. [1]
Why would it be shut down? Why would you structure an anti-censorship
project in such a way that it depends on goodwill of authorities?
That's a motivation page (in a dire need of an update, but that's
beside the point) =97 I don't care if any of these categories of people
use Libert=E9. Why should I? Their activities are someone else's
problem. Moreover, if any of them help improve Libert=E9 (be it via bug
reports, suggestions, patches, promotion) =97 then great, and it's
welcome. I don't feel a need to justify a project by pretending that
most users are some goodwill elves. Do you? I have a strong suspicion
that if I didn't mention the possibility of gathering .onion access
statistics in Tor network, then I would get the usual replies that
there is no evidence of most active .onion resources being of
questionable nature.
[1]

@_date: 2012-08-08 07:02:39
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
No, it's a contraction to avoid saying the same thing twice. By the
way, I forgot to add [3], it should go at the end of first paragraph,
after =93nevertheless=94.

@_date: 2012-08-08 06:07:49
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] Tor as ecommerce platform 
I doubt that the Tor Project will ever acknowledge such support. Tor
developers (or at least policy people) like to pretend that Tor is
used for purposes that they consider morally right, and ignore the
uses that are morally wrong [1]. I believe it's an american thing =97
one typical tell-tale sign is treating criminals as some masterminds
who can already easily achieve what they want [2] (americans are used
to doing the same in gun control debates), and ignoring the fact that
the project facilitates anonymity for criminals just as well, if not
more, as for non-criminals. Personally, I don't understand what's the
big deal about the make-believe game, and it probably detracts from
the project's credibility, but it's fun to watch nevertheless.
I actually intend to write a Tor server patch to be able to gather
.onion access statistics on relays, once I am sufficiently bored, just
for the fun cognitive dissonance potential (expecting drugs and CP
forums to top the list).
[1] [2] [3]

@_date: 2012-08-24 23:51:29
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
Wrt. the first proof, it seems to me that the assumed correlation
accuracy rate of 99.9% is incredibly low, and I think that the Raccoon
recognized that by referring to sampling and retention at the end of
his post. With the targeted attack that's similar to =93Example 3=94 in
Raccoon's post that I described in my previous comment here, where one
analyzes all exit traffic without missing packets, I would expect the
correlation accuracy (and as a result, match confidence) to
exponentially approach 100% very quickly with the number of relevant
packets seen, and extremely quickly if the traffic is interactive
(i.e., browsing).
Actually, c/n of 30% in =93Example 3=94 is close to the 25% that's
discussed in the OP here, so let's redo the example with c/n=3D25% and
different correlation accuracies (leaving the other numbers intact):
(using =93bc -l=94)
ca  =3D 0.999
pm  =3D (1/5000) * (0.25)^2
ca*pm / (pm*ca + (1-pm)*(1-ca))
ca  =3D 0.999
ca =3D 0.9999
ca =3D 0.99999
ca =3D 0.999999
ca =3D 0.9999999
ca =3D 0.99999999
ca =3D 0.999999999
So reducing correlation accuracy error to 10^-9 will give you 99.99%
confidence in end-to-end correlation match. I suspect that a few
seconds of interactive traffic will give you a correlation accuracy
that's much better than a 10^-9 error.

@_date: 2012-08-22 06:48:19
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
I don't think that buying the software would be that difficult. For a
big project, LE could outsource it to one of those shady companies
selling exploits, or (more likely) to a government contractor with
security clearance. For something smaller, a hungry grad student
should do, after making them sign an NDA, or, in case of a really
arrogant LE, some national secrecy act. Writing the service as
something innocent in accounting is probably par for the course.
Closer to the topic, I think that traffic correlation can be performed
in a distributed fashion, if you know the target IPs to watch for
(which can be gathered beforehand locally on exit nodes, and
aggregated and analyzed afterwards). Exit nodes that see packets
to/from target hosts aggregate their exact timestamps for a few
seconds, and then send the chunks to all other nodes (so yes, you
can't correlate too much traffic). All other (guard) nodes then try to
locally correlate the received packets with their own traffic, and
aggregate successes for later reports. In this fashion, each node
needs to keep perhaps a minute of timestamped traffic. It is also
possible to play with traffic / disk space / success probability
tradeoffs: send chunks to rotating sets of nodes, increase recorded
traffic window (to be able to send old chunks to nodes that didn't see
traffic to a given IP yet), etc.

@_date: 2012-08-22 03:51:06
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
There are some subtleties, mainly the restriction on distinct families
in a circuit =97 you can account for them in a spreadsheet, or by
writing a proper analysis program, but I doubt that it will result in
more than a few percents difference (just speculating, maybe it's
more). Doing some heuristic search for intercepted nodes selection (a
few high-bandwidth Exit-only or Guard-only nodes) will probably push
the estimates in the other direction.
This quote: =93They only use relays with the Guard flag for their first
hop. They read weighting parameters from the consensus and use them to
avoid Guard-flagged nodes for positions other than the first hop and
avoid Exit-flagged nodes for positions other than the last hop, in
proportion to how much capacity is available in each category.=94 =97 is
this actually true? Are Guard+Exit nodes never used as guard nodes? Or
even only used as middle nodes (depending on how one reads the first
sentence)? I didn't see something like that in the code.
Ok, maybe I overestimate LE =97 different countries have different
standards. Let's consider extra-legal attacks. You mentioned [1],
which looks at intercepting IX traffic. IX links are probably
considered a part of vital national infrastructure wherever they are
located (similarly to telcoms), so it would be extremely hard for a
non-LE adversary to install their (extremely expensive) equipment or
software in the relevant facilities. However, consider what would be
needed to intercept all traffic from the /28 networks mentioned here,
managed by ~20 VPS hosting providers (I don't think I noticed anything
residential, but intercepting that would be much easier). Let's say
you have a million dollars to spare. Allocate $50k for each of the
hosters, and budget another $50k for some smooth salesperson type who
will fly to each hosting facility / office, befriend an infrastructure
admin with beer / hookers / coke, and offer him $50k for shadowing
traffic from VPSes of interest to your own VPS (which might be
possible to do purely in software in most cases, probably). I think
it's doable, whether you are just curious and want your own
international surveillance operation, or treat it as a data mining
investment (there is probably a lot of interesting traffic going
through Tor, if you know what to look for). It is also quite cheap for
the effect.
[1] For one, everyone should contribute as a relay. This also has the
potential to improve the users community, and advance hidden service
resources as a result. =93Internet that we have=94 is also problematic,
because Internet is too hierarchical. I think that EFF should promote
large-scale ISP-independent mesh networks, instead of caring so much
about the ability of some CIA-funded NGO activists to get on Facebook.
Other anonymity systems don't care much about accessing clearnet. I am
not even sure whether I2P, for instance, has any active outproxies at
the moment, and they do fine, since they provide what the users need =97
community, ability to religiously tweak the console panel, integrated
file sharing, etc.
I don't think it would change the top-25 list much, since. for
instance, all /28 networks there belong to different /16 classes.
Maybe something like Amazon EC2 could creep in, but I doubt that. But
it's difficult to say definitely, e.g:
$ cut -d' ' -f1 nodes | sort -u | wc -l
1595 (IPs)
$ cut -d' ' -f1 nodes | cut -d. -f1-3 | sort -u | wc -l
1461 (/24 networks)
$ cut -d' ' -f1 nodes | cut -d. -f1-2 | sort -u | wc -l
984 (/16 networks)
I don't think it matters much. Technical people are skeptical to begin
with. Non-technical people are irrational (e.g., if to judge from
experience with activists described on liberationtech mailing list) =97
they will keep everything in plaintext and use unencrypted connections
even when told explicitly that it's dangerous. From my experience,
warnings only work when you show people something that will cause a
cognitive dissonance. I.e.: =93don't email exams=94 doesn't work, whereas
=93here is the exam you wrote for tomorrow, and here is the student who
stole it from your mailbox=94 works well. It seems that Tor is not yet
at the point where one can show such examples, although someone with a
few million $ to spare or to invest might to just that (see above).

@_date: 2012-08-22 01:42:35
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
Manually, using WHOIS and traceroute. This can be done automatically
using GeoIP, but I wanted to be sure in the results (also visited some
hosting sites), and writing a proper program would deviate too much
from the initially intended =93quick hack=94 design.
That's why I insist that everyone should be a relay by default, even
if there are some theoretical issues that weren't worked out yet [1].
Making everyone a relay also results in a healthier users community (I
think I2P is one), and more intrinsic network growth.
Quoting [2] (referenced by fakefake): =93Tor has been long suspected,
and later confirmed [11,12], to be vulnerable to an attacker who could
observe both the entry and exit point of a connection through an
anonymity network.=94
Well, it of course depends on what one calls =93unsophisticated=94. E.g.,
if one judges by IACIS email dump [3], then most investigators hardly
understand what they are doing when it comes to unfamiliar
technologies (like Tor). So maybe you need them to be =93sophisticated=94,
after all, but my point was that you don't need something exceptional
like involving state security agencies =97 i.e., FBI + UK Police + DE
Police + a couple of other countries, coordinating via Interpol does
not sound impossible to me. I will also expand on that in a reply to
[1] [2] [3]

@_date: 2012-08-21 21:52:04
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
Bingo =97 in the first graph in the ticket [1] you see that the
probability gets to ~80% when the number of nodes gets to 40. What
this graph doesn't show, however, is that many of these nodes are
attached to the same switch, or even run on same machine in different
VMs, or on different IPs (some even run on same IP). After accounting
for that, the number of tiny networks (at least /28, from going over
the list in the original message) and nodes one needs to intercept in
order to get the same 80% figure gets down to ~25. And of course, if
one is smarter about choosing which nodes to intercept, the
probability of seeing both entry and exit traffic is also significant:
~25%. It is also possible to do something in between (choose some
Guard-only and Exit-only nodes), but my laziness kicked in at that
point of analysis.
Here are the network again, in case anyone has the resources and is
curious enough about who does what with Tor:
DE 31.172.30.[1-4]
GB 146.185.23.179
NL 77.247.181.{162,164}
RO 109.163.233.{200-201,205}
CA 198.96.155.3
US 199.48.147.[35-41]
DE 212.84.206.250
FR 178.32.211.{130,140}
US 204.8.156.142
US 173.254.216.[66-69]
SE 78.108.63.44
US 96.44.189.102
GB 178.33.169.35
CZ 212.79.110.28
US 66.180.193.219
DE 88.198.100.{230,233}
LU 212.117.180.65
SE 81.170.186.175
CH 62.220.135.129
SE 84.55.117.251
DE 85.31.187.132
CA 8.18.172.156
FR 213.251.185.74
US 69.42.212.2
FR 37.59.82.50
[1]

@_date: 2012-08-21 21:24:00
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
inly used for nefarious purposes like buying drugs or illegal pornography, =
in addition to claiming such would be "not difficult to prove." LOL!
1. Stop spreading FUD and false claims, and performing ad hominem attacks.
2. All your posts in this mailing list were about (a) not
understanding basic maths; (b) not understanding how Tor works; and
(c) proposing to invoke an attorney on some kid who tries to work on
an open-source project he likes.
What's the point of your posts? You don't *do* anything. There are
other venues where you can indulge in useless chit-chat. Please do not
reply until you have something worthwhile to contribute.

@_date: 2012-08-21 21:12:08
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
this attack as it seems.
No, you didn't understand the point of the attack.
Nothing written about /16 and /24 networks in this thread is relevant
to the (obvious) attack. I don't understand the purpose of most
replies here. How can it be described any simpler? You intercept
traffic at 25 nodes, you can deanonymize 25% of the traffic, or watch
80% of exit traffic. This makes one wonder whether this mailing list
is suitable for any discussion that assumes even the most basic
It is linear, unless I missed something in the code. If it wouldn't be
linear, then nodes would be under- or over-utilized.

@_date: 2012-08-21 18:57:15
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] End-to-end correlation for fun and profit 
No, it means that if you intercept traffic from 10 top-bandwidth Tor
routers with some characteristics (Guard + Exit, basically) at what's
probably the nearest hardware switch (seems true for the nodes listed
in my original message), then the probability of both entry and exit
nodes being one of these routers is close to 11.5%. I just multiplied
bandwidth-weighted probabilities for entry and exit nodes. The routers
don't have to be on the same network. Enforcing different-family
circuit nodes skews the probabilities, but not by much, so I didn't
bother to account for that.

@_date: 2012-08-20 07:33:29
@_author: Maxim Kammerer 
@_subject: [tor-talk] End-to-end correlation for fun and profit 
Hello gentlemen,
Here and there I see references to =93global=94 or =93state-level=94 powerf=
adversaries when it comes to end-to-end traffic correlation =97 i.e.,
it's supposed to be very hard. Because Tor network has many nodes,
there are guard nodes, there is research, blog posts, CIA funding
(well, not anymore, but similar funding from EU is in the works),
useless bureaucracy, college kids playing in serious development, yada
yada =97 you know the drill.
Anyway, let's do some math. Below, you will find a table where left
column denotes the number of Guard+Exit+Fast+Stable Tor relays one
needs to sniff at Class-C level, and right column denotes the
probability that a given circuit will go through both intercepted
entry and exit nodes. This is slightly imprecise, because same node
can't be both entry and exit for a circuit, and there are other
ignored intricacies (e.g., port policies) that push the estimates in
the other direction =97 the reason is that I am better with writing
quick scripts [1] than with Excel. The consensus taken for analysis is
from a few hours ago, and I read Tor server code from current stable
version in Gentoo (0.2.2.35) =97 this probably doesn't matter.
10 11.50%
11 14.56%
12 16.52%
13 16.80%
14 17.69%
15 17.98%
16 18.90%
17 19.20%
18 19.50%
19 20.46%
20 20.46%
21 21.76%
22 22.77%
23 23.43%
24 23.43%
25 24.48%
26 24.48%
27 24.82%
28 25.55%
29 25.90%
30 25.90%
As you can see, sniffing just 25 Class-C networks (or 42 individual
nodes) lets an adversary correlate ~25% of (non-.onion) circuits.
Which networks are these?
DE 31.172.30.[1-4]
GB 146.185.23.179
NL 77.247.181.{162,164}
RO 109.163.233.{200,201,205}
CA 198.96.155.3
US 199.48.147.{35,36,37,38,39,40,41}
DE 212.84.206.250
FR 178.32.211.{130,140}
US 204.8.156.142
US 173.254.216.[66-69]
SE 78.108.63.44
US 96.44.189.102
GB 178.33.169.35
CZ 212.79.110.28
US 66.180.193.219
DE 88.198.100.{230,233}
LU 212.117.180.65
SE 81.170.186.175
CH 62.220.135.129
SE 84.55.117.251
DE 85.31.187.132
CA 8.18.172.156
FR 213.251.185.74
US 69.42.212.2
FR 37.59.82.50
All of these servers are in US/CA or EU jurisdiction, so even an
unsophisticated LE operation can issue ~20 wiretapping orders at ISP
level (many of these networks are operated by same hosting providers),
and immediately deanonymize ~25% of Tor traffic. So far for anonymity!
Oh, and if you are just into looking what sites Tor users visit, the
situation is even better =97 intercepting the same 25 Class-C networks
will let you see 72% of the traffic. Picking better non-Guard Exits
will improve this figure to 78%. That's right =97 4/5th of Tor traffic
exits through just 25 LANs.
[1]

@_date: 2012-10-16 20:31:26
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] registration for youtube, gmail over Tor - fake voicemail / sms anyone? 
It's not Tor's problem to solve. Both common sense and actual research
[1] suggest otherwise. Tor only needs to steadily increase its
popularity and teach users not to link their real identities to online
activities. Service providers will then need to adapt their business
models or lose users, and as a result, customers (advertisers in your
[1]

@_date: 2012-10-16 19:44:52
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] registration for youtube, gmail over Tor - fake voicemail / sms anyone? 
SMS-verified GMail accounts: $100 per 1k. Non-SMS-verified GMail
accounts: $95 per 1k. (Annoying millions of users by ignoring their
desire for privacy: priceless.)
Looks like spammers don't value your phone verification efforts too much.

@_date: 2012-12-01 14:20:38
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] William was raided for running a Tor exit node. Please help if 
Well, to be sure, I was only objecting to messages not being properly
labeled when filtered by To/CC headers. Maybe I should invest more in
my filtering setup.

@_date: 2012-12-01 12:37:30
@_author: Maxim Kammerer 
@_subject: Re: [tor-talk] William was raided for running a Tor exit node. Please help if 
Is it possible to configure the tor-talk mailing list to discard
messages not explicitly addressed to it? Like this nanog discussion.
