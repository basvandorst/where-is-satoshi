
@_date: 2004-05-10 14:28:22
@_author: "Ragnar Paulson" 
@_subject: Re: Software (fwd) 
I don't believe that SpamAssassin looks at X-MailScanner-From ... but it does look at "Return-Path:" which is also forged. MailScanner probably gets it's header from "Return-Path:".   Also when I use the SpamAssassin whitelist, it adds a score of -100 for USER_IN_WHITELIST.  I don't see this in your e-mail
headers, instead it appears you have a large SPAM score (SpamAssassin (score=23.919, required 3))
but it ignored by SpamCheck (X-Dickinson-MailScanner-SpamCheck: not spam (whitelisted)).   So you may have to take this up with SpamCheck.  Meanwhile for what its worth,  I have created a local rules:
meta __TSG_UNTRUSTED    (FORGED_AOL_RCVD || FORGED_HOTMAIL_RCVD || FORGED_EUDORAMAIL_RCVD || FORGED_YAHOO_RCVD || FORGED_JUNO_RCVD || FORGED_GW05_RCVD || FORGED_MUA_OUTLOOK)
describe __TSG_UNTRUSTED        Received headers indicate a forgery of some type
score   __TSG_UNTRUSTED 1.00
meta TSG_WHITELIST      (USER_IN_WHITELIST && !(__TSG_UNTRUSTED))
describe TSG_WHITELIST  Received headers do not indicate forgery, and USER_IN_WH
score   TSG_WHITELIST   -1.000
meta TSG_UNWHITELIST    (USER_IN_WHITELIST && __TSG_UNTRUSTED)
describe TSG_UNWHITELIST Undo SpamAssassin Whitelisting
score   TSG_UNWHITELIST 100.0
This has the effect of undoing the whitelist score of -100 when there is something suspicious about the headers. I use procmail for
filtering, so the rule "TSG_WHITELIST" is just there to give me something to filter on instead of "USER_IN_WHITELIST".  Also this is still not perfect,  Spammers just have to get better at the headers to fool this one too (it has happenned).  You can also work with "whitelist_from_rcvd", particularly for local addresses like dickinson.edu but I haven't found a good way to manage large whitelists for a large user community this way.  ----- Original Message ----- Sent: Monday, May 10, 2004 8:24 AM
