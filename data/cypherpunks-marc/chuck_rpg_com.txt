
@_date: 2002-11-13 05:22:24
@_author: "Charles Perkins" 
@_subject: [eros-arch] Did you *really* zeroize that key? 
(please pardon the non-linear reply; I've been lurking reading the pipermail
On Tue, 12 Nov 2002 11:57:07 -0500  Jeroen C. van Gelderen wrote in response
Ryan McBride's response to Jeroen:
[regarding encrypting disk data vs. scrubbing the disk]
Here's where I have done some thinking. At this level we're talking about a
social problem and we need something that supports a social solution. In
honor of a past U.S. president I think the best solution is something I call
a plausible-deniability file system.
Please pardon me for the following rambling incoherent misspelled missive.
The problem with current encrypted file systems is that they contain
encrypted data. Anybody can point to a file and say "that is an encrypted
file. Give me the key or else."  It is reasonable to assume that such an
individual will not be satisfied until you provide a working key and the
is decrypted or you convince him that the key has really and truly been
In certain situations that can be a tough sell.
Encrypting the whole file system merely extends the problem to the whole
file system.
The solution I propose is two-fold:
First, encrypt the whole disk sector by sector, including free space. This
ensures that off-line analysis of the system cannot reveal how much of
the disk space is actually used by data thereby exposing how much
information you may be coerced into revealing the keys for.
(Each block should have its own automatically generated key that is
also recorded to disk in a master set of blocks that themselves are
encrypted and written to disk.)
Second, in addition to the regular directory structure create a shadow
directory structure (or structures) that record additional files or
directories that layer on top of the base level hierarchy. The base
directory structure must maintain a free/allocated map of the store and
the shadow structures must also have free/allocated maps which allocate
out of the free space of the base level.
On boot the user or the user would have to provide
a key to decrypt the section of disk that holds the keys to individual
blocks. The file system driver then would linearly scan until locating
a block that can be successfully decrypted with that key. That block
would contain a reference to which block contained the root of the
file system (and the key to decrypt it.)
(It is important that there be no fixed offset for this master block.)
Here's where the niftiness comes in--when you are being coerced
you may reveal a key phrase that decrypts a file system structure
that is lower in the stack of shadow directory trees. The file system
driver, when given that key, will scan forward until it finds a completely
self-consistent file system image including free and used disk space.
Any data recorded in a higher shadow will merely be free space to
the lower structure. It would have keys and locations to any lower
shadow directory structure and would present that data as if it
were a part of it's own directory structure. New data could be
written by default to the highest level, the lowest level, or some
intermediate level and the level of an item or a directory could
be changed via some utility like chmod or chown.
And here's where the social aspect of it comes in--you're going to
have to be convincing when you explain why you have all that free
disk space. It may be helpful to have some mildly sensitive files
in one or two shadows lower than the key you give that will
justify why you're encrypting files in the first place.
The hierarchy of shadows may be a graph; you may segregate
your data into mutually unintelligible shadows that are both
visible to one or more loftier directory structures. You may then
select which class of data to reveal depending on the revealed
knowledge of the interrogator (i.e. "I KNOW you have this data
in there somewhere, because here it is in your email to Bob...")
Of course any time the file system is mounted with a lower key
than the ultimate key to the ultimate blocks the file system may
irretrievably over-write the hidden data. This is inherent in the
design--to the lower-level shadow directories those blocks
are just free space after all, and that's the way it has to be. Any
method for protecting that space will reveal it for what it is--
a cache of hidden data.
There you have it--a plausible-deniabilty file system whereby
you can say "Nope, all I've got is some MP3's hidden, honest.
And here's my key. Go look."
Chuck "But what am I afraid of?" Perkins
eros-arch mailing list
