
@_date: 1995-09-17 21:41:08
@_author: Ian Goldberg 
@_subject: Netscape SSL implementation cracked! 
As some of you may recall, a few weeks ago I posted a
reverse-compilation of the random number generation routine used by
netscape to choose challenge data and encryption keys.
Recently, one of my officemates (David Wagner )
and I (Ian Goldberg ) finished the job
of seeing exactly how the encryption keys are picked.
What we discovered is that, at least on the systems we checked (Solaris
and HP-UX), the seed value for the RNG was fairly trivial to guess by
someone with an account on the machine running netscape (so much so
that in this situation, it usually takes less than 1 minute to find
the key), and not too hard for people without accounts, either.
See below for details.
I've included the header to a program we wrote to do this key-cracking
below.  I would like to get some information, though:
o Where should I put the full source (1 file, ~12k) so that ITAR lovers
  don't get mad at me?
o Where can I find a version of netscape that does RC4-128?  It is
  likely that it suffers from the same problem, and even a brute-force
  search of the entire seed space is _much_ less than 128 bits.
Happy hacking,
   - Ian "who just saw _Hackers_ today with some other Bay Area cypherpunks,
           and it put me in the mood"
   Break netscape's shoddy implementation of SSL on some platforms
   (tested for netscape running RC4-40 on Solaris and HP-UX; other
    Unices are probably similar; other crypt methods are unknown, but
    it is likely that RC4-128 will have the same problems).
   The idea is this: netscape seeds the random number generator it uses
   to produce challenge-data and master keys with a combination of the
   time in seconds and microseconds, the pid and the ppid.  Of these,
   only the microseconds is hard to determine by someone who
   (a) can watch your packets on the network and
   (b) has access to any account on the system running netscape.
   Even if (b) is not satisfied, the time can often be obtained from
   the time or daytime network daemons; an approximation to the pid can
   sometimes be obtained from a mail daemon (the pid is part of most
   Message-ID's); the ppid will usually be not much smaller than the pid,
   and has an higher than average chance of being 1.  Clever guessing
   of these values will in all likelihood cut the expected search space
   down to less than brute-forcing a 40-bit key, and certainly is less
   than brute-forcing a 128-bit key.
   Subsequent https: connections after the first (even to different hosts)
   seem to _not_ reseed the RNG.  This makes things much easier, once
   you've broken the first message.  Just keep generating 16 bytes of
   random numbers until you get the challenge-data for the next message.
   The next key will then be the 16 random bytes after that.
   main() and bits of MD5Transform1 by Ian Goldberg    and David Wagner .  The rest is taken from the
   standard MD5 code; see below.
   This code seems to want to run on a big-endian machine.  There may be
   other problems as well.  This code is provided as-is; if it causes you
   to lose your data, sleep, civil liberties, or SO, that's your problem.
    On the command line, give the time in seconds, the pid, the ppid and
   the SSL challenge data (each byte in hex, separated by some non-hex
   character like a colon) of the _first_ SSL message generated by
   the instance of netscape.  This program will search through the
   microsecond values.  You may need to run it again with a slightly
   different value for the seconds, depending on how accurately you know
   the time on the system running netscape.  The output will be the
   master key (all 16 bytes; note you never even told the program the
   11 bytes you knew) and the value for the microseconds that produced it.
   As a benchmark, this code runs in just under 25 seconds real time
   (for an unsuccessful search through 1<<20 values for the microseconds)
   on an unloaded HP 712/80.

@_date: 1995-09-20 08:49:11
@_author: Ian Goldberg 
@_subject: Munitions shirt (again) 
So, Dave and I got free munitions shirts (they're different, though;
the font is smaller and they have a bunch of X'd out Constitutional
Amendments on the back; I think they ere designed by Joel Furr) for
our bug find.
So I'm wearing it today.  The thing is, I live in International House,
a residence that has 50% non-Americans.
So, any consensus as to whether it's actually illegal to do so?  I
remember some disagreement a few weeks ago that AFAIK wasn't resolved.
As far as I can tell, it's _technically_ illegal, but any LEO would be
out of his mind to try to enforce it (it would have to be a Fed, too,
wouldn't it?  Or can regular city cops get you for violating export
   - Ian

@_date: 1996-01-25 03:17:59
@_author: Ian Goldberg 
@_subject: Guess what I found... 
Guess what I found in my mailbox this morning:
A cheque (that's check for those Americans out there) for $500 from
Netscape Comm. Corp.  It seems they decided to split a "Bugs Bounty"
prize between Dave and me retroactively for the PRNG thing. :-)
   - Ian "This may turn out to be a good day..."

@_date: 1996-01-15 16:14:41
@_author: Ian Goldberg 
@_subject: How to make someone else lose ecash 
I don't recall seeing this on cypherpunks or on ecash
it's being sent to both places, so set your replies appropriately.
Dave and I were discussing the ecash protocols when we discovered
what seems to be a way for Eve (a passive eavesdropper) to cause
anyone to lose money.  Note that she doesn't gain anything from it.
Eve watches for any message that contains pcoins (a list of onl_coin).
These messages are the Payment (from user to shop) and Deposit (from
shop to mint).  Neither of these are required to be encrypted.
An onl_coin is the following:
onl_coin =
      [
        int     keyversion              ; low 5 bits are denomination
        MPI     n                       ; coin number
        MPI     sig                     ; encrypted coin signature
      ]
sig is (f(n)^(1/h) XOR f(payment_hdr)), encrypted in the mint's public key.
The reason sig is encrypted is so that the payment header can't be
changed and so that Eve can't learn f(n)^(1/h).  However, n is sitting
there all nice and cleartext.
Therefore: when Eve sees such a message, she uses the same value of n
to withdraw a coin from her bank account, and then spends it (she could
just pay it to herself).  Eve does not gain or lose anything, but if
she can deposit the coin before the original coin that she saw gets to
the mint, the original coin will not clear.  If Eve has the ability
to drop or delay packets, she can accomplish this easily.  The result
is that whoever withdrew the coin originally has lost the use of that
Note that this is the same problem as if two users just happen to use
the same value of n when they withdraw coins.  We don't really care
about that, since the probability is trivial.  However, this attack
lets Eve produce the same effect _on purpose_.
How can we prevent this?  Well, since a shop has no way of using the
value n except for just sending it on to the mint, we lose nothing by
encrypting it.  Thus, an onl_coin should be:
onl_coin =
      [
      ]
Note that it's not really necessary to have sig already encrypted if
we're going to encrypt it again.  Actually, I think an onl_coin
should have an additional field (bankID) to the fields listed
above, but that's another argument for another time.
   - Ian "Back from the North and ready to party!"

@_date: 1996-02-18 09:51:33
@_author: Ian Goldberg 
@_subject: Re: Text of personal use exemption 
Interesting.  Note, however, the following proviso (123.27(a)(1)):
   (1) The software product(s) are to be used only on a simultaneously
temporarily exported Category XIII(b)(1) hardware product or a
simultaneously exported item on the Commerce Control List (CCL)
This seems to say a couple of things:
o I can't bring my copy of PGP or kerberos with me on a floppy,
  intending to use it abroad on a conveniently available computer; I must
  bring a computer with me.
o The computer I bring with me must be a Category XIII(b)(1) hardware
  product; that is, something that is illegal to export (now, except
  for personal use), or be on the CCL.
That second one seems weird.  Does the CCL have things like normal portable
computers on it?  Otherwise, this exemption seems pretty useless...
   - Ian

@_date: 1996-02-22 03:50:20
@_author: Ian Goldberg 
@_subject: Re: JavaScript to grab email 
I was under the impression that netscape doesn't run sendmail at all;
it speaks SMTP directly.  In that case, changing your email adress
in the options should suffice.
However, if you do this, actually sending mail and news from netscape
will get messed up, won't it?
   - Ian

@_date: 1996-02-29 05:39:39
@_author: Ian Goldberg 
@_subject: DES hooks in Linux kernel 
(aeb is included, as he seems to be the last person to have
touched loop.c before it was put into the standard Linux kernel sources,
but I may be wrong.)
The file loop.c, included in recent Linux kernel sources, includes calls
to DES routines, such as:
 DES_AVAILABLE
static int transfer_des(struct loop_device *lo, int cmd, char *raw_buf,
                  char *loop_buf, int size)
                        des_ecb_encrypt((des_cblock *) tmp,(des_cblock*)
                            loop_buf,lo->lo_des_key,DES_ENCRYPT);
AFAIK, the presence of these hooks (even if surrounded by the ifdef's)
makes this file illegal to export from the United States.  Its presence
on ftp sites in the US could get someone in trouble.
   - Ian "this ITAR thing is really silly..."

@_date: 1996-03-23 08:00:35
@_author: Ian Goldberg 
@_subject: Re: Ecash API about to be released 
By this, do you mean that just the API will be released (which we had
pretty much finalized in mid-January), or actual code to go with it?
They've had far too much time to add wrappers to their existing ecash
client to turn it into a library.  I hope that (very soon) we see a
properly-implemented libecash; however, that's unlikely, since no one
has discussed a low-level API yet...
   - Ian "I'll write it, if someone can get around these **** INS
           problems..."

@_date: 1996-04-05 15:41:16
@_author: Ian Goldberg 
@_subject: Re: [NOISE] Employers need pseudonymous off-shore remailers 
In article ,
Having recently been involved in a similar situation :-), I found that
the following trick seems to work:  have someone you know start a consulting
company in another country (like Canada (yes, Canada is another country)).
It seems an F-1 student (like me (for now; I'm trying to switch to J-1))
is allowed to work for a foreign company (as if the US government could prevent
a foreign company from hiring a foreign citizen (well, it could try...
(these nested parens are getting out of hand...))).  So just contract work
out to a foreign consulting company, which subcontracts work out to
the F-1 student.
   - Ian

@_date: 1996-04-05 16:20:35
@_author: Ian Goldberg 
@_subject: Re: What backs up digital money? 
And here's another data point I learned at CFP.
Kawika Daguio (Federal Representative, Regulatory & Trust Affairs, American
Bankers Association) mentioned that the Stamp Payments Act (or something
like that) forbids "open" currencies in amounts less than $1.  It seems
certain casinos have been hit with this, when other businesses in the
area started accepting their chips as "real" money.
It seemed to me that he thought that ecash (Digicash's version) wouldn't
fly in the US.
We'll see, I guess...
   - Ian "Now where's the code for that library...?"

@_date: 1996-04-08 12:51:21
@_author: Ian Goldberg 
@_subject: Re: Was Cohen the first? 
In article <199604070321.TAA02171
Not true.  Pressing ctrl-reset jumped to the interrupt routine pointed
to by the vector at (I think) 1010/1011, if the contents of that vector
checksummed correctly with the contents of the next byte (1012), and
otherwise reset the computer.  It certainly was possible (and useful)
to trap ctrl-reset.  Also, even when a reset occurred, not all of the
memory was cleared, so you could in fact keep code in memory across
a reset, if you could arrange to have it run on the other side of the
As you pointed out, it was very easy to write viruses for the Apple ][.
The "slave" disk layout contained two blank sectors (.5 K) within the
DOS image that get loaded into memory.  The designers may as well have
labelled it "put virus here".
   - Ian "Been there; done that..."

@_date: 1996-04-11 12:48:12
@_author: Ian Goldberg 
@_subject: RC4 on FPGAs (Was: Bank transactions on Internet) 
Coincidentaly enough, this is part of my project for my Hardware class.
I'll let you know when I have it working.  I'm using Altera FLEX 81188s,
though the 10K models (with built-in RAM) would be _way_ faster...
   - Ian

@_date: 1996-04-11 19:33:15
@_author: Ian Goldberg 
@_subject: Bay Area Meeting on Saturday? 
So, will there be a Bay Area meeting on Saturday?  Where?  etc...
   - Ian

@_date: 1996-04-27 14:37:29
@_author: Ian Goldberg 
@_subject: Re: An idea for refining penet-style anonymous servers 
In article ,
This sounds a bit like the scheme mentioned in AC2, pp73-74.
Check it out (and its reference, if you have time...).
   - Ian

@_date: 1996-05-02 10:34:20
@_author: Ian Goldberg 
@_subject: Re: Calling other code in Java applications and applets 
In article <3187209C.3E5B
In an alternate universe in which I didn't have projects to finish, I may
be interested in doing something like this.  However, I haven't been able
to find information on how to write Unix (or preferably portable) plugins.
Any hints?
   - Ian

@_date: 1996-05-03 11:40:57
@_author: Ian Goldberg 
@_subject: Unix plugins for Netscape (Was: Calling other code in Java applications and applets) 
In article <31887DD0.300F
I downloaded this, and I notice you don't have a "makefile.linux".  Is that
just because no one's bothered to make one, or does Linux Atlas actually
not support plugins at all?  (Quickly checking the binary...)  I see that
Linux Atlas is still a.out.  Ick.  That would make supporting plugins
pretty tough.  If it were in ELF, things would be _way_ easier; in fact,
I'd probably say trivial (but that's just me).
I'd venture a guess that most people who have a Linux box sufficiently cool
to run netscape at all, have the ability to run ELF.  In fact, there are
probably a lot of people (like everyone who bought Slackware 3.0 or a recent
RedHat) for which netscape is the _only_ a.out binary on their system.
The reason I'm pointing this out is (obviously) because Linux is my main
development platform, and I'd like to be able to try writing plugins
for things like crypto and ecash.
   - Ian "Add me to the 'Make an ELF Linux binary!!!' list..."

@_date: 1996-05-03 12:09:07
@_author: Ian Goldberg 
@_subject: Re: [Fwd: Cylink can export 128-bit DH?] 
In article <199605011919.MAA27020
Not quite.  CDMF key shortening was designed by IBM to shrink a 56-bit DES
key to 40 bits, suitable for export.  See AC2, page 366.  I heard a rumour
that CDMF is in SET, but I'm not sure how much that makes sense.
   - Ian

@_date: 1996-05-08 15:01:40
@_author: Ian Goldberg 
@_subject: ecash moneychangers (Was:  Kid Gloves or Megaphones) 
In article <199605051818.LAA13740
Ah, but if we have the capability to do the fully-anon protocol, we can
suddenly do change-making stations.
The change problem is similar to the problem described above:  what if the
payor wants to buy something, but doesn't have the right change?  Going
to the bank to get change will give away who he is.  The solution:
go to your local moneychanger.
A moneychanger accepts, say, a coin for $0.02 and two blinded half-coins
for $0.01 each.  He deposits the $0.02, and if it clears, has the bank sign
the half-coins, which he returns to the payor (he'll probably blind and
unblind those half-coins, too).  The payor now has the right change, and
all the bank can see is that the moneychanger deposited a $0.02 coin and
withdrew 2 $0.01 coins.  Of course, the moneychanger may charge the payor
an extra bit for the privilege.
In the case of the fully-anon protocol, the payee gives a blinded half-coin
to the payor.  The payor then, as above, sends it (and a service fee)
to the moneychanger, who sends it to the bank (or maybe another moneychanger...
echos of remailers...), yadda yadda.
A moneychanger is a very useful construct for protecting _payor_ privacy
when exact change isn't handy.
Note also that with a system like this, there's no real reason for the payor
to even _have_ an account with the bank...
If (when) the ecash library is released, this will all become pretty
straightforward to implement.
   - Ian "who thinks he understands the ecash protocol, right down to the wire"

@_date: 1996-05-09 12:47:59
@_author: Ian Goldberg 
@_subject: Re: ecash payee anonymity, cpunk archives 
In article <199605072236.RAA02543
I don't recall if an "official" explanation of the protocol got posted here,
but it's being discussed in another thread (search for "moneychangers").
   - Ian

@_date: 1996-05-09 17:12:54
@_author: Ian Goldberg 
@_subject: "Architectural considerations for cryptanalytic hardware" paper on the web 
For anyone who was interested in Dave's and my hardware project
(Architectural considerations for cryptanalytic hardware), it's done
(thank goodness).  You're free to check it out at
in either HTML or PostScript.  Thanks to cypherpunks Eric Hughes and
Bruce Koball, and to Altera people Clive McCarthy and Stephen Smith.
   - Ian "...pray for an 'A' for us..."

@_date: 1996-05-19 00:16:23
@_author: Ian Goldberg 
@_subject: HUGE denial of service attack against any ecash customer!!! 
(Again Cc:'d to ecash-feedback, hoping for a security prize.  I wonder
 who's keeping track...  Also Cc:'d to cypherpunks, for fun...)
So I had some more free time... (Dave cringes when I say that.)
Here's a cute one:
Give me an account number, and I can prevent it from being used until
an arbitrary time in the future (of my choosing).
How?  Simple.
Send a deposit message with 0 coins (well, any message will work, I think, but
this is one of the simplest messages there is) with a timestamp of some future
Messages stamped prior to that (such as everything coming from the
actual user for that account, until the time comes) will be politely
discarded.  (Actually, I think the last reply to a withdrawal request
is continually resent, but I'm not exactly sure of this.)  In any case,
the actual user will be unable to withdraw money from his mint until
the time sent in the denial-of-service message.  (Unless he forward-dates
his computer's clock, or something...)
I've tested this against myself and Sameer (with his cooperation, of course).
Anyone else want to be locked out for an hour?  (Actually, I could pretty
effectively lock out _everyone_ for an arbitrarily long time, it seems...)
   - Ian "Right.  I want the sources to the client and the server
          released.  Now."  :-)

@_date: 1996-05-19 11:59:17
@_author: Ian Goldberg 
@_subject: My meeting with Chaum (Also: ecash full anonymity and a legal question) 
In article ,
So here's the deal with ecash "as it works today":
If a payment is made with ecash through some anonymous channel (like a remailer
or a post to alt.anonymous.messages), neither the payee or the payor can
directly identify the other (that is to say, neither's identity need be stored
in, or used to construct, the payment).
_However_, in the current implementation, the payor can collude with the bank
to reveal the payee's identity.  More specifically, the payor can produce
the "blinding factor" he used when he withdrew the coins from the bank,
which he later gave to the payee, who deposited them.  The bank can use this
information to figure out what the unblinded coin looked like, and then check
its logs to find out who deposited that coin (remember that with the current
implementation, when a coin is paid to someone, he must immediately deposit it,
or risk losing the money if the payor tries to cancel the payment or spend it
Note that the act of giving up the blinding factor will reveal
_both_ parties in the transaction.  That is, in order to reveal the payee,
the payor must identify himself.  (Not a big deal in the case of LEO...)
This is because what is being identified is a "link" between a blinded coin
that was withdrawn from the payor's account to the unblinded coin that was
deposited to the payee's account.
The way "full anonymity" works is that the coin is blinded by _both_ the payor
and the payee before being withdrawn from the bank.  That way, in order to
reveal the link between the payor and the payee, _all three_ of the bank, the
payor, and the payee must collude.  This is not a big deal (the reasons for
which are left as an exercise).
The ecash "concept" (numbers that _are_ money) produces an inherently
bearer instrument (modulo double spending protection).  The current software
implements payor-side blinding only, in order to appease the Powers That Be.
There's no reason why, given the information currently available, and
even better when the library is released, with a weekend's work
(a week if you're slow), you couldn't produce the handful of functions
you'd need to implement the fully-anonymous protocol, REGARDLESS of whether
you had access to the source to the current client or the library.
The reson I bring this up is that yesterday, I had a 2.5-hour chat with
David Chaum.  These seemed to be the important bits:
o The current plan is to release a lowish-level, binary-only library, as well
  as highish-level source which calls that library, and implements the
  published high-level API (  Release date: RSN.
o The source to the current client, and the low-level library will _not_ be
  released.  Dr. Chaum's main reason was that releasing the source would make
  it "too easy" to implement full anonymity, which he sees the various
  regulators seeing as a Bad Thing(TM).  I disagreed.  With the recent release
  of the byte-level encoding (
  it would be not too much work for a sufficiently motivated person to
  do, with or without the source.  In fact, it's unclear the source to
  the low-level library is really all that helpful in this respect.
o He doesn't really want there to be an independent implementation of the
  ecash library, with full source available, also for the above reasons.
  The phrase "The worst thing you could do would be to go to Canada, write
  the library, and publish it on the net." came up.  In both this and the
  above case, he didn't believe that availability of source code for
  security analysis (everyone runs code they didn't write) was an important
  issue.  As far as I could tell, he was thinking like a Cryptographer
  (not surprising, as that's what he is (and a damn fine one, at that)):
  he wanted to have a way to verify that the _protocols_ were behaving
  correctly; that is, they were not leaking private information, and that
  money wasn't being lost.  The issue of buffer overruns causing the security
  of my entire machine to be compromised wasn't important.
o Similarly, the source to the mint will not be published.  Notwithstanding
  that the last few bugs I found in ecash were with the mint software, of which
  I've never seen source nor object code, again, thinking like a Cryptographer,
  he insisted that the system was designed so that no matter how one person
  cheats, the others can't be affected.  That may be true in theory, but in
  practice, if there's a fingerd-style hole in the mint software, and someone
  manages to steal the mint's private key, and makes counterfeit ecash,
  does that really not affect me, a customer?  If I'm going to be buying into
  this system, I would like to have some assurance of its security, and
  it is well-known that the best way to do that is to have open source.
So: a question to legal-types, maybe:
I am, in fact, going to Canada, and was considering writing a version of
the library while I was there.  Now, Chaum has a patent on 2 lines of
code (blinding the coin before it goes to the bank, and unblinding the
value returns).  Believe it or not, I would like to stay within the law.
Would my writing a library that worked perfectly well with the current
system, but just didn't do blinding (and thus has no anonymity) be
"contributory infringement" or something like that (noting that it would
likely be trivial for someone to add in the relevant 2 lines)?  Would it
matter (either including the 2 lines or not) if I'd: (a) sell it (b)
give it away on the net (c) give it just to a few people (d) only use it
Remember also that this would be done in Canada, just to make the question
   - Ian "I didn't rant nearly so much as I thought I would..."

@_date: 1996-05-21 09:28:32
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article <199605190626.BAA62897
Yup; with the current protocols, there's no way to do change.  For the shop
to pay you change, besides suddenly losing your anonymity as a payee, you
would have to go online immediately to clear the coins, which assumedly
is infeasable.
However, if you use the "fully anonymous" protocol, change becomes trivial.
You don't have to go online; the payer (the shop) does, which it assumedly
already is.  Another benefit is that coins received in this way as change
are immediately spendable by you, without having to go online in between.
The "fully anonymous" protocol turns out to be _exactly_ what is needed
for situations like this.
   - Ian "this is one of those 'pay attention' posts Sameer mentioned..."

@_date: 1996-05-21 15:05:48
@_author: Ian Goldberg 
@_subject: Re: The Crisis with Remailers 
In article ,
I mentioned this to Chaum, and he didn't really seem agree with the need for
something lower-level...
Another problem with postage in Mixmaster:  the minimum ecash payment is
$0.01.  Do we want to charge that much for email?  Need we consider
   - Ian

@_date: 1996-05-21 15:06:51
@_author: Ian Goldberg 
@_subject: Interesting bit in the US ecash License Agreement... 
Here's a bit of the US license agreement for the ecash software that some
of you may have missed:
Note that last clause.  It seems (probably due to the client using RSAREF,
or something like that) that using the ecash software "directly or
indirectly for revenue generating or commercial purposes" is illegal.
Someone might want to fix that...
   - Ian "read _before_ you sign"

@_date: 1996-05-23 06:20:27
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article <199605201902.MAA16278
In the "normal" protocol, the payee has to go online.  In the "anon" protocol,
the payer has to go online.  Since you don't want to go online when you
walk into a shop, you can pay the shop with the "normal" protocol, and
the shop gives you change with the "anon" protocol.
That way, you never need to go online, and your identity is never compromised.
   - Ian

@_date: 1996-05-23 05:38:31
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article ,
But if you go online, you give away your identity due to a timing coincidence.
That's another of the cool features of the "anon" protocol: the coin isn't
complete until the protocol is finished.  The hot-dog vendor doesn't have
enough information to spend the coin.
   - Ian

@_date: 1996-05-24 04:53:27
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article <01I50K5LNPQG8Y4X9G
Ah.  I see I was misunderstood.  The goal was not to make the shop anonymous,
but rather to be able to provide change to an anonymous payer.
   - Ian

@_date: 1996-05-29 10:07:57
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article <01I53GAYSQUC8Y4Z90
Yes, that's the _basic_ purpose, but the "anon" protocol has several
useful "secondary" properties as well.  This (providing change to an
anonymous payer) is one of them.
   - Ian

@_date: 1996-05-29 10:18:32
@_author: Ian Goldberg 
@_subject: Re: Is Chaum's System Traceable or Untraceable? 
In article ,
But then the shop, having seen the coins before, can collude with the bank
to identify the customer!  The point of this use of the "anon" protocol
is that the shop, throughout the transaction, never sees the coin it
uses to provide change to the customer.
   - Ian

@_date: 1996-06-20 08:55:04
@_author: Ian Goldberg 
@_subject: Re: Digital Cash application 
In article <199606190339.UAA07400
Well, this has been around for quite a while:
(it's the Libertarian Party of Virginia; they accept ecash and First Virtual).
   - Ian

@_date: 1996-06-20 09:35:39
@_author: Ian Goldberg 
@_subject: Re: German Federal Bank opposes e-cash 
That's very interesting, especially considering Deutsche Bank has signed
on to be an ecash mint (
I don't get this worry about counterfeiting.  It would seem to be harder to
counterfeit ecash than paper cash (though, admittedly, it would be harder to
track, but it would almost certainly have to be an "inside job").  Maybe
the journalists are just misinformed, or possibly the banking people?
   - Ian

@_date: 1996-06-22 07:31:19
@_author: Ian Goldberg 
@_subject: Re: Recipients get the postage 
In article ,
I disagree.  I think the main reason that postage has not appeared for
remailers is that there is no good way to integrate Chaumian cash into
applications.  Now, with two (count 'em!) libraries for ecash starting
to become available, we will hopefully see people working to put ecash
code into MUAs, remailers, etc.
   - Ian "and I'll be one of them..."

@_date: 1996-06-29 08:20:08
@_author: Ian Goldberg 
@_subject: New mixmaster up: jammix 
I've finally gotten around to installing mixmaster.  I'll install a Type 1
tomorrow or next week.  Any suggestions on which (I hope this isn't a
religious war...)?
jammix mix c2178bf3018c062a8d0fabd066e50ed9 2.0.3

@_date: 1996-06-29 09:52:09
@_author: Ian Goldberg 
@_subject: New mix/ghio.remailer.2 remailer up: jam 
As anticipated, I've put up a ghio.remailer.2.  The email address is
Here's the public key:
Type bits/keyID    Date       User ID
pub  1024/734C3A3D 1996/06/28 John Anonymous MacDonald Remailer sig       734C3A3D             John Anonymous MacDonald Remailer

@_date: 1996-06-30 02:56:47
@_author: Ian Goldberg 
@_subject: Re: anonymous mailing lists 
In article <199606290404.XAA32220
[I'm copying this to remailer-operators.]
Yesterday, Dave and I discussed at length a design for a new remailer network.
It was motivated by the fact that, when I installed mixmaster, it mentioned
Diffie-Helman and direct socket connections as a "future expansion"
thing.  Well, IMHO, that time has come.  I wanted to hack mixmaster to
accept ecash postage for the last hop, anyway, so I may as well put in
the direct connection bits as well.
I'll post more about this when we've discussed it more (and with Lance),
and when I'm on a faster link to the net.  Basically, the idea is that every
remailer gets a copy of every encrypted message, using a randomized fill
algorithm, and D-H encrypted links.  If you're a remailer in this network,
and you get a message:
If you've seen this message before, drop it (this step needs more thought).
If you can decrypt the message, do so, and handle the decrypted copy (but
continue with the following steps with the original message anyway).
If you have a message waiting to be inserted into the remailer network,
drop the incoming message and take that message instead.
Take whatever message you have now, and queue it to be sent to 5 random
remailers.  Every so often, fill your queue to a constant size with dummy
messages, and send some (possibly smaller, randomly chosen) constant
number of them on their way.
All messages should, of course, be packetized to the same size, a la mixmaster.
The result of this is that, if you are a part of this network, it should
be impossible for anyone to tell when you receive a message, as opposed
to anyone else in the network (think alt.anonymous.messages, but where
the links are D-H encrypted, and you have a news feed to your own
machine, and the message sizes are all the same, and so on...).  This is
perfect for making nyms.
Sender anonymity is achieved by chaining.  If you are part of the network,
you can always claim that a message you sent was just one you received from
somewhere else (you used D-H to get the messages, so you can't identify
from where, though).
So if you're part of the network, it would seem you are indistinguishable
from anyone else on the network.  Here is where the tradeoff occurs.
How big should the network be?  If it's too small, the above anonymity
doesn't gain you much.  If it's too big, you may not be able to handle
all of the remailer traffic.
Also, what are the issues for people who aren't on the network?  It will
be very hard to prevent people from noticing that they're sending a
message to the network, or receiving one from it, so it seems the best we can
do is to avoid letting someone be able to link incoming messages to outgoing
ones.  A way to help this is to have a (smaller) number of nodes be the
only ones which send mail _out_ of the network.  One idea which I'd like to
try is having that last remailer charge postage in order to send mail out.
After all, he is the one who will take the "heat" for the anon message,
probably.  By concentrating the outgoing messages, it should be easier
to do the latency and reordering tricks.
   - Ian

@_date: 1996-07-02 07:14:20
@_author: Ian Goldberg 
@_subject: PGP Inc. buys ViaCrypt (was: Zimmerman/ViaCrypt?) 
In article <0PggPD7w165w
Muppet news flash:
I'm listening to the SAFE conference live by RealAudio, and Zimmerman just
announced that on Friday, PGP Inc. bought ViaCrypt.  He didn't give any
more details.
   - Ian

@_date: 1996-07-07 06:15:19
@_author: Ian Goldberg 
@_subject: Netscape 3.0b5 can unanonymize Anonymizer 
The new netscape has this "feature" where the RHS of KEY=value pairs in tags
can contain inline Javascript, which is evaluated to get the actual RHS.
For example, the HTML:
Did you really think you could be anonymous?
will open a new, unanonymized, window (you don't even have to click on the
link).  The main problem is that the Anonymizer doesn't filter out the
new way of embedding Javascript:
&{this.is("javascript code")};
So, if you use the Anonymizer with netscape 3.0b5, _disable_ Javascript
until this is fixed (better yet, disable Javascript and Java entirely,
but that's another story for another time...).
   - Ian

@_date: 1996-07-16 18:23:19
@_author: Ian Goldberg 
@_subject: Re: DES & IDEA built right into the Linux kernel... 
In article <199607130507.WAA25103
Except that last I checked (2.0.6) it was completely insecure.  The
DES-encrypted filesystem ignored your password and always used a key of
all 0's (which is a weak key in DES, to boot).  I've been touching it up
to do DES and IDEA _right_ (CBC mode within each block, IV based on block
number), and plan to put in some simple stego as well.
   - Ian

@_date: 1996-07-19 03:02:08
@_author: Ian Goldberg 
@_subject: Re: DES & IDEA built right into the Linux kernel... 
In article ,
Well, it seems encryption now works, and stego works, but stego'ing an
encrypted filesystem doesn't. :-(   I'll keep looking at it...
   - Ian

@_date: 1996-07-19 04:21:59
@_author: Ian Goldberg 
@_subject: Re: overseas PGPfone and Netscape 
In article <01BB74A5.CDC6BC00
I haven't tried to download it myself, yet (I'm on the wrong side of a
slow link (though it's faster since I got my new ZyXEL
yesterday)), so maybe this is explained for me, but does netscape
publish checksums for their US binaries?
This isn't just an issue of making sure your copy wasn't munged in transit;
without checksums, what's stopping netscape from embedding the info you
provide in the binary before shipping it to you, so that if it shows
up on hacktic, they know who did it?
Could various people with various architectures post MD5 or SHA1 hashes
of the files they downloaded?
   - Ian

@_date: 1996-07-21 08:20:04
@_author: Ian Goldberg 
@_subject: Re: Netscape 3.0B US version MD5 (was: Re: overseas PGPfone and Netscape) 
In article <31EF632D.2B88
But assumedly if they're downloading the 128-bit netscape, then they're
only using the 40-bit version to do it... :-)
   - Ian

@_date: 1996-07-21 08:14:29
@_author: Ian Goldberg 
@_subject: Re: Opiated file systems 
In article <199607182148.WAA00324
The fixes to the encrypted loopback filesystem support for Linux that
I'll be finishing shortly (hopehopehope) incorporate, among other things,
the following features:
o encrypted filesystems
o stego'ing a filesystem in a large (say audio) file
Now, what if you do this:
Record 1/2 an hour of music from your CD, say at 8k samples/sec, 8 bits/sample,
stereo.  In the _left_ channel, stego your real filesystem.  In the _right_
channel, stego your duress filesystem.  If the cops are suspicious that
you have a huge sound file on your hard drive and they don't believe that
it's just for audio purposes, you could (reluctantly) give up the duress key.
Does this have the properties you want?
   - Ian

@_date: 1996-07-21 08:14:25
@_author: Ian Goldberg 
@_subject: Re: Opiated file systems 
In article <199607182213.RAA10532
Charge ecash?
   - Ian

@_date: 1996-07-24 18:13:12
@_author: Ian Goldberg 
@_subject: Re: E-Cash promotion idea 
In article ,
Hey!  I've got one of those HP48's, and I'd love to use it for ecash.
Why do you reject it out of hand?
(and what if I'm _willing_ to wait however many hours to create a payment...
:-) (note that if you know what you're going to buy, payments can be created
offline, and the HP becomes simply a transport mechanism))
   - Ian

@_date: 1996-07-31 16:57:32
@_author: Ian Goldberg 
@_subject: Re: E-Cash promotion idea 
In article <1.5.4.32.19960729084347.00331d14
But don't forget that you can use a slightly modified protocol to accept
change anonymously, without having to go online!
An IOU is equivalent to a coupon.  You could even implement it as ecash
issued by the merchant, but why?  Using the "change" protocol, you can
do it with real ecash just as easily.  It's just as hard to get an
HP48 to check the signature on change coins returned by the merchant as it
is to check the signature on the IOU.
An HP48 is unlikely to be able to do 768-bit RSA operations.  However,
it could easily have coins stored on it, transmitted to the store via
a convenient IR port, or an RS232 connection.  It's quite straightforward;
if I had a store, I'd do it myself...
   - Ian

@_date: 1996-08-06 11:45:31
@_author: Ian Goldberg 
@_subject: Re: Internal Passports 
In article <199608042250.PAA13719
So does anyone have any sort of "official" list as to what constitutes
"government-issued photo-id"?  I'll be flying within California soon
(see you at Crypto...), as as a "furriner", I have no US ID.  I do have
photo-id issued by _another_ government, though (a health card; I wonder
if they'll have heard of that...).
   - Ian "I'd try to be sure to get to the airport early, but the plane
            leaves at some ridiculous time like 7:30am"

@_date: 1996-08-07 19:34:02
@_author: Ian Goldberg 
@_subject: Fixes to loop.c et al. for DES,IDEA,stego now done 
As I mentioned before, the hooks to DES (and IDEA; with Nicholas Leon's
patches) in loop.c and {mount,losetup}(8) are horribly broken.
For example, the DES key you type in is totally ignored, and only the first
byte of the IDEA key you enter is relevant.  As well, the DES code was using
PCBC mode, and IDEA was using ECB mode.
I've fixed the key management (the key is based on a SHA1 hash of the pass
phrase you enter), and changed both DES and IDEA to use CBC mode.
Adding other encryption methods (Blowfish, for example) should be
straightforward.  In fact, I'm planning to add a facility for dynamically
adding and removing general data transformation modules (maybe for 2.1...).
In addition, I've implemented steganography (hiding a filesystem in the low
bits of, say, an audio file), and fixed some assorted bugs in loop.c
(incorrect variables were being used in some places, and a deadlock was fixed
having to do with making a loop device on top of another loop device).
The patches are available from:
Since that site seems to be down a lot, there's an alternate site:
Note that there's one file that contains crypto that users outside of the
US and Canada must not download.  See below for further details and
Attached is the text version of index.html.  Share and enjoy.
   - Ian

@_date: 1996-08-09 10:49:22
@_author: Ian Goldberg 
@_subject: Re: Fixes to loop.c et al. for DES,IDEA,stego now done 
In article ,
Well, unlike CFS, loop.c is part of the Linux kernel, which is single-threaded,
so I guess loop.c is also single-threaded.  However, I took care that deadlocks
be avoided (mounting a loop device as another loop device (for example,
hiding an encrypted filesystem as stego) caused me to think a bit, but I'm
fairly confident that it works now).
   - Ian
[For those that missed it, the URL is
mirror site:

@_date: 1996-08-09 15:05:50
@_author: Ian Goldberg 
@_subject: Re: Thank you. 
In article <199608081616.SAA01670
No problem.  I urge you to push (on linux-kernel and/or
comp.os.linux.development.system) for its inclusion in the standard kernel
before 2.1 comes out.  Stego isn't that useful a feature, if the very fact
of having a modified kernel that supports it, is incriminating...
   - Ian

@_date: 1996-08-13 09:19:55
@_author: Ian Goldberg 
@_subject: [NOISE] Newspapers and basic science (was: US Power Outages) 
In article ,
Watts are a measure of energy per unit time; it makes sense to say
"60 W powers a light bulb", not "60 W powers a light bulb for one hour".
But my _favourite_ example of this was a newspaper clipping I used to have
that said that in the previous month, the city had received "160 square
pounds of rain".   That just defied common sense.
   - Ian "closely followed by temperatures 'doubling' (which happens more
          often when they use Celcius)"

@_date: 1996-08-16 08:29:31
@_author: Ian Goldberg 
@_subject: Re: Jurisdictionless Distributed Data Havens 
In article <3212B0CB.1AB7
Actually, it doesn't...  It's just that in order to use DigiCash's ecash
without an account, you need a slightly cooler client, which (AFAIK)
nobody's gotten around to writing (yet).
   - Ian "you'll have to wait until after Crypto..."

@_date: 1996-08-20 12:56:30
@_author: Ian Goldberg 
@_subject: Re: Final release of Navigator (with strong crypto) now available 
In article <3216F54C.425C
Not to mention that plugins are virtually impossible with a.out...
   - Ian

@_date: 1996-08-22 03:22:18
@_author: Ian Goldberg 
@_subject: Re: Final release of Navigator (with strong crypto) now available 
In article ,
Yes, I'm positive of it, mainly because _I_ will, especially for Linux.
   - Ian

@_date: 1996-09-17 09:53:26
@_author: Ian Goldberg 
@_subject: Unsolicited email advertising already illegal in US? 
This piece from RISKS looks interesting.  My computer certainly _is_
    "equipment which has the capacity to transcribe text or images
    (or both) from an electronic signal received over a regular
    telephone line onto paper."
Now, are HipCrime et al. liable for $500 in damages for each piece of spam?
If so, where do I sign up?
   - Ian

@_date: 1996-09-27 07:05:07
@_author: Ian Goldberg 
@_subject: Re: Where to write crypto? 
In article ,
As far as I'm aware, the rule for Canada is this:
If it came from the US, it can only be exported back to the US.
If it did not come from the US, it can be exported to any "non-evil"
country ("evil" countries are ones like Libya).
Then there are rules for what "came from" means, which are less clear.
I've also heard "substantially modified": if software comes from the US
into Canada, and is "substantially modified" in Canada, it may be
   - Ian "having a vested interest in this topic..."

@_date: 1996-10-01 10:19:42
@_author: Ian Goldberg 
@_subject: Re: POLL RESULTS 
In article ,
Just remember that "John Anonymous MacDonald" is the name that appears
on _every_ item remailed from the jam remailer, ;
it's not a nym belonging to a single person.
   - Ian

@_date: 1996-10-05 09:11:27
@_author: Ian Goldberg 
@_subject: Re: Export laws don't just affect crypto 
In article <199610011632.MAA01864
And I quote:
# (6) A launch vehicle or payload shall not, by reason of the launching of
# such vehicle, be considered an export for purposes of this subchapter.
# However, for certain limited purposes (see @ 126.1 of this subchapter),
# the controls of this subchapter may apply to any sale, transfer or
# proposal to sell or transfer defense articles or defense services.
   - Ian

@_date: 1996-10-05 15:57:16
@_author: Ian Goldberg 
@_subject: Re: encrypting pppd? 
In article <961002.235706.1R8.rnr.w165w
pppd doesn't necessarily run over a modem; you can "tunnel" it over another
IP connection.
I have in fact done this very thing.  Use ssh to (encrypted) log in to
the ppp server, and start pppd at each end.  It's been a while; I think I
had to tweak something to make it work over a pty instead of a serial port.
   - Ian

@_date: 1996-10-15 22:37:01
@_author: Ian Goldberg 
@_subject: Re: extortion via digital cash 
In article ,
Who says the kidnapper has to have an account?
   - Ian "your internal net address is showing"

@_date: 1996-10-15 23:14:51
@_author: Ian Goldberg 
@_subject: Re: extortion via digital cash 
In article <9610151846.AA00586
If you had Pipenet, or some other real-time anonymous communication system,
the extortionee could still carry out the cut-and-choose protocol by passing
the bank's requests for unblinding back to the extortionist.
   - Ian

@_date: 1996-10-17 13:27:55
@_author: Ian Goldberg 
@_subject: Re: exporting signatures only/CAPI (was Re: Why not PGP?) 
In article <199610130802.JAA00335
I remember hearing (if my memory is correct, from the mouth of a Microsoft
employee at Crypto '96) that when Microsoft signs a module, they are certifying
that they saw a signed sheet of paper swearing that either
(1) you won't export the software, or
(2) you have received an appropriate export license.
AFAIK, they don't even read the code.
   - Ian

@_date: 1996-11-02 12:02:57
@_author: Ian Goldberg 
@_subject: www.anonymizer.com down? 
In article <1.5.4.32.19961101145104.006a0c20
I would, but it seems to be unavailable.  There is currently no response
on    - Ian

@_date: 1996-11-11 14:26:53
@_author: Ian Goldberg 
@_subject: Re: WebTV a "munition" 
In article <199611091610.LAA00420
I had heard of this before, but it's odd, because the ITAR says that
among items _excluded_ from the munitions list are items:
121.1 Category XIII(b)(1)(viii):
Limited to receiving for radio broadcast, pay television or similar
restricted audience television of the consumer type, without digital encryption
and where digital decryption is limited to the video, audio or management
so it would seem a sattelite TV descrambler is not a munition.
   - Ian

@_date: 1996-11-19 19:05:53
@_author: Ian Goldberg 
@_subject: Re: Playing Cards - Caution! 
In article ,
I studied the "imperfect shuffle" thing in my Randomized Algorithms class
last year.  If I remember correctly, an "imperfect shuffle" is something like
Cut the deck into two piles, left and right.  The number of cards in
(say) the left pile is distributed binomially.
Drop one card at a time to form the new deck.  A card is dropped from the
left or right pile, with probability proportional to the number of cards
remaining in that pile.
   - Ian "someone else can figure out the entropy of this..."

@_date: 1996-12-13 14:30:33
@_author: Ian Goldberg 
@_subject: Re: ITAR -> EAR; loss of First Amendment Rights. 
In article <199612131951.LAA03511
Part 744.9(c) of the draft regs:
# (c) Definition of U.S. person. For purposes of this section, the term
#     U.S. person includes: # #       (1) Any individual who is a citizen or permanent resident alien of
#           the United States; # #       (2) Any juridical person organized under the laws of the United States
#           or any jurisdiction within the United States, including foreign
#           branches; and # #       (3) Any person in the United States.
So it would be legal to sell books to foreigners in the US, unless that would
be "provid[ing] assistance to foreign persons" (744.9(a)).  Funnily enough,
"foreign person" isn't defined anywhere in Is it safe to assume it means "a person who is not a U.S. person, as defined
in 744.9(c)"?  If that is the case, then teaching crypto classes to foreigners
in the US would be legal.
The new regs don't seem to have the exception for "mere travel outside of
the United States by a person whose personal knowledge includes technical
data" (ITAR, 120.17(1)).  Does that mean that such travel is now (or will
shortly be, when the new regs are enacted) illegal?  I find that hard to
believe (but I also find that virus checkers and firewalls are being
controlled hard to believe; hell, I find the whole crypto export policy
hard to believe).
   - Ian "heading back to Canada..."

@_date: 1996-12-26 06:32:24
@_author: Ian Goldberg 
@_subject: Re: Credentials without Identity--Race Bits 
In article <1.5.4.32.19961221065041.003d70c8
I just took my first flight with a laptop (USair), and, having heard
stories like the above, was wondering how "on" the laptop would have to
be (past the powerup password check?  I hope they're not expecting
My laptop was in my backpack, which I had oriented so that the large
face of the laptop was vertical.  It thus presented a very small cross
section to their X-ray machine, and they didn't even ask me about it.
   - Ian

@_date: 1996-12-26 07:32:58
@_author: Ian Goldberg 
@_subject: Re: Legality of requiring credit cards? 
In article <01BBF1A7.45E1F7D0
Well, I just came from Casino Niagara (Ontario side), and the cashiers'
windows all have a sign saying that the law requires them to check ID
for cash transactions of $1000 (not $10000) or more.  I don't know if
this is a general rule, or if it's just a rule for casinos.
   - Ian

@_date: 1996-12-31 11:05:28
@_author: Ian Goldberg 
@_subject: Re: Unix Passwd 
In article ,
Please note the difference between crypt(3), the C library call used to
hash passwords, and crypt(1), the user program that encrypts files.  The
former is based on DES, and has not been broken (unless someone from the
NSA wants to speak up now).  The latter is based on the Enigma machine,
and is the one that "Crypt Breakers Workbench" attacks.
   - Ian

@_date: 1996-12-31 13:05:32
@_author: Ian Goldberg 
@_subject: Re: New crypto regs outlaw financing non-US development 
In article <3.0.32.19961228225731.006b3080
But it _specifically_ restricts virus-checkers (and, also, it would seem,
backup programs, but that could be stretching it):
ECCN 5D002.c.3:
# ``Software'' designed or modified to protect against malicious
# computer damage, e.g., viruses
   - Ian "_not_ a U.S. Person"

@_date: 1997-01-28 19:00:14
@_author: Ian Goldberg 
@_subject: Last nail for US crypto export policy? 
EXPORTABLE CRYPTOGRAPHY TOTALLY INSECURE: CHALLENGE CIPHER BROKEN IMMEDIATELY
January 28, 1997 - Ian Goldberg, a UC Berkeley graduate student, announced
today that he had successfully cracked RSA Data Security Inc.'s 40-bit
challenge cipher in just under 3.5 hours.
RSA challenged scientists to break their encryption technology, offering a
$1000 award for breaking the weakest version of the code.  Their offering
was designed to stimulate research and practical experience with the security
of today's codes.
The number of bits in a cipher is an indication of the maximum level of
security the cipher can provide.  Each additional bit doubles the potential
security level of the cipher.  A recent panel of experts recommended
using 90-bit ciphers, and 128-bit ciphers are commonly used throughout
the world, but US government regulations restrict exportable US products
to a mere 40 bits.
Goldberg's announcement, which came just three and a half hours after
RSA started their contest, provides very strong evidence that 40-bit
ciphers are totally unsuitable for practical security.  "This is the
final proof of what we've known for years: 40-bit encryption technology
is obsolete," Goldberg said.
The US export restrictions have limited the deployment of technology
that could greatly strengthen security on the Internet, often affecting
both foreign and domestic users.  "We know how to build strong
encryption; the government just won't let us deploy it.  We need strong
encryption to uphold privacy, maintain security, and support commerce on
the Internet -- these export restrictions on cryptography must be
lifted,"  Goldberg explained.  Fittingly, when Goldberg finally
unscrambled the challenge message, it read: "This is why you should use
a longer key."
Goldberg used UC Berkeley's Network of Workstations (known as the NOW) to
harness the computational resources of about 250 idle machines.  This allowed
him to test 100 billion possible "keys" per hour -- analogous to safecracking
by trying every possible combination at high speed.  This amount of computing
power is available with little overhead cost to students and employees at
many large educational institutions and corporations.
Goldberg is a founding member of the ISAAC computer security research group
at UC Berkeley.  In the Fall of 1995, the ISAAC group made headlines by
revealing a major security flaw in Netscape's web browser.

@_date: 1997-01-04 09:51:02
@_author: Ian Goldberg 
@_subject: Re: New rules for Internet sales to CA buyers 
In article <3.0.32.19970102144026.0069bc00
So is this saying that a merchant _anywhere in the world_ can be prosecuted
under California law if someone in California goes to their web page,
and the web page doesn't satisfy the requirements (which I snipped)?
How is a merchant in, say, Finland, supposed to know that this law (or others
like it in any city, state, or country in the world) exists?
   - Ian

@_date: 1997-01-13 14:14:58
@_author: Ian Goldberg 
@_subject: Re: Private Idaho source code now available 
In article <199701120553.VAA10283
- From the Commerce Control List:
# 5D002.a: ``Software'' specially designed or modified for the
# ``development'', ``production'' or ``use'' of equipment or ``software''
# controlled by 5A002, 5B002 or 5D002.
# 5A002.a: Designed or modified to use ``cryptography'' employing digital
# techniques to ensure ``information security'';
5A002.a covers PGP, so it would seem that 5D002.a covers premail and
Private Idaho.
   - Ian

@_date: 1997-01-13 17:46:07
@_author: Ian Goldberg 
@_subject: Re: New US regs ban downloadable data-security software 
Lucky Green said:
After _very_ careful reading of the Export Administration Regulations (EAR)
(though IANAL), it would seem that the above is slightly inaccurate.
Although, as Lucky pointed out, virus checkers et al. are indeed regulated
for export from the US, and putting software up for ftp or WWW is considered
export, the EAR does _not_ apply to "publicly available" software
(732.2(b)(1)).  Software is publicly available "when it is available for
general distribution either for free or at a price that does not exceed
the cost of reproduction and distribution" (734.7(b)).
Therefore, it would seem that, as long as the security software on your ftp
or WWW site is free of cost, it is OK to keep it there.  Commercial
security software, however, remains export-restricted.
NOTE, however, that products that actually do contain cryptography fall under
an exception (734.7(c)): "Notwithstanding paragraphs (a) and (b) of this
section, note that encryption software controlled under ECCN 5D002 for
``EI'' reasons on the Commerce Control List (refer to Supplement No. 1
to part 774 of the EAR) remains subject to the EAR even when publicly
The software controlled for EI reasons under 5D002 are described as:
"EI controls apply to encryption software transferred from the U.S.
Munitions List to the Commerce Control List consistent with E.O. 13026
of November 15, 1996 (61 FR 58767) and pursuant to the Presidential
Memorandum of that date. Refer to Sec. 742.15 of the EAR."
As virus checkers et al. were not on the Munitions List, they are not
controlled for EI (Encryption Items) reasons, but rather for NS (National
Security) and AT (Anti-Terrorism) reasons.
The RISKS: the government suddenly creating (and putting into effect)
new rules covering large amounts of software, without warning or
(in my opinion) justification.
   - Ian "again, IANAL"

@_date: 1997-02-05 14:01:36
@_author: Ian Goldberg 
@_subject: Re: "Strong" crypto and export rule changes. 
In article <199702030626.WAA14616
Actually, it was 259 _machines_, but 4 of them were 8-processor UltraSPARCs
(by far the coolest machines I had access to), for a total of 287 processors.
The "special" network used by the NOW cluster was irrelevant; I didn't use
it at all.  I used the machines on the NOW and 120 other HP workstations
as regular TCP/IP clients.  I started them by simply logging in to each
machine, one at a time with "rsh" (well, "krsh" or "ssh" where appropriate).
   - Ian

@_date: 1997-02-07 22:40:52
@_author: Ian Goldberg 
@_subject: Re: 40-bit RC5 crack meaningless? 
In article <199702071941.LAA29283
This is a common mistake.  Just use the first block of ciphertext as the IV,
and start decrypting from the second block.  Let's say you discover that
key K causes C2,C3,... to decrypt to something intelligible (P2,P3,...),
using C1 as the IV.  What could P1 have been?  Well, we know that
(if IV is the _actual_ IV, which you don't know) E_K[IV^P1] = C1, so
IV^P1 = D_K[C1].  But we now have what is effectively a one-time pad
situation, where P1 is the plaintext, IV is the pad, and D_K[C1] is the
ciphertext.  Thus, if you don't know the IV in a CBC situation, you can
still recover all of the plaintext starting at the second block with
the same amount of work it would have taken to have recovered the whole
plaintext, given the IV (the IV does not in fact add its bits to the
strength of the key), but you learn nothing about the first block
(unless something about the protocol gives you a clue based on your knowledge
of subsequent blocks).
Disclaimer: I've been having a rough week...
   - Ian

@_date: 1997-02-05 13:15:19
@_author: Ian Goldberg 
@_subject: Re: "Strong" crypto and export rule changes. 
In article <199702030626.WAA14616
Actually, it was 259 _machines_, but 4 of them were 8-processor UltraSPARCs
(by far the coolest machines I had access to), for a total of 287 processors.
The "special" network used by the NOW cluster was irrelevant; I didn't use
it at all.  I used the machines on the NOW and 120 other HP workstations
as regular TCP/IP clients.  I started them by simply logging in to each
machine, one at a time with "rsh" (well, "krsh" or "ssh" where appropriate).
   - Ian

@_date: 1997-02-07 21:49:56
@_author: Ian Goldberg 
@_subject: Re: 40-bit RC5 crack meaningless? 
In article <199702071941.LAA29283
This is a common mistake.  Just use the first block of ciphertext as the IV,
and start decrypting from the second block.  Let's say you discover that
key K causes C2,C3,... to decrypt to something intelligible (P2,P3,...),
using C1 as the IV.  What could P1 have been?  Well, we know that
(if IV is the _actual_ IV, which you don't know) E_K[IV^P1] = C1, so
IV^P1 = D_K[C1].  But we now have what is effectively a one-time pad
situation, where P1 is the plaintext, IV is the pad, and D_K[C1] is the
ciphertext.  Thus, if you don't know the IV in a CBC situation, you can
still recover all of the plaintext starting at the second block with
the same amount of work it would have taken to have recovered the whole
plaintext, given the IV (the IV does not in fact add its bits to the
strength of the key), but you learn nothing about the first block
(unless something about the protocol gives you a clue based on your knowledge
of subsequent blocks).
Disclaimer: I've been having a rough week...
   - Ian

@_date: 1997-05-13 13:37:33
@_author: Ian Goldberg 
@_subject: Re: Unexportable crypto 
In article <199705121618.MAA09197
Actually, yes.  The cypherpunks ftp site has a program on it that helps
you break simple substitution ciphers (like newspaper cryptograms), for which
the author claims he was denied an export license.
   - Ian

@_date: 1997-05-18 22:54:49
@_author: Ian Goldberg 
@_subject: Re: Distributing cryptographic code 
In article <3.0.1.32.19970517183655.00867d60
Not the way I read the regs (IANAL)...  734.2(b) provides a completely
different definition of "export" for encryption software ((b)(9) instead
of (b)(2)(ii)).
   - Ian
    an actual shipment or transmission of items subject to the EAR out of
    the United States, or release of technology or software subject to the
    EAR to a foreign national in the United States, as described in
    paragraph (b)(2)(ii) of this section. See part 772 of the EAR for the
    definition that applies to exports of satellites subject to the EAR.
    See paragraph (b)(9) of this section for the definition that applies to
    exports of encryption source code and object code software subject to
    the EAR.
    provisions that apply to encryption source code and object code
    software.) ``Export'' of technology or software, excluding encryption
    software subject to ``EI'' controls, includes:
    For purposes of the EAR, the export of encryption source code and
    object code software means:
    States (see also paragraph (b)(9)(ii) of this section); or
    or affiliate of a foreign country.
    controlled for EI reasons under ECCN 5D002 on the Commerce Control List
    (see Supplement No. 1 to part 774 of the EAR) includes downloading, or
    causing the downloading of, such software to locations (including
    electronic bulletin boards, Internet file transfer protocol, and World
    Wide Web sites) outside the U.S., or making such software available for
    transfer outside the United States, over wire, cable, radio,
    electromagnetic, photooptical, photoelectric or other comparable
    communications facilities accessible to persons outside the United
    States, including transfers from electronic bulletin boards, Internet
    file transfer protocol and World Wide Web sites, unless the person
    making the software available takes precautions adequate to prevent
    unauthorized transfer of such code outside the United States. Such
    precautions shall include:

@_date: 1997-06-21 01:45:48
@_author: Ian Goldberg 
@_subject: Re: Fw: Advance Bank launches ecash 
In article ,
It _is_ in fact Digicash's ecash.  Do you really think it's surprising
that the Bank's press release does not mention "untraceable" or
"anonymous"? :-)
   - Ian

@_date: 1997-06-23 00:06:51
@_author: Ian Goldberg 
@_subject: Re: Party on IRC 
In article ,
It can't use crypt(3), as that's more of a hash function than a cipher,
and one would hope it doesn't use crypt(1) (though I wouldn't be very
   - Ian

@_date: 1997-06-23 08:47:04
@_author: Ian Goldberg 
@_subject: Re: Laying PipeNet 
In article <199706222045.VAA00836
I haven't used CU-SeeMe precisely because I couldn't find either source
or a Linux binary.  I do use the Mbone tools (vic, vat, etc.) somewhat
often. :-)
   - Ian

@_date: 1997-07-16 22:23:20
@_author: Ian Goldberg 
@_subject: PGP 5.0 source available (but not online yet) 
I received a copy of the latest source (12 volumes) from a PGP, Inc. rep
at the July Bay Area Cypherpunks Open Meeting on US Soil (12 July on Stanford
You can order your own copies through Printers, Inc.:
  Printers, Inc.
  301 Castro St.
  Mountain View, CA. 94041
  (415) 961-8500
  PGP 5.0 Platform Independent Source Code
   Five Volumes, $94.00   ISBN 099649654-5-3
  PGP 5.0 Win95 Source Code
   Three Volumes, $57.00  ISBN 099649654-6-1
  PGP 5.0 Mac Source Code
   Four Volumes, $82.00   ISBN 099649654-7-X
   - Ian

@_date: 1997-07-20 07:53:24
@_author: Ian Goldberg 
@_subject: Re: Verisign gets export approval 
In article <33D04A75.31E08282
It is in no way a defense service for Ian's Certificate Authority to issue
a digital certificate to Steve's Offshore Laundry, Inc. that basically
says "I think communications to the holder of this cert should use 128-bit
encryption.", even if it uses the same V3 extension that Verisign uses.
Now, if some company were to sell a browser overseas that enabled 128-bit
encryption when it saw _any_ cert with this extension (or even any such
cert from a CA in the user's trusted CAs list), I'd say it's the browser
company that's supplying the encryption, not the CA; the CA just issued
a signed statement of fact/opinion.
It would seem to me, though, that the only reason Netscape was able to
release a browser with the "128-bit-if-Verisign-magic" mode overseas
was that the USG had gotten Verisign to agree that it wouldn't issue
Verisign-magic certs to "alledged terrorists", etc.  If Verisign renegs
on the agreement, and issues the Verisign-magic certs to left-handed
albino money-laundering aliens, they'd be in violation of whatever
they signed with the USG, but certainly not in violation of the crypto
export regs (which, now that they're under Commerce, I'm not sure even have
a "defense service" category anymore).
So in answer to the original question (IMHO), you don't need the permission
of the USG to issue "magic" certs (ones with the V3 extension).  It's just
that browser companies won't be allowed to make browsers that turn on
strong encryption for _your_ "magic" certs unless the USG trusts you
not to give such certs to just anybody.
Contrasting this situation with Microsoft signing CAPI modules is left
as an exercise for the reader.
   - Ian "I believe that the bearer of this signed message should be entitled
          to use as strong crypto as he likes."

@_date: 1997-07-28 05:57:10
@_author: Ian Goldberg 
@_subject: Re: NSA leak (fwd) 
[To cypherpunks, copied to fight-censorship (which I'm not on).]
In article ,
Uh-huh.  Unless the Administration has granted a secret Executive Order
repealing the Laws of Physics for the NSA, the above statement, if true,
would imply one of the following things:
1. The NSA has a reversible computing machine with at least 2^128*128 bits
   = 5.44*10^39 bytes = 4.95*10^27 TB of memory.  Hardly.
2. Their cracker changes the state of 2^128 bits in 33 minutes.  This is
   being extremely generous; it assumes (in the style of Schneier) that
   they only have to increment a counter through each possible key, and
   that _checking_ the key is free.  Let T be the temperature at which
   they run their computer.  Again, be very generous, and assume that
   their computer is in deep space, with an ambient temperature of    about 3 Kelvins, and that their super-fast processor does not heat
   up the system, so T = 3K.
   Then their cracker would require 2^128 * k * T of energy in 33 minutes
   (k is Boltmann's constant, 1.38*10^-23 J/K).  This works out to a power
   requirement of 2^128*k*(3K)/(33*60s) = 7.12 TW (terawatts).  This
   seems also unlikely.  (Actually, for all I know, terawatt power sources
   may exist; that's out of my field.  Please let me know if this is the case.
   I just know that at my rates, 7.12 TW for 33 minutes (at about $.10/kWh)
   would cost $392 million each time they wanted to crack a key (half that
   in the average case; and of course, their electrical rates are probably
   lower than mine...).  Again, this is being _extremely_ generous in
   the energy consumption calculations.  Note also that this dollar figure
   depends only on the size of the key and your power rate; the 33 minute
   figure cancels out.)
   There could be some tradeoff in the above two cases.
3. They have a quantum computer, or some alien technology, or something
   else we know pretty much nothing about.
Given this choice, I would vote for  :-)  However, I'd go out on a limb
and say that the NSA guy was simply lying (or that the anecdote itself is
   - Ian

@_date: 1997-07-30 00:56:06
@_author: Ian Goldberg 
@_subject: Re: y2k problem *serious* 
In article ,
Sigh.  It boggles the mind how many people know the 100-year exception to the
"divisible by 4" rule, but don't know the 400-year exception to the exception.
    Is the year 2000 a leap year?     The year 2000 will be a leap year. Century years (like 1900 and 2000)
    are leap years only if they are evenly divisible by 400. Therefore, 1700,
    1800, and 1900 were not leap years, but the year 2000 will be a leap year.
    To understand this, you need to know why leap years are necessary in
    the first place. Leap years are necessary because the actual length of
    a year is 365.242 days, not 365 days, as commonly stated. Therefore,
    on years that are evenly divisible by 4 (like 1992, for example) an
    extra day is added to the calendar on February 29th. However, since the
    year is slightly less than 365.25 days long, adding an extra day every
    4 years results in about 3 extra days being added over a period of 400
    years. For this reason, only 1 out of every 4 century years is considered
    as a leap year.
Note that (from  :)
    The Time and Frequency Division is an operating unit of the Physics
    Laboratory of the National Institute of Standards and Technology
    (NIST). Located in Boulder,Colorado at the NIST Boulder Laboratories,
    the Time and Frequency Division:
    o Maintains the primary frequency standard for the United States.
    o Develops and operates standards of time and frequency.
    o Coordinates U. S. T&F standards with other world standards.
    o Provides time and frequency services for United States clientele.
    o Performs research in support of improved standards and services.
So if NIST says 2000 will be a leap year, that would seem to be "official"
(at least for the US).
   - Ian "who's going to be sorry he bothered responding"

@_date: 1997-07-31 04:30:22
@_author: Ian Goldberg 
@_subject: Re: Cryptography Question (I hope it's not off-topic on this list) 
In article ,
Careful, here.  3DES gives us a benefit because we can chain crypto at
the algorithm level.  Chaining several passes of DES may not give this
benefit if all we have is an opaque program that block-pads the input
and does raw DES on that.  For example (the values are imaginary),
DES("foo") = DES_raw("foo\x05\x05\x05\x05\x05") = "f983hgls"
DES(DES("foo")) = DES("f983hgls") =
   DES_raw("f983hgls\x08\x08\x08\x08\x08\x08\x08\x08") = "d84koqw78452398f"
DES(DES(DES("foo"))) = DES("d84koqw78452398f") =
   DES_raw("d84koqw78452398f\x08\x08\x08\x08\x08\x08\x08\x08") =
   "ecy34895y34057834985634y";
whereas 3DES("foo") = 3DES_raw("foo\x05\x05\x05\x05\x05") = "ecy34895"
To break DES(DES(DES("foo"))), break the outer DES until you find
"\x08\x08\x08\x08\x08\x08\x08\x08" at the end of the "plaintext" (actually,
the padded value of DES(DES("foo"))).  Repeat until you get "foo".
[It is left as an exercise to the reader to determine why you might not
be able to merely chop the last 8 bytes off the output of the second and
third DES iterations to get around this problem.]
   - Ian

@_date: 1997-08-09 06:10:38
@_author: Ian Goldberg 
@_subject: Re: Exit Remailer Suggestion 
In article <199708080936.KAA01816
Sounds good to me.  Hotmail makes a note of the IP address that connected
to it, but luckily there's no shortage of HTTP proxies out there...
   - Ian
 -w
 sendhotmail: pipe an RFC822 mail message into this, and it will send it
              out from a hotmail account via an HTTP proxy
 Initial revision 19970808 by Ian Goldberg  Set the following to your proxy host and port.
  Look at the files pointed at by
     for sample entries, but most of them don't allow just anyone to connect
  to hotmail through them.
$proxyhost = 'proxy.slt.lk';
$proxyport = 8080;
 This is your hotmail login name and password
$login =  Fill this in yourself
$passwd =  Fill this in yourself
 End Configuration
sub escapetext {
    my $t = $_[0];
    $t =~ s/([\000-\037\200-\377\{\}\|\\\^\[\]\`\"\<\>\:\
    $t =~ s/ /+/g;
    $t;
 Parse the incoming mail (note that we don't handle continuation headers)
 Also, the To, Cc, and Bcc headers ought to be in a form hotmail understands
 (no full names, etc.).  We try to do the stripping properly.
$to = '';
$subject = '';
$cc = '';
$bcc = '';
while() {
    if (/^To:\s+(.*)/io) {
    } elsif (/^Subject:\s+(.*)/io) {
    } elsif (/^Cc:\s+(.*)/io) {
    } elsif (/^Bcc:\s+(.*)/io) {
    }
    last if /^$/;
$msg = &escapetext(join("\r\n", ));
use LWP;
 Begin magic
$ua = new LWP::UserAgent;
$ua->proxy('http', "
$url = new URI::URL '
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\"/io or die "Cannot log in";
$url = new URI::URL $1, $url;
$body = $';
$body =~ s/\<\s*\/form\s*\>.*//;
$body =~ /\<\s*input\s+[^>]*name=\"disk\"\s+value(=\"(.*?)\")?/io or die "Cannot give passwd";
$disk = $2 || "";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/compose.*?)\"/io or die "Cannot compose";
$composeurl = new URI::URL $1, $url;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/logout.*?)\"/io or die "Cannot compose";
$logouturl = new URI::URL $1, $url;
$request = new HTTP::Request('GET', $composeurl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\".*?\>/io or die "Cannot send message";
$url = new URI::URL $1, $composeurl;
$body = $';
$data = '';
while(1) {
    $body =~ /^\s*\<\s*input\s+type=\"?hidden\"?\s+name=\"(.*?)\"\s+value(=\"(.*?)\")?\s*\>/io or last;
    $name = $1; $value = $3 || ""; $body = $';
    $data .= $name."=".$value."&";
$data .= "to=${to}&subject=${subject}&cc=${cc}&bcc=${bcc}&body=${msg}&Send.x=1&Send.y=1";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$request = new HTTP::Request('GET', $logouturl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);

@_date: 1997-08-13 11:05:30
@_author: Ian Goldberg 
@_subject: sendhotmail, version 1.2 
Here's version 1.2 of sendhotmail.
Now the only configuration option in the perl script itself is the location
of a config file.  That file should have the following form (you should change
the pathnames of the local files, of course):
---8<--- sample config file ---8<---
 The URL from which to fetch the current list of active proxies
Proxy List URL:  The file in which to cache the above list
Proxy List Cache File: /home/iang/sendhotmail/proxy_list.txt
 How many days to cache the proxy list
Proxy List Cache Age: 1
 The file containing the list of hotmail accounts
Account List File: /home/iang/sendhotmail/accountlist
---8<--- sample config file ---8<---
Also, you'll need a list of valid hotmail account names/passwords in the
account list file to which you pointed, above.  This file contains a number
of lines, each of the form "login:password".  For example:
---8<--- sample accountlist file ---8<---
---8<--- sample accountlist file ---8<---
sendhotmail now picks a proxy and hotmail account at random.  I'll try to
keep the proxy list relatively up-to-date, and you need to keep your
account list up-to-date (in case Hotmail shuts one down, or something).
The perl program will "die" if something unexpected happens (such as the
proxy it chose didn't work, or the hotmail account was suddenly invalid).
Just try running it again (future versions will likely automatically
retry with different random choices for the proxy and the hotmail login).
   - Ian
 -w
 sendhotmail: pipe an RFC822 mail message into this, and it will send it
              out from a hotmail account via an HTTP proxy
 Program by Ian Goldberg use LWP;
$uadirect = new LWP::UserAgent;
 The filename of the configuration file
$configfile = '/home/iang/sendhotmail/config';
 Read the config file
open(CONFIG, $configfile) or die "Cannot open $configfile: $!\n";
while() {
    next if /^\s*$/o;
    next if /^\s*\
    next unless /^([^:]+):\s*(.*)$/o;
    $value = $2;
    $name = "\L$1\E";
    $name =~ s/[^a-z0-9]//iog;
    $config{$name} = $value;
 Get the proxy list
$proxylisturl = new URI::URL ($config{'proxylisturl'} ||
if (defined $config{'proxylistcachefile'}) {
     Check if the locally cached copy is new enough
    $maxage = $config{'proxylistcacheage'} || 1;
    if (! -e $config{'proxylistcachefile'} ||
    }
     Read the proxy list
    open(CACHE, $config{'proxylistcachefile'}) or
     = grep (s/\n// && /^[^ );
    close(CACHE);
} else {
     Just fetch from the net
    $request = new HTTP::Request('GET', $proxylisturl);
    $request->header(Pragma => 'no-cache');
    $response = $uadirect->request($request);
     = grep (/^[^ split("\n", $response->content));
 = ('secure.escape.ca:80') if $ == -1;
 Get the account list
if (defined $config{'accountlistfile'}) {
    open(ACC, $config{'accountlistfile'}) or
     = grep (s/\n// && /^[^ );
    close(ACC);
 = ('ldeliverer:xxxx') if $ == -1;
sub escapetext {
    my $t = $_[0];
    $t =~ s/([\000-\037\200-\377\{\}\|\\\^\[\]\`\"\<\>\:\
    $t =~ s/ /+/g;
    $t;
sub getaddrs {
    my  = split(/,\s*/, $_[0]);
    my ($a, $ra);
    my     foreach $a ( {
    }
    join(', ',  Parse the incoming mail.  We need to put the To, Cc, and Bcc headers
 into a simple format that hotmail can understand.
$header{'to'} = '';
$header{'subject'} = '';
$header{'cc'} = '';
$header{'bcc'} = '';
$curheader = '';
while() {
    last if /^$/;
    chomp;
    if (/^\S/) {
    }
    if ($curheader ne '') {
    }
$header{'to'} = &getaddrs($header{'to'});
$header{'cc'} = &getaddrs($header{'cc'});
$header{'bcc'} = &getaddrs($header{'bcc'});
$msg = &escapetext(join('', ));
 Choose a proxy and account at random
srand(time ^ $$);
$proxy = $proxylist[int rand ($
($login, $passwd) =
    $accountlist[int rand ($ =~ /^([^:]*):(.*)$/;
 Begin hotmail-specific magic
$ua = new LWP::UserAgent;
$ua->proxy('http', "
$url = new URI::URL '
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\"/io or die "Cannot log in";
$url = new URI::URL $1, $url;
$body = $';
$body =~ s/\<\s*\/form\s*\>.*//;
$body =~ /\<\s*input\s+[^>]*name=\"disk\"\s+value(=\"(.*?)\")?/io or die "Cannot give passwd";
$disk = $2 || "";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/compose.*?)\"/io or die "Cannot compose";
$composeurl = new URI::URL $1, $url;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/logout.*?)\"/io or die "Cannot compose";
$logouturl = new URI::URL $1, $url;
$request = new HTTP::Request('GET', $composeurl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\".*?\>/io or die "Cannot send message";
$url = new URI::URL $1, $composeurl;
$body = $';
$data = '';
while(1) {
    $body =~ /^\s*\<\s*input\s+type=\"?hidden\"?\s+name=\"(.*?)\"\s+value(=\"(.*?)\")?\s*\>/io or last;
    $name = $1; $value = $3 || ""; $body = $';
    $data .= $name."=".$value."&";
$data .= "to=$header{'to'}&subject=$header{'subject'}&cc=$header{'cc'}&bcc=$header{'bcc'}&body=${msg}&Send.x=1&Send.y=1";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$request = new HTTP::Request('GET', $logouturl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);

@_date: 1997-08-14 06:55:43
@_author: Ian Goldberg 
@_subject: sendhotmail, version 1.3 
And here's 1.3.  It uses the same config file as 1.2.
o fixes a bug involving + in email addresses
o handles continuation headers properly
o Can be used as a drop-in replacement for sendmail (though it may get confused
  if you pass weird sendmail options); it will keep trying random hotmail
  accounts and proxies until it succeeds in delivering the mail.  Note that,
  depending on your connectivity, this can take a while...
   - Ian
 -w
 sendhotmail: pipe an RFC822 mail message into this, and it will send it
              out from a hotmail account via an HTTP proxy
 Version 1.3: 19970813
 Program by Ian Goldberg sub Usage {
    die "Usage: $0 -t | addr\ ...\n";
 Check options
$cmdlineto = '';
while ($ >= 0 && $ARGV[0] =~ /^-/o) {
    $_ = shift     if ($_ eq "-t") {
    } elsif ($_ eq "-f") {
    } else {
    }
if ($ >= 0) {
    $cmdlineto = join(", ", use LWP;
$uadirect = new LWP::UserAgent;
 The filename of the configuration file
$configfile = '/home/iang/sendhotmail/config';
 Read the config file
open(CONFIG, $configfile) or die "Cannot open $configfile: $!\n";
while() {
    next if /^\s*$/o;
    next if /^\s*\
    next unless /^([^:]+):\s*(.*)$/o;
    $value = $2;
    $name = "\L$1\E";
    $name =~ s/[^a-z0-9]//iog;
    $config{$name} = $value;
sub escapetext {
    my $t = $_[0];
    $t =~ s/([\000-\037\200-\377\{\}\|\\\^\[\]\`\"\<\>\:\
    $t =~ s/ /+/g;
    $t;
sub getaddrs {
    my  = split(/,\s*/, $_[0]);
    my ($a, $ra);
    my     foreach $a ( {
    }
    join(', ',  Parse the incoming mail.  We need to put the To, Cc, and Bcc headers
 into a simple format that hotmail can understand.
$header{'to'} = '';
$header{'subject'} = '';
$header{'cc'} = '';
$header{'bcc'} = '';
$curheader = '';
while() {
    last if /^$/;
    chomp;
    if (/^\S/) {
    }
    if ($curheader ne '') {
    }
 If we were given command-line addresses, that overrides the headers
$header{'to'} = &getaddrs($cmdlineto eq '' ? $header{'to'} : $cmdlineto);
$header{'cc'} = &getaddrs($cmdlineto eq '' ? $header{'cc'} : '');
$header{'bcc'} = &getaddrs($cmdlineto eq '' ? $header{'bcc'} : '');
$msg = &escapetext(join('', ));
srand(time ^ $$);
 Keep trying until the message is successfully delivered
RETRYLOOP: while (1) {
 Get the proxy list
$proxylisturl = new URI::URL ($config{'proxylisturl'} ||
if (defined $config{'proxylistcachefile'}) {
     Check if the locally cached copy is new enough
    $maxage = $config{'proxylistcacheage'} || 1;
    if (! -e $config{'proxylistcachefile'} ||
    }
     Read the proxy list
    open(CACHE, $config{'proxylistcachefile'}) or
     = grep (s/\n// && /^[^ );
    close(CACHE);
} else {
     Just fetch from the net
    $request = new HTTP::Request('GET', $proxylisturl);
    $request->header(Pragma => 'no-cache');
    $response = $uadirect->request($request);
     = grep (/^[^ split("\n", $response->content));
 = ('secure.escape.ca:80') if $ == -1;
 Get the account list
if (defined $config{'accountlistfile'}) {
    open(ACC, $config{'accountlistfile'}) or
     = grep (s/\n// && /^[^ );
    close(ACC);
 = ('ldeliverer:xxxx') if $ == -1;
 Choose a proxy and account at random
$proxy = $proxylist[int rand ($
($login, $passwd) =
    $accountlist[int rand ($ =~ /^([^:]*):(.*)$/;
 STDERR "Trying $login through $proxy\n";
 Begin hotmail-specific magic
$ua = new LWP::UserAgent;
$ua->proxy('http', "
$url = new URI::URL '
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\"/io or next RETRYLOOP;
$url = new URI::URL $1, $url;
$body = $';
$body =~ s/\<\s*\/form\s*\>.*//;
$body =~ /\<\s*input\s+[^>]*name=\"disk\"\s+value(=\"(.*?)\")?/io or next RETRYLOOP;
$disk = $2 || "";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/compose.*?)\"/io or next RETRYLOOP;
$composeurl = new URI::URL $1, $url;
$body =~ /\<\s*area\s+[^>]*href=\"(\/cgi-bin\/logout.*?)\"/io or next RETRYLOOP;
$logouturl = new URI::URL $1, $url;
$request = new HTTP::Request('GET', $composeurl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*form\s+[^>]*action=\"(.*?)\".*?\>/io or next RETRYLOOP;
$url = new URI::URL $1, $composeurl;
$body = $';
$data = '';
while(1) {
    $body =~ /^\s*\<\s*input\s+type=\"?hidden\"?\s+name=\"(.*?)\"\s+value(=\"(.*?)\")?\s*\>/io or last;
    $name = $1; $value = $3 || ""; $body = $';
    $data .= $name."=".$value."&";
$data .= "to=$header{'to'}&subject=$header{'subject'}&cc=$header{'cc'}&bcc=$header{'bcc'}&body=${msg}&Send.x=1&Send.y=1";
$request = new HTTP::Request('POST', $url);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
$body = $response->content;
$body =~ /\<\s*title\s*\>\s*Hotmail\s*-\s*Mailbox/io or next RETRYLOOP;
$request = new HTTP::Request('GET', $logouturl);
$request->header(Pragma => 'no-cache');
$response = $ua->request($request);
last RETRYLOOP;   Success

@_date: 1997-09-03 03:38:28
@_author: Ian Goldberg 
@_subject: Re: Things we should be working on... 
In article ,
I have to disagree here.  The export issue is very important to me.
For me, crypto export isn't about Netscape getting their 128-bit crypto
overseas; it's about me being allowed to publish my research on the net,
or give "technical assistance" to foreigners.  As long as the current
export regs are in place, my ability to publish, collaborate in, and
by extension, perform, research in pure or applied cryptography is
severely hampered.
The effect the crypto regs have on me is that any time I want to actually
_implement_ something and publish it, I have to wait for school breaks,
go home (to Canada), do all of the work there, and publish it from there
before I return to Berkeley.  This obviously cuts down on the rate at which
I can get things done.  Americans don't even have this option. If not
for problems like this, S/WAN would certainly be further along than it is
   - Ian

@_date: 1997-09-04 00:25:00
@_author: Ian Goldberg 
@_subject: Re: Things we should be working on... 
In article <199709022216.XAA00915
I'm not primarily talking about _products_, here; I'm not selling stuff.
I'm just trying to publish!  Part of my research (which focuses on computer
security) involves (surprise) building secure systems or breaking insecure
ones.  Where this involves cryptography or cryptanalysis, I am prohibited
from publishing these systems on the Net, from my homepage (and I don't
_want_ to put access control on my homepage).
To answer Tim: for example, when I was in Canada last, I wrote Top Gun ssh
(secure shell for the Pilot) from the ground up.  It would be hard to
understand how this could be a violation of US export regs, when nothing
involved ever _entered_, let alone was _exported_ from, the US.
I do understand that US citizens and Permanent Residents are prohibited
from giving crypto to foreigners even when they are outside of the US,
but I'm neither of those.  The BXA _could_ try the old "let's tax all
foreigners living abroad" tactic, of course...
   - Ian

@_date: 1997-09-15 00:41:34
@_author: Ian Goldberg 
@_subject: Re: Note to Net-lobbyists: give it up already, abandon Congress 
In article ,
Only if the court challenges get decided in our favour, and go all the way
up the Supreme Court without being struck down.  The current situation
is terrible.  I agree that it's unlikely that legislation will be able to be
passed that would fix this.  The court challenges, of course, move slowly.
   - Ian

@_date: 1997-09-30 05:18:27
@_author: Ian Goldberg 
@_subject: Re: Remailer Ecash Bounty 
In article <86bf420d7b91c105780c596aac21863f
Done.   accepts messages of the form:
Request-Remailing-To: luser
 > -----BEGIN ECASH PAYMENT-----
 >  > oLmQgwAC5qGgiqCukIFPkIECkIEZkIEEkIEDkYQ0MBDNkIQ0XjVNkIFPkpJDeXBo
 > ZXJwdW5rcyBDYW5hZGGUlOy30rxoVWzRj2FUEDm3bTSxv3pJlJTaOaPuXmtLDTJV
 > v++VYBiQr9gHCZCBEJKAkoCUgJCBAJGEAAAAAJCBAKGguKCrkIICAJPgPylA2DY6
 > zQ4/J1GgVNbIf583iwRnYYTIOoTXYepGbfOakKFVg1muz3EOzkPrZbS8YlLPLZP5
 > 16iq+A5JFd9g/0HAXyP3ugcxpGQSTcl2xZthaK5DYdnw1NS/ZRUbcSwXk+AzVqnq
 > 5zTSngOAXvXu4NE5e2TuhwoFCV0FWfQngdjnP+TCFZLsfCYhGrkjVi59FdNgvcOX
 > tRRh26dpImGlB3xoBymUE/hKW2LGnb8DplywwFAJCjOW8zExyXn7iCAye+qQgQGh
 > oKuQggIDk+A/UDTdM1Id10cZf2ETXN77AlJD9NEizrzCQaBEzzhFmjJoziqMbYZu
 > hyfjjKFbHP3JkMhfZ4UwhG57hpD6JM4QXJ5N+RgjLaN8f4LQlDtBVuki+FeWMDcA
 > ZjhLV1N//oKT4DDG016p9/EZCZZiFL7prITgWEusumlENbPKM8dPEPc4Wky5BQm9
 > k8BQpAFWmJ773qpzO3AioNjid9ZVefV8dXZ/QkmPGOSR+LZSudVJJm7+NcsJhnlv
 > NKQmg7/PrnCu+5CBCKGgq5CCAgST4CQKMhd8S1j63UhO9N8T1mEg10ffj+2C3Y6N
 > 39aI3LicANxLk7cLJzyGi9oT+yy22QBnQJO0eBA7t26hJVJOA7gLIr+lW49jgmQ+
 > 1Y17RKG8D4tOb20PzI2JFX5A0JpZfZPgrdcLz1LSmU8+si5Z0503x4qs8aDzJGu9
 > B2IyfstgkLxIZVDoagcbrxoiu++POrX0UFNE/KG5jJ4aYOuTj/48EN6Gv/VWigs6
 > pieDeUj+h1nWKIvn1jCaRTV1MhnYKU3ykIEQoaGh
 > -----END ECASH PAYMENT-----
This is the body of the message to be remailed.
The ecash payment should be in the amount of USD 0.25, made out to
"Cypherpunks Canada".  Messages sent to that do not contain a valid payment will be turned into heat.  The
PGP key for  is the same as that for
.  Do _not_ encrypt the ecash payment.
You can send your $50 to me in ecash, of course. :-)  Make it out to
"Cypherpunks Canada", and email it to me at .
   - Ian

@_date: 1997-09-30 11:10:59
@_author: Ian Goldberg 
@_subject: Re: Remailer Ecash Bounty 
In article <60p4q2$giu$1
Just to let you know, I received the payment from Monty.
   - Ian

@_date: 1997-10-05 07:29:29
@_author: Ian Goldberg 
@_subject: Re: Peter Landrock's CRYPTO 97 rump session 
In article <199709261614.KAA00562
IIRC, it only worked for e=3.  In that case, since gcd(e,(p-1)(q-1)) = 1,
we must have that p and q are each 2 mod 3.  Then, since (p-1)(q-1) | de-1,
we have that e d - r (p-1)(q-1) = 1 for some positive integer r.
Taking this mod 3, we see that r is 2 mod 3.  But r = (ed-1)/[(p-1)(q-1)]
< (3(p-1)(q-1)-1)/[(p-1)(q-1)] < 3, so r=2.  Thus d = [2(p-1)(q-1)+1]/3
= 2(n-p-q)/3 + 1.  If p and q are each about half the length of n, then
d agrees with 2(n-1)/3 for about its first half.
   - Ian

@_date: 1997-11-22 10:07:23
@_author: Ian Goldberg 
@_subject: Re: Personal use crypto export 
In article ,
So I can't take my laptop to Anguilla, right?  (I'm not a US citizen or
permanent resident; I'm pretty sure I don't fall under the TMP exception
either, but I haven't checked in a while.)
   - Ian

@_date: 1998-10-30 01:00:38
@_author: Ian Goldberg 
@_subject: Re: Shuffling (fwd) 
In article <199810291325.HAA19001
The "7 times" theorem uses the following model of a shuffle:
o The deck is cut into two parts, with the number of cards in each piece
    binomially distributed (with mean 26, of course).
o The resulting deck is then achieved by having cards fall from one or the
    other of the two parts; a card will fall from one of the parts with
    probability proportional to the number of cards remaining in the part.
   - Ian "Who took a course in Randomized Algorithms last year"

@_date: 1998-10-31 03:18:33
@_author: Ian Goldberg 
@_subject: Re: Shuffling (fwd) 
In article <199810291716.LAA19879
   "It's only a model."  -- Monty Python and the Holy Grail
It actually _does_ address the normal, statistical clumping that goes on.
It _doesn't_ address clumping that occurs because, say, you were playing
poker while eating a peanut butter sandwich. :-)
   - Ian

@_date: 1998-10-31 04:56:02
@_author: Ian Goldberg 
@_subject: Re: Shuffling (fwd) 
In article <199810301934.NAA26157
That's true.  That's why you need to do it seven times, in order to
properly randomize the deck.
It's for exactly this reason that players at computer-dealt bridge
tournaments complain about "flat" distributions.  When they play in
"real life", people usually don't shuffle seven times, and the resulting
suit distributions end up skewed ("ghoulies" is the extreme case of this).
The players are used to this, though, and when they get actual random
hands, the distributions are much flatter.
   - Ian
