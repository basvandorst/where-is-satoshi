
@_date: 1993-02-05 00:02:23
@_author: Phil Karn 
@_subject: spread spectrum synchronization 
Synchronization is indeed one of the more complex parts of a spread
spectrum system. But there are standard, well studied ways to do it,
and any of several textbooks have good descriptions. It's more tedious
than difficult. A good job for VLSI.
The "gold codes" you mention are simply one family of spreading
sequences.  There are others.  You'd search for signals that use them
in the same way you'd search for any kind of spreading sequence -- by
searching the sequence space until you find a correlation between the
incoming signal and your local copy of the spreading sequence. You
detect this by the sudden increase in narrowband signal energy seen at
the output of the despreader around the nominal carrier frequency when
you're within a chip of the correct time. You then lock onto and track
the spreading sequence with a circuit very similar to a phase locked
Practical spread spectrum systems aid this process either by
synchronizing the spreading sequence to a common clock source, or by
using a small enough spreading sequence to make searching the entire
sequence feasible.
In our CDMA cellular system, we use both approaches and several
ordinary LSFR PN sequences (not Gold codes). There's a "short PN" code
(2^15 chips long) common to all cells that can be found by a mobile
within a few seconds of being turned on, and an additional per-user
"long code" (2^47-1 chips) that is synchronized with the aid of GPS
receivers at the cells. Both operate at the same chip rate (1.2288
The gory details can be found by anonymous FTP to lorien.qualcomm.com,
in /pub/cdma. Read the "overview" document first.

@_date: 1993-03-23 02:46:23
@_author: Phil Karn 
@_subject: your note on sci.crypt 
Dr. Denning:
Although you are correct that many of the responses to your proposal
contained personal attacks (in which people called you naive, etc),
you seem to believe that this invalidates the fundamental underlying
point they were making.  This is not so.
This fundamental point can be summarized as follows:
The US government has repeatedly shown by its past conduct that it
simply cannot be trusted to obey its own laws regarding spying on
private citizens, particularly those who are organized in lawful,
peaceful opposition to government policies. And history has shown that
it can take many years for unlawful monitoring to become public, if
indeed they ever do (consider the current story I just sent you about
the Army spying on Dr. Martin Luther King). In other words, the
government has frequently ignored its own laws, because it knows it
can do so with impunity.
No credible case can be made that the problem has been "fixed" since
the now-publicized abuses of the 1960s and 1970s, i.e., that new
safeguards have somehow rendered the government incapable of violating
the privacy rights of its citizens. Privacy violations may or may not
still be occurring; we have no way to know. But I suspect it depends
far more on the people in power than on any post-Watergate
"safeguards" against the abuse of that power.
The private use of strong cryptography provides, for the very first
time, a truly effective safeguard against this sort of government
abuse. And that's why it must continue to be free and unregulated.
I should credit you for doing us all a very important service by
raising this issue. Nothing could have lit a bigger fire under those
of us who strongly believe in a citizens' right to use cryptography
than your proposals to ban or regulate it.  There are many of us out
here who share this belief *and* have the technical skills to turn
it into practice. And I promise you that we will fight for this belief
to the bitter end, if necessary.
Phil Karn

@_date: 1993-04-18 00:20:07
@_author: Phil Karn 
@_subject: Thoughts on the proposal 
Some points to add, some of which I don't think have been made yet.
It is entirely possible that Clinton, if he understands anything at
all about this proposal, sincerely thinks that he's helping the cause
of personal privacy. Consider that his entire education on the
subject of cryptography probably consisted of a 5 minute briefing
that probably went something like this:
And I bet that this would sound perfectly reasonable to the average
man on the street, too.
Well...I'd say we know better. And we have a big educational job to
do.  We need to let the public know that civilian cryptography is
already quite good. Good enough that the communications industry
doesn't need any "help" in the form of new chips from the government
to secure its communications, thank you very much. And simple and
cheap enough that it would have already have been made widely
available in products such as digital cellular telephones if the
government hadn't considered it "too good" and done everything they
could behind the scenes to stop it.
Clinton needs to learn that if he *really* wants to help the cause of
civilian cryptography, he only needs to call off the goons over in
NSA.  We don't need their "help". We just want them to get the hell
out of our private conversations and our private lives.

@_date: 1993-04-18 15:31:38
@_author: Phil Karn 
@_subject: voice privacy for the masses 
I think Hal Finney's analysis is not far from the mark. Saner elements
in the government probably do realize the utter impossibility of a
complete ban on uncrackable crypto given the existence of talented,
knowledgeable and highly motivated (especially now!) "cypherpunks".
But the government has also found that with very little effort, they
can still have an enormous practical effect on the non-cypherpunk
masses.  Heck, look at what the NSA did to the digital cellular
standards by standing in the shadows and quietly threatening to
withhold export approval to phones with meaningful technology.
The NSA barely had to whisper its objections, because the industry
simply doesn't care very much about customer privacy. Certainly not
enough to risk not only their non-US markets, but also the ability to
have phones manufactured overseas for the US market. And then NSA rubs
salt in the wound by brazenly claiming that they're only concerned
about encryption getting into the hands of unfriendly foreign
governments. As far as they're concerned, they say with a perfectly
straight face, Americans are free to use any encryption scheme they
I wonder how people like that can sleep at night.
Well, the implications are obvious. If the public is ever to benefit
on a large scale from strong encryption technology, it cannot depend
on a normal market to sell it to them in turnkey packages. As soon as
you go into business overtly selling such packages, the government
pressure will begin. They will make sure that you do not become too
successful, either by banning exports or by flooding the market with
inferior technology that they can break (like Clipper).
So we need to create a rather nonconventional "market". More
specifically, we need to find a way to bring the efforts of the
cypherpunks to the public with minimal cost and in a way that the
government cannot control.
By far the best way to do this is to write and distribute free crypto
software that requires only readily available general purpose hardware
to run. As we know, duplicating and distributing software is so
trivial that controlling it is virtually impossible. And while it's
theoretically somewhat easier for the government to ban or regulate,
say, modems faster than 2400 bps or CPUs faster than 10 MHz 286s,
general purpose computer hardware like this has so many other
"legitimate" uses that in practice a ban would again be impossible.
I've contributed a little to this effort myself with my public domain
DES code, but it's the PGP effort that has really made this a reality.
PGP is now unstoppable, and it's well on the way toward providing
large scale privacy for email and other textual information.
But voice is still a problem. What we really need now is "PGVP"
("Pretty Good Voice Privacy"), i.e., a package of public domain
software that, when again combined with readily available general
purpose computer hardware, produces a highly secure telephone.
We already have two of the three hardware components of a digital
secure telephone well in hand: CPUs capable of encrypting digital
voice in real time, and reasonably fast telephone modems. The one
remaining piece to the puzzle is the vocoder, as conventional waveform
sampling of speech produces a data rate too high for telephone modems.
(Faster modems might alleviate the need for a low bit rate vocoder,
but current generation modems are already running very close to
theoretical limits, and there won't be too many more improvements.)
Ready-made vocoders are available. In fact, my company (Qualcomm) just
announced one (the Q4400) as a spinoff of our CDMA digital cellular
system.  It's a mask-programmed AT&T DSP-16A DSP chip. Unfortunately,
like many leading-edge products, it's not cheap: $69/ea in quantity
1000, and reportedly nearly $200 in small quantities.
A second alternative is to run your own vocoder software. But vocoders
are notoriously compute-intensive, and they're traditionally run on
DSPs.  And DSPs do not yet qualify as "widely available general
purpose computer hardware".
That leaves a third possibility: tuning vocoder software to run in
real time on a fast general purpose processor like a 486. John Gilmore
has already obtained and distributed public domain code that
implements the Federal standard CELP vocoder algorithm (used in
government secure telephones, a nice twist) but my understanding is
that it's too slow to run in real time on popular computers. Van
Jacobson at LBL has reportedly tuned it to run in better than real
time on a Sparc 1+, but he hasn't released it yet and he's a
notoriously hard guy to get ahold of.
So the request of the day is this: who's willing to take that CELP
code, bum enough instructions out of it so it will run in real time on
a 486, and place his or her work back out into the public domain?

@_date: 1993-06-01 19:55:14
@_author: Phil Karn 
@_subject: eavesdropping druggies 
Today's San Diego Union Tribune has a locally-written article on the
investigation into the murder of the Mexican cardinal by drug gangs.
The title is "Drug gangs eavesdrop on rivals", and begins as follows:L
"TIJUANA - The two rival drug gangs whose attempts to kill each other's
leadership have left a Mexican cardinal and six others dead apparently
have been using sophisticated electronic gear to monitor each other's
movements, Mexican authorities reported yesterday.
"In addition to the assault rifles, grenades and police and army uniforms
being discovered in a series of safe houses, Mexican federal police are
reporting finding devices designed to trace and monitor calls made from
cellular telephones.
"They also are finding sophisticated communications-monitoring equipment,
walkie-talkies, tape recorders and pages upon pages of documents."
The article continues with other developments in the investigation unrelated
to electronic eavesdropping.
A few (semi-serious) thoughts come to mind:
1. Perhaps the government doesn't want secure telephones in the hands of
the drug lords not so much because it will thwart wiretapping by law
enforcement, but because it will protect the gangs from each other --
and they aren't inhibited by Constitutional requirements.
2. Gee. I thought the cellular eavesdropping problem was completely
solved by the recent ban on cellular-capable scanners.
3. I can't wait for the Federales to discover computers with PGP in
one of these safehouses. And when it does, expect all hell to break
loose in the crypto propaganda war.

@_date: 1993-06-24 13:51:50
@_author: Phil Karn 
@_subject: Triggerfish 
I just posted this to the CU (Computer Underground) digest in response
to a most interesting series of items about the newsletter Full
Disclosure's public mention of a Harris Corporation device marketed to
law enforcement agencies for intercepting cellular telephone
conversations named "Triggerfish".  Harris responded with an amazing
threat to sue the newsletter for a variety of offenses, including
trademark infringement (for merely mentioning the product in a brief
"new products" editorial).
The CU digest can be read on the usenet newsgroup
comp.society.cu-digest; the issue in question is Volume 5, Issue 46.
Reply-To: karn
In CU Digest 5.46:
I find the phrase "directly from the ether" *most* illuminating given
a rather heated exchange I had with Mr. Jim Kallstrom of the FBI at
the recent CPSR Cryptography Conference in Washington DC earlier this
Kallstrom is the FBI's chief public advocate for their "Digital
Telephony Initiative". Among other things, they want the ability to
intercept suspects' cellular telephone calls at the MTSO (switch).
Only with a valid warrant, naturally.
At the meeting, I made the following comments.  I had seen the
standards-setting process for the new digital cellular telephone
systems from the inside as they related to security and privacy. And I
was wondering why the government (specifically NSA, through its export
control reviews) was so strongly opposed to meaningful air link
encryption, even if the encryption were to stop at the switch as it
would have to in order to be compatible with existing telephones on
the land side of a cellular call. Such encryption would secure the air
link, the most easily intercepted portion of a cellular telephone
call, while leaving the conversation in the clear at the MTSO where it
could be tapped, if necessary.
In a private conversation, one of the senior members of the committee
who didn't want his name mentioned told me why. "It's very simple", he
said.  "Anybody can intercept the radio link. It's easy. But tapping a
call at the switch requires the cooperation of the telephone company,
and they generally require warrants. And law enforcement says that
sometimes, warrants are, well, just too damn inconvenient."
This really set Kallstrom off. He shouted me down, attacking my
unwillingness to name my source. I challenged him, unsuccessfully, to
back up *his* shrill claims for the absolute necessity of Digital
Telephony with anything more than handwaving. After tempers cooled a
bit, in a one-on-one conversation during a break, he insisted to me
that the FBI was never interested in intercepting the air link portion
of cellular calls - "too difficult, too labor-intensive", he said.  He
agreed that he'd like to see cellular air links encrypted.  They only
wanted the capability to tap in at the switch, and he couldn't care
less if the air link were securely encrypted (though he still wanted
the keys to be escrowed for some reason...hmmm...)
Perhaps it was a desperate attempt to maintain this "we're not
interested in the air link" fiction that triggered Harris's silly
overreaction to the public mention of TRIGGERFISH.

@_date: 1993-09-28 02:01:25
@_author: Phil Karn 
@_subject: My comments to NIST 
Director, Computer Systems Laboratory
ATTN: Proposed FIPS for Escrowed Encryption Standard
Technology Building, Room B-154
National Institute of Standards and Technology
Gaithersburg, MD 20899
Re: A Proposed Federal Information Processing Standard for an Escrowed
Encryption Standard (EES)
Docket No 930659-3159
RIN 0693-AB19
I am writing in response to your call for comments on the
aforementioned matter that appeared in the Federal Register on July
30, 1993. I am writing as a concerned individual with BS and MS
degrees in electrical and computer engineering and 15 years of
professional experience in communications, computer networking and
security at leading edge R&D organizations. I currently work in the
digital cellular telephone industry, a ripe application for robust
encryption if there ever was one. I feel that my experience in this
field qualifies me to comment on the practicality of the proposed
First of all, I am totally opposed to the entire concept of key
escrow. It is a dangerous, un-American and fatally flawed idea that
should never have been proposed. In my opinion, everyone has the
Constitutional right to use the encryption scheme of their choice,
whether or not the government can break it. The impact of strong
encryption on the enforcement of legitimate laws is and will remain
minimal.  Even unbreakable encryption is incapable of thwarting
standard investigational techniques such as informants, testimony
compelled through grants of immunity, "end point" surveillance (e.g.,
hidden microphones), the gathering of physical evidence of crimes and
so forth.
Strong un-escrowed encryption will, on the other hand, finally put an
end to illegal, often politically motivated interceptions of private
electronic communications without having to rely on anyone's goodwill,
such as the still-unnamed "key escrow agencies". Precisely because
eavesdropping has been so easy to do and so hard to detect, the
government has repeatedly proven itself untrustworthy in this regard,
as documented in great detail by the Watergate investigations and the
Church Committee hearings of the 1970s. Why should we trust it now?
Although the government currently claims that the EES will be a
"voluntary" standard, many of its features make no sense whatsoever in
this context.  For example, why must the Skipjack algorithm be kept
secret if individuals remain free to use other algorithms such as
triple-key DES or IDEA that are quite probably even stronger?
The government's claim is completely transparent, as one simply cannot
escape the conclusion that the EES is a prelude to a ban on all other
encryption schemes, or at least a ban on those the government can't
crack. And this presents a profoundly disturbing threat to some very
important Constitutional principles.
Countless others have argued forcefully against the proposal on these
and other grounds. For example, see the points made by the Computing
Professionals for Social Responsibility (CPSR) in the attached
Appendix. I fully agree with CPSR and feel that they alone should have
been enough to stop the proposal long ago.
However, the fact that the Escrowed Encryption Standard has advanced
so quickly despite these serious problems reveals the totally
one-sided nature of the decision process. Far from being an
independent and impartial agency, NIST has proven itself to be merely
a pawn for the National Security Agency, the Federal Bureau of
Investigation and other powerful intelligence and law enforcement
agencies.  Despite (or perhaps because of) encryption's enormous
potential to put real "teeth" into the Constitutional principles of
privacy and freedom of speech and association, these agencies are
notably unsympathetic to tFrom owner-cypherpunks  Tue Sep 28 05:51:28 1993
Received: by toad.com id AA02707; Tue, 28 Sep 93 05:46:19 PDT
Received: by toad.com id AA02651; Tue, 28 Sep 93 05:41:49 PDT
Return-Path: Received: from bsu-cs.bsu.edu ([147.226.112.101]) by toad.com id AA02647; Tue, 28 Sep 93 05:41:46 PDT
Received: by bsu-cs.bsu.edu (5.57/Ultrix3.0-C)
X-Remailed-By: Anonymous X-Ttl: 0
X-Notice: This message was forwarded by a software-
In the paper written by Delaney, Denning and Kaye (Wiretap Laws and
Procedures -- What Happens when the U.S. Government Taps a  Line,
September 23, 1993), a few numbers were presented from a 1992 report
which reflect the wiretaps put into place during that year.
Without further details concerning the specifics surrounding some
of these numbers, it should certainly raise eyebrows on a couple
of points:
- All 919 "interceptions" were authorized. The numbers presented in
  this report indicate that none were denied.
- Out of this number, 303 were in single family homes, 135 were in
  apartments and 289 were categorized as placed in "other" locations.
- Out of 919, 634 were placed into service for interception of
  information involving narcotics. The closest contender in this
  area involved racketeering, in which 90 was the magic number.
- The number of persons arrested was 2,685. Of that number, only
  607 were convicted. These statistics alone should concern YOU.

@_date: 1993-09-28 22:56:23
@_author: Phil Karn 
@_subject: Re: My comments to NIST 
Thank you. Sternlight didn't like it, but what else is new? :-)

@_date: 1994-01-25 00:16:45
@_author: Phil Karn 
@_subject: Re: subpoenas of personal papers 
Breaking a cipher with brute force (or whatever) without cooperation
from the suspect is certainly *not* "unbroken legal ground". See
Kahn's "The Codebreakers" for several stories about rum-runners and
other Prohibition violators who used relatively weak codes and ciphers
that were cracked by the authorities and used against them in
court. See if you get the same sense of deja-vu that I got.
What *is* unbroken legal ground is the original question of whether a
court could compel you, under threat of contempt, to divulge an
encryption key to decrypt information that could then be used against
you. Mike Godwin, who unlike me *is* a lawyer, has forcefully argued
that a strong legal case could be made that the Fifth Amendment would
*not* protect you, while I've heard other lawyers (including a law
school prof who specializes in the Fifth Amendment) say exactly the
Ah, lawyers. Where would they be if they all *agreed*? :-)
Anyway, even Mike concedes that the specific facts may be very
relevant. For example, I might do much better by refusing to concede
that I even know the key to the file in question, as opposed to
admitting that I do know it but am standing on my Fifth Amendment
right to not reveal it.
But this might be hard to do if the file were encrypted with PGP in
the public key mode, especially given PGP's fondness for user-friendly
error messages like:
 "This message can only be read by Phil Karn "
On the other hand, if the file in question were encrypted with PGP
with the -c (conventional cryptography only) option, then I'd have a
somewhat better chance of claiming that I didn't know the key. I could
claim that it belonged to my, uh, uncle (now conveniently deceased,
alas) who, uh, asked me to hold onto it for safekeeping and, uh, I
just hadn't had the heart to delete it yet.
It would be even better, of course, to use encryption that leaves *no*
identifying markings of any kind on its ciphertext. Just flat, random
binary data. This way you don't even have to concede that it *is*
ciphertext. Perhaps you were playing with your new PC sound card, and
you must have accidentally recorded some interstation noise from the
FM radio, yeah, that's it...
And, of course, there's no real reason why you have to leave yourself
at all vulnerable to compelled key disclosure when it comes to
encrypted *communications* (as opposed to stored information) given
the existence of things like authenticated Diffie-Hellman key

@_date: 1994-03-11 10:20:07
@_author: Phil Karn 
@_subject: 2nd CJ update 
Looks like the stalling tactics have begun. I just got a phone call
from "Susan Shea" from the National Security Agency. She said that to
"make a better determination" she would need a copy of the diskette.
I explained (as I had in my written request) that the diskette in
question contained exactly the same source code as was printed in Part
5 of the book Applied Cryptography, byte for byte. But she claimed
that as she did not have a copy of that, she would still need the
Right. The NSA doesn't have a copy of Applied Cryptography, and has
never seen one. Yet, apparently, they signed off on my original CJ
request to export the printed book (the State letter mentions comments
from the Department of Defense, which is always a code phrase for the
NSA in such situations).
Sigh. I will send it off to them. This should buy them about two days,
unless I get really extravagant and switch from Priority Mail to
Express Mail...
PS. Does anybody consider it odd that someone from the NSA would actually
identify themselves as such?

@_date: 1994-05-11 11:59:22
@_author: Phil Karn 
@_subject: State Dept Response to my second CJ request 
In reply refer to
ODTC Case: CJ 081-94
YOUR LETTER DATED: March 9, 1994
REQUEST FOR COMMODITY JURISDICTION DETERMINATION FOR: "Applied
Cryptography Source Code Disk"
Your commodity jurisdiction (CJ) request was referred to the
Departments of Commerce and Defense and the National Security Agency
for their review and recommendations. As a result, the Department
of State has determined that the subject source code disk is subject
to the licensing jurisdiction of the Department of State in
accordance with the International Traffic in Arms Regulations (22
CFR 120 through 130). This article is designated as a defense
article under category XIII(b)(1) of the United States Munitions
List.  Licenses issued by this office are required prior to export.
The text files on the subject disk are not an exact representation
of what is found in "Applied Cryptography."  Each source code
listing has been partitioned into its own file and has the
capability of being easily compiled into an executable subroutine.
The subject disk contains source code listings for each of the
following cryptographic algorithms: Vigenere, Beauford, Enigma, DES,
Lucifer, NewDES, FEAL-8, FEAL-NX, REDOC III, LOKI 91, IDEA, N-HASH,
MD5, Secure Hash Algorithm (SHA), and Secret Sharing. Also, the
subject disk contains source code listings for certain algorithms
that would not be exportable if they were incorporated int
a product.
The intended use of this source code disk, as stated in your CJ
request, is to provide code for those who wish to incorporate
encryption into their applications.  There are fourteen (14)
separate source code files that amount to thousands of lines of
easily executable code contained on the subject disk. This is
certainly an added value to any end-user that wishes to incorporate
encryption into a product.
Should you require further assistance on this matter, please contact
Tom Denner at (703) 875-7041.
Phil Karn
7431 Teasdale Ave
San Diego, CA 92122

@_date: 1994-05-11 12:24:18
@_author: Phil Karn 
@_subject: Re: State Dept Response to my second CJ request 
That occurred to me, but the wording suggests that it's the machine
readability that they really object to.

@_date: 1994-05-21 01:46:36
@_author: Phil Karn 
@_subject: Some 1024-bit DH moduli, and a program to generate them 
Here are some randomly generated 1024-bit Diffie-Hellman moduli, along
with the smallest generator for each. Each modulus p is a strong
prime, i.e., both p and (p-1)/2 are prime.
I've appended the generating program, which uses the GNU gmp
library. On a 486-66 DX2 running BSDI 1.1, it generally runs in less
than an hour though of course the actual run time is probably a
Poisson distributed random variable. It turns out that almost any
amount of sieving is worthwhile given the cost of the Miller-Rabin
test and that the density of 1024-bit strong primes is on the order of
only one every 500,000 or so. Before running this again I'd probably
decrease the large number sieve size to perhaps 1 million and make the
small number sieve as large as possible, rather than keep them the
same size.
Generator = 5
Generator = 2
Generator = 5
Generator = 2
Generator = 2
Generator = 5
Generator = 2
Generator = 2
Generator = 2
Generator = 7
 * i.e., (p-1)/2 is also prime. Also find a generator.
 * P. Karn, April 1994.
 */
  	PLEN	1024	/* 1024 bits */
	SEARCHSPACE	5000000	/* Search range beyond starting point */
 SIEVESIZE (SEARCHSPACE/2)	/* Sieve only includes odd numbers */
	BIT_SET(a,n)	((a)[(n)>>5] |= 1 << ((n) & 31))
 BIT_CLEAR(a,n)	((a)[(n)>>5] &= ~(1 << ((n) & 31)))
	BIT_TEST(a,n)	((a)[(n)>>5] & (1 << ((n) & 31)))
unsigned long Smallsieve[SIEVESIZE/32];
long generator(MP_INT *p);
 * algorithm on p. 209 of Schneier. Since we know (p-1)/2 is prime,
 * we know the factorization of p-1: it's simply 2 * (p-1)/2.
 * This makes our job *much* easier.
 */
MP_INT *p;

@_date: 1994-08-06 00:25:55
@_author: Phil Karn 
@_subject: fast 386 DES code figures 
To see if software DES could really be made acceptable in a IP
security protocol, I've been bumming cycles out of my old DES code.
I've completely translated the encrypt and decrypt routines to
assembler, with no calls or jumps inside either routine.  I picked up
Richard Outerbridge's seriously clever initial and final permutation
algorithm from Schneier, along with a few of his other tricks.
The bottom line: about 38,373 encryptions/sec (2.456 megabits/sec) on
a 50 Mhz Intel 486 running in 16-bit real mode. This includes the
overhead of the C loop that calls the encrypt function and prints a
status line every 10,000 loops.
The code would probably run faster if assembled and run in 32-bit
native mode, as this would eliminate a lot of 1-clock operand size
prefixes (I do many 32-bit operations).
Oh, by the way, if I eliminate the permutations the speed goes up to
about 42,986 encryptions/sec (2.751 megabits/sec), an increase of
about 12%. That says I should be able to do triple-DES at about 13,777
blocks/sec (881.7 kbit/sec) although I haven't tried it yet.
What still bugs me is that Schneier lists the speed of one commercial
DES implementation as 40,600 encryptions/sec on a 33 Mhz 486.  I just
don't see how that's possible without using a lot more memory for
lookup table space (I use only 2K, which is nice in a DOS
In any event, this should be enough for a T1 link (half duplex) as
long as too many cycles aren't needed for things like routing
packets. :-)

@_date: 1994-08-06 10:00:19
@_author: Phil Karn 
@_subject: Re: fast 386 DES code figures 
Yup, it is. I could look up more than 6 bits (i.e., more than 1 S-box)
at a time, but this really starts to eat RAM.
This is another trick from Outerbridge's code that I picked up. As you
say, it does make a difference. It's especially nice in 386 assembler
since I can do the key XOR E(R) AND mask in 32-bit operations, then
pick off the 4 resulting bytes individually to do the SP box
indexing. This trick took me from about 1.85 megabits/sec to the 2.45
megabit/sec figure I gave earlier.
I'm doing this too, if I understand you correctly.  By left-adjusting
each subkey in the key schedule (i.e., shifting the 6 bits left 2
bits), I can pre-adjust for the x4 offset I need to index the SP
table, which has 4-byte elements. This saves two 32-bit shifts per
BTW, some of the code (including Outerbridge's in Schneier)
accumulates the 8 intermediate SP results by ORing into a temporary,
then XORs the temporary into the output data block. This is
unnecessary; each table lookup can be XORed directly into the output
block. Since XOR and OR take the same time, this avoids a temporary
and an extra operation.
At the moment I'm really down in the noise. I've discovered that
286/386/486 specific instructions like ROR EAX,31 execute slightly
faster (2 clock cycles) on the 486 than the equivalent 8086
instruction ROL EAX,1 (3 clock cycles), even though the faster
instruction is more bytes.  Unexpected timings occur for several other
486 instruction sequences as well, such as LODS[BW] (5 clocks), which
is much slower than writing out the equivalent MOV/INC (or ADD)
sequence longhand (1 clock each).  I guess code size is unimportant as
long as everything lands in the cache.

@_date: 1994-08-06 18:29:29
@_author: Phil Karn 
@_subject: Dallas Morning News article 
Dallas Morning News, July 23, 1994, Page 5F
Cryptography tests rights of electronic word
Tom Steinert-Threlkeld
The electronic word appears to have fewer rights than the printed word.
At least that could be the conclusion drawn from an unusual case
emerging from the Bureau of Politico-Military Affairs in the
U.S. State Department's Office of Defense Trade Controls. There, a
book about encryption techniques has won an export license, but a
computer disk containing the same information has not.
The book in question is titled "Applied Cryptography", an attempt by
data security consultant Bruce Schneier to translate 20 years of
academic research in scrambling computer traffic "into terms
understandable by mere mortals."
In so doing, Mr. Schneier hopes to do "more to further the spread of
cryptography around the globe than any single (encryption) product
So far, his publishers, John Wiley & Sons, believe the 600-page tome
has been doing almost that.  Since its release in November, almost
15,000 copies of the book have been sold. Of that, between 1,500 and
2,000 have been to programmers and other interested parties abroad.
Those foreign sales are possible because the book did not have to get
an export license. Such controls are used by the State Department to
guard against the spread of cryptographic methods that could be too
difficult to break, posing a threat to national security.
The book contains what Mr. Schneier estimates is about 100 pages of
algorithms, hash functions and other lines of computer code that can
be used to encrypt messages. But the Office of Defense Trade Controls
in March rendered the opinion that the book "is not subject to the
licensing jurisdiction of the Department of State since the item is in
the public domain."
No so with two disks containing the same "source" code.
In a May 11 letter, office director William B. Robinson designated the
disks as an article "under category XIII(b)(1) of the United States
Munitions List." As such, the author would require an export license
for the disks.
The code itself was not a finished product. It would have to be
"compiled" into an executable program before it actually could be used
to disguise any data on a computer network.
The code was also exactly the same as appeared in the book, or at
least as nearly as possible, given the transfer to a magnetic disk.
But that appeared to be enough of a difference for the State
Department.  Mr. Robinson stated, "The text files on the subject disk
are not an exact representation of what is found in 'Applied
Cryptography'. Each source code listing...has the capability of being
easily compiled into an executable subroutine."
A State Department official Friday translated the distinction this
way: "The difference with the code in the book is you have to type it
all in and correct all the errors" before it is usable by a computer
programmer.  The "value added" by putting the code on the disk is that
it is already typed in.
"That was the determination we made", the official said.
Practically speaking, the distinction escapes the author,
Mr. Schneier. Once one overseas programmer types in the code and
corrects the errors, hundreds of copies can be easily made and shipped
to any country. For the programmer who is too lazy to type, the book's
pages even can be scanned in.
"What do we think? Foreigners can't type? Or is the worldwide scanning
industry influencing this decision?" he asks.
Others see larger, constitutional questions.
"They're trying to say electronic words have less protection than
written words," said David Banisar, policy analyst with the Electronic
Privacy Information Center in Washington, D.C. "That's not a
proposition that I think any court will support."
As more and more words -- from book, magazine and newspaper
publishers, for instance -- become electronic, the issue could become
critical. "When all words are electronic, they won't be able to be
protected under the First Amendment" if this difference between words
on a paper medium and words on a digital medium gains footing, he
Phil Karn, an engineer and ally of Mr. Schneier, however, is appealing
the stand on the disks. The State Department's view also is not the
final law of the land.
"It seems like kind of a foolish distinction and one which in any case
is ultimately doomed to failure," said Internet Society executive
director Anthony Rutkowski. The different rulings on the book and the
disk are "utterly stupid, but that's the way bureaucracies work."
Mr. Robinson and the trade control office's deputy director, Rose
Brancaniello, declined to comment. Another officer, Tom Denner, said
comment was prohibited by confidentiality provisions contained in
section 38(e) of the Arms Export Control Act.
CyberTalk appears every other Saturday, discussing people, places and
problems populating the world of computer communications known as
cyberspace.  Tom Steinert-Threlkeld can be reached at the Internet
address, tomhyphen at America Online, tomhyphen; or at
Prodigy, trfj19a.

@_date: 1994-08-07 18:06:27
@_author: Phil Karn 
@_subject: IDEA vs DES 
Now that I've got DES running about as fast as it can go on the 486, I
did a little analysis on IDEA. The algorithm is definitely more
straightforward to implement than DES, but not necessarily that much
faster. It uses three primitive operations, all on 16-bit quantities:
XOR, ADD and multiplication modulo 65537.  Each encryption involves 48
XORs, 34 adds and 34 multiplies, plus a few exchanges.
The multiplies are a problem. On the 486, a 16x16 integer multiply
takes from 13-26 clocks, depending on how many significant bits there
are in the multiplicand. Random data usually has 15-16 significant
bits, so this distribution is probably weighted more toward the 26
clock figure. So I count an optimistic total of 990 clocks per 64-bit
encryption, assuming plenty of registers (which I don't have), not
counting the modular reduction steps for each multiply, and ignoring
the memory references for the subkeys.
I figure my DES code is currently taking about 1300 clocks per
encryption. So IDEA won't be much faster, though it may be more
Anybody know the speed of the integer multiply instruction on the
various PowerPC chips? Along with modular exponentiation and vocoders,
which also do a lot of multiplies, it looks like fast multiplication
is becoming rather important in secure communications.

@_date: 1994-08-25 21:18:04
@_author: Phil Karn 
@_subject: DSPs 
I'm not really an expert on DSPs, but it does seem like they should be
good for modular exponentiation given the number of multiplies required.
But I don't think I'm the first to point that out.
I think I already said that it looks like fast multiply performance is
going to be crucial for secure communications. Modular exponentiation
for public key algorithms, modulo-65537 multiplies in IDEA, and the
many DSP multiplies in CELP speech coding, just to name three.
I recently heard of a FED-STD-1016 CELP implementation that runs in
better than real time on the PowerPC. It runs in much worse than real
time on just about everything else. The PowerPC's multiply performance is
clearly the reason.

@_date: 1994-08-26 00:05:05
@_author: Phil Karn 
@_subject: Re: Fast modular exponentiation 
An interesting discussion. Thanks.
How about a basic tutorial on these various modexp algorithms, with
particular attention to how many of each arithmetic operation
(add/subtract/multiply/divide) are needed as a function of the modexp
input parameter sizes?  I don't really understand all the details yet,
especially how they relate to which algorithm is best for a given
I.e., if I come up with a list of clock counts for each basic
arithmetic instruction, how can I tell which algorithm is probably
best for my machine?

@_date: 1994-08-26 00:03:49
@_author: Phil Karn 
@_subject: Re: Nuclear Weapons Material 
Sigh. At the risk of furthering a way-off-topic discussion, I should
elaborate on what I said earlier. My understanding is that the tritium
produced for nuclear weapons is used only to "boost" the *fission*
reactions in the "primary" that is in turn used to trigger the main
fusion reaction in the "secondary".
Although the main fusion reaction in a thermonuclear device *is*
between tritium and deuterium, the much larger quantities of tritium
needed for this stage are produced during the actual detonation by
neutron irradiation of lithium-6. That's why lithium-6 deuteride is
used as the fusion fuel.
Once again, these materials are distinct from the small amounts of
gaseous tritium and deuterium used in the fission boosting stage.
To summarize the steps (page 22, "US Nuclear Weapons" by Hansen):
1. High explosives detonate and compress the fission fuel in the primary.
2. At the right moment, neutrons are injected from an external
generator to start the chain reaction.
3. Small amounts of gaseous tritium and deuterium are injected into
the exploding fission core to boost the fission reaction, resulting in
much more rapid and complete fission.
4. X-rays from the exploding primary, traveling at the speed of light,
are focused onto a physically separated "secondary", the fusion fuel
assembly, rapidly compressing and heating it by radiation pressure.
Physical separation is essential to give the secondary time to react
before the exploding primary physically blows it apart. *This* is the
"breakthrough" that Ulam came up with that made the H-bomb practical;
before then, Teller had wanted to simply pile deuterium closely around
an A-bomb, which clearly wouldn't work.
5. At the center of the rapidly imploding *secondary* is a "sparkplug"
of fissionable material. Neutrons from the primary cause this material
to fission, producing even more neutrons that breed large amounts of
tritium from the lithium-6 in the fusion fuel.
6. The newly produced tritium fuses with the deuterium in the main
fusion reaction.
7. Fast neutrons from the fusion reaction may then fission a jacket
of U-238 (yes, U-238) surrounding the secondary, producing an even
greater yield using material that would otherwise be useless.
8. Additional fusion stages may then react (if present).
As you can see, the fission and fusion reactions in a modern
thermonuclear weapon are very closely interwined.
Just to bring this back somewhat to cryptography, an interesting topic
for speculation is the operation of the "permissive action links"
(PALs) that control these weapons. The complexity of the procedure
suggests that the precise timing of many events is crucial if a
high-yield nuclear explosion is to result. This is particularly true
for the timing of the many HE detonators, the neutron generator and
the fusion boost injector.  Perhaps these parameters are stored in
encrypted form in the weapon and can be decrypted for use only with
the proper externally-provided key? Considering that a brute force key
search would consume one weapon per trial key, perhaps this technique
isn't too bad against dictionary attacks? :-)

@_date: 1994-08-26 13:05:06
@_author: Phil Karn 
@_subject: Re: DSPs 
Yes, but even scalar multiplication is so much faster on a DSP than on
most general purpose CPUs that it seems like a definite win. The 486
takes from 13-42 clock cycles to perform a multiply, depending on the
operand sizes and number of significant bits in the multiplier. Even
if you couldn't keep the pipeline full on a chip like the PowerPC, you'd
still be well ahead.
But then I hear people say that it's not the multiplication that slows
down modular exponentiation, it's the modular reduction.

@_date: 1994-09-14 02:15:32
@_author: Phil Karn 
@_subject: Is cypherpunks archived somewhere? 
Is the cypherpunks list being automatically archived where it can be
retrieved by anonymous FTP?
Yes, there *are* occasional nuggets on this list. Why, there's even
the occasional practical item about cryptography buried in the massive
rants to the libertarian choir. But I'd hate to miss stuff like the
recent note on RC4. That's why I haven't unsubscribed yet.
But something has to give. The list is just too high-volume, and the
signal-to-noise ratio is now below -1.6 dB. It's just not worth it.
It's a major reason why I always seem to run as much as a week behind
on my mail.
If there were an automatic FTP archive of the list, then I could
unsubscribe while keeping the option of pulling over and grepping
through an archived batch every so often just to see if anybody is
actually doing anything.

@_date: 1994-09-15 11:39:29
@_author: Phil Karn 
@_subject: Re: Running PGP on Netcom (and Similar) 
This discussion is ridiculous. If you can crunch keys on your own
trusted machine, why not just run PGP there? Or at least the RSA
secret key operations?
I've been saying for a long time that there is a role for the latter
device.  It would hold your PGP secret key and do all RSA secret key
operations (signing, decryption) locally, taking requests from and
communicating the results back to hosts running PGP that do the rest:
RSA public key operations such as signature verification and
encryption, and IDEA encryption/decryption.
Ideally this device would be a smart card, but a small palmtop might
make a good prototype (except for speed). The big win is in much
better protection of the RSA secret key; it would never have to leave
the device, except perhaps in encrypted form for backup.
By plugging this device into a (possibly hacked) host you could use
your RSA key without risking all of the traffic you have ever
protected or will protect with a particular RSA secret key if that
particular host happens to be compromised.
But any traffic that passed through the hacked host would still be
compromised, as it would if the link between the secret key device and
the host were tapped.  There's simply nothing you can do about it.

@_date: 1994-09-15 13:09:34
@_author: Phil Karn 
@_subject: Re: The Importance of Filtering 
This is not what I asked for. I already have a pretty good filter:
it's called "grep". Plus a few friends have volunteered to forward the
occasional worthwhile article to me by private email. All I wanted was
an alternate transmission mechanism - complete archives on demand by
anonymous FTP rather than automatically by email. Is this so
Even if I used Eudora regularly (which I don't), the problem wouldn't
get much better. In some ways it would get even worse. Eudora is very
nice for those who travel frequently: you can download mail in a big
batch whenever you can find a phone, read and edit it offline (e.g.,
during a flight), and then transmit your responses when you find
another phone.
The problem, of course, is the severely limited bandwidth of the phone
link. Sometimes I only have 10 minutes between flights. I simply don't
want to waste the time downloading the day's several megabytes of
cypherpunk flamage. Filtering it out after I've received it doesn't
help me.
Some have suggested netnews relays. This is not sufficient either,
given that most sites I know keep news for only a few days
to keep their disk space requirements within reason.
Is it so hard to add an entry to the cypherpunks list on toad.com so
that every message can be appended to a file in the anonymous FTP
area? It's not like it has never been done before...but perhaps that's
what makes it uninteresting to this group.

@_date: 1994-11-27 16:20:38
@_author: Phil Karn 
@_subject: Re: Zimmermann interrogated without counsel 
The basic problem here is that Constitutional limits on police powers
have long been at their weakest at the border or at "border
equivalents" like international airports. More recently the
protections have been loosened within the US near borders, which
accounts for police-state practices like the INS checkpoint north of
San Diego that I have to drive through on my way to LA. It's an open
secret that it's as much for drugs being carried by Americans as it is
for illegal aliens from Mexico.
Looks like all you have to do is to weaken a protection for some
"worthwhile" and supposedly narrow reason and you can count on the
feds to exploit it fully for any other purpose they can get away with.
As I understand it, you have no obligation to do or say anything to a
Customs officer when entering the country other than to identify
yourself, hand over your passport, and permit a search of your
luggage. It's not even clear you have to answer their questions as to
where you've been. Dunno what would happen if they searched your
laptop and found encrypted material...

@_date: 1994-11-27 22:07:09
@_author: Phil Karn 
@_subject: Re: Zimmermann interrogated without counsel 
There was supposed to be an exemption for temporary export of
cryptography by US citizens for personal use overseas. At least it was
announced last spring by Martha Harris at the State Dept.
There's some confusion about whether the exemption ever actually took
effect; the current consensus appears to be that it has not. So I
guess you still have to go through the formality.

@_date: 1994-11-27 22:11:19
@_author: Phil Karn 
@_subject: Re: Cell Phones Security?? 
In article <94Nov21.08.1184 you write:
Basically, there is *no* security whatsoever in cellular phones, at
least with the current analog FM technology. If you want privacy,
you'll have to provide it yourself on an end-to-end basis. Not only
does this require that the party on the other end to have a secure
phone, but it greatly reduces reliability since most dialup modems
don't perform very well over cellular radio paths.

@_date: 1994-12-24 03:11:54
@_author: Phil Karn 
@_subject: Re: Thoughts on 15 day CJ crypto 
In article <94Dec16.08.5320 you write:
Isn't it common practice to pad out a plaintext block with random
garbage to the size of the modulus before you RSA-encrypt it? E.g., if
you have an 8-byte DES key and you want to encrypt it with an RSA
public key having a 512-bit modulus, you'd stick 56 bytes of random
stuff in front of the DES key before you do the exponentiation.  When
you decrypt with the secret key, you simply throw away the random
At least RSAREF does this.
Wouldn't this thwart the kind of attack you describe?

@_date: 1994-12-28 22:19:49
@_author: Phil Karn 
@_subject: Re: IPSP and Netscape 
In article <94Dec13.08.6313 you write:
Uh, I don't see that IPSP provides any automatic immunity to traffic
analysis. It does make certain kinds of fine-grained traffic analysis
a little more difficult. E.g., you can't tell what upper level
protocols are in use, and if you share a single SAID between each host
pair you can't tell which or how many users are sharing the path. But
you can still tell that the hosts are communicating.
If you use IPSP in the IS-IS tunnel mode, you could help protect the
identities of the end systems on each end, but again you can't hide
the fact that the ISes are talking.
Something like IPSP *could* serve as the basis of an anonymous
forwarding IP network analogous to the existing anonymous remailers,
but this would take a lot more work. And you could generate bogus
filler traffic between a pair of IPSP hosts to help cover the real
traffic between them.

@_date: 1995-11-21 22:32:03
@_author: Phil Karn 
@_subject: Applied Cryptography case filings on the Web 
The government has filed its Motion to Dismiss, or In The Alternative,
For Summary Judgment in the case of Karn vs State Dept. This case
challenges the arbitrary Commodity Jurisdiction Request rulings
made for the book Applied Cryptography and for a floppy disk containing
the same source code printed in the book.
I've begun scanning in and HTMLizing the various government documents,
some of which are sizeable. As I finish them I'm putting them up on
my web page. Please feel free to pass around this URL:

@_date: 1995-12-12 18:23:46
@_author: Phil Karn 
@_subject: Plaintiff's Opposition in Karn vs State Dept 
Defendants' Motion to Dismiss in the case of Karn vs US Dept of State
et al.
I have HTMLized our filings and added them to my web page. Please feel
free to peruse them. Also, let me know if you spot any obvious typos;
I had to do quite a bit of manual editing, particularly in the
footnotes, to make the result look good in HTML.
The government now gets the chance to answer our opposition. They were
originally scheduled to do by December 13, but since our own filing
was delayed over the weekend by the judge's concurrence the government
will probably get a few extra days to respond.
Note that we have asked to make oral arguments on the motion. I'll let
everyone know if or when this will happen.
The web page is:

@_date: 1996-01-20 19:30:49
@_author: Phil Karn 
@_subject: ITAR and hash functions (Perry's question) 
Perry quoted part of the joint declaration of facts in my case and asked
Not according to them. They have made it clear throughout their
filings that they consider each CJ request on a case-by-case basis.
Furthermore, they repeatedly assert that under the power delegated to
them by the President, they have the absolute power to add and delete
items from the Munitions List and to make inexplicable, inconsistent
and arbitrary rulings whenever they damn well feel like it, and no
court can overrule them.
They even feel free to ignore their own rules whenever they get too
inconvenient. See my attorneys' brilliant analysis of why the ITAR as
written clearly permits the export of public domain crypto code under
the public domain exemption. It's about halfway through
But State wrote the rules, so they can ignore 'em whenever they feel
like it. Why gosh, National Security is at stake! And that's something
we mere mortals can't possibly know anything about.
Grep for the word "estoppel" in their arguments -- I know they used it
at least once to discuss this exact point.
So the bottom line is this: at the moment the ODTC will let you export
hash functions as long as they don't encrypt data. They'll probably
grant CJ requests to that effect. But they could change their minds at
any time if they feel like it.
Isn't it wonderful to live under a government of laws, not of men?

@_date: 1996-03-20 19:14:33
@_author: Phil Karn 
@_subject: NSA denies our 3DES license application 
Last month, Qualcomm filed with the State Department an application to
export my IP Security (ESP) code for KA9Q NOS to Singapore.
Our stated purpose was to encrypt an Internet "tunnel" between
Qualcomm's US facilities and our office in Singapore, which is staffed
by two US citizens. We stated that the software would be used solely
for this purpose and would not be transferred to anyone else.
Our application indicated that the software in question supported both
single and triple DES.
On March 11, the Office of Defense Trade Controls returned our application
stamped "RETURNED WITHOUT ACTION". The following form was attached:
IN REPLY REFER TO
DTC CASE - 664149
The enclosed application has been voided and is being RETURNED WITHOUT
ACTION for the reasons indicated below:
_X_1. Submit a new application including all required background and
      documentation. Do not return the enclosed application.
[25 other unchecked items omitted. These referred mainly to administrative
problems like "you used the wrong form", "you didn't file enough copies
of the supporting technical data", etc.
_X_27. Please submit another license [sic] once your software has been
       modified so that it no longer contains triple DES.  Please specify
       object code only on your license application.
[end of form]
So there you have it. NSA makes good on its threat to ANSI X9 that
triple DES would not be exportable.
This was a case where keeping strong crypto out of the hands of
terrorists and unfriendly governments was clearly not at issue. It
dealt strictly with the ability of a US corporation to defend its
international operations against against industrial espionage. Or,
perhaps more to the point, espionage by the NSA.
Certainly seems like a good argument in favor of the Leahy bill to me.
One mildly interesting thing about this form letter response is that
item 27 appeared to be part of the standard form -- it wasn't typed
into an "other" field of an existing form. Perhaps they added it to
the word processing file for this one occasion. Or perhaps they deny
triple DES exports so regularly that they now have a standard form
item to deal with it.
Phil Karn

@_date: 1996-03-31 20:08:24
@_author: Phil Karn 
@_subject: text of Richey's decision 
The text of Judge Richey's decision to grant the government's motion
to dismiss my case is now up on my web page as
My attorneys scanned it into HTML format, but neither they nor I have
had a chance to thoroughly proofread it yet.
An appeal is extremely likely.

@_date: 1996-07-20 09:45:02
@_author: Phil Karn 
@_subject: Re: Netscrape download 
Thanks. Others have confirmed the BSDI and Windows 95 version, so
I guess they're all the same.
