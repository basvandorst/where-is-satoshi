
@_date: 1995-09-20 17:18:06
@_author: David_A Wagner 
@_subject: Re: NYT on Netscape Crack 
In article <9509201034.AA10521 you write:
If the master key PRNG is poorly seeded, this is still exploitable:
for instance, there is a lot of redundancy in most plaintext, and
this can be used to check each candidate key value.
Just use a cryptographically secure PRNG seeded with enough entropy.

@_date: 1995-09-25 12:58:06
@_author: David_A Wagner 
@_subject: Re: netscape bug 
In article <199509201855.LAA17261 you write:
No, the time, pid, and ppid often leak to a remote adversary too.
The attack probably requires a bit more sophistication when the
cracker doesn't have login access, but I believe it's still possible.
See my recent post to sci.crypt for some comments from Ian & I
about this.

@_date: 1995-09-25 13:32:16
@_author: David_A Wagner 
@_subject: Re: Exchange random numbers (was: Re: netscape's response) 
In article <199509211852.LAA22259 you write:
People seem to think this kind of thing is obviously safe.  I'm not yet
By xoring in a quantity *chosen by your adversary*, you're essentially
allowing related-key attacks on your stream cipher.  (Your PRNG is just
a stream cipher, keyed with my_seed.)
Noone knows how secure most ciphers are against related-key attacks:
related-key attacks are known to be very powerful (often more powerful
than any other type); but very little research on this topic is available.
You're treading on unknown ground.
There's the also a small error in your specific algorithm.  Let
presumably n is much less than the length of your seed.  Then a brute-force
search over n bits will recover n bits of the seed -- this is a much faster
cryptanalysis than a brute force over all bits of the seed.  This can
probably be fixed by something like
but the related-key uncertainties still remain.

@_date: 1995-09-27 10:48:23
@_author: David_A Wagner 
@_subject: Re: Exchange random numbers (was: Re: netscape's response) 
So here's another attack on this scheme which I noticed today.
I'll assume you're using the Netscape/RSAREF PRNG:
Then an attacker can send you ``1'' as contribution.  This will
xor ``1 << contrib_area'' into your seed.  With probability 1/2,
this will be the same as subtracting ``1 << contrib_area'' from
your seed -- and in this case, your PRNG will repeat after
``1 << contrib_area'' more outputs.  This is much worse than the
expected 1 << 128 cycle length.
So this is an example of why it's dangerous to xor in values
*chosen by your adversary* to your seed.
I don't know about any work on related-key attacks on stream ciphers.
For block ciphers, related-key attacks are much stronger than other
attacks. (e.g. DES can be broken with ~ 2^28 related key queries and
about ~ 2^28 off-line computation steps)
Here's some references on related key attacks on block ciphers.  If
anyone can find any other work in this area, let me know!
        author = {Edna K. Grossman and Bryant Tuckerman},
        title = {Analysis of a Weakened {Feistel}-like Cipher},
        booktitle = {1978 International Conference on Communications},
        pages = {46.3.1--46.3.5},
        publisher = {Alger Press Limited},
        year = {1978},
        annote = {Feistel ciphers with identical subkeys in each round
                        are very weak}
        author = {Robert Winternitz and Martin Hellman},
        title = {Chosen-key Attacks on a Block Cipher},
        journal = {Cryptologia},
        year = {1987},
        volume = {{XI}},
        number = {1},
        month = {January},
        pages = {16--20}
        author = {Eli Biham},
        title = {New Types of Cryptanalytic Attacks Using Related Keys},
        booktitle = {Advances in Cryptology: {EUROCRYPT} '93},
        pages = {398--409},
        publisher = {Springer-Verlag},
        year = {1994}

@_date: 1995-10-02 14:27:04
@_author: David_A Wagner 
@_subject: Re: NetScape's dependence upon RSA down for the count! 
In article <9509301910.AA10970 you write:
This is a trivial program!  I can't believe anyone considers this
technically difficult.  But hey, who am I to question, if you'll
pay $50!
Ok, let me back that up with real code.  Here's a proxy I've been
using for experimenting, in lieu of root access & tcpdump.
Usage: proxy localport remotehost remoteport > capturefile
$ ./proxy 2999  80 > capturefile &
$ netscape  &
$ ./proxy 3999 alpha.mkn.co.uk 443 > capturefile &
$ netscape  &
Here's the source.  It's a bit unstable, and could be a improved
a little, but was fine for a quick kludge.  So feel free send the
$50 to the following address at your convenience!! :-)
David Wagner
UC Berkeley
330 Soda Hall
Berkeley, CA  94720
        dump(char *p, int len)
 	if (si.sin_family == AF_INET)
int localinit(int port)
int main(int argc, char **argv)

@_date: 1995-11-15 13:59:53
@_author: David A Wagner 
@_subject: Re: Diffie-Hellman in GF(2^n)? 
In article  you write:
I remember that the discrete log problem is quite a bit easier
in GF(2^n), but I don't remember how much easier.   Let me try
to look it up...
A. Odlyzko has a paper recommending that people should not use
GF(2^n) for discrete log applications; in it he states that you
will need at the minimum n > 800, and probably n > 1500.  (And
you also need to choose n carefully.)  A quote from the abstract:
``Hence the fields GF(2^n) out to be avoided in all cryptographic
I don't know enough about number theory to judge for myself;
but you can read the (long) paper yourself at
I hope this helps!

@_date: 1995-12-01 15:31:15
@_author: David A Wagner 
@_subject: digital receipts and cash 
Digital cash protocols are starting to look like they could become very
popular and useful.
But under current proposals, there's one thing you don't get when you
spend digital cash: a digital receipt.
(Later, if the vendor reneges on the transaction, you'd have the digital
receipt to prove that you paid & the vendor is cheating you.)
This seems like it would be a really useful feature.  Does anyone know
if there are any *practical* protocols to do this?
ObCypherpunks relevance: digital receipts seem (IMHO) important to the
emergence of fair and robust reputation markets.  Discuss.
ObCrypto relevance: I've looked through _Applied Cryptography_, but the
protocols listed there aren't practical -- they require something like
100 rounds of interaction!  Can this be improved?

@_date: 1996-01-26 09:34:21
@_author: David A Wagner 
@_subject: Re: Why is blowfish so slow?  Other fast algorithms? 
Not true.
For instance, suppose you append a standard simple CRC-32 of the
plaintext, and then encrypt with CBC mode.  Because CRC-32 is linear,
it's trivial to construct a collision by flipping some of the first
33 bits of the plaintext; but this, in turn, is easy to do by just
flipping the corresponding bits in the IV.  (The attack is even
easier if you're using a stream cipher.)
I'm sure you can come up with a non-cryptographic checksum which looks
(at first glance) like it'll work ok.  Maybe you'll be completely safe.
Still, the security of any such scheme will inherently depend on very
subtle issues of whether the encryption and the checksum can interact--
and there are probably only a handful of people in the free world who
are really qualified to do a full analysis of these effects, I'd guess.
You can use a non-crypto checksum to attempt to provide integrity if
you want, I suppose.  Is that prudent system engineering?  Personally,
I don't think so.
At the risk of sounding like a broken record, I suggest
  Design principle: if you want message integrity/authentication
  guarantees, use a crypto-strength MAC, damnit!
False.  MACs are useful & necessary in a encrypted packet network,
to prevent message tampering by active attackers.  (Unless you prefer
to sign *every* packet with RSA, which is insanely slow
MACs are useful in conjunction with encryption, I should add.  They're
not mutually exclusive. :-)

@_date: 1996-04-01 03:05:03
@_author: David Wagner 
@_subject: Chaumian ecash without RSA 
I've always seen Chaum's anonymous ecash system described in terms of RSA.
RSA has this ungainly patent which probably will be around for quite some
time, yet the Diffie-Hellman patent expires pretty soon.  With that motivation,
here's a Chaumian anonymous ecash protocol based on Diffie-Hellman.
Take a publicly known group G and generator g; breaking Diffie-Hellman and
taking discrete logs in this group should be hard.  For instance, G might
be (Z/pZ)^*, the integers modulo a prime p.
The bank picks a secret value k, and publishes g^k.
To withdraw a coin, Alice picks an x, sets
chosen so that y is in G.  Alice chooses a random secret blinding factor b,
sends to the bank
and the bank returns
debiting Alice's account.
Note that this is a (blinded) Diffie-Hellman key exchange with public
exponentials g^k and y g^b; the bank returns the exchanged "secret".
Alice unblinds this value, computing
and now c = (x,z) is a coin in the digital cash system.  Note z = y^k.
We use the traditional online clearing protocol; to deposit the coin, a
shop S sends
The bank checks to make sure the coin hasn't already been spent, and then
checking whether y^k = z.  If equality holds, and the coin hasn't already
been spent, then the bank credits S's account and adds the coin to the
list of spent coins.
This is just the same old Chaum anonymous ecash protocol, except that I've
replaced the RSA operations by Diffie-Hellman ones.  It's a lesser-known
fact that you can blind a Diffie-Hellman key exchange just as you can blind
a RSA signature.
The security of this protocol depends on the intractibility of breaking
Diffie-Hellman.  In particular, given public exponentials g^k and y = g^m,
for k,m unknown, it must be impossible to compute g^{km} = y^k.  Furthermore,
this protocol depends on the hash function being one-way and possessing no
interactions with Diffie-Hellman or modular exponentiation.

@_date: 1996-04-09 23:19:56
@_author: David Wagner 
@_subject: Re: RC4 improvement idea 
In article <199604060539.VAA22611
No, the report was right: the weak keys are real.
For one key in 256, you have a 13.6% chance of recovering 16 bits of
the original key.
On average, the work factor per key recovered is reduced by a factor
of 35 (i.e. the effective keylength is reduced by 5.1 bits) by using
this class of weak keys.
I've experimentally confirmed this effect myself.  Andrew Roos did
some good work.
Take care,

@_date: 1996-04-19 08:40:12
@_author: David Wagner 
@_subject: Re: why compression doesn't perfectly even out entropy 
In article <199604181352.JAA08215
Then I propose the following scheme.  (I've proposed it before.)
My entropy cruncher takes in random noise from a number of diverse
sources (some possibly of dubious quality).  I take *all* the noise
and run it through a hash function to distill entropy.
Now I need to have some method to estimate when I have enough entropy
in the random noise I'm crunching.  First rule: be conservative.
One can never have too much entropy in the input to the hash function.
Therefore, I suggest making a *copy* of the input noise stream,
running it through Jon Wienke's "this shouldn't happen" filter, and
feeding the result to some entropy estimator.  When the entropy
estimator says "I've got 1000 bits of entropy", I stop crunching.
This is conservative design, folks.  Using Wienke's filter in this manner
can't be any weaker than not using it at all. (agreed?)
Now, you can go argue whether the extra design complexity is worth it,
if you like. P.S.  To forestall confusion, let me be explicit about what I'm *not*
proposing: I *don't* want you to apply Wienke's filter to the input or
output of the hash function.
Applying Wienke's filter to the random noise stream, to the input to
the hash function, or to the output to the hash function, is clearly
a bad idea.
(The mathematician says "clearly", knowing full well that, unfortunately,
some small part of the audience probably doesn't get it... )
This is what the "POTP" snake oil folks were proposing-- they had
some "quality control" process they applied to the one-time pads
they generated.  I think they said they regularly eliminated 70%
of the pads as "defective".  This was supposed to be encouraging :-)
If you don't understand why the POTP "quality control" process was
laughable, let someone else design the entropy cruncher!!!

@_date: 1996-04-20 18:06:24
@_author: David Wagner 
@_subject: Re: why compression doesn't perfectly even out entropy 
In article <199604182255.PAA13373
Excellent point!  Very nicely put.
You've convinced me: I was looking at the problem the wrong way.
Thanks for correcting & educating me...
Appreciative of the "signal",

@_date: 1996-04-27 15:33:02
@_author: David Wagner 
@_subject: Re: An idea for refining penet-style anonymous servers 
In article ,
So maybe this is an incremental improvement over the penet model,
but I'm not yet convinced that it's really a gigantic advance.
The threat model I'm most worried about is this: I post a Co$
document about clams & volcanos, under a nym.  The Co$ has enough
lawyers to subvert any justice system; they might be pissed off
enough to target me.  I don't want them to recover my name.
As you point out, your improvement can't protect against this scenario.
Maybe it can help protect others, so that when the Co$ scum steal
the database, they can't compromise everyone who's ever used penet.
But I'm not convinced-- what if the Co$ do a DejaNews search for
'anon* and use each hit to query the database?  I think
they'll be able to break the anonymity of nearly everyone in the
So I'll make another proposal, to try to be constructive.
Write a program to translate between penet-style remailers and
mixmaster/alpha style remailers.  Set up a service which automatically
creates a chain of nyms for you, with encryption at all the
mixmaster/alpha - to - mixmaster/alpha links.
People seem to (like / be familiar with / be willing to use) the
penet style interface-- so use the penet syntax as the interface
to the user, so the user doesn't have to know anything about what
the remailers are doing behind his back.  (Or use some *simple*
Java/html-forms/... interface.)
Advantages: to figure out the link between a nym and the real person,
you have to compromise a whole chain of remailers (except for the
following drawback).  the nym<->person database is distributed,
so is less susceptible to attack.
Drawbacks: this doesn't encrypt the link between the user and the
first remailer, so if Co$ can sniff on the link between you and
your first remailer, you're screwed.  This is still an improvement
over vanilla penet.fi-- the Co$ has better lawyers than wiretappers,
I suspect-- and you can also make sure your first link is just a
couple of hops away.  One might also contemplate using Hal's java
applet to automatically pgp encrypt the first link (so you only
have to assume that the web server you got the applet from is
trustworthy, and that the Co$ isn't doing active attacks on you).
This is still a compromise between security & usability, unfortunately.

@_date: 1996-04-27 17:46:33
@_author: David Wagner 
@_subject: Re: WWW proxies? 
In article  you write:
Here's what I know of.
You could get an anonymous  account and websurf
from it.  You can also publish web pages anonymously
from c2.  See
It looks like there's an experimental anonymizing proxy
up in France (if you can tolerate the link delay):
I haven't tested it myself, though.
CMU has a web anonymizer at
Unfortunately, it's not useable by the public yet.  (They
promise to release it in early 1996.)
Decense is a early prototype of a double-blind penet-style
Wei Dai has talked about PipeNet, a network of "re-routers"
for general Internet traffic.  Unfortunately, at this point,
it's only a pipe dream on the whiteboard (as far as I know--
correct me if I'm wrong!).
If I left any out, let me know.
I hope to get a chance to play with these things (and possibly
install one on my machine) during the summer, when I'll have
some more free time.  Whee!

@_date: 1996-05-23 15:29:40
@_author: David Wagner 
@_subject: Re: PROTOCOL: Encrypted Open Books 
Apologies for replying to a reposted article; I wasn't subscribed when
the (very interesting!) open books protocol was originall proposed.
In article ,
Yes, if the bank manufactures a fake transaction to a customer's
account, I see that the customer can discover the discrepancy & step
forward to identify the bank.
But what if the bank manufactures a fake account, without a real
customer, and fakes a transfer into that account, pocketing the
money that should have gone into that account?  There is no real
customer corresponding to that account to check up on the open
books, so it seems to me like a bank employee can embezzle money
undetectably this way.
Did I miss an important part of the protocol, or does some extra
mechanism need to be added to counter this threat?

@_date: 1996-06-01 12:50:41
@_author: David Wagner 
@_subject: Re: Statistical analysis of anonymous databases 
In article ,
How about a simple non-technical solution?  Each patient picks a
random pseudonym; the database is keyed off that pseudonym, and the
person's True Name(tm) never appears in the database.  Patients
should remember their pseudonym (or write it down); then they can
add information to the database.
Ahh, anonymity.
(Hey, I posted about something exportable-- that should fill my
quota for the year. :-)

@_date: 1996-07-02 16:00:33
@_author: David Wagner 
@_subject: Re: Message pools _are_ in use today! 
In article ,
alt.anonymous.messages is not an ideal message pool-- it is a hack.
(Granted, it *is* a really cool, clever, and practically useful hack.)
Ian and I talked about this at some length.  alt.anonymous.messages
has certain unfortunate shortcomings.
Someone sniffing the Berkeley 'net can tell when I receive an
alt.anonymous.messages message by when I download an article from
the NNTP server; they can tell when I send such an article by when
I upload an article to the NNTP server; they can list all the
``subversive'' Berkeley folks who have read alt.anonymous.messages
The local NNTP server must be trusted.
Furthermore, even if you run a trusted NNTP server on your local
machine, there are still vulnerabilities.  Someone sniffing on your
subnet can tell when you inject a new message onto alt.anonymous.messages,
as can your neighboring NNTP servers.
Then there are all the standard message length and timing threats
from traffic analysis.  And there is no perfect forward secrecy
when using alpha nymservers to redirect email to alt.anonymous.messages.
There are also second-order threats, arising from the fact that
an attacker can selectively and remotely delete messages from some
spools by using cancel messages, without compromising any NNTP servers.
Ian's post detailed a proposal for implementing a message pool with
better security properties: link encryption, constant size messages,
randomized flooding, perfect forward secrecy, etc.
This mechanism is intended to provide recipient anonymity.  Sender
anonymity must still be achieved by standard chaining methods.
If folks have better ideas for how to achieve really good recipient
anonymity, I hope they'll speak up!
Take care,

@_date: 1996-07-03 22:52:40
@_author: David Wagner 
@_subject: Re: Message pools _are_ in use today! 
In article ,
Nope!  That would be..er..my fault. :-)
You are quite right.  I was mixing my criticisms.  My mistake.
A message pool provides only recipient anonymity, of course.  For sender
anonymity (e.g. posting to a message pool), chaining is the right way to go.
Good points, all of them.
I agree that public message pools seem to give far better security than
reply-block approaches.  (Although the two can be combined: set up a nym
reply-block which just redirects traffic to alt.anonymous.messages; then
the reply-block is not security-critical, but does allow folks to contact
you by a simple email address.)
Jim Bell brought up the really nifty point that someday soon we may be
able to receive these message pools by satellite dish-- hurray for true
broadcasting!  That would provide most excellent security (unless `they'
started requiring licenses, waiting periods, ... to own a dish-- unlikely).
I can't wait.
Another suggestion was to read alt.anonymous.messages by pointing the
anonymizer at it.  This doesn't stand up to my threat model at all.
The anonymizer only provides you anonymity against a malicious server
who is trying to collect marketing information-- it doesn't protect
you against SIGINT folks eavesdropping on network links, performing
traffic analysis, etc. to trace back your access.
Now if we had pipe-net deployed :-), the idea might work...

@_date: 1996-07-18 18:04:20
@_author: David Wagner 
@_subject: Re: Crypto 96 
In article <199607172345.QAA08995
Yeah, should be good fun -- see you there!
I just wanted to point out that many of the papers you mentioned
below are available on the Web, if you want to preview them.
(Please excuse me if any of the URLs are wrong-- I'm logged in
via a slowish link, so I've just copied the URLs from my bookmarks
without checking them.)
I think?
and discussed on sci.crypt and sci.crypt.research.
for an early draft.
I wouldn't call it a ``big new result''; it talks about
differential related-key attacks.

@_date: 1996-07-19 13:59:17
@_author: David Wagner 
@_subject: Re: Educational cryptanalysis competition (small prize) 
In article <9607171243.AA26209
If you have a n-byte plaintext P[0..n-1], define f(P) as Now encrypt P[0..n-1] under your cipher to obtain C[0..n-1].
(Ignore the final reversible unkeyed transformation to hex,
which has no impact on security.)
My observation is that
no matter how many rounds you use.  Here rot_constant is a
key-independent constant, and key_dep_byte depends only on the
key (and not on the plaintext or anything).  Therefore, (for
example) knowing C[0..n-1] reveals f(P) when one known-plaintext
is available.
I'll leave it as an exercise to discover why and derive the
values of the two constants.  Hint: it's enough to prove it
for one round.
I think that I don't need to spend any more time on it (though
I am sure there are many more weaknesses lurking in the code).
In all fairness I can reasonably conclude that
Take care,

@_date: 1996-07-19 20:20:26
@_author: David Wagner 
@_subject: Re: Netscrape download 
In article ,
Looks like we match:
~ $ md5sum /opt/netscape-3.0b5a-US/bin/netscape
a82666e8c83a39c4e4653f0de2a930cf  /opt/netscape-3.0b5a-US/bin/netscape
Also, for any others who might like to compare their Linux .tar file:
~ $ md5sum netscape.tar.Z
fdface7dbbf0ea350847edf1ad37e4a8  netscape.tar.Z
Three cheers for Netscape!

@_date: 1996-07-26 19:01:59
@_author: David Wagner 
@_subject: Re: Data Sources for DES Breaking 
In article <199607242051.NAA13352
How about a Kerberos packet?
Kerberos is a time-honored system.  There are a number of citations
that can be provided to prove that it is in use (perhaps heavy use?)
on Wall Street.
Alternatively, how about a Netscape SSL packet encrypted with DES?
I will volunteer to provide such a challenge if anyone is going to
undertake a serious keysearch effort.

@_date: 1996-07-31 18:36:34
@_author: David Wagner 
@_subject: Re: Paranoid Musings 
In article <199607310502.WAA09812
I don't think so.  None of the FPGAs Ian & I looked at could even approach
the RC4-cracking performance of a fast Intel CPU.
Those estimates assume that a single FPGA can break RC4 in hours.  I think
that is an extremely optimistic assumption, given the available public
information.  But perhaps NSA is orders of magnitude ahead of us in chip
design (unlikely) or orders of magnitude ahead of us in RC4 cryptanalysis
(and we're back to paranoid musings).
Naw, this is orthogonal to the cost of cryptanalysis-- even when all messages
are sent in the clear, they still need this storage.
I would be willing to believe that message selection & storage is a very
expensive part of SIGINT.  However, if one has the resources to break all
encrypted messages in realtime, I don't see why message selection & storage
costs need to increase so significantly.
Nope, I don't buy it.  Show me a chip takes longer to load a known plaintext
and ciphertext pair than it takes to do a 40-bit exhaustive keysearch for that
pair, and I'll show you a chip that has no I/O pins. :-)
Remember, if you have a million FPGAs to crack a thousand messages, you don't
have to send the first message to all million FPGAs, then send the second
message to all million FPGAs, etc.  Instead you should send the first message
to the first thousand FPGAs, and concurrently send the second message to the
second thousand FPGAs, etc.
I agree that key schedule complexity can have a significant influence on the
complexity of exhaustive keysearch.
However, DES's key schedule is actually much better suited to exhaustive
keysearch than RC4's key schedule is.  (I speak with implementation experience.
However, it's not too hard to see why this should be true-- DES was designed
for implementation in hardware, and its keyschedule consists merely of some
bit permutations, which are free in hardware.  RC4 uses RAM heavily, and thus
can incur large I/O costs, and also is highly serialized, so it is not so
well-suited to efficient hardware implementation.)
Yup, brute-forcing 40-bit Blowfish will probably be even harder than RC4.
No, FPGAs are programmable logic, and thus can be easily reprogrammed if the
Netscape default encryption algorithm changes.  Perhaps you are thinking of
ASICs, which have their logic burned in, and cannot be changed.

@_date: 1996-08-01 21:51:02
@_author: David Wagner 
@_subject: Re: Cracking RC4/40 for massive wiretapps 
In article <199608010603.XAA19276
That was the keylength paper.  I think their estimate is way off.
But that's ok-- I do so like the ring of ``8-cent encryption'', even
if I think the derivation is technically dubious :-)
Not with SSL.
SSL uses a random 88-bit salt which is different for every session.
This attack doesn't work.  Fun to think about, though, eh? :-)
[ Unsalted 40-bit RC4 is super-dangerous, and there are all sorts of
nasty games one can play with it.  That's why you should avoid it. ]
Same deal.
Keep those ideas flowing-- one of 'em is bound to work.

@_date: 1996-08-02 23:38:33
@_author: David Wagner 
@_subject: [off-topic] roving wiretaps 
In article <01I7RM0CJM388Y4XIK
I don't get it.  Help me out here-- how can this possibly be constitutional?
I'm reading the Fourth Amendment to our honored Constitution of the United
States, which proclaims
Are we just to strike out that emphasized phrase?  What's going on here?
Someone tell me I'm not just having a bad nightmare.
Apologies if these are silly questions,

@_date: 1996-08-09 18:07:19
@_author: David Wagner 
@_subject: Re: Oregon License Plate Site in the News Tonight! 
In article ,
I'd be most proud to have my name associated with such a project.
I say, what we need is a little more abuse.  I say, a well-publicized
incident of abuse of the driver's license database can do more to
help the cause of privacy than any amount of intellectually compelling
debate.  Perhaps one horrible incident of abuse would ignite enough
public backlash to stop states from selling their databases at the
drop of a hat.
I say this in all seriousness.  Look at how much furor has been
raised from one little incident (the TWA flight, the Atlanta bombing)
which caused an absolutely insignificant loss of life (in the grand
picture).  Look at how much folks want to curb our freedom in response.
We have been shown all too many times how much a highly-publicized
case of abuse can be used to trample on our civil liberties.  It's
about time for us to wise up.  It's time to fight fire with fire.
No regrets,

@_date: 1996-08-13 21:30:32
@_author: David Wagner 
@_subject: Re: (Off Topic) Re: FCC_ups 
In article ,
This is easy.  Just use end-to-end encryption.  No sweat.  (So what if
call setup takes a half a second to do a public key encryption?  The phone
rings for a couple of seconds before the other guy picks it up anyhow.)
Well, there's that nasty key distribution and management problem (e.g.
who certifies the millions of public keys corresponding to everyone's
phone number?), but that's not specific to voice traffic, and this is
a well-known annoying problem.
The *real* challenge: how do you support sender- and recipient- anonymous
phone calls with strong security?  Have fun.

@_date: 1996-09-17 09:59:16
@_author: David Wagner 
@_subject: Re: Workers Paradise. /Political rant. 
In article ,
Why stop there?
Make biometric ID implants the condition for welfare and financial aid, so
we can track them in case they spend it on (gasp!) donations to the Libertarian
Government scholarships for education and research?  Better wiretap their
phones & emails, in case the recipients use the scholarships to work on strong
non-GAKed cryptography.
Hell, folks are also taking advantage of government money every time they
step foot on a park or government road: might as well require citizen-units
to escrow their identity and confiscate their guns as a condition of usage.
``Buckle your thought-escrow-unit, it's the law!''

@_date: 1996-12-29 14:15:43
@_author: David Wagner 
@_subject: Re: Legality of requiring credit cards? 
In article <199612241223.HAA14556
Well, when I fly they ask for 'government issued' picture ID, and
I present my UC Berkeley student ID for inspection.  They usually
grumble at me, but I grumble back, and in the end they've always
accepted it.  Try it sometime.  (And yes, my student ID is probably
eminently forgable -- it looks very ragged and unprofessional.)
P.S.  At JFK I had a guy tell me that they preferred to see my
social security card!  I was completely surprised, since it has no
picture, and (I think) says 'this card not to be used for identification
purposes' at the bottom.  Anyone know anything about this?

@_date: 1997-01-23 15:58:41
@_author: David Wagner 
@_subject: Privacy-enhancing technologies for the Internet 
Ian Goldberg, Eric Brewer, and I wrote a paper giving a high-level
introduction to privacy-enhancing technologies for the Internet.
Nothing terribly new, but it's about time this stuff made it past
oral history and into the literature.  To be presented at IEEE
COMPCON '97 in February.
The paper is available on the web.  A html version is at
        and there's a postscript version at
        Comments, critiques, and discussions are welcome.

@_date: 1997-01-02 13:42:28
@_author: David Wagner 
@_subject: Re: New crypto regulations 
In article <199612301517.KAA01543
Here's one.  Ian Goldberg and I wrote a Dr. Dobb's Journal article on
Netscape's insecure random number generation.  It contained a few short
snippets of code that described how Netsape's PRNG seeding process
worked.  I believe that they may fall under the category of 'cryptographic
source code'.  And...guess what... DDJ in fact published the article
online at
Here's a citation:
Ian Goldberg and David Wagner.  "Randomness and the Netscape Browser".
Dr. Dobb's Journal, January 1996.

@_date: 1997-01-17 11:24:22
@_author: David Wagner 
@_subject: Re: Hi again, and an invitation to kibitz 
In article <199701140755.CAA04514
Some weaknesses:
- It doesn't resist dictionary attacks (no salt) when the attacker can make
    one active probe (forge a fixed challenge and get the client's response).
- It doesn't stop replay attacks (replay a fixed challenge, now the same DES
    key is used, so replay DES-encrypted session data).
- DES-encryption doesn't provide message authentication against active
    attacks; use a MAC too.
- You should use independent DES keys for each direction of the connection.
- Also the DES encryption key doesn't change for each connection.  It should.

@_date: 1997-01-17 11:35:32
@_author: David Wagner 
@_subject: Re: Newt's phone calls 
In article ,
This is well-known.  GSM does this, for example.  I've seen the point
made in several textbooks.
I don't know of any cellular systems that do end-to-end encryption
(which would stop wiretapping at the landline switch) as opposed to
airlink encryption.  Does anyone else?

@_date: 1997-04-03 18:06:04
@_author: David Wagner 
@_subject: Re: No, it's PayWord, no, it's MicroMint, no, it's... 
In article <199703272018.MAA00322
Wow, a perfect straight line.  I couldn't ask for better.
Actually, I posted to sci.crypt.research a while ago about how to adapt
Rivest and Shamir's PayWord scheme to do anonymous micropayments; see
In short, instead of asking the bank for a hash stick and a signature on
the top of the stick, you get a blind signature on a top of a stick you've
generated yourself.  Then you patch up some issues (like double-spending)
that the anonymity raises.
Sadly, it's got a problem that'd probably be a killer for practical
deployment -- it's got the same patent problems that ecash has.  Sigh.

@_date: 1997-04-03 23:31:43
@_author: David Wagner 
@_subject: Re: No, it's PayWord, no, it's MicroMint, no, it's... 
In article <199704040538.VAA01156
In the non-anonymous case, shops can go offline and redeem sticks nightly;
this doesn't prevent double-spending, but allows detection, so that brokers
can blacklist double-spenders.
When you move to anonymity, you need a different approach; going online at
stick commitment time works (i.e. when the shop checks the digital signature
it simultaneously goes online to the bank).  This has some of the costs of
online schemes, but isn't terrible, because you only do it when the first
coin is paid, not when subsequent coins are.
If going online is a problem, you could imagine doing probabilistic
online checking.  The shop has a 10% chance (say) of going online and
checking immediately, and a 90% chance of batching for verification on
the half hour.  If the shop sees a bunch of fraud going on during some
batched verification, then the shop has to take that as a loss, but it
then knows to increase the chance of going online significantly.  You
can imagine auditing agencies (or the bank) publishing daily statistics
on fraud, and businesses adjusting their percentages to respond with
the trends.  Again, different shops will probably have different trade-offs
(based on performance demands, risk, whether they're using durable goods
or selling just bits, and such); this gives them flexibility in choosing
their risk profile.
You mention specifically the special double-spending problem of spending
once at a shop and once when asking for a redemption of a partially-spent
stick.  To help ameliorate this particular problem, some special-purpose
solutions are available: for instance, you could enforce a one-day waiting
period on trade-ins for partially-spent sticks.  For instance, the consumer
commits today, and if no shop has collected by tomorrow, he gets the cash
back; shops are instructed to verify nightly, or else they bear much more
risk.  Consumers don't need to trade back their sticks in real-time; they
can certainly be forced to wait a day or two at no real inconvenience.
I don't know; I know nothing about Chaum's offline coins.
Can you enforce a trade-in where the new stick the user gets has the
same identity information in it that the old stick had, and the bank can
verify this equality (cut-and-choose somehow??) without needing to know
the identity informatino itself?  I don't know.
Good point.  That didn't occur to me.  Thanks.

@_date: 1997-05-11 17:26:17
@_author: David Wagner 
@_subject: Money orders, debit cards, ... 
Some court transcripts from the McVeigh case contain interesting
information about real-life anonymous systems.  See
    Did you know that money orders are not so anonymous as you might think?
On the order itself are digits identifying the post office where the
order was purchased, as well as the date of purchase.  Also, a private
company testified on their money order service, and it comes out that
they keep a computerized record of every money order purchase in a
central database.  Eek.
And read about a real-life instance of traffic analysis of phone calls
based on timing correlations.  This one really happened, folks (though
it was by mistake).  Also, read about how a company offering prepaid
debit cards searched through billions of records to find all phone calls
to or from a certain number, etc.  Read about how they entered a disk
containing information on 100,000--200,000 phone calls (!) into evidence.
(Note: contents of calls are protected by law, but traffic analysis
specifically is allowed, far as I can tell.)
And you value your privacy?  Too bad!

@_date: 1997-05-14 10:22:21
@_author: David Wagner 
@_subject: Re: Public Key Break Paper 
In article <1.5.4.32.19970513194224.00928884
Thanks for posting.
I just took a brief look at it, (thanks for forwarding, Lucky),
and it's pure crap-ola.
[ ObTechnicalTrashing: the least x such that 2^x = 1 mod n is
very likely to be of order n, so 2^x (not modulo!) will be a
x-bit integer, and he ends up computing 2^x without doing any
reductions, so the work factor of his method is at least order
n.  Finding a prime factor by exhaustive search (try 2, 3, 5,
7, ...) would be more efficient... Sigh. ]

@_date: 1997-05-15 06:49:40
@_author: David Wagner 
@_subject: Re: The War is Underway (fwd) 
In article <3.0.32.19970513223226.0074e2bc
Actually, that's not true.  Check out the Rogaway/Kilian paper.
It says that, if you've got 2^p known plaintexts, DESX has an effective
keylength of at least 118-p bits.  So, for instance, if you've got 2^32
known plaintexts, DESX only has an effective keylength of 86 bits.
In short, 3DES is (roughly speaking) stronger than DESX.

@_date: 1997-05-16 05:42:22
@_author: David Wagner 
@_subject: Reporting threshold for NY money transfers lowered 
I thought this might be of interest to cypherpunks:
The threshold for reporting New York money transfers was apparently
quietly lowered to $750 last month.  Looks like all it took was one
order signed by one Treasury official -- eek.  Can they lower the
$10k cash threshold just as easily?
*  NYT Sunday April 13, 1997
*  *  U.S. Seizes $5.6 Million Hidden in a Truck on Way to Mexico
*  By Sam Dillon
*  *  Mexico City, April 12 - United States officials said today that
*  $5.6 million discovered this week in a truck about to cross into
*  Mexico from El Paso was the largest cash seizure in memory along
*  the southwest border.
*  [snip]
*  *  ...probably the proceeds of street drug sales...
*  [snip]
*  *  Officials have seen a big increase in cash seizures lately...
*  [snip]
*  *  In [another] case the authorities believe the traffickers
*  chose to move the cash south out of New York in bulk by
*  car because of an order signed by Mr. Kelly [Treasury
*  Under Secretary Raymond W. Kelly] which required New York
*  businesses transmitting cash to report all transactions
*  over $750.
*  *  Although the order was not announced, word spread quickly
*  among traffickers, and a dramatic drop in money wires to
*  Colombia followed, along with a sharp increase in seizures
*  of cash along the eastern seaboard.
Thanks to  for forwarding.

@_date: 1997-05-29 08:30:43
@_author: David Wagner 
@_subject: Re: Time Magazine: "No Privacy on the Web" (6/2/97) 
You should've asked on cypherpunks.  I found Dianne's SSN for free a
few weeks ago.  It's 567-40-7912.  (No charge -- the first one's free.)
Obtained from .
In article ,

@_date: 1997-05-31 05:33:46
@_author: David Wagner 
@_subject: Re: Crypto Disputes 
In article <1.5.4.32.19970529230949.00937498
Heh.  This article is way behind the times.  (Either that, or the reporter
has been listening too closely to Sun marketing hype.)
ISAKMP/Oakley has been endorsed as the mandatory-to-support key management
standard for ipsec.  Proposals to make SKIP mandatory were explicitly rejected.
The bitter debate is over, and ISAKMP/Oakley won.
Hoo boy is this reporter clueless!  Don't you believe it for even an instant.
