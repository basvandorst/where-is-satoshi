
@_date: 1993-08-17 13:45:23
@_author: Karl Lui Barrus 
@_subject: ANON: remailer list 
Sorry about the delay getting this out but I was waiting for my new
account.  Script updates will be made soon...
The only change is the shut down of phantom, unless it became a secondary
remailer and I missed it.
-----BEGIN PGP SIGNED MESSAGE-----
Q1: What cypherpunk remailers exist?
 1: nowhere  2: hh  3: hh  4: hh  5: 00x  6: hal  7: ebrandt  8: remailer  9: elee7h5 10: hfinney 11: remail 12: remail 13: remailer 14: remailer
15: remail NOTES: 		no encryption of remailing requests
		support encrypted remailing requests
		special - header and message must be encrypted together
	introduce larger than average delay (not direct connect)
      running on privately owned machines
Q2: What help is available?
Check out the pub/cypherpunks directory at soda.berkeley.edu
(128.32.149.19).  Instructions on how to use the remailers are in the
remailer directory, along with some unix scripts and dos batch files.
The public keys for the remailers which support encrypted remailing
requests is also available in the same directory.
Mail to me (klbarrus for further help and/or questions.

@_date: 1993-08-20 15:17:04
@_author: Karl Lui Barrus 
@_subject: KOH virus (long) 
Fellow cypherpunks,
While I am woefully behind in cypherpunks mail, at this time I wish to pick
the discussion on the potassium hydroxide program.  I beleive this is relevant to the list, so I'm posting to the list.  So as to not try
everybody's patience, my own personal opinions and experiences are contained
in a section so delimited toward the end.  Also, some concerns brought up
previously are also contained in their own section, before my opinions.  So
you can stop reading at any time :-).
In summary, I am posting this because I intend to post KOH code when it becomes available.  The feelings expressed about this may very well affect the future of the list.  In fact, I may post to virus-l because it has come
to my attention the topic has surfaced there as well.  And I know that
anti-virus professionals are always interested in the facts of any matter.
A few people have requested copies of the program from me, and I know of
at least one person actively working on a disassembly.  I mention this
partly in an effort to mentally prepare some people on this list for
an event that is certain to happen in the future: the posting of KOH
source code.  I say this: when a disassembly of the program becomes
available, if I receive a copy, I fully intend to post it to this list.
I would like to point out the charter of this list includes the phrase
"Cypherpunks write code."  As we all know software development is a time
consuming process and thus not many programming projects are discussed,
due to complexity, time constraints, slow development, etc.  One such
project a few list readers expressed interest in was the so called
"CryptoStacker" project - a program which would funtion very much like
Stacker does (it automatically compresses and uncompresses disk drives)
except the CryptoStacker would automatically encrypt and decrypt.
Suddenly, a program which claims to do all this surfaces.  KOH claims to
install itself, encrypt and decrypt with IDEA and an unspecified quick
algorithm, and uninstall from the hard drive on request.  The author
explicity states he intends no maliciousness, and will even accept bug
reports and perform patches.  How then can we ignore such a program?
Now the author called his program a "virus", a word that is treated with
near hysteria by some.  I don't give a damn if the author calls his program
a virus, a program, an automatic encryption program, Pretty Automatic
Privacy, a universal Turing machine, or a duck-billed platypus.  The fact
is this program fill the need of many users, or may advance the state of
art in automatic encryption programs.  It most certainly will be helpful
to see IDEA implemented in assembly - perhaps this could be used to many
advantages, in PGP, other packages, etc.
A bit of the disassembly has been performed - and apparently the program
installs itself in memory, hooks various interrupts, and installs itself
on floppies, marking off sectors as bad.  I don't know how Stacker 3.0
stacks floppies to make them portably uncompressable (that is, you can
stack a floppy, and still use it on a system that doesn't run Stacker), but
it is clear it must reserve part of the disk as being used, at least to
contain the decompression routines.  It is also clear that Stacker installs
itself into memory, and hooks various interrupts to compress/decompress
on the fly, like KOH does.  If this is too close to viral activity, then I ask the anti-virus professionals exactly how did you expect a program of this nature to work?
How can a program like stacker funtion if it doesn't hook interrupts,
install into memory, and place certain routines on floppies?  Answers to
these questions may direct efforts and work in another direction more
pleasing to some.
Now, I'm not going to waste my time looking for an official anti-virus
community sanctioned example of a program which does the above.  KOH
is here, and we may learn and benefit from it.
PREVIOUS CONCERNS
Some people wrote in objections to the list about the KOH "virus".  So as
to diffuse a potentially emotional situation, I am not crediting the
original authors, and am paraphasing their statements.
One person expressed concern that all viruses carry potential for damage,
and that a legitimate program would be better.
1) Yes, viruses carry potential for damage.  But the author of this one
   states he intends no malicious behavior.
   * perhaps somebody could enlighten us as to how a program like stacker
     or KOH is supposed to work in "legitimate program" form.  Both
     programs must obviously hook DOS systems calls, install into memory,
     and place "undoing" routines on floppies.
   * not to insult anyone, but to imply that only viruses carry potential
     for damage is a pretty outrageous selective use of facts.  PKZIP and
     PGP both had bugs which caused lost data, and even DOS itself has a
     buggy CHKDSK command.
{at this time I would like to apologize profusely to Phil Karn, Hal Finney,
Derek Atkins, Edgar Swanks, Phil Zimmerman, and anybody else involved in
PKZIP, PGP, or creating software in general.  The people devote hours of their time and expertise towards programs which help thousands of users; I am not poking fun of anybody or blaming them or anything like that.  I just
wish to point out that modern software is complex, configurations are uncountable, and that despite the best efforts, mistakes are made.  Fortunately, most are caught quickly and corrected.  I don't think anybody can expect perfection.}
Another person expressed concern that the software comes with no explanation
of ramification.
2) Well, I have some interesting news: no software does.  In fact, after
   checking the manuals for every piece of commercial software I could find,
   I discovered that all software comes with two disclaimers:
   1) The manufacturer does not guarentee the software even works
   2) The manufacturer disclaims all damages
   So perhaps those who wish such promises from a public domain encryption
   program are expecting a lot given that there isn't even any commercial
   software which does this.
{interesting crypto relationship to reputation markets.  The software industry is a billion dollar industry that sells products not even
guarenteed to work, all damages disclaimed.  How then is the industry
so successful?  Answer: reputations.}
PERSONAL OPINIONS
Well, I'll keep it brief since if you've read this far, you are probably
getting tired :-)
* I do not condone or encourage speading malicious code, especially to
  novice users.  Perhaps the worst thing that viruses do is create a   sense of fear among people already intimidated by computers.  * However, I don't see anything wrong with knowledgeable users who accept
  the risk sharing code.  Naturally, I expect they will take responsibility
  for their actions and not seek to destroy anybody elses property.  Keep
  it local, use your skill to everybody's advantage.
* I think viruses are severly over-hyped.    It is my deepest nightmare to one day open the paper and see the headline
  "Planet Earth Knocked Out of Orbit by Computer Virus!"
  Eventually with fancier security (operating system wise), cryptography   (message digests, authentication), and research on virus scanners the   problem will go to zero.
  Yes, I know it is impossible to have a program perfectly detect viruses.
  But in my own reading it seems that it is possible to have one program
  have no false positives (but some false negatives), and another have no   false negatives (but some false positives).  The combination of these two
  scanners would then be optimal.
  If this is incorrect reasoning, please let me know, with an explanation
  if possible.
* I've lost 10 minutes of work because of the nVIR virus on the copy of
  CricketGraph I once used.  I lost one whole week of work (2400 minutes)
  helping figure out why Windows, Novell, and Dr Dos wouldn't work
  together.  Files were lost, machines crashed, device drivers kept stomping
  one another.  The problems were fixed in bug patches from the   manufacturers.
  So maybe my experiences were atypical, but I just can't get excited about
  fearing a viral attack.  I am more likely to fear the commercial software
  I use.
* Some elements of the anti-viral community seem to act in a self-serving,
  high priesthood mode, gathering occasionally to congratulate and agree
  with one another.
  In fact, some seem to act like the NSA: answerable to no one but
  themselves, seeking to censor or otherwise restrict information they
  deem sensitive, preferring you trust them in various matters, etc.
  Now, I point no fingers, make no accusations, and in no way begrudge
  any of these people.  It's an honest living, and many people do benefit
  from their efforts.
  However, I am reminded of a favorite quote of mine:
  "The louder they spoke of their honor, the faster we counted the spoons."
  That is, the louder someone condemns viruses, the more hysteria they
  generate, the more vehement the accusations, the more I wonder how much
  $$$ this person stands to make.
* That's it.  Again, I say studying the KOH will benefit us.
Comments are welcome at klbarrus  However, I am a full time
student once again; classes being Monday so I will probably take a while to

@_date: 1993-08-24 12:46:53
@_author: Karl Lui Barrus 
@_subject: Blinding messages 
Earlier Perry asked for references to blinding methods.  I can provide
one, but the mathematics is fairly simple and straightforward, so I'll
just talk about it here.  Any good intro text on number theory, or even
some crypto books (Denning, Seberry & Peiprzyk) will have all the math
you need to know.
Conceptually, when you blind a message, nobody else can read it.  A
property about blinding is that under the right circumstances if another party digitally signs a blinded message, the unblinded message will contain a valid digital signature.
So if Alice blinds the message "I owe Alice $1000" so that it reads (say)
"a;dfafq)(*&" or whatever, and Bob agrees to sign this message, later
Alice can unblind the message Bob signed to retrieve the original.  And
Bob's digital signature will appear on the original, although he didn't
sign the original directly.
Mathematically, blinding a message means multiplying it by a number (think
of the message as being a number).  Unblinding is simply dividing the
original blinding factor out.
One thing protocols that involve signing blinded messages have to watch
for are messages that you don't really want to sign.  If someone asks
you to digitally sign a random stream of symbols, remember that what you
sign may be unblinded to reveal a contract, etc.  Techniques of getting
around this seem to be cut-and-choose protocols, which I won't get into
Judy Moore's paper "Protocol Failures in Cryptosystems" - appeared in
IEEE Proceedings, May 1988, Vol. 76, No.5, and also appears in the big IEEE Crypto book Simmons edited - discusses this as the "Notory Protocol."
I'll excerpt from her paper:
1) To setup the notary protocol, Alice chooses RSA parameters p, q, e, d
   She publishes her public key e, and n = pq
Bob now wants to trick Alice into signing a message which says she owes
him some money.
2) Bob now chooses an arbitrary number x.  He computes y = x^e mod n.
   e is Alice's public key and everyone knows it.
Bob can now use y (bliding factor) to obtain forgeries on another 3) Bob forms the messages he wants, and muliplies in the blinding factor    y.  He calulates m' = ym
4) Alice agrees to sign a message m' which is total gibberish.  She
   computes s = m'^d mod n and returns the result s to Bob.
5) Bob then calculates s' = s x^-1.
   A valid signature on m' is m'^d mod n = (ym)^d mod n
                                         = y^d m^d mod n
                                         = x m^d mod n
   so all Bob has to do is remove x from what Alice signed and he has
   m^d mod n, Alice's digital signature on message m.
An example with numbers (I'm currently learning Scheme so I will give
the Scheme code I used):
Alice chooses p = 43, q = 47, thus n = 2021
              d = 5, gcd(d,phi(n)) = 1, so e = 773 (* see note below)
Bob chooses x = 314, y = x^e mod n
                       = 314^773 mod 2021
                       = (expt-mod 314 773 2021)
                       = 1271
Bob creates the message m = 99, which means Alice owes him money.
Bob blinds the message by calculating m' = ym
                                         = 1271 99
                                         = (modulo (* 1271 99) 2021)
                                         = 527
Alice agrees to sign 527, a message which is possible unintelligible.
She calculates s = m'^d mod n
                 = 527^5 mod 2021
                 = (expt-mod 527 5 2021)
                 = 360
Bob takes Alice's signed message s = 360 and unblinds it.
He calculates s' = s x^-1
First he calculates x^-1 = 354 (*see note below)
Then, s' = 360 364
         = (modulo (* 360 354) 2021)
         = 117
As a check, say Alice decides to sign the original message m=99.
Then, the signed message would be m^d mod n
                                = 99^5 mod 2021
                                = 117
So Bob does indeed have a message which is his original message with
Alice's digital signature on it.  Be more careful next time, Alice.
* Note:
There are two ways I know of to calculate the inverse of a number.
First, x = a^((phi(n)-1) mod n will yeild x, the inverse of a mod n.
But, sharp eyed people will note you need phi(n) to calculate this way
- - and only Alice knows the factorization of n.  So she can calculate
e, the inverse of d mod phi(n) as:
e = d^((phi(phi(n))-1) mod phi(n)
  = 5^(phi(1932)-1) mod 1932
  = 5^(264-1) mod 1932
  = 5^263 mod 1932
  = (expt-mod 5 263 1932)
  = 773
Now how does Bob calculate the inverse of x mod n?  He does not know
the factorization of n.
Well, for the purposes of this problem I did now how n factors so I
used it :-)
BUT, there is a way you can calculate the inverse of a number mod n
without knowing how n factors.  The algorithm is related to Euclid's,
the one that you can use to tell if two numberse a relatively prime.
Essentially, you run through Euclid's forwards, and then in the reverse
direction, grouping and substituting, and the inverse will pop out.
Once you do it by hand it will be clear, and you won't ever want to do
it by hand again :-)
If you use Mathematica, it will let you do PowerMod[x, -1, n] to
calculate the inverse of x mod n.  But Scheme won't since the three
integers for expt-mod must be positive.

@_date: 1993-08-26 10:22:30
@_author: Karl Lui Barrus 
@_subject: Re: blinding message & newbie questions 
[I think I messed up when I responded originally ... KLB]
Sure, I'll take questions :-)  I may be a little slow in responding at
the moment.
Not exactly.  Blinding/Unblinding is multiplication;
Encryption/Decryption is exponentiation.
While I can unblind a document without knowing phi(n), I cannot
decrypt a message without knowing phi(n).  Knowing phi(n) is
equivalent to knowing how n factors, so this is intractable.
phi(n) = Euler totient function.  The conditions are usually satisfied.  Offhand, the only one I can
think of is that x and n must be relatively prime, otherwise there is
no inverse of x mod n.
With really huge numbers, the chances of guessing x such that gcd(x,n) != 1 are very small.  If this does happen, then you've
guessed x such that x is a multiple of one of the factors of n!  Time
for somebody to pick a new p,q, and n :-)
As far as PGP, I think the only messages PGP produces are exponentiated.
I mean, PGP doesn't produces messages obscured only by a muliplication
factor; the ascii snow messages PGP generates are encrypted, signed,
compressed, or all of the above.
So this doesn't arise.
Let me get back on this.  I beleive the general name these sorts of
protocols go under is "embassy protocols".
They are useful in things such a digital cash: blind a message, and
get the bank to sign it.  Then unblind and you have a valid, digitally
signed piece of cash.  The bank is unable to track it since it
couldn't read it (message was blinded when the bank signed), but the
bank can verify that the cash is digitally signed by them.
It also arises in automatic protocols: say in computer security.  If
the computer sends a challenge string which you decrypt and send back,
the computer can encrypt with your public key to verify you.  If the
challenge string is random, you may have unwittingly digitally signed
a blinded document that is not in your favor...
The cut-and-choose protocol allows a person to sign a blinded document
and be sure they aren't signing something else.  I'll get back on this
as well.

@_date: 1993-08-26 12:05:48
@_author: Karl Lui Barrus 
@_subject: Re: blinding & PGP 
It occured to me over lunch that PGP IDEA encrypts files; what is RSA
encrypted are session keys, hashes, etc.  So you never really digitally sign the file itself, you instead
digitally sign the portion that contains the session key used, hashes
and so forth.
Again, I'm sure PGP doesn't blind the RSA portion, so I would
say you can't bamboozle someone into signing a blinded document with
PGP.  Now, as for verifying a commercial version of PGP by comparing
encrypts... it all depends on how exactly randseed.bin figures into
the session key creation.  Two files encrypted with the same public
key could compare very differently if the random session keys are
different, since the IDEA encryptions would differ and the so would
the MD5 hashes, and so forth.
I'm not sure if additional info besides the randseed.bin file goes
into session key creation.

@_date: 1993-08-27 08:35:56
@_author: Karl Lui Barrus 
@_subject: Re: Adding an "AKA" 
I think all you do is
pgp -ke ferguson
and it will ask if you want to add more info to your public key.
I did this so now my public key looks like this: 'pgp -kvv barrus'
Key ring: '/home/klbarrus/Crypto/pgp/pubring.pgp', looking for user ID "barrus".
Type bits/keyID   Date       User ID
pub  1024/5AD633 1993/01/08  Karl L. Barrus                              Karl L. Barrus 1 key(s) examined.

@_date: 1993-08-30 07:23:44
@_author: Karl Lui Barrus 
@_subject: REMAIL: Attacks on remailers 
Well, I tried to implement this on a test remailer as follows:
1) file incoming mail in a spool directory
2) at midnight, pick a random file in the spool directory, operate on
   it, mail it out, and delete
3) keep on going until the directory is empty
Naturally, you could make the interval larger: say a week.
With no root privs on the machine, I tried using the at command to
perform the above function and then reschedule itself for tomorrow.
Problem: if the machine reboots then the mailing out portion is killed.
I'll fiddle with it some more.
Yes!  This might help avoid some log files.
If you add random stuff to the end of an encrypted message and encrypt
again, when you decrypt will PGP throw away the ending junk?  If so,
maybe the routing software could include random bits between each
nested encryption instead.
If the remailers encrypt then the operators will have to keep adding
to the remailer's pubring.

@_date: 1993-08-31 10:54:37
@_author: Karl Lui Barrus 
@_subject: PGP: question 
Are there any heavy implications, security and otherwise, to the
truncation of the environment variable PGPPATH that occurs in
Background: I've been trying all sorts of stuff getting pgp to read
config.txt when I'm anywhere else in my directory structure.  My home
directory is /home/klbarrus which as it turns out is a symbolic link
another directory (it may even change from time to time).  Since I
never could get PGPPATH to work on my old NeXT account, and my home
directory there was also a link to something else, I thought: AHA!
PGP uses stat() and/or some other functions which don't follow
symbolic links!!
Nope, it does, so that wasn't it.
So, I poked around the code more and found out that buildfilename()
returns null if the length of getenv(PGPPATH) is greater than 50.
This probably explains why it didn't work on the NeXT; PGPPATH was set
to some huge path like /private/Net/tree/Users/barrus/Cryptography/pgp
or something close, so buildfilename() returned null.  But the
pathname on my new account is definitely shorter than 50 characters,
but I decided to try increasing 50 just to see what it would do.
Right before remaking pgp I realized the mistake I had made, one that
is (export) almost too embarrasing to admit :-)
Anyway, any "deep" reason to return null if the length of the
environment variable is > 50?  Or is it just to keep the path
relatively short, maybe to keep from breaking a system call on some
machine out there?

@_date: 1993-08-31 13:14:38
@_author: Karl Lui Barrus 
@_subject: REMAIL: list 
Q1: What cypherpunk remailers exist?
 1: nowhere  2: hh  3: hh  4: hh  5: 00x  6: cdodhner
 7: hal  8: ebrandt  9: remailer 10: elee7h5 11: hfinney 12: remail 13: remail 14: remailer 15: remailer
16: remail NOTES: 		no encryption of remailing requests
		support encrypted remailing requests
		special - header and message must be encrypted together
	introduce larger than average delay (not direct connect)
      running on privately owned machines
Q2: What help is available?
Check out the pub/cypherpunks directory at soda.berkeley.edu
(128.32.149.19).  Instructions on how to use the remailers are in the
remailer directory, along with some unix scripts and dos batch files.
The public keys for the remailers which support encrypted remailing
requests is also available in the same directory.
Mail to me (klbarrus for further help and/or questions.

@_date: 1993-09-02 05:54:40
@_author: Karl Lui Barrus 
@_subject: MISC: cut & choose 
Earlier I mentioned cut-and-choose protocols as a way of protecting from
signing a message that you really don't want to (ways of forging signatures
on documents).
The protocols are simple and rest on a probabalistic argument (similar in
some ways to the "proof" in a zero-knowledge proof) - you can be certain
to any degree you wish that you are not about to sign a harmful document.
Essentially, Bob makes multiple copies of the document and appends random bits on the end of each.  Then, he blinds each document with a different blinding factor, and presents all the copies of the blinded documents to
Alice.  But before she signs anything, she demands that all documents
are unblinded, except one.  Bob complies and produces the unblinding factor
for all the documents except one, and unblinds them.  Alice looks over the
documents to verify their content, and if she is satisfied, she goes ahead
and digitally signs the remaining document, which is still blinded.
For example, say Alice is a digital bank.  Bob wants to get $10 of digital
cash, so he prepares a message, blinds it, and goes to the bank. However, Alice, who has read about the notary protocol, is leery of signing random
strings, so Bob goes home again and prepares 100 messages, 100 blinding factors, and blinds each message with its own blinding factor.  He shows up
at the bank and gives Alice all the messages.  Alice picks one message and hands back the other 99, demanding that Bob unblind them.  So he complies, and Alice verifies that they all are in fact messages for $10.  Satisfied,
she digitally signs the last message, knowing that there still is a 1%
chance that Bob cheated the bank by slipping in a $100 message with the
$10 messages.
So Alice can feel as comfortable as she likes by just asking for more
Say that cash messages look like this (with random bits at the end):
This is $10 of digicash legal tender from First Digital. ADF!
When Bob blinds this, it becomes unreadable so Alice can't verify that it
is in fact a legitimate message (Bob may be trying to get Alice's signature
on another document).  But Bob does need to blind the message or the bank
(Alice) can note the random bits, serial number, or whatever, and thus
correlate the cash with him.  The solution is the above protocol, which leaves an 1/n chance of fooling
the bank, where n is the number of messages.  Alice can ask for n messages
where n is large, but there will still be a 1/n chance that Alice picks
the special message and is tricked into signing it.  (Say Bob slips in a
message for $1000 into a bunch of $10 messages; he may get really lucky
and have Alice pick the $1000 message, demanding he unblind all the rest
to reveal $10 messages).
However, this can get pretty expensive to implement for high confidence levels.  Again, I'm sure a document forgery can't occur with PGP or even
RIPEM (in the notary protocol manner) since neither program blinds messages:
they calculate hashes, compress, encrypt, digitally sign hashes, but don't obscure messages by a multiplication factor.

@_date: 1993-09-02 05:58:16
@_author: Karl Lui Barrus 
@_subject: MISC: DH key xchange 
Earlier somebody (Samuel Pigg?) asked for a D-H key exchange reference.
It should be in any modern crypto textbook, and is easy to follow.
Alice and Bob want to exchange keys over a hostile channel.  They pick
a prime p, a random number a, and exchange this information.  Alice picks Ra, a random number less than p, and keeps it secret.  Bob picks
Rb, also a random number less than p.  Alice calculates Ya = a^Ra mod p, and sends the result to Bob.  Bob calculates Yb = a^Rb mod p, and sends the result to Alice.  To recover the common key Alice and Bob will now use with
each other, they raise the result the other person sent them to their secret
random number, and take the result modulo p.  That is, Alice calculates
Yb^Ra mod p, and Bob calculates Ya^Rb mod p.
Even if an eavesdropper gets a, p, and the intermediate Ya and Yb, the final
key cannot be determined (due the difficulty of the discrete logarithm).
1) Alice and Bob pick a = 11, p = 347
2) Alice picks Ra = 240
   Bob picks Rb = 39
   Alice and Bob keep Ra and Rb secret
3) Alice calculates Ya = a^Ra mod p
                       = 11^240 mod 347 = 49
   Bob calculates   Yb = a^Rb mod p
                       = 11^39 mod 347 = 285
4) Alice sends Bob Ya = 49
   Bob sends Alice Yb = 285
5) Alice calculates Yb^Ra mod p = 285^240 mod 347
                                = 268
   Bob calculates   Ya^Rb mod p = 49^39 mod 347
                                = 268
   Now Alice and Bob can communicate using their common key.  Even if an
   enemy intercepts a = 11, p = 347, Ya = 49, and Yb = 285, the common
   key cannot be calcuated.  (Well, they can here since I'm using small
   numbers, but with large numbers the discrete log problem is intractable).
Karl L. Barrus: klbarrus         keyID: 5AD633 hash: D1 59 9D 48 72 E9 19 D5  3D F3 93 7E 81 B5 CC 32 "One man's mnemonic is another man's cryptography"   - my compilers prof discussing file naming in public directories

@_date: 1993-09-02 05:56:54
@_author: Karl Lui Barrus 
@_subject: KOH: disassembly 
About the KOH virus/program:
I've receive two disassemblies of the program (but not the original source
code yet; I haven't had a chance to try to contact the author).
I'm not sure that either person who mailed me the disassembly wants to take
credit for it, publically at least :-) so I'll just thank them here for their work, and answer questions in email (although one of the disassemblies
includes an email address).  One person indicated that KOH really isn't a
virus at all, so maybe this can be answered by folks who know more about
such matters than I do!
Apparently the fast encryption method is indeed an XOR; other than that I
haven't had a chance to look over the code.  I am interested in the IDEA
implementation that KOH includes.
So, if you are interested in copies of the disassembly, let me know.  I had
one report that KOH locked up an 8088 PC from a tester (thanks!).
I'd try to post something intelligent about the code but I just haven't
looked at it enough to comment.
Karl L. Barrus: klbarrus         keyID: 5AD633 hash: D1 59 9D 48 72 E9 19 D5  3D F3 93 7E 81 B5 CC 32 "One man's mnemonic is another man's cryptography"   - my compilers prof discussing file naming in public directories

@_date: 1993-09-04 21:05:51
@_author: Karl Lui Barrus 
@_subject: REMAIL: RIPEM and PGP remailer 
I have turned my old account (elee9sf into a
cypherpunks remailer that supports BOTH pgp and ripem.  In addition to
the pgp pasting token
Encrypted: PGP
there is also a ripem pasting token
Encrypted: RIPEM
I've just tested the remailer with pgp, ripem, pgp nested inside
ripem, and ripem nested inside pgp, and all the messages have come
back successfully.
The installation went fairly quickly with Sameer's scripts; I
essentially added the necessary lines to the maildelivery file, copied
the pgpmail.pl file to ripemmail.pl (that's what I indicated in the
maildelivery file), altered ripemmail.pl to recognize RIPEM
message delimiters, and changed around the string that is built with
the $system call.
I apologize to those who have asked for a RIPEM remailer for taking so
long; I was bogged down trying to get RIPEM compiled on rosebud, an
HP/UX (cc, c89, -Aa flags: nothing worked; no gcc or disk space to
install gcc, unproto didn't help - I now think the compiler is way
The only drawback is that account is due to expire sometime.  Plus, if
many people decide to support ripem in addition to pgp the scripts are
going to need some reworking :-)  In order to update the dos batch
files I'll need an MSDOS ripem executable - has anyone seen any?
(Apparently I don't have a command line compiler to build it myself; I
have Turbo C++ for Windows)
Here are the public keys:
For the pgp half

@_date: 1993-09-05 09:21:01
@_author: Karl Lui Barrus 
@_subject: Re: Remailer Reliability 
Header construction software for unix and pc's has existed for months
and is available at soda.berkeley.edu
Granted, I'm waiting to validate three of the remailers so the scripts
are a bit out of date, especially the dos batch files...
Karl L. Barrus: klbarrus         keyID: 5AD633 hash: D1 59 9D 48 72 E9 19 D5  3D F3 93 7E 81 B5 CC 32 "One man's mnemonic is another man's cryptography"   - my compilers prof discussing file naming in public directories

@_date: 1993-09-05 09:46:01
@_author: Karl Lui Barrus 
@_subject: REMAIL: 9/6/93 
With all the new remailers, and more to come soon, I thought I'd post an
updated list.
Updated public keys and unix scripts should be available soon; hopefully I'll
update the dos batch files this weekend as well.
NOTE: my new remailer (elee9sf is not on this list, partly
because I don't expect it to run for any great length of time.  It is more
of an experiment to support PGP and RIPEM at the same remailer.  If you
missed the public keys, mail to me and I'll send them.
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 9/6/93
Q1: What are the anonymous remailers?
 1: nowhere
 2: hh
 3: hh
 4: hh
 5: 00x
 6: cdodhner
 7: hal
 8: cs60a-qu
 9: ebrandt
10: catalyst
11: sameer
12: remailer
13: elee7h5
14: hfinney
15: remail
16: remail
17: remailer
18: remailer
19: remail
NOTES: 1-6		no encryption of remailing requests
7-19		support encrypted remailing requests
19		special - header and message must be encrypted together
12,17,18,19	introduce larger than average delay (not direct connect)
12,17,19	running on privately owned machines
Q2: What help is available?
Check out the pub/cypherpunks/remailer directory at soda.berkeley.edu
(128.32.149.19).  chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
Mail to me (klbarrus for further help and/or questions.
Q3.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
 apparently blocks anonymous remailer posts
 blocks from non-berkeley sites (so use the berkeley remailers :-)

@_date: 1993-09-09 12:12:23
@_author: Karl Lui Barrus 
@_subject: Re: REMAIL: Perl/problems 
Could you give an example?  I tried a message like the following
(between the cut marks) which I sent to elee7h5
Anon-To: klbarrus
and it came back OK, with the blanks squeezed out.  So I'm probably
misunderstanding what you said.

@_date: 1993-09-14 13:35:22
@_author: Karl Lui Barrus 
@_subject: Re: REMAIL: testing remailer & keys 
I think there are two more remailers:
elee7h5 and
(keys below)
Incidentally, I see you have the Mr. Remailer key
(elee6ue  How did that slip out? :-)
I must have extracted it instead of elee7h5
Anyway, that one should be stable - I've used it for various scripts
hacks and testing, and I restored it to plain form recently.
In fact, it may become the preferred remailer on rosebud - the account
it is in is still "valid"; it belongs to a friend of mine who is
currently working in New Hampshire (he has no telnet access).  His
password is still valid, and the remailer is set up with his
permission (even blessings).
I mention this since I have been told by a lawyer that running a
remailer on an account I no longer have legitimate access to breaks
about three laws here in Texas.  So I attempted to re-legitimize my
account (described below).
Once upon a time that was my account, but I'm through with that grad
area, and university, so the account is locked now... but my directory
structure is still there.  So, I mailed to two people in charge on
rosebud and told them to get back to me.  So far, I haven't heard
anything, so maybe they don't care!  Actually, if it doesn't impose a
cpu burden (it doesn't) or take up much space (it doesn't), they might
not give a crap.
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.3a
-----END PGP PUBLIC KEY BLOCK-----
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.3a
-----END PGP PUBLIC KEY BLOCK-----

@_date: 1993-09-14 14:44:04
@_author: Karl Lui Barrus 
@_subject: REMAIL: list 
Anon-To: cypherpunks
Here is an interim release of the list, which includes the elee9sf
and elee6ue remailer.  (And you thought I was joking when I said
that some people run remailers that aren't announced :-)
I cleaned up the scripts at elee6ue and in the process of creating
the proper directories for caching (which is NOT implemented just yet) I
zapped the pgp directory and the keyrings... so now there is a new key
for elee6ue keyid = BBC00D.  Sorry about that!
Also, my key klbarrus keyid = 5AD633 has an A.K.A. on
it for elee9sf  This is NOT the public key to the remailer,
whose keyid is DC9EE9.
I sign the public keys of remailers I have verified as working, so if you
get the latest pubkeys.tar.gz file from soda or the keys from me, you
will find a signature from 5AD633 on them.
Lastly, thanks to folks who are contributing programs to help other use
the remailers!  I decided to keep my offerings as shell scripts or batch
files, but there is only so much these languages can do, so I welcome
"high" level help programs (source included :-).  Nate's program is
mentioned, but not Alex's (yet) since it isn't available via ftp (yet).
I'll try to keep on top of this stuff.
Cypherpunk anonymous remailers, 9/15/93
Q1: What are the anonymous remailers?
 1: nowhere
 2: hh
 3: hh
 4: hh
 5: 00x
 6: cdodhner
 7: hal
 8: cs60a-qu
 9: ebrandt
10: catalyst
11: sameer
12: remailer
13: elee6ue
14: elee7h5
15: hfinney
16: remail
17: remail
18: remailer
19: remailer
20: elee9sf
21: remail
NOTES: 1-6		no encryption of remailing requests
7-20		support encrypted remailing requests
21		special - header and message must be encrypted together
12,18,19,21	introduce larger than average delay (not direct connect)
12,18,21	running on privately owned machines
20              supports RIPEM encryption, caches all requests
Q2: What help is available?
Check out the pub/cypherpunks/remailer directory at soda.berkeley.edu
(128.32.149.19).  chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
Also, at 129.82.156.104 in /pub/pgpc/ are two files: pgp22.tar.gz,
pgp22.tar.Z which assist in using the anonymous remailers, including
Mail to me (klbarrus for further help and/or questions.
Q3.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
 apparently blocks anonymous remailer posts
 blocks from non-berkeley sites (so use the berkeley remailers :-)

@_date: 1993-09-18 15:19:39
@_author: Karl Lui Barrus 
@_subject: Cypherpunks & GOPHER 
I'd like to announce the Cypherpunks Gopher Site - dedicated to
putting up information for access, and meant to be a list resource.
I'm running the gopher site at chaos.bsu.edu, thanks to Chael Hall,
who graciously donated an account to me to be used for any and all
projects.  This is something I've been wanting to do for quite some
time but have been unable to.  But now I have an account and a
sympathetic system administrator...!
Chaos.bsu.edu is 147.226.53.28, and the port is 2000.  That is port
2000 and not the usual port 70 - when Chael and I have some more time
I will ask him to perform the various and necessary incantations
(chown) and I'll move it to the usual place.
So: try 'gopher 147.226.53.28 2000' and browse around.
The site doesn't have much stuff yet...  I plan to add more
information sometime in the future.  Currently the site consists of
some old back articles from the list, some faq's, etc.  I plan to sift
for more stuff, especially Clipper related, and add it in.
In posting back articles, I have attempted to give proper credit at
the BOTTOM of the article, unless a signature already appears.  I
figure that posts sent to the list are meant to be seen, but if the
original author of something wants is taken off, mail me.  If lots of
people want stuff removed, I'll probably just solve the whole problem
with 'rm -rf ~/gopher-data'
I will sift through my archives of the list, incomplete as they are,
and add files when I have time.
Direct questions to: klbarrus

@_date: 1993-09-18 16:39:39
@_author: Karl Lui Barrus 
@_subject: gopher site 
I forgot to mention I will take suggestions for what to place at the
gopher site - for example, what 10 or so Clipper articles from the
archives at soda.berkeley.edu MUST be available?  I haven't read them
all and won't have the time for the forseeable future to do so.
Pointers and suggestions to other docs and files are welcome.  Should
I put stuff like appropriate rfc's and documentation (pgp and ripem,
etc.) or not?  All of this is subject to disk space and it may be I'll
give preference to shorter items.
I am leaning towards including the rfc's for PEM and the two for
Rivest's MD4/MD5 hash algorithms.

@_date: 1993-09-18 23:31:41
@_author: Karl Lui Barrus 
@_subject: GOPHER: misc 
Thanks for the feedback about links - I didn't read that far in the
server.doc!  It looks like I could point to the EFF gopher for
legislation and stuff, if they wouldn't mind...?
But, stuff I link to has to be available from another gopher, right?
I mean, I just can't point to a directory on some machine and have
gopher retrieve the file for viewing?  Or can I?  Because I definitely
would like to have the RFC's and message digest stuff viewable, or
pointed to.  Also, will gopher uncompress a file before displaying?
I think I should read the gopher FAQ :-)  And look at WWW when I have
some time.
Also, where is the "Digital Silk Road" paper?  I'd like to put the
text version in the "Digital Cash" section.  I'd also like to put the
two reports at cwi up, but those are postscript...
gopher.wustl.edu has a TANTALIZING menu item for the ftp site, but I
got a connection refused message.  I need to talk to Chael to see
exactly what kind of disk space we have to work with - it looks like
to me an ftp option retrieves files to the gopher site (chaos).
I put up some more stuff, including remailer public keys, but not much
more on anonymous mail and still nothing on clipper.

@_date: 1993-09-19 09:56:50
@_author: Karl Lui Barrus 
@_subject: GOPHER: cpsr 
I just discovered the CPSR gopher (gopher.cpsr.org) mirrors the
cypherpunk soda archive, including the clipper directory there.  So
I'll figure out how to create a link to it.
I don't know about cool links though; the only gopher sever and client
I could compile on chaos (net BSD some.version) was gopher1.12S, and I
don't think is has that functionality.  Later, I'll give the
gopher2.06 a try again.
Plus, I've noticed that sometimes the name resolver can find
chaos.bsu.edu, sometimes not, for whatever reason.  So maybe I'll talk
to Chael and see if we can't make a gopher login for telnet access.

@_date: 1993-09-20 16:29:59
@_author: Karl Lui Barrus 
@_subject: REMAIL: policy 
Tim asks about remailer policy: here is mine.
About logging: I think there are two kinds of logs remailers can keep.
By default, the "archive.remail" and "archive.pgp" (and
"archive.ripem") files are kept, which record messages as they pass
through.  Also, there is debugging logging, which records stuff like
the return value of pipes, user environment variables, whether pasting
tokens and message delimiters are found, etc.  Further, Hal showed how
the maildelivery file can be extended to log usage only - an entry
appended to a file for every use (see the cypherpunks gopher site :-)
in "Anonymous Mail" for how to do this).
I don't keep debugging logging or archive logging - I unlink the
archive.* files every time slocal is invoked.  Actually, I don't keep
usage logs either.  However, I haven't had a chance to drop in a
sendmail agent, so there is always the syslog file I can't control.
Hm.. I suppose I could just remove the relevant lines from the
maildelivery file and avoid the archive.* files completely.  I will do
Errors (malformed messages) are dropped in the elee7h5 and
elee6ue remailers, and get forwarded to me
(klbarrus from the elee9sf remailer.
This is so mail intended for me but sent to my old address still gets
Furthermore, the elee7h5 remailer is locked - I can't log in
anymore.  But, the directory structure is preserved, the remailer
still works last time I tried, and I mailed to the admin asking him to
contact me about this about two weeks ago, and haven't heard back. Encryption: elee7h5 elee6ue elee9sf support
PGP encryption.  Also elee9sf supports RIPEM.
Caching: elee9sf caches messages, remailing in a random order
at midnight.  More precisely, it caches them in random order and mails
out every midnight.  So if you wrap your PGP encrypted message inside
a RIPEM encryption, it will stay until midnight the first day to
unwrap the RIPEM, and then will stay till midnight the next day to
unwrap PGP to get the remailing request.
Message padding: I'm experimenting with this, but not in production
mode just yet.  It's easy enough to pad so the messages waiting to be
remaild are the same size, but I want to extend this so what leaves
via sendmail or it's replacement is also the same size.
Ownership: well, these are all school accounts so I don't have final
authority over the machines.

@_date: 1993-09-21 11:56:33
@_author: Karl Lui Barrus 
@_subject: GOPHER: now on port 70 
Chael has made the necessary changes, and the cypherpunks gopher now listens to port 70 as standard gophers do...
So 'gopher chaos.bsu.edu' or 'gopher 147.226.53.28'.
I will look into announcing the site to the gopher list maintainers at
UMN; perhaps some sites that are able to look up chaos.bsu.edu
consistently will consider including a pointer to us!
Karl Barrus

@_date: 1993-09-21 12:21:33
@_author: Karl Lui Barrus 
@_subject: MAIL: anonymous, positive reputations 
Earlier, Graham mentioned some concerns about anonymous mail;
specifically it isn't easy to respond to the author, most messages are
off topic, etc.  (hopefully not referring to my posts sent through
remailers :-) on topics like the cypherpunks gopher and caching
And some people are asking about marking anonymous mail (gopher plug:
check the article "Why Mark Anonymous Mail?" at the gopher site in the
"Anonymous Mail" section, contributed by Hal Finney sometime ago).
Currently, I sign my posts sent through anonymous remailer, sometimes
including my address at the bottom of the post itself.  I know others
do this as well - Hal Finney, probably others I can't think of.
I am working on (and off as time constraints crop up) a positive
reputation scheme for anonymous mail.  My stab at this is somewhat
modest: a program that sifts through elm mail folders (similar to the
elm frm command) and produces a formatted list containing message
number, email address of author (frm sometimes reports name and I like
email addresses instead), and subject.  BUT, instead of printing email address, if the message is pgp signed,
report the signature instead.  Under this program, the fact that an
anonymous remailer was used is somewhat transparent since you would
see who signed the document sent through a remailer.  This would allow
somebody to build up a positive reputation attached to a pgp signature
(which could be fairly anonymous) and possibly help guide anonymous
mail kill file users.
Naturally, it would be best if it were easy to respond to an anonymous
mail, if this were incorporated into mail programs, etc. but I have
two problems: time constraints, and disk quota (I can't lay out the
source code for elm, pgp, whatever else).
I'm to the point where the script I include below does what I want
expect check for digital signatures on letters.  Since there isn't a
pgp library (yet), the next step will be difficult since I'd rather
not pipe the message through pgp just to get the signature, although
for testing I'll implement something in the next few weeks.
Here is the script: if anybody has input, speak up!  I named it scan
after the mh command it is a poor imitation of.
Usage: 'scan foldername returns a formatted list of mail in the folder
Ug, I see an improvement I will make tonight: using getenv() to get my
home directory instead of plugging it in directly:

@_date: 1993-09-23 12:17:20
@_author: Karl Lui Barrus 
@_subject: MAIL: positive reputations 
Earlier, I mentioned my stab at a positive reputation scheme for
anonymous mail.  I made some changes to the script I posted earlier
(which I discovered was truncated because of a lone period on a line -
PERL's marker for ending a format specifier).
The script sifts through an elm folder, reporting message number,
email address of author, and subject.  When a pgp signed message is
found, it sends the message through pgp, extracting the signature and
reports that instead.  (At the moment I'm not sure what happens if the
public key needed to verify the signature isn't on your keyring, or if
a signature is bad).
Positive reputations, digital postage, and easier methods for replying
are a solution for the "how to mark anonymous mail" question which
crops up from time to time.  That is, you don't mark anonymous mail -
instead, in the future, mail readers will be capable of getting the
digital signature from a mail message and reporting it, of replying to
anonymous mail, etc.
I mean, who wrote the message is what you are really interested in,
now so much how it got to you (via anonymous remailing chains, etc.).
Positive reputations and digital postage are more appealing to me
because I'm a "purist" - I'm more interested in "pulling it off"
(anonymous mail) than in other concerns.  Marking anonymous mail with
certain subject headers and so forth is an unacceptable solution to
Now, there isn't a requirement that the signature on the message be
for a "real" person - a good positive reputation system would allow a
person to adopt a pseudonym (ala Demosthenes and Locke in Card's
_Ender's Game_) and speak via that pseudonym.  When you read your mail
and you note messages are from "Demosthenes" and you agree with the
opinions expressed, you will mentally note that Demosthenes is
intelligent, and be willing to read further message.  On the other
hand, if you feel Locke is an idiot, you will skip messages, or set
your advanced email filters to reject the messages.
I thought about a possible real life example, and this came to mind:
suppose David Sternlight, heartened by a legal PGP, decided he was
going to blow off USENET and instead participate here, on cypherpunks.
He knows that for many, merely seeing the email address
"strnlght will cause a variety of reactions :-).  So he
could form a pseudonym for himself and participate, allowing himself
to start afresh.
Following is the script.  It is inefficient (the while loop that
drives the thing needs massive reworking, pgp is called to get a
signature from a document) but eventually these will be fixed (I'll
rewrite the loop, a pgp library will be made available).  Plus, as I
said above, I'm not sure what happens with bad signatures or missing
public keys.  Also, to prevent some mailer from truncating this post,
I'll move the formatting period over by a space - this will cause a
"format not terminated" error if you try to run this script without
moving the period back!
Here's how I use it: scan cypher
where cypher is an elm mail folder.  I get back a report that looks
like this:
   1  collins   blank lines v. the remailer
   2* Karl L. Barrus 8--------------------
 email address and subject of messages in an elm folder
 sometimes reports name and not email address - not that I
#  guarantee this works in all cases
 the message is pgp signed, report signature instead of address
 version of mh scan command
 L. Barrus chdir "$dir/Mail" || die "Can't cd to ~/Mail\n";
while ( {
  $file = shift   if (-T $file) {
    if (-z $file) {  length folders with no messages
      print "Folder $file has no messages\n";
    }
    elsif (!open(FOLDER, "./$file")) {
      print STDERR "Can't open $file\n";
    }
    else {
      $state = 1;           for a new message
      $num = 0;
      while () {  whole loop need massive reworking!!!
        if ($state == 1) {  a new message
          $num++;                    $from = "";
          $subject = "";
          $sig = "";
          $state = 2;       for From: and Subject:
        }
        if ($state == 2) {  found a message; looking for headers
          /^Subject: (.*)/ && ($subject = $1);     subject
          /^From: (.+)/ && ($from = $1);           "From: add"
          /^From: (.+) ((.+))/ && ($from = $2);    "From: name (add)"
          /^From: (.+) \((.+)\)/ && ($from = $1);  "From: add (name")
          if ($from ne "" && $subject ne "") {  both headers
            $state = 3;  for possible pgp signed message
          }
        }
        if ($state == 3) {  a message, found headers, look for pgp
          if (/^-----BEGIN PGP SIGNED MESSAGE-----$/) {
            $sig = "*";
            $temp = "./.tmp_" . $num . "_" . $$;
            $tempsig = "./.tmp_sig_" . $num . "_" . $$;
            open (OUT1, "> $temp");
            $state = 4;  out pgp signed message to a file
          }
        }
        if ($state == 4) {  pgp signed message to a file
          print OUT1 $_;
          if (/^-----END PGP SIGNATURE-----$/) {
            close (OUT1);
            system ("$dir/bin/pgp -f < ./$temp 1>/dev/null 2>$tempsig");
            open (PGPOUT, $tempsig);
            while () {
              /^Good signature from user "(.+)"\.$/ && ($from = $1);
            }
            close (PGPOUT);
            unlink $temp, $tempsig;
          }
        }
        if ($state >= 3 && /^From[^:]/) {
          $state = 1;  back to looking for a new message
          write;
        }                }
    }
  }
  elsif (-d $file) {
    print STDERR "$file is a directory\n";
  }
format STDOUT =
@ $num, $sig, $from, $subject
 .

@_date: 1993-09-30 19:52:37
@_author: Karl Lui Barrus 
@_subject: REMAIL: digicash II 
Heh, my math is slightly off: the chances of a duplication are
actually 1/(62^60) since valid characters are [a-zA-Z0-9], and each
cash string is of length 61, 60 characters taken randomly from the set
of valid characters, and an initial 'B' (since all the cash issued
from elee7h5 starts with an 'A').  On the other hand, I'm not
using a cryptographically strong random number generator (I'm waiting
for the soon to be released PGP library :-)
Remailing seems to a bit slower, probably because the perl hacks I
added slurp the entire file of valid strings, check payment, and
rewrite the file, minus valid payment.  Also, the more enterprising and devious among you :-) will soon note
that the remailer elee6ue passes along the subject line even
when payment fails.  Thus, if you collapse your entire message into
the subject, you can still get a message through.  I will fix this
problem soon!

@_date: 1993-09-30 22:37:30
@_author: Karl Lui Barrus 
@_subject: FIDO, steganography, PGP 
I've had fun writing this!
This is a PERL script that takes as input a PGP encrypted, ascii
output file.  It skips the headers and stuff, and converts every
character in the body into a geographic name.  I don't think I'll have
a chance to write the reverse script tonight, but it will coming along
So maybe this can be used to mail other people lists of geographic
names rather than encrypted messages since I've heard some networks
frown upon encrypted mail :-)
Generate your PGP file, and invoke the script like this:
pgpsteg < encrypted_file_ascii_output > steg.out
and steg.out will contain a list of places derived from your input

@_date: 1993-10-01 15:53:40
@_author: Karl Lui Barrus 
@_subject: FIDO, encryption 
Here is the companion script to the other one I posted. It takes the
output of the previous script (which takes PGP encrypted ascii to a
list of geopraphic name), and turns it back into a PGP file.
Not really stegonography since it's really just a substitution cipher.
But, with a more sophisticated output grammar, you could embed your
encrypted file in a bizarre vacation itinerary :-)
pgphide < file.asc | mail -s "not encryped at all" user
and then
pgpuhide < mail_file_from_sneaky_person > pgpfile.asc
will allow your friend decrypt pgpfile.asc.

@_date: 1993-10-03 19:04:34
@_author: Karl Lui Barrus 
@_subject: Re: Single Value Pseudonyms 
What?  It doesn't work?  Care to elaborate?
I mean, a person can satisfy to any degree desired that the last
unblinded document is of a particular value.
I agree that it becomes real expensive to do so, and for digital
banking purposes, there are several alternatives: 1) all cash is of
same denomination, 2) different exponents for different
denominations, 3) different keys for different denominations.
I think I mentioned the application towards digital cash is a bit
forced because of the above.  The real point is in avoiding signing
a blinded document that is later unblinded to reveal something
undesirable, in which case the signature and the document signed
have value.  The application of cut-and-choose I described applies
best when for some reason (poor choices of the bank?) the document
itself contains value, like the denomination it represents.

@_date: 1993-10-03 20:54:34
@_author: Karl Lui Barrus 
@_subject: Re: ECPA and Remailers? 
Sure, but there is also a copy of posted remailer policies at the
gopher site, in a directory under "Anonymous Mail".  Except for Christian Odhner's since I haven't extracted it out of the
message it was in yet :-)

@_date: 1993-10-05 20:39:11
@_author: Karl Lui Barrus 
@_subject: Re: Crypto Idea; Multi-Part Sigs 
An excellent paper (author and title have slipped my mind - the paper
describes key-and, key-or, and other operations) describes how to do
something related to part 2 of the above.
In that scheme, you would have the three key pairs for the
individuals, Pa, Sa, Pb, Sb, Pc, Sc, and the "joint" keypair Pj, Sj.  A message encrypted with Pj can only be unlocked with Sj, which in
turn is encrypted with Pa, Pb, Pc.  Thus, the final message looks like
E(M, Pj); E(Sj, Pa); E(Sj, Pb); E(Sj, Pc)
where the four parts are passed around as one, and E(a,b) means a
encrypted with b.  Thus, each of the individuals, knowing their own
private keys, can extract Sj, and then the message M.
Offhand, I'm not sure if the paper describes joint signings in this

@_date: 1993-10-05 22:05:18
@_author: Karl Lui Barrus 
@_subject: Re: Chaum on the wrong foot? 
The other paper at CWI "Single Term Off-Line Coins" (which I have read
but haven't really studied in depth) isn't an observer based protocol.
Ferguson represents cash as 3 numbers.  When Alice wants to spend, she
gets two RSA-signatures from the bank (which are derived from the hash
functions and the 3 numbers).  Alice pays by sending the 3 numbers to
the store, which replies with a challenge, which she responds to using
information derived from both signatures.  She can spend several coins
by using the same challenge and sending the product of her responses
to the store.  At the end of the day, the bank sends the 3 numbers,
the challenge and response to the bank, which then verifies the
If Alice spends a coin twice, she allows the bank to determine her
identity.  (The bank must make sure the penalty is severe enough to
discourage this behavior).  One nice feature is that it is very
difficult (infeasible) for the bank to frame Alice and claim she
double spended.
It seems from this paper, and I think one other I read, that offline
protocols presented cannot prevent double spending but rather reveal
the identity of such a person.
Karl L. Barrus: klbarrus         keyID: 5AD633 hash: D1 59 9D 48 72 E9 19 D5  3D F3 93 7E 81 B5 CC 32 "One man's mnemonic is another man's cryptography"   - my compilers prof discussing file naming in public directories

@_date: 1993-10-05 22:20:09
@_author: Karl Lui Barrus 
@_subject: Re: Crypto Idea, Multi-Party Sigs 
Forcing all three people for signing the document can be done as
by merely splitting the secret key into three parts.  Then, all three
must be used to reassemble secret key in order to sign the document.
If both methods co-exist, then each individual can sign the document
from information they know from being able to decrypt.
Unless you go to a modified RSA system like Eric described.
(it's much easier to force all three to sign and all three to decrypt

@_date: 1993-10-05 22:50:08
@_author: Karl Lui Barrus 
@_subject: Re: Standard Headers for Anonymous Remailers 
Hey Doug,
Well, as I mentioned in an earlier post, I'm one who doesn't favor
labelling anonymous mail - I'd rather work on positive reputation
schemes, cash accepting remailers, etc.  An anonymous remailer that
charges will discourage people from using it for frivolous purposes;
digital signature combined with positive filters will let people
filter out posters they consider stupid.
After all, you are more interested in who sent the mail than where it
originated from.
(I've been working on a script that checks elm mail folders for pgp
signed messages and reports the signature instead of From: address;
and a cash accepting remailer).
The attitude expressed by the individual on io.com shows a problem we
will have in educating others - "anonymous posts CAN destroy a civil
conversation".  Yes, maybe so, but in my experience on mailing lists,
bbses, etc. I've noticed that "flame wars" and "anonymous posts" have
NO correlation, and are quite independent of one another.  Since I've seen "flame wars" on systems with absolutely no anonymous
posting facilities (or none that were used), I conclude that civil
conversation is destroyed by strongly held differences in opinions (or
some other factor I can't pin down).
However, I would be interested in hearing if filtering anonymous
mail/posts does significantly cut down on or eliminate the destruction
of civil conversation.

@_date: 1993-10-07 12:05:42
@_author: Karl Lui Barrus 
@_subject: Weak RSA keys? 
I don't mean to flame you, but before you rush off and publish your
results somewhere you may want to step back and check over your premise
and the steps it involves a few times.
Now how exactly do you calculate this "F"?  Does it involve, say,
knowing phi(n), information ONLY available to you if you happen to
know the factorization of n?  In which case the whole thing collapses
How can you use this information to decrypt a message?  If I were to
give you the 200 digit product of two primes, could you find the
"spare" key?  If I get some time I'd like to look over your method to see if it's
really there or an artifact of the numbers you chose.  There is a
"weakness" easily shown in RSA in that for some keys, up to 9 messages
encrypt to themselves!  That is, M^e = M mod n.  Now, if you pick
large primes, these 9 messages will get lost in the 100 trillion
numbers every atom in the universe can have allocated, so it really
isn't a problem.

@_date: 1993-10-07 12:59:20
@_author: Karl Lui Barrus 
@_subject: Weak RSA keys? 
Yes, it does look like there are two possible decryption exponents,
but one is derived from the other and information only known to the
person who can factor n, so it isn't clear to me how this is a big
weakness.  If you pick good factors of n and the primes are large, the
problem is just as infeasible as it was before, and you get ONLY two
decryption exponents.
In fact, if you look on page 92 of "Cryptography; An Introduction to
Data Security" by Seberry and Pieprzyk, you will see that they make it
more explicit than some other texts: they give this as the formula
relating then encryption and decryption exponents:
So they use the least common multiple of p-1 and q-1.
With good choices of p and q, there will be 2 decryption exponents: d
and (d + phi(n)/gamma(n)).  If you have more than 2 decryption
exponents, you have made poor choices of primes.
Again, to calculate the "spare" key you nee need to know how n factors,
which makes the whole thing moot.
Example with better choices for p and q:
p = 107; q = 167; n = 17869
phi(n) = 106 * 166 = 17596
e = 43
d = 43^-1 mod 17596 = 7775
71^43 mod 17869 = 10073 (the encrypted message)
to decrypt: 10073^7775 mod 17869 = 71.
If you use e d = 1 mod gamma(n) you get
d = 43^-1 mod 8798 = 7775, which is the same d you got above.  Thus,
the spare key is 7775 + 8798 = 16573, which does work as a decryption
exponent.

@_date: 1993-10-07 13:25:32
@_author: Karl Lui Barrus 
@_subject: Re: Weak RSA keys, 2nd post 
(sorry for posting this twice, but as I sent the previous message, line
noise or something overtook me)
It does appear that there can be multiple decryption keys, but with good
choices of p and q, there will be only two.
Whether or not "ed = 1 mod phi(n)" is a myth or not... depends.  Look at
"Cryptography: an Intoduction to Computer Security" by Seberry and
Pieprzyk.  On page 92, equation 3.9 gives the relation between encryption
and decryption keys as "ed = 1 mod gamma(n)" where gamma(n) = lcm(p-1,q-1).
Which is what the "F" function described before is.
With proper choices of p and q, the d calulcated by the first forumla and
the d calculated by the second will be the same.
Of course, since you must know how to factor n to calculate the "spare" key,
it isn't clear to me how it will help you decrypt a message.  With large
enough properly chosen primes, it won't matter.  Solution: pick good primes.
An example with better choices for p and q:
p = 107; q = 167; n = pq = 17869
phi(n) = (p-1)(q-1) = 17596
e = 43
Method 1: d = 43^-1 mod 17596 = 7775
Method 2: lcm(p-1, q-1) = 8798                d = 43^-1 mod 8798 = 7775 Either method: message M = 71
               encrypted M' = 71^43 mod 17869 = 10073
               decrypt = 10073^7775 mod 17869 = 71
The "spare" key is 7775 + 8798 = 16573, which does indeed work.
But again, I don't see how an attacker can use info about the existence of
a second key.
Karl L. Barrus

@_date: 1993-10-07 13:35:32
@_author: Karl Lui Barrus 
@_subject: Re: Standard Headers for Anonymous Remailers 
Yes, but it's more than just the privacy systems that need good
designs; applications like mailers could benefit from (say) digitally
signing every message and reporting the signature on a document rather
than where it came from.
At the risk of sounding like a broken record, I will quote some
private email I sent to another indiviual concerned with these things
(hopefully eveybody else who is going to post in about needing to
minimize abuses and stuff will read this and find out such things are
being worked on!)

@_date: 1993-10-11 14:59:50
@_author: Karl Lui Barrus 
@_subject: Re: Breaking DES 
Encrypting with k1 and then k2 leaves you open to the "meet in the
middle" attack.
Say I get a copy of the plaintext and ciphertext.  I could encrypt the
plaintext with 2^56 keys, and decrypt the ciphertext with 2^56 keys.
Then by matching results of the above steps, I could figure out k1 and
The work for this attack is 2^56 + 2^56 = 2^57, which suggests that
double encryption doesn't increase the complexity of breaking your
text very much.  It only increases it from 2^56 to 2^(56+1).  So if
you use the same k1 and k2 for all your documents and it is worth my
time and money to figure out k1 and k2, favoring double encryption
over single encryption doesn't make much sense.
Otherwise, there was fear that DES was a group (encrypting with k1 and
k2 is equivalent to encrypting once with k3), but I think this got
buried (?) recently.
Also, with the triple encrypt-decrypt-encrypt, if you pick the same
key for each step, it is equivalent to just single encryption.  Which
may be of importance in compatibility issues, etc.

@_date: 1993-10-12 17:56:53
@_author: Karl Lui Barrus 
@_subject: Re: Breaking DES 
Maybe I'm being overly sensitive, but lately some of my posts are
getting attacked for being wrong or impractical.
I did not invent the cut-and-choose protocol (previously described as
incorrect), nor did I invent the "meet in the middle" attack outlined
in a previous post which Perry has so eloquently described above as
I am just passing along information about an attack against double DES
which demonstrates that double DEs encryption does not increase
complexity very much at all.
"I" do not care what "people" think of "this" attack, since it is
valid and I didn't invent it.
So maybe it's only of theoretical interest, sort of like differential
cryptanalysis against the DES - which requires 10^47 chosen
Why don't you mail Biham and Shamir that their method sucks.  It's
fairly infeasible as well.
I think I need a long vacation from this list.  Naturally, I'm not so
egotistical to think anybody gives a damn.

@_date: 1993-10-13 20:19:59
@_author: Karl Lui Barrus 
@_subject: DES: breaking, attacking 
On the method Douglad Holland posted about breaking the DES... an
interesting property of DES is that of complimentation.  That is, if
encryption of plaintext P under key K produces ciphertext T, then
encryption of plaintext P' under key K' produces ciphertext T', where
the primes (') mean bitwise complement.
If:       T  = DES(P ,K)
then      T' = DES(P', K')
Cryptanalysis can exploit this if two pairs are available such that T' = T or P' = P.
What this boils down to is a 50% reduction in work.  So now instead of
taking 10 billion years it'll just take you 5 billion :-) Complexity
wise, it's just 2^55 steps instead of 2^56, so it may not buy you too
A more interesting attack I read of is a probabilistic attack against
DES.  Suppose you encrypt sensitive data, and change keys once a
month.  I can attack you by trying as many decryptions as possible
within the month.  Sure, I am not guarenteed success, but the point is
that if I do this month after month, I have a decent chance of success
at some point during the year.  And if the information you encrypt is
valuable, once success during the year is all I'll need.
An upcoming book on cryptanalysis details this attack; the author
calculates success rates given various estimates for hardware (speed
and number) and frequency of key shifting.  It is quite arresting:
even if you change keys every week, if I can muster enough computer
power to give me a 1% chance of success, the chances are "good" that
at some time during the year I'll succeed in decrypting a message.
For example, if I can be guarenteed of breaking your DES encrypted
message in a year (say I can mount a brute force attack that does 2^56
encryptions and takes a year), there is an 8% chance the key will be
recovered in one month.  So even if you change your key every month, I
have an 8% chance of success.  If your key is needed to conduct
financial transactions and you are a bank, I can profit greatly from
one success.
So basically, DES is looking more and more disadvantaged with its
relatively small key size (64 bits, of which 8 are predictable parity
Karl Barrus

@_date: 1993-10-16 16:12:19
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
By expanding the equation above (the top one), I got this:
y = 1/8*x^4 + 1/4*x^3 + (3/8 + c/2)*x^2 + (1/4 + c/2)*x + (1/2*c + 1/2*c^2 + d)
and by matching powers, got the following equations:
c/2 + 3/8 = 63.875
1/2*c^2 + 1/2*c + d = 8159
These equations are easily solved for c = 127, d = 31.  From there, I
can compute the required inverse equations, and so on.
I'm not too sure about the security of this method; it seems it
boils down to solving simultaneous equations, which yield the constant
terms.  And you even know how many nested equations there are from the
power of the leading term.
But, as a test, post a harder one (maybe four or more nestings) and
see if I can get it!

@_date: 1993-10-17 14:00:44
@_author: Karl Lui Barrus 
@_subject: Re: Crypto Technique 
I think that the proposed one-way function is too easy to invert.  To decrypt a message requires producing the inverses for each
function, which in turn requires knowing the constants (c1, c2, ...).
But these constants can be easily obtained from expanding the general
form of the equation and setting coefficients equal to one another.
The resulting equations are in an easy to solve form (I think it's
called upper triagonal form in linear algebra (?)).  As it turns out,
only a fraction of the simultaneous equations generated are needed to
solve for the constants.
For instance, at the end of this message is the polynomial obtained
from the following nested equations:
a = 1/2 x^2 + 1/2 x + c1
b = 1/2 a^2 + 1/2 a + c2
c = 1/2 b^2 + 1/2 b + c3
d = 1/2 c^2 + 1/2 c + c4
d is then the resulting 16th degree polynomial at the end of this
[By the way, I used Mathematica to do this - the Expand[] function.]
The reason the resulting simultaneous equations can be solved so
easily is they are in a form convenient for back-substitution:
The coefficient for x^14 is (9/8192 + c1/2048)
                    x^12 is (139/16384 + c1 7/512 + 7/2048 c1^2 + c2/1024)
                    etc.
The first equation immediately yields c1; this in the next yields c2,
So the various constants can be obtained with no trouble.
Here is the polynomial d:
c1/8 + (7*c1^2)/32 + (7*c1^3)/32 + (25*c1^4)/128 + c1^5/8 + (5*c1^6)/64 +   c1^7/32 + c1^8/128 + c2/4 + (3*c1*c2)/8 + (9*c1^2*c2)/16 + (7*c1^3*c2)/16 +   (3*c1^4*c2)/8 + (3*c1^5*c2)/16 + (c1^6*c2)/16 + (3*c2^2)/8 +   (3*c1*c2^2)/8 + (9*c1^2*c2^2)/16 + (3*c1^3*c2^2)/8 + (3*c1^4*c2^2)/16 +   c2^3/4 + (c1*c2^3)/4 + (c1^2*c2^3)/4 + c2^4/8 + c3/2 + (c1*c3)/4 +   (3*c1^2*c3)/8 + (c1^3*c3)/4 + (c1^4*c3)/8 + (c2*c3)/2 + (c1*c2*c3)/2 +   (c1^2*c2*c3)/2 + (c2^2*c3)/2 + c3^2/2 + c4 + x/16 + (7*c1*x)/32 +   (21*c1^2*x)/64 + (25*c1^3*x)/64 + (5*c1^4*x)/16 + (15*c1^5*x)/64 +   (7*c1^6*x)/64 + (c1^7*x)/32 + (3*c2*x)/16 + (9*c1*c2*x)/16 +   (21*c1^2*c2*x)/32 + (3*c1^3*c2*x)/4 + (15*c1^4*c2*x)/32 +   (3*c1^5*c2*x)/16 + (3*c2^2*x)/16 + (9*c1*c2^2*x)/16 + (9*c1^2*c2^2*x)/16 +   (3*c1^3*c2^2*x)/8 + (c2^3*x)/8 + (c1*c2^3*x)/4 + (c3*x)/8 + (3*c1*c3*x)/8 +   (3*c1^2*c3*x)/8 + (c1^3*c3*x)/4 + (c2*c3*x)/4 + (c1*c2*c3*x)/2 +   (15*x^2)/128 + (49*c1*x^2)/128 + (159*c1^2*x^2)/256 + (45*c1^3*x^2)/64 +   (155*c1^4*x^2)/256 + (51*c1^5*x^2)/128 + (21*c1^6*x^2)/128 +   (c1^7*x^2)/32 + (21*c2*x^2)/64 + (57*c1*c2*x^2)/64 + (39*c1^2*c2*x^2)/32 +   (39*c1^3*c2*x^2)/32 + (45*c1^4*c2*x^2)/64 + (3*c1^5*c2*x^2)/16 +   (21*c2^2*x^2)/64 + (27*c1*c2^2*x^2)/32 + (27*c1^2*c2^2*x^2)/32 +   (3*c1^3*c2^2*x^2)/8 + (3*c2^3*x^2)/16 + (c1*c2^3*x^2)/4 + (7*c3*x^2)/32 +   (9*c1*c3*x^2)/16 + (9*c1^2*c3*x^2)/16 + (c1^3*c3*x^2)/4 + (3*c2*c3*x^2)/8 +   (c1*c2*c3*x^2)/2 + (35*x^3)/256 + (109*c1*x^3)/256 + (95*c1^2*x^3)/128 +   (105*c1^3*x^3)/128 + (185*c1^4*x^3)/256 + (49*c1^5*x^3)/128 +   (7*c1^6*x^3)/64 + (43*c2*x^3)/128 + (27*c1*c2*x^3)/32 +   (87*c1^2*c2*x^3)/64 + (35*c1^3*c2*x^3)/32 + (15*c1^4*c2*x^3)/32 +   (21*c2^2*x^3)/64 + (21*c1*c2^2*x^3)/32 + (9*c1^2*c2^2*x^3)/16 +   (c2^3*x^3)/8 + (7*c3*x^3)/32 + (7*c1*c3*x^3)/16 + (3*c1^2*c3*x^3)/8 +   (c2*c3*x^3)/4 + (305*x^4)/2048 + (127*c1*x^4)/256 + (855*c1^2*x^4)/1024 +   (495*c1^3*x^4)/512 + (755*c1^4*x^4)/1024 + (21*c1^5*x^4)/64 +   (7*c1^6*x^4)/128 + (21*c2*x^4)/64 + (243*c1*c2*x^4)/256 +   (339*c1^2*c2*x^4)/256 + (15*c1^3*c2*x^4)/16 + (15*c1^4*c2*x^4)/64 +   (75*c2^2*x^4)/256 + (9*c1*c2^2*x^4)/16 + (9*c1^2*c2^2*x^4)/32 +   (c2^3*x^4)/16 + (25*c3*x^4)/128 + (3*c1*c3*x^4)/8 + (3*c1^2*c3*x^4)/16 +   (c2*c3*x^4)/8 + (69*x^5)/512 + (475*c1*x^5)/1024 + (801*c1^2*x^5)/1024 +   (447*c1^3*x^5)/512 + (35*c1^4*x^5)/64 + (21*c1^5*x^5)/128 +   (135*c2*x^5)/512 + (207*c1*c2*x^5)/256 + (15*c1^2*c2*x^5)/16 +   (15*c1^3*c2*x^5)/32 + (3*c2^2*x^5)/16 + (9*c1*c2^2*x^5)/32 + (c3*x^5)/8 +   (3*c1*c3*x^5)/16 + (497*x^6)/4096 + (837*c1*x^6)/2048 +   (1437*c1^2*x^6)/2048 + (345*c1^3*x^6)/512 + (175*c1^4*x^6)/512 +   (7*c1^5*x^6)/128 + (231*c2*x^6)/1024 + (153*c1*c2*x^6)/256 +   (75*c1^2*c2*x^6)/128 + (5*c1^3*c2*x^6)/32 + (15*c2^2*x^6)/128 +   (3*c1*c2^2*x^6)/32 + (5*c3*x^6)/64 + (c1*c3*x^6)/16 + (391*x^7)/4096 +   (663*c1*x^7)/2048 + (531*c1^2*x^7)/1024 + (105*c1^3*x^7)/256 +   (35*c1^4*x^7)/256 + (81*c2*x^7)/512 + (45*c1*c2*x^7)/128 +   (15*c1^2*c2*x^7)/64 + (3*c2^2*x^7)/64 + (c3*x^7)/32 + (2337*x^8)/32768 +   (123*c1*x^8)/512 + (675*c1^2*x^8)/2048 + (105*c1^3*x^8)/512 +   (35*c1^4*x^8)/1024 + (99*c2*x^8)/1024 + (45*c1*c2*x^8)/256 +   (15*c1^2*c2*x^8)/256 + (3*c2^2*x^8)/256 + (c3*x^8)/128 + (101*x^9)/2048 +   (311*c1*x^9)/2048 + (175*c1^2*x^9)/1024 + (35*c1^3*x^9)/512 +   (25*c2*x^9)/512 + (15*c1*c2*x^9)/256 + (259*x^10)/8192 +   (85*c1*x^10)/1024 + (147*c1^2*x^10)/2048 + (7*c1^3*x^10)/512 +   (21*c2*x^10)/1024 + (3*c1*c2*x^10)/256 + (9*x^11)/512 + (77*c1*x^11)/2048 +   (21*c1^2*x^11)/1024 + (3*c2*x^11)/512 + (139*x^12)/16384 +   (7*c1*x^12)/512 + (7*c1^2*x^12)/2048 + (c2*x^12)/1024 + (7*x^13)/2048 +   (7*c1*x^13)/2048 + (9*x^14)/8192 + (c1*x^14)/2048 + x^15/4096 + x^16/32768

@_date: 1993-10-17 22:42:07
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
I still don't know about that - I think all it does is remove the
problem one step from immediately solvable.
Is that P term public knowledge (here P = 256)?  If so, the revised
equations are:
c1/2 + 1/4 = 63.75   ===> c1 = 127
c1/2 + 1/4 x1^2 + c2 = 223 + 256k  ===> c2 = -7905 + 256k
And this will yeild either c2 = -225 or c2 = 31.  The computational
expense of trying both is small.
If it does turn out that the magnitude of the constants must be less
than P, I don't think taking the mod of each coefficient obscures the
problem very much at all.  It still boils down to solving systems
of simultaneous equations, which isn't the same complexity as solving
discrete logarithms or factoring.

@_date: 1993-10-18 08:37:15
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
I've been thinking about this (well, not too much since I'm in the
midst of midterms week :-).
I beleive the equation leaks information.  When you expand the
equation symbolically, it is easy to solve for the constants by
matching the coefficients of the highest powers and working backwards.
If the constants can be negative as well as positive, the signs of
some of the terms will reflect this.
We know the magnitude of the constants must be less than P, which is
public.  But can they be negative - will the decoding process still
work?  Or, will you obtain the correct decoding for the correct choice
and an incorrect decoding for the incorrect choice?  If it turns out
that either choice will decode a number to the same value, or if the
decoding won't work with negative numbers, then this method is too
easy to invert.
If the constants can't be negative, or if they can be but it doesn't
make a difference in the decoding, then taking the modulus doesn't
obscure anything at all.
For example, suppose c = 127 and d = -225.  Then
y1 = 7903. + 63.75 x + 63.875 x  + 0.25 x  + 0.125 x
which becomes (after mod 256)
y1 = 223. + 63.75 x + 63.875 x  + 0.25 x  + 0.125 x
However, if c = 127, d = 31, then
y2 = 8159. + 63.75 x + 63.875 x  + 0.25 x  + 0.125 x
which becomes (after mod 256)
y2 = 223. + 63.75 x + 63.875 x  + 0.25 x  + 0.125 x
So y1 = y2.  Here, d = -225 and d = 31 yeild the same equation (after
mod operation).  Now I need to try the decoding process to see if d = -225 or d = 31
yeild the same or different answers.

@_date: 1993-10-20 10:32:34
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
Sure, I'll give it a whirl as soon as my exams are over.
Offhand, it looks like you get five equations in six unknowns, which
is under-specified.  So possibly one parameter can take on any value
(or maybe any odd value), and the rest are then solved in terms of the
fixed variable.  The variable paramter can only take on values less
than P (maybe only odd values under P), the number of unknows is then
2*(nestings) - 1; everything still looks linear.
However, I haven't actually tried yet, so we'll see!
This isn't meant as a flame (in fact, this method is very
interesting), but you've posted two or three methods and declared them
all impossible to break.  Are you yourself trying to break these
schemes?  The very first method posted would have fallen under
Also, mail any additional info to me directly; I'm behind on list

@_date: 1993-10-20 14:32:48
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
One question before I work on this more at a later date.
Can you still decode properly if you take the modulus of each
coefficient?  I ask since if you can't, the modulus makes is harder to
find the constants, but as a side effect it also destroys the message.
Say I use
f = 29/2 x + 40
g = 135/2 f^2 + 135/2 f + 75
I get g = 110775 + 317155/4 x + 113535/8 x^2
This is easy to solve, so Matt takes the modulus of each coefficient
(some power of 2, I pick 32 here to keep it simple).
results in g' = 23 + 99/4 x + 127/8 x^2
Say I encode my message x = 5
g(5) = 6895725/8 mod 32 = 109/8
g'(5) = 4349/8 mod 32 = 253/8
Notice that these two results aren't equal at all!  Am I misunderstanding the encoding (and decoding) process?  Aren't
these two results supposed to be equal?  I'm not getting the expected
result when each coefficient is reduced mod 32.

@_date: 1993-10-20 14:42:50
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique - error 
I made a math error reducing one of the terms.
g and g' do yield the same answer.
Whew, I thought something was messed up :-)

@_date: 1993-10-20 16:07:52
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
I couldn't resist trying to find A, B, C, D, E, F.
You may be on to something, Matt.  The equations are underspecified,
and have many solutions - here are some I generated (any of them
match what you picked? :-)
Maybe you could look at what these alternate solutions are - it could
turn out that the mod operation creates extra valid solutions, which
would be quite undesirable.  But then, without the mod, the equation
may be too easy to pick apart.
Or maybe there is some other attack I haven't thought of or don't know

@_date: 1993-10-20 16:57:49
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
I think the modulus operation destroys uniqueness.
I don't have a proof, but after working symbolically for a while, I
tried an example:
f = a x + b
g = c f^2 + c f + d
where I picked a = 11/2, b = 8, c = 25/2, d = 3.  I also pick P = 16
to keep it small.
So g = 903 + 4675/4 x + 3025/8 x^2 mod 16
and if I reduce each coefficient mod 16, I get
  g' = 7 + 3/4 x + 81/8 x^2 mod 16
Great so far.  (And I checked to see that g and g' are equal).  So
let's look at all possible messages and their encryption:
x       g'(x)	x       g'(x)
- -       -----	-       -----
1	15/8	9	15/8
2	1	10	3
3	35/8	11	67/8
4	12	12	2
5	63/8	13	127/8
6	8	14	2
7	99/8	15	67/8
8	5	16	3
There is a serious problem in the above: the messages 10 and 16
encrypt to the same ciphertext; 11 and 15 also; and 12 and 14.  The
ciphertext 3 decodes to 10 or 16, 67/8 decodes to 11 or 15, 2 decodes
to 12 or 14.  That's 6 out of 16 messages, a sizeable 37.5%.
This behavior may have uses in fair coin flipping or some sort of
oblivious transfer (I am not claiming this in the general case, just
in the example above!), but not as encryption.
Besides, the fact that even messages encrypt to integers and odd
messages encrypt to fractions probably isn't good.
So Matt, with the numbers you used to generate the challenge problem,
see if any messages encrypt to the same ciphertext, just as a check.

@_date: 1993-10-20 17:42:39
@_author: Karl Lui Barrus 
@_subject: Re: crypto technique 
Another possible problem with the technique is that the multiple
solutions are all valid.
For example, with two nestings and a = 11/2, b = 8, c = 25/2, d = 3, P = 16
I obtain g = 903 + 4675/4 x + 3025/8 x^2 mod 16
         g' = 7 + 3/4 x + 81/8 x^2 mod 16
where the g' is obtained from g by reducing the coefficients mod 16.
Solving the resulting equations yields two solutions:
a = 11/2, b = 8, c = 25/2, d = 3 (what I chose)
a = 31/2, b = 6, c = 17/2, d = 2
Plugging in the second solution:
         h = 359 + 6851/4 x + 16337/8 x^2 mod 16
         h' = 7 + 3/4 x + 81/8 x^2 mod 16
Notice that h' equals g'!
So the other solution can be used to form the same polynomial (which
we already saw doesn't encrypt uniquely).
Can this other solution be used for decryption as well?  I'd check but
I've REALLY got to go study now :-)

@_date: 1993-10-21 10:27:56
@_author: Karl Lui Barrus 
@_subject: MATH: factoring, # of bits 
I think the fastest method that anyone admits to, by Odzyklo
(spelling?), has an order of magnitude defined by:
e^(sqrt(ln(x) ln(ln(x))))
I've been dusting off my Mathematica skills working on the crypto
techniques Matt posts :-) so it looks like this in Mathematica:
f[x_] := N[Exp[Sqrt[Log[x] Log[Log[x]]]]]
x in bits	difficulty
200		2.27 E11
384		5.54 E16	<- PGP casual
512		6.69 E19	<- PGP commercial
664		1.18 E23
1000		1.75 E29
1024		4.42 E29	<- PGP military
1500		8.11 E36
2000		3.11 E43
3000		5.49 E54
4000		2.44 E64
6000		7.06 E80
8000		8.99 E94
I don't know how many seconds until the end of the universe, but I
think you'll be covered using an 8000 bit key :-)

@_date: 1993-10-21 21:58:07
@_author: Karl Lui Barrus 
@_subject: Subliminal Channels 
A while ago I sent a post on subliminal channels - I had a chance to work
a larger example.
A subliminal channel is a communication channel that cannot be read by
those for whom it is not intended.  The problem is sometimes phrased as
a prisoner's dilemma: two prisoners are allowed to communicate with each
other by exchanging messages.  They are able to digitally sign the messages
to protect against spoofing.  However, the warden will not allow the
messages to be encrypted - only plaintext and the digital signature will
be passed.  All parties agree to these conditions and communication
Unknown to the warden, the prisoners are still able to coordinate their
plans by using a subliminal channel to communicate, in full view of the
warden!  Essentially, the prisoners use some piece of shared knowledge to
hide their real communication in the digital signature of an innocuous
message.  The warden sees the innocent message, checks that the signature
is valid, and passes it along.  The prisoner checks the signature to see
if the warden didn't alter the message, and then extracts the real message
from the digital signature.
This topic came up when previously on the list, people were discussing
the fact that encrypted communication over HAM radio is illegal - only
authentication codes may be transmitted.  I mentioned that actually, this
restraint can be sidestepped by embedding encrypted communication a la
subliminal channel style.  YES, I KNOW THIS IS ILLEGAL AND I'M NOT
SUGGESTING ANYBODY DO IT!  I just pointed it out.
What may be more important is that a subliminal channel may lurk in the
digital signature standard (DSS).  In turn, this is important because from
time to time proposals are made concerning national id cards, national
health cards, etc.  If some agency is going to authenticate or otherwise
digitally sign an identification card, they may also embed information
into the signature.  The DSS has been described as "very hospitable to
subliminal channels."  Imagine what records could be kept on you if various
information were embedded in the digital signature of documents you own.
First, a description and example of El Gamal authentication, and then of
the subliminal channel based on El Gamal.
El Gamal authentication:
The sender picks a prime p, primitive element g, and random integer r.
The public information is the triple (K,g,p), where K = g^r mod p
To authenticate a message M, the sender picks another random integer r'
such that gcd(r',p-1) = 1, and computes X = g^r' mod p
Then, the sender solves for Y in the equation M = r X + r' Y mod p-1
The triple (M,X,Y) is the message and the signature - this is what is transmitted to the receiver.  r and r' are kept secret.
The receiver computes
A = K^X X^Y mod p
and accepts the message as authentic if
A = g^M mod p
El Gamal Example:
p = 224737, r = 5135, g = 2
K = 2^5135 mod 224737 = 136800
The triple (136800, 2, 224737) is public.
To send the message M = 12345, the sender picks r' = 89321
gcd(89321,224736) = 1 so r' is ok.  Now compute X = 2^89321 mod 224737
                                                  = 87880
Solve for Y in: 12345 = 5135 87880 + 89321 Y mod 224736
          ==>   18433 = 89321 Y mod 224736
          ==>   Y = 207929
The triple (12345, 87880, 207929) is the message and the signature.
The receiver gets (12345, 87880, 207929) and knows (136800, 2, 224737).
A = 136800^87880 87880^207929 mod 224737 = 160740
g^M mod p = 2^12345 mod 224737 = 160740
These are equal and the message is accepted as authentic.
El Gamal Subliminal Channel:
Now the interesting part is the subliminal channel.  The sender and receiver must share the knowledge of random number r.
To send the subliminal message M, where gcd(M,p) = 1, using a cryptogram
C, the sender calculates X = g^M mod p
and solves for Y in
C = r X + M Y mod p-1
The triple (C,X,Y) is transmitted to the receiver.
The receiver computes A = (g^r)^X X^Y mod p and accepts the message as authentic if A = g^C mod p
To extract the subliminal message, the receiver calculates
M = Y^-1 (C - r X) mod p-1
El Gamal Subliminal Channel Example:
Suppose the sender and receiver share the knowledge r = 5135
The sender wants to send M = 11111 using the innocent message C = 12345.
The sender calculates X = 2^11111 mod 224737 = 20944
and solves for Y in : 12345 = 5135 20944 + 11111 Y mod 224736
               ==>    Y = 194447
The triple sent to the receiver is (12345, 20944, 194447).
The warden can check this if he wants, to very the signature:
A = 136800^20944 20944^194447 mod 224737 = 160740
g^C mod p = 2^12345 mod 224737 = 160740
so the warden verifies the signatures.  Convinced nothing fishy is
going on here, he passes on the message.
The receiver checks authenticity and is successful.  However, now the
subliminal message is extracted:
M = 194447^-1 (12345 - 5135 20944) mod 224736 = 11111
The subliminal message is successfully extraced, and the prisoners have
passed information right by the warden.

@_date: 1993-10-22 15:43:00
@_author: Karl Lui Barrus 
@_subject: ANON: revealing penet id 
this topic seems to come up every few months - just today I was
reading the newest Risks digest and an32153 (or something like that)
was announcing the "risk" of using penet.  I mailed off a submission
describing how to avoid this.  I think people don't know about this
because it isn't published anywhere.  Or is it?
Maybe somebody could help Julf out and offer to write a new help file
that specifically mentions the an/na trick.  Last time I looked at the
penet help file, this wasn't mentioned.
It only takes a bit of work to avoid blowing your id - you just can't
hit 'r' and reply to the addressee; instead you must type in the
address manually (and be sure to type na instead of an  Last
week I responded to some email from a penet user.  I was careful to
respond to na or penet would have allocated me an id for
klbarrus (since I don't have one for this account) and
thus someone would have been able to correlate my penet id and this
account.  As a matter of fact, I think that I revealed the penet id
for an old account of mine (elee9sf this exact way,
although this was before the an/na functionality.

@_date: 1993-10-22 16:03:00
@_author: Karl Lui Barrus 
@_subject: Re: Subliminal Channels 
Someone did write a program which embeds information in a JPEG, but I
don't have any other info (like where to get it, who wrote it, etc.
Actually though, embedding a message in a picture leans toward
Subliminal channels, covert channels, and steganography are related to
one another, and seem to overlap.  I don't have precise definitions
(does anybody else?).  From reading, here is what I think these three
methods are:
Covert channel: you and I agree that if I mail you a letter with the
stamp affixed sideways, that messageA is communicated.  Or, we agree
that a post sent to alt.test with the subject "el mariachi" conveys
messageA.  Or that my running a process and killing before 9:30 p.m.
conveys messageA. Subliminal channel: you and I share a secret and convey our message in
the digital signature of innocent message we pass to one another.
Steganography: I write an innocent message, and I change the spacing
between words, to convey messageA.  Or, I embed the message in the low
order bits of a picture or a sound file.
So, it looks like that in subliminal channels and steganography, the
actual message is passed, while covert channels don't (it's like
winking at a friend - no message but lots of information).
Also, it seems that steganography alters the innocent message itself,
while a subliminal channel doesn't.
Obviously, there is great room for hair-splitting.  These are the
differences as I understand them!  Any other input?

@_date: 1993-10-25 15:59:11
@_author: Karl Lui Barrus 
@_subject: Digital Signatures 
Earlier, L. Detwiler posted a message which listed some desirable properties
of digital signatures.  (I won't comment on the rest of the post since I'm behind in list mail and haven't read up).
Signatures (real and digital) ideally have the following properties, and maybe others:
1) Unforgeable.  The presence of the signature shows the signer attached it on purpose.  Also, the signature should convince another party that the
signer signed the document (i.e. the signature can be linked to somebody
or a pseudonym or whatever satisfies the recipient).
2) Not transferable.  If the signer signs one document, it should be
impossible to transfer the signature to another document.  (Beware
signing random documents - see a previous post on the "Notary Protocol"
or Judith Moore's paper on protocol failures).  In the digital world,
transfering a signature should make it invalid.
3) Can't repudiate.  The signer can't claim he/she did not in fact sign
a document which bears the signature.
4) Can't alter.  A document which is signed can't be altered without
invalidating the signature.  I don't know if a signed contract with white-out, strike-outs, and various inserted edits is still valid, but a good digital signature should contain information (secure cryptographic
hash like md5, md4, snefru, snefru256, etc.) about the text signed.
For instance, PGP and RIPEM signatures contain an md5 hash of the message
text, so altering the document after it's signed will invalidate the

@_date: 1993-10-27 08:17:53
@_author: Karl Lui Barrus 
@_subject: ANON: why pseudonyms 
It's not a dumb questions, and it comes up from time to time.  In
fact, this was the subject of a lengthy war on news.admin.policy a
while ago.
You could use a pseudonym anytime you don't want to be linked to an
opinion.  Maybe you don't want to be known as the author of a post to
alt.sex about whether you shower with your spouse; maybe you feel less
embarrassed asking questions like Wonderer; perhaps you want to engage
in a serious debate over touchy political issues; etc.  In these
examples, you would be putting out opinions that are your own - you
just want the freedom of speaking without fearing retribution or
After all, you may irritate someone who decides to cause you harm.
This won't ever happen, you say?  Maybe, but here's an example: Salmon
Rushdie, author of the "Satanic Verses" is still living in fear of his
You can whistle-blow.  Some months ago a local paper ran a series of
articles on people who had the careers and lives destroyed by the
Nuclear Regulatory Commission, because they reported various unsafe
practices and violations at their workplace.
Small examples of anonymity are in our life already: most radio shows
don't broadcast your last name, papers will withhold names from
editorial pieces sent them, police departments take anonymous tips.
The protection a pseudonym affords is more powerful.

@_date: 1993-10-27 08:57:54
@_author: Karl Lui Barrus 
@_subject: CASH: crosspost 
At risk of irritating some folks who already saw this, a crosspost:

@_date: 1993-10-30 08:53:27
@_author: Karl Lui Barrus 
@_subject: Re: Paranoid 
I'm not exactly sure what this thread is about :-) but I do have some
Differential cryptanalysis of DES requires 2^47 = 140737488355328 =
1.4 10^14 known plaintexts.
The complexity of a brute force DES attack (keysearch) is 2^56 =
72057594037927936 = 7.2 10^16, or 2^55 = 36028797018963968 = 3.6 10^16
if you are efficient.
Similary, brute forcing IDEA is 2^128 =
340282366920938463463374607431768211456 = 3.4 10^38
The best factoring algorithm (gopher plug: check in Misc/ for
a recent "bits and difficulty factoring post") for a 1024 bit key is a complexity of 4.42 10^29.
Somewhere around 1600 bits comes a point where it is "easier" to
attack IDEA than factor the resulting number.
Karl Barrus

@_date: 1993-11-02 13:30:01
@_author: Karl Lui Barrus 
@_subject: ANON: mail concerns 
Hm.. there have been some concerns over anonymous mail recently...
both Alan and Thomas have noted that it is easy to match up sender and
destination for a remailer which processes each message as it arrives.
Solution: cache all messages and process them later (once a day, once
a week, etc.).  For example, the remailer at elee9sf
caches all incoming requests, and processes them (randomly) at
I didn't even have to modify the remailer scripts to do this; rather,
I wrote some extra ones.  The process seems stable.  The trickiest
part is scheduling the remailing: I have to use the 'at' command since
I can't have my own crontab.
Also, Thomas mentioned what seems to be 'random remailing'.  As I
mentioned in a previous message ("ANON: anonymous mail"), forcing mail
to progress through a network randomly also forces the final
destination to be known to everybody, where before only one site knows
the final destination.
Also, instead of building the necessay headers to hop mail you may be
able to use one of several scripts and programs available at
Karl Barrus

@_date: 1993-11-04 09:02:23
@_author: Karl Lui Barrus 
@_subject: ANON: random remailing... 
Yes, this is true, but the key point in the anonymous remailers is
they can be used for two-way communication.  Presumably, both you and
your friend intend to email each other.  If mail proceeds randomly throughout the network, then the final
destination must be available to every remailer.  This may be fine if
A only sends to B (announces to every remailer B's address), but when
B responds to A, A's address is similarly announced to every remailer.
Now it is simple to figure out A and B are communicating.
If all you want is one-way communication (i.e. you just want to send
and don't expect any replies), you may be better off faking mail with
telnet, or using a newsgroup.
Karl Barrus

@_date: 1993-11-04 09:12:25
@_author: Karl Lui Barrus 
@_subject: ANON: pools 
Well, you can always run your own remailer or two... :-)
Actually, this is quite similar (identical to?) anonymous pools.  The
stuff about interfacing different pools sounds good.  Miron is running
one at extropia.wimsey.com (mail to pool0-request or pool0-help).
Basically, it is a mailing list with several subscribers.  If you want
to send a message to one person, encrypt it and send it to the pool.
Everybody gets the message, but only one person can decrypt it.

@_date: 1993-11-05 15:52:35
@_author: Karl Lui Barrus 
@_subject: ANON: random remailing 
Whoops, I think I was vague in my earlier response.
In mail, either you know whoever your mailing to or you don't.  If A
wants to mail B and doesn't need a response:
If A doesn't know B, A could use telnet to fake mail to B.  This
leaves more of a trail than an anonymous remailer, narrows down where
the message could have come from, but obscures who actually sent it
(I'm sure some logging facilities invalidate this).
If A knows B, they could agree to use a newsgroup as an anonymous pool
(sort of).  A posts a message, B reads it.
- From time to time, random remailing is suggested.  I think I'll go
re-read Chaum's paper and think about it more, but I'm nearly positive
that this makes it easier to pair up sender and destination.
Suppose remailers used random routing.  Assuming one remailer can be
trusted (the first hop) so linking A and mail sent to the trusted
remailer is not possible, A could send to B via the trusted remailer.
B's address will be made available to every remailer.  Now when B
replies, A's address is made available.  Caching and padding messages
may help, but all an eavesdropper has to do is monitor mail from B, a
known address, and when mail hits any remailer, A's address is known.
So is it reasonable to assume an eavesdropper can monitor a remailer
(all remailers except the trusted remailer), they can also monitor an
arbitrary address (B's)?

@_date: 1993-11-13 10:24:53
@_author: Karl Lui Barrus 
@_subject: REMAIL: scan, folders scripts 
Well, I put two PERL scripts I wrote at the ftp site (named
misc.elm.scripts.tar.gz); here is the README file:
scan is the script which prints out signature information of pgp
signed messages (instead of where the message came from).  Thus, if
pgp signed mail is sent through an anonymous remailer, you see who
signed the message instead of where it came from.  The inner loop is
ugly and needs major reworking; I've noted this below and in a comment
in the code :-)
It would be easy to include this in the mh 'folder' command, but I
don't have mh anymore here on owlnet :(  Integration into elm itself
would be great.
-----BEGIN PGP SIGNED MESSAGE-----
These are two experimental PERL scripts I wrote which report
information about elm mail folders.
folders prints a summary of mail in your ~/Mail directory.  It prints
out how many letters are in each folders, and how many files are in
each directory.
~> folders
Folder     austin         :    4 messages
Folder     cypher         :   20 messages
Folder     educom         :    1 message
Folder     inc            :   17 messages
Directory  misc           :   12 messages
Folder     store          :   26 messages
Folder     ysn            :    0 messages

@_date: 1993-11-14 23:20:19
@_author: Karl Lui Barrus 
@_subject: ANON: pseudospoofing confusion 
Well, there may be some legal precedent to look up: some of the
greatest works of literature were published under "pseudonymous"
identities.  Lewis Carroll, George Orwell, Mark Twain, George Eliot:
none of these people ever existed.  In fact, Mary Ann Evans published
under "George Eliot" in order to pretend to be male; I guess you could
call her master pseudospoofer, since she specifically created a fake
identity in order to fool others.
I suppose "Publius" doesn't qualify as a pseudospoofer since the three
gentlemen who were responsible for the _Federalist Papers_ were
probably just trying to hide their identity (at first) and not go
about creating new ones.
I'm sort of fuzzy on the distinction between pseudonymous and
pseudoanonymous; is it that a pseudonym is obviously so?  For example,
an id on anon.penet.fi is obviously a pseudonym, so if I were to use
it, I would be pseudonymous.  In a sense, every mail address you see
here is a pseudonym.
Now, pseudoanonymous is when a fake identity is created, without it
being obviously so.  (Right?)  So if I were to obtain another account
with a different user name, etc. and use that account, I would be
pseudospoofing. (?)
But the difference between these two seems so slight, a semantic one
rather than practical.
For example, suppose several people were in communication with someone
they had never met.  One person (of the several) is curious as to the
identity of the mystery person, and tries to find out information
about this person.  Very little is turned up.  So little, it could be
that the mystery person is "pseudoanonymous", a fake identity.  Are
the several people being pseudospoofed?  How can they tell one way or
the other without actually meeting the mystery person?  If they can't
tell, then what difference does it make?

@_date: 1993-11-17 20:56:58
@_author: Karl Lui Barrus 
@_subject: real-life pseudospoofing examples 
I thought I'd try to unearth some real-world "pseudospoofing" just so
Mr. Detweiler and other interested in this could have other tangible
While I can't do justice (i.e. research further) to these items right
now, I've found two examples in the little digging I've done.
First, Mary Ann Evans published "Silas Marner" under the pseudonym of
"George Eliot."  She purposely chose a male name in order to
masquerade as a male since women couldn't be novelists at the time.
It is unknown how long she pulled this off, but nevertheless is an
example of someone who created a false identity in order to
deliberately fool others.
I don't know what the reasons were for Eric Blair (George Orwell),
Samuel Clements (Mark Twain), or Charles Dogdson (Lewis Carroll) to
publish under pseudonyms.
The second (possible) example of pseudospoofing was relayed to me by
my parents.  They live in Prince William Country, Virginia, where
apparently Walt Disney Company has announced plans to build another
amusement park.  A representative of Walt Disney Co. bought the land
over a period of several years, consistently misleading real-estate
agents as to his intention and who he worked for.  He claimed to be
based in Phoenix, Arizona, and often would head towards a different
terminal in Dulles airport in order to make business associates
beleive this.  Maybe he even flew there every once in a while, I'm not
sure (parents are mailing various articles to me).
Obviously, he did this in order to keep Disney from being screwed on
land prices.  He pseudospoofed to do it.  He created a false identity,
lied to others about it.
So I look forward to mention of the Walt Disney Company as a
many-tentacled, satanic practicing pseudospoofing, subversive criminal
organization.  Maybe even in the next issue of RISKS :-)

@_date: 1993-11-28 19:34:40
@_author: Karl Lui Barrus 
@_subject: Re: CHAOS gopher maintenance 
The Welcome file at the top level directory should identify myself and
Chael as running the gopher site...
I have several posts from the last month or so, but haven't gotten
around to editing headers and making them available.  I've been buried
by coursework and by looking for summer internships, etc.
But I'll get around to it real soon!

@_date: 1993-12-02 13:42:35
@_author: Karl Lui Barrus 
@_subject: REMAIL: list 12/2/93 
Unless I missed more, the changes are
  chaos.bsu.edu can be looked up, so no more remailer%chaos
  remailer at cdodhner is down
also, I got some anon mail about changing the dos scripts to include
more redirection to nul; apparently 4dos is more verbose.  I will
update this over the break, promise!
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 12/2/93
Q1: What are the anonymous remailers?
 1: remailer
 2: nowhere
 3: hh
 4: hh
 5: hh
 6: 00x
 7: hal
 8: cs60a-qu
 9: ebrandt
10: catalyst
11: sameer
12: remailer
13: elee6ue
14: elee7h5
15: hfinney
16: sameer
17: remail
18: remail
19: remailer
20: remailer
21: elee9sf
22: remail
NOTES: 1-6		no encryption of remailing requests
7-21		support encrypted remailing requests
22		special - header and message must be encrypted together
12,19,20,22	introduce larger than average delay (not direct connect)
12,19,22	running on privately owned machines
13		requires "cash" payment for remailing
21		supports RIPEM encryption, caches remailing requests
Q2: What help is available?
Check out the pub/cypherpunks/remailer directory at soda.berkeley.edu
(128.32.149.19).  chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
For MAC's, at 129.82.156.104 in /pub/pgpc/ are two files:
pgpc22.tar.gz, pgpc22.tar.Z which assist in using the anonymous
remailers, including anon.penet.fi.
Mail to me (klbarrus for further help and/or questions.
Q3.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
 blocks from non-berkeley sites (so use the berkeley remailers :-)

@_date: 1994-01-13 19:15:40
@_author: Karl Lui Barrus 
@_subject: TV: Nova & Crypto 
On a different note, I see that the NOVA episode on Tuesday the 25th
of January is supposed to cover cryptography.  It looks like
historical stuff (Zimmerman note, Enigma, Purple, William Friedman,
etc.) and may not cover any "current" issues :-)
But it should be interesting.

@_date: 1994-01-17 09:03:29
@_author: Karl Lui Barrus 
@_subject: RSA: low exponent 
[concerning a low RSA modulus]
I haven't had a chance to look at Matt's post very much...
Actually, I beleive the largest concern over using a small modulus is
if you encrypt a message to multiple recipients (i.e. an identical
message to several people)
This then leaves you open to the "low modulus attack" (how
appropriately named :-) as described by Judith Moore in her paper
"Protocol Failures in Cryptosystems".  This paper also appears in the
Simmons big book on Crypto.
Basically, the message can be reconstructed with the Chinese Remainder
Theorem (I beleive, it's been a while since I worked through it).
To prevent this, random bits should be appended to change the message
for each person.
Karl Barrus

@_date: 1994-01-17 09:18:30
@_author: Karl Lui Barrus 
@_subject: REMAIL: remailer tech 
Thanks for the note, L.Detweiler!
Let's see, I added a bunch of files to the gopher site, and I'll do
more maintenance next weekend.
I sent out remailing requests, and got responses from these remailers:
Remailed-By: Remailer X-Remailed-By: Anonymous X-Remailed-By: Anonymous Remailed-By: remailer03                                     insufficent funds message
                                    alumni account to portal
Remailed-By: Eli Brandt Remailed-By: remailer bogus account Remailed-By: remail
Remailed-By: Eric Hollander Remailed-By: nobody
The following errors were received:
"|/u50/sameer/.myfilt"  (unrecoverable error)
    (expanded from: )
550 ... User unknown
So that's hearing from 18 out of 21, and maybe some more will drift in
shortly :-)  I'll test again in a while.
Yes, this is what the remailer at menudo does, all incoming mail is
just filed away, and then remailed at midnight.  I beleive I changed
the mailout script to pause for 5 or 10 seconds in between mailing.
Hopefully this will guard against massive onslaught attacks.
Karl Barrus

@_date: 1994-01-19 20:14:06
@_author: Karl Lui Barrus 
@_subject: RSA: questions 
I beleive if p and q are well chosen (p-1 and q-1 have large prime
factors, for example p = 2p'+1 and q=2q'+1 with p' and q' prime) then
only two values of d will work as the decryption exponent.  This makes
guessing d as "easy" as guessing either p or q in the first place.
For example: p = 11 (p' = 5), q = 23 (q' = 11), n = 253, phi(n) = 220
I picked e = 7, gcd(e,n) = 1, solve for d = 63
The message 20 encrypts to 20^7  mod 253 = 136
I make a brute force search for d by raising C to all possible values
of d, from 1 to 253, looking for what decrypts to the original message.
Only two values work: d = 63 (what I got above) and d = 173.  There
are as many useful d's as there are factors in n; clearly for large
values of p and q guessing d is as infeasible as guessing p or q.
Karl L. Barrus
d 136^d mod 253

@_date: 1994-01-21 12:18:11
@_author: Karl Lui Barrus 
@_subject: RE: RSA is weak link 
True; it is more expensive to do a brute force search over the IDEA
keyspace than it is to factor a 1024 bit number using the best known
factoring algorithm :)
I did some calculations once and I think the crossover point is
between 1500 and 1600 bits, at which point factoring becomes more
difficult than searching.

@_date: 1994-01-21 12:38:15
@_author: Karl Lui Barrus 
@_subject: Re: RSA questions 
Yeah, I'll try to play with the math this weekend or something;
actually, Charlie Merritt posted some formulas...
Hm.... I don't think you reduce the keyspace all that much.  The
restriction on e (and d) is they must be relatively prime to phi(n),
and if n = p q = (2p' + 1) (2q' + 1) then phi(n) = 4p'q', in which
case e (and d) can't be 2, 4, p', q', 2p', 2q', 4p', 4q', or 4p'q', a
total of 9 numbers out of the total possible.  I don't remember the
prime number theorem off hand (prime distribution), but for big
numbers the chances of stumbling on the correct d is essentially the
same as just guessing the factors of n in the first place.
There are other RSA artifacts: for example, a message may encrypt to
itself.  But you can minimize this (down to a max of 9 messages if
memory serves) by good choices for p and q.
So, choose good primes :)
Besides, an attacker hopefully won't have any information on the
primes you chose and will be forced to do a brute force search anyway.
Karl L. Barrus

@_date: 1994-01-22 11:36:26
@_author: Karl Lui Barrus 
@_subject: Re: RSA questions 
Argh, I left out p'q' and 2p'q', which brings the total to 11 unusable
numbers.

@_date: 1994-01-28 10:57:58
@_author: Karl Lui Barrus 
@_subject: META: request 
Hm... I have a request:
(There was a security incident here at Rice; owlnet has been
disconnected from internet for about 2 weeks and I think quite of bit
of mail has spilled.  Email has supposedly been restored, but that's
it so far, and given the number of "fork: no more processes" errors
I'm getting I think it'll be a bit longer...)
Can anybody send me the original "Remailer Noise Traffic" or "REMAIL:
Noise Cover" messages?  I'd like to read them and include them at the
gopher site (when I can actually telnet/ftp over there :-).  I only
have 20 messages from the list since the 23rd.

@_date: 1994-02-01 15:25:29
@_author: Karl Lui Barrus 
@_subject: Re: PGP 
I did some calculations on this a few months ago, and it works out to
be on the order of 4.42 10^29 steps.  So then you can figure out how
much real time it takes given machine speed.
I also made some calculations for other sizes - to get the rest of the
article gopher to chaos.bsu.edu and look at Misc/"Bits and Factoring
Difficulty" where I have been archiving various cypherpunks posts,
apparently flying the face of copyright laws blah blah blah blah.
Since I wrote that I give permission for it to be at the gopher site
Well, if it's an 128 bit IDEA password, and brute force is the fastest
way to "break" it, then 2^128 = 3.4 10^38.
Karl Barrus

@_date: 1994-02-01 15:30:42
@_author: Karl Lui Barrus 
@_subject: Re: PGP 
Yes, I think that the turnaround point is right around 1600 bits, at
which IDEA is "easier" than RSA.
Assuming of course brute force is the fastest way to break IDEA;
the fastest (known|published) factoring method runs in time
proportional to the formula I typed out, etc.
Karl Barrus

@_date: 1994-02-01 17:40:48
@_author: Karl Lui Barrus 
@_subject: REMAIL: ping, script 
I've been catching up on past messages; I see there was some interest
in scripts for pinging remailers, and some questions about how many
there are, etc.
Here is the data file and script I use to ping non-special remailers.
Note: remailer  will only remail if you attach "digital cash",
remailer  batches until midnight, remailer  requires encryption.
Save this as "remailer.data"

@_date: 1994-02-05 09:10:36
@_author: Karl Lui Barrus 
@_subject: MAIL: tearlines, policies 
Fellow cypherpunks,
Hm... I'm falling further behind list mail; the day after the security
situation at Rice was fixed (~2 weeks off internet) the hard disk
* About remailer policies:
Try to gopher site (chaos.bsu.edu) in "Anonymous Mail"/"Remailer
Policies" I can only really describe what goes on at elee7h5
elee6ue and elee9sf
* About tearlines:
There is no standard I'm aware of, although a quick and dirty trick is
to place a single period in the first column.  Most remailers pipe to
will end a mail message.  Try it before you rely on it to strip the
rest of your message.  I beleive Miron Cuperman (extropia remailer)
invokes sendmail with -oi.
* About old discontinued remailers:
I remember another discontinued remailer ?  I don't
remember the name, but the student was forced to shut it down because
the university said that running an anonymous remailer basically made
computing resources available to non-students.
* About the remailers I started/run:
Remailer  Fast?  OpLog SysLog Subj Batch RD NL CPU Phys PGP BitB

@_date: 1994-02-05 09:25:39
@_author: Karl Lui Barrus 
@_subject: MAIL: questionnaire 
Run by Chael Hall.
Contact at same address
Run by Chael Hall.
Contact at same address
Run by Peter Shipley
Run by Miron Cuperman
Comments: not directly connected, introduces some delay
Run by Karl Barrus
Maching: University machine
Problems policy: see policy at gopher site.
Contact elee9sf or klbarrus
Software: Hal's remailer code with a few modifications by myself
Security: batches incoming message, sends them out randomly at midnight.
Comments: also accepts RIPEM, pads messages to 1K with random stuff
(an experimental approach, Hal has code to pad inside PGP messages).
History: ??
Run by Julf (Johan Helsingus)
Run by Bill (O'Hanlon?  not quite sure)
Machine: privately owned
Comments: not directly connected, introduces some delay
History: 2nd oldest remailer
rosebud: (elee7h5
Run by Karl Barrus.
Machine: univerisity
Problems policy: see gopher site
Contact klbarrus
Software: standard scripts
Security: syslog file can be read
Comments: errors are dropped
History: 3rd oldest remailer
rosebud: (elee6ue
Run by Karl Barrus.
Machine: univerisity
Problems policy: see gopher site
Contact klbarrus
Software: standard scripts modified to accept cash strings
Security: syslog file can be read
Comments: errors are dropped
Karl Barrus

@_date: 1994-02-05 10:25:38
@_author: Karl Lui Barrus 
@_subject: MAIL: Re: remailers revisted 
- From a few weeks ago (recently for me :-)
Your system sounds great.  However, don't you have to be root to run
the server side of things (put it in /etc/inetd.conf)?  Or the
alternative is to leave a process continually running listening for
connections, right?  Leaving a process running isn't feasible for me,
even if it forks all the time (especially now with the recent security
problem on owlnet).
Or is there another way that an ordinary user can pull this off?  If
so I'd like to hear about it and work on an idea I've had for a while.
Karl Barrus

@_date: 1994-02-09 13:47:26
@_author: Matthew J Ghio 
@_subject: Re: What's a "real encryptor"? 
Does this program exist?  If so where can I get it?

@_date: 1994-02-10 09:00:21
@_author: Karl Lui Barrus 
@_subject: Re: real encryptor 
Sorry about the confusion Matt, I had sent a letter to Xenon about his
idea for stripped PGP describing this pure RSA program, and didn't
send it to the list.
Anyway, the program RSA.tar.gz is at ghost.dsi.unimi.it in /pub/crypt.
It implements pure RSA, no IDEA session keys, no MD5 hash of a
passphrase, no checksums, no keyring, no usernames, etc.  It is about
as minimal as you can get.  Which may be perfect for your purposes :-)
Because it is just RSA, it is SLOW!!  Which is to be expected, but all
the same the amount of time required to encrypt a reasonable sized
file is surprising.  Heck, even generating a decent size key takes
quite a bit of time.  I'm sure the code could stand some
optimizations, but even still public key crypto is much slower than
secret key.
Here's what a public key from the program looks like (in fact, it's my
public key for this program):
This public key and the associated secret key correspond to about a
700 bit modulus (100 digit and 110 digit primes).  The program encodes
numbers as an ascii string, but that is it.
The output of the program is the encrypted file, which has no header
or magic byte information, etc.  Decryption takes an encrypted file
back to the original form (except it looks like it pads and doesn't
toss the padding, maybe a bug) but if you use the wrong secret key
(i.e. not encrypted for you) the program decrypts the file to junk.
Or you can decrypt junk into different junk :-)  If you edit your keys
and change a few characters, or do the same to the encrypted file, you
don't get "checksum" errors, you just get an unreadable file.
Due to the slowness of the program, I think for testing the output for
randomness one should create relatively small keys (say 20 or 30
digits max) and encrypt large files.  Of course, at these sizes, it is
much easier to factor the modulus than brute force IDEA, for example.
Also, if you want larger keys be wary of the included script which
generates keys for you; it assumes you want a small key (and thus will
mess up the generated files).
So if indeed this is nothing but RSA then it should be impossible to
tell the output of the file from random noise.  (And incidentally, I
checked out Chaitin's Algorithmic Information Theory and have tried to
read the chapter on random numbers, but let's just say that it is
extremely slow reading :) I guess that's because it builds on stuff
from previous chapters or something...)
Karl Barrus

@_date: 1994-02-13 12:41:14
@_author: Karl Lui Barrus 
@_subject: REMAIL: new remailer 
After reading Tim's ideas on second generations remailer, I decided to
try coding a new experimental remailer which includes some of the
features mentioned.  Because I am doing a couple of different things,
I wrote the scripts from scratch since I need the familiarity with the
code that comes from actually writing the whole thing yourself.
However, I don't think it will be hard to add these features to Hal's
code, if they are found desirable.  I've been testing for a while and
it seems to work.
* Send mail to barrus to enter the remailer.
Ultimately, mail will be remailed from elee6ue
That is, there is a "mystery" processing point in between: mail ->
barrus -> ? -> elee6ue -> wherever.
I imagine it isn't difficult to figure out what the middle processing
point is, but I thought I'd distribute things around a bit.  * Mail from ? to elee6ue will be encrypted, even if
the mail sent to barrus isn't.  So mail with a latency
delay will be encrypted as it sits at ?; mail with no latency will by
encrypted before travelling to elee6ue
* The remailer elee6ue has been restored to normal.
That is, the "digital cash" (random strings) features has been taken
* The remailer figures out whether the message is encrypted (with PGP)
or not.  So no encrypted pasting token; perhaps later I will add RIPEM
* Instructions to the remailer are of this form:
The instructions come first, then a space, then your message.  The
original header of the message is thrown out (see *subject below).
For example, a valid message with the new remailer is:

@_date: 1994-02-13 13:21:16
@_author: Karl Lui Barrus 
@_subject: REMAIL: list of remailers 
Well, it's been a bit since I posted this, I hope I got all the
activity over the past month.
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 2/13/94
Q1: What are the anonymous remailers?
 1: remailer
 2: nowhere
 3: hh
 4: hh
 5: hh
 6: 00x
 7: hal
 8: ebrandt
 9: catalyst
10: qwerty
11: remailer
12: elee6ue
13: elee7h5
14: hfinney
15: barrus
16: remailer
17: remailer
18: elee9sf
19: remail
NOTES: 1-6		no encryption of remailing requests
7-19		support encrypted remailing requests
19		special - header and message must be encrypted together
11,16,17,19	introduce larger than average delay (not direct connect)
11,16,19	running on privately owned machines
18		supports RIPEM encryption, caches remailing requests
15		supports different request syntax
5		features USENET posting
Q2: What help is available?
Check out the pub/cypherpunks/remailer directory at soda.berkeley.edu
(128.32.149.19).  chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
For MAC's, at 129.82.156.104 in /pub/pgpc/ are two files:
pgpc22.tar.gz, pgpc22.tar.Z which assist in using the anonymous
remailers, including anon.penet.fi.
Or try the cypherpunks gopher site (chaos.bsu.edu) and look in
"Anonymous Mail" for instructions.
Mail to me (klbarrus for further help and/or questions.
Q3.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
*  Remember to include a Subject: with your post, may cause failures
   if missing
 blocks from non-berkeley sites (so use the berkeley remailers :-)

@_date: 1994-02-15 21:49:47
@_author: Karl Lui Barrus 
@_subject: REMAIL: simple digital postage 
Well, I know that integrating a quick and dirty (not particularly
cryptographically sophisticated) digital money system can be done in
Hal's code, since thats what I did at elee6ue for
quite a while.  (Now elee6ue has been restored to "ordinary"
And the one I recently wrote could be modified the same way - I just
put it together to test cutmarks, automatically detecting pgp
encryption, and latency delayed remailing.
I was looking into a more efficient way to check the validity of cash,
and making things bomb-proof, but sorta got sidetracked ;)
The way I did it is to add to remail.pl, have the script search the
header for a Digicash line (you use the pasting tokens as usual to
place it in the header).  The script extracted the "cash" and searched
for it in a list maintained by the remailer.  If found, then the
remailing proceeded as usual, otherwise the message "Insufficient
funds to deliver message" was sent along instead.  The cash list is
read into memory and rewritten out, minus the value just used.
The cash strings I used were random characters, which looked like this
(all starting with the character B):
and so forth.
Now with magic money a more sophisticated system may be developed.
Perhaps I will shift elee6ue back to a pay-for-remail system,
or do it at the mystery middle point of the remailer chain I'm
experimenting with.
Here is an extract of the additions to remail.pl I made to implement
        if (/^Digicash:/) {
          chop ;
          s/^.*: // ;          # remove text before colon AND blank afterwards
          $payment = $_ ;
        }
# check validity of digital cash
# open cash file and read it all in
  open(CASHLIST, "./digicash.list");
   = ;
  close(CASHLIST);
  unlink "./digicash.list";
 file, check cash for validity
 valid, don't write it back to the file
  open(CASHLIST, "> ./digicash.list");
  $paidfor = "n";
  while ( {
    $validcash = shift     chop $validcash;
    if ($validcash eq $payment) {
      $paidfor = "y";
      next;
    }      print CASHLIST $validcash, "\n";
  }
  close(CASHLIST);

@_date: 1994-02-18 20:51:05
@_author: Karl Lui Barrus 
@_subject: REMAIL: down remailers 
Bad news on the remailer front... both elee7h5 and
elee6ue are gone.  I just found out now, when some
anonymous mail intended for elee6ue bounced back to
me (the middle mystery hop of my recent remailer is my account on
I tried fingering both accounts, and it does appear they are gone
(before my old account elee7h5 was merely locked, so I
couldn't log in but the remailer I set up there kept on running).
The shut down will also unfortunately take out the one at
barrus since that was just the first stage of a
remailer that worked here and finally sent out through
elee6ue  Mail to barrus was forwarded to my
account here, and I was using the elm filter command to direct that
mail into the remailer scripts for processing.  I can't run a remailer
on owlnet (at least not so obviously, I risked it before since
remailed messages appeared to originate from elee6ue on not my
account klbarrus since it is forbidden by the user policy.
So I have three messages (the one bounce, and 2 queued with latency)
waiting to be remailed, but that can't happen anymore since the secret
key for elee6ue is gone.  I'll delete them soon since they
can't be decrypted anymore.
I have no idea why this has suddenly happened: I haven't had any
complaints or questions directed to me.  It could be anything from the
grad student who admins rosebud cleaned up old user accounts to
complaints from receipients of anonymous mail.
Anyway, I'll make the changes to the remailer list, and include the
new one at hacktic.nl.
Karl Barrus

@_date: 1994-02-20 11:21:27
@_author: Karl Lui Barrus 
@_subject: REMAIL: down (sortof) remailers 
well, after poking around some, I found out that the remailers
elee7h5 and elee6ue are down... they have been
Yes, that's right!  They are now named elee7h5x and
elee6uex  I've been testing and they do seem to work just
like before.  I'll flush out the two latency queued messages since I'm
not sure I can re-enable the chained remailer (I sent through the one
message that bounced).
Now this may be a pain as far as the remailing scripts actually
because both accounts are locked, so I don't have the secret keys
available to me anymore, in order to rename the public keys.  I guess
both those remailers are on the possible edge of extinction anyway (I
figure they were just renamed and locked because the grad student who
admins rosebud probably can't figure out how to remove an account
being a VMS guy ;)
Karl Barrus

@_date: 1994-02-27 16:52:42
@_author: Karl Lui Barrus 
@_subject: MISC: gopher & anon ftp 
About the gopher site:
I'm not sure how "easy" it will be to make the files available via
anonymous ftp as well.  I know Chael is running an anonymous ftp site
on chaos, but I'm not sure where it's directory lives... the gopher
data directory is within my own directory hierarchy.  It may be hard
to overlap the two and preserve the security standards Chael wants to
maintain.  Disk space is tight so just making a duplicate copy is
probably not the way to go ;)
However, I do back up the gopher data every month or so (and so does
Chael!), and since I will be adding 10 or 15 more files over the next
week (from anonymous video rental to magic money) and re-arranging the
ones already there, I'd be willing to mail you or anybody else
uuencoded, gzip'ed tar files.  Since most (all?) files have more than
eight character names, producing MSDOS compatible file names may be a
problem, since there will be some collisions.
And I like gopher!  It's great for just browsing around :)
For a while I was thinking of an "anonymous mail drop-off/pick-up"
where mail sent would be filed in a gopher accessible directory.  So
for example you could reach Pr0duct Cypher, Deadbeat, Wonderer, etc.
by mailing here and waiting for them to read your message via gopher.
Problems concerning disk space and the lifetimes of messages would
need to be addressed, as well as whether or not they would even use
such a system to receive messages.
Karl Barrus

@_date: 1994-03-02 18:19:24
@_author: Karl Lui Barrus 
@_subject: MAIL: remailer list 
I was just informed by Chris Walker that the remailer
elee9sf is now down.  If you send mail, it bounces with
"this account is expired".
Sheesh, in the space of two weeks I've lost all four remailers I had
running at UH.  Time to set up another ;)
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 3/3/94
Q1: What are the anonymous remailers?
 1: remailer
 2: nowhere
 3: hh
 4: hal
 5: ebrandt
 6: catalyst
 7: remailer
 8: hfinney
 9: remailer
10: remailer
11: remail
NOTES: 1-3		no encryption of remailing requests
4-11		support encrypted remailing requests
11		special - header and message must be encrypted together
7,9,10,11	introduce larger than average delay (not direct connect)
7,9,11  	running on privately owned machines
3		features USENET posting
Q2: What help is available?
Check out the pub/cypherpunks/remailer directory at soda.berkeley.edu
(128.32.149.19).  chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
Or try the cypherpunks gopher site (chaos.bsu.edu) and look in
"Anonymous Mail" for instructions.
Mail to me (klbarrus for further help and/or questions.
Q3.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
*  Remember to include a Subject: with your post, may cause failures
   if missing
 blocks from non-berkeley sites (so use the berkeley remailers :-)
This is the remailer.data file I use with nestping, a script for
pinging anonymous remailers:

@_date: 1994-03-02 20:05:11
@_author: Karl Lui Barrus 
@_subject: LIST: encrypted 
About receiving this mailing list encrypted.... I beleive Hal Finney
is (was?)  offering such a service.  Basically you send in your public
key, and Hal pipes all list mail through pgp and remails it you, from
one of his anonymous remailers.
I don't think many people opt for this :) but the option is there
(unless Hal isn't offering it anymore).
He'll probably answer when he reads the list mail!

@_date: 1994-03-10 10:56:59
@_author: Karl Lui Barrus 
@_subject: MAIL and Coming Police State 
Yeah, what you need is to run your own site, or have the explicit
permission to run a remailer from whoever owns the site.
For example, here on owlnet, the user policy forbids forwarding mail
to a non-standard program.
I mention this because I have asked and been told repeatedly by an
attorney friend of mine that running a remailer on a system where you
don't have authorization to do so is a violation of the ECPA.  (i.e.
access beyond what the system administration intends for you to have).
So you definitely need sysadmin approval to withstand even the
slightest pressure.
So maybe I'm glad all the remailers I set up have expired ;-)
As far as other properties, I've tried digital cash and time delay:
One remailer I ran used digital cash (a very simple system), another
batched mail and sent out once a day.  I didn't keep logs so I don't
know how popular these two remailers were, but I have a feeling not
very popular at all.  I also tried num-latency delays, but the
remailer which did this wasn't able to run for very long, so I
couldn't tell if it was a popular feature or not.
Good luck!
Karl Barrus

@_date: 1994-03-12 09:36:05
@_author: Karl Lui Barrus 
@_subject: Re: MAIL and Coming Police State 
Sure.  The attorney is Ed Cavazos (polekat - I met him
first as a user on his BBS (Bamboo Gardens, WWIVnet, now in Houston
after years in Austin) where he runs Modem/BBSLaw net, and then in
person a few times at EFH (Electronic Frontiers Houston) meetings or
He was involved in the Steve Jackson vs. Secret Service case, not as
lead attorney, but as an assistant.  Since this is the only case
involving the ECPA to hit the courts and he was in on it, I'm going to
have to go with his judgement, unless somebody can argue super
persuasively (and preferably convince him too!)
As a side note at the last EFH event, we had about 50 people in a room
talking about the Clipper Chip and its cons - people that stayed after
his talk on legal issues in cyberspace.
Anyway, I've asked him several times about the legality of remailers,
and during his last talk he addressed them, again ;).
Like a fool, I didn't take notes, but from what I remember, the ECPA:
* forbids others reading private communications
* makes it a crime to attempt unauthorized access on a system with
  private communication facilities (i.e. email)
* forbids you from access above/beyond what the system intended for
  you
I think there is one more thing that goes along with the ECPA, but I
can't remember.  I will email polekat and ask again, hopefully in a
few days or so he'll be able to get back to me.  Again, this is all
from memory.
Anyway, the last one is the key.  It says the even if you are a legit
user, the following are still illegal:
* you find a way to defeat security
* you read files that you aren't supposed to, even if the permissions
  let you
* you run programs or use the system in any way that the system
  administration didn't intend for you (i.e. you run crack all the time
  or you run a remailer)
Now, I was careful to make a distinction: running a remailer on a
current account, and running one on an old account.
(Because the four remailers I used to run were on old account of mine
when I was a student at UH.  Now I am at Rice, and Ed said it is
DEFINITELY a violation to run a remailer on an account you aren't even
supposed to have anymore)
But, he said that even running one on a current account is a violation
unless you have permission.
I mean, I don't mean to scare anybody or spread FUD - for example I am
not out of the remailer business ;) it's just the next one I set up
will be with the approval/blessing/whatever of the system
Well, the way it is prohibited here at Rice is by a policy which
forbids sending mail to any unauthorized or nonstandard program.
Stuff like filter, procmail, slocal (if MH were on owlnet ;) would be
allowed, but definitely not a remailer.
Yeah, but by this logic why is it illegal to export cryptographic
software when you can print it and mail it anywhere you please?
Silly, yet illegal.
Karl Barrus

@_date: 1994-03-22 20:53:05
@_author: Karl Lui Barrus 
@_subject: Re: PGP for OS/2 
It's available via ftp from a few european sites also:
(from the pgp22.txt file at ftp-os2.cdrom.com).
OS/2 executables for PGP 2.2 are available from
        ftp.uni-erlangen.de, pub/pc/os2/fauern/crypt/pgp22os2.zip
I checked a few domestic os2 ftp sites; they all seem to have a file
telling you where else to go... I guess the os2 ftp sites are
unwilling to carry pgp?
I got my copy of pgp32.exe (32 bit pgp2.3a) from the archive in
Finland (nic.funet.fi in pub/os2/2.x/diskutil I beleive; I can't check
right now because of a "your ftp client misuses NLST primitive" error
which seems to hang eveything...)

@_date: 1994-04-01 06:52:18
@_author: Karl Lui Barrus 
@_subject: MAIL: remailer list 
The only change to the list is a new section briefly describing three
other services: Miron Cuperman's, Matt Ghio's, and Jay Prime
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 4/1/94
Q1: What are the anonymous remailers?
 1: remailer
 2: nowhere
 3: hh
 4: rperkins
 5: hal
 6: ebrandt
 7: catalyst
 8: remailer
 9: hfinney
10: remailer
11: remail
NOTES: 1-4		no encryption of remailing requests
5-11		support encrypted remailing requests
11		special - header and message must be encrypted together
8,10,11		introduce larger than average delay (not direct connect)
1,2,8,10,11  	running on privately owned machines
3		features USENET posting
11		features anonymous pools
Q2: What help is available?
Look in ftp://soda.berkeley.edu/pub/cypherpunks/remailer
(soda.berkeley.edu = 128.32.149.19)
chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
Or try to gopher to chaos.bsu.edu and look in "Anonymous Mail"/Remailer Instructions"
Q3.  Other Services:
  1. Miron Cuperman's anonymous pool.
     To subscribe, send mail to pool0-request
     Mail sent to pool0 will be sent to all
     subscribers of the anonymous pool.
  2. Matt Ghio's pseudo-account remailer.
     Send mail to mg5n+getid
     You will receive an encrypted mail address of the form
       mg5n+eaxxxxx
     Mail sent to this address will be forwarded to you.
  3. Jay Prime Positive's mail pool
     Send mail to jpp=0x123456 and the mail will be
     encrypted with the key matching 0x123456, and sent to alt.test
     with a subject line of "Ignore 0x123456"
     To add a key, send to jpp=poolnew  The body of the
     message should contain the public key in pgp format.  If there is
     a key clash, a message with the subject "Ignore jpp=poolnew key
     already in use"
Q4.  Email-to-Usenet gateways?
 1: group-name
 2: group.name.usenet
 3: group.name
 4: group.name
 5: group-name
 6: group-name
*  This does not include ones that work for single groups, like twwells.com.
*  Remember to include a Subject: with your post, may cause failures
   if missing
 blocks from non-berkeley sites (so use the berkeley remailers :-)
This is the remailer.data file I use with pingmail, a script for
pinging anonymous remailers:

@_date: 1994-04-03 18:42:49
@_author: Karl Lui Barrus 
@_subject: MAIL: prank 
Why?  If you think about it, the prank doesn't demonstrate why
anonymity is bad - it could have been off with ordinary mail forgery.
What is does demonstrate is the need for digital signatures and
authentication.  In the future you would just ignore an announcement
of this sort if it doesn't have a valid digital signature.
Karl L. Barrus

@_date: 1994-04-05 19:25:20
@_author: Karl Lui Barrus 
@_subject: CHESS: max # of games 
Since this thread won't seem to die, I thought I might (hopefully)
present an argument that will convince you who are interested that
there are a finite number of chess games.
A chess game may end by checkmate, resignation, statemate, or draw.
The draw category is important: it can be agreed or forced.
Draws are forced when:
* the same position repeats three times.
  This is commonly used to end games by "perpetual check".
* 50 moves pass and no pawn is moved, or piece captured
  I've never seen this invoked, but it could happen if say one player
  doesn't have enough material to checkmate the other.  E.g. white has
  a king and black has a king and bishop.  Checkmate is impossible so
  the game will eventually end.  Or the players could be smart enough
  to realize no win is possible and draw the game right there.
So, there are a finite number of moves in a game.  In fact, the
following is excerpted from the FAQ for rec.games.chess:
Now, as an EXTREMELY LOOSE upper bound on the number of positions
possible, allowing illegal positions, not differentiating between the
various pieces, etc.... chessboards have 64 squares, white has 16
pieces and black has 16 pieces.  There are 64!/32! ways to place the
pieces (1st piece gets 64 choices, 2nd gets 63, on down to the last
which gets 33 choices).  64!/32! = 4.8222 10^53.  (Right?  No
combinations or permutations here).
Again, this allows ALL positions, even illegal positions and position
which are othewise impossible.
So I calculate the ABSOLUTE maximum number of games to be
(4.8222 10^53) ^ 5048 = 1.0516 10^270993
I don't see how it is possible under the rules to have more; indeed
the true number is FAR less.
While this number is pretty big, it is less than infinity.
And send followup questions to me and not the list.
Karl Barrus

@_date: 1994-04-09 10:44:14
@_author: Karl Lui Barrus 
@_subject: MAIL: catalyst and entropy 
Yes, it does!  You can find the public key for this remailer at the
gopher site (gopher chaos.bsu.edu in "Anonymous Mail"/"Public Keys").
Argh, I've fallen a bit behind and may not have upload the latest
stuff to the soda.berkeley.edu.  I'll do that soon.
Yes, I think it is.  I got it to work a few times recently, but very
erratically.  Just a few days ago there was a message sent to the list
by the admin of linet.org saying entropy hadn't polled in quite a
while... so I guess it is down.

@_date: 1994-04-26 20:55:56
@_author: Karl Lui Barrus 
@_subject: Re: prime numbers 
Hm... interesting.  There is a related problem about every integer
being represented as the sum of four squares, but you ask if
(1+4k) can be written as a sum of squares, without mentioning a limit
on the number of squares.
If this is the case, then each number of the form (1+4k) is easily
represented as the sum of squares: 4 is represented as 2^2 up to k
times, and 1 is just 1^2.
So for example 21 is 1^2 + 2^2 + 2^2 + 2^2 + 2^2 + 2^2.
Pretty cheesy, eh? ;)

@_date: 1994-04-30 08:40:16
@_author: Karl Lui Barrus 
@_subject: Crypto books 
I have this book - "Cryptography and Secure Communications" by Man
Young Rhee.  It covers basic cryptography (number theory, DES, block
ciphers, stream ciphers, public key systems) and also communications
(BCH codes, Reed-Solomon Codes, Error control for cryptosystems).
Late chapters cover more crypto protocols (authentication, digital
signatures, ZKIP, smart cards, key management).
The book is pretty good, but Schneier's book covers far more
cryptographic protocols.  This one seems to be a fusion of
cryptography and error control coding.  But then, the author's
previous book was "Error Control Coding Theory."
Karl Barrus

@_date: 1994-05-01 11:04:35
@_author: Karl Lui Barrus 
@_subject: MAIL: remailer list 
1) two new remailers!  anon and remailer
I put the public keys up at the gopher site (chaos.bsu.edu) and once
the semester is over I will get organized and upload to
2) Matt Ghio's update list of email-to-usenet gateways, gained from
trolling misc.test.  Thanks!
-----BEGIN PGP SIGNED MESSAGE-----
Cypherpunk anonymous remailers, 5/1/94
Q1: What are the anonymous remailers?
 1: nowhere
 2: remailer
 3: rperkins
 4: remailer
 5: hal
 6: ebrandt
 7: remailer
 8: anon
 9: remailer
10: remailer
11: catalyst
12: hfinney
13: remail
NOTES: 1-3		no encryption of remailing requests
4-11		support encrypted remailing requests
11		special - header and message must be encrypted together
7,10,13		introduce larger than average delay (not direct connect)
1,2,7,10,13  	running on privately owned machines
4,8,9		features USENET posting
11		features anonymous pools
8,13		located outside of the U.S.
Q2.  Other Services:
  1. Miron Cuperman's anonymous pool.
     To subscribe, send mail to pool0-request
     Mail sent to pool0 will be sent to all
     subscribers of the anonymous pool.
  2. Matt Ghio's pseudo-account remailer.
     Send mail to mg5n+getid
     You will receive an encrypted mail address of the form
       mg5n+eaxxxxx
     Mail sent to this address will be forwarded to you.
     Mail sent to mg5n+remailers will return a list of
     remailers to you.
     Mail sent to
     mg5n+anz3ajg8o1yxicqzt6v6qgpg3tkhddpqw3jl
     will be forwarded on to cypherpunks
  3. Jay Prime Positive's mail pool
     Send mail to jpp=0x123456 and the mail will be
     encrypted with the key matching 0x123456, and sent to alt.test
     with a subject line of "Ignore 0x123456"
     To add a key, send to jpp=poolnew  The body of the
     message should contain the public key in pgp format.  If there is
     a key clash, a message with the subject "Ignore jpp=poolnew key
     already in use"
  4. Finger remailer for instructions and a ping report.
  5. Usenet posting:
     anon and remailer allow posting to
     usenet with the following syntax:
     Request-Remailing-To: news.group
     remailer uses the following syntax:
     Post-To: news.group OR Anon-Post-To: news.group
Q3: What help is available?
1. Look in ftp://soda.berkeley.edu/pub/cypherpunks/remailer
   (soda.berkeley.edu = 128.32.149.19)
chain.zip             - program that helps with using remailers
dosbat.zip            - MSDOS batch files that help with using remailers
hal's.instructions.gz - in depth instruction on how to use
hal's.remailer.gz     - remailer code
pubkeys.tar.gz        - public keys of remailers which support encryption
pubkeys.zip           - MSDOS zip file of public keys
scripts.tar.gz        - scripts that help with using remailers
2. Or try to gopher to chaos.bsu.edu and look in    "Anonymous Mail"/Remailer Instructions"
3. Cypherpunks WWW home page is
   ftp://soda.berkeley.edu/pub/cypherpunks/Home.html
Q4.  Email-to-Usenet gateways?
  1: group-name
  2: group.name.usenet
  3: group.name
  4: group.name
  5: group-name
  6: group-name
  7: group.name
  8: group.name
  9: group.name
 10: group.name
 11: group.name
 12: group.name
*  This does not include ones that work for single groups, like twwells.com.
*  Remember to include a Subject: with your post, may cause failures
   if missing
 blocks from non-berkeley sites (so use the berkeley remailers :-)
This is the remailer.data file I use with pingmail, a script for
pinging anonymous remailers:

@_date: 1994-05-11 17:32:02
@_author: Karl Lui Barrus 
@_subject: Message Havens (research havens, remailer usage) 
Well, I am glad somebody read my post, admist the heavy and sometimes
irrelevant traffic...
Ah, sorry about the mixup in nomenclature - I like "Joe College" as a
name actually, reminds me of Snoopy ;)
Funny, but I was going to describe something I've been kicking around
for a while, something in between a remailer and a data haven (a
different service I could try setting up after getting a slip
connection, or on an existing account, etc.).  But as I sifted through
list mail today I see you did it for me!
Actually, I based my idea on gopher and called it a "message haven".
Basically, write some scripts which accept incoming mail and file it
into a gopher accessible hierarchy.  Then, anybody could connect up
and browse for messages.
For example, if you wanted to contact Pr0duct Cypher, you could
encrypt a message with his key and send it to the message haven.
Leave your own public key in the message and he can respond the same
way.  People could use anonymous remailers to send in messages, and
use pseudonyms to protect their privacy.
(The service would allow you to specify the name you want your message
filed under, and both parties would have to agree on details such as
this, etc.  The haven could even accept digital cash - say by default
messages are only kept for a day but you can pay for extensions.)
An advantage would be no mail is sent out, so there (hopefully) won't
be anybody complaining about receiving harrassing mail, a common
objection to anonymous mail.  Bandwidth may be saved (as opposed to
sending to usenet or a mailing list to reach one person, all mail
would just go to the haven).
How is privacy preserved?  Well, it's kinda ugly but you borrow a
trick from Mr. Slippery ("True Names") and browse the entire message
database, buffering all messages and later extracting what's relevant
to you.  This way even if gopher logs are kept, exactly what message
interested you is undeterminable (since you read them all).  If your
net connection is monitored, no information can be derived since you
took it all.  (Note: this could be impractible, perhaps there is a
better way?)
The reason why I based this on gopher since I have some experience
with gopher from helping the run the cypherpunks gopher site.  Chael
tells me that eventually all the files will be moved out of my home
directory into the same directory used by anonymous ftp.  Which would
free up my disk space (running near quota ;) and allow people to
retreive files with ftp.  More important, I would have space to try
some other crypto experiment, like this message haven.
Why only messages?  Largely due to disk space restrictions, I would
hope that messages would tend to be short (shorter than 1000 graphic
or sound files, etc.)
Well, does this sound useful?
Karl Barrus

@_date: 1994-05-11 21:51:52
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
It occured to me that perhaps getting messages to a message haven
won't require anonymous mail to protect privacy (who you are
communicating with.  You would still need to use a remailer to hide
the fact you are using the message haven!).
In each message, the author could specify what to name the next reply.
If messages are encrypted, then all a watcher would see is incoming
messages from various people, but not be able to figure out who is
reading what message, and what messages are responses to what other
This would require the service to reject unencrypted messages, which
would be easy enough.  But it would still require people to "download"
everything and sift through it at home, to hide what messages they are
interested in.
Karl Barrus

@_date: 1994-05-12 20:39:53
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
Well, the biggest (and maybe the only) difference is mail doesn't
leave the haven.  It's like a post office box, you have to show up to
retrieve your mail.
- From my experience running remailers, posts other operators send here,
general observations, and various attacks we've all suffered through,
it seems like most of the problems/objections we get stem from the
fact that anonymous remailers (drum roll...) actually send mail!
For example:
* Eli just sent a message about somebody who used his remailer to
mailbomb something...
*this list has been victim to the rantings of various individuals
anonymous and otherwise.
*somebody forwarded a ClariNet post through Scott Collins' remailer
thus causing him difficulty
*remailers operators have to fear some fool will remail to
whitehouse.gov (or the operatros have blocked that address)
*the message pool Miron runs is susceptible to mail bombing
I'm not saying we should junk the anonymous remailers and replace them
with message havens... it's just a suggestion that may solve a few
problems we are having.  Until positive reputation filters show up and
everybody digitally signs their posts, etc.
Digital cash payments for each message stored would greatly reduce the
mailbomb problem for message havens as well as anonymous remailers.
Karl Barrus

@_date: 1994-05-12 20:53:24
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
I disagree.  The only resource that will be hit is the message haven
(unlike say every computer in the world that carries the certain
usenet group you have chosen to use as a communications vehicle).
Geez, think of like a place that offers anonymous ftp.  It's resources
are hit, but I don't buy the "massive load on net.resources".
The only load I can envision being hit on a person's terminal is the
time it would take to browse all messages.  You have to read each
message and have your communications software log in a file, or
scrollback/record each one individually.  I mean, the info is already
coming to your computer, you just have to save it.  Maybe the haven
could offer a way to get all the days/weeks/whatever files in one big
chuck; this is clearly no worse than just ftp'ing a large file.
This scheme is precisely what I described earlier!  The two users
agree on what to name/tag the file, and that's how they get messages
to each other.  The problem is Bob can't just retreive that one file
(if he is concerned about traffic analysis), so he can get them all so
a watcher learns nothing.  You have suggested downloading a smaller
portion of the available message base instead of the whole thing.
Alice and Bob can get their messages to the haven via anonymous
remailers to avoid problem   I didn't envision the message haven even having a key.  It isn't
needed if they both are encrypting with the other person's key anyway,
so I'm not sure what problem  is.
Karl Barrus

@_date: 1994-05-12 21:32:52
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
I'm taking it that a "gopherhole" is different than the "message
haven" I described, so maybe I missed something...
but if the "gopherhole" sends out random messages (and presumably the
ones you are interested in) then the "gopherhole" will eventually be
able to figure out what messages you are interested in.  And how would
it know what messages you are interested in unless you tell it... it
would then need to be able to tie your psuedonym to your real mail
address, which defeats the entire purpose of what I described.  But
then, maybe the design goal of a "gopherhole" is different and I
missed it.
Maybe I wasn't clear in what the "message haven" offered... I'm trying
to get away from the penet style mapping tables, persistent
information tying you and your pseudonym, and solve the "unsolicited
anonymous mail" problem.  The message haven requires no trust, no
tables, no information since it just accepts message and files them,
and if you retrieve all the message, the haven can't figure out which
ones you are interested in!
Karl Barrus

@_date: 1994-05-12 21:48:37
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens, gopherholes 
Okay, I think the discussion has forked somewhere along the way to
"gopherholes" and "message havens".  While I described the message
havens, maybe I didn't do so clearly (after all, it's all worked out
in my mind!) and I may be overlooking something a fresh perspective
will see.
But, the advantages of a message haven are:
* it doesn't send mail, thus eliminating what are the strongest
  objections to anonymous mail - you can't harrass somebody
* it doesn't require you to tell it what messages you want to retrieve
* it doesn't keep a list of pseudonym and true identity mappings,
  which seems to be required for "gopherhole" operation
* it doesn't even need to have a public key: you and your partner can
  use each other's keys, and in every response to a message, you can
  specify what to name the next message, and even include a brand new
  public key if you want, etc.
* if you retreive all the messages, the haven can't figure out who you
  are communicating with (actually, it can't figure out who is
  communicating with you)
Now, about gopherholes:
[description of how randomization and tag changes will make it hard to
 associate pseudonyms and true names]
Unless I missed something, you have to tell the "gopherhole" what
messages you want to receive.  This allows the goperhole to associate
your psuedonym and true identity.
More comments!  About message havens and gopherholes.  Nice to see
some crypto being discussed ;)
Karl Barrus

@_date: 1994-05-13 17:13:39
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens (fwd) 
[Douglas asked me to forward this to the list]
You think so?  Hm.  I'm just pulling numbers out of the air here,
Let's say the cypherpunk dream is realized, and everyone on the net
uses anonymous mail through a message haven.  I believe there are
20 000 000 InterNet users right now.  Lets say each person sends one
piece of mail every day, and also checks the message haven each day.
Each day there are twenty million new messages on the message haven.
These are downloaded by twenty million people each day.  That's
400 trillion messages that the message haven must send each day.
Let's say the average size of a message is 1Kb.  This gives a total of 3 Petabits a day.  At 86400 seconds in a day, this requires
a bandwidth of 30 Terabits/second.
This is, of course, far beyond practicality.  I'm allso being
a little silly here, assuming there is only one message haven
for the world.  With distributed havens the load on each haven
decreases.  However, the load on each recieving terminal is the
same.  Each terminal must process 20 Gigabytes of mail to look for
messages to the user.  Maybe that'll be practical in a few years,
but then again in a few years there will be more internet users.
I'm sorry, I must not have read your post carefully enough.  I understood
there to be no tag outside the encryption wrapper.  I thought you were
implying attempting decryption of every post on the haven until one worked.
My appologies.

@_date: 1994-05-13 17:20:11
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
Well, if the cypherpunks "dream" is realized then there won't be a
need for message havens since anonymous mail will be accepted
net-wide.  People wouldn't go after anonymous remailer operators
because somebody harrassed another person.
But back to the problem at hand...
Your analysis is interesting, but so far fetched I'm not going to
worry about it.  I mean, yes, if the 5 billion people of earth decide
to do this, or decide to call each other, or decide to send each other
snail mail, everything will collapse.  Considering this as a worst
case, in my opinion, is a waste for right now, and will deter useful
work before it even starts.
Planning for this is about as useful as worrying about all 20 million
net users will access the same Mosaic page, the same gopher site, the
same ftp site, etc.
I just don't expect traffic to be that heavy.  And I base it on
personal experience from running anonymous remailers.
Plus, it is ONLY necessary to retreive all messages if you don't want
it know who you are communicating with.  If you don't care if it is
known you communicate with some psuedonym, then you don't have to get
all the messages.  The primary goal is to not mail messages out since
that is where most the complaints against anonymous remailers lie.

@_date: 1994-05-13 18:17:01
@_author: Karl Lui Barrus 
@_subject: Message Haven explanation 
Hm... after reading various replies about the message haven I
described, I've concluded my original explanation was terrible and
confusing ;)
Background: I've noticed that about the only opposition voiced to
anonymous mail is the fact somebody can harrass another user (however,
they can also be used to forward Clarinet posts, for example).  Also,
systems such as Julf's, convenient as it is, require tables which map
psuedonym to true identity.  The message haven is my idea of how to
get around these two problems.  (I'm not saying Julf is untrustworthy
or something, this is just an idea to try out!)
The way I see it working is you would create a message containing what
you want to say, what to name the next reply, and anything else...
perhaps a new public key to encrypt the reply with.  You encrypt this
message with the public key for whoever you want to communicate with,
and send it to the haven with instuctions to file it under a name you
specify.  Your partner would browse the message haven, and retreive
the message.  He would frame a response, include what to name the next
reply, maybe include another key, etc., encrypt his message with your
public key, and send it back to be filed under the name you specified.
The very first message to a person would have to be titled something
obvious to them (i.e. "To Pr0duct Cypher", "To Deadbeat", "To
Wonderer", "To L. Detweiler" or whoever), unless you can pre-arrange
So far, the haven just accepts messages and files them.  Maybe it
could take a digital cash payment to file in an area where the message
will be available for longer.  The haven doesn't even have a public
key (unless it runs a bank and has a public key for the bank portion).
Now, if the message haven keeps logs of what messages you read, it
will be able to figure out who you are communicating with.  One
possibility is to take all the message, so even if the haven fully
logs, it will derive no information.  This is only if you actually
care that the haven can figure out who you are communicating with.  If
not, just grab the messages for you.
Some people are suggesting retrieving a subset of the messages.  Yes,
this will work, but only if you take the same subset all the time.
For example, you take your messages and message addressed to users A,
B, C, and yourself.  (There would be a complication if all the other
users changed public keys simultaneously).  If you don't take the same
subset all the time (say you retrieve A, B, C, and yourself once, and
then X, Y, Z, and yourself another time.  It should be pretty clear
who you are!), you expose your identity.  Also, you would need to take
all the messages of the other users (say A, B, C, and you have 5
messages each.  You take all of yours, and just 1 from each of the
others.  Again, it should be pretty obvious who you are).
Maybe the easiest thing to do is simply use a brand new public key
every time, then you can take random messages.  Indeed, you could even
fool the haven into thinking you are communicating with someone else
by always retrieving their messages, if you use a new public key each
Some schemes have been suggested in which you tell the haven what
messages you want.  It would send them along with some random ones.  I
don't like this idea since it requires the haven to be able to connect
your pseudonym with your true identity, and it's more complicated, as
far as the haven goes, and as far as you (if you want to use a new
key).  And if you are already telling the haven your identity, you may
as well just browse it and retrieve the messages intended for you.
So, hopefully that is a bit clearer.  Comments are welcome!
Karl Barrus

@_date: 1994-05-14 11:00:07
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
Okay, I think that you are overlooking something which appears obvious
(to me) but evidently it is not.  I am guilty of skipping over some
The fact that you take the messages from a haven or several havens or
all the havens doesn't allow anybody to figure out if you are actually
reading any of the messages!
If message havens become popular, then (as you mentioned in a previous
post) there may be hundreds set up for people to use.  This would
decrease the load on each one.  If there many message havens to choose
from each would only have to serve a few hundred or so people (much
like banks).
Again, only if you want to hide your pseudonym, you can simply
download all the files and foil any logging on the part of the haven.
It is NOT necessary to download all the files from ALL the havens.
You just use your preferred one.  If you get all the files from the
haven you use (and ONLY the haven you use), you still leave the haven:
a) unable to determine your pseudonym
b) unable to figure out if any of the messages are indeed for you
The haven would not be able to figure out if anybody is communicating
with you since the haven can't be sure you are even reading the
messages you grab.
And if you do regularly receive messages at one haven, you can pick
another one, and get all the message from both.  And neither haven
would be able to determine what messages you are reading, if any at
all.  You could get even fancier and communicate back to your friend
via a different haven altogether, which you never go to.
So before doing a detailed complexity analysis, I think it is best to
think about the protocol a bit more.

@_date: 1994-05-14 11:15:46
@_author: Karl Lui Barrus 
@_subject: Re: Penet Spoofing 
I would like to add that I have evidently been a victim of "penet
spoofing" as well, since I too received the following message from
Somebody is trying to be clever and forging mail to figure out
my penet id (surprise, I don't have one, but now I do).
When I got this message, I immediately sent off in an attempt to set
my password.  I haven't heard back yet, so I don't know if it was
successful or not.  If the password set fails, then somebody has taken
over anXXXXX and I'll be mailing Julf in order to get it removed.
Whoever wants to know my penet id... I'll save you some trouble:
an4609 - my old (now expired) account elee9sf
an5022 - my old (now expired/locked) account barrus
Now, of course, I have a new one, which somebody has thoughtfully
started up for me.
Karl Barrus

@_date: 1994-05-14 11:23:21
@_author: Karl Lui Barrus 
@_subject: Re: Penet spoofing 
Heh, I forgot the mention my new ID at penet, which was created by
somebody trying to figure out mine:
Since whoever forged the post creating this id knows that an97875
corresponds to klbarrus I have no desire to actually
use this account for posting messages.
Karl Barrus

@_date: 1994-05-14 18:53:42
@_author: Karl Lui Barrus 
@_subject: Re: ADMIN: on penet and on paranoia 
Yes, that is indeed the nature of it since many of the protocols are
designed to work admist mutually distrusting parties.  A degree of
suspicion/ paranoia is necessary - for example, digital cash.  Another
example, a non-suspicious person may be tricked into digitally signing
anything (by getting them to sign a blinded document).
I understand this: I was allocated an anonymous id which I didn't
intend to request.  So maybe it was a technical error, maybe it was
somebody trying to figure out my id...
in either case the resulting id is useless  Presumably, the person subscribing to the list received my message,
with the From: field altered to the anonymous id.  Since the message
contained by name and email address, I don't care if the id was
assigned by mistake.
Precisely: I beleive my assigned anonymous id to be worthless.
I think I follow most of what you are saying; all the same, in this
case, technical error or not, malicious person or not, the paranoia is
justified.  And beleive me, I haven't invested much time into figuring
this out.

@_date: 1994-05-14 19:21:47
@_author: Karl Lui Barrus 
@_subject: re: havens, pools, usenet 
Nothing happened to the idea of posting anonymously to usenet!
It's just that it usually draws complaints from people, which at times
threaten the existence of the remailers involved.  And the fact that
the haven doesn't send mail out is an attempt to solve this problem.
Besides, the advantage the haven would offer is that it could allow
you to pay for more time - say by default messages get tossed out
after a day or two, but you could pay for yours to stay around a while
longer. Maybe commercial services operate differently, but here at Rice,
newsgroups (especially in the alt.* hierarchy) expire lightning fast.
Well, all except the rice.* and clari.* heirarchies.  Which would pose
a difficulty in using certain groups.
Like I said, most of the objections I see to anonymous mail are the
fact that mail actually arrives at another person mailbox or in a
newsgroup.  I mean, I was involved in a flame war on comp.admin.policy
a while ago, and after exchanging posts and email with a few people,
it became clear their only objection to anonymous posts/mail was that
mail actually went somewhere or it was a breach of "nettiquette".
Tim, I agree with your assessment of "nettiquette"; there are plenty
of worse abusers, but all the same, it draws fire which is harmful.
If nothing else, lots of other people get irritated.  For instance,
Serdar Argic seems to survive despite net.abuse, but it irritates
hundreds. Karl Barrus

@_date: 1994-05-15 08:45:47
@_author: Karl Lui Barrus 
@_subject: Re: Message Havens 
Hal brings up an excellent point!  I forgot to consider this, if there
are several message havens, then you need to know what havens your
party monitors...
Hm... I guess you'd need to start the conversation by broadcasting the
initial message to all havens.

@_date: 1994-05-16 19:39:44
@_author: Karl Lui Barrus 
@_subject: Re: Rabin 
Earlier, anonymous asked:
Well, I'll look at what Schneier says; maybe there is a typo in the
formula... but the way you can solve this is with the Chinese
Remainder Theorem.
If c = m^2 mod n, then a solution is a common solution of
m^2 mod n = c mod p
m^2 mod n = c mod q
Since p+1 and q+1 are divisible by 4, then (a^((p+1)/4))^2 = a since a
is a quadratic residue modulo p, and then a^((p-1)/2) mod p = 1
anyway, you calculate x1 = a^((p+1)/4) mod p
                      x2 = a^((q+1)/4) mod q
and then use the CRT four times to get the solution.
For this example, p = 7, q = 11, n = p q = 77, m = 50
c = 50^2 mod 77 = 36
x1 = c^((p+1)/4) mod p = 36^2 mod 7  = 1
x2 = c^((q+1)/4) mod q = 36^3 mod 11 = 5
So now you use the Chinese Remainder Theorem for the following four
CRT(n, p, q, x1, x2)
CRT(n, p, q, x1, q - x2)
CRT(n, p, q, p - x1, q)
CRT(n, p, q, p - x1, q - x1)
CRT(77, 7, 11, 1, 5) --> 71
CRT(77, 7, 11, 1, 6) --> 50
CRT(77, 7, 11, 6, 5) --> 27
CRT(77, 7, 11, 6, 6) --> 6
Sorry, but I don't have time to write out the steps for the CRT ;)
It's pretty straightforward, given the algorithm.
so (71, 50, 27, 6) satisfy the equation x^2 mod n = c
                                        x^2 mod 77 = 36
as you can see, the original message (m = 50) is one of the choices.
This is similar to an oblivious transfer protocol.  Actually, I think
it is an oblivious transfer as described by Blum.
Karl Barrus

@_date: 1994-05-16 21:03:32
@_author: Karl Lui Barrus 
@_subject: Re: Rabin 
About Rabin (and you're welcome, Mr. Anonymous!)
Well, I looked at Schneier on p. 290 and I have to confess I'm
puzzled.  I'm sure these formulas weren't invented out of this air,
but I'm not sure why one of them must equal M.  (In the example worked
none are equal to M).  I would bet that this is a typo in the book;
check the errata sheet
I think the formulas are trying to say the following facts:
For the kinds of problems we are considering, If m1 = CRT(n,p,q,x1,x2)
   m2 = CRT(n,p,q,x1,q-x2)
   m3 = CRT(n,p,q,p-x1,x2)
   m4 = CRT(n,p,q,p-x1,q-x2)
then m4 = n - m1, m3 = n - m2
So you really don't need to do CRT four times; twice is good enough.
(In the example, m1 = 71, so m4 = 77 - 71 = 6
                 m2 = 50, so m3 = 77 - 50 = 27)
Karl Barrus

@_date: 1994-05-17 16:24:04
@_author: Karl Lui Barrus 
@_subject: Re: DH key exchange 
Actually, there is some sample code - for example, in the rdemo
directory is the file dhdemo.c, which is a demo of the DH extensions
to RSAREF.
An example (all worked out) of a DH key exchange is available at the
gopher site (chaos.bsu.edu) in the Protocols directory.
Karl Barrus

@_date: 1994-05-30 15:36:59
@_author: Karl Lui Barrus 
@_subject: Re: Detweiler's motivations 
I agree it is difficult to determine Detweiler's motivations; I've
carried on quite civil email exchanges with him... but the posts from
tmp are quite bizzare.
Anyway, I was looking thought this months PC Techniques articles on
Secret Sharing, Simple Encryption (XOR), and Subliminal Channels, when
I flipped through Connect magazine... and was stunned to see the
article "Cryptography for the Unwashed Masses" by L. Detweiler!
The article is calm, reasonable, explains the rudiments of crypto
(keeping in mind the target audience), and in general pro crypto.  So
while he may have it in for cypherpunks stuff, he seems to be
supporting cryptography.

@_date: 1994-06-03 19:10:13
@_author: Karl Lui Barrus 
@_subject: Re: Mosaic / CEB / CypherEssay Archive and List 
This isn't quite the mosaic site described, nor is it the "Cypherpunks
Electronic Book", but there is an archive of what I think are some of
the more interesting articles posted here (well, I'm a few weeks
behind adding new stuff and have several posts to include soon).
It's a gopher site: gopher.chaos.bsu.

@_date: 1994-06-14 16:41:27
@_author: Karl Lui Barrus 
@_subject: Timed Released Crypto 
(been absent from the list for a long time since Rice disabled remote
dialups AGAIN)
I see there was a question on how to encrypt something to be read in
the future.  Several months ago Tim May sent a post covering this very
topic - "Timed Released Crypto", which is at the gopher site
in the Protocols directory.  The archive is now a menu item from the
top level directory which is called something like "Cypherpunks Gopher
Archive" I just mention this since I don't see any followups which mention
this.  But then I have very few messages from the list given I haven't
been able to check mail in a week and a half.

@_date: 1994-06-18 19:05:15
@_author: Karl Lui Barrus 
@_subject: MAIL: secure mail 
The problem may be this: pgp needs a path.
Try "| PGPPATH=/whatever pgp -feat ecarp | rmail erc%khijol
This is what I needed to do when I tried something similar with mh and slocal.
Karl Barrus

@_date: 1994-06-19 17:04:02
@_author: Karl Lui Barrus 
@_subject: MAIL: anon mailing list 
Well, Hal Finney offered a service by which people could subscribe to
an encrypted version of this list... which is something similar.
Say somebody wants to run a mailing list as you propose.  I think they
should just run the list at the same address unless the remailers can
suitably pad, delay, and randomize incoming messages and redirect them
to the true list site (but then delay and randomization may lead to
loss of coherency on the list ;).  If not, surely external observation
of the contact point will show where all the messages are headed.
The resources needed would be higher than a normal list since each
incoming message would need to be checked for a digital signature (or
the list could become victim to an anonymous mail bomber, and you
can't filter out anonymous remailers since of course everybody is
using them to submit posts!), encrypted to every other member, and
Which isn't to say impossible, just maybe impractical for a large
mailing list.  Take this list, with say 500 members - every incoming
post digitally signed and arriving via anonymous remailer, and upon
arrival, checked for a valid signature, encrypted with the public keys
of the pseudonyms subscribing to the list;), and remailed out...
This may work if you have a small group of people dedicated to this
setup, but otherwise, no go.  I mean, most people on this list don't
even sign their posts, most don't submit via anonymous remailer, etc.
It would take much work to make it convenient enough to do this.
I think a higher priority is finding the bug that keeps unsubscribing
everybody ;)
Karl Barrus

@_date: 1994-06-22 18:04:42
@_author: Karl Lui Barrus 
@_subject: MAIL: Using "nobody" 
Using "nobody" as a remailer is pretty interesting ;) the only problem
being you have to be root or be allowed to choose your own username.
I don't understand: why can't the somebody do a telnet to port 25 and
"vrfy nobody" to see if it points to /dev/null?  Or find out if mail
is piped to a script? Again, a pretty good suggestion, but I don't think most remailer
operators can do this even if they wanted to.  I know I couldn't have
with remailers I've run in the past.

@_date: 1994-06-28 15:51:35
@_author: Karl Lui Barrus 
@_subject: Re: Archives? 
Well, I keep a variety of old posts at chaos.bsu.edu, available via
gopher, in the "Cypherpunks gopher site" directory.  It isn't a full
archive of the list, but has some of the more interesting posts since
I joined the list (Oct. 1992).
I added about 15 more files over the weekend, and probably need to
re-organize the posts and directory structure soon ;)

@_date: 1994-06-30 17:41:33
@_author: Karl Lui Barrus 
@_subject: MAIL: chained remailing strategy 
Well, I don't run a remailer at the moment, but I can about ones I
used to run.
One I ran (elee9sf batched all incoming messages and
remailed them randomly at midnight.  So in some sense it didn't matter
when during the day mail arrived.  During its operation, the remailer
averaged about 15-20 messages a week, or about 2-3 a day (I don't
remember which days of the week if any were more popular).
Sometimes there were severe usage "spikes", when the remailer would
handle several times its average (once nearly 100 messages in a week,
and 20 in one day).  However, I feel that this was due to users
repeatedly submitting messages - perhaps testing the remailer -
without realizing the remailer only resent at midnight.
I don't know what loads remailers operated with, but more messages
circulating via anonymous remailer would definitely help.
Yes, the extra text is ignored.  In fact, the remailer implemented
this form of padding (however, it only padded messages shorter than 2K
out to 2K).  This isn't the best way to do padding since it is quite
obvious that it is in fact padding.  Hal Finney wrote some perl
scripts which pad inside the pgp message (add random text without
likewise updating the message length field; upon decryption the extra
text is throw away) and this is a better approach.
I think one thing that screws things up (Bill O'Hanlon pointed this
out months ago) is if somebody encrypts a message with the -m option
(for eyes only) - this causes the remailer to hang, waiting for
keyboard input.  I'm not sure if this problem is easily fixable on the
remailer side.
Run your own and use that one as the first link ;)
Hm... I guess exactly the way you describe, by going to each machine
and trying to piece together the remailing path, possibly with help
from the syslog file.
By disabling sendmail logging, if the remailer operator is able to.
(I wasn't able to on any of the remailers I ran).  Of course, other
forms of logging would need to be disabled as well.
Well, I'm not sure.  A few months ago, there was only one remailer
outside of the U.S. (in Canada,   However, now
there are several, in the Netherlands, and one in Italy (?).  I guess
it would depend on whether the chain includes out of the country
remailers, if each remailer keeps logs (including syslog which may or
may not be in control of the remailer operator).
All the same, I would recommend remailers block  :)
Karl Barrus

@_date: 1994-07-05 16:14:32
@_author: Karl Lui Barrus 
@_subject: GOPHER: AOL, CPSR, cypherpunks 
Earlier, somebody (I beleive Carl Ellison, but I screwed up and
deleted the file) asked about AOL and the gopher site.
The problem may not be AOL or CPSR actually.
What happened is this: Chael reorganized the gopher site, placing the
Cypherpunks Gopher Archive into a subdirectory.  So the archive is
still at chaos.bsu.edu, but no longer immediately at the top level.
Perhaps CPSR's pointer to the site is no longer valid!
Or maybe the problem is that he also upgraded to a new gopher server,
which is supposed to be backwards compatible ;) and one of these days
I'll create some sort of index files (?) to take advantage of the new
features, etc.  So maybe this is the problem, a new version that AOL
doesn't handle.
So try gopher'ing directly to chaos.bsu.edu and then into the
"Cypherpunks Gopher Archive" if going through somebody else isn't
Hm... I'll inform CPSR about the change.
Karl Barrus

@_date: 1994-07-05 16:25:22
@_author: Karl Lui Barrus 
@_subject: MD5: hashing, > 1->1 
Geez, I did it again (deleted the original message - the one Derek
So from memory, I beleive that in the context in which Derek was
describing the "finding two messages" above, his statement about the
difficulty (2^128) is correct.
The birthday paradox is the situation when you are looking for *any*
two messages that hash to the same value.  In this case, 2^64 is the
expected work.
However, if you are given a particular hash and you are looking for
another message which has the same hash, then the difficulty is 2^128.
This is the situation which is (more) important since it corresponds
to forging MD5 hashes for a signed message.  Say you are given a
message and you want to find another which has the same hash.  2^128
The birthday paradox situation corresponds to just finding two
messages with the same hash.  In this case the expected work is 2^64,
but then the two messages that you discover with the same hash may be
random (and thus worthless).
Karl Barrus

@_date: 1994-07-18 16:04:16
@_author: Karl Lui Barrus 
@_subject: Re: Card Playing Protocol 
Start out simple, just try something like a blackjack game (good
choice since the house strategy follows simple rules) over a
The house shuffles, bit commits to the shuffle, and sends you the
hash.  Then, you can begin playing, or you can try to break the system
by finding a deck with a matching hash.  After you are done, the
casino sends you the deck and you can verify that you weren't cheated.
All sorts of other stuff can be added later, like digital cash, etc.

@_date: 1994-08-11 18:46:21
@_author: Karl Lui Barrus 
@_subject: MAIL: future free remailers 
Interesting point... I guess that is a good reason why free anonymous
remailers might not ever die out, but pay remailers may be able to
offer enhanced features and services that would tend to attract the
vast majority of customers (assuming such a service would be
considered as valuable by enough people ;)
I mean, it is easy enough to run a remailer from a school account or
something like that, except you have little control: it may be
forbidden (here at Rice for example), you may be told to shut it down
(Netcom, U of Buffalo, U of Washington), you may have a disk quota
(previous remailer I ran which stored messages, mixed and sent them at
midnight) which would limit certain features, you may not be able to
use "cron" or "at", you may not be able to turn off sendmail logging,
you may not have the account for very long... you may want to offer
usenet posting but can't, you may be subject to various denial of
service attacks, you may want to name your remailer "nobody" but
can't, you may want to alter sendmail config files, etc.
And then maybe you'd like to experiment with something really
different, like running an fsp daemon and letting people fsp files to
you to be remailed.  Or something of this nature, which may require
leaving a program running all the time, listening to a port for
connections.  But maybe you can't do this either.
On the other hand, if you owned your own machine and net connection,
you are in a position to address all these concerns, and the people
who are concerned enough to seriously use anonymous remailers may be
willing to pay a postage fee.
Karl Barrus

@_date: 1994-08-12 20:45:21
@_author: Karl Lui Barrus 
@_subject: MAIL: commercial remailers 
But this assumes that commercial remailers will not take in enough
money to keep themselves afloat.  Which could very well be true!
What you describe is a serious problem indeed: in which only a "deep
pockets/government front/whatever" can run a pay remailer and most
free remailers exist on unsecure systems.
But this is the problem, if the remailer operator is just an ordinary
user, he/she may not even know their remailer is compromised, since
there is only so much an ordinary user can do.  You're trustworthy
friends may be victim of a sysadmin who does sendmail logging, etc.
Karl Barrus

@_date: 1994-08-26 15:37:09
@_author: Karl Lui Barrus 
@_subject: MATH: Brands cash, Hal's posts 
Cypherpunks, or maybe that's Atompunks,
Earlier, Hal posted several excellent messages concerning Brands' cash, and some introductory material.  I always find it useful to work through
various protocols by hand (well, with Mathematica), working with real numbers to help understand the protocol and how it works.  So like I did a long time ago when Hal posted a description of Chaumian cash, I will give an example of the protocols described.  I intend to follow along Hal's posts and work math as it comes up (and try to keep the notation consistent!).
I'll not be using numbers large enough to give actual security.
For folks with Mathematica, the functions of interest are PowerMod[a,b,c]
to calculate a^b mod c, and Mod[a,b] to calculate a mod b.
Hal's first post was introductory material on discrete logs:
* Generators
Finding a generator g is easy if you know the factorization of n-1.  You just
need to calculate g^((n-1)/q) mod n for all values of q, the prime factors of
n.  If any of the results are 1, then g is not a generator.
So say you want to see if 5 is a generator mod 2047.  The prime factors of n - 1 = 2046 are { 2, 3, 11, 31 }, so you calculate:
5 ^ (2046/2) mod 2047 = 1034
5 ^ (2046/3) mod 2047 = 622
5 ^ (2046/11) mod 2047 = 1435
5 ^ (2046/31) mod 2047 =  622
None of these turned out to equal 1, so 5 is a generator mod 2047.
* Diffie-Hellman key exchange
Let's use g = 10, and pick p = 17389.  10 is indeed a generator mod 17389.
Alice chooses x = 53, and calculates g^x mod p = 10^53 mod 17389
                                               = 9059
Bob chooses y = 4321 and calculates g^y mod p = 10^4321 mod 17389
                                              = 16077
They exchange, so Alice receives GY = 16077 and Bob receives GX = 9059
Alice calculates 16077^53 mod 17389 = 11643
Bob calculates 9059^4321 mod 17389 = 11643
Alice and Bob agree to the shared secret 11643.
* DH-based identification protocol
For this example, suppose we use g = 10, p = 17389 as above.  Also, Paul
chooses x = 555 to be his private key, therefore 10^555 mod 17389 = 11106
is his public key.
Vicki randomly chooses y = 1994, so she sends 10^1994 mod 17389 = 13848.
Paul calculates 13848^555 mod 17389 = 8324, and sends it back.
Vicki checks 11106^1994 mod 17389 = 8324.  This matches what Paul sent back.
* Schnorr identification protocol
Paul chooses w = 200, and sends 10^200 mod 17389 = 14097 to Vicki.
Vicki chooses c = 561 and sends this to Paul.
Paul calculates r = 561 * 555 + 200 = 311555.
Vicki checks: 10^315555 mod 17389 = 4594
      (11106^561) 14097 mod 17389 = ((11106^561 mod 17389) * 14097) mod 17389
                                  = 4594
* Chaum discrete log interactive signature protocol
Here, we'll pick m = 1040.  Thus, Paul can calculate MX = 1040^555 mod 17389
                                                        = 8608
As above, Paul chooses w = 200, so he sends GW = 14097 and MW = m^w mod p = 1040^200 mod 17389 = 472 to Vicki.
She chooses 561 again.
He calculates 311555 again.
Vicki checks g^r as above.  Now she also checks: m^r mod p = 1040^311555 mod 17389 = 13723
                     (MX^c)*MW = (8608^561)*472 mod 17389 = 13723
* Chaum discrete log signature protocol
Well, this is similar to the above protocol except a hash function is used.
I'll do something similar for Hal's other posts as time permits.
Karl Barrus

@_date: 1994-08-30 13:38:06
@_author: Karl Lui Barrus 
@_subject: Re: Knuth Volume 2 Page 379 
Heh, I thought this same thing a few months ago.  As it turns out,
Miller-Rabin and a modified Lucas test has already been coded up for
the next release of PGP.
I don't have a copy of this handy, or I'd tell you.  Basically,
Miller-Rabin is similar Fermat except you continue testing and divide
by two.  The quick, dirty, and ugly explanation ;)

@_date: 1994-09-10 12:20:49
@_author: Karl Lui Barrus 
@_subject: Re: Crypto Anarchist Manifesto (location) 
It is available via FTP at ftp.csua.berkeley.edu (I'm pretty sure this
is the new name of soda.berkeley.edu!) in pub/cypherpunks.
It is also available via gopher at chaos.bsu.edu in the Essays
subdirectory of the "Cypherpunks Archive Site" directory
(gopher://chaos.bsu.edu/Cypherpunks Archive Site/Essays/Cypherpunks Manifesto)
I guess it should be renamed it to "Crypto Anarchist Manifesto" ;)
It is probably elsewhere too; I'm currently reorganizing the gopher
site (still have to do "Anonymous Mail" and "Misc") and hope to finish
with adding extra material, including pointers to other the other
sites I know exist.

@_date: 1994-09-19 14:18:02
@_author: Karl Lui Barrus 
@_subject: Re: art encryption... 
Maybe I'm missing something, but why can't you just use the detached
signature option of pgp?  "pgp -sb file" will created a signature file
that is seperate from the document (named file.asc by default, I'm
pretty sure); later, the file and your public key can be used to
verify the signature!

@_date: 1994-09-19 19:53:14
@_author: Karl Lui Barrus 
@_subject: Re: (fwd) "Will You Be a Terrorist?" 
You can find this file at the gopher site (chaos.bsu.edu) in the Misc
directory, as "Sendmail and + in addressing".  Or something like that,
the Misc directory will be reorganized soon, and the file name may
Also, I split Tim's large FAQ into 20 chapters and placed it in
FAQs/Cypherpunks/Cyphernomicon, if that makes it easier for some
people to digest ;)

@_date: 1994-09-19 20:38:11
@_author: Karl Lui Barrus 
@_subject: REMAIL: scripts 
Recently, somebody mentioned writing scripts to assist in using the
remailers (I deleted the message and can't remember who it was).  I used to keep a remailer list, and generated simple unix Bourne shell
scripts and DOS batch files to do exactly this; however, I'm cleaning
up my account and now defer to superior products: (Matt Ghio's and
Raph Levien's remailer lists are better, and Hal Finney's chain
program is more functional than the scripts).
But, if they may be of some use to somebody, I just made available the
various PERL scripts, makefiles, etc. I once used to generate the
above mentioned scripts.  It is available via anonymous ftp at
chaos.bsu.edu in pub/cypherpunks/incoming as klb.scripts.tar.gz.  The
remailer data file included is fairly old and will need updating if
somebody wants to toy with the scripts, etc.

@_date: 1994-09-21 11:27:49
@_author: Karl Lui Barrus 
@_subject: META: Tim's FAQ, ftp to chaos 
Sure thing, you're welcome!  I'll try to keep on top of future
versions as well.
About retreiving the gopher files via ftp: I'm not sure it is set up
for that yet.  Chael has put in quite a bit of work over the summer,
including updating gopher daemon, and he did mention he would like to
make the heirarchy available via anonymous ftp, or perhaps move the
gopher directory (currently a subdirectory of my home) into the
anonymous ftp area.  However, I'm not sure if this has been done yet,
or is doable, etc.
If there is sufficient interest though, I could place the chapters of the
FAQ into the cypherpunks/incoming directory for the time being.

@_date: 1994-09-21 11:51:55
@_author: Karl Lui Barrus 
@_subject: MAIL: crime and remailers 
Intellectual property rights, export status and all that aside, as a
once (and hopefully future) remailer operator, I am curious and
concerned for the remailer operator in this case.
I see that RSADSI contacted Mr. Perry's employer (jpunix consultants
here in Houston?) and the remailer is "temporarily" shut down.  This
investigation could go a long ways into answering (maybe unfavorably)
several legal matters, such as the seizure of sendmail logs, from
multiple machines if chained.  Will the FBI get cooperation from a
foreign law enforcement if a foriegn remailer was used?  If the mail
was chained through several remailers, will legal action be taken
against each one?
Then there's the liability of the remailer operator, the company who
owned the machine, etc.  Will RSA pursue action against these people?
Can they?  I'm not advocating illegal remailer usage, but I certainly
don't want to see John Perry become the focus of lawsuits as the most
visible target.
John Perry mentioned he was almost fired, except the CEO of JPUnix is
open minded.  Thankfully, I can imagine other organizations wouldn't
have hesitated in firing him.

@_date: 1994-09-21 13:53:10
@_author: Matthew J Ghio 
@_subject: Re: MAIL: crime and remailers 
The remailer is back up.
I don't know if it's really my place to comment here, but I would like
to clear up the misconceptions.  Someone from RSA (probably Bidzos)
contacted Perspective Scientific (persci.com), a company which hired
John Perry to install and maintain their network.  Since Mr. Perry was
not in at the time, they demanded to speak to the CEO.  The caller then
proceeded to tell him that Persci's computers were being used to
distribute proprietary, copyrighted encryption software on the internet.
 This claim is false, and I assume that the caller knew it was false but
made it anyway.  Jpunix.com is John Perry's personal computer at his
home.  The caller could have gotten his home number from the whois
record and called him personally; there was absolutely no reason for
them to call his employer.  RSA called PerSci for no other reason than
to harass John Perry and attempt to get him in trouble at work.  This is
not the first time they have done this type of thing (and based on the
various lawsuits against them, it would seem they consider it standard
procedure).  Fortunately, the CEO of Persci was open-minded enough to
realise that RSA's complaint had nothing to do with Perspective
Scientific, and dropped the issue there.  Failing that, there isn't much
else RSA can do to harass Mr. Perry, and they seem to have given up for

@_date: 1994-09-21 20:55:43
@_author: Karl Lui Barrus 
@_subject: META: gopher site 
Here is what Chael sent me (I have a feeling he meant to copy the list
as well):

@_date: 1994-09-22 17:54:28
@_author: Karl Lui Barrus 
@_subject: MATH: Brands' cash, Hal's post #2 
This post gives numerical examples to go along with Hal Finney's excellent
description of Brands' digital cash, posted earlier.  If the math is too
much, just remember the whole point:
Continuing along:
I will use g = 10, n = 17389 as in the previous example.  Paul will choose x = 351 to be his secret key, so GX = 10^351 mod 17389 = 16987 is his public key.  In addition, the message is m = 1994.
Paul chooses a random w = 666
MX = 1994^351 mod 17389 = 11740
GW = 10^666 mod 17389 = 7115
MW = 1994^666 mod 17389 = 13262
Vicki chooses s = 3694, t = 1243
m' = (1994^3694)*(10^1243) mod 17389 = 10313
Vicki chooses u = 5192, v = 100
MX' = (MX^s)*(GX^t) = (11740^3694)*(16987^1243) mod 17389 = 10710
GW' = (GW^u)*(g^v) = (7115^5192)*(10^100) mod 17389 = 12113
MW' = (7115^(5192 1243))*(11740^(5192 3694))*(10313^100) mod 17389 = 9314
c' = hash(10313,10710,12113,9314) = 7672 (some hash function I made up)
c = (7672/5192) mod 17389 = 323
[     5192 c = 7672 mod 17389    --> 5192 c" = 1 mod 17389   --> c" = 3520
  check: (323 5192) mod 17389 = 7672
r = (323 351 + 666) mod 17388 = 9711
r' = (5192 9711 + 100) mod 17388 = 11800
So the resulting signature is (10710,12113,9314,11800)
Okay, that should be an actual example of the protocol, unless I messed up somewhere ;)  I hope to finish going through Hal's third post soon.
Karl Barrus

@_date: 1994-09-26 16:48:55
@_author: Karl Lui Barrus 
@_subject: CASH: Lone Star Cards 
The State of Texas rolled out a new cash card today (at a demo, the
real rollout is Oct. 1), intended to replace food stamps over within
two years.  This card is to be used like bank ATM card, so none of the
parties are private, and thus this isn't digital cash in the
strong crypto/cypherpunks sense.
A user swipes the card at a grocery store and then enters a PIN, which
causes a transfer of funds from the Department of Human Services (or
something like that) to the store.  The Comptroller states that this
system will lower costs through reduced paperwork and reduced fraud.
Who knows, perhaps the checkout scanner logs can be sold for a profit
to various companies too!  ;)
Anyway, just thought I'd mention it - this fits in with various
predictions by Tim that an outright ban on cash will begin with steps
like this.

@_date: 1994-11-17 14:31:42
@_author: Karl Lui Barrus 
@_subject: re: changes to remailer@jpunix.com 
I read about some changes that John Perry made to his remailer, since
it is being abused.  (Sorry to hear it!)
I thought he said he is doing source blocking (I deleted the message
and can't check.)  Is this true?  Were there no hops between the
abuser and the remailer?  How can you prevent the abuser from just
chaining through different paths to reach your remailer and continuing
to use it?  Or am I remembering incorrectly ;)
Random Factor suggested (among other things)
Requiring encryption is OK, as long as you don't require the remailing
header and message body to be encrypted together.  If you do, like the
extropia remailer does, then you can't form reply blocks that include
such a remailer (since the reply block is created by a sender who
obviously doesn't have the message body that his recipient will use
the reply block to respond to).

@_date: 1994-12-11 11:03:22
@_author: Karl Lui Barrus 
@_subject: Re: "Crypto Anarchy and Virtual Communities" 
I have managed to obtain this file, and have placed at the gopher
Now, chaos.bsu.edu has recently moved to chaos.taylored.com, which is
still a "host unknown" for me.  But, using its ip address works just
fine "gopher 204.95.228.28".  Actually, "gopher chaos.bsu.edu" still
works for me, but this is supposed to change by January...
Anyway, the file in the Essays directory as "Crypto Anarchy and
Virtual Communities".
One (or more) of the following should work:
gopher://chaos.taylored.com/Cypherpunks Gopher Server/
gopher://204.95.228.28/Cypherpunks Gopher Server/
gopher://chaos.bsu.edu/Cypherpunks Gopher Server/
and then look in
Essays/Crypto Anarchy and Virtual Communities

@_date: 1994-12-13 11:04:12
@_author: Karl Lui Barrus 
@_subject: Re: What, exactly is elliptic encryption? 
Well, some other have already described it.  I'll list some references
I've found:
A Course in Number Theory and Cryptography, 2nd edition, Neal Koblitz,
Springer-Verlag.  Chapter 6 is titled "Elliptic Curves" and is split
into four parts: basics, cryptosystems, factorization, primality
Elliptic Curve Public Key Cryptosystems, Alfred Menezes, Kluwer
Academic Publishers.  Haven't had a chance to read this book yet.
Looks pretty good though :)
Algorithms for Modular Elliptic Curves, J. E. Cremona, Cambridge
University Press.  Found this book last week, along with the above
mentioned Menezes book.  Likewise, I haven't had a chance to read it
yet.  It is divided into three parts: description of contructing
elliptic curves, a collection of algorithms, a huge list of tables.
The algorithms are either in Fortran or in pseudocode (unless the
Fortran used allows semicolons and the sh-like FI keyword).
Yeah, for a while a friend and I tried getting that to work, but we
were never successful.  Then, in an version upgrade, the encryption
disappeared ;)

@_date: 1995-01-26 07:42:20
@_author: Karl Lui Barrus 
@_subject: Re: Starting a remailer 
If you are thinking of setting up a remailer on a general usage type
unix shell account, then first find out if the usage policy allows you
to run one (for example, remailer are forbidden here at Rice).
Actually, I would recommend asking first, to head off future
headaches, as I can think at least two other (former) remailers run at
.edu sites that were forced to close.
Other than that, try to find out if sendmail logs are kept, especially
if they are world readable (this will reduce the security of the
remailer, but you won't be able to anything about it anyway).
The software is easily available, installation isn't hard (you have to
install PGP as well).  Maintenance isn't much unless you expirement
around.  I would recommend blocking anonymous mail to whitehouse.gov
and other similar addresses.
I don't know about problems; I never had any, but these days it seems
more and more people are finding out about remailer, and with that
comes abusers.  John Perry had to shut down because of abuse, after
withstanding the RC4 posting crisis.  Be prepared for some hassles.
Actually, I would recommend finding a remailer-friendly site like
c2.org and setting up there.
