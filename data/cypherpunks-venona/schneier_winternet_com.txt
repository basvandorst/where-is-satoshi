
@_date: 1995-07-27 06:30:03
@_author: Bruce Schneier 
@_subject: Crypto: ride from SF on Saturday 
Is anyone driving from the SF area to Crypto (in Santa Barbara) on Saturday?
If so, I would like a ride.
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier

@_date: 1995-08-23 03:28:04
@_author: Bruce Schneier 
@_subject: Applied Cryptography, Second Edition 
The second edition to APPLIED CRYPTOGRAPHY will be published in November.
This is not just a correction, it is a major update.  There are 50% more
words in the second edition.
The second edition will be published in both hardback and paperback.  Wiley
is jacking the price a bit, so I am offering a 15% pre-publication discount.
Details will be forthcoming when I invent them.
Attached is the table of contents.
APPLIED CRYPTOGRAPHY - SECOND EDITION    by  Bruce Schneier
Forward by Whitfield Diffie
Chapter 1:  Foundations
          Terminology; Steganography; Substitution Ciphers and
          Transposition Ciphers; Simple XOR; One-Time Pads; Computer
          Algorithms; Large Numbers
Part I:  Cryptographic Protocols
Chapter 2:  Protocol Building Blocks
          Introduction to Protocols; Communications using Symmetric
          Cryptography; One-Way Functions; One-Way Hash Functions;
          Communications using Public-Key Cryptography; Digital
          Signatures; Digital Signatures with Encryption; Random and
          Pseudo-Random Sequence Generation
Chapter 3:  Basic Protocols
          Key Exchange; Authentication; Authentication and Key
          Exchange; Formal Analysis of Authentication and Key-Exchange
          Protocols; Multiple-Key Public-Key Cryptography; Secret
          Splitting; Secret Sharing; Cryptographic Protection of
          Databases
Chapter 4:  Intermediate Protocols
          Timestamping Services; Subliminal Channel; Undeniable
          Digital Signatures; Designated Confirmer Signatures; Proxy
          Signatures; Group Signatures; Fail-Stop Digital Signatures;
          Computing with Encrypted Data; Bit Commitment; Fair Coin
          Flips; Mental Poker; One-Way Accumulators; All-or-Nothing
          Disclosure of Secrets; Key Escrow
Chapter 5:  Advanced Protocols
          Zero-Knowledge Proofs; Zero-Knowledge Proofs of Identity;
          Blind Signatures; Identity-Based Public-Key Cryptography;
          Oblivious Transfer; Oblivious Signatures; Simultaneous
          Contract Signing; Digital Certified Mail; Simultaneous
          Exchange of Secrets
Chapter 6:  Esoteric Protocols
          Secure Elections; Secure Multiparty Computation; Anonymous
          Message Broadcast; Digital Cash
Part II:  Cryptographic Techniques
Chapter 7:  Key Length
          Symmetric Key Length; Public-Key Key Length; Comparing
          Symmetric and Public-Key Key Length; Birthday Attacks
          against One-Way Hash Functions; How Long Should a Key Be?;
          Caveat Emptor
Chapter 8:  Key Management
          Generating Keys; Nonlinear Keyspaces; Transferring Keys;
          Verifying Keys; Using Keys; Updating Keys; Storing Keys;
          Backup Keys; Compromised Keys; Lifetime of Keys; Destroying
          Keys; Public-Key Key Management
Chapter 9:  Algorithm Types and Modes
          Electronic Codebook Mode; Block Replay; Cipher Block
          Chaining Mode; Stream Ciphers; Self-Synchronizing Stream
          Ciphers; Cipher-Feedback Mode; Synchronous Stream Ciphers;
          Output-Feedback Mode; Counter Mode; Other Block-Cipher
          Modes; Choosing a Cipher Mode; Interleaving; Block Ciphers
          vs. Stream Ciphers
Chapter 10:  Using Algorithms
          Choosing an Algorithm; Public-Key Cryptography vs. Symmetric
          Cryptography; Encrypting Communications Channels; Encrypting
          Data for Storage; Hardware Encryption vs. Software
          Encryption; Compression, Encoding, and Encryption; Detecting
          Encryption; Hiding Ciphertext in Ciphertext; Destroying
          Information
Part III:  Cryptographic Algorithms
Chapter 11:  Mathematical Background
          Information Theory; Complexity Theory; Number Theory;
          Factoring; Prime Number Generation; Discrete Logarithms in a
          Finite Field
Chapter 12:  Data Encryption Standard
          Background; Description of DES; Security of DES;           Differential and Linear Cryptanalysis; The Real Design
          Criteria; DES Variants; How Secure is DES Today?
Chapter 13:  Other Block Algorithms
          Lucifer; Madryga; NewDES; FEAL-N; REDOC; Loki; Khufu and
          Khafre; RC2; IDEA; MMB; CA-1.1; Skipjack
Chapter 14:  Still Other Block Algorithms
          GOST; CAST; Blowfish; SAFER K-64; 3-Way; Crab; SXAL8/MBAL;
          RC5; Other Block Algorithms; Theory of Block Cipher Design;
          Using One-Way Hash Functions; Choosing a Block Algorithm
Chapter 15:  Combining Block Algorithms
          Double Encryption; Triple Encryption; Doubling the Block
          Length; Other Multiple Encryption Schemes; CDMF Key
          Shortening; Whitening; Cascading Multiple Block Algorithms;
          Combining Multiple Block Algorithms
Chapter 16:  Pseudo-Random-Sequence Generators and Stream Ciphers
          Linear Congruential Generators; Linear Feedback Shift
          Registers; LFSRs in Software; Design and Analysis of Stream
          Ciphers; Stream Ciphers using LFSRs; A5; Hughes XPD/KPD;
          Nanoteq; Rambutan; Additive Generators; Gifford; Algorithm
          M; PKZIP
Chapter 17:  Other Stream Ciphers and Real Random-Sequence Generators
          RC4; SEAL; Wake; Feedback with Carry Shift Registers; Stream
          Ciphers using FCSRs; Nonlinear Feedback Shift Registers;           Other Stream Ciphers; System-Theoretic Approach to Stream
          Cipher Design; Complexity-Theoretic Approach to Stream
          Cipher Design; Other Approaches to Stream Cipher Design;
          Cascading Multiple Stream Ciphers;  Choosing a Stream
          Cipher; Generating Multiple Streams from a Single Pseudo-
          Random Sequence Generator; Real Random-Sequence Generators
Chapter 18:  One-Way Hash Functions
          Background; Snefru; N-HASH; MD4; MD5; MD2; Secure Hash
          Algorithm (SHA); RIPE-MD; Haval; Other One-Way Hash
          Functions; One-Way Hash Functions using Symmetric Block
          Algorithms; Using Public-key Algorithms; Choosing a One-Way
          Hash Function; Message Authentication Codes
Chapter 19:  Public-Key Algorithms
          Background; Knapsack Algorithms; RSA; Pohlig-Hellman; Rabin;
          ElGamal; McEliece; Elliptic Curve Cryptosystems; LUC; Finite
          Automaton Public-Key Cryptosystems
Chapter 20:  Public-Key Digital Signature Algorithms
          Digital Signature Algorithm (DSA); DSA Variants; GOST
          Digital Signature Algorithm; Discrete Logarithm Signature
          Schemes; Ong-Schnorr-Shamir; ESIGN; Cellular Automata; Other
          Public-Key Algorithms
Chapter 21:  Identification Schemes
          Feige-Fiat-Shamir; Guillou-Quisquater; Schnorr; Converting
          Identification Schemes to Signature Schemes
Chapter 22:  Key-Exchange Algorithms
          Diffie-Hellman; Station-to-Station Protocol; Shamir's Three-
          Pass Protocol; COMSET; Encrypted Key Exchange; Fortified Key
          Negotiation; Conference Key Distribution and Secret
          Broadcasting
Chapter 23:  Special Algorithms for Protocols
          Multiple-Key Public-Key Cryptography; Secret Sharing
          Algorithms; Subliminal Channel; Undeniable Digital
          Signatures; Designated Confirmer Signatures; Computing with
          Encrypted Data; Fair Coin Flips; One-Way Accumulators; All-
          or-Nothing Disclosure of Secrets; Fair and Failsafe
          Cryptosystems; Zero-Knowledge Proofs of Knowledge; Blind
          Signatures; Oblivious Transfer; Secure Multiparty
          Computation; Probabilistic Encryption; Quantum Cryptography
Part IV:  The Real World
Chapter 24:  Example Implementations
          IBM Secret-Key Management Protocol; Mitrenet; ISDN; STU-III;
          Kerberos; KryptoKnight; Sesame; IBM Common Cryptographic
          Architecture; ISO Authentication Framework; Privacy-Enhanced
          Mail (PEM); Message Security Protocol; Pretty Good Privacy
          (PGP); Smart Cards; Public-Key Cryptography Standards;
          Universal Electronic Payment System; Clipper; Capstone; AT&T
          Model 3600 Telephone Security Device
Chapter 25:  Politics
          National Security Agency; National Computer Security Center;
          National Institute of Standards and Technology; RSA Data
          Security, Inc.; Public Key Partners; International
          Association for Cryptologic Research; RACE Integrity
          Primitives Evaluation; Conditional Access for Europe;
          ISO/IEC 9979; Professional, Civil Liberties, and Industry
          Groups; Sci.Crypt; Cypherpunks; Patents; U.S. Export Rules;
          Foreign Import and Export of Cryptography; Legal Issues
Afterward by Matt Blaze
Source Code
          DES; LOKI91; IDEA; GOST; Blowfish; 3-Way; RC5; A5; SEAL;
          WAKE

@_date: 1995-09-06 07:09:33
@_author: Bruce Schneier 
@_subject: the S-1 Algorithm 
[I just posted this to sci.crypt.  I don't normally read Cypherpunks, so
please forward any substantive replies directly to me.  Thanks.  -Bruce]
I was in Europe while S-1 was posted, so I missed most of the
discussion.  Better late than never....
Over the last year, I have spent considerable effort collecting
SKIPJACK information.  I have gone through the published
literature, the rumors, and a large stack of documents received
by EPIC through Freedom of Information Act (FOIA) lawsuits.
At Crypto last week I gave a Rump Session talk entitled "Reverse
Engineering SKIPJACK from Open Sources."  I prepared the slides
before I left for Europe.  Here is what I said:
     What the government told us:
          Single-key block cipher.
          Can be used in ECB, CBC, CFB, or OFB.
          64-bit block size.
          80-bit key size.
     What the review committee told us:
          32 rounds.
          No weak keys (like DES has).
          No key complementation property (like DES has).
     What the hardware specifications tell us:
          The latency of the Mykotronx chip has 64 clock cycles.                This means two clock cycles per round.
     Assorted rumors (excuse me if I don't reveal sources):
          SKIPJACK does not have rounds in the same sense that
               DES does: i.e., half of the text block is not
               encrypted in each round.
          SKIPJACK has half the total S-box data as DES.
          SKIPJACK has a 48-bit internal structure analogous to a
               32-bit internal structure in DES.
          The masks for the Clipper/Capstone chip are
               unclassified and the chips can be produced in an
               unclassified foundry.  Part of the programming in
               the secure vault includes installing part of the
               SKIPJACK algorithm.  The part of the algorithm
               installed in the secure vault are the "S-tables",
               suggesting that perhaps unprogrammed Clipper chips
               can be programmed to implement other 80-bit key,
               32 round ciphers.
Trying to puzzle out the meaning of the third rumor, Matt Blaze
and I invented something called an Unbalanced Feistel Network. These are Feistel networks where the source and target blocks are
of different size.  For example, in each round 48 bits might be
used as an input into the F function, and produce 16 output bits
to be XORed with the remainder of the bits.  We called this a
48:16 UFN, and we proposed a design at last year's Algorithms
Workshop in Leuven.  Our design was broken, but I am still
examining the structure.  A 48:16 UFN satisfies the first and
third rumor above, and I think it as good a guess as any
regarding SKIPJACK.
A few months ago, I found some additional information in the form
of documents released under FOIA.  One document was a Mykotronx
design review for "Project Capstone" dated 10 December 1991.  The
design review was unclassified.  Among the details about the
modular multipliers and the SHA code was the following page about
     ECB Processing Rate
          2 clocks per G-Box operation
          x 1 G-box per shift
          x 32 shifts per ECB encryption
          ______________________________
          64 clocks per ECB
     64 clocks per ECB / 64 bits out per ECB = 1 clock per bit
     Yields 40 Mbit encryption using a 40 MHz clock.
The only other thing I found was a SECRET memo.  The organization
name (either from or to) is blacked out.  The date is 25 August
1992.  The subject is "SKIPJACK Revision."  Paragraph 2 is
blacked out, but paragraph 1 reads:
     1.  (U) The enclosed Informal Technical Report revises the
     F-table in SKIPJACK 3.  No other aspect of the algorithm is
     changed.
That's it.  Rounds are called "shifts," which seems to indicate
that they are not "rounds" in the DES sense.  A shift consists of
a "G-box" operation, which includes not only what we call the F-
F-function but the XOR as well.  And there is something called an
F-table, which could be a table of constants or perhaps a table
of functions.  In any case, it is something that can be revised
without changing the rest of the algorithm.
Now let's look at S-1.  The most probable explanation is that it
is a hoax.  But it is a very good hoax:
     The hoaxer knew enough about algorithm design to make a
          cipher that was not obviously lousy, while at the same
          time not unduly complicated.  The hoaxer knew enough to
          make a design that included three novel ideas not seen
          anywhere else: S-boxes that are created according to no
          known criteria, a G-table that chooses a rotation of
          S-boxes to use in a given round, and a bizarre key
          schedule.
     The hoaxer knew enough about how algorithms are used in the
          military to make a spookish interface.  I am
          particularly interested in the "zeroize" function, the
          separation of the key creation and key loading
          functions, and the key masking.  Blaze said that the
          interface was similar to the Fortezza interface, but
          not the same.
     The hoaxer knew about Blaze's and my MacGuffin paper and
          that we thought SKIPJACK was a 48:16 UFN.  We made no
          secret about this, and our paper is on Blaze's web
          page.  The hoaxer knew to use the term F-table.  I
          haven't shown many people what I found in EPIC's
          documents, so the hoaxer either had to look through
          them himself or get them by some other means (maybe an
          independent FOIA request).
It's not a perfect hoax, though.  The classification markings
look odd: NSA algorithms are SECRET, not TOP SECRET, and the
codeword restriction sentence is strange.  The key schedule is
hopelessly flawed (David Wagner posted an attack to sci.crypt). The coding style is amateurish, like it was translated from one
language to another.  (Maybe this is clever on the hoaxer's
part.)  And there's even a typo in the code.
And maybe the hardware latency is wrong.  Clearly the design
facilitates parallelization.  You can precompute all possible F-
table outputs in previous shifts, and then use the G-table result
to select between them; I am not sure you can get a shift down to
two clock cycles.  I don't have the hardware background, and
would appreciate comments from others.
And why are there not bitwise permutations?  If SKIPJACK is
designed for hardware, it makes sense to put them in.  They're
free, after all.
Anyway, it's a real good hoax.  Blaze estimated that he could
have done it, but it would have taken him a month of effort.  I
agree with his assessment: one man-month.  It's a lot of time to
spend on a hoax, especially one where the hoaxer doesn't get any
So, maybe it's SKIPJACK.  It has a 64-bit block size and an 80-
bit key size.  It's a 48:16 UFN with 32 rounds (or shifts, or
whatever).  And it has an F-table.  This is really interesting,
because the structure really is an S-box.  Everyone knows it's an
S-box, and it makes no sense for a hoaxer to call it something
else.  But in S-1 it's called an F-table.  (I think this is very
significant, but others find it less convincing.)
And the F-table has been revised at least once.  In the code it
says that the F-table entries "differ in the S-2 version."  The
code is dated 1 February 1989 and 31 July 1991, and I have a memo
dated 25 August 1992 that says the F-table has been revised in
"SKIPJACK 3."  Pretty convincing, I think.  (Of course this means
that we can't confirm anything by testing the hardware, since the
F-table entries are different.)
Maybe there are no bit permutations because they make analysis
harder, and perhaps they don't add all that much.  Maybe the
algorithm was designed for both hardware and software, or maybe
it was designed for specialized cryptographic hardware with
several parallel microprocessors and some cryptographic
primitives. If it is real, we have a lot to learn about S-box design.  The S-
boxes are not even balanced.  Maybe they are created just so to
avoid some bizarre attack we can only dream about, but I kind of
doubt it.
But the key schedule is just plain wrong.
So, here's a theory.  Let's assume the code is real.  (Not that
it's SKIPJACK, but that it's a real algorithm from some military
or some corporation.)  Clearly the code is not designed to test
the cryptographic algorithm, but to simulate some kind of
hardware interface: it's called a "software chip simulator."  If
I were the NSA and I designed an algorithm whose security rested
on some tables of constants, I might replace them with phony
constants before giving them to another organization to test.  I
might call the phony version S-1 and the real version S-2.
Maybe the code was originally written in FORTRAN, and then
translated into C.  (NSA doesn't use ADA.)
NSA algorithms are classified SECRET, put perhaps algorithms in
development are classified TOP SECRET.  (We know cryptanalytic
techniques can be TOP SECRET, so perhaps commented code falls
under that category as well.)
And maybe the code originally didn't have an 80-bit key schedule.
Maybe it had a longer key schedule.  The poster then modified
this key schedule to make it look more like SKIPJACK.  (This
might also explain the bug in the code, which might not be a bug
if it still had the original key schedule.)
Which leaves us precisely nowhere.  The most likely explanation
is that it is a hoax, but I am hard-pressed to imagine a hoaxer
with the requisite combination of skills, resources, and
attitude.  I also don't believe that it is SKIPJACK.  It might be
a preliminary design for SKIPJACK, but if both the key schedule
and F-table entries are wrong, we really haven't learned
anything.  If we suddenly discovered that unbalanced S-boxes are
far superior to balanced ones, then all best are off.
* Bruce Schneier            2,000,000,000,000,000,000,000,000,002,000,
* Counterpane Systems       000,000,000,000,000,000,002,000,000,002,293 * schneier  The last prime number...alphabetically!
* (708) 524-9461            Two vigintillion, two undecillion, two * 730 Fair Oaks Ave.        trillion, two thousand, two hundred and * Oak Park, IL  60302       ninety three.

@_date: 1995-09-15 11:07:30
@_author: Bruce Schneier 
@_subject: Applied Cryptography, Second Edition:  Ordering Information 
The SECOND EDITION of APPLIED CRYPTOGRAPHY is coming in November. This is a major rewrite: 50% more words, 7 more chapters, and
over 1600 references.  Not only did I make corrections to the
first edition and add developments since it was published, but I
also included topics left out of the first edition.  (See table
of contents--attached.)
The second edition has lots of new algorithms (including GOST,
Blowfish, RC4, and A5), more information on the Clipper Chip and
key escrow, dozens of new protocols, more information on how PGP
works, detailed information on key management and modes of
operation, and new source code.
The second edition will be published in paperback and hardcover. Right now I am making both available at a 15% discount.
                          ORDER FORM
Applied Cryptography, 2nd Edition (Hardcover): $70 * .85 = $59.00
Applied Cryptography, 2nd Edition (Softcover): $50 * .85 = $42.00
          Shipping:
                    Air (U.S.):       $5 per book
                    Surface (U.S.):   $3 per book
                    Canada/Mexico:    $7 per book
                    Everywhere else:  $9 per book
Send to:
          Counterpane Systems, 101 E Minnehaha Parkway,
                    Minneapolis, MN  55419
              APPLIED CRYPTOGRAPHY, SECOND EDITION
                       Table of Contents
((Sections in all capitals are either new or substantially
Forward by Whitfield Diffie
Chapter 1:  Foundations
          Terminology; STEGANOGRAPHY; Substitution Ciphers and
          Transposition Ciphers; Simple XOR; One-Time Pads; Computer
          Algorithms; Large Numbers
Part I:  Cryptographic Protocols
Chapter 2:  Protocol Building Blocks
          Introduction to Protocols; Communications using Symmetric
          Cryptography; One-Way Functions; One-Way Hash Functions;
          Communications using Public-Key Cryptography; Digital
          Signatures; Digital Signatures with Encryption; Random and
          Pseudo-Random Sequence Generation
Chapter 3:  Basic Protocols
          Key Exchange; Authentication; AUTHENTICATION AND KEY
          EXCHANGE; FORMAL ANALYSIS OF AUTHENTICATION AND KEY-EXCHANGE
          PROTOCOLS; Multiple-Key Public-Key Cryptography; Secret
          Splitting; Secret Sharing; Cryptographic Protection of
          Databases
Chapter 4:  Intermediate Protocols
          Timestamping Services; Subliminal Channel; Undeniable
          Digital Signatures; DESIGNATED CONFIRMER SIGNATURES; PROXY
          SIGNATURES; Group Signatures; Fail-Stop Digital Signatures;
          Computing with Encrypted Data; Bit Commitment; Fair Coin
          Flips; Mental Poker; ONE-WAY ACCUMULATORS; All-or-Nothing
          Disclosure of Secrets; KEY ESCROW
Chapter 5:  Advanced Protocols
          ZERO-KNOWLEDGE PROOFS; Zero-Knowledge Proofs of Identity;
          Blind Signatures; IDENTITY-BASED PUBLIC-KEY CRYPTOGRAPHY;
          Oblivious Transfer; OBLIVIOUS SIGNATURES; Simultaneous
          Contract Signing; Digital Certified Mail; Simultaneous
          Exchange of Secrets
Chapter 6:  Esoteric Protocols
          SECURE ELECTIONS; Secure Multiparty Computation; Anonymous
          Message Broadcast; DIGITAL CASH
Part II:  Cryptographic Techniques
Chapter 7:  Key Length
          SYMMETRIC KEY LENGTH; PUBLIC-KEY KEY LENGTH; COMPARING
          SYMMETRIC AND PUBLIC-KEY KEY LENGTH; BIRTHDAY ATTACKS
          AGAINST ONE-WAY HASH FUNCTIONS; How Long Should a Key Be?;
          Caveat Emptor
Chapter 8:  Key Management
          Generating Keys; NONLINEAR KEYSPACES; Transferring Keys;
          Verifying Keys; Using Keys; UPDATING KEYS; Storing Keys;
          Backup Keys; Compromised Keys; Lifetime of Keys; Destroying
          Keys; Public-Key Key Management
Chapter 9:  Algorithm Types and Modes
          Electronic Codebook Mode; Block Replay; Cipher Block
          Chaining Mode; Stream Ciphers; Self-Synchronizing Stream
          Ciphers; Cipher-Feedback Mode; Synchronous Stream Ciphers;
          Output-Feedback Mode; Counter Mode; Other Block-Cipher
          Modes; CHOOSING A CIPHER MODE; INTERLEAVING; Block Ciphers
          vs. Stream Ciphers
Chapter 10:  Using Algorithms
          Choosing an Algorithm; Public-Key Cryptography vs. Symmetric
          Cryptography; Encrypting Communications Channels; ENCRYPTING
          DATA FOR STORAGE; Hardware Encryption vs. Software
          Encryption; COMPRESSION, ENCODING, AND ENCRYPTION; DETECTING
          ENCRYPTION; HIDING CIPHERTEXT IN CIPHERTEXT; DESTROYING
          INFORMATION
Part III:  Cryptographic Algorithms
Chapter 11:  Mathematical Background
          Information Theory; Complexity Theory; NUMBER THEORY;
          FACTORING; Prime Number Generation; Discrete Logarithms in a
          Finite Field
Chapter 12:  Data Encryption Standard
          Background; Description of DES; Security of DES;           DIFFERENTIAL AND LINEAR CRYPTANALYSIS; THE REAL DESIGN
          CRITERIA; DES VARIANTS; HOW SECURE IS DES TODAY?
Chapter 13:  Other Block Algorithms
          Lucifer; Madryga; Newdes; Feal-N; Redoc; LOKI; Khufu and
          Khafre; RC2; Idea; Mmb; CA-1.1; SKIPJACK
Chapter 14:  Still Other Block Algorithms
          GOST; CAST; BLOWFISH; SAFER K-64; 3-WAY; CRAB; SXAL8/MBAL;
          RC5; OTHER BLOCK ALGORITHMS; THEORY OF BLOCK CIPHER DESIGN;
          USING ONE-WAY HASH FUNCTIONS; CHOOSING A BLOCK ALGORITHM
Chapter 15:  Combining Block Algorithms
          DOUBLE ENCRYPTION; TRIPLE ENCRYPTION; DOUBLING THE BLOCK
          LENGTH; OTHER MULTIPLE ENCRYPTION SCHEMES; CDMF KEY
          SHORTENING; WHITENING; CASCADING MULTIPLE BLOCK ALGORITHMS;
          COMBINING MULTIPLE BLOCK ALGORITHMS
Chapter 16:  Pseudo-Random-Sequence Generators and Stream Ciphers
          Linear Congruential Generators; Linear Feedback Shift
          Registers; LFSRs in Software; DESIGN AND ANALYSIS OF STREAM
          CIPHERS; Stream Ciphers using LFSRs; A5; HUGHES XPD/KPD;
          NANOTEQ; RAMBUTAN; ADDITIVE GENERATORS; GIFFORD; ALGORITHM
          M; PKZIP
Chapter 17:  Other Stream Ciphers and Real Random-Sequence Generators
          RC4; SEAL; WAKE; FEEDBACK WITH CARRY SHIFT REGISTERS; STREAM
          CIPHERS USING FCSRS; NONLINEAR FEEDBACK SHIFT REGISTERS;           Other Stream Ciphers; System-Theoretic Approach to Stream
          Cipher Design; Complexity-Theoretic Approach to Stream
          Cipher Design; Other Approaches to Stream Cipher Design;
          CASCADING MULTIPLE STREAM CIPHERS;  CHOOSING A STREAM
          CIPHER; GENERATING MULTIPLE STREAMS FROM A SINGLE PSEUDO-
          RANDOM SEQUENCE GENERATOR; REAL RANDOM-SEQUENCE GENERATORS
Chapter 18:  One-Way Hash Functions
          Background; Snefru; N-HASH; MD4; MD5; MD2; Secure Hash
          Algorithm (SHA); RIPE-MD; Haval; Other One-Way Hash
          Functions; ONE-WAY HASH FUNCTIONS USING SYMMETRIC BLOCK
          ALGORITHMS; Using Public-key Algorithms; CHOOSING A ONE-WAY
          HASH FUNCTION; MESSAGE AUTHENTICATION CODES
Chapter 19:  Public-Key Algorithms
          Background; Knapsack Algorithms; RSA; Pohlig-Hellman; Rabin;
          ElGamal; McEliece; Elliptic Curve Cryptosystems; LUC; FINITE
          AUTOMATON PUBLIC-KEY CRYPTOSYSTEMS
Chapter 20:  Public-Key Digital Signature Algorithms
          Digital Signature Algorithm (DSA); DSA VARIANTS; GOST
          DIGITAL SIGNATURE ALGORITHM; DISCRETE LOGARITHM SIGNATURE
          SCHEMES; Ong-Schnorr-Shamir; Esign; Cellular Automata; Other
          Public-Key Algorithms
Chapter 21:  Identification Schemes
          Feige-Fiat-Shamir; Guillou-Quisquater; Schnorr; CONVERTING
          IDENTIFICATION SCHEMES TO SIGNATURE SCHEMES
Chapter 22:  Key-Exchange Algorithms
          DIFFIE-HELLMAN; STATION-TO-STATION PROTOCOL; Shamir's Three-
          Pass Protocol; COMSET; Encrypted Key Exchange; FORTIFIED KEY
          NEGOTIATION; Conference Key Distribution and Secret
          Broadcasting
Chapter 23:  Special Algorithms for Protocols
          Multiple-Key Public-Key Cryptography; Secret Sharing
          Algorithms; Subliminal Channel; Undeniable Digital
          Signatures; DESIGNATED CONFIRMER SIGNATURES; Computing with
          Encrypted Data; Fair Coin Flips; ONE-WAY ACCUMULATORS; All-
          or-Nothing Disclosure of Secrets; FAIR AND FAILSAFE
          CRYPTOSYSTEMS; Zero-Knowledge Proofs of Knowledge; Blind
          Signatures; Oblivious Transfer; Secure Multiparty
          Computation; Probabilistic Encryption; Quantum Cryptography
Part IV:  The Real World
Chapter 24:  Example Implementations
          IBM Secret-Key Management Protocol; Mitrenet; ISDN; STU-III;
          Kerberos; KryptoKnight; SESAME; IBM COMMON CRYPTOGRAPHIC
          ARCHITECTURE; ISO Authentication Framework; Privacy-Enhanced
          Mail (PEM); Message Security Protocol; PRETTY GOOD PRIVACY
          (PGP); SMART CARDS; PUBLIC-KEY CRYPTOGRAPHY STANDARDS;
          UNIVERSAL ELECTRONIC PAYMENT SYSTEM; CLIPPER; CAPSTONE; AT&T
          MODEL 3600 TELEPHONE SECURITY DEVICE
Chapter 25:  Politics
          NATIONAL SECURITY AGENCY; National Computer Security Center;
          National Institute of Standards and Technology; RSA Data
          Security, Inc.; PUBLIC KEY PARTNERS; International
          Association for Cryptologic Research; RACE Integrity
          Primitives Evaluation; CONDITIONAL ACCESS FOR EUROPE;
          ISO/IEC 9979; PROFESSIONAL, CIVIL LIBERTIES, AND INDUSTRY
          GROUPS; Sci.Crypt; CYPHERPUNKS; Patents; U.S. EXPORT RULES;
          FOREIGN IMPORT AND EXPORT OF CRYPTOGRAPHY; Legal Issues
AFTERWARD BY MATT BLAZE
Source Code
          DES; LOKI91; IDEA; GOST; BLOWFISH; 3-WAY; RC5; A5; SEAL;
          WAKE

@_date: 1995-09-19 05:57:40
@_author: Bruce Schneier 
@_subject: Errors in Applied Cryptography, 2nd Edition 
I have taken a three stage approach to reducing the number of
errors in the second edition:
     1.  Correct the errors from the first edition.
     2.  Ensure that I don't create any new errors while writing
          the new material for the second edition.
     3.  Make sure that additional errors don't creep in during
          the production of the second edition.
In order....  I have done a lot more than incorporate all the
corrections from the errata into the second edition.  Minor
things, too trivial to make the errata list, were also corrected. The first edition was translated into French, and the translator
sent me hundreds of queries: things that were unclear, ambiguous,
or erroneous.  All of those queries resulted in changes to the
second-edition manuscript.
I was a lot more careful adding new material, reading it over
several times to ensure accuracy.  And a lot of other people read
the chapters over, too.  For the first edition, I asked about a
dozen people to proofread the manuscript for me.  Most people
read the first chapters carefully, and then petered out somewhere
in the middle.  This time I asked about seventy people to each
read a chapter (or two)--a chapter within their area of
expertise.  Each chapter was edited by at least two people, often
more.  Additionally, two people were paid to read the entire book
for accuracy and comprehensibility.
I learned a lot about the publishing process during the
production of the first edition.  For the first edition, I had no
control of any of the production decisions.  The copyeditor added
errors to the manuscript.  Some computer idiot lost all of my
italics, boldface, superscripting, and subscripting while
translating my files from my word processor to their page layout
program.  The proofreader didn't catch errors that the production
people added.  I had almost no time to review the manuscript at
any of the stages.  This time around I was able to choose my own
copyeditor, proofreader, and indexer.  In fact, there were two
separate rounds of copyediting with two different copyeditors. The proofreader is not only the most meticulous proofreader I
know, but someone who knows enough math to catch errors in the
equations.  I verified all file translations myself.  And I
reviewed the copyedited manuscript twice, and two separate passes
of page proofs.
I'm not stupid enough to state that the book is 100% error-free,
but I am confident that there are far fewer errors in the second
edition than there were in the first.  I was embarrassed at some
of the errors in the first edition, and I put a lot of effort
into making sure it doesn't happen again.
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier

@_date: 1995-09-20 13:38:31
@_author: Bruce Schneier 
@_subject: PKP Lawsuit Settled: Both Sides Claim Victory 
It looks as though the PKP suit is finally over, with both sides claiming
victory.  Is the decision public?  Can someone in California get a copy of
it and find out what really was decided.
    SUNNYVALE, Calif.--(BUSINESS WIRE)--Sept. 18, 1995--An  Arbitration Panel
has determined that RSA Data Security Inc.  licensed software products,
practicing public-key technology to  third parties without the legal rights
necessary to the patents  covering the technology.    The decision, issued on Sept. 6, 1995, came in a binding  arbitration
between RSA and CYLINK Corp., which formed the  partnership known as Public
Key Partners (PKP) on April 6, 1990. The purpose of forming PKP was to
establish a security standard and  jointly license security patents to leading
vendors in the high-tech  industry.    CYLINK has indicated that it will enforce the binding decision  in Federal
Court.    "The ruling exposes everyone of RSA's OEM customers -- from the  time PKP
was formed in 1990 until the patents expire -- to the  liability for patent
infringement," said Robert Fougner, general  counsel, CYLINK.    "Because of the widespread interest in public key technology,  this ruling
has enormous implications for the entire high-tech  industry, impacting the
future of all electronic information  exchanges including electronic commerce
and banking.  The panel's  decision vindicates our position that RSA Security
Inc. has been  improperly licensing technology which they did not have the necessary rights to."    The fundamental patents covering public key technology  (Merkle-Hellman and
Rivest-Shamir-Adelman) had been held by the PKP  partnership since 1990. Effective Sept. 6, 1995, however, the  arbitration ruled that PKP was
dissolved and the broadest of the  public key patents (invented at Stanford
University and which cover  all known implementations of public key
technology) revert from PKP  back to CYLINK.    The panel further ruled that RSA Data Security Inc. could not  grant its
software customers the right to make any copies of  RSA-authored software
implementing Stanford public key technology.      In an order issued Sept. 12, 1995, the arbitrators said that "the intent of
the order is to clarify that to the extent a (RSA  software) licensee makes
copies of the code (whether source or  object), it is not protected as a
result of the order from a claim  that the making of such copies is a `making'
under the patent laws  upon which a claim for infringement of the Stanford
patents can be  based."    "Cylink will assert the rights to the Stanford patents  vigorously," said
David Morris, vice president of marketing, CYLINK. "The investors of public
key cryptography, especially Martin Hellman  of Stanford University, have
never gotten a fair return for their  ground breaking invention.  Since the
formation of PKP, RSA Data  Security Inc. had been granting software rights
which allowed  licensees to copy and modify the programs, but without paying
PKP or  the inventors a royalty for those rights."  Arbitration Ruling     The Stanford University patents include the Hellman-Merkle  patent, the
first public key patent making the broadest claim of  cryptography, a security
technique that ensures privacy,  authentication and the integrity of
electronic information.  Because  the Hellman-Merkle patent claims cover all
implementations of public  key techniques, including the techniques known as
RSA.    To avoid risk of a patent infringement suit under the Stanford  patents,
any vendor who has purchased a license from RSA since April  6, 1990, or is
contemplating the purchase of an RSA license and is  distributing software or
hardware covered by the Stanford University  patents, must now obtain a
license to the Hellman-Merkle patent from  CYLINK for their continued use. Customers who would like to contact  CYLINK about existing and future licenses
should call Robert  Fougner, General Counsel, at 408/735-5800.  Background Information:       On April 6, 1990, RSA and CYLINK formed PKP to establish a  security
standard, and jointly license security patents to leading  vendors in the
high-tech industry.  The security technology business  is unusual in that it
is based on patents to which only these two  companies have rights.    The patents originally developed at Stanford University  (Diffie-Hellman,
Hellman-Merkle and Hellman-Pohling) broadly claim  the invention of public-key
cryptography.  Another patent, invented  at MIT (Rivest-Shamir-Adelman) claims
a particular implementation of  public key cryptography using the algorithm
known as "RSA."    In 1994, CYLINK initiated the arbitration against RSA, claiming  that RSA's
licensing practices exceeded RSA's rights under the  patents and violated the
agreements forming PKP.  CYLINK further  claimed that it was denied a promised
license to the RSA patent when  PKP was formed.  Among other rulings, the
arbitrators ruled that an  April 1990 document grants CYLINK a patent license
to the RSA  patent.    CYLINK Corp. is the world's largest provider of enterprise-wide  network
information security products and wireless communications.   Headquartered in
Sunnyvale, CYLINK serves Fortune 500 companies,  multinational financial
institutions and many international  government agencies.     --30--crd/sf* jar/sf  CONTACT:  Cylink Corporation, Sunnyvale Kim Rose, 408/774-6447
    REDWOOD CITY, Calif.--(BUSINESS WIRE)--Sept. 19, 1995--An  Arbitration
Panel recently ruled that Cylink does not have a license  to RSA patented
technology, that RSA's software licensing practices  do not breach any
agreement with Cylink or its wholly owned  subsidiary Caro-Kann and that RSA
now has the exclusive right to  license the RSA patent.      In a Sept. 6, 1995 ruling, an Arbitration Panel, formed by  agreement of
the parties, and after nearly a month of testimony,  ruled in favor of RSA on
every significant issue.  The Panel held  that neither Cylink nor Caro-Kann
had a license to practice RSA  patented technology.  Cylink admittedly
incorporates this technology  in its Secure X.25 product line, without any
license to do so.      The Panel also found that RSA's software licensing practices did  not
materially breach any of Cylink's rights.  The Panel did not rule that anyone,
(specifically including RSA and its software customers)  infringed any
existing patent rights of anyone - including Cylink.      As a result of the Panel's ruling, RSA now has the exclusive  right to
license the patented RSA technology.  According to Jim  Bidzos, the President
of RSA, "RSA will continue to conduct its  software business in exactly the
same way that it has for the past  ten years.      "In addition, RSA anticipates that licenses to the RSA Patent  will now be
much more readily available, because they now can now be  granted without
Cylink interference.  RSA has all of the intellectual property rights which it
needs to license its software.  RSA will  vigorously defend against any claim
to the contrary."      A recent Cylink press release on the Ruling of the Arbitration  Panel is
wildly inaccurate.  The same Robert Fougner (Cylink's  General Counsel) who is
cited in the Cylink press release has  repeatedly made express representations
to third parties that the  Stanford Patents do not cover, and are not
infringed by, the  manufacture, use or sale of products incorporating RSA's
TIPEM  software developer's toolkit.      As noted by Mr. Bidzos: "Cylink lost every single significant  issue in the
Arbitration.  Their press release was simply an attempt  to cover up what has
been a crushing defeat."      Questions regarding the Arbitration Panel Ruling or RSA licenses  should be
directed to Kurt Stammberger, RSA Technology Marketing  Manager, or Paul
Livesay, RSA Director of Legal Affairs.       --30--as/sf*  CONTACT:  RSA Kurt Stammberger, 415/595-8782

@_date: 1996-01-03 15:02:42
@_author: Bruce Schneier 
@_subject: no subject (file transmission) 
APPLIED CRYPTOGRAPHY, Second Edition
                               ERRATA
                     Version 1.0 - 3 January 1996
This errata includes all errors I have found in the book, including minor
spelling and grammatical errors.  Please distribute this errata sheet to
anyone else who owns a copy of the book.
Page 11:  Line 18, the reference should be "[703]" and not "[699]".
Page 13:  Fifth paragraph, first sentence, should read: "The German Enigma
had three rotors, chosen from a set of five,...."
Page 14:  The last sentence should read:  "The smallest displacement that
indicates a multiple of the key length is the length of the key."
Page 16:  Third line from the bottom, "1.44" makes more sense as "1.544".
Page 18:  Table 1.1, second item.  1 in 4,000,000 is 2^22.
Page 53:  Second to last sentence about SKEY should read: "Similarly, the
database is not useful to an attacker."
Page 61:  Step (3), the second message should contain A instead of B.
Page 62:  In the third line, there's a comma missing.
Page 63:  Second protocol, step (2), the second message should be
Page 70:  In the first step (4), the equation should be "R XOR S = M".  In
the second step (2), it should be "to generate U".
Page 77:  In step (2), the message is signed with Trent's private key.  And
T_n is mistakenly both the time and the timestamp.
Page 82:  Fourth line from the bottom, the correct expression is "up and
Page 99:  Tenth line from the bottom, delete the second word: "will".
Page 104:  Graph isomorphism has never been proven to be an NP-Complete
problem.  It does seem to be hard, and is probably useful for cryptography.
Page 105:  In Step (2), Peggy gives Victor a copy of H'.
Page 112:  Step (1) should read "Alice takes the document and multiplies it
by a random value."
Page 116:  The protocol could be worded better.  Step (3) should begin:
"Alice decrypts Bob's key twice, once with each of her private keys."  Step
(4) should begin: "Alice encrypts both of her messages, each with a
different one of the DES keys...."
Page 126:  The "Voting with Blind Signatures" protocol is a little more
complicated.  The voter does not send all the blinding factors in step (2). The CTF requests 9 of 10 blinding factors in step (3), and the voter sends
only those blinding factors to the CTF.
Page 134:  Another problem with this protocol is that there are numerous
ways that various participants can cheat and collude to find out the salary
of another participant.  These cheaters can misrepresent their own salaries
during their attack.
Page 135:  Lines 13-14; technically Alice and Bob get no additional
information about the other's numbers.
Page 136:  Lines 14-15; technically Alice and Bob get no additional
information about the other's numbers.
Page 144:  Line 27, the odds should be "1 in n".  Line 29, "step (2) should
be "step (1)".
Page 161:  In the eleventh line from the bottom, "harnesses" should be
Page 181:  Line a should read "he does not know it" instead of "he does
know it".
Page 195:  In line 13, the reference number should be [402].
Page 201:  Error Propagation, lines 5-6.  The sentence should read: "In 8-
bit CFB mode, 9 bytes of decrypted plaintext are garbled by a single-bit
error in the ciphertext."
Page 202:  Third to last line, toggling individual bits does not affect
subsequent bits in a synchronous stream cipher.
Page 203:  Section 9.8, both equations should be "S_i = E_K(S_(i-1))".
Page 209:  Table 9.1.   CFB, Security: Bits of the last block can be
changed, not the first.  CFB, Efficiency: The speed is the same as the
block cipher only in 64-bit CFB.  CFB and OFB, Efficiency: "Ciphertext is
the same size as the plaintext" should be a plus.
Page 217:  The Table 10.1 headers got garbled.  They should be:
"Algorithm", "Confidentiality", "Authentication", "Integrity", and "Key
Page 246:  The last line should be: " isEven(x) ((x & 0x01) == 0)".
Page 249:  Line 9, "Euclid's generalization" should be "Euler's
Page 251:  Lines 20-21.  The sentence should read: "For example, there are
11 quadratic residues mod 35: 1, 4, 9, 11, 14, 15, 16, 21, 25, 29, and 30." See page 505 for more details.
Page 258:  In line 27, his name is spelled "Chandrasekhar".
Page 275:  Table 12.4; it should be a "48-Bit Input".
Page 281:  In line  4, "minuscule" is misspelled as "miniscule".
Page 287:  In Figure 12.6, there should be no period in X or Y.
Page 292:  Second line, "b_24" should be "b_26".  In line 10, "1/2 - .0061"
should be "1/2 + .0061".
Page 295:  Third line from the bottom, 2^(120/n) should be (2^120)/n.
Page 300:  In the first line, "56" should be "48".
Page 319:  In line 11, Section "25.13" should be "25.14".
Page 322:  Last line, the chip is 107.8 square mm.
Page 338:  In Figure 14.3 and in the first line, "f" should be "F".
Page 340:  Second equation should be "mod 256".
Page 341:  The current variants of SAFER are SAFER SK-40, SAFER SK-64, and
SAFER SK-128, all with a modified key schedule, in response to a
theoretical attack by Lars Knudsen presented at Crypto '95.
Page 345:  Lines 10 and 11; the + should be a -.
Page 346:  The reference number for BaseKing should be [402].
Page 352:  In line 8, that second "l" should be an "r".
Page 358:  In the decryption equation of Davies-Price mode, the final D
should be an E.
Page 362:  In the first equation, P is used to indicate both padding and
plaintext.  If P is plaintext and p is padding, then the equation should
be: C = E_K3(p(E_K2(p(E_K1(P))))).
Page 362:  Figure 15.2 is wrong.  The middle and top rows of "Encrypt," and
the plaintext feeding them, are shifted right by 1/2 block from where they
should be.
Page 363:  The parenthetical remark would be clearer as: "encryption with
one of n different keys, used cyclically".
Page 363:  Second to last line, the equation should have an I_2 in place of
the I_1.
Page 367:  Second equation, "P XOR K_3" should be "C XOR K_3".
Page 369:  A maximal period linear congruential generator as a period of m,
not m-1.
Page 375:  Third paragraph should read:  "It is easy to turn this into a
maximal period LFSR.  The highest exponent is the size of the register, n. Number the bits from n-1 to 0.  The numbers, including the 0, specify the
tap sequence, counting from the left of the register.  The x^n term of the
polynomial stands for the input being fed into the left end."  The next
paragraph is wrong.
Page 379:  Second line of code has an extra close parentheses.
Page 380:  The forth line should begin: "On the other hand, an
Page 393:  In Figure 16.16, there should be an arrow from b_4 to the Output
Page 393:  Second sentence should be: "It's a method for combining multiple
pseudo-random streams that increases their security."
Page 429:  The second sentence should be: "It returns a fixed-length hash
value, h."
Page 431:  In step (2), "prepend" instead of "append".
Page 440: In item 3, there is an "AND" missing in the equation.
Page 441:  The compression function of MD2 is confusing without the
indentations.  The two for-loops are nested, and include the next two
Page 444:  In figure 18.7, the a, b, c, d, and e variables are backwards.
Page 445:  Line 14, SHA should be compared to MD4.
Page 447:  Lines 3-4 should read: "...CBC in [1145], CBC in [55,56,54]...."
Page 449:  Figure 18.9, M_i and H_i-1 in the upper-left diagram should be
Page 456:  Table 18.2.  Encryption speed should be in "kilobytes/second",
and "SNEERU" should be "SNEFRU".
Page 457:  Lines 3 and 4, the ending "-1" and "-2" should be superscripts.
Page 465:  In the third line of text, the number should be n^-1.
Page 470:  The second to last line is missing an "is".
Page 480:  An additional reference for elliptic-curve cryptosystems is N.
Koblitz, A Course in Number Theory and Cryptography, Springer-Verlag, 1988. This is an excellent book, and omitting it was an oversight.
Page 489:  Caption to Table 20.3 should specify an "80386 33 MHz personal
Page 495:  In Step (8), the constant should be "0x7fffffff".
Page 497:  Delete the fourth equation in the list of verification
Page 499:  ESIGN, seventh line:  "m-1 should be "n-1".
Page 505:  In step 3, the third sentence should be:  "If Victor's first bit
is a 1, then s_1 is part of the product...."
Page 514:  In step (1), Alice must sent X to Bob.
Page 515:  In line 1, "commutitive" is misspelled as "communitive".
Page 515:  Hughes.  Step (2): In order for step (4) to work, y must be
relatively prime to n-1 else the inverse function in step (4) won't work. If n is a strong prime such that (n-1)/2 is also prime, then y can be any
odd random large integer except for (n-1)/2.  In step (4), Bob computes:
z=y^-1 mod (n-1).
Page 516:  In the Station-to-Station protocol, the exponentiation is
missing.  In step (1), Alice sends Bob g^x mod p.  In step (2), Bob
computes the shared key based on g^x mod p and y.  He signs g^x mod p and
g^y mod p, and encrypts the signature using k.  He sends that, along with
g^y mod p, to Alice.  In step (3), Alice sends a signed message consisting
of g^x mod p and g^y mod p, encrypted in their shared key.
Page 529:  Line 13 should be a polynomial of degree 5, not 6.
Page 535:  The technique wherein Mallory leaks 10 bits of DSA secret per
signature, can be sped up by a factor of 16 or so.  Instead of choosing a
4-bit block randomly and then searching for a k that leaks
the correct 14 bits, he can just use the low 4 bits of r to select the
block of the signature to leak (no need to have an opaque subliminal
channel) and he only has to check an average of 1024 k values until the
bits sent out over the 10 subliminal channels match the 10 bits of the
secret selected by r = (g^k mod p) mod q.
Page 568:  In the Kerberos Version 5 Messages, step 3, the final "s" should
not be subscripted.
Page 586:  Figure 24.7, in the key the arrow should point from y to x.
Page 586:  Seventh line, "revokation" should be spelled "revocation".
Page 589:  Section 24.15, fourth line:  "Nambia" should be "Namibia".
Page 592:  The equation is wrong.  The structure of the LEAF is
"E_KF(U,E_KU(K_S),C)", where U is the 32-bit unit ID, K_S is the 80-bit
session key, and C is a 16-bit checksum of K_S and the IV (and possibly
other material) used by the receiving chip to ensure that it has a valid
Page 604:  Fourth line from the bottom should read: "to U.S. patent law."
Page 606:  In lines 12 and 13, the cross-references are to chapter 18.
Page 607:  In Table 25.4, the column headers are reversed.
Page 610:  Sixth line should read "it is filed", not "it is filled".
Page 683:  In reference 210, the title of the paper is "A Comparison of
Three Modular Reduction Functions".
Page 705:  In reference 727, subscript should be a superscript.
This errata is updated periodically.  For a current errata sheet, send a
self-addressed stamped envelope to:   Bruce Schneier, Counterpane Systems,
101 East Minnehaha Parkway, Minneapolis, MN  55419; or send electronic mail

@_date: 1996-01-04 06:22:57
@_author: Bruce Schneier 
@_subject: Someone wanted to give PGP lecture at CSI conference 
I'm looking, on behalf of the COmputer Security Institute, for someone who
is willing to give a 1.5 hour PGP primer at their summer conference in
SF.  They don't pay, but they will give you free admission into the conference
(and two bad hotel conference meals).
I speak at their conferences; they're not a bad lot.  Interested parties should email me directly.
* Bruce Schneier
* Counterpane Systems         For a good prime, call 391581 * 2^216193 - 1
* schneier

@_date: 1996-02-02 02:19:52
@_author: Bruce Schneier 
@_subject: RC2 code on sci.crypt 
For those not paying attention, there is RC2 code on sci.crypt.  RSADSI
is acting as if it is real, and will publish some legal posturing about
it real soon now.  * Bruce Schneier              APPLIED CRYPTOGRAPHY, 2nd EDITION is
* Counterpane Systems         available.  For info on a 15%
* schneier    discount offer, send me e-mail.

@_date: 1996-02-09 10:44:15
@_author: Bruce Schneier 
@_subject: Applied Cryptography, 2nd Edition --  Errata version 1.2 
APPLIED CRYPTOGRAPHY, Second Edition
                              ERRATA
                   Version 1.2 - 1 February 1996
This errata includes all errors I have found in the book, including minor
spelling and grammatical errors.  Please distribute this errata sheet to
anyone else who owns a copy of the book.
Page 7:  In line 31, delete the word "source".
Page 10:  The second sentence would be clearer as "Replace the least
significant bit of each byte of the image with the bits of the message."
Page 11:  Line 18, the reference should be "[703]" and not "[699]".
Page 13:  Fifth paragraph, first sentence, should read: "The original
German Enigma had three rotors, chosen from a set of five,...."  This
increased to three rotors chosen from eight during the war, and the Navy
started using four rotors chosen from eight.
Page 14:  The last sentence should read:  "The smallest displacement that
indicates a multiple of the key length is the length of the key."
Page 16:  Third line from the bottom, "1.44" makes more sense as "1.544".
Page 18:  Table 1.1, second item.  1 in 4,000,000 is 2^22.  This makes the
third item equal to 2^55.
Page 53:  Second to last sentence about SKEY should read: "Similarly, the
database is not useful to an attacker."
Page 55:  William Price's first name is Wyn.
Page 60:  In Step (4) of the Kerberos protocol, change "Bob sends" to "Bob
Page 61:  Step (3), the second message should contain A instead of B.
Page 62:  In the third line, there's a comma missing.
Page 63:  Second protocol, step (2), the second message should be
Page 70:  In the first step (4), the equation should be "R XOR S = M".  In
the second step (2), it should be "to generate U".
Page 77:  In step (2), the message is signed with Trent's private key.  And
T_n is mistakenly both the time and the timestamp.
Page 80:  In line 7, "step (3)" should be "step (5)".
Page 82:  Fourth line from the bottom, the correct expression is "up and
Page 99:  Tenth line from the bottom, delete the second word: "will".
Page 104:  Graph isomorphism has never been proven to be an NP-Complete
problem.  It does seem to be hard, and is probably useful for cryptography.
Page 105:  In Step (2), Peggy gives Victor a copy of H'.
Page 106:  In the first line, "step (3)" should be "step (4)".
Page 112:  Step (1) should read "Alice takes the document and multiplies it
by a random value."
Page 116:  The protocol could be worded better.  Step (3) should begin:
"Alice decrypts Bob's key twice, once with each of her private keys."  Step
(4) should begin: "Alice encrypts both of her messages, each with a
different one of the DES keys...."
Page 126:  The "Voting with Blind Signatures" protocol is a little more
complicated.  The voter does not send all the blinding factors in step (2). The CTF requests 9 of 10 blinding factors in step (3), and the voter sends
only those blinding factors to the CTF.  Additionally, in step three only
the one messages (containing a set of votes) that has not been unblinded will effectively be signed by the CTF.
Page 134:  Another problem with this protocol is that there are numerous
ways that various participants can cheat and collude to find out the salary
of another participant.  These cheaters can misrepresent their own salaries
during their attack.
Page 135:  Lines 13-14; technically Alice and Bob get no additional
information about the other's numbers.
Page 136:  Lines 14-15; technically Alice and Bob get no additional
information about the other's numbers.
Page 144:  Line 27, the odds should be "1 in n".  Line 29, "step (2) should
be "step (1)".
Page 146:  Fourth line from the bottom, delete the word "that".
Page 161:  In the eleventh line from the bottom, "harnesses" should be
Page 175:  Line 8, it's really triple-DES encryption.
Page 181:  Line 8 should read "he does not know it" instead of "he does
know it".
Page 195:  In line 13, the reference number should be [402].
Page 201:  Error Propagation, lines 5-6.  The sentence should read: "In 8-
bit CFB mode, 9 bytes of decrypted plaintext are garbled by a single-bit
error in the ciphertext."
Page 202:  Third to last line, toggling individual bits does not affect
subsequent bits in a synchronous stream cipher.
Page 203:  Section 9.8, both equations should be "S_i = E_K(S_(i-1))".
Page 209:  Table 9.1.   CFB, Security: Bits of the last block can be
changed, not the first.  CFB, Efficiency: The speed is the same as the
block cipher only in 64-bit CFB.  CFB and OFB, Efficiency: "Ciphertext is
the same size as the plaintext" should be a plus.
Page 213:  In the last line of the third paragraph, "cryptanalyze" is
Page 217:  The Table 10.1 headers got garbled.  They should be:
"Algorithm", "Confidentiality", "Authentication", "Integrity", and "Key
Page 246:  The last line should be: " isEven(x) ((x & 0x01) == 0)".
Page 249:  Line 9, "Euclid's generalization" should be "Euler's
Page 251:  Lines 20-21.  The sentence should read: "For example, there are
11 quadratic residues mod 35: 1, 4, 9, 11, 14, 15, 16, 21, 25, 29, and 30." See page 505 for more details.
Page 258:  In line 27, his name is spelled "Chandrasekhar".
Page 259:  Lehmann reference "[903]" should be [945]".
Page 275:  Figure 12.4; "46-Bit Input" should be "48-Bit Input".
Page 287:  In line 13, "first and third" should be "second and third".
Page 287:  In Figure 12.6, there should be no period in X or Y.
Page 288:  In figure 12.7, the final output on the right side should be
Page 292:  Second line, "b_24" should be "b_26".  In line 10, "1/2 - .0061"
should be "1/2 + .0061".
Page 295:  Fourth line from the bottom, 2^(120/n) should be (2^120)/n.
Page 300:  In the first line, "56" should be "48".
Page 306:  The first sentence is wrong.  The key is rotated to the right;
the key and data move in opposite directions to minimize redundant key bit
operations.  Also, the XOR happens after the rotation.  The third paragraph
should be modified to be the opposite of this.  In any case, Madryga is
vulnerable to differential cryptanalysis with about 5000 chosen plaintexts. Don't use it.
Page 307:  Last line, "complementation" is misspelled as "complemention".
Page 311:  Second paragraph, second line should be: "it more quickly than
by brute force..."
Page 316:  In Table 13.2, P_2 should be "379", not "279".
Page 319:  In line 11, Section "25.13" should be "25.14".
Page 322:  Last line, the chip is 107.8 square mm.
Page 325:  Last line, "mod 3" should be "mod 4".
Page 338:  In Figure 14.3 and in the first line, "f" should be "F".
Page 340:  Second equation should be "mod 256".
Page 341:  The current variants of SAFER are SAFER SK-40, SAFER SK-64, and
SAFER SK-128, all with a modified key schedule, in response to a
theoretical attack by Lars Knudsen presented at Crypto '95.
Page 342:  In the description of 3-Way, "K^(n+1)" should be "K_n".
Page 345:  Lines 10 and 11; the + should be a -.
Page 346:  The reference number for BaseKing should be [402].
Page 352:  In line 8, that second "l" should be an "r".
Page 358:  In the decryption equation of Davies-Price mode, the final D
should be an E.
Page 362:  In the first equation, P is used to indicate both padding and
plaintext.  If P is plaintext and p is padding, then the equation should
be: C = E_K3(p(E_K2(p(E_K1(P))))).
Page 362:  Figure 15.2 is wrong.  The middle and top rows of "Encrypt," and
the plaintext feeding them, are shifted right by 1/2 block from where they
should be.
Page 363:  The parenthetical remark would be clearer as: "encryption with
one of n different keys, used cyclically".
Page 363:  Second to last line, the equation should have an I_2 in place of
the I_1.
Page 367:  Second equation, "P XOR K_3" should be "C XOR K_3".
Page 369:  A maximal period linear congruential generator as a period of m,
not m-1.
Page 375:  Third paragraph should read:  "It is easy to turn this into a
maximal period LFSR.  The highest exponent is the size of the register, n. Number the bits from n-1 to 0.  The exponents, including the 0, specify the
tap sequence, counting from the right of the register.  The x^n term of the
polynomial stands for the input being fed into the left end."  The next
paragraph is wrong, as is the code and the figure.
Page 379:  Second line of code has an extra close parentheses.
Page 380:  The fourth line should begin: "On the other hand, an
Page 382:  In paragraph 4, "LFSR" would be more clear if it were labeled
"LFSR-2".  Similarly, in the first sentence of paragraph 5  "LFSR" would be
more clear if it were labeled "LFSR-3".
Page 384:  Bilateral Stop-and-Go Generator:  To agree with Figure 16.11,
reverse "LFSR-1" and "LFSR-2".
Page 389:  Some more details on the GSM algorithms.  A3 is the
authentication algorithm in the smart card.  A8 is just a bit shuffling
process that takes part of the output of A3 and turns it into a session key
for A5.  A5 is the privacy algorithm.  There are two algorithms used in
GSM: A5/1 and A5/2.  A5/1 can be used by only certain countries; A5/2 can
be used by all countries.
Page 391:  In the 11th line under Fish, it should be "D_j" instead of
Page 393:  In Figure 16.17, there should be an arrow from the fourth byte
to the Output Function.
Page 393:  Second sentence should be: "It's a method for combining multiple
pseudo-random streams that increases their security."
Page 398:  In the third line of the section on SEAL, "kilobytes" is
misspelled as "kiloytes".
Page 411:  Another option for an alternating stop-and-go generator would be
to use a LFSR in Register-2, a FCSR in Register-3, and either in Register-
1.  This may have advantages over either of the three constructions listed.
Page 420:  Table 17.3, the speed should be in kilobytes/second.
Page 429:  The second sentence should be: "It returns a fixed-length hash
value, h."
Page 431:  In step (2), "prepend" instead of "append".
Page 440: In item 3, there is an "AND" missing in the equation.
Page 441:  The compression function of MD2 is confusing without the
indentations.  The two for-loops are nested; the inner loop includes the
next two statements; and the other loop the statement after that.
Page 443:  Last paragraph, the operation number runs from 0 to 79.
Page 444:  In figure 18.7, the a, b, c, d, and e variables are backwards.
Page 445:  Line 14, SHA should be compared to MD4.
Page 447:  Lines 3-4 should read: "...CFB in [1145], CBC in [55,56,54]...."
Page 449:  Figure 18.9, M_i and H_i-1 in the upper-left diagram should be
Page 454:  Seventh and sixth lines from the bottom, Z is the sum of the
message blocks as if they were 256-bit integers.
Page 456:  Table 18.2.  It's "Hash Speeds", not "Encryption Speeds", and it
is measured in "kilobytes/second".  "SNEERU" should be "SNEFRU".
Page 465:  In the third line of text, the number should be n^-1.
Page 469:  Table 19.3, the "Clock Cycles" entry for the Siemens chip should
be ".3M".
Page 470:  Sixth line from the bottom, the n' should be an m'.
Page 470:  The second to last line is missing an "is".
Page 471:  In the sixth line from the bottom, "n'^d mod n" should be "m'^d
mod n"

@_date: 1996-02-17 09:04:49
@_author: Bruce Schneier 
@_subject: ITAR Amended to Allow Personal Use Exemptions 
Today's Federal Register contains a notice from the Department of
State, Bureau of Political Military Affairs, announcing final rule of
an amendment to the International Traffic in Arms Regulation (ITAR)
allowing U.S. persons to temporarily export cryptographic products for
personal use without the need for an export license.  The product must
not be intended for copying, demonstration, marketing, sale, re-export,
or transfer of ownership or control.  It must remain in the possession
of the exporting person, which includes being locked in a hotel room or
safe.  While in transit, it must be with the person's accompanying
baggage.  Exports to certain countries are prohibited -- currently
Cuba, Iran, Iraq, Libya, North Korea, Sudan, and Syria.  The exporter
must maintain records of each temporary export for five years.  See
Federal Register, Vol. 61, No. 33, Friday, February 16, 1996, Public
Notice 2294, pp. 6111-6113.

@_date: 1996-04-27 11:13:32
@_author: Bruce Schneier 
@_subject: APPLIED CRYPTOGRAPHY 2nd EDITION Errata version 1.3 
I just mailed a copy of the new errata to everyone on my mailing list.  If
you didn't get one, it means that you are not on my mailing list.  Send
me e-mail to correct that oversight immediately.
Wiley has not yet committed to making an updated version of the book.  If
you want to complain to my editor, he is psutherl
* Bruce Schneier              APPLIED CRYPTOGRAPHY, 2nd EDITION is
* Counterpane Systems         available.  For info on a 15%
* schneier    discount offer, send me e-mail.
* For Blowfish C code, see ftp.ox.ac.uk:/pub/crypto/misc/blowfish.c.gz
