
@_date: 1994-08-01 21:40:07
@_author: Matthew Gream 
@_subject: Keystone Kops suck up Internet traffic 
*laugh* The following was forwarded to me from aarnet-contacts a
mailing list for organisations connected to AARNet (Australian Academic
and Research Network) -- the local Internet -- which provides our
gateway to the world. fyi: The AFP (Australian Federal Police)
currently have a machine on the network, and have for some time, it has
no DNS records but its registered domain is in the NIC.

@_date: 1994-08-05 22:56:06
@_author: Matthew Gream 
@_subject: Problem in draft FIPS `CRYPTOGRAPHIC SERVICE CALLS' 
Anyone producing cryptographic software elements should take notice of
the recent FIPS draft standard on `cryptographic service calls' dated
23 May 1994. It attempts to define data structures and "function" calls towards the
goal of making better interoperability between applications and crypto
"libraries". However, you'll notice that both DSA and RSA modulus sizes
are constrained to a `MODULUS_SIZE ' of 64 `BYTE's (unsigned char).
This permissible maximum of 512 bits is too small, and a violation of
FIPS-186 s.4.1. amongst others.
I like this FIPS, but it would be pretty useless if it contained the
above restriction. If you're also a software developer, make a comment
to NIST on the issue, so they do change it.

@_date: 1994-09-02 05:12:25
@_author: Matthew Gream 
@_subject: Aust crypto regulations 
I posted this to clarify some possible misconceptions, and ended it
with a `teaser'. Since I'm sure it'll be of interest to readers here,
here goes a forward (some headers elided):
---- begin include ----
Newsgroups: aus.computers.ibm-pc,alt.security.pgp
That sounds bogus to me, at least from the information you've given me
there. I've had the pleasure of being routed from our `Australian Trade
Commission' through a number of channels to get to the `Defence
Industry Development Branch' who furnished me with information relating
to export of `Dual Use Technologies'. Having been informed first hand, and given the appropriate paperwork,
I'm fairly confident in saying that there are no export restrictions on
software (specific clause stating that mass market, public domain and
"unsupported after installation" software is not covered by the
Industrial List). There do exist restrictions on hardware. All of these
restrictions are a direct result of our adherence with COCOM
regulations (enacted through amendments to our Customs Act) -- and even so, export licences are required only for "certain" countries.
The documentation relating to export guidelines is dated September
1992, I received it early 1994 and was informed that it was still
"current". I have heard "on the net" (how's that for credibility ?
:-), that the COCOM agreements are going to be abandoned, but as the
software project I'm involved with isn't complete, I haven't looked
into the matter since the initial investigation. I will do so when the
time comes, or suitably motivated.
I should also mention that in response to one of several questions I
put to our Cwth Attorney General's Department, I received:
    ``Your third question concerns restricting [sic] on the production,
    export and import of cryptographic software and hardware. I note
    your familiarity with the Customs (Prohibited Exports) Regulations.     I am not aware of any other legislation dealing particularly with     cryptographic software and hardware.''
      -- Steven Marshall, A/g Assistant Secretary, National Security       Branch. Security Divison, Attorney General's Department,
      Commonwealth of Australia. personal correspondence, 26 May 1994.
Getting back to the export guidelines, I have it with me here and I'll
quote something interesting that may apply in this circumstance (whoever
wrote this didn't seem pleased either, but it still got the Minister's
seal of approval):
    ``United States of America Re-export Controls
    Exporters should be aware that authorities of the United States
    of America claim control over many exports from other countries,
    including Australia, where the goods are of US origin, include
    components of US origin, or were produced using US-origin     technology. In such cases, under US export regulations, a US
    re-export licence may be required whether or not an Australian
    export licence is needed or has been granted.
    Although such US regulations are not valid in Australian law,     the US authorities commonly penalise foreign companies which do
    not comply, by denying them access to US goods or technology in
    the future. Where a company has a presence in the US, legal action
    may lead to the imposition of fines and other penalties.
    Enquiries regarding re-export approval should be directed to the
    US Consulate in Sydney or Melbourne. The contact numbers are
    listed in Annex C.''
      -- "Australian controls on the export of technology with civil
      and military applications" -- "a guide for exporters and importers"
      September 1992, Department of Defence, Canberra. pg 4.
The question here is whether "US-origin technology" covers algorithms
and conceptual systems (RSA for example). I'd be interested to hear
about these apparent US prosecutions.
Matthew Gream  -- Consent Technologies, (02) 821-2043
Disclaimer: From? \notin speaking_for(Organization?)            [cfqx103]
---- end include ----

@_date: 1994-09-05 15:50:41
@_author: Matthew Gream 
@_subject: Re: How do I choose constants suitable for Diffe-Hellman? 
I needed a few of these primes a while ago, so I took a few minutes and
hacked Phil's code to operate distributed (ie. a central machine
carried out the sieving and handed off candidates to a set of other
machines to do the Rabin-Miller). With one Sun Sparc 690MP and approx
40 Sun Sparc LX's, it was getting results like:
acacia: 7:21pm  up  2:05,  20 users,  load average: 0.95, 0.98, 0.77
mg.{~/static/d/dist} date;./go;date
Sun Jul 24 19:21:57 EST 1994
  server calls:   7235
found modulus p = finding generator
trying 2 3 5
generator g = 5
Sun Jul 24 21:10:18 EST 1994
That's 2 hours for a 2048 prime P where (P - 1)/2 is also prime, and they
also satisfied the constraint that P = 3(mod 4).
The software maintains a TCP connection to each "Rabin-Miller server"
and can dynamically deal with the loss of machines, but in it's
simplicity doesn't do reconnects.  If anyone who operates an FTP
archive wants to reply to me, I'll tar it up (in it's current "it works
for me, but no guarantees" state).
Speaking of primes with constraints, I got my hands on Harn's recent
paper on a PKCS based on both factoring and discrete logs. He wants his
modulus to be a prime P = 2p x q + 1, where p = 2r + 1, q = 2s + 1. All
P, q, q, r, s must be prime -- good luck in finding such primes by
probablistic methods !
mg.{~/src/rr} ls -l
total 26
-rw-------  1 mgream       8339 Jul 24 14:17 client.c
-rw-------  1 mgream       2196 Jul 24 15:00 common.h
-rw-------  1 mgream       6028 Jul 29 13:35 dhgen.c
-rwx------  1 mgream        270 Jul 24 14:58 go
-rw-------  1 mgream        527 Jul 24 14:58 makefile
-rw-------  1 mgream       3041 Jul 29 14:50 server.c
-rw-------  1 mgream        367 Jul 24 14:26 servers.src

@_date: 1994-09-06 00:05:52
@_author: Matthew Gream 
@_subject: Re: Aust crypto regulations 
Well, fuck that for thinking I was living under a less restrictive
regime -- and I can say goodbye to an international market for my
---- begin include ----
Newsgroups: aus.computers.ibm-pc,alt.security.pgp
I'm afraid I have to post a clarification to a clarification. I've just
been in contact with the relevant people at the Defence Signals
Directorate. It seems that regardless of advice obtained from other
departments and documentation that points to the contrary, there are
restrictive controls on software.
In my conversation, the following was articulated (she was refering to
the same document as previously mentioned [1]):
1. The "General Software Note" on Page 1-6 of [1] does not override
   the regulations in "Category 5: Telecommunications and `Information
   Security'", specifically s.5.A.2 and s.5.D.2. This means that they
   assert control over all forms of software _including_ public domain.
   I tried to pin-point what the "General Software Note" is for then,
   but didn't receive an acceptable answer.
2. DES can only be exported for specific banking and associated    applications, even then only to 8 governments and certain banking    groups. They accept RSA for export where it's used in Key    Distribution applications. In essence, there is a list of specific
   uses for certain algorithms.
3. Message digests are in general OK, so long as they can't be modified
   to perfom cryptographic functions (ie. encryption/decryption).
4. Export is regulated on a per end user basis. In order words, they
   assert control over _each_ item of software sold.
5. The fact that COCOM is in a "forum" period does not affect the
   current regulations.
6. I specifically asked about "public domain" distribution of software
   via the Internet. She said that this was "highly inadvisable" and
   "if our government found out about it, they could take action" and
   asserted that it would be worse for an individual than if the
   violation was carried out by a company. She said that she wouldn't
   like someone to become a "test case", and made mention of problems
   in the USA.
She was extremely helpfull though, but the real problem I had, and I
spent most of my time on this, was that these requirements aren't
solidified anywhere, and hence subjective. I'm not really surprised
though, that's the whole point of it all.
I wasn't concerned about "weak crypto", only DES, IDEA, RSA, MD* and
locally produced algorithms.
In short: Anything cryptographic, they want to know about, and they
want to know about it on a per end-user basis. They advise against
distribution on the "Internet" and any distribution without prior
approval otherwise there could be "problems".
[1] "Australian Controls on the Export of Technology with Civil and
Matthew Gream  -- Consent Technologies, (02) 821-2043
Disclaimer: From? \notin speaking_for(Organization?)            [cfqx103]
---- end include ----

@_date: 1994-09-07 18:56:45
@_author: Matthew Gream 
@_subject: Re: Aust crypto regulations 
This intrigued me, as I too see no basis for their controls. The prohibited
exports come under the Customs Act, and it may well be that the upfront
"general software note" which excludes public domain and other software
isn't yet instilled in legislation. I'll have to look at the Customs Act
itself to see how the prohibited exports ties in. Finding out what group
constructed this documentation and hence the relevance of that note is
another avenue.
I wouldn't hesitate to speculate that they are asserting controls over crypto that they don't really have. The issue still requires further
investigation though.

@_date: 1994-09-20 16:10:27
@_author: Matthew Gream 
@_subject: Re: Laws Outside the U.S. 
(I've touched on this issue in a few bits and peices, but this is
an opportunity for me to summarise some of the critical points)
Crypto in Australia:
- There are no regulations or laws covering the use of crypto, ie.
  encryption of communications over common carriers. However, when a
  Law Enforcement Agency (only our Federal Police and the Australian
  Security Intelligence Organisation can obtain warrants for telephone
  intercepts) requires an intercept, the carrier must be able to
  furnish the information to them. What this means is that if the
  carrier employs encryption or some other method of altering
  information between external communication end points, it must unwrap
  this for AFP/ASIO when they have a warrant for such information. This
  applies _only_ to "carriers".
- There _are_ export laws on crypto, covered under section 13B and
  13E of the Customs (Prohibited Exports) Regulations (under the
  Customs Act 1901). This prohibits certain specified goods of which
  crypto is one, along with any goods in a list produced by the
  `Minister of State for Defence' on `Goods with Civil and Military
  Applications' [ie. what comes from COCOM]. Permits must be obtained
  in writing from the Minister of State for Defence _or_ someone
  authorised in writing by him/her. This legislation doesn't seem to
  have been applied.
- There are no laws on crypto import. Of course, importing implies
  something coming from another jurisdiction, who may see the export
  issue a different way. It's my belief that the laws are in place to
  "scare" and "standover" the _exporters_ and place the onus on them to
  control emissions. In other words, just as if the smoke shop sold to
  a minor, the shop, not the minor would get it.  I did at one stage
  think that "they" wouldn't mind occasional abuses of the legislation,
  as it gives them the occasional victim to prosecute and hold up for
  all to see. I don't think this anymore, because "they" would _not_
  win a case unless it's shown that the exporter did so explicitely to
  construct products for "the bad guys" (a dubious concept at best) --
  as opposed to products for personal security and commerce (I suspect
  this is why Phils case is on ice, prosecuting him isn't ever going to
  work).
- The Defence Signals Directorate (DSD) is our primary SIGINT/COMSEC
  agency. Much like the NSA (but on a smaller scale, their HQ in
  Canberra consists of 3 or 4 buildings only, surrounded by razor
  fencing though and my "driver" swears the radio went dead as I
  stepped out for a closer look :>) they provide COMSEC advice to the
  Govt. They are also the ones that deal with authorising crypto
  products for export under s.13B & 13E as mentioned above.
- Some peripheral issues: There is a section in the Telecommunications
  (Interception) Act that makes it an "offence" to hinder an officer
  under a warrant. This may apply to the use of crypto, but would do so
  only after a warrant has already been obtained to look into a
  criminal offence -- this is mere speculation on my behalf. Our
  privacy act deals _only_ with information relating to the Tax File
  Number, and credit agencies. We have a `Data matching Act' that
  allows social security and the tax department to correlate data base
  information. Interestingly enough this Act specifically outlines in
  algorithm steps what is to be compared, how it is to be compared and
  even time restrictions on the lengths of these steps and looking at
  the composition of the information, one gets an idea about exactly
  what is stored in these databases.
So far there don't seem to be any moves here in Australia to change
what legislation is already in place. Though, I must admit that I
haven't gone into depth on this and am relying only upon what the
Department of Transport and Communications and our Attorney General's
Department have told me [by letter and telephone]. Ian Farqhar might
have some comments on the Law Enforcement Access Committee.
I have it on my "to do list" to wander up to the Law Reform Commission
and ask them whether they've considered or are considering any of these
issues (Justice Kirby once wrote an excellent paper in Computer
Networks and ISDN Systems on `Data protection and Law Reform' back in
1979 -- well, I would have been about 7 years old then, I read it at
a later stage).
I'd say this is so. One thing that is particular about Australia is
that our Government "loves" International Agreements and likes to be
seen adhering to them. This fuels my skeptism about changes in our
crypto export laws (which have been unenforced anyways -- for the
reasons mentioned wrt. Phil above) because they come from COCOM
agreements. We've always had close ties with the US, but these have
been wavering, if only slightly, in the last few years. I'd like to
know more about COCOM though, can anyone offer ?
We beat the Australia card (then suffered the Tax File Number in its
place, though not as severe). I'm confident that something as high
profile as Clipper or Key Escrow would have a good level of opposition
where the public can understand the direct application to telephone
conversions, I'm not so confident about general issues of cryptography
though. I suspect this is the case in other countries, but anytime we
see "bulletin boards" and "the internet" on current affairs shows, it
tends to be in the context of underage access to pornography.

@_date: 1994-09-20 19:02:05
@_author: Matthew Gream 
@_subject: Re: Laws Outside the U.S. 
Actually, I have to admit to having a slight fascination with buildings
of this type, some other points about the architecture and location of
DSD HQ: [Note: It's an offence to photograph these facilities, it might
be bordering on the edge of legality to make the following
observations, but these are all a matter of the public record and
intended for informational purposes -- if it's me making them at all
 - It's located in Russell Offices along with most of the Deparment
   of Defence and ASIO's HQ. Just down the road is ASIS, and around the
   corner is the AFP's HQ. It puts a lot of valuable resources in close
   physical proximity.
 - Just above Russell Offices (on Russell Hill in fact) is a lookout,
   you drive up from ADFA. Standing up here gives you direct line of
   sight into DSD and all the other Defence buildings, you can watch
   people walking around. Interestingly, when I drove down and back
   around the front and looked back up to lookout, a utility had pulled
   up. In any case, employees have questionable ability to remain
   "anonymous".
 - Right along the front of the building is a major road, a couple of
   feet away stands the razor fencing, then the building is a few more
   feet inside, on the other side of the road is a carpark. The
   guardhouse for entry into the "complex" sits just off the road too.
 - You can drive up around the back of the complex, there is a little
   road that has the DSD facility on the lower side and bushland on the
   upper. You can get out and walk up to the fence and stare straight
   down into a smaller inside carpark and people walking around.
 - The building immediately adjacent to the road out the front only
   stands some 20 or so metres high, it has no windows and is quite
   recent --> the TEMPEST sheilding you mention. The other buildings,
   more than likely only for administrative purposes have darkened
   windows. More than likely it extends to a significant distance
   underground.
 - There are no obvious antennas on or near it at all. Although the
   Defence Integrated Secure Communications Network (DISCON) has it's
   certain switching station at Canberra, this is mainted by another
   division within the Defence Dept. (DSD is an "outrider" organisation
   anyway). Desmond Ball's book shows a picture of a sat dish at
   Watsonia for NSA uplink, used when DSD were in Melbourne -- there
   is none of this in Canberra. I'm pretty sure Defence maintains a
   communications facility just out of Canberra (not far from    Tidbinbilla (sp?), probably initially processed there and leased
   line into Russell Offices ?).
 - DSD uses the Signals Corp, and when a new battalion relocated to
   Moorebank Army base, as they were building it, someone who drove by
   daily remarked to me that up went the frame, then went in a room
   concreted with only one doorway and subsequently wrapped in
   "insulation". They then bricked the building up as per usual, ie.
   adding another layer over this "room". When the work in this room
   (I'm told), the shifts last about 4-6 hrs, they enter and don't
   leave until their time is up. Standard security procedures I guess,
   interesting to see it on your proverbial backdoor none the less
   :-).
Not exactly what most people go and see on their holidays, but then
I've never been like "most people" :-) [footnote: I take a purely
passive and observant role in these affairs].
ps. There's also the Brian Wilshire conjectured "Big Brother
Information Processing Centre" at St. Leonards (I could see it out the
window of my previous place of employment!), but it's nothing more than
Telecom's Data Processing Facility. Brian Wilshire (talkback host on
local 2GB, author of "Fine Print") is a loony anyway.

@_date: 1994-09-20 19:15:55
@_author: Matthew Gream 
@_subject: Re: Laws Outside the U.S. 
Possible misconception (was rushing to beat a system downtime):
When I mean "hasn't been applied", I mean as in it doesn't seem that
anyone has been prosecuted explicitly for crypto export. The
regulations deal with lots of other things as well (export to Iraq,
Libya,  and export of nuclear and
munitions et al) and it's sure to have been enforced on many other

@_date: 1994-12-04 16:42:55
@_author: Matthew Gream 
@_subject: Re: gambling machines 
To exercise my ecash software I had a few goes at this and found at
least one problem; payments not honoured. In ten games I obtained two
four of a kinds, the first on a 0.25 bet which should have resulted in
a payment of 6.25. No payment as received. The second time it was on a
wager of 1.00,
 You have won!
  Your final hand was a Four of a Kind. The winnings for this hand was
  $25. This sum is being deposited in your CyberWallet right now.
again --- no payment received. Admittedly, four other small payments
succeeded, with values of less than and equal to 2.00 (for two of a
kinds and so on). I assume this is caused by some kind of bug, not any
deception on behalf of the operator; but it does illustrate a potental
problem as I really don't have any `proof' with which to challenge.
Not that I'm worried; it being a beta and all that. But one would
expect a `real' system to provide better assurances (wrt. payments
being honoured and guaranteed rates of return). Clearly we're
experimenting here.
Matthew Gream
(sw/hw engineer)
+61 (02) 821-2043

@_date: 1994-12-06 16:04:34
@_author: Matthew Gream 
@_subject: Re: GUCAPI (Grand Unified Crypto API) 
QoS considerations. If the purpose of the API is to allow polymorphic
access to cryptographic operations, then you need to provide a method
to select `methods' based on particular needs (you're the client, you
want the assocation to meet specific contractual requirements).  For
example, you may specify key bounds or block sizes.
At the same time, you need to reduce the interfaces complexity and
overhead, which could mean for example that `limited' implementation
could do without the QoS aspects; ie. elements need to be clearly
seperable and orthogonal.
For example, I could envisage:
    resp_t
    skcs_open (skcs_ctx * ctx,                void * name, uint name_sz, uint name_type,
               bucket * qos, bucket * param)
    resp_t
    skcs_process (skcs_ctx * ctx,
                  void * iblock, uint iblock_sz, unit * iblock_pos,
                  void * oblock, uint oblock_sz, uint * oblock_pos,
                  bitstring options)
    resp_t
    skcs_close (skcs_ctx * ctx, bitstring options)
where:     typedef struct bucket_str {         struct bucket_str * next;
        void * data; uint type; uint length     } bucket;
and qos types could include:     QOS_KEYSZ_MIN, QOS_KEYSZ_MAX, QOS_KEYSZ_RANGE,
    QOS_INBLOCKSZ_MIN, ....
param types could include:     PARAM_KEY, PARAM_IV, PARAM_FEEDBACK_BITS
or something like that. But by the same token, you'd want to ensure
that there is something like the following so the additional overhead
of chained buckets could be avoided.
    resp_t
    skcs_set_param (skcs_ctx * ctx, void * data, uint type, uint length)
The point is that the provision of such a `generic' method of
specifying attributes lends itself to support a diverse set of
algorithms and cryptographic modules. The `skcs_open' could well be a
subset of a more generic `crypto_open'. By the same token, there
could exist a `skcs_DES_open' and `skcs_IDEA_open' for use when you
know the specific algorithm you want and want to avoid additional
I'm only considering a cryptographic operations interface, not one that
deals with more generic `security' operations, such as in GSSAPI. But
there are plenty of issues to be examined and resolved.
discuss away!
Matthew Gream
(sw/hw engineer)
(02) 821-2043

@_date: 1994-12-06 16:15:47
@_author: Matthew Gream 
@_subject: Re: GUCAPI (Grand Unified Crypto API) 
Ohh, I misinterpreted. You're talking about a high level interface that
assumes cryptographic operations are already being used for specific
purposes (ie. `signature', `GetMIC', `VerifyMIC', `Wrap', `Unwrap').
I was thinking more about the layer below this, the primitive operations that don't make assumptions on what the user is going to do; and limitations placed thereupon.
In the middle of the year I worked on a Radio Show that delved into the
PGP and Clipper debarcle, it was titled `Tales from the Crypt'.
Subsequently I submitted it for a Government sponsored contest for
excellence in technical, science and engineering journalism. I found
out yesterday that I've taken out a prize for the best work conducted
by someone under the age of 26. There is a certain irony in being
awarded the prize by a Government department :-).
Matthew Gream
(sw/hw engineer)
(02) 821-2043

@_date: 1994-12-13 15:41:11
@_author: Matthew Gream 
@_subject: ohh, sheesh! forget that last message. 
slip of the fingers, my apologies for the last message.
Matthew Gream
(sw/hw engineer)
(02) 821-2043
