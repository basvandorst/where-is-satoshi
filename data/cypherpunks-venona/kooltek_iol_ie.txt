
@_date: 1995-08-31 17:34:35
@_author: jmcc 
@_subject: Re: Fiat Shamir Zero Knowledge Test 
The standard text on this is the paper "How To Prove Yourself" by Fiat and
Shamir. I'll try and dig up the name of the ftp site I found it on but in
the meantime here is a rough description.
The access control system for RCA DirecTv was developed by News Datacom.
They, News Datacom, also developed the security for the VideoCrypt system
here in Europe. The smart card used in VideoCrypt here in Europe has been
continually reverse-engineered for the last three card issues. (currently on
issue 09). Therefore much of the description below is based on the European
system. Of course the fact that the DSS cards are now turning up in Europe
repainted as Sky cards indicates that the ROM is identical. This is where
the routined for card i/o protocols and data packets are. As a result, the
DirecTv system probably uses the same packet types. Any of the pirate smart
card emulator programs available on BBSes on FTP sites can be used to
monitor the data flowing to and from the card. Cutting to the chase:
Packet - Direction- Bytes - Function
70       C > D      6       Card presents  6 byte ID number to decoder
7C       C > D     16       Card sends tiering/authorisation levels to decoder
7E	 C > D     64       Card sends X value for ZKT to decoder 80       D > C	    1       Decoder sends Q flag to card (either 00h or 01h)
82       C > D     64       Card's Y ZKT response to decoder
70       C > D      6       Card presents 6 byte ID number to decoder
The Fiat Shamir ZKT as used in here is dependent on a number of elements:
S, the serial number of the card. N, the common modulus. R, the look-up table in the card (a block of data).
X, the value sent by the card to be authenticated.
Q, the calculation mode flag (either 00h or 01h)
Y, the calculated response from the card.
The X value is calculated as X=R^2 mod N. The Y responses are calculated as
 Y = R if Q=00h
 Y = (R * S) mod N if Q=01h
The Q flag tells the card how to generate response Y. The card would be
authenticated in the following cases:
If Q=00h then Y^2 = X mod N
If Q=01h then Y^2 = (X * V) mod N where V is the card identity number
received prior to the authentication process. S, the card serial number is
derived from V by the equation: S = sqrt (V) mod N
The implementation of the ZKT in VideoCrypt is faulty and open to a simple
hack. It is designed to make the card authenticate itself. Many of the
earlier decoders had a flaw in the ZKT calculation routines in the decoder.
Of course the data in the decoder was easily popped by hackers since the
microcontroller in charge of the authentication was not secured.
In the VideoCrypt system, one of the latest bypasses for the ZKT is to
record the response from a valid card and have the pirate card replay it.
This saves a lot of time and it does work perfectly.
Since the complete contents, (ROM and EEPROM), of the VideoCrypt card are
now available, the whole idea of authentication is invalid. In the DSS
system, however, there the ZKT is still viable though there are some ways in
which it theoretically could  be bypassed if it uses the same implementation
as VideoCrypt.
(John McCormac)
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6.2
-----END PGP PUBLIC KEY BLOCK-----

@_date: 1996-03-30 17:13:23
@_author: Hack Watch News 
@_subject: Re: [NOISE] Cable-TV-Piracy-Punks 
The DSS smart card has been reverse-engineered for at least six months now
and pirate devices are in the market. The encryption used on those systems
is good but it does not stand up to a well financed attack. In the European
version of the system, the encryption routines were using a hashing
function. The input packet also carried the authorisation data so it was
using this as an input packet. The DSS routine is probably based on a
similar hashing routine.
Using DES to encrypt the audio on the fly is an old technique and was used
in the VideoCipher II system. Most of the more recent systems use a PRNBSG
EXORed with the digital audio data stream. The problem of piracy will still exist on digital systems. The DSS system is
a completely digital system and it too is hacked. Admittedly some of the
elements of security in the DSS are good, most can be rendered void by
hackers. The problem for DSS is that the smart card they used is not secure
enough. It was a Motorola 6805 type. What appears to be the pattern with the
hacks on more recent smart card systems is an inversion of the original
pattern on the simple analogue systems. The original pattern was that some
hobbyists would figure out how to hack the system and then the hack would be
commercialised. With the smart card hacks - the pattern is inverted so that
it becomes a trickle down pattern. The professional hackers reverse and
emulate the smart card and then the code is sometimes hacked from the
emulator card and then distributed among hobbyists.
The most dangerous thing in all this is that the smart cards that have been
hacked in Pay TV systems throughout the world are also used in other
applications. The expertise and the knowledge of reversing smart cards is
now more common in the Pay TV piracy business. There is always the
possibility that these skills could be applied elsewhere.
John McCormac            * Hack Watch News
jmcc       * 22 Viewmount, Voice&Fax: +353-51-73640 * Waterford,
BBS: +353-51-50143       * Ireland
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6
-----END PGP PUBLIC KEY BLOCK-----

@_date: 1996-06-16 09:50:49
@_author: Hack Watch News 
@_subject: Re: Fuseable Links - no guarantees?? 
The advert was probably for a device/program called PICBUSTER. This is
basically a technique of popping the PIC16C84 microcontroller. The chip is
an EEPROM micro. There are a few ways of popping the chip but the simplest
is to ensure that there is set the supply voltage to the programming voltage
less about 0.7 Volts. This is generally done with the aid of a diode such as
the 1N4148. Then the fuses are reset. For normal programming there should be
at least 5 Volts differential. The smaller differential seems to only allow
the protection to be popped. It is not a fusible link as such.
If you want to read the details they are on
Apparently the protection fuse in the EPROM versions of the microcontrollers
are fairly readily identifiable. Most of the OTP microcontrollers are
essentially EPROM types without the quartz glass window. The commonest procedure for popping these is to first remove the coating and
then to measure accurately where the protection fuse is. Then, with another
that is to be popped, a small hole is drilled over the fuse area. The
drilling operation stops before reaching the silicon die. Then some strong
acid, either Sulphuric or Nitric is dropped in to disolve the coating. Then
a UV lamp is shone on the fuse to reset it.
The latter techique for popping chips is by far the most dangerous. It
requires proper acid handling procedures and good ventilation. Another technique is to fool the microncontroller into switching from
internal to external EPROM and then back. This hack generally works on the
8051, 8751, 8052 and 8752 microcontrollers.
I was coincidentally just finishing a section on popping chips for a book
that I am working on :-)
(John McCormac)
John McCormac            * Hack Watch News
jmcc       * 22 Viewmount, Voice&Fax: +353-51-73640 * Waterford,
BBS: +353-51-50143       * Ireland
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6
-----END PGP PUBLIC KEY BLOCK-----

@_date: 1996-08-29 12:02:28
@_author: Hack Watch News 
@_subject: Re: stego virus 
The GIF would contain the operational data and the viewer would contain the engine. Both would be inert until mixed just like binary nerve gasses. The problem would be detecting the data in the GIF or indeed any other form of file. Theoretically it could even be part of a text file using the high bits.
Regards...jmcc

@_date: 1996-11-20 13:29:32
@_author: Hack Watch News 
@_subject: Re: Cracks Are Found In Smartcard Security (fwd) 
The smart cards in use by banks to protect transactions seem to use RSA
and DES algorithms. Now these algorithms are computationally difficult
to hack. Therefore an attack via cryptographical route would not be
envisaged by those who specify the system for the bank.
With the research into popping smart cards using fuming Nitric Acid, the
keys used for these transactions could be extracted from a smart card
within a few hours. Thus with the keys extracted, RSA and DES become
even more vulnerable because they are such well known algorithms. It
would be easy for someone to implement them in a pirate smart card as
indeed has been the case in European satellite Pay TV piracy. (France
Telecom used DES as the cryptographical basis for their EuroCrypt-M
access control overlay for the D2-MAC television standard).
The Fiat-Shamir ZKT was also demonstrated to be vulnerable using a
similar approach. It was possible to extract the necessary data to allow
pirate cards to spoof a valid ZKT response. Of course the original
version of this flaw was due to incompetence on the part of the system
designers (they never secured the card-decoder interface
microcontroller). A later implementation integrated the result of the
ZKT with the output of the algorithm thus making it a more secure
implemenation. However the smart card was popped (reverse-engineered
using the techniques desicribed in the paper) making it all academic.
The bottom line is that the security of smart cards is both highly
overrated and depends on a high level of bluff. Most people would not
attack a smart card because they think it is secure. However in European
satellite television piracy, most of the systems have been shown to have
flaws either in the technology or the implementation. (Naturally the
best reference on this is European Scrambling Systems 5 - The Black Book
ISBN: 1-873556-22-5 ;-) )
The relevant paper is at:
