
@_date: 1996-01-26 16:17:02
@_author: Peter Wayner 
@_subject: Re: "Concryption" Prior Art 
Death rays from Mars made pcw (Peter Wayner) write:
There's a much earlier paper by Frank Rubin in a 1979 Cryptologia which
covers encryption+compression with Huffman and arithmetic coding.
However the Con-cryption patent covers first compressing, then
encrypting.  Unless they've got very good lawyers, you can probably
ignore it.

@_date: 1996-02-09 11:08:34
@_author: John Pettitt 
@_subject: Re: Encryption and Backups 
Death rays from Mars made jpp (John Pettitt) write:
It's slightly more secure than the widespread double rot-13 encryption.  PC
Tools uses 2-round DES (or at least it did the last time I looked).  There's some criticism of this in the SFS docs somewhere.

@_date: 1996-03-25 11:48:01
@_author: Alan Olsen 
@_subject: Re: protection on IoMega ZIP drives 
Death rays from Mars made alano (Alan Olsen) write:
The Zip drives have a firmware bug in that they don't do anything if the
(appropriately-named) FUA bit is set in SCSI requests, and then return a
command complete status.  SFS 1.20 has a workaround for this problem.  It
works with both SCSI and parallel-port versions.  Before anyone asks
when it's due out, its the end of February, probably about the 60th of the

@_date: 1996-03-27 15:06:22
@_author: and possibly back out of 
@_subject: Test case for RSA t-shirts 
[I posted this to comp.org.eff.talk but got virtually no response, maybe
 someone here can make use of it]
In July I'll be going to the US for a conference.  I have one of Adam Backs
RSA-in-perl t-shirts and am prepared to wear it into (and possibly back out of)
the country if anyone feels it would do any good (for example to act as a test
case for exportability).  If anyone thinks this would be useful or wants to
offer a legal opinion, let me know.
For something less trivial, I can also carry in a disk of crypto code or
something similar (say, 20 pages of DES bar codes) and see if I'm allowed to
take it back with me.

@_date: 1996-03-30 19:11:04
@_author: YY, XX, 8 
@_subject: Re: trouble with idea.c from cryptl99.zip 
Tall men in dark suits made Jack Mott  write:
Arrgghh!!! That defeats the whole purpose of the library, which is to provide a
standard interface to many different algorithms.  If you use the routine the
way it's meant to be used (via initCryptContext(), etc) it'll work fine.
BTW the reason it isn't encrypting is that by the looks of it you're not
calling the IDEA key schedule code.

@_date: 1996-04-01 17:24:20
@_author: FUeV 
@_subject: New release of SFS available 
I have just uploaded version 1.19 of SFS to the grumbo.uwasa.fi FTP site as:
 551004 Apr 01 01:19 grumbo.uwasa.fi:/pc/crypt/sfs119.zip
This release contains a number of major improvements over previous versions.
The most important is that it follows recommendations on the use of encryption
software to be released later today in a joint announcement by the Committee of
Ministers of the Council of Europe and the US State Department.  To this end the
new version of SFS will abandon the use of MDC/SHS in favour of a classified
algorithm which the both NSA and GCHQ are confident will protect non-
confidential data.  Although the exact algorithm details cannot be published
due to its classified nature, it can be revealed that it uses prime number
cycle wheels, a system still employed today at the highest levels.
This algorithm improves on MDC/SHS by using a massive 2048-bit key, which would
take billions of years to exhaust via a brute-force search.  However in order
to satisfy the requirements of various organizations such as the Chinese
government (who need to ensure that no nasty outside influences pollute the
minds of their citizens) and to allow the originators of the 83.5% of all
Usenet traffic which contains porn to be prosecuted (a recent example being the
widely publicised move by the Office of the Bavarian Illuminati to force
Compuserve to drop all sex-related newsgroups), SFS 1.19 will store 2032 bits
of the key in the clear along with the encrypted data.
The head of the FBI Louis Freeh has been quoted as saying that "this will
provide adequate protection against your little sister or your mother, while
allowing law enforcement agencies to investigate people using encryption for
illegal purposes".  The head of the French DSSI agrees: "There have been too
many cases of industrial espionage by foreign government intelligence agencies.
For example in 1993 one such agency acquired over $1 billion worth of business
for their own countries' companies in this manner.  SFS 1.19 will protect
against this problem, while allowing us to maintain control over French
national security interests".
The German government has tentatively approved SFS 1.19 for public use provided
that it undergo a few small changes to comply with an updated form of the the
Fernmeldeanlagen Ueberwachungs-Verordung (FUeV), which will require that all
German users of SFS be connected to a central system to which copies of all
keys used, times of encryption and decryption, identities of users, and copies
of all encrypted data, be automatically forwarded.  The Minister of the
Interior Manfred Kanther stated that "this should fulfil the requirements of
the German government for monitoring possible criminal use, although I might
change my mind about this in a minute or two".

@_date: 1996-04-14 06:16:22
@_author: J.UCS 
@_subject: New paper on crypto regulation and the right to privacy available 
A paper exploring various aspects of cryptography and cryptography regulation
has just been published in the Journal of Universal Computer Science (J.UCS).
J.UCS is a Springer-Verlag electronic publication available at
J.UCS.  It's coming off a non-HTTP server so I can't give a direct URL, you
need to follow the links to Volume 2, No.3 to find:
  Government, Cryptography, and the Right to Privacy
  J.Shearer, P.Gutmann
  The notion of a right to privacy of citizens in their communications is
  discussed in the context of an international movement by governments towards
  regulation of cryptography, and consideration of key forfeiture systems in
  national cryptography use.  The authors argue that the right to privacy in
  communications networks is an issue of major importance, assuring freedom of
  the individual in national and global communications.  Regulation and control
  of cryptography use on the Internet by national governments may lead to an
  imbalance in the citizen/government power relationship, with sequelae
  including unprecedented surveillance of citizens, disruption of international
  commerce due to lack of powerful cryptography (and lack of standardisation),
  human rights abuses by less democratic or non-democratic governments, and
  limiting of the political potential of an Internet global political system.

@_date: 1996-05-18 08:21:12
@_author: Greg Morgan 
@_subject: Re: Any DLL's that handle Public Key Encryption or Key Exchange? 
Tall men in dark suits made draven (Greg Morgan) write:
The next release of my encryption library (currently available as
ftp://garbo.uwasa.fi/pc/security/crypl110.zip) will contain a nice fast RSA
implementation.  It includes 16 and 32-bit DLL's.  Actually the current version
has support for it, but I took out the code because the key management routines
weren't ready yet.
There are two things worth noting, the first is that RSA itself isn't much use
without a *lot* of key management code (which is what's holding up the
RSA-enabled version).  The second is that if you're in the US you're probably
going to run into legal hassles using this code unless someone wants to do an
alternative RSAREF implementation which you can plug in in place of the
existing RSA code.

@_date: 1996-05-18 16:06:07
@_author: lib_rsa.c 
@_subject: Re: Any DLL's that handle Public Key Encryption or Key Exchange? 
Death rays from Mars made Bill Stewart  write:
I've already got a nice fast RSA implementation, so I think I'll stick with
that.  Besides, I'm not terribly keen on using a library which has stolen code
in it.
If anyone wants to create an RSAREF version, all you need to do is replace one
module (lib_rsa.c) with an RSAREF-compatible version (that's why I mentioned
plug-in encryption modules in the docs - you just unplug the existing code and
plug in RSAREF instead).  What you need to do is use RSAPublicBlock() and
RSAPrivateBlock(), the rest is just wrapper code which you can base on the
existing lib_rsa.c.  My estimate is that it's about an afternoons work.
I got permission from RSADSI to bypass the official interface to RSAREF for
HPACK, my archiver which has PGP-compatible encryption, in 1993.  However I
suspect getting permission for the same thing in a general-purpose library,
especially one which has RC2, RC4, and DESX[1] in it, may be difficult since
parts of the library are essentially a free version of BSAFE (not by design,
they just ended up that way).
[1] Well, it will have DESX once I can get some test vectors to make sure I've
    got it right.  Does anyone have some I can use?

@_date: 1996-05-27 13:45:13
@_author: which has Toolhelp32 
@_subject: cryptlib debugging for Win95, WinNT 
In order for the RSA encryption functions in cryptlib
(ftp://garbo.uwasa.fi/pc/security/crypl110.zip, but that one's without
the RSA stuff for reasons which will become apparent) to work, I need to
find someone to test the Win95 and WinNT random-number generation code,
which calls various Win32 statistics-monitoring functions to seed its
internal random number pool.  I've written most of the code, but since some of the documentation for the API's is pretty dodgy, it'll need a bit of
debugging and testing to get going.  Is there anyone here who can help
with this?  I estimate that it's an hour or so of work for the Win95 side
(which has Toolhelp32), and maybe half a day for NT (which has the incredibly
complex registry-walking system and semi-documented network statistics
gathering).  There are two files to compile, with a total size of about 20K.
I can't do it myself since I don't have easy access to any sort of Win32 Oh yes, this part of the code has nothing to do with crypto, so there are no
problems with US people doing it.

@_date: 1996-07-07 00:39:49
@_author: user 
@_subject: Transforming variable- to fixed-length keys 
In preparing the next version of cryptlib (which is going to have some cool
features when it's ready, which should be before the end of the millenium),
I've run into a problem in writing a general-purpose n-byte input to m-byte
output transformation function.  What this does is take an arbitrary-length
user key and transform it to a fixed-length encryption key (for example an
entered passphrase into a 112-bit triple-DES key).  The constraints on memory
usage are:
- The input (user) key can't be altered (you can't change data passed in by the
  caller)
- The user key can't be copied to an internal buffer (it can be of arbitrary
  length, and is sensitive material so shouldn't be copied elsewhere)
In other words there's no temporary storage available apart from what's
provided in the output key.  This is almost always a different length from the
input key.
Some other constraints are:
- The transformation must be algorithm-independant (it shouldn't, for example,
  rely on SHA1 to transform an input string into a fixed output of 160 bits and
  assume you'll never need a key longer than 160 bits).
This means you can't just use a single pass of a hash function to generate the
output key, since the output can be smaller or larger than the hash function
- The transformation must be able to be iterated to make a password-guessing
  attack harder to perform.
This one is tricky, since the lack of temporary buffer space means you can't
just feed the output back to the input and iterate.
Here's my initial approach, if anyone has any comments to make on this or knows
of a better way to do it, please let me know.

@_date: 1996-07-10 00:06:17
@_author: or some other feedback mode 
@_subject: Re: Transforming variable- to fixed-length keys 
This doesn't work because the input and output buffer will almost always be of
different lengths.
No.  Each chunk is a new hash with , where  defaults to
SHA1.  Since (for SHA1) 64 bytes of input affect each 20 bytes of output, I
don't think there's much need for chaining.  I'm trying to keep the
specification as simple and easy to check as possible (one of the problems with
the PGP data management was that it was rather complex and hard to follow.  I
suspect it would be difficult to implement a compatible version going only from
a written specification).
The input wraps, just like the output, so for example the letter "a" would be
hashed as:
 aaaaaa[...]
That's another possibility.  The only thing here is that you're only changing
one byte for each pass, and I'm not sure if this is healthy.  I'll see what the
sci.crypt crowd (those who've survived the spamming) has to say about this - it
may actually be stronger than my increment-by-one method if you're worried
about related-key cryptanalysis.

@_date: 1996-07-20 18:00:29
@_author: "David F. Ogren" 
@_subject: Re: Making encoding out of an authentication cipher 
Green alien space slime made ogren ("David F. Ogren") write:
It depends.  On a PC (the most common type of computer hardware) you're limited by the bus speed.  Most encryption cards are still ISA (so far I've managed to find a single PCI DES card, everyone is still shipping ISA cards because they're the lowest common denominator).  This means that even with a 15 MB/sec DES chip you can't get more than 1 MB/sec throughput.  I think the breakeven point for MDC/SHA vs the ISA bus is either a P5/90 or a P5/100 (I don't have access to either of them to check this right now).  This isn't just for MDC, virtually anything on any recent PC is faster than the ISA bus (in fact from Eric Youngs libdes figures there are CPU's which will do software 3DES faster than hardware 3DES on an ISA bus).

@_date: 1996-07-31 14:24:31
@_author: unknown_name 
@_subject: Re: RPK Public Key Cryptography 
Tall men in dark suits made Stephen Cobb  write:
It's just Yet Another PKC.  Look at the history of LUC for a similar example:
An amazing new breakthrough in PKC is announced, after a couple of years of
analysis by cryptographers it's found to be no better or worse than existing
PKC's, but in any case noone uses it because the existing patent covers only
the US and expires in a few years whereas the LUC ones cover much of the world
and will be around for ages.  RPK is a similar case (actually it's in a
somewhat worse position, by the time it's been subjected to enough analysis for
people to trust it, the RSA patent will have expired, making RPK unmarketable). Other comments on the system:
 - The inventor apparently has no plans to publish details on the system in a
   journal or present it at a conference for peer review.
 - Someone who used to work with him rates him as a fairly competent
   programmer.  His crypto skills are unknown.
Given what happened with LUC I predict more of the same for RPK.

@_date: 1996-08-03 15:24:51
@_author: compressed 
@_subject: Re: crypto CD source 
I have about 100MB (compressed) of crypto archives, papers, source code, etc
etc, reasonably well organised with descriptions of each file.  I've got a
friend to put it on CD, but only for my own use.  If there's someone who can
get them done in bulk outside the US you could probably use this as a crypto CD
(I don't think there's anyone in NZ who could do it, and I don't really want
the hassle of organising the whole thing).

@_date: 1996-08-09 06:19:08
@_author: a 
@_subject: An SSL implementation weakness? 
The following weakness seems very obvious, I've got a partial writeup of this but before I turn it into a paper or something and arrange a demonstration of how it would work I thought I'd check to make sure (a) someone else hasn't mentioned it before, and (b) it is actually possible (it seems too simple to be true):
1. Using DNS spoofing, stage a hostile takeover of an address (for example    using bogus referrals set yourself up as the delegated server for a DNS    subtree).
2. Get a Verisign certificate for an arbitrary company and set up a bogus site    at the stolen address.
Lets say you steal   People connect to this site (which is actually your bogus site), Netscape (for example) displays the blue line and non-broken key (which is actually for your J.Random certificate rather than the real megafoobarcorp one) to show the connection is secure, and you've just subverted their site.  The problem is that unless the user on the client side checks their certificates (which noone does), all they're told is "A secure link is established", not who the secure link is established to.  Even if browsers did pop up a dialog to tell them who the secured connection was to, after about the third time people would click on the "Never show this incredibly annoying dialog again" option and never look at it again.     This effectively reduces an attack on an SSL-enabled server to an attack on the DNS.  Is this as simple as it seems, and is it worth doing a writeup on?

@_date: 1996-08-22 17:16:37
@_author: unknown_name 
@_subject: SSL: The early days 
I've been trying to find information about the early days of SSL for a paper I'm writing, but I'm finding that someone's comment about the net having a collective memory of about 12 months seems to be true - there doesn't seem to be anything available going back more than a year or so.  In particular I'm interested in:
- Why/how/when did Netscape decide on SSL?
- How long did it take to design the first version?
- I've heard a rumour that when it was first presented at a conference, two   people independantly broke it before the speaker sat down.  Is this true,   and what conference was it?
The later work on SSL (an open design process, contributions from cryptographers and security experts, IETF standards-track work, etc etc) is well documented, but information on earlier work is hard to find.  Does anyone have any pointers to information I could work from?

@_date: 1996-09-07 16:08:06
@_author: Used to be they just kept stuff secret; now they patent some of it. 
@_subject: Re: What the NSA is patenting 
That isn't NSA research, it was merely sponsored by the NSA.  Those are all
university people who have published their work on MFSTM in journals, papers,
and theses (I used some of it in my paper at the Usenix Security Symposium, and
two of the images in my talk were provided by one of Mel Gomez' students). What the NSA is doing in this area is still classified (although I suspect the
techology isn't much different from what's publicly available), in this case
all they were doing was protecting their investment (just like the various PKC
patents originally assigned to universities).

@_date: 1996-09-08 13:37:57
@_author: a few K devices 
@_subject: Re: What the NSA is patenting 
No, the market for the more mainstream MFM's is small (a few K devices), for MFSTM's it's even smaller (a few dozen?).  MFSTM's are usually built by universities for research purposes, which means the patent won't affect them.  As I said before, it's purely a "we paid for the research, we want some paper to wave around to justify the cost" thing.
You can see the results, just read the Journal of Applied Physics or IEEE Transactions on Magnetics.
I know people like to come up with conspiracy theories about the NSA, but this patent won't work as the basis for one.

@_date: 1996-09-12 05:40:35
@_author: SSL 
@_subject: [Long] A history of Netscape/MSIE problems 
I've been putting together a writeup on problems in web browsers, mainly the history of the Netscape RC4/40 break, random number bugs, and problems with Java, as part of a longer paper I'm doing on crypto from a non-US perspective. A lot of the information in this section of the paper has come from this list, so I thought I'd post it for comment and in case anyone found it interesting (please don't post it to web sites or anything until the paper is actually published).  If anyone has anything to add, corrections to make, etc, please let me know.
The Netscape SSL Break and its Implications
After the RC4 attacks, researchers looked for other weaknesses in Netscape.  In
September 1995 it was discovered that Netscape didn't check the amount of input
it was fed, leading to internal buffers being overrun [Green 1995] [Neumann
1995].  This bug also existed in other browsers such as Mosaic and IBM's
WebExplorer.  By carefully adjusting the data fed to the browser, it was
possible to force a victims PC to execute arbitrary code simply by selecting a
URL.  This problem has occurred in the past in a number of other programs such
as fingerd (where it was exploited by the Internet worm [Spafford 1988]), the
CERN and NCSA httpd's (as explained below in the section [!!!!]), and recently
splitvt, syslog, and mount/umount, leading one exasperated mailing-list
moderator to wonder how many more times he'd see this problem [Bloodmask 1996].
The flaw in question can be exploited by ensuring that the code to be executed
is located in the URL at a point where it overflows the end of the buffer.  A
URL can contain almost any data value except for a few characters which have
special significance and a binary zero, a restriction which can easily be
bypassed by selecting alternative encodings for any instructions which cause
problems.  The browser stack looks as follows:
[Diagram: URL buffer, other data, callers saved program counter]
It is therefore possible, by making the URL long enough to overwrite the other
data and saved program counter, to force a jump to an attackers code rather
than returning to the calling routine, allowing an attacker to force the
execution of arbitrary code on the victims machine.  Although this exploit is
machine and browser-specific, by targetting the most common architecture
(Windows on an Intel processor) and browser (Netscape), a reasonable chance of
success can be obtained.
At about the same time the stack overwrite problem was discovered, a basic flaw
was found in Netscape's SSL implementation which reduced the time to break the
encryption from hours to minutes.  Despite an existing body of literature
covering the need for carefully selected random-number generation routines for
cryptographic applications [Eastlake 1994] [IEEE 1995] [Robertson 1995], one of
which even included ready-to-use code [Plumb 1994], Netscape used fairly simple
methods which resulted in easy-to-guess encryption keys [Goldberg 1995]
[Goldberg 1996].  It was found that, under Unix, Netscape used a combination of
the current time in seconds and microseconds and the process ID of the current
and parent process to initialise the random number generator which produced
master encryption keys. The time can be determined to a reasonable degree of
accuracy from the message being sent, the process ID's can be determined using
standard Unix utilities (by people using the same machine that Netscape is
running on), or by using other tricks such as the fact the an approximate
process ID can often be obtained by observing the output of other
network-related programs on the machine, and the parent process ID is often 1
(for example when Netscape is started from an X-windows menu) or close to the
process ID.  Under Windows the implementation was similarly flawed.
The resulting number of values to search are smaller than the number of
combinations in a 40-bit key, and much smaller than the number of combinations
in the 128-bit key in the export-restricted version. Since Netscape never
reseeds its internal random number generator, subsequent connections are
relatively easy to break once the first one is broken.  The researchers who
discovered this problem released a program, unssl [unssl 1995] which would
break Netscape's encryption (both the weak exportable version and the strong
export-restricted version) in about a minute on an average workstation.
Although one of the researchers classed it as "a silly bug", it received large
amounts of media attention, including front-page coverage in the New York Times
[Markoff 1995] and coverage in the Wall Street Journal [Sandberg 1995] and
Daily Telegraph [Uhlig 1995].
Attempts to fix this problem introduced yet more problems.  Under Windows the
browser and server code, which appear to share the same random number code,
don't close some of the file handles they use.  While this has no serious
effect on the client software (which doesn't run over extended periods of
time), it does effect the server, which after a period of time runs out of file
handles so that a number of calls related to gathering random data (some of
them not apparently file-related) quietly fail, significantly weakening the
random-number generation process [RingZero 1995].  The problem of insecure
random number generation was not unique to Netscape, and has in the past beset
XDM (which generates weak xauth keys), Netrek (a network game which generates
guessable RSA private keys), an earlier version of the SecuDE security toolkit
(which again generated guessable RSA keys), and Sesame (a european Kerberos
clone) which uses it to generate DES keys.
Significant security holes are also opened up through the use of Java, which
allows arbitrary programs downloaded from the net to run in a (supposedly)
controlled environment on a host PC.  By breaking out of this controlled
environment, Java applets can act as trojan horse programs on the PC, bypassing
normal security measures.  The consequences of these security problems have
been widely reported and include the destruction of data [Clark 1996], the
ability to access arbitrary files on the system [Felten 1996b], the ability to
forward sensitive information to arbitrary machines on the net (bypassing
firewalls and similar measures, since the "attack" comes from a trusted machine
inside the security perimeter) [Williams 1996] [Markoff 1996], or even run
arbitrary native code on the machine [Felten 1996a] [Hopwood 1996] [Kennedy
1996].  This last class of flaws are the most serious, since they allow any
code to be executed on a victims machine.  The problem was in the class loading
code for the browser and affected all then available browsers rather than just
Netscape, and could be carried out simply by a victim viewing a web page
containing the hostile Java applet.
Java problems can be combined with other attacks such as DNS spoofing (in which
a fake address for a target machine is advertised), allowing a Java applet to
connect to a normally disallowed target machine since the Java security manager
thinks it is connecting to a safe system [Mueller 1996].  Other problems are
less subtle, and can crash the browser (and, under some versions of Windows,
the operating system as well) simply by connecting to a web page [Ref:
Browser-crashing pages].  One report comes to the conclusion that "because of
the wonderful power of the Java language, security problems are likely to
continue" [Neumann 1996].
These problems are not unique to Java.  Microsoft's ActiveX has experienced
similar troubles, exemplified by a sample application which shuts down the
machine, and even turns off the power on systems which support this
functionality [McLain 1996].  The problems extend beyond Java and ActiveX to
other kinds of embedded executable content as well.  For example the ability to
embed macros in documents viewed and downloaded by a browser, in combination
with security holes in the browser, allows an attacker to execute arbitrary
code on a victims system whenever they view the attackers web page [Felten
1996c].  Although this was subsequently fixed, the solution was to issue
warnings for all local files as well as remote downloads, so that after the
first dozen or so messages the user was likely to simply automatically click
"OK" whenever another warning popped up [Walsh 1996].  In addition a hostile
application could access the Windows registry (the system-wide database of
configuration options) to quietly disable the warnings.  This creates a nice
niche for "espionage-enabling" viruses which disable or patch various security
features in operating systems or application software to allow later attacks.
At least one security organisation already uses such a program, a modified
stealth virus, for this purpose.
-> Mention that these are all seperate problems, not the same ref over and
   over.
[Clark 1996] Don Clark, "Researchers Find Big Security Flaw In Java Language"
The Wall Street Journal, 26 March 1996, p.B4.
[Bloodmask 1996] `Bloodmask', "Vulnerability in ALL linux distributions",
posting to linux-alert mailing list, 30 July 1996.
[Eastlake 1994] Donald Eastlake, Stephen Crocker, Jeffrey Schiller, "Randomness
Recommendations for Security", RFC 1750, December 1994.
[Felten 1996a] Ed Felten, "Security Flaw in Netscape 2.02", Risks-Forum Digest
Vol.18, Issue 13, 17 May 1996.
[Felten 1996b] Ed Felten, "Java security update", Risks-Forum Digest, Vol.18,
Issue 32, 13 August 1996.
[Felten 1996c] Ed Felten "Internet Explorer Security Problem", Risks-Forum
Digest, Vol.18, Issue 36, 21 August 1996.
[Goldberg 1995] Ian Goldberg, "Netscape SSL implementation cracked!", posting
to cypherpunks mailing list, message-ID:
<199509180441.VAA16683 18 September 1995.
[Goldberg 1996] Ian Goldberg and David Wagner, "Randomness and the Netscape
Browser", Dr.Dobbs Journal, January 1996, p.66.
[Green 1995] Heather Green, "Netscape Says Hackers Uncover 3rd Flaw in Its
Internet Software", The New York Times, 25 Sep 1995.
[Hopwood 1996] David Hopwood, "Another Java security bug", posting to
comp.lang.java newsgroup, message-ID <4orf1q$t6f 2 June 1996.
[IEEE 1995] IEEE P1363 Appendix E, "Cryptographic Random Numbers", Draft
version 1.0, 11 November 1995.
[Kennedy 1996] David Kennedy, "Another Netscape Bug US$1K", Risks-Forum Digest,
Vol.18, Issue 1422, May 1996.
[Markoff 1995] John Markoff, "Security Flaw Is Discovered In Software Used in
Shopping", The New York Times, 19 September 1995, p.A1.
[Markoff 1996] John Markoff, "New Netscape Software Flaw Is Discovered", The
New York Times, 18 May 1996, p.31.
[McLain 1996] Fred McLain, "ActiveX, or how to put nuclear bombs in web pages",
[Mueller 1996] Marianne Mueller, "Java security", Risks-Forum Digest,  Vol.17,
Issue 79 23 February 1996.
[Neumann 1995] Peter Neumann, "Third Netscape weakness found", Risks-Forum
Digest, Vol.17, Issue 36, 27 September 1995.
[Neumann 1996] Peter Neumann, "More Java, JavaScript, and Netscape problems",
in "Security Risks in Computer-Communication Systems", ACM SIGSAC Review,
Vol.14, No.3 (July 1996), p.22.
[Plumb 1994] Colin Plumb, "Truly Random Numbers", Dr.Dobbs Journal, November
1994, p.113.
[RingZero 1995] `RingZero', "NEW Netscape RNG hole", posting to cypherpunks
mailing list, message-ID <9510080732.AA14015 8 October 1995.
[Robertson 1995] Richard Robertson, "Random Number Generators Draft", IEEE
P1363 Random Number Generators Review Group, May 1995.
[Sandberg 1995] Jared Sandberg, "Netscape's Internet Software Contains Flaw
That Jeopardizes Security of Data", The Wall Street Journal, 19 September 1995.
[Spafford 1988] Gene Spafford, "The Internet Worm: Crisis and Aftermath",
Communications of the ACM, Vol.32, No.6 (June 1989), p.678.
[Uhlig 1995] Robert Uhlig, "Security threat to Internet shopping", Daily
Telegraph, Daily Telegraph (paper edition), 3 October 1995, p.12.
[unssl 1995] ftp://ftp.csua.berkeley.edu/pub/cypherpunks/cryptanalysis/unssl.c.
[Walsh 1996] Mike Walsh, "Microsoft's warning", Risks-Forum Digest, Vol.18,
Issue 38, 26 August 1996
[Williams 1996] Eric Williams, "New Netscape 2.0/2.01 Security Issue (Java
Sockets)", posting to comp.lang.java newsgroup, message-ID
<4jppdt$ake 1 April 1996.
[WSJ 1996] The Wall Street Journal, "Princeton Team Finds Bug In Part Of
Netscape Program", 20 May 1996.

@_date: 1996-09-16 00:13:59
@_author: SPA 
@_subject: Re: [Long] A history of Netscape/MSIE problems 
It's in AC II, p.319 (I was getting worried for a minute, I missed it the first
time I looked and then couldn't figure out where I'd got the info from).
It's mentioned in the list of minor RC4 weaknesses.  I didn't include refs for
all of these because I've already probably got as many references in there as
text (the term "reference terrorism" has been used to describe some of my
papers in the past).
Interesting... does anyone want to comment on this?  This kind of damages one
of my assumptions in the paper that publicity attacks can hurt a company
providing poor security.  Could it be that at the time people would buy
Netscape stock no matter what happened?  If MSIE had been widespread at the
time, would it have caused people to jump ship en masse?
It's a pretty obscure attack and one which most implementations (ones running
on home PC's) won't ever need to worry about, given that it's many times easier
to get a victim to download some whiz-bang ActiveX applet which quietly patches
their browser to use a fixed key for all SSL sessions.  Has anyone thought of
doing this?  If I had a system (and compiler) capable of building ActiveX
apps I'd love to do this - create an espionage-enabling screen saver or

@_date: 1996-09-18 00:21:00
@_author: unknown_name 
@_subject: Re: [Long] A history of Netscape/MSIE problems 
In case anyone's interested, I've finally found the source I used for the claim that RC2/RC4 were exportable if the details were kept quiet:
  "Details about them [RC2 and RC4] have not been published (including by    patenting) in order to maintain their special export status".
       -- RSA FAQ, version 1.0, draft 1e, 14 September 1992, p.40.
This makes sense - the NSA wouldn't want the details published to stop non-US non-crippled versions appearing, and I can't really imagine RSADSI volutarily not patenting a new algorithm.

@_date: 1996-09-23 14:37:24
@_author: typically a long passphrase 
@_subject: Transforming variable-length to fixed keys 
I posted this to sci.crypt recently but the response to it was rather
underwhelming, so I thought I'd repost it here to see if anyone has any
comments on it.  What it is is a scheme for transforming arbitrary user keys
(typically a long passphrase) into a fixed-length key for a particular
algorithm.  This has the following properties:
1. The user key 'userKey' is transformed into an algorithm-specific key 'key'
   using a number of 'iterations' of a hash algorithm 'hash()'.
2. The transformation is strongly serialized so that any form of attack
   involving parallelization or precomputation isn't possible.
3. The transformation is non-reversible, so that recovering the transformed key
   won't recover the original key.
4. The result of the transformation is algorithm-dependant, so that if an
   attacker recovers a transformed key for one algorithm they can't recover the
   transformed key (from the same user key) for another algorithm.
5. The transformation can be iterated as often as required to make
   password-guessing attacks difficult.
6. The transformation process is algorithm-independant and can use any type of
   hash algorithm and original and transformed key size.
The transformation algorithm (which was designed with the help of John Kelsey)
is as follows:
   key[] = { 0 };
   state = hash( algorithm, mode, parameters, userKey );
   for count = 1 to iterations
     for length = 1 to keyLength (in hash_output_size blocks)
       state = hash( state );
       key[ length ] = hash( state, userKey );
The state acts as an RNG which ensures that the key hashing is serialized.
The initial state depends on all encryption parameters, not just the user key.
If we hashed the user key directly and then used it for a number of algorithms
then someone who could recover the transformed key for one algorithm could
compromise it if used for other algorithms (for example recovering a DES key
would also recover half an IDEA key).  Hashing all algorithm-related parameters
means that a successful attack one an algorithm, mode, or configuration won't
allow the key for any other algorithm, mode, or configuration to be recovered.
The code which implements the iterated hashing is:
  /* Hash the variable-length input to a fixed-length output */
  memset( key, 0, keyLength );
  for( count = 0; count < iterations; count++ )
    {
    for( keyIndex = 0; keyIndex < keyLength; keyIndex += hashOutputSize )
      {
      /* state = hash( state ); key[ n ] = hash( state, userKey ) */
      hash( state, state,   hashOutputSize, HASH_ALL );
      hash( NULL,  state,   hashOutputSize, HASH_START );
      hash( temp,  userKey, userKeyLength,  HASH_END );
         |          |
           output    input   input size
      /* Copy as much of the hashed data as required to the output */
      length = ( keyLength - keyIndex ) % hashOutputSize;
      for( i = 0; i < length; i++ )
        key[ i ] ^= temp[ i ];
      }
    }

@_date: 1996-09-24 03:57:44
@_author: Fwd 
@_subject: Re: (Fwd) Australian "ITAR" regulations 
If the DSD is anything like our GCSB then what they'll have told you is what they'd like to be the case, not what's really the case.  They will tell you what it pleases them to tell you, which doesn't necessarily have anything to do with the facts.  The easiest way to check the real situation is to look at your customs act, the NZ Customs Act of 1995 (which in the relevant area is almost identical to the 1966 one) covers forms of export in excruciating detail.  Doesn't mention anything about computer networks in there.  In practice it'd have to be decided in the courts, but I don't think the DSD will take action because there's a very good chance they'd get a ruling against them, which is also why the NSA is so reluctant to enforce the ITAR in court.

@_date: 1996-09-26 05:42:23
@_author: ASN.1 objects, object identifiers, and public key components 
@_subject: [Long] How to break Netscape's server key encryption 
The Netscape server key format is very susceptible to both a dictionary attack
and to keystream recovery.  It uses the PKCS  format for private keys, which
provides a large amount of known plaintext at the start of the data, in
combination with RC4 without any form of IV or other preprocessing (even though
PKCS  recommends that PKCS  password-based encryption be used), which means
you can recover the first 100-odd bytes of key stream with a simple XOR (the
same stupid mistake Microsoft made with their .PWL files).  This means two
1. It's very simple to write a program to perform a dictionary attack on the
   server key (it took me about half an hour using cryptlib, and another half
   hour to rip the appropriate code out of cryptlib to create a standalone
   program).
2. The recovered key stream from the encrypted server key can be used to
   decrypt any other resource encrypted with the server password, *without
   knowing the password*.  This is because there's enough known plaintext
   (ASN.1 objects, object identifiers, and public key components) at the start
   of the encrypted data to recover large quantities of key stream.
To demonstrate the problem, I have written a program which performs a
dictionary attack on the server key, and if successful prints the password used
to encrypt it and the server's RSA private key.  Originally I used my
encryption library ( to do
the encryption, to turn it into a standalone program I ripped the necessary
parts out of the library, which means it's a bit messy and not as portable as
the original was.  The code could probably be made to run about twice as fast
if it's properly optimised, but I don't know if it's worth the bother and
besides, it's just gone 4am I could use some sleep.
To run it, use:
  breaksk  Here's the output from a server key someone sent me, tested against my 100MB+
word list collection (some people collect stamps, I collect word lists :-):
  The password used to encrypt this Netscape server key is 'unguessable'.
  Modulus = 00D50626580C2543378FD249994A543FBF5FF1333E70684E942EC7034E5FA [...]
  Public exponent = 03
  Private exponent = 008E0419900818D77A5FE18666318D7FD4EAA0CCD44AF03462C9 [...]
  Prime 1 = 00FBD3FC2CE1F50B31323F2D3FA27F6708D4373CC0487DB7199A712124380 [...]
  Prime 2 = 00D88D984BA6A7CD07F6608D95D3AC2682769DA904D061E593CF86A21B4A9 [...]
  Exponent 1 = 00A7E2A81DEBF8B220CC2A1E2A6C54EF5B3824D32ADAFE7A1111A0C0C2 [...]
  Exponent 2 = 00905E6587C46FDE054EEB090E8D1D6F01A4691B588AEBEE628A59C167 [...]
  Coefficient = 2DEBC012356B96D2206346141371D999288F55DD07AEF6D1972383E97 [...]
(I've trimmed some of the lines a bit).
The problem here is caused by a combination of the PKCS  format (which is
rather nonoptimal for protecting private keys) and the use of RC4 to encryt
fixed, known plaintext.  Since everything is constant, you don't even need to
run the password-transformation process more than once - just store a
dictionary of the resulting key stream for each password in a database, and you
can break the encryption with a single lookup (this would be avoided by the use
of PKCS  password-based encryption, which iterates the key setup and uses a
salt to make a precomputed dictionary attack impossible.  PKCS  states that
its primary intended application is for protecting private keys, but Netscape
chose not to use this and went with straight RC4 instead).
A quick (but not necessarily optimal) solution to the problem involves two
1. Only encrypt the unknown, private fields in the key (which is what PGP
   does).  Instead of wrapping everything up in several layers of encapsulation
   with object identifiers and public-key components, change the portion which
   is encrypted to:
      EncryptedRSAPrivateKey ::= SEQUENCE {
        privateExponent INTEGER,
        prime1          INTEGER,
        prime2          INTEGER,
        exponent1       INTEGER,
        exponent2       INTEGER,
        coefficient     INTEGER
        }
   with everything else outside this object.
2. Don't use a simple stream cipher to encrypt fixed data like this.  Use an IV
   on the encrypted data.  Iterate the password setup to slow down a dictionary
   attack (I posted a scheme for transforming variable to fixed-length keys to
   the cypherpunks list a few days ago which provides the necessary
   functionality).
The consequences of this attack are pretty scary.  It involves vastly less
effort than breaking a 40-bit session key or factoring a 512-bit public key,
yet once you've recovered the private key you can also recover every session
key it's ever protected in the past and will ever protect in the future (which
is why I'm a fan of signed DH for session key exchange).  The ease with which a
dictionary attack can be carried out represents a critical weakness which
compromises all other encryption components on the server - spending a few days
with a Markov-model based phrase generator on a PC is still a lot easier than
spending a few months with GNFS and a workstation farm.
It seems strange that there are no real standards defined for secure storage of
such a critical component as a private key.  Although a lot of work has gone
into X.509 and the multitude of related public-key certificate standards, the
only generally-used private-key formats are PKCS  (which has problems, as
demonstrated above), and Microsofts recently-proposed PFX (Personal Information
Exchange) data format and protocol (PFX is designed to allow users to move
their keys, certificates and other personal information securely from one
platform to another, you can get more info on it from
 which is too new to
comment on.  It would be useful if a portable, secure private-key format at the
same level as the X.509 effort were developed to solve this problem.
For the curious (and ASN.1-aware), here's what the data formats look like.
First there's the outer encapsulation which Netscape use to wrap up the
encrypted key:
  NetscapeServerKey ::= SEQUENCE {
    identifier          OCTET STRING ('private-key'),
    encryptedPrivateKeyInfo
                        EncryptedPrivateKeyInfo
    }
Inside this is a PKCS  private key:
  EncryptedPrivateKeyInfo ::= SEQUENCE {
    encryptionAlgorithm EncryptionAlgorithmIdentifier,
    encryptedData       EncryptedData
    }
  EncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
  EncryptedData = OCTET STRING
Now the EncryptionAlgorithmIdentifier is supposed to be something like
pbeWithMD5AndDES, with an associated 64-bit salt and iteration count, but
Netscape ignored this and used straight rc4 with no salt or iteration count.
The EncryptedData decrypts to:
  PrivateKeyInfo ::= SEQUENCE {
    version             Version
    privateKeyAlgorithm PrivateKeyAlgorithmIdentifier
    privateKey          PrivateKey
    attributes    [ 0 ] IMPLICIT Attributes OPTIONAL
    }
  Version ::= INTEGER
  PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier
  PrivateKey ::= OCTET STRING
  Attributes ::= SET OF Attribute
The algorithm information is encoded as:
  AlgorithmIdentifier ::= SEQUENCE {
    algorithm           ALGORITHM.&id( { SupportedAlgorithms } ),
    parameters          ALGORITHM.&Type( { SupportedAlgorithms }{  } )
                            OPTIONAL
    }
  SupportedAlgorithms ALGORITHM ::= { ... }
  ALGORITHM ::= TYPE-IDENTIFIER
(and so on and so on, I haven't bothered going down any further).  The
EncryptionAlgorithmIdentifier is '1 2 840 113549 3 4' or { iso(1)
member-body(2) US(840) rsadsi(113549) algorithm(3) rc4(4) }.  The
PrivateKeyAlgorithmIdentifier is '1 2 840 113549 1 1 1' or { iso(1)
member-body(2) US(840) rsadsi(113549) pkcs(1) pkcs1-1(1) rsaEncryption(1) }.
Included below is the code to perform the attack (set tabs to 4, phasers to
Do I get a t-shirt for this? :-)

@_date: 1996-09-26 20:28:24
@_author: unknown_name 
@_subject: How to break Netscape's server key encryption - Followup 
There has been a successful hostile attack on a Netscape server key using the
code I posted yesterday.  I was contacted earlier today by someone who told me
he had in the past obtained Netscape server keys and PGP private keys from
Windows NT machines running Microsofts insecure FTP server which allows access
to the entire drive (he found some of the PGP keys using archie searches -
ouch!).  He lives somewhere with nasty anti-hacking laws and definitely doesn't
want his identity known, but after some pleading said I could reveal the
  - He used the cracklib dictionary to get the password
  - The password was found "very quickly"
  - The password was a female name
  - He deleted the server key after he'd found the password
  - He did it merely out of idle curiosity and has no intention of misusing the
    information.
  - He definitely doesn't want to be contacted

@_date: 1996-09-28 14:26:49
@_author: unknown_name 
@_subject: Re: Mitsubishi MISTY LSI 
It was developed by a team lead by Mitsuru Matsui and has been subject to
fairly intense analysis, although not by non-Mitsubishi people AFAIK.  In any
case it's not the usual snake oil.  When I last talked to someone from
Mitsubishi who was working on Misty I tried to convince them to make details
available online, you could try something like  to see if
there's anything available.

@_date: 1996-09-29 21:57:39
@_author: *hashfnptr 
@_subject: Re: Transforming variable-length to fixed keys 
Yeah, that's a particularly evil way of making things harder for people with
keysearch engines.  That's why in cryptlib when I'm doing something like key
exchange I encrypt all the parameters (algorithm, mode, etc etc) along with the
session key, so an attacker can't even tell what algorithm you're using[1]. I'd
thought of adding some sort of "choose a random algorithm and mode" capability
to cryptlib, but the user interface was too difficult to handle (finding a way
to let the user specify "We want a choice of DES-CFB, IDEA-OFB, DES-EDE-CBC, or
Blowfish-PCBC" is a bit of a pain).  In the end I took the easy way out by
adding an extended initialisation mode which allows the user to specify the
algorithm if they want, but left the possibility of one-algorithm-per-round
hashing alone.  A problem with using one of a fixed selection of algorithms is
that as you add new modes the selection changes, so you need to add more state
information to the key which specifies the choice of algorithms, which starts
to get messy.
I'd still love to add this in some form to keep the NSA amused... perhaps a
bit vector of allowable algorithms and modes passed to the setup function.
[1] There's a story from IBM when they were testing a new IBM-internal     encryption system for long-haul telecoms applications.  They were     playing around with bouncing encrypted transmissions off an IBM-owned     satellite when they were contacted by the NSA who said "You're not using     DES.  Stop it".

@_date: 1996-10-08 00:41:34
@_author: it's not a very good shot 
@_subject: NSA/GCSB spying shown on NZ television 
20/20 today had a segment on the operation of the GCSB (Government Communications Security Bureau), the trading name of the NSA in New Zealand.
This was motivated by the recent publication of Nicky Hagers book "Secret Power" which goes into great detail about the operation of the GCSB (it has floor plans of the monitoring stations, details of operations, staff, names and contact numbers, etc etc - it's a very well researched book covering the day-to-day running of an intelligence agency).
In the 20/20 segment, Nicky and a reporter managed to get through the security perimeter at the Waihopai base with a camera and ladder, climbed up to the windows, and shot footage of the interior of the base through improperly-closed curtains.  The main operations room had racks of equipment which is hard to identify (it's not a very good shot), along with tables containing PClone monitors and HP II's[1].  Unfortunately the resolution isn't good enough to show what's being displayed on the monitors.  Another shot of an office showed a desk with Intelsat operations manuals, providing, for the first time, direct proof of whose traffic is being monitored - not the Russians, not the Chinese, but NZ's pacific neighbours and trading partners.  The intercepted traffic is then passed straight back to the NSA for analysis.
AFAIK there's never been any direct, documented proof of what these bases are intercepting - the dishes are pointed in the right direction for intercepting Intelsat transmissions, but the various agencies have been able to deny the nature of the interception.  The footage of operations manuals on a desk would seem to prove beyond a doubt that the agencies are engaged in large-scale interception and monitoring of civilian communications.
It was rather unfortunate that the program was shown at the same time as the political leaders debate on another channel (we have an election in four days time), because virtually noone will have watched 20/20.
[1] Given that the windows looked like plain glass and that these things have a control zone that reaches halfway to Antarctica, I'd love to park outside the base with certain pieces of receiving equipment...

@_date: 1996-10-14 23:09:59
@_author: PDT 
@_subject: cryptlib 2.00 free encryption library released 
Version 2.00 of cryptlib is now available from
ftp://garbo.uwasa.fi/pc/crypt/crypl200.zip and also from
The library provides an easy-to-use interface which allows even inexperienced
crypto programmers to easily add strong encryption and authentication services
to their software.  The library contains DES, triple DES, IDEA, MDC/SHS, RC2,
RC4, RC5, SAFER, SAFER-SK, Blowfish, and Blowfish-SK conventional encryption,
MD2, MD4, MD5, RIPEMD-160 and SHA hash algorithms, and Diffie-Hellman, DSA, and
RSA public-key encryption, as well as a comprehensive high-level interface with
functions such as cryptCreateSignature() and cryptExportKey().  The library is
supplied as source code for Unix (shared or static libraries), DOS, Windows
(16- and 32-bit DLL's), and the Amiga.
The library provides a standardised interface to a number of popular encryption
algorithms, as well as providing a high-level interface which hides most of the
implementation details and provides an operating-system-independant encoding
method which makes it easy to transfer encrypted data from one system to
another.  Although use of the the high-level interface is recommended,
experienced programmers can directly access the lower-level encryption routines
for implementing custom encryption protocols or methods not provided by the
The library API serves as an interface to a range of plug-in encryption modules
which allow encryption algorithms to be added in a fairly transparent manner.
The standardised API allows any of the algorithms and modes supported by the
library to be used with a minimum of coding effort.  As such the main function
of the library is to provide a standard, portable, easy-to-use interface
between the underlying encryption routines and the user software.  In addition
the easy-to-use high-level routines allow for the exchange of encrypted session
keys and the creation and checking of digital signatures with a minimum of
programming overhead.
The library has been written to be as idiot-proof as possible.  On
initialization it performs extensive self-testing against test data from
encryption standards documents, and the API's check each parameter and function
call for errors before any actions are performed, with error reporting down to
the level of individual parameters.
The library implements a security perimeter around the encryption functions,
with encryption contexts consisting of an arbitrary handle referring to
(hidden) data held within the library.  No outside access to state variables or
keying information is possible, provided the underlying OS provides some form
of memory protection.  If the OS supports it, all sensitive information used by
the library will be page-locked to ensure it is never swapped to disk.
There is one small bug I found about an hour after it was released (sigh), you
can't use CRYPT_USE_DEFAULT as a parameter to cryptCreateContext() due to
missing parentheses in crypt.c.
Incidentally, if someone in Europe with a high-bandwidth link to the rest of
the world could provide a permanent site for cryptlib betas that'd be useful,
since the current beta distribution system is rather ad hoc.

@_date: 1996-10-27 23:19:19
@_author: PST 
@_subject: Secure Internet-based Electronic Commerce: The View from Outside the US 
I've just made a draft copy of this paper available for comment as  a copy of the introduction is given below.  The whole thing is around 170K long (40 A4 pages when printed).
If anyone has any comments to make on it, please let me know.
The creation of a global electronic commerce system will provide an extremely powerful magnet for hackers, criminals, disgruntled employees, and hostile (but also "friendly") governments intelligence agencies.  This problem is magnified by the nature of the Internet, which allows attackers to quickly disseminate technical details on performing attacks and software to exploit vulnerabilities.  A single skilled attacker willing to share their knowledge can enable hordes of dilletantes around the world to exploit a security hole in an operating system or application software within a matter of hours.  The Internet also enables an attacker to perform an attack over long distances with little chance of detection and even less chance of apprehension. The ability to carry this out more or less anonymously, at low cost, and with little chance of being caught, encourages attackers.
Because of well-publicized break-ins there has been a steadily increasing demand for encryption and related security measures to be included in software products.  Unfortunately these measures often consist either of "voodoo security" techniques where security is treated as a marketing checkbox only, or are rendered ineffective by the US governments refusal to allow non-americans access to the same security measures which it allows its own citizens. Organisations employing such (in)security systems may make themselves liable for damages or losses incurred when they are compromised.  This paper covers the issues of using weak, US government-approved security as well as problems with flawed security measures, examines some of the measures necessary to provide an adequate level of security, and then suggests several possible solutions.

@_date: 1996-10-28 12:44:21
@_author: PST 
@_subject: Re: Secure Internet-based Electronic Commerce: The View from Outside the US 
Oops - when I posted the previous announcement I gave the file the .html extension out of force of habit, the URL should in fact be  (you can also get to it using
the previous URL, but your browser will wrap the text.  To fix this, either
load it as text or use the .txt URL).

@_date: 1996-11-07 16:59:59
@_author: PST 
@_subject: Re: Group order for "Secret Power" ... (San Francisco Bay Area only) 
If anyone is going to the Usenix e-commerce conference I can bring over
some copies for them.  I'm already taking over a whole bunch of copies,
I can bring over a few more if I can get them (I've pretty much cleaned
out the bookshops around here).  I can bring them to the conference but
what you do with them from there is up to you (ie I won't have time to
find post offices to mail people copies or whatever).  Cost is US$25
(the NZ retail price is $35 = US$25), delivery is in just over a week.

@_date: 1996-12-01 16:53:57
@_author: PST 
@_subject: Re: Strong-crypto smart cards in Singapore and Germany 
Actually the German system contains some fairly elaborate safeguards to make
it pretty challenging to automatically track transactions (Germans have historical reasons for being uneasy about government monitoring).  However
given other German laws like the Fernmeldeanlagenueberwachungsverordnung
(yes, that's one word), which make the CALEA look like a picnic, I'm not sure
how long these safeguards will remain in place.  Given that the standard has
been created by a collaboration of all German banks, who are big enough to tell the government to take a hike if they demand access to the data, it may
be safe (certainly the people involved in the project that I've spoken to are
confident that they can keep the data private, however I'm not so sure how
it'll work out in the long run).
As for the Singapore solution, the Singpore government knows whats best for
you, so it isn't any of your business to question their judgement.  Anyone
thinking otherwise gets 25 strokes of the rattan.

@_date: 1996-12-20 14:08:09
@_author: PST 
@_subject: Re: Van Eck articles 
I have a copy of the original German version of this, I can snail mail a copy
if anyone wants to translate it.  It has lots of graphs and diagrams which
probably won't scan very well, and it will need translation before most of the
people on the list can make any use of it.  I know there are English versions
floating around, but I've never seen one.
BTW the work was done in the early '80's, not 1990.

@_date: 1996-12-21 06:36:07
@_author: PST 
@_subject: New Australian export regulations 
Australia's new export control regulations have just been posted to the net, you can get them from  (they're all Word 6.0 documents, I've been reading them with a binary file browser - blech).  What makes them interesting is that most of the text is word for word identical to the Canadian regulations (which is sensible, since the Canadian ones are clear and easy to follow, unlike the US "We'll let you know when you've broken the law" FUD regulations).  The only thing which is different is the section numbering, the mapping from Canadian to Australian section numbers appears to be:
  10xy.y.z -> xY00?.Y.Z where y -> Y == 1 -> A, 2 -> B, etc and z -> Z == A -> 1, 2 -> B, etc, so that Canadian 1151.1.c becomes Australian 5A002.a.3 (this doesn't work in all cases, if there's no .n suffix on the Australian number then the .n part from the Canadian number becomes part of the main Australian number, eg 1071.5 -> The text may not be taken straight from the Canadian one because some of the spelling mistakes in the Canadian one aren't present in the Austrlian one, or maybe it was prepared from a later version which had been spelling checked.
For crypto software, you want cat_5.doc, equivalent to section 1150 of the Canadian regulations.
Anyway, here's the good bit, in sou.doc, "GENERAL TECHNOLOGY NOTE (PART 1 - MUNITIONS LIST)"
Again, this is identical to the Canadian regulations.  Since the Canadian government has already ruled that a whole variety of crypto software is exportable under this exception, it means that the same stuff (and equivalent software from Australia) should also be exportable, or at least that you've got a very good case for arguing with the Australian government if they decide it's not exportable.
Then in definits.doc we again have the Canadian text:
It's nice to have this stuff laid out at last, because it finally takes the Australian crypto controls out of a gray area and defines them so that stuff like SSLeay and my own cryptlib aren't restricted.
Incidentally, there's also the cute:
This covers virtually any software development tool, and any kind of computer hardware, as well as natural neural networks and personal digital extensions (of the kind designed for keyboard data entry).
I wonder if we'll see the regulations retroactively changed when someone in Canberra realizes what they've copied from the Canadian regs :-).

@_date: 1996-11-30 05:22:11
@_author: PST 
@_subject: Strong-crypto smart cards in Singapore and Germany 
Wednesday's "Straits Times" contains two front-page articles on the introduction of a CashCard which acts as an electronic wallet capable of storing from $10-$200 ("Dr Hu launches cash-in-a-card payment system"), and an identity card capable of Internet electronic transactions with (presumably RSA) 1024-bit encryption ("50,000 to take part in electronic ID trials").  The ID card can also be implemented as software on disk.  It appears to be purely a form of storing an ID which is then transmitted in encrypted form.  The CashCard, on the other hard, is an electronic wallet developed by a group of Singapore banks.  There are no details on how it works, except that it doesn't have any sort of protection - it's up to you to make sure the card isn't The standardisation committee of the German banks have also produced an electronic wallet which should have 25 million (yes, 25M) users by January of next year.  Again, this is a pure electronic wallet, with 2-key triple DES and 768-bit (to become 1024-bit) RSA encryption.  The relevant standards are still in the process of being translated, but should be available Real Soon Now (the complete specification will be made public).  This looks like a very nice system, and unlike Mondex doesn't rely entirely on the hope that criminals can't get at the data on the card.

@_date: 1997-01-22 04:27:13
@_author: PST 
@_subject: Re: Keyword scanning/speech recognition 
I've found another collection of references on speech scanning/recognition, the
February 1989 CACM, p.193, contains 38 references going back to 1980.  It'd be
an interesting exercise for anyone with access to a large library to trace back
through these (some of them look promising, like a 1980 book "Trends in Speech
Recognition" from which a number of references are taken) to see how far back
you can go and at what point certain things became feasible.  The CACM
references would be a good starting point for a search.

@_date: 1997-01-29 20:42:13
@_author: PST 
@_subject: Re: New export controls to include code signing applications 
The Men in Black made Lucky Green  write:
These aren't new regulations, they're old regulations which have resurfaced.
I've managed to obtain a copy of part of the old pre-Wassenaar COCOM
regulations, which contain the magic lines:
  5.D.2.c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5.A.2 or 5.B.2.
    2. "Software" to certify "software" embargoed by 5.D.2.c.1.
    3. "Software" designed or modified to protect against malicious computer
        damage, e.g. viruses.
This is from the October 1991 version.
By October 1996 this had changed to:
  5D002 c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5A002 or 5B002.
    2. "Software" to certify "software" specified in 5D002.c.1.
It looks like someone used the old COCOM regs as the basis for the EAR rather than the newer Wassenaar ones.  The two are almost identical anyway except for a few minor points.  It's likely that the anti-virus clause is due to bureaucratic bungling rather than malicious intent.

@_date: 1997-01-07 01:49:16
@_author: PST 
@_subject: Re: The Upcoming DES Challenge 
Orbital mind control lasers made mpd (Mike Duvos) write:
I'm still a bit nervous about what the reaction will be though - won't the US government (and anyone else pushing DES) be able to say "It took 10,000 Pentiums several weeks, noone would bother doing that, so it's safe" (with a possible side order of "Safer-SK64 is 256 times as secure, anyone we really like can use that provided they hand over the keys in advance").

@_date: 1997-01-12 23:38:35
@_author: PST 
@_subject: Re: Menwith Hill / NSA 
I talked to the guy who made the documentary (Duncan Campbell) an hour or two
ago, he's sending me the transcripts when he gets back to the UK.  I'll see if I can get his permission to post them to the web.  He's been doing this
sort of thing for about 25 years, and has some really neat stories to tell about his run-ins with the UK government.

@_date: 1997-01-18 06:34:58
@_author: PST 
@_subject: Keyword scanning/speech recognition 
I was talking to someone recently about the feasibilty of keyword-scanning
phone conversations.  He thought it was probably still beyond the reach of
current technology, I thought it wasn't (I gave a couple of references in a
recent paper on government attitudes to crypto which indicate that it's being
used right now by a number of governments).  Anyway, I've got bits and pieces
of one or two papers here which people might find interesting.  The first one
  "Digital Circuit Techniques for Speech Analysis" by G.L.Clapper, presented at
   the AIEE Winter General Meeting in January 1962.
I've only got the first two pages of the paper here, I think the full thing
might have been published in the IEEE Trans.Communications in about 1963.  This
paper mentions a "digit recognizer" built at Bell Labs in 1952, and a Japanese
voice-operated typewriter using 3,000 transistors and 6,000 diodes.  The paper
goes on to describe a means of producing a "compact digital code expressing
significant qualities of speech in a form suitable for machine utilization".
This was in 1962!
A more recent paper is:
  "Discrete Utterance Speech Recognition without Time Alignment", John Shore
   and David Burton, IEEE Trans.Information Theory, Vol.29, No.4 (July 1983),
   p.473.
This generates a feature vector every 10-30ms from input speech which is
compared to pre-generated reference sequences.  It also has references to many
other papers covering the same area.
Certainly it appears that by the early 1980's it was possible to scan speech
for keywords and/or speakers and use this to target the surrounding
conversation, and that early work on this had been done since about 1960.  This
is all from public sources, since certain organisations have a *far* greater
interest in this particular area than anyone performing public research it's
likely that equivalent classified research was some way ahead of this.

@_date: 1997-01-19 15:10:25
@_author: PST 
@_subject: The NSA's influence on New Zealand crypto policy 
For nearly a year I've been involved in an ongoing battle with several
government departments and the odd intelligence agency in an attempt to clarify
NZ's position on the export of crypto software.  The whole story has now got
about as far as it can go, so I thought I'd share it with others.  I've been
trying to get the media to take an interest in this, but noone really seems to
care... if anyone knows any journalists who might be interested in it, feel
free to pass it on.  I've got more details including names of contact people
and phone numbers in case anyone needs to verify parts of the story.
The main players are:
The Government Communications Security Bureau (GCSB), a New Zealand
    intelligence agency (for US readers, the GCSB is the NZ subsidiary of the
    NSA).  The foremost authority on the GCSB is Nicky Hager, who recently
    published the book "Secret Power" which documents their activities.
The Defence Signals Directorate (DSD), an Australian intelligence agency (the
    Australian version of the NSA).
The Ministry of Foreign Affairs and Trade (MFAT), a New Zealand government
    department.
New Zealand Customs.
Cyphercom Solutions, a New York company which produces financial/online
    commerce systems.
Kiss Audio Video, an Australian video production company.
Orion Systems, a New Zealand company which produces medical information and
    communication systems for transmitting medical information.
Myself (Peter Gutmann) and cryptlib, my free encryption library
    In April 1996 I got a call from someone who worked for Cyphercom Solutions, a
New York company who wanted to use my cryptlib encryption library in a project
they were working on.  Their lawyers wanted them to obtain an official,
physically exported copy so that there wouldn't be any complications later on
if the source of the software were ever called into question.  The application
involved financial transaction processing, and they had received indications
from the NSA that it would be looked on favourably in terms of getting export
permission.  Somewhat strangely though, they were given the distinct impression
that to get anywhere, they'd need to play ball with the NSA, even though it was
NZ software being exported from NZ, where the NSA should have no jurisdiction.
At this point a brief explanation of the export law situation in NZ is in
order.  The Customs Act of 1996, Section 54, "Prohibited Exports", states that
"The Governor-General may from time to time, by Order in Council, prohibit the
exportation from New Zealand of any specified goods or goods of a specified
class or classes" (followed by a list of specific conditions on prohibitions).
There's no further information in the Customs Act, but NZ Customs have a short
publication "New Zealand Customs Fact Sheet: Export Prohibitions and
Restrictions" which contains, among such curious items as cat skins and a large
list of agricultural products which can't be exported without going via the
appropriate government department, the item "Strategic goods such as computers,
navigation and marine equipment, firearms, ammunition, explosives, military
aircraft and vessels".  The responsible government department is the Ministry
of Foreign Affairs and Trade (MFAT, pronounced "em-fat").  Apparently computer
software comes under the same classification as computers (MFAT extends the
Customs definition of "Strategic goods" to cover "Computer technology,
information security systems, and telecommunications equipment").  The entity
within MFAT which handles this is the International Security and Arms Control
Division, who are advised by the Government Communications Security Bureau
(GCSB), the New Zealand NSA subsidiary.
Once you get past the part where NZ Customs are involved, the whole setup is
run like the mafia.  Nothing is ever written down, everything is done verbally.
Although it took only a paragraph to describe how this works, it took more than
two months of work to find out in practice.  Unless you know exactly who to ask
for information, noone has ever heard of these restrictions.  A search of NZ
legal databases found nothing.  Several IP lawyers had never heard of these
restrictions.  Noone seemed to know anything about any restrictions.  (In an
October newsletter, MFAT retroactively gave themselves jurisdiction over this
area, this is covered further down).
An initial discussion with MFAT revealed that NZ Customs tend to apply
restrictions based on the old COCOM rules, which have been superseded by the
Wassenaar agreement.  For this reason export permits are required for shipments
to certain eastern european countries, certain middle eastern countries, and
the current UN politically-incorrect-country club.  Export to countries other
than that would be unlikely to require a permit.
In May, Cyphercom therefore decided to try to export the software to the US and
Singapore.  Initially MFAT said this was OK.  Then at the last minute they
changed their minds and imposed the following restrictions:
 - No encryption algorithms except single DES.
 - Keysize limited to 64 bits (this is peculiar, I assume it's to stop me from
   using tricks like key-dependant S-boxes and DESX, which I'd discussed in
   email with people in the US some time ago).
 - Definitely no triple DES (this was specifically mentioned).
 - Export limited to object code only (so the key size couldn't be changed).
The text of the message (with a few names removed) is:
  "The Secretary of Foreign Affairs and Trade has no objection to the export of
   the XXX financial package, as detailed in the following application from
   YYY, *provided that* the library of encryption algorithms is limited to DES
   (but not triple DES) and any required hash algorithms, dated 15 May 1996".
In the accompanying description of the library, every single algorithm except
DES and the hash algorithms have been crossed out.  Note that this is for
export to the US, which has its own export restrictions anyway (the same thing
was done for the Singapore export).
Inquiries by lawyers in the US indicated that there had been a flurry of
communication between the NSA and the GCSB over this (as one person - not one
of the lawyers BTW - I talked to put it, "When the NSA says 'Bend over', the
GCSB says 'How far?'").  The NSA might as well have signed the export
(non-)permit themselves.  The story from the US lawyers was that there was
"repeated intervention of the NSA" and that "NZ is out of its depth, it was
terrified of offending the US".
been initiated by the GCSB rather than the NSA, who were afraid to do anything
without NSA approval.  The GCSB went to the NSA and asked them what they should
do, the result was the (non-)permit.  A DSD person also later told a reporter
that the GCSB had gone to the DSD and asked them "Would you allow the export
under these conditions?".  The DSD said "No".
Shortly before this, the Canadian government, which follows the same export
guidelines as New Zealand (dual-use technology under the Wassenaar agreement),
had ruled that cryptlib was exportable to anywhere except the previously
mentioned restricted countries, with no permit necessary, and no need to apply
for a permit:
  "Application No.278466 covering cryptographic software proposed for export to
   England, this software is not controlled according to Canada's ECL.
   Therefore, provided the product noted in this application is not of US
   origin within the meaning of the ECL item 5400, these goods may be exported
   to any country, except Libya and Angola, without an export permit.  Please
   note that most goods to Iraq are still prohibited at this time, as well".
The interesting thing about the Canadian decision was that I was contacted
twice by Canadian export controls people who asked me a number of very detailed
questions about the software, whereas MFAT managed to come to their decision
without ever examining the encryption software or talking to its author.  As
far as I've been able to tell MFAT had very little to do with the decision:
They have to follow the GCSB's advice, and the GCSB won't do anything without
the NSA's permission.
The opinion from lawyers in NZ was that they were acting far outside their
authority.  In any case in late May two copies of the software on 3.5" disks
were sent out by a large accounting firm acting for Cyphercom, one to the US
and one to Singapore as provided for in the export permit.
At about the time the original export appeal was lodged, the GCSB had told
another NZ company, Orion Systems, that they couldn't export a product with the
encryption necessary to protect patient medical data, lab results, patient
referrals, and so on, without obtaining an end user certitificate for each
user.  To sell a copy to just the one overseas site which the inquiry was about
would have required otaining two thousand certifications from all the end
users.  Larger sites with ten thousand users are not unknown.  This meant that
Orion would have had to somehow obtain 2000 signed declarations from users just
to allow the exchange of medical records (this tactic has also been
successfully used by the US government to effectively block certain software
exports by US firms).  Orion didn't even bother going to MFAT, because if the
GCSB required these impossible-to-meet conditions then going to the next level
down in the chain of command would make no difference.
After chasing my way around a number of government departments I talked to some
people in the Ministry of Commerce who advised that the best way to resolve
this craziness was to write to MFAT and inform them that the Canadian
government had ruled that the library was freely exportable and that there was
no reason for them blocking the export, and ask under what authority the export
was being blocked.  This letter was sent to MFAT in mid-September
(incidentally, the way government departments refer to the GCSB is wierd. Noone
ever says "the GCSB", it's always "another government department" or "an
organisation which I won't name", as if there was some belief that using The
Dreaded Name will cause evil to descend upon the person who utters it, much
like the use of the work J*h*v* or Lovecraft's "He Who Is Not To Be Named").
Anyway, at this point, things started to get weird.  At about the time I wrote
the letter, I was FedEx'd an NDA sent from lawyers representing PGP Inc (a US
encryption software vendor) to Orion Systems, sent in a standard FedEx letter
envelope.  It was intercepted by NZ Customs and opened, and the contents
examined, before I got it.  This wasn't the usual random (and quite rare)
"Examined by Customs" spot check, the letter had a large red "Customs - Hold"
sticker on it with an LAX flight number, so I assume they knew in advance what
they were looking for.  NZ Customs couldn't tell me why it was intercepted, but
seemed a bit surprised that the letter had been opened.  They said that they
may have been "acting on information".
In early October, about a fortnight after I sent the letter to MFAT questioning
the export refusal and asking for clarification on what law they were using to
block the export (and many months after the export itself), the Australian
parent of the US company who wanted the export got a call from the Australian
Ministry of Defence (it was actually the DSD, but they generally identify
themselves as Ministry of Defence just like NSA employess are always identified
as Department of Defence rather than NSA).  This company, Kiss Audio Visual,
are a video production house who have nothing at all to do with encryption
software (or, in fact, anything but video production and graphics design, which
they are very good at).  They were called by Alan Owen of the DSD who said that
they had been informed that NZ Customs had intercepted a shipment containing a
high-security encryption product which was being illegally exported from New
Zealand.  According to the story, when NZ Customs went back to the party who
exported the software, they claimed it was on behalf of Kiss.  The Managing
Director of Kiss called the Ministry of Defence to make sure this was actually
for real, and they confirmed that it was.
This story has several very large holes in it:
- NZ Customs never intercepted anything.  The package containing the disks
  arrived in the US unopened, there was no "high-security encryption product"
  on the disks, and a Customs person has verified that NZ Customs have never
  intercepted any crypto software shipped overseas.
- There was no illegal export of any kind.  All the necessary permissions had
  been obtained from MFAT before the disks were shipped.
- The export was performed by Cyphercom, not Kiss.  Kiss happens to be the
  parent company, but (apart from a few business discussions carried out over
  international phone links), there was no other connection between Kiss and
  Cyphercom.
Alan said that this export had very serious consequences, and that they would
be coming to Melbourne to talk to Kiss at 2pm the next day.  The Kiss Director
immediately called Cyphercom in the US, and they discussed having serious
quantities of lawyers present at the meeting, and taking the whole story to the
The visit was cancelled without any explanation.  Who says governments never
listen to their citizens?
(The DSD side of the story is that they were rather busy that day and didn't
have time to carry out their investigation).
The implications of this are interesting.  Despite the fact that MFAT had
already (in effect) denied permission for the export, someone with the ability
to listen in to international phone conversations had used discussions about
the export to fabricate a story about NZ Customs with which the Australian
government could harass Kiss, who had done nothing wrong and in fact had
nothing to do with the whole affair (unfortunately I don't have any proof of
the phone-conversation monitoring, but I can't see how anyone could possibly
have connected Kiss with Cyphercom except for the phone conversations - they
simply have nothing else in common).  Apparently whoever was pulling the
strings saw it necessary to bypass MFAT entirely in an attempt to suppress the
encryption software (this does not inspire confidence in the working
relationship between MFAT and the unnamed agency.  The identity of the unnamed
agency was later revealed by the DSD - see below).
Also in October, an article "Trade in Strategic Goods - An Update" in MFAT's
"Business File" publication, Vol.3, No.7 made specific mention that MFAT were
in charge of controlling the export of encryption hardware and software.  It's
pretty certain that this special mention was motivated entirely by attempts to
export cryptlib, because MFAT stated in a letter to me that they'd never
encountered anything like this before, so the claim that:
  "..the most commonly affected exports from New Zealand are of encryption
   hardware and software..."
is distinctly peculiar.  The last time anyone checked (a KPMG report from
mid-1994) NZ had no restrictions on the export of crypto.  Some time between
mid-94 and October 1996, export controls (or at least some vague mention of
controls) appeared, with MFAT having jurisdiction.  I suspect this was in
October 1996, *after* the whole export/non-export fiasco took place.
In any event the article contains some rather curious comments.  "Run-of-the
mill exports have usually been processed within 48 hours".  MFAT have now taken
9 months without showing any results, causing considerable financial hardship
for Cyphercom who are unable to ship a product or even obtain a sample copy for
demonstration to customers.  "New Zealand... is helping to limit the spread of
increasingly sophisticated military technology and weapons of mass
destruction".  Whether software to protect financial transactions and medical
records counts as "sophisticated military technology" or "weapons of mass
destruction" is unclear.
In late October I called MFAT to see what the delay was in replying to my
earlier letter, and received a reply the following week.  In their reply, MFAT
stated that the export (non-)permit was in fact not final, and was still under
consideration, which was at odds with what they had told Cyphercom and with the
wording of the permit itself (see above).  The letter also states:
  "We made it clear that it would take some time, as the application dealt with
   a relatively new area in terms of our export controls, and was in a rapidly
   changing and advancing field.  We... are currently discussing it and other
   issues it raises with relevant government departments".
(the "relevant government department" is the GCSB, this has been confirmed by
the DSD).  I interpret this paragraph to mean "We're making up the rules as we
go along".  The Canadian government certainly didn't seem to have any of these
problems when they covered the same issue.
MFAT declined to answer my question as to whether this portion of NZ's foreign
trade policy was being controlled by US intelligence agencies.
In early January 1997, Kiss were informed by the same Ministry of Defence/DSD
person (Alan Owen) that he and an associate would again be flying in from
Canberra to talk to them, using as justification the same fictitious story
about NZ Customs that they had used before.  They spent about two hours at
Kiss, saw that they were indeed a video production house (and nothing but a
video production house), and left.  Before they left, they told the Kiss people
that the source of the story about NZ Customs was "their counterparts in NZ"
(the GCSB).  Kiss had a lawyer present to witness this.
The implications of this are pretty scary.  The GCSB first used their position
to impose impossible-to-meet conditions on Orion and influence MFAT to
indefinitely delay export of software which isn't export-restricted anyway (or
at least not by any known NZ law) and which the Canadian government had already
ruled wasn't export restricted.  However, not content with this, they then fed
a fictitious story to the Australian government to convince them to begin an
investigation into a company which had done nothing wrong, and had very little
to do with the whole issue.
Foreign competitors of NZ companies will ship their encryption products within
15 minutes of a credit card order being received.  The GCSB, by employing all
sorts of devious measures, has managed to suppress distribution of the same
software by NZ individuals and companies.  Under their influence, MFAT have now
spent nine solid months brooding over the export of one single copy of
equivalent encryption software without showing any results.  This has had the
effect of protecting overseas markets for exploitation by foreign
competitors... by a ministry supposed to be in charge of promoting NZ trade.
To summarise, the situation is as follows:
1.There is absolutely no way that anyone could reasonably be expected to find
  out about what to do with crypto software in New Zealand.  NZ Customs have
  been extremely helpful throughout this affair, but had to keep deferring to
  MFAT, where everything stops.  Even the people charged with enforcing export
  conditions don't know what it is they're supposed to be enforcing.  If it
  wasn't for a number of lucky coincidences and occasionally knowing or running
  into the right people, I still wouldn't know any more about the situation.
2.Anyone trying to follow the vaguely-defined, possibly nonexistant rules, at
  least in New Zealand, is opening themselves up to government harassment, no
  matter how hard they try to follow whatever rules and regulations someone in
  the government comes up with.  The only safe way to distribute crypto
  software seems to be to either distribute it over the Internet, or to make
  sure you have enough media and political contacts to raise hell over any
  ensuing mail interception, possible phone tapping, government investigations,
  bogus stories about crimes being committed, and other niceties which may crop
  up.

@_date: 1997-01-20 19:30:36
@_author: PST 
@_subject: Re: Menwith Hill / NSA 
I've just heard from Duncan Campbell (who made the documentary), he'll send me
a copy of the script which can be put on the web.  I'll let people know when
it's available.  Copies of the tape can be ordered from his company:
  IPTV Ltd
  1 Meadowbank
  Edinburgh EH8 8JE
  Scotland, UK
  E-mail : duncan           Tel : +44 131 659 6566
Cost is \pounds 14.50 stg + any postage costs for outside UK - \pounds 5 will
cover it.
They have no NTSC versions in stock but can make them from the master. Provided
they get orders for at least 10, the cost will be the same.  They accept
payment in US$ cheques as well as \pounds stg cheques; no credit cards, sorry.
He is, in theory, on holiday for another month or so and only has intermittent
net connectivity, so please don't flood him with email just yet.

@_date: 1997-01-20 20:25:35
@_author: PST 
@_subject: Re: Menwith Hill / NSA 
I've just heard from Duncan Campbell (who made the documentary), he'll send me
a copy of the script which can be put on the web.  I'll let people know when
it's available.  Copies of the tape can be ordered from his company:
  IPTV Ltd
  1 Meadowbank
  Edinburgh EH8 8JE
  Scotland, UK
  E-mail : duncan           Tel : +44 131 659 6566
Cost is \pounds 14.50 stg + any postage costs for outside UK - \pounds 5 will
cover it.
They have no NTSC versions in stock but can make them from the master. Provided
they get orders for at least 10, the cost will be the same.  They accept
payment in US$ cheques as well as \pounds stg cheques; no credit cards, sorry.
He is, in theory, on holiday for another month or so and only has intermittent
net connectivity, so please don't flood him with email just yet.

@_date: 1997-01-21 23:25:56
@_author: PST 
@_subject: Re: Keyword scanning/speech recognition 
I've found another collection of references on speech scanning/recognition, the
February 1989 CACM, p.193, contains 38 references going back to 1980.  It'd be
an interesting exercise for anyone with access to a large library to trace back
through these (some of them look promising, like a 1980 book "Trends in Speech
Recognition" from which a number of references are taken) to see how far back
you can go and at what point certain things became feasible.  The CACM
references would be a good starting point for a search.

@_date: 1997-01-29 19:40:43
@_author: PST 
@_subject: Re: New export controls to include code signing applications 
The Men in Black made Lucky Green  write:
These aren't new regulations, they're old regulations which have resurfaced.
I've managed to obtain a copy of part of the old pre-Wassenaar COCOM
regulations, which contain the magic lines:
  5.D.2.c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5.A.2 or 5.B.2.
    2. "Software" to certify "software" embargoed by 5.D.2.c.1.
    3. "Software" designed or modified to protect against malicious computer
        damage, e.g. viruses.
This is from the October 1991 version.
By October 1996 this had changed to:
  5D002 c Specific "software" as follows:
    1. "Software" having the characteristics, or performing or simulating the
        functions of the equipment embargoed by 5A002 or 5B002.
    2. "Software" to certify "software" specified in 5D002.c.1.
It looks like someone used the old COCOM regs as the basis for the EAR rather than the newer Wassenaar ones.  The two are almost identical anyway except for a few minor points.  It's likely that the anti-virus clause is due to bureaucratic bungling rather than malicious intent.

@_date: 1997-02-01 09:40:51
@_author: PST 
@_subject: Crypto in New Zealand - an update 
This is a continuation of the article I posted here a few weeks ago.  You can
find the whole thing at

@_date: 1997-02-04 06:56:36
@_author: Peter Gutmann 
@_subject: Re: Secure Phones 
This thing is snake oil.  What it does is move the data through an FIR filter
with the taps being controlled by a secret key.  The data itself isn't
encrypted, but is spread out over a wide spectrum in a (they hope)
difficult-to-analyse manner.  However with only 1K possible taps and
(presumably) something as high-security as an LFSR driving it, I think the
strength of the system has been overestimated somewhat.  It wasn't designed for
security at all, it was designed by an ex-Canterbury uni engineer to provide
add-on noise-immunity to fax machines, and they only decided to market it as an
encryption device later on - the designer apparently knows very little about
encryption.  I've got a photo of it, it's in a box the size of a small modem
and consists of a circuit board with an ASIC on it and a bit of interface
The company has a patent on it, but a search for the patent has so far been
unsuccessful (mind you I didn't search very hard).  If anyone wants to check it
themselves, the patent will probably be assigned to Ken Stokes of Cardinal
Encryption Services - they claim to have worldwide coverage.
This is rather cool, it was designed by a couple of students at the University
of Saarbruecken.  It uses the Lintel RSA chips which are fast enough to do
real-time RSA voice encryption, either singly for 512 bits or chained for 1033
bits.  I've got a brochure somewhere which shows one of the inventors using it,
it's a small motherboard containing the RSA chip, some other unidentifiable
circuitry (presumably a modem chipset), an EPROM, etc etc.  It was done as a
research project by students who are unlikely to have put backdoors in it.  The
BSI (German NSA) were not at all happy about it.
It's a pretty neat product, but unfortunately due to its origins it's having
difficulty getting any market penetration.  In addition the Lintel chips are
f-ing expensive and there are many other components that go in on top of that,
I doubt the whole thing sells for less than DM 1000-1500.

@_date: 1997-02-04 13:59:22
@_author: Peter Gutmann 
@_subject: Re: CAST 
I've just had mail from Carlisle Adams in response to my question about the status of CAST-128:
The algorithm is well worth looking at (see the URL above) - it's a nice royalty-free drop-in replacement for IDEA for example.  I've had a version half-finished for inclusion in cryptlib for a few months now, but something else always seems to crop up...

@_date: 1997-02-14 15:58:08
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-15 09:42:51
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-15 22:58:04
@_author: Peter Gutmann 
@_subject: Crypto code published in magazines 
I'm trying to find instances of crypto code published in computer magazines in the last few years.  I know of Blowfish in DDJ, are there cases of more mainstream computer mags like Byte publishing crypto code (I know Byte did DES in 1977, I'm hoping for something a bit more recent)?.  Please mail or cc replies directly to me, nntp.hks.net seems to have died :-(.

@_date: 1997-02-14 14:05:39
@_author: Peter Gutmann 
@_subject: DES and RSA crypto hardware from the free world 
I've just got the details on two new crypto chips produced by the Dutch company
Pijnenburg Custom Chips B.V.  These are the PCC 201 bignum coprocessor and the
PCC 101 DES-with-everything processor (the official names are slightly
different :-).  The PCC 101 sells for approximately US$27, the PCC 201 sells
for approximately US$50 (for people who aren't familiar with the market for
these things, these are very good prices, especially for the 201).
The PCC 201 is officially a "Large number modular arithmetic coprocessor" which
is designed to perform the operations:
  A^x mod N
  AB mod N
  C mod n
very quickly for quantities of up to 1024 bits.  Typical procesing times for
1K-bit operands is 40ms, for 512 bits it's 12ms when clocked at 25 MHz.
Unfortunately you can't directly chain them for larger operands, although it's
possible to use two 201's and some software tricks for CRT decrypts to stretch
the operand size to > 1024 bits.
The way the 201 works is that you load the fixed components (exponent and
modulus for A^x mod N, modulus only for AB mod N and C mod N) into one of three
sets of on-chip registers, and then use them to perform arbitrary numbers of
operations on data.  This means that for something like a micropayment
application you would load the necessary private key components once and then
generate signatures at the (theoretical) rate of 25 a second.  To date the cost
of this kind of hardware has been such that the most viable solution was to run
racks full of cheap P5 boards booting a bare-bones RSA-processing application
through a network card, but with the PCC 201 you could populate a board with
201's and a few microcontrollers a la a Wiener machine and use these as a
payment transaction processing engine.  They'd also make fairly cool SSL
co-processors for web servers.
The PCC 101, officially a "DES encryption device", does DES, 3DES (EDE with 2
or 3 keys), and DESX in ECB, CBC, CFB, OFB, and MAC modes at a maximum rate of
132 Mbits/s (16.5 Mbytes/sec) for single DES, or 1/3 that for 3DES, when
clocked at 33 MHz.  It's possible to load either single or triple-DES encrypted
keys which are then decrypted using onboard key encryption keys (KEKs).  The
chip contains onboard storage for 24 keys, 3 KEKs, 4 IV's, and 2 DESX keys
(pre/post-whitener).  Processing is done in a 3-stage pipeline, so once you
feed in 3 64-bit blocks it churns out a new result every 16 clocks (this also
allows overlapped I/O operation).  You can add an external battery to save the
internal state when power is removed, so you could keep your keys permanently
stored onboard (although given that these keys can be recovered given enough
money and effort I'm not sure if this is a good thing).
The PCC 101 is available in 44-pin PLCC/TQFP packages, the PCC 201 is available
in 68-pin PLCC and 80-pin TQFP packages.   The PCC 201 contains a multiplexed
address/data bus and a few control signals (most of the pins are unused), the
PCC 101 contains data and address ports and a few control signals.  They look
fairly easy to interface.  There's an ISA evaluation board available which
contains the PCC 201 and the slightly older PCC 100 (predecessor of the 101)
and some test software.  Note that this is an evaluation board only, Pijnenburg
make the chips but don't sell general encryption cards.
A fast PCI card containing these chips and drivers for various common operating
systems and MSDOS is currently being designed by an international cabal.  This
will be a PCI 2.1-compliant card containing a PCC101, an optional PCC201, and
possibly a few other things (we're still arguing about the design).  I'll be
writing DOS and Win16 drivers for it, and someone else will do an NT and
possibly Linux driver (again, it's still at the design stage).  cryptlib
( will probably end up
having native support for it when it's ready.
Pijnenburg don't have a web page yet but are working on it, I'll post the
details here when it becomes available.  Until then you can contact them at
asic  The only slight problem is that they're subject to the
Dutch governments export rules (the usual Wassenaar stuff) which means that if
you're not using it for an authentication/integrity-only application or a
financial application, you'll probably need to go through some paperwork to
show that it's for your use only and you won't be passing it on to your friend
Jose from Columbia.  Pijnenburg have a standard Statement of Application which
people can use as to write their own statement for export approval.
These chips look *very* promising.  Who needs Clipper, or HP's
Clipper-under-another-name, when you can get triple DES from the free world at
prices like this?

@_date: 1997-02-15 22:29:23
@_author: Peter Gutmann 
@_subject: Crypto code published in magazines 
I'm trying to find instances of crypto code published in computer magazines in the last few years.  I know of Blowfish in DDJ, are there cases of more mainstream computer mags like Byte publishing crypto code (I know Byte did DES in 1977, I'm hoping for something a bit more recent)?.  Please mail or cc replies directly to me, nntp.hks.net seems to have died :-(.

@_date: 1997-02-21 19:57:17
@_author: Peter Gutmann 
@_subject: Re: DES and RSA crypto hardware from the free world 
Those are one-off prices.  You'll have to contact Pijnenburg (see the address in the original message) for more details.

@_date: 1997-02-27 05:43:26
@_author: Peter Gutmann 
@_subject: Presidential decrees and emergency powers 
The letter/executive order from Bill Clinton which transfers control of
encryption and related items to the EAR contains a mention of:
  ... the national emergency described and declared in Executive Order 12924 of
  August 19, 1994, and continued on August 15, 1995, and August 14, 1996,
  necessitated by the expiration of the Export Administration Act (EAA) on
  August 20, 1994, I hereby report to the Congress that pursuant to section
  204(b) of the International Emergency Economic Powers Act, 50 U.S.C. 1703(b)
  (the "Act"), I have today exercised the authority granted by the Act to issue
  an Executive order (a copy of which is attached)...
Does anyone know what national emergency this refers to, and what the section
of the emergency economic powers act covers?  I seem to remember a post by
someone who had traced it back through endless levels of indirection to a
police action in Korea or something, but haven't been able to find any more

@_date: 1997-02-27 13:57:38
@_author: Peter Gutmann 
@_subject: Re: Presidential decrees and emergency powers 
Thanks.  This contains (among other things) the interesting Executive Order:
So the fact that Congress won't continue a law is justification for declaring
an emergency which is justification for continuing it by presidential decree
instead.  Scary.
Unfortunately it doesn't list all the earlier, expired decrees which would show
what was originally used to start this thing off ("... the unusual and
extraordinary threat to the national security, foreign policy, and economy of
the United States in light of the British army currently marching on
Washington" perhaps?)

@_date: 1997-02-01 09:05:18
@_author: PST 
@_subject: Crypto in New Zealand - an update 
This is a continuation of the article I posted here a few weeks ago.  You can
find the whole thing at

@_date: 1997-03-16 14:30:28
@_author: Peter Gutmann 
@_subject: Re: Wassenaar Arrangement and "sensitive dual-use items" 
There are two separate documents here which people are getting confused.  The
first is the text of the Wassenaar arrangement, which is quite short and (as
described by one person who's seen it) "consists of a lot of weasel words".
The second is the one which sets down what is controlled.  This is rather
lengthy, around 100 pages.  The EAR changes which were made in the US contains
some of the text of this document, which predates Wassenaar and is just the
older COCOM text under a new title.  The COCOM text originates from the US, and some of the countries still have versions with US spellings even though the countries use proper :-) Englishm which indicates its origins.

@_date: 1997-03-22 07:44:17
@_author: Peter Gutmann 
@_subject: Security of SSL proxies 
A number of vendors are now selling SSL proxies which implement secure tunnelling for web browsers using a non-crippled SSL implementation running on the client machine.  Has anyone considered the total security level provided by one of these systems?  I can see three problems with this approach:
1. The security stops a few feet short of the browser, making a MITM attack    possible (see below).
2. Security and authentication is handled by the proxy and not the browser.     This means that the browser (and browser user) never get to see the usual    indicators that their connection is secure (or "secure" for non-US users).
3. If you use a proxy like this to protect traffic for an entire company, the    proxy provides the same type of target as a GAK key center: An attack which    compromises this compromises security for the entire company.
The first one is a practical problem, the second one is more perceptual.  Consider the following possible attack: A nice authenticoded ActiveX control ("the tee proxy") installs itself on your machine and hooks itself into the chain of proxies by either moving the SSL proxy to a different port or changing the browser config entry so it's the first proxy in the chain.  It then scans all data being forwarded for credit card numbers/PINs/whatever and forwards them to God knows where.
There are various simple defences (eg the SSL proxy checks to make sure the browser still goes to it first), but in the end it's just a cat and mouse game - the tee proxy could spoof the registry calls (there was an article in DDJ which explains how to do this), or disable the check, or hook directly into the proxy service by patching the DLL (this was explained in MSJ I think).  In short, because the security stops a few feet short, it's possible to attack the system.
A related problem is that fact that the browser isn't aware that a layer of security is being applied to the connection, and so will act as if the connection was insecure (ie it won't display the usual signs that the link is secured, and will give annoying warnings when navigating secure web sites).
Finally, pulling personal certs into/through the proxy is rather complex, requiring the cooperation of the CA in issuing specific types of certs (one browser-specific one for the browser and an identical-content but proxy-specific one for the proxy), and all sorts of complex juggling by the user to install them.  This probably makes the use of certs in this environment fairly luser-proof, which more or less means no certs.
Are there any other problems which people are aware of?  There was a bit of a fuss made about these proxies being the end of ITAR when they were first announced, but since then things seem to have gone quiet.

@_date: 1997-05-20 21:59:29
@_author: Peter Gutmann 
@_subject: Re: Question: RC5 assembly code? 
Not if it's x86 assembler.  On the Pentium each rotate uses 4-5 non-pairable
cycles, so rotates are very slow (each rotate is the equivalent of (in the best
case) 8-10 normal instructions, so the two rotates in an RC5 round are the
equivalent of 16-20 other instructions).  According to Intel shifts and rotates
have been optimised on the PPro so they're slight faster than on the P5, but I
haven't looked at the details yet.  I haven't tried to formulate the RC5 core
in asm yet (because of the patent - what good is it writing code which noone
can use?) but on Intel hardware it's certainly going to be a lot slower than it
looks (the much more complex CAST core is faster than just the rotates from the
RC5 core).  This is kind of unfortunate, because it's a nice algorithm.

@_date: 1997-05-20 21:48:01
@_author: Peter Gutmann 
@_subject: Re: Public Key Break Paper 
There was also a response/rebuttal to this paper in RSA's Ciphertext
newsletter, Vol.2, No.1 (Summer 1994), p.9, "Public Key Cryptography is Not
Easy to Break" which shows that it's not nearly as easy as the author of the
original paper thinks.
(I had another look at the unbalanced RSA proposal in the Autumn 1995
 CryptoBytes as I was trying to find the above article, did anyone ever do
 anything with unbalanced RSA or was it just left as a curiosity?).

@_date: 1997-06-02 15:58:38
@_author: Peter Gutmann 
@_subject: Re: Creating a unique ID number for a dollar 
Death rays from Mars made Tim May  write:
It's not guaranteed unique.  First, the dollar you use may be a forgery (why forge a dollar?  I don't know, maybe they're practicing on low-denomination notes which noone ever looks at closely so they can get the twenties and hundreds perfect.  I have a vague memory of someone doing this with either US dollars or UK pound notes some time ago, motivated by the "noone would ever bother forging a dollar/pound, so it has to be genuine" mentality).  In addition you'd have to specify "US dollar" rather than just "dollar" because, apart from the different serial number formats, some countries will reissue banknotes if the originals are damaged in printing, which leads to the possibility of two (legitimate) notes with the same serial number being in circulation if the original isn't destroyed as required (I have some of these replacement notes for now-defunct NZ dollar and two-dollar notes stashed away somewhere).  Does the US Treasury issue replacement notes if the originals are damaged in printing, or does it just destroy the notes and leave it at that?

@_date: 1997-06-25 04:22:28
@_author: Peter Gutmann 
@_subject: Re: spook pressure on crypto exports (was Re: cypherpunks coding challenge) 
Death rays from Mars made Adam Back  write:
Nothing was intercepted.  They (the GCSB, NZ subsidiary of the NSA) came up with some phony story about NZ customs intercepting a shipment of military-grade encryption (or something similar) which they fed to the Australian spooks (DSD).  NZ Customs knew nothing of this, and the DSD were apparently also considerably surprised by it.  As far as I can tell it was a very amateurish attempt to intimidate one of the companies involved (frighteningly amateurish in fact - a single phonecall was enough to confirm that they'd invented the whole incident themselves, the only real effect it had was to get them a front-page story in the National Business Review and (presumably) piss off the DSD for sending them on a wild goose chase and risking media exposure).
It can be legally exported.  Although the people pulling the strings are the GCSB, the group enforcing it is the Ministry of Foreign Affairs and Trade (MFAT)'s export control group, who are idiots (I can elaborate on this in great detail at some point, preferably over a beer).  I have several written statements from them that I can freely export it electronically (along with all sorts of bogosities such as a letter signed by the minister in which the first sentence of the second paragraph says exactly the opposite of the last sentence in the paragraph, and other, similar gems).  At one point I was firing off one letter after another to them just to see how silly they would get, but it got boring after awhile.  I'll put these letters online at some point for people to have a laugh at.
I should also clarify a point about the online writeup of my experiences, which imply that the NSA was active in directing the GCSB over export controls.  I'd had some feedback from a high-level US spook source that this wasn't quite the case, but the source has some rather unusual opinions on spooks and their activities (something along the lines of "Civilization would collapse tomorrow if it wasn't for the fine efforts of the CIA and NSA") which made me somewhat suspicious about the accuracy of the information.  Anyway, what this source said (and this bit I can believe) was that NZ was completely out of its depth with this (which was obvious from the way it was handled) and was terrified of offending the US.  According to the source, the NSA was exerting a *moderating* influence on the whole thing, and that any progress made was because the NSA told the GCSB to back off.  This would indicate an interesting case of the NSA exerting very strong indirect influence on determining crypto policy.  The GCSB knew the NSA didn't want crypto being distributed, and when they heard of the export they went into overdrive to show the NSA what good boys they could be and how keen they were to help the US by enforcing US policy for NZ crypto.
This interpretation is believable, NZ is very much a junior member of the UKUSA alliance and really doesn't want to do anything which might offend the other partners.  They knew the US didn't want crypto being made available, so they went out of their way to try to show the NSA that they could be trusted to do their bit in restricting crypto (I'm certain that something as amateurish as the NZ Customs story didn't come from the NSA, even the DSD seemed unaware of it).
This means that it doesn't actually require any direct intervention from the USG to control crypto policy, the mere knowledge that the NSA doesn't like something is enough to make the local spooks (who, in NZ's case, rely on the NSA for much of their hardware and training) do whatever they think will keep
the NSA happy.  It's perfect for the NSA I guess, because they get complete deniability (Just yell "Will noone rid me of this troublesome crypto" and sit back and wait).
BTW, what's happened to taz.nceye.net?  The cypherpunks mail->news doesn't seem to have been updated for more than a week.

@_date: 1997-07-01 12:24:49
@_author: Peter Gutmann 
@_subject: Re: Dr. Dobbs Cryptography and Security CD-ROM 
What makes this case especially awkward is the fact that the CDROM can't legally be sold outside the US, which means the only way the rest of the world can get it is through illegal copies.  Given the immense usefulness of something like this, I'd say it's only a matter of time before bootleg copies start appearing outside the US, but because of the USG's position we can't pay for it even if we want to (DDJ wouldn't look too good if they accepted payment for what they knew was illegally exported crypto).  Perhaps a donation of the same amount to charity would serve as some equivalent to payment...

@_date: 1997-08-04 19:28:15
@_author: Peter Gutmann 
@_subject: News: Spy Base Expanded 
CLEAR Net - News
  Spy Base Expanded
  The Government has announced a planned expansion at Blenheim's Waihopai
  spybase to boost New Zealand's ability to monitor satellite communications.
  And the Prime Minister, Jim Bolger, says a change to the Crimes Act will
  allow the base to monitor phone calls by foreigners, which was formerly
  illegal.
Full story at

@_date: 1997-08-25 04:41:57
@_author: Peter Gutmann 
@_subject: Re:  CAST key size 
"CAST" isn't a particular algorithm, but a design process for creating algorithms.  The particular CAST instantiation used in PGP 5 is either CAST-128 or CAST5, depending on who you ask.  Other versions of CAST abound, including an earlier one used by MS for unknown purposes which had a 64-bit key, probably the one Bruce is referring to.

@_date: 1997-09-08 20:58:43
@_author: Peter Gutmann 
@_subject: Re: Infoworld and Denning's study 
Due to the late hour I got that wrong, it's Computerworld NZ, not Infoworld (slight difference in naming).  Even later last night I wrote a letter to the editor which, I gather, will appear in the next issue.  I've included it below in case anyone finds it useful, it's written for a general audience who probably aren't aware of the deeper issues apart from the fact that the USG has a peculiar attitude towards crypto, due to length constraints I couldn't go into too much detail.  If you feel the need to circulate this, please don't do so until after next Monday when it's officially published.

@_date: 1997-10-15 10:46:06
@_author: Peter Gutmann 
@_subject: Re: the case for separate comms keys 
Death rays from Mars made Adam Back  write:
There are also a few other reasons for doing this, and I've extended the idea
used in SFS for use with my cryptlib encryption toolkit.  Instead of encrypting
just the key, you also encrypt the algorithm details, ie:
    E          ( algorithm, algorithmInfo, key )
     passphrase
    E                             ( data )                    algorithm, algorithmInfo, key
This makes the job of an attacker somewhat harder because even if they have
some means of performing a reasonable attack on the second encryption step,
they won't know exactly what it is, so even if it only has a 40-bit key they
might need to search half a dozen algorithms before finding the right one.
This makes it a lot harder to just brute-force everything going past in the
hope of finding something useful.  This is especially entertaining for
algorithms like RC5 and Safer, where you can produce dozens of variations by
playing with algorithm parameters, in effect adding extra bits to the key
As Adam mentions, you can also escrow[0] the second key (which SFS does using a
threshold scheme with the parameters controlled by the user).  In this way the
user can change their password without destroying the ability of the escrow to
access the data.
Finally, using the session-key mechanism means you never encrypt two lots of
data using the same key, and means you can encrypt a single message for
multiple recipients just like the public-key equivalent.
[0] This is "escrow" used in the true sense, not the GAK euphemism.  It's
    completely under the control of the user, it's optional, and it's intended
    for recovery of stored data when you forget the passphrase.

@_date: 1997-10-21 20:23:51
@_author: Peter Gutmann 
@_subject: Re: EC refutes GAK 
[I originally posted this to the c2.net crypto list but apparently it never
 appeared, I've reposted it here in case anyone finds it useful]
There's another way to foil GAK which I don't think has been mentioned before,
using what is often referred to as "malicious obedience" in the military (or
"you asked for it, you got it" elsewhere):
Since I don't trust any cryptosystem based on mathematical principles, I
encrypt all my communications using a one-time pad communicated on CDROM
(700+MB if you push it).  To limit the exposure of each pad, I change it once a
month at a cost of ~$1 per CDR blank.  If I communicate with around 100 people
that's 100 x 12 x 700+MB or (rounding things up a bit) a terabyte of keying
material a year.  Since they use their own pads to communicate back to me,
anyone wanting to intercept a years worth of traffic to/from me would need to
archive 100 terabytes of keying material (I'd make sure I spread out the bits
of pad I used so they couldn't just keep the useful bits and discard the rest).
In any case since this will only be used for court-authorised intercepts (just
keep repeating that until you believe it), everything would have to be archived
without any changes so it could be used as evidence.
At a cost of $100/month in CDR's this should comply with any GAK law (instant
access to keys, etc), but will also do a reasonable job of overwhelming any
centralised repository charged with storing the data.  Of course since I don't
trust the government any more than I trust those nasty cryptosystems based on
mathematical principles, I'd use triple DES underneath the OTP just to be sure.

@_date: 1997-10-22 02:45:42
@_author: Peter Gutmann 
@_subject: Re:  GAK "service" charges (Re: EC refutes GAK) 
Yes, but how will they phrase the requirements?  A CD is a single key (in fact 1,000 CD's are all part of a single key)... this leads to the same problem I heard of here a few years ago w.r.t. outlawing gangs: "It would be impossible to word any comprehensive anti-gang legislation in a manner which didn't also outlaw the police".  The same goes for certain aspects of escrowing, any escrow rules which are in any way practical and useable will also be open to all sorts of creative interpretation ("You must deposit a copy of your encryption key with the government" -> "Here's the key.  Where can I park the forklift that moves the container of CD's?").

@_date: 1997-10-23 21:32:48
@_author: Peter Gutmann 
@_subject: Use crypto, face a death squad 
There have been various rumours and comments over the past few years that the use of crypto in certain countries (Syria, Iraq, possibly China) is very dangerous for the end user, but very little actual evidence to substantiate this.  About a week ago I got some evidence (well, something better than the usual rumours) on the situation with using crypto in Iraq which people might find interesting.
I was talking to someone who worked for a large multinational corporation which maintains a comprehensive directory of who to contact in each country they operate in (basically every country on earth, this was before the gulf war so Iraq was included) for any kind of emergency.  This consists of a huge file of data intended to cover every imaginable type of situation.  Included in the information on Iraq was a comment to the effect that you should never, ever use any form of encryption when sending messages to the contact people there.  He can't remember the exact details any more, but the implication was that any encrypted messages sent to them would result in them quietly disappearing.  Since this was a very big company with a lot of sensitive information which it would go to great lengths to protect, I would assume they had very good reasons for advising against the use of crypto in this instance.

@_date: 1997-12-16 18:27:08
@_author: Peter Gutmann 
@_subject: UK spooks invent RSA, DH in 1973 
There's an interesting paper at  which claims that UK spooks invented both RSA and DH in 1973 and 1974 respectively.
The summary info is:
(The paper was mentioned on a UK crypto list, but I've lost the original  reference).

@_date: 1998-01-20 23:37:38
@_author: Peter Gutmann 
@_subject: [Long] How to recover private keys for various Microsoft products 
How to recover private keys for Microsoft Internet Explorer, Internet
            Information Server, Outlook Express, and many others
                                      - or -
                 Where do your encryption keys want to go today?
                    Peter Gutmann, Microsoft uses two different file formats to protect users private keys, the
original (unnamed) format which was used in older versions of MSIE, IIS, and
other software and which is still supported for backwards-compatibility reasons
in newer versions, and the newer PFX/PKCS  format.  Due to a number of
design and implementation flaws in Microsofts software, it is possible to break
the security of both of these formats and recover users private keys, often in
a matter of seconds.  In addition, a major security hole in Microsofts
CryptoAPI means that many keys can be recovered without even needing to break
the encryption.  These attacks do not rely for their success on the presence of
weak, US-exportable encryption, they also affect US versions.
As a result of these flaws, no Microsoft internet product is capable of
protecting a users keys from hostile attack.  By combining the attacks
described below with widely-publicised bugs in MSIE which allow hostile sites
to read the contents of users hard drives or with an ActiveX control, a victim
can have their private key sucked off their machine and the encryption which
"protects" it broken at a remote site without their knowledge.
Once an attacker has obtained a users private key in this manner, they have
effectively stolen their (digitial) identity, and can use it to digitally sign
contracts and agreements, to recover every encryption session key it's ever
protected in the past and will ever protect in the future, to access private
and confidential email, and so on and so on.  The ease with which this attack
can be carried out represents a critical weakness which compromises all other
encryption components on web servers and browsers - once the private key is
compromised, all security services which depend on it are also compromised.
A really clever attacker might even do the following:
- Use (say) an MSIE bug to steal someones ActiveX code signing key.
- Decrypt it using one of the attacks described below.
- Use it to sign an ActiveX control which steals other peoples keys.
- Put it on a web page and wait.
On the remote chance that the ActiveX control is discovered (which is extremely
unlikely, since it runs and deletes itself almost instantly, and can't be
stopped even with the highest "security" setting in MSIE), the attack will be
blamed on the person the key was stolen from rather than the real attacker.
This demonstrates major problems in both Microsoft's private key security
(an attacker can decrypt, and therefore misuse, your private key), and ActiveX
security (an attacker can create an effectively unstoppable malicious ActiveX
control and, on the remote chance that it's ever discovered, ensure that
someone else takes the blame).
About a year ago I posted an article on how to break Netscape's (then) server
key encryption to the cypherpunks list (Netscape corrected this problem at
about the same time as I posted the article).  However more than a year after
the code was published, and 2 1/2 years after a similar problem with Windows
.PWL file encryption was publicised, Microsoft are still using exactly the
same weak, easily-broken data format to "protect" users private keys.  To
break this format I simply dusted off my year-old software, changed the
"Netscape" strings to "Microsoft", and had an encryption-breaker which would
recover most private keys "protected" with this format in a matter of seconds.
In addition to the older format, newer Microsoft products also support the
PKCS  format (which they originally called PFX), which Microsoft render as
useless as the older format by employing the RC2 cipher with a 40-bit key.  In
a truly egalitarian manner, this same level of "security" is used worldwide,
ensuring that even US users get no security whatsoever when storing their
private keys.  However even RC2/40 can take awhile to break (the exact
definition of "a while" depends on how much computing power you have available,
for most non-funded attackers it ranges from a few hours to a few days).
Fortunately, there are enough design flaws in PKCS  and bugs in Microsofts
implementation to ensure that we can ignore the encryption key size.  This has
the useful - to an attacker - side-effect that even if Microsoft switch to
using RC2/128 or triple DES for the encryption, it doesn't make the attackers
task any more difficult.  By combining the code to break the PKCS  format
with the code mentioned above which breaks the older format, we obtain a single
program which, when run on either type of key file, should be able to recover
the users private keys from most files in a matter of seconds.
A (somewhat limited) example of this type of program is available in source
code form from   Because
it's meant as a proof-of-concept program it's somewhat crude, and restricted to
recovering passwords which are single dictionary words.  Note: This does not
mean that using (say) two words as a password instead of one will protect your
private key.  All it means is that I haven't bothered to write anything more
sophisticated - no doubt anyone who was serious about this could adapt
something like cracklib's password-generation rules and routines to provide a
more comprehensive and powerful type of attack.  Similarly, by making trivial
changes to the key file data format it's possible to fool the program until
someone makes an equally trivial change to the program to track the format
change - this is meant as a demonstrator only, not a do-everything encryption
To use the program, compile and invoke it with:
  breakms  Here's what the output should look like (some of the lines have been trimmed a
  File is a PFX/PKCS  key file.
  Encrypted data is 1048 bytes long.
  The password which was used to encrypt this Microsoft PFX/PKCS  file is
    'orthogonality'.
  Modulus = 00BB6FE79432CC6EA2D8F970675A5A87BFBE1AFF0BE63E879F2AFFB93644D [...]
  Public exponent = 010001
  Private exponent = 6F05EAD2F27FFAEC84BEC360C4B928FD5F3A9865D0FCAAD291E2 [...]
  Prime 1 = 00F3929B9435608F8A22C208D86795271D54EBDFB09DDEF539AB083DA912D [...]
  Prime 2 = 00C50016F89DFF2561347ED1186A46E150E28BF2D0F539A1594BBD7FE4674 [...]
  Exponent 1 = 009E7D4326C924AFC1DEA40B45650134966D6F9DFA3A7F9D698CD4ABEA [...]
  Exponent 2 = 00BA84003BB95355AFB7C50DF140C60513D0BA51D637272E355E397779 [...]
  Coefficient = 30B9E4F2AFA5AC679F920FC83F1F2DF1BAF1779CF989447FABC2F5628 [...]
Someone sent me a test Microsoft key they had created with MSIE 3.0 and the
program took just a few seconds to recover the password used to encrypt the
One excuse offered by Microsoft is that Windows NT has access control lists
(ACL's) for files which can be used to protect against this attacks and the one
described below.  However this isn't notably useful: Most users will be running
Windows '95 which doesn't have ACL's, of the small remainder using NT most
won't bother setting the ACL's, and in any case since the attack is coming from
software running as the current user (who has full access to the file), the
ACL's have no effect.  The ACL issue is merely a red herring, and offers no
further protection.
Further Attacks (information provided by Steve Henson )
The PFX/PKCS  format is vastly more complex (and braindamaged) than the
older format.  You can find an overview of some of the bletcherousness in this
format at   After Microsoft
originally designed the format (calling it PFX) and presented it to the world
as a fait accompli, cleanup crews from other companies rushed in and fixed some
of the worst problems and security flaws.  However by this time Microsoft had
already shipped implementations which were based on the earlier version with
all its flaws and holes, and didn't want to change their code any more.  A
side-effect of this was that to be compatible, other vendors had to copy
Microsofts bugs rather than produce an implementation in accordance with the
standard.  Newer versions of the standard have now been amended to define the
implementation bugs as a part of the standard.
Anyway, as a result of this it's possible to mount three independant types of
attack on Microsoft's PFX/PKCS  keys:
1. Attack the RC2/40 encryption used in all versions, even the US-only one.
2. Attack the MAC used to protect the entire file.  Since the same password is
   used for the MAC and the encrypted key, recovering the MAC password also
   recovers the password used to encrypt the private key.  The cleanup crews
   added a MAC iteration count to make this attack harder, but Microsoft
   ignored it.
3. Attack the private key encryption key directly.  Like the MAC's, this also
   has an interation count.  Microsoft don't use it.
Even if one of these flaws is fixed, an attacker can simply switch over and
concentrate on a different flaw.
I decided to see which one could be implemented the most efficiently.
Obviously (1) was out (you need to perform 2^39 RC2 key schedules on average
to find the key), which left (2) and (3).  With the refinements I'm about to
describe, it turns out that an attack on the private key encryption is
significantly more efficient than an attack on the MAC.
To understand how the attack works, you need to look at how PKCS  does its
key processing.  The original PFX spec included only some very vague thoughts
on how to do this.  In later PKCS  versions this evolved into a somewhat
garbled offshoot of the PKCS  and TLS key processing methods.  To decrypt
data which is "protected" using the PKCS  key processing, you need to do the
  construct a 64-byte "diversifier" (which differs depending on whether you
        want to set up a key or an IV) and hash it;
  stretch the salt out to 64 bytes and hash it after the diversifier hash;
  stretch the password out to 64 bytes (using incorrect processing of the
        text string, this is one of Microsofts implementation bugs which has
        now become enshrined in the standard) and hash it after the salt hash;
  complete the hash and return the resulting value as either the key or the
        IV, depending on the diversifier setting;
(it's actually rather more complex than that, this is a stripped-down version
which is equivalent to what Microsoft use).
This process is carried out twice, once for the key and once for the IV.  The
hashing is performed using SHA-1, and each of the two invocations of the
process require 4 passes through the SHA-1 compression function, for a total
of 8 passes through the function.  Because the PKCS  spec conveniently
requires that all data be stretched out to 64 bytes, which happens to be the
data block size for SHA-1, there's no need for the input processing which is
usually required for SHA-1 so we can strip this code out and feed the data
directly into the compression function.  Thus the compression function (along
with the RC2 key setup) is the limiting factor for the speed of an attack.
Obviously we want to reduce the effort required as much as possible.
As it turns out, we can eliminate 6 of the 8 passes, cutting our workload by
75%.  First, we observe that the the diversifier is a constant value, so
instead of setting it up and hashing it, we precompute the hash and store the
hash value.  This eliminates the diversifier, and one pass through SHA-1.
Next, we observe that the salt never changes for the file being attacked, so
again instead of setting it up and hashing it, we precompute the hash and
store the hash value.  This eliminates the diversifier, and another pass
through SHA-1.
Finally, all that's left is the password.  This requires two passes through
the compression function, one for the password (again conveniently stretched
to 64 bytes) and a second one to wrap up the hashing.
In theory we'd need to repeat this process twice, once to generate the
decryption key and a second time to generate the decryption IV which is used
to encrypt the data in CBC mode.  However the start of the decrypted plaintext
  SEQUENCE {
    SEQUENCE {
      OBJECT IDENTIFIER,
          ...
and the SEQUENCE is encoded as 30 82 xx xx (where xx xx are the length
bytes).  This means the first 8 bytes will be 30 82 xx xx 30 82 xx xx, and
will be followed by the object identifier.  We can therefore skip the first 8
bytes and, using them as the IV, decrypt the second 8 bytes and check for the
object identifier.  This eliminates the second PKCS  key initialisation
call which is normally required to generate the IV.
As this analysis (and the program) shows, Microsoft managed to design a
"security" format in which you can eliminate 75% of the encryption processing
work while still allowing an attack on the encrypted data.  To make it even
easier for an attacker, they then dumbed the key down to only 40 bits, even in
the US-only version of the software.  In fact this doesn't really have any
effect on security, even if they used 128-bit RC2 or triple DES or whatever,
it would provide no extra security thanks to the broken key processing.

@_date: 1998-01-24 19:23:02
@_author: Peter Gutmann 
@_subject: Update on New Zealand crypto policy 
As part of my recent effort to prepare a useful home page after 2 years of having instead a mini text adventure, I've finally got around to finishing off the web page containing the recent history of, and current state of, New Zealands crypto export policy as decided by several intelligence agencies and a supporting cast of bungling bureaucrats.  This policy has resulted in New Zealand enjoying the dubious distinction of having the strictest export controls on earth, with everything ranging from crypto hardware down to software, library books, computer magazines, and journals being restricted from export.  It's not even possible for a university to publish academic research without prior permission from a government agency, and the requirements for obtaining this permission are structured to ensure that they can never be fulfilled.  You can find the information on:
  The page also contains links to a sizeable collection of never-before- published documents including correspondence with relevant government agencies, and media reports on the situation.
If you're going to send me mail about this, please note that I'll be at Usenix in San Antonio for the next week, so it'll take awhile for me to reply.  My PGP key's at the bottom of my home page if you need it.

@_date: 1998-02-03 20:56:30
@_author: Peter Gutmann 
@_subject: An update on MS private key (in)security issues 
A fortnight ago I posted a message exposing a number of weaknesses in the way
various Microsoft security products handle users private keys.  A few days
before I was due to vanish for a security conference (where it was very
difficult to contact me), the article started getting a bit of attention.  This
is a general response which clarifies several issues relating to the original
First, Russ Cooper (moderator of the NT Bugtraq mailing list) made some wildly
inaccurate claims about the article.  I've had a bit of feedback which
indicated that it wasn't even worth dignifying this stuff with a response but
I've written one anyway, at least for the original NT Bugtraq messages he
posted (the stuff he put on a web page is just more of the same).  You can find
it at  (even if you
don't want to plough through the whole thing, you might want to read the last
two paragraphs for a giggle).
After this, Microsofts spin doctors leaped into action and posted a response to
the article.  I've replied to this one in a bit more detail, since it raises
several important issues.
Comments on Microsofts Response
One or two respondents have tried to play down the seriousness of a private key
compromise, saying that I exaggerated the dangers in my original message.  What
I wanted to point out was how extremely valuable a users private key is, and
how disappointingly little concern Microsoft seem to have for protecting this
valuable resource.  For example Garfinkel and Spaffords "Web Security and
Commerce" (O'Reilly, 1997) contains the warning:
  "Today's PC's are no better at storing private keys once they have been
  generated.  Even though both Navigator and Internet Explorer can store keys
  encrypted, they have to be decrypted to be used.  All an attacker has to do
  is write a program that manages to get itself run on the users computer (for
  example by using [...] Microsoft's ActiveX technology), waits for the key to
  be decrypted, and then sends the key out over the network" (p.120).
Including a function like CryptExportKey() (which hands over a users private
key) makes this very attack possible.  The potential damage which can be caused
with a misappropriated private key is enormous.  Consider the relative risks in
the compromise of a logon password and a private key.  With a logon password,
the worst an attacker can do (apart from stealing possibly valuable data) is to
trash the victims hard drive, which involves reinstalling the operating system
(an action which many users are intimately familiar with).  In contrast an
attacker who obtains a private key can potentially drain the victims credit
card, clean out their bank account (if the victim uses one of the emerging
online banking services), sign documents in their name, and so on.
The implications of that last point can be quite serious.  Take for example the
Utah digital signature act, which was used as a model by a number of other
states who implemented or are implementing digital signature legislation.
Under the Utah act, digitally signed documents are given the same evidentiary
weight as notarised documents, and someone trying to overcome this has to
provide "clear and convincing evidence" that the document is fraudulent, which
is difficult since it bears a valid signature from the users key (this fact has
been used in the past to criticise digital signature laws based on this act).
In addition, under the Utah act and derived acts, anyone who loses their
private key bears unlimited liability for the loss (in contrast, consumer
liability for credit card loss is limited to $50).  This leads to the spectre
of a malicious attacker who has the ability to issue notarised documents in
your name for which you carry unlimited liability.  This is a lot more
important than someone reformatting your hard drive, or stealing last months
sales figures.

@_date: 1998-09-22 21:31:22
@_author: Peter Gutmann 
@_subject: German court: DES is no good 
German Court Ruling Another Blow To U.S. Encryption Standard
By Mary Lisbeth D'Amico
MUNICH - A German district court has ordered a bank in Frankfurt to repay a customer 4,543 marks (US$2,699) for money withdrawn from her bank account after her bank card was stolen.
The decision, made public Monday, again points to the holes in the 56-bit encryption technology used in Eurocheque cards, called EC Cards, according to the Chaos Computer Club, a German hackers group.
Calling the encryption technology for the EC bank cards "out-of-date and not safe enough," a Frankfurt District Court held the bank responsible for the amount stolen from the 72-year old plaintiff in February 1997. Neither the bank's name or that of the plaintiff were revealed.
An EC card is like a bank card which can be used at bank automats and point-of-sale terminals throughout Europe. The cards feature the U.S. government's data encryption standard, which uses 56-bit encrypted code to scramble the security information.
[Rest snipped]

@_date: 1998-10-06 08:33:29
@_author: Peter Gutmann 
@_subject: Re: Echelon's Origin 
Located nearby at  are documents related to the Kennedy assassination.  Check out the COMINT reports, they were getting information from an awful lot of interesting sources, many of which appear to be telegrams or telexes or similar
communications.  The Truman memo may show the background behind Echelon,
but these things show it (or at least its ancestor) in action.  Wow.

@_date: 1998-10-11 22:55:19
@_author: Peter Gutmann 
@_subject: Hidden WebTV signatures 
For those of you who don't read sci.crypt, Robert Ames  has posted an article in which he observes that all WebTV posts contain an X-WebTV-Signature: line containing base64-encoded data.  For samples of WebTV-generated posts, try the alt.weemba newsgroup, which is filled with WebTV-user drool (caution: remember to employ protection when exposting your mind to the content of the messages).  Some samples:
X-WebTV-Signature: 1
        ETAsAhQDqtur/jfleJ2CDOnNrVoeyALEQAIUOQyCBbzjx5HHfxeMERDgCjztXOU= X-WebTV-Signature: 1
        ETAtAhUAmCCzQt+Tqt6fNX+L9+gDCECaqQkCFA0YCPz5tk85mUgq7iX/u4vWvOgG These decode into ASN.1-encoded DSA signatures, eg:
   1 30   45: SEQUENCE {
   3 02   21:   INTEGER
            :     00 98 20 B3 42 DF 93 AA DE 9F 35 7F 8B F7 E8 03
            :     08 40 9A A9 09
  26 02   20:   INTEGER
            :     0D 18 08 FC F9 B6 4F 39 99 48 2A EE 25 FF BB 8B
            :     D6 BC E8 06
            :   }
for the second one.  The key isn't included in the header, presumably the  address can be tied to the hardware which contains some hardcoded DSA key.  I wonder if WebTV users know they're signing each message they send?

@_date: 1998-10-23 22:02:56
@_author: Peter Gutmann 
@_subject: Break DES Fast! 
Dear Friend,                                  My name is Dave Rhodes.  In 1997 my cipher designs had all been broken, my patents declared without merit, and NIST had rejected my preliminary AES submission.  Then in early 1998 I received a letter in the mail telling me how I could earn fame as a cryptographer whenever I wanted.  I was naturally very skeptical and threw the letter on the desk next to my computer.  It's funny though, when you are desperate, backed into a corner, your mind does crazy things.  I spent a frustating day looking through the DES S-boxes for better differentials, but the pickings were sparse at best.  That night I tried to unwind by reading a few security newsgroups.  I read several of the posts and then glanced at the letter next to the computer.  All at once it came to me, I now had the key to my dreams.
This year I presented a paper at Crypto'98 and have one accepted for Eurocrypt'99.  Cryptographers from all over the world come to me for advice, and NIST has asked me to be on the AES evaluation board.  I will have my own crypto conference within 4 or 5 months.  Anyone can do the same.  This crypto method works perfectly every time, 100% of the time.  Best of all you never have to leave home except to go to your mailbox or post office.          I realized that with the power of the computer I could expand and enhance this method into the most unbelievable system that has ever been created.  I substituted email in place of the post office and electronically did by computer what others were doing 100% by mail.  Most of the hard work is speedily handled by computers throughout the world.  If you believe that someday you deserve that lucky break that you have waited for all your life, simply follow the easy instructions below.  Your dreams will come true.
Sincerely yours,                                                Dave Rhodes                                                          Follow these instructions EXACTLY, and in 20 to 60 days you will have searched well over 50 trillion DES keys.  This program has remained successful because of the honesty and integrity of the participants.  Please continue its success by carefully adhering to the instructions.  1. Immediately send the following ciphertext/plaintext pair below to ten friends: 12F7E88920:0A2DE3172B
2. Remove the searched keyspace that appears at number 1 on the list below.  Move the other 9 sets of searched keyspaces up one position.  Number 2 will become number 1 and number 3 will become number 2, etc.  Place the keyspace you've searched in the number 10 position.
3. Post the message with the keyspace you've tried in the number 10 position into 10 separate newsgroups or mailing lists, call the file BREAK.DES.FAST.
4. Within 60 days you will receive over 50 trillion further DES keys which people have tried.
This is not a scam.  This is perfectly legal.  If you have any doubts, refer to 22 USC Sec 2778.
[Keyspace list snipped]

@_date: 1998-10-26 10:20:40
@_author: Peter Gutmann 
@_subject: TriSnakeoil questions 
I'm currently sitting in a booth at a Tandem user show directly
opposite the Atalla one.  If there's anything in particular which
someone wants to ask them, let me know and I'll see how knowledgeable their salesdroids are.  Dunno how reliable my access to mail will be in the next day or two, if you're local
you could try calling me at the hotel I'm staying, which is the
Fairmont in San Jose (although you've got a whelks chance in a
supernova of actually catching me in my room, so you'll probably
have to leave a message).

@_date: 1998-11-06 04:45:47
@_author: Peter Gutmann 
@_subject: Re: TriSnakeoil questions 
I had a talk to them, it turns out that of the two different Atalla's, Atalla the company and John Atalla the person, the snake oil is being pushed by Atalla the person rather than Atalla the company.  The Atalla people knew as little about it as everyone else, and although they were careful with their replies I got the impression that they were about as impressed with TriStrata as others on this list are.  OTOH perhaps they were just depressed that I asked them about TriStrata instead of their RSA/3DES card :-).
[I have half a dozen brochures for this one, in every single brochure it's  called something different (SET accelerator, SSL accelerator, e-commerce  accelerator,  accelerator) but once you get past the first few  application-specific paragraphs the rest is identical.  Covers all the bases  I guess.  Their white paper on why hardware crypto is better than software  crypto is a hoot too - "Hardware is cheaper" (obviously some new definition  of the word with which I wasn't previously familiar), "software crypto can't  be shared" (as opposed to hardware, which can be shared with a simple copy  command), etc.  Their products look pretty good, but everyone I talked to  complained about the price and was ready to jump on software alternatives]

@_date: 1998-11-08 11:01:13
@_author: Peter Gutmann 
@_subject: Blind signal demodulation 
The October 1993 Proceedings of the IEEE contain a number of rather interesting articles on blind signal identification and demodulation, which may be described roughly as "demodulation without the cooperation of the transmitter (or intended receiver where this might be necessary)".  The first article in particular goes into some detail on how to acquire QAM signals used in modems, including a neat diagram on p.1919 of a 64-QAM constellation through the various stages of acquisition by a blind demodulator.  The blind demodulation comletely bypasses the need for an initial training stage, acquiring the necessary signal-processing details on the fly.
The article finishes with overviews of typical hardware used for blind demodulation of QAM signals, including a multi-protocol DSP card with with 8 320C50's capable of blind demodulation of anything from 24 2400bps signals up through 8 V.34 ones, as well as an ASIC for blind demodulation of digital cable TV signals.  They also comment that blind decoders for typical voiceband signals can be implemented on Pentium MMX/UltraSparc-grade hardware.  This is interesting reading, and should lay to rest the UL that high-speed modems have some sort of magic immunity to interception which the lower-speed ones don't.
Oh yes, the introduction makes the observation that this sort of stuff is "rarely mentioned in the open literature".  It's not hard to see why.
Peter.

@_date: 1998-11-08 19:16:42
@_author: Peter Gutmann 
@_subject: Re: verisign digital id's for outlook <shudder> 
It's protected by Microsoft asserting that it's protected.  There's also some
sort of attempt at encryption (easily broken, see
 but in any case there are
enough security holes there that anything which manages to run on your system
(ActiveX, as you've mentioned) can grab your keys without a lot of trouble.

@_date: 1998-11-09 05:02:06
@_author: Peter Gutmann 
@_subject: Re: Blind signal demodulation 
Oops, that should be October 1998, not 1993 (ie last months issue).  Sorry
about that.

@_date: 1998-11-11 12:10:48
@_author: Peter Gutmann 
@_subject: More on blind signal demodulation 
There's at least one firm which makes this stuff commercially, their products
are available via   This looks like a
one-stop ECHELON shop: you take one or more of their products (pick your type,
intended target, and budget), plug as many E1's or E3's or whatever into one side as you can handle (the most impressive one does 16 E3's or 7680 voice/
data channels) and all modem, fax, and voice comms going through the circuit are available on the other side.  They have products to do automatic channel/
signal scanning, demuxing, decoding of various data formats, processing of satellite and radio signals ("combines tuning, demodulation, descrambling, decoding, demultiplexing, and output formatting in one chassis"), every kind of mobile phone signal you've ever heard of, digital microwave links, decoding of higher-level protocols like V.42/V.42bis, X.25, HDLC, PPP, every Internet protocol worth doing, etc etc (their terminology is pretty neat, they have for example a 1.5-44.7Mbps "modem for on-the-move applications" :-).  Much of the hardware claims to be built to TEMPEST specs.  One interesting point is that most of their stuff is for E1's and E3's even though they're a US company.

@_date: 1998-11-28 12:09:52
@_author: Peter Gutmann 
@_subject: Re: open-pgp / s/mime interoperability 
Actually S/MIME *could* support the use of PGP keys, but there's a field
(the SubjectKeyIdentifier) missing from the CMS SignerInfo which prevents
this.  This is rather inconsistent, because the same field is present in
the RecipientInfo.  I'm currently arguing in favour of adding it to SignerInfo on the basis that any argument against it would also apply to
RecipientInfo.  Not sure whether it'll work though - a couple of list
members seem convinced that exactly the same thing which is currently in
RecipientInfo won't work if used in SignerInfo.

@_date: 1998-12-03 22:01:30
@_author: Peter Gutmann 
@_subject: Re: open-pgp / s/mime interoperability 
I'm trying to get this adopted for CMS, the underlying data format for S/MIME.  The silly thing about this is that alternative key identifiers (like PGP keys) were going to be included in RSADSI's PKCS7v2, but aren't included in the IETF version of the same thing.  The result is that you have a private company going out of its way to accomodate open standards, and the IETF going out of its way to lock them out.  Weird.
You don't need this conversion, with key identifiers you can use both SPKI and PGP keys directly within S/MIME.  There's no need to convert them into an X.509-like format first.

@_date: 1998-12-07 16:36:45
@_author: Peter Gutmann 
@_subject: Re: What was the quid pro quo for Wassenaar countries? 
One thing which came to me recently when I was trying to figure out what sort of gun the US held to the rest of the world's head to get them to agree to this: Could the Wassenaar outcome have been a sign of Echelon in action?
Consider this: Delegates from each country have been travelling to Vienna for some months now to negotiate their countries position.  During the negotiations, they'll be contacting their governments via phonecalls carried over microwave trunks, satellite links, or undersea cables to discuss the progress of the negotiations and what position they should take.  Just like the negotiations which lead to the Five-Power Treaty in 1921, if one country had the ability to intercept all the other countries communications it would know how far they could be pushed, and where the most resistance was likely to come from, allowing greater amounts of "persuasion" to be concentrated on them.
I can't think of a more appropriate application of Echelon (use worldwide surveillance technology to perpetuate the usefulness of worldwide surveillance technology), and it would go some way towards explaining the very peculiar agreement which was reached.

@_date: 1998-12-15 20:26:25
@_author: Peter Gutmann 
@_subject: Re: Forced DNA Collection 
The Commissioner messed up the quote, it's actually:
  "I am returning to punish the guilty; the innocent have nothing to fear"
   - Lucius Cornelius Sulla, 90BC, just before he massacred the innocent en      masse.

@_date: 1998-12-16 05:58:51
@_author: Peter Gutmann 
@_subject: NZ government to legalise black bag jobs 
15 December 1998
GOVERNMENT TO INTRODUCE AMENDMENT TO NZSIS LEGISLATION
The Government will introduce an amendment to legislation this week covering the operations of the New Zealand Security Intelligence Service, and will also seek to appeal part of the Choudry decision of the Court of Appeal, Prime Minister Jenny Shipley said today.
"In Mr Choudry's case, the Court of Appeal pointed out the need for Parliament to provide express authority for the NZSIS to enter private premises, without permission, to intercept communications."
"It is vital that the NZSIS is able to carry out its functions properly in gathering intelligence on security threats to New Zealand. In some rare instances, this may require covert entry to private property, which the amendment to the legislation will allow.  The existing law had been presumed to allow this to occur.  The Court has said if this is the intention, it should be made explicit as is the case in Canada, the United Kingdom and Mrs Shipley said the Government would also seek leave to appeal against one aspect of the Court of Appeal's decision in Mr Choudry's case.  The issue concerns the procedure the Court should follow when the Government asserts it is necessary, in the course of litigation against the Crown, to withhold from the Court, and other parties, access to information, in order to protect national security interests.
Choudry was a protestor against the 1994 APEC meeting held in Auckland (a bunch of foreign politicians turned up to talk for a week, shutting down the city centre in a way that wasn't equalled until Mercury Energy earlier this year).  At the time the SIS's mandate had been widened to include "economic security", bringing the APEC meeting into its sphere of interest.  As part of the APEC brouhaha, they carried out a black bag job on Choudry and got caught, causing the government some embarassment.  The current bill, rushed through under urgency just before parliament shuts down (which means it gets rubberstamped with no scrutiny or debate), would legalise these things in the future, just in time for the next big politicians powwow next year (which has already lead to the army invading the university as part of some training exercise which involved a simulated search for dissidents).
The second part is more worrying, what it'll do is remove any provision for judicial review of dubious actions by the government by allowing them to claim national security concerns as a blanket excuse for whatever they do.  Certainly in the Choudry case the real concern was job security, not national

@_date: 1998-12-23 22:31:41
@_author: Peter Gutmann 
@_subject: New synonym for GAK 
Another one to add to the list:
Their PR which was sent to several crypto mailing lists earlier today was conveniently cut off just before the GAK paragraph (and in any case they weren't lying, just being economical with the truth).
