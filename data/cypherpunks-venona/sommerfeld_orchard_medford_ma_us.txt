
@_date: 1992-12-20 20:56:59
@_author: Bill Sommerfeld 
@_subject: DES source for the HP48SX calculator. 
I have implemented a version of the core of the DES algorithm for the
HP 48SX calculator; I mentioned this in passing on this list a couple
of weeks ago.  Anyhow, in the general cypherpunks spirit of things,
I'm willing to share this code...
Note that this only ECB-mode encryption and key schedule computation,
and not decryption.  Both operations take about 12 seconds.. mostly
because they're written in user RPL rather than system RPL or machine
If the person at Berkeley who maintains the cypherpunks FTP archive
wants to get in touch with me, I'd be happy to contribute this file to
the archive; also, I'll mail it to anyone with a US or Canadian email
return address.

@_date: 1992-12-24 09:57:49
@_author: Bill Sommerfeld 
@_subject: Signing ascii text 
I don't think space-collapsed signatures make any sense; they're only
going to mess up
If you're going to do any canonicalization, do either exactly what PEM
does, or canonicalize tabs and trailing spaces out of the message at
posting time.  Then do the same canonicalization on the receive end
before the signature is verified.
If a message transfer path is still "lossy", stop using the unencoded
body and just live with radix64 encoding.

@_date: 1993-02-23 21:28:49
@_author: Bill Sommerfeld 
@_subject: dispatches from the front lines of anonymity 
Date: Tue, 23 Feb 93 18:46:17 -0800
   From: hughes (Eric Hughes)
   >Eric Hughes suggests an alt.whistleblower with localized anonymizing. I
   >like this, but I don't see how NNTP provides it. Wouldn't every server
   >have to be modified or upgraded to support anonymizing?
   In an already supported sense, yes.  As I understand it, when a
   moderated group is created, an email address for the moderator is
   propagated with it.  So every time a moderated group is created, every
   server already is "modified".
That's how it *should* work, not how it *does* work.  In real life,
moderator addresses are distributed "out of band" to a relatively
small number of "backbone" sites; all the rest of the sites merely
forward the mail to a "backbone" site.
Making a newsgroup moderated in the absence of a moderation address is
an easy way to make it "read-only"; I think the folks who run the fj.*
groups do this instead of sending rmgroups (which are generally

@_date: 1993-03-12 21:33:18
@_author: Bill Sommerfeld 
@_subject: CYPHER: Plain encypher 
For a good time, read the sections from "The Codebreakers" regarding
what kind of lengths war-time censors went through to foil
In this day & age, rearranging the spacing of messages "just for the
heck of it" would be a rather obvious equivalent to what they did back
then (BITNET does things like this today just out of sheer
perversity).  So would scrambling the low-order bits of a sound file.

@_date: 1993-04-17 10:36:45
@_author: Bill Sommerfeld 
@_subject: Boston Globe article 4/17/93 
[I've called the Globe to complain about their swallowing the
government's story, hook, line, and sinker; I suggest others do
US reveals computer chip for scrambling telephones
By John Mintz
Washington Post
WASHINGTON -- The White House yesterday announced its new plan to
prevent criminals, terrorists, and industrial spies from decoding
communications over telephones, fax machines, and computers while
ensuring the government's ability to eavesdrop.
The plan features a $1200 government-developed computer chip embedded
in a scrambling device the size of a small notebook, which the
government hopes will be adopted as the universal means of encryption.
The Clinton administration said the technology will balance the
interests of civil libertarians, corporations, and individuals on the
one hand against law enforcement and intelligence agencies on the
The official White House announcement yesterday was the endorsement of
the Clipper Chip, developed by NSA, as the government standard for
encryption devices.
Industry and US officials said that means the Clipper Chip also will
become widely accepted in corporate America, because companies and
individuals desiring to do business with federal agencies that encode
their information would have to use the government's standard.
The success of the government's initiative depends on the willingness
of companies to accept encryption that the government can crack.
AT&T announced yesterday it would use the new chip in all its secure
nongovernment telephones.
The NSA has licensed two California firms to manufacture and market
the Clipper Chip, officials said.  The price is expected to drop to
about $25 each, they said.

@_date: 1993-04-18 17:37:05
@_author: Bill Sommerfeld 
@_subject: Followup message from Hellman 
Quoting Martin Helmann as forwarded by Steve Belloving and Phil Karn:
   she [Denning -sommerfeld] says the message is not double encrypted.
   The system key (or family key as she was told it is called) only
   encrypts the serial number or the serial number and the encrypted
   unit key. This is not a major difference, but I thought it should
   be mentioned and thank her for bringing it to my attention.
This sounds pretty unlikely to me -- if the message isn't
double-encrypted, the "tags" could be separated from the ciphertext
without too much effort.  Of course, it's not clear whether the
receiving system checks the serial number, or whether the serial
number is factored into E[M;K]; conceivably, those things could be
reconstituted on the other end if the receiving wiretap chip needed

@_date: 1993-04-19 06:37:00
@_author: Bill Sommerfeld 
@_subject: Amiga Crypto 
I think you're off by a factor of 8..
8K samples/sec is 8K bytes/second, not 8Kbits/sec
If we had universal ISDN at 56kb/s or 64kb/s, encrypted voice using
PC-class machines would be trivial.  Instead, we have to compress down
to a data rate comparable to ~1800 8-bit samples/second (V.32bis
speed; modem compression won't do very much -- unless nobody's talking

@_date: 1993-04-19 06:37:27
@_author: Bill Sommerfeld 
@_subject: Hellman's Hints 
It occurred to me that the "clipper chip" makes it easier for the
government to tap voice telephone trunks & do traffic analysis.
Current long-haul phone technology uses out-of-band signalling on
different, reportedly encrypted, trunks, so to make any sense out of
the data trunks you also have to listen in on the signalling trunks
and correllate what you record there with what you record off the data
With the wiretap chip in place, all they need to do is to "surf" the
data trunks looking for the encrypted serial number of the devices
they're interested in.
Depending on what the encryption tag blocks *really* look like, you
might not even need SK in order to do traffic analysis.  Even if the
tag blocks are built with confounders and similar randomness included
to discourage ciphertext matching, the SK can be found in *every
single chip* and it's only a matter of time before someone gets it,
either by electron microscope or by bribing some of the hundreds of
people likely to have access to the key.

@_date: 1993-04-22 19:38:04
@_author: Bill Sommerfeld 
@_subject: crypto export controls. 
I got an announcement last week of a presentation early this week at
my place of work on the subject of cryptographic export controls,
shortly before the cripple chip announcement was made.  This struck me
as at least suspicious.
Well, turns that the timing was something of a coincidence; it was
just a generic presentation on the current sorry state of the export
regulations, by one who had to deal with them day in and day out.  He
seemed to have the right attitude towards "working the regulations"
and what they should be, and had been involved in a few meetings with
NSA-types.  He commented that things have been getting better -- it
used to be that they'd refuse to meet with you over the subject of
exporting DES; now, they'll meet with you and just refuse to talk
about it.  The justification for ignoring the current wide
availability of strong crypto outside the U.S. was that if they
prevent strong crypto from falling into the hands of *one* bad guy,
they will have accomplished something...
He mentioned that the Software Publishers Association deal (where
companies can now export software using crippled versions of RC2 and
RC4 on short notice) was a surprise to him and much of the non-PC
software industry and represented an almost complete capitulation on
the SPA's part.  It was also uninteresting to my employer as we aren't
interested in using trivially breakable crypto in our products, and
the quick turnaround is pretty much meaningless given the amount of
lead time needed to get a product out the door.
He also mentioned an upcoming amendment to the next version of the law
which authorizes the ITAR and the commerce equivalent which would
specifically allow the export of generally available encryption
software; he didn't hold out much hope for it passing but considered
it worth fighting for.
He was also taken by surprise by the cripple chip announcement, and
also considered it a bad and ominous thing...

@_date: 1993-04-24 11:45:05
@_author: Bill Sommerfeld 
@_subject: OSF's DCE 
OSF's DCE is a "distributed systems toolkit" which provides tools and
infrastructure for building distributed systems.
The relevant point to cypherpunks is that it uses cryptographic
techniques to provide authentication and (optionally) data privacy
using DES and Kerberos V5.  Unfortunately, the data privacy features
must be disabled in the exportable versions.
Contact the OSF or any of the many vendors (HP, IBM, DEC, Transarc,
...) selling ports of the code for more details.

@_date: 1993-07-13 07:20:22
@_author: Bill Sommerfeld 
@_subject: Re: State Dept. shuts down DEC machine 
Note that the machine wasn't (only) an FTP server; it let anyone who
wanted get at a shell with compilers, debuggers, tools, etc., so that
the alleged Bad Guys from third world countries in a country with IP
connectivity on a student visa could run their nuclear bomb
design/simulation programs there....  never mind that the simulation
for the Manhattan Project was done with a horde of clerks, decks of
punched cards, and a big bunch of IBM card tabulators (see Feinmann's
autobiographies for more details..).
This looks annoyingly like a variant of the "initiative" a few years
back where the State Dept. wanted makers of high performance
workstations to export them only in a locked-down configuration
capable of executing only the applications they were originally
purchased to run; compilers need not apply...  fortunately, that died
a quick & quiet death.

@_date: 1993-09-21 15:36:38
@_author: Bill Sommerfeld 
@_subject: Re: Bidzos on PGP and ITAR verbatim 
If Bidzos is using the term "technical data" as it's defined in $120.21
   of the ITAR, I think it's debatable. Can we come up with data to support
   that IDEA and RSA are "commonly taught .. in academia"? The RSA public key algorithm is taught at MIT in the math course
18.063, which is required for an undergraduate computer science
That's one data point...

@_date: 1993-11-12 08:23:42
@_author: Bill Sommerfeld 
@_subject: Re: OMNI CARD 
BTW, you can't take the cards apart.  They fry themselves if you try.
Uhh.  Well, not exactly.  The cards don't fry, but presumably the
*key* inside them does.
I've seen a SecurID card which had been pried apart; when you put the
two halves back together, the LED went on again, apparantly into some
"initialization mode".
One assumes that the internal key had apparantly been fried; it was,
however, apparantly possible to reinitialize the card with a new key.
This may not defeat their security, but it may make it possible to
recycle their old cards instead of buying new ones..

@_date: 1993-11-12 08:24:32
@_author: Bill Sommerfeld 
@_subject: Re: Politics on the List? 
But the vast majority of the 500+ folks on this List are either not
   writing crypto code, or are keeping silent about it.
There are undoubtedly a fair number of the latter; probably better
than 50% of the cypherpunks subscribers I know around here (including
myself) get paid to (among other things) work on software related to
network security through cryptography.
Random Rant (preaching to the choir, but..):
The same day that I spent far too many hours attempting to get our
DES-using products in synch with what we believe is a correct
interpretation of the export regulations, I saw a post in sci.crypt
from someone in Italy announcing that he had a copy of my HP48SX DES
implementation (which is available for anonymous FTP from
soda.berkeley.edu; disclaimer: it does ECB encrypt mode only, that's
all I needed).

@_date: 1993-11-14 09:03:56
@_author: Bill Sommerfeld 
@_subject: Re: OMNI CARD 
There were apparantly more than two switches; more like 10 or so.
I think there may be two different models of securid cards, one with
and one without switches; the only difference may be in the faceplate
and the factory programming.

@_date: 1993-11-18 19:21:42
@_author: Bill Sommerfeld 
@_subject: Re:  hohocon 
For the hohocon case you could have a calculator programmed with
   some one-way function (DES is available for the HP48); the remote
   system could generate a challenge number and you would use your
   calculator to DES-encrypt it with a fixed secret key, then type the
   result in, and the remote system would check it.
In fact, that's exactly why I wrote it :-) .
Maybe I should go dig up the source to the challenge-response program
I wrote to go along with it..

@_date: 1993-11-18 19:51:42
@_author: Bill Sommerfeld 
@_subject: Re: Remailer cdodhner@indirect.com DOWN (temp) 
Yup, there was a recent CERT advisory on sendmail; see
comp.mail.sendmail for the details on the attack, but basically you
can jam nasty things down the throat of the sendmail "program" mailer
over the net..
I'm surprised more remailers haven't been hit by this problem...

@_date: 1993-12-08 07:35:41
@_author: Bill Sommerfeld 
@_subject: Re: ANNOUNCEMENT: DPSWG Crypto-Policy Statement to White House 
Although we don't make custom versions of our software for specific     customers, our software, due to its nature, is highly customizable by the     purchaser.  Neither the Cantwell bill, nor the DPSWG letter mentions this     type of software product.
Huh?  Does the fact that Microsoft C or WinDoze contains run-time
libraries and is "highly customizeable" cause it to cease to be a
mass-market product?
Read the bill more carefully; it doesn't say anything about required
sales volume, and allows for telephone/etc support for installs and
the like.  It also doesn't say anything about "end users".  As long as
the *seller* doesn't customize it for each user, it's mass-market.
BTW a "standard commercial channel" includes mail/phone orders.

@_date: 1993-12-10 08:59:30
@_author: Bill Sommerfeld 
@_subject: Re: small memoryspace DES? 
The DES implementation I'm most familiar with (the DES library core
written by Dennis Ferguson) uses moderately large (by your standards)
read-only tables.  The IP and FP tables are each 256*4 bytes (2Kbytes
total); the expanded S boxes are 8*64*4 bytes (another 2K bytes), and
the key schedule code uses a 48*4 byte table and two 4*64*4 byte
tables (another 2K+).  It's optimized for 32 (and larger) bit
processors, but it probably wouldn't be all bad on a 16 bit system.
The expanded key schedule uses 8 bytes per round times 16 rounds, or
128 bytes per currently active key (1/8 of your available memory).
However, only 48 bits of key schedule are actually needed per round (8
subfields of 6 bits each), so you could (at the cost of some speed,
probably a penalty of 50% to 100% or so) compress the schedule down to
96 bytes if it really mattered to you..
You could also compute each round of the key schedule as you needed it
(discarding it on the fly) reducing the memory needed per key to 8
bytes of "persistant" storage and a little bit more dynamic memory
when actually doing the encryption.. of course, performance goes down
the tubes if you do this unless you only use each key once..

@_date: 1993-12-17 07:36:18
@_author: Bill Sommerfeld 
@_subject: Re: inman vs. crypto 
' "My Answer", he said "would be legislation which would    make it a criminal offense to use encrypted communications to conceal    criminal activity.
This isn't so bad all by itself, but...
   ..you could have a registry of institutios which can    legally use cryphers. If you get somebody using one who isn't registered,    then you go after him." '
... this is absolutely unacceptable!
BTW, I just called Sen. Kennedy's office.  Kennedy is on the Armed
Services committee, and according to the secretary is in favor of the
nomination, but I asked a staffer to ask Kennedy to ask Inman about
how he reconciles the First Amendment with statements he's made like

@_date: 1994-02-11 08:40:28
@_author: Bill Sommerfeld 
@_subject: Re: FLASH: Vice President Gore Questions Current Key Escrow Policy! 
Frankly, it looks to me like the gov't is playing "good cop, bad cop",
with Gore being the "Good Cop" and anonymous faceless bureaucrats
being the "bad cop".
I hope nobody falls for this...

@_date: 1994-02-13 14:01:16
@_author: Bill Sommerfeld 
@_subject: Re: Actively Sabotaging Clipper and Capstone? 
Actually, I had heard that there were three different family keys
... and that this indicated that the at least some organizations
within these governments had "bought into" the Clipper scheme.
The person who told me this claimed that the pressure for key escrow
came from much higher levels -- the National Security Council, *not*
the NSA -- and that various lower-level functionaries within NIST
among others were *not* happy about having to toe the administration
line on key escrow.
This does not fit well with Gore's recent "good cop" remarks.

@_date: 1994-03-01 20:05:24
@_author: Bill Sommerfeld 
@_subject: Re: PGP on the HP 100 
From: smb
   Date: Tue, 1 Mar 94 19:56:40 EST
   Sender: owner-cypherpunks
   Has anyone tried putting ViaCrypt PGP on the HP-100?     Is anyone but me crazy enough to contemplate it?  Nope.  (I demoed it to a few people at the ISOC SNDS conference in San
Diego a month ago..).
   How abysmal is the performance?
Pretty bad, at least compared to the desktop systems I'm used to.
I hope you're patient..

@_date: 1994-03-18 19:05:41
@_author: Bill Sommerfeld 
@_subject: Re: CLIPPER COMPROMIZED? 
Ok, so we have a wire service report citing unnamed sources that the
gov't is trying to find out if Ames could have had access to Clipper,
and Denning citing unnamed sources that Ames probably didn't have
access to Clipper...
IMHO, that's roughly a tie in the credibility race, especially given
Denning's known biases on the matter.
At this stage in the clipper deployment, it would not be hard for them
to "recall" all the outstanding clipper/capstone/etc. chips for an,
umm, "bug fix", which installed a new set of S-boxes & a new family
In any event, anyone who had compromised clipper would be a fool to
show his hand now.. it would make a lot more sense to wait until
deployment was seriously under way, and clipperphones had gotten into
the hands (& electron microscopes :-) ) of at least some anti-clipper
activists... that way, it would be impossible for the gov't to dismiss
such a compromise as a hoax.

@_date: 1994-03-25 19:45:03
@_author: Bill Sommerfeld 
@_subject: Re: Digital Cash 
I have always been skeptical of this observer-chip approach, because it
   wasn't clear that it was feasible to make a tamper-resistant chip
   economically, and because the specialized hardware that would be
   required would prevent the system from being used on widely-available
   PCs.
Think "PCMCIA" here.. not just laptops, but now desktop systems and
palmtop systems are starting to get PCMCIA slots these days.

@_date: 1994-03-28 08:20:41
@_author: Bill Sommerfeld 
@_subject: Re: Ames/clipper compromised? 
What does it mean to ``compromise'' Clipper?  The algorithm is known?
Yeah.. this doesn't completely add up unless (a) the source is lying
or (b) there's a "blatant" back door.
If the algorithm becomes known at this stage in the game, they can
probably "easily" generate a modified SKIPJACK algorithm (changing the
S-boxes or equivalent), a new family key, and a subtle variation on
key generation.  They might not even need to re-spin the chip design
if, as they claimed, the critical parts of the algorithm are
programmed into the chip after fabrication.
BTW, my guess at the most likely back door is that the unit keys will
be generated as a cryptographic function of the serial number and a
*small* random number generated for each chip and unknown to the
agency.  They would have to search a mere 2**16..2**32 keys once they
get the serial number out of the LEEF.  The existance of such a
backdoor would be difficult to prove, since there would be no visible
evidence for it in the individual chips.  It is also difficult to
disprove such a theory because the clipper key generation algorithms
are classified.

@_date: 1994-03-29 08:05:33
@_author: Bill Sommerfeld 
@_subject: questions for review committee. 
generation of each set of unit keys?
or entities provide the hardware and/or software to generate them?
Are they generated inside the "vault" at the time of programming or
held constant during the generation of a "batch" of chips?  If so,
what is the justification for this practice?
Question: if production reaches ~1 million units per year, or ~4000 per work
documented and examined by the review committee is the one actually
used in production?
studied by the review committee is the same as the one implemented by
the chip?  More specifically, have several members of the review
committee each coded their own SKIPJACK implementations, including the
escrow protocols, "from scratch" on computer systems not owned or
provided by the U.S. government, and compared their outputs to that of
the chips under study?  If this is not feasible, please explain why.
implementing the EES implements exactly and only the skipjack
algorithm, the documented escrow procedures, and other publicly
documented features?  Are there any VLSI experts on the review
committee?  If so, what chips have they designed, and what chips have
they "reverse engineered"?
By "assurances" I mean that there is an active process in place for
validating compliance to a particular requirement such that no single
*organization*, or single model of hardware can "fail" in a way such
that violation of the requirement goes undetected.
I consider the set of current and former employees of the Executive
Branch of the U.S. Government to be a single organization for purposes
of assurance.
Addendum to all of these:
If this information is classified, please justify this classification
etc., etc.,
Steve, I hope you don't consider any of these "have you stopped
beating your spouse"..

@_date: 1994-04-09 10:31:01
@_author: Bill Sommerfeld 
@_subject: Re: MIT sysop faces piracy charges. 
For those of you with WWW access, there is an article with much more
technical detail available from  in the April
8th issue of The Tech; they also have press releases from the DA, MIT,
as well as the indictment and the response which was posted.
If the messages in the indictment, do in fact, come from the accused,
then he's got a bunch of explaining to do...

@_date: 1994-05-04 07:38:22
@_author: Bill Sommerfeld 
@_subject: Re: The ITARs 
This is sick. According to this, I cannot teach foreigners about
   cryptography in the U.S. -- even about the open literature. This is a
   grotesque denial of my first amendment rights.
When this issue came up in a discussion on export control issues with
my employer's export control guru, he said that they basically never
bothered to enforce this in the case of open courses at colleges &
universities (because they knew it was unenforceable and

@_date: 1994-05-05 19:53:47
@_author: Bill Sommerfeld 
@_subject: Re: Chill out.... was Re: Keyserver service outRAGE 
One (minor) correction: Jeff is the MIT Network Manager; he's not a

@_date: 1994-05-11 19:56:36
@_author: Bill Sommerfeld 
@_subject: Re: State Dept Response to my second CJ request 
Does anyone think it would be worthwhile to go through the rigamarole
of CJ requests for "intermediate" cases?  Or is that just splitting
I can think of a couple... though setting these up would, of course,
require the cooperation of Bruce Schneier:
 - diskettes containing either all the source in one big file (with
page breaks), or one file per "page" as found in the book.
 - diskettes containing PostScript (or similar) source for the
appendix (where one has to parse the PostScript to get the program
text out) or even the whole book...  (Bruce Schneier or his publisher
might have a problem with this, though..).
 - diskettes containing .TIFF or .GIF images of the pages from the
appendix -- machine readable, but not easily compileable w/o character
recognition software.
I'm waiting for someone like Markoff to run a story with the headline
"Goverment Agency Rules Only Americans Can Type".

@_date: 1994-05-11 19:55:42
@_author: Bill Sommerfeld 
@_subject: Re: NSA & State Fears ITAR Lawsuits 
Someone who's had dealings with the NSA and State over these issues
   saw some memos, but was not allowed to make copies of them, which
   indicated that State's lawyer's were very concerned that an ITAR case
   involving software *not* ever reach the courts, because they felt the
   government's case was very weak and that a probable loss would be a
   serious setback in other areas.
Is there any chance that these memos would be subject to release under
the FOIA?

@_date: 1994-05-13 07:37:25
@_author: Bill Sommerfeld 
@_subject: Re: Cypherpunks Goals: Bad debate drives out good debate 
There's an additional "failure" case you didn't consider:
bad message, bad moderator: message accepted.

@_date: 1994-05-17 07:42:27
@_author: Bill Sommerfeld 
@_subject: Re:  Fixing pgp 2.6 
The thing is, though, that PGP 2.5 *doesn't* infringe on the patent,
   because of the use of RSAREF.  I think the broad silence from MIT and RSADSI on the subject of PGP
2.5 after the initial announcement means that this was a matter of
debate and that there were some serious negotiations going on between
the two.  I hope this means that the 2.5/2.6 time-delayed
incompatibility is a bone thrown to RSADSI to get them to support
*some* version of PGP.. which means that everyone in the U.S. (except
the government) will be happy afterwards.
A comment I heard from someone close to the situation was that the
2.5->2.6 format changes will be *very* small, and will be publically
documented in an "ITAR-proof" document.

@_date: 1994-05-17 08:42:29
@_author: Bill Sommerfeld 
@_subject: visual cryptography (talk by Shamir yesterday at MIT). 
Here's a brief summary of Shamir's talk at MIT yesterday, which was
well attended.
The problem he solved was to create a cryptosystem which is as secure
as possible, but can be decoded (with some care) using only the human
visual system.
Shamir described two applications of this system:
the receiving fax machine.
The cryptosystem in its simplest form encrypts a (bitmap) image as a
similar image but with half the resolution.
for each pixel in the plaintext, you expand it to four pixels in the
cyphertext and key.
The key (a "one time pad") is printed on a transparent material
(overhead projector transparancies).
each 2x2 grid in the key has a random selection of two pixels darkened:
There are six different ways to do this:
  | |   |# |   |   |   |# |   |  |   |    |# |  |   |# |   You then produce the plaintext as follows:
two pixels not colored in on the ciphertext.
same two pixels as the key.
Line the key up with the cyphertext (registration is somewhat tricky
particularly as the pixel size gets really small), and you get an
image which ranges in density from 50% gray to 100% gray.
as a practical matter, it works better if you use alternating vertical
and horizontal bars in a chessboard pattern because the image starts
to appear when you get the registration within just under 2 pixels.
Shamir also described extensions of this system to:

@_date: 1994-05-20 08:05:25
@_author: Bill Sommerfeld 
@_subject: Re: Sternlight "kill" file 
Given that you've already admitted posting it, a forgery claim is a
little late.
Claim "fair use".
You did not intend to make a profit from the republication, and the
republication was for educational purposes: to show the world that
Sternlight is playing hit-man for RSADSI...

@_date: 1994-06-06 20:04:35
@_author: Bill Sommerfeld 
@_subject: Re: The Crypto Home Shopping Network 
A year or so ago, my employer's export control expert said that
decrypt-only strong crypto for intellectual property protection was
exportable (in object code form only).

@_date: 1994-06-22 06:34:54
@_author: Bill Sommerfeld 
@_subject: Re: Another Cellular Vict 
Which suggests a "stealth" phone that randomly dithers its round trip
   delay a la GPS selective availability...
Well, I'm not sure how well that would work...  The "dither" on the
RTT can't go negative (for obvious reasons :-) ).
Presumably the dither turns a "He's somewhere on this circle" into a
"He's somewhere inside this circle".
If you vary the dither over time, someone trying to track you would
wait for the RTT to hit a local minimum to get the most precise fix.
If the dither introduced by the phone has to be the same for all cell
sites, it gets even easier.

@_date: 1994-07-01 07:04:53
@_author: Bill Sommerfeld 
@_subject: someone clue me in about USACM.. 
Could someone explain to me the difference, if any, between the
"USACM" and the panel of luminaries who put out the "Codes, Keys, and
Conflicts" paper?
The paper was downright bland in tone, while the one-page USACM
position in the press release is clearly hostile towards the EES.
Who is the USACM?  How big is it, who can join, and who has?

@_date: 1994-07-04 07:36:26
@_author: Bill Sommerfeld 
@_subject: Re: Dr. Dobbs Dev. Update 1/5 July 94 & Schneier 
> Applications include sending an encrypted message via fax: the
   > receiver can carry the key transparency with him and can receive
   > the encrypted fax from an insecure machine.  Cool stuff.
   Yea, cool stuff, especially if the fax doesen't shrink the transmitted    picture :-)  Shamir's comment on this at his talk at MIT was that the accuracy of a
fax machine in the horizontal direction was much better than the
accuracy in the vertical direction.  If the visually encrypted
document is a text file, you can adjust it so that it's correctly
registered for a few lines, read those lines, slide the key
transparancy by a small fraction of an inch, read the next few lines,
and repeat until you're done with the message.

@_date: 1994-07-07 08:33:17
@_author: Bill Sommerfeld 
@_subject: Re: Counting bits 
Since people are playing "my processor is better than your processor"...
This case (counting number of bits set in n-bit word) takes 2n+1
instructions on the HP PA-RISC processor.  (HP's compiler generates
2n+2 instructions, GCC takes 2n+1).  No branch instructions are
generated in either case.
HP's compiler uses the conditional skip feature of the PA
architecture, while GCC converts
( (x>>n)&1 being a single-instruction bitfield extract on the PA).

@_date: 1994-07-22 20:02:07
@_author: Bill & 
@_subject: Re: Gore's "new and improved" key escrow proposal 
Actually, that should be
(You get to choose your own escrow agent :-) ).
This should be trivial to implement; just treat it as an implicit
recipient in all PK-encrypted messages.

@_date: 1994-08-05 20:47:37
@_author: Bill & 
@_subject: Re: USPS digital signature annoucement 
OUR CUSTOMERS ARE ASKING US TO PLAY AN EXPANDED
   ROLE IN FACILITATING PAPER AND ELECTRONIC COMMERCE BECAUSE WE
   HAVE UNIQUE LEGAL AND INSTITUTIONAL RESOURCES TO ACCOMPLISH THE
   TASK.
Would you trust a cyberspacial authority who couldn't figure out how
to turn off CAPS LOCK?
This speech just screams out for someone to MST3Kify it..

@_date: 1994-08-23 07:36:31
@_author: Bill Sommerfeld 
@_subject: Re: Nuclear Weapons Material 
[this is wandering off the subject of this list, but...]
No, not exactly.  See Robert Serber's "The Los Alamos Primer/The First
Lectures on How To Build An Atomic Bomb" (ISBN 0-520-07576-5),
published by the University of California Press.  I'll quote from the beginning of Chapter 18:
   "To avoid predetonation, we must make sure that there is only a
   small probability of a neutron appearing while the pieces of the
   bomb are being put together.  On the other hand, when the pieces
   reach their best position we want to be very sure that a neutron
   starts the reaction before the pieces have a chance to separate or
   break.  It may be possible to make the projectile seat and stay in
   the desired position.  Failing in this, or in any event as extra
   insurance, another possibility is to provide a strong neutron
   source which becomes active as soon as the pieces come into
   position.   ...
Note that this is especially important with the more efficient
implosion-type bombs, where the critical mass just can't "seat" like
on one of the simple gun-type bombs.  Also note that you can't build a
gun-type bomb using P239; it reacts too quickly.
   "Evidently a source of this strength that can be activated within
   about 10**-5 sec and is mechanically rugged enough to stand the
   shocks involved with firing presents a difficult problem."
The text later states that the initiator used in the first two bomb
designs was a mixture of Polonium and Beryllium.

@_date: 1994-08-25 05:53:11
@_author: Bill Sommerfeld 
@_subject: Re: Nuclear Weapons Material 
Much as I hate continuing to inject facts into an off-topic
discussion...  I wouldn't call it "much later".
The first bomb *design* was the uranium gun-type bomb.  They thought
that they could use the same design with Pu239, but discovered when
their first significant samples of Pu showed up that it just wouldn't
The first bomb ever *detonated* (at Alamogordo, NM, on 16 July 1945)
was an implosion bomb using plutonium.  You see, the implosion design
was sufficiently hairy that they needed to test it before using it for
The "Los Alamos Primer" I cited yesterday contains a photo captioned:
   "Sgt. Herbert Lehr delivering plutonium core of first test bomb in its
   shock mounted case to the assembly room at McDonald Ranch, on the
   Trinity test site in the desert northwest of Alamogordo, NM, July 12
   1945."
(The "shock mounted case" in question is a rectangular box, roughly

@_date: 1994-09-01 05:40:03
@_author: Bill Sommerfeld 
@_subject: Re: Cyberspatial governments? 
If this is indeed the case, Matt Blaze's results should be
particularly devastating to them.

@_date: 1994-09-13 08:13:32
@_author: Bill Sommerfeld 
@_subject: Re: alleged-RC4 
Since I haven't seen a statement by anyone who I would believe that
this is, in fact, RC4, I'm calling it "Alleged-RC4"..
Actually, all the %256 operations in the code are superfluous on
8-bit-byte platforms since the indices are declared as `unsigned
There are two interesting features in this alleged-RC4 which clearly
put it above the typical xor-based homebrew cypher..
 1) the "pad" is maintained as a permutation of 0..255, so the output
should always have a close-to-uniform distribution of output values.
 2) the operations which stir the "pad" all have two counters: one (x)
which increments by 1 each time, and one (t) which moves in a way
dependant on the "pad" values.  The x counter guarantees that all
bytes in the pad get shuffled with roughly equal frequency, so you're
less likely to get stuck in a shorter-length cycle.  The y counter
moves in a "chaotic" data-dependant way, and each slot in the pad
affects its stepping in turn.
Probably the only potential weakness I can see is that the `x' and `y'
counters are always initialized to zero when starting off; this means
that an attacker can almost always know the `x' value used to encrypt
each byte of cyphertext they find.  I can't see any way to exploit
this, though.  It would seem that you could (slightly) strengthen the
cipher by starting with x=state[0] and y=state[1], then cranking the
key generation loop for two more iterations..
The fact that the NSA allows export of this cipher (albeit with keys
limited to 40 bits) is interesting.. unlike DES, the alleged-RC4's key
setup does not appear to be particularly parallelizeable.  A
fully-pipelined alleged-RC4 key breaker would require 256 stages of
key setup followed by n stages of "encryption" (with ~2k bits of state
per stage).  This is significantly more complex than the 16-stage
pipeline with ~128 bits of state per stage in the pipelined

@_date: 1994-09-13 08:42:14
@_author: Bill Sommerfeld 
@_subject: Alleged RC4 source code (message header only) 
In case any of you had filtered this one out based purely
on sender and subject, I've enclosed the *headers* of the message and
its first paragraph.
The message also contained two source files, "rc4.h" and "rc4.c",
implementing a stream cypher which is based on incremental shuffling
of a permutation of the numbers 0..255, and seems to be fairly
well-suited for efficient implementation in software.  For obvious
reasons, I'm not including the source files here.
    Date: Fri, 9 Sep 1994 22:11:49 -0500
    Message-Id: <199409100311.WAA12423
    To: cypherpunks
    From: nobody
    Subject: Thank you Bob Anderson
    Remailed-By: remailer
    Complaints-To: postmaster
    Sender: owner-cypherpunks
    Precedence: bulk
    SUBJECT:  RC4 Source Code
    I've tested this.  It is compatible with the RC4 object module
    that comes in the various RSA toolkits.

@_date: 1994-09-14 08:17:12
@_author: Bill Sommerfeld 
@_subject: Re: alleged-RC4 
Actually, in looking at the assembly code generated by three different
compilers (GCC on i386, GCC on PA, and HP's PA compiler), strangely
enough, the `% 256' should be `& 0xff' (it shaves a few instructions
off the inner loop for some reason which isn't immediately apparant to
On the PA, I got a ~30% speedup by unrolling the inner loop 4x,
assembling the pad into an `unsigned long', and doing one 4-byte-wide
XOR with the user data.  I think most of the speedup comes from giving
the instruction scheduler more instructions to reorder to avoid
load-store conflicts.  Your milage will vary on other architectures.

@_date: 1994-09-14 08:36:57
@_author: Bill Sommerfeld 
@_subject: Re: alleged-RC4 
I agree; this cypher should definitely be handed a unique key each
time it is used.
However, you can do this pretty easily for file encryption, too..
Generate and store an "initialization vector" with each file of
cyphertext.  Instead of passing the user key directly to RC4, you
instead pass a hash (MD5 or SHA) of the user key concatenated with the
If you don't have room to store the IV's, you could use some
position-dependant information (e.g., per disk ID plus disk block
number or file inode number) instead.

@_date: 1994-09-15 10:11:53
@_author: Bill Sommerfeld 
@_subject: Re: thoughts on RC4 
Actually, I'm not sure that it's that impractical, but I don't know a
heck of a lot about VLSI or hardware design.  A fully pipelined chip
would require significantly more more chip area than the DES cracker,
but you probably don't need that.  I'm pretty sure you could make a
blazingly fast, non-pipelined, chip with a "key setup" unit and then a
"trial encrypt" unit which run in parallel; you clock the key setup
unit 256 times to set up the key, then the key gets fed to the trial
encrypt unit where it gets tried against the known
plaintext/ciphertext pair..
Back of the envelope calculation: massively parallel RC4 cracker.

@_date: 1994-10-03 16:08:43
@_author: Bill Sommerfeld 
@_subject: Re: Mandatory Email verification 
Huh?  How do you count that?  There are dozens of algorithms described
in Schneier; most are described as either being of unknown strength
(due to insufficient cryptanalysis), or broken, or substantially
similar to a broken cipher.  Only a few are described as strong.
There's only one unconditionally secure cipher: the true one-time-pad.
And pigs can fly, and you have prime development land for sale in
south Florida..

@_date: 1994-10-05 06:53:19
@_author: Bill Sommerfeld 
@_subject: Re: Richard Stallman of GNU on Tcl 
To attempt to make this crypto-relevant:
Most scheme implementations support infinite precision integers
("bignums") directly, though some of them don't, and some of those
which do have really slow bignum support.
I haven't seen one with a fast modular exponentiation routine,
though :-).
I haven't looked at STk at all.

@_date: 1994-10-05 09:33:28
@_author: Bill Sommerfeld 
@_subject: Re: Referrences to SKE and GAK 
I think the main problem here is that the government seized the
initiative by using "Key Escrow" when they really mean "Government
Access to Keys"; also, the infamous Gore->Cantwell letter refers to
SKE, but clearly means, from context, that they're referring to what
you refer to as KEG.  This makes it difficult to advocate key escrow
of any form without appearing to endorse "escrow" with the government
as the grantee.
One can divide the use of encryption in computer networks in two
 - encrypting real-time communications
 - encrypting stored data (files).
Key escrow in the former case is only useful in the presence of
wiretaps, since the encrypted data is ephemeral.
The business/commercial justification for key escrow (having a "spare
key" around) is really only applicable in the second case.

@_date: 1994-12-02 05:47:55
@_author: Bill Sommerfeld 
@_subject: Re: FBI INVESTIGATING BLACKNET 
I also heard that the FBI was investigating Blacknet, and had asked
questions of someone quite a bit more reliable than Mr. Detweiler.
Apparantly someone didn't `get the joke' when Detweiler spammed the
world, called the FBI, and the FBI didn't get it either.
Your Tax Dollars At Work.
(BTW, the recent flamage about encouraging digitally signed messages
to cypherpunks prodded me into doing something I had been meaning to
do for a while: when I go to send mail in emacs, it prompts me if I
want to sign or encrypt the outgoing message.  It's a 10 minute hack
for anyone who knows emacs lisp, but it's something good which has
come out of the flame war...)

@_date: 1994-12-13 08:28:24
@_author: Bill Sommerfeld 
@_subject: Re: HTTP security 
Not just yet; they're currently arguing about this on the pem-dev
Nope, the IETF stds track is Proposed Standard -> Draft Standard -> Standard
Right, but with its preoccupation with negotiation, it seems to be
more oriented towards securing the *transaction* rather than the
There are at least three different layers at which HTTP and "the web"
can be secured:
1) - the *transport* (and lower) -- secured by IPSP and/or SSL 2) - the *transaction* (e.g, authentication for access control)
3) - the *document* (e.g., authentication by the document's author)
The difference between (1) and (2) becomes obvious when proxies are
involved.  Doing (2) complicates distributed caching, while (1) and
(3) don't really get in the way of caches.
Frankly, I think that the web needs (3), then (1), and only later (2).

@_date: 1994-12-14 07:48:26
@_author: Bill Sommerfeld 
@_subject: Re: BofA+Netscape 
Nope.  It's very similar to the CP/M `ed'. (I hesitate to say
"identical" since I haven't touched a CP/M system since 1984..), but
the first time I used edlin a couple years ago to edit an autoexec.bat
file, I had CP/M flashbacks...
Edlin is very different from the Unix `ed' and *its* ancestors (which
are a line of several line-oriented editors which started life on
CTSS, grew up on Multics, and were cut back down to size on Unix, only
to sprout up again into ex and vi..)

@_date: 1994-12-20 19:29:01
@_author: Bill Sommerfeld 
@_subject: Re: No privacy with DigiCash 
Yes... at least one TCP/IP proxy system (socks) lets the client
receive incoming connections (the client makes a second connection to
the socks server, and the socks server informs it of the addr/port
that it's listening on; when a connection comes in to that port, the
two incoming connections are gatewayed to each other); that's how
socksified FTP works, by the way.
Things could get sticky if the server needs to make multiple
connections to the wallet at the same address (in sequence or in
series), but I'd imagine that this wouldn't be the case..

@_date: 1995-01-02 06:36:02
@_author: Bill Sommerfeld 
@_subject: Re: Exporting cryptographic materials, theory vs. practice 
Actually, those of us who are going should arrange to take *separate*
flights...  My reading of Matt's message said that most of the time
was spent trying to figure out what to do, and only a little time was
spent actually doing it.  If a bunch of people all take the same
flight, it will take them only a slight bit longer to process the
whole bunch of you than if one person on the flight was doing it...

@_date: 1995-07-24 05:27:19
@_author: Bill Sommerfeld 
@_subject: Re: Netscape the Big Win 
Perry's right.
With a fairly current BIND (named), MIT stores on the order of 100-200
bytes of data per Athena user for ~25000 users.  MIT's been doing this
for years; for the longest time, they were using ~1 MIPS Vaxstation
II's with ~9MB of memory as DNS servers.  1024 bit RSA public keys are ~128 bytes, as are digital signatures.
If we allow framing and similar stuff to expand the size of the data
to 150 bytes per key/signature, and if each user had a signed key in
the DNS, this would roughly triple the amount of data in the DNS.
This Is Not A Problem.
I haven't looked at the CPU load needed to compute the signatures, but
that takes place off-line, not on-line.

@_date: 1995-08-09 21:48:01
@_author: Bill Sommerfeld 
@_subject: Re: "S1" encryption system 
BTW, I compiled it and confirmed that decryption is the inverse of
encryption for at least one (key, plaintext) pair..
It looks very much like the sort of typo you would get from a
mistranslation from assembly language if the target architecture had a
*4-bit* processor. (This is also consistant with the "<<4"'s which
show up in several places in the code).
The typo is consistant -- it shows up every time the key schedule is
referenced; it looks like a semi-mechanical translation was done..

@_date: 1995-08-18 08:17:33
@_author: Bill Sommerfeld 
@_subject: Re: Cost to Crack Keys 
And I think your cost estimate is also too high.  You're assuming
$5000 per system, and that's way too high.
You only need a power supply, a motherboard, a processor, a *tiny*
amount of RAM, a network device of some sort (so you can netboot the
systems), and probably a cheezeball display card; you can put one or
two monitors on a cart if you *really* need one hooked up.
You don't need a disk or disk controller -- it's just something else
to break..
Prices selected by throwing darts at the August Computer Shopper.
There are probably lower ones..
So, one could put together a P100 compute server for about $1000, and
a P120 for about $1400.. the P100 is a better deal at this point.
I suspect that with a little work, you could share power supplies
between multiple motherboards, rack-mount the systems, share
keyboards, etc.  You might need a slightly more expensive LAN card for
That cuts your cost estimate down by a factor of about 3 or better, to
around $350.00
I think your electricity estimate may be a bit low, but electricity is
expensive where I live in the northeast U.S...

@_date: 1995-09-20 05:25:33
@_author: Bill Sommerfeld 
@_subject: Re: My Day 
A couple comments on using the time as a seed:
Any system running NTP will let you know its clock to within a couple
ms; some folks have gotten NTP accuracy down to the high hundred
microseconds on real-time systems..
Any entropy you get from sampling the system clock will have to come
from the low-order bits of the tv_usec, or equivalent, and you'll only
get a few bits per sample.
Getting real entropy from mouse movements under X may be tricky,
because the X server goes out of its way to compress mouse movement
reporting and to buffer events sent to the client ("X is an exercise
in avoiding system calls").  You'll probably get less entropy than you
might think.
A 32-bit ms-resolution counter wraps roughly every 50 days.  Very few
Windoze PC's stay up that long :-).
In a long-term active attack, the tick count can be estimated by
periodically pinging the system under attack, noticing when it goes
off the air and then back on again, and using that as a base value for
the tick count search, so the tick count probably only adds a factor
of somewhat less than 2**10 to the keyspace, not 2**32..

@_date: 1995-09-21 19:19:20
@_author: Bill Sommerfeld 
@_subject: Re: netscape bug 
Nope, that wasn't it, either.
See the Eichin/Rochlis "tour of the worm" paper.  I was visiting friends at MIT the night the worm hit.  After receiving
some confused and unspecific reports that the worm was getting in
through fingerd, I had a flash of insight as to how that might happen;
as it turned out, this insight was correct, and shortly thereafter, I
had reproduced a benign form of the fingerd attack.  As implemented by
the worm, it only worked on vaxes, but it could have worked on other
The buffer in question was on the stack, not in static storage.
The attacker wrote a long sequence of NOP's, followed by machine
instructions which implemented the equivalent of exec("/bin/sh"),
followed by the approximate stack address of the stack buffer; the
last address was at the right place to overwrite the saved PC field in
the stack frame.  When the routine "returned", it actually branched
into the runway of NOP's, and then exec'ed "/bin/sh".
Note that the actual stack address varied, as environment variables
(which tend to vary from installation to installation) are located at
the top of the stack.
As it turned out, the attack did not work on most Athena systems,
because the athena /etc/rc complex wound up using a large number of
environment variables which pushed the location of the stack frame in
question out of the range where the attack would have worked.

@_date: 1995-10-06 07:17:57
@_author: Bill Sommerfeld 
@_subject: Re: PCMCIA Crypto 
For those of you who don't recognize the company name, Spyrus makes
one version of the Tessera^H^H^H^H^H^H^HFortezza card.
Is Spyrus the Toys 'R Us for spies? :-)

@_date: 1995-10-16 06:27:13
@_author: Bill Sommerfeld 
@_subject: Re: Why commercial key escrow? [Re: My chat with Goeff Greiveldinger] 
Yup, those of us who already paid the up-front cost to build two
versions of our products are not about to *weaken* our domestic
version just to go back to having only one version.

@_date: 1995-10-24 19:48:20
@_author: Bill Sommerfeld 
@_subject: Re: 80 bit security from 40 bit exportable products 
C'mon Bob.. how long has it been since you picked a lock? :-)
Given the likely presence of known or verifiable plaintext at each
nesting level, a three-deep nesting of 40-bit ciphers like this
probably increases the strength to about, ohh, a 42 bit cipher.

@_date: 1995-10-24 20:17:57
@_author: Bill Sommerfeld 
@_subject: Re: textbooks 
I meant to bring this up with Charlie Kaufman and Radia Perlman when I
got the book, but never got around to it..
The following line of thinking was inspired by the NSA "patch" to SHA:
the addition of a rotate-left-one-bit operation to each round of SHA,
which yields faster mixing between values in bit positions within the
Actually, I found the proof not completely convincing.  It's really a
proof that it doesn't strengthen the DES against a *known plaintext*
attack, but there are other weaker attacks it may make marginally more
difficult (or easier..); for instance, partially-known plaintext or
some forms of verifiable plaintext.
The FP/IP don't add *much* security, but I'm not about to say that
they add *no* security.
Again, their proof assumed that all the bits of the key are
independant and unbiased -- which they will be if you're careful, but
won't be if you're stupid.
Remember that the NSA designs ciphers for use by people with a high
school diploma or less :-).

@_date: 1995-11-07 13:40:23
@_author: Bill Sommerfeld 
@_subject: Re: forging headers 
More specifically, the headers which are most needed are the Received:
and Message-Id: headers; each mailer along the path adds another
Received; header, typically with its name, a timestamp, and sometimes
the name or address of the previous system.  Other headers may also help.
