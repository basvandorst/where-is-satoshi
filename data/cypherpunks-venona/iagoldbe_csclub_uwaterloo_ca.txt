
@_date: 1995-08-29 22:13:04
@_author: Ian Goldberg 
@_subject: Netscape's RNG 
Someone on the list (sorry, I forget who), suggested that Netscape's RNG
be looked at to see if the secret part of the SSL RC4/40 master key could
be determined more directly.
I used gdb on the Solaris version.  SSL_GenerateRandomBytes() is called
when random bytes are needed.  It initializes the RNG, if necessary, and then
calls RNG_GenerateRandomBytes.
When I run "netscape SSL_GenerateRandomBytes() is called 3 times; the first time, 32 bytes
are produced (I don't know what they're for); the second time, 16 bytes
are produced (the Challenge data); the third time, 64 bytes are produced,
the first 16 of which are the master key (the first 11 of which are sent
in the clear, and the next 5 are our goal).
Here's my own hand-reverse-assembly of RNG_GenerateRandomBytes:
(Correctness not actually guaranteed in any way...)
struct RNG
    unsigned char md5bytes[0x10];
    unsigned char randbytes[0x10];
    int size;
    void *md5data;
RNG_GenerateRandomBytes(struct RNG *i0, char *i1, int i2)
    char buf[0x20];
    int o1,o2;
    while (i2 > i0->size)
    {
    }
    /* i2 <= i0->size */
    memcpy(i1, &(i0->randbytes)+0x10-i0->size, i2);
    i0->size -= i2;
    return 0;
It looks like that Compilers course came in handy...
So it's not linear congruential.  I guess the next step is to figure out
how it's seeded, but that not for me to do (at least not tonight...).
Here's another question about a more direct method:
The 5 secret bytes are encrypted with the server's public (RSA?) key.
Does the server use the same public key every time?  How do you read
the public key, given the Certificate Data (what's the format of the
certificate)?  Is it feasible to try to attack the public key with a
massively parallel (Internet) factoring program (a la RSA-129)?
Assuming that the modulus is _big_, it still is worthy to note that,
unlike cracking individual challenges, cracking the public key will
compromise _all_ communications with that server (until they catch on
and pay $$$ for another key (I think?)).
Just some thoughts,
   - Ian "it's only 10pm _here_, but it's 2am in Nova Scotia!"

@_date: 1995-09-05 12:46:19
@_author: Ian Goldberg 
@_subject: Re: Wearing RSA shirt to school 
OK, I'm confused.  Is it or is it not legal to disclose cryptology to
a foreigner?  T.C.May (I think it was; sorry if I misremember this) posted
a couple of days ago that it _was_ legal (citing that textbooks are not
stopped from being published internationally).
Perhaps this is just because the publishers of these texts never applied
for an export license (maybe)?  I was reading Bernstein vs. US Dept. of
State, et al. (
and found this:
G.  RESULT OF DEFENDANTS' REJECTION OF PLAINTIFF'S CJ REQUEST
    71.  Plaintiff's scientific paper, algorithm and computer program are
speech protected by the First Amendment to the United States Constitution.
Thus, by rejecting Plaintiff's CJ Request, Defendants have determined that
these items are "defense articles or defense services" which may not be
exported without submitting to the above-described prior restraints.  Since
Defendants define "export" to include disclosing or transferring cryptology
to a foreign person anywhere in the world, including within the United
States, Plaintiff is informed and believes and therefore alleges that he is
required by law to obtain a license to publish or publicly discuss any of
the Items whether within or outside the United States.
    72.  Plaintiff is presently unable to publish his scientific paper,
algorithm or computer program within or outside the United States.  The
only reason preventing publication is the threat of prosecution for an
illegal export if he does so without a license.
    73.  To this date, Plaintiff has not received a response to his
appeal or a license to publish his paper, algorithm, or computer program
and as a result, he has not published the Items.
So it seems to me (at least according to the Plaintiff (EFF, I guess)),
that the ITAR regulations _do_ restrict publication and public discussion
of cryptology.
   - Ian "and why is Canada considered part of the US for this?"

@_date: 1995-09-15 21:57:41
@_author: Ian Goldberg 
@_subject: Re: Quantum computing info? 
In article <199509160259.TAA03727
Try    - Ian "hoping this new mail2news gateway works in reverse as well"

@_date: 1995-09-16 12:40:45
@_author: Ian Goldberg 
@_subject: cypherpunks as a newsgroup 
In article ,
That was my thinking exactly.  That's why I wrote just such a mail2news
gateway to a local newsgroup, csc.lists.cypherpunks (moderated, with
cypherpunks as the moderator), as you can probably see in
the header.
This way, trn groups all articles with the same subject together,
and correctly threads articles that have References: or In-Reply-To:
As for the location, I'd agree with comp.security.cypherpunks.
Watch out, though; the list/group will probably get a much higher
readership as a newsgroup.  Although this is good for the
"make the public aware" goal, remember that, as far as I can tell,
September 1992 never ended.
I've been very impressed with the signal/noise ratio on this list.
In fact, people often put [NOISE] in the subject line to flag trivial
content.  This ratio will certainly go down if we go to a newsgroup.
One of the main benefits of Usenet is that anyone can _post_.
One of the main detriments is that _anyone_ can post.
   - Ian "that would have been much more elegant in Latin"

@_date: 1995-09-18 13:22:52
@_author: Ian Goldberg 
@_subject: unssl.c available for ftp (was: Netscape's random numbers) 
In article ,
Too late.  The news (in the form of a call from John Markoff, New York Times)
came to Dave and me first thing this morning.
In other news:
unssl.c is presently in the /pub/cypherpunks/incoming/ directory
on ftp.csua.berkeley.edu.  Remember: you must be a "US person"
to download it blah blah blah.  It will (hopefully) soon move to
a more suitable location under /pub/cypherpunks.
The HP on my desk seems to like compiling it with "gcc -O3 -o unssl unssl.c".
   - Ian "it's now about 1:20 pm PDT; I wonder when it will get exported..."

@_date: 1995-09-19 09:35:25
@_author: Ian Goldberg 
@_subject: Random publicity was: articles 
In article <199509191435.HAA00275
So far, I talked to the NYT and the WSJ yesterday, as well as the SF Chronicle.
This morning, one of the University's publicity people
 forwarded Marketplace (a radio show)
and CNN (sending a camera crew) to me.
I've also received email from various people, including someone who
works in security at the Pentagon.
I wonder if I should tell them I'm not an American?
   - Ian "but I'm Canadian, so that's the same thing, right?" :-(

@_date: 1995-09-19 20:34:28
@_author: Ian Goldberg 
@_subject: Re: Encryption algorithms used in PrivaSoft (fwd) 
In article <9509191929.AA15153
Waitasec...  I was under the impression that if you patented it, you had to
reveal it.  That's why RC4 isn't patented (it used to be a trade secret).
   - Ian "IANAL yadda yadda"

@_date: 1995-09-19 21:09:35
@_author: Ian Goldberg 
@_subject: My Day 
Well, my brain's pretty frazzled about now (and I still have a pretty dense
paper on xFS to read and summarize for 9am tomorrow for my OS class) from
all the press that's gone after me today.
The ones I wrote down (I believe sameer wanted a list; I have names and
numbers for some of these, too, bt it was pretty hectic: get off the phone,
go to my terminal, note that I have 20 new mail messages from people wanting
interviews or info, and answer the phone because it's ringing again.):
NY Times
WS Journal
SF Chronicle
CNN (camera crew)
Marketplace (NPR)
SF Examiner
Kansas City Star
Chronicle of Higher Education
Boston Globe
Newsweek (or WiReD; it was Steven Levy)
and at least half a dozen more.  Not to mention the job offers, one call
that I couldn't decipher (it sounded like one of those AI's that you see
roaming the net every so often, only on the phone), and email in French
(je suis canadien, but I was still amazed I could understand it).
Sorry for the blathering, but that's how I feel just now.
BTW: the line we tended to stress was "public availability of source to
at least the security bits", but who knows how it will come out?
Holger.Reif (Holger Reif ) was kind enough to
verify that the SunOS 4.1.3 version of Netscape generates its keys in
_exactly_ the same way as Solaris and HP-UX; he says he'll test other
architectures tomorrow.  I suspect any big-endian machine with the
lrand48() function (which is used in key generation on Solaris/HP-UX;
it's disguised in unssl.c as the macro mklcpr()) will be the same.
Other Unix flavours should require only minor changes.
I'm still interested in what Windoze clients do (other than lose).
   - Ian "So how _did_ Netscape's stock do today?"

@_date: 1995-09-20 14:56:33
@_author: Ian Goldberg 
@_subject: Re: netscape's response 
But you don't have the usec at all, if I read your post correctly.
Windoze uses the time in seconds (essentially 0 bits of randomness,
maybe a couple, since Windoze machines don't set their clocks very well),
and the tick count.
In one hour, the tick counts counts to 3600*1000, or about 22 bits.
Many hours given another bit or two.
Thus, in total, given *no* information except the assumption that the
clock is reasonably accurate, you get at *most* 25 bits.
Since our code can do 21 bits in 1 minute, we'll need 16 minutes.
   - Ian

@_date: 1995-09-20 15:19:12
@_author: Ian Goldberg 
@_subject: Re: Please send me SSL problems... 
In article <199509201004.DAA23933
Well, if you'd release Netscape source, we could check its
implementation... :-)
   - Ian

@_date: 1995-09-20 22:32:57
@_author: Ian Goldberg 
@_subject: Re: Cypherpunks Hold a Cracking Party 
In article <199509201812.OAA28709
How many more can there be?  I must have given interviews to a large
percentage of them by now. :-)  Luckily, it's starting to subside.
I actually had almost a whole hour today during which nobody called.
Was it like this for Damien?
   - Ian "whose brain melted after Monday's deluge"

@_date: 1995-09-20 22:36:19
@_author: Ian Goldberg 
@_subject: Re: Munitions shirt (again) 
In article ,
Just some random thoughts while my brain is goo... :-)
   - Ian "that, and I'm trying to figure out your country's legal system..."

@_date: 1995-09-20 22:47:57
@_author: Ian Goldberg 
@_subject: Patents and trade secrets was: Encryption algorithms used in PrivaSoft (fwd) 
But don't they have to put something on the patent application?  Can they
claim trade secret status for something that was on a patent application,
but rejected?  That seems like they're getting it both ways.  They should
probably have to choose whther or not they want to show anyone their
"secret".  If not, it stays a trade secret.  If so, it's not a secret anymore,
and they hope it's "nonobvious, etc." enough to be granted a patent.
   - Ian "I heard that 'x*y=[(x+y)/2]^2 - [(x-y)/2]^2' is a patented way

@_date: 1995-09-20 23:03:56
@_author: Ian Goldberg 
@_subject: [NOISE] "hacker" was: first virtual "security" 
In article <0kMA2EqMc50eMEb4Yx
Ugh.  That word again.  I'm only 22, but I'm old enough to remember
when there were people called "crackers", and being called a "hacker"
was a _good_ thing.
I know at least one article about the break went, "Two hackers in
Berkeley, California...".
We actually got questions from reporters asking why we didn't just use
our newly-found hole to snoop financial transactions.  I've done a lot
of root-breaking in my (short) time, but I work for the Good Guys (TM).
  - Ian "hey, I warned you it was noise"

@_date: 1995-09-20 23:12:00
@_author: Ian Goldberg 
@_subject: Re: FROM A FRIEND . . . 
In article <43qrhf$gd5
Who _is_ legally prohibited from using it?  I think there are some countries
where the very use of crypto is illegal (could someone please list them?),
but who else?
There are some people that may be legally prohibited from _obtaining_ it
from a US site (ITAR yadda), but even so, if JRFurriner downloads
crypto from company C's site in the US, who's guilty of ITAR-violation?
Company C for making it available, or JRF for initiating the action
that caused the bits to be send out of the country?
   - Ian "my, I seem to be posting a lot tonight"

@_date: 1995-09-21 08:50:26
@_author: Ian Goldberg 
@_subject: XDM has the same problem as netscape ?! 
In article <9509210631.AA18308
Wow.  I just checked, and Nelson's right.
The seed is this:
 ITIMER_REAL
    {
        struct timeval  now;
        X_GETTIMEOFDAY (&now);
        ldata[0] = now.tv_sec;
        ldata[1] = now.tv_usec;
    }
    {
        long    time ();
        ldata[0] = time ((long *) 0);
        ldata[1] = getpid ();
    }
and if you don't have XDMAUTH defined, the auth value is this:
        seed = (ldata[0]) + (ldata[1] << 16);
        srand (seed);
        for (i = 0; i < len; i++)
        {
            value = rand ();
            auth[i] = value & 0xff;
        }
Oh, well.  We knew X didn't have much in the way of security, anyway...
   - Ian

@_date: 1995-09-21 09:35:06
@_author: Ian Goldberg 
@_subject: Re: Fraud Fraut Froth 
In article <199509211130.HAA20039
The work we did was not funded by anyone.  If someone out there would
care to rectify this situation, he can let us know. :-)
   - Ian "Grad students are not notoriously wealthy in this country,
            either, right?"

@_date: 1995-09-27 15:02:29
@_author: Ian Goldberg 
@_subject: Re: Insecurity in WWW oriented security 
[Story about hospital wanting to use "secure" Netscape deleted.]
On a similar note, just after the unssl announcement, I got email from
someone who works in network security at the Pentagon, saying that
users in his domain were "expressing their desires to use Netscape
to do some sensitive things."
I wonder if anyone's packet-sniffing the Pentagon?
   - Ian "I mean _besides_ the NSA."

@_date: 1995-10-11 14:29:04
@_author: Ian Goldberg 
@_subject: Re: Checksums for current beta versions of Netscape Navigator 
'sabout time.
In article <199510110921.CAA29849
He put his private key on his web page?  Um, maybe not... :-)
   - Ian "Oh, no.  Not again."

@_date: 1995-10-19 10:44:55
@_author: Ian Goldberg 
@_subject: Re: REMINDER: SF Federal Building, Oct 20, 1015AM: Bernstein case 
A handful of interested students from Manuel Blum's Crypto class at
Berkeley will likely be attending (sort of an unofficial field trip).
I've managed to raise awareness and interest in this issue among the
   - Ian "I doubt some of these grad students even _have_ banker outfits..."

@_date: 1995-10-23 17:02:50
@_author: Ian Goldberg 
@_subject: Hacking Digicash (was: Article on Digital Cash in "Worth") 
In article ,
What about us "current" Goldbergs and Wagners? :-)
We should be keeping in mind that the goal here is to end up, in one way
or another, with a _secure_ way of transacting on the net.  To that end,
it may be necessary to demonstrate that some current products don't
provide that way.  We certainly don't want people to be scared away
from using one insecure product, only to use another, especially
if the latter is less secure than the former.
At least Netscape published their protocols, if not their implementation.
Digicash, AFAIK, hasn't even done that much.  There is absolutely zero
reason for me to believe that their client is safe.
For all I know, it could be an essential part of the protocol
to send a dump of my harddrive to Digicash every time I deposit money
into my account.
I do intend to attempt a reverse-engineer of the ecash protocol,
assuming no one points me to an online copy (no, a paper copy obtained
via a NDA doesn't count).  Donations of a Sparc client binary
and/or access to a real ecash account will be gratefully accepted.
If the reverse-engineer ends up showing a protocol misfeature or
(more likely) a bad implementation (such as a buffer overflow),
I'm not going to keep quiet about it.  Netscape reacted quite
commendably to the finding of bugs in their software (quick admission
of the problem, and timely bugfix).  Hopefully, Digicash will
be as good about it.
Everything would be _so_ much easier to check, though, if these
people would stop this "security through obscurity" garbage and
publish their protocols, if not their source.
   - Ian "Mr. Worf, activate targetting scanners."

@_date: 1995-12-04 11:09:11
@_author: Ian Goldberg 
@_subject: How to steal ecash (was: Questions/Comments on ecash protocol) 
In article <199512030127.RAA03496
After reading the responses to my questions/comments, it seems that, if
Charlie (the customer) wants to cancel a payment, his ecash client sends
a copy of the payment, including the payer_code field (which evidently was
not in the original payment), to the mint.  The mint accepts the payment
because the payer_code was supplied.  However, the payer_code is sent
_in the clear_.
Thus: How to steal ecash:
This method can be used by Mitch, an active eavesdropper, though all he really
needs to be able to do is selectively remove or delay packets in transit.
Mitch taps either his target, or, better yet, the mint, and watches for
deposits to the mint that have the payer_code filled in (a cancelled payment).
He delays that packet, and sends the identical deposit to the mint himself
(with his own userID in the userhdr, of course).  The mint, being unable
to know who withdrew the coin originally, has no reason to believe it wasn't
Mitch, and so happily deposits the money "back" in Mitch's account.
Mitch is then free to release the delay on the original packet, and
Charlie's deposit fails (as the coin has already been deposited).
So:  do I win
anything?   :-)
Disclaimer: Don't do this.  Then again, is it illegal to copy ecash?  I doubt
  it's considered counterfeiting.  What about creating ecash out of thin air
  (say I had a magic factoring box (like a quantum computer (well, not yet)))?
   - Ian "IANAL, but IAA security-wise net.citizen..."

@_date: 1995-12-04 14:54:48
@_author: Ian Goldberg 
@_subject: Re: Questions/Comments on ecash protocol (fwd) 
In article ,
But do the current implementations support this?  Can Sam's Shop's ecash
client tell that the payment he just received was made out to " and
if so, should encrypt the deposit message to the bank?  What if Sam is not
around to enter his secret key?
   - Ian

@_date: 1996-01-04 08:30:45
@_author: Ian Goldberg 
@_subject: Re: 2047 bit keys in PGP 
In article ,
Order of magnitude check:
There is a very well-defined limit to the size of key that can be broken by
brute force, independent of your "wildest dreams" as to the growth of
technology.  It's the Laws of Thermodynamics.
For a symmetric algorithm for which any value of the appropriate length n
is a possibly valid (and equally likely) key, there are 2^n keys to try
in a brute-force search.  From Applied Crypto, 2nd ed, pp157-158,
setting or clearing one bit takes at _least_ 4.4*10^-16 erg of energy.
For symmetric keys of size 256, then, you would need more than 10^61 erg
(that's 10^45 GJ) of energy just to _enumerate_ the states.  For comparison,
this about 10 billion times larger than the output of a typical supernova.
From the same source:
"These numbers have nothing to do with the technology of the devices;
they are the maximums that thermodynamics will allow.  And they strongly
imply that brute-force attacks against 256-bit keys will be infeasible
until computers are built from something other than matter and occupy
something other than space."
Thus this situation is quite different from the 640K of RAM scenario.
It's more like "who would ever need more RAM than you could get by
storing a bit on every subatomic particle in the universe".  It's
not a matter of what resources you can imagine using, but rather,
what resources are in the universe, able to be used.
   - Ian "First post of the morning; it shows, doesn't it..."
