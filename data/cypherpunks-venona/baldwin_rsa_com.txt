
@_date: 1995-08-22 09:31:26
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Any code for getting noise from PC & Mac sound card? 
I am looking for an example of software that extracts unpredictable
bits from the sound cards of PCs and MACs.  Has anyone written software
like this?  Can someone send me a URL to it?  Thanks,
                --Bob Baldwin

@_date: 1995-08-31 08:49:59
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Some details on RSA Secure 
Here are my biased comments on RSA Secure.  They are biased by
the fact that I an a techie who works for RSA Data Security.
Neatest Features:
- It is integrated with the File Manager on Windows and the
  Finder on Mac System 7.
    For example, from the file manager you can double click on
  an encrypted Excel spread sheet and the file will automatically
  decrypt and launch Excel.  The decryption can be automatic
  because the file manager hangs on to your password for a settable
  number of minutes.
- A settable list of files can be automatically decrypted (or
  encrypted) on system startup (or shutdown).
Technical Features:
- The random number generator for file encryption keys and public
  keys is seeded by user keystrokes or wiggling the mouse.  The
  GUI for this is really fun to play with, but it only comes up
  when you first install the software.
- The user's passphrase unlocks a master key that is used to unlock
  the file encryption key for each file.
- Tamper detection for encrypted files using an MD5 hash.
- If emergency key access is turned on then the file encrypting
  key is also encrypted with the public key for emergency key
  access.  That public key is usually split into 5 or more pieces
  and two or three of the pieces are required to perform the
  emergency access functions.  A quick look at the file header
  reveals whether the escrow feature is in use.
- Files encrypted with the 40 bit demo version can be read by
  the 80 bit commercial version, and will be automatically
  upgraded to 80 bit security when they are reencrypted.
- Runs on DOS, Windows, Mac, and SunOS.  Other ports coming soon.
Coming Soon:
- Password based file sharing.  A simple way to protect files
  in transit using a secret passphrase known only to the sender
  and receiver.  Currently, only the person who encrypted the
  file can decrypt it.
- Self decrypting binaries.  This allows you to send an encrypted
  file to someone who does not have RSA Secure.  They execute
  the file, which then asks for the password and extracts the
  contents if the password is correct.  The sender can choose
  to use 40 or 80 bit encryption keys in order to comply with
  export regulations.
Request for Improvements:
        What else should be in a product that is aimed at
the commercial laptop market?
                --Bob Baldwin

@_date: 1995-09-07 12:51:50
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Commercial Speech over Internet product 
Here's an article about a commercial company that is doing speech
over the Internet.  Maybe someone would like to help them add encryption.
                --Bob Baldwin, speaking for myself only.
    ------------------------
TrueSpeech Player enables real-time audio over Internet
SANTA CLARA, CALIFORNIA, U.S.A., 1995 SEP 1 (NB) -- DSP Group Inc. (NASDAQ:DSPG) announced a new Windows product, TrueSpeech Player, that is freely available on the Internet. The TrueSpeech Player enables TrueSpeech- encoded speech to be played in real-time over the Internet.
Kurt Magdanz, director of business development at DSP, told Newsbytes, "The TrueSpeech Player utilizes the TrueSpeech compression technology bundled in Microsoft's Windows 95 and Windows NT. True Speech is a very high quality algorithm which compresses speech. TrueSpeech Player allows users to decompress TrueSpeech in real time."
With the TrueSpeech compression algorithm, speech is communicated in real- time over standard telephone lines to computers capable of communicating at data rates of 14.4kbps (kilobits per second) or above, Newsbytes was told. Because the TrueSpeech Player converts compressed speech data in real-time, World Wide Web site visitors have access to high-quality speech over the Internet in real time, said Magdanz.
"The TrueSpeech Player is our first step in enabling high-quality speech communication in real-time over the Internet," said Yuval Cohen, vice president of business development with the DSP Group. "World Wide Web site and content developers can immediately begin developing TrueSpeech Player- compatible content without paying fees."
"Content developers who wish to create TrueSpeech Player-compatible speech content should visit our World Wide Web site for detailed instructions on how to use this new product," said Cohen.
DSP Group is currently developing an advanced TrueSpeech Server software package which will offer content developers tools, interaction with the TrueSpeech Player to enable advanced features, live broadcasting capability and enhanced server control with diagnostics, said Magdanz.
The TrueSpeech Player can be downloaded freely from DSP Group's World Wide Web site,  .
DSP is headquartered in Santa Clara, California.
(Richard Bowers/19950831/Press Contact: Kurt Magdanz, DSP, 408- 986-4300)

@_date: 1995-09-20 08:56:44
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RSA Prevails In Arbitration Against Cylink 
Here's an article on the RSA-Cylink arbitration from
the business wire.
                --Bob Baldwin
-   -----------------------------
RSA Prevails In Arbitration Against Cylink
REDWOOD CITY, Calif.--(BUSINESS WIRE)--Sept. 19, 1995--An Arbitration Panel recently ruled that Cylink does not have a license to RSA patented technology, that RSA's software licensing practices do not breach any agreement with Cylink or its wholly owned subsidiary Caro-Kann and that RSA now has the exclusive right to license the RSA patent.
In a Sept. 6, 1995 ruling, an Arbitration Panel, formed by agreement of the parties, and after nearly a month of testimony, ruled in favor of RSA on every significant issue. The Panel held that neither Cylink nor Caro-Kann had a license to practice RSA patented technology. Cylink admittedly incorporates this
technology in its Secure X.25 product line, without any license to do so.
The Panel also found that RSA's software licensing practices did not materially breach any of Cylink's rights. The Panel did not rule that anyone, (specifically
including RSA and its software customers) infringed any existing patent rights of anyone - including Cylink.
As a result of the Panel's ruling, RSA now has the exclusive right to license the patented RSA technology. According to Jim Bidzos, the President of RSA, `RSA
will continue to conduct its software business in exactly the same way that it has for the past ten years.
`In addition, RSA anticipates that licenses to the RSA Patent will now be much more readily available, because they now can now be granted without Cylink interference. RSA has all of the intellectual property rights which it needs to license its software. RSA will vigorously defend against any claim to the A recent Cylink press release on the Ruling of the Arbitration Panel is wildly inaccurate. The same Robert Fougner (Cylink's General Counsel) who is cited in the Cylink press release has repeatedly made express representations to third parties that the Stanford Patents do not cover, and are not infringed by, the manufacture, use or sale of products incorporating RSA's TIPEM software developer's toolkit.
As noted by Mr. Bidzos: `Cylink lost every single significant issue in the Arbitration. Their press release was simply an attempt to cover up what has been
a crushing defeat.`
Questions regarding the Arbitration Panel Ruling or RSA licenses should be directed to Kurt Stammberger, RSA Technology Marketing Manager, or Paul Livesay,
RSA Director of Legal Affairs.
CONTACT: RSA
Kurt Stammberger, 415/595-8782

@_date: 1995-09-28 12:03:44
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Q&A on the RSA/Cylink legal dispute 
Here is RSA's Question & Answer sheet on the arbitration.
It is available on our web site,                 --Bob
______________________________ Forward Header __________________________________
  [RSALogo]   ---------------------------------------------------------------
              Q&A ON THE RSA/CYLINK LEGAL DISPUTE
This page contains general questions that have been brought up to us regarding the legal dispute between RSA and Cylink. We are providing these answers in hopes that you may better understand the issues.

@_date: 1995-09-29 18:19:08
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RSA's comments on RC4 weak keys 
Well, I seem to be falling into the role of spokesperson
for RSA on the net.  It gives me something to do other than
design reviews and programming.  Here is our response to the excellent work that Andrew Roos has been doing on RC4.  I am
glad that people are looking at RC4 critically.
                --Bob
September 29, 1995 statement from RSADSI
RSA Data Security Inc. has been following the emerging
reports of a weakness in certain keys for the RC4 cipher.
RSADSI's researchers have been aware of this particular
property of the RC4 cipher for over a year.   Most ciphers
have a property whereby an enormous amount of known
plaintext will provide a slight reduction in exhaustive key
searching.  The linear cryptanalysis of the DES cipher is an
well known example of this.   Limitations like this in the
underlying ciphers are addressed by following sound advice
on the design of the overall cryptographic system.
Products that include RC4 from RSADSI are not compromised by
this attack.  Companies that license the BSafe cryptography
toolkit have always been given advice that overcomes this
limitation of the RC4 cipher, and this is true even for
products that were built >before< this specific problem was
discovered by the researchers at RSADSI.   These researchers
also monitor all developments in the field of cryptography
and cryptanalysis so they can keep RSADSI's customers
appraised relevant developments.

@_date: 1995-10-31 10:24:00
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Keyed-MD5, and HTTP-NG 
There are a few different ways to add key material to MD5 to
make it suitable as a shared-secret authenticator function.  Some of these
are less resistant to attacks than others.  For example, the keyed MD5
mechanism that is part of the current IPsec specifications can be
attacked using 2**60 chosen messages.  Fortunately, the IPsec specs
also require that the shared MD5 key be changed every 2**32 messages,
so this attack is unlikely to succeed.  Specifically, IPsec uses
MD5 as follows:  X = MD5(key | keypad | Message), where "|" means
concatenation and the "keypad" pads out the key to 512 bits.
Basically, this function is the same as standard MD5 with a
different initialization vector for the compression operation
on the first block of the message.
        RSA Labs recommends that a people use an authenticator like
X = MD5(key1, MD5(key2, Message)).  This resists the chosen plaintext
attacks that were published at the crypto conference in Spring 1995.
        There are also some very fast MAC algorithms being proposed
these days.  As Phill Hallam mentioned, you may want to look at the
work of Phil Rogaway.  At a minimum, make sure that your standard
allows people to migrate from a current solution based on MD5 to a
future solution based on new functions.  However, I would be relunctant
to require new functions until they have had a chance to be tested
by the cryptographic research community.
                --Bob Baldwin

@_date: 1995-10-02 12:51:40
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Re: Certificate proposal & X509 clarifications 
The Distinguished Name of X509 is NOT intended to be the
unique identifier of a person or a public key.  In the X509 world
two different DNs can have the same public key, and a single
DN can have multiple certificates with possibly different
public keys.  The same public key naturally appears in multiple
certificates when each certificate is only valid for a certain
period of time (e.g., weekly certificates have been proposed for
applications that do not want to implement revocation lists).
        The unique identifier in an X509 certificate is the
DN of the issuer and the serial number that the issuer attached
to the certificate.  Both of these fields appear in the version 1 X509
certificate.  Of course, this assumes that issuers are
following the rule of not issuing two certificates with the same
serial number.
        The designers of version 1 of the X509 certificate format
have realized that they need to allow issuers to attach all kinds
of different attributes to a public key.  This lead to version 3
of the X509 format, which provides for general extensions.  Of course,
this means that there is more rope to hang yourself with when it
comes to designing an overall system, but with careful design,
lots of good things can be done.
        For example, for the S/MIME secure mail effort, the certificates
include the email address of the owner, as certified by the company
that is providing the email post office (e.g., the employer or
service provider).  Note that Netscape Navigator 2.x will support
Version 3 X509 certificates and S/MIME.
        Question: what's a good way to have the existing PGP public
key infrastructure interoperate with the X509 infrastructure?
                --Bob

@_date: 1995-10-12 08:06:57
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RSA Data Security, Inc. To Exclusively License Rights to RSA 
Here's the latest press release from my employer.  As was pointed
out earlier, for those who did not already know, Business Wire articles
are written by companies and distributed to news agencies by BW for a fee.
                --Bob Baldwin
RSA Data Security, Inc. To Exclusively License Rights to RSA Public Key Encryption and Digital Signature Standard (DSS) Technologies; Company Becomes One-Stop Worldwide Source for Encryption Technology
REDWOOD CITY, Calif.--(BUSINESS WIRE)--Oct. 12, 1995--RSA Data Security, Inc. today announced that it is now licensing patents for the Digital Signature Standard (DSS), the U.S. government standard for digital signatures.
RSA also announced that it has renewed its exclusive licensing agreement for the
 industry-standard Rivest-Shamir-Adleman (RSA) public key cryptosystem developed  at the Massachusetts Institute of Technology (MIT). With the addition of DSS technology to its portfolio of encryption offerings, RSA Data Security has become the exclusive source for the industry's most widely accepted security RSA also announced that under its uniform, non-discriminatory licensing plan, manufacturers will pay a one-time royalty when they sell products containing RSA
 and/or DSS technology. No additional per-certificate or use charges are `For the first time, the patents covering the most popular encryption and digital signature methods in the world, RSA and DSS, are easily available on a non-discriminatory basis from a single vendor,` said Jim Bidzos, president of RSA. `By offering one-stop shopping for both systems, our customers can seamlessly integrate both RSA encryption and DSS digital signature methods into their products.` Widespread Implementation
Many of RSA's software licensees -- such as Adobe, Aquila, Atalla, National Semiconductor, Spyrus, Premenos, Spyglass, Terisa Systems, Frontier Technologies, BroadVision, Checkpoint Software, Raptor Systems, SafeCo Insurance, Wollongong, Square D, Interval Systems, and Comm-Press -- have already requested patent licenses to both the RSA and DSS techniques for use in software and hardware systems. IBM and Siemens currently offer DSS-based products, licensed under RSA's DSS patent, to the U.S. government.
`Now that vendors can obtain DSS and RSA patents from one source, we expect to see companies throughout the U.S., Europe and Japan incorporate RSA and DSS technology into dozens of products, including access control systems, network management systems, smart cards, link encryptors, and wireless encryption devices,` said Bidzos.
`The demand for these technologies is very strong and will continue to grow as vendors increasingly incorporate security features into their products. In the next several months we expect to be inundated with requests from licensees. This
 is great news for the security industry, which has waited patiently for easy availability of the RSA and DSS patents.` Digital Signatures
A digital signature on an electronic document is an encrypted form of data equivalent to a signature on a printed document, such as a contract or other commercial agreement. It verifies that the document is valid and unaltered, and that the person signing the document has agreed to its terms.
Furthermore, secure digital signatures cannot be repudiated. The signer of a document cannot disown it by claiming it was forged. Both DSS and RSA support digital signatures and certificates. Several states, including California and Utah have recently enacted legislation recognizing digital signatures as legally
 binding. License Availability
Uniform licenses to both the RSA and DSS/Schnorr patents are available immediately. The license text, as well as other information regarding these patents, is available on RSA Data Security's home page at For existing customers of RSA's BSAFE and TIPEM software toolkits, no separate patent licenses are required. All rights under the patents to use, integrate and
 copy RSA's software are embedded. RSA Data Security, Inc.
RSA Data Security, Inc. is the world's brand name for cryptography, with more than 15 million copies of RSA encryption and authentication technologies installed and in use worldwide. RSA technologies are part of existing and proposed standards for the Internet and World Wide Web, CCITT, ISO, ANSI, IEEE, and business, financial and electronic commerce networks around the globe.
The company develops and markets platform-independent developers kits and end-user products and provides comprehensive cryptographic consulting services.
Founded in 1982 by the inventors of the RSA Public Key Cryptosystem, the company
 is headquartered in Redwood City, Calif. -0-
Note to Editors: RSA Public Key Cryptosystem, BSAFE and TIPEM are trademarks of RSA Data Security, Inc. All other product or company names are trademarks of their respective corporations.
For information regarding licensing RSA or DSS patents, contact Paul Livesay at RSA Data Security, Inc. (415) 595-8782, or polrsa.com.
For information regarding licensing RSA or DSS toolkits, contact Paul Gordon at RSA Data Security, Inc. (415) 595-8782, or paulrsa.com.
CONTACT: Corman/Croel Marketing & Communications
Patrick Corman, 415/326-9648
Lisa Croel, 415/326-0487 lcroelmediacity.com
KEYWORD: CALIFORNIA
INDUSTRY KEYWORD: COMPUTERS/ELECTRONICS COMED TELECOMMUNICATIONS PRODUCT REPEATS: New York 212-575-8822 or 800-221-2462; Boston 617-236-4266 or 800-225-2030; SF 415-986-4422 or 800-227-0845; LA 310-820-9473 BW URL: AP-NY-10-12-95 0701EDT
This material is copyrighted and may not be republished without permission of the originating newspaper or wire service. NewsHound is a service of the San Jose Mercury News. For more information call 1-800-818-NEWS.

@_date: 1995-10-24 10:35:46
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: What is needed for S/MIME remailer ? 
The other day I was wondering what it would take to make an
anonymous remailer for an S/MIME client.  Implementing S/MIME from
scratch is a lot of work given the lack of a public domain
implementation, but it seems that a remailer could be built on top
of a commercial email product that supported S/MIME.  The question
is: What features should a commercial S/MIME email product have to
make it easy to support a remailer?  Are there a small set of
command line options that would greatly simplify a remailer
                --Bob Baldwin

@_date: 1995-10-24 10:53:16
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: 80 bit security from 40 bit exportable products 
Long ago vendors should have put encryption into network layer
products, but for a variety of reasons that effort was delayed or
discouraged.  One effect of this lack is that almost every layer of
the network stack is adding its own encryption.  For example, the
HTTP session layer added S-HTTP and the TCP transport layer added
SSL.  Soon we will have network layer encryption with IPsec.
        The vendors for each layer can export a product that uses
ciphers with 40 bit keys.  A user can then combine multiple
products to get more than 40 bits worth of security.  For example,
a web client might fetch an S-HTTP page over an SSL protected link
via a firewall that supports IPsec tunnels.  That's three 40 bit
keys protecting the data over the internet link (of course, this
may not be equivalent to a 120 bit cipher, that depends on the
details of the cipher systems and independence of the key setups).
Interesting possibilities.
                --Bob Baldwin

@_date: 1995-10-24 14:39:46
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: 80 bits from 40 bits -- NOT 
Well, let me eat my words.  Unless all layers turn on
encryption at the same time, and there is not predictable text
that passes from one layer to the next, adding encryption at
each layer cannot substantially improve the size of the key
space.  Consider two layers each of which has a verifiable
header and a body of encrypted text.  By "verifyable", I mean
that it contains enough redundancy to recognize a correct
decryption of the cipher added by the lower layer.  For example,
a header that included a content type field and a length field
could be examined to see if it looked reasonable, and thus
confirm a guess at the lower level's cipher.
                Plaintext-Body-1
                 Layer-1-cipher
      Header-1, Encrypted-Body-1
            Layer-2-cipher
   Header-2, Encrypted-Body-2
        To crack this system, an attacker does brute force search
of the keyspace for the layer-2-cipher, for each key check the
decrypted Header-1 value to see if it looks OK, if not, continue,
otherwise start searching the keyspace for the Layer-1-cipher
given the candidate for the Encrypted-Body-1 produced by the
guess at the Layer-2-cipher key.  Clearly, if you have several
layer 2 blocks and they all have good looking values for the
Header-1, then the Layer-2-cipher key is correct.
        The summary is that two layers of 40 bit ciphers with
the first layer adding some verifiable information, has the effect
of adding at most one bit to the effective keysize (doubling the
amount of work).  It DOES NOT increase the keysize to 80 bits.
                --Bob Baldwin
______________________________ Reply Separator _________________________________
        Long ago vendors should have put encryption into network layer
products, but for a variety of reasons that effort was delayed or discouraged.  One effect of this lack is that almost every layer of the network stack is adding its own encryption.  For example, the HTTP session layer added S-HTTP and the TCP transport layer added SSL.  Soon we will have network layer encryption with IPsec.
        The vendors for each layer can export a product that uses
ciphers with 40 bit keys.  A user can then combine multiple products to get more than 40 bits worth of security.  For example, a web client might fetch an S-HTTP page over an SSL protected link via a firewall that supports IPsec tunnels.  That's three 40 bit keys protecting the data over the internet link (of course, this may not be equivalent to a 120 bit cipher, that depends on the details of the cipher systems and independence of the key setups). Interesting possibilities.
                --Bob Baldwin

@_date: 1995-11-02 12:29:40
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Re: Keyed-MD5, and HTTP-NG 
I wish that the field of cryptography was as well advanced
as the field of Bridge Building.  A modern Bridge Builder can design
a bridge that is easy to construct and will in fact last for 100 years.
Unfortunately, modern Cryptography is like Bridge Building in the
late 1800s.  Back then, it was possible to build bridges that did
last for 100 years but lots of cities refused to pay the extra costs
in materials, labor and time to make a solid bridge, and as a result
the bridges did not last.  To make it worse, there was no systematic
teaching of the best practices, so often no one would realize that
they had build and/or bought a weak bridge until the day that it
fell apart.
        The sad result of the state of the art in Cryptography is
that we end up with situations like the one you described where it
takes months to get agreement among Cryptographers and then it turns
out that one of the other choices would have been better.  Not
surprisingly, the other choices often run slower than the initial choice.
However, there is little guarantee that the second choice will resist
all new attacks.  One of the reasons that the IPsec authenticator was
analyzed was that it had been chosen as the IPsec authenticator.  As soon
as a large organization picks a new authenticator, the researchers will
try their hand on breaking that one.  In the field of Cryptographic
Engineering, we just don't have a well tested construct for authenticators.
        If the IPsec group was run by scientists instead of engineers,
then they would consider cryptographic constructs that have "provable"
security properties (e.g., faking this authenticator is as hard as
factoring a Blum integer (a composite number with two strong primes)).
The downside of having this kind of provable security is that the
packet processing time would be enormous.  You would loose all the
benefits of a T1 connection to the Internet in order to get provable
security on your authenticator or encryptor.  Speaking for myself,
I am glad that the IETF is run by engineers.
        The vitriol you spewed is quite justified.  People at RSA and
IBM both agreed that the IPsec authenticator would resist all known
attacks.  In fact, a fully conforment IPsec implementation will still
resist the new attack because IPsec requires that the all keys be
changed every 2**32 packets.  However, this new attack makes Cryptographers
nervous.  Perhaps it could be extended to work with only 2**40 chosen packets
in which case there is a noticeable chance of it succeeding with only
2**32 packets.  Only further research will tell.  Currently, the only way
to get the MD5 key is to feed in 2**60 chosen messages of various lengths.
Of course, this is another good reason to use different keys for the
MD5 authenticator and packet encryption.  Wisely, IPsec requires different
keys for the authenticator and the encryptor.
        I also understand your being upset about not hearing about this
attack the moment it was published.  Actually, as soon as RSA Labs confirmed
the weakness we did call some of the editors of the IPsec specifications
to let them know about it.  The consensus was that this was not a show
stopper.  The IPsec protocols could be rolled out as is.  Later, once a
better authenticator had been developed and tested, it could be
substituted for the existing one.  One of the excellent features of the
IPsec specification is that new algorithms can be substituted easily
(modulo a "small matter of programming").
        Perhaps your main complaint is that it took time for the attack
to be confirmed by other researchers before the issue was brought to
the IPsec authors.  That is another effect of the current state of the
art in Cryptography, and an effect of the normal academic process.
It takes time to understand and confirm a weakness, and it is necessary
to confirm weaknesses (researchers make mistakes in designing attacks
just like they make mistakes in designing ciphers).  That's the way
things are in "cryptography today".
        I guess my conclusion is to say "Sorry".  Several professional
cryptographers gave it their best shot, and the authenticator turned
out to be somewhat weaker than expected.
                --Bob
______________________________ Reply Separator _________________________________
Pardon me. The amount of vitriol I am going to spew is probably difficult for people to understand because most folks around here weren't following the keyed MD5 discussions during the IPSEC work and have no idea of the sort of crap the professional cryptographic community put us through.
We spent months, and months, and months, and months, getting advice from every cryptographer on the planet. Every conceivable combination of pads, multiple keys, keys before the text, after, before and after, etc., was discussed over and over and over again.
Finally, the folks at RSA and IBM both agreed that Hugo's scheme, the one we were putting in to place, was the best possible one. (Thats the one with the padded key.)
What the flying hell are you doing telling us now, and indeed not even telling the IPSEC community but instead mumbling on cypherpunks, that you guys were in possession of information BEFORE the entire discussion in midsummer that indicated that your own advice was wrong?

@_date: 1995-11-02 02:20:14
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Rivest on the Design of RC4 
Professor Ron Rivest will be presenting a talk titled
"The Design of RC4" at the RSA Data Security Conference in San Francisco
(January 17 to 19).  It should be interesting.
                --Bob

@_date: 1995-11-02 08:15:16
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Re: Keyed-MD5, and HTTP-NG 
I personally spoke to Bill Simpson about this problem.  I should have
given you a phone call or email in addition to speaking to Bill.  In my
opinion this problem does not at all reflect on your skills or reputation.
What it signifies to me is the poor state of cryptographic engineering.
If anything, it points out the wisdom of the IPsec designers in requiring
that key material have a limited lifetime.  A wise engineering choice like
this protects the system against many different kinds of attacks.  Of course,
the protocol implementors often omit "details" like key lifetime limits.
In fact, 17 years ago when I wrote a TCP/IP stack for the Xerox Alto I left
out several "details", which of course caused lots of problems when I
did interoperability testing with a mainframe (Multics).
                --Bob
______________________________ Reply Separator _________________________________
On 11/1/95 10:20 AM, perry worte:

@_date: 1995-12-13 06:04:14
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Wanted: email for Calif senators & representatives 
Can someone send me, or the list, the email addresses for
the California senators and representatives?
                --Bob Baldwin

@_date: 1996-01-06 09:02:11
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RSA's Art gallery is now on the web 
Are you tired of the clip art you downloaded last week?  Do you
need a new background screen for you PC?  Does your cubicle need something
to give it character?
        Look no further.  Visit the RSA Data Security Art Gallery and
download to your hearts content.  We have such classics as the "Sink Clipper" T-shirt image, and our latest "We Hear You" poster by the
famous political cartoonist, Dan Perkins (a.k.a. Tom Tomarrow).  Don't
miss the our rendition of the NSA logo ("We read your mail, so you
don't have too").
        More art will be coming soon.  Feel free to send us your favorite
images, or ideas (webmaven
                --Bob Baldwin
                  RSA Data Security

@_date: 1996-01-24 03:17:29
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Mykotronx sells 68,000 Fortezza cards to Spyrus 
Here is a press release from Mykotronix about a big
order of Fortezza cards for the Defense Messaging System.
        Another part of the government has selected Fisher
International to supply SmartDisk cryptographic cards for
the use of citizens interacting with the IRS and other agencies
electronically.  Although Fisher has not received a big order
yet, they are looking at 100 thousand and 10 million card
production runs.  The Fisher card is based on RSA's crypto
toolkit and DOES NOT include skipjack or escrow.
                --Bob
______________________________ Forward Header __________________________________
    IRVINE, Calif.--(BUSINESS WIRE)--Jan. 22, 1996--Rainbow  Technologies
Inc. (NASDAQ:RNBO), Monday announced its Mykotronx  division has received a purchase order from Spyrus for over 68,000  of Mykotronx's new Capstone encryption processor (MYK-82).     The devices will be used to build part of the Government's order  of
Fortezza Cryptographic Cards for the Defense Message System (DMS)  awarded Sept. 1995.  Initial delivery of the new cryptographic  processor will begin April 1996.     "The significance of the MYK-82 is that it allows us to provide  a high
grade, low cost encryption technology to customers, such as  Spyrus," said John Droge, vice president of program development for  Mykotronx.  "The MYK-82 is an advanced encryption processor  specifically aimed at PCMCIA cryptographic applications and has a  built-in PCMCIA interface.  The newer design is smaller, faster and  has a lower cost than its predecessor."  In addition, Mykotronx will  be programming all the cryptographic processors to fill the  Government's Sept. 1995 order of 300,000 Fortezza Cryptographic
 Cards.     The MYK-82, developed by Mykotronx and fabricated by VLSI  Technology
Inc., is the first of a series of security products to be  developed as part of an alliance with VLSI, targeting both  Government and commercial markets.     Rainbow Technologies, founded in 1984, is the world's leading  developer,
manufacturer and supplier of software protection products  and encryption technology.  Mykotronx, a subsidiary of Rainbow, is a  leader in secure communication and cryptographic products for U.S.  government agencies and the commercial marketplace.  Rainbow was  recently recognized by Forbes magazine as one of The Best Small  Companies in America and in SmartMoney Magazine as one of the Seven  Stocks for the Next Decade.  Rainbow is ISO 9002 certified.  CONTACT:  Rainbow Technologies Inc., Irvine, Calif. Ann Jones, 714/450-7350 email: ajones WWW Home Page:  KEYWORD: CALIFORNIA INDUSTRY KEYWORD:  COMPUTERS/ELECTRONICS  COMED

@_date: 1996-01-09 13:55:05
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Can you break my encryption protocol ? - improvements 
The protocol works well as long as you trust the ability of
clients to generate random numbers and you are not too worried about replay or message modification attacks.  If you are, then the session key should be a function of random values chosen by both the client and the server.  That way, a replay of the initial connection message will not cause the server to use the same key.          You may also want to add key verification in case the application
does not already provide a simple way to tell if both parties are using the same key.  For example, the client and server could exchange known values encrypted under the session key before continuing.
        Here's a protocol based on the ISO standards that has both
dual key determination (both parties influence the key value and neither can control the range of possible keys in any useful way), and dual
key validation (both parties end up knowing they are talking to someone who can compute the common key).
Client computes:
  Mc = unpredictable 128 bit value.  Serves as authenticator and
       as a value that is unknown to the attacker.
  Nc = H(Mc)  // Hash of Mc like MD5(Mc)
C->S: C, S, Nc
    The names or IP addresses of C & S are included to avoid various
replay and reflection attacks.  Message integrity is done later.
Server computes:
  Ms = unpredictable 128 bit value.
  Ns = H(Ms)
  P = shared passphrase padded with zeros to multiple of 64 bytes
      which is the block size of the hash function's compress operation.
  K = H(P || H(P || C || Nc || S || Ns))   Vs = Enc(K, Ms)
       The value Ms is unknown to the attacker, so this value does not
       help with mounting a brute force key search.
S->C: S, C, Ns, Vs
Client computes:
  P = shared passphrase padded with zeros to multiple of 64 bytes
      which is the block size of the hash function's compress operation.
  K = H(P || H(P || C || Nc || S || Ns))   X = Dec(K, Vs)
  Test that H(X) = Ns, if not return error and close connection.   Vc = Enc(K, Mc)
C->S: C, S, Vc
Server computes:
  X = Dec(K, Vs)
  Test that H(X) = Ns, if not return error and close connection.
All subsequent communication should be encrypted with K.
                --Bob Baldwin
______________________________ Forward Header __________________________________
I'm trying to put together a simple protocol for encrypting confidential but typically low-value data (i.e. I don't want people to be able to read it, but in most cases it wouldn't be catastrophic if they could). I want it to be completely license-free, so I can't use RSA or other patented algorithms. It also would only be used inside one organisation, so key management isn't so much of a problem, and the main attack it has to defend against is packet-sniffing on the Net. It also has to support variable-length keys for ITAR.. The idea is as follows..
Client and server both have copies of a passphrase, of any length.
When starting the connection, client sends 128 random bits to the server.
Both ends take this data, append the passphrase, and use MD5 to generate a session key. If a key of less than 128 bits is required for legal reasons, then the appropriate number of bits are retained, and the rest replaced with bits from the random data that was sent in the clear.
That is, if you're only allowed 40 bit security, you take the first 88 bits that you were sent, and append the last 40 bits of the generated key to give you the session key to use.
You then go off and encrypt the session (probably using 3DES or Blowfish). Can anyone spot any flaws in this system ? The only potential problem I can see would be that by cracking a number of sessions you could work out the passphrase. However, I think the number required would still be infeasible. Also, are there any known problems with using Blowfish for encrypting a data stream ? I'm assuming it's OK as it's used in PGPfone.  Mark

@_date: 1996-02-02 07:01:28
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RC2 Source Code - Legal Warning from RSADSI 
WARNING NOTICE
        It has recently come to the attention of RSA Data
Security, Inc. that certain of its confidential and
proprietary source code has been misappropriated and
disclosed.  Despite such unauthorized use and disclosure,
RSA Data Security reserves all intellectual property rights
in such source code under applicable law, including without
limitation trade secret and copyright protection.  In
particular, RSA Data Security's RC2 (TM) symmetric block
cipher source code has been illegally misappropriated and
published.  Please be advised that these acts, as well as
any retransmission or use of this source code, is a
violation of trade secret, copyright and various other state
and federal laws.  Any person or entity that acquires,
discloses or uses this information without authorization or
license to do so from RSA Data Security, Inc. is in
violation of such laws and subject to applicable criminal
and civil penalties, which may include monetary and punitive
damages, payment of RSA's attorneys fees and other equitable
        RSA Data Security considers misappropriation of its
intellectual property to be most serious.  Not only is this
act a violation of law, but its publication is yet another
abuse of the Internet.  RSA has begun an investigation and
will proceed with appropriate action against anyone found to
have violated its intellectual property rights.
        Anyone having information about the misappropriation
identified above is encouraged to contact RSA directly.

@_date: 1996-02-02 09:55:25
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Thanks for not flaming the messenger 
Well, I've read a whole bunch of replies to the legal
warning I posted for my employer.  I want to thank everyone for
being thoughtful enough for not flaming me personally.
My apologies to people who received multiple copies.  The goal
was to ensure that anyone searching for the original article
would get the warning with it, and that any CD-ROM containing
sci.crypt would also contain the warning.  Sorry for the
                --Bob

@_date: 1996-02-03 01:58:30
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: Technical comments on RC2 from John Kelsey 
Here are some interesting technical comments on RC2 from
sci.crypt.  If you already read sci.crypt, delete this now and
accept my apologies for wasting your time.
                --Bob
______________________________ Forward Header __________________________________
Newsgroups: sci.crypt
Organization: Delphi (info email, 800-695-4005 voice) -----BEGIN PGP SIGNED MESSAGE-----
[ To: sci.crypt  Date: 01/29/96 09:18 pm   Subject: RC2 source code ]
This was interesting.  Is this another "S1," or another "alleged-RC4?"  The whole thing looks pretty believeable, i.e., it doesn't have any obviously dumb parts that I can see.
Note that alleged RC2's block encryption function looks an awful lot like one round of MD5 performed on 16-bit sub-blocks, using the bitwise selection function as the nonlinear function, and a key-derived constant table.  Additionally, in rounds four and eleven, there are four lookups into the expanded key array.
The encryption function could be rewritten as
     a = rotl(a + bsel(d,c,b) + *sk++, 1);      b = rotl(b + bsel(a,d,c) + *sk++, 2);      c = rotl(c + bsel(d,c,b) + *sk++, 3);      d = rolt(d + bsel(c,b,a) + *sk++, 5);
     if((i==4)||(i==11)){
          a += xk[d&0x3f];
          b += xk[a&0x3f];
          c += xk[b&0x3f];
          d += xk[c&0x3f];
     }
If this is accurate, it may give us some insight into Rivest's development of MD4 and MD5, which were radically different than MD2. What are the dates on this?  Did Rivest do MD4 or RC2 first?  This may be the first block cipher in the commercial/academic world to use a UFN structure.  One interesting part of this is the use of the subkey array as an S-box twice during the encryption process.  I'm curious as to why this would be used only twice, rather than each round, i.e.
a += bsel(b,c,d) + *sk++ + s[d&0x3f];
Sticking a very different internal transformation in may have been an attempt to make iterative (i.e., differential) attacks harder, since there's no longer a single round function through which you can pass differential characteristics.  This depends upon when RC2 was developed and released.
Note that the claim that "RC2 is not an iterative block cipher" seems to be based on the fact that it has two instances where a different round function is thrown in.  (Essentially, it's actually an 18-round cipher with two different round functions, one of which is used only twice.)  This other round function isn't very impressive, since it uses only six bits of the source block to affect the target block.
A one-bit change in a randomly-distributed input block looks
look like it will propogate pretty quickly:  There's a roughly 0.5 probability that it doesn't make it through the bsel function.  If it does, then there's about a 0.5 probability that it will cause a change in the carry bit.  This happens four times per "round," so a one-bit change should have about a 2^{-8} chance to make it through one round as a one-bit change, and so about a 2^{-128} chance to make it through all sixteen rounds, assuming no impact from either of the two S-box lookups. Does this look right, or am I missing something?  (This is a first approximation--if our bit is in the high-order position anywhere, then it *can't* cause a carry bit, but there's no obvious way to keep it there for long.)  By choosing the input block, I can ensure that one-bit XOR difference makes it through the first step or two, but that doesn't do too much for an actual attack.
Other XOR differences can help with the first round or so, but stop being helpful afterward.  It generally looks hard to prevent diffusion by choosing other values, at least using XOR differences, because each subblock is rotated a different amount in each round. (The bits don't keep lining up.)
We can also try to do a differential attack based on subtraction modulo 2^16, based partially on Tom Berson's attempt to differentially attack MD5 using subtraction modulo 2^32.  This gets complicated because of the rotations and the bit selection operations, but it ought to be tried if it hasn't already.
The key scheduling is also interesting, and somewhat reminiscent of MD2's internal operations.  Each expanded key byte after the first N (where N is the number of bytes in the user's key) is determined by two bytes--the previous expanded key byte, and the expanded key byte N positions back.  This means that we probably don't get ideal mixing of the key bytes in the early expanded key bytes, but it isn't clear to me that there will be a lot of problems with reasonable key lengths.  (Note that a reasonable key length would be 128 bits=16 bytes, and that it should come from the output of a good one-way hash function.)  I wouldn't recommend using the key schedule to hash passphrases, since long passphrases would leave us with many very low-entropy subkey values.  In general, I think that really large user keys will leave us vulnerable to a variety of related-key attacks and other nasty stuff.  I'm a little curious as to the purpose of phase 2 of the key schedule, but since it's only used when a watered-down version of the algorithm is wanted (right?), I haven't spent much time looking at it.
Does alleged RC2's key schedule use the same permutation table as MD2 does?  For small systems, this might have been a reasonably nice space savings.  (On the other hand, if you have a hash function available at the same time, it makes sense to go ahead and use it in your key schedule, which isn't done here.)
The algorithm looks like it will have reasonable performance on 16-bit machines like the 8086, which was almost certainly one of the requirements for the algorithm, given the times it was used.
   --John Kelsey, jmkelsey / kelsey
 PGP 2.6 fingerprint = 4FE2 F421 100F BB0A 03D1 FE06 A435 7E36

@_date: 1996-02-03 02:52:35
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: RC2 technical questions 
In a shameless attempt to move the discussion of RC2 into
a more technical arena, here are some interesting questions to
explore about RC2.
                --Bob
Key expansion
- How can you tell whether the permutation is based on
  some sequence of digits from PI?
- What are the diffusion and avalanche properties of
  this permutation?
- What are the linear characteristics of this permutation?
- What are the properties of the compression function
  that maps 16 bits (bytes X and Y) to 8 bits (byte Z)
  via Z = P[X + Y]?
- How does the length of the key influence the mixing
  of bits during each pass of the expansion algorithm?
  - Is this a non-linear feedback shift register over
    the field GF(256)?
- If the first pass of expansion is viewed as a hash
  function that produces 40 or 128 bits out, what are
  its properties?
Round Functions
- What are the diffusion and avalanche properties of
  the two round functions?
- What are the linear approximations and how good are they?
- What characteristics can be preserved by the round
  function that performs rotations?
  - With what probability?
  - Does the amount of rotation influence the security?
- What characteristics can be preserved by the round
  function that performs the data dependent selection
  of the expanded key?
  - With what probability?
- Are there any "weak" keys?    - Will the expansion algorithm produce them?

@_date: 1996-03-09 04:02:48
@_author: baldwin@RSA.COM (Robert W. Baldwin 
@_subject: News on RSA vs. Cylink Injunctions and Patents 
The following press release from RSA may be of interest to the
folks on this list.
                --Bob
REDWOOD CITY, Calif.--(BUSINESS WIRE)--March 8, 1996--In a ruling filed March 4, the Honorable Spencer Williams, U.S. District Court Judge for the Northern District of California, denied Cylink Corporation's motion seeking an injunction against RSA Data Security, Inc.'s licensing of its BSAFE/TIPEM toolkit software.  Cylink contends that RSA's software infringes its Stanford patents and that licensing required an additional grant from Cylink, despite the fact that RSA already has a license.  After hearing oral arguments on Feb. 29, Judge Williams denied Cylink's motion from the bench and later issued a written order explaining that "several factors weigh against finding that (Cylink) has shown a likelihood of success on the merits."  In denying the motion the court found that "RSA has raised serious question (sic) regarding the validity of the first of the Stanford patents, the Diffie-Hellman patent."  With respect to Cylink's other patent, the Hellman-Merkle patent, the court had this to say: "(I)t is questionable whether the patent warrants such broad coverage."  Thus, Cylink has "failed to demonstrate a likelihood of success on the merits."  RSA had initiated the lawsuit against CKC, a wholly owned subsidiary of Cylink, because CKC was threatening RSA's customers in an effort to induce them to purchase sublicenses to the Stanford patents.  RSA's action seeks a court determination that the patents are invalid, not infringed and/or RSA's licensing does not exceed its existing rights under the patents.  Cylink/CKC responded by filing its motion for preliminary injunction which was denied by the court as described above.  In a related matter, the arbitration panel which is handling the winding up and dissolution of Public Key Partners ("PKP"), the entity that formerly held the licensing rights to the MIT and Stanford patents, ruled that:  "In addition to the claims discussed above and in our prior rulings, Cylink presented the claim, but did not prove, that RSA breached its fiduciary duty to PKP by providing patent licenses to third parties."  The arbitration panel also found that PKP was obligated to reimburse RSA for the costs and attorney's fees incurred in other related litigation, including a patent lawsuit brought by Cylink to invalidate the MIT patent.  "The court confirmed that RSA has existing rights to the Stanford patents, and although Cylink knew this, it has forced RSA to investigate.  In that process, we have found a number of disturbing facts about the Stanford patents," said Jim Bidzos, president of RSA. He went on to add: "Cylink's losing its motion is likely only a surprise to Cylink who thinks they can achieve through the courts what they haven't been able to accomplish in the marketplace."

@_date: 1997-01-03 10:09:11
@_author: Bob Baldwin 
@_subject: RSA Announces New "DES Challenge" 
RSA Announces New "DES Challenge"
Tens of thousands of dollars in cash prizes offered; contest should improve overall Internet security by illustrating relative strength of different crypto algorithms and keysizes.
Business Editors and Computer Writers
REDWOOD CITY, Calif.-Jan 2, 1997--RSA Data Security, Inc., a wholly owned subsidiary of Security Dynamics Technology, Inc. (NASDAQ: SDTI), today announced an Internet-based contest with cash prizes.   The contest, known as the "RSA DES Challenge", challenges mathematicians, hackers and computer experts around the world to decipher encrypted messages.  The goal of the contest is to quantify the security offered by the government endorsed DES encryption standard and other secret-key ciphers at various key sizes.
The challenge proper will be launched during the RSA Data Security Conference to be held in San Francisco, January 28-31, with the target ciphertexts for the different contests being simultaneously posted on the company web-site, at RSA Data Security pioneered the Internet-based "cracking" contest, when it launched the original "RSA Factoring Challenge" back in 1991.  Since then, the company has paid out over $100,000 in prize money to mathematicians and hackers around the world, and the data gained from that Challenge (which is ongoing) has greatly increased mathematicians' understanding of the strength of encryption techniques based on the "factoring problem", such as the RSA Public Key Cryptosystem T.
It's widely agreed that 56-bit keys, such as those offered by the government's DES standard, offer marginal protection against the committed adversary. By inertia as much as anything else, DES is still used for many applications, and the 20-year-old algorithm is proposed to be exportable under the latest incarnation of Clipper. It is the perfect time to demonstrate to the world that better systems are both required - and available - thus improving the world's There have been theoretical studies done showing that a specialized computer "DES cracker" could be built for a modest sum, which could crack keys in mere hours by exhaustive search. However, no one is known to have built such a machine in the private sector - and nobody knows if one has been built in any government, either.
The successes of the RSA Factoring Challenge show that for some types of problems, it's possible to recruit spare "cycles" on a large number of machines distributed around the Internet. Therefore, by offering a suitable incentive, it should be possible to recruit sufficient CPU power across the Internet to exhaustively search the DES keyspace in a matter of weeks.
Computer scientists have already developed software that will allow even the novice computer user to participate in the cracking effort.  By incorporating the key search software in a "screen saver", a simple PC anywhere on the Internet can devote its spare time to working on the problem - remotely and completely unattended.  Even people with limited computer skills will be able to participate.  In the RSA DES Challenge, the motto will definitely be "The More, The The Contest
Full details of the RSA DES Challenge will be posted on the RSA home page ( during the first weeks of January. Complete rules for the competition will be provided as well as example challenges and solutions against which computer scientists and hackers can test their software. In conjunction with the RSA DES Challenge, RSA will simultaneously launch a series of other contests based around the RC5 Symmetric Block Cipher (another encryption algorithm).  Since RC5 is a variable key length block cipher, targets that offer increasing resistance against so-called "exhaustive search attacks" will be posted in the hope of assessing the full impact of a widely-distributed exhaustive search. There will be 12 challenges based on the use of RC5. Prizes will be awarded for the recovery of each of 12 keys which are chosen to be of lengths varying from 40 bits all the way up to 128 bits, with the length increasing in steps of eight bits.
The email sender of the first correctly formatted submissions to each contest will receive a cash prize. For the RSA DES Challenge the first sender of the secret DES key will receive $10,000. For the other contests the prize money awarded will vary with the difficulty of the RC5 key attacked.
For more information about the ongoing RSA Factoring Challenge send email to challenge-administrator and for the latest news and developments send email to challenge-news About RSA Data Security, Inc.
RSA Data Security, Inc., a wholly owned subsidiary of Security Dynamics Technologies, Inc., is the world's brand name for cryptography, with more than 75 million copies of RSA encryption and authentication technologies installed and in use worldwide. RSA technologies are part of existing and proposed standards for the Internet and World Wide Web, IT4, ISO, ANSI, IEEE, and business, financial and electronic commerce networks around the globe. The company develops and markets platform-independent developer's kits and end-user products, and provides comprehensive cryptographic consulting services. For more information on any of RSA's encryption technologies, please call RSA directly at 415/595-8782 or send electronic mail to sales RSA also provides information on its Web site at  Kurt R. Stammberger
Director, Technology Marketing
RSA Data Security, Inc. (A Security Dynamics Company)
415-595-8782 vox           415-595-1873 fax
kurt
