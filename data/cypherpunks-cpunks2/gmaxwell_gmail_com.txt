
@_date: 2013-07-19 09:33:45
@_author: Gregory Maxwell 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
It's _very_ hard to reason about this subject and act safely.
It is common for ISPs to use segments in their network which are
provided by third party providers, even providers who are almost
entirely facilities based will have some holes or redundancy gaps.
Because these are L1 (wave) and L2 (e.g. ethernet transport) they are
utterly invisible from the L3 topology.
You can make some guesses which are probably harmless: a guard that is
across the ocean is much more likely to take you across a compromised
path than one closer—    but going much further than that may well
decrease your security.
These concerns should be reminding us of the importance of high
latency mix networks... they're the only way to start getting any real
confidence against a global passive observer, and the are mostly a
missing item in our privacy tool toolbelt.
tor-talk mailing list
tor-talk at lists.torproject.org

@_date: 2013-07-19 13:42:03
@_author: Gregory Maxwell 
@_subject: [tor-talk] Network diversity [was: Should I warn against Tor?] 
So have low latency ones, some things fail.  Today you'd answer that
concern by running your high latency mix network over tor (or
integrated into tor) and so it cannot be worse. Answering the "you
need users first, and low latency networks are easier to get users
for" concern.
The point there remains that if you're assuming a (near) global
adversary doing timing attacks you cannot resist them effectively
using a low latency network.  Once you've taken that as your threat
model you can wax all you want about how low latency mix networks get
more users and so on.. it's irrelevant because they're really not
secure against that threat model. (Not that high latency ones are
automatically secure either— but they have a fighting chance)
On Fri, Jul 19, 2013 at 10:03 AM, Jens Lechtenboerger
Because you're lowering the entropy of the nodes you are selecting
maybe all the hosts themselves are simply NSA operated, or if not now,
they be a smaller target to compromise.  Maybe it actually turns out
that they all use a metro fiber provider in munich which is owned by
an NSA shell company.
In Germany this may not be much of a risk. But if your logic is
applied to someplace that is less of a hotbed of Tor usage it wouldn't
be too shocking if all the nodes there were run by some foreign
intelligence agency.
tor-talk mailing list
tor-talk at lists.torproject.org

@_date: 2013-10-25 21:26:21
@_author: Gregory Maxwell 
@_subject: [tor-talk] x.509 for hidden services 
==Background== (you can skip to the Tor section if you don't care)
The Bitcoin universe is in the process of creating a specification for
digital invoices called "the bitcoin payment protocol". (More info:
The payment protocol allows someone to request someone else pay
Bitcoin for specific things, instructing them to pay specific amounts
in specific ways, and allows the receiver to provide things like
instructions for sending a refund if the transaction is for some
reason aborted... all sorts of extra metadata which doesn't belong in
the public Bitcoin network for scalability and privacy reasons.
One of the things these invoices have is an optional signing mechanism
for authentication and non-repudiation. Normally these requests would
be sent over an authenticated and encrypted channel which provides
confidentiality and authentication, but not non-repudiation.
The non-repudiation will provide cryptographic evidence to the
participants which can be used to resolve disputes: e.g.
"He didn't send me my alpaca socks!" "Thats not the address I told you to pay!"
"He told me he'd send my 99 red-balloons, not just one!"  "No way,
that was the price for 1 red-balloon!"
The payment protocol is extensible and may someday commonly support
many kinds of signatures, but the initial implementations only support
signing with internal x.509 certificates and verifying those
certificates with standard CAs. As _horrible_ as this is, it's better
than nothing, and the primary users asking for this functionality have
SSL websites today.  We don't believe that any other PKI mechenism is
actually functional enough to be usable (e.g. as evidenced by the fact
that downloads of our GPG signatures, is on the order of 1% of the
downloads of the Bitcoin software; and probably only a small portion
of those users have actually done anything to verify the signing keys)
today, so other options haven't been a priority.
However, the need to use the known insecure CA infrastructure for this
(optional!) feature has seriously spazzed out some people. A lot of
this is pure confusion, e.g. people thinking that all payment requests
would have to go via the CA (no kidding!), but its surprisingly hard
to convince people who are responding emotionally of the subtle
tradeoffs involved especially when they have the luxury of saying
"it's your problem to go figure out, figure it out and go write a
bunch extra of software for me". So having some alternative on day one
would be useful in helping the more conspiracy minded understand that
this isn't some effort to cram the use of CAs down their throat.
==Where Tor comes in==
One of the downsides if using x.509 certs to non-repudiate here is
that sites hosted as tor hidden services can't participate.
It occurred to me that this could be fixed with very little code:
Take the HS pubkey, pack it into a self-signed x.509 cert with the
cn=pubkeybase32.onion.  And specify that .onion certs have a special
hostname validation rule that hashes and encodes the key.
Then the whole process would work for .onion, we'd have a non-CA
option available and working, etc.
I'm aware that HS pubkeys have been used for application level
authentication in Tor elsewhere (e.g. I believe torchat does this) so
it's not entirely unprecedented. I'm not aware of anyone packing them
in x.509 certificates. If anyone has, I'd like to use the same
encoding style for greater compatibility.
The biggest reason I can see not to do this is that it will not be
compatible with future editions of hidden services which aren't based
on RSA keys. (e.g. the EC point addition stuff to protect against
enumeration attacks wouldn't fit into this model). I don't think this
is a serious concern: if HS x.509s do become widely used we could add
a new authentication type for the new onion addresses when those are
Does anyone else see any other reasons not to do this?
Are there other applications which would benefit from having x.509
certs for onion names?

@_date: 2013-10-25 21:26:21
@_author: Gregory Maxwell 
@_subject: [tor-talk] x.509 for hidden services 
==Background== (you can skip to the Tor section if you don't care)
The Bitcoin universe is in the process of creating a specification for
digital invoices called "the bitcoin payment protocol". (More info:
The payment protocol allows someone to request someone else pay
Bitcoin for specific things, instructing them to pay specific amounts
in specific ways, and allows the receiver to provide things like
instructions for sending a refund if the transaction is for some
reason aborted... all sorts of extra metadata which doesn't belong in
the public Bitcoin network for scalability and privacy reasons.
One of the things these invoices have is an optional signing mechanism
for authentication and non-repudiation. Normally these requests would
be sent over an authenticated and encrypted channel which provides
confidentiality and authentication, but not non-repudiation.
The non-repudiation will provide cryptographic evidence to the
participants which can be used to resolve disputes: e.g.
"He didn't send me my alpaca socks!" "Thats not the address I told you to pay!"
"He told me he'd send my 99 red-balloons, not just one!"  "No way,
that was the price for 1 red-balloon!"
The payment protocol is extensible and may someday commonly support
many kinds of signatures, but the initial implementations only support
signing with internal x.509 certificates and verifying those
certificates with standard CAs. As _horrible_ as this is, it's better
than nothing, and the primary users asking for this functionality have
SSL websites today.  We don't believe that any other PKI mechenism is
actually functional enough to be usable (e.g. as evidenced by the fact
that downloads of our GPG signatures, is on the order of 1% of the
downloads of the Bitcoin software; and probably only a small portion
of those users have actually done anything to verify the signing keys)
today, so other options haven't been a priority.
However, the need to use the known insecure CA infrastructure for this
(optional!) feature has seriously spazzed out some people. A lot of
this is pure confusion, e.g. people thinking that all payment requests
would have to go via the CA (no kidding!), but its surprisingly hard
to convince people who are responding emotionally of the subtle
tradeoffs involved especially when they have the luxury of saying
"it's your problem to go figure out, figure it out and go write a
bunch extra of software for me". So having some alternative on day one
would be useful in helping the more conspiracy minded understand that
this isn't some effort to cram the use of CAs down their throat.
==Where Tor comes in==
One of the downsides if using x.509 certs to non-repudiate here is
that sites hosted as tor hidden services can't participate.
It occurred to me that this could be fixed with very little code:
Take the HS pubkey, pack it into a self-signed x.509 cert with the
cn=pubkeybase32.onion.  And specify that .onion certs have a special
hostname validation rule that hashes and encodes the key.
Then the whole process would work for .onion, we'd have a non-CA
option available and working, etc.
I'm aware that HS pubkeys have been used for application level
authentication in Tor elsewhere (e.g. I believe torchat does this) so
it's not entirely unprecedented. I'm not aware of anyone packing them
in x.509 certificates. If anyone has, I'd like to use the same
encoding style for greater compatibility.
The biggest reason I can see not to do this is that it will not be
compatible with future editions of hidden services which aren't based
on RSA keys. (e.g. the EC point addition stuff to protect against
enumeration attacks wouldn't fit into this model). I don't think this
is a serious concern: if HS x.509s do become widely used we could add
a new authentication type for the new onion addresses when those are
Does anyone else see any other reasons not to do this?
Are there other applications which would benefit from having x.509
certs for onion names?

@_date: 2013-10-25 21:26:21
@_author: Gregory Maxwell 
@_subject: [tor-talk] x.509 for hidden services 
==Background== (you can skip to the Tor section if you don't care)
The Bitcoin universe is in the process of creating a specification for
digital invoices called "the bitcoin payment protocol". (More info:
The payment protocol allows someone to request someone else pay
Bitcoin for specific things, instructing them to pay specific amounts
in specific ways, and allows the receiver to provide things like
instructions for sending a refund if the transaction is for some
reason aborted... all sorts of extra metadata which doesn't belong in
the public Bitcoin network for scalability and privacy reasons.
One of the things these invoices have is an optional signing mechanism
for authentication and non-repudiation. Normally these requests would
be sent over an authenticated and encrypted channel which provides
confidentiality and authentication, but not non-repudiation.
The non-repudiation will provide cryptographic evidence to the
participants which can be used to resolve disputes: e.g.
"He didn't send me my alpaca socks!" "Thats not the address I told you to pay!"
"He told me he'd send my 99 red-balloons, not just one!"  "No way,
that was the price for 1 red-balloon!"
The payment protocol is extensible and may someday commonly support
many kinds of signatures, but the initial implementations only support
signing with internal x.509 certificates and verifying those
certificates with standard CAs. As _horrible_ as this is, it's better
than nothing, and the primary users asking for this functionality have
SSL websites today.  We don't believe that any other PKI mechenism is
actually functional enough to be usable (e.g. as evidenced by the fact
that downloads of our GPG signatures, is on the order of 1% of the
downloads of the Bitcoin software; and probably only a small portion
of those users have actually done anything to verify the signing keys)
today, so other options haven't been a priority.
However, the need to use the known insecure CA infrastructure for this
(optional!) feature has seriously spazzed out some people. A lot of
this is pure confusion, e.g. people thinking that all payment requests
would have to go via the CA (no kidding!), but its surprisingly hard
to convince people who are responding emotionally of the subtle
tradeoffs involved especially when they have the luxury of saying
"it's your problem to go figure out, figure it out and go write a
bunch extra of software for me". So having some alternative on day one
would be useful in helping the more conspiracy minded understand that
this isn't some effort to cram the use of CAs down their throat.
==Where Tor comes in==
One of the downsides if using x.509 certs to non-repudiate here is
that sites hosted as tor hidden services can't participate.
It occurred to me that this could be fixed with very little code:
Take the HS pubkey, pack it into a self-signed x.509 cert with the
cn=pubkeybase32.onion.  And specify that .onion certs have a special
hostname validation rule that hashes and encodes the key.
Then the whole process would work for .onion, we'd have a non-CA
option available and working, etc.
I'm aware that HS pubkeys have been used for application level
authentication in Tor elsewhere (e.g. I believe torchat does this) so
it's not entirely unprecedented. I'm not aware of anyone packing them
in x.509 certificates. If anyone has, I'd like to use the same
encoding style for greater compatibility.
The biggest reason I can see not to do this is that it will not be
compatible with future editions of hidden services which aren't based
on RSA keys. (e.g. the EC point addition stuff to protect against
enumeration attacks wouldn't fit into this model). I don't think this
is a serious concern: if HS x.509s do become widely used we could add
a new authentication type for the new onion addresses when those are
Does anyone else see any other reasons not to do this?
Are there other applications which would benefit from having x.509
certs for onion names?
